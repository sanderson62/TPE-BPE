* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50******************************************************************
    51
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   3
* EL156.cbl
    53 ENVIRONMENT DIVISION.
    54
    55 DATA DIVISION.
    56
    57 WORKING-STORAGE SECTION.
    58 01  DFH-START PIC X(04).
    59
    60 77  FILLER  PIC X(32)  VALUE '********************************'.
    61 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    62 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    63 77  WS-SSN  PIC X(9) VALUE ZEROS.
    64 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    65 77  C0                          PIC S999 COMP-3 VALUE +0.
    66 77  C1                          PIC S999 COMP-3 VALUE +0.
    67 77  C2                          PIC S999 COMP-3 VALUE +0.
    68 77  C3                          PIC S999 COMP-3 VALUE +0.
    69 77  s1                          PIC S999 COMP-3 VALUE +0.
    70 77  s2                          pic s999 comp-3 value +0.
    71 77  P1                          PIC S999 COMP-3 VALUE +0.
    72 77  DD-IU-SW                    PIC X   VALUE ' '.
    73     88  DD-IU-PRESENT                 VALUE 'Y'.
    74 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    75 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    76 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    77 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    78 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    79 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    80 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    81 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    82 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    83
    84*    COPY ELCSCTM.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCTM                             *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    92*                                                                *
    93******************************************************************
    94 01  SECURITY-MESSAGE.
    95     12  FILLER                          PIC X(30)
    96            VALUE '** LOGIC SECURITY VIOLATION -'.
    97     12  SM-READ                         PIC X(6).
    98     12  FILLER                          PIC X(5)
    99            VALUE ' PGM='.
   100     12  SM-PGM                          PIC X(6).
   101     12  FILLER                          PIC X(5)
   102            VALUE ' OPR='.
   103     12  SM-PROCESSOR-ID                 PIC X(4).
   104     12  FILLER                          PIC X(6)
   105            VALUE ' TERM='.
   106     12  SM-TERMID                       PIC X(4).
   107     12  FILLER                          PIC XX   VALUE SPACE.
   108     12  SM-JUL-DATE                     PIC 9(5).
   109     12  FILLER                          PIC X    VALUE SPACE.
   110     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   4
* EL156.cbl
   111
   112
   113*    COPY ELCSCRTY.
   114******************************************************************
   115*                                                                *
   116*                                                                *
   117*                            ELCSCRTY                            *
   118*                            VMOD=2.001                          *
   119*                                                                *
   120*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   121*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   122*        SAVED IN PI-SECURITY-ADDRESS.                           *
   123*                                                                *
   124******************************************************************
   125 01  SECURITY-CONTROL.
   126     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   127     12  FILLER                       PIC XX    VALUE 'SC'.
   128     12  SC-CREDIT-CODES.
   129         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   130             20  SC-CREDIT-DISPLAY    PIC X.
   131             20  SC-CREDIT-UPDATE     PIC X.
   132     12  SC-CLAIMS-CODES.
   133         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   134             20  SC-CLAIMS-DISPLAY    PIC X.
   135             20  SC-CLAIMS-UPDATE     PIC X.
   136
   137 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   138 01  WS-DATE-AREA.
   139     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   140     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   141     12  SAVE-DATE-CCYYMMDD.
   142         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   143         16  SAVE-DATE-YMD.
   144             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   145             20  FILLER              PIC X(04)   VALUE SPACES.
   146
   147 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   148 01  STANDARD-AREAS.
   149     12  WS-RESPONSE         PIC S9(8)   COMP.
   150         88  WS-RESP-NORMAL              VALUE +00.
   151         88  WS-RESP-ERROR               VALUE +01.
   152         88  WS-RESP-NOTFND              VALUE +13.
   153         88  WS-RESP-DUPREC              VALUE +14.
   154         88  WS-RESP-ENDFILE             VALUE +20.
   155     12  PMT-HEAD-A.
   156         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   157         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   158         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   159-        '     RESERVES  TYPE    AMOUNT'.
   160     12  PMT-HEAD-B.
   161         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   162         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   163         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   164     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   165     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   166     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   167     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   168     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   5
* EL156.cbl
   169     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   170     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   171     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   172     12  PGM-NAME            PIC X(8).
   173     12  TIME-IN             PIC S9(7).
   174     12  TIME-OUT-R  REDEFINES TIME-IN.
   175         16  FILLER          PIC X.
   176         16  TIME-OUT        PIC 99V99.
   177         16  FILLER          PIC XX.
   178     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   179     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   180     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   181     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   182     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   183     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   184     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   185     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   186     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   187     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   188     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   189     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   190     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   191     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   192     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   193     12  WS-BLANK            PIC X       VALUE ' '.
   194
   195 01  MISC-WORK-AREAS.
   196     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   197     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   198     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   199     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   200     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   201     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   202     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   203     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   204     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   205     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   206     12  W-CALLED-NAME           PIC X(08).
   207     12  W-EOB-CODES.
   208         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   209             20  W-EOB-CODE      PIC XXX.
   210             20  W-EOB-FILLER    PIC X.
   211     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   212     12  W-NAME-LAST             PIC X(15).
   213     12  W-NAME-FIRST            PIC X(15).
   214     12  W-NAME-MIDDLE.
   215         16  FILLER              PIC X.
   216         16  W-NAME-MIDDLE-2     PIC X.
   217         16  FILLER              PIC X(13).
   218     12  W-DMD-CHECK-NO.
   219         16  W-DMD-CHECK-NO-1    PIC X(4).
   220         16  W-DMD-CHECK-NO-2    PIC X.
   221         16  W-DMD-CHECK-NO-3    PIC XX.
   222
   223     12  WS-COMPUTE-FROM-DT  PIC XX.
   224     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   225     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   226     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   6
* EL156.cbl
   227     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   228     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   229     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   230         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   231         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   232     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   233         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   234     12  WS-UPDATE-SW        PIC X VALUE ' '.
   235     12  WS-GROUPING.
   236         16  WS-GROUP-1      PIC X VALUE SPACES.
   237         16  FILLER          PIC X(05) VALUE SPACES.
   238     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   239     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   240     12  WS-WORK-STATE-ACCT.
   241         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   242         16  FILLER          PIC X       VALUE '/'.
   243         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   244     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   245     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   246     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   247     12  QID.
   248         16  QID-TERM        PIC X(4)    VALUE SPACES.
   249         16  FILLER          PIC X(4)    VALUE '156A'.
   250     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   251     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   252     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   253     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   254     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   255     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   256     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   257     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   258     12  WS-STATUS           PIC X       VALUE SPACES.
   259     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   260     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   261     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   262     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   263     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   264     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   265     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   266     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   267     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   268     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   269     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   270     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   271     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   272     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   273     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   274     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   275     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   276     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   277     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   278     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   279     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   280     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   281     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   282     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   283     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   284     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   7
* EL156.cbl
   285     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   286     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   287     12  WORK-DATE-FROM.
   288         16  WDF-MONTH       PIC 99        VALUE ZERO.
   289         16  WDF-DAY         PIC 99        VALUE ZERO.
   290         16  WDF-YEAR        PIC 99        VALUE ZERO.
   291     12  WORK-DATE-THRU.
   292         16  WDT-MONTH       PIC 99        VALUE ZERO.
   293         16  WDT-DAY         PIC 99        VALUE ZERO.
   294         16  WDT-YEAR        PIC 99        VALUE ZERO.
   295     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   296     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   297     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   298     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   299     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   300     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   301     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   302     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   303     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   304     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   305     12  WS-PY-WK REDEFINES WS-PY-WORK.
   306         16  WS-PY-NUM       PIC S9(7)V99.
   307         16  WS-PY-SIGN      PIC X.
   308     12  WS-DY-WORK          PIC S9(5).
   309     12  WS-DY-WK REDEFINES WS-DY-WORK.
   310         16  WS-DY-NUM       PIC S9(4).
   311         16  WS-DY-SIGN      PIC X.
   312     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   313         88  COMP-REC-FOUND              VALUE 'Y'.
   314     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   315         88  BENEFIT-FOUND       VALUE 'Y'.
   316         88  NO-BENEFIT-FOUND    VALUE 'N'.
   317     12  WS-TERMS.
   318         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   319         16  FILLER          PIC X       VALUE '/'.
   320         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   321         16  WST-REM-DAYS-GRP.
   322             20  WST-SLASH   PIC X       VALUE '/'.
   323             20  WST-REM-DAYS
   324                             PIC --9.
   325     12  WS-ACCESS.
   326         16  FILLER          PIC XX      VALUE SPACES.
   327         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   328     12  WS-STATE-ACCESS.
   329         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   330         16  FILLER          PIC XX      VALUE SPACES.
   331     12  WS-CARR-ACCESS.
   332         16  FILLER          PIC X(3)    VALUE SPACES.
   333         16  WS-CARR         PIC X       VALUE SPACES.
   334     12  DATE-WORK.
   335         16  FILLER          PIC XX      VALUE SPACES.
   336         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   337     12  WS-SAVE-INPUT.
   338         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   339         16  WS-PAYEE        PIC XX      VALUE SPACE.
   340         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   341         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   342         16  WS-OFFLINE      PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   8
* EL156.cbl
   343         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   344         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   345         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   346         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   347         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   348         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   349         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   350         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   351         16  WS-ETYPE        PIC X       VALUE SPACE.
   352         16  WS-CASH         PIC X       VALUE SPACE.
   353         16  WS-GROUPED      PIC X       VALUE SPACE.
   354         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   355         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   356         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   357         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   358         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   359         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   360         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   361         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   362     12  LAST-ERROR-LINE.
   363         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   364         16  FILLER              PIC X(30)
   365             VALUE ' FATAL ERRORS ENCOUNTERED'.
   366         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   367         16  FILLER              PIC X(28)
   368             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   369     12  WS-CHECK-AREA.
   370         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   371         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   372     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   373     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   374         16  FILLER              PIC XX.
   375         16  WS-A-CHECK-NUM-5    PIC 9(5).
   376     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   377         16  FILLER              PIC X.
   378         16  WS-A-CHECK-NUM-6    PIC 9(6).
   379     12  OPTION-1-SAVE-AREA.
   380         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   381         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   382     12  WS-WORK-ZIP.
   383         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   384         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   385     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   386                                 PIC 9(9).
   387     12  WS-FLI-PMTNOTE.
   388         16  WS-PMTOPTION        PIC XX.
   389         16  WS-DOCNAME          PIC X(28).
   390         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   391             20  WS-AMOUNT       PIC X(8).
   392             20  FILLER          PIC X(20).
   393         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   394             20  WS-NUM-AMT      PIC 9(6)V99.
   395             20  FILLER          PIC X(20).
   396
   397     12  WS-HAN-PMTNOTE.
   398         16  WS-HAN-PMT-CODE     PIC X.
   399         16  WS-HAN-PMT-NOTE     PIC X(39).
   400
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page   9
* EL156.cbl
   401     12  WS-NCL-PMT-OPTION       PIC XX.
   402         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   403
   404     12  WS-CLAIM-SEQUENCE.
   405         16  FILLER              PIC X VALUE '('.
   406         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   407         16  FILLER              PIC X(04) VALUE ' OF '.
   408         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   409         16  FILLER              PIC X VALUE ')'.
   410
   411     12  WS-REFUND-AMT           PIC Z(7).99.
   412     12  WS-CALC-INT             PIC S9(7)V99.
   413     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   414
   415     12  SUB                     PIC 99 VALUE ZEROS.
   416
   417     12  WS-BOANOTE1.
   418         16  WS-BOANOTE1-DESC    PIC X(11).
   419         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   420         16  FILLER              PIC X(17).
   421     12  WS-BOANOTE2.
   422         16  WS-BOANOTE2-DESC    PIC X(11).
   423         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   424         16  FILLER              PIC X(17).
   425
   426     12  WS-NCLNOTE1.
   427         16  WS-NCLNOTE1-DESC    PIC X(11).
   428         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   429         16  FILLER              PIC X(17).
   430     12  WS-NCLNOTE2.
   431         16  WS-NCLNOTE2-DESC    PIC X(11).
   432         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   433         16  FILLER              PIC X(17).
   434
   435     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   436     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   437     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   438     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   439     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   440     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   441     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   442     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   443     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   444     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   445
   446     12  WS-AIG-WORK-AREAS.
   447         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   448             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   449         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   450             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   451         16  WS-FROM-DATE-MDY.
   452             20  WS-FROM-MO      PIC 99.
   453             20  WS-FROM-DA      PIC 99.
   454             20  WS-FROM-YR      PIC 99.
   455         16  WS-TEMP-DATE-MDY.
   456             20  WS-TEMP-MO      PIC 99.
   457             20  WS-TEMP-DA      PIC 99.
   458             20  WS-TEMP-YR      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  10
* EL156.cbl
   459         16  WS-BIN-FROM-DT      PIC XX.
   460         16  WS-TEMP-INC-MDY.
   461             20  WS-TEMP-INC-MO  PIC 99.
   462             20  WS-TEMP-INC-DA  PIC 99.
   463             20  WS-TEMP-INC-YR  PIC 99.
   464         16  WS-PMT-DUE-MDY.
   465             20  WS-PMT-DUE-MO   PIC 99.
   466             20  WS-PMT-DUE-DA   PIC 99.
   467             20  WS-PMT-DUE-YR   PIC 99.
   468         16  WS-PMT-DUE-DT       PIC XX.
   469         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   470         16  WS-RETRO-ELIM-DT    PIC XX.
   471         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   472             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   473         16  WS-SAVE-DUE-DA      PIC 99.
   474         16  WS-CDAYS            PIC S9(05).
   475         16  WS-DAYS-OFF         PIC S9(05).
   476         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   477             88  ELIM-SATISFIED            VALUE 'Y'.
   478         16  WS-AIG-CHECKNO.
   479             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   480             20  WS-A-CHECKNO-3-7.
   481                 24  FILLER              PIC X(3)    VALUE SPACES.
   482                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   483                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   484         16  WS-AIG-GROUPING.
   485             20  WS-A-BENE               PIC XXX.
   486             20  FILLER                  PIC XXX.
   487         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   488             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   489             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   490         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   491                 VALUE 'UNEMPLOYMENT PAYMENT'.
   492         16  WS-CHK-THRU-DT              PIC XX.
   493         16  WS-HOLD-BIN-DATE-1          PIC XX.
   494
   495 01  MISC-CSO-AREA.
   496     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   497     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   498     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   499         88  APPROVAL-NEEDED                        VALUE 'Y'.
   500     12  WS-APPROV-NOTE                  PIC X(43)
   501         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   502     12  WS-REAUDIT-NOTE                 PIC X(43)
   503         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   504     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   505     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   506     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   507     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   508     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   509     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   510     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   511         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   512     12  WS-PAYEE-CITY-STATE     PIC X(30).
   513     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   514         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   515     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   516     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  11
* EL156.cbl
   517     12  WS-WORK-NAME            PIC X(30).
   518     12  FILLER  REDEFINES WS-WORK-NAME.
   519         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   520     12  WS-INSURED-NAME         PIC X(30).
   521     12  FILLER  REDEFINES WS-INSURED-NAME.
   522         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   523     12  WS-PAYEE-NAME           PIC X(30).
   524     12  FILLER  REDEFINES WS-PAYEE-NAME.
   525         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   526
   527 01  ERROR-MESSAGES.
   528     12  ER-0000                 PIC X(4)  VALUE '0000'.
   529     12  ER-0004                 PIC X(4)  VALUE '0004'.
   530     12  ER-0008                 PIC X(4)  VALUE '0008'.
   531     12  ER-0019                 PIC X(4)  VALUE '0019'.
   532     12  ER-0029                 PIC X(4)  VALUE '0029'.
   533     12  ER-0042                 PIC X(4)  VALUE '0042'.
   534     12  ER-0070                 PIC X(4)  VALUE '0070'.
   535     12  ER-0130                 PIC X(4)  VALUE '0130'.
   536     12  ER-0149                 PIC X(4)  VALUE '0149'.
   537     12  ER-0154                 PIC X(4)  VALUE '0154'.
   538     12  ER-0168                 PIC X(4)  VALUE '0168'.
   539     12  ER-0169                 PIC X(4)  VALUE '0169'.
   540     12  ER-0172                 PIC X(4)  VALUE '0174'.
   541     12  ER-0198                 PIC X(4)  VALUE '0198'.
   542     12  ER-0204                 PIC X(4)  VALUE '0204'.
   543     12  ER-0206                 PIC X(4)  VALUE '0206'.
   544     12  ER-0252                 PIC X(4)  VALUE '0252'.
   545     12  ER-0254                 PIC X(4)  VALUE '0254'.
   546     12  ER-0282                 PIC X(4)  VALUE '0282'.
   547     12  ER-0283                 PIC X(4)  VALUE '0283'.
   548     12  ER-0294                 PIC X(4)  VALUE '0294'.
   549     12  ER-0338                 PIC X(4)  VALUE '0338'.
   550     12  ER-0419                 PIC X(4)  VALUE '0419'.
   551     12  ER-0420                 PIC X(4)  VALUE '0420'.
   552     12  ER-0421                 PIC X(4)  VALUE '0421'.
   553     12  ER-0422                 PIC X(4)  VALUE '0422'.
   554     12  ER-0433                 PIC X(4)  VALUE '0433'.
   555     12  ER-0436                 PIC X(4)  VALUE '0436'.
   556     12  ER-0437                 PIC X(4)  VALUE '0437'.
   557     12  ER-0438                 PIC X(4)  VALUE '0438'.
   558     12  ER-0439                 PIC X(4)  VALUE '0439'.
   559     12  ER-0440                 PIC X(4)  VALUE '0440'.
   560     12  ER-0441                 PIC X(4)  VALUE '0441'.
   561     12  ER-0442                 PIC X(4)  VALUE '0442'.
   562     12  ER-0443                 PIC X(4)  VALUE '0443'.
   563     12  ER-0444                 PIC X(4)  VALUE '0444'.
   564     12  ER-0445                 PIC X(4)  VALUE '0445'.
   565     12  ER-0446                 PIC X(4)  VALUE '0446'.
   566     12  ER-0447                 PIC X(4)  VALUE '0447'.
   567     12  ER-0448                 PIC X(4)  VALUE '0448'.
   568     12  ER-0449                 PIC X(4)  VALUE '0449'.
   569     12  ER-0452                 PIC X(4)  VALUE '0452'.
   570     12  ER-0458                 PIC X(4)  VALUE '0458'.
   571     12  ER-0459                 PIC X(4)  VALUE '0459'.
   572     12  ER-0460                 PIC X(4)  VALUE '0460'.
   573     12  ER-0461                 PIC X(4)  VALUE '0461'.
   574     12  ER-0462                 PIC X(4)  VALUE '0462'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  12
* EL156.cbl
   575     12  ER-0463                 PIC X(4)  VALUE '0463'.
   576     12  ER-0464                 PIC X(4)  VALUE '0464'.
   577     12  ER-0465                 PIC X(4)  VALUE '0465'.
   578     12  ER-0466                 PIC X(4)  VALUE '0466'.
   579     12  ER-0467                 PIC X(4)  VALUE '0467'.
   580     12  ER-0468                 PIC X(4)  VALUE '0468'.
   581     12  ER-0469                 PIC X(4)  VALUE '0469'.
   582     12  ER-0473                 PIC X(4)  VALUE '0473'.
   583     12  ER-0474                 PIC X(4)  VALUE '0474'.
   584     12  ER-0475                 PIC X(4)  VALUE '0475'.
   585     12  ER-0476                 PIC X(4)  VALUE '0476'.
   586     12  ER-0477                 PIC X(4)  VALUE '0477'.
   587     12  ER-0478                 PIC X(4)  VALUE '0478'.
   588     12  ER-0479                 PIC X(4)  VALUE '0479'.
   589     12  ER-0481                 PIC X(4)  VALUE '0481'.
   590     12  ER-0491                 PIC X(4)  VALUE '0491'.
   591     12  ER-0492                 PIC X(4)  VALUE '0492'.
   592     12  ER-0493                 PIC X(4)  VALUE '0493'.
   593     12  ER-0494                 PIC X(4)  VALUE '0494'.
   594     12  ER-0495                 PIC X(4)  VALUE '0495'.
   595     12  ER-0499                 PIC X(4)  VALUE '0499'.
   596     12  ER-0500                 PIC X(4)  VALUE '0500'.
   597     12  ER-0501                 PIC X(4)  VALUE '0501'.
   598     12  ER-0502                 PIC X(4)  VALUE '0502'.
   599     12  ER-0508                 PIC X(4)  VALUE '0508'.
   600     12  ER-0513                 PIC X(4)  VALUE '0513'.
   601     12  ER-0518                 PIC X(4)  VALUE '0518'.
   602     12  ER-0524                 PIC X(4)  VALUE '0524'.
   603     12  ER-0525                 PIC X(4)  VALUE '0525'.
   604     12  ER-0526                 PIC X(4)  VALUE '0526'.
   605     12  ER-0530                 PIC X(4)  VALUE '0530'.
   606     12  ER-0540                 PIC X(4)  VALUE '0540'.
   607     12  ER-0541                 PIC X(4)  VALUE '0541'.
   608     12  ER-0542                 PIC X(4)  VALUE '0542'.
   609     12  ER-0543                 PIC X(4)  VALUE '0543'.
   610     12  ER-0545                 PIC X(4)  VALUE '0545'.
   611     12  ER-0552                 PIC X(4)  VALUE '0552'.
   612     12  ER-0555                 PIC X(4)  VALUE '0555'.
   613     12  ER-0556                 PIC X(4)  VALUE '0556'.
   614     12  ER-0557                 PIC X(4)  VALUE '0557'.
   615     12  ER-0572                 PIC X(4)  VALUE '0572'.
   616     12  ER-0573                 PIC X(4)  VALUE '0573'.
   617     12  ER-0594                 PIC X(4)  VALUE '0594'.
   618     12  ER-0616                 PIC X(4)  VALUE '0616'.
   619     12  ER-0617                 PIC X(4)  VALUE '0617'.
   620     12  ER-0618                 PIC X(4)  VALUE '0618'.
   621     12  ER-0657                 PIC X(4)  VALUE '0657'.
   622     12  ER-0658                 PIC X(4)  VALUE '0658'.
   623     12  ER-0699                 PIC X(4)  VALUE '0699'.
   624     12  ER-0730                 PIC X(4)  VALUE '0730'.
   625     12  ER-0737                 PIC X(4)  VALUE '0737'.
   626     12  ER-0760                 PIC X(4)  VALUE '0760'.
   627     12  ER-0768                 PIC X(4)  VALUE '0768'.
   628     12  ER-0769                 PIC X(4)  VALUE '0769'.
   629     12  ER-0770                 PIC X(4)  VALUE '0770'.
   630     12  ER-0802                 PIC X(4)  VALUE '0802'.
   631     12  ER-0803                 PIC X(4)  VALUE '0803'.
   632     12  ER-0819                 PIC X(4)  VALUE '0819'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  13
* EL156.cbl
   633     12  ER-0834                 PIC X(4)  VALUE '0834'.
   634     12  ER-0836                 PIC X(4)  VALUE '0836'.
   635     12  ER-0844                 PIC X(4)  VALUE '0844'.
   636     12  ER-0845                 PIC X(4)  VALUE '0845'.
   637     12  ER-0846                 PIC X(4)  VALUE '0846'.
   638     12  ER-0849                 PIC X(4)  VALUE '0849'.
   639     12  ER-0851                 PIC X(4)  VALUE '0851'.
   640     12  ER-0872                 PIC X(4)  VALUE '0872'.
   641     12  ER-0873                 PIC X(4)  VALUE '0873'.
   642     12  ER-0874                 PIC X(4)  VALUE '0874'.
   643     12  ER-0879                 PIC X(4)  VALUE '0879'.
   644     12  ER-0919                 PIC X(4)  VALUE '0919'.
   645     12  ER-0921                 PIC X(4)  VALUE '0921'.
   646     12  ER-0923                 PIC X(4)  VALUE '0923'.
   647     12  ER-0925                 PIC X(4)  VALUE '0925'.
   648     12  ER-0944                 PIC X(4)  VALUE '0944'.
   649     12  ER-0945                 PIC X(4)  VALUE '0945'.
   650     12  ER-0946                 PIC X(4)  VALUE '0946'.
   651     12  ER-0947                 PIC X(4)  VALUE '0947'.
   652     12  ER-0948                 PIC X(4)  VALUE '0948'.
   653     12  ER-0949                 PIC X(4)  VALUE '0949'.
   654     12  ER-0950                 PIC X(4)  VALUE '0950'.
   655     12  ER-0951                 PIC X(4)  VALUE '0951'.
   656     12  ER-0954                 PIC X(4)  VALUE '0954'.
   657     12  ER-0956                 PIC X(4)  VALUE '0956'.
   658     12  ER-0967                 PIC X(4)  VALUE '0967'.
   659     12  ER-0968                 PIC X(4)  VALUE '0968'.
   660     12  ER-0974                 PIC X(4)  VALUE '0974'.
   661     12  ER-0975                 PIC X(4)  VALUE '0975'.
   662     12  ER-1561                 PIC X(4)  VALUE '1561'.
   663     12  ER-1566                 PIC X(4)  VALUE '1566'.
   664     12  ER-1567                 PIC X(4)  VALUE '1567'.
   665     12  ER-1569                 PIC X(4)  VALUE '1569'.
   666     12  er-1657                 pic x(4)  value '1657'.
   667     12  er-1658                 pic x(4)  value '1658'.
   668     12  ER-1775                 PIC X(4)  VALUE '1775'.
   669     12  ER-1880                 PIC X(4)  VALUE '1880'.
   670     12  ER-2044                 PIC X(4)  VALUE '2044'.
   671     12  ER-3140                 PIC X(4)  VALUE '3140'.
   672     12  ER-3141                 PIC X(4)  VALUE '3141'.
   673     12  ER-3255                 PIC X(4)  VALUE '3255'.
   674     12  ER-3516                 PIC X(4)  VALUE '3516'.
   675     12  ER-3527                 PIC X(4)  VALUE '3527'.
   676     12  ER-3528                 PIC X(4)  VALUE '3528'.
   677     12  ER-3529                 PIC X(4)  VALUE '3529'.
   678     12  ER-3530                 PIC X(4)  VALUE '3530'.
   679     12  ER-3531                 PIC X(4)  VALUE '3531'.
   680     12  ER-3532                 PIC X(4)  VALUE '3532'.
   681     12  ER-3533                 PIC X(4)  VALUE '3533'.
   682     12  ER-3534                 PIC X(4)  VALUE '3534'.
   683     12  ER-3535                 PIC X(4)  VALUE '3535'.
   684     12  ER-3536                 PIC X(4)  VALUE '3536'.
   685     12  ER-3537                 PIC X(4)  VALUE '3537'.
   686     12  ER-3538                 PIC X(4)  VALUE '3538'.
   687     12  ER-3539                 PIC X(4)  VALUE '3539'.
   688     12  ER-3540                 PIC X(4)  VALUE '3540'.
   689     12  ER-3541                 PIC X(4)  VALUE '3541'.
   690     12  ER-3542                 PIC X(4)  VALUE '3542'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  14
* EL156.cbl
   691     12  ER-3543                 PIC X(4)  VALUE '3543'.
   692     12  ER-3546                 PIC X(4)  VALUE '3546'.
   693     12  ER-3549                 PIC X(4)  VALUE '3549'.
   694     12  ER-3818                 PIC X(4)  VALUE '3818'.
   695     12  ER-7540                 PIC X(4)  VALUE '7540'.
   696     12  ER-7576                 PIC X(4)  VALUE '7576'.
   697     12  ER-7579                 PIC X(4)  VALUE '7579'.
   698     12  ER-7830                 PIC X(4)  VALUE '7830'.
   699     12  ER-7831                 PIC X(4)  VALUE '7831'.
   700     12  ER-7832                 PIC X(4)  VALUE '7832'.
   701     12  ER-7833                 PIC X(4)  VALUE '7833'.
   702     12  ER-7834                 PIC X(4)  VALUE '7834'.
   703     12  ER-7835                 PIC X(4)  VALUE '7835'.
   704     12  ER-7836                 PIC X(4)  VALUE '7836'.
   705     12  ER-7837                 PIC X(4)  VALUE '7837'.
   706     12  ER-7838                 PIC X(4)  VALUE '7838'.
   707     12  ER-7841                 PIC X(4)  VALUE '7841'.
   708     12  ER-7844                 PIC X(4)  VALUE '7844'.
   709     12  ER-7845                 PIC X(4)  VALUE '7845'.
   710     12  ER-8000                 PIC X(4)  VALUE '8000'.
   711     12  ER-8051                 PIC X(4)  VALUE '8051'.
   712     12  ER-8052                 PIC X(4)  VALUE '8052'.
   713     12  ER-8053                 PIC X(4)  VALUE '8053'.
   714     12  ER-8054                 PIC X(4)  VALUE '8054'.
   715     12  ER-8055                 PIC X(4)  VALUE '8055'.
   716     12  ER-8056                 PIC X(4)  VALUE '8056'.
   717     12  ER-8057                 PIC X(4)  VALUE '8057'.
   718     12  ER-8058                 PIC X(4)  VALUE '8058'.
   719     12  ER-8059                 PIC X(4)  VALUE '8059'.
   720     12  ER-8060                 PIC X(4)  VALUE '8060'.
   721     12  ER-8061                 PIC X(4)  VALUE '8061'.
   722     12  ER-8062                 PIC X(4)  VALUE '8062'.
   723     12  ER-8063                 PIC X(4)  VALUE '8063'.
   724     12  ER-8064                 PIC X(4)  VALUE '8064'.
   725     12  ER-8065                 PIC X(4)  VALUE '8065'.
   726     12  ER-8066                 PIC X(4)  VALUE '8066'.
   727     12  ER-8146                 PIC X(4)  VALUE '8146'.
   728     12  ER-8147                 PIC X(4)  VALUE '8147'.
   729     12  ER-8152                 PIC X(4)  VALUE '8152'.
   730     12  ER-8153                 PIC X(4)  VALUE '8153'.
   731     12  ER-8154                 PIC X(4)  VALUE '8154'.
   732     12  ER-8155                 PIC X(4)  VALUE '8155'.
   733     12  ER-8310                 PIC X(4)  VALUE '8310'.
   734     12  ER-8311                 PIC X(4)  VALUE '8311'.
   735     12  ER-8312                 PIC X(4)  VALUE '8312'.
   736     12  ER-8313                 PIC X(4)  VALUE '8313'.
   737     12  ER-8314                 PIC X(4)  VALUE '8314'.
   738     12  ER-8315                 PIC X(4)  VALUE '8315'.
   739     12  ER-8316                 PIC X(4)  VALUE '8316'.
   740     12  ER-8317                 PIC X(4)  VALUE '8317'.
   741
   742 01  CSO-WORK-FIELDS.
   743     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   744       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   745
   746     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   747     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   748         88  CERT-NOTE-ADDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  15
* EL156.cbl
   749     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   750         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   751     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   752
   753     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   754
   755 01  SC-NP6-CERT-NOTE.
   756     12  FILLER                  PIC X(12)
   757               VALUE 'REM BENEFIT '.
   758     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   759     12  SC-NP6-COMM             PIC X(8)
   760               VALUE ' + 6 MO '.
   761     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   762     12  FILLER                  PIC X(12)
   763               VALUE ' = AMT PAID '.
   764     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   765
   766 01  SC-NP6-ORIG-NOTE.
   767     12  FILLER                  PIC X(63)  VALUE
   768         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   769 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   770     88  PDEF-FOUND                   VALUE 'Y'.
   771 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   772     88  ACCT-FOUND                   VALUE 'Y'.
   773 01  CTBL-KEY-SAVE               PIC X(5).
   774 01  CTBL-KEY.
   775     05  CTBL-COMPANY-CD         PIC X.
   776     05  CTBL-TABLE              PIC XXX.
   777     05  CTBL-BEN-TYPE           PIC X.
   778     05  CTBL-BEN-CODE           PIC XX.
   779 01  ERPDEF-KEY-SAVE             PIC X(18).
   780 01  ERPDEF-KEY.
   781     12  ERPDEF-COMPANY-CD       PIC X.
   782     12  ERPDEF-STATE            PIC XX.
   783     12  ERPDEF-PROD-CD          PIC XXX.
   784     12  F                       PIC X(7).
   785     12  ERPDEF-BEN-TYPE         PIC X.
   786     12  ERPDEF-BEN-CODE         PIC XX.
   787     12  ERPDEF-EXP-DT           PIC XX.
   788 01  ELCRTT-KEY.
   789     05  CTRLR-COMP-CD       PIC X.
   790     05  CTRLR-CARRIER       PIC X.
   791     05  CTRLR-GROUPING      PIC X(6).
   792     05  CTRLR-STATE         PIC X(2).
   793     05  CTRLR-ACCOUNT       PIC X(10).
   794     05  CTRLR-EFF-DT        PIC XX.
   795     05  CTRLR-CERT-NO       PIC X(11).
   796     05  CTRLR-REC-TYPE      PIC X.
   797 01  ACCESS-KEYS.
   798     12  ELARCH-KEY.
   799         16  ARCH-CO             PIC X.
   800         16  ARCH-NUMBER         PIC S9(08) COMP.
   801         16  ARCH-REC-TYPE       PIC X.
   802         16  ARCH-SEQ            PIC S9(04) COMP.
   803     12  ELMSTR-KEY.
   804         16  MSTR-COMP-CD        PIC X.
   805         16  MSTR-CARRIER        PIC X.
   806         16  MSTR-CLAIM-NO       PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  16
* EL156.cbl
   807         16  MSTR-CERT-NO        PIC X(11).
   808     12  ELCNTL-KEY.
   809         16  CNTL-COMP-ID        PIC X(3).
   810         16  CNTL-REC-TYPE       PIC X.
   811         16  CNTL-ACCESS         PIC X(4).
   812         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   813     12  ELCERT-KEY.
   814         16  CERT-COMP-CD        PIC X.
   815         16  CERT-CARRIER        PIC X.
   816         16  CERT-GROUPING       PIC X(6).
   817         16  CERT-STATE          PIC XX.
   818         16  CERT-ACCOUNT        PIC X(10).
   819         16  CERT-EFF-DT         PIC XX.
   820         16  CERT-CERT-NO        PIC X(11).
   821     12  ELTRLR-KEY.
   822         16  TRLR-COMP-CD        PIC X.
   823         16  TRLR-CARRIER        PIC X.
   824         16  TRLR-CLAIM-NO       PIC X(7).
   825         16  TRLR-CERT-NO        PIC X(11).
   826         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   827     12  ELACTQ-KEY.
   828         16  ACTQ-COMP-CD        PIC X.
   829         16  ACTQ-CARRIER        PIC X.
   830         16  ACTQ-CLAIM-NO       PIC X(7).
   831         16  ACTQ-CERT-NO        PIC X(11).
   832     12  W-NOTE-KEY.
   833         16  W-NOTE-COMP-CD      PIC X.
   834         16  W-NOTE-CERT-KEY.
   835             20  W-NOTE-CARRIER  PIC X.
   836             20  W-NOTE-GROUPING PIC X(6).
   837             20  W-NOTE-STATE    PIC XX.
   838             20  W-NOTE-ACCOUNT  PIC X(10).
   839             20  W-NOTE-EFF-DT   PIC XX.
   840             20  W-NOTE-CERT-NO  PIC X(11).
   841     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   842     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   843     12  ERACCT-KEY.
   844         16  ERACCT-PARTIAL-KEY.
   845             20  ACCT-COMP-CD    PIC X.
   846             20  ACCT-CARRIER    PIC X.
   847             20  ACCT-GROUPING   PIC X(6).
   848             20  ACCT-STATE      PIC XX.
   849             20  ACCT-ACCOUNT    PIC X(10).
   850         16  ACCT-EXP-DT         PIC XX.
   851         16  FILLER              PIC X(4) VALUE SPACES.
   852     12  ELCHKQ-KEY.
   853         16  CHKQ-COMP-CD        PIC X.
   854         16  CHKQ-CONTROL        PIC S9(8) COMP.
   855         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   856     12  ELBENE-KEY.
   857         16  BENE-COMP-CD         PIC X.
   858         16  BENE-RECORD-TYPE     PIC X.
   859         16  BENE-NUMBER          PIC X(10).
   860     12  ERCOMP-KEY.
   861         16  COMP-COMP-CD        PIC X.
   862         16  COMP-CARRIER        PIC X.
   863         16  COMP-GROUP          PIC X(06).
   864         16  COMP-FIN-RESP       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  17
* EL156.cbl
   865         16  COMP-ACCOUNT        PIC X(10).
   866         16  COMP-TYPE           PIC X.
   867
   868     12  DLO035-KEY.
   869         16  DL35-PROCESS-TYPE   PIC X.
   870         16  DL35-CREDIT-CARD    PIC X(20).
   871         16  DL35-BEN-TYPE       PIC XX.
   872         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   873         16  DL35-RETURN-CODE    PIC XX.
   874
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  18
* EL156.cbl
   876*    COPY ELCDATE.
   877******************************************************************
   878*                                                                *
   879*                                                                *
   880*                            ELCDATE.                            *
   881*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   882*                            VMOD=2.003
   883*                                                                *
   884*                                                                *
   885*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   886*                 LENGTH = 200                                   *
   887******************************************************************
   888
   889 01  DATE-CONVERSION-DATA.
   890     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   891     12  DC-OPTION-CODE                PIC X.
   892         88  BIN-TO-GREG                VALUE ' '.
   893         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   894         88  EDIT-GREG-TO-BIN           VALUE '2'.
   895         88  YMD-GREG-TO-BIN            VALUE '3'.
   896         88  MDY-GREG-TO-BIN            VALUE '4'.
   897         88  JULIAN-TO-BIN              VALUE '5'.
   898         88  BIN-PLUS-ELAPSED           VALUE '6'.
   899         88  FIND-CENTURY               VALUE '7'.
   900         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   901         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   902         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   903         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   904         88  JULIAN-TO-BIN-3            VALUE 'C'.
   905         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   906         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   907         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   908         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   909         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   910         88  CHECK-LEAP-YEAR            VALUE 'H'.
   911         88  BIN-3-TO-GREG              VALUE 'I'.
   912         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   913         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   914         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   915         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   916         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   917         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   918         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   919         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   920         88  THREE-CHARACTER-BIN
   921                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   922         88  GREGORIAN-TO-BIN
   923                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   924         88  BIN-TO-GREGORIAN
   925                  VALUES ' ' '1' 'I' '8' 'G'.
   926         88  JULIAN-TO-BINARY
   927                  VALUES '5' 'C' 'E' 'F'.
   928     12  DC-ERROR-CODE                 PIC X.
   929         88  NO-CONVERSION-ERROR        VALUE ' '.
   930         88  DATE-CONVERSION-ERROR
   931                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   932         88  DATE-IS-ZERO               VALUE '1'.
   933         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  19
* EL156.cbl
   934         88  DATE-IS-INVALID            VALUE '3'.
   935         88  DATE1-GREATER-DATE2        VALUE '4'.
   936         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   937         88  DATE-INVALID-OPTION        VALUE '9'.
   938         88  INVALID-CENTURY            VALUE 'A'.
   939         88  ONLY-CENTURY               VALUE 'B'.
   940         88  ONLY-LEAP-YEAR             VALUE 'C'.
   941         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   942     12  DC-END-OF-MONTH               PIC X.
   943         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   944     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   945         88  USE-NORMAL-PROCESS         VALUE ' '.
   946         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   947         88  ADJUST-UP-100-YRS          VALUE '2'.
   948     12  FILLER                        PIC X.
   949     12  DC-CONVERSION-DATES.
   950         16  DC-BIN-DATE-1             PIC XX.
   951         16  DC-BIN-DATE-2             PIC XX.
   952         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   953         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   954                       DC-GREG-DATE-1-EDIT.
   955             20  DC-EDIT1-MONTH        PIC 99.
   956             20  SLASH1-1              PIC X.
   957             20  DC-EDIT1-DAY          PIC 99.
   958             20  SLASH1-2              PIC X.
   959             20  DC-EDIT1-YEAR         PIC 99.
   960         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   961         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   962                     DC-GREG-DATE-2-EDIT.
   963             20  DC-EDIT2-MONTH        PIC 99.
   964             20  SLASH2-1              PIC X.
   965             20  DC-EDIT2-DAY          PIC 99.
   966             20  SLASH2-2              PIC X.
   967             20  DC-EDIT2-YEAR         PIC 99.
   968         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   969         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   970                     DC-GREG-DATE-1-YMD.
   971             20  DC-YMD-YEAR           PIC 99.
   972             20  DC-YMD-MONTH          PIC 99.
   973             20  DC-YMD-DAY            PIC 99.
   974         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   975         16  DC-GREG-DATE-1-MDY-R REDEFINES
   976                      DC-GREG-DATE-1-MDY.
   977             20  DC-MDY-MONTH          PIC 99.
   978             20  DC-MDY-DAY            PIC 99.
   979             20  DC-MDY-YEAR           PIC 99.
   980         16  DC-GREG-DATE-1-ALPHA.
   981             20  DC-ALPHA-MONTH        PIC X(10).
   982             20  DC-ALPHA-DAY          PIC 99.
   983             20  FILLER                PIC XX.
   984             20  DC-ALPHA-CENTURY.
   985                 24 DC-ALPHA-CEN-N     PIC 99.
   986             20  DC-ALPHA-YEAR         PIC 99.
   987         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   988         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   989         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   990         16  DC-JULIAN-DATE            PIC 9(05).
   991         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  20
* EL156.cbl
   992                                       PIC 9(05).
   993         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   994             20  DC-JULIAN-YEAR        PIC 99.
   995             20  DC-JULIAN-DAYS        PIC 999.
   996         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   997         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   998         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   999     12  DATE-CONVERSION-VARIBLES.
  1000         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1001         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1002             20  FILLER                PIC 9(3).
  1003             20  HOLD-CEN-1-CCYY.
  1004                 24  HOLD-CEN-1-CC     PIC 99.
  1005                 24  HOLD-CEN-1-YY     PIC 99.
  1006             20  HOLD-CEN-1-MO         PIC 99.
  1007             20  HOLD-CEN-1-DA         PIC 99.
  1008         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1009             20  HOLD-CEN-1-R-MO       PIC 99.
  1010             20  HOLD-CEN-1-R-DA       PIC 99.
  1011             20  HOLD-CEN-1-R-CCYY.
  1012                 24  HOLD-CEN-1-R-CC   PIC 99.
  1013                 24  HOLD-CEN-1-R-YY   PIC 99.
  1014             20  FILLER                PIC 9(3).
  1015         16  HOLD-CENTURY-1-X.
  1016             20  FILLER                PIC X(3)  VALUE SPACES.
  1017             20  HOLD-CEN-1-X-CCYY.
  1018                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1019                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1020             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1021             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1022         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1023             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1024             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1025             20  HOLD-CEN-1-R-X-CCYY.
  1026                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1027                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1028             20  FILLER                PIC XXX.
  1029         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1030         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1031         16  DC-JULIAN-DATE-1          PIC 9(07).
  1032         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1033             20  DC-JULIAN-1-CCYY.
  1034                 24  DC-JULIAN-1-CC    PIC 99.
  1035                 24  DC-JULIAN-1-YR    PIC 99.
  1036             20  DC-JULIAN-DA-1        PIC 999.
  1037         16  DC-JULIAN-DATE-2          PIC 9(07).
  1038         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1039             20  DC-JULIAN-2-CCYY.
  1040                 24  DC-JULIAN-2-CC    PIC 99.
  1041                 24  DC-JULIAN-2-YR    PIC 99.
  1042             20  DC-JULIAN-DA-2        PIC 999.
  1043         16  DC-GREG-DATE-A-EDIT.
  1044             20  DC-EDITA-MONTH        PIC 99.
  1045             20  SLASHA-1              PIC X VALUE '/'.
  1046             20  DC-EDITA-DAY          PIC 99.
  1047             20  SLASHA-2              PIC X VALUE '/'.
  1048             20  DC-EDITA-CCYY.
  1049                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  21
* EL156.cbl
  1050                 24  DC-EDITA-YEAR     PIC 99.
  1051         16  DC-GREG-DATE-B-EDIT.
  1052             20  DC-EDITB-MONTH        PIC 99.
  1053             20  SLASHB-1              PIC X VALUE '/'.
  1054             20  DC-EDITB-DAY          PIC 99.
  1055             20  SLASHB-2              PIC X VALUE '/'.
  1056             20  DC-EDITB-CCYY.
  1057                 24  DC-EDITB-CENT     PIC 99.
  1058                 24  DC-EDITB-YEAR     PIC 99.
  1059         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1060         16  DC-GREG-DATE-CYMD-R REDEFINES
  1061                              DC-GREG-DATE-CYMD.
  1062             20  DC-CYMD-CEN           PIC 99.
  1063             20  DC-CYMD-YEAR          PIC 99.
  1064             20  DC-CYMD-MONTH         PIC 99.
  1065             20  DC-CYMD-DAY           PIC 99.
  1066         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1067         16  DC-GREG-DATE-MDCY-R REDEFINES
  1068                              DC-GREG-DATE-MDCY.
  1069             20  DC-MDCY-MONTH         PIC 99.
  1070             20  DC-MDCY-DAY           PIC 99.
  1071             20  DC-MDCY-CEN           PIC 99.
  1072             20  DC-MDCY-YEAR          PIC 99.
  1073    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1074        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1075    12  DC-EL310-DATE                  PIC X(21).
  1076    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  22
* EL156.cbl
  1078*    COPY ELCLOGOF.
  1079******************************************************************
  1080*                                                                *
  1081*                                                                *
  1082*                            ELCLOGOF.                           *
  1083*                            VMOD=2.001                          *
  1084*                                                                *
  1085*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1086*                                                                *
  1087******************************************************************
  1088 01  CLASIC-LOGOFF.
  1089     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1090     12  LOGOFF-TEXT.
  1091         16  FILLER          PIC X(5)    VALUE SPACES.
  1092         16  LOGOFF-MSG.
  1093             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1094             20  FILLER      PIC X       VALUE SPACES.
  1095             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1096         16  FILLER          PIC X(80)
  1097           VALUE '* YOU ARE NOW LOGGED OFF'.
  1098         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1099         16  FILLER          PIC X       VALUE QUOTE.
  1100         16  LOGOFF-SYS-MSG  PIC X(17)
  1101           VALUE 'S CLAS-IC SYSTEM '.
  1102     12  TEXT-MESSAGES.
  1103         16  UNACCESS-MSG    PIC X(29)
  1104             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1105         16  PGMIDERR-MSG    PIC X(17)
  1106             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  23
* EL156.cbl
  1108*    COPY ELCCALC.
  1109******************************************************************
  1110*                                                                *
  1111*                           ELCCALC.                            *
  1112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1113*                            VMOD=2.025                          *
  1114*                                                                *
  1115*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1116*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1117*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1118*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1119*                                                                *
  1120*  PASSED TO ELRTRM                                              *
  1121*  -----------------                                             *
  1122*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1123*  ORIGINAL TERM                                                 *
  1124*  BEGINNING DATE                                                *
  1125*  ENDING DATE                                                   *
  1126*  COMPANY I.D.                                                  *
  1127*  ACCOUNT MASTER USER FIELD                                     *
  1128*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1129*  FREE LOOK DAYS                                                *
  1130*                                                                *
  1131*  RETURNED FROM ELRTRM                                          *
  1132*  ---------------------                                         *
  1133*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1134*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1135*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1136*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1137*----------------------------------------------------------------*
  1138*  PASSED TO ELRAMT                                              *
  1139*  ----------------                                              *
  1140*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1141*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1142*  ORIGINAL AMOUNT                                               *
  1143*  ALTERNATE BENEFIT (BALLON)                                    *
  1144*  A.P.R. - NET PAY ONLY                                         *
  1145*  METHOD
  1146*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1147*  COMPANY I.D.                                                  *
  1148*  BENEFIT TYPE                                                  *
  1149*                                                                *
  1150*  RETURNED FROM ELRAMT                                          *
  1151*  --------------------                                          *
  1152*  REMAINING AMOUNT 1 - CURRENT                                  *
  1153*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1154*  REMAINING AMOUNT FACTOR
  1155*----------------------------------------------------------------*
  1156*  PASSED TO ELRESV                                              *
  1157*  -----------------                                             *
  1158*  CERTIFICATE EFFECTIVE DATE                                    *
  1159*  VALUATION DATE                                                *
  1160*  PAID THRU DATE                                                *
  1161*  BENEFIT                                                       *
  1162*  INCURRED DATE                                                 *
  1163*  REPORTED DATE                                                 *
  1164*  ISSUE AGE                                                     *
  1165*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  24
* EL156.cbl
  1166*  CDT PERCENT                                                   *
  1167*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1168* *CLAIM TYPE (LIFE, A/H)                                        *
  1169* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1170* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1171*                                                                *
  1172*  RETURNED FROM ELRESV                                          *
  1173*  --------------------                                          *
  1174*  CDT TABLE USED                                                *
  1175*  CDT FACTOR USED                                               *
  1176*  PAY TO CURRENT RESERVE                                        *
  1177*  I.B.N.R. - A/H ONLY                                           *
  1178*  FUTURE (ACCRUED) AH ONLY                                      *
  1179*----------------------------------------------------------------*
  1180*  PASSED TO ELRATE                                              *
  1181*  ----------------                                              *
  1182*  CERT ISSUE DATE                                               *
  1183*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1184*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1185*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1186*  STATE CODE (CLIENT DEFINED)                                   *
  1187*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1188*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1189*  DEVIATION CODE                                                *
  1190*  ISSUE AGE                                                     *
  1191*  ORIGINAL BENEFIT AMOUNT                                       *
  1192*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1193*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1194*  BENEFIT KIND (LIFE OR A/H)                                    *
  1195*  A.P.R.                                                        *
  1196*  METHOD
  1197*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1198*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1199*  COMPANY I.D. (3 CHARACTER)                                    *
  1200*  BENEFIT CODE                                                  *
  1201*  BENEFIT OVERRIDE CODE                                         *
  1202*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1203*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1204*  JOINT INDICATOR (CSL ONLY)                                    *
  1205*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1206*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1207*                                                                *
  1208*  RETURNED FROM ELRATE                                          *
  1209*  --------------------                                          *
  1210*  CALCULATED PREMIUM                                            *
  1211*  PREMIUM RATE                                                  *
  1212*  MORTALITY CODE                                                *
  1213*  MAX ATTAINED AGE                                              *
  1214*  MAX AGE                                                       *
  1215*  MAX TERM                                                      *
  1216*  MAX MONTHLY BENEFIT                                           *
  1217*  MAX TOTAL BENIFIT                                             *
  1218*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1219*----------------------------------------------------------------*
  1220*  PASSED TO ELRFND                                              *
  1221*  ----------------                                              *
  1222*  CERT ISSUE DATE                                               *
  1223*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  25
* EL156.cbl
  1224*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1225*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1226*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1227*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1228*  STATE CODE (CLIENT DEFINED)                                   *
  1229*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1230*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1231*  DEVIATION CODE                                                *
  1232*  ISSUE AGE                                                     *
  1233*  ORIGINAL BENEFIT AMOUNT                                       *
  1234*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1235*  PROCESS TYPE (CANCEL)                                         *
  1236*  BENEFIT KIND (LIFE OR A/H)                                    *
  1237*  A.P.R.                                                        *
  1238*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1239*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1240*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1241*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1242*  COMPANY I.D. (3 CHARACTER)                                    *
  1243*  BENEFIT CODE                                                  *
  1244*  BENEFIT OVERRIDE CODE                                         *
  1245*                                                                *
  1246*  RETURNED FROM ELRFND                                          *
  1247*  --------------------                                          *
  1248*  CALCULATED REFUND                                             *
  1249*----------------------------------------------------------------*
  1250*  PASSED TO ELEARN                                              *
  1251*  ----------------                                              *
  1252*  CERT ISSUE DATE                                               *
  1253*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1254*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1255*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1256*  STATE CODE (CLIENT DEFINED)                                   *
  1257*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1258*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1259*  DEVIATION CODE                                                *
  1260*  ISSUE AGE                                                     *
  1261*  ORIGINAL BENEFIT AMOUNT                                       *
  1262*  BENEFIT KIND (LIFE OR A/H)                                    *
  1263*  A.P.R.                                                        *
  1264*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1265*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1266*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1267*  COMPANY I.D. (3 CHARACTER)                                    *
  1268*  BENEFIT CODE                                                  *
  1269*  BENEFIT OVERRIDE CODE                                         *
  1270*                                                                *
  1271*  RETURNED FROM ELEARN                                          *
  1272*  --------------------                                          *
  1273*  INDICATED  EARNINGS                                           *
  1274*----------------------------------------------------------------*
  1275*                 LENGTH = 450                                   *
  1276*                                                                *
  1277******************************************************************
  1278******************************************************************
  1279*                   C H A N G E   L O G
  1280*
  1281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  26
* EL156.cbl
  1282*-----------------------------------------------------------------
  1283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1284* EFFECTIVE    NUMBER
  1285*-----------------------------------------------------------------
  1286* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1287* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1288* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1289* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1290* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1291* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1292* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1293* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1294* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1295******************************************************************
  1296
  1297 01  CALCULATION-PASS-AREA.
  1298     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1299                                     COMP.
  1300
  1301     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1302       88  NO-CP-ERROR                             VALUE ZERO.
  1303       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1304                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1305       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1306       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1307       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1308       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1309       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1310       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1311       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1312       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1313       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1314       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1315       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1316       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1317       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1318       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1319       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1320       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1321       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1322
  1323     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1324       88  NO-CP-ERROR-2                           VALUE ZERO.
  1325***********************  INPUT AREAS ****************************
  1326
  1327     12  CP-CALCULATION-AREA.
  1328         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1329         16  CP-CERT-EFF-DT        PIC XX.
  1330         16  CP-VALUATION-DT       PIC XX.
  1331         16  CP-PAID-THRU-DT       PIC XX.
  1332         16  CP-BENEFIT-TYPE       PIC X.
  1333           88  CP-AH                               VALUE 'A' 'D'
  1334                                                   'I' 'U'.
  1335           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1336           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1337         16  CP-INCURRED-DT        PIC XX.
  1338         16  CP-REPORTED-DT        PIC XX.
  1339         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  27
* EL156.cbl
  1340         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1341         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1342                                     COMP-3.
  1343         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1344                                     COMP-3.
  1345         16  CP-CDT-METHOD         PIC X.
  1346           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1347           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1348           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1349         16  CP-CLAIM-TYPE         PIC X.
  1350           88  CP-AH-CLAIM                         VALUE 'A'.
  1351           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1352         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1353                                     COMP-3.
  1354         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1355                                     COMP-3.
  1356         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1357                                     COMP-3.
  1358         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1359                                     COMP-3.
  1360         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1361                                     COMP-3.
  1362         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1363                                     COMP-3.
  1364         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1365                                     COMP-3.
  1366         16  CP-REM-TERM-METHOD    PIC X.
  1367           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1368           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1369           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1370           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1371           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1372           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1373           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1374         16  CP-EARNING-METHOD     PIC X.
  1375           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1376           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1377           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1378           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1379           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1380           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1381           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1382           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1383           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1384           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1385           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1386           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1387           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1388           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1389         16  CP-PROCESS-TYPE       PIC X.
  1390           88  CP-CLAIM                            VALUE '1'.
  1391           88  CP-CANCEL                           VALUE '2'.
  1392           88  CP-ISSUE                            VALUE '3'.
  1393         16  CP-SPECIAL-CALC-CD    PIC X.
  1394           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1395           88  CP-1-MTH-INTEREST               VALUE ' '.
  1396           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1397           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  28
* EL156.cbl
  1398           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1399           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1400           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1401           88  CP-FARM-PLAN                    VALUE 'F'.
  1402           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1403           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1404           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1405           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1406           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1407           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1408           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1409           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1410           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1411           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1412                                                     'W' 'X'.
  1413           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1414           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1415           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1416           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1417           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1418           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1419           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1420           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1421           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1422           88  CP-CSL-METH-1                   VALUE '5'.
  1423           88  CP-CSL-METH-2                   VALUE '6'.
  1424           88  CP-CSL-METH-3                   VALUE '7'.
  1425           88  CP-CSL-METH-4                   VALUE '8'.
  1426
  1427         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1428                                     COMP-3.
  1429         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1430         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1431         16  CP-STATE              PIC XX          VALUE SPACE.
  1432         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1433         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1434           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1435               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1436         16  CP-R78-OPTION         PIC X.
  1437           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1438           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1439
  1440         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1441         16  CP-IBNR-RESERVE-SW    PIC X.
  1442         16  CP-CLAIM-STATUS       PIC X.
  1443         16  CP-RATE-FILE          PIC X.
  1444         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1445                                     COMP-3.
  1446
  1447         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1448         16  CP-AH-OVERRIDE-CODE   PIC X.
  1449
  1450         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1451                                     COMP-3.
  1452         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1453                                   PIC S9(5)V99 COMP-3.
  1454         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1455                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  29
* EL156.cbl
  1456         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1457                                     COMP-3.
  1458         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1459                                     COMP-3.
  1460         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1461                                  PIC S9(7)V99 COMP-3.
  1462
  1463         16  CP-PAID-FROM-DATE     PIC X(02).
  1464         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1465         16  CP-EXT-DAYS-CALC      PIC X.
  1466           88  CP-EXT-NO-CHG                   VALUE ' '.
  1467           88  CP-EXT-CHG-LF                   VALUE '1'.
  1468           88  CP-EXT-CHG-AH                   VALUE '2'.
  1469           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1470         16  CP-DOMICILE-STATE     PIC XX.
  1471         16  CP-CARRIER            PIC X.
  1472         16  CP-REIN-FLAG          PIC X.
  1473         16  CP-REM-TRM-CALC-OPTION PIC X.
  1474           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1475                      '2' '3' '4' '5'.
  1476           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1477           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1478           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1479           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1480           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1481           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1482           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1483           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1484         16  CP-SIG-SWITCH         PIC X.
  1485         16  CP-RATING-METHOD      PIC X.
  1486           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1487           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1488           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1489           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1490           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1491           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1492           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1493           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1494           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1495         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1496                                     COMP-3.
  1497         16  CP-BEN-CATEGORY       PIC X.
  1498         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1499         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1500                                   PIC S99V9(5) COMP-3.
  1501         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1502         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1503                                   PIC S99V9(5) COMP-3.
  1504         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1505         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1506         16  CP-EXPIRE-DT          PIC XX.
  1507         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1508         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1509         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1510         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1511         16  CP-DDF-SPEC-CALC      PIC X.
  1512             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1513             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  30
* EL156.cbl
  1514         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1515         16  CP-CANCEL-REASON      PIC X.
  1516         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1517         16  CP-PMT-MODE           PIC X.
  1518         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1519         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1520         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1521         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1522         16  FILLER                PIC X.
  1523
  1524***************    OUTPUT FROM ELRESV   ************************
  1525
  1526         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1527
  1528         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1529                                     COMP-3.
  1530         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1531                                     COMP-3.
  1532         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1533                                     COMP-3.
  1534         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1535                                     COMP-3.
  1536         16  FILLER                PIC X(09).
  1537***************    OUTPUT FROM ELRTRM   *************************
  1538
  1539         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1540                                     COMP-3.
  1541         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1542                                     COMP-3.
  1543         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1544                                     COMP-3.
  1545         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1546                                     COMP-3.
  1547         16  FILLER                PIC X(12).
  1548
  1549***************    OUTPUT FROM ELRAMT   *************************
  1550
  1551         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1552                                     COMP-3.
  1553         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1554                                     COMP-3.
  1555         16  FILLER                PIC X(12).
  1556
  1557***************    OUTPUT FROM ELRATE   *************************
  1558
  1559         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1560                                     COMP-3.
  1561         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1562                                     COMP-3.
  1563         16  CP-MORTALITY-CODE     PIC X(4).
  1564         16  CP-RATE-EDIT-FLAG     PIC X.
  1565             88  CP-RATES-NEED-APR                  VALUE '1'.
  1566         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1567                                     COMP-3.
  1568         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1569         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1570         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1571                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  31
* EL156.cbl
  1572         16  FILLER                PIC X(07).
  1573
  1574***************    OUTPUT FROM ELRFND   *************************
  1575
  1576         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1577                                     COMP-3.
  1578         16  CP-REFUND-TYPE-USED   PIC X.
  1579           88  CP-R-AS-R78                         VALUE '1'.
  1580           88  CP-R-AS-PRORATA                     VALUE '2'.
  1581           88  CP-R-AS-CALIF                       VALUE '3'.
  1582           88  CP-R-AS-TEXAS                       VALUE '4'.
  1583           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1584           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1585           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1586           88  CP-R-AS-MEAN                        VALUE '8'.
  1587           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1588           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1589           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1590           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1591           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1592           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1593         16  FILLER                PIC X(12).
  1594
  1595***************    OUTPUT FROM ELEARN   *************************
  1596
  1597         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1598                                     COMP-3.
  1599         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1600                                     COMP-3.
  1601         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1602                                     COMP-3.
  1603         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1604                                     COMP-3.
  1605         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1606                                     COMP-3.
  1607         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1608                                     COMP-3.
  1609         16  CP-EARNING-TYPE-USED  PIC X.
  1610           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1611           88  CP-E-AS-R78                         VALUE '1'.
  1612           88  CP-E-AS-PRORATA                     VALUE '2'.
  1613           88  CP-E-AS-TEXAS                       VALUE '4'.
  1614           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1615           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1616           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1617           88  CP-E-AS-MEAN                        VALUE '8'.
  1618           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1619         16  FILLER                PIC X(12).
  1620
  1621***************    OUTPUT FROM ELPMNT   *************************
  1622
  1623         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1624                                     COMP-3.
  1625         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1626                                     COMP-3.
  1627         16  FILLER                PIC X(12).
  1628
  1629***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  32
* EL156.cbl
  1630         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1631                                     COMP-3.
  1632         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1633                                     COMP-3.
  1634         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1635                                     COMP-3.
  1636         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1637                                     COMP-3.
  1638         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1639                                     COMP-3.
  1640         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1641                                     COMP-3.
  1642         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1643             88  OPEN-RATE-FILE                   VALUE 'O'.
  1644             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1645             88  IO-ERROR                         VALUE 'E'.
  1646
  1647         16  CP-FIRST-PAY-DATE     PIC XX.
  1648
  1649         16  CP-JOINT-INDICATOR    PIC X.
  1650
  1651         16  CP-RESERVE-REMAINING-TERM
  1652                                   PIC S9(4)V9    VALUE ZERO
  1653                                     COMP-3.
  1654
  1655         16  CP-INSURED-BIRTH-DT   PIC XX.
  1656
  1657         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1658                                     COMP-3.
  1659
  1660         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1661                                     COMP-3.
  1662
  1663         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1664                                     COMP-3.
  1665
  1666         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1667                                     COMP-3.
  1668
  1669         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1670                                     COMP-3.
  1671
  1672         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1673                                     COMP-3.
  1674
  1675         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1676                                     COMP-3.
  1677
  1678         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1679             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1680
  1681         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1682                                     COMP-3.
  1683         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1684                                     COMP-3.
  1685         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1686         16  FILLER                PIC X(15).
  1687******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  33
* EL156.cbl
  1688*    COPY ELCICALC.
  1689******************************************************************
  1690*                                                                *
  1691*                           ELCCICALC.                           *
  1692*                            VMOD=2.001                          *
  1693*                                                                *
  1694*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1695*                 CALCULATION MODULE                             *
  1696*                                                                *
  1697*  PASSED TO ELCLMI                                              *
  1698*  -----------------                                             *
  1699*  STATE                                                         *
  1700*  PRODUCT                                                       *
  1701*  COVERAGE                                                      *
  1702*  EFFECTIVE DATE                                                *
  1703*  INCURRED DATE                                                 *
  1704*  ESTABLISHED DATE                                              *
  1705*  LAST PAID DATE                                                *
  1706*  REPORTED DATE                                                 *
  1707*  CLAIM PAYMENT AMOUNT                                          *
  1708*                                                                *
  1709*  RETURNED FROM ELRTRM                                          *
  1710*  ---------------------                                         *
  1711*  RETURN CODE                                                   *
  1712*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1713*  CLAIM INTEREST AMOUNT                                         *
  1714*----------------------------------------------------------------*
  1715*----------------------------------------------------------------*
  1716*                 LENGTH = 100                                   *
  1717*                                                                *
  1718******************************************************************
  1719******************************************************************
  1720*                   C H A N G E   L O G
  1721*
  1722* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1723*-----------------------------------------------------------------
  1724*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1725* EFFECTIVE    NUMBER
  1726*-----------------------------------------------------------------
  1727* 120905    2004040700004  PEMA  NEW COPYBOOK
  1728* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1729******************************************************************
  1730
  1731 01  CLAIM-INT-PASS-AREA.
  1732     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1733                                     COMP.
  1734
  1735     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1736       88  NO-CI-ERROR                             VALUE ZERO.
  1737       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1738       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1739       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1740       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1741       88  CP-AMT-LT-5000                          VALUE '4'.
  1742       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1743       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1744       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1745       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  34
* EL156.cbl
  1746***********************  INPUT AREAS ****************************
  1747
  1748     12  CP-CALCULATION-AREA.
  1749         16  CP-COMPANY-CD         PIC X.
  1750         16  CP-STATE              PIC XX.
  1751         16  CP-PRODUCT            PIC XX.
  1752         16  CP-COVERAGE           PIC XX.
  1753         16  CP-INC-DT             PIC XX.
  1754         16  CP-EST-DT             PIC XX.
  1755         16  CP-LSTPD-DT           PIC XX.
  1756         16  CP-RPT-DT             PIC XX.
  1757         16  CP-PRF-DT             PIC XX.
  1758         16  CP-EFF-DT             PIC XX.
  1759         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1760         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1761         16  FILLER                PIC X(37).
  1762
  1763***************    OUTPUT FROM ELCLMI   ************************
  1764
  1765         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1766
  1767         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1768         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1769         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1770         16  FILLER                PIC X(19).
  1771******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  35
* EL156.cbl
  1773*    COPY ELCATTR.
  1774******************************************************************
  1775*                                                                *
  1776*                            ELCATTR.                            *
  1777*                            VMOD=2.001                          *
  1778*                                                                *
  1779*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1780*                                                                *
  1781*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1782*                                                                *
  1783*                   POS 1   P=PROTECTED                          *
  1784*                           U=UNPROTECTED                        *
  1785*                           S=ASKIP                              *
  1786*                   POS 2   A=ALPHA/NUMERIC                      *
  1787*                           N=NUMERIC                            *
  1788*                   POS 3   N=NORMAL                             *
  1789*                           B=BRIGHT                             *
  1790*                           D=DARK                               *
  1791*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1792*                           OF=MODIFIED DATA TAG OFF             *
  1793*                                                                *
  1794*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1795******************************************************************
  1796 01  ATTRIBUTE-LIST.
  1797     12  AL-PABOF            PIC X       VALUE 'Y'.
  1798     12  AL-PABON            PIC X       VALUE 'Z'.
  1799     12  AL-PADOF            PIC X       VALUE '%'.
  1800     12  AL-PADON            PIC X       VALUE '_'.
  1801     12  AL-PANOF            PIC X       VALUE '-'.
  1802     12  AL-PANON            PIC X       VALUE '/'.
  1803     12  AL-SABOF            PIC X       VALUE '8'.
  1804     12  AL-SABON            PIC X       VALUE '9'.
  1805     12  AL-SADOF            PIC X       VALUE '@'.
  1806     12  AL-SADON            PIC X       VALUE QUOTE.
  1807     12  AL-SANOF            PIC X       VALUE '0'.
  1808     12  AL-SANON            PIC X       VALUE '1'.
  1809     12  AL-UABOF            PIC X       VALUE 'H'.
  1810     12  AL-UABON            PIC X       VALUE 'I'.
  1811     12  AL-UADOF            PIC X       VALUE '<'.
  1812     12  AL-UADON            PIC X       VALUE '('.
  1813     12  AL-UANOF            PIC X       VALUE ' '.
  1814     12  AL-UANON            PIC X       VALUE 'A'.
  1815     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1816     12  AL-UNBON            PIC X       VALUE 'R'.
  1817     12  AL-UNDOF            PIC X       VALUE '*'.
  1818     12  AL-UNDON            PIC X       VALUE ')'.
  1819     12  AL-UNNOF            PIC X       VALUE '&'.
  1820     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  36
* EL156.cbl
  1822*    COPY ELCEMIB.
  1823******************************************************************
  1824*                                                                *
  1825*                                                                *
  1826*                            ELCEMIB.                            *
  1827*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1828*                            VMOD=2.005                          *
  1829*                                                                *
  1830*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1831*                                                                *
  1832******************************************************************
  1833 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1834     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1835     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1836     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1837     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1838     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1839     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1840     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1841     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1842     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1843         88  EMI-NO-ERRORS                    VALUE '1'.
  1844         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1845         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1846     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1847         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1848     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1849         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1850         88  EMI-AREA1-FULL                   VALUE '2'.
  1851     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1852         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1853         88  EMI-AREA2-FULL                   VALUE '2'.
  1854     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1855         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1856         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1857         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1858         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1859         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1860     12  EMI-ERROR-LINES.
  1861         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1862         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1863         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1864         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1865             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1866                 24  EMI-ERR-NUM         PIC X(4).
  1867                 24  EMI-FILLER          PIC X.
  1868                 24  EMI-SEV             PIC X.
  1869                 24  FILLER              PIC X.
  1870             20  FILLER                  PIC X(02).
  1871     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1872         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1873             20  EMI-ERROR-NUMBER    PIC X(4).
  1874             20  EMI-FILL            PIC X.
  1875             20  EMI-SEVERITY        PIC X.
  1876             20  FILLER              PIC X.
  1877             20  EMI-ERROR-TEXT.
  1878                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1879                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  37
* EL156.cbl
  1880     12  EMI-SEVERITY-SAVE           PIC X.
  1881         88  EMI-NOTE                    VALUE 'N'.
  1882         88  EMI-WARNING                 VALUE 'W'.
  1883         88  EMI-FORCABLE                VALUE 'F'.
  1884         88  EMI-FATAL                   VALUE 'X'.
  1885     12  EMI-MESSAGE-FLAG            PIC X.
  1886         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1887         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1888     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1889     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1890         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1891         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1892         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1893     12  emi-claim-no                pic x(7).
  1894     12  emi-claim-type              pic x(6).
  1895     12  FILLER                      PIC X(124)  VALUE SPACES.
  1896     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1897     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1898     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1899     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  38
* EL156.cbl
  1901*    COPY ELCLNKLT.
  1902******************************************************************
  1903*                                                                *
  1904*                                                                *
  1905*                           ELCLNKLT                             *
  1906*                            VMOD=2.003                          *
  1907*                                                                *
  1908*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1909*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1910*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1911*                                                                *
  1912*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1913*   COMPLETING THE REQUIRED FIELDS.                              *
  1914*                                                                *
  1915*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1916*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1917*                              9999 INDICATES AN UNKNOWN ABEND   *
  1918*                                   WAS DETECTED.                *
  1919*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1920*                              CODES FOUND IN THE ERROR FILE.    *
  1921******************************************************************
  1922 01  W-1523-LINKDATA.
  1923     12  W-1523-COMMON-PI-DATA.
  1924         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1925         16  FILLER              PIC  X(67).
  1926         16  W-1523-COMPANY-CD   PIC  X(01).
  1927         16  FILLER              PIC  X(10).
  1928         16  W-1523-CONTROL-IN-PROGRESS.
  1929             20  W-1523-CARRIER  PIC  X(01).
  1930             20  W-1523-GROUPING PIC  X(06).
  1931             20  W-1523-STATE    PIC  X(02).
  1932             20  W-1523-ACCOUNT  PIC  X(10).
  1933             20  W-1523-CLAIM-CERT-GRP.
  1934                 24  W-1523-CLAIM-NO
  1935                                 PIC  X(07).
  1936                 24  W-1523-CERT-NO.
  1937                     28  W-1523-CERT-PRIME
  1938                                 PIC  X(10).
  1939                     28  W-1523-CERT-SFX
  1940                                 PIC  X(01).
  1941                 24  W-1523-CERT-EFF-DT
  1942                                 PIC  X(02).
  1943         16  FILLER              PIC X(265).
  1944
  1945     12  W-1523-WORK-AREA.
  1946         16  W-1523-FORM-NUMBER  PIC  X(04).
  1947         16  W-1523-NUMBER-COPIES
  1948                                 PIC  9(01).
  1949         16  W-1523-ADDR-TYPE    PIC  X(02).
  1950         16  W-1523-FOLLOW-UP-DATE
  1951                                 PIC  X(02).
  1952         16  W-1523-RESEND-DATE  PIC  X(02).
  1953         16  W-1523-ERROR-CODE   PIC  9(04).
  1954             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1955             88  W-1523-FATAL-ERROR
  1956                                    VALUES  0006 0013 0042
  1957                                            0154 0168 0169
  1958                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  39
* EL156.cbl
  1959                                            0179 0186 0281
  1960                                            0332 2055 3697
  1961                                            3698 3699 3770
  1962                                            3771 3772 7675
  1963                                            9106 9808 9883
  1964                                            9887.
  1965             88  W-1523-STOP-ERRORS
  1966                                    VALUES  0013 0042 0154
  1967                                            0168 0169 0172
  1968                                            0281 0332 2055
  1969                                            3698 3699 7675
  1970                                            9106 9808 9883
  1971                                            9999.
  1972         16  W-1523-REASON       PIC  X(70).
  1973         16  W-1523-ARCHIVE-NUMBER
  1974                                 PIC  9(08).
  1975     12  W-1523-POINTER-AREA.
  1976         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1977         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1978         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1979         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1980         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  40
* EL156.cbl
  1982*    COPY ELCNWA.
  1983*****************************************************************
  1984*                                                               *
  1985*                                                               *
  1986*                            ELCNWA.                            *
  1987*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1988*                            VMOD=2.003                         *
  1989*                                                               *
  1990*            M O V E   N A M E   W O R K   A R E A.             *
  1991*                                                               *
  1992*****************************************************************.
  1993
  1994 01  WS-NAME-WORK-AREA.
  1995     05  WS-INSURED-LAST-NAME        PIC X(15).
  1996     05  WS-INSURED-1ST-NAME         PIC X(12).
  1997     05  WS-INSURED-MID-INIT         PIC X.
  1998
  1999     05  WS-NAME-WORK.
  2000         10  WS-NW                   PIC X
  2001             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2002
  2003     05  WS-NAME-WORK2.
  2004         10  WS-NW2                  PIC X
  2005             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2006                                        NWA-INDEX0.
  2007
  2008     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2009                                     COMP-3.
  2010
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  41
* EL156.cbl
  2012*    COPY ELCDMO.
  2013******************************************************************
  2014*                                                                *
  2015*                                                                *
  2016*                            ELCDMO.                             *
  2017*                            VMOD=2.004                          *
  2018*                                                                *
  2019*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2020*        COMMUNICATION AREA                                      *
  2021*   FILE TYPE = NA                                               *
  2022*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2023*                                                                *
  2024******************************************************************
  2025 01  DMO-COMMUNICATION-AREA.
  2026     12  DM-RECORD-TYPE                  PIC  X(02).
  2027             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2028             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2029             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2030     12  DM-DIST-CODE                    PIC  X(04).
  2031     12  DM-MAIL-CODE                    PIC  X(05).
  2032     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2033     12  DM-INSURED-NAME                 PIC  X(30).
  2034     12  DM-CLAIM-NO                     PIC  X(07).
  2035     12  DM-CLAIM-TYPE                   PIC  X.
  2036
  2037     12  DM-STATUS-DATA-AREA.
  2038         16  DM-CLAIM-STATUS             PIC  X.
  2039             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2040             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2041             88  DM-CLOSED                        VALUE '3'.
  2042             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2043             88  DM-DEFAULT                       VALUE '9'.
  2044         16  DM-STATUS-DATE              PIC  X(08).
  2045******YYYYMMDD
  2046         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2047             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2048             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2049             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2050             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2051             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2052             88  DM-RE-OPENED                     VALUE 'R'.
  2053             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2054             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2055             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2056         16  DM-STAT-CARRIER             PIC X.
  2057
  2058     12  DM-DRAFT-DATA-AREA.
  2059         16  DM-PAYMENT-TYPE             PIC  X.
  2060             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2061         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2062         16  DM-PAYMENT-DATE             PIC  X(08).
  2063******YYYYMMDD
  2064         16  DM-CERT-NO                  PIC  X(11).
  2065         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2066         16  DM-CARRIER                  PIC  X.
  2067
  2068     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  42
* EL156.cbl
  2070*    COPY ELCDMDCD.
  2071******************************************************************
  2072*                                                                *
  2073*                                                                *
  2074*                            ELCDMDCD.                           *
  2075*                            VMOD=2.001                          *
  2076*                                                                *
  2077*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2078*       COMMUNICATIONS AREA                                      *
  2079*                                                                *
  2080******************************************************************
  2081 01  CD-COMMUNICATION-AREA.
  2082     12  CD-SYSTEM-ID            PIC  X(02).
  2083         88 CD-CLAIMS                      VALUE 'CL'.
  2084         88 CD-CREDIT                      VALUE 'CR'.
  2085     12  CD-RECORD-TYPE          PIC  X(02).
  2086         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2087         88 CD-EOB-CODE                    VALUE 'EO'.
  2088         88 CD-ICD9-CODE                   VALUE 'I9'.
  2089         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2090         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2091         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2092         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2093         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2094     12  CD-RECORD-KEY           PIC  X(06).
  2095         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2096     12  CD-RETURN-CODE          PIC  X(02).
  2097     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2098     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2099     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2100     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  43
* EL156.cbl
  2102*    COPY ELCDCTB.
  2103******************************************************************
  2104*                                                                *
  2105*                                                                *
  2106*                            ELCDCTB.                            *
  2107*                            VMOD=2.002                          *
  2108*                                                                *
  2109*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2110*       COMMUNICATIONS AREA                                      *
  2111*                                                                *
  2112******************************************************************
  2113 01  DCT-COMMUNICATION-AREA.
  2114     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2115     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2116     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2117     12  DCT-PRODUCT-CODE         PIC  X(02).
  2118     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2119     12  DCT-RETURN-CODE          PIC  X(02).
  2120     12  DCT-MAIL-CODE            PIC  X(05).
  2121     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2122     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  44
* EL156.cbl
  2124 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2125 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2126 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2127 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  45
* EL156.cbl
  2129*    COPY ELCINTF.
  2130******************************************************************
  2131*                                                                *
  2132*                                                                *
  2133*                            ELCINTF.                            *
  2134*                            VMOD=2.017                          *
  2135*                                                                *
  2136*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2137*                                                                *
  2138*       LENGTH = 1024                                            *
  2139*                                                                *
  2140******************************************************************
  2141*                   C H A N G E   L O G
  2142*
  2143* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2144*-----------------------------------------------------------------
  2145*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2146* EFFECTIVE    NUMBER
  2147*-----------------------------------------------------------------
  2148* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2149******************************************************************
  2150 01  PROGRAM-INTERFACE-BLOCK.
  2151     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2152     12  PI-CALLING-PROGRAM              PIC X(8).
  2153     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2154     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2155     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2156     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2157     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2158     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2159     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2160     12  PI-COMPANY-ID                   PIC XXX.
  2161     12  PI-COMPANY-CD                   PIC X.
  2162
  2163     12  PI-COMPANY-PASSWORD             PIC X(8).
  2164
  2165     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2166
  2167     12  PI-CONTROL-IN-PROGRESS.
  2168         16  PI-CARRIER                  PIC X.
  2169         16  PI-GROUPING                 PIC X(6).
  2170         16  PI-STATE                    PIC XX.
  2171         16  PI-ACCOUNT                  PIC X(10).
  2172         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2173                                         PIC X(10).
  2174         16  PI-CLAIM-CERT-GRP.
  2175             20  PI-CLAIM-NO             PIC X(7).
  2176             20  PI-CERT-NO.
  2177                 25  PI-CERT-PRIME       PIC X(10).
  2178                 25  PI-CERT-SFX         PIC X.
  2179             20  PI-CERT-EFF-DT          PIC XX.
  2180         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2181             20  PI-PLAN-CODE            PIC X(2).
  2182             20  PI-REVISION-NUMBER      PIC X(3).
  2183             20  PI-PLAN-EFF-DT          PIC X(2).
  2184             20  PI-PLAN-EXP-DT          PIC X(2).
  2185             20  FILLER                  PIC X(11).
  2186         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  46
* EL156.cbl
  2187             20  PI-OE-REFERENCE-1.
  2188                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2189                 25  PI-OE-REF-1-SUFF    PIC XX.
  2190
  2191     12  PI-SESSION-IN-PROGRESS          PIC X.
  2192         88  CLAIM-SESSION                   VALUE '1'.
  2193         88  CREDIT-SESSION                  VALUE '2'.
  2194         88  WARRANTY-SESSION                VALUE '3'.
  2195         88  MORTGAGE-SESSION                VALUE '4'.
  2196         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2197
  2198
  2199*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2200
  2201     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2202     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2203
  2204     12  PI-CREDIT-USER                  PIC X.
  2205         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2206         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2207
  2208     12  PI-CLAIM-USER                   PIC X.
  2209         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2210         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2211
  2212     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2213         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2214         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2215         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2216         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2217         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2218
  2219     12  PI-PROCESSOR-ID                 PIC X(4).
  2220
  2221     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2222
  2223     12  PI-MEMBER-CAPTION               PIC X(10).
  2224
  2225     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2226         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2227
  2228     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2229     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2230     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2231     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2232
  2233     12  PI-AH-OVERRIDE-L1               PIC X.
  2234     12  PI-AH-OVERRIDE-L2               PIC XX.
  2235     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2236     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2237
  2238     12  PI-NEW-SYSTEM                   PIC X(2).
  2239
  2240     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2241     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2242         88  PI-USES-PAID-TO                 VALUE '1'.
  2243     12  PI-CRDTCRD-SYSTEM.
  2244         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  47
* EL156.cbl
  2245             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2246             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2247         16  PI-CC-MONTH-END-DT          PIC XX.
  2248     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2249
  2250     12  PI-OE-REFERENCE-2.
  2251         16  PI-OE-REF-2-PRIME           PIC X(10).
  2252         16  PI-OE-REF-2-SUFF            PIC X.
  2253
  2254     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2255
  2256     12  PI-LANGUAGE-TYPE                PIC X.
  2257             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2258             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2259             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2260
  2261     12  PI-POLICY-LINKAGE-IND           PIC X.
  2262         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2263         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2264                                                   LOW-VALUES.
  2265
  2266     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2267     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2268         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2269         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2270
  2271     12  PI-PROCESSOR-CSR-IND            PIC X.
  2272         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2273         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2274
  2275     12  FILLER                          PIC X(3).
  2276
  2277     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2278
  2279     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2280         PI-SYSTEM-LEVEL.
  2281
  2282         16  PI-ENTRY-CODES.
  2283             20  PI-ENTRY-CD-1           PIC X.
  2284             20  PI-ENTRY-CD-2           PIC X.
  2285
  2286         16  PI-RETURN-CODES.
  2287             20  PI-RETURN-CD-1          PIC X.
  2288             20  PI-RETURN-CD-2          PIC X.
  2289
  2290         16  PI-UPDATE-STATUS-SAVE.
  2291             20  PI-UPDATE-BY            PIC X(4).
  2292             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2293
  2294         16  PI-LOWER-CASE-LETTERS       PIC X.
  2295             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2296
  2297*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2298*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2299*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2300
  2301         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2302             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  48
* EL156.cbl
  2303             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2304             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2305             88  ACCNT-CNTL                  VALUE '3'.
  2306             88  CARR-ACCNT-CNTL             VALUE '4'.
  2307
  2308         16  PI-PROCESSOR-CAP-LIST.
  2309             20  PI-SYSTEM-CONTROLS.
  2310                24 PI-SYSTEM-DISPLAY     PIC X.
  2311                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2312                24 PI-SYSTEM-MODIFY      PIC X.
  2313                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2314             20  FILLER                  PIC XX.
  2315             20  PI-DISPLAY-CAP          PIC X.
  2316                 88  DISPLAY-CAP             VALUE 'Y'.
  2317             20  PI-MODIFY-CAP           PIC X.
  2318                 88  MODIFY-CAP              VALUE 'Y'.
  2319             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2320                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2321             20  PI-FORCE-CAP            PIC X.
  2322                 88  FORCE-CAP               VALUE 'Y'.
  2323
  2324         16  PI-PROGRAM-CONTROLS.
  2325             20  PI-PGM-PRINT-OPT        PIC X.
  2326             20  PI-PGM-FORMAT-OPT       PIC X.
  2327             20  PI-PGM-PROCESS-OPT      PIC X.
  2328             20  PI-PGM-TOTALS-OPT       PIC X.
  2329
  2330         16  PI-HELP-INTERFACE.
  2331             20  PI-LAST-ERROR-NO        PIC X(4).
  2332             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2333
  2334         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2335             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2336
  2337         16  PI-CR-CONTROL-IN-PROGRESS.
  2338             20  PI-CR-CARRIER           PIC X.
  2339             20  PI-CR-GROUPING          PIC X(6).
  2340             20  PI-CR-STATE             PIC XX.
  2341             20  PI-CR-ACCOUNT           PIC X(10).
  2342             20  PI-CR-FIN-RESP          PIC X(10).
  2343             20  PI-CR-TYPE              PIC X.
  2344
  2345         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2346
  2347         16  PI-CR-MONTH-END-DT          PIC XX.
  2348
  2349         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2350             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2351             88  PI-ZERO-CARRIER             VALUE '1'.
  2352             88  PI-ZERO-GROUPING            VALUE '2'.
  2353             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2354
  2355         16  PI-CARRIER-SECURITY         PIC X.
  2356             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2357
  2358         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2359             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2360             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  49
* EL156.cbl
  2361
  2362         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2363             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2364                                         INDEXED BY PI-ACCESS-NDX
  2365                                         PIC X.
  2366
  2367         16  PI-GA-BILLING-CONTROL       PIC X.
  2368             88  PI-GA-BILLING               VALUE '1'.
  2369
  2370         16  PI-MAIL-PROCESSING          PIC X.
  2371             88  PI-MAIL-YES                 VALUE 'Y'.
  2372
  2373         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2374
  2375         16  PI-AR-SYSTEM.
  2376             20  PI-AR-PROCESSING-CNTL   PIC X.
  2377                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2378             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2379             20  PI-AR-MONTH-END-DT      PIC XX.
  2380
  2381         16  PI-MP-SYSTEM.
  2382             20  PI-MORTGAGE-USER            PIC X.
  2383                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2384                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2385             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2386                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2387                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2388                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2389                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2390                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2391             20  PI-MP-MONTH-END-DT          PIC XX.
  2392             20  PI-MP-REFERENCE-NO.
  2393                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2394                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2395
  2396         16  PI-LABEL-CONTROL            PIC X(01).
  2397             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2398             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2399
  2400         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2401             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2402
  2403         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2404             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2405             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2406
  2407         16  FILLER                      PIC X(14).
  2408
  2409     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2410******************************************************************
  2411     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2412         16  PI-SAVE-FORM        PIC X(12).
  2413         16  PI-ACCT-KEY         PIC X(26).
  2414         16  PI-PAYEE-NAME       PIC X(30).
  2415         16  PI-DAILY-RATE       PIC S9(3)V99.
  2416         16  PI-MONTH-END-SAVE   PIC XX.
  2417         16  PI-BENEFIT-SAVE.
  2418             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  50
* EL156.cbl
  2419             20  PI-BEN-TYPE     PIC X.
  2420         16  PI-MANUAL-SW        PIC 9.
  2421         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2422         16  PI-PASS-SW          PIC X.
  2423         16  PI-PFKEY-USED       PIC X.
  2424         16  PI-CK-ASSIGN        PIC X.
  2425         16  PI-FATAL-COUNT      PIC 99.
  2426         16  PI-FORCE-COUNT      PIC 99.
  2427         16  PI-SAVE-INPUT.
  2428             20  PI-PMTTYPE      PIC X.
  2429             20  PI-PAYEE.
  2430                 24  PI-PAYEE-TYPE PIC X.
  2431                 24  PI-PAYEE-SEQ  PIC X.
  2432                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2433                   PI-PAYEE-SEQ    PIC S9.
  2434             20  PI-PMTNOTE1     PIC X(60).
  2435             20  PI-PMTNOTE2     PIC X(60).
  2436             20  PI-OFFLINE      PIC X.
  2437             20  PI-ECHECKNO     PIC X(7).
  2438             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2439                 28  PI-ECHECKNO-N     PIC X.
  2440                 28  PI-ECHECKNO-6     PIC X(6).
  2441             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2442                 24  PI-ECHECKNO-CR    PIC XX.
  2443                 24  PI-ECHECKNO-5     PIC X(5).
  2444             20  PI-HOLDTIL      PIC 9(6).
  2445             20  PI-EPYFROM      PIC 9(6).
  2446             20  PI-EPYTHRU      PIC 9(6).
  2447             20  PI-EDAYS        PIC S9(5).
  2448             20  PI-EPYAMT       PIC S9(7)V99.
  2449             20  PI-ERESV        PIC S9(7)V99.
  2450             20  PI-EEXPENS      PIC 9(6)V99.
  2451             20  PI-ETYPE        PIC X.
  2452             20  PI-CASH         PIC X.
  2453             20  PI-GROUPED      PIC X.
  2454             20  PI-INT-RATE     PIC S99V9(5).
  2455             20  PI-AIGFROM      PIC 9(6).
  2456             20  PI-LOAN-NO      PIC X(20).
  2457             20  PI-PROOF-DATE   PIC 9(6).
  2458             20  PI-PRINT-EOB-YN PIC X.
  2459             20  PI-PRINT-CLM-FRM-YN PIC X.
  2460             20  PI-PRINT-SURVEY-YN PIC X.
  2461             20  PI-SPECIAL-RELEASE-YN PIC X.
  2462         16  PI-SAVE-COMPUTED.
  2463             20  PI-CCHECKNO     PIC X(7).
  2464             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2465                 28  PI-CCHECKNO-N     PIC X.
  2466                 28  PI-CCHECKNO-6     PIC X(6).
  2467             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2468                 24  PI-CCHECKNO-CR    PIC XX.
  2469                 24  PI-CCHECKNO-5     PIC X(5).
  2470             20  PI-CPYFROM      PIC XX.
  2471             20  PI-CPYTHRU      PIC XX.
  2472             20  PI-CDAYS        PIC S9(5).
  2473             20  PI-CPYAMT       PIC S9(7)V99.
  2474             20  PI-CRESV        PIC 9(6)V99.
  2475             20  PI-CEXPENS      PIC 9(6)V99.
  2476             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  51
* EL156.cbl
  2477                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2478                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2479                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2480         16  PI-PREV-CLMNO       PIC X(7).
  2481         16  PI-LF-COVERAGE-TYPE PIC X.
  2482         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2483         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2484         16  PI-PROVISIONAL-IND  PIC X.
  2485             88 PI-PROV-PMT      VALUE 'P'.
  2486         16  PI-PREV-TRLR-KEY    PIC X(22).
  2487         16  PI-SPLIT-PMT-SW     PIC X.
  2488         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2489         16  PI-ACTIVITY-CODE    PIC 99.
  2490         16  PI-RESET-SW         PIC X.
  2491         16  PI-SPECIAL-BEN-SW   PIC X.
  2492             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2493         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2494         16  PI-EXP-DT           PIC XX.
  2495         16  PI-LOAN-DUE-DAY     PIC 99.
  2496         16  PI-3RD-PARTY-SW     PIC X.
  2497         16  PI-LOAN-UPDATE-SW   PIC X.
  2498
  2499         16  PI-DMD-DATA.
  2500             20  PI-SV-CERT-KEY       PIC X(21).
  2501             20  PI-SV-CERT-NO        PIC X(11).
  2502             20  PI-SV-BEN            PIC X(10).
  2503             20  PI-SV-CCN            PIC X(16).
  2504             20  PI-INTEREST-PAID-IND PIC X.
  2505                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2506             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2507             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2508             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2509             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2510         16  PI-AT-EOB-CODES.
  2511             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2512         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2513         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2514         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2515         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2516         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2517         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2518         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2519         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2520         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2521         16  PI-LF-BENEFIT-CD         PIC X(2).
  2522         16  PI-EOB-CODES-EXIST PIC X.
  2523         16  PI-SET-NOTE2-MDT   PIC X.
  2524         16  PI-VFY-2ND-BENE          PIC X.
  2525         16  PI-CLM-TYPE              PIC X.
  2526         16  PI-APPROVAL-LEVEL        PIC X.
  2527         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2528         16  PI-REAUDIT-NEEDED        PIC X.
  2529         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2530         16  PI-AH-BENEFIT-CD         PIC XX.
  2531*00781          16  FILLER                   PIC X(176).
  2532*052506         16  FILLER                   PIC X(161).
  2533*031808         16  FILLER                   PIC X(154).
  2534*091808         16  FILLER                   PIC X(152).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  52
* EL156.cbl
  2535*041710         16  FILLER                   PIC X(94).
  2536         16  FILLER                   PIC X(81).
  2537
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  53
* EL156.cbl
  2539*    COPY ELCJPFX.
  2540******************************************************************
  2541*                                                                *
  2542*                                                                *
  2543*                            ELCJPFX.                            *
  2544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2545*                            VMOD=2.002                          *
  2546*                                                                *
  2547*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2548*                                                                *
  2549*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2550*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2551*        ELCNTL - CONTROL FILE                                   *
  2552*        ELMSTR - CLAIM MASTERS                                  *
  2553*        ELTRLR - ACTIVITY TRAILERS                              *
  2554*        ELCHKQ - CHECK QUE                                      *
  2555******************************************************************
  2556 01  JOURNAL-RECORD.
  2557     12  jp-date                     pic s9(5) comp-3.
  2558     12  jp-time                     pic s9(7) comp-3.
  2559     12  JP-USER-ID                  PIC X(4).
  2560     12  JP-FILE-ID                  PIC X(8).
  2561     12  JP-PROGRAM-ID               PIC X(8).
  2562     12  JP-RECORD-TYPE              PIC X.
  2563         88 JP-ADD              VALUE 'A'.
  2564         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2565         88 JP-AFTER-CHANGE     VALUE 'C'.
  2566         88 JP-DELETE           VALUE 'D'.
  2567         88 JP-GENERIC-DELETE   VALUE 'G'.
  2568         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2569         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2570     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2571     12  JP-RECORD-AREA
  2572
  2573
  2574                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  54
* EL156.cbl
  2576*    COPY ELCAID.
  2577******************************************************************
  2578*                                                                *
  2579*                            ELCAID.                             *
  2580*                            VMOD=2.001                          *
  2581*                                                                *
  2582*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2583*                                                                *
  2584*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2585*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2586******************************************************************
  2587
  2588 01  DFHAID.
  2589   02  DFHNULL   PIC  X  VALUE  ' '.
  2590   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2591   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2592   02  DFHPEN    PIC  X  VALUE  '='.
  2593   02  DFHOPID   PIC  X  VALUE  'W'.
  2594   02  DFHPA1    PIC  X  VALUE  '%'.
  2595   02  DFHPA2    PIC  X  VALUE  '>'.
  2596   02  DFHPA3    PIC  X  VALUE  ','.
  2597   02  DFHPF1    PIC  X  VALUE  '1'.
  2598   02  DFHPF2    PIC  X  VALUE  '2'.
  2599   02  DFHPF3    PIC  X  VALUE  '3'.
  2600   02  DFHPF4    PIC  X  VALUE  '4'.
  2601   02  DFHPF5    PIC  X  VALUE  '5'.
  2602   02  DFHPF6    PIC  X  VALUE  '6'.
  2603   02  DFHPF7    PIC  X  VALUE  '7'.
  2604   02  DFHPF8    PIC  X  VALUE  '8'.
  2605   02  DFHPF9    PIC  X  VALUE  '9'.
  2606   02  DFHPF10   PIC  X  VALUE  ':'.
  2607   02  DFHPF11   PIC  X  VALUE  '#'.
  2608   02  DFHPF12   PIC  X  VALUE  '@'.
  2609   02  DFHPF13   PIC  X  VALUE  'A'.
  2610   02  DFHPF14   PIC  X  VALUE  'B'.
  2611   02  DFHPF15   PIC  X  VALUE  'C'.
  2612   02  DFHPF16   PIC  X  VALUE  'D'.
  2613   02  DFHPF17   PIC  X  VALUE  'E'.
  2614   02  DFHPF18   PIC  X  VALUE  'F'.
  2615   02  DFHPF19   PIC  X  VALUE  'G'.
  2616   02  DFHPF20   PIC  X  VALUE  'H'.
  2617   02  DFHPF21   PIC  X  VALUE  'I'.
  2618*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2619   02  DFHPF22   PIC  X  VALUE  '['.
  2620   02  DFHPF23   PIC  X  VALUE  '.'.
  2621   02  DFHPF24   PIC  X  VALUE  '<'.
  2622   02  DFHMSRE   PIC  X  VALUE  'X'.
  2623   02  DFHSTRF   PIC  X  VALUE  'h'.
  2624   02  DFHTRIG   PIC  X  VALUE  '"'.
  2625 01  FILLER    REDEFINES DFHAID.
  2626     12  FILLER              PIC X(8).
  2627     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  55
* EL156.cbl
  2629*    COPY EL156S.
  2630 01  EL156AI.
  2631     05  FILLER            PIC  X(0012).
  2632*    -------------------------------
  2633     05  RUNDTEAL PIC S9(0004) COMP.
  2634     05  RUNDTEAF PIC  X(0001).
  2635     05  FILLER REDEFINES RUNDTEAF.
  2636         10  RUNDTEAA PIC  X(0001).
  2637     05  RUNDTEAI PIC  X(0008).
  2638*    -------------------------------
  2639     05  RUNTIMAL PIC S9(0004) COMP.
  2640     05  RUNTIMAF PIC  X(0001).
  2641     05  FILLER REDEFINES RUNTIMAF.
  2642         10  RUNTIMAA PIC  X(0001).
  2643     05  RUNTIMAI PIC  X(0005).
  2644*    -------------------------------
  2645     05  SEQUL PIC S9(0004) COMP.
  2646     05  SEQUF PIC  X(0001).
  2647     05  FILLER REDEFINES SEQUF.
  2648         10  SEQUA PIC  X(0001).
  2649     05  SEQUI PIC  X(0010).
  2650*    -------------------------------
  2651     05  CLMNOL PIC S9(0004) COMP.
  2652     05  CLMNOF PIC  X(0001).
  2653     05  FILLER REDEFINES CLMNOF.
  2654         10  CLMNOA PIC  X(0001).
  2655     05  CLMNOI PIC  X(0007).
  2656*    -------------------------------
  2657     05  CARRL PIC S9(0004) COMP.
  2658     05  CARRF PIC  X(0001).
  2659     05  FILLER REDEFINES CARRF.
  2660         10  CARRA PIC  X(0001).
  2661     05  CARRI PIC  X(0001).
  2662*    -------------------------------
  2663     05  CERTNOL PIC S9(0004) COMP.
  2664     05  CERTNOF PIC  X(0001).
  2665     05  FILLER REDEFINES CERTNOF.
  2666         10  CERTNOA PIC  X(0001).
  2667     05  CERTNOI PIC  X(0010).
  2668*    -------------------------------
  2669     05  SUFXL PIC S9(0004) COMP.
  2670     05  SUFXF PIC  X(0001).
  2671     05  FILLER REDEFINES SUFXF.
  2672         10  SUFXA PIC  X(0001).
  2673     05  SUFXI PIC  X(0001).
  2674*    -------------------------------
  2675     05  CLMTYPL PIC S9(0004) COMP.
  2676     05  CLMTYPF PIC  X(0001).
  2677     05  FILLER REDEFINES CLMTYPF.
  2678         10  CLMTYPA PIC  X(0001).
  2679     05  CLMTYPI PIC  X(0006).
  2680*    -------------------------------
  2681     05  CLMSTATL PIC S9(0004) COMP.
  2682     05  CLMSTATF PIC  X(0001).
  2683     05  FILLER REDEFINES CLMSTATF.
  2684         10  CLMSTATA PIC  X(0001).
  2685     05  CLMSTATI PIC  X(0006).
  2686*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  56
* EL156.cbl
  2687     05  LSTNMEL PIC S9(0004) COMP.
  2688     05  LSTNMEF PIC  X(0001).
  2689     05  FILLER REDEFINES LSTNMEF.
  2690         10  LSTNMEA PIC  X(0001).
  2691     05  LSTNMEI PIC  X(0015).
  2692*    -------------------------------
  2693     05  FSTNMEL PIC S9(0004) COMP.
  2694     05  FSTNMEF PIC  X(0001).
  2695     05  FILLER REDEFINES FSTNMEF.
  2696         10  FSTNMEA PIC  X(0001).
  2697     05  FSTNMEI PIC  X(0012).
  2698*    -------------------------------
  2699     05  MINITL PIC S9(0004) COMP.
  2700     05  MINITF PIC  X(0001).
  2701     05  FILLER REDEFINES MINITF.
  2702         10  MINITA PIC  X(0001).
  2703     05  MINITI PIC  X(0001).
  2704*    -------------------------------
  2705     05  PRIMHDGL PIC S9(0004) COMP.
  2706     05  PRIMHDGF PIC  X(0001).
  2707     05  FILLER REDEFINES PRIMHDGF.
  2708         10  PRIMHDGA PIC  X(0001).
  2709     05  PRIMHDGI PIC  X(0012).
  2710*    -------------------------------
  2711     05  PCERTNOL PIC S9(0004) COMP.
  2712     05  PCERTNOF PIC  X(0001).
  2713     05  FILLER REDEFINES PCERTNOF.
  2714         10  PCERTNOA PIC  X(0001).
  2715     05  PCERTNOI PIC  X(0010).
  2716*    -------------------------------
  2717     05  PSUFXL PIC S9(0004) COMP.
  2718     05  PSUFXF PIC  X(0001).
  2719     05  FILLER REDEFINES PSUFXF.
  2720         10  PSUFXA PIC  X(0001).
  2721     05  PSUFXI PIC  X(0001).
  2722*    -------------------------------
  2723     05  STATUSL PIC S9(0004) COMP.
  2724     05  STATUSF PIC  X(0001).
  2725     05  FILLER REDEFINES STATUSF.
  2726         10  STATUSA PIC  X(0001).
  2727     05  STATUSI PIC  X(0010).
  2728*    -------------------------------
  2729     05  LOANHL PIC S9(0004) COMP.
  2730     05  LOANHF PIC  X(0001).
  2731     05  FILLER REDEFINES LOANHF.
  2732         10  LOANHA PIC  X(0001).
  2733     05  LOANHI PIC  X(0014).
  2734*    -------------------------------
  2735     05  LOANNOL PIC S9(0004) COMP.
  2736     05  LOANNOF PIC  X(0001).
  2737     05  FILLER REDEFINES LOANNOF.
  2738         10  LOANNOA PIC  X(0001).
  2739     05  LOANNOI PIC  X(0025).
  2740*    -------------------------------
  2741     05  DUEDAYHL PIC S9(0004) COMP.
  2742     05  DUEDAYHF PIC  X(0001).
  2743     05  FILLER REDEFINES DUEDAYHF.
  2744         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  57
* EL156.cbl
  2745     05  DUEDAYHI PIC  X(0008).
  2746*    -------------------------------
  2747     05  DUEDAYL PIC S9(0004) COMP.
  2748     05  DUEDAYF PIC  X(0001).
  2749     05  FILLER REDEFINES DUEDAYF.
  2750         10  DUEDAYA PIC  X(0001).
  2751     05  DUEDAYI PIC  X(0002).
  2752*    -------------------------------
  2753     05  ZINTHL PIC S9(0004) COMP.
  2754     05  ZINTHF PIC  X(0001).
  2755     05  FILLER REDEFINES ZINTHF.
  2756         10  ZINTHA PIC  X(0001).
  2757     05  ZINTHI PIC  X(0009).
  2758*    -------------------------------
  2759     05  ZINTL PIC S9(0004) COMP.
  2760     05  ZINTF PIC  X(0001).
  2761     05  FILLER REDEFINES ZINTF.
  2762         10  ZINTA PIC  X(0001).
  2763     05  ZINTI PIC  99V99999.
  2764*    -------------------------------
  2765     05  PTHRHDGL PIC S9(0004) COMP.
  2766     05  PTHRHDGF PIC  X(0001).
  2767     05  FILLER REDEFINES PTHRHDGF.
  2768         10  PTHRHDGA PIC  X(0001).
  2769     05  PTHRHDGI PIC  X(0014).
  2770*    -------------------------------
  2771     05  PDTHRUL PIC S9(0004) COMP.
  2772     05  PDTHRUF PIC  X(0001).
  2773     05  FILLER REDEFINES PDTHRUF.
  2774         10  PDTHRUA PIC  X(0001).
  2775     05  PDTHRUI PIC  X(0008).
  2776*    -------------------------------
  2777     05  TOTPAIDL PIC S9(0004) COMP.
  2778     05  TOTPAIDF PIC  X(0001).
  2779     05  FILLER REDEFINES TOTPAIDF.
  2780         10  TOTPAIDA PIC  X(0001).
  2781     05  TOTPAIDI PIC  X(0010).
  2782*    -------------------------------
  2783     05  COVERL PIC S9(0004) COMP.
  2784     05  COVERF PIC  X(0001).
  2785     05  FILLER REDEFINES COVERF.
  2786         10  COVERA PIC  X(0001).
  2787     05  COVERI PIC  X(0010).
  2788*    -------------------------------
  2789     05  INCURL PIC S9(0004) COMP.
  2790     05  INCURF PIC  X(0001).
  2791     05  FILLER REDEFINES INCURF.
  2792         10  INCURA PIC  X(0001).
  2793     05  INCURI PIC  X(0008).
  2794*    -------------------------------
  2795     05  LSTDTEL PIC S9(0004) COMP.
  2796     05  LSTDTEF PIC  X(0001).
  2797     05  FILLER REDEFINES LSTDTEF.
  2798         10  LSTDTEA PIC  X(0001).
  2799     05  LSTDTEI PIC  X(0008).
  2800*    -------------------------------
  2801     05  CRTSTATL PIC S9(0004) COMP.
  2802     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  58
* EL156.cbl
  2803     05  FILLER REDEFINES CRTSTATF.
  2804         10  CRTSTATA PIC  X(0001).
  2805     05  CRTSTATI PIC  X(0010).
  2806*    -------------------------------
  2807     05  EFFECTL PIC S9(0004) COMP.
  2808     05  EFFECTF PIC  X(0001).
  2809     05  FILLER REDEFINES EFFECTF.
  2810         10  EFFECTA PIC  X(0001).
  2811     05  EFFECTI PIC  X(0008).
  2812*    -------------------------------
  2813     05  TERMSL PIC S9(0004) COMP.
  2814     05  TERMSF PIC  X(0001).
  2815     05  FILLER REDEFINES TERMSF.
  2816         10  TERMSA PIC  X(0001).
  2817     05  TERMSI PIC  X(0011).
  2818*    -------------------------------
  2819     05  STACCTL PIC S9(0004) COMP.
  2820     05  STACCTF PIC  X(0001).
  2821     05  FILLER REDEFINES STACCTF.
  2822         10  STACCTA PIC  X(0001).
  2823     05  STACCTI PIC  X(0013).
  2824*    -------------------------------
  2825     05  EXPDTEHL PIC S9(0004) COMP.
  2826     05  EXPDTEHF PIC  X(0001).
  2827     05  FILLER REDEFINES EXPDTEHF.
  2828         10  EXPDTEHA PIC  X(0001).
  2829     05  EXPDTEHI PIC  X(0014).
  2830*    -------------------------------
  2831     05  EXPDTEL PIC S9(0004) COMP.
  2832     05  EXPDTEF PIC  X(0001).
  2833     05  FILLER REDEFINES EXPDTEF.
  2834         10  EXPDTEA PIC  X(0001).
  2835     05  EXPDTEI PIC  X(0008).
  2836*    -------------------------------
  2837     05  BENECAPL PIC S9(0004) COMP.
  2838     05  BENECAPF PIC  X(0001).
  2839     05  FILLER REDEFINES BENECAPF.
  2840         10  BENECAPA PIC  X(0001).
  2841     05  BENECAPI PIC  X(0013).
  2842*    -------------------------------
  2843     05  BENEL PIC S9(0004) COMP.
  2844     05  BENEF PIC  X(0001).
  2845     05  FILLER REDEFINES BENEF.
  2846         10  BENEA PIC  X(0001).
  2847     05  BENEI PIC  X(0009).
  2848*    -------------------------------
  2849     05  FORMTYPL PIC S9(0004) COMP.
  2850     05  FORMTYPF PIC  X(0001).
  2851     05  FILLER REDEFINES FORMTYPF.
  2852         10  FORMTYPA PIC  X(0001).
  2853     05  FORMTYPI PIC  X(0001).
  2854*    -------------------------------
  2855     05  PMTTYPEL PIC S9(0004) COMP.
  2856     05  PMTTYPEF PIC  X(0001).
  2857     05  FILLER REDEFINES PMTTYPEF.
  2858         10  PMTTYPEA PIC  X(0001).
  2859     05  PMTTYPEI PIC  X(0001).
  2860*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  59
* EL156.cbl
  2861     05  PAYEEL PIC S9(0004) COMP.
  2862     05  PAYEEF PIC  X(0001).
  2863     05  FILLER REDEFINES PAYEEF.
  2864         10  PAYEEA PIC  X(0001).
  2865     05  PAYEEI PIC  X(0002).
  2866*    -------------------------------
  2867     05  CHECKNOL PIC S9(0004) COMP.
  2868     05  CHECKNOF PIC  X(0001).
  2869     05  FILLER REDEFINES CHECKNOF.
  2870         10  CHECKNOA PIC  X(0001).
  2871     05  CHECKNOI PIC  X(0007).
  2872*    -------------------------------
  2873     05  OFFLINEL PIC S9(0004) COMP.
  2874     05  OFFLINEF PIC  X(0001).
  2875     05  FILLER REDEFINES OFFLINEF.
  2876         10  OFFLINEA PIC  X(0001).
  2877     05  OFFLINEI PIC  X(0001).
  2878*    -------------------------------
  2879     05  HOLDTILL PIC S9(0004) COMP.
  2880     05  HOLDTILF PIC  X(0001).
  2881     05  FILLER REDEFINES HOLDTILF.
  2882         10  HOLDTILA PIC  X(0001).
  2883     05  HOLDTILI PIC  X(0008).
  2884*    -------------------------------
  2885     05  NOTE1L PIC S9(0004) COMP.
  2886     05  NOTE1F PIC  X(0001).
  2887     05  FILLER REDEFINES NOTE1F.
  2888         10  NOTE1A PIC  X(0001).
  2889     05  NOTE1I PIC  X(0060).
  2890*    -------------------------------
  2891     05  NOTE2L PIC S9(0004) COMP.
  2892     05  NOTE2F PIC  X(0001).
  2893     05  FILLER REDEFINES NOTE2F.
  2894         10  NOTE2A PIC  X(0001).
  2895     05  NOTE2I PIC  X(0060).
  2896*    -------------------------------
  2897     05  EOBYNL PIC S9(0004) COMP.
  2898     05  EOBYNF PIC  X(0001).
  2899     05  FILLER REDEFINES EOBYNF.
  2900         10  EOBYNA PIC  X(0001).
  2901     05  EOBYNI PIC  X(0001).
  2902*    -------------------------------
  2903     05  CLMFMYNL PIC S9(0004) COMP.
  2904     05  CLMFMYNF PIC  X(0001).
  2905     05  FILLER REDEFINES CLMFMYNF.
  2906         10  CLMFMYNA PIC  X(0001).
  2907     05  CLMFMYNI PIC  X(0001).
  2908*    -------------------------------
  2909     05  SURVYYNL PIC S9(0004) COMP.
  2910     05  SURVYYNF PIC  X(0001).
  2911     05  FILLER REDEFINES SURVYYNF.
  2912         10  SURVYYNA PIC  X(0001).
  2913     05  SURVYYNI PIC  X(0001).
  2914*    -------------------------------
  2915     05  SPRELYNL PIC S9(0004) COMP.
  2916     05  SPRELYNF PIC  X(0001).
  2917     05  FILLER REDEFINES SPRELYNF.
  2918         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  60
* EL156.cbl
  2919     05  SPRELYNI PIC  X(0001).
  2920*    -------------------------------
  2921     05  PINTHL PIC S9(0004) COMP.
  2922     05  PINTHF PIC  X(0001).
  2923     05  FILLER REDEFINES PINTHF.
  2924         10  PINTHA PIC  X(0001).
  2925     05  PINTHI PIC  X(0004).
  2926*    -------------------------------
  2927     05  PINTL PIC S9(0004) COMP.
  2928     05  PINTF PIC  X(0001).
  2929     05  FILLER REDEFINES PINTF.
  2930         10  PINTA PIC  X(0001).
  2931     05  PINTI PIC  X(0008).
  2932*    -------------------------------
  2933     05  PROOFDTL PIC S9(0004) COMP.
  2934     05  PROOFDTF PIC  X(0001).
  2935     05  FILLER REDEFINES PROOFDTF.
  2936         10  PROOFDTA PIC  X(0001).
  2937     05  PROOFDTI PIC  X(0008).
  2938*    -------------------------------
  2939     05  AIGFRMHL PIC S9(0004) COMP.
  2940     05  AIGFRMHF PIC  X(0001).
  2941     05  FILLER REDEFINES AIGFRMHF.
  2942         10  AIGFRMHA PIC  X(0001).
  2943     05  AIGFRMHI PIC  X(0012).
  2944*    -------------------------------
  2945     05  AIGFROML PIC S9(0004) COMP.
  2946     05  AIGFROMF PIC  X(0001).
  2947     05  FILLER REDEFINES AIGFROMF.
  2948         10  AIGFROMA PIC  X(0001).
  2949     05  AIGFROMI PIC  X(0008).
  2950*    -------------------------------
  2951     05  PMTHDGAL PIC S9(0004) COMP.
  2952     05  PMTHDGAF PIC  X(0001).
  2953     05  FILLER REDEFINES PMTHDGAF.
  2954         10  PMTHDGAA PIC  X(0001).
  2955     05  PMTHDGAI PIC  X(0066).
  2956*    -------------------------------
  2957     05  EPYFROML PIC S9(0004) COMP.
  2958     05  EPYFROMF PIC  X(0001).
  2959     05  FILLER REDEFINES EPYFROMF.
  2960         10  EPYFROMA PIC  X(0001).
  2961     05  EPYFROMI PIC  X(0008).
  2962*    -------------------------------
  2963     05  EPYTHRUL PIC S9(0004) COMP.
  2964     05  EPYTHRUF PIC  X(0001).
  2965     05  FILLER REDEFINES EPYTHRUF.
  2966         10  EPYTHRUA PIC  X(0001).
  2967     05  EPYTHRUI PIC  X(0008).
  2968*    -------------------------------
  2969     05  EDAYSL PIC S9(0004) COMP.
  2970     05  EDAYSF PIC  X(0001).
  2971     05  FILLER REDEFINES EDAYSF.
  2972         10  EDAYSA PIC  X(0001).
  2973     05  EDAYSI PIC  S9(6).
  2974*    -------------------------------
  2975     05  EPYAMTL PIC S9(0004) COMP.
  2976     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  61
* EL156.cbl
  2977     05  FILLER REDEFINES EPYAMTF.
  2978         10  EPYAMTA PIC  X(0001).
  2979     05  EPYAMTI PIC  S9(8)V99.
  2980*    -------------------------------
  2981     05  ERESVL PIC S9(0004) COMP.
  2982     05  ERESVF PIC  X(0001).
  2983     05  FILLER REDEFINES ERESVF.
  2984         10  ERESVA PIC  X(0001).
  2985     05  ERESVI PIC  S9(7)V99.
  2986*    -------------------------------
  2987     05  ETYPEL PIC S9(0004) COMP.
  2988     05  ETYPEF PIC  X(0001).
  2989     05  FILLER REDEFINES ETYPEF.
  2990         10  ETYPEA PIC  X(0001).
  2991     05  ETYPEI PIC  X(0001).
  2992*    -------------------------------
  2993     05  EEXPENSL PIC S9(0004) COMP.
  2994     05  EEXPENSF PIC  X(0001).
  2995     05  FILLER REDEFINES EEXPENSF.
  2996         10  EEXPENSA PIC  X(0001).
  2997     05  EEXPENSI PIC  9(6)V99.
  2998*    -------------------------------
  2999     05  CPYFROML PIC S9(0004) COMP.
  3000     05  CPYFROMF PIC  X(0001).
  3001     05  FILLER REDEFINES CPYFROMF.
  3002         10  CPYFROMA PIC  X(0001).
  3003     05  CPYFROMI PIC  X(0008).
  3004*    -------------------------------
  3005     05  CPYTHRUL PIC S9(0004) COMP.
  3006     05  CPYTHRUF PIC  X(0001).
  3007     05  FILLER REDEFINES CPYTHRUF.
  3008         10  CPYTHRUA PIC  X(0001).
  3009     05  CPYTHRUI PIC  X(0008).
  3010*    -------------------------------
  3011     05  CDAYSL PIC S9(0004) COMP.
  3012     05  CDAYSF PIC  X(0001).
  3013     05  FILLER REDEFINES CDAYSF.
  3014         10  CDAYSA PIC  X(0001).
  3015     05  CDAYSI PIC  9(6).
  3016*    -------------------------------
  3017     05  CPYAMTL PIC S9(0004) COMP.
  3018     05  CPYAMTF PIC  X(0001).
  3019     05  FILLER REDEFINES CPYAMTF.
  3020         10  CPYAMTA PIC  X(0001).
  3021     05  CPYAMTI PIC  S9(8)V99.
  3022*    -------------------------------
  3023     05  CRESVL PIC S9(0004) COMP.
  3024     05  CRESVF PIC  X(0001).
  3025     05  FILLER REDEFINES CRESVF.
  3026         10  CRESVA PIC  X(0001).
  3027     05  CRESVI PIC  9(6)V99.
  3028*    -------------------------------
  3029     05  CEXPENSL PIC S9(0004) COMP.
  3030     05  CEXPENSF PIC  X(0001).
  3031     05  FILLER REDEFINES CEXPENSF.
  3032         10  CEXPENSA PIC  X(0001).
  3033     05  CEXPENSI PIC  9(6)V99.
  3034*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  62
* EL156.cbl
  3035     05  ERRMSG0L PIC S9(0004) COMP.
  3036     05  ERRMSG0F PIC  X(0001).
  3037     05  FILLER REDEFINES ERRMSG0F.
  3038         10  ERRMSG0A PIC  X(0001).
  3039     05  ERRMSG0I PIC  X(0072).
  3040*    -------------------------------
  3041     05  ERRMSG1L PIC S9(0004) COMP.
  3042     05  ERRMSG1F PIC  X(0001).
  3043     05  FILLER REDEFINES ERRMSG1F.
  3044         10  ERRMSG1A PIC  X(0001).
  3045     05  ERRMSG1I PIC  X(0072).
  3046*    -------------------------------
  3047     05  ERRMSG2L PIC S9(0004) COMP.
  3048     05  ERRMSG2F PIC  X(0001).
  3049     05  FILLER REDEFINES ERRMSG2F.
  3050         10  ERRMSG2A PIC  X(0001).
  3051     05  ERRMSG2I PIC  X(0072).
  3052*    -------------------------------
  3053     05  ENTERPFL PIC S9(0004) COMP.
  3054     05  ENTERPFF PIC  X(0001).
  3055     05  FILLER REDEFINES ENTERPFF.
  3056         10  ENTERPFA PIC  X(0001).
  3057     05  ENTERPFI PIC  99.
  3058*    -------------------------------
  3059     05  PF6TITL PIC S9(0004) COMP.
  3060     05  PF6TITF PIC  X(0001).
  3061     05  FILLER REDEFINES PF6TITF.
  3062         10  PF6TITA PIC  X(0001).
  3063     05  PF6TITI PIC  X(0016).
  3064 01  EL156AO REDEFINES EL156AI.
  3065     05  FILLER            PIC  X(0012).
  3066*    -------------------------------
  3067     05  FILLER            PIC  X(0003).
  3068     05  RUNDTEAO PIC  X(0008).
  3069*    -------------------------------
  3070     05  FILLER            PIC  X(0003).
  3071     05  RUNTIMAO PIC  99.99.
  3072*    -------------------------------
  3073     05  FILLER            PIC  X(0003).
  3074     05  SEQUO PIC  X(0010).
  3075*    -------------------------------
  3076     05  FILLER            PIC  X(0003).
  3077     05  CLMNOO PIC  X(0007).
  3078*    -------------------------------
  3079     05  FILLER            PIC  X(0003).
  3080     05  CARRO PIC  X(0001).
  3081*    -------------------------------
  3082     05  FILLER            PIC  X(0003).
  3083     05  CERTNOO PIC  X(0010).
  3084*    -------------------------------
  3085     05  FILLER            PIC  X(0003).
  3086     05  SUFXO PIC  X(0001).
  3087*    -------------------------------
  3088     05  FILLER            PIC  X(0003).
  3089     05  CLMTYPO PIC  X(0006).
  3090*    -------------------------------
  3091     05  FILLER            PIC  X(0003).
  3092     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  63
* EL156.cbl
  3093*    -------------------------------
  3094     05  FILLER            PIC  X(0003).
  3095     05  LSTNMEO PIC  X(0015).
  3096*    -------------------------------
  3097     05  FILLER            PIC  X(0003).
  3098     05  FSTNMEO PIC  X(0012).
  3099*    -------------------------------
  3100     05  FILLER            PIC  X(0003).
  3101     05  MINITO PIC  X(0001).
  3102*    -------------------------------
  3103     05  FILLER            PIC  X(0003).
  3104     05  PRIMHDGO PIC  X(0012).
  3105*    -------------------------------
  3106     05  FILLER            PIC  X(0003).
  3107     05  PCERTNOO PIC  X(0010).
  3108*    -------------------------------
  3109     05  FILLER            PIC  X(0003).
  3110     05  PSUFXO PIC  X(0001).
  3111*    -------------------------------
  3112     05  FILLER            PIC  X(0003).
  3113     05  STATUSO PIC  X(0010).
  3114*    -------------------------------
  3115     05  FILLER            PIC  X(0003).
  3116     05  LOANHO PIC  X(0014).
  3117*    -------------------------------
  3118     05  FILLER            PIC  X(0003).
  3119     05  LOANNOO PIC  X(0025).
  3120*    -------------------------------
  3121     05  FILLER            PIC  X(0003).
  3122     05  DUEDAYHO PIC  X(0008).
  3123*    -------------------------------
  3124     05  FILLER            PIC  X(0003).
  3125     05  DUEDAYO PIC  X(0002).
  3126*    -------------------------------
  3127     05  FILLER            PIC  X(0003).
  3128     05  ZINTHO PIC  X(0009).
  3129*    -------------------------------
  3130     05  FILLER            PIC  X(0003).
  3131     05  ZINTO PIC  9.99999.
  3132*    -------------------------------
  3133     05  FILLER            PIC  X(0003).
  3134     05  PTHRHDGO PIC  X(0014).
  3135*    -------------------------------
  3136     05  FILLER            PIC  X(0003).
  3137     05  PDTHRUO PIC  X(0008).
  3138*    -------------------------------
  3139     05  FILLER            PIC  X(0003).
  3140     05  TOTPAIDO PIC  Z(6).99-.
  3141*    -------------------------------
  3142     05  FILLER            PIC  X(0003).
  3143     05  COVERO PIC  X(0010).
  3144*    -------------------------------
  3145     05  FILLER            PIC  X(0003).
  3146     05  INCURO PIC  X(0008).
  3147*    -------------------------------
  3148     05  FILLER            PIC  X(0003).
  3149     05  LSTDTEO PIC  X(0008).
  3150*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  64
* EL156.cbl
  3151     05  FILLER            PIC  X(0003).
  3152     05  CRTSTATO PIC  X(0010).
  3153*    -------------------------------
  3154     05  FILLER            PIC  X(0003).
  3155     05  EFFECTO PIC  X(0008).
  3156*    -------------------------------
  3157     05  FILLER            PIC  X(0003).
  3158     05  TERMSO PIC  X(0011).
  3159*    -------------------------------
  3160     05  FILLER            PIC  X(0003).
  3161     05  STACCTO PIC  X(0013).
  3162*    -------------------------------
  3163     05  FILLER            PIC  X(0003).
  3164     05  EXPDTEHO PIC  X(0014).
  3165*    -------------------------------
  3166     05  FILLER            PIC  X(0003).
  3167     05  EXPDTEO PIC  X(0008).
  3168*    -------------------------------
  3169     05  FILLER            PIC  X(0003).
  3170     05  BENECAPO PIC  X(0013).
  3171*    -------------------------------
  3172     05  FILLER            PIC  X(0003).
  3173     05  BENEO PIC  Z(6).99.
  3174*    -------------------------------
  3175     05  FILLER            PIC  X(0003).
  3176     05  FORMTYPO PIC  X(0001).
  3177*    -------------------------------
  3178     05  FILLER            PIC  X(0003).
  3179     05  PMTTYPEO PIC  X(0001).
  3180*    -------------------------------
  3181     05  FILLER            PIC  X(0003).
  3182     05  PAYEEO PIC  X(0002).
  3183*    -------------------------------
  3184     05  FILLER            PIC  X(0003).
  3185     05  CHECKNOO PIC  X(0007).
  3186*    -------------------------------
  3187     05  FILLER            PIC  X(0003).
  3188     05  OFFLINEO PIC  X(0001).
  3189*    -------------------------------
  3190     05  FILLER            PIC  X(0003).
  3191     05  HOLDTILO PIC  99B99B99.
  3192*    -------------------------------
  3193     05  FILLER            PIC  X(0003).
  3194     05  NOTE1O PIC  X(0060).
  3195*    -------------------------------
  3196     05  FILLER            PIC  X(0003).
  3197     05  NOTE2O PIC  X(0060).
  3198*    -------------------------------
  3199     05  FILLER            PIC  X(0003).
  3200     05  EOBYNO PIC  X(0001).
  3201*    -------------------------------
  3202     05  FILLER            PIC  X(0003).
  3203     05  CLMFMYNO PIC  X(0001).
  3204*    -------------------------------
  3205     05  FILLER            PIC  X(0003).
  3206     05  SURVYYNO PIC  X(0001).
  3207*    -------------------------------
  3208     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  65
* EL156.cbl
  3209     05  SPRELYNO PIC  X(0001).
  3210*    -------------------------------
  3211     05  FILLER            PIC  X(0003).
  3212     05  PINTHO PIC  X(0004).
  3213*    -------------------------------
  3214     05  FILLER            PIC  X(0003).
  3215     05  PINTO PIC  Z,ZZ9.99.
  3216*    -------------------------------
  3217     05  FILLER            PIC  X(0003).
  3218     05  PROOFDTO PIC  99B99B99.
  3219*    -------------------------------
  3220     05  FILLER            PIC  X(0003).
  3221     05  AIGFRMHO PIC  X(0012).
  3222*    -------------------------------
  3223     05  FILLER            PIC  X(0003).
  3224     05  AIGFROMO PIC  99B99B99.
  3225*    -------------------------------
  3226     05  FILLER            PIC  X(0003).
  3227     05  PMTHDGAO PIC  X(0066).
  3228*    -------------------------------
  3229     05  FILLER            PIC  X(0003).
  3230     05  EPYFROMO PIC  99B99B99.
  3231*    -------------------------------
  3232     05  FILLER            PIC  X(0003).
  3233     05  EPYTHRUO PIC  99B99B99.
  3234*    -------------------------------
  3235     05  FILLER            PIC  X(0003).
  3236     05  EDAYSO PIC  Z(4)9-.
  3237*    -------------------------------
  3238     05  FILLER            PIC  X(0003).
  3239     05  EPYAMTO PIC  Z(6).99-.
  3240*    -------------------------------
  3241     05  FILLER            PIC  X(0003).
  3242     05  ERESVO PIC  Z(5).99-.
  3243*    -------------------------------
  3244     05  FILLER            PIC  X(0003).
  3245     05  ETYPEO PIC  X(0001).
  3246*    -------------------------------
  3247     05  FILLER            PIC  X(0003).
  3248     05  EEXPENSO PIC  Z(5).99.
  3249*    -------------------------------
  3250     05  FILLER            PIC  X(0003).
  3251     05  CPYFROMO PIC  99B99B99.
  3252*    -------------------------------
  3253     05  FILLER            PIC  X(0003).
  3254     05  CPYTHRUO PIC  99B99B99.
  3255*    -------------------------------
  3256     05  FILLER            PIC  X(0003).
  3257     05  CDAYSO PIC  Z(4)9-.
  3258*    -------------------------------
  3259     05  FILLER            PIC  X(0003).
  3260     05  CPYAMTO PIC  Z(6).99-.
  3261*    -------------------------------
  3262     05  FILLER            PIC  X(0003).
  3263     05  CRESVO PIC  Z(5).99.
  3264*    -------------------------------
  3265     05  FILLER            PIC  X(0003).
  3266     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  66
* EL156.cbl
  3267*    -------------------------------
  3268     05  FILLER            PIC  X(0003).
  3269     05  ERRMSG0O PIC  X(0072).
  3270*    -------------------------------
  3271     05  FILLER            PIC  X(0003).
  3272     05  ERRMSG1O PIC  X(0072).
  3273*    -------------------------------
  3274     05  FILLER            PIC  X(0003).
  3275     05  ERRMSG2O PIC  X(0072).
  3276*    -------------------------------
  3277     05  FILLER            PIC  X(0003).
  3278     05  ENTERPFO PIC  X(0002).
  3279*    -------------------------------
  3280     05  FILLER            PIC  X(0003).
  3281     05  PF6TITO PIC  X(0016).
  3282*    -------------------------------
  3283 01  EL156BI REDEFINES EL156AI.
  3284     05  FILLER            PIC  X(0012).
  3285*    -------------------------------
  3286     05  RUNDTEBL PIC S9(0004) COMP.
  3287     05  RUNDTEBF PIC  X(0001).
  3288     05  FILLER REDEFINES RUNDTEBF.
  3289         10  RUNDTEBA PIC  X(0001).
  3290     05  RUNDTEBI PIC  X(0008).
  3291*    -------------------------------
  3292     05  RUNTIMBL PIC S9(0004) COMP.
  3293     05  RUNTIMBF PIC  X(0001).
  3294     05  FILLER REDEFINES RUNTIMBF.
  3295         10  RUNTIMBA PIC  X(0001).
  3296     05  RUNTIMBI PIC  X(0005).
  3297*    -------------------------------
  3298     05  PAYDTBL PIC S9(0004) COMP.
  3299     05  PAYDTBF PIC  X(0001).
  3300     05  FILLER REDEFINES PAYDTBF.
  3301         10  PAYDTBA PIC  X(0001).
  3302     05  PAYDTBI PIC  X(0008).
  3303*    -------------------------------
  3304     05  PAYTYPBL PIC S9(0004) COMP.
  3305     05  PAYTYPBF PIC  X(0001).
  3306     05  FILLER REDEFINES PAYTYPBF.
  3307         10  PAYTYPBA PIC  X(0001).
  3308     05  PAYTYPBI PIC  X(0015).
  3309*    -------------------------------
  3310     05  PAYAMTBL PIC S9(0004) COMP.
  3311     05  PAYAMTBF PIC  X(0001).
  3312     05  FILLER REDEFINES PAYAMTBF.
  3313         10  PAYAMTBA PIC  X(0001).
  3314     05  PAYAMTBI PIC  X(0011).
  3315*    -------------------------------
  3316     05  LOANHBL PIC S9(0004) COMP.
  3317     05  LOANHBF PIC  X(0001).
  3318     05  FILLER REDEFINES LOANHBF.
  3319         10  LOANHBA PIC  X(0001).
  3320     05  LOANHBI PIC  X(0012).
  3321*    -------------------------------
  3322     05  LOANNBL PIC S9(0004) COMP.
  3323     05  LOANNBF PIC  X(0001).
  3324     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  67
* EL156.cbl
  3325         10  LOANNBA PIC  X(0001).
  3326     05  LOANNBI PIC  X(0025).
  3327*    -------------------------------
  3328     05  CKNUMHDL PIC S9(0004) COMP.
  3329     05  CKNUMHDF PIC  X(0001).
  3330     05  FILLER REDEFINES CKNUMHDF.
  3331         10  CKNUMHDA PIC  X(0001).
  3332     05  CKNUMHDI PIC  X(0012).
  3333*    -------------------------------
  3334     05  CKNUMBL PIC S9(0004) COMP.
  3335     05  CKNUMBF PIC  X(0001).
  3336     05  FILLER REDEFINES CKNUMBF.
  3337         10  CKNUMBA PIC  X(0001).
  3338     05  CKNUMBI PIC  X(0007).
  3339*    -------------------------------
  3340     05  AGTHDGL PIC S9(0004) COMP.
  3341     05  AGTHDGF PIC  X(0001).
  3342     05  FILLER REDEFINES AGTHDGF.
  3343         10  AGTHDGA PIC  X(0001).
  3344     05  AGTHDGI PIC  X(0016).
  3345*    -------------------------------
  3346     05  NAMEBL PIC S9(0004) COMP.
  3347     05  NAMEBF PIC  X(0001).
  3348     05  FILLER REDEFINES NAMEBF.
  3349         10  NAMEBA PIC  X(0001).
  3350     05  NAMEBI PIC  X(0030).
  3351*    -------------------------------
  3352     05  NAMEB2L PIC S9(0004) COMP.
  3353     05  NAMEB2F PIC  X(0001).
  3354     05  FILLER REDEFINES NAMEB2F.
  3355         10  NAMEB2A PIC  X(0001).
  3356     05  NAMEB2I PIC  X(0030).
  3357*    -------------------------------
  3358     05  ADDR1BL PIC S9(0004) COMP.
  3359     05  ADDR1BF PIC  X(0001).
  3360     05  FILLER REDEFINES ADDR1BF.
  3361         10  ADDR1BA PIC  X(0001).
  3362     05  ADDR1BI PIC  X(0030).
  3363*    -------------------------------
  3364     05  ADDR1B2L PIC S9(0004) COMP.
  3365     05  ADDR1B2F PIC  X(0001).
  3366     05  FILLER REDEFINES ADDR1B2F.
  3367         10  ADDR1B2A PIC  X(0001).
  3368     05  ADDR1B2I PIC  X(0030).
  3369*    -------------------------------
  3370     05  ADDR2BL PIC S9(0004) COMP.
  3371     05  ADDR2BF PIC  X(0001).
  3372     05  FILLER REDEFINES ADDR2BF.
  3373         10  ADDR2BA PIC  X(0001).
  3374     05  ADDR2BI PIC  X(0030).
  3375*    -------------------------------
  3376     05  ADDR2B2L PIC S9(0004) COMP.
  3377     05  ADDR2B2F PIC  X(0001).
  3378     05  FILLER REDEFINES ADDR2B2F.
  3379         10  ADDR2B2A PIC  X(0001).
  3380     05  ADDR2B2I PIC  X(0030).
  3381*    -------------------------------
  3382     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  68
* EL156.cbl
  3383     05  CITYSTBF PIC  X(0001).
  3384     05  FILLER REDEFINES CITYSTBF.
  3385         10  CITYSTBA PIC  X(0001).
  3386     05  CITYSTBI PIC  X(0030).
  3387*    -------------------------------
  3388     05  CITYST2L PIC S9(0004) COMP.
  3389     05  CITYST2F PIC  X(0001).
  3390     05  FILLER REDEFINES CITYST2F.
  3391         10  CITYST2A PIC  X(0001).
  3392     05  CITYST2I PIC  X(0030).
  3393*    -------------------------------
  3394     05  ZIPBL PIC S9(0004) COMP.
  3395     05  ZIPBF PIC  X(0001).
  3396     05  FILLER REDEFINES ZIPBF.
  3397         10  ZIPBA PIC  X(0001).
  3398     05  ZIPBI PIC  X(0009).
  3399*    -------------------------------
  3400     05  ZIPB2L PIC S9(0004) COMP.
  3401     05  ZIPB2F PIC  X(0001).
  3402     05  FILLER REDEFINES ZIPB2F.
  3403         10  ZIPB2A PIC  X(0001).
  3404     05  ZIPB2I PIC  X(0009).
  3405*    -------------------------------
  3406     05  INTHDBL PIC S9(0004) COMP.
  3407     05  INTHDBF PIC  X(0001).
  3408     05  FILLER REDEFINES INTHDBF.
  3409         10  INTHDBA PIC  X(0001).
  3410     05  INTHDBI PIC  X(0012).
  3411*    -------------------------------
  3412     05  INTAMTBL PIC S9(0004) COMP.
  3413     05  INTAMTBF PIC  X(0001).
  3414     05  FILLER REDEFINES INTAMTBF.
  3415         10  INTAMTBA PIC  X(0001).
  3416     05  INTAMTBI PIC  X(0011).
  3417*    -------------------------------
  3418     05  PMTHDGBL PIC S9(0004) COMP.
  3419     05  PMTHDGBF PIC  X(0001).
  3420     05  FILLER REDEFINES PMTHDGBF.
  3421         10  PMTHDGBA PIC  X(0001).
  3422     05  PMTHDGBI PIC  X(0034).
  3423*    -------------------------------
  3424     05  CLMNOBL PIC S9(0004) COMP.
  3425     05  CLMNOBF PIC  X(0001).
  3426     05  FILLER REDEFINES CLMNOBF.
  3427         10  CLMNOBA PIC  X(0001).
  3428     05  CLMNOBI PIC  X(0007).
  3429*    -------------------------------
  3430     05  CARRBL PIC S9(0004) COMP.
  3431     05  CARRBF PIC  X(0001).
  3432     05  FILLER REDEFINES CARRBF.
  3433         10  CARRBA PIC  X(0001).
  3434     05  CARRBI PIC  X(0001).
  3435*    -------------------------------
  3436     05  CERTNOBL PIC S9(0004) COMP.
  3437     05  CERTNOBF PIC  X(0001).
  3438     05  FILLER REDEFINES CERTNOBF.
  3439         10  CERTNOBA PIC  X(0001).
  3440     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  69
* EL156.cbl
  3441*    -------------------------------
  3442     05  SUFXBL PIC S9(0004) COMP.
  3443     05  SUFXBF PIC  X(0001).
  3444     05  FILLER REDEFINES SUFXBF.
  3445         10  SUFXBA PIC  X(0001).
  3446     05  SUFXBI PIC  X(0001).
  3447*    -------------------------------
  3448     05  CLMTYPBL PIC S9(0004) COMP.
  3449     05  CLMTYPBF PIC  X(0001).
  3450     05  FILLER REDEFINES CLMTYPBF.
  3451         10  CLMTYPBA PIC  X(0001).
  3452     05  CLMTYPBI PIC  X(0006).
  3453*    -------------------------------
  3454     05  INCURBL PIC S9(0004) COMP.
  3455     05  INCURBF PIC  X(0001).
  3456     05  FILLER REDEFINES INCURBF.
  3457         10  INCURBA PIC  X(0001).
  3458     05  INCURBI PIC  X(0008).
  3459*    -------------------------------
  3460     05  PYFROMBL PIC S9(0004) COMP.
  3461     05  PYFROMBF PIC  X(0001).
  3462     05  FILLER REDEFINES PYFROMBF.
  3463         10  PYFROMBA PIC  X(0001).
  3464     05  PYFROMBI PIC  X(0008).
  3465*    -------------------------------
  3466     05  PYTHRUBL PIC S9(0004) COMP.
  3467     05  PYTHRUBF PIC  X(0001).
  3468     05  FILLER REDEFINES PYTHRUBF.
  3469         10  PYTHRUBA PIC  X(0001).
  3470     05  PYTHRUBI PIC  X(0008).
  3471*    -------------------------------
  3472     05  DAYSBL PIC S9(0004) COMP.
  3473     05  DAYSBF PIC  X(0001).
  3474     05  FILLER REDEFINES DAYSBF.
  3475         10  DAYSBA PIC  X(0001).
  3476     05  DAYSBI PIC  X(0005).
  3477*    -------------------------------
  3478     05  BYBL PIC S9(0004) COMP.
  3479     05  BYBF PIC  X(0001).
  3480     05  FILLER REDEFINES BYBF.
  3481         10  BYBA PIC  X(0001).
  3482     05  BYBI PIC  X(0004).
  3483*    -------------------------------
  3484     05  PROOFDBL PIC S9(0004) COMP.
  3485     05  PROOFDBF PIC  X(0001).
  3486     05  FILLER REDEFINES PROOFDBF.
  3487         10  PROOFDBA PIC  X(0001).
  3488     05  PROOFDBI PIC  X(0008).
  3489*    -------------------------------
  3490     05  ACCTBL PIC S9(0004) COMP.
  3491     05  ACCTBF PIC  X(0001).
  3492     05  FILLER REDEFINES ACCTBF.
  3493         10  ACCTBA PIC  X(0001).
  3494     05  ACCTBI PIC  X(0010).
  3495*    -------------------------------
  3496     05  STATEBL PIC S9(0004) COMP.
  3497     05  STATEBF PIC  X(0001).
  3498     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  70
* EL156.cbl
  3499         10  STATEBA PIC  X(0001).
  3500     05  STATEBI PIC  X(0002).
  3501*    -------------------------------
  3502     05  GROUPBL PIC S9(0004) COMP.
  3503     05  GROUPBF PIC  X(0001).
  3504     05  FILLER REDEFINES GROUPBF.
  3505         10  GROUPBA PIC  X(0001).
  3506     05  GROUPBI PIC  X(0006).
  3507*    -------------------------------
  3508     05  ACARRBL PIC S9(0004) COMP.
  3509     05  ACARRBF PIC  X(0001).
  3510     05  FILLER REDEFINES ACARRBF.
  3511         10  ACARRBA PIC  X(0001).
  3512     05  ACARRBI PIC  X(0001).
  3513*    -------------------------------
  3514     05  ACCTNMBL PIC S9(0004) COMP.
  3515     05  ACCTNMBF PIC  X(0001).
  3516     05  FILLER REDEFINES ACCTNMBF.
  3517         10  ACCTNMBA PIC  X(0001).
  3518     05  ACCTNMBI PIC  X(0030).
  3519*    -------------------------------
  3520     05  UNDISBL PIC S9(0004) COMP.
  3521     05  UNDISBF PIC  X(0001).
  3522     05  FILLER REDEFINES UNDISBF.
  3523         10  UNDISBA PIC  X(0001).
  3524     05  UNDISBI PIC  X(0010).
  3525*    -------------------------------
  3526     05  RATEBL PIC S9(0004) COMP.
  3527     05  RATEBF PIC  X(0001).
  3528     05  FILLER REDEFINES RATEBF.
  3529         10  RATEBA PIC  X(0001).
  3530     05  RATEBI PIC  X(0006).
  3531*    -------------------------------
  3532     05  ERMSG1BL PIC S9(0004) COMP.
  3533     05  ERMSG1BF PIC  X(0001).
  3534     05  FILLER REDEFINES ERMSG1BF.
  3535         10  ERMSG1BA PIC  X(0001).
  3536     05  ERMSG1BI PIC  X(0072).
  3537*    -------------------------------
  3538     05  ENTPFBL PIC S9(0004) COMP.
  3539     05  ENTPFBF PIC  X(0001).
  3540     05  FILLER REDEFINES ENTPFBF.
  3541         10  ENTPFBA PIC  X(0001).
  3542     05  ENTPFBI PIC  99.
  3543 01  EL156BO REDEFINES EL156AI.
  3544     05  FILLER            PIC  X(0012).
  3545*    -------------------------------
  3546     05  FILLER            PIC  X(0003).
  3547     05  RUNDTEBO PIC  X(0008).
  3548*    -------------------------------
  3549     05  FILLER            PIC  X(0003).
  3550     05  RUNTIMBO PIC  99.99.
  3551*    -------------------------------
  3552     05  FILLER            PIC  X(0003).
  3553     05  PAYDTBO PIC  99B99B99.
  3554*    -------------------------------
  3555     05  FILLER            PIC  X(0003).
  3556     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  71
* EL156.cbl
  3557*    -------------------------------
  3558     05  FILLER            PIC  X(0003).
  3559     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3560*    -------------------------------
  3561     05  FILLER            PIC  X(0003).
  3562     05  LOANHBO PIC  X(0012).
  3563*    -------------------------------
  3564     05  FILLER            PIC  X(0003).
  3565     05  LOANNBO PIC  X(0025).
  3566*    -------------------------------
  3567     05  FILLER            PIC  X(0003).
  3568     05  CKNUMHDO PIC  X(0012).
  3569*    -------------------------------
  3570     05  FILLER            PIC  X(0003).
  3571     05  CKNUMBO PIC  X(0007).
  3572*    -------------------------------
  3573     05  FILLER            PIC  X(0003).
  3574     05  AGTHDGO PIC  X(0016).
  3575*    -------------------------------
  3576     05  FILLER            PIC  X(0003).
  3577     05  NAMEBO PIC  X(0030).
  3578*    -------------------------------
  3579     05  FILLER            PIC  X(0003).
  3580     05  NAMEB2O PIC  X(0030).
  3581*    -------------------------------
  3582     05  FILLER            PIC  X(0003).
  3583     05  ADDR1BO PIC  X(0030).
  3584*    -------------------------------
  3585     05  FILLER            PIC  X(0003).
  3586     05  ADDR1B2O PIC  X(0030).
  3587*    -------------------------------
  3588     05  FILLER            PIC  X(0003).
  3589     05  ADDR2BO PIC  X(0030).
  3590*    -------------------------------
  3591     05  FILLER            PIC  X(0003).
  3592     05  ADDR2B2O PIC  X(0030).
  3593*    -------------------------------
  3594     05  FILLER            PIC  X(0003).
  3595     05  CITYSTBO PIC  X(0030).
  3596*    -------------------------------
  3597     05  FILLER            PIC  X(0003).
  3598     05  CITYST2O PIC  X(0030).
  3599*    -------------------------------
  3600     05  FILLER            PIC  X(0003).
  3601     05  ZIPBO PIC  ZZZZ99999.
  3602*    -------------------------------
  3603     05  FILLER            PIC  X(0003).
  3604     05  ZIPB2O PIC  ZZZZZZZZZ.
  3605*    -------------------------------
  3606     05  FILLER            PIC  X(0003).
  3607     05  INTHDBO PIC  X(0012).
  3608*    -------------------------------
  3609     05  FILLER            PIC  X(0003).
  3610     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3611*    -------------------------------
  3612     05  FILLER            PIC  X(0003).
  3613     05  PMTHDGBO PIC  X(0034).
  3614*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  72
* EL156.cbl
  3615     05  FILLER            PIC  X(0003).
  3616     05  CLMNOBO PIC  X(0007).
  3617*    -------------------------------
  3618     05  FILLER            PIC  X(0003).
  3619     05  CARRBO PIC  X(0001).
  3620*    -------------------------------
  3621     05  FILLER            PIC  X(0003).
  3622     05  CERTNOBO PIC  X(0010).
  3623*    -------------------------------
  3624     05  FILLER            PIC  X(0003).
  3625     05  SUFXBO PIC  X(0001).
  3626*    -------------------------------
  3627     05  FILLER            PIC  X(0003).
  3628     05  CLMTYPBO PIC  X(0006).
  3629*    -------------------------------
  3630     05  FILLER            PIC  X(0003).
  3631     05  INCURBO PIC  X(0008).
  3632*    -------------------------------
  3633     05  FILLER            PIC  X(0003).
  3634     05  PYFROMBO PIC  99B99B99.
  3635*    -------------------------------
  3636     05  FILLER            PIC  X(0003).
  3637     05  PYTHRUBO PIC  99B99B99.
  3638*    -------------------------------
  3639     05  FILLER            PIC  X(0003).
  3640     05  DAYSBO PIC  X(0005).
  3641*    -------------------------------
  3642     05  FILLER            PIC  X(0003).
  3643     05  BYBO PIC  X(0004).
  3644*    -------------------------------
  3645     05  FILLER            PIC  X(0003).
  3646     05  PROOFDBO PIC  99B99B99.
  3647*    -------------------------------
  3648     05  FILLER            PIC  X(0003).
  3649     05  ACCTBO PIC  X(0010).
  3650*    -------------------------------
  3651     05  FILLER            PIC  X(0003).
  3652     05  STATEBO PIC  X(0002).
  3653*    -------------------------------
  3654     05  FILLER            PIC  X(0003).
  3655     05  GROUPBO PIC  X(0006).
  3656*    -------------------------------
  3657     05  FILLER            PIC  X(0003).
  3658     05  ACARRBO PIC  X(0001).
  3659*    -------------------------------
  3660     05  FILLER            PIC  X(0003).
  3661     05  ACCTNMBO PIC  X(0030).
  3662*    -------------------------------
  3663     05  FILLER            PIC  X(0003).
  3664     05  UNDISBO PIC  ZZZ,Z99.99.
  3665*    -------------------------------
  3666     05  FILLER            PIC  X(0003).
  3667     05  RATEBO PIC  ZZZ.99.
  3668*    -------------------------------
  3669     05  FILLER            PIC  X(0003).
  3670     05  ERMSG1BO PIC  X(0072).
  3671*    -------------------------------
  3672     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  73
* EL156.cbl
  3673     05  ENTPFBO PIC  X(0002).
  3674*    -------------------------------
  3675****************************************************************
  3676*
  3677* Copyright (c) 2007 by Clerity Solutions, Inc.
  3678* All rights reserved.
  3679*
  3680****************************************************************
  3681 01  DFHEIV.
  3682   02  DFHEIV0               PIC X(35).
  3683   02  DFHEIV1               PIC X(08).
  3684   02  DFHEIV2               PIC X(08).
  3685   02  DFHEIV3               PIC X(08).
  3686   02  DFHEIV4               PIC X(06).
  3687   02  DFHEIV5               PIC X(04).
  3688   02  DFHEIV6               PIC X(04).
  3689   02  DFHEIV7               PIC X(02).
  3690   02  DFHEIV8               PIC X(02).
  3691   02  DFHEIV9               PIC X(01).
  3692   02  DFHEIV10              PIC S9(7) COMP-3.
  3693   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3694   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3695   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3696   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3697   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3698   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3699   02  DFHEIV17              PIC X(04).
  3700   02  DFHEIV18              PIC X(04).
  3701   02  DFHEIV19              PIC X(04).
  3702   02  DFHEIV20              USAGE IS POINTER.
  3703   02  DFHEIV21              USAGE IS POINTER.
  3704   02  DFHEIV22              USAGE IS POINTER.
  3705   02  DFHEIV23              USAGE IS POINTER.
  3706   02  DFHEIV24              USAGE IS POINTER.
  3707   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3708   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3709   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3710   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3711   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3712   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3713   02  FILLER                PIC X(02).
  3714   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3715   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3716   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3717   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3718   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3719 LINKAGE  SECTION.
  3720*****************************************************************
  3721*                                                               *
  3722* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3723* All rights reserved.                                          *
  3724*                                                               *
  3725*****************************************************************
  3726 01  dfheiblk.
  3727     02  eibtime          pic s9(7) comp-3.
  3728     02  eibdate          pic s9(7) comp-3.
  3729     02  eibtrnid         pic x(4).
  3730     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  74
* EL156.cbl
  3731     02  eibtrmid         pic x(4).
  3732     02  dfheigdi         pic s9(4) comp.
  3733     02  eibcposn         pic s9(4) comp.
  3734     02  eibcalen         pic s9(4) comp.
  3735     02  eibaid           pic x(1).
  3736     02  eibfiller1       pic x(1).
  3737     02  eibfn            pic x(2).
  3738     02  eibfiller2       pic x(2).
  3739     02  eibrcode         pic x(6).
  3740     02  eibfiller3       pic x(2).
  3741     02  eibds            pic x(8).
  3742     02  eibreqid         pic x(8).
  3743     02  eibrsrce         pic x(8).
  3744     02  eibsync          pic x(1).
  3745     02  eibfree          pic x(1).
  3746     02  eibrecv          pic x(1).
  3747     02  eibsend          pic x(1).
  3748     02  eibatt           pic x(1).
  3749     02  eibeoc           pic x(1).
  3750     02  eibfmh           pic x(1).
  3751     02  eibcompl         pic x(1).
  3752     02  eibsig           pic x(1).
  3753     02  eibconf          pic x(1).
  3754     02  eiberr           pic x(1).
  3755     02  eibrldbk         pic x(1).
  3756     02  eiberrcd         pic x(4).
  3757     02  eibsynrb         pic x(1).
  3758     02  eibnodat         pic x(1).
  3759     02  eibfiller5       pic x(2).
  3760     02  eibresp          pic 9(09) comp.
  3761     02  eibresp2         pic 9(09) comp.
  3762     02  dfheigdj         pic s9(4) comp.
  3763     02  dfheigdk         pic s9(4) comp.
  3764 01  DFHCOMMAREA             PIC X(1024).
  3765
  3766*    COPY ELCMSTR.
  3767******************************************************************
  3768*                                                                *
  3769*                            ELCMSTR.                            *
  3770*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3771*                            VMOD=2.012                          *
  3772*                                                                *
  3773*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3774*                                                                *
  3775*   FILE TYPE = VSAM,KSDS                                        *
  3776*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3777*                                                                *
  3778*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3779*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3780*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3781*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3782*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3783*                                                 RKP=75,LEN=21  *
  3784*                                                                *
  3785*   **** NOTE ****                                               *
  3786*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3787*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3788*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  75
* EL156.cbl
  3789*   LOG = YES                                                    *
  3790*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3791******************************************************************
  3792*                   C H A N G E   L O G
  3793*
  3794* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3795*-----------------------------------------------------------------
  3796*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3797* EFFECTIVE    NUMBER
  3798*-----------------------------------------------------------------
  3799* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3800* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3801* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3802******************************************************************
  3803 01  CLAIM-MASTER.
  3804     12  CL-RECORD-ID                PIC XX.
  3805         88  VALID-CL-ID         VALUE 'CL'.
  3806
  3807     12  CL-CONTROL-PRIMARY.
  3808         16  CL-COMPANY-CD           PIC X.
  3809         16  CL-CARRIER              PIC X.
  3810         16  CL-CLAIM-NO             PIC X(7).
  3811         16  CL-CERT-NO.
  3812             20  CL-CERT-PRIME       PIC X(10).
  3813             20  CL-CERT-SFX         PIC X.
  3814
  3815     12  CL-CONTROL-BY-NAME.
  3816         16  CL-COMPANY-CD-A1        PIC X.
  3817         16  CL-INSURED-LAST-NAME    PIC X(15).
  3818         16  CL-INSURED-NAME.
  3819             20  CL-INSURED-1ST-NAME PIC X(12).
  3820             20  CL-INSURED-MID-INIT PIC X.
  3821
  3822     12  CL-CONTROL-BY-SSN.
  3823         16  CL-COMPANY-CD-A2        PIC X.
  3824         16  CL-SOC-SEC-NO.
  3825             20  CL-SSN-STATE        PIC XX.
  3826             20  CL-SSN-ACCOUNT      PIC X(6).
  3827             20  CL-SSN-LN3          PIC X(3).
  3828
  3829     12  CL-CONTROL-BY-CERT-NO.
  3830         16  CL-COMPANY-CD-A4        PIC X.
  3831         16  CL-CERT-NO-A4.
  3832             20  CL-CERT-A4-PRIME    PIC X(10).
  3833             20  CL-CERT-A4-SFX      PIC X.
  3834
  3835     12  CL-CONTROL-BY-CCN.
  3836         16  CL-COMPANY-CD-A5        PIC X.
  3837         16  CL-CCN-A5.
  3838             20  CL-CCN.
  3839                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3840                 24  CL-CCN-PRIME-A5 PIC X(12).
  3841             20  CL-CCN-FILLER-A5    PIC X(4).
  3842
  3843     12  CL-INSURED-PROFILE-DATA.
  3844         16  CL-INSURED-BIRTH-DT     PIC XX.
  3845         16  CL-INSURED-SEX-CD       PIC X.
  3846             88  INSURED-IS-MALE        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  76
* EL156.cbl
  3847             88  INSURED-IS-FEMALE      VALUE 'F'.
  3848             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3849         16  CL-INSURED-OCC-CD       PIC X(6).
  3850         16  FILLER                  PIC X(5).
  3851
  3852     12  CL-PROCESSING-INFO.
  3853         16  CL-PROCESSOR-ID         PIC X(4).
  3854         16  CL-CLAIM-STATUS         PIC X.
  3855             88  CLAIM-IS-OPEN          VALUE 'O'.
  3856             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3857         16  CL-CLAIM-TYPE           PIC X.
  3858*            88  AH-CLAIM               VALUE 'A'.
  3859*            88  LIFE-CLAIM             VALUE 'L'.
  3860*            88  PROPERTY-CLAIM         VALUE 'P'.
  3861*            88  IUI-CLAIM              VALUE 'I'.
  3862*            88  GAP-CLAIM              VALUE 'G'.
  3863         16  CL-CLAIM-PREM-TYPE      PIC X.
  3864             88  SINGLE-PREMIUM         VALUE '1'.
  3865             88  O-B-COVERAGE           VALUE '2'.
  3866             88  OPEN-END-COVERAGE      VALUE '3'.
  3867         16  CL-INCURRED-DT          PIC XX.
  3868         16  CL-REPORTED-DT          PIC XX.
  3869         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3870         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3871         16  CL-LAST-PMT-DT          PIC XX.
  3872         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3873         16  CL-PAID-THRU-DT         PIC XX.
  3874         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3875         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3876         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3877         16  CL-PMT-CALC-METHOD      PIC X.
  3878             88  CL-360-DAY-YR          VALUE '1'.
  3879             88  CL-365-DAY-YR          VALUE '2'.
  3880             88  CL-FULL-MONTHS         VALUE '3'.
  3881         16  CL-CAUSE-CD             PIC X(6).
  3882
  3883         16  CL-PRIME-CERT-NO.
  3884             20  CL-PRIME-CERT-PRIME PIC X(10).
  3885             20  CL-PRIME-CERT-SFX   PIC X.
  3886
  3887         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3888             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3889             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3890
  3891         16  CL-MICROFILM-NO         PIC X(10).
  3892         16  CL-PROG-FORM-TYPE       PIC X.
  3893         16  CL-LAST-ADD-ON-DT       PIC XX.
  3894
  3895         16  CL-LAST-REOPEN-DT       PIC XX.
  3896         16  CL-LAST-CLOSE-DT        PIC XX.
  3897         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3898             88  FINAL-PAID             VALUE '1'.
  3899             88  CLAIM-DENIED           VALUE '2'.
  3900             88  AUTO-CLOSE             VALUE '3'.
  3901             88  MANUAL-CLOSE           VALUE '4'.
  3902             88  BENEFITS-CHANGED       VALUE 'C'.
  3903             88  SETUP-ERRORS           VALUE 'E'.
  3904         16  CL-ASSOC-CERT-SEQU      PIC S99.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  77
* EL156.cbl
  3905         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3906         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3907             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3908         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3909         16  FILLER                  PIC X.
  3910
  3911     12  CL-CERTIFICATE-DATA.
  3912         16  CL-CERT-ORIGIN          PIC X.
  3913             88  CERT-WAS-ONLINE        VALUE '1'.
  3914             88  CERT-WAS-CREATED       VALUE '2'.
  3915             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3916         16  CL-CERT-KEY-DATA.
  3917             20  CL-CERT-CARRIER     PIC X.
  3918             20  CL-CERT-GROUPING    PIC X(6).
  3919             20  CL-CERT-STATE       PIC XX.
  3920             20  CL-CERT-ACCOUNT.
  3921                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3922                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3923             20  CL-CERT-EFF-DT      PIC XX.
  3924
  3925     12  CL-STATUS-CONTROLS.
  3926         16  CL-PRIORITY-CD          PIC X.
  3927             88  CONFIDENTIAL-DATA      VALUE '8'.
  3928             88  HIGHEST-PRIORITY       VALUE '9'.
  3929         16  CL-SUPV-ATTN-CD         PIC X.
  3930             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3931             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3932         16  CL-PURGED-DT            PIC XX.
  3933         16  CL-RESTORED-DT          PIC XX.
  3934         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3935         16  CL-NEXT-RESEND-DT       PIC XX.
  3936         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3937         16  CL-CRITICAL-PERIOD      PIC 99.
  3938*        16  FILLER                  PIC XX.
  3939         16  CL-LAST-MAINT-DT        PIC XX.
  3940         16  CL-LAST-MAINT-USER      PIC X(4).
  3941         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3942         16  CL-LAST-MAINT-TYPE      PIC X.
  3943             88  CLAIM-SET-UP           VALUE ' '.
  3944             88  PAYMENT-MADE           VALUE '1'.
  3945             88  LETTER-SENT            VALUE '2'.
  3946             88  MASTER-WAS-ALTERED     VALUE '3'.
  3947             88  MASTER-WAS-RESTORED    VALUE '4'.
  3948             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3949             88  FILE-CONVERTED         VALUE '6'.
  3950             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3951             88  ERROR-CORRECTION       VALUE 'E'.
  3952         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3953         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3954         16  CL-BENEFICIARY          PIC X(10).
  3955         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3956         16  CL-DENIAL-TYPE          PIC X.
  3957             88  CL-TYPE-DENIAL          VALUE '1'.
  3958             88  CL-TYPE-RESCISSION      VALUE '2'.
  3959             88  CL-TYPE-REFORMATION     VALUE '3'.
  3960             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3961             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3962         16  CL-CRIT-PER-RECURRENT   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  78
* EL156.cbl
  3963         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3964         16  CL-RTW-DT               PIC XX.
  3965
  3966     12  CL-TRAILER-CONTROLS.
  3967         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3968             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3969             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3970             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3971         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3972         16  FILLER                  PIC XX.
  3973         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3974         16  CL-ADDRESS-TRAILER-CNT.
  3975             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3976                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3977             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3978                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3979             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3980                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3981             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3982                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3983             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3984                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3985             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3986                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3987             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3988                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3989
  3990     12  CL-CV-REFERENCE-NO.
  3991         16  CL-CV-REFNO-PRIME       PIC X(18).
  3992         16  CL-CV-REFNO-SFX         PIC XX.
  3993
  3994     12  CL-FILE-LOCATION            PIC X(4).
  3995
  3996     12  CL-PROCESS-ERRORS.
  3997         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3998             88  NO-FATAL-ERRORS        VALUE ZERO.
  3999         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4000             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4001
  4002     12  CL-PRODUCT-CD               PIC X.
  4003
  4004     12  CL-CURRENT-KEY-DATA.
  4005         16  CL-CURRENT-CARRIER      PIC X.
  4006         16  CL-CURRENT-GROUPING     PIC X(6).
  4007         16  CL-CURRENT-STATE        PIC XX.
  4008         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4009
  4010     12  CL-ASSOCIATES               PIC X.
  4011         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4012         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4013         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4014         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4015
  4016     12  CL-ACTIVITY-CODE            PIC 99.
  4017     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4018     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4019
  4020     12  CL-LAPSE-REPORT-CODE        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  79
* EL156.cbl
  4021     12  CL-LAG-REPORT-CODE          PIC 9.
  4022     12  CL-LOAN-TYPE                PIC XX.
  4023     12  CL-LEGAL-STATE              PIC XX.
  4024
  4025     12  CL-YESNOSW                  PIC X.
  4026     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4027         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4028         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4029         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4030     12  cl-insured-claim            pic x.
  4031         88  cl-claim-on-primary         value 'P'.
  4032         88  cl-claim-on-secondary       value 'S'.
  4033     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  80
* EL156.cbl
  4035*    COPY ELCCNTL.
  4036******************************************************************
  4037*                                                                *
  4038*                                                                *
  4039*                            ELCCNTL.                            *
  4040*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4041*                            VMOD=2.059                          *
  4042*                                                                *
  4043*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4044*                                                                *
  4045*   FILE TYPE = VSAM,KSDS                                        *
  4046*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4047*                                                                *
  4048*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4049*       ALTERNATE INDEX = NONE                                   *
  4050*                                                                *
  4051*   LOG = YES                                                    *
  4052*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4053******************************************************************
  4054*                   C H A N G E   L O G
  4055*
  4056* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4057*-----------------------------------------------------------------
  4058*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4059* EFFECTIVE    NUMBER
  4060*-----------------------------------------------------------------
  4061* 082503                   PEMA  ADD BENEFIT GROUP
  4062* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4063* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4064* 092705    2005050300006  PEMA  ADD SPP LEASES
  4065* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4066* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4067* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4068* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4069* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4070* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4071* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4072* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4073* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4074******************************************************************
  4075*
  4076 01  CONTROL-FILE.
  4077     12  CF-RECORD-ID                       PIC XX.
  4078         88  VALID-CF-ID                        VALUE 'CF'.
  4079
  4080     12  CF-CONTROL-PRIMARY.
  4081         16  CF-COMPANY-ID                  PIC XXX.
  4082         16  CF-RECORD-TYPE                 PIC X.
  4083             88  CF-COMPANY-MASTER              VALUE '1'.
  4084             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4085             88  CF-STATE-MASTER                VALUE '3'.
  4086             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4087             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4088             88  CF-CARRIER-MASTER              VALUE '6'.
  4089             88  CF-MORTALITY-MASTER            VALUE '7'.
  4090             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4091             88  CF-TERMINAL-MASTER             VALUE '9'.
  4092             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  81
* EL156.cbl
  4093             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4094             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4095             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4096             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4097             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4098             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4099             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4100             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4101         16  CF-ACCESS-CD-GENL              PIC X(4).
  4102         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4103             20  CF-PROCESSOR               PIC X(4).
  4104         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4105             20  CF-STATE-CODE              PIC XX.
  4106             20  FILLER                     PIC XX.
  4107         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4108             20  FILLER                     PIC XX.
  4109             20  CF-HI-BEN-IN-REC           PIC XX.
  4110         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4111             20  FILLER                     PIC XXX.
  4112             20  CF-CARRIER-CNTL            PIC X.
  4113         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4114             20  FILLER                     PIC XX.
  4115             20  CF-HI-TYPE-IN-REC          PIC 99.
  4116         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4117             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4118                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4119             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4120             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4121         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4122             20  FILLER                     PIC X.
  4123             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4124         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4125             20  FILLER                     PIC XX.
  4126             20  CF-MORTGAGE-PLAN           PIC XX.
  4127         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4128
  4129     12  CF-LAST-MAINT-DT                   PIC XX.
  4130     12  CF-LAST-MAINT-BY                   PIC X(4).
  4131     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4132
  4133     12  CF-RECORD-BODY                     PIC X(728).
  4134
  4135
  4136****************************************************************
  4137*             COMPANY MASTER RECORD                            *
  4138****************************************************************
  4139
  4140     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4141         16  CF-COMPANY-ADDRESS.
  4142             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4143             20  CF-CL-IN-CARE-OF           PIC X(30).
  4144             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4145             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4146             20  CF-CL-CITY-STATE           PIC X(30).
  4147             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4148             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4149         16  CF-COMPANY-CD                  PIC X.
  4150         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  82
* EL156.cbl
  4151         16  CF-SECURITY-OPTION             PIC X.
  4152             88  ALL-SECURITY                   VALUE '1'.
  4153             88  COMPANY-VERIFY                 VALUE '2'.
  4154             88  PROCESSOR-VERIFY               VALUE '3'.
  4155             88  NO-SECURITY                    VALUE '4'.
  4156             88  ALL-BUT-TERM                   VALUE '5'.
  4157         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4158             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4159         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4160             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4161         16  CF-INFORCE-LOCATION            PIC X.
  4162             88  CERTS-ARE-ONLINE               VALUE '1'.
  4163             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4164             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4165         16  CF-LOWER-CASE-LETTERS          PIC X.
  4166         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4167             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4168             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4169             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4170             88  CF-ACCNT-CNTL                  VALUE '3'.
  4171             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4172
  4173         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4174         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4175
  4176         16  CF-LGX-CREDIT-USER             PIC X.
  4177             88  CO-IS-NOT-USER                 VALUE 'N'.
  4178             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4179
  4180         16 CF-CREDIT-CALC-CODES.
  4181             20  CF-CR-REM-TERM-CALC PIC X.
  4182               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4183               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4184               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4185               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4186               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4187               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4188               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4189             20  CF-CR-R78-METHOD           PIC X.
  4190               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4191               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4192
  4193         16  CF-CLAIM-CONTROL-COUNTS.
  4194             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4195                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4196
  4197             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4198                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4199
  4200             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4201                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4202
  4203             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4204                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4205
  4206         16  CF-CURRENT-MONTH-END           PIC XX.
  4207
  4208         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  83
* EL156.cbl
  4209             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4210             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4211             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4212             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4213                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4214                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4215             20  CF-CO-PREM-REJECT-SW       PIC X.
  4216                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4217                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4218             20  CF-CO-REF-REJECT-SW        PIC X.
  4219                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4220                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4221
  4222         16  CF-CO-REPORTING-DT             PIC XX.
  4223         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4224         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4225           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4226           88  CF-CO-MONTH-END                  VALUE '1'.
  4227
  4228         16  CF-LGX-CLAIM-USER              PIC X.
  4229             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4230             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4231
  4232         16  CF-CREDIT-EDIT-CONTROLS.
  4233             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4234             20  CF-MIN-AGE                 PIC 99.
  4235             20  CF-DEFAULT-AGE             PIC 99.
  4236             20  CF-MIN-TERM                PIC S999      COMP-3.
  4237             20  CF-MAX-TERM                PIC S999      COMP-3.
  4238             20  CF-DEFAULT-SEX             PIC X.
  4239             20  CF-JOINT-AGE-INPUT         PIC X.
  4240                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4241             20  CF-BIRTH-DATE-INPUT        PIC X.
  4242                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4243             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4244                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4245                 88  CF-ZERO-CARRIER            VALUE '1'.
  4246                 88  CF-ZERO-GROUPING           VALUE '2'.
  4247                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4248             20  CF-EDIT-SW                 PIC X.
  4249                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4250             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4251             20  CF-CR-PR-METHOD            PIC X.
  4252               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4253               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4254             20  FILLER                     PIC X.
  4255
  4256         16  CF-CREDIT-MISC-CONTROLS.
  4257             20  CF-REIN-TABLE-SW           PIC X.
  4258                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4259             20  CF-COMP-TABLE-SW           PIC X.
  4260                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4261             20  CF-EXPERIENCE-RETENTION-AGE
  4262                                            PIC S9        COMP-3.
  4263             20  CF-CONVERSION-DT           PIC XX.
  4264             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4265             20  CF-RUN-FREQUENCY-SW        PIC X.
  4266                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  84
* EL156.cbl
  4267                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4268
  4269             20  CF-CR-CHECK-NO-CONTROL.
  4270                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4271                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4272                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4273                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4274                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4275                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4276
  4277                 24  CF-CR-CHECK-COUNT       REDEFINES
  4278                     CF-CR-CHECK-COUNTER      PIC X(4).
  4279
  4280                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4281                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4282
  4283                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4284                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4285                 24  CF-MAIL-PROCESSING       PIC X.
  4286                     88  MAIL-PROCESSING          VALUE 'Y'.
  4287
  4288         16  CF-MISC-SYSTEM-CONTROL.
  4289             20  CF-SYSTEM-C                 PIC X.
  4290                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4291             20  CF-SYSTEM-D                 PIC X.
  4292                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4293             20  CF-SOC-SEC-NO-SW            PIC X.
  4294                 88  SOC-SEC-NO-USED             VALUE '1'.
  4295             20  CF-MEMBER-NO-SW             PIC X.
  4296                 88  MEMBER-NO-USED              VALUE '1'.
  4297             20  CF-TAX-ID-NUMBER            PIC X(11).
  4298             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4299             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4300                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4301                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4302                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4303                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4304             20  CF-SYSTEM-E                 PIC X.
  4305                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4306
  4307         16  CF-LGX-LIFE-USER               PIC X.
  4308             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4309             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4310
  4311         16  CF-CR-MONTH-END-DT             PIC XX.
  4312
  4313         16  CF-FILE-MAINT-DATES.
  4314             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4315                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4316             20  CF-LAST-BATCH       REDEFINES
  4317                 CF-LAST-BATCH-NO               PIC X(4).
  4318             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4319             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4320             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4321             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4322             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4323             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4324             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  85
* EL156.cbl
  4325             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4326             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4327             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4328
  4329         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4330         16  FILLER                         PIC X.
  4331
  4332         16  CF-ALT-MORT-CODE               PIC X(4).
  4333         16  CF-MEMBER-CAPTION              PIC X(10).
  4334
  4335         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4336             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4337             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4338             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4339             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4340             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4341
  4342         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4343
  4344         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4345         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4346         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4347         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4348
  4349         16  CF-AH-OVERRIDE-L1              PIC X.
  4350         16  CF-AH-OVERRIDE-L2              PIC XX.
  4351         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4352         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4353
  4354         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4355         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4356
  4357         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4358         16  CF-AR-LAST-EL860-DT            PIC XX.
  4359         16  CF-MP-MONTH-END-DT             PIC XX.
  4360
  4361         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4362         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4363             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4364
  4365         16  CF-AR-MONTH-END-DT             PIC XX.
  4366
  4367         16  CF-CRDTCRD-USER                PIC X.
  4368             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4369             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4370
  4371         16  CF-CC-MONTH-END-DT             PIC XX.
  4372
  4373         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4374
  4375         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4376             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4377             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4378             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4379         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4380         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4381         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4382         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  86
* EL156.cbl
  4383             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4384             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4385         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4386         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4387         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4388             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4389         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4390
  4391         16  CF-CL-ZIP-CODE.
  4392             20  CF-CL-ZIP-PRIME.
  4393                 24  CF-CL-ZIP-1ST          PIC X.
  4394                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4395                 24  FILLER                 PIC X(4).
  4396             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4397         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4398             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4399             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4400             20  FILLER                     PIC XXX.
  4401
  4402         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4403         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4404         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4405         16  CF-CO-OPTION-START-DATE        PIC XX.
  4406         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4407           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4408                                                      '3' '4'.
  4409           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4410           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4411           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4412           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4413           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4414           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4415
  4416         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4417
  4418         16  CF-PAYMENT-APPROVAL-LEVELS.
  4419             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4420             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4421             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4422             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4423             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4424             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4425
  4426         16  CF-END-USER-REPORTING-USER     PIC X.
  4427             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4428             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4429
  4430         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4431             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4432             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4433
  4434         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4435
  4436         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4437         16  FILLER                         PIC X.
  4438
  4439         16  CF-CREDIT-ARCHIVE-CNTL.
  4440             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  87
* EL156.cbl
  4441             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4442             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4443
  4444         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4445
  4446         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4447             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4448             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4449
  4450         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4451             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4452             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4453
  4454         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4455
  4456         16  CF-CO-ACH-ID-CODE              PIC  X.
  4457             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4458             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4459             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4460         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4461         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4462         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4463         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4464         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4465         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4466         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4467         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4468         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4469                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4470         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4471                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4472
  4473         16  CF-CO-OVER-SHORT.
  4474             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4475             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4476
  4477*         16  FILLER                         PIC X(102).
  4478         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4479             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4480             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4481
  4482         16  CF-AH-APPROVAL-DAYS.
  4483             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4484             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4485             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4486             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4487
  4488         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4489
  4490         16  CF-APPROV-LEV-5.
  4491             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4492             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4493             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4494
  4495         16  FILLER                         PIC X(68).
  4496****************************************************************
  4497*             PROCESSOR/USER RECORD                            *
  4498****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  88
* EL156.cbl
  4499
  4500     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4501         16  CF-PROCESSOR-NAME              PIC X(30).
  4502         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4503         16  CF-PROCESSOR-TITLE             PIC X(26).
  4504         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4505                 88  MESSAGE-YES                VALUE 'Y'.
  4506                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4507
  4508*****************************************************
  4509****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4510****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4511****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4512****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4513*****************************************************
  4514
  4515         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4516             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4517             20  CF-APPLICATION-FORCE       PIC X.
  4518             20  CF-INDIVIDUAL-APP.
  4519                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4520                     28  CF-BROWSE-APP      PIC X.
  4521                     28  CF-UPDATE-APP      PIC X.
  4522
  4523         16  CF-CURRENT-TERM-ON             PIC X(4).
  4524         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4525             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4526             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4527             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4528             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4529             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4530             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4531             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4532         16  CF-PROCESSOR-CARRIER           PIC X.
  4533             88  NO-CARRIER-SECURITY            VALUE ' '.
  4534         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4535             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4536         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4537             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4538         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4539             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4540
  4541         16  CF-PROC-SYS-ACCESS-SW.
  4542             20  CF-PROC-CREDIT-CLAIMS-SW.
  4543                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4544                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4545                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4546                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4547             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4548                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4549                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4550             20  CF-PROC-LIFE-GNRLDGR-SW.
  4551                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4552                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4553                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4554                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4555             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4556                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  89
* EL156.cbl
  4557                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4558         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4559             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4560             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4561         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4562
  4563         16  CF-APPROVAL-LEVEL                  PIC X.
  4564             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4565             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4566             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4567             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4568             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4569
  4570         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4571
  4572         16  CF-LANGUAGE-TYPE                   PIC X.
  4573             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4574             88  CF-LANG-IS-FR                      VALUE 'F'.
  4575
  4576         16  CF-CSR-IND                         PIC X.
  4577         16  FILLER                             PIC X(239).
  4578
  4579****************************************************************
  4580*             PROCESSOR/REMINDERS RECORD                       *
  4581****************************************************************
  4582
  4583     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4584         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4585             20  CF-START-REMIND-DT         PIC XX.
  4586             20  CF-END-REMIND-DT           PIC XX.
  4587             20  CF-REMINDER-TEXT           PIC X(50).
  4588         16  FILLER                         PIC X(296).
  4589
  4590
  4591****************************************************************
  4592*             STATE MASTER RECORD                              *
  4593****************************************************************
  4594
  4595     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4596         16  CF-STATE-ABBREVIATION          PIC XX.
  4597         16  CF-STATE-NAME                  PIC X(25).
  4598         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4599         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4600             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4601             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4602             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4603             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4604                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4605                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4606             20  CF-ST-PREM-REJECT-SW       PIC X.
  4607                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4608                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4609             20  CF-ST-REF-REJECT-SW        PIC X.
  4610                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4611                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4612         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4613         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4614         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  90
* EL156.cbl
  4615             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4616             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4617             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4618         16  CF-ST-FST-PMT-EXTENSION.
  4619             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4620             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4621                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4622                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4623                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4624                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4625         16  CF-ST-STATE-CALL.
  4626             20  CF-ST-CALL-UNEARNED        PIC X.
  4627             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4628             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4629         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4630             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4631             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4632         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4633         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4634         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4635         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4636         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4637         16  FILLER                         PIC X.
  4638         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4639             20  CF-ST-BENEFIT-CD           PIC XX.
  4640             20  CF-ST-BENEFIT-KIND         PIC X.
  4641                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4642                 88  CF-ST-AH-KIND              VALUE 'A'.
  4643             20  CF-ST-REM-TERM-CALC        PIC X.
  4644                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4645                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4646                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4647                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4648                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4649                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4650                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4651                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4652
  4653             20  CF-ST-REFUND-CALC          PIC X.
  4654                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4655                 88  ST-REFD-BY-R78             VALUE '1'.
  4656                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4657                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4658                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4659                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4660                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4661                 88  ST-REFD-UTAH               VALUE '7'.
  4662                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4663                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4664                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4665
  4666             20  CF-ST-EARNING-CALC         PIC X.
  4667                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4668                 88  ST-EARN-BY-R78             VALUE '1'.
  4669                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4670                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4671                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4672                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  91
* EL156.cbl
  4673                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4674                 88  ST-EARN-MEAN               VALUE '8'.
  4675                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4676
  4677             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4678                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4679                 88  ST-OVRD-BY-R78             VALUE '1'.
  4680                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4681                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4682                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4683                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4684                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4685                 88  ST-OVRD-MEAN               VALUE '8'.
  4686                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4687             20  FILLER                     PIC X.
  4688
  4689         16  CF-ST-COMMISSION-CAPS.
  4690             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4691             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4692             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4693             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4694         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4695                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4696
  4697         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4698
  4699         16  CF-ST-STATUTORY-INTEREST.
  4700             20  CF-ST-STAT-DATE-FROM       PIC X.
  4701                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4702                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4703             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4704             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4705             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4706             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4707             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4708
  4709         16  CF-ST-OVER-SHORT.
  4710             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4711             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4712
  4713         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4714
  4715         16  CF-ST-RT-CALC                  PIC X.
  4716
  4717         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4718         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4719         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4720         16  CF-ST-RF-LR-CALC               PIC X.
  4721         16  CF-ST-RF-LL-CALC               PIC X.
  4722         16  CF-ST-RF-LN-CALC               PIC X.
  4723         16  CF-ST-RF-AH-CALC               PIC X.
  4724         16  CF-ST-RF-CP-CALC               PIC X.
  4725*        16  FILLER                         PIC X(206).
  4726*CIDMOD         16  FILLER                         PIC X(192).
  4727         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4728             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4729         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4730         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  92
* EL156.cbl
  4731         16  CF-ST-CAUSAL-STATE             PIC X.
  4732         16  FILLER                         PIC X(185).
  4733
  4734****************************************************************
  4735*             BENEFIT MASTER RECORD                            *
  4736****************************************************************
  4737
  4738     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4739         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4740             20  CF-BENEFIT-CODE            PIC XX.
  4741             20  CF-BENEFIT-NUMERIC  REDEFINES
  4742                 CF-BENEFIT-CODE            PIC XX.
  4743             20  CF-BENEFIT-ALPHA           PIC XXX.
  4744             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4745             20  CF-BENEFIT-COMMENT         PIC X(10).
  4746
  4747             20  CF-LF-COVERAGE-TYPE        PIC X.
  4748                 88  CF-REDUCING                VALUE 'R'.
  4749                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4750
  4751             20  CF-SPECIAL-CALC-CD         PIC X.
  4752                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4753                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4754                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4755                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4756                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4757                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4758                 88  CF-FARM-PLAN               VALUE 'F'.
  4759                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4760                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4761                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4762                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4763                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4764                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4765                 88  CF-PRUDENTIAL              VALUE 'P'.
  4766                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4767                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4768                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4769                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4770                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4771                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4772
  4773             20  CF-JOINT-INDICATOR         PIC X.
  4774                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4775
  4776*            20  FILLER                     PIC X(12).
  4777             20  FILLER                     PIC X(11).
  4778             20  CF-BENEFIT-CATEGORY        PIC X.
  4779             20  CF-LOAN-TYPE               PIC X(8).
  4780
  4781             20  CF-CO-REM-TERM-CALC        PIC X.
  4782                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4783                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4784                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4785                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4786                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4787
  4788             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  93
* EL156.cbl
  4789                 88  CO-EARN-BY-R78             VALUE '1'.
  4790                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4791                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4792                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4793                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4794                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4795                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4796                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4797
  4798             20  CF-CO-REFUND-CALC          PIC X.
  4799                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4800                 88  CO-REFD-BY-R78             VALUE '1'.
  4801                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4802                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4803                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4804                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4805                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4806                 88  CO-REFD-MEAN               VALUE '8'.
  4807                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4808                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4809                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4810
  4811             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4812                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4813                 88  CO-OVRD-BY-R78             VALUE '1'.
  4814                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4815                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4816                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4817                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4818                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4819                 88  CO-OVRD-MEAN               VALUE '8'.
  4820                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4821
  4822             20  CF-CO-BEN-I-G-CD           PIC X.
  4823                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4824                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4825                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4826
  4827         16  FILLER                         PIC X(304).
  4828
  4829
  4830****************************************************************
  4831*             CARRIER MASTER RECORD                            *
  4832****************************************************************
  4833
  4834     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4835         16  CF-ADDRESS-DATA.
  4836             20  CF-MAIL-TO-NAME            PIC X(30).
  4837             20  CF-IN-CARE-OF              PIC X(30).
  4838             20  CF-ADDRESS-LINE-1          PIC X(30).
  4839             20  CF-ADDRESS-LINE-2          PIC X(30).
  4840             20  CF-CITY-STATE              PIC X(30).
  4841             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4842             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4843
  4844         16  CF-CLAIM-NO-CONTROL.
  4845             20  CF-CLAIM-NO-METHOD         PIC X.
  4846                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  94
* EL156.cbl
  4847                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4848                 88  CLAIM-NO-SEQ               VALUE '3'.
  4849                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4850             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4851                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4852                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4853                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4854
  4855         16  CF-CHECK-NO-CONTROL.
  4856             20  CF-CHECK-NO-METHOD         PIC X.
  4857                 88  CHECK-NO-MANUAL            VALUE '1'.
  4858                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4859                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4860                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4861             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4862                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4863
  4864         16  CF-DOMICILE-STATE              PIC XX.
  4865
  4866         16  CF-EXPENSE-CONTROLS.
  4867             20  CF-EXPENSE-METHOD          PIC X.
  4868                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4869                 88  DOLLARS-PER-PMT            VALUE '2'.
  4870                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4871                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4872             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4873             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4874
  4875         16  CF-CORRESPONDENCE-CONTROL.
  4876             20  CF-LETTER-RESEND-OPT       PIC X.
  4877                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4878                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4879             20  FILLER                     PIC X(4).
  4880
  4881         16  CF-RESERVE-CONTROLS.
  4882             20  CF-MANUAL-SW               PIC X.
  4883                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4884             20  CF-FUTURE-SW               PIC X.
  4885                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4886             20  CF-PTC-SW                  PIC X.
  4887                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4888             20  CF-IBNR-SW                 PIC X.
  4889                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4890             20  CF-PTC-LF-SW               PIC X.
  4891                 88  CF-LF-PTC-USED             VALUE '1'.
  4892             20  CF-CDT-ACCESS-METHOD       PIC X.
  4893                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4894                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4895                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4896             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4897
  4898         16  CF-CLAIM-CALC-METHOD           PIC X.
  4899             88  360-PLUS-MONTHS                VALUE '1'.
  4900             88  365-PLUS-MONTHS                VALUE '2'.
  4901             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4902             88  360-DAILY                      VALUE '4'.
  4903             88  365-DAILY                      VALUE '5'.
  4904
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  95
* EL156.cbl
  4905         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4906         16  FILLER                         PIC X(11).
  4907
  4908         16  CF-LIMIT-AMOUNTS.
  4909             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4910             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4911             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4912             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4913             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4914             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4915             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4916             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4917             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4918             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4919
  4920         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4921         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4922         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4923
  4924         16  CF-ZIP-CODE.
  4925             20  CF-ZIP-PRIME.
  4926                 24  CF-ZIP-1ST             PIC X.
  4927                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4928                 24  FILLER                 PIC X(4).
  4929             20  CF-ZIP-PLUS4               PIC X(4).
  4930         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4931             20  CF-CAN-POSTAL-1            PIC XXX.
  4932             20  CF-CAN-POSTAL-2            PIC XXX.
  4933             20  FILLER                     PIC XXX.
  4934
  4935         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4936         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4937         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4938
  4939         16  CF-RATING-SWITCH               PIC X.
  4940             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4941             88  CF-NO-RATING                   VALUE 'N'.
  4942
  4943         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4944
  4945         16  CF-CARRIER-OVER-SHORT.
  4946             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4947             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4948
  4949         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4950         16  CF-SECPAY-SWITCH               PIC X.
  4951             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4952             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4953         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4954         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4955         16  FILLER                         PIC X(444).
  4956*        16  FILLER                         PIC X(452).
  4957
  4958
  4959****************************************************************
  4960*             MORTALITY MASTER RECORD                          *
  4961****************************************************************
  4962
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  96
* EL156.cbl
  4963     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4964         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4965                                INDEXED BY CF-MORT-NDX.
  4966             20  CF-MORT-TABLE              PIC X(5).
  4967             20  CF-MORT-TABLE-TYPE         PIC X.
  4968                 88  CF-MORT-JOINT              VALUE 'J'.
  4969                 88  CF-MORT-SINGLE             VALUE 'S'.
  4970                 88  CF-MORT-COMBINED           VALUE 'C'.
  4971                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4972                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4973             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4974             20  CF-MORT-AGE-METHOD         PIC XX.
  4975                 88  CF-AGE-LAST                VALUE 'AL'.
  4976                 88  CF-AGE-NEAR                VALUE 'AN'.
  4977             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4978             20  CF-MORT-ADJUSTMENT-DIRECTION
  4979                                            PIC X.
  4980                 88  CF-MINUS                   VALUE '-'.
  4981                 88  CF-PLUS                    VALUE '+'.
  4982             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4983             20  CF-MORT-JOINT-CODE         PIC X.
  4984                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4985             20  CF-MORT-PC-Q               PIC X.
  4986                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4987             20  CF-MORT-TABLE-CODE         PIC X(4).
  4988             20  CF-MORT-COMMENTS           PIC X(15).
  4989             20  FILLER                     PIC X(14).
  4990
  4991         16  FILLER                         PIC X(251).
  4992
  4993
  4994****************************************************************
  4995*             BUSSINESS TYPE MASTER RECORD                     *
  4996****************************************************************
  4997
  4998     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4999* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5000* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5001* AND RECORD 05 IS TYPES 81-99
  5002         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5003             20  CF-BUSINESS-TITLE          PIC  X(19).
  5004             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5005                                            PIC S9V9(4) COMP-3.
  5006             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5007             20  FILLER                     PIC  X.
  5008         16  FILLER                         PIC  X(248).
  5009
  5010
  5011****************************************************************
  5012*             TERMINAL MASTER RECORD                           *
  5013****************************************************************
  5014
  5015     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5016
  5017         16  CF-COMPANY-TERMINALS.
  5018             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5019                                  PIC X(4).
  5020         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  97
* EL156.cbl
  5021
  5022
  5023****************************************************************
  5024*             LIFE EDIT MASTER RECORD                          *
  5025****************************************************************
  5026
  5027     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5028         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5029             20  CF-LIFE-CODE-IN            PIC XX.
  5030             20  CF-LIFE-CODE-OUT           PIC XX.
  5031         16  FILLER                         PIC X(248).
  5032
  5033
  5034****************************************************************
  5035*             AH EDIT MASTER RECORD                            *
  5036****************************************************************
  5037
  5038     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5039         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5040             20  CF-AH-CODE-IN              PIC XXX.
  5041             20  CF-AH-CODE-OUT             PIC XX.
  5042         16  FILLER                         PIC X(248).
  5043
  5044
  5045****************************************************************
  5046*             CREDIBILITY TABLES                               *
  5047****************************************************************
  5048
  5049     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5050         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5051                             INDEXED BY CF-CRDB-NDX.
  5052             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5053             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5054             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5055         16  FILLER                         PIC  X(332).
  5056
  5057
  5058****************************************************************
  5059*             REPORT CUSTOMIZATION RECORD                      *
  5060****************************************************************
  5061
  5062     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5063         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5064             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5065             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5066             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5067**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5068****       A T-TRANSFER.                                   ****
  5069             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5070
  5071         16  FILLER                         PIC XX.
  5072
  5073         16  CF-CARRIER-CNTL-OPT.
  5074             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5075                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5076                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5077             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5078                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  98
* EL156.cbl
  5079         16  CF-GROUP-CNTL-OPT.
  5080             20  CF-GROUP-OPT-SEQ           PIC 9.
  5081                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5082                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5083             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5084                                            PIC X(6).
  5085         16  CF-STATE-CNTL-OPT.
  5086             20  CF-STATE-OPT-SEQ           PIC 9.
  5087                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5088                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5089             20  CF-STATE-SELECT OCCURS 3 TIMES
  5090                                            PIC XX.
  5091         16  CF-ACCOUNT-CNTL-OPT.
  5092             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5093                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5094                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5095             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5096                                            PIC X(10).
  5097         16  CF-BUS-TYP-CNTL-OPT.
  5098             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5099                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5100                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5101             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5102                                            PIC XX.
  5103         16  CF-LF-TYP-CNTL-OPT.
  5104             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5105                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5106                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5107             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5108                                            PIC XX.
  5109         16  CF-AH-TYP-CNTL-OPT.
  5110             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5111                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5112                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5113             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5114                                            PIC XX.
  5115         16  CF-REPTCD1-CNTL-OPT.
  5116             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5117                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5118                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5119             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5120                                            PIC X(10).
  5121         16  CF-REPTCD2-CNTL-OPT.
  5122             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5123                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5124                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5125             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5126                                            PIC X(10).
  5127         16  CF-USER1-CNTL-OPT.
  5128             20  CF-USER1-OPT-SEQ           PIC 9.
  5129                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5130                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5131             20  CF-USER1-SELECT OCCURS 3 TIMES
  5132                                            PIC X(10).
  5133         16  CF-USER2-CNTL-OPT.
  5134             20  CF-USER2-OPT-SEQ           PIC 9.
  5135                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5136                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page  99
* EL156.cbl
  5137             20  CF-USER2-SELECT OCCURS 3 TIMES
  5138                                            PIC X(10).
  5139         16  CF-USER3-CNTL-OPT.
  5140             20  CF-USER3-OPT-SEQ           PIC 9.
  5141                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5142                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5143             20  CF-USER3-SELECT OCCURS 3 TIMES
  5144                                            PIC X(10).
  5145         16  CF-USER4-CNTL-OPT.
  5146             20  CF-USER4-OPT-SEQ           PIC 9.
  5147                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5148                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5149             20  CF-USER4-SELECT OCCURS 3 TIMES
  5150                                            PIC X(10).
  5151         16  CF-USER5-CNTL-OPT.
  5152             20  CF-USER5-OPT-SEQ           PIC 9.
  5153                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5154                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5155             20  CF-USER5-SELECT OCCURS 3 TIMES
  5156                                            PIC X(10).
  5157         16  CF-REINS-CNTL-OPT.
  5158             20  CF-REINS-OPT-SEQ           PIC 9.
  5159                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5160                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5161             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5162                 24  CF-REINS-PRIME         PIC XXX.
  5163                 24  CF-REINS-SUB           PIC XXX.
  5164
  5165         16  CF-AGENT-CNTL-OPT.
  5166             20  CF-AGENT-OPT-SEQ           PIC 9.
  5167                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5168                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5169             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5170                                            PIC X(10).
  5171
  5172         16  FILLER                         PIC X(43).
  5173
  5174         16  CF-LOSS-RATIO-SELECT.
  5175             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5176             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5177         16  CF-ENTRY-DATE-SELECT.
  5178             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5179             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5180         16  CF-EFFECTIVE-DATE-SELECT.
  5181             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5182             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5183
  5184         16  CF-EXCEPTION-LIST-IND          PIC X.
  5185             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5186
  5187         16  FILLER                         PIC X(318).
  5188
  5189****************************************************************
  5190*                  EXCEPTION REPORTING RECORD                  *
  5191****************************************************************
  5192
  5193     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5194         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 100
* EL156.cbl
  5195             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5196
  5197         16  CF-COMBINED-LIFE-AH-OPT.
  5198             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5199             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5200             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5201             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5202
  5203         16  CF-LIFE-OPT.
  5204             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5205             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5206             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5207             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5208             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5209             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5210             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5211             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5212             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5213             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5214
  5215         16  CF-AH-OPT.
  5216             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5217             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5218             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5219             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5220             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5221             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5222             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5223             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5224             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5225             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5226
  5227         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5228             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5229             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5230             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5231
  5232         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5233
  5234         16  FILLER                         PIC X(673).
  5235
  5236
  5237****************************************************************
  5238*             MORTGAGE SYSTEM PLAN RECORD                      *
  5239****************************************************************
  5240
  5241     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5242         16  CF-PLAN-TYPE                   PIC X.
  5243             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5244             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5245             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5246         16  CF-PLAN-ABBREV                 PIC XXX.
  5247         16  CF-PLAN-DESCRIPT               PIC X(10).
  5248         16  CF-PLAN-NOTES                  PIC X(20).
  5249         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5250         16  CF-PLAN-UNDERWRITING.
  5251             20  CF-PLAN-TERM-DATA.
  5252                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 101
* EL156.cbl
  5253                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5254             20  CF-PLAN-AGE-DATA.
  5255                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5256                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5257                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5258             20  CF-PLAN-BENEFIT-DATA.
  5259                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5260                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5261                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5262                                            PIC S9(7)V99  COMP-3.
  5263         16  CF-PLAN-POLICY-FORMS.
  5264             20  CF-POLICY-FORM             PIC X(12).
  5265             20  CF-MASTER-APPLICATION      PIC X(12).
  5266             20  CF-MASTER-POLICY           PIC X(12).
  5267         16  CF-PLAN-RATING.
  5268             20  CF-RATE-CODE               PIC X(5).
  5269             20  CF-SEX-RATING              PIC X.
  5270                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5271                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5272             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5273             20  CF-SUB-STD-TYPE            PIC X.
  5274                 88  CF-PCT-OF-PREM            VALUE '1'.
  5275                 88  CF-PCT-OF-BENE            VALUE '2'.
  5276         16  CF-PLAN-PREM-TOLERANCES.
  5277             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5278             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5279         16  CF-PLAN-PYMT-TOLERANCES.
  5280             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5281             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5282         16  CF-PLAN-MISC-DATA.
  5283             20  FILLER                     PIC X.
  5284             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5285             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5286         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5287         16  CF-PLAN-IND-GRP                PIC X.
  5288             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5289                                                     '1'.
  5290             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5291                                                     '2'.
  5292         16  CF-MIB-SEARCH-SW               PIC X.
  5293             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5294             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5295             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5296             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5297         16  CF-ALPHA-SEARCH-SW             PIC X.
  5298             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5299             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5300             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5301             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5302             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5303             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5304             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5305             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5306             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5307             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5308                                                     'A' 'B' 'C'
  5309                                                     'X' 'Y' 'Z'.
  5310         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 102
* EL156.cbl
  5311             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5312             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5313             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5314             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5315             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5316         16  FILLER                         PIC X(4).
  5317         16  CF-HEALTH-QUESTIONS            PIC X.
  5318             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5319         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5320         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5321         16  CF-PLAN-SNGL-JNT               PIC X.
  5322             88  CF-COMBINED-PLAN              VALUE 'C'.
  5323             88  CF-JNT-PLAN                   VALUE 'J'.
  5324             88  CF-SNGL-PLAN                  VALUE 'S'.
  5325         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5326         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5327         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5328         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5329         16  CF-RERATE-CNTL                 PIC  X.
  5330             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5331             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5332             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5333             88  CF-AUTO-RECALC                 VALUE '4'.
  5334         16  CF-BENEFIT-TYPE                PIC  X.
  5335             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5336             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5337         16  CF-POLICY-FEE                  PIC S999V99
  5338                                                    COMP-3.
  5339         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5340         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5341         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5342         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5343         16  FILLER                         PIC  X(32).
  5344         16  CF-TERMINATION-FORM            PIC  X(04).
  5345         16  FILLER                         PIC  X(08).
  5346         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5347                                                       COMP-3.
  5348         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5349         16  CF-ISSUE-LETTER                PIC  X(4).
  5350         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5351         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5352             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5353             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5354         16  CF-MP-REFUND-CALC              PIC X.
  5355             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5356             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5357             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5358             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5359             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5360             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5361             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5362             88  CF-MP-REFD-MEAN                VALUE '8'.
  5363         16  CF-ALT-RATE-CODE               PIC  X(5).
  5364
  5365
  5366         16  FILLER                         PIC X(498).
  5367****************************************************************
  5368*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 103
* EL156.cbl
  5369****************************************************************
  5370
  5371     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5372         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5373         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5374             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5375             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5376             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5377             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5378             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5379
  5380         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5381         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5382         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5383         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5384         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5385
  5386         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5387             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5388         16  CF-MP-RECON-USE-IND            PIC X(1).
  5389             88  CF-MP-USE-RECON             VALUE 'Y'.
  5390         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5391             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5392         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5393             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5394             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5395         16  FILLER                         PIC X(1).
  5396         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5397             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5398         16  CF-MORTG-MIB-VERSION           PIC X.
  5399             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5400             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5401             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5402         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5403             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5404                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5405             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5406                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5407             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5408                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5409             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5410                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5411             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5412                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5413             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5414                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5415         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5416         16  FILLER                         PIC X(7).
  5417         16  CF-MORTG-DESTINATION-SYMBOL.
  5418             20  CF-MORTG-MIB-COMM          PIC X(5).
  5419             20  CF-MORTG-MIB-TERM          PIC X(5).
  5420         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5421             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5422         16  FILLER                         PIC X(03).
  5423         16  CF-MP-CHECK-NO-CONTROL.
  5424             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5425                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5426                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 104
* EL156.cbl
  5427                                                ' ' LOW-VALUES.
  5428                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5429                                               VALUE '3'.
  5430         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5431         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5432         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5433             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5434                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5435             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5436                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5437             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5438                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5439             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5440                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5441             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5442                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5443             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5444                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5445         16  CF-MORTG-BILLING-AREA.
  5446             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5447                                            PIC X.
  5448         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5449         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5450         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5451         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5452             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5453             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5454         16  FILLER                         PIC X.
  5455         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5456             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5457             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5458         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5459         16  FILLER                         PIC X(8).
  5460         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5461         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5462         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5463         16  CF-ACH-COMPANY-ID.
  5464             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5465                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5466                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5467                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5468             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5469         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5470             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5471         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5472             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5473             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5474         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5475         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5476         16  FILLER                         PIC X(536).
  5477
  5478****************************************************************
  5479*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5480****************************************************************
  5481
  5482     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5483         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5484             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 105
* EL156.cbl
  5485                 24  CF-FEMALE-FT           PIC 99.
  5486                 24  CF-FEMALE-IN           PIC 99.
  5487             20  CF-FEMALE-MIN-WT           PIC 999.
  5488             20  CF-FEMALE-MAX-WT           PIC 999.
  5489         16  FILLER                         PIC X(428).
  5490
  5491     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5492         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5493             20  CF-MALE-HEIGHT.
  5494                 24  CF-MALE-FT             PIC 99.
  5495                 24  CF-MALE-IN             PIC 99.
  5496             20  CF-MALE-MIN-WT             PIC 999.
  5497             20  CF-MALE-MAX-WT             PIC 999.
  5498         16  FILLER                         PIC X(428).
  5499******************************************************************
  5500*             AUTOMATIC ACTIVITY RECORD                          *
  5501******************************************************************
  5502     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5503         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5504             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5505             20  CF-SYS-LETTER-ID           PIC X(04).
  5506             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5507             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5508             20  CF-SYS-RESET-SW            PIC X(01).
  5509             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5510             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5511
  5512         16  FILLER                         PIC X(50).
  5513
  5514         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5515             20  CF-USER-ACTIVE-SW          PIC X(01).
  5516             20  CF-USER-LETTER-ID          PIC X(04).
  5517             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5518             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5519             20  CF-USER-RESET-SW           PIC X(01).
  5520             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5521             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5522             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5523
  5524         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 106
* EL156.cbl
  5526*    COPY ELCCERT.
  5527******************************************************************
  5528*                                                                *
  5529*                            ELCCERT.                            *
  5530*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5531*                            VMOD=2.013                          *
  5532*                                                                *
  5533*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5534*                                                                *
  5535*   FILE TYPE = VSAM,KSDS                                        *
  5536*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5537*                                                                *
  5538*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5539*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5540*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5541*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5542*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5543*                                                                *
  5544*   LOG = YES                                                    *
  5545*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5546******************************************************************
  5547*                   C H A N G E   L O G
  5548*
  5549* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5550*-----------------------------------------------------------------
  5551*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5552* EFFECTIVE    NUMBER
  5553*-----------------------------------------------------------------
  5554* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5555* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5556* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5557* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5558* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5559* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5560* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5561* 032612  CR2011110200001  PEMA  AHL CHANGES
  5562******************************************************************
  5563
  5564 01  CERTIFICATE-MASTER.
  5565     12  CM-RECORD-ID                      PIC XX.
  5566         88  VALID-CM-ID                      VALUE 'CM'.
  5567
  5568     12  CM-CONTROL-PRIMARY.
  5569         16  CM-COMPANY-CD                 PIC X.
  5570         16  CM-CARRIER                    PIC X.
  5571         16  CM-GROUPING.
  5572             20  CM-GROUPING-PREFIX        PIC X(3).
  5573             20  CM-GROUPING-PRIME         PIC X(3).
  5574         16  CM-STATE                      PIC XX.
  5575         16  CM-ACCOUNT.
  5576             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5577             20  CM-ACCOUNT-PRIME          PIC X(6).
  5578         16  CM-CERT-EFF-DT                PIC XX.
  5579         16  CM-CERT-NO.
  5580             20  CM-CERT-PRIME             PIC X(10).
  5581             20  CM-CERT-SFX               PIC X.
  5582
  5583     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 107
* EL156.cbl
  5584         16  CM-COMPANY-CD-A1              PIC X.
  5585         16  CM-INSURED-LAST-NAME          PIC X(15).
  5586         16  CM-INSURED-INITIALS.
  5587             20  CM-INSURED-INITIAL1       PIC X.
  5588             20  CM-INSURED-INITIAL2       PIC X.
  5589
  5590     12  CM-CONTROL-BY-SSN.
  5591         16  CM-COMPANY-CD-A2              PIC X.
  5592         16  CM-SOC-SEC-NO.
  5593             20  CM-SSN-STATE              PIC XX.
  5594             20  CM-SSN-ACCOUNT            PIC X(6).
  5595             20  CM-SSN-LN3.
  5596                 25  CM-INSURED-INITIALS-A2.
  5597                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5598                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5599                 25 CM-PART-LAST-NAME-A2         PIC X.
  5600
  5601     12  CM-CONTROL-BY-CERT-NO.
  5602         16  CM-COMPANY-CD-A4              PIC X.
  5603         16  CM-CERT-NO-A4                 PIC X(11).
  5604
  5605     12  CM-CONTROL-BY-MEMB.
  5606         16  CM-COMPANY-CD-A5              PIC X.
  5607         16  CM-MEMBER-NO.
  5608             20  CM-MEMB-STATE             PIC XX.
  5609             20  CM-MEMB-ACCOUNT           PIC X(6).
  5610             20  CM-MEMB-LN4.
  5611                 25  CM-INSURED-INITIALS-A5.
  5612                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5613                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5614                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5615
  5616     12  CM-INSURED-PROFILE-DATA.
  5617         16  CM-INSURED-FIRST-NAME.
  5618             20  CM-INSURED-1ST-INIT       PIC X.
  5619             20  FILLER                    PIC X(9).
  5620         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5621         16  CM-INSURED-SEX                PIC X.
  5622             88  CM-SEX-MALE                  VALUE 'M'.
  5623             88  CM-SEX-FEMAL                 VALUE 'F'.
  5624         16  CM-INSURED-JOINT-AGE          PIC 99.
  5625         16  CM-JOINT-INSURED-NAME.
  5626             20  CM-JT-LAST-NAME           PIC X(15).
  5627             20  CM-JT-FIRST-NAME.
  5628                 24  CM-JT-1ST-INIT        PIC X.
  5629                 24  FILLER                PIC X(9).
  5630             20  CM-JT-INITIAL             PIC X.
  5631
  5632     12  CM-LIFE-DATA.
  5633         16  CM-LF-BENEFIT-CD              PIC XX.
  5634         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5635         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5636         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5637         16  CM-LF-DEV-CODE                PIC XXX.
  5638         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5639         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5640         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5641         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 108
* EL156.cbl
  5642         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5643         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5644         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5645         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5646         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5647         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5648         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5649         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5650         16  FILLER                        PIC XX.
  5651
  5652     12  CM-AH-DATA.
  5653         16  CM-AH-BENEFIT-CD              PIC XX.
  5654         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5655         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5656         16  CM-AH-DEV-CODE                PIC XXX.
  5657         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5658         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5659         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5660         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5661         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5662         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5663         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5664         16  CM-AH-PAID-THRU-DT            PIC XX.
  5665             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5666         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5667         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5668         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5669         16  FILLER                        PIC X.
  5670
  5671     12  CM-LOAN-INFORMATION.
  5672         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5673         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5674                                           PIC S9(5)V99  COMP-3.
  5675         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5676         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5677         16  CM-PAY-FREQUENCY              PIC S99.
  5678         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5679         16  CM-RATE-CLASS                 PIC XX.
  5680         16  CM-BENEFICIARY                PIC X(25).
  5681         16  CM-POLICY-FORM-NO             PIC X(12).
  5682         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5683         16  CM-LAST-ADD-ON-DT             PIC XX.
  5684         16  CM-DEDUCTIBLE-AMOUNTS.
  5685             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5686             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5687         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5688             20  CM-RESIDENT-STATE         PIC XX.
  5689             20  CM-RATE-CODE              PIC X(4).
  5690             20  FILLER                    PIC XX.
  5691         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5692             20  CM-LOAN-OFFICER           PIC X(5).
  5693             20  FILLER                    PIC XXX.
  5694         16  CM-CSR-CODE                   PIC XXX.
  5695         16  CM-UNDERWRITING-CODE          PIC X.
  5696             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5697         16  CM-POST-CARD-IND              PIC X.
  5698         16  CM-NH-INTERFACE-SW            PIC X.
  5699         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 109
* EL156.cbl
  5700             88  CM-SING-PRM                  VALUE '1'.
  5701             88  CM-O-B-COVERAGE              VALUE '2'.
  5702             88  CM-OPEN-END                  VALUE '3'.
  5703         16  CM-IND-GRP-TYPE               PIC X.
  5704             88  CM-INDIVIDUAL                VALUE 'I'.
  5705             88  CM-GROUP                     VALUE 'G'.
  5706         16  CM-SKIP-CODE                  PIC X.
  5707             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5708             88  SKIP-JULY                    VALUE '1'.
  5709             88  SKIP-AUGUST                  VALUE '2'.
  5710             88  SKIP-SEPTEMBER               VALUE '3'.
  5711             88  SKIP-JULY-AUG                VALUE '4'.
  5712             88  SKIP-AUG-SEPT                VALUE '5'.
  5713             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5714             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5715             88  SKIP-JUNE                    VALUE '8'.
  5716             88  SKIP-JUNE-JULY               VALUE '9'.
  5717             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5718             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5719         16  CM-PAYMENT-MODE               PIC X.
  5720             88  PAY-MONTHLY                  VALUE SPACE.
  5721             88  PAY-WEEKLY                   VALUE '1'.
  5722             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5723             88  PAY-BI-WEEKLY                VALUE '3'.
  5724             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5725         16  CM-LOAN-NUMBER                PIC X(8).
  5726         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5727         16  CM-OLD-LOF                    PIC XXX.
  5728*        16  CM-LOAN-OFFICER               PIC XXX.
  5729         16  CM-REIN-TABLE                 PIC XXX.
  5730         16  CM-SPECIAL-REIN-CODE          PIC X.
  5731         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5732         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5733         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5734
  5735     12  CM-STATUS-DATA.
  5736         16  CM-ENTRY-STATUS               PIC X.
  5737         16  CM-ENTRY-DT                   PIC XX.
  5738
  5739         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5740         16  CM-LF-CANCEL-DT               PIC XX.
  5741         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5742
  5743         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5744         16  CM-LF-DEATH-DT                PIC XX.
  5745         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5746
  5747         16  CM-LF-CURRENT-STATUS          PIC X.
  5748             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5749                                                'M' '4' '5' '9'.
  5750             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5751             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5752             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5753             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5754             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5755             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5756             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5757             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 110
* EL156.cbl
  5758             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5759             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5760             88  CM-LF-DECLINED               VALUE 'D'.
  5761             88  CM-LF-VOIDED                 VALUE 'V'.
  5762
  5763         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5764         16  CM-AH-CANCEL-DT               PIC XX.
  5765         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5766
  5767         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5768         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5769         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5770
  5771         16  CM-AH-CURRENT-STATUS          PIC X.
  5772             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5773                                                'M' '4' '5' '9'.
  5774             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5775             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5776             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5777             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5778             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5779             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5780             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5781             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5782             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5783             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5784             88  CM-AH-DECLINED               VALUE 'D'.
  5785             88  CM-AH-VOIDED                 VALUE 'V'.
  5786
  5787         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5788             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5789             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5790             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5791         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5792
  5793         16  CM-ENTRY-BATCH                PIC X(6).
  5794         16  CM-LF-EXIT-BATCH              PIC X(6).
  5795         16  CM-AH-EXIT-BATCH              PIC X(6).
  5796         16  CM-LAST-MONTH-END             PIC XX.
  5797
  5798     12  CM-NOTE-SW                        PIC X.
  5799         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5800         88  CERT-NOTES-PRESENT               VALUE '1'.
  5801         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5802         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5803         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5804         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5805         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5806         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5807     12  CM-COMP-EXCP-SW                   PIC X.
  5808         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5809         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5810     12  CM-INSURED-ADDRESS-SW             PIC X.
  5811         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5812         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5813
  5814*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5815     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 111
* EL156.cbl
  5816     12  FILLER                            PIC X.
  5817
  5818*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5819     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5820     12  FILLER                            PIC X.
  5821*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5822     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5823
  5824     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5825         88  CERT-ADDED-BATCH                 VALUE ' '.
  5826         88  CERT-ADDED-ONLINE                VALUE '1'.
  5827         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5828         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5829         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5830     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5831         88  CERT-AS-LOADED                   VALUE ' '.
  5832         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5833         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5834         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5835         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5836         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5837         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5838         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5839
  5840     12  CM-ACCOUNT-COMM-PCTS.
  5841         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5842         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5843
  5844     12  CM-USER-FIELD                     PIC X.
  5845     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5846     12  CM-CLP-STATE                      PIC XX.
  5847     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5848     12  CM-USER-RESERVED                  PIC XXX.
  5849     12  FILLER REDEFINES CM-USER-RESERVED.
  5850         16  CM-AH-CLASS-CD                PIC XX.
  5851         16  F                             PIC X.
  5852******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 112
* EL156.cbl
  5854*    COPY ELCTRLR.
  5855******************************************************************
  5856*                                                                *
  5857*                            ELCTRLR.                            *
  5858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5859*                            VMOD=2.014                          *
  5860*                                                                *
  5861*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5862*                                                                *
  5863*   FILE TYPE = VSAM,KSDS                                        *
  5864*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5865*                                                                *
  5866*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5867*       ALTERNATE INDEX = NONE                                   *
  5868*                                                                *
  5869*   LOG = YES                                                    *
  5870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5871******************************************************************
  5872*                   C H A N G E   L O G
  5873*
  5874* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5875*-----------------------------------------------------------------
  5876*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5877* EFFECTIVE    NUMBER
  5878*-----------------------------------------------------------------
  5879* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5880* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5881* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5882* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5883* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5884* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5885* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5886* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5887* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5888* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5889* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5890* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5891* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5892* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5893* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5894* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5895* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5896******************************************************************
  5897 01  ACTIVITY-TRAILERS.
  5898     12  AT-RECORD-ID                    PIC XX.
  5899         88  VALID-AT-ID                       VALUE 'AT'.
  5900
  5901     12  AT-CONTROL-PRIMARY.
  5902         16  AT-COMPANY-CD               PIC X.
  5903         16  AT-CARRIER                  PIC X.
  5904         16  AT-CLAIM-NO                 PIC X(7).
  5905         16  AT-CERT-NO.
  5906             20  AT-CERT-PRIME           PIC X(10).
  5907             20  AT-CERT-SFX             PIC X.
  5908         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5909             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5910             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5911             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 113
* EL156.cbl
  5912             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5913             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5914             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5915             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5916             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5917             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5918             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5919             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5920             88  AT-BENEFICIARY-TRL           VALUE +91.
  5921             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5922             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5923             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5924             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5925
  5926     12  AT-TRAILER-TYPE                 PIC X.
  5927         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5928         88  PAYMENT-TR                       VALUE '2'.
  5929         88  AUTO-PAY-TR                      VALUE '3'.
  5930         88  CORRESPONDENCE-TR                VALUE '4'.
  5931         88  ADDRESS-TR                       VALUE '5'.
  5932         88  GENERAL-INFO-TR                  VALUE '6'.
  5933         88  AUTO-PROMPT-TR                   VALUE '7'.
  5934         88  DENIAL-TR                        VALUE '8'.
  5935         88  INCURRED-CHG-TR                  VALUE '9'.
  5936         88  FORM-CONTROL-TR                  VALUE 'A'.
  5937
  5938     12  AT-RECORDED-DT                  PIC XX.
  5939     12  AT-RECORDED-BY                  PIC X(4).
  5940     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5941
  5942     12  AT-TRAILER-BODY                 PIC X(165).
  5943
  5944     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5945         16  AT-RESERVE-CONTROLS.
  5946             20  AT-MANUAL-SW            PIC X.
  5947                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5948             20  AT-FUTURE-SW            PIC X.
  5949                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5950             20  AT-PTC-SW               PIC X.
  5951                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5952             20  AT-IBNR-SW              PIC X.
  5953                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5954             20  AT-PTC-LF-SW            PIC X.
  5955                 88  AT-LF-PTC-USED          VALUE '1'.
  5956             20  AT-CDT-ACCESS-METHOD    PIC X.
  5957                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5958                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5959                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5960             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5961         16  AT-LAST-COMPUTED-DT         PIC XX.
  5962         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5963         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5964         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5965         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5966         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5967         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5968         16  AT-EXPENSE-CONTROLS.
  5969             20  AT-EXPENSE-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 114
* EL156.cbl
  5970                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5971                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5972                 88  PERCENT-OF-PMT           VALUE '3'.
  5973                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5974             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5975             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5976         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5977         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5978
  5979         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5980         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5981
  5982*        16  FILLER                      PIC X(53).
  5983         16  FILLER                      PIC X(47).
  5984
  5985         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5986         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5987
  5988         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5989             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5990             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5991*                    C = CLOSED
  5992*                    O = OPEN
  5993             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5994*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5995
  5996     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5997         16  AT-PAYMENT-TYPE             PIC X.
  5998             88  PARTIAL-PAYMENT                VALUE '1'.
  5999             88  FINAL-PAYMENT                  VALUE '2'.
  6000             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6001             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6002             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6003             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6004             88  VOIDED-PAYMENT                 VALUE '9'.
  6005             88  TRANSFER                       VALUE 'T'.
  6006             88  LIFE-INTEREST                  VALUE 'I'.
  6007
  6008         16  AT-CLAIM-TYPE               PIC X.
  6009             88  PAID-FOR-AH                    VALUE 'A'.
  6010             88  PAID-FOR-LIFE                  VALUE 'L'.
  6011             88  PAID-FOR-IUI                   VALUE 'I'.
  6012             88  PAID-FOR-GAP                   VALUE 'G'.
  6013         16  AT-CLAIM-PREM-TYPE          PIC X.
  6014             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6015             88  AT-O-B-COVERAGE                VALUE '2'.
  6016             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6017         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6018         16  AT-CHECK-NO                 PIC X(7).
  6019         16  AT-PAID-FROM-DT             PIC XX.
  6020         16  AT-PAID-THRU-DT             PIC XX.
  6021         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6022         16  FILLER                      PIC X.
  6023         16  AT-PAYEES-NAME              PIC X(30).
  6024         16  AT-PAYMENT-ORIGIN           PIC X.
  6025             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6026             88  ONLINE-AUTO-PMT                VALUE '2'.
  6027             88  OFFLINE-PMT                    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 115
* EL156.cbl
  6028         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6029         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6030         16  AT-VOID-DATA.
  6031             20  AT-VOID-DT              PIC XX.
  6032*00144       20  AT-VOID-REASON          PIC X(30).
  6033             20  AT-VOID-REASON          PIC X(26).
  6034         16  AT-PMT-APPROVED-BY          PIC X(04).
  6035         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6036         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6037         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6038                                         PIC S99V9(5)  COMP-3.
  6039         16  AT-CREDIT-INTERFACE.
  6040             20  AT-PMT-SELECT-DT        PIC XX.
  6041                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6042             20  AT-PMT-ACCEPT-DT        PIC XX.
  6043                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6044             20  AT-VOID-SELECT-DT       PIC XX.
  6045                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6046             20  AT-VOID-ACCEPT-DT       PIC XX.
  6047                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6048
  6049         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6050                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6051                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6052         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6053
  6054         16  AT-FORCE-CONTROL            PIC X.
  6055             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6056         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6057         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6058         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6059         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6060         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6061         16  AT-BENEFIT-TYPE             PIC X.
  6062
  6063         16  AT-EXPENSE-TYPE             PIC X.
  6064         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6065
  6066         16  AT-PAYEE-TYPE-CD.
  6067             20  AT-PAYEE-TYPE           PIC X.
  6068                 88  INSURED-PAID           VALUE 'I'.
  6069                 88  BENEFICIARY-PAID       VALUE 'B'.
  6070                 88  ACCOUNT-PAID           VALUE 'A'.
  6071                 88  OTHER-1-PAID           VALUE 'O'.
  6072                 88  OTHER-2-PAID           VALUE 'Q'.
  6073                 88  DOCTOR-PAID            VALUE 'P'.
  6074                 88  EMPLOYER-PAID          VALUE 'E'.
  6075             20  AT-PAYEE-SEQ            PIC X.
  6076
  6077         16  AT-CASH-PAYMENT             PIC X.
  6078         16  AT-GROUPED-PAYMENT          PIC X.
  6079         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6080         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6081         16  AT-APPROVED-LEVEL           PIC X.
  6082         16  AT-VOID-TYPE                PIC X.
  6083             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6084             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6085         16  AT-AIG-UNEMP-IND            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 116
* EL156.cbl
  6086             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6087         16  AT-ASSOCIATES               PIC X.
  6088             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6089             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6090
  6091         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6092         16  AT-CV-PMT-CODE              PIC X.
  6093             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6094             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6095             88  FULL-ADD-PAYMENT           VALUE '3'.
  6096             88  HALF-ADD-PAYMENT           VALUE '4'.
  6097             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6098             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6099             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6100             88  ADDL-PAYMENT               VALUE '8'.
  6101
  6102         16  AT-EOB-CODE1                PIC XXX.
  6103         16  AT-EOB-CODE2                PIC XXX.
  6104         16  AT-EOB-CODE3                PIC XXX.
  6105         16  FILLER REDEFINES AT-EOB-CODE3.
  6106             20  AT-PRINT-CLM-FORM       PIC X.
  6107             20  AT-PRINT-SURVEY         PIC X.
  6108             20  AT-SPECIAL-RELEASE      PIC X.
  6109         16  AT-EOB-CODE4                PIC XXX.
  6110         16  FILLER REDEFINES AT-EOB-CODE4.
  6111             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6112             20  FILLER                  PIC X.
  6113         16  AT-EOB-CODE5                PIC XXX.
  6114         16  FILLER REDEFINES AT-EOB-CODE5.
  6115             20  AT-PMT-PROOF-DT         PIC XX.
  6116             20  FILLER                  PIC X.
  6117
  6118         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6119             88  AT-PRINT-EOB            VALUE 'Y'.
  6120
  6121         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6122         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6123
  6124     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6125         16  AT-SCHEDULE-START-DT        PIC XX.
  6126         16  AT-SCHEDULE-END-DT          PIC XX.
  6127         16  AT-TERMINATED-DT            PIC XX.
  6128         16  AT-LAST-PMT-TYPE            PIC X.
  6129             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6130             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6131         16  AT-FIRST-PMT-DATA.
  6132             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6133             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6134             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6135         16  AT-REGULAR-PMT-DATA.
  6136             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6137             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6138             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6139         16  AT-AUTO-PAYEE-CD.
  6140             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6141                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6142                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6143                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 117
* EL156.cbl
  6144                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6145                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6146             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6147         16  AT-AUTO-PAY-DAY             PIC 99.
  6148         16  AT-AUTO-CASH                PIC X.
  6149             88  AT-CASH                      VALUE 'Y'.
  6150             88  AT-NON-CASH                  VALUE 'N'.
  6151*        16  FILLER                      PIC X(129).
  6152         16  AT-AUTO-END-LETTER          PIC X(4).
  6153         16  FILLER                      PIC X(125).
  6154
  6155         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6156         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6157
  6158     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6159         16  AT-LETTER-SENT-DT           PIC XX.
  6160         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6161         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6162         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6163         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6164         16  AT-LETTER-ORIGIN            PIC X.
  6165             88  ONLINE-CREATION              VALUE '1' '3'.
  6166             88  OFFLINE-CREATION             VALUE '2' '4'.
  6167             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6168             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6169         16  AT-STD-LETTER-FORM          PIC X(4).
  6170         16  AT-REASON-TEXT              PIC X(70).
  6171         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6172         16  AT-ADDRESEE-TYPE            PIC X.
  6173              88  INSURED-ADDRESEE            VALUE 'I'.
  6174              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6175              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6176              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6177              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6178              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6179              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6180         16  AT-ADDRESSEE-NAME           PIC X(30).
  6181         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6182         16  AT-RESEND-PRINT-DATE        PIC XX.
  6183         16  AT-CORR-SOL-UNSOL           PIC X.
  6184         16  AT-LETTER-PURGED-DT         PIC XX.
  6185*
  6186*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6187*
  6188         16  AT-CSO-REDEFINITION.
  6189             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6190             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6191             20  AT-LETTER-TO-BENE       PIC X(1).
  6192             20  AT-STOP-LETTER-DT       PIC X(2).
  6193             20  FILLER                  PIC X(19).
  6194*             20  FILLER                  PIC X(27).
  6195             20  AT-CSO-LETTER-STATUS    PIC X.
  6196                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6197                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6198                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6199             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6200             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6201*
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 118
* EL156.cbl
  6202*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6203*
  6204*        16  FILLER                      PIC X(26).
  6205*
  6206*        16  AT-DMD-BSR-CODE             PIC X.
  6207*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6208*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6209*
  6210*        16  AT-DMD-LETTER-STATUS        PIC X.
  6211*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6212*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6213*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6214*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6215*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6216
  6217         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6218         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6219
  6220     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6221         16  AT-ADDRESS-TYPE             PIC X.
  6222             88  INSURED-ADDRESS               VALUE 'I'.
  6223             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6224             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6225             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6226             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6227             88  OTHER-ADDRESS-1               VALUE 'O'.
  6228             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6229         16  AT-MAIL-TO-NAME             PIC X(30).
  6230         16  AT-ADDRESS-LINE-1           PIC X(30).
  6231         16  AT-ADDRESS-LINE-2           PIC X(30).
  6232         16  AT-CITY-STATE.
  6233             20  AT-CITY                 PIC X(28).
  6234             20  AT-STATE                PIC XX.
  6235         16  AT-ZIP.
  6236             20  AT-ZIP-CODE.
  6237                 24  AT-ZIP-1ST          PIC X.
  6238                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6239                 24  FILLER              PIC X(4).
  6240             20  AT-ZIP-PLUS4            PIC X(4).
  6241         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6242             20  AT-CAN-POSTAL-1         PIC XXX.
  6243             20  AT-CAN-POSTAL-2         PIC XXX.
  6244             20  FILLER                  PIC XXX.
  6245         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6246*         16  FILLER                      PIC X(23).
  6247         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6248         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6249         16  FILLER                      PIC X(13).
  6250         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6251         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6252
  6253     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6254         16  AT-INFO-LINE-1              PIC X(60).
  6255         16  FILLER REDEFINES AT-INFO-LINE-1.
  6256             20  AT-NOTE-ERROR-NO OCCURS 15
  6257                                         PIC X(4).
  6258         16  AT-INFO-LINE-2              PIC X(60).
  6259         16  AT-INFO-TRAILER-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 119
* EL156.cbl
  6260             88  AT-ERRORS-NOTE          VALUE 'E'.
  6261             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6262             88  AT-CALL-NOTE            VALUE 'C'.
  6263             88  AT-MAINT-NOTE           VALUE 'M'.
  6264             88  AT-CERT-CHANGE          VALUE 'X'.
  6265             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6266             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6267         16  AT-CALL-TYPE                PIC X.
  6268             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6269             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6270         16  AT-NOTE-CONTINUATION        PIC X.
  6271             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6272         16  AT-EOB-CODES-EXIST          PIC X.
  6273             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6274         16  FILLER                      PIC X(35).
  6275         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6276         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6277
  6278     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6279         16  AT-PROMPT-LINE-1            PIC X(60).
  6280         16  AT-PROMPT-LINE-2            PIC X(60).
  6281         16  AT-PROMPT-START-DT          PIC XX.
  6282         16  AT-PROMPT-END-DT            PIC XX.
  6283         16  FILLER                      PIC X(35).
  6284         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6285         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6286
  6287     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6288         16  AT-DENIAL-INFO-1            PIC X(60).
  6289         16  AT-DENIAL-INFO-2            PIC X(60).
  6290         16  AT-DENIAL-DT                PIC XX.
  6291         16  AT-RETRACTION-DT            PIC XX.
  6292         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6293*         16  FILLER                      PIC X(31).
  6294         16  AT-DENIAL-PROOF-DT          PIC XX.
  6295         16  FILLER                      PIC X(29).
  6296         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6297         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6298
  6299     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6300         16  AT-OLD-INCURRED-DT          PIC XX.
  6301         16  AT-OLD-REPORTED-DT          PIC XX.
  6302         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6303         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6304         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6305         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6306         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6307         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6308         16  FILLER                      PIC X(26).
  6309         16  AT-OLD-DIAG-CODE            PIC X(6).
  6310         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6311         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6312         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6313         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6314         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6315         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6316         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6317         16  FILLER                      PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 120
* EL156.cbl
  6318         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6319
  6320     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6321         16  AT-FORM-SEND-ON-DT          PIC XX.
  6322         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6323         16  AT-FORM-RE-SEND-DT          PIC XX.
  6324         16  AT-FORM-ANSWERED-DT         PIC XX.
  6325         16  AT-FORM-PRINTED-DT          PIC XX.
  6326         16  AT-FORM-REPRINT-DT          PIC XX.
  6327         16  AT-FORM-TYPE                PIC X.
  6328             88  INITIAL-FORM                  VALUE '1'.
  6329             88  PROGRESS-FORM                 VALUE '2'.
  6330         16  AT-INSTRUCT-LN-1            PIC X(28).
  6331         16  AT-INSTRUCT-LN-2            PIC X(28).
  6332         16  AT-INSTRUCT-LN-3            PIC X(28).
  6333         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6334         16  AT-FORM-ADDRESS             PIC X.
  6335             88  FORM-TO-INSURED              VALUE 'I'.
  6336             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6337             88  FORM-TO-OTHER-1              VALUE 'O'.
  6338             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6339         16  AT-RELATED-1.
  6340             20 AT-REL-CARR-1            PIC X.
  6341             20 AT-REL-CLAIM-1           PIC X(7).
  6342             20 AT-REL-CERT-1            PIC X(11).
  6343         16  AT-RELATED-2.
  6344             20 AT-REL-CARR-2            PIC X.
  6345             20 AT-REL-CLAIM-2           PIC X(7).
  6346             20 AT-REL-CERT-2            PIC X(11).
  6347         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6348         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6349         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6350         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6351         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6352         16  AT-STOP-FORM-DT             PIC X(2).
  6353
  6354         16  FILLER                      PIC X(09).
  6355         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6356         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6357******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 121
* EL156.cbl
  6359*    COPY ELCACTQ.
  6360******************************************************************
  6361*                                                                *
  6362*                            ELCACTQ.                            *
  6363*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6364*                            VMOD=2.004                          *
  6365*                                                                *
  6366*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6367*                                                                *
  6368*   FILE TYPE = VSAM,KSDS                                        *
  6369*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6370*                                                                *
  6371*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6372*       ALTERNATE INDEX = NONE                                   *
  6373*                                                                *
  6374*   LOG = YES                                                    *
  6375*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6376*                                                                *
  6377*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6378******************************************************************
  6379
  6380 01  ACTIVITY-QUE.
  6381     12  AQ-RECORD-ID                PIC XX.
  6382         88  VALID-AQ-ID                VALUE 'AQ'.
  6383
  6384     12  AQ-CONTROL-PRIMARY.
  6385         16  AQ-COMPANY-CD           PIC X.
  6386         16  AQ-CARRIER              PIC X.
  6387         16  AQ-CLAIM-NO             PIC X(7).
  6388         16  AQ-CERT-NO.
  6389             20  AQ-CERT-PRIME       PIC X(10).
  6390             20  AQ-CERT-SFX         PIC X.
  6391
  6392     12  AQ-PENDING-ACTIVITY-FLAGS.
  6393         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6394         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6395             88  PENDING-PAYMENTS       VALUE '1'.
  6396         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6397             88  PENDING-FULL-PRINT     VALUE '1'.
  6398             88  PENDING-PART-PRINT     VALUE '2'.
  6399         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6400             88  PENDING-LETTERS        VALUE '1'.
  6401         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6402             88  PENDING-RESTORE        VALUE 'C'.
  6403             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6404
  6405     12  FILLER                      PIC X(20).
  6406
  6407     12  AQ-RESEND-DATE              PIC XX.
  6408     12  AQ-FOLLOWUP-DATE            PIC XX.
  6409     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6410     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6411     12  AQ-AUTO-LETTER              PIC X(4).
  6412     12  FILLER                      PIC XX.
  6413     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6414*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 122
* EL156.cbl
  6416*    COPY ERCACCT.
  6417******************************************************************
  6418*                                                                *
  6419*                                                                *
  6420*                            ERCACCT                             *
  6421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6422*                            VMOD=2.031                          *
  6423*                                                                *
  6424*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6425*                                                                *
  6426*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6427*   VSAM ACCOUNT MASTER FILES.                                   *
  6428*                                                                *
  6429*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6430*                                                                *
  6431*   FILE TYPE = VSAM,KSDS                                        *
  6432*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6433*                                                                *
  6434*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6435*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6436*                                                                *
  6437*   LOG = NO                                                     *
  6438*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6439*                                                                *
  6440*                                                                *
  6441******************************************************************
  6442*                   C H A N G E   L O G
  6443*
  6444* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6445*-----------------------------------------------------------------
  6446*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6447* EFFECTIVE    NUMBER
  6448*-----------------------------------------------------------------
  6449* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6450* 092705    2005050300006  PEMA  ADD SPP LEASES
  6451* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6452* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6453* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6454* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6455* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6456******************************************************************
  6457
  6458 01  ACCOUNT-MASTER.
  6459     12  AM-RECORD-ID                      PIC XX.
  6460         88  VALID-AM-ID                      VALUE 'AM'.
  6461
  6462     12  AM-CONTROL-PRIMARY.
  6463         16  AM-COMPANY-CD                 PIC X.
  6464         16  AM-MSTR-CNTRL.
  6465             20  AM-CONTROL-A.
  6466                 24  AM-CARRIER            PIC X.
  6467                 24  AM-GROUPING.
  6468                     28 AM-GROUPING-PREFIX PIC XXX.
  6469                     28 AM-GROUPING-PRIME  PIC XXX.
  6470                 24  AM-STATE              PIC XX.
  6471                 24  AM-ACCOUNT.
  6472                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6473                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 123
* EL156.cbl
  6474             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6475                                           PIC X(19).
  6476             20  AM-CNTRL-B.
  6477                 24  AM-EXPIRATION-DT      PIC XX.
  6478                 24  FILLER                PIC X(4).
  6479             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6480                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6481
  6482     12  AM-CONTROL-BY-VAR-GRP.
  6483         16  AM-COMPANY-CD-A1              PIC X.
  6484         16  AM-VG-CARRIER                 PIC X.
  6485         16  AM-VG-GROUPING                PIC X(6).
  6486         16  AM-VG-STATE                   PIC XX.
  6487         16  AM-VG-ACCOUNT                 PIC X(10).
  6488         16  AM-VG-DATE.
  6489             20  AM-VG-EXPIRATION-DT       PIC XX.
  6490             20  FILLER                    PIC X(4).
  6491         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6492                                           PIC 9(11)      COMP-3.
  6493     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6494         16  FILLER                        PIC X(10).
  6495         16  AM-VG-KEY3.
  6496             20  AM-VG3-ACCOUNT            PIC X(10).
  6497             20  AM-VG3-EXP-DT             PIC XX.
  6498         16  FILLER                        PIC X(4).
  6499     12  AM-MAINT-INFORMATION.
  6500         16  AM-LAST-MAINT-DT              PIC XX.
  6501         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6502         16  AM-LAST-MAINT-USER            PIC X(4).
  6503         16  FILLER                        PIC XX.
  6504
  6505     12  AM-EFFECTIVE-DT                   PIC XX.
  6506     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6507
  6508     12  AM-PREV-DATES  COMP-3.
  6509         16  AM-PREV-EXP-DT                PIC 9(11).
  6510         16  AM-PREV-EFF-DT                PIC 9(11).
  6511
  6512     12  AM-REPORT-CODE-1                  PIC X(10).
  6513     12  AM-REPORT-CODE-2                  PIC X(10).
  6514
  6515     12  AM-CITY-CODE                      PIC X(4).
  6516     12  AM-COUNTY-PARISH                  PIC X(6).
  6517
  6518     12  AM-NAME                           PIC X(30).
  6519     12  AM-PERSON                         PIC X(30).
  6520     12  AM-ADDRS                          PIC X(30).
  6521     12  AM-CITY.
  6522         16  AM-ADDR-CITY                  PIC X(28).
  6523         16  AM-ADDR-STATE                 PIC XX.
  6524     12  AM-ZIP.
  6525         16  AM-ZIP-PRIME.
  6526             20  AM-ZIP-PRI-1ST            PIC X.
  6527                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6528             20  FILLER                    PIC X(4).
  6529         16  AM-ZIP-PLUS4                  PIC X(4).
  6530     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6531         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 124
* EL156.cbl
  6532         16  AM-CAN-POSTAL-2               PIC XXX.
  6533         16  FILLER                        PIC XXX.
  6534     12  AM-TEL-NO.
  6535         16  AM-AREA-CODE                  PIC 999.
  6536         16  AM-TEL-PRE                    PIC 999.
  6537         16  AM-TEL-NBR                    PIC 9(4).
  6538     12  AM-TEL-LOC                        PIC X.
  6539         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6540         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6541
  6542     12  AM-COMM-STRUCTURE.
  6543         16  AM-DEFN-1.
  6544             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6545                 24  AM-AGT.
  6546                     28  AM-AGT-PREFIX     PIC X(4).
  6547                     28  AM-AGT-PRIME      PIC X(6).
  6548                 24  AM-COM-TYP            PIC X.
  6549                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6550                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6551                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6552                 24  AM-RECALC-LV-INDIC    PIC X.
  6553                 24  AM-RETRO-LV-INDIC     PIC X.
  6554                 24  AM-GL-CODES           PIC X.
  6555                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6556                 24  FILLER                PIC X(01).
  6557         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6558             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6559                 24  FILLER                PIC X(11).
  6560                 24  AM-L-COMA             PIC XXX.
  6561                 24  AM-J-COMA             PIC XXX.
  6562                 24  AM-A-COMA             PIC XXX.
  6563                 24  FILLER                PIC X(6).
  6564
  6565     12  AM-COMM-CHANGE-STATUS             PIC X.
  6566         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6567
  6568     12  AM-CSR-CODE                       PIC X(4).
  6569
  6570     12  AM-BILLING-STATUS                 PIC X.
  6571         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6572         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6573     12  AM-AUTO-REFUND-SW                 PIC X.
  6574         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6575         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6576     12  AM-GPCD                           PIC 99.
  6577     12  AM-IG                             PIC X.
  6578         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6579         88  AM-HAS-GROUP                     VALUE '2'.
  6580     12  AM-STATUS                         PIC X.
  6581         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6582         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6583         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6584         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6585         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6586         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6587     12  AM-REMIT-TO                       PIC 99.
  6588     12  AM-ID-NO                          PIC X(11).
  6589
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 125
* EL156.cbl
  6590     12  AM-CAL-TABLE                      PIC XX.
  6591     12  AM-LF-DEVIATION                   PIC XXX.
  6592     12  AM-AH-DEVIATION                   PIC XXX.
  6593     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6594     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6595     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6596     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6597     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6598     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6599
  6600     12  AM-USER-FIELDS.
  6601         16  AM-FLD-1                      PIC XX.
  6602         16  AM-FLD-2                      PIC XX.
  6603         16  AM-FLD-3                      PIC XX.
  6604         16  AM-FLD-4                      PIC XX.
  6605         16  AM-FLD-5                      PIC XX.
  6606
  6607     12  AM-1ST-PROD-DATE.
  6608         16  AM-1ST-PROD-YR                PIC XX.
  6609         16  AM-1ST-PROD-MO                PIC XX.
  6610         16  AM-1ST-PROD-DA                PIC XX.
  6611     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6612     12  AM-CERTS-PURGED-DATE.
  6613         16  AM-PUR-YR                     PIC XX.
  6614         16  AM-PUR-MO                     PIC XX.
  6615         16  AM-PUR-DA                     PIC XX.
  6616     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6617     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6618     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6619     12  AM-INACTIVE-DATE.
  6620         16  AM-INA-MO                     PIC 99.
  6621         16  AM-INA-DA                     PIC 99.
  6622         16  AM-INA-YR                     PIC 99.
  6623     12  AM-AR-HI-CERT-DATE                PIC XX.
  6624
  6625     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6626     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6627
  6628     12  AM-OB-PAYMENT-MODE                PIC X.
  6629         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6630         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6631         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6632         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6633
  6634     12  AM-AH-ONLY-INDICATOR              PIC X.
  6635         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6636         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6637
  6638     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6639
  6640     12  AM-OVER-SHORT.
  6641         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6642         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6643
  6644     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6645     12  AM-DCC-CLP-STATE                  PIC XX.
  6646
  6647     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 126
* EL156.cbl
  6648     12  AM-RECALC-REIN                    PIC X.
  6649
  6650     12  AM-REI-TABLE                      PIC XXX.
  6651     12  AM-REI-ET-LF                      PIC X.
  6652     12  AM-REI-ET-AH                      PIC X.
  6653     12  AM-REI-PE-LF                      PIC X.
  6654     12  AM-REI-PE-AH                      PIC X.
  6655     12  AM-REI-PRT-ST                     PIC X.
  6656     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6657     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6658     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6659     12  AM-REI-GROUP-A                    PIC X(6).
  6660     12  AM-REI-MORT                       PIC X(4).
  6661     12  AM-REI-PRT-OW                     PIC X.
  6662     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6663     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6664     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6665     12  AM-REI-GROUP-B                    PIC X(6).
  6666
  6667     12  AM-TRUST-TYPE                     PIC X(2).
  6668
  6669     12  AM-EMPLOYER-STMT-USED             PIC X.
  6670     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6671
  6672     12  AM-STD-AH-TYPE                    PIC XX.
  6673     12  AM-EARN-METHODS.
  6674         16  AM-EARN-METHOD-R              PIC X.
  6675             88 AM-REF-RL-R78                 VALUE 'R'.
  6676             88 AM-REF-RL-PR                  VALUE 'P'.
  6677             88 AM-REF-RL-MEAN                VALUE 'M'.
  6678             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6679         16  AM-EARN-METHOD-L              PIC X.
  6680             88 AM-REF-LL-R78                 VALUE 'R'.
  6681             88 AM-REF-LL-PR                  VALUE 'P'.
  6682             88 AM-REF-LL-MEAN                VALUE 'M'.
  6683             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6684         16  AM-EARN-METHOD-A              PIC X.
  6685             88 AM-REF-AH-R78                 VALUE 'R'.
  6686             88 AM-REF-AH-PR                  VALUE 'P'.
  6687             88 AM-REF-AH-MEAN                VALUE 'M'.
  6688             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6689             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6690             88 AM-REF-AH-NET                 VALUE 'N'.
  6691
  6692     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6693     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6694     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6695
  6696     12  AM-RET-Y-N                        PIC X.
  6697     12  AM-RET-P-E                        PIC X.
  6698     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6699     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6700     12  AM-RET-GRP                        PIC X(6).
  6701     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6702         16  AM-POOL-PRIME                 PIC XXX.
  6703         16  AM-POOL-SUB                   PIC XXX.
  6704     12  AM-RETRO-EARNINGS.
  6705         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 127
* EL156.cbl
  6706         16  AM-RET-EARN-L                 PIC X.
  6707         16  AM-RET-EARN-A                 PIC X.
  6708     12  AM-RET-ST-TAX-USE                 PIC X.
  6709         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6710         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6711     12  AM-RETRO-BEG-EARNINGS.
  6712         16  AM-RET-BEG-EARN-R             PIC X.
  6713         16  AM-RET-BEG-EARN-L             PIC X.
  6714         16  AM-RET-BEG-EARN-A             PIC X.
  6715     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6716     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6717
  6718     12  AM-USER-SELECT-OPTIONS.
  6719         16  AM-USER-SELECT-1              PIC X(10).
  6720         16  AM-USER-SELECT-2              PIC X(10).
  6721         16  AM-USER-SELECT-3              PIC X(10).
  6722         16  AM-USER-SELECT-4              PIC X(10).
  6723         16  AM-USER-SELECT-5              PIC X(10).
  6724
  6725     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6726
  6727     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6728
  6729     12  AM-RPT045A-SWITCH                 PIC X.
  6730         88  RPT045A-OFF                   VALUE 'N'.
  6731
  6732     12  AM-INSURANCE-LIMITS.
  6733         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6734         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6735
  6736     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6737         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6738
  6739     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6740         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6741         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6742
  6743     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6744
  6745     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6746     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6747     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6748     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6749     12  AM-DCC-UEF-STATE                  PIC XX.
  6750     12  FILLER                            PIC XXX.
  6751     12  AM-REPORT-CODE-3                  PIC X(10).
  6752*    12  FILLER                            PIC X(22).
  6753
  6754     12  AM-RESERVE-DATE.
  6755         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6756         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6757         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6758
  6759     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6760     12  AM-NOTIFICATION-TYPES.
  6761         16  AM-NOTIF-OF-LETTERS           PIC X.
  6762         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6763         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 128
* EL156.cbl
  6764         16  AM-NOTIF-OF-STATUS            PIC X.
  6765
  6766     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6767         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6768         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6769         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6770         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6771
  6772     12  AM-BENEFIT-CONTROLS.
  6773         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6774             20  AM-BENEFIT-CODE           PIC XX.
  6775             20  AM-BENEFIT-TYPE           PIC X.
  6776             20  AM-BENEFIT-REVISION       PIC XXX.
  6777             20  AM-BENEFIT-REM-TERM       PIC X.
  6778             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6779             20  FILLER                    PIC XX.
  6780         16  FILLER                        PIC X(80).
  6781
  6782     12  AM-TRANSFER-DATA.
  6783         16  AM-TRANSFERRED-FROM.
  6784             20  AM-TRNFROM-CARRIER        PIC X.
  6785             20  AM-TRNFROM-GROUPING.
  6786                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6787                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6788             20  AM-TRNFROM-STATE          PIC XX.
  6789             20  AM-TRNFROM-ACCOUNT.
  6790                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6791                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6792             20  AM-TRNFROM-DTE            PIC XX.
  6793         16  AM-TRANSFERRED-TO.
  6794             20  AM-TRNTO-CARRIER          PIC X.
  6795             20  AM-TRNTO-GROUPING.
  6796                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6797                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6798             20  AM-TRNTO-STATE            PIC XX.
  6799             20  AM-TRNTO-ACCOUNT.
  6800                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6801                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6802             20  AM-TRNTO-DTE              PIC XX.
  6803         16  FILLER                        PIC X(10).
  6804
  6805     12  AM-SAVED-REMIT-TO                 PIC 99.
  6806
  6807     12  AM-COMM-STRUCTURE-SAVED.
  6808         16  AM-DEFN-1-SAVED.
  6809             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6810                 24  AM-AGT-SV             PIC X(10).
  6811                 24  AM-COM-TYP-SV         PIC X.
  6812                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6813                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6814                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6815                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6816                 24  FILLER                PIC X.
  6817                 24  AM-GL-CODES-SV        PIC X.
  6818                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6819                 24  FILLER                PIC X.
  6820         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6821             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 129
* EL156.cbl
  6822                 24  FILLER                PIC X(11).
  6823                 24  AM-L-COMA-SV          PIC XXX.
  6824                 24  AM-J-COMA-SV          PIC XXX.
  6825                 24  AM-A-COMA-SV          PIC XXX.
  6826                 24  FILLER                PIC X(6).
  6827
  6828     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6829         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6830            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6831            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6832            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6833
  6834     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6835     12  FILLER                            PIC X(120).
  6836
  6837     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6838         16  AM-CONTROL-NAME               PIC X(30).
  6839         16  AM-EXECUTIVE-ONE.
  6840             20  AM-EXEC1-NAME             PIC X(15).
  6841             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6842                                                          COMP-3.
  6843             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6844                                                          COMP-3.
  6845         16  AM-EXECUTIVE-TWO.
  6846             20  AM-EXEC2-NAME             PIC X(15).
  6847             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6848                                                          COMP-3.
  6849             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6850                                                          COMP-3.
  6851
  6852     12  AM-RETRO-ADDITIONAL-DATA.
  6853         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6854         16  AM-RETRO-PREM-P-E             PIC X.
  6855         16  AM-RETRO-CLMS-P-I             PIC X.
  6856         16  AM-RETRO-RET-BRACKET-LF.
  6857             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6858                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6859                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6860             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6861                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6862                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6863             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6864                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6865                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6866         16  AM-RETRO-RET-BRACKET-AH.
  6867             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6868                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6869                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6870                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6871             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6872                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6873                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6874             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6875                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6876                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6877
  6878     12  AM-COMMENTS.
  6879         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 130
* EL156.cbl
  6880
  6881     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6882         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6883         16  AM-FLI-BILLING-CODE           PIC X.
  6884         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6885         16  AM-FLI-UNITED-IDENT           PIC X.
  6886         16  AM-FLI-INTEREST-LOST-DATA.
  6887             20  AM-FLI-BANK-NO            PIC X(5).
  6888             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6889             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6890             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6891         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6892             20  AM-FLI-AGT                PIC X(9).
  6893             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6894             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6895         16  FILLER                        PIC X(102).
  6896
  6897     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6898         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6899             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6900             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6901             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6902             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6903             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6904         16  FILLER                          PIC X(10).
  6905******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 131
* EL156.cbl
  6907*    COPY ELCCHKQ.
  6908******************************************************************
  6909*                                                                *
  6910*                                                                *
  6911*                            ELCCHKQ.                            *
  6912*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6913*                            VMOD=2.007                          *
  6914*                                                                *
  6915*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6916*                                                                *
  6917*   FILE TYPE = VSAM,KSDS                                        *
  6918*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6919*                                                                *
  6920*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6921*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6922*                                                                *
  6923*   LOG = YES                                                    *
  6924*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6925******************************************************************
  6926 01  CHECK-QUE.
  6927     12  CQ-RECORD-ID                PIC XX.
  6928         88  VALID-CQ-ID         VALUE 'CQ'.
  6929
  6930     12  CQ-CONTROL-PRIMARY.
  6931         16  CQ-COMPANY-CD           PIC X.
  6932         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6933         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6934
  6935     12  CQ-CONTROL-BY-PAYEE.
  6936         16  CQ-CONTROL-BY-NUMBER.
  6937             20  CQ-COMPANY-CD-A1     PIC X.
  6938             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6939         16  CQ-PAYEE-CARRIER        PIC X.
  6940         16  CQ-PAYEE-GROUPING       PIC X(6).
  6941         16  CQ-PAYEE-STATE          PIC XX.
  6942         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6943         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6944
  6945     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6946         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6947         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6948         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6949         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6950         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6951         16  FILLER                  PIC X(3).
  6952
  6953     12  CQ-ENTRY-TYPE               PIC X.
  6954             88  CHECK-ON-QUE           VALUE 'Q'.
  6955             88  ALIGNMENT-CHECK        VALUE 'A'.
  6956             88  SPOILED-CHECK          VALUE 'S'.
  6957             88  PAYMENT-ABORTED        VALUE 'X'.
  6958
  6959     12  CQ-CLAIM-MAST-CNTL.
  6960         16  CQ-CARRIER              PIC X.
  6961         16  CQ-CLAIM-NO             PIC X(7).
  6962         16  CQ-CERT-NO.
  6963             20  CQ-CERT-PRIME       PIC X(10).
  6964             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 132
* EL156.cbl
  6965         16  CQ-CLAIM-TYPE           PIC X.
  6966             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6967             88  CQ-AH-CLAIM            VALUE 'A'.
  6968         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6969             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6970             88  CQ-O-B-COVERAGE        VALUE '2'.
  6971             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6972
  6973     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6974     12  CQ-CHECK-NUMBER             PIC X(7).
  6975     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6976     12  CQ-PAYMENT-TYPE             PIC X.
  6977             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6978             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6979             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6980             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6981             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6982             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6983             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6984             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6985     12  CQ-VOID-INDICATOR           PIC X.
  6986             88  CHECK-IS-STOPPED          VALUE 'S'.
  6987             88  CHECK-IS-VOID             VALUE 'V'.
  6988     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6989     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6990     12  CQ-CHECK-BY-USER            PIC X(4).
  6991     12  CQ-PRE-NUMBERING-SW         PIC X.
  6992       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6993       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6994
  6995     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6996     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6997     12  CQ-LEDGER-FLAG              PIC X(01).
  6998     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6999     12  CQ-LAST-UPDATED-DT          PIC XX.
  7000     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7001     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7002
  7003     12  FILLER                      PIC X(04).
  7004
  7005******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 133
* EL156.cbl
  7007*    COPY ELCBENE.
  7008******************************************************************
  7009*                                                                *
  7010*                            ELCBENE.                            *
  7011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7012*                            VMOD=2.006                          *
  7013*                                                                *
  7014*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7015*                                                                *
  7016*   FILE TYPE = VSAM,KSDS                                        *
  7017*   RECORD SIZE = 500   RECFORM = FIX                            *
  7018*                                                                *
  7019*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7020*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7021*                                                                *
  7022*   LOG = YES                                                    *
  7023*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7024*                                                                *
  7025*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7026******************************************************************
  7027
  7028 01  BENEFICIARY-MASTER.
  7029     12  BE-RECORD-ID                PIC XX.
  7030         88  VALID-BE-ID                VALUE 'BE'.
  7031
  7032     12  BE-CONTROL-PRIMARY.
  7033         16  BE-COMPANY-CD           PIC X.
  7034         16  BE-RECORD-TYPE          PIC X.
  7035             88  BENEFICIARY-RECORD  VALUE 'B'.
  7036             88  ADJUSTOR-RECORD     VALUE 'A'.
  7037         16  BE-BENEFICIARY          PIC X(10).
  7038     12  BE-CONTROL-BY-NAME.
  7039         16  BE-COMPANY-CD-A1        PIC X.
  7040         16  BE-RECORD-TYPE-A1       PIC X.
  7041         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7042         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7043
  7044     12  BE-LAST-MAINT-DT            PIC XX.
  7045     12  BE-LAST-MAINT-BY            PIC X(4).
  7046     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7047
  7048     12  BE-ADDRESS-DATA.
  7049         16  BE-MAIL-TO-NAME         PIC X(30).
  7050         16  BE-ADDRESS-LINE-1       PIC X(30).
  7051         16  BE-ADDRESS-LINE-2       PIC X(30).
  7052         16  BE-ADDRESS-LINE-3       PIC X(30).
  7053         16  BE-CITY-STATE.
  7054             20  BE-CITY             PIC X(28).
  7055             20  BE-STATE            PIC XX.
  7056         16  BE-ZIP-CODE.
  7057             20  BE-ZIP-PRIME.
  7058                 24  BE-ZIP-1ST      PIC X.
  7059                     88  BE-CANADIAN-POST-CODE
  7060                                         VALUE 'A' THRU 'Z'.
  7061                 24  FILLER          PIC X(4).
  7062             20  BE-ZIP-PLUS4        PIC X(4).
  7063         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7064             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 134
* EL156.cbl
  7065             20  BE-CAN-POSTAL-2     PIC XXX.
  7066             20  FILLER              PIC XXX.
  7067         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7068         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7069
  7070******************************************************************
  7071*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7072*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7073******************************************************************
  7074     12  BE-CARRIER                  PIC X.
  7075
  7076     12  BE-ADDRESS-DATA2.
  7077         16  BE-MAIL-TO-NAME2        PIC X(30).
  7078         16  BE-ADDRESS-LINE-12      PIC X(30).
  7079         16  BE-ADDRESS-LINE-22      PIC X(30).
  7080         16  BE-ADDRESS-LINE-32      PIC X(30).
  7081         16  BE-CITY-STATE2.
  7082             20  BE-CITY2            PIC X(28).
  7083             20  BE-STATE2           PIC XX.
  7084         16  BE-ZIP-CODE2.
  7085             20  BE-ZIP-PRIME2.
  7086                 24  BE-ZIP-1ST2     PIC X.
  7087                     88  BE-CANADIAN-POST-CODE2
  7088                                         VALUE 'A' THRU 'Z'.
  7089                 24  FILLER          PIC X(4).
  7090             20  BE-ZIP-PLUS42       PIC X(4).
  7091         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7092             20  BE-CAN-POSTAL-12    PIC XXX.
  7093             20  BE-CAN-POSTAL-22    PIC XXX.
  7094             20  FILLER              PIC XXX.
  7095         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7096         16  BE-BILLING-STMT-DATA.
  7097             20  BE-BSR              PIC X.
  7098                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7099                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7100             20  BE-BSR-FROM         PIC X(30).
  7101             20  BE-BSR-DEPT         PIC X(30).
  7102             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7103             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7104             20  BE-OUTPUT-TYPE      PIC X.
  7105                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7106                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7107
  7108     12  FILLER                      PIC X(28).
  7109******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 135
* EL156.cbl
  7111*    COPY ELCARCH.
  7112******************************************************************
  7113*                                                                *
  7114*                            ELCARCH.                            *
  7115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7116*                            VMOD=2.007                          *
  7117*                                                                *
  7118*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7119*                                                                *
  7120*   FILE TYPE = VSAM,KSDS                                        *
  7121*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7122*                                                                *
  7123*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7124*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7125*                                                                *
  7126*   LOG = NO                                                     *
  7127*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7128*                                                                *
  7129*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7130******************************************************************
  7131 01  LETTER-ARCHIVE.
  7132     12  LA-RECORD-ID                PIC XX.
  7133         88  VALID-LA-ID                VALUE 'LA'.
  7134
  7135     12  LA-CONTROL-PRIMARY.
  7136         16  LA-COMPANY-CD           PIC X.
  7137         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7138         16  LA-RECORD-TYPE          PIC X.
  7139             88  LA-HEADER-DATA         VALUE '1'.
  7140             88  LA-ADDRESS-DATA        VALUE '2'.
  7141             88  LA-TEXT-DATA           VALUE '3'.
  7142             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7143         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7144
  7145     12  LA-CONTROL-BY-TYPE.
  7146         16  LA-COMPANY-CD-A1        PIC X.
  7147         16  LA-RECORD-TYPE-A1       PIC X.
  7148         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7149         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7150
  7151     12  LA-TEXT-RECORD.
  7152         16  LA-SKIP-CONTROL         PIC XX.
  7153             88  NO-LINES-SKIPPED       VALUE SPACES.
  7154             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7155         16  LA-TEXT-LINE            PIC X(70).
  7156
  7157     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7158         16  FILLER                  PIC XX.
  7159         16  LA-ADDRESS-LINE         PIC X(30).
  7160         16  FILLER                  PIC X(40).
  7161
  7162     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7163         16  FILLER                  PIC XX.
  7164         16  LA-CARRIER              PIC X.
  7165         16  LA-CLAIM-NO             PIC X(7).
  7166         16  LA-CERT-NO.
  7167             20  LA-CERT-PRIME       PIC X(10).
  7168             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 136
* EL156.cbl
  7169         16  LA-NO-OF-COPIES         PIC S9.
  7170         16  LA-RESEND-DATE          PIC XX.
  7171         16  LA-PROCESSOR-CD         PIC X(4).
  7172         16  LA-CREATION-DT          PIC XX.
  7173         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7174         16  LA-RESEND-PRINT-DATE    PIC XX.
  7175         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7176         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7177*
  7178* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7179*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7180*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7181*   I        20  LA-DMD-RES-ST           PIC XX.
  7182*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7183*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7184*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7185*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7186*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7187*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7188*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7189*   I        20  LA-DMD-UND-CODE         PIC XX.
  7190*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7191*   V    16  FILLER                  PIC X(15).
  7192* -----
  7193*
  7194* REINSERTED  CSO  MODS
  7195*
  7196         16  FILLER.
  7197             20  FILLER                  PIC X(29).
  7198             20  LA-CSO-LETTER-STATUS    PIC X.
  7199                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7200                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7201                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7202             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7203             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7204*
  7205
  7206     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7207         16  FILLER                  PIC XX.
  7208         16  LA4-CARRIER             PIC X.
  7209         16  LA4-CLAIM-NO            PIC X(7).
  7210         16  LA4-CERT-NO.
  7211             20  LA4-CERT-PRIME      PIC X(10).
  7212             20  LA4-CERT-SFX        PIC X.
  7213         16  LA4-NO-OF-COPIES        PIC S9.
  7214         16  LA4-RESEND-DATE         PIC XX.
  7215         16  LA4-PROCESSOR-CD        PIC X(4).
  7216         16  LA4-CREATION-DT         PIC XX.
  7217         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7218         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7219         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7220         16  LA4-FORM-TYPE           PIC X.
  7221             88  LA4-INITIAL-FORM    VALUE '1'.
  7222             88  LA4-PROGRESS-FORM   VALUE '2'.
  7223         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7224         16  LA4-STATE               PIC X(02).
  7225         16  FILLER                  PIC X(31).
  7226******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 137
* EL156.cbl
  7228*    COPY ELCDAR.
  7229******************************************************************
  7230*                                                                *
  7231*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7232*   FILE TYPE = VSAM,KSDS                                        *
  7233*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7234*   BASE CLUSTER = DLYACTV                                       *
  7235*   LOG = YES                                                    *
  7236*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7237*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7238*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7239*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7240*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7241*               BY PROGRAM "LGINFCE".                            *
  7242*                                                                *
  7243******************************************************************
  7244 01  DAILY-ACTIVITY-RECORD.
  7245     05  DA-KEY.
  7246         10  DA-COMP-CD          PIC X.
  7247         10  DA-CARRIER          PIC X.
  7248         10  DA-CLAIM-NO         PIC X(7).
  7249         10  DA-CERT-NO.
  7250             15  DA-CERT-PRIME   PIC X(10).
  7251             15  DA-CERT-SFX     PIC X.
  7252     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7253     05  DA-RECORD-TYPE          PIC X.
  7254     05  FILLER                  PIC X(2).
  7255******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 138
* EL156.cbl
  7257*    COPY ERCCOMP.
  7258******************************************************************
  7259*                                                                *
  7260*                                                                *
  7261*                            ERCCOMP                             *
  7262*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7263*                            VMOD=2.019                          *
  7264*                                                                *
  7265*   ONLINE CREDIT SYSTEM                                         *
  7266*                                                                *
  7267*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7268*                                                                *
  7269*   FILE TYPE = VSAM,KSDS                                        *
  7270*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7271*                                                                *
  7272*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7273*       ALTERNATE PATH = NONE                                    *
  7274*                                                                *
  7275*   LOG = NO                                                     *
  7276*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7277*                                                                *
  7278******************************************************************
  7279*                   C H A N G E   L O G
  7280*
  7281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7282*-----------------------------------------------------------------
  7283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7284* EFFECTIVE    NUMBER
  7285*-----------------------------------------------------------------
  7286* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7287* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7288* 092205    2005050300006  PEMA  ADD LEASE FEE
  7289* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7290* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7291* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7292* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7293* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7294* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7295******************************************************************
  7296
  7297 01  COMPENSATION-MASTER.
  7298     12  CO-RECORD-ID                          PIC XX.
  7299         88  VALID-CO-ID                          VALUE 'CO'.
  7300
  7301     12  CO-CONTROL-PRIMARY.
  7302         16  CO-COMPANY-CD                     PIC X.
  7303         16  CO-CONTROL.
  7304             20  CO-CTL-1.
  7305                 24  CO-CARR-GROUP.
  7306                     28  CO-CARRIER            PIC X.
  7307                     28  CO-GROUPING.
  7308                         32  CO-GROUP-PREFIX   PIC XXX.
  7309                         32  CO-GROUP-PRIME    PIC XXX.
  7310                 24  CO-RESP-NO.
  7311                     28  CO-RESP-PREFIX        PIC X(4).
  7312                     28  CO-RESP-PRIME         PIC X(6).
  7313             20  CO-CTL-2.
  7314                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 139
* EL156.cbl
  7315                     28  CO-ACCT-PREFIX        PIC X(4).
  7316                     28  CO-ACCT-PRIME         PIC X(6).
  7317         16  CO-TYPE                           PIC X.
  7318             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7319             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7320             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7321
  7322     12  CO-MAINT-INFORMATION.
  7323         16  CO-LAST-MAINT-DT                  PIC XX.
  7324         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7325         16  CO-LAST-MAINT-USER                PIC X(4).
  7326     12  FILLER                                PIC XX.
  7327     12  CO-STMT-TYPE                          PIC XXX.
  7328     12  CO-COMP-TYPE                          PIC X.
  7329         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7330     12  CO-STMT-OWNER                         PIC X(4).
  7331     12  CO-BALANCE-CONTROL                    PIC X.
  7332         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7333         88  CO-NO-BALANCE                        VALUE 'N'.
  7334
  7335     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7336         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7337         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7338         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7339
  7340     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7341         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7342         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7343
  7344     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7345     12  CO-GA-DIRECT-DEP                      PIC X.
  7346     12  CO-FUTURE-SPACE                       PIC X.
  7347         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7348
  7349     12  CO-ACCT-NAME                          PIC X(30).
  7350     12  CO-MAIL-NAME                          PIC X(30).
  7351     12  CO-ADDR-1                             PIC X(30).
  7352     12  CO-ADDR-2                             PIC X(30).
  7353     12  CO-ADDR-3.
  7354         16  CO-ADDR-CITY                      PIC X(27).
  7355         16  CO-ADDR-STATE                     PIC XX.
  7356     12  CO-CSO-1099                           PIC X.
  7357     12  CO-ZIP.
  7358         16  CO-ZIP-PRIME.
  7359             20  CO-ZIP-PRI-1ST                PIC X.
  7360                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7361             20  FILLER                        PIC X(4).
  7362         16  CO-ZIP-PLUS4                      PIC X(4).
  7363     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7364         16  CO-CAN-POSTAL-1                   PIC XXX.
  7365         16  CO-CAN-POSTAL-2                   PIC XXX.
  7366         16  FILLER                            PIC XXX.
  7367     12  CO-SOC-SEC                            PIC X(13).
  7368     12  CO-TELEPHONE.
  7369         16  CO-AREA-CODE                      PIC XXX.
  7370         16  CO-PREFIX                         PIC XXX.
  7371         16  CO-PHONE                          PIC X(4).
  7372
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 140
* EL156.cbl
  7373     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7374
  7375     12  CO-AR-BAL-LEVEL                       PIC X.
  7376         88  CO-AR-REF-LVL                        VALUE '1'.
  7377         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7378         88  CO-AR-BILL-LVL                       VALUE '2'.
  7379         88  CO-AR-AGT-LVL                        VALUE '3'.
  7380         88  CO-AR-FR-LVL                         VALUE '4'.
  7381
  7382     12  CO-AR-NORMAL-PRINT                    PIC X.
  7383         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7384         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7385
  7386     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7387
  7388     12  CO-AR-REPORTING                       PIC X.
  7389         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7390         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7391
  7392     12  CO-AR-PULL-CHECK                      PIC X.
  7393         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7394         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7395
  7396     12  CO-AR-BALANCE-PRINT                   PIC X.
  7397         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7398
  7399     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7400         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7401         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7402         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7403
  7404     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7405
  7406     12  CO-USER-CODE                          PIC X.
  7407     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7408
  7409******************************************************************
  7410*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7411*    THE LAST MONTH END RUN.
  7412******************************************************************
  7413
  7414     12  CO-LAST-ACTIVITY-DATE.
  7415         16  CO-ACT-YEAR                       PIC 99.
  7416         16  CO-ACT-MONTH                      PIC 99.
  7417         16  CO-ACT-DAY                        PIC 99.
  7418
  7419     12  CO-LAST-STMT-DT.
  7420         16  CO-LAST-STMT-YEAR                 PIC 99.
  7421         16  CO-LAST-STMT-MONTH                PIC 99.
  7422         16  CO-LAST-STMT-DAY                  PIC 99.
  7423
  7424     12  CO-MO-END-TOTALS.
  7425         16  CO-MONTHLY-TOTALS.
  7426             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7427             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7428             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7429             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7430             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 141
* EL156.cbl
  7431
  7432         16  CO-AGING-TOTALS.
  7433             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7434             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7435             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7436             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7437
  7438         16  CO-YTD-TOTALS.
  7439             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7440             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7441
  7442         16  CO-OVER-UNDER-TOTALS.
  7443             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7444             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7445
  7446     12  CO-MISCELLANEOUS-TOTALS.
  7447         16  CO-FICA-TOTALS.
  7448             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7449             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7450
  7451         16  CO-CLAIM-TOTALS.
  7452             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7453             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7454
  7455******************************************************************
  7456*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7457*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7458******************************************************************
  7459
  7460     12  CO-CURRENT-TOTALS.
  7461         16  CO-CURRENT-LAST-STMT-DT.
  7462             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7463             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7464             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7465
  7466         16  CO-CURRENT-MONTHLY-TOTALS.
  7467             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7468             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7469             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7470             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7471             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7472
  7473         16  CO-CURRENT-AGING-TOTALS.
  7474             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7475             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7476             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7477             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7478
  7479         16  CO-CURRENT-YTD-TOTALS.
  7480             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7481             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7482
  7483     12  CO-PAID-COMM-TOTALS.
  7484         16  CO-YTD-PAID-COMMS.
  7485             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7486             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7487
  7488     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 142
* EL156.cbl
  7489         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7490         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7491
  7492     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7493         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7494         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7495         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7496         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7497         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7498         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7499         88  CO-FINAL-LETTER                  VALUE 'F'.
  7500         88  CO-RECONCILING                   VALUE 'R'.
  7501         88  CO-PHONE-CALL                    VALUE 'P'.
  7502         88  CO-LEGAL                         VALUE 'L'.
  7503         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7504         88  CO-WRITE-OFF                     VALUE 'W'.
  7505         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7506
  7507     12  CO-CSR-CODE                       PIC X(4).
  7508
  7509     12  CO-GA-STATUS-INFO.
  7510         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7511         16  CO-GA-TERMINATION-DT          PIC XX.
  7512         16  CO-GA-STATUS-CODE             PIC X.
  7513             88  CO-GA-ACTIVE                 VALUE 'A'.
  7514             88  CO-GA-INACTIVE               VALUE 'I'.
  7515             88  CO-GA-PENDING                VALUE 'P'.
  7516         16  CO-GA-COMMENTS.
  7517             20  CO-GA-COMMENT-1           PIC X(40).
  7518             20  CO-GA-COMMENT-2           PIC X(40).
  7519             20  CO-GA-COMMENT-3           PIC X(40).
  7520             20  CO-GA-COMMENT-4           PIC X(40).
  7521
  7522     12  CO-RPTCD2                         PIC X(10).
  7523     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7524         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7525         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7526
  7527     12  CO-TYPE-AGENT                     PIC X(01).
  7528         88  CO-CORPORATION                   VALUE 'C'.
  7529         88  CO-PARTNERSHIP                   VALUE 'P'.
  7530         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7531         88  CO-TRUST                         VALUE 'T'.
  7532         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7533
  7534     12  CO-FAXNO.
  7535         16  CO-FAX-AREA-CODE                  PIC XXX.
  7536         16  CO-FAX-PREFIX                     PIC XXX.
  7537         16  CO-FAX-PHONE                      PIC X(4).
  7538
  7539     12  CO-BANK-INFORMATION.
  7540         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7541         16  CO-BANK-TRANSIT-NON REDEFINES
  7542             CO-BANK-TRANSIT-NO                PIC 9(8).
  7543
  7544         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7545     12  CO-MISC-DEDUCT-INFO REDEFINES
  7546                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 143
* EL156.cbl
  7547         16  CO-MD-GL-ACCT                     PIC X(10).
  7548         16  CO-MD-DIV                         PIC XX.
  7549         16  CO-MD-CENTER                      PIC X(4).
  7550         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7551         16  CO-CREATE-AP-CHECK                PIC X.
  7552         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7553         16  FILLER                            PIC XXX.
  7554     12  CO-ACH-STATUS                         PIC X.
  7555         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7556         88  CO-ACH-PENDING                        VALUE 'P'.
  7557
  7558     12  CO-BILL-SW                            PIC X.
  7559     12  CO-CONTROL-NAME                       PIC X(30).
  7560     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7561     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7562     12  CO-CLP-STATE                          PIC XX.
  7563     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7564     12  CO-SPP-REFUND-EDIT                    PIC X.
  7565
  7566******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 144
* EL156.cbl
  7568*    COPY ERCDMDNT.
  7569******************************************************************
  7570*                                                                *
  7571*                            ERCDMDNT                            *
  7572*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7573*                            VMOD=2.005                          *
  7574*                                                                *
  7575*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7576*                                                                *
  7577*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7578*                                                                *
  7579*        FILE TYPE= VSAM,KSDS                                    *
  7580*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7581*                                                                *
  7582*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7583*                                                                *
  7584*        LOG = YES                                               *
  7585*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7586*                                                                *
  7587******************************************************************
  7588
  7589 01  CERTIFICATE-NOTE.
  7590     12  CN-RECORD-ID                     PIC  XX.
  7591         88  VALID-CN-ID                      VALUE 'CN'.
  7592
  7593     12  CN-CONTROL-PRIMARY.
  7594         16  CN-COMPANY-CD                PIC X.
  7595         16  CN-CERT-KEY.
  7596             20  CN-CARRIER               PIC X.
  7597             20  CN-GROUPING.
  7598                 24  CN-GROUPING-PREFIX   PIC XXX.
  7599                 24  CN-GROUPING-PRIME    PIC XXX.
  7600             20  CN-STATE                 PIC XX.
  7601             20  CN-ACCOUNT.
  7602                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7603                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7604             20  CN-CERT-EFF-DT           PIC XX.
  7605             20  CN-CERT-NO.
  7606                 24  CN-CERT-PRIME        PIC X(10).
  7607                 24  CN-CERT-SFX          PIC X.
  7608
  7609     12  CN-BILLING-START-LINE-NO         PIC 99.
  7610     12  CN-BILLING-END-LINE-NO           PIC 99.
  7611
  7612     12  CN-LINES.
  7613         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7614
  7615     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7616         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7617         16  CN-CSI-GENERAL-DATA-AREA.
  7618             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7619
  7620         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7621             CN-CSI-GENERAL-DATA-AREA.
  7622             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7623             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7624             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7625             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 145
* EL156.cbl
  7626             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7627             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7628             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7629             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7630             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7631             20  FILLER                       PIC XX.
  7632             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7633             20  FILLER                       PIC X(38).
  7634
  7635         16  CN-CSI-PRODUCT-DATA-AREA.
  7636             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7637
  7638         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7639             CN-CSI-PRODUCT-DATA-AREA.
  7640             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7641             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7642             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7643             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7644             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7645             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7646             20  FILLER                   PIC XX.
  7647             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7648             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7649             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7650             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7651             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7652             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7653             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7654             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7655             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7656             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7657             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7658             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7659             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7660             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7661             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7662             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7663             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7664             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7665             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7666             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7667             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7668             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7669             20  FILLER                   PIC X(25).
  7670
  7671         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7672             CN-CSI-CREDIT-CARD-DATA.
  7673             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7674             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7675             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7676             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7677             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7678             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7679             20  FILLER                   PIC XX.
  7680             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7681             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7682             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7683             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 146
* EL156.cbl
  7684             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7685             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7686             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7687             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7688             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7689             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7690             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7691             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7692             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7693             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7694             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7695             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7696             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7697             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7698             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7699             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7700             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7701             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7702             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7703             20  FILLER                   PIC X(17).
  7704
  7705         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7706             CN-CSI-FAMILY-LEAVE-DATA.
  7707             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7708             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7709             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7710             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7711             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7712             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7713             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7714             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7715             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7716             20  CN-CSI-SL-INT-ON-PROCEEDS
  7717                                          PIC S9(5)V99  COMP-3.
  7718             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7719             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7720             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7721             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7722             20  CN-CSI-SL-POLICY-BENEFITS
  7723                                          PIC S9(5)V99  COMP-3.
  7724             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7725             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7726             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7727             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7728             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7729             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7730             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7731             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7732             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7733             20  CN-CSI-SL-STATE-NOT      PIC X.
  7734             20  FILLER                   PIC XX.
  7735
  7736         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7737             CN-CSI-SENIOR-LIFE-DATA.
  7738             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7739             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7740             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7741                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 147
* EL156.cbl
  7742             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7743             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7744             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7745             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7746             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7747             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7748             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7749             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7750             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7751             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7752             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7753             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7754             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7755             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7756             20  CN-CSI-PP-REPAIR         PIC X.
  7757             20  CN-CSI-PP-REPLACE        PIC X.
  7758             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7759             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7760             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7761             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7762             20  FILLER                   PIC X(5).
  7763
  7764         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7765             CN-CSI-PURCH-PROP-DATA.
  7766             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7767             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7768             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7769             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7770             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7771             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7772             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7773             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7774             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7775             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7776             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7777             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7778             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7779             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7780             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7781             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7782             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7783             20  CN-CSI-EW-REPLACE        PIC X.
  7784             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7785             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7786             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7787             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7788             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7789             20  FILLER                   PIC X(4).
  7790
  7791     12  CN-LAST-MAINT-DT                 PIC XX.
  7792     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7793     12  CN-LAST-MAINT-USER               PIC X(4).
  7794     12  FILLER                           PIC X(6).
  7795
  7796******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 148
* EL156.cbl
  7798*    COPY ERCCNOT.
  7799******************************************************************
  7800*                                                                *
  7801*                            ERCCNOT                             *
  7802*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7803*                            VMOD=2.003                          *
  7804*                                                                *
  7805*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7806*                                                                *
  7807*        FILE TYPE= VSAM,KSDS                                    *
  7808*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7809*                                                                *
  7810*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7811*                                                                *
  7812*        LOG = YES                                               *
  7813*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7814*                                                                *
  7815******************************************************************
  7816*                   C H A N G E   L O G
  7817*
  7818* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7819*-----------------------------------------------------------------
  7820*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7821* EFFECTIVE    NUMBER
  7822*-----------------------------------------------------------------
  7823* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7824******************************************************************
  7825
  7826 01  CERT-NOTE-FILE.
  7827     12  CZ-RECORD-ID                PIC  XX.
  7828         88  VALID-CZ-ID                  VALUE 'CZ'.
  7829
  7830     12  CZ-CONTROL-PRIMARY.
  7831         16  CZ-COMPANY-CD           PIC X.
  7832         16  CZ-CARRIER              PIC X.
  7833         16  CZ-GROUPING.
  7834             20 CZ-GROUPING-PREFIX   PIC XXX.
  7835             20 CZ-GROUPING-PRIME    PIC XXX.
  7836         16  CZ-STATE                PIC XX.
  7837         16  CZ-ACCOUNT.
  7838             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7839             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7840         16  CZ-CERT-EFF-DT          PIC XX.
  7841         16  CZ-CERT-NO.
  7842             20  CZ-CERT-PRIME       PIC X(10).
  7843             20  CZ-CERT-SFX         PIC X.
  7844         16  CZ-RECORD-TYPE          PIC X.
  7845             88  CERT-NOTE           VALUE '1'.
  7846             88  CLAIM-CERT-NOTE     VALUE '2'.
  7847         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7848
  7849     12  CZ-LAST-MAINT-DT            PIC XX.
  7850     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7851     12  CZ-LAST-MAINT-USER          PIC X(4).
  7852
  7853     12  CZ-NOTE-INFORMATION.
  7854         16  CZ-NOTE                 PIC X(63).
  7855         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 149
* EL156.cbl
  7856******************************************************************
  7857*                            COPY ERCPDEF.
  7858******************************************************************
  7859*                                                                *
  7860*                                                                *
  7861*                            ERCPDEF.                            *
  7862*                                                                *
  7863*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7864*                                                                *
  7865*    FILE TYPE = VSAM,KSDS                                       *
  7866*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7867*                                                                *
  7868*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7869*                                                                *
  7870*    LOG = YES                                                   *
  7871*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7872******************************************************************
  7873 01  PRODUCT-MASTER.
  7874    12  PD-RECORD-ID                 PIC X(02).
  7875        88  VALID-PD-ID                  VALUE 'PD'.
  7876    12  PD-CONTROL-PRIMARY.
  7877        16  PD-COMPANY-CD            PIC X.
  7878        16  PD-STATE                 PIC XX.
  7879        16  PD-PRODUCT-CD            PIC XXX.
  7880        16  PD-FILLER                PIC X(7).
  7881        16  PD-BEN-TYPE              PIC X.
  7882        16  PD-BEN-CODE              PIC XX.
  7883        16  PD-PROD-EXP-DT           PIC XX.
  7884    12  FILLER                       PIC X(50).
  7885    12  PD-PRODUCT-DATA OCCURS 8.
  7886        16  PD-PROD-CODE             PIC X.
  7887            88  PD-PROD-LIFE           VALUE 'L'.
  7888            88  PD-PROD-PROP           VALUE 'P'.
  7889            88  PD-PROD-AH             VALUE 'A'.
  7890            88  PD-PROD-IU             VALUE 'I'.
  7891            88  PD-PROD-GAP            VALUE 'G'.
  7892        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7893        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7894        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7895        16  PD-MAX-TERM              PIC S999        COMP-3.
  7896        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7897        16  FILLER                   PIC X.
  7898        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7899        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7900        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7901        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7902        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7903        16  PD-REC-CRIT-PERIOD       PIC X.
  7904        16  PD-RTW-MOS               PIC 99.
  7905        16  FILLER                   PIC X(5).
  7906    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7907    12  PD-TERM-LIMITS OCCURS 15.
  7908        16  PD-LOW-TERM              PIC S999        COMP-3.
  7909        16  PD-HI-TERM               PIC S999        COMP-3.
  7910*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7911    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7912        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7913        16  PD-HI-AMT                PIC S9(7)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 150
* EL156.cbl
  7914    12  PD-EARN-FACTORS.
  7915        16  FILLER OCCURS 15.
  7916            20  FILLER OCCURS 15.
  7917                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7918    12  PD-PRODUCT-DESC              PIC X(80).
  7919    12  PD-TRUNCATED                 PIC X.
  7920    12  FILLER                       PIC X(59).
  7921    12  PD-MAINT-INFORMATION.
  7922        16  PD-LAST-MAINT-DT         PIC X(02).
  7923        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7924        16  PD-LAST-MAINT-BY         PIC X(04).
  7925*                            COPY ELCCRTT.
  7926******************************************************************
  7927*                                                                *
  7928*                            ELCCRTT.                            *
  7929*                                                                *
  7930*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7931*                                                                *
  7932*   FILE TYPE = VSAM,KSDS                                        *
  7933*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7934*                                                                *
  7935*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7936*                                                                *
  7937*   LOG = YES                                                    *
  7938*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7939******************************************************************
  7940*                   C H A N G E   L O G
  7941*
  7942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7943*-----------------------------------------------------------------
  7944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7945* EFFECTIVE    NUMBER
  7946*-----------------------------------------------------------------
  7947* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7948* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7949* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7950* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7951* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7952******************************************************************
  7953
  7954 01  CERTIFICATE-TRAILERS.
  7955     12  CS-RECORD-ID                      PIC XX.
  7956         88  VALID-CS-ID                      VALUE 'CS'.
  7957
  7958     12  CS-CONTROL-PRIMARY.
  7959         16  CS-COMPANY-CD                 PIC X.
  7960         16  CS-CARRIER                    PIC X.
  7961         16  CS-GROUPING                   PIC X(6).
  7962         16  CS-STATE                      PIC XX.
  7963         16  CS-ACCOUNT                    PIC X(10).
  7964         16  CS-CERT-EFF-DT                PIC XX.
  7965         16  CS-CERT-NO.
  7966             20  CS-CERT-PRIME             PIC X(10).
  7967             20  CS-CERT-SFX               PIC X.
  7968         16  CS-TRAILER-TYPE               PIC X.
  7969             88  COMM-TRLR           VALUE 'A'.
  7970             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7971             88  CERT-DATA-TRLR      VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 151
* EL156.cbl
  7972
  7973     12  CS-DATA-AREA                      PIC X(516).
  7974
  7975     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7976         16  CS-BANK-COMMISSION-AREA.
  7977             20  CS-BANK-COMMS       OCCURS 10.
  7978                 24  CS-AGT                PIC X(10).
  7979                 24  CS-COM-TYP            PIC X.
  7980                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7981                 24  CS-RECALC-LV-INDIC    PIC X.
  7982                 24  FILLER                PIC X(10).
  7983         16  FILLER                        PIC X(256).
  7984
  7985     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7986****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7987****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7988         16  CS-MB-CLAIM-DATA OCCURS 2.
  7989             20  FILLER OCCURS 10.
  7990                 24  CS-CLAIM-TYPE         PIC X.
  7991                     88  CS-AH-CLM           VALUE 'A'.
  7992                     88  CS-IU-CLM           VALUE 'I'.
  7993                     88  CS-GP-CLM           VALUE 'G'.
  7994                     88  CS-LF-CLM           VALUE 'L'.
  7995                     88  CS-PR-CLM           VALUE 'P'.
  7996                 24  CS-BANK               PIC S999 COMP-3.
  7997                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7998                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7999                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  8000         16  FILLER                        PIC X(216).
  8001     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8002         16  CS-VIN-NUMBER                 PIC X(17).
  8003         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8004         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8005         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8006         16  FILLER                        PIC X(496).
  8007******************************************************************
  8008 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8009                          CONTROL-FILE CERTIFICATE-MASTER
  8010                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8011                          ACCOUNT-MASTER CHECK-QUE
  8012                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8013                          DAILY-ACTIVITY-RECORD
  8014                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8015                          CERT-NOTE-FILE PRODUCT-MASTER
  8016                          CERTIFICATE-TRAILERS.
  8017 0000-DFHEXIT SECTION.
  8018     MOVE '9#                    $   ' TO DFHEIV0.
  8019     MOVE 'EL156' TO DFHEIV1.
  8020     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8021
  8022     IF EIBCALEN = 0
  8023         GO TO 8800-UNAUTHORIZED-ACCESS.
  8024
  8025     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8026     MOVE EIBTRMID               TO QID-TERM.
  8027     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8028     MOVE '2'                    TO EMI-SWITCH2.
  8029     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 152
* EL156.cbl
  8030     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8031
  8032     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8033     MOVE '5'                    TO DC-OPTION-CODE.
  8034     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8035     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8036                                    SAVE-BIN-DATE.
  8037     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8038     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8039
  8040     IF SAVE-DATE-YY > 70
  8041         MOVE 19                 TO SAVE-DATE-CC
  8042     ELSE
  8043         MOVE 20                 TO SAVE-DATE-CC.
  8044
  8045     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8046         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8047     END-IF.
  8048
  8049     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8050        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8051     ELSE
  8052        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8053     END-IF
  8054
  8055     IF PI-PRINT-CLM-FRM-YN = 'N'
  8056         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8057     ELSE
  8058         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8059     END-IF
  8060
  8061     IF PI-PRINT-SURVEY-YN = 'N'
  8062         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8063     ELSE
  8064         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8065     END-IF
  8066
  8067     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8068         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8069     ELSE
  8070         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8071     END-IF
  8072
  8073* EXEC CICS HANDLE CONDITION
  8074*        NOTOPEN   (9990-ABEND)
  8075*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8076*        MAPFAIL   (0400-FIRST-TIME)
  8077*        DUPREC    (6180-DUPREC)
  8078*        ERROR     (9990-ABEND)
  8079*    END-EXEC.
  8080*    MOVE '"$JL?%.               ! " #00008068' TO DFHEIV0
  8081     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8083     MOVE X'2220233030303038303638' TO DFHEIV0(25:11)
  8084     CALL 'kxdfhei1' USING DFHEIV0
  8085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8086
  8087
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 153
* EL156.cbl
  8088     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8089         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8090
  8091     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8092         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8093             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8094             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8095             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8096             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8097             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8098             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8099             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8100             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8101             MOVE LOW-VALUES           TO EL156AI
  8102             MOVE 'Y'                  TO FIRST-ENTRY
  8103         ELSE
  8104             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8105             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8106             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8107             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8108             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8109             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8110             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8111             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8112
  8113     IF RETURNED-FROM NOT = SPACES
  8114        IF (RETURNED-FROM = 'EL614')
  8115           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8116           IF WS-SAVED-EOB-CODES NOT = SPACES
  8117              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8118           ELSE
  8119              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8120           END-IF
  8121        END-IF
  8122         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8123            MOVE 'Y'             TO FIRST-ENTRY
  8124            IF RETURNED-FROM = 'EL614'
  8125               AND (PI-PASS-SW NOT = 'C')
  8126               IF WS-SAVED-EOB-CODES NOT = SPACES
  8127                  MOVE WS-SAVED-EOB-CODES
  8128                                 TO PI-PMTNOTE2
  8129                                    WS-PMTNOTE2
  8130                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8131               ELSE
  8132                  MOVE SPACES    TO PI-PMTNOTE2
  8133                                    WS-PMTNOTE2
  8134                                    PI-EOB-CODES-EXIST
  8135               END-IF
  8136            END-IF
  8137            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8138            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8139            IF RETURNED-FROM = 'EL614'
  8140               GO TO 1000-EDIT-DATA
  8141            END-IF
  8142            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8143               (PAYEEI   = LOW-VALUES OR SPACES)
  8144               GO TO 8100-SEND-INITIAL-MAP
  8145            ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 154
* EL156.cbl
  8146               GO TO 1000-EDIT-DATA.
  8147
  8148     IF EIBTRNID NOT = TRANS-ID
  8149         GO TO 0400-FIRST-TIME.
  8150
  8151     IF EIBAID = DFHCLEAR
  8152        IF PI-PASS-SW = 'C'
  8153           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8154           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8155           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8156           MOVE 'Y'            TO RETURNED-FROM-B
  8157           GO TO 1000-EDIT-DATA
  8158        ELSE
  8159           GO TO 9400-CLEAR.
  8160
  8161     IF PI-PASS-SW = 'C'
  8162         MOVE MAP-NAMEB          TO MAP-NAME
  8163         IF EIBAID = DFHPF1 OR DFHPF13
  8164             GO TO 5000-UPDATE
  8165           ELSE
  8166             IF EIBAID NOT = DFHENTER
  8167                 MOVE LOW-VALUES TO EL156BI
  8168                 MOVE MAP-NAMEB  TO MAP-NAME
  8169                 MOVE ER-0029    TO EMI-ERROR
  8170                 MOVE -1         TO  ENTPFBL
  8171                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8172                 GO TO 8200-SEND-DATAONLY.
  8173
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 155
* EL156.cbl
  8175 0200-RECEIVE.
  8176     MOVE LOW-VALUES             TO EL156AI.
  8177     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8178         MOVE ER-0008            TO EMI-ERROR
  8179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8180         IF PI-PASS-SW = 'C'
  8181             MOVE -1             TO ENTPFBL
  8182             GO TO 8200-SEND-DATAONLY
  8183         ELSE
  8184             MOVE -1             TO PMTTYPEL
  8185             GO TO 8200-SEND-DATAONLY.
  8186
  8187     IF PI-COMPANY-ID = 'DMD'
  8188         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8189
  8190     IF PI-PASS-SW = 'C'
  8191         MOVE MAP-NAMEB          TO MAP-NAME.
  8192
  8193
  8194* EXEC CICS RECEIVE
  8195*        MAP   (MAP-NAME)
  8196*        MAPSET(MAPSET-NAME)
  8197*        ASIS
  8198*        INTO  (EL156AI)
  8199*    END-EXEC.
  8200     MOVE LENGTH OF
  8201      EL156AI
  8202       TO DFHEIV11
  8203*    MOVE '8"TAI  L              ''   #00008181' TO DFHEIV0
  8204     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8205     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8206     MOVE X'2020233030303038313831' TO DFHEIV0(25:11)
  8207     CALL 'kxdfhei1' USING DFHEIV0,
  8208           MAP-NAME,
  8209           EL156AI,
  8210           DFHEIV11,
  8211           MAPSET-NAME,
  8212           DFHEIV99,
  8213           DFHEIV99
  8214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8215
  8216
  8217     IF PI-PASS-SW NOT = 'C'
  8218         GO TO 0250-MAPA.
  8219
  8220     IF ENTPFBL NOT > ZERO
  8221         MOVE MAP-NAMEB          TO MAP-NAME
  8222         MOVE ER-0029            TO EMI-ERROR
  8223         MOVE -1                 TO  ENTPFBL
  8224         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8225         GO TO 8200-SEND-DATAONLY.
  8226
  8227     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8228         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8229       ELSE
  8230         MOVE MAP-NAMEB           TO MAP-NAME
  8231         MOVE ER-0029             TO EMI-ERROR
  8232         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 156
* EL156.cbl
  8233         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8234         GO TO 8200-SEND-DATAONLY.
  8235
  8236     IF EIBAID = DFHPF1 OR DFHPF13
  8237         IF MODIFY-CAP
  8238            GO TO 5000-UPDATE
  8239          ELSE
  8240            MOVE 'UPDATE'           TO SM-READ
  8241            PERFORM 9995-SECURITY-VIOLATION
  8242            MOVE MAP-NAMEB          TO MAP-NAME
  8243            MOVE ER-0070            TO EMI-ERROR
  8244            MOVE -1                 TO  ENTPFBL
  8245            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8246            GO TO 8200-SEND-DATAONLY.
  8247
  8248 0250-MAPA.
  8249     IF ENTERPFL = 0
  8250         GO TO 0300-CHECK-PFKEYS.
  8251
  8252     IF EIBAID NOT = DFHENTER
  8253         MOVE ER-0004            TO EMI-ERROR
  8254         GO TO 0320-INPUT-ERROR.
  8255
  8256     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8257         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8258     ELSE
  8259         MOVE ER-0029            TO EMI-ERROR
  8260         GO TO 0320-INPUT-ERROR.
  8261
  8262 0300-CHECK-PFKEYS.
  8263     IF EIBAID = DFHPF7 OR DFHPF8
  8264         GO TO 8820-PF7-8.
  8265
  8266     IF EIBAID = DFHPF23
  8267         GO TO 8810-PF23.
  8268
  8269     IF EIBAID = DFHPF24
  8270         GO TO 9200-RETURN-MAIN-MENU.
  8271
  8272     IF EIBAID = DFHPF12
  8273         GO TO 9500-PF12.
  8274
  8275     IF EIBAID = DFHPF1
  8276        IF PI-PASS-SW = 'A' OR 'B'
  8277          GO TO 0330-BROWSE-FORWARD.
  8278
  8279     IF EIBAID = DFHPF2
  8280        IF PI-PASS-SW = 'A' OR 'B'
  8281          GO TO 0350-BROWSE-BACKWARD.
  8282
  8283     IF EIBAID = DFHPF6
  8284        IF PI-EOB-CODES-EXIST = 'Y'
  8285           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8286        ELSE
  8287           MOVE SPACES              TO WS-PMTNOTE2
  8288        END-IF
  8289         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8290         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 157
* EL156.cbl
  8291            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8292         END-IF
  8293         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8294         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8295             MOVE 'EL614'        TO PGM-NAME
  8296             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8297             GO TO 9300-XCTL
  8298         ELSE
  8299             MOVE XCTL-157       TO PGM-NAME
  8300             GO TO 9300-XCTL.
  8301
  8302     IF EIBAID = DFHPF9
  8303        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8304        MOVE XCTL-141            TO PGM-NAME
  8305        GO TO 9300-XCTL.
  8306
  8307     IF EIBAID = DFHPF10
  8308        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8309        MOVE XCTL-155            TO PGM-NAME
  8310        GO TO 9300-XCTL.
  8311
  8312     MOVE SPACES                 TO ERRMSG0O
  8313                                    ERRMSG1O
  8314                                    ERRMSG2O.
  8315
  8316     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8317         IF PI-PASS-SW NOT = 'B'
  8318             MOVE ER-0422        TO EMI-ERROR
  8319             GO TO 0320-INPUT-ERROR
  8320           ELSE
  8321             GO TO 0700-TEST-FOR-CHANGES.
  8322
  8323     IF EIBAID = DFHPF11
  8324        IF PI-PASS-SW = 'C'
  8325           MOVE ER-0029          TO EMI-ERROR
  8326           GO TO 0320-INPUT-ERROR.
  8327
  8328     IF EIBAID = DFHENTER OR DFHPF11
  8329        NEXT SENTENCE
  8330     ELSE
  8331        MOVE ER-0029             TO EMI-ERROR
  8332        GO TO 0320-INPUT-ERROR.
  8333
  8334     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8335
  8336     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8337         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8338         GO TO 1000-EDIT-DATA
  8339     ELSE
  8340         IF PI-FATAL-COUNT NOT = 0 OR
  8341            PI-FORCE-COUNT NOT = 0
  8342             GO TO 1000-EDIT-DATA
  8343         ELSE
  8344             GO TO 2000-EDIT-DONE.
  8345
  8346 0320-INPUT-ERROR.
  8347     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8348
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 158
* EL156.cbl
  8349     IF ENTERPFL = 0
  8350         MOVE -1                 TO PMTTYPEL
  8351     ELSE
  8352         MOVE AL-UNBON           TO ENTERPFA
  8353         MOVE -1                 TO ENTERPFL.
  8354
  8355     GO TO 8200-SEND-DATAONLY.
  8356
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 159
* EL156.cbl
  8358 0330-BROWSE-FORWARD.
  8359
  8360     MOVE CLMNOI            TO PI-CLAIM-NO.
  8361     MOVE CARRI             TO PI-CARRIER.
  8362     MOVE CERTNOI           TO PI-CERT-PRIME.
  8363     MOVE SUFXI             TO PI-CERT-SFX.
  8364
  8365     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8366     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8367     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8368     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8369
  8370     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8371
  8372
  8373* EXEC CICS HANDLE CONDITION
  8374*         NOTFND   (0380-CLAIM-END-FILE)
  8375*         ENDFILE  (0380-CLAIM-END-FILE)
  8376*    END-EXEC.
  8377*    MOVE '"$I''                  ! # #00008343' TO DFHEIV0
  8378     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8380     MOVE X'2320233030303038333433' TO DFHEIV0(25:11)
  8381     CALL 'kxdfhei1' USING DFHEIV0
  8382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8383
  8384
  8385
  8386* EXEC CICS STARTBR
  8387*         DATASET    ('ELMSTR')
  8388*         RIDFLD     (ELMSTR-KEY)
  8389*         GTEQ
  8390*    END-EXEC.
  8391     MOVE 'ELMSTR' TO DFHEIV1
  8392     MOVE 0
  8393       TO DFHEIV11
  8394*    MOVE '&,         G          &   #00008348' TO DFHEIV0
  8395     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303038333438' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           DFHEIV1,
  8400           ELMSTR-KEY,
  8401           DFHEIV99,
  8402           DFHEIV11,
  8403           DFHEIV99
  8404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8405
  8406
  8407     MOVE 'Y' TO WS-BROWSE-START-SW.
  8408
  8409 0335-READNEXT.
  8410
  8411
  8412* EXEC CICS READNEXT
  8413*         DATASET    ('ELMSTR')
  8414*         RIDFLD     (ELMSTR-KEY)
  8415*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 160
* EL156.cbl
  8416*    END-EXEC.
  8417     MOVE 'ELMSTR' TO DFHEIV1
  8418     MOVE 0
  8419       TO DFHEIV11
  8420*    MOVE '&.S                   )   #00008358' TO DFHEIV0
  8421     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8422     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8423     MOVE X'2020233030303038333538' TO DFHEIV0(25:11)
  8424     CALL 'kxdfhei1' USING DFHEIV0,
  8425           DFHEIV1,
  8426           DFHEIV20,
  8427           DFHEIV99,
  8428           ELMSTR-KEY,
  8429           DFHEIV99,
  8430           DFHEIV11,
  8431           DFHEIV99,
  8432           DFHEIV99
  8433     SET ADDRESS OF CLAIM-MASTER TO
  8434         DFHEIV20
  8435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8436
  8437
  8438     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8439        GO TO 0380-CLAIM-END-FILE.
  8440
  8441     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8442        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8443        GO TO 0335-READNEXT.
  8444
  8445     IF PI-COMPANY-ID = 'CRI'
  8446         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8447            GO TO 0380-CLAIM-END-FILE.
  8448
  8449     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8450         GO TO 0335-READNEXT.
  8451
  8452     IF PI-CARRIER-SECURITY > SPACES
  8453         IF CL-CARRIER = PI-CARRIER-SECURITY
  8454             NEXT SENTENCE
  8455         ELSE
  8456             GO TO 0335-READNEXT.
  8457
  8458     IF PI-ACCOUNT-SECURITY > SPACES
  8459         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8460             NEXT SENTENCE
  8461         ELSE
  8462             GO TO 0335-READNEXT.
  8463
  8464     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8465     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8466     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8467
  8468     GO TO 0400-FIRST-TIME.
  8469
  8470 0350-BROWSE-BACKWARD.
  8471
  8472     MOVE CLMNOI            TO PI-CLAIM-NO
  8473                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 161
* EL156.cbl
  8474     MOVE CARRI             TO PI-CARRIER.
  8475     MOVE CERTNOI           TO PI-CERT-PRIME.
  8476     MOVE SUFXI             TO PI-CERT-SFX.
  8477
  8478     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8479
  8480     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8481     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8482     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8483
  8484
  8485* EXEC CICS HANDLE CONDITION
  8486*         NOTFND   (0380-CLAIM-END-FILE)
  8487*         ENDFILE  (0380-CLAIM-END-FILE)
  8488*    END-EXEC.
  8489*    MOVE '"$I''                  ! $ #00008410' TO DFHEIV0
  8490     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8492     MOVE X'2420233030303038343130' TO DFHEIV0(25:11)
  8493     CALL 'kxdfhei1' USING DFHEIV0
  8494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8495
  8496
  8497
  8498* EXEC CICS STARTBR
  8499*         DATASET    ('ELMSTR')
  8500*         RIDFLD     (ELMSTR-KEY)
  8501*         GTEQ
  8502*    END-EXEC.
  8503     MOVE 'ELMSTR' TO DFHEIV1
  8504     MOVE 0
  8505       TO DFHEIV11
  8506*    MOVE '&,         G          &   #00008415' TO DFHEIV0
  8507     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8509     MOVE X'2020233030303038343135' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0,
  8511           DFHEIV1,
  8512           ELMSTR-KEY,
  8513           DFHEIV99,
  8514           DFHEIV11,
  8515           DFHEIV99
  8516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8517
  8518
  8519     MOVE 'Y' TO WS-BROWSE-START-SW.
  8520
  8521
  8522* EXEC CICS READNEXT
  8523*         DATASET    ('ELMSTR')
  8524*         RIDFLD     (ELMSTR-KEY)
  8525*         SET        (ADDRESS OF CLAIM-MASTER)
  8526*    END-EXEC.
  8527     MOVE 'ELMSTR' TO DFHEIV1
  8528     MOVE 0
  8529       TO DFHEIV11
  8530*    MOVE '&.S                   )   #00008423' TO DFHEIV0
  8531     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 162
* EL156.cbl
  8532     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8533     MOVE X'2020233030303038343233' TO DFHEIV0(25:11)
  8534     CALL 'kxdfhei1' USING DFHEIV0,
  8535           DFHEIV1,
  8536           DFHEIV20,
  8537           DFHEIV99,
  8538           ELMSTR-KEY,
  8539           DFHEIV99,
  8540           DFHEIV11,
  8541           DFHEIV99,
  8542           DFHEIV99
  8543     SET ADDRESS OF CLAIM-MASTER TO
  8544         DFHEIV20
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8546
  8547
  8548
  8549* EXEC CICS READPREV
  8550*         DATASET    ('ELMSTR')
  8551*         RIDFLD     (ELMSTR-KEY)
  8552*         SET        (ADDRESS OF CLAIM-MASTER)
  8553*    END-EXEC.
  8554     MOVE 'ELMSTR' TO DFHEIV1
  8555     MOVE 0
  8556       TO DFHEIV11
  8557*    MOVE '&0S                   )   #00008429' TO DFHEIV0
  8558     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8559     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8560     MOVE X'2020233030303038343239' TO DFHEIV0(25:11)
  8561     CALL 'kxdfhei1' USING DFHEIV0,
  8562           DFHEIV1,
  8563           DFHEIV20,
  8564           DFHEIV99,
  8565           ELMSTR-KEY,
  8566           DFHEIV99,
  8567           DFHEIV11,
  8568           DFHEIV99,
  8569           DFHEIV99
  8570     SET ADDRESS OF CLAIM-MASTER TO
  8571         DFHEIV20
  8572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8573
  8574
  8575 0360-BROWSE-BACKWARD.
  8576
  8577
  8578* EXEC CICS READPREV
  8579*         DATASET    ('ELMSTR')
  8580*         RIDFLD     (ELMSTR-KEY)
  8581*         SET        (ADDRESS OF CLAIM-MASTER)
  8582*    END-EXEC.
  8583     MOVE 'ELMSTR' TO DFHEIV1
  8584     MOVE 0
  8585       TO DFHEIV11
  8586*    MOVE '&0S                   )   #00008437' TO DFHEIV0
  8587     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8588     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8589     MOVE X'2020233030303038343337' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 163
* EL156.cbl
  8590     CALL 'kxdfhei1' USING DFHEIV0,
  8591           DFHEIV1,
  8592           DFHEIV20,
  8593           DFHEIV99,
  8594           ELMSTR-KEY,
  8595           DFHEIV99,
  8596           DFHEIV11,
  8597           DFHEIV99,
  8598           DFHEIV99
  8599     SET ADDRESS OF CLAIM-MASTER TO
  8600         DFHEIV20
  8601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8602
  8603
  8604     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8605        GO TO 0380-CLAIM-END-FILE.
  8606
  8607     IF PI-COMPANY-ID = 'CRI'
  8608         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8609            GO TO 0380-CLAIM-END-FILE.
  8610
  8611     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8612         GO TO 0360-BROWSE-BACKWARD.
  8613
  8614     IF PI-CARRIER-SECURITY > SPACES
  8615         IF CL-CARRIER = PI-CARRIER-SECURITY
  8616             NEXT SENTENCE
  8617         ELSE
  8618             GO TO 0360-BROWSE-BACKWARD.
  8619
  8620     IF PI-ACCOUNT-SECURITY > SPACES
  8621         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8622             NEXT SENTENCE
  8623         ELSE
  8624             GO TO 0360-BROWSE-BACKWARD.
  8625
  8626     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8627     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8628     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8629
  8630     GO TO 0400-FIRST-TIME.
  8631
  8632 0380-CLAIM-END-FILE.
  8633
  8634     MOVE ER-0130     TO EMI-ERROR.
  8635     MOVE -1          TO CLMNOL.
  8636     MOVE AL-UABON    TO CARRA
  8637                         CLMNOA
  8638                         CERTNOA
  8639                         SUFXA.
  8640
  8641     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8642
  8643     GO TO 8200-SEND-DATAONLY.
  8644
  8645 0400-FIRST-TIME.
  8646
  8647     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 164
* EL156.cbl
  8648        MOVE 'N'         TO WS-BROWSE-START-SW
  8649
  8650* EXEC CICS ENDBR
  8651*            DATASET    ('ELMSTR')
  8652*       END-EXEC.
  8653     MOVE 'ELMSTR' TO DFHEIV1
  8654     MOVE 0
  8655       TO DFHEIV11
  8656*    MOVE '&2                    $   #00008488' TO DFHEIV0
  8657     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8658     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8659     MOVE X'2020233030303038343838' TO DFHEIV0(25:11)
  8660     CALL 'kxdfhei1' USING DFHEIV0,
  8661           DFHEIV1,
  8662           DFHEIV11,
  8663           DFHEIV99
  8664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8665
  8666
  8667     IF PI-PROCESSOR-ID = 'LGXX'
  8668         NEXT SENTENCE
  8669     ELSE
  8670
  8671* EXEC CICS READQ TS
  8672*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8673*            INTO    (SECURITY-CONTROL)
  8674*            LENGTH  (SC-COMM-LENGTH)
  8675*            ITEM    (SC-ITEM)
  8676*        END-EXEC
  8677*    MOVE '*$II   L              ''   #00008495' TO DFHEIV0
  8678     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8679     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8680     MOVE X'2020233030303038343935' TO DFHEIV0(25:11)
  8681     CALL 'kxdfhei1' USING DFHEIV0,
  8682           PI-SECURITY-TEMP-STORE-ID,
  8683           SECURITY-CONTROL,
  8684           SC-COMM-LENGTH,
  8685           SC-ITEM,
  8686           DFHEIV99,
  8687           DFHEIV99
  8688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8689         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8690         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8691
  8692     MOVE LOW-VALUES             TO EL156AI.
  8693     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8694     MOVE 'Y'                    TO FIRST-ENTRY.
  8695     GO TO 7000-SHOW-CLAIM.
  8696
  8697 0500-CREATE-TEMP-STORAGE.
  8698     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8699
  8700
  8701* EXEC CICS WRITEQ TS
  8702*        QUEUE (QID)
  8703*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8704*        LENGTH(PI-COMM-LENGTH)
  8705*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 165
* EL156.cbl
  8706*    MOVE '*"                    ''   #00008512' TO DFHEIV0
  8707     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8708     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8709     MOVE X'2020233030303038353132' TO DFHEIV0(25:11)
  8710     CALL 'kxdfhei1' USING DFHEIV0,
  8711           QID,
  8712           PROGRAM-INTERFACE-BLOCK,
  8713           PI-COMM-LENGTH,
  8714           DFHEIV99,
  8715           DFHEIV99,
  8716           DFHEIV99
  8717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8718
  8719
  8720
  8721* EXEC CICS WRITEQ TS
  8722*        QUEUE (QID)
  8723*        FROM  (EL156AI)
  8724*        LENGTH(MAP-LENGTH)
  8725*    END-EXEC.
  8726*    MOVE '*"                    ''   #00008518' TO DFHEIV0
  8727     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8728     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8729     MOVE X'2020233030303038353138' TO DFHEIV0(25:11)
  8730     CALL 'kxdfhei1' USING DFHEIV0,
  8731           QID,
  8732           EL156AI,
  8733           MAP-LENGTH,
  8734           DFHEIV99,
  8735           DFHEIV99,
  8736           DFHEIV99
  8737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8738
  8739
  8740 0599-EXIT.
  8741      EXIT.
  8742
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 166
* EL156.cbl
  8744 0600-RECOVER-TEMP-STORAGE.
  8745
  8746* EXEC CICS READQ TS
  8747*        QUEUE (QID)
  8748*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8749*        LENGTH(PI-COMM-LENGTH)
  8750*    END-EXEC.
  8751*    MOVE '*$I    L              ''   #00008529' TO DFHEIV0
  8752     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8753     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8754     MOVE X'2020233030303038353239' TO DFHEIV0(25:11)
  8755     CALL 'kxdfhei1' USING DFHEIV0,
  8756           QID,
  8757           PROGRAM-INTERFACE-BLOCK,
  8758           PI-COMM-LENGTH,
  8759           DFHEIV99,
  8760           DFHEIV99,
  8761           DFHEIV99
  8762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8763
  8764
  8765
  8766* EXEC CICS READQ TS
  8767*        QUEUE (QID)
  8768*        INTO  (EL156AI)
  8769*        LENGTH(MAP-LENGTH)
  8770*    END-EXEC.
  8771*    MOVE '*$I    L              ''   #00008535' TO DFHEIV0
  8772     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8773     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8774     MOVE X'2020233030303038353335' TO DFHEIV0(25:11)
  8775     CALL 'kxdfhei1' USING DFHEIV0,
  8776           QID,
  8777           EL156AI,
  8778           MAP-LENGTH,
  8779           DFHEIV99,
  8780           DFHEIV99,
  8781           DFHEIV99
  8782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8783
  8784
  8785     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8786
  8787     IF PMTTYPEI NOT = LOW-VALUES
  8788         MOVE AL-UANON           TO PMTTYPEA.
  8789
  8790     IF PAYEEI NOT = LOW-VALUES
  8791         MOVE AL-UANON           TO PAYEEA.
  8792
  8793     IF NOTE1I NOT = LOW-VALUES
  8794         MOVE AL-UANON           TO NOTE1A.
  8795
  8796     IF (RETURNED-FROM = 'EL614')
  8797        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8798     END-IF
  8799*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8800*       AND (PI-EOB-CODES-EXIST = 'Y')
  8801*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 167
* EL156.cbl
  8802*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8803     IF PI-SET-NOTE2-MDT = 'Y'
  8804         MOVE AL-SANON           TO NOTE2A
  8805     END-IF
  8806
  8807     IF OFFLINEI NOT = LOW-VALUES
  8808         MOVE AL-UANON           TO OFFLINEA.
  8809
  8810*    IF GROUPEDI NOT = LOW-VALUES
  8811*        MOVE AL-UANON           TO GROUPEDA.
  8812
  8813*    IF CASHI NOT = LOW-VALUES
  8814*        MOVE AL-UANON           TO CASHA.
  8815
  8816     IF CHECKNOI NOT = LOW-VALUES
  8817         MOVE AL-UANON           TO CHECKNOA.
  8818
  8819     IF HOLDTILI NOT = LOW-VALUES
  8820         MOVE AL-UANON           TO HOLDTILA.
  8821
  8822     IF EPYFROMI NOT = LOW-VALUES
  8823         MOVE AL-UANON           TO EPYFROMA.
  8824
  8825     IF AIGFROMI NOT = LOW-VALUES
  8826         MOVE AL-UANON           TO AIGFROMA.
  8827
  8828     IF EPYTHRUI NOT = LOW-VALUES
  8829         MOVE AL-UANON           TO EPYTHRUA.
  8830
  8831     IF EDAYSI NOT = LOW-VALUES
  8832         MOVE AL-UNNON           TO EDAYSA.
  8833
  8834     IF EPYAMTL NOT = +0
  8835         MOVE AL-UNNON           TO EPYAMTA.
  8836
  8837     IF ERESVL NOT = +0
  8838         MOVE AL-UNNON           TO ERESVA.
  8839
  8840     IF EEXPENSL NOT = +0
  8841         MOVE AL-UNNON           TO EEXPENSA.
  8842
  8843     IF ETYPEI NOT = LOW-VALUES
  8844         MOVE AL-UNNON           TO ETYPEA.
  8845
  8846     IF PROOFDTI NOT = 0
  8847         MOVE AL-UNNON           TO PROOFDTA.
  8848
  8849     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8850        MOVE AL-UANON            TO EOBYNA
  8851     END-IF
  8852     IF CLMFMYNI = 'Y' OR 'N'
  8853        MOVE AL-UANON            TO CLMFMYNA
  8854     END-IF
  8855
  8856     IF SURVYYNI = 'Y' OR 'N'
  8857        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8858           MOVE AL-UANON         TO SURVYYNA
  8859        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 168
* EL156.cbl
  8860     END-IF
  8861
  8862     IF SPRELYNI = 'Y' OR 'N'
  8863        MOVE AL-UANON            TO SPRELYNA
  8864     END-IF
  8865
  8866     .
  8867 0699-EXIT.
  8868      EXIT.
  8869
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 169
* EL156.cbl
  8871 0700-TEST-FOR-CHANGES.
  8872     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8873         MOVE ER-0433            TO EMI-ERROR
  8874         GO TO 0750-FUNCTION-ERROR.
  8875
  8876     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8877
  8878     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8879         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8880         MOVE 'A'                TO PI-PASS-SW
  8881         GO TO 1000-EDIT-DATA.
  8882
  8883     IF PI-FATAL-COUNT NOT = 0
  8884         MOVE ER-0499            TO EMI-ERROR
  8885         GO TO 0750-FUNCTION-ERROR.
  8886
  8887     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8888         MOVE ER-0500            TO EMI-ERROR
  8889         GO TO 0750-FUNCTION-ERROR.
  8890
  8891     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8892        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8893           MOVE ER-0542          TO EMI-ERROR
  8894           MOVE -1               TO EPYAMTL
  8895           GO TO 0750-FUNCTION-ERROR.
  8896
  8897     IF PI-OFFLINE = 'Y'  OR
  8898        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8899        MOVE EIBAID              TO PI-PFKEY-USED
  8900        GO TO 5000-UPDATE.
  8901
  8902     GO TO 6000-BUILD-SCREEN-B.
  8903
  8904 0750-FUNCTION-ERROR.
  8905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8906
  8907     IF ENTERPFL > 0
  8908         MOVE -1                 TO ENTERPFL
  8909         MOVE AL-UNBON           TO ENTERPFA
  8910         GO TO 8200-SEND-DATAONLY
  8911     ELSE
  8912         MOVE -1                 TO ENTERPFL
  8913         MOVE AL-UNNOF           TO ENTERPFA
  8914         GO TO 8200-SEND-DATAONLY.
  8915
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 170
* EL156.cbl
  8917 0800-DELETE-TS.
  8918
  8919* EXEC CICS HANDLE CONDITION
  8920*        QIDERR(0800-EXIT)
  8921*    END-EXEC.
  8922*    MOVE '"$N                   ! % #00008674' TO DFHEIV0
  8923     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8925     MOVE X'2520233030303038363734' TO DFHEIV0(25:11)
  8926     CALL 'kxdfhei1' USING DFHEIV0
  8927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8928
  8929
  8930
  8931* EXEC CICS DELETEQ TS
  8932*        QUEUE(QID)
  8933*    END-EXEC.
  8934*    MOVE '*&                    #   #00008678' TO DFHEIV0
  8935     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8936     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8937     MOVE X'2020233030303038363738' TO DFHEIV0(25:11)
  8938     CALL 'kxdfhei1' USING DFHEIV0,
  8939           QID,
  8940           DFHEIV99
  8941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8942
  8943
  8944 0800-EXIT.
  8945      EXIT.
  8946 0900-GET-DDF-FACTORS.
  8947
  8948     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8949     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8950     MOVE CL-CERT-STATE          TO ERPDEF-STATE
  8951     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8952     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  8953     MOVE PI-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8954     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8955
  8956     DISPLAY ' MADE 0900 ' ERPDEF-KEY (2:15)
  8957     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8958
  8959
  8960* EXEC CICS STARTBR
  8961*        DATASET  ('ERPDEF')
  8962*        RIDFLD   (ERPDEF-KEY)
  8963*        GTEQ
  8964*        RESP     (WS-RESPONSE)
  8965*    END-EXEC
  8966     MOVE 'ERPDEF' TO DFHEIV1
  8967     MOVE 0
  8968       TO DFHEIV11
  8969*    MOVE '&,         G          &  N#00008697' TO DFHEIV0
  8970     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8971     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8972     MOVE X'204E233030303038363937' TO DFHEIV0(25:11)
  8973     CALL 'kxdfhei1' USING DFHEIV0,
  8974           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 171
* EL156.cbl
  8975           ERPDEF-KEY,
  8976           DFHEIV99,
  8977           DFHEIV11,
  8978           DFHEIV99
  8979     MOVE EIBRESP  TO WS-RESPONSE
  8980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8981
  8982     IF NOT WS-RESP-NORMAL
  8983        GO TO 0900-EXIT
  8984     END-IF
  8985
  8986     .
  8987 0900-READNEXT.
  8988
  8989
  8990* EXEC CICS READNEXT
  8991*       DATASET  ('ERPDEF')
  8992*       SET      (ADDRESS OF PRODUCT-MASTER)
  8993*       RIDFLD   (ERPDEF-KEY)
  8994*       RESP     (WS-RESPONSE)
  8995*    END-EXEC
  8996     MOVE 'ERPDEF' TO DFHEIV1
  8997     MOVE 0
  8998       TO DFHEIV11
  8999*    MOVE '&.S                   )  N#00008711' TO DFHEIV0
  9000     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9001     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9002     MOVE X'204E233030303038373131' TO DFHEIV0(25:11)
  9003     CALL 'kxdfhei1' USING DFHEIV0,
  9004           DFHEIV1,
  9005           DFHEIV20,
  9006           DFHEIV99,
  9007           ERPDEF-KEY,
  9008           DFHEIV99,
  9009           DFHEIV11,
  9010           DFHEIV99,
  9011           DFHEIV99
  9012     SET ADDRESS OF PRODUCT-MASTER TO
  9013         DFHEIV20
  9014     MOVE EIBRESP  TO WS-RESPONSE
  9015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9016
  9017     IF NOT WS-RESP-NORMAL
  9018        GO TO 0900-ENDBR
  9019     END-IF
  9020
  9021     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9022        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9023           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9024        ELSE
  9025           GO TO 0900-READNEXT
  9026        END-IF
  9027     ELSE
  9028        GO TO 0900-ENDBR
  9029     END-IF
  9030
  9031     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9032        (P1 > +8)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 172
* EL156.cbl
  9033        OR (PD-PROD-CODE (P1) = 'I')
  9034     END-PERFORM
  9035     IF P1 < +9
  9036        SET DD-IU-PRESENT        TO TRUE
  9037     END-IF
  9038
  9039     IF CM-LOAN-TERM = ZEROS
  9040        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9041     END-IF
  9042
  9043     .
  9044 0900-ENDBR.
  9045
  9046
  9047* EXEC CICS ENDBR
  9048*       DATASET  ('ERPDEF')
  9049*    END-EXEC
  9050     MOVE 'ERPDEF' TO DFHEIV1
  9051     MOVE 0
  9052       TO DFHEIV11
  9053*    MOVE '&2                    $   #00008747' TO DFHEIV0
  9054     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9055     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9056     MOVE X'2020233030303038373437' TO DFHEIV0(25:11)
  9057     CALL 'kxdfhei1' USING DFHEIV0,
  9058           DFHEIV1,
  9059           DFHEIV11,
  9060           DFHEIV99
  9061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9062
  9063     .
  9064 0900-EXIT.
  9065     EXIT.
  9066 1000-EDIT-DATA.
  9067
  9068     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9069         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9070         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9071
  9072     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9073
  9074     IF NOT MODIFY-CAP
  9075         MOVE ER-0070            TO EMI-ERROR
  9076         MOVE -1                 TO PMTTYPEL
  9077         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9078         GO TO 2000-EDIT-DONE.
  9079
  9080     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9081                         '5' AND '6'
  9082         MOVE ER-0420            TO EMI-ERROR
  9083         MOVE -1                 TO PMTTYPEL
  9084         MOVE AL-UABON           TO PMTTYPEA
  9085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9086     ELSE
  9087         MOVE AL-UANON           TO PMTTYPEA.
  9088
  9089*    IF PI-OFFLINE = 'Y'
  9090*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 173
* EL156.cbl
  9091*          MOVE ER-1880         TO EMI-ERROR
  9092*          MOVE -1              TO GROUPEDL
  9093*          MOVE AL-UABON        TO GROUPEDA
  9094*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9095*
  9096*    IF GROUPEDL > +0
  9097*       IF PI-GROUPED = 'Y' OR 'N'
  9098*          MOVE AL-UANON TO GROUPEDA
  9099*       ELSE
  9100*          MOVE ER-3140            TO EMI-ERROR
  9101*          MOVE -1                 TO GROUPEDL
  9102*          MOVE AL-UABON           TO GROUPEDA
  9103*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9104*
  9105*    IF CASHL > +0
  9106*       IF PI-CASH = 'Y' OR 'N'
  9107*          MOVE AL-UANON           TO CASHA
  9108*       ELSE
  9109*          MOVE ER-3141            TO EMI-ERROR
  9110*          MOVE -1                 TO CASHL
  9111*          MOVE AL-UABON           TO CASHA
  9112*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9113
  9114     IF LOANNOL > +0
  9115         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9116
  9117 1000-EDIT-PAYEE.
  9118
  9119     IF PI-PAYEE-SEQ NOT NUMERIC
  9120         MOVE ER-0294            TO  EMI-ERROR
  9121         MOVE -1                 TO  PAYEEL
  9122         MOVE AL-UABON           TO  PAYEEA
  9123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9124         GO TO 1000-CONT-EDIT.
  9125
  9126     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9127                         'E' OR 'O' OR 'Q'
  9128         NEXT SENTENCE
  9129     ELSE
  9130         MOVE ER-0294            TO  EMI-ERROR
  9131         MOVE -1                 TO  PAYEEL
  9132         MOVE AL-UABON           TO  PAYEEA
  9133         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9134         GO TO 1000-CONT-EDIT.
  9135
  9136     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9137        (PI-PAYEE-SEQ NOT < '1' AND
  9138         PI-PAYEE-SEQ NOT > '9'))
  9139      OR
  9140        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9141         (PI-PAYEE-SEQ NOT > '9'))
  9142         MOVE AL-UANON            TO PAYEEA
  9143     ELSE
  9144         MOVE ER-0294            TO EMI-ERROR
  9145         MOVE -1                 TO PAYEEL
  9146         MOVE AL-UABON           TO PAYEEA
  9147         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9148
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 174
* EL156.cbl
  9149     IF PI-COMPANY-ID = 'DMD'
  9150         IF PI-PAYEE-TYPE = 'B' AND
  9151            PI-PAYEE-SEQ NOT = '0'
  9152               MOVE ER-7841            TO EMI-ERROR
  9153               MOVE -1                 TO PAYEEL
  9154               MOVE AL-UABON           TO PAYEEA
  9155               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9156
  9157     IF PI-COMPANY-ID = 'JHL'
  9158         IF PI-PAYEE = 'B0'
  9159             NEXT SENTENCE
  9160           ELSE
  9161
  9162* EXEC CICS HANDLE CONDITION
  9163*            ENDFILE(1950-NOT-FOUND)
  9164*            NOTFND (1950-NOT-FOUND)
  9165*        END-EXEC
  9166*    MOVE '"$''I                  ! & #00008849' TO DFHEIV0
  9167     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9169     MOVE X'2620233030303038383439' TO DFHEIV0(25:11)
  9170     CALL 'kxdfhei1' USING DFHEIV0
  9171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9172         MOVE 'N'                    TO FOUND-TOL-SW
  9173         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9174         MOVE '2'                    TO CNTL-REC-TYPE
  9175         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9176         MOVE +0                     TO CNTL-SEQ-NO
  9177         MOVE 'PROC'                 TO FILE-SWITCH
  9178         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9179         IF PI-PAYEE = 'I1' AND
  9180            APPROVAL-LEVEL-2
  9181             NEXT SENTENCE
  9182           ELSE
  9183         IF NOT PI-USER-ALMIGHTY-YES
  9184             MOVE ER-3546        TO EMI-ERROR
  9185             MOVE -1             TO PAYEEL
  9186             MOVE AL-UABON       TO PAYEEA
  9187             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9188
  9189     IF PI-PAYEE-TYPE = 'E'
  9190        IF PI-PMTTYPE = '5' OR '6'
  9191            NEXT SENTENCE
  9192        ELSE
  9193            MOVE ER-3539            TO EMI-ERROR
  9194            MOVE -1                 TO PAYEEL
  9195            MOVE AL-UABON           TO PAYEEA
  9196            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9197
  9198 1000-CONT-EDIT.
  9199
  9200     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9201        IF PI-EPYAMT NOT NEGATIVE
  9202            MOVE ER-0421         TO EMI-ERROR
  9203            MOVE -1              TO OFFLINEL
  9204            MOVE AL-UABON        TO OFFLINEA
  9205            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9206        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 175
* EL156.cbl
  9207            MOVE AL-UANON        TO OFFLINEA.
  9208
  9209     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9210        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9211           CONTINUE
  9212        ELSE
  9213        IF PI-PRINT-EOB-YN = 'S' AND
  9214           PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9215             CONTINUE
  9216        ELSE
  9217           MOVE ER-1561          TO EMI-ERROR
  9218           MOVE -1               TO EOBYNL
  9219           MOVE AL-UABON         TO EOBYNA
  9220           PERFORM 9900-ERROR-FORMAT
  9221                                 THRU 9900-EXIT
  9222        END-IF
  9223        END-IF
  9224
  9225        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9226            MOVE ER-1566        TO EMI-ERROR
  9227            MOVE -1             TO CLMFMYNL
  9228            MOVE AL-UABON       TO CLMFMYNA
  9229            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9230        END-IF
  9231
  9232        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9233            MOVE ER-1567        TO EMI-ERROR
  9234            MOVE -1             TO SURVYYNL
  9235            MOVE AL-UABON       TO SURVYYNA
  9236            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9237        END-IF
  9238
  9239        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9240            MOVE ER-1569        TO EMI-ERROR
  9241            MOVE -1             TO SPRELYNL
  9242            MOVE AL-UABON       TO SPRELYNA
  9243            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9244        END-IF
  9245
  9246     END-IF
  9247     IF PI-EPYAMT IS NEGATIVE
  9248         IF PI-OFFLINE NOT = 'Y'
  9249             MOVE ER-0836        TO  EMI-ERROR
  9250             MOVE -1             TO  OFFLINEL
  9251             MOVE AL-UABON       TO  OFFLINEA
  9252             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9253
  9254     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9255        MOVE ER-0872             TO EMI-ERROR
  9256        MOVE -1                  TO PROOFDTL
  9257        MOVE AL-UABON            TO PROOFDTA
  9258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9259     ELSE
  9260        MOVE '4'                TO DC-OPTION-CODE
  9261        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9262        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9263        IF DATE-CONVERSION-ERROR
  9264            MOVE ER-0873        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 176
* EL156.cbl
  9265            MOVE -1                  TO PROOFDTL
  9266            MOVE AL-UABON            TO PROOFDTA
  9267            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9268        ELSE
  9269            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9270            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9271                MOVE ER-0873    TO EMI-ERROR
  9272                MOVE -1                  TO PROOFDTL
  9273                MOVE AL-UABON            TO PROOFDTA
  9274                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9275            END-IF
  9276        END-IF
  9277     END-IF.
  9278
  9279     IF PI-COMPANY-ID = 'DMD'
  9280        IF NOTE1L NOT = ZEROS
  9281            MOVE ER-7844        TO  EMI-ERROR
  9282            MOVE -1             TO  NOTE1L
  9283            MOVE AL-UABON       TO  NOTE1A
  9284            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9285
  9286     IF PI-COMPANY-ID = 'DMD'
  9287        IF NOTE2L NOT = ZEROS
  9288          GO TO 1004-DMD-EOB-CHECKS.
  9289
  9290     IF NOTE1L NOT > +0
  9291         GO TO 1005-CHECK-ERRORS.
  9292
  9293     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9294         GO TO 1005-CHECK-ERRORS.
  9295
  9296     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9297         GO TO 1003-HAN-PMT-NOTES.
  9298
  9299     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9300
  9301     IF WS-PMTOPTION NUMERIC
  9302        IF WS-PMTOPTION > '00' AND < '17'
  9303           NEXT SENTENCE
  9304        ELSE
  9305           MOVE ER-0618          TO EMI-ERROR
  9306           MOVE -1               TO NOTE1L
  9307           MOVE AL-UABON         TO NOTE1A
  9308           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9309     ELSE
  9310        GO TO 1005-CHECK-ERRORS.
  9311
  9312     IF WS-PMTOPTION = '05' AND
  9313        WS-DOCNAME = SPACES
  9314          MOVE ER-0616             TO EMI-ERROR
  9315          MOVE -1                  TO NOTE1L
  9316          MOVE AL-UABON            TO NOTE1A
  9317          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9318
  9319     IF WS-PMTOPTION = '15' OR '16'
  9320
  9321* EXEC CICS BIF DEEDIT
  9322*            FIELD (WS-AMOUNT)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 177
* EL156.cbl
  9323*            LENGTH(08)
  9324*        END-EXEC
  9325     MOVE 08
  9326       TO DFHEIV11
  9327*    MOVE '@"L                   #   #00009001' TO DFHEIV0
  9328     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9329     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9330     MOVE X'2020233030303039303031' TO DFHEIV0(25:11)
  9331     CALL 'kxdfhei1' USING DFHEIV0,
  9332           WS-AMOUNT,
  9333           DFHEIV11
  9334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9335        IF (WS-NUM-AMT = ZEROS) OR
  9336           (WS-AMOUNT NOT NUMERIC)
  9337           MOVE ER-0617          TO EMI-ERROR
  9338           MOVE -1               TO NOTE1L
  9339           MOVE AL-UABON         TO NOTE1A
  9340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9341
  9342     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9343
  9344     GO TO 1005-CHECK-ERRORS.
  9345
  9346 1003-HAN-PMT-NOTES.
  9347
  9348     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9349
  9350     IF WS-HAN-PMT-CODE = SPACE
  9351         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9352     ELSE
  9353     IF WS-HAN-PMT-CODE = 'A'
  9354         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9355                                 TO WS-HAN-PMT-NOTE
  9356     ELSE
  9357     IF WS-HAN-PMT-CODE = 'B'
  9358         MOVE ':FINAL PAYMENT / DECEASED'
  9359                                 TO WS-HAN-PMT-NOTE
  9360     ELSE
  9361     IF WS-HAN-PMT-CODE = 'C'
  9362         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9363                                 TO WS-HAN-PMT-NOTE
  9364     ELSE
  9365     IF WS-HAN-PMT-CODE = 'D'
  9366         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9367                                 TO WS-HAN-PMT-NOTE
  9368     ELSE
  9369     IF WS-HAN-PMT-CODE = 'E'
  9370         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9371                                 TO WS-HAN-PMT-NOTE
  9372     ELSE
  9373     IF WS-HAN-PMT-CODE = 'F'
  9374         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9375                                 TO WS-HAN-PMT-NOTE
  9376     ELSE
  9377     IF WS-HAN-PMT-CODE = 'P'
  9378         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9379
  9380     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 178
* EL156.cbl
  9381     GO TO 1005-CHECK-ERRORS.
  9382
  9383 1004-DMD-EOB-CHECKS.
  9384
  9385     INITIALIZE PI-AT-EOB-CODES.
  9386
  9387     IF NOTE2I (20:21) > SPACES
  9388         MOVE ER-7845          TO EMI-ERROR
  9389         MOVE -1               TO NOTE2L
  9390         MOVE AL-UABON         TO NOTE2A
  9391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9392         GO TO 1005-CHECK-ERRORS
  9393      ELSE
  9394         MOVE NOTE2I             TO W-EOB-CODES.
  9395
  9396     MOVE +1                     TO W-EOB-NDX.
  9397
  9398 1004-CHECK-EACH-EOB.
  9399
  9400     IF W-EOB-NDX > +5
  9401             OR
  9402        W-EOB-CODE (W-EOB-NDX) = SPACES
  9403         GO TO 1004-CHECK-DUP-EOB.
  9404
  9405     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9406         MOVE ER-0956            TO EMI-ERROR
  9407         MOVE -1                 TO NOTE2L
  9408         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9409         GO TO 1005-CHECK-ERRORS.
  9410
  9411     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9412     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9413     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9414     MOVE 'DLO023'               TO PGM-NAME.
  9415
  9416
  9417* EXEC CICS LINK
  9418*        PROGRAM    (PGM-NAME)
  9419*        COMMAREA   (CD-COMMUNICATION-AREA)
  9420*        LENGTH     (CD-RCRD-LENGTH)
  9421*    END-EXEC.
  9422*    MOVE '."C                   (   #00009086' TO DFHEIV0
  9423     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9425     MOVE X'2020233030303039303836' TO DFHEIV0(25:11)
  9426     CALL 'kxdfhei1' USING DFHEIV0,
  9427           PGM-NAME,
  9428           CD-COMMUNICATION-AREA,
  9429           CD-RCRD-LENGTH,
  9430           DFHEIV99,
  9431           DFHEIV99,
  9432           DFHEIV99,
  9433           DFHEIV99
  9434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9435
  9436
  9437     IF CD-RETURN-CODE = 'OK'
  9438         GO TO 1004-CONT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 179
* EL156.cbl
  9439
  9440     MOVE -1                     TO NOTE2L.
  9441
  9442     IF CD-RETURN-CODE = '01'
  9443         MOVE ER-8310            TO EMI-ERROR
  9444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9445         GO TO 1005-CHECK-ERRORS.
  9446
  9447     IF CD-RETURN-CODE = '02'
  9448         MOVE ER-8311            TO EMI-ERROR
  9449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9450         GO TO 1005-CHECK-ERRORS.
  9451
  9452     IF CD-RETURN-CODE = '03'
  9453         MOVE ER-8312            TO EMI-ERROR
  9454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9455         GO TO 1005-CHECK-ERRORS.
  9456
  9457     IF CD-RETURN-CODE = '04'
  9458         MOVE ER-8313            TO EMI-ERROR
  9459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9460         GO TO 1005-CHECK-ERRORS.
  9461
  9462     IF CD-RETURN-CODE = '05'
  9463         MOVE ER-8314            TO EMI-ERROR
  9464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9465         GO TO 1005-CHECK-ERRORS.
  9466
  9467     IF CD-RETURN-CODE = '06'
  9468         MOVE ER-8315            TO EMI-ERROR
  9469         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9470         GO TO 1005-CHECK-ERRORS.
  9471
  9472     IF CD-RETURN-CODE = 'E1'
  9473         MOVE ER-8316            TO EMI-ERROR
  9474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9475         GO TO 1005-CHECK-ERRORS.
  9476
  9477     IF CD-RETURN-CODE = 'N1'
  9478         MOVE ER-8317            TO EMI-ERROR
  9479         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9480         GO TO 1005-CHECK-ERRORS.
  9481
  9482 1004-CONT.
  9483     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9484
  9485     ADD +1 TO W-EOB-NDX.
  9486     GO TO 1004-CHECK-EACH-EOB.
  9487
  9488 1004-CHECK-DUP-EOB.
  9489     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9490         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9491                               PI-AT-EOB-CODE (3) OR
  9492                               PI-AT-EOB-CODE (4) OR
  9493                               PI-AT-EOB-CODE (5)))
  9494                  OR
  9495        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9496         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 180
* EL156.cbl
  9497                               PI-AT-EOB-CODE (4) OR
  9498                               PI-AT-EOB-CODE (5)))
  9499                  OR
  9500        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9501         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9502                               PI-AT-EOB-CODE (5)))
  9503                  OR
  9504        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9505         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9506            MOVE ER-8000            TO EMI-ERROR
  9507            MOVE AL-UABON           TO NOTE2A
  9508            MOVE -1                 TO NOTE2L
  9509            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9510            GO TO 1005-CHECK-ERRORS.
  9511
  9512 1005-CHECK-ERRORS.
  9513*    IF PI-COMPANY-ID NOT = 'DMD'
  9514        GO TO 1006-CHECK-ERRORS.
  9515
  9516*********  DMD CODE START ******************
  9517*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9518*       GO TO 1006-CHECK-ERRORS.
  9519*
  9520*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9521*
  9522*    COMPUTE W-PAYMENT-TOTAL
  9523*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9524*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9525*               AND
  9526*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9527*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9528*          MOVE ER-0967    TO EMI-ERROR
  9529*          MOVE -1         TO PMTTYPEL
  9530*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9531*
  9532*    GO TO 1006-CHECK-ERRORS.
  9533*********  DMD CODE END ******************
  9534
  9535 1006-CHECK-ERRORS.
  9536     IF NOT EMI-NO-ERRORS
  9537        GO TO 2000-EDIT-DONE.
  9538
  9539
  9540* EXEC CICS HANDLE CONDITION
  9541*        NOTFND(1950-NOT-FOUND)
  9542*    END-EXEC.
  9543*    MOVE '"$I                   ! '' #00009194' TO DFHEIV0
  9544     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9546     MOVE X'2720233030303039313934' TO DFHEIV0(25:11)
  9547     CALL 'kxdfhei1' USING DFHEIV0
  9548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9549
  9550
  9551     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9552     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9553     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9554     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 181
* EL156.cbl
  9555     MOVE 'MSTR'                 TO FILE-SWITCH.
  9556
  9557     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9558
  9559     IF PI-COMPANY-ID = 'DMD'
  9560         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9561
  9562     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9563        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9564           MOVE ER-0873    TO EMI-ERROR
  9565           MOVE -1                  TO PROOFDTL
  9566           MOVE AL-UABON            TO PROOFDTA
  9567           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9568        END-IF
  9569     END-IF
  9570     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9571     MOVE +95                    TO TRLR-SEQ-NO
  9572
  9573* EXEC CICS READ
  9574*       DATASET  ('ELTRLR')
  9575*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9576*       RIDFLD   (ELTRLR-KEY)
  9577*       RESP     (WS-RESPONSE)
  9578*    END-EXEC
  9579     MOVE 'ELTRLR' TO DFHEIV1
  9580*    MOVE '&"S        E          (  N#00009219' TO DFHEIV0
  9581     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9583     MOVE X'204E233030303039323139' TO DFHEIV0(25:11)
  9584     CALL 'kxdfhei1' USING DFHEIV0,
  9585           DFHEIV1,
  9586           DFHEIV20,
  9587           DFHEIV99,
  9588           ELTRLR-KEY,
  9589           DFHEIV99,
  9590           DFHEIV99,
  9591           DFHEIV99
  9592     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9593         DFHEIV20
  9594     MOVE EIBRESP  TO WS-RESPONSE
  9595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9596
  9597     if ws-resp-normal
  9598        perform varying s1 from +1 by +1 until
  9599           at-note-error-no (s1) = spaces
  9600           if at-note-error-no (s1) = '1662'
  9601              continue
  9602           else
  9603              move at-note-error-no (s1)
  9604                                 to emi-error
  9605              if at-note-error-no (s1) = '1653'
  9606                 evaluate true
  9607                    when cl-claim-type = 'L'
  9608                       move '  LF  '
  9609                                 to emi-claim-type
  9610                    when cl-claim-type = 'I'
  9611                       move '  IU  '
  9612                                 to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 182
* EL156.cbl
  9613                    when other
  9614                       move '  AH  '
  9615                                 to emi-claim-type
  9616                 end-evaluate
  9617              end-if
  9618              PERFORM 9900-ERROR-FORMAT
  9619                                 THRU 9900-EXIT
  9620           end-if
  9621        end-perform
  9622     end-if
  9623     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9624         IF PI-PMTTYPE = '5' OR '6'
  9625             NEXT SENTENCE
  9626         ELSE
  9627             MOVE ER-0555             TO EMI-ERROR
  9628             MOVE -1                  TO PMTTYPEL
  9629             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9630
  9631     IF CL-LAST-CLOSE-REASON = '2'
  9632         IF CL-CLAIM-STATUS = 'C'
  9633             MOVE ER-0760        TO  EMI-ERROR
  9634             MOVE -1             TO  PMTTYPEL
  9635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9636
  9637     IF PI-ACTIVITY-CODE = 9
  9638         MOVE ER-3538            TO  EMI-ERROR
  9639         MOVE -1                 TO  PMTTYPEL
  9640         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9641
  9642     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9643         GO TO 1008-READ-CERT.
  9644**********************AIG LOGIC STARTS *********************
  9645     IF CL-CERT-PRIME = 'INCOMPLETE'
  9646         MOVE ER-3540            TO  EMI-ERROR
  9647         MOVE -1                 TO  PMTTYPEL
  9648         MOVE AL-UABON           TO  PMTTYPEA
  9649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9650         GO TO 2000-EDIT-DONE.
  9651
  9652     IF PI-PMTTYPE = '4'
  9653         IF PI-EPYAMT IS NEGATIVE
  9654             IF PI-ECHECKNO-CR = 'CR'
  9655                 NEXT SENTENCE
  9656             ELSE
  9657                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9658
  9659     IF PI-PMTTYPE = '4'
  9660         IF PI-ECHECKNO-CR = 'CR'
  9661             IF PI-EPYAMT IS NEGATIVE
  9662                 NEXT SENTENCE
  9663             ELSE
  9664                 MOVE ER-0834    TO  EMI-ERROR
  9665                 MOVE -1         TO  EPYAMTL
  9666                 MOVE AL-UNBON   TO  EPYAMTA
  9667                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9668
  9669     IF PI-PMTTYPE = '4'
  9670         IF PI-EPYAMT IS NEGATIVE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 183
* EL156.cbl
  9671             IF PI-OFFLINE = 'Y'
  9672                 NEXT SENTENCE
  9673             ELSE
  9674                 MOVE 'Y'        TO  PI-OFFLINE
  9675                                     WS-OFFLINE
  9676                                     OFFLINEO
  9677                 MOVE AL-UANON   TO  OFFLINEA.
  9678
  9679*    IF PI-PMTTYPE = '4'
  9680*        IF PI-EPYAMT IS NEGATIVE
  9681*            IF PI-CASH = 'Y'
  9682*                NEXT SENTENCE
  9683*            ELSE
  9684*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9685*                MOVE AL-UANON   TO  CASHA
  9686*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9687*
  9688*    IF PI-CASH NOT = 'Y' AND 'N'
  9689*         IF PI-OFFLINE = 'Y'  AND
  9690*            PI-ECHECKNO-CR = 'CR'
  9691*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9692*              MOVE AL-UANON     TO  CASHA
  9693*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9694*
  9695*    IF PI-CASH NOT = 'Y' AND 'N'
  9696*        IF PI-PMTTYPE = '5' OR '6'
  9697*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9698*            MOVE AL-UANON       TO  CASHA
  9699*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9700*
  9701*    IF PI-CASH NOT = 'Y' AND 'N'
  9702*       IF CL-ASSOCIATES = 'N' OR 'A'
  9703*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9704*           MOVE AL-UANON        TO  CASHA
  9705*       ELSE
  9706*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9707*           MOVE AL-UANON        TO  CASHA.
  9708*
  9709*    IF PI-PMTTYPE = '5' OR '6'
  9710*        IF PI-CASH = 'N'
  9711*            MOVE ER-0819        TO  EMI-ERROR
  9712*            MOVE AL-UANON       TO  CASHA
  9713*            MOVE -1             TO  CASHL
  9714*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9715*
  9716*    IF CL-ASSOCIATES = 'N' OR 'A'
  9717*       IF CASHI = 'N'
  9718*        MOVE ER-3537            TO  EMI-ERROR
  9719*        MOVE AL-UANON           TO  CASHA
  9720*        MOVE -1                 TO  CASHL
  9721*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9722
  9723 1007-DEFAULT-AIG-CHECKNO.
  9724
  9725     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9726         MOVE ER-3532            TO  EMI-ERROR
  9727         MOVE -1                 TO  PMTTYPEL
  9728         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 184
* EL156.cbl
  9729**********************AIG LOGIC ENDS ***********************
  9730
  9731 1008-READ-CERT.
  9732
  9733     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9734     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9735     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9736     MOVE CL-CERT-STATE          TO CERT-STATE.
  9737     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9738     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9739     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9740     MOVE 'CERT'                 TO FILE-SWITCH.
  9741
  9742     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9743
  9744     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9745         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9746     ELSE
  9747         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9748
  9749*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9750*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9751
  9752     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9753         MOVE ER-0458            TO EMI-ERROR
  9754         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9755
  9756     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9757         MOVE ER-0459            TO EMI-ERROR
  9758         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9759
  9760     IF CL-REPORTED-DT = LOW-VALUES
  9761        MOVE ER-0530             TO EMI-ERROR
  9762        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9763
  9764     IF PI-COMPANY-ID = 'NCL'
  9765        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9766            MOVE ER-0770            TO EMI-ERROR
  9767            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9768
  9769     IF PI-COMPANY-ID = 'NCL'
  9770        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9771            MOVE ER-0737            TO EMI-ERROR
  9772            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9773
  9774     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9775         MOVE ER-0768            TO  EMI-ERROR
  9776         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9777
  9778     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9779         MOVE ER-0769            TO  EMI-ERROR
  9780         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9781
  9782     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9783         GO TO 1020-DO-LIFE-EDITS
  9784     ELSE
  9785         GO TO 1030-DO-AH-EDITS.
  9786
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 185
* EL156.cbl
  9787 1010-GENERAL-ERROR.
  9788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9789
  9790     IF EMI-MESSAGE-FORMATTED
  9791         MOVE -1                 TO PMTTYPEL.
  9792
  9793 1010-EXIT.
  9794     EXIT.
  9795
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 186
* EL156.cbl
  9797 1020-DO-LIFE-EDITS.
  9798     IF CM-LF-BENEFIT-CD = '00'
  9799         IF PI-PMTTYPE = '5' OR '6'
  9800             MOVE ER-0658        TO EMI-ERROR
  9801             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9802         ELSE
  9803             MOVE ER-1775        TO EMI-ERROR
  9804             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9805
  9806     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9807     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9808         MOVE ER-0460            TO EMI-ERROR
  9809         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9810
  9811     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9812     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9813     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9814     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9815     MOVE '4'                    TO  CNTL-REC-TYPE.
  9816     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9817     MOVE 'BENE'                 TO  FILE-SWITCH.
  9818     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9819     IF NO-BENEFIT-FOUND
  9820         GO TO 1950-NOT-FOUND.
  9821
  9822     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9823
  9824     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9825         IF PI-PMTTYPE = '4'
  9826             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9827                PI-LF-COVERAGE-TYPE = 'P'
  9828                 NEXT SENTENCE
  9829             ELSE
  9830                 MOVE ER-0461        TO EMI-ERROR
  9831                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9832         ELSE
  9833            NEXT SENTENCE
  9834     ELSE
  9835         IF PI-PMTTYPE = '2'
  9836            IF NOT CM-O-B-COVERAGE
  9837              AND CM-LF-CURRENT-STATUS = '7'
  9838                MOVE ER-0462     TO EMI-ERROR
  9839                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9840
  9841     IF PI-PMTTYPE = '2'
  9842         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9843            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9844             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9845             MOVE ER-0730            TO  EMI-ERROR
  9846             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9847             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9848
  9849     IF PI-PMTTYPE = '2'
  9850         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9851            PI-LF-COVERAGE-TYPE = 'P'
  9852             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9853                 MOVE ER-0462    TO  EMI-ERROR
  9854                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 187
* EL156.cbl
  9855
  9856     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9857       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9858         MOVE ER-0466            TO EMI-ERROR
  9859         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9860
  9861     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9862         IF PI-PMTTYPE = '3'
  9863             MOVE 0436           TO EMI-ERROR
  9864             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9865             GO TO 1045-EDIT-PAYEE-ADDR
  9866         ELSE
  9867             GO TO 1045-EDIT-PAYEE-ADDR.
  9868
  9869     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9870        PI-LF-COVERAGE-TYPE = 'P'
  9871         IF PI-PMTTYPE = '3'
  9872             MOVE ER-0436          TO  EMI-ERROR
  9873             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9874         ELSE
  9875             NEXT SENTENCE
  9876     ELSE
  9877         IF PI-PMTTYPE = '1' OR '3'
  9878             MOVE ER-0436            TO EMI-ERROR
  9879             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9880*
  9881     IF PI-COMPANY-ID = 'CID' AND
  9882        CL-CERT-STATE = 'SC'  AND
  9883        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9884           MOVE ER-0879    TO  EMI-ERROR
  9885           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9886           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9887     END-IF.
  9888     IF PI-COMPANY-ID = 'AHL'
  9889        evaluate true
  9890           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9891              MOVE ER-0879       TO  EMI-ERROR
  9892              PERFORM 1040-PMTTYPE-ERROR
  9893                                 THRU 1040-EXIT
  9894              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9895           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9896                 '6D' OR '6H' OR '6R'
  9897              MOVE ER-0879       TO  EMI-ERROR
  9898              PERFORM 1040-PMTTYPE-ERROR
  9899                                 THRU 1040-EXIT
  9900              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9901           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9902              MOVE ER-0879       TO  EMI-ERROR
  9903              PERFORM 1040-PMTTYPE-ERROR
  9904                                 THRU 1040-EXIT
  9905              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9906        end-evaluate
  9907     END-IF
  9908     GO TO 1045-EDIT-PAYEE-ADDR.
  9909
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 188
* EL156.cbl
  9911 1030-DO-AH-EDITS.
  9912     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9913     IF CM-AH-BENEFIT-CD = '00'
  9914         IF PI-PMTTYPE = '5' OR '6'
  9915             MOVE ER-0658        TO EMI-ERROR
  9916             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9917         ELSE
  9918             MOVE ER-1775        TO EMI-ERROR
  9919             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9920
  9921     IF CL-TOTAL-PAID-AMT = ZEROS
  9922         IF PI-PMTTYPE = '4'
  9923             MOVE ER-0438        TO EMI-ERROR
  9924             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9925
  9926     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9927         IF PI-PMTTYPE = '3'
  9928             MOVE ER-0463        TO EMI-ERROR
  9929             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9930         ELSE
  9931             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9932              AND CM-LF-CURRENT-STATUS = '7'
  9933                 MOVE ER-0465    TO EMI-ERROR
  9934                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9935
  9936     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9937         IF PI-PMTTYPE = '3'
  9938             MOVE ER-0464        TO EMI-ERROR
  9939             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9940         ELSE
  9941             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9942                 MOVE ER-0469    TO EMI-ERROR
  9943                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9944
  9945     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9946         IF PI-PMTTYPE = '3'
  9947             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9948                 MOVE ER-0467    TO EMI-ERROR
  9949                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9950             ELSE
  9951                 NEXT SENTENCE
  9952         ELSE
  9953             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9954                 MOVE ER-0468    TO EMI-ERROR
  9955                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9956
  9957     GO TO 1045-EDIT-PAYEE-ADDR.
  9958
  9959 1040-PMTTYPE-ERROR.
  9960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9961
  9962     IF EMI-MESSAGE-FORMATTED
  9963         MOVE -1                 TO PMTTYPEL
  9964         MOVE AL-UABON           TO PMTTYPEA.
  9965
  9966 1040-EXIT.
  9967     EXIT.
  9968
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 189
* EL156.cbl
  9970 1045-EDIT-PAYEE-ADDR.
  9971
  9972     IF PI-OFFLINE = 'N' AND
  9973        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9974           < PI-PAYEE-SEQ-NUM)
  9975        OR
  9976         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9977         (PI-PAYEE-TYPE = 'B')                 AND
  9978         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9979        OR
  9980         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9981           < PI-PAYEE-SEQ-NUM)
  9982        OR
  9983         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9984           < PI-PAYEE-SEQ-NUM)
  9985        OR
  9986         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9987           < PI-PAYEE-SEQ-NUM)
  9988        OR
  9989         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9990           < PI-PAYEE-SEQ-NUM)
  9991        OR
  9992         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9993           < PI-PAYEE-SEQ-NUM))
  9994             MOVE ER-0437        TO EMI-ERROR
  9995             MOVE -1             TO PAYEEL
  9996             MOVE AL-UABON       TO PAYEEA
  9997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9998
  9999     IF PI-OFFLINE    = 'N' AND
 10000        PI-PAYEE-TYPE = 'B' AND
 10001        PI-PAYEE-SEQ  = '0'
 10002         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10003         IF BENE-FOUND-SW = 'N'
 10004             MOVE ER-0437        TO EMI-ERROR
 10005             MOVE -1             TO PAYEEL
 10006             MOVE AL-UABON       TO PAYEEA
 10007             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10008
 10009     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10010        IF PI-OFFLINE    = 'N'  AND
 10011           PI-PAYEE-TYPE = 'B'  AND
 10012           PI-PAYEE-SEQ  = '9'
 10013             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10014             IF BENE-FOUND-SW = 'N'
 10015                MOVE ER-0437        TO EMI-ERROR
 10016                MOVE -1             TO PAYEEL
 10017                MOVE AL-UABON       TO PAYEEA
 10018                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10019
 10020*    IF PI-COMPANY-ID = 'CRI'
 10021*        IF CL-CLAIM-TYPE = 'L'
 10022*            MOVE 'N'                TO  WS-GROUPED
 10023*                                        PI-GROUPED
 10024*                                        GROUPEDI
 10025*            MOVE AL-UANON           TO  GROUPEDA
 10026*            GO TO 1050-EDIT-CHECK-NO
 10027*        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 190
* EL156.cbl
 10028*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10029*            IF WS-GROUP-1 = 'C'
 10030*                NEXT SENTENCE
 10031*            ELSE
 10032*                MOVE 'N'            TO  WS-GROUPED
 10033*                                        PI-GROUPED
 10034*                                        GROUPEDI
 10035*                MOVE AL-UANON       TO  GROUPEDA
 10036*                GO TO 1050-EDIT-CHECK-NO.
 10037
 10038*     IF PI-GROUPED = 'Y'
 10039*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10040*           NEXT SENTENCE
 10041*        ELSE
 10042*           MOVE ER-0437        TO EMI-ERROR
 10043*           MOVE -1             TO PAYEEL
 10044**02180            MOVE AL-UABON       TO PAYEEA
 10045*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10046*
 10047*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10048*        (PI-GROUPED    = ' ')
 10049*        NEXT SENTENCE
 10050*     ELSE
 10051*
 10052     GO TO 1050-EDIT-CHECK-NO.
 10053*     IF PI-COMPANY-ID = 'CRI'
 10054*        MOVE 'N'           TO GROUPEDI
 10055*                              PI-GROUPED
 10056*                              WS-GROUPED
 10057*        MOVE AL-UANON      TO GROUPEDA.
 10058*
 10059*     IF PI-COMPANY-ID = 'CRI'
 10060*        IF PI-PAYEE-TYPE = 'B'
 10061*           IF BENE-FOUND-SW = 'Y'
 10062*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10063*                 MOVE 'Y'           TO GROUPEDI
 10064*                                       PI-GROUPED
 10065*                                       WS-GROUPED
 10066*                 MOVE AL-UANON      TO GROUPEDA
 10067*              ELSE
 10068*                 NEXT SENTENCE
 10069*           ELSE
 10070*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10071*              IF BENE-FOUND-SW = 'Y'
 10072*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10073*                    MOVE 'Y'      TO GROUPEDI
 10074*                                     PI-GROUPED
 10075*                                     WS-GROUPED
 10076*                    MOVE AL-UANON TO GROUPEDA.
 10077*
 10078
 10079     IF PI-COMPANY-ID NOT = 'CRI'
 10080        GO TO 1050-EDIT-CHECK-NO.
 10081
 10082*************** CRI CODE START ******************
 10083     IF PI-PAYEE-TYPE NOT = 'A'
 10084        GO TO 1050-EDIT-CHECK-NO.
 10085
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 191
* EL156.cbl
 10086     MOVE LOW-VALUES             TO ERACCT-KEY.
 10087     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10088     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10089     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10090     MOVE PI-STATE               TO ACCT-STATE.
 10091     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10092     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10093     MOVE 'ACCT'                 TO FILE-SWITCH.
 10094
 10095     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10096     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10097
 10098
 10099* EXEC CICS HANDLE CONDITION
 10100*         NOTFND   (1950-NOT-FOUND)
 10101*         ENDFILE  (1950-NOT-FOUND)
 10102*    END-EXEC.
 10103*    MOVE '"$I''                  ! ( #00009727' TO DFHEIV0
 10104     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10106     MOVE X'2820233030303039373237' TO DFHEIV0(25:11)
 10107     CALL 'kxdfhei1' USING DFHEIV0
 10108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10109
 10110
 10111
 10112* EXEC CICS STARTBR
 10113*         DATASET   ('ERACCT')
 10114*         RIDFLD    (ERACCT-KEY)
 10115*         GTEQ
 10116*    END-EXEC.
 10117     MOVE 'ERACCT' TO DFHEIV1
 10118     MOVE 0
 10119       TO DFHEIV11
 10120*    MOVE '&,         G          &   #00009732' TO DFHEIV0
 10121     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10122     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10123     MOVE X'2020233030303039373332' TO DFHEIV0(25:11)
 10124     CALL 'kxdfhei1' USING DFHEIV0,
 10125           DFHEIV1,
 10126           ERACCT-KEY,
 10127           DFHEIV99,
 10128           DFHEIV11,
 10129           DFHEIV99
 10130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10131
 10132
 10133 1046-READNEXT-ERACCT.
 10134
 10135
 10136* EXEC CICS READNEXT
 10137*         DATASET   ('ERACCT')
 10138*         RIDFLD    (ERACCT-KEY)
 10139*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10140*    END-EXEC.
 10141     MOVE 'ERACCT' TO DFHEIV1
 10142     MOVE 0
 10143       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 192
* EL156.cbl
 10144*    MOVE '&.S                   )   #00009740' TO DFHEIV0
 10145     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10146     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10147     MOVE X'2020233030303039373430' TO DFHEIV0(25:11)
 10148     CALL 'kxdfhei1' USING DFHEIV0,
 10149           DFHEIV1,
 10150           DFHEIV20,
 10151           DFHEIV99,
 10152           ERACCT-KEY,
 10153           DFHEIV99,
 10154           DFHEIV11,
 10155           DFHEIV99,
 10156           DFHEIV99
 10157     SET ADDRESS OF ACCOUNT-MASTER TO
 10158         DFHEIV20
 10159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10160
 10161
 10162     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10163        IF WS-ERACCT-HOLD-RECORD = SPACES
 10164           GO TO 1950-NOT-FOUND
 10165        ELSE
 10166           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10167           GO TO 1048-CONTINUE.
 10168
 10169     IF ACCT-EXP-DT = HIGH-VALUES
 10170        NEXT SENTENCE
 10171     ELSE
 10172        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10173        GO TO 1046-READNEXT-ERACCT.
 10174
 10175 1048-CONTINUE.
 10176
 10177*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10178*       MOVE 'Y'                 TO GROUPEDI
 10179*                                   PI-GROUPED
 10180*                                   WS-GROUPED
 10181*       MOVE AL-UANON            TO GROUPEDA.
 10182*************** CRI CODE END ******************
 10183
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 193
* EL156.cbl
 10185 1050-EDIT-CHECK-NO.
 10186
 10187     IF PI-OFFLINE = 'Y'
 10188         IF PI-ECHECKNO = SPACES
 10189              MOVE ER-0439        TO EMI-ERROR
 10190              GO TO 1090-CHECK-NO-ERROR
 10191           ELSE
 10192*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10193*           IF PI-ECHECKNO-N = 'N' AND
 10194*              PI-CASH       = 'Y'
 10195*                MOVE ER-3535        TO EMI-ERROR
 10196*                GO TO 1090-CHECK-NO-ERROR
 10197*             ELSE
 10198*                MOVE AL-UANON    TO CHECKNOA
 10199*                GO TO 1100-EDIT-HOLDTIL
 10200*         ELSE
 10201            MOVE AL-UANON    TO CHECKNOA
 10202            GO TO 1100-EDIT-HOLDTIL.
 10203
 10204     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10205     MOVE '6'                    TO CNTL-REC-TYPE.
 10206
 10207     IF CONTROL-IS-ACTUAL-CARRIER
 10208         MOVE PI-CARRIER         TO WS-CARR
 10209     ELSE
 10210         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10211
 10212     IF PI-COMPANY-ID = 'FIA'
 10213         MOVE PI-CARRIER         TO WS-CARR.
 10214
 10215     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10216     MOVE 0                      TO CNTL-SEQ-NO.
 10217     MOVE 'CARR'                 TO FILE-SWITCH.
 10218
 10219     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10220
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 194
* EL156.cbl
 10222     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10223         GO TO 1051-EDIT-CHECKNO-CONT.
 10224
 10225**********************AIG LOGIC STARTS**********************
 10226     IF PI-ECHECKNO = SPACES
 10227         IF CHECK-NO-MANUAL
 10228             MOVE ER-0441        TO EMI-ERROR
 10229             GO TO 1090-CHECK-NO-ERROR
 10230         ELSE
 10231             MOVE AL-UANOF       TO CHECKNOA
 10232             GO TO 1100-EDIT-HOLDTIL.
 10233
 10234     IF PI-ECHECKNO NOT = SPACES
 10235         IF CHECK-NO-MANUAL
 10236             MOVE AL-UANON       TO CHECKNOA
 10237             GO TO 1100-EDIT-HOLDTIL.
 10238
 10239     IF PI-ECHECKNO-CR = 'CR'
 10240        IF PI-OFFLINE = 'Y'
 10241            MOVE AL-UANON       TO CHECKNOA
 10242            GO TO 1100-EDIT-HOLDTIL
 10243        ELSE
 10244            MOVE ER-3534        TO EMI-ERROR
 10245            GO TO 1090-CHECK-NO-ERROR.
 10246
 10247     IF PI-ECHECKNO-N = 'N'
 10248        IF PI-CASH = 'N'
 10249            MOVE AL-UANON       TO CHECKNOA
 10250            GO TO 1100-EDIT-HOLDTIL
 10251        ELSE
 10252            MOVE ER-3535          TO EMI-ERROR
 10253            GO TO 1090-CHECK-NO-ERROR.
 10254
 10255     MOVE ER-0442        TO EMI-ERROR
 10256     GO TO 1090-CHECK-NO-ERROR.
 10257**********************AIG LOGIC ENDS************************
 10258
 10259 1051-EDIT-CHECKNO-CONT.
 10260
 10261     IF PI-COMPANY-ID = 'DMD'
 10262        IF PI-ECHECKNO NOT = SPACES
 10263           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10264              MOVE ER-0442        TO EMI-ERROR
 10265              GO TO 1090-CHECK-NO-ERROR
 10266            ELSE
 10267              GO TO 1100-EDIT-HOLDTIL
 10268          ELSE
 10269           GO TO 1100-EDIT-HOLDTIL.
 10270
 10271     IF PI-ECHECKNO = SPACES
 10272         IF CHECK-NO-MANUAL
 10273             MOVE ER-0441        TO EMI-ERROR
 10274             GO TO 1090-CHECK-NO-ERROR
 10275         ELSE
 10276             MOVE AL-UANOF       TO CHECKNOA
 10277             GO TO 1100-EDIT-HOLDTIL
 10278     ELSE
 10279         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 195
* EL156.cbl
 10280             MOVE AL-UANON       TO CHECKNOA
 10281             GO TO 1100-EDIT-HOLDTIL
 10282         ELSE
 10283             MOVE ER-0442        TO EMI-ERROR
 10284             GO TO 1090-CHECK-NO-ERROR.
 10285
 10286 1090-CHECK-NO-ERROR.
 10287     MOVE -1                     TO CHECKNOL.
 10288     MOVE AL-UABON               TO CHECKNOA.
 10289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10290
 10291     GO TO 2000-EDIT-DONE.
 10292
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 196
* EL156.cbl
 10294 1100-EDIT-HOLDTIL.
 10295     MOVE AL-UANON               TO HOLDTILA.
 10296
 10297     IF PI-HOLDTIL = ZEROS
 10298        IF PI-OFFLINE = 'Y'
 10299           MOVE ER-0572          TO EMI-ERROR
 10300           GO TO 1105-HOLDTIL-ERROR
 10301        ELSE
 10302           GO TO 1110-EDIT-PAID-FROM.
 10303
 10304     MOVE '4'                    TO DC-OPTION-CODE.
 10305     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10306     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10307
 10308     IF DATE-CONVERSION-ERROR
 10309         MOVE ER-0446            TO EMI-ERROR
 10310         GO TO 1105-HOLDTIL-ERROR
 10311     END-IF
 10312     IF PI-OFFLINE = 'Y'
 10313        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10314           MOVE ER-0446            TO EMI-ERROR
 10315           GO TO 1105-HOLDTIL-ERROR
 10316        END-IF
 10317     END-IF
 10318
 10319     IF PI-OFFLINE = 'Y'
 10320        GO TO 1110-EDIT-PAID-FROM.
 10321
 10322     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10323     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10324     MOVE '1'                    TO DC-OPTION-CODE.
 10325     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10326
 10327     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10328         MOVE ER-0447            TO EMI-ERROR
 10329         GO TO 1105-HOLDTIL-ERROR.
 10330
 10331     GO TO 1110-EDIT-PAID-FROM.
 10332
 10333 1105-HOLDTIL-ERROR.
 10334     MOVE -1                     TO HOLDTILL.
 10335     MOVE AL-UNBON               TO HOLDTILA.
 10336     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10337
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 197
* EL156.cbl
 10339 1110-EDIT-PAID-FROM.
 10340     MOVE AL-UANON               TO EPYFROMA.
 10341
 10342     IF PI-EPYFROM = ZEROS
 10343         GO TO 1120-CALCULATE-PAID-FROM.
 10344
 10345     IF PI-PMTTYPE = '5' OR '6'
 10346         MOVE ER-0448            TO EMI-ERROR
 10347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10348         MOVE AL-UNBON           TO EPYFROMA
 10349         MOVE -1                 TO EPYFROML
 10350         GO TO 1150-EDIT-PAID-THRU.
 10351
 10352     MOVE '4'                    TO DC-OPTION-CODE.
 10353     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10354     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10355
 10356     IF DATE-CONVERSION-ERROR
 10357         MOVE ER-0449            TO EMI-ERROR
 10358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10359         MOVE AL-UNBON           TO EPYFROMA
 10360         MOVE -1                 TO EPYFROML
 10361     ELSE
 10362         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10363
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 198
* EL156.cbl
 10365 1120-CALCULATE-PAID-FROM.
 10366     IF PI-PMTTYPE = '5' OR '6'
 10367         GO TO 1150-EDIT-PAID-THRU.
 10368
 10369*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10370*       IF PI-PMTTYPE = '4'
 10371*         GO TO 1150-EDIT-PAID-THRU.
 10372
 10373     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10374         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10375         MOVE ' '                TO DC-OPTION-CODE
 10376         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10377         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10378         GO TO 1145-TEST-PAID-FROM.
 10379
 10380     IF PI-PMTTYPE = '4'
 10381        GO TO 1150-EDIT-PAID-THRU.
 10382
 10383     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10384     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10385     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10386     MOVE '5'                    TO CNTL-REC-TYPE.
 10387     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10388     MOVE 'BENE'                 TO FILE-SWITCH.
 10389
 10390     IF WS-BEN-CD = ZEROS
 10391         GO TO 1950-NOT-FOUND.
 10392
 10393     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10394
 10395     IF NO-BENEFIT-FOUND
 10396         GO TO 1950-NOT-FOUND.
 10397
 10398     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10399     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10400
 10401     IF PI-BEN-DAYS NOT NUMERIC
 10402        MOVE ZEROS               TO PI-BEN-DAYS.
 10403
 10404     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10405
 10406     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10407        (CL-TOTAL-PAID-AMT > ZEROS)
 10408         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10409         MOVE '6'                 TO DC-OPTION-CODE
 10410         MOVE +0                  TO DC-ELAPSED-MONTHS
 10411         MOVE +1                  TO DC-ELAPSED-DAYS
 10412         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10413         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10414         GO TO 1145-TEST-PAID-FROM.
 10415
 10416******************************************************************
 10417****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10418****** SPECIAL ENTERED DATE.
 10419******************************************************************
 10420
 10421     IF PI-AIGFROM = ZEROS
 10422         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 199
* EL156.cbl
 10423
 10424     MOVE AL-UANON TO AIGFROMA.
 10425
 10426     MOVE '4'                    TO DC-OPTION-CODE.
 10427     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10428     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10429
 10430     IF DATE-CONVERSION-ERROR
 10431         MOVE ER-0449            TO EMI-ERROR
 10432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10433         MOVE AL-UNBON           TO AIGFROMA
 10434         MOVE -1                 TO AIGFROML
 10435         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10436     ELSE
 10437         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10438         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10439
 10440     GO TO 1140-CONTINUE-PAID-FROM.
 10441
 10442 1130-CONTINUE-PAID-FROM.
 10443
 10444     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10445        (CL-TOTAL-PAID-AMT = ZEROS)
 10446           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10447
 10448 1140-CONTINUE-PAID-FROM.
 10449
 10450     IF PI-BEN-TYPE = 'R'
 10451         IF PI-BEN-DAYS = ZEROS
 10452             NEXT SENTENCE
 10453         ELSE
 10454         IF PI-COMPANY-ID NOT = 'DMD'
 10455             SUBTRACT 1 FROM PI-BEN-DAYS.
 10456
 10457     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10458
 10459     IF PI-COMPANY-ID = 'DMD'
 10460         MOVE -1                 TO DC-ELAPSED-DAYS
 10461         MOVE +0                 TO DC-ELAPSED-MONTHS
 10462         MOVE '6'                TO DC-OPTION-CODE
 10463         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10464         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10465         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10466                               REMAINDER DC-ELAPSED-DAYS
 10467      ELSE
 10468         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10469         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10470
 10471     MOVE '6'                    TO DC-OPTION-CODE.
 10472     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10473     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10474
 10475     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10476
 10477     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10478         MOVE ER-0541            TO EMI-ERROR
 10479         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10480         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 200
* EL156.cbl
 10481         MOVE AL-UNBON           TO EPYFROMA.
 10482
 10483     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10484        (PI-BENEFIT-SAVE = '60E')
 10485        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10486           (CL-TOTAL-PAID-AMT = ZEROS)
 10487             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10488             MOVE 30                  TO DC-ELAPSED-DAYS
 10489             MOVE +0                  TO DC-ELAPSED-MONTHS
 10490             MOVE '6'                 TO DC-OPTION-CODE
 10491             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10492
 10493     IF PI-BEN-TYPE = 'R'
 10494         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10495     ELSE
 10496         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10497         IF WS-SV-EPYFROM = LOW-VALUES
 10498            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10499
 10500     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10501         IF WS-USE-AIG-PAYFROM   OR
 10502            WS-AIG-RECALC-PAYFROM
 10503              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10504                                      DC-BIN-DATE-1
 10505              MOVE ' '            TO  DC-OPTION-CODE
 10506              MOVE +0             TO  DC-ELAPSED-MONTHS
 10507                                      DC-ELAPSED-DAYS
 10508              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10509              IF NO-CONVERSION-ERROR
 10510                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10511
 10512     IF PI-CPYFROM < CL-INCURRED-DT
 10513        MOVE -1                  TO EPYFROML
 10514        MOVE ER-3542             TO EMI-ERROR
 10515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10516
 10517     IF CM-ENTRY-DT < CL-INCURRED-DT
 10518        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10519        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10520        MOVE +0                     TO DC-ELAPSED-DAYS
 10521        MOVE +0                     TO DC-ELAPSED-MONTHS
 10522        MOVE '1'                    TO DC-OPTION-CODE
 10523        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10524        ELSE
 10525        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10526
 10527     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10528         NEXT SENTENCE
 10529     ELSE
 10530         IF DC-ELAPSED-MONTHS < 2
 10531             MOVE ER-3255        TO EMI-ERROR
 10532             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10533
 10534 1145-TEST-PAID-FROM.
 10535     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10536         GO TO 1150-EDIT-PAID-THRU.
 10537
 10538     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 201
* EL156.cbl
 10539         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10540         MOVE ' '                TO DC-OPTION-CODE
 10541         MOVE +0                 TO DC-ELAPSED-MONTHS
 10542                                    DC-ELAPSED-DAYS
 10543         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10544         IF NO-CONVERSION-ERROR
 10545             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10546         ELSE
 10547             MOVE SPACES             TO EMI-DATE-FIELD.
 10548
 10549     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10550         IF CL-TOTAL-PAID-AMT = ZEROS
 10551             MOVE ER-3543            TO EMI-ERROR
 10552             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10553             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10554             IF EMI-MESSAGE-FORMATTED
 10555                MOVE -1             TO EPYFROML
 10556                MOVE AL-UNBON       TO EPYFROMA
 10557             ELSE
 10558                NEXT SENTENCE
 10559         ELSE
 10560             MOVE ER-0452            TO EMI-ERROR
 10561             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10562             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10563             IF EMI-MESSAGE-FORMATTED
 10564                MOVE -1             TO EPYFROML
 10565                MOVE AL-UNBON       TO EPYFROMA.
 10566
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 202
* EL156.cbl
 10568 1150-EDIT-PAID-THRU.
 10569
 10570     MOVE AL-UANON               TO EPYTHRUA.
 10571
 10572     IF PI-EPYTHRU = ZEROS
 10573         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10574             GO TO 1200-EDIT-FIND-TOLERANCES
 10575         ELSE
 10576            IF (PI-PMTTYPE = '3') OR
 10577               (PI-PMTTYPE = '2' AND
 10578                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10579               GO TO 1152-CHECK-TYPE
 10580            ELSE
 10581               MOVE ER-0473      TO EMI-ERROR
 10582               GO TO 1170-PAID-THRU-FATAL-ERROR
 10583     ELSE
 10584         IF PI-PMTTYPE = '5' OR '6'
 10585             MOVE ER-0474        TO EMI-ERROR
 10586             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10587
 10588     MOVE '4'                    TO DC-OPTION-CODE.
 10589     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10590     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10591
 10592     IF DATE-CONVERSION-ERROR
 10593         MOVE ER-0475            TO EMI-ERROR
 10594         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10595
 10596     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10597
 10598     IF PI-COMPANY-ID = 'DMD'
 10599         IF PI-PMTTYPE NOT = '2'
 10600                 AND
 10601            WS-EXP-DT > WS-SV-EPYTHRU
 10602             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10603             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10604             MOVE '1'              TO DC-OPTION-CODE
 10605             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10606             IF DATE-CONVERSION-ERROR
 10607                 MOVE ER-0944      TO EMI-ERROR
 10608                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10609             ELSE
 10610                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10611                    DC-ELAPSED-DAYS   = 1
 10612                     MOVE ER-0945  TO EMI-ERROR
 10613                     MOVE -1       TO EPYTHRUL
 10614                     MOVE AL-UABON TO EPYTHRUA
 10615                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10616
 10617     IF PI-PMTTYPE = '4'
 10618         NEXT SENTENCE
 10619     ELSE
 10620         IF WS-SV-EPYTHRU = WS-EXP-DT
 10621             IF PI-PMTTYPE NOT = '2' AND '3'
 10622                 MOVE ER-3541    TO EMI-ERROR
 10623                 MOVE -1         TO PMTTYPEL
 10624                 MOVE AL-UABON   TO PMTTYPEA
 10625                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 203
* EL156.cbl
 10626
 10627     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10628         MOVE ER-0501            TO EMI-ERROR
 10629         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10630
 10631     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10632        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10633*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10634*              MOVE ER-0540         TO EMI-ERROR
 10635*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10636*              MOVE -1              TO EPYTHRUL
 10637*              MOVE AL-UNBON        TO EPYTHRUA
 10638*          ELSE
 10639*          IF PI-COMPANY-ID = 'DMD'
 10640*              MOVE ER-7540         TO EMI-ERROR
 10641*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10642*              MOVE -1              TO EPYTHRUL
 10643*              MOVE AL-UNBON        TO EPYTHRUA
 10644*          ELSE
 10645               IF PI-PMTTYPE NOT = '2' AND '3'
 10646                  IF PI-COMPANY-ID = '???'
 10647                      MOVE ER-7540  TO EMI-ERROR
 10648                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10649                      MOVE -1       TO EPYTHRUL
 10650                      MOVE AL-UNBON TO EPYTHRUA
 10651                  ELSE
 10652                      MOVE ER-0540  TO EMI-ERROR
 10653                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10654                      MOVE -1       TO EPYTHRUL
 10655                      MOVE AL-UNBON TO EPYTHRUA.
 10656
 10657     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10658            OR
 10659        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10660         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10661            OR
 10662        (PI-CPYFROM NOT = LOW-VALUES AND
 10663         PI-CPYFROM < CL-PAID-THRU-DT)
 10664        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10665
 10666 1152-CHECK-TYPE.
 10667     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10668        OR (PI-PMTTYPE = '5' OR '6')
 10669         GO TO 1160-EDIT-PAID-THRU-AH.
 10670
 10671 1155-EDIT-PAID-THRU-LIFE.
 10672     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10673     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10674     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10675     MOVE '4'                    TO CNTL-REC-TYPE.
 10676     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10677     MOVE 'BENE'                 TO FILE-SWITCH.
 10678
 10679     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10680
 10681     IF NO-BENEFIT-FOUND
 10682         GO TO 1950-NOT-FOUND.
 10683
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 204
* EL156.cbl
 10684     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10685
 10686     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10687
 10688     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10689        PI-LF-COVERAGE-TYPE = 'P'
 10690         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10691         GO TO 1200-EDIT-FIND-TOLERANCES.
 10692
 10693     IF PI-EPYTHRU = ZEROS
 10694        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10695
 10696     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10697         MOVE ER-0476            TO EMI-ERROR
 10698         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10699
 10700     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10701*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10702     move cl-critical-period    to dc-elapsed-months
 10703     MOVE +0                    TO DC-ELAPSED-DAYS.
 10704     MOVE '6'                   TO DC-OPTION-CODE.
 10705     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10706
 10707     IF (NO-CONVERSION-ERROR AND
 10708         WS-SPECIAL-CALC-CD = 'C')
 10709        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10710            MOVE ER-0657 TO EMI-ERROR
 10711            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10712
 10713     IF PI-COMPANY-ID = 'NCL'
 10714         IF WS-SPECIAL-CALC-CD = 'C' AND
 10715            cl-critical-period = zeros
 10716*           CM-LF-CRITICAL-PERIOD = +0
 10717             MOVE ER-0844       TO EMI-ERROR
 10718             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10719
 10720     GO TO 1200-EDIT-FIND-TOLERANCES.
 10721
 10722 1160-EDIT-PAID-THRU-AH.
 10723     IF PI-EPYTHRU = ZEROS
 10724        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10725                                    WS-SV-EPYTHRU
 10726     ELSE
 10727        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10728
 10729     IF WS-SV-EPYTHRU < PI-CPYFROM
 10730         MOVE ER-0508            TO EMI-ERROR
 10731         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10732
 10733     IF PI-PMTTYPE = '3'
 10734        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10735         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10736             MOVE ER-0477        TO EMI-ERROR
 10737             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10738         ELSE
 10739             NEXT SENTENCE
 10740     ELSE
 10741         IF WS-SV-EPYTHRU > WS-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 205
* EL156.cbl
 10742             MOVE ER-0557        TO EMI-ERROR
 10743             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10744
 10745     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10746         PI-PMTTYPE NOT = '3'
 10747         MOVE ER-0541        TO EMI-ERROR
 10748         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10749
 10750     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10751        (PI-PMTTYPE NOT = '3')
 10752         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10753             MOVE ER-0478        TO EMI-ERROR
 10754             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10755
 10756     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10757        (PI-PMTTYPE NOT = '4')
 10758         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10759             MOVE ER-0479        TO EMI-ERROR
 10760             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10761
 10762     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10763         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10764             MOVE ER-0545        TO EMI-ERROR
 10765             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10766
 10767     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10768         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10769             MOVE ER-0481        TO EMI-ERROR
 10770             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10771
 10772*    IF PI-COMPANY-ID = 'NCL'
 10773*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10774*           CM-AH-CRITICAL-PERIOD = +0
 10775*            MOVE ER-0844        TO  EMI-ERROR
 10776*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10777
 10778*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10779     if (cl-critical-period = zeros)
 10780        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10781          GO TO 1200-EDIT-FIND-TOLERANCES.
 10782
 10783     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10784     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10785     MOVE '1'        TO DC-OPTION-CODE.
 10786     MOVE +0         TO DC-ELAPSED-DAYS
 10787                        DC-ELAPSED-MONTHS.
 10788     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10789
 10790*    IF NO-CONVERSION-ERROR
 10791*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10792*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10793*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10794*           MOVE ER-0657 TO EMI-ERROR
 10795*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10796
 10797     GO TO 1200-EDIT-FIND-TOLERANCES.
 10798
 10799 1165-PAID-THRU-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 206
* EL156.cbl
 10800     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10801
 10802     IF EMI-MESSAGE-FORMATTED
 10803         MOVE -1                 TO EPYTHRUL
 10804         MOVE AL-UNBON           TO EPYTHRUA.
 10805
 10806 1165-EXIT.
 10807     EXIT.
 10808
 10809 1166-CHECK-ALL-TRLRS.
 10810
 10811     IF PI-PMTTYPE = '4'
 10812        GO TO 1166-TRLR-EXIT.
 10813
 10814     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10815
 10816     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10817        WS-SV-EPYFROM = LOW-VALUES
 10818          GO TO 1166-END-CHECK.
 10819
 10820
 10821* EXEC CICS HANDLE CONDITION
 10822*        ENDFILE   (1166-END-CHECK)
 10823*        NOTFND    (1166-END-CHECK)
 10824*    END-EXEC.
 10825*    MOVE '"$''I                  ! ) #00010404' TO DFHEIV0
 10826     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10828     MOVE X'2920233030303130343034' TO DFHEIV0(25:11)
 10829     CALL 'kxdfhei1' USING DFHEIV0
 10830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10831
 10832
 10833     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10834     MOVE +100                   TO TRLR-SEQ-NO.
 10835
 10836
 10837* EXEC CICS STARTBR
 10838*         DATASET    ('ELTRLR')
 10839*         RIDFLD     (ELTRLR-KEY)
 10840*         GTEQ
 10841*    END-EXEC.
 10842     MOVE 'ELTRLR' TO DFHEIV1
 10843     MOVE 0
 10844       TO DFHEIV11
 10845*    MOVE '&,         G          &   #00010412' TO DFHEIV0
 10846     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10847     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10848     MOVE X'2020233030303130343132' TO DFHEIV0(25:11)
 10849     CALL 'kxdfhei1' USING DFHEIV0,
 10850           DFHEIV1,
 10851           ELTRLR-KEY,
 10852           DFHEIV99,
 10853           DFHEIV11,
 10854           DFHEIV99
 10855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10856
 10857
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 207
* EL156.cbl
 10858     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10859
 10860 1166-READ-TRLR-NEXT.
 10861
 10862
 10863* EXEC CICS READNEXT
 10864*         DATASET    ('ELTRLR')
 10865*         RIDFLD     (ELTRLR-KEY)
 10866*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10867*    END-EXEC.
 10868     MOVE 'ELTRLR' TO DFHEIV1
 10869     MOVE 0
 10870       TO DFHEIV11
 10871*    MOVE '&.S                   )   #00010422' TO DFHEIV0
 10872     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10873     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10874     MOVE X'2020233030303130343232' TO DFHEIV0(25:11)
 10875     CALL 'kxdfhei1' USING DFHEIV0,
 10876           DFHEIV1,
 10877           DFHEIV20,
 10878           DFHEIV99,
 10879           ELTRLR-KEY,
 10880           DFHEIV99,
 10881           DFHEIV11,
 10882           DFHEIV99,
 10883           DFHEIV99
 10884     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10885         DFHEIV20
 10886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10887
 10888
 10889     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10890        TRLR-CARRIER  = MSTR-CARRIER  AND
 10891        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10892        TRLR-CERT-NO  = MSTR-CERT-NO
 10893          NEXT SENTENCE
 10894      ELSE
 10895          GO TO 1166-END-CHECK.
 10896
 10897* **  BYPASS ALL NON-PAYMENT TRAILERS
 10898
 10899     IF AT-TRAILER-TYPE = '2'
 10900        NEXT SENTENCE
 10901     ELSE
 10902        GO TO 1166-READ-TRLR-NEXT.
 10903
 10904* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10905
 10906     IF AT-PAYMENT-TYPE = '1' OR '2'
 10907        NEXT SENTENCE
 10908     ELSE
 10909        GO TO 1166-READ-TRLR-NEXT.
 10910
 10911* **  BYPASS ALL VOID PAYMENTS
 10912
 10913     IF AT-VOID-DT NOT = LOW-VALUES
 10914        GO TO 1166-READ-TRLR-NEXT.
 10915
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 208
* EL156.cbl
 10916     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10917        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10918          GO TO 1166-READ-TRLR-NEXT.
 10919
 10920     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10921         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10922            OR
 10923        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10924         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10925        NEXT SENTENCE
 10926     ELSE
 10927         IF CL-TOTAL-PAID-AMT > ZEROS
 10928             MOVE ER-0502            TO EMI-ERROR
 10929             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10930             MOVE -1                 TO EPYTHRUL
 10931             MOVE AL-UNBON           TO EPYTHRUA.
 10932
 10933     GO TO 1166-READ-TRLR-NEXT.
 10934
 10935 1166-END-CHECK.
 10936
 10937     IF WS-BROWSE-TRLR-SW = 'Y'
 10938
 10939* EXEC CICS ENDBR
 10940*            DATASET   ('ELTRLR')
 10941*       END-EXEC.
 10942     MOVE 'ELTRLR' TO DFHEIV1
 10943     MOVE 0
 10944       TO DFHEIV11
 10945*    MOVE '&2                    $   #00010477' TO DFHEIV0
 10946     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10947     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10948     MOVE X'2020233030303130343737' TO DFHEIV0(25:11)
 10949     CALL 'kxdfhei1' USING DFHEIV0,
 10950           DFHEIV1,
 10951           DFHEIV11,
 10952           DFHEIV99
 10953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10954
 10955
 10956     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10957
 10958 1166-TRLR-EXIT.
 10959     EXIT.
 10960
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 209
* EL156.cbl
 10962 1170-PAID-THRU-FATAL-ERROR.
 10963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10964
 10965     MOVE -1                     TO EPYTHRUL.
 10966     MOVE AL-UNBON               TO EPYTHRUA.
 10967
 10968 1200-EDIT-FIND-TOLERANCES.
 10969
 10970* EXEC CICS HANDLE CONDITION
 10971*        ENDFILE(1950-NOT-FOUND)
 10972*        NOTFND (1950-NOT-FOUND)
 10973*    END-EXEC.
 10974*    MOVE '"$''I                  ! * #00010494' TO DFHEIV0
 10975     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10977     MOVE X'2A20233030303130343934' TO DFHEIV0(25:11)
 10978     CALL 'kxdfhei1' USING DFHEIV0
 10979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10980
 10981
 10982     IF PI-PROCESSOR-ID = 'LGXX'
 10983        GO TO 1240-FIND-ACCT-TOLERANCES.
 10984
 10985     MOVE 'N'                    TO FOUND-TOL-SW.
 10986     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10987     MOVE '2'                    TO CNTL-REC-TYPE.
 10988     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10989     MOVE +0                     TO CNTL-SEQ-NO.
 10990     MOVE 'PROC'                 TO FILE-SWITCH.
 10991
 10992     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10993
 10994     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10995     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10996                                    PI-MAX-PMT-TOL.
 10997     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10998
 10999     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11000         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11001
 11002     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11003     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11004                                    PI-MAX-LF-PMT-TOL.
 11005
 11006     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11007         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11008
 11009     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11010                                    PI-MAX-EXP-PMT.
 11011
 11012 1240-FIND-ACCT-TOLERANCES.
 11013
 11014     IF WS-PMT-TOL NOT = +0
 11015         MOVE 'Y'                TO FOUND-TOL-SW.
 11016
 11017     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11018         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11019         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 210
* EL156.cbl
 11020         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11021         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11022         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11023         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11024     ELSE
 11025         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11026         MOVE PI-CARRIER             TO ACCT-CARRIER
 11027         MOVE PI-GROUPING            TO ACCT-GROUPING
 11028         MOVE PI-STATE               TO ACCT-STATE
 11029         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11030         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11031
 11032     MOVE 'ACCT'                 TO FILE-SWITCH.
 11033
 11034     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11035     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11036
 11037
 11038* EXEC CICS HANDLE CONDITION
 11039*         NOTFND   (1950-NOT-FOUND)
 11040*         ENDFILE  (1950-NOT-FOUND)
 11041*    END-EXEC.
 11042*    MOVE '"$I''                  ! + #00010554' TO DFHEIV0
 11043     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11044     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11045     MOVE X'2B20233030303130353534' TO DFHEIV0(25:11)
 11046     CALL 'kxdfhei1' USING DFHEIV0
 11047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11048
 11049
 11050
 11051* EXEC CICS STARTBR
 11052*        DATASET('ERACCT')
 11053*        RIDFLD (ERACCT-KEY)
 11054*        GTEQ
 11055*    END-EXEC.
 11056     MOVE 'ERACCT' TO DFHEIV1
 11057     MOVE 0
 11058       TO DFHEIV11
 11059*    MOVE '&,         G          &   #00010559' TO DFHEIV0
 11060     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11061     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11062     MOVE X'2020233030303130353539' TO DFHEIV0(25:11)
 11063     CALL 'kxdfhei1' USING DFHEIV0,
 11064           DFHEIV1,
 11065           ERACCT-KEY,
 11066           DFHEIV99,
 11067           DFHEIV11,
 11068           DFHEIV99
 11069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11070
 11071
 11072 1245-FIND-ACCT-TOLERANCES-LOOP.
 11073
 11074
 11075* EXEC CICS READNEXT
 11076*        DATASET('ERACCT')
 11077*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 211
* EL156.cbl
 11078*        RIDFLD (ERACCT-KEY)
 11079*    END-EXEC.
 11080     MOVE 'ERACCT' TO DFHEIV1
 11081     MOVE 0
 11082       TO DFHEIV11
 11083*    MOVE '&.S                   )   #00010567' TO DFHEIV0
 11084     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11085     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11086     MOVE X'2020233030303130353637' TO DFHEIV0(25:11)
 11087     CALL 'kxdfhei1' USING DFHEIV0,
 11088           DFHEIV1,
 11089           DFHEIV20,
 11090           DFHEIV99,
 11091           ERACCT-KEY,
 11092           DFHEIV99,
 11093           DFHEIV11,
 11094           DFHEIV99,
 11095           DFHEIV99
 11096     SET ADDRESS OF ACCOUNT-MASTER TO
 11097         DFHEIV20
 11098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11099
 11100
 11101     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11102        IF WS-ERACCT-HOLD-RECORD = SPACES
 11103           GO TO 1950-NOT-FOUND
 11104        ELSE
 11105           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11106           GO TO 1250-CONTINUE.
 11107
 11108     IF ACCT-EXP-DT = HIGH-VALUES
 11109        NEXT SENTENCE
 11110     ELSE
 11111        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11112        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11113
 11114 1250-CONTINUE.
 11115
 11116     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11117
 11118     IF FOUND-TOL-SW = 'N'
 11119         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11120
 11121********* 1260-FIND-STATE-TOLERANCES.
 11122
 11123     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11124     MOVE PI-STATE               TO WS-ST-ACCESS.
 11125     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11126     MOVE '3'                    TO CNTL-REC-TYPE.
 11127     MOVE +0                     TO CNTL-SEQ-NO.
 11128     MOVE 'STAT'                 TO FILE-SWITCH.
 11129
 11130     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11131
 11132     IF WS-PMT-TOL = +0
 11133         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11134
 11135     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 212
* EL156.cbl
 11136     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11137     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11138     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11139     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11140
 11141****USE THIS ROUTINE TO CHECK PAYEE NAME EQUAL TO DECEASED
 11142     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 11143*        PI-VFY-2ND-BENE = 'Y' AND
 11144        PI-PAYEE-TYPE <> 'B'
 11145           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11146     END-IF.
 11147
 11148     IF PI-PMTTYPE      = '2'  AND
 11149        PI-SPLIT-PMT-SW = 'Y'  AND
 11150        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11151          MOVE ER-3530                TO EMI-ERROR
 11152          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11153
 11154********* 1280-FIND-BENEFIT-TOLERANCES.
 11155
 11156     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11157        OR (PI-PMTTYPE = '5' OR '6')
 11158         GO TO 1300-FIND-CARR-TOLERANCES.
 11159
 11160     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11161     MOVE '4'                    TO CNTL-REC-TYPE.
 11162     MOVE +0                     TO CNTL-SEQ-NO.
 11163     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11164     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11165     MOVE 'BENE'                 TO FILE-SWITCH.
 11166
 11167     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11168
 11169     IF NO-BENEFIT-FOUND
 11170         GO TO 1950-NOT-FOUND.
 11171
 11172     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11173     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11174     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11175
 11176
 11177* EXEC CICS HANDLE CONDITION
 11178*        NOTFND(1950-NOT-FOUND)
 11179*    END-EXEC.
 11180*    MOVE '"$I                   ! , #00010648' TO DFHEIV0
 11181     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11183     MOVE X'2C20233030303130363438' TO DFHEIV0(25:11)
 11184     CALL 'kxdfhei1' USING DFHEIV0
 11185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11186
 11187
 11188 1300-FIND-CARR-TOLERANCES.
 11189     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11190     MOVE '6'                    TO CNTL-REC-TYPE.
 11191
 11192     IF CONTROL-IS-ACTUAL-CARRIER
 11193         MOVE PI-CARRIER               TO WS-CARR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 213
* EL156.cbl
 11194     ELSE
 11195         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11196
 11197     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11198     MOVE +0                     TO CNTL-SEQ-NO.
 11199     MOVE 'CARR'                 TO FILE-SWITCH.
 11200
 11201     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11202
 11203     IF WS-DAYS-TOL = +0
 11204         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11205
 11206     IF WS-PMT-TOL = +0
 11207         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11208
 11209     IF WS-MAX-DAYS-TOL = +0
 11210         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11211
 11212     IF WS-MAX-PMT-TOL = +0
 11213         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11214                                    PI-MAX-PMT-TOL.
 11215
 11216     IF WS-MAX-LF-PMT-TOL = +0
 11217        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11218                                    PI-MAX-LF-PMT-TOL.
 11219
 11220     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11221
 11222********* 1320-FIND-COMP-TOLERANCES.
 11223
 11224     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11225     MOVE '1'                    TO CNTL-REC-TYPE.
 11226     MOVE SPACES                 TO CNTL-ACCESS.
 11227     MOVE +0                     TO CNTL-SEQ-NO.
 11228     MOVE 'COMP'                 TO FILE-SWITCH.
 11229
 11230     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11231
 11232     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11233     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11234
 11235     IF WS-PMT-TOL NOT = +0
 11236        IF WS-TOL-SEVERITY NOT = ' '
 11237         GO TO 1360-EDIT-DAYS.
 11238
 11239     IF WS-PMT-TOL = +0
 11240         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11241
 11242     IF WS-TOL-SEVERITY = ' '
 11243         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11244
 11245 1360-EDIT-DAYS.
 11246     IF PI-PMTTYPE NOT = '4'
 11247        IF PI-EDAYS NEGATIVE OR
 11248           PI-EPYAMT NEGATIVE
 11249          MOVE ER-0513             TO EMI-ERROR
 11250          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11251          MOVE -1                  TO PMTTYPEL.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 214
* EL156.cbl
 11252
 11253     IF PI-PMTTYPE = '5' OR '6'
 11254        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11255
 11256     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11257        IF PI-PMTTYPE = '4'
 11258          MOVE PI-EDAYS          TO PI-CDAYS.
 11259
 11260     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11261         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11262
 11263     IF PI-PMTTYPE = '4'
 11264        MOVE PI-EDAYS            TO PI-CDAYS
 11265        GO TO 1400-EDIT-PAYMENT.
 11266
 11267     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11268        GO TO 1500-EDIT-EXPENSES.
 11269
 11270*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11271*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11272*          CM-AH-BENEFIT-CD = '23'              AND
 11273*          CL-CERT-STATE    = '04'              AND
 11274*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11275*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11276*            GO TO 1362-CHECK-MAX-DAYS.
 11277
 11278     IF PI-EDAYS = ZEROS
 11279*        IF PI-COMPANY-ID = 'DMD'
 11280*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11281*            MOVE -1             TO DC-ELAPSED-DAYS
 11282*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11283*            MOVE '6'            TO DC-OPTION-CODE
 11284*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11285*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11286*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11287*            MOVE '1'            TO DC-OPTION-CODE
 11288*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11289*            IF NO-CONVERSION-ERROR
 11290*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11291*                                 + DC-ODD-DAYS-OVER
 11292*               MOVE 6           TO EDAYSL
 11293*               MOVE AL-UNNON    TO EDAYSA
 11294*            ELSE
 11295*                NEXT SENTENCE
 11296*       ELSE
 11297            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11298            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11299            MOVE '1'             TO DC-OPTION-CODE
 11300            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11301            IF NO-CONVERSION-ERROR
 11302                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11303                ADD 1                 TO PI-EDAYS
 11304                MOVE AL-UNNON         TO EDAYSA.
 11305
 11306*    IF PI-COMPANY-ID = 'DMD'
 11307*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11308*        MOVE -1                 TO DC-ELAPSED-DAYS
 11309*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 215
* EL156.cbl
 11310*        MOVE '6'                TO DC-OPTION-CODE
 11311*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11312*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11313*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11314*        MOVE '1'                TO DC-OPTION-CODE
 11315*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11316*    ELSE
 11317         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11318         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11319         MOVE '1'                TO DC-OPTION-CODE.
 11320         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11321
 11322     IF NO-CONVERSION-ERROR
 11323        IF PI-COMPANY-ID = 'DMD'
 11324            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11325                             + DC-ODD-DAYS-OVER
 11326        ELSE
 11327            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11328            ADD 1                TO PI-CDAYS.
 11329
 11330     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11331        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11332        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11333
 11334     IF PI-EDAYS NOT NUMERIC
 11335         MOVE ER-0491            TO EMI-ERROR
 11336         GO TO 1370-DAYS-ERROR.
 11337
 11338     IF CL-NO-OF-PMTS-MADE = 0
 11339        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11340        AND CL-CERT-STATE = 'MI'
 11341        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11342            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11343     END-IF.
 11344
 11345 1362-CHECK-MAX-DAYS.
 11346
 11347     IF WS-MAX-DAYS-TOL = +999
 11348         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11349
 11350     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11351         IF PI-EDAYS = ZEROS
 11352             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11353         ELSE
 11354             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11355
 11356     IF WS-MAX-DAYS-TOL NOT = ZERO
 11357        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11358           PI-CDAYS > WS-MAX-DAYS-TOL
 11359             MOVE ER-0492          TO EMI-ERROR
 11360             GO TO 1370-DAYS-ERROR.
 11361
 11362 1365-SKIP-MAX-DAYS-EDIT.
 11363     IF PI-EDAYS = ZEROS
 11364        GO TO 1400-EDIT-PAYMENT.
 11365
 11366     IF WS-DAYS-TOL NOT = ZERO
 11367        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 216
* EL156.cbl
 11368           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
 11369                MOVE ER-0493     TO EMI-ERROR
 11370                GO TO 1370-DAYS-ERROR.
 11371
 11372     GO TO 1400-EDIT-PAYMENT.
 11373
 11374 1370-DAYS-ERROR.
 11375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11376
 11377     IF EMI-MESSAGE-FORMATTED
 11378         MOVE -1                 TO EDAYSL
 11379         MOVE AL-UABON           TO EDAYSA.
 11380
 11381     GO TO 1400-EDIT-PAYMENT.
 11382
 11383 1380-EDIT-EXPENSE-PMT-AMT.
 11384     IF PI-PMTTYPE = '5' OR '6'
 11385         NEXT SENTENCE
 11386     ELSE
 11387         GO TO 1400-EDIT-PAYMENT.
 11388
 11389     IF WS-MAX-EXP-PMT NOT = ZEROS
 11390        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11391            MOVE ER-3529            TO EMI-ERROR
 11392            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11393
 11394     GO TO 1500-EDIT-EXPENSES.
 11395
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 217
* EL156.cbl
 11397
 11398 1390-CHECK-PAYMENT-DAYS.
 11399
 11400     IF PI-EDAYS = 0
 11401         MOVE PI-CDAYS TO WS-PD-DAYS
 11402     ELSE
 11403         MOVE PI-EDAYS TO WS-PD-DAYS
 11404     END-IF.
 11405
 11406     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11407         IF WS-PD-DAYS = 14
 11408            GO TO 1390-EXIT
 11409         END-IF
 11410     END-IF.
 11411
 11412     IF PI-COMPANY-ID = 'AHL'  AND
 11413        CM-AH-BENEFIT-CD = '1K'
 11414         IF WS-PD-DAYS = 14
 11415            GO TO 1390-EXIT
 11416         END-IF
 11417     END-IF.
 11418
 11419     IF WS-PD-DAYS < 30
 11420         MOVE ER-3549              TO EMI-ERROR
 11421         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11422     END-IF.
 11423
 11424 1390-EXIT.
 11425      EXIT.
 11426
 11427 1400-EDIT-PAYMENT.
 11428*    IF PI-COMPANY-ID = 'DMD'
 11429*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11430*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11431
 11432     IF PI-COMPANY-ID = 'DCC'
 11433        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11434        MOVE PI-CARRIER          TO ACCT-CARRIER
 11435        MOVE PI-GROUPING         TO ACCT-GROUPING
 11436        MOVE PI-STATE            TO ACCT-STATE
 11437        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11438        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11439        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11440        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11441
 11442
 11443* EXEC CICS READ
 11444*          DATASET ('ERACCT')
 11445*          RIDFLD  (ERACCT-KEY)
 11446*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11447*          GTEQ
 11448*          resp    (WS-RESPONSE)
 11449*       END-EXEC
 11450     MOVE 'ERACCT' TO DFHEIV1
 11451*    MOVE '&"S        G          (  N#00010906' TO DFHEIV0
 11452     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11454     MOVE X'204E233030303130393036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 218
* EL156.cbl
 11455     CALL 'kxdfhei1' USING DFHEIV0,
 11456           DFHEIV1,
 11457           DFHEIV20,
 11458           DFHEIV99,
 11459           ERACCT-KEY,
 11460           DFHEIV99,
 11461           DFHEIV99,
 11462           DFHEIV99
 11463     SET ADDRESS OF ACCOUNT-MASTER TO
 11464         DFHEIV20
 11465     MOVE EIBRESP  TO WS-RESPONSE
 11466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11467        IF WS-RESP-NORMAL
 11468           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11469           and pi-cert-eff-dt < am-expiration-dt
 11470           and pi-cert-eff-dt >= am-effective-dt
 11471           move am-dcc-product-code to pi-dcc-product-code
 11472        else
 11473           move spaces           to pi-dcc-product-code
 11474        end-if
 11475        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11476           MOVE ' '              TO WS-PDEF-RECORD-SW
 11477           PERFORM 0900-GET-DDF-FACTORS
 11478                                 THRU 0900-EXIT
 11479           IF PDEF-FOUND
 11480              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11481                 (P1 > +8)
 11482                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11483              END-PERFORM
 11484              IF P1 < +9
 11485                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11486                    MOVE PD-MAX-AMT (P1)
 11487                                 TO CM-AH-BENEFIT-AMT
 11488                 end-if
 11489              END-IF
 11490           END-IF
 11491        end-if
 11492     END-IF
 11493     IF PI-PMTTYPE NOT = '4'
 11494        GO TO 1405-CALC-PAYMENT.
 11495
 11496     IF PI-EDAYS NOT NUMERIC
 11497         MOVE PI-EPYAMT           TO PI-CPYAMT
 11498         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11499         GO TO 1430-CHECK-AH-TOLERANCE.
 11500
 11501*    IF PI-COMPANY-ID = 'FIA'
 11502*       IF CERT-ACCOUNT = '0000011043'
 11503*        COMPUTE PI-DAILY-RATE ROUNDED =
 11504*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11505*        COMPUTE PI-CPYAMT ROUNDED =
 11506*                          PI-DAILY-RATE * PI-EDAYS
 11507*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11508*        GO TO 1430-CHECK-AH-TOLERANCE.
 11509
 11510     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11511         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11512         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 219
* EL156.cbl
 11513         GO TO 1420-CHECK-AIG-BENEFIT.
 11514
 11515     IF WS-CALC-METHOD = '2' OR  '5'
 11516         COMPUTE PI-DAILY-RATE ROUNDED =
 11517                        (CM-AH-BENEFIT-AMT * 12) / 365
 11518         COMPUTE PI-CPYAMT ROUNDED =
 11519                           PI-DAILY-RATE * PI-EDAYS
 11520        GO TO 1420-CHECK-AIG-BENEFIT.
 11521
 11522     IF WS-CALC-METHOD = '3'
 11523         COMPUTE PI-DAILY-RATE =
 11524                         (CM-AH-BENEFIT-AMT * 12) / 365
 11525         COMPUTE PI-CPYAMT ROUNDED =
 11526                           PI-DAILY-RATE * PI-EDAYS
 11527        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 220
* EL156.cbl
 11529*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11530
 11531****************************************************************
 11532****************************************************************
 11533*                  CALCULATED FROM      PAYMENT      PAYMENT
 11534*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11535* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11536*1-01-83  1-15-83    0    15     15        15           15
 11537*1-01-83  1-30-83    0    30     30        30           30
 11538*1-01-83  1-31-83    1     0     31        30           30
 11539*1-01-83  2-01-83    1     1     32        31           31
 11540*1-01-83  2-15-83    1    15     46        45           45
 11541*1-01-83  2-28-83    2     0     59        60           60
 11542*1-01-83  3-01-83    2     1     60        61           61
 11543*1-01-83  3-31-83    3     0     90        90           90
 11544*1-15-83  1-31-83    0    17     17        17           16
 11545*1-15-83  2-01-83    0    18     18        18           17
 11546*1-15-83  2-28-83    1    14     45        44           46
 11547*1-21-83  3-09-83    1    20     48        50           49
 11548*2-05-83  3-06-83    1     2     30        32           32
 11549*2-05-83  3-23-83    1    19     47        49           49
 11550*2-15-83  2-28-83    0    14     14        14           16
 11551*2-15-83  3-01-83    0    15     15        15           17
 11552*2-21-83  3-19-83    0    27     27        27           29
 11553*2-21-83  3-20-83    1     0     28        30           30
 11554*2-21-83  4-10-83    1    18     49        30           50
 11555*2-21-83  5-19-83    2    27     88        87           89
 11556*2-21-83  5-22-83    3     2     91        92           92
 11557*3-21-83  5-19-83    1    30     60        60           59
 11558****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 221
* EL156.cbl
 11560 1405-CALC-PAYMENT.
 11561     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11562     MOVE ' '                    TO DC-OPTION-CODE.
 11563     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11564     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11565     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11566
 11567     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11568     MOVE ' '                    TO DC-OPTION-CODE.
 11569     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11570     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11571     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11572
 11573     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11574     MOVE -1                     TO DC-ELAPSED-DAYS.
 11575     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11576     MOVE '6'                    TO DC-OPTION-CODE.
 11577     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11578     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11579
 11580     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11581     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11582     MOVE '1'                    TO DC-OPTION-CODE.
 11583     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11584
 11585     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11586     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11587     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11588
 11589******************************************************************
 11590*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11591*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11592*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11593******************************************************************
 11594
 11595     IF WS-CALC-METHOD = '1'           AND
 11596        DC-ELAPSED-MONTHS > ZERO AND
 11597        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11598        WDF-DAY > WDT-DAY
 11599          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11600          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11601          MOVE -1                  TO DC-ELAPSED-MONTHS
 11602          MOVE '6'                 TO DC-OPTION-CODE
 11603          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11604          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11605          COMPUTE WS-SAVE-ODD-DAYS =
 11606          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11607          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11608
 11609     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11610     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11611     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11612
 11613     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11614     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11615
 11616*    IF PI-COMPANY-ID = 'FIA'
 11617*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 222
* EL156.cbl
 11618*        COMPUTE PI-DAILY-RATE ROUNDED =
 11619*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11620*        COMPUTE PI-CPYAMT ROUNDED =
 11621*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11622*        GO TO 1420-CHECK-AIG-BENEFIT.
 11623
 11624*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11625*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11626*          CM-AH-BENEFIT-CD = '23'               AND
 11627*          CL-CERT-STATE    = '04'               AND
 11628*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11629*            COMPUTE WS-DAILY-RATE ROUNDED =
 11630*                               CM-AH-BENEFIT-AMT / 30
 11631*            COMPUTE PI-CPYAMT ROUNDED =
 11632*                               (WS-DAILY-RATE * PI-CDAYS)
 11633*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11634*            GO TO 1420-CHECK-AIG-BENEFIT.
 11635
 11636     IF WS-CALC-METHOD = '1'
 11637         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11638         COMPUTE PI-CPYAMT ROUNDED =
 11639             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11640             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11641         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11642         GO TO 1420-CHECK-AIG-BENEFIT.
 11643
 11644     IF WS-CALC-METHOD = '2'
 11645         COMPUTE PI-DAILY-RATE ROUNDED =
 11646                          (CM-AH-BENEFIT-AMT * 12) / 365
 11647         COMPUTE PI-CPYAMT ROUNDED =
 11648             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11649             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11650         GO TO 1420-CHECK-AIG-BENEFIT.
 11651
 11652     IF WS-CALC-METHOD = '4'
 11653         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11654         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11655         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11656         COMPUTE PI-CPYAMT ROUNDED =
 11657                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11658         GO TO 1420-CHECK-AIG-BENEFIT.
 11659
 11660     IF WS-CALC-METHOD = '5'
 11661         COMPUTE PI-DAILY-RATE ROUNDED =
 11662                            (CM-AH-BENEFIT-AMT * 12) / 365
 11663         COMPUTE PI-CPYAMT ROUNDED =
 11664                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11665         GO TO 1420-CHECK-AIG-BENEFIT.
 11666
 11667     IF WS-CALC-METHOD NOT = '3'
 11668        GO TO 1410-CHECK-PAYMENT.
 11669
 11670******   CALCULATION METHOD  3  ROUTINE
 11671     COMPUTE PI-DAILY-RATE =
 11672                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11673
 11674******CHECK TO SEE IF WITHIN SAME MONTH
 11675     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 223
* EL156.cbl
 11676        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11677                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11678         GO TO 1420-CHECK-AIG-BENEFIT.
 11679
 11680******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11681     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11682             SAVE-ODD-DAYS-OVER = ZEROS
 11683      COMPUTE PI-CPYAMT  ROUNDED =
 11684                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11685      GO TO 1420-CHECK-AIG-BENEFIT.
 11686
 11687******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11688******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11689     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11690        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11691        IF WDF-MONTH > 12
 11692           ADD 1                 TO WDF-YEAR
 11693           SUBTRACT 12         FROM WDF-MONTH.
 11694
 11695******CONVERT THE NEW FROM MONTH TO BINARY
 11696     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11697        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11698        MOVE '4'              TO DC-OPTION-CODE
 11699        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11700        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11701
 11702     IF WDF-MONTH = WDT-MONTH AND
 11703        WDF-YEAR  = WDT-YEAR
 11704          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11705                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11706                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11707        ELSE
 11708          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11709          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11710          COMPUTE PI-CPYAMT ROUNDED =
 11711       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11712       +
 11713       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11714       +
 11715       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11716
 11717     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 224
* EL156.cbl
 11719 1410-CHECK-PAYMENT.
 11720******PAYMENT OPTION 6
 11721******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11722     IF SAVE-ELAPSED-MONTHS > ZERO
 11723        IF SAVE-ODD-DAYS-OVER = ZEROS
 11724           GO TO 1412-CHECK-TO-DAY
 11725        ELSE
 11726           IF WDF-DAY > WDT-DAY
 11727              IF WDF-MONTH = 02
 11728                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11729                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11730                  GO TO 1412-CHECK-TO-DAY
 11731              ELSE
 11732                  IF FROM-DAYS-IN-MONTH = 31
 11733                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11734                     GO TO 1412-CHECK-TO-DAY
 11735                  ELSE
 11736                     GO TO 1412-CHECK-TO-DAY
 11737           ELSE
 11738               GO TO 1412-CHECK-TO-DAY.
 11739
 11740     IF WDF-MONTH NOT = WDT-MONTH
 11741        IF WDF-MONTH = 02
 11742           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11743           IF WDF-DAY = 29
 11744              ADD 1              TO SAVE-ODD-DAYS-OVER
 11745           ELSE
 11746              ADD 2              TO SAVE-ODD-DAYS-OVER
 11747        ELSE
 11748           IF FROM-DAYS-IN-MONTH = 31
 11749              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11750
 11751 1412-CHECK-TO-DAY.
 11752        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11753           IF WDT-DAY = 28
 11754              ADD 2              TO SAVE-ODD-DAYS-OVER
 11755           ELSE
 11756              IF WDT-DAY = 29
 11757                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11758              ELSE
 11759                 NEXT SENTENCE
 11760        ELSE
 11761           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11762              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11763
 11764     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11765     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11766     COMPUTE PI-CPYAMT ROUNDED =
 11767         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11768         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11769
 11770     GO TO 1420-CHECK-AIG-BENEFIT.
 11771
 11772 1415-CHECK-LEAP-YEAR.
 11773     IF FROM-DAYS-IN-MONTH = 29
 11774        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11775
 11776 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 225
* EL156.cbl
 11777     EXIT.
 11778
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 226
* EL156.cbl
 11780 1420-CHECK-AIG-BENEFIT.
 11781
 11782     IF WS-SPECIAL-CALC-CD = 'Q'
 11783         GO TO 1425-CHECK-WHOLE-MONTH.
 11784
 11785*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11786*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11787*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11788*       (PI-PMTTYPE = '1' OR '2')
 11789*        NEXT SENTENCE
 11790*    ELSE
 11791         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11792         GO TO 1430-CHECK-AH-TOLERANCE.
 11793
 11794******************AIG LOGIC STARTS**********************
 11795*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11796*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11797*    MOVE ER-3533      TO EMI-ERROR.
 11798*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11799*    GO TO 1430-CHECK-AH-TOLERANCE.
 11800******************AIG LOGIC ENDS************************
 11801
 11802 1425-CHECK-WHOLE-MONTH.
 11803******************************************************************
 11804****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11805****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11806****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11807****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11808****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11809****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11810****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11811****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11812****          PAID * MONTHLY BENEFIT.                         ****
 11813******************************************************************
 11814
 11815     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11816
 11817     IF CL-NO-OF-PMTS-MADE > +0
 11818         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11819
 11820     IF PI-CDAYS < WS-BEN-DAYS
 11821         GO TO 1430-CHECK-AH-TOLERANCE.
 11822
 11823     IF PI-CDAYS = WS-BEN-DAYS
 11824         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11825         GO TO 1430-CHECK-AH-TOLERANCE.
 11826
 11827*    IF PI-COMPANY-ID = 'ACM'
 11828*       NEXT SENTENCE
 11829*    ELSE
 11830        GO TO 1425-NOT-ACM-W15C.
 11831
 11832*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11833*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11834*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11835*    MOVE '6'                    TO  DC-OPTION-CODE.
 11836*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11837*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 227
* EL156.cbl
 11838*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11839*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11840*       MOVE '1'                 TO  DC-OPTION-CODE
 11841*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11842*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11843*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11844*       IF NO-CONVERSION-ERROR
 11845*          IF (DC-ELAPSED-MONTHS > +0) OR
 11846*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11847*             NEXT SENTENCE
 11848*          ELSE
 11849*             MOVE +0            TO  PI-CPYAMT
 11850*             MOVE ER-0846       TO  EMI-ERROR
 11851*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11852*             GO TO 1430-CHECK-AH-TOLERANCE
 11853*       ELSE
 11854*           MOVE ER-0846         TO  EMI-ERROR
 11855*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11856*           GO TO 1430-CHECK-AH-TOLERANCE.
 11857*
 11858*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11859*       ADD +1 TO DC-ELAPSED-MONTHS.
 11860*
 11861*    COMPUTE PI-CPYAMT ROUNDED =
 11862*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11863*
 11864*    GO TO 1430-CHECK-AH-TOLERANCE.
 11865
 11866 1425-NOT-ACM-W15C.
 11867
 11868     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11869     MOVE '6'                        TO  DC-OPTION-CODE.
 11870     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11871     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11872
 11873     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11874     IF NO-CONVERSION-ERROR
 11875         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11876     ELSE
 11877         MOVE ER-0846                TO  EMI-ERROR
 11878         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11879         GO TO 1430-CHECK-AH-TOLERANCE.
 11880
 11881     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11882     MOVE '1'                        TO  DC-OPTION-CODE.
 11883     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11884     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11885     IF NO-CONVERSION-ERROR
 11886         IF DC-ODD-DAYS-OVER = +0
 11887             NEXT SENTENCE
 11888         ELSE
 11889             MOVE ER-0846            TO  EMI-ERROR
 11890             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11891             GO TO 1430-CHECK-AH-TOLERANCE
 11892     ELSE
 11893         MOVE ER-0846                TO  EMI-ERROR
 11894         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11895         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 228
* EL156.cbl
 11896
 11897     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11898         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11899
 11900     GO TO 1430-CHECK-AH-TOLERANCE.
 11901
 11902 1425-CONT-WHOLE-MONTH-PMTS.
 11903******************************************************************
 11904****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11905****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11906****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11907******************************************************************
 11908
 11909     IF PI-COMPANY-ID = 'ACM'
 11910        NEXT SENTENCE
 11911     ELSE
 11912        IF DC-ODD-DAYS-OVER = +0
 11913            NEXT SENTENCE
 11914        ELSE
 11915            MOVE ER-0845            TO  EMI-ERROR
 11916            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11917            GO TO 1430-CHECK-AH-TOLERANCE.
 11918
 11919     COMPUTE PI-CPYAMT ROUNDED =
 11920                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11921
 11922 1430-CHECK-AH-TOLERANCE.
 11923     IF PI-PMT-APPR-SW = 'G'
 11924         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11925
 11926*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11927*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11928*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11929*
 11930*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11931*      IF WDF-MONTH = 02
 11932*        IF SAVE-ELAPSED-MONTHS = 0
 11933*          NEXT SENTENCE
 11934*        ELSE
 11935*          IF SAVE-ODD-DAYS-OVER > 0
 11936*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11937*            COMPUTE WS-PMT-MOS ROUNDED =
 11938*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11939*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11940*                                     WS-PMT-MOS
 11941*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11942*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11943*          ELSE
 11944*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11945*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11946*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11947*                                     WS-PMT-MOS.
 11948
 11949     IF WS-MAX-PMT-TOL NOT = ZERO
 11950        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11951           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11952            MOVE ER-0494         TO  EMI-ERROR
 11953            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 229
* EL156.cbl
 11954            GO TO 1500-EDIT-EXPENSES.
 11955
 11956 1430-CONT-CHECK-AH-TOLERANCE.
 11957
 11958     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11959        GO TO 1500-EDIT-EXPENSES.
 11960
 11961     IF CM-O-B-COVERAGE
 11962        GO TO 1500-EDIT-EXPENSES.
 11963
 11964     IF PI-COMPANY-ID = 'NCL'
 11965       IF FOUND-TOL-SW = 'Y'
 11966         IF WS-PMT-TOL NOT = ZERO
 11967           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11968              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11969                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11970                  IF WS-NCL-PMT-OPTION = SPACES
 11971                      MOVE ER-0699 TO EMI-ERROR
 11972                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11973                  ELSE
 11974                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11975                      NEXT SENTENCE
 11976                  ELSE
 11977                  IF NOT WS-VALID-NCL-OPTION
 11978                      MOVE ER-0699 TO EMI-ERROR
 11979                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11980
 11981     if pi-company-id = 'DCC'
 11982        and pdef-found
 11983        and pi-cpyamt < pi-epyamt
 11984           move er-1657          to emi-error
 11985           perform 1490-payment-error
 11986                                 thru 1490-exit
 11987     else
 11988        IF WS-PMT-TOL NOT = ZERO
 11989           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 11990              or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11991              MOVE ER-0495       TO EMI-ERROR
 11992              PERFORM 1490-PAYMENT-ERROR
 11993                                 THRU 1490-EXIT
 11994           end-if
 11995        end-if
 11996     end-if
 11997
 11998     GO TO 1500-EDIT-EXPENSES.
 11999
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 230
* EL156.cbl
 12001 1440-COMPUTE-LIFE-REMAINING.
 12002
 12003     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12004        IF PI-PMTTYPE = '4'
 12005          MOVE PI-EPYAMT TO PI-CPYAMT
 12006          GO TO 1460-TEST-TYPE.
 12007
 12008     IF WS-LF-COVERAGE-TYPE = 'L'
 12009        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12010                          - CL-TOTAL-PAID-AMT
 12011        GO TO 1450-CHECK-MAX.
 12012
 12013     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12014        PI-LF-COVERAGE-TYPE = 'P'
 12015          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12016                              CM-LF-ITD-DEATH-AMT
 12017          GO TO 1450-CHECK-MAX.
 12018
 12019     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12020     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12021     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12022     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12023     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12024     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12025     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12026     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12027     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12028
 12029     PERFORM 9800-LINK-REM-TERM.
 12030
 12031     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12032     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12033     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12034     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12035     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12036     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12037     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12038     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12039     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12040     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12041     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12042     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12043     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12044     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12045     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12046     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12047     IF PI-COMPANY-ID = 'DCC'
 12048        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12049        MOVE PI-CARRIER          TO ACCT-CARRIER
 12050        MOVE PI-GROUPING         TO ACCT-GROUPING
 12051        MOVE PI-STATE            TO ACCT-STATE
 12052        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12053        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12054        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12055        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12056
 12057
 12058* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 231
* EL156.cbl
 12059*          DATASET ('ERACCT')
 12060*          RIDFLD  (ERACCT-KEY)
 12061*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12062*          GTEQ
 12063*          resp    (WS-RESPONSE)
 12064*       END-EXEC
 12065     MOVE 'ERACCT' TO DFHEIV1
 12066*    MOVE '&"S        G          (  N#00011503' TO DFHEIV0
 12067     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12069     MOVE X'204E233030303131353033' TO DFHEIV0(25:11)
 12070     CALL 'kxdfhei1' USING DFHEIV0,
 12071           DFHEIV1,
 12072           DFHEIV20,
 12073           DFHEIV99,
 12074           ERACCT-KEY,
 12075           DFHEIV99,
 12076           DFHEIV99,
 12077           DFHEIV99
 12078     SET ADDRESS OF ACCOUNT-MASTER TO
 12079         DFHEIV20
 12080     MOVE EIBRESP  TO WS-RESPONSE
 12081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12082        IF WS-RESP-NORMAL
 12083           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12084           and (pi-cert-eff-dt < am-expiration-dt)
 12085           and (pi-cert-eff-dt >= am-effective-dt)
 12086           move am-dcc-product-code to pi-dcc-product-code
 12087        else
 12088           move spaces           to pi-dcc-product-code
 12089        end-if
 12090        if pi-dcc-product-code not = spaces
 12091           MOVE ' '              TO WS-PDEF-RECORD-SW
 12092           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12093           PERFORM 0900-GET-DDF-FACTORS
 12094                                 THRU 0900-EXIT
 12095           IF PDEF-FOUND
 12096              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12097                 (P1 > +8)
 12098                 OR (PD-PROD-CODE (P1) = 'L')
 12099              END-PERFORM
 12100              IF P1 < +9
 12101                 MOVE PD-MAX-AMT (P1)
 12102                                 TO CP-R-MAX-TOT-BEN
 12103              END-IF
 12104           END-IF
 12105        end-if
 12106     END-IF
 12107
 12108* EXEC CICS LINK
 12109*       PROGRAM  (LINK-REMAMT)
 12110*       COMMAREA (CALCULATION-PASS-AREA)
 12111*       LENGTH   (CP-COMM-LENGTH)
 12112*    END-EXEC.
 12113*    MOVE '."C                   (   #00011535' TO DFHEIV0
 12114     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12115     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12116     MOVE X'2020233030303131353335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 232
* EL156.cbl
 12117     CALL 'kxdfhei1' USING DFHEIV0,
 12118           LINK-REMAMT,
 12119           CALCULATION-PASS-AREA,
 12120           CP-COMM-LENGTH,
 12121           DFHEIV99,
 12122           DFHEIV99,
 12123           DFHEIV99,
 12124           DFHEIV99
 12125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12126
 12127
 12128     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12129
 12130     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12131     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12132
 12133     IF PI-COMPANY-ID = 'BOA' AND
 12134        PI-PMTTYPE    = '2'   AND
 12135        PI-OFFLINE    = 'N'
 12136           GO TO 1441-COMPUTE-BOA-INTEREST.
 12137
 12138     IF PI-COMPANY-ID = 'NCL' AND
 12139        PI-PMTTYPE    = '2'   AND
 12140        PI-OFFLINE    = 'N'
 12141          GO TO 1442-COMPUTE-NCL-INTEREST
 12142       ELSE
 12143          GO TO 1445-CONTINUE.
 12144
 12145 1441-COMPUTE-BOA-INTEREST.
 12146     MOVE +0             TO WS-CALC-INT.
 12147
 12148     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12149     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12150     MOVE +0             TO DC-ELAPSED-MONTHS
 12151                            DC-ELAPSED-DAYS.
 12152     MOVE '1'            TO DC-OPTION-CODE.
 12153     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12154     IF NO-CONVERSION-ERROR
 12155         NEXT SENTENCE
 12156     ELSE
 12157         GO TO 1445-CONTINUE.
 12158
 12159     IF (PI-INT-RATE NOT > ZEROS)  AND
 12160        (DC-ELAPSED-DAYS > +30)
 12161         MOVE ER-3531            TO EMI-ERROR
 12162         MOVE -1                 TO PINTL
 12163         MOVE AL-UNBON           TO PINTA
 12164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12165
 12166     IF PI-EPYAMT NOT > ZEROS
 12167         GO TO 1445-CONTINUE.
 12168
 12169     IF (PI-INT-RATE NOT > ZEROS)  OR
 12170        (DC-ELAPSED-DAYS NOT > +30)
 12171         MOVE PI-EPYAMT TO PI-CPYAMT
 12172         GO TO 1441-FORMAT-NOTE.
 12173
 12174     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 233
* EL156.cbl
 12175                                 *  PI-INT-RATE
 12176                                 *  DC-ELAPSED-DAYS
 12177                                 /  365
 12178                                 /  100.
 12179
 12180     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12181
 12182 1441-FORMAT-NOTE.
 12183
 12184     MOVE SPACES        TO WS-BOANOTE1.
 12185     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12186     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12187     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12188     MOVE AL-UANON      TO NOTE1A.
 12189
 12190     IF WS-CALC-INT > ZEROS
 12191         MOVE SPACES        TO WS-BOANOTE2
 12192         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12193         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12194         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12195         MOVE AL-UANON      TO NOTE2A.
 12196
 12197     GO TO 1445-CONTINUE.
 12198
 12199 1442-COMPUTE-NCL-INTEREST.
 12200     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12201     MOVE PI-STATE               TO WS-ST-ACCESS.
 12202     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12203     MOVE '3'                    TO CNTL-REC-TYPE.
 12204     MOVE +0                     TO CNTL-SEQ-NO.
 12205     MOVE 'STAT'                 TO FILE-SWITCH.
 12206
 12207     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12208
 12209     MOVE +0                 TO WS-CALC-INT.
 12210
 12211     IF ST-STAT-FROM-INCURRED
 12212         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12213       ELSE
 12214     IF ST-STAT-FROM-REPORTED
 12215         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12216       ELSE
 12217         GO TO 1445-CONTINUE.
 12218
 12219     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12220     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12221     MOVE +0                 TO DC-ELAPSED-MONTHS
 12222                                DC-ELAPSED-DAYS.
 12223     MOVE '1'                TO DC-OPTION-CODE.
 12224     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12225     IF NO-CONVERSION-ERROR
 12226         NEXT SENTENCE
 12227     ELSE
 12228         GO TO 1445-CONTINUE.
 12229
 12230     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12231        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12232         GO TO 1445-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 234
* EL156.cbl
 12233
 12234     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12235                                 *  CF-ST-STAT-INTEREST.
 12236
 12237     MOVE SPACES              TO WS-NCLNOTE1.
 12238     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12239     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12240     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12241                                 PI-PMTNOTE1
 12242                                 NOTE1I.
 12243     MOVE AL-UANON            TO NOTE1A.
 12244
 12245     IF WS-CALC-INT > ZEROS
 12246         MOVE SPACES          TO WS-NCLNOTE2
 12247         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12248         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12249         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12250                                 PI-PMTNOTE2
 12251                                 NOTE2I
 12252         MOVE AL-UANON        TO NOTE2A.
 12253
 12254     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12255
 12256 1445-CONTINUE.
 12257
 12258     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12259        GO TO 1460-TEST-TYPE.
 12260
 12261     IF CM-O-B-COVERAGE
 12262        GO TO 1460-TEST-TYPE.
 12263
 12264     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12265         GO TO 1450-CHECK-MAX.
 12266
 12267     if pi-company-id = 'DCC'
 12268        and pdef-found
 12269        and pi-epyamt > pd-max-amt (p1)
 12270        move er-1657             to emi-error
 12271        perform 1490-payment-error
 12272                                 thru 1490-exit
 12273        go to 1460-test-type
 12274     else
 12275        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12276           > PI-EPYAMT)
 12277                         OR
 12278           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12279           < PI-EPYAMT)
 12280           MOVE ER-0594          TO EMI-ERROR
 12281           PERFORM 1490-PAYMENT-ERROR
 12282                                 THRU 1490-EXIT
 12283           GO TO 1460-TEST-TYPE
 12284        end-if
 12285     end-if
 12286     .
 12287 1450-CHECK-MAX.
 12288
 12289     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12290        PI-LF-COVERAGE-TYPE = 'P'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 235
* EL156.cbl
 12291         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12292                                   CM-LF-ITD-DEATH-AMT
 12293     ELSE
 12294         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12295                                   CL-TOTAL-PAID-AMT.
 12296
 12297     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12298          MOVE ER-0543           TO EMI-ERROR
 12299          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12300
 12301 1460-TEST-TYPE.
 12302
 12303     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12304        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12305           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12306                                   CM-LF-ALT-BENEFIT-AMT -
 12307                                   CL-TOTAL-PAID-AMT
 12308           IF PI-EPYAMT > WS-LF-BEN-AMT
 12309               MOVE ER-0543      TO EMI-ERROR
 12310               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12311           END-IF
 12312        END-IF
 12313     END-IF
 12314
 12315     IF PI-PMT-APPR-SW = 'G'
 12316       NEXT SENTENCE
 12317     ELSE
 12318       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12319         IF PI-EPYAMT = ZERO
 12320             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12321                 MOVE ER-0494    TO  EMI-ERROR
 12322                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12323                 GO TO 1500-EDIT-EXPENSES
 12324             ELSE
 12325                 NEXT SENTENCE
 12326         ELSE
 12327             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12328                 MOVE ER-0494    TO  EMI-ERROR
 12329                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12330                 GO TO 1500-EDIT-EXPENSES.
 12331
 12332     IF PI-PMTTYPE NOT = '2' OR
 12333        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12334         GO TO 1500-EDIT-EXPENSES.
 12335
 12336     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12337     MOVE ER-0526                TO EMI-ERROR.
 12338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12339
 12340     IF EMI-ERROR-NUMBER (1) = '0526'
 12341        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12342
 12343     IF EMI-ERROR-NUMBER (2) = '0526'
 12344        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12345
 12346     GO TO 1500-EDIT-EXPENSES.
 12347
 12348 1490-PAYMENT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 236
* EL156.cbl
 12349     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12350
 12351     IF EMI-MESSAGE-FORMATTED
 12352         MOVE -1                 TO EPYAMTL
 12353         MOVE AL-UNBON           TO EPYAMTA.
 12354
 12355 1490-EXIT.
 12356      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 237
* EL156.cbl
 12358 1500-EDIT-EXPENSES.
 12359     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12360         GO TO 1500-SKIP-ERROR-0556.
 12361
 12362 1500-CONTINUE-ON.
 12363
 12364     IF CM-O-B-COVERAGE
 12365        MOVE ER-0556             TO EMI-ERROR
 12366        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12367
 12368 1500-SKIP-ERROR-0556.
 12369     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12370        IF PI-EEXPENS NOT = ZEROS
 12371           MOVE ER-0524          TO EMI-ERROR
 12372           GO TO 1590-EXPENSE-ERROR
 12373        ELSE
 12374           GO TO 1600-EDIT-RESERVES.
 12375
 12376     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12377     MOVE '6'                    TO CNTL-REC-TYPE.
 12378
 12379     IF CONTROL-IS-ACTUAL-CARRIER
 12380         MOVE PI-CARRIER         TO WS-CARR
 12381     ELSE
 12382         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12383
 12384     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12385     MOVE +0                     TO CNTL-SEQ-NO.
 12386     MOVE 'CARR'                 TO FILE-SWITCH.
 12387
 12388     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12389
 12390     IF EXPENSE-CALC-MANUAL
 12391        GO TO 1600-EDIT-RESERVES.
 12392
 12393     IF DOLLARS-PER-PMT
 12394        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12395        GO TO 1600-EDIT-RESERVES.
 12396
 12397     IF DOLLARS-PER-MONTH AND
 12398        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12399       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12400       GO TO 1600-EDIT-RESERVES.
 12401
 12402     IF PERCENT-OF-PAYMENT
 12403        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12404
 12405     GO TO 1600-EDIT-RESERVES.
 12406
 12407 1590-EXPENSE-ERROR.
 12408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12409
 12410     IF EMI-MESSAGE-FORMATTED
 12411        MOVE -1                  TO EEXPENSL
 12412        MOVE AL-UNBON            TO EEXPENSA.
 12413
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 238
* EL156.cbl
 12415 1600-EDIT-RESERVES.
 12416     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12417        IF PI-ERESV = ZEROS
 12418           GO TO 1700-EDIT-EXPENSE-TYPE
 12419        ELSE
 12420           MOVE ER-0525          TO EMI-ERROR
 12421           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12422           GO TO 1700-EDIT-EXPENSE-TYPE.
 12423
 12424     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12425     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12426     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12427
 12428     IF NOT AT-MANUAL-RESERVES-USED
 12429        IF PI-ERESV NOT = ZEROS
 12430           MOVE ER-0518          TO EMI-ERROR
 12431           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12432
 12433     IF AT-MANUAL-RESERVES-USED
 12434        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12435        GO TO 1700-EDIT-EXPENSE-TYPE.
 12436
 12437     IF AT-FUTURE-RESERVES-USED
 12438        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12439
 12440     IF AT-FUTURE-RESERVES-USED
 12441        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12442
 12443     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12444        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12445
 12446     IF AT-IBNR-RESERVES-USED
 12447        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12448
 12449     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12450     GO TO 1700-EDIT-EXPENSE-TYPE.
 12451
 12452 1690-RESERVE-ERROR.
 12453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12454
 12455     IF EMI-MESSAGE-FORMATTED
 12456        MOVE AL-UNBON            TO ERESVA
 12457        MOVE -1                  TO ERESVL.
 12458
 12459 1690-EXIT.
 12460      EXIT.
 12461
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 239
* EL156.cbl
 12463 1700-EDIT-EXPENSE-TYPE.
 12464     IF PI-PMTTYPE NOT = '5' AND '6'
 12465        GO TO 2000-EDIT-DONE.
 12466
 12467     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12468                   '6' OR '7' OR '8' OR '9'
 12469        GO TO 2000-EDIT-DONE.
 12470
 12471 1705-EXPENSE-ERROR.
 12472     MOVE ER-0573                TO EMI-ERROR.
 12473     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12474
 12475     IF EMI-MESSAGE-FORMATTED
 12476        MOVE AL-UABON            TO ETYPEA
 12477        MOVE -1                  TO ETYPEL.
 12478
 12479     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 240
* EL156.cbl
 12481 1950-NOT-FOUND.
 12482     IF FILE-SWITCH = 'MSTR'
 12483        MOVE ER-0204             TO EMI-ERROR.
 12484
 12485     IF FILE-SWITCH = 'CARR'
 12486        MOVE ER-0252             TO EMI-ERROR.
 12487
 12488     IF FILE-SWITCH = 'COMP'
 12489        MOVE ER-0254             TO EMI-ERROR.
 12490
 12491     IF FILE-SWITCH = 'STAT'
 12492        MOVE ER-0149             TO EMI-ERROR.
 12493
 12494     IF FILE-SWITCH = 'PROC'
 12495        MOVE ER-0019             TO EMI-ERROR.
 12496
 12497     IF FILE-SWITCH = 'ACCT'
 12498        MOVE ER-0198             TO EMI-ERROR.
 12499
 12500     IF FILE-SWITCH = 'BENE'
 12501        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12502           MOVE ER-0282          TO EMI-ERROR
 12503        ELSE
 12504           MOVE ER-0283          TO EMI-ERROR.
 12505
 12506     MOVE -1                     TO PMTTYPEL.
 12507     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12508
 12509     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12510                                     WS-FORCE-CTR.
 12511
 12512     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12513                                     WS-FATAL-CTR.
 12514
 12515     GO TO 8200-SEND-DATAONLY.
 12516
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 241
* EL156.cbl
 12518 2000-EDIT-DONE.
 12519     if pi-company-id = 'DCC'
 12520        and cl-critical-period > 0
 12521        perform 2210-dcc-max-benes thru 2210-exit
 12522     else
 12523     IF (WS-SPECIAL-CALC-CD = 'C')
 12524*       AND (CM-AH-CRITICAL-PERIOD) > 0
 12525        and (cl-critical-period > 0)
 12526        IF CM-AH-BENEFIT-AMT NOT = ZERO
 12527           IF PI-EPYAMT > ZEROS
 12528              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12529                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12530           ELSE
 12531              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 12532                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12533           END-IF
 12534*          IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 12535           if ws-crit-period-days > cl-critical-period
 12536              MOVE ER-0657          TO EMI-ERROR
 12537              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12538           END-IF
 12539        END-IF
 12540     END-IF
 12541     end-if
 12542     IF PI-HOLDTIL NOT = ZEROS
 12543        MOVE PI-HOLDTIL          TO HOLDTILO
 12544        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12545
 12546     IF PI-EPYFROM NOT = ZEROS
 12547        MOVE PI-EPYFROM          TO EPYFROMO
 12548        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12549
 12550     IF PI-EPYTHRU NOT = ZEROS
 12551        MOVE PI-EPYTHRU            TO EPYTHRUO
 12552        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12553        IF PI-USES-PAID-TO
 12554           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12555           MOVE '4'                TO DC-OPTION-CODE
 12556           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12557           IF NO-CONVERSION-ERROR
 12558              MOVE +1              TO DC-ELAPSED-DAYS
 12559              MOVE +0              TO DC-ELAPSED-MONTHS
 12560              MOVE '6'             TO DC-OPTION-CODE
 12561              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12562              IF NO-CONVERSION-ERROR
 12563                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12564
 12565     MOVE PI-EDAYS               TO EDAYSO.
 12566
 12567     IF PI-AIGFROM NOT = ZEROS
 12568        MOVE PI-AIGFROM          TO AIGFROMO
 12569        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12570
 12571     MOVE PI-EPYAMT              TO EPYAMTO.
 12572     MOVE PI-ERESV               TO ERESVO.
 12573     MOVE PI-EEXPENS             TO EEXPENSO.
 12574
 12575     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 242
* EL156.cbl
 12576     MOVE SPACES                 TO DC-OPTION-CODE.
 12577     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12578
 12579     IF DATE-CONVERSION-ERROR
 12580        MOVE SPACES              TO CPYFROMI
 12581     ELSE
 12582        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12583        IF PI-EPYFROM = ZEROS
 12584           MOVE AL-UANON             TO EPYFROMA
 12585           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12586           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12587
 12588     IF PI-USES-PAID-TO
 12589        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12590        MOVE +1                            TO DC-ELAPSED-DAYS
 12591        MOVE +0                            TO DC-ELAPSED-MONTHS
 12592        MOVE '6'                           TO DC-OPTION-CODE
 12593        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12594        IF NO-CONVERSION-ERROR
 12595           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12596           IF PI-EPYTHRU = ZEROS
 12597              MOVE AL-UANON                TO EPYTHRUA
 12598              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12599              MOVE ' '                     TO DC-OPTION-CODE
 12600              MOVE +0                      TO DC-ELAPSED-DAYS
 12601                                              DC-ELAPSED-MONTHS
 12602              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12603              IF NO-CONVERSION-ERROR
 12604                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12605                  GO TO 2001-CONTINUE
 12606              ELSE
 12607                  GO TO 2001-CONTINUE
 12608           ELSE
 12609              GO TO 2001-CONTINUE.
 12610
 12611     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12612     MOVE SPACES                 TO DC-OPTION-CODE.
 12613     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12614
 12615     IF DATE-CONVERSION-ERROR
 12616        MOVE SPACES              TO CPYTHRUI
 12617     ELSE
 12618        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12619        IF PI-EPYTHRU = ZEROS
 12620           MOVE AL-UANON TO EPYTHRUA
 12621           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12622           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12623
 12624 2001-CONTINUE.
 12625
 12626     MOVE PI-CDAYS               TO CDAYSO.
 12627
 12628     IF PI-EDAYS = ZEROS
 12629        MOVE AL-UNNON TO EDAYSA
 12630        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12631
 12632     MOVE PI-CPYAMT              TO CPYAMTO.
 12633
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 243
* EL156.cbl
 12634     IF PI-EPYAMT = ZEROS
 12635        MOVE AL-UNNON            TO EPYAMTA
 12636        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 12637
 12638     MOVE PI-CRESV               TO CRESVO.
 12639     MOVE PI-CEXPENS             TO CEXPENSO.
 12640
 12641     IF PI-EEXPENS = ZEROS
 12642        MOVE AL-UNNON TO EEXPENSA
 12643        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12644
 12645     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12646        AND (CL-CLAIM-TYPE = 'L')
 12647        AND (PI-OFFLINE NOT EQUAL 'Y')
 12648        IF PI-PMTTYPE = '2' OR '4'
 12649           PERFORM 2200-CALC-INTEREST
 12650                                 THRU 2200-EXIT
 12651        END-IF
 12652     END-IF
 12653     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12654     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12655     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12656
 12657     IF EMI-FATAL-CTR = ZEROS
 12658        MOVE 'B'                 TO PI-PASS-SW.
 12659
 12660     IF NOT EMI-MESSAGE-FORMATTED
 12661         MOVE -1                 TO EPYFROML
 12662     ELSE
 12663         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12664            EMI-ERROR-NUMBER (2) = SPACES
 12665             MOVE -1             TO EPYFROML.
 12666
 12667     GO TO 8200-SEND-DATAONLY.
 12668
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 244
* EL156.cbl
 12670 2200-CALC-INTEREST.
 12671     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12672        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12673        MOVE '4'                 TO DC-OPTION-CODE
 12674        PERFORM 9700-LINK-DATE-CONVERT
 12675        IF DATE-CONVERSION-ERROR
 12676            MOVE LOW-VALUES      TO CP-PRF-DT
 12677        ELSE
 12678           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12679        END-IF
 12680     END-IF
 12681     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12682        IN CLAIM-INT-PASS-AREA
 12683     MOVE CL-CERT-STATE          TO CP-STATE
 12684        IN CLAIM-INT-PASS-AREA
 12685     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12686     MOVE 'LF'                   TO CP-COVERAGE
 12687     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12688     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12689     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12690     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12691     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12692     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12693
 12694* EXEC CICS LINK
 12695*       PROGRAM   ('ELCLMI')
 12696*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12697*       LENGTH    (CP-CLAIM-LENGTH)
 12698*    END-EXEC
 12699     MOVE 'ELCLMI' TO DFHEIV1
 12700*    MOVE '."C                   (   #00012106' TO DFHEIV0
 12701     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12703     MOVE X'2020233030303132313036' TO DFHEIV0(25:11)
 12704     CALL 'kxdfhei1' USING DFHEIV0,
 12705           DFHEIV1,
 12706           CLAIM-INT-PASS-AREA,
 12707           CP-CLAIM-LENGTH,
 12708           DFHEIV99,
 12709           DFHEIV99,
 12710           DFHEIV99,
 12711           DFHEIV99
 12712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12713     MOVE AL-PANOF               TO PINTHA
 12714                                    PINTA
 12715     IF NO-CI-ERROR
 12716        MOVE CP-CLM-INT-AMT      TO PINTO
 12717                                    PI-INT-AMT
 12718        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12719        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12720        MOVE AL-PANOF            TO PINTHA
 12721                                    PINTA
 12722     ELSE
 12723        IF CI-RETURN-CODE = '8'
 12724           MOVE ER-3818          TO EMI-ERROR
 12725           MOVE -1               TO ZINTL
 12726           PERFORM 9900-ERROR-FORMAT
 12727                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 245
* EL156.cbl
 12728           GO TO 2200-EXIT
 12729        ELSE
 12730           MOVE ZEROS            TO PINTO
 12731                                    PI-INT-AMT
 12732                                    PI-INT-DAYS
 12733                                    PI-INT-RATE-USED
 12734        END-IF
 12735     END-IF
 12736     IF PI-INT-AMT NOT = ZEROS
 12737        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12738           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12739           CONTINUE
 12740        ELSE
 12741           MOVE CL-SOC-SEC-NO (1:3)
 12742                                 TO WS-SSN (1:3)
 12743           MOVE CL-SOC-SEC-NO (5:2)
 12744                                 TO WS-SSN (4:2)
 12745           MOVE CL-SOC-SEC-NO (8:4)
 12746                                 TO WS-SSN (6:4)
 12747           IF (WS-SSN NUMERIC)
 12748              AND (WS-SSN NOT = ZEROS)
 12749              CONTINUE
 12750           ELSE
 12751              MOVE ER-2044       TO EMI-ERROR
 12752              PERFORM 9900-ERROR-FORMAT
 12753                                 THRU 9900-EXIT
 12754           END-IF
 12755        END-IF
 12756        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12757        MOVE +51                 TO TRLR-SEQ-NO
 12758
 12759* EXEC CICS READ
 12760*          DATASET  ('ELTRLR')
 12761*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12762*          RIDFLD   (ELTRLR-KEY)
 12763*          RESP     (WS-RESPONSE)
 12764*       END-EXEC
 12765     MOVE 'ELTRLR' TO DFHEIV1
 12766*    MOVE '&"S        E          (  N#00012156' TO DFHEIV0
 12767     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12769     MOVE X'204E233030303132313536' TO DFHEIV0(25:11)
 12770     CALL 'kxdfhei1' USING DFHEIV0,
 12771           DFHEIV1,
 12772           DFHEIV20,
 12773           DFHEIV99,
 12774           ELTRLR-KEY,
 12775           DFHEIV99,
 12776           DFHEIV99,
 12777           DFHEIV99
 12778     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12779         DFHEIV20
 12780     MOVE EIBRESP  TO WS-RESPONSE
 12781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12782        IF (NOT WS-RESP-NORMAL)
 12783                    OR
 12784           ((WS-RESP-NORMAL)
 12785           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 246
* EL156.cbl
 12786           OR (AT-CITY-STATE = SPACES)))
 12787           MOVE ER-0874          TO EMI-ERROR
 12788           PERFORM 9900-ERROR-FORMAT
 12789                                 THRU 9900-EXIT
 12790        END-IF
 12791     END-IF
 12792     .
 12793 2200-EXIT.
 12794     EXIT.
 12795 2210-dcc-max-benes.
 12796
 12797     move cm-ah-benefit-amt      to ws-monthly-benefit
 12798     if pdef-found
 12799        and pd-max-amt (p1) < ws-monthly-benefit
 12800        move pd-max-amt (p1)     to ws-monthly-benefit
 12801     end-if
 12802
 12803     move cl-cert-key-data       to elcrtt-key (2:21)
 12804     move cl-company-cd          to ctrlr-comp-cd
 12805     move cl-cert-no             to ctrlr-cert-no
 12806     move 'B'                    to ctrlr-rec-type
 12807
 12808
 12809* EXEC CICS READ
 12810*       DATASET  ('ELCRTT')
 12811*       set      (address of CERTIFICATE-TRAILERS)
 12812*       RIDFLD   (ELCRTT-KEY)
 12813*       RESP     (WS-RESPONSE)
 12814*    END-EXEC
 12815     MOVE 'ELCRTT' TO DFHEIV1
 12816*    MOVE '&"S        E          (  N#00012188' TO DFHEIV0
 12817     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12819     MOVE X'204E233030303132313838' TO DFHEIV0(25:11)
 12820     CALL 'kxdfhei1' USING DFHEIV0,
 12821           DFHEIV1,
 12822           DFHEIV20,
 12823           DFHEIV99,
 12824           ELCRTT-KEY,
 12825           DFHEIV99,
 12826           DFHEIV99,
 12827           DFHEIV99
 12828     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12829         DFHEIV20
 12830     MOVE EIBRESP  TO WS-RESPONSE
 12831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12832     IF not WS-RESP-NORMAL
 12833        go to 2210-exit
 12834     end-if
 12835
 12836*    if instypei = 'P'
 12837*       move +1 to s1
 12838*    else
 12839*       MOVE +2 to s1
 12840*    end-if
 12841
 12842     move +1 to s1
 12843     evaluate cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 247
* EL156.cbl
 12844        when 'A'
 12845           move +1 to s2
 12846        when 'I'
 12847           move +2 to s2
 12848        when 'G'
 12849           move +3 to s2
 12850        when 'L'
 12851           move +4 to s2
 12852        when 'P'
 12853           move +5 to s2
 12854     end-evaluate
 12855
 12856     if pi-epyamt > zeros
 12857        compute ws-crit-period-days =
 12858           (cs-total-paid (s1 s2) + PI-EPYAMT)
 12859           / ws-monthly-benefit
 12860     else
 12861        compute ws-crit-period-days =
 12862           (cs-total-paid (s1 s2) + PI-CPYAMT)
 12863           / ws-monthly-benefit
 12864     end-if
 12865
 12866     if ws-crit-period-days > cl-critical-period
 12867*    if ws-crit-period-days > pd-crit-period (p1)
 12868        move er-1658             to emi-error
 12869        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12870     end-if
 12871
 12872     .
 12873 2210-exit.
 12874     exit.
 12875
 12876 2220-update-elcrtt.
 12877
 12878
 12879* EXEC CICS GETMAIN
 12880*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 12881*       LENGTH   (ELCRTT-LENGTH)
 12882*       INITIMG  (GETMAIN-SPACE)
 12883*    END-EXEC
 12884*    MOVE ',"IL                  $   #00012240' TO DFHEIV0
 12885     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12886     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12887     MOVE X'2020233030303132323430' TO DFHEIV0(25:11)
 12888     CALL 'kxdfhei1' USING DFHEIV0,
 12889           DFHEIV20,
 12890           ELCRTT-LENGTH,
 12891           GETMAIN-SPACE
 12892     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12893         DFHEIV20
 12894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12895
 12896     move cl-cert-key-data       to elcrtt-key (2:21)
 12897     move cl-company-cd          to ctrlr-comp-cd
 12898     move cl-cert-no             to ctrlr-cert-no
 12899     move 'B'                    to ctrlr-rec-type
 12900
 12901
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 248
* EL156.cbl
 12902* EXEC CICS READ
 12903*       UPDATE
 12904*       DATASET  (ELCRTT-DSID)
 12905*       into     (CERTIFICATE-TRAILERS)
 12906*       RIDFLD   (ELCRTT-KEY)
 12907*       RESP     (WS-RESPONSE)
 12908*    END-EXEC
 12909     MOVE LENGTH OF
 12910      CERTIFICATE-TRAILERS
 12911       TO DFHEIV11
 12912*    MOVE '&"IL       EU         (  N#00012251' TO DFHEIV0
 12913     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12914     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12915     MOVE X'204E233030303132323531' TO DFHEIV0(25:11)
 12916     CALL 'kxdfhei1' USING DFHEIV0,
 12917           ELCRTT-DSID,
 12918           CERTIFICATE-TRAILERS,
 12919           DFHEIV11,
 12920           ELCRTT-KEY,
 12921           DFHEIV99,
 12922           DFHEIV99,
 12923           DFHEIV99
 12924     MOVE EIBRESP  TO WS-RESPONSE
 12925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12926
 12927     IF WS-RESP-NORMAL
 12928        perform 2225-upd-crt-trlr thru 2225-exit
 12929
 12930* EXEC CICS REWRITE
 12931*          DATASET  (ELCRTT-DSID)
 12932*          from     (CERTIFICATE-TRAILERS)
 12933*          RESP     (WS-RESPONSE)
 12934*       END-EXEC
 12935     MOVE LENGTH OF
 12936      CERTIFICATE-TRAILERS
 12937       TO DFHEIV11
 12938*    MOVE '&& L                  %  N#00012261' TO DFHEIV0
 12939     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12940     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12941     MOVE X'204E233030303132323631' TO DFHEIV0(25:11)
 12942     CALL 'kxdfhei1' USING DFHEIV0,
 12943           ELCRTT-DSID,
 12944           CERTIFICATE-TRAILERS,
 12945           DFHEIV11,
 12946           DFHEIV99
 12947     MOVE EIBRESP  TO WS-RESPONSE
 12948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12949     else
 12950        if ws-resp-notfnd
 12951           move 'CS'             to certificate-trailers
 12952           move cl-company-cd    to cs-company-cd
 12953           move cl-cert-key-data to cs-control-primary (2:21)
 12954           move cl-cert-no       to cs-cert-no
 12955           move 'B'              to cs-trailer-type
 12956           perform varying s1 from +1 by +1 until s1 > +2
 12957              perform varying s2 from +1 by +1 until s2 > +10
 12958                 move zeros      to cs-bank (s1 s2)
 12959                                    cs-no-of-claims (s1 s2)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 249
* EL156.cbl
 12960                                    cs-days-paid (s1 s2)
 12961                                    cs-total-paid (s1 s2)
 12962              end-perform
 12963           end-perform
 12964           perform 2225-upd-crt-trlr
 12965                                 thru 2225-exit
 12966
 12967* EXEC CICS WRITE
 12968*             DATASET  (ELCRTT-DSID)
 12969*             from     (CERTIFICATE-TRAILERS)
 12970*             RIDFLD   (cs-control-primary)
 12971*             RESP     (WS-RESPONSE)
 12972*          END-EXEC
 12973     MOVE LENGTH OF
 12974      CERTIFICATE-TRAILERS
 12975       TO DFHEIV11
 12976*    MOVE '&$ L                  ''  N#00012283' TO DFHEIV0
 12977     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12978     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12979     MOVE X'204E233030303132323833' TO DFHEIV0(25:11)
 12980     CALL 'kxdfhei1' USING DFHEIV0,
 12981           ELCRTT-DSID,
 12982           CERTIFICATE-TRAILERS,
 12983           DFHEIV11,
 12984           cs-control-primary,
 12985           DFHEIV99,
 12986           DFHEIV99
 12987     MOVE EIBRESP  TO WS-RESPONSE
 12988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12989        end-if
 12990     END-IF
 12991
 12992     .
 12993 2220-exit.
 12994     exit.
 12995
 12996 2225-upd-crt-trlr.
 12997
 12998*    if instypei = 'P'
 12999*       move +1 to s1
 13000*    else
 13001*       MOVE +2 to s1
 13002*    end-if
 13003
 13004     move +1 to s1
 13005     evaluate cl-claim-type
 13006        when 'A'
 13007           move +1 to s2
 13008        when 'I'
 13009           move +2 to s2
 13010        when 'G'
 13011           move +3 to s2
 13012        when 'L'
 13013           move +4 to s2
 13014        when 'P'
 13015           move +5 to s2
 13016     end-evaluate
 13017
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 250
* EL156.cbl
 13018     compute cs-total-paid (s1 s2) = cs-total-paid (s1 s2) +
 13019        at-amount-paid
 13020     compute cs-days-paid (s1 s2) = cs-days-paid (s1 s2) +
 13021        at-days-in-period
 13022
 13023     .
 13024 2225-exit.
 13025     exit.
 13026 3000-MOVE-INPUT-TO-SAVE-AREA.
 13027     IF PMTTYPEL > 0
 13028         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13029
 13030     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13031
 13032     IF WS-PMTTYPE = '9'
 13033         MOVE 'P'                TO PI-PROVISIONAL-IND
 13034         MOVE '1'                TO WS-PMTTYPE.
 13035
 13036     IF PAYEEL > 0
 13037         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13038         MOVE PAYEEI             TO WS-PAYEE.
 13039
 13040     IF NOTE1L > +0
 13041         MOVE NOTE1I             TO WS-PMTNOTE1
 13042                                    WS-FLI-PMTNOTE
 13043                                    WS-HAN-PMTNOTE.
 13044
 13045     IF NOTE2L > +0
 13046         MOVE NOTE2I             TO WS-PMTNOTE2.
 13047
 13048     IF OFFLINEL > 0
 13049         MOVE OFFLINEI           TO WS-OFFLINE.
 13050
 13051     IF PROOFDTL > 0
 13052         MOVE PROOFDTI            TO DATE-WORK
 13053         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13054         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13055         MOVE '4'                 TO DC-OPTION-CODE
 13056         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13057         IF NO-CONVERSION-ERROR
 13058            MOVE NUM-WORK         TO PROOFDTO
 13059            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13060            MOVE NUM-WORK         TO WS-PROOF-DATE
 13061         ELSE
 13062            MOVE ZEROS            TO WS-PROOF-DATE
 13063         END-IF
 13064     END-IF.
 13065
 13066     IF EOBYNL > +0
 13067         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13068         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13069     END-IF
 13070
 13071     IF CLMFMYNL > +0
 13072         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13073         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13074     END-IF
 13075
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 251
* EL156.cbl
 13076     IF SURVYYNL > +0
 13077         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13078         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13079     END-IF
 13080
 13081     IF SPRELYNL > +0
 13082         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13083         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13084     END-IF
 13085*    IF GROUPEDL > +0
 13086*        MOVE GROUPEDI           TO WS-GROUPED.
 13087*
 13088*    IF CASHL > +0
 13089*       MOVE CASHI               TO WS-CASH.
 13090     IF LOANNOL > +0
 13091         MOVE LOANNOI            TO WS-LOAN-NO.
 13092
 13093     IF CHECKNOL > 0
 13094         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13095
 13096     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13097         IF WS-AIG-CREDIT-ENTERED
 13098             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13099             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13100             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13101             MOVE AL-UANON         TO CHECKNOA.
 13102
 13103     IF HOLDTILL > 0
 13104         MOVE HOLDTILI           TO DATE-WORK
 13105         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13106         MOVE NUM-WORK           TO WS-HOLDTIL.
 13107
 13108     IF ZINTL > +0
 13109
 13110* EXEC CICS BIF DEEDIT
 13111*           FIELD   (ZINTI)
 13112*           LENGTH  (07)
 13113*       END-EXEC
 13114     MOVE 07
 13115       TO DFHEIV11
 13116*    MOVE '@"L                   #   #00012409' TO DFHEIV0
 13117     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13118     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13119     MOVE X'2020233030303132343039' TO DFHEIV0(25:11)
 13120     CALL 'kxdfhei1' USING DFHEIV0,
 13121           ZINTI,
 13122           DFHEIV11
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13124        IF ZINTI NOT NUMERIC
 13125           MOVE ER-0419          TO EMI-ERROR
 13126           PERFORM 9900-ERROR-FORMAT
 13127           MOVE AL-UABON         TO ZINTA
 13128           MOVE -1               TO ZINTL
 13129        ELSE
 13130           MOVE ZINTI            TO CP-INT-RATE
 13131                                    WS-INT-RATE
 13132           MOVE CP-INT-RATE      TO ZINTO
 13133           MOVE AL-UNNON         TO ZINTA
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 252
* EL156.cbl
 13134        END-IF
 13135     ELSE
 13136        MOVE ZEROS               TO CP-INT-RATE
 13137     END-IF
 13138     IF EPYFROML > 0
 13139         MOVE EPYFROMI           TO DATE-WORK
 13140         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13141         MOVE NUM-WORK           TO WS-EPYFROM.
 13142
 13143     IF AIGFROML > 0
 13144         MOVE AIGFROMI           TO DATE-WORK
 13145         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13146         MOVE NUM-WORK           TO WS-AIGFROM
 13147     ELSE
 13148         IF (AIGFROMI = LOW-VALUES) AND
 13149            (PI-AIGFROM NOT = ZEROS)
 13150              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13151
 13152     IF EPYTHRUL > +0
 13153        MOVE EPYTHRUI           TO DATE-WORK
 13154        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13155        MOVE NUM-WORK           TO WS-EPYTHRU
 13156        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13157        MOVE '4'                TO DC-OPTION-CODE
 13158        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13159        IF NO-CONVERSION-ERROR
 13160           IF PI-USES-PAID-TO
 13161              MOVE '6'                TO DC-OPTION-CODE
 13162              MOVE -1                 TO DC-ELAPSED-DAYS
 13163              MOVE +0                 TO DC-ELAPSED-MONTHS
 13164              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13165              IF NO-CONVERSION-ERROR
 13166                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13167                 MOVE ' '             TO DC-OPTION-CODE
 13168                 MOVE +0              TO DC-ELAPSED-DAYS
 13169                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13170              IF NO-CONVERSION-ERROR
 13171                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13172
 13173*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13174*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13175     IF EDAYSL > 0
 13176
 13177* EXEC CICS BIF DEEDIT
 13178*            FIELD(EDAYSI)
 13179*            LENGTH(6)
 13180*        END-EXEC
 13181     MOVE 6
 13182       TO DFHEIV11
 13183*    MOVE '@"L                   #   #00012465' TO DFHEIV0
 13184     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13185     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13186     MOVE X'2020233030303132343635' TO DFHEIV0(25:11)
 13187     CALL 'kxdfhei1' USING DFHEIV0,
 13188           EDAYSI,
 13189           DFHEIV11
 13190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13191         MOVE EDAYSI             TO WS-DY-WORK
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 253
* EL156.cbl
 13192         IF WS-DY-SIGN = SPACES
 13193            MOVE WS-DY-NUM       TO WS-EDAYS
 13194            ADD 0                TO WS-EDAYS
 13195         ELSE
 13196            MOVE EDAYSI          TO WS-EDAYS
 13197            ADD 0                TO WS-EDAYS.
 13198
 13199*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13200*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13201     IF EPYAMTL > 0
 13202
 13203* EXEC CICS BIF DEEDIT
 13204*            FIELD(EPYAMTI)
 13205*            LENGTH(10)
 13206*        END-EXEC
 13207     MOVE 10
 13208       TO DFHEIV11
 13209*    MOVE '@"L                   #   #00012480' TO DFHEIV0
 13210     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13211     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13212     MOVE X'2020233030303132343830' TO DFHEIV0(25:11)
 13213     CALL 'kxdfhei1' USING DFHEIV0,
 13214           EPYAMTI,
 13215           DFHEIV11
 13216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13217         MOVE EPYAMTI            TO WS-PY-WORK
 13218         IF WS-PY-SIGN = SPACES
 13219            MOVE WS-PY-NUM       TO WS-EPYAMT
 13220            ADD 0                TO WS-EPYAMT
 13221         ELSE
 13222            MOVE EPYAMTI         TO WS-EPYAMT
 13223            ADD 0                TO WS-EPYAMT.
 13224
 13225     IF ERESVL > 0
 13226
 13227* EXEC CICS BIF DEEDIT
 13228*            FIELD(ERESVI)
 13229*            LENGTH(9)
 13230*        END-EXEC
 13231     MOVE 9
 13232       TO DFHEIV11
 13233*    MOVE '@"L                   #   #00012493' TO DFHEIV0
 13234     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13235     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13236     MOVE X'2020233030303132343933' TO DFHEIV0(25:11)
 13237     CALL 'kxdfhei1' USING DFHEIV0,
 13238           ERESVI,
 13239           DFHEIV11
 13240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13241         MOVE ERESVI TO WS-ERESV.
 13242
 13243     IF EEXPENSL > 0
 13244
 13245* EXEC CICS BIF DEEDIT
 13246*            FIELD(EEXPENSI)
 13247*            LENGTH(8)
 13248*        END-EXEC
 13249     MOVE 8
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 254
* EL156.cbl
 13250       TO DFHEIV11
 13251*    MOVE '@"L                   #   #00012500' TO DFHEIV0
 13252     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13253     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13254     MOVE X'2020233030303132353030' TO DFHEIV0(25:11)
 13255     CALL 'kxdfhei1' USING DFHEIV0,
 13256           EEXPENSI,
 13257           DFHEIV11
 13258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13259         MOVE EEXPENSI           TO WS-EEXPENS.
 13260
 13261     IF ETYPEL > ZEROS
 13262         MOVE ETYPEI             TO WS-ETYPE.
 13263
 13264     IF PI-COMPANY-ID = 'BOA'
 13265        IF PINTL > ZEROS
 13266
 13267* EXEC CICS BIF DEEDIT
 13268*            FIELD (PINTI)
 13269*            LENGTH(05)
 13270*          END-EXEC
 13271     MOVE 05
 13272       TO DFHEIV11
 13273*    MOVE '@"L                   #   #00012511' TO DFHEIV0
 13274     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13275     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13276     MOVE X'2020233030303132353131' TO DFHEIV0(25:11)
 13277     CALL 'kxdfhei1' USING DFHEIV0,
 13278           PINTI,
 13279           DFHEIV11
 13280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13281           IF PINTI NUMERIC
 13282               MOVE AL-UNNON     TO PINTA
 13283               MOVE PINTI        TO WS-INT-RATE
 13284               MOVE WS-INT-RATE  TO PINTO.
 13285
 13286 3000-EXIT.
 13287     EXIT.
 13288
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 255
* EL156.cbl
 13290 3050-REBUILD-ENTERED.
 13291
 13292     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13293
 13294     IF PI-PROV-PMT
 13295         MOVE '9'           TO PMTTYPEO
 13296     ELSE
 13297         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13298
 13299     MOVE PI-PAYEE          TO PAYEEO.
 13300     MOVE PI-PMTNOTE1       TO NOTE1O.
 13301     MOVE PI-PMTNOTE2       TO NOTE2O.
 13302     MOVE PI-OFFLINE        TO OFFLINEO.
 13303     IF PI-PROOF-DATE NOT = ZEROS
 13304         MOVE PI-PROOF-DATE TO PROOFDTO
 13305         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13306     END-IF.
 13307*    MOVE PI-GROUPED        TO GROUPEDO.
 13308
 13309*    MOVE PI-CASH           TO CASHO.
 13310
 13311     IF PI-INT-RATE > ZEROS
 13312         MOVE PI-INT-RATE   TO PINTO.
 13313
 13314     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13315        IF PI-INT-AMT > ZEROS
 13316           MOVE PI-INT-AMT       TO PINTO
 13317           MOVE AL-PANOF         TO PINTA
 13318                                    PINTHA
 13319        END-IF
 13320     END-IF
 13321     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13322     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13323     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13324     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13325     IF PI-HOLDTIL NOT = ZEROS
 13326        MOVE PI-HOLDTIL          TO HOLDTILO
 13327        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13328
 13329     IF PI-EPYFROM NOT = ZEROS
 13330        MOVE PI-EPYFROM          TO EPYFROMO
 13331        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13332
 13333     IF PI-AIGFROM NOT = ZEROS
 13334        MOVE PI-AIGFROM          TO AIGFROMO
 13335        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13336
 13337     IF PI-EPYTHRU NOT = ZEROS
 13338        MOVE PI-EPYTHRU          TO EPYTHRUO
 13339        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13340        IF PI-USES-PAID-TO
 13341           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13342           MOVE '4'                TO DC-OPTION-CODE
 13343           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13344           IF NO-CONVERSION-ERROR
 13345              MOVE +1 TO DC-ELAPSED-DAYS
 13346              MOVE +0 TO DC-ELAPSED-MONTHS
 13347              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 256
* EL156.cbl
 13348              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13349              IF NO-CONVERSION-ERROR
 13350                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13351
 13352     IF PI-EDAYS NOT = ZEROS
 13353        MOVE PI-EDAYS TO EDAYSO.
 13354
 13355     IF PI-EPYAMT NOT = ZEROS
 13356        MOVE PI-EPYAMT TO EPYAMTO.
 13357
 13358     IF PI-ERESV NOT = ZEROS
 13359        MOVE PI-ERESV TO ERESVO.
 13360
 13361     IF PI-EEXPENS NOT = ZEROS
 13362        MOVE PI-EEXPENS TO EEXPENSO.
 13363
 13364     MOVE PI-ETYPE TO ETYPEO.
 13365
 13366     IF PI-ECHECKNO NOT = SPACES
 13367        MOVE PI-ECHECKNO         TO CHECKNOO
 13368     ELSE
 13369        MOVE PI-CCHECKNO         TO CHECKNOO.
 13370
 13371     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13372     MOVE SPACES                 TO DC-OPTION-CODE.
 13373     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13374
 13375     IF DATE-CONVERSION-ERROR
 13376        MOVE SPACES              TO CPYFROMI
 13377     ELSE
 13378        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13379
 13380     IF PI-USES-PAID-TO
 13381        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13382        MOVE +1                  TO DC-ELAPSED-DAYS
 13383        MOVE +0                  TO DC-ELAPSED-MONTHS
 13384        MOVE '6'                 TO DC-OPTION-CODE
 13385        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13386        IF NO-CONVERSION-ERROR
 13387           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13388           GO TO 3051-CONTINUE.
 13389
 13390     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13391     MOVE SPACES                 TO DC-OPTION-CODE.
 13392     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13393
 13394     IF DATE-CONVERSION-ERROR
 13395        MOVE SPACES              TO CPYTHRUI
 13396     ELSE
 13397        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13398
 13399 3051-CONTINUE.
 13400
 13401     IF PI-CDAYS NOT = ZEROS
 13402        MOVE PI-CDAYS TO CDAYSO.
 13403
 13404     IF PI-CPYAMT NOT = ZEROS
 13405        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 257
* EL156.cbl
 13406
 13407     IF PI-CRESV NOT = ZEROS
 13408        MOVE PI-CRESV TO CRESVO.
 13409
 13410     IF PI-CEXPENS NOT = ZEROS
 13411        MOVE PI-CEXPENS TO CEXPENSO.
 13412
 13413 3059-EXIT.
 13414     EXIT.
 13415
 13416 3100-DEEDIT-DATE.
 13417
 13418* EXEC CICS BIF DEEDIT
 13419*        FIELD(DATE-WORK)
 13420*        LENGTH(8)
 13421*    END-EXEC.
 13422     MOVE 8
 13423       TO DFHEIV11
 13424*    MOVE '@"L                   #   #00012651' TO DFHEIV0
 13425     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13426     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13427     MOVE X'2020233030303132363531' TO DFHEIV0(25:11)
 13428     CALL 'kxdfhei1' USING DFHEIV0,
 13429           DATE-WORK,
 13430           DFHEIV11
 13431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13432
 13433
 13434 3100-EXIT.
 13435     EXIT.
 13436
 13437 3200-CALC-AIG-DAYS.
 13438
 13439     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13440
 13441     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13442     MOVE ' '                    TO DC-OPTION-CODE.
 13443     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13444     IF NO-CONVERSION-ERROR
 13445         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13446     ELSE
 13447         GO TO 3290-ERROR.
 13448
 13449     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13450         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13451                                WS-BIN-FROM-DT
 13452     ELSE
 13453         IF CL-TOTAL-PAID-AMT > ZEROS
 13454             IF WS-SV-EPYFROM = LOW-VALUES
 13455                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13456                                        WS-BIN-FROM-DT
 13457             ELSE
 13458                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13459                                        WS-BIN-FROM-DT
 13460         ELSE
 13461             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13462                                        WS-BIN-FROM-DT.
 13463
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 258
* EL156.cbl
 13464 3210-CONTINUE.
 13465
 13466     MOVE ' '                    TO DC-OPTION-CODE.
 13467     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13468     IF DATE-CONVERSION-ERROR
 13469         GO TO 3290-ERROR.
 13470
 13471     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13472
 13473     IF PI-LOAN-DUE-DAY = 31
 13474         MOVE 30              TO WS-PMT-DUE-DA
 13475                                 WS-SAVE-DUE-DA
 13476     ELSE
 13477         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13478                                 WS-SAVE-DUE-DA.
 13479
 13480     IF (PI-LOAN-DUE-DAY > 28) AND
 13481        (WS-PMT-DUE-MO = 2)
 13482         MOVE 'Y'                TO WS-DUE-DAY-SW
 13483         MOVE 28                 TO WS-PMT-DUE-DA.
 13484
 13485     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13486     MOVE '4'                    TO DC-OPTION-CODE.
 13487     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13488     IF NO-CONVERSION-ERROR
 13489         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13490     ELSE
 13491         GO TO 3290-ERROR.
 13492
 13493*--------------------------------------------------------------*
 13494*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13495*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13496*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13497*                                                              *
 13498*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13499*             INCURRED DATE      - 04/15/91                    *
 13500*             PMT DUE DATE       - 04/03/91                    *
 13501*             PMT DUE DATE       - 05/03/91                    *
 13502*--------------------------------------------------------------*
 13503
 13504     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13505        (WS-SV-AIGFROM = LOW-VALUES)
 13506         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13507            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13508             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13509             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13510             IF NO-CONVERSION-ERROR
 13511                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13512                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13513             ELSE
 13514                 GO TO 3290-ERROR.
 13515
 13516     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13517        (WS-SV-AIGFROM = LOW-VALUES)
 13518         GO TO 3205-CONT-CALC-PMT.
 13519
 13520     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13521     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 259
* EL156.cbl
 13522     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13523     IF NO-CONVERSION-ERROR
 13524         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13525     ELSE
 13526         GO TO 3290-ERROR.
 13527
 13528     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13529        (WS-PMT-DUE-DA < WS-FROM-DA)
 13530          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13531          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13532          IF NO-CONVERSION-ERROR
 13533              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13534              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13535          ELSE
 13536              GO TO 3290-ERROR.
 13537
 13538 3205-CONT-CALC-PMT.
 13539
 13540*--------------------------------------------------------------*
 13541*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13542*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13543*--------------------------------------------------------------*
 13544
 13545     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13546        PI-PMTTYPE = '2'
 13547          NEXT SENTENCE
 13548     ELSE
 13549        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13550           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13551             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13552             MOVE ER-3527            TO EMI-ERROR
 13553             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13554             MOVE -1                 TO EPYTHRUL
 13555             MOVE AL-UNBON           TO EPYTHRUA
 13556                                        EPYFROMA
 13557             GO TO 3299-EXIT.
 13558
 13559*--------------------------------------------------------------*
 13560*    CALCULATE RETRO ELIMINATION DATE                          *
 13561*--------------------------------------------------------------*
 13562
 13563     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13564         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13565     ELSE
 13566         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13567
 13568     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13569     MOVE +0             TO DC-ELAPSED-MONTHS.
 13570     MOVE '6'            TO DC-OPTION-CODE.
 13571     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13572     IF NO-CONVERSION-ERROR
 13573         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13574     ELSE
 13575         GO TO 3290-ERROR.
 13576
 13577 3210-CHECK-PMT-DATE.
 13578
 13579*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 260
* EL156.cbl
 13580*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13581*    THE ENTERED PAY FROM DATE                                 *
 13582*--------------------------------------------------------------*
 13583
 13584     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13585         NEXT SENTENCE
 13586     ELSE
 13587         GO TO 3220-COMPUTE-DAYS.
 13588
 13589     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13590     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13591     IF NO-CONVERSION-ERROR
 13592         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13593         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13594         GO TO 3210-CHECK-PMT-DATE
 13595     ELSE
 13596         GO TO 3290-ERROR.
 13597
 13598 3220-COMPUTE-DAYS.
 13599
 13600     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13601     MOVE ZEROS         TO WS-CDAYS.
 13602     MOVE 'N'           TO WS-ELIMINATION-SW.
 13603
 13604*--------------------------------------------------------------*
 13605*    COMPUTE CALIFORNIA DUE DAYS                               *
 13606*--------------------------------------------------------------*
 13607
 13608     IF CL-TOTAL-PAID-AMT > ZEROS
 13609         MOVE 'Y' TO WS-ELIMINATION-SW
 13610         GO TO 3240-FIRST-PMT-DUE
 13611     ELSE
 13612        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13613            NEXT SENTENCE
 13614        ELSE
 13615            GO TO 3240-FIRST-PMT-DUE.
 13616
 13617 3230-NEXT-PMT-DUE.
 13618
 13619     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13620     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13621     IF NO-CONVERSION-ERROR
 13622         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13623         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13624     ELSE
 13625         GO TO 3290-ERROR.
 13626
 13627 3240-FIRST-PMT-DUE.
 13628
 13629     IF CL-TOTAL-PAID-AMT > ZEROS
 13630         NEXT SENTENCE
 13631     ELSE
 13632        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13633            GO TO 3230-NEXT-PMT-DUE.
 13634
 13635     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13636         GO TO 3250-VERIFY-ELIMINATION.
 13637
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 261
* EL156.cbl
 13638     ADD +30 TO WS-CDAYS.
 13639     MOVE 'Y' TO WS-ELIMINATION-SW.
 13640     GO TO 3230-NEXT-PMT-DUE.
 13641
 13642 3250-VERIFY-ELIMINATION.
 13643
 13644     IF ELIM-SATISFIED
 13645         GO TO 3260-END-CALC.
 13646
 13647     IF PI-PMTTYPE = '1'
 13648         MOVE ZEROS TO WS-CDAYS
 13649         GO TO 3260-END-CALC.
 13650
 13651     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13652         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13653     ELSE
 13654         IF CL-TOTAL-PAID-AMT > ZEROS
 13655             IF WS-SV-EPYFROM = LOW-VALUES
 13656                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13657             ELSE
 13658                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13659         ELSE
 13660             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13661
 13662     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13663     MOVE '1'                    TO DC-OPTION-CODE.
 13664     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13665     IF NO-CONVERSION-ERROR
 13666         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13667     ELSE
 13668         GO TO 3290-ERROR.
 13669
 13670     IF CL-TOTAL-PAID-AMT > ZEROS
 13671         MOVE WS-DAYS-OFF TO WS-CDAYS
 13672     ELSE
 13673         IF PI-BEN-DAYS > WS-DAYS-OFF
 13674             MOVE ZEROS TO WS-CDAYS
 13675         ELSE
 13676             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13677
 13678 3260-END-CALC.
 13679
 13680     MOVE WS-CDAYS TO PI-CDAYS.
 13681
 13682     IF PI-EDAYS = ZEROS
 13683         MOVE PI-CDAYS TO PI-EDAYS
 13684         MOVE AL-UNNON TO EDAYSA.
 13685
 13686     GO TO 3299-EXIT.
 13687
 13688 3290-ERROR.
 13689
 13690     MOVE ER-3528            TO EMI-ERROR.
 13691     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13692     MOVE -1                 TO CDAYSL.
 13693     MOVE AL-UNBON           TO CDAYSA.
 13694
 13695 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 262
* EL156.cbl
 13696     EXIT.
 13697
 13698 3300-BUMP-DATE.
 13699
 13700     IF WS-RESTORE-DUE-DAY
 13701         MOVE 'N'              TO WS-DUE-DAY-SW
 13702         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13703         ADD 1                 TO WS-PMT-DUE-MO
 13704         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13705         MOVE '4'              TO DC-OPTION-CODE
 13706         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13707         IF NO-CONVERSION-ERROR
 13708             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13709             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13710             GO TO 3399-EXIT
 13711         ELSE
 13712             MOVE '9'          TO DC-ERROR-CODE
 13713             GO TO 3399-EXIT.
 13714
 13715     IF (WS-PMT-DUE-MO = 1) AND
 13716        (WS-SAVE-DUE-DA > 28)
 13717           MOVE 'Y' TO WS-DUE-DAY-SW.
 13718
 13719     MOVE +0                 TO DC-ELAPSED-DAYS.
 13720     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13721     MOVE '6'                TO DC-OPTION-CODE.
 13722     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13723
 13724 3399-EXIT.
 13725     EXIT.
 13726
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 263
* EL156.cbl
 13728 3400-COMPUTE-EXPIRY.
 13729
 13730     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13731     MOVE +0                    TO DC-ELAPSED-DAYS
 13732                                   DC-ODD-DAYS-OVER.
 13733     MOVE '1'                   TO DC-END-OF-MONTH.
 13734     MOVE '6'                   TO DC-OPTION-CODE.
 13735
 13736     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13737         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13738     ELSE
 13739         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13740
 13741     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13742     IF NO-CONVERSION-ERROR
 13743         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13744     ELSE
 13745         GO TO 3390-CONTINUE.
 13746
 13747     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13748         GO TO 3390-CONTINUE.
 13749
 13750     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13751     MOVE '4'                    TO CNTL-REC-TYPE.
 13752     MOVE +0                     TO CNTL-SEQ-NO.
 13753     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13754     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13755     MOVE 'BENE'                 TO FILE-SWITCH.
 13756
 13757     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13758
 13759     IF NO-BENEFIT-FOUND
 13760         GO TO 3390-CONTINUE.
 13761
 13762     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13763        IF (PI-OFFLINE = 'Y') OR
 13764           (PI-PMTTYPE = '7')
 13765           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13766                                     THRU 9870-EXIT
 13767           IF ERROR-ON-OUTPUT
 13768             MOVE -1                 TO ENTERPFL
 13769             MOVE AL-UANON           TO ENTERPFA
 13770             MOVE MAP-NAMEA          TO MAP-NAME
 13771             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13772             GO TO 8200-SEND-DATAONLY.
 13773
 13774     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 13775        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 13776        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 13777          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 13778          MOVE +0        TO DC-ELAPSED-DAYS
 13779          MOVE +1        TO DC-ELAPSED-MONTHS
 13780          MOVE 6         TO DC-OPTION-CODE
 13781          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13782          IF NO-CONVERSION-ERROR
 13783              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 13784
 13785 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 264
* EL156.cbl
 13786
 13787      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13788         MOVE CM-AH-LOAN-EXPIRE-DT
 13789                                 TO DC-BIN-DATE-1
 13790      ELSE
 13791         MOVE CM-LF-LOAN-EXPIRE-DT
 13792                                 TO DC-BIN-DATE-1
 13793      END-IF
 13794
 13795      MOVE ' '                    TO DC-OPTION-CODE.
 13796      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13797      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 13798      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 13799
 13800 3499-EXIT.
 13801     EXIT.
 13802
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 265
* EL156.cbl
 13804
 13805 3600-CHECK-VERIFICATION.
 13806
 13807     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13808
 13809     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13810
 13811     IF PI-PAYEE-TYPE = 'I'
 13812        GO TO 3600-READ-TRAILER.
 13813
 13814     IF PI-PAYEE-TYPE = 'B'
 13815        ADD +10                  TO TRLR-SEQ-NO
 13816        GO TO 3600-READ-TRAILER.
 13817
 13818     IF PI-PAYEE-TYPE = 'A'
 13819        ADD +20                  TO TRLR-SEQ-NO
 13820        GO TO 3600-READ-TRAILER.
 13821
 13822     IF PI-PAYEE-TYPE = 'O'
 13823        ADD +50                  TO TRLR-SEQ-NO
 13824        GO TO 3600-READ-TRAILER.
 13825
 13826     IF PI-PAYEE-TYPE = 'Q'
 13827        ADD +60                  TO TRLR-SEQ-NO
 13828        GO TO 3600-READ-TRAILER.
 13829
 13830     IF PI-PAYEE-TYPE = 'P'
 13831        ADD +30                  TO TRLR-SEQ-NO
 13832        GO TO 3600-READ-TRAILER.
 13833
 13834     IF PI-PAYEE-TYPE = 'E'
 13835        ADD +40                  TO TRLR-SEQ-NO.
 13836
 13837 3600-READ-TRAILER.
 13838
 13839
 13840* EXEC CICS HANDLE CONDITION
 13841*         NOTFND(3600-CONTINUE)
 13842*    END-EXEC.
 13843*    MOVE '"$I                   ! - #00013061' TO DFHEIV0
 13844     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13846     MOVE X'2D20233030303133303631' TO DFHEIV0(25:11)
 13847     CALL 'kxdfhei1' USING DFHEIV0
 13848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13849
 13850
 13851     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13852
 13853 3600-CONTINUE.
 13854
 13855     IF PI-VFY-2ND-BENE = 'Y'
 13856       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 13857         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 13858           MOVE ER-7576            TO EMI-ERROR
 13859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13860           MOVE -1                 TO PAYEEL
 13861           MOVE AL-UABON           TO PAYEEA
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 266
* EL156.cbl
 13862           GO TO 3600-EXIT
 13863         END-IF
 13864       END-IF
 13865     END-IF.
 13866
 13867     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 13868     MOVE 1 TO WS-SUB2
 13869     MOVE SPACES TO WS-PAYEE-NAME
 13870     PERFORM VARYING WS-SUB FROM 1 BY 1
 13871             UNTIL WS-SUB > 30
 13872         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13873            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13874                 WS-PAYEE-NAME-X (WS-SUB2)
 13875            ADD +1 TO WS-SUB2
 13876         END-IF
 13877     END-PERFORM.
 13878
 13879     STRING CL-INSURED-1ST-NAME
 13880            CL-INSURED-MID-INIT
 13881            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 13882     MOVE 1 TO WS-SUB2
 13883     MOVE SPACES TO WS-INSURED-NAME
 13884     PERFORM VARYING WS-SUB FROM 1 BY 1
 13885             UNTIL WS-SUB > 30
 13886         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 13887            MOVE WS-WORK-NAME-X (WS-SUB) TO
 13888                 WS-INSURED-NAME-X (WS-SUB2)
 13889            ADD +1 TO WS-SUB2
 13890         END-IF
 13891     END-PERFORM.
 13892
 13893     IF WS-PAYEE-NAME = WS-INSURED-NAME
 13894        MOVE ER-7579            TO EMI-ERROR
 13895        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13896        MOVE -1                 TO PAYEEL
 13897        MOVE AL-UABON           TO PAYEEA
 13898     END-IF.
 13899
 13900 3600-EXIT.
 13901     EXIT.
 13902
 13903 5000-UPDATE.
 13904
 13905     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 13906
 13907     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 13908
 13909     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 13910        PI-OFFLINE = 'Y'
 13911        NEXT SENTENCE
 13912     ELSE
 13913        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 13914
 13915*    IF PI-COMPANY-ID = 'CRI'
 13916*       IF PI-PMTTYPE = '1' OR  '2'
 13917*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13918*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 13919*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 267
* EL156.cbl
 13920
 13921*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 13922*       IF PI-PMTTYPE = '1'
 13923*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13924*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 13925
 13926     IF PI-PMTTYPE      = '2' AND
 13927        PI-SPLIT-PMT-SW = 'Y' AND
 13928        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 13929          MOVE ER-3530                TO EMI-ERROR
 13930          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13931
 13932     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13933        AND (CL-CLAIM-TYPE = 'L')
 13934        IF PI-PMTTYPE = '2' OR '4'
 13935           IF PI-INT-AMT NOT = ZEROS
 13936              PERFORM 7110-BUILD-PMT-TRLR
 13937                                 THRU 7130-EXIT
 13938           ELSE
 13939              IF PI-PMTTYPE = '2'
 13940                 PERFORM 7140-BUILD-NOTE-TRLR
 13941                                 THRU 7170-EXIT
 13942              END-IF
 13943           END-IF
 13944        END-IF
 13945     END-IF
 13946*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13947*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13948*            MOVE 'N'                 TO  WS-LETTER-SW.
 13949
 13950*    IF PI-COMPANY-ID = 'DMD'
 13951*        IF CL-NO-OF-PMTS-MADE = +1
 13952*                OR
 13953*           PI-PMTTYPE = '2'
 13954*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 13955
 13956     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 13957
 13958*    IF PI-COMPANY-ID = 'DMD'
 13959*       IF CL-CERT-NO (5:2) = '69' OR '70'
 13960*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 13961
 13962
 13963* EXEC CICS REWRITE
 13964*         DATASET('ELMSTR')
 13965*         FROM(CLAIM-MASTER)
 13966*     END-EXEC.
 13967     MOVE LENGTH OF
 13968      CLAIM-MASTER
 13969       TO DFHEIV11
 13970     MOVE 'ELMSTR' TO DFHEIV1
 13971*    MOVE '&& L                  %   #00013176' TO DFHEIV0
 13972     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13973     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13974     MOVE X'2020233030303133313736' TO DFHEIV0(25:11)
 13975     CALL 'kxdfhei1' USING DFHEIV0,
 13976           DFHEIV1,
 13977           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 268
* EL156.cbl
 13978           DFHEIV11,
 13979           DFHEIV99
 13980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13981
 13982
 13983     IF WS-LETTER-SW = 'N'
 13984         GO TO 5000-END-UPDATE.
 13985
 13986 5000-GENERATE-AUTO-LETTER.
 13987
 13988
 13989* EXEC CICS LINK
 13990*        PROGRAM    (LINK-1523)
 13991*        COMMAREA   (W-1523-LINKDATA)
 13992*        LENGTH     (W-1523-COMM-LENGTH)
 13993*    END-EXEC.
 13994*    MOVE '."C                   (   #00013186' TO DFHEIV0
 13995     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13997     MOVE X'2020233030303133313836' TO DFHEIV0(25:11)
 13998     CALL 'kxdfhei1' USING DFHEIV0,
 13999           LINK-1523,
 14000           W-1523-LINKDATA,
 14001           W-1523-COMM-LENGTH,
 14002           DFHEIV99,
 14003           DFHEIV99,
 14004           DFHEIV99,
 14005           DFHEIV99
 14006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14007
 14008
 14009     IF W-1523-FATAL-ERROR
 14010         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14012         MOVE ER-0802                TO  EMI-ERROR
 14013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14014
 14015     IF W-1523-ERROR-CODE = 0191
 14016         MOVE ER-0803                TO  EMI-ERROR
 14017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14018
 14019     IF PI-COMPANY-ID      = 'HAN' AND
 14020        PI-PMTTYPE         = '1'   AND
 14021        PI-3RD-PARTY-SW    = 'Y'   AND
 14022        W-1523-FORM-NUMBER = 'EOB1'
 14023           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14024           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14025           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14026           GO TO 5000-GENERATE-AUTO-LETTER.
 14027
 14028 5000-END-UPDATE.
 14029
 14030     MOVE ER-0000                TO EMI-ERROR.
 14031     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14032     GO TO 7000-SHOW-CLAIM.
 14033
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 269
* EL156.cbl
 14035 5000-MOVE-NAME.
 14036     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14037     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14038     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14039
 14040 5000-EXIT.
 14041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 270
* EL156.cbl
 14043 5300-CREATE-DMO.
 14044
 14045     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14046     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14047     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14048
 14049
 14050* EXEC CICS HANDLE CONDITION
 14051*         NOTFND   (5300-NOTE-NOT-FOUND)
 14052*    END-EXEC.
 14053*    MOVE '"$I                   ! . #00013232' TO DFHEIV0
 14054     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14055     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14056     MOVE X'2E20233030303133323332' TO DFHEIV0(25:11)
 14057     CALL 'kxdfhei1' USING DFHEIV0
 14058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14059
 14060
 14061
 14062* EXEC CICS READ
 14063*         DATASET('ERNOTE')
 14064*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14065*         RIDFLD (W-NOTE-KEY)
 14066*    END-EXEC.
 14067     MOVE 'ERNOTE' TO DFHEIV1
 14068*    MOVE '&"S        E          (   #00013236' TO DFHEIV0
 14069     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14071     MOVE X'2020233030303133323336' TO DFHEIV0(25:11)
 14072     CALL 'kxdfhei1' USING DFHEIV0,
 14073           DFHEIV1,
 14074           DFHEIV20,
 14075           DFHEIV99,
 14076           W-NOTE-KEY,
 14077           DFHEIV99,
 14078           DFHEIV99,
 14079           DFHEIV99
 14080     SET ADDRESS OF CERTIFICATE-NOTE TO
 14081         DFHEIV20
 14082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14083
 14084
 14085     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14086     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14087     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14088
 14089     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14090         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14091     ELSE
 14092         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14093
 14094     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14095     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14096     MOVE 'DLO006'               TO PGM-NAME.
 14097
 14098
 14099* EXEC CICS LINK
 14100*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 271
* EL156.cbl
 14101*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14102*        LENGTH     (DCT-RCRD-LENGTH)
 14103*    END-EXEC.
 14104*    MOVE '."C                   (   #00013255' TO DFHEIV0
 14105     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14107     MOVE X'2020233030303133323535' TO DFHEIV0(25:11)
 14108     CALL 'kxdfhei1' USING DFHEIV0,
 14109           PGM-NAME,
 14110           DCT-COMMUNICATION-AREA,
 14111           DCT-RCRD-LENGTH,
 14112           DFHEIV99,
 14113           DFHEIV99,
 14114           DFHEIV99,
 14115           DFHEIV99
 14116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14117
 14118
 14119     IF DCT-RETURN-CODE = 'OK'
 14120         GO TO 5300-CONT.
 14121
 14122     IF DCT-RETURN-CODE = '01' OR '02'
 14123         GO TO 5300-EXIT.
 14124
 14125     IF DCT-RETURN-CODE = '03'
 14126         MOVE ER-0951            TO EMI-ERROR
 14127         GO TO 5300-BAD-EXIT.
 14128
 14129     IF DCT-RETURN-CODE = '04'
 14130         MOVE ER-0946            TO EMI-ERROR
 14131         GO TO 5300-BAD-EXIT.
 14132
 14133     IF DCT-RETURN-CODE = '05'
 14134         MOVE ER-0947            TO EMI-ERROR
 14135         GO TO 5300-BAD-EXIT.
 14136
 14137     IF DCT-RETURN-CODE = '06'
 14138         MOVE ER-0921            TO EMI-ERROR
 14139         GO TO 5300-BAD-EXIT.
 14140
 14141     IF DCT-RETURN-CODE = '07'
 14142         MOVE ER-0849            TO EMI-ERROR
 14143         GO TO 5300-BAD-EXIT.
 14144
 14145     IF DCT-RETURN-CODE = '08'
 14146         MOVE ER-0948            TO EMI-ERROR
 14147         GO TO 5300-BAD-EXIT.
 14148
 14149     IF DCT-RETURN-CODE = 'N1'
 14150         MOVE ER-0950            TO EMI-ERROR
 14151         GO TO 5300-BAD-EXIT.
 14152
 14153     IF DCT-RETURN-CODE = 'E1'
 14154         MOVE ER-0974            TO EMI-ERROR
 14155         GO TO 5300-BAD-EXIT.
 14156
 14157     IF DCT-RETURN-CODE = 'E2'
 14158         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 272
* EL156.cbl
 14159         GO TO 5300-BAD-EXIT.
 14160
 14161     IF DCT-RETURN-CODE NOT = 'OK'
 14162         MOVE ER-0949            TO EMI-ERROR
 14163         GO TO 5300-BAD-EXIT.
 14164
 14165 5300-CONT.
 14166
 14167     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14168     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14169     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14170     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14171     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14172     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14173     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14174     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14175
 14176     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14177     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14178     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14179     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14180     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14181
 14182     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14183
 14184     IF PI-PMTTYPE = '2'
 14185         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14186         MOVE '4'                TO DM-CLAIM-STATUS
 14187     ELSE
 14188         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14189         MOVE '2'                TO DM-CLAIM-STATUS.
 14190
 14191     MOVE 'DLO025'               TO PGM-NAME.
 14192
 14193
 14194* EXEC CICS LINK
 14195*        PROGRAM    (PGM-NAME)
 14196*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14197*        LENGTH     (DM-DMO-LENGTH)
 14198*    END-EXEC.
 14199*    MOVE '."C                   (   #00013335' TO DFHEIV0
 14200     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14201     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14202     MOVE X'2020233030303133333335' TO DFHEIV0(25:11)
 14203     CALL 'kxdfhei1' USING DFHEIV0,
 14204           PGM-NAME,
 14205           DMO-COMMUNICATION-AREA,
 14206           DM-DMO-LENGTH,
 14207           DFHEIV99,
 14208           DFHEIV99,
 14209           DFHEIV99,
 14210           DFHEIV99
 14211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14212
 14213
 14214     IF DM-RETURN-CODE = 'OK'
 14215         GO TO 5300-EXIT.
 14216
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 273
* EL156.cbl
 14217     IF DM-RETURN-CODE = '01'
 14218         MOVE ER-8051            TO EMI-ERROR
 14219         GO TO 5300-BAD-EXIT.
 14220
 14221     IF DM-RETURN-CODE = '02'
 14222         MOVE ER-8052            TO EMI-ERROR
 14223         GO TO 5300-BAD-EXIT.
 14224
 14225     IF DM-RETURN-CODE = '03'
 14226         MOVE ER-8053            TO EMI-ERROR
 14227         GO TO 5300-BAD-EXIT.
 14228
 14229     IF DM-RETURN-CODE = '04'
 14230         MOVE ER-8054            TO EMI-ERROR
 14231         GO TO 5300-BAD-EXIT.
 14232
 14233     IF DM-RETURN-CODE = '05'
 14234         MOVE ER-8055            TO EMI-ERROR
 14235         GO TO 5300-BAD-EXIT.
 14236
 14237     IF DM-RETURN-CODE = '06'
 14238         MOVE ER-8056            TO EMI-ERROR
 14239         GO TO 5300-BAD-EXIT.
 14240
 14241     IF DM-RETURN-CODE = '07'
 14242         MOVE ER-8057            TO EMI-ERROR
 14243         GO TO 5300-BAD-EXIT.
 14244
 14245     IF DM-RETURN-CODE = '08'
 14246         MOVE ER-8058            TO EMI-ERROR
 14247         GO TO 5300-BAD-EXIT.
 14248
 14249     IF DM-RETURN-CODE = '09'
 14250         MOVE ER-8059            TO EMI-ERROR
 14251         GO TO 5300-BAD-EXIT.
 14252
 14253     IF DM-RETURN-CODE = '10'
 14254         MOVE ER-8060            TO EMI-ERROR
 14255         GO TO 5300-BAD-EXIT.
 14256
 14257     IF DM-RETURN-CODE = '11'
 14258         MOVE ER-8061            TO EMI-ERROR
 14259         GO TO 5300-BAD-EXIT.
 14260
 14261     IF DM-RETURN-CODE = '12'
 14262         MOVE ER-8062            TO EMI-ERROR
 14263         GO TO 5300-BAD-EXIT.
 14264
 14265     IF DM-RETURN-CODE = '13'
 14266         MOVE ER-8063            TO EMI-ERROR
 14267         GO TO 5300-BAD-EXIT.
 14268
 14269     IF DM-RETURN-CODE = '14'
 14270         MOVE ER-8064            TO EMI-ERROR
 14271         GO TO 5300-BAD-EXIT.
 14272
 14273     IF DM-RETURN-CODE = '15'
 14274         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 274
* EL156.cbl
 14275         GO TO 5300-BAD-EXIT.
 14276
 14277     IF DM-RETURN-CODE = '16'
 14278         MOVE ER-8154            TO EMI-ERROR
 14279         GO TO 5300-BAD-EXIT.
 14280
 14281     IF DM-RETURN-CODE = '17'
 14282         MOVE ER-8155            TO EMI-ERROR
 14283         GO TO 5300-BAD-EXIT.
 14284
 14285     IF DM-RETURN-CODE = 'N1'
 14286         MOVE ER-8152            TO EMI-ERROR
 14287         GO TO 5300-BAD-EXIT.
 14288
 14289     IF DM-RETURN-CODE = 'E1'
 14290         MOVE ER-8153            TO EMI-ERROR
 14291         GO TO 5300-BAD-EXIT.
 14292
 14293     MOVE ER-8066            TO EMI-ERROR.
 14294     GO TO 5300-BAD-EXIT.
 14295
 14296 5300-NOTE-NOT-FOUND.
 14297
 14298     MOVE ER-0954                TO EMI-ERROR.
 14299     GO TO 5300-BAD-EXIT.
 14300
 14301 5300-BAD-EXIT.
 14302
 14303* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14304*    MOVE '6"R                   !   #00013429' TO DFHEIV0
 14305     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14307     MOVE X'2020233030303133343239' TO DFHEIV0(25:11)
 14308     CALL 'kxdfhei1' USING DFHEIV0
 14309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14310
 14311     IF MAP-NAME = 'EL156A'
 14312         MOVE -1             TO ENTERPFL
 14313       ELSE
 14314         MOVE LOW-VALUES     TO EL156BI
 14315         MOVE -1             TO ENTPFBL.
 14316
 14317     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14318     GO TO 8200-SEND-DATAONLY.
 14319
 14320 5300-EXIT.
 14321     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 275
* EL156.cbl
 14323 5350-FORMAT-LAST-NAME-1ST.
 14324*****************************************************************
 14325*             M O V E   N A M E   R O U T I N E                 *
 14326*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14327*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14328*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14329*                  FIELD                   VALUE                *
 14330*           W-NAME-LAST    (CL15)      SMITH                    *
 14331*           W-NAME-FIRST   (CL15)      JOHN                     *
 14332*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14333*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14334*     CONTAIN                                                   *
 14335*                SMITH, JOHN ALLEN                              *
 14336*     OR                                                        *
 14337*                SMITH, JOHN A.                                 *
 14338*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14339*     COPYBOOK, ELCNWA.                                         *
 14340*****************************************************************.
 14341
 14342     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14343     MOVE ZERO                   TO  WS-NAME-SW.
 14344     SET NWA-INDEX               TO +1.
 14345
 14346     IF W-NAME-LAST   = SPACES AND
 14347        W-NAME-MIDDLE = SPACES
 14348         MOVE +1                 TO WS-NAME-SW.
 14349
 14350     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14351     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14352
 14353     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14354     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14355
 14356     SET NWA-INDEX UP BY +1.
 14357
 14358     IF W-NAME-MIDDLE NOT = SPACES
 14359         IF W-NAME-MIDDLE-2 = SPACES
 14360             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14361             SET NWA-INDEX UP BY +1
 14362             MOVE '.'            TO WS-NW (NWA-INDEX)
 14363             SET NWA-INDEX UP BY +2
 14364         ELSE
 14365             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14366             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14367
 14368 5350-EXIT.
 14369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 276
* EL156.cbl
 14371 5360-MOVE-NAME.
 14372
 14373     IF WS-NAME-SW > +1
 14374         GO TO 5360-EXIT.
 14375
 14376     IF WS-NAME-WORK2 = SPACES
 14377         GO TO 5360-EXIT.
 14378
 14379     SET NWA-INDEX2            TO +1.
 14380     SET NWA-INDEX3            TO +2.
 14381
 14382 5360-MOVE-NAME-CYCLE.
 14383
 14384     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14385
 14386     IF NWA-INDEX < +30
 14387         SET NWA-INDEX UP BY +1
 14388     ELSE
 14389         ADD +2                TO  WS-NAME-SW
 14390         GO TO 5360-EXIT.
 14391
 14392     IF NWA-INDEX2 < +20
 14393         SET NWA-INDEX3 UP BY +1
 14394         SET NWA-INDEX2 UP BY +1.
 14395
 14396     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14397        WS-NW2 (NWA-INDEX3) = SPACES
 14398         IF WS-NAME-SW = ZERO
 14399             MOVE ','            TO  WS-NW (NWA-INDEX)
 14400             SET NWA-INDEX UP BY +2
 14401             MOVE +1             TO  WS-NAME-SW
 14402             GO TO 5360-EXIT
 14403         ELSE
 14404             GO TO 5360-EXIT.
 14405
 14406     GO TO 5360-MOVE-NAME-CYCLE.
 14407
 14408 5360-EXIT.
 14409     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 277
* EL156.cbl
 14411 6000-BUILD-SCREEN-B.
 14412     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14413     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14414     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14415     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14416
 14417     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14418
 14419 6050-BUILD-SCREEN.
 14420     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14421     MOVE LOW-VALUES             TO EL156BI.
 14422     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14423
 14424     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14425
 14426     IF PI-PAYEE-TYPE = 'I'
 14427        GO TO 6060-READ-TRAILER.
 14428
 14429     IF PI-PAYEE-TYPE = 'B'
 14430        ADD +10                  TO TRLR-SEQ-NO
 14431        GO TO 6060-READ-TRAILER.
 14432
 14433     IF PI-PAYEE-TYPE = 'A'
 14434        ADD +20                  TO TRLR-SEQ-NO
 14435        GO TO 6060-READ-TRAILER.
 14436
 14437     IF PI-PAYEE-TYPE = 'O'
 14438        ADD +50                  TO TRLR-SEQ-NO
 14439        GO TO 6060-READ-TRAILER.
 14440
 14441     IF PI-PAYEE-TYPE = 'Q'
 14442        ADD +60                  TO TRLR-SEQ-NO
 14443        GO TO 6060-READ-TRAILER.
 14444
 14445     IF PI-PAYEE-TYPE = 'P'
 14446        ADD +30                  TO TRLR-SEQ-NO
 14447        GO TO 6060-READ-TRAILER.
 14448
 14449     IF PI-PAYEE-TYPE = 'E'
 14450        ADD +40                  TO TRLR-SEQ-NO.
 14451
 14452 6060-READ-TRAILER.
 14453
 14454     IF PI-PAYEE-TYPE    = 'A' AND
 14455        PI-PAYEE-SEQ-NUM = 0
 14456          GO TO 6061-READ-ACCOUNT.
 14457
 14458     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14459        (PI-PAYEE-TYPE    = 'B')             AND
 14460        (PI-PAYEE-SEQ-NUM = 9)
 14461          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14462          IF BENE-FOUND-SW = 'N'
 14463            GO TO 6065-NOT-FOUND
 14464          ELSE
 14465            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14466            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14467            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14468*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 278
* EL156.cbl
 14469            STRING BE-CITY ' ' BE-STATE
 14470               DELIMITED BY '  ' INTO CITYSTBO
 14471            END-STRING
 14472            MOVE BE-ZIP-CODE       TO ZIPBO
 14473            GO TO 6061-READ-ACCOUNT.
 14474
 14475     IF PI-PAYEE-TYPE    = 'B' AND
 14476        PI-PAYEE-SEQ-NUM = 0
 14477          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14478          IF BENE-FOUND-SW = 'N'
 14479            GO TO 6065-NOT-FOUND
 14480          ELSE
 14481            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14482            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14483            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14484*           MOVE BE-CITY-STATE     TO CITYSTBO
 14485            STRING BE-CITY ' ' BE-STATE
 14486               DELIMITED BY '  ' INTO CITYSTBO
 14487            END-STRING
 14488            MOVE BE-ZIP-CODE       TO ZIPBO
 14489            GO TO 6061-READ-ACCOUNT.
 14490
 14491
 14492* EXEC CICS HANDLE CONDITION
 14493*         NOTFND(6065-NOT-FOUND)
 14494*     END-EXEC.
 14495*    MOVE '"$I                   ! / #00013610' TO DFHEIV0
 14496     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14498     MOVE X'2F20233030303133363130' TO DFHEIV0(25:11)
 14499     CALL 'kxdfhei1' USING DFHEIV0
 14500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14501
 14502
 14503     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14504
 14505     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14506     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14507     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14508     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14509*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14510     STRING AT-CITY ' ' AT-STATE
 14511        DELIMITED BY '  ' INTO CITYSTBO
 14512     END-STRING
 14513     MOVE AT-ZIP-CODE            TO ZIPBO.
 14514
 14515 6061-READ-ACCOUNT.
 14516
 14517* EXEC CICS HANDLE CONDITION
 14518*         NOTFND(6068-ACCT-NOT-FND)
 14519*     END-EXEC.
 14520*    MOVE '"$I                   ! 0 #00013627' TO DFHEIV0
 14521     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14523     MOVE X'3020233030303133363237' TO DFHEIV0(25:11)
 14524     CALL 'kxdfhei1' USING DFHEIV0
 14525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14526
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 279
* EL156.cbl
 14527
 14528
 14529* EXEC CICS READ
 14530*         DATASET('ERACCT')
 14531*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14532*         RIDFLD (PI-ACCT-KEY)
 14533*     END-EXEC.
 14534     MOVE 'ERACCT' TO DFHEIV1
 14535*    MOVE '&"S        E          (   #00013631' TO DFHEIV0
 14536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14538     MOVE X'2020233030303133363331' TO DFHEIV0(25:11)
 14539     CALL 'kxdfhei1' USING DFHEIV0,
 14540           DFHEIV1,
 14541           DFHEIV20,
 14542           DFHEIV99,
 14543           PI-ACCT-KEY,
 14544           DFHEIV99,
 14545           DFHEIV99,
 14546           DFHEIV99
 14547     SET ADDRESS OF ACCOUNT-MASTER TO
 14548         DFHEIV20
 14549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14550
 14551
 14552     MOVE AM-CARRIER             TO ACARRBO.
 14553     MOVE AM-GROUPING            TO GROUPBO.
 14554     MOVE AM-STATE               TO STATEBO.
 14555     MOVE AM-ACCOUNT             TO ACCTBO.
 14556     MOVE AM-NAME                TO ACCTNMBO.
 14557
 14558     IF PI-PAYEE-TYPE = 'A' AND
 14559        PI-PAYEE-SEQ-NUM = 0
 14560          MOVE AM-NAME             TO NAMEBO
 14561                                      PI-PAYEE-NAME
 14562          MOVE AM-ADDRS            TO ADDR1BO
 14563          MOVE SPACES              TO ADDR2BO
 14564*         MOVE AM-CITY             TO CITYSTBO
 14565          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14566             DELIMITED BY '  ' INTO CITYSTBO
 14567          END-STRING
 14568          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14569          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14570          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14571          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14572
 14573     IF CITYSTBO EQUAL SPACES
 14574         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14575         GO TO 6070-FORMAT-DATA
 14576     END-IF.
 14577
 14578     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14579     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14580     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14581     PERFORM VARYING WS-SUB FROM 30 BY -1
 14582          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14583        IF WS-END-SUB = 0  AND
 14584           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 280
* EL156.cbl
 14585              OR LOW-VALUES  OR '.')
 14586            CONTINUE
 14587        ELSE
 14588            IF WS-END-SUB = 0
 14589                MOVE WS-SUB TO WS-END-SUB
 14590            ELSE
 14591                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14592                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14593                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14594                END-IF
 14595            END-IF
 14596        END-IF
 14597        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14598            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14599            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14600        END-IF
 14601     END-PERFORM.
 14602
 14603     IF WS-BEG-SUB > 0
 14604         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14605         IF WS-STATE-LENGTH = 2
 14606             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14607                  TO PI-CHECK-STATE-FOR-AK
 14608         ELSE
 14609             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14610                'ALASKA'
 14611                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14612             ELSE
 14613                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14614             END-IF
 14615         END-IF
 14616     ELSE
 14617         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14618     END-IF.
 14619
 14620     GO TO 6070-FORMAT-DATA.
 14621
 14622 6065-NOT-FOUND.
 14623     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14624     GO TO 6061-READ-ACCOUNT.
 14625
 14626 6068-ACCT-NOT-FND.
 14627     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14628
 14629 6070-FORMAT-DATA.
 14630     IF PI-HOLDTIL = ZEROS
 14631        MOVE SAVE-DATE           TO PAYDTBI
 14632       ELSE
 14633        MOVE PI-HOLDTIL          TO PAYDTBO
 14634        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14635
 14636     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14637     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14638
 14639     IF EIBAID = DFHPF3 OR DFHPF4
 14640        NEXT SENTENCE
 14641     ELSE
 14642       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 281
* EL156.cbl
 14643
 14644     MOVE PI-EPYFROM          TO PYFROMBO.
 14645     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14646
 14647     IF NOT PI-USES-PAID-TO
 14648        MOVE PI-EPYTHRU          TO PYTHRUBO
 14649        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14650     ELSE
 14651        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14652        MOVE '4'              TO DC-OPTION-CODE
 14653        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14654        IF NO-CONVERSION-ERROR
 14655           MOVE +1            TO DC-ELAPSED-DAYS
 14656           MOVE +0            TO DC-ELAPSED-MONTHS
 14657           MOVE '6'           TO DC-OPTION-CODE
 14658           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14659           IF NO-CONVERSION-ERROR
 14660              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14661
 14662     MOVE PI-EDAYS            TO DAYSBO.
 14663     MOVE PI-EPYAMT           TO PAYAMTBO.
 14664     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14665        IF PI-INT-AMT > ZEROS
 14666           MOVE PI-INT-AMT       TO INTAMTBO
 14667        END-IF
 14668     END-IF
 14669     GO TO 6072-SET-TYPE.
 14670
 14671 6071-CONTINUE.
 14672
 14673     IF PI-CPYFROM NOT = LOW-VALUES
 14674        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14675        MOVE SPACES              TO DC-OPTION-CODE
 14676        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14677        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14678
 14679     IF PI-CPYTHRU NOT = LOW-VALUES
 14680        IF NOT PI-USES-PAID-TO
 14681           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14682           MOVE SPACES             TO DC-OPTION-CODE
 14683           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14684           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14685        ELSE
 14686           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14687           MOVE '6'                TO DC-OPTION-CODE
 14688           MOVE +1                 TO DC-ELAPSED-DAYS
 14689           MOVE +0                 TO DC-ELAPSED-MONTHS
 14690           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14691           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14692
 14693     MOVE PI-CDAYS               TO DAYSBO.
 14694     MOVE PI-CPYAMT              TO PAYAMTBO.
 14695     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14696        IF PI-INT-AMT > ZEROS
 14697           MOVE PI-INT-AMT       TO INTAMTBO
 14698        END-IF
 14699     END-IF
 14700     .
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 282
* EL156.cbl
 14701 6072-SET-TYPE.
 14702     IF PI-PMTTYPE = '1'
 14703        MOVE 'PARTIAL'           TO PAYTYPBO.
 14704
 14705     IF PI-PMTTYPE = '2'
 14706        MOVE 'FINAL'             TO PAYTYPBO.
 14707
 14708     IF PI-PMTTYPE = '3'
 14709        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14710
 14711     IF PI-PMTTYPE = '4'
 14712        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14713
 14714     IF PI-PMTTYPE = '5'
 14715        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14716
 14717     IF PI-PMTTYPE = '6'
 14718        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14719
 14720     IF PI-PROV-PMT
 14721        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14722
 14723     IF PI-ECHECKNO NOT = SPACES
 14724        MOVE PI-ECHECKNO         TO CKNUMBO
 14725     ELSE
 14726        MOVE PI-CCHECKNO         TO CKNUMBO.
 14727
 14728     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14729        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14730        MOVE +91                 TO  TRLR-SEQ-NO
 14731
 14732* EXEC CICS READ
 14733*           DATASET  ('ELTRLR')
 14734*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14735*           RIDFLD   (ELTRLR-KEY)
 14736*           RESP     (WS-RESPONSE)
 14737*       END-EXEC
 14738     MOVE 'ELTRLR' TO DFHEIV1
 14739*    MOVE '&"S        E          (  N#00013816' TO DFHEIV0
 14740     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14742     MOVE X'204E233030303133383136' TO DFHEIV0(25:11)
 14743     CALL 'kxdfhei1' USING DFHEIV0,
 14744           DFHEIV1,
 14745           DFHEIV20,
 14746           DFHEIV99,
 14747           ELTRLR-KEY,
 14748           DFHEIV99,
 14749           DFHEIV99,
 14750           DFHEIV99
 14751     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14752         DFHEIV20
 14753     MOVE EIBRESP  TO WS-RESPONSE
 14754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14755
 14756        IF WS-RESP-NORMAL
 14757           MOVE AT-INFO-LINE-1   TO  LOANNBO
 14758        ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 283
* EL156.cbl
 14759           MOVE SPACES           TO  LOANNBO
 14760        END-IF
 14761     END-IF
 14762
 14763*       MOVE PI-LOAN-NO          TO LOANNBO
 14764
 14765     IF CKNUMBO = SPACES
 14766         MOVE SPACES             TO CKNUMHDO.
 14767
 14768     MOVE CL-CLAIM-NO            TO CLMNOBO.
 14769     MOVE CL-CARRIER             TO CARRBO.
 14770     MOVE CL-CERT-PRIME          TO CERTNOBO.
 14771     MOVE CL-CERT-SFX            TO SUFXBO.
 14772
 14773     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14774        EVALUATE CL-CLAIM-TYPE
 14775           WHEN 'I'
 14776              MOVE '  IU  '      TO CLMTYPBO
 14777           WHEN 'G'
 14778              MOVE ' GAP  '      TO CLMTYPBO
 14779           WHEN OTHER
 14780              MOVE PI-AH-OVERRIDE-L6
 14781                                 TO CLMTYPBO
 14782        END-EVALUATE
 14783        MOVE ZEROS               TO UNDISBO
 14784*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 14785        IF PI-PMTTYPE = '5' OR '6'
 14786           GO TO 6073-GET-NOTIFY-DATA
 14787        ELSE
 14788           MOVE PI-DAILY-RATE    TO RATEBO
 14789           GO TO 6073-GET-NOTIFY-DATA.
 14790
 14791     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 14792
 14793     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 14794        MOVE ZEROS               TO UNDISBO
 14795     ELSE
 14796        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 14797
 14798 6073-GET-NOTIFY-DATA.
 14799
 14800     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 14801
 14802     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 14803         MOVE SPACES             TO  NAMEB2O
 14804                                     ADDR1B2O
 14805                                     ADDR2B2O
 14806                                     CITYST2O
 14807                                     AGTHDGO
 14808         MOVE ZEROS              TO  ZIPB2O
 14809         GO TO 6080-SET-INCURRED.
 14810
 14811     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 14812     MOVE +29                    TO  TRLR-SEQ-NO.
 14813
 14814
 14815* EXEC CICS HANDLE CONDITION
 14816*        NOTFND   (6074-GET-COMP-DATA)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 284
* EL156.cbl
 14817*    END-EXEC.
 14818*    MOVE '"$I                   ! 1 #00013881' TO DFHEIV0
 14819     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14821     MOVE X'3120233030303133383831' TO DFHEIV0(25:11)
 14822     CALL 'kxdfhei1' USING DFHEIV0
 14823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14824
 14825
 14826     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14827
 14828     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 14829     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 14830     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 14831*    MOVE AT-CITY-STATE          TO  CITYST2O.
 14832     STRING AT-CITY ' ' AT-STATE
 14833        DELIMITED BY '  ' INTO CITYST2O
 14834     END-STRING
 14835     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 14836     GO TO 6080-SET-INCURRED.
 14837
 14838 6074-GET-COMP-DATA.
 14839
 14840     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 14841         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 14842
 14843     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 14844         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 14845                                         ADDR1B2O
 14846                                         ADDR2B2O
 14847                                         CITYST2O
 14848         MOVE ZEROS                  TO  ZIPB2O
 14849         GO TO 6080-SET-INCURRED.
 14850
 14851     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 14852     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 14853     MOVE AM-CARRIER             TO  COMP-CARRIER.
 14854     MOVE AM-GROUPING            TO  COMP-GROUP.
 14855     MOVE 'A'                    TO  COMP-TYPE.
 14856     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14857                                 TO  COMP-FIN-RESP.
 14858
 14859     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 14860         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 14861                                       'G' OR 'B'
 14862             MOVE 'G'            TO  COMP-TYPE
 14863             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 14864         ELSE
 14865             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 14866                                 TO  COMP-ACCOUNT
 14867     ELSE
 14868         MOVE 'G'                TO  COMP-TYPE
 14869         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 14870
 14871     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 14872
 14873     IF COMP-REC-FOUND
 14874         MOVE CO-ACCT-NAME       TO  NAMEB2O
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 285
* EL156.cbl
 14875         MOVE CO-ADDR-1          TO  ADDR1B2O
 14876         MOVE CO-ADDR-2          TO  ADDR2B2O
 14877*        MOVE CO-ADDR-3          TO  CITYST2O
 14878         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14879            DELIMITED BY '  ' INTO CITYST2O
 14880         END-STRING
 14881         MOVE CO-ZIP             TO  ZIPB2O
 14882     ELSE
 14883         MOVE 'NO COMP ADDRESS AVAILABLE'
 14884                                 TO  NAMEB2O
 14885                                     ADDR1B2O
 14886                                     ADDR2B2O
 14887                                     CITYST2O
 14888         MOVE ZEROS               TO ZIPB2O.
 14889
 14890 6080-SET-INCURRED.
 14891     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14892     MOVE SPACES                 TO DC-OPTION-CODE.
 14893     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14894     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 14895     MOVE PI-PROCESSOR-ID        TO BYBO.
 14896     MOVE MAP-NAMEB              TO MAP-NAME.
 14897     MOVE 'C'                    TO PI-PASS-SW.
 14898     MOVE EIBAID                 TO PI-PFKEY-USED.
 14899     MOVE -1                     TO ENTPFBL.
 14900     GO TO 8100-SEND-INITIAL-MAP.
 14901
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 286
* EL156.cbl
 14903 6100-BUILD-PAYMENT-TRAILER.
 14904
 14905     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 14906       (PI-COMPANY-ID = 'CID' OR 'AHL')
 14907         GO TO 6105-STATE-CHECK-NUMBER
 14908     END-IF.
 14909
 14910     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14911     MOVE '6'                    TO CNTL-REC-TYPE.
 14912
 14913     IF CONTROL-IS-ACTUAL-CARRIER
 14914         MOVE PI-CARRIER         TO WS-CARR
 14915     ELSE
 14916         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 14917
 14918     IF PI-COMPANY-ID = 'FIA'
 14919         MOVE PI-CARRIER         TO  WS-CARR.
 14920
 14921     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 14922     MOVE 0                      TO CNTL-SEQ-NO.
 14923     MOVE 'CARR'                 TO FILE-SWITCH.
 14924
 14925     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14926
 14927     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14928         IF PI-OFFLINE     = 'Y' AND
 14929            PI-ECHECKNO-CR = 'CR'
 14930              GO TO 6110-READ-CONTROL
 14931         ELSE
 14932            IF PI-CASH = 'N'
 14933                GO TO 6110-READ-CONTROL.
 14934
 14935     IF CHECK-NO-MANUAL    OR
 14936        CHECK-NO-AT-PRINT  OR
 14937        PI-OFFLINE = 'Y'
 14938          GO TO 6130-BUILD-TRAILER.
 14939
 14940     IF PI-COMPANY-ID = 'FIA'
 14941         NEXT SENTENCE
 14942     ELSE
 14943         IF NOT CONTROL-IS-ACTUAL-CARRIER
 14944             GO TO 6110-READ-CONTROL.
 14945
 14946     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14947
 14948     IF CHECK-CNT-RESET-VALUE
 14949        MOVE +1                  TO CF-CHECK-COUNTER
 14950     ELSE
 14951        ADD +1                   TO CF-CHECK-COUNTER.
 14952
 14953     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 14954
 14955     IF CHECK-NO-CARR-SEQ
 14956        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 14957
 14958     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 14959
 14960     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 287
* EL156.cbl
 14961     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 14962        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 14963         MOVE 'Y' TO PI-REAUDIT-NEEDED
 14964         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 14965            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 14966         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 14967                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 14968     END-IF.
 14969
 14970     GO TO 6120-REWRITE.
 14971
 14972 6105-STATE-CHECK-NUMBER.
 14973     IF CHECK-NO-MANUAL    OR
 14974        CHECK-NO-AT-PRINT  OR
 14975        PI-OFFLINE = 'Y'
 14976           GO TO 6130-BUILD-TRAILER
 14977     END-IF.
 14978
 14979     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 14980     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 14981     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 14982     MOVE '3'                TO CNTL-REC-TYPE.
 14983     MOVE +0                 TO CNTL-SEQ-NO.
 14984     MOVE 'STAT'             TO FILE-SWITCH.
 14985     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 14986
 14987     IF CF-ST-CHECK-CNT-RESET
 14988         MOVE +1             TO CF-ST-CHECK-COUNTER
 14989     ELSE
 14990         ADD +1              TO CF-ST-CHECK-COUNTER
 14991     END-IF.
 14992
 14993     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 14994     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 14995     GO TO 6120-REWRITE.
 14996
 14997 6110-READ-CONTROL.
 14998     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14999     MOVE '1'                    TO CNTL-REC-TYPE.
 15000     MOVE SPACES                 TO CNTL-ACCESS.
 15001     MOVE 0                      TO CNTL-SEQ-NO.
 15002
 15003     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15004
 15005     IF CO-CHECK-COUNT-RESET
 15006        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15007     ELSE
 15008        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15009
 15010     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15011
 15012     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15013         IF PI-OFFLINE     = 'Y'  AND
 15014            PI-ECHECKNO-CR = 'CR'
 15015              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15016              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15017              MOVE AL-UANON           TO CHECKNOA
 15018              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 288
* EL156.cbl
 15019         ELSE
 15020         IF PI-CASH = 'N'
 15021             MOVE 'N'                TO PI-ECHECKNO-N
 15022             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15023             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15024             MOVE AL-UANON           TO CHECKNOA
 15025             GO TO 6120-REWRITE.
 15026
 15027     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15028
 15029 6120-REWRITE.
 15030
 15031* EXEC CICS REWRITE
 15032*         DATASET('ELCNTL')
 15033*         FROM(CONTROL-FILE)
 15034*     END-EXEC.
 15035     MOVE LENGTH OF
 15036      CONTROL-FILE
 15037       TO DFHEIV11
 15038     MOVE 'ELCNTL' TO DFHEIV1
 15039*    MOVE '&& L                  %   #00014089' TO DFHEIV0
 15040     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15041     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15042     MOVE X'2020233030303134303839' TO DFHEIV0(25:11)
 15043     CALL 'kxdfhei1' USING DFHEIV0,
 15044           DFHEIV1,
 15045           CONTROL-FILE,
 15046           DFHEIV11,
 15047           DFHEIV99
 15048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15049
 15050
 15051     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15052
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 289
* EL156.cbl
 15054 6130-BUILD-TRAILER.
 15055
 15056
 15057* EXEC CICS GETMAIN
 15058*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15059*         LENGTH    (200)
 15060*         INITIMG   (GETMAIN-SPACE)
 15061*     END-EXEC.
 15062     MOVE 200
 15063       TO DFHEIV11
 15064*    MOVE ',"IL                  $   #00014099' TO DFHEIV0
 15065     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15066     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15067     MOVE X'2020233030303134303939' TO DFHEIV0(25:11)
 15068     CALL 'kxdfhei1' USING DFHEIV0,
 15069           DFHEIV20,
 15070           DFHEIV11,
 15071           GETMAIN-SPACE
 15072     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15073         DFHEIV20
 15074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15075
 15076
 15077     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15078                                    AT-PREV-PAID-THRU-DT.
 15079     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15080     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15081     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15082     MOVE 'AT'                   TO AT-RECORD-ID.
 15083     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15084
 15085     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15086        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15087           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15088     ELSE
 15089           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15090           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15091
 15092     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15093         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15094             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15095             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15096           ELSE
 15097             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15098             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15099
 15100     MOVE '2'                    TO AT-TRAILER-TYPE.
 15101     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15102                                    AT-PAYMENT-LAST-MAINT-DT.
 15103     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15104                                    AT-PAYMENT-LAST-UPDATED-BY.
 15105     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15106     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15107     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15108     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15109
 15110     IF PI-PMT-APPROVED
 15111        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 290
* EL156.cbl
 15112           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15113
 15114     IF PI-PFKEY-USED = DFHPF5
 15115        GO TO 6140-PF5-ENTERED.
 15116
 15117     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15118     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15119
 15120     IF PI-AIG-SPECIAL-BENEFIT
 15121         IF WS-1ST-SPECIAL-PMT
 15122             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15123             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15124                                        AT-AMOUNT-PAID
 15125         ELSE
 15126             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15127
 15128     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15129
 15130     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15131     MOVE '4'                    TO DC-OPTION-CODE.
 15132     PERFORM 9700-LINK-DATE-CONVERT.
 15133
 15134     IF DATE-CONVERSION-ERROR
 15135        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15136     ELSE
 15137        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15138
 15139     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15140     MOVE '4'                    TO DC-OPTION-CODE.
 15141     PERFORM 9700-LINK-DATE-CONVERT.
 15142
 15143     IF DATE-CONVERSION-ERROR
 15144        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15145     ELSE
 15146        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15147
 15148     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15149     GO TO 6150-FINISH-MOVE.
 15150
 15151 6140-PF5-ENTERED.
 15152     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15153     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15154
 15155     IF PI-AIG-SPECIAL-BENEFIT
 15156         IF WS-1ST-SPECIAL-PMT
 15157             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15158             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15159                                        AT-AMOUNT-PAID
 15160         ELSE
 15161             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15162
 15163     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15164     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15165     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15166
 15167 6150-FINISH-MOVE.
 15168
 15169     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 291
* EL156.cbl
 15170         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15171     ELSE
 15172         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15173
 15174     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15175     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15176
 15177*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15178*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15179
 15180     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15181         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15182
 15183     IF PI-OFFLINE = 'N'
 15184        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15185        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15186     ELSE
 15187        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15188        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15189
 15190     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15191
 15192     IF WS-2ND-SPECIAL-PMT
 15193         MOVE 'Y'                TO AT-CASH-PAYMENT
 15194         MOVE SPACES             TO AT-CHECK-NO
 15195         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15196         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15197         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15198         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15199
 15200     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15201                                    AT-TO-BE-WRITTEN-DT.
 15202
 15203     IF PI-HOLDTIL NOT = ZEROS
 15204        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15205        MOVE '4'                 TO DC-OPTION-CODE
 15206        PERFORM 9700-LINK-DATE-CONVERT
 15207        IF PI-OFFLINE = 'N'
 15208           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15209        ELSE
 15210           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15211
 15212     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15213     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15214                                    AT-CHECK-QUE-SEQUENCE.
 15215
 15216     IF PI-PFKEY-USED = DFHPF4
 15217        MOVE '1'                 TO AT-FORCE-CONTROL.
 15218
 15219     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15220        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15221        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15222        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15223
 15224     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15225                                    AT-VOID-SELECT-DT
 15226                                    AT-VOID-ACCEPT-DT
 15227                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 292
* EL156.cbl
 15228     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15229        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15230        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15231        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15232        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15233     ELSE
 15234        MOVE ZEROS               TO AT-DAILY-RATE
 15235                                    AT-ELIMINATION-DAYS
 15236        MOVE SPACES              TO AT-BENEFIT-TYPE
 15237     END-IF
 15238     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15239     MOVE '4'                    TO DC-OPTION-CODE.
 15240     PERFORM 9700-LINK-DATE-CONVERT.
 15241     IF DATE-CONVERSION-ERROR
 15242         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15243     ELSE
 15244         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15245     END-IF.
 15246     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15247     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15248     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15249     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15250     IF PI-REAUDIT-NEEDED = 'Y'
 15251         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15252         MOVE 'Y' TO WS-NEED-APPROVAL
 15253         GO TO 6170-WRITE
 15254     END-IF.
 15255*******************************************************
 15256     IF NOT PI-PMT-GRADUATED
 15257         GO TO 6170-WRITE.
 15258
 15259     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15260     MOVE '1'                    TO CNTL-REC-TYPE.
 15261     MOVE SPACES                 TO CNTL-ACCESS.
 15262     MOVE +0                     TO CNTL-SEQ-NO.
 15263     MOVE 'COMP'                 TO FILE-SWITCH.
 15264
 15265     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15266
 15267     IF PAID-FOR-LIFE
 15268         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15269             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15270                                     WS-PMT-APPROVAL-SW
 15271             GO TO 6170-WRITE.
 15272
 15273*05999      IF PAID-FOR-AH
 15274     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15275         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15276             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15277                                     WS-PMT-APPROVAL-SW
 15278             GO TO 6170-WRITE.
 15279
 15280     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15281
 15282******A&H Limits are set as a monthly payment.  Calculate the mont
 15283******equivalent of the amount paid today
 15284     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15285        PI-SAVE-ODD-DAYS-OVER > 0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 293
* EL156.cbl
 15286           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15287                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15288           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15289                                  WS-CALC-PMT-MONTHS
 15290     ELSE
 15291           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15292     END-IF.
 15293*06007      IF ((PAID-FOR-AH) AND
 15294     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15295*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15296        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15297              OR
 15298        ((PAID-FOR-LIFE) AND
 15299        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15300            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15301       ELSE
 15302*06014      IF ((PAID-FOR-AH)  AND
 15303         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15304*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15305           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15306              OR
 15307        ((PAID-FOR-LIFE) AND
 15308        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15309            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15310         ELSE
 15311*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15312           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15313               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15314              OR
 15315          ((PAID-FOR-LIFE) AND
 15316          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15317            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15318       ELSE
 15319           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15320               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15321              OR
 15322          ((PAID-FOR-LIFE) AND
 15323          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15324            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15325       ELSE
 15326            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15327
 15328     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15329        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15330        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15331            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15332        END-IF
 15333     ELSE
 15334     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15335        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15336        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15337            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15338        END-IF
 15339     ELSE
 15340     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15341        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15342        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15343            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 294
* EL156.cbl
 15344        END-IF
 15345     ELSE
 15346     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15347        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15348        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15349            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15350        END-IF
 15351     ELSE
 15352     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15353            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15354
 15355     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15356
 15357     IF NOT PI-PMT-GRADUATED
 15358         GO TO 6170-WRITE.
 15359
 15360
 15361* EXEC CICS HANDLE CONDITION
 15362*        NOTFND   (6170-WRITE)
 15363*    END-EXEC.
 15364*    MOVE '"$I                   ! 2 #00014388' TO DFHEIV0
 15365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15367     MOVE X'3220233030303134333838' TO DFHEIV0(25:11)
 15368     CALL 'kxdfhei1' USING DFHEIV0
 15369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15370
 15371
 15372     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15373     MOVE '2'                    TO CNTL-REC-TYPE.
 15374     MOVE +0                     TO CNTL-SEQ-NO.
 15375     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15376
 15377
 15378* EXEC CICS READ
 15379*         DATASET  ('ELCNTL')
 15380*         SET      (ADDRESS OF CONTROL-FILE)
 15381*         RIDFLD   (ELCNTL-KEY)
 15382*    END-EXEC.
 15383     MOVE 'ELCNTL' TO DFHEIV1
 15384*    MOVE '&"S        E          (   #00014397' TO DFHEIV0
 15385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15386     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15387     MOVE X'2020233030303134333937' TO DFHEIV0(25:11)
 15388     CALL 'kxdfhei1' USING DFHEIV0,
 15389           DFHEIV1,
 15390           DFHEIV20,
 15391           DFHEIV99,
 15392           ELCNTL-KEY,
 15393           DFHEIV99,
 15394           DFHEIV99,
 15395           DFHEIV99
 15396     SET ADDRESS OF CONTROL-FILE TO
 15397         DFHEIV20
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15399
 15400
 15401     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 295
* EL156.cbl
 15402
 15403     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15404                         OR '4' OR '5'
 15405         NEXT SENTENCE
 15406     ELSE
 15407         MOVE 'Y' TO WS-NEED-APPROVAL
 15408         GO TO 6170-WRITE.
 15409
 15410     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15411         MOVE 'Y' TO WS-NEED-APPROVAL
 15412         IF WS-APPROVAL-LEVEL = '1'
 15413             MOVE '2'        TO  AT-APPROVED-LEVEL
 15414                            WS-SAVE-APPROVED-LEVEL
 15415             GO TO 6170-WRITE
 15416         ELSE
 15417             IF WS-APPROVAL-LEVEL = '2'
 15418                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15419                                WS-SAVE-APPROVED-LEVEL
 15420                 GO TO 6170-WRITE
 15421             ELSE IF WS-APPROVAL-LEVEL = '3'
 15422                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15423                                WS-SAVE-APPROVED-LEVEL
 15424                 GO TO 6170-WRITE
 15425             ELSE IF WS-APPROVAL-LEVEL = '4'
 15426                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15427                                WS-SAVE-APPROVED-LEVEL
 15428                 GO TO 6170-WRITE.
 15429
 15430     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15431                             WS-PMT-APPROVAL-SW.
 15432     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15433                             AT-APPROVAL-LEVEL-REQD.
 15434
 15435*******************************************************
 15436
 15437 6170-WRITE.
 15438
 15439     if pi-company-id = 'DCC'
 15440        MOVE ' '                 TO WS-PDEF-RECORD-SW
 15441        PERFORM 0900-GET-DDF-FACTORS
 15442                                 THRU 0900-EXIT
 15443     end-if
 15444    perform 2220-update-elcrtt   thru 2220-exit
 15445     IF PI-COMPANY-ID = 'DMD'
 15446        IF PI-AT-EOB-CODES NOT = SPACES
 15447           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15448           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15449           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15450           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15451           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15452
 15453
 15454* EXEC CICS HANDLE CONDITION
 15455*        DUPREC    (6180-DUPREC)
 15456*    END-EXEC.
 15457*    MOVE '"$%                   ! 3 #00014455' TO DFHEIV0
 15458     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 296
* EL156.cbl
 15460     MOVE X'3320233030303134343535' TO DFHEIV0(25:11)
 15461     CALL 'kxdfhei1' USING DFHEIV0
 15462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15463
 15464
 15465
 15466* EXEC CICS WRITE
 15467*         DATASET       ('ELTRLR')
 15468*         FROM          (ACTIVITY-TRAILERS)
 15469*         RIDFLD        (AT-CONTROL-PRIMARY)
 15470*     END-EXEC.
 15471     MOVE LENGTH OF
 15472      ACTIVITY-TRAILERS
 15473       TO DFHEIV11
 15474     MOVE 'ELTRLR' TO DFHEIV1
 15475*    MOVE '&$ L                  ''   #00014459' TO DFHEIV0
 15476     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15478     MOVE X'2020233030303134343539' TO DFHEIV0(25:11)
 15479     CALL 'kxdfhei1' USING DFHEIV0,
 15480           DFHEIV1,
 15481           ACTIVITY-TRAILERS,
 15482           DFHEIV11,
 15483           AT-CONTROL-PRIMARY,
 15484           DFHEIV99,
 15485           DFHEIV99
 15486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15487
 15488
 15489     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15490        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15491*06088           GO TO 6199-EXIT.
 15492           GO TO 6176-APPROVAL-NOTE.
 15493
 15494
 15495* EXEC CICS GETMAIN
 15496*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15497*         LENGTH    (200)
 15498*         INITIMG   (GETMAIN-SPACE)
 15499*     END-EXEC.
 15500     MOVE 200
 15501       TO DFHEIV11
 15502*    MOVE ',"IL                  $   #00014470' TO DFHEIV0
 15503     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15504     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15505     MOVE X'2020233030303134343730' TO DFHEIV0(25:11)
 15506     CALL 'kxdfhei1' USING DFHEIV0,
 15507           DFHEIV20,
 15508           DFHEIV11,
 15509           GETMAIN-SPACE
 15510     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15511         DFHEIV20
 15512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15513
 15514
 15515     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15516
 15517     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 297
* EL156.cbl
 15518     MOVE 'AT'                   TO AT-RECORD-ID.
 15519     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15520     MOVE '6'                    TO AT-TRAILER-TYPE.
 15521     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15522                                    AT-GEN-INFO-LAST-MAINT-DT
 15523     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15524                                    AT-GEN-INFO-LAST-UPDATED-BY
 15525     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15526
 15527     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15528     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15529     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15530
 15531     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15532
 15533 6175-WRITE.
 15534
 15535
 15536* EXEC CICS HANDLE CONDITION
 15537*        DUPREC    (6190-DUPREC)
 15538*    END-EXEC.
 15539*    MOVE '"$%                   ! 4 #00014496' TO DFHEIV0
 15540     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15542     MOVE X'3420233030303134343936' TO DFHEIV0(25:11)
 15543     CALL 'kxdfhei1' USING DFHEIV0
 15544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15545
 15546
 15547
 15548* EXEC CICS WRITE
 15549*         DATASET     ('ELTRLR')
 15550*         FROM        (ACTIVITY-TRAILERS)
 15551*         RIDFLD      (AT-CONTROL-PRIMARY)
 15552*     END-EXEC.
 15553     MOVE LENGTH OF
 15554      ACTIVITY-TRAILERS
 15555       TO DFHEIV11
 15556     MOVE 'ELTRLR' TO DFHEIV1
 15557*    MOVE '&$ L                  ''   #00014500' TO DFHEIV0
 15558     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15559     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15560     MOVE X'2020233030303134353030' TO DFHEIV0(25:11)
 15561     CALL 'kxdfhei1' USING DFHEIV0,
 15562           DFHEIV1,
 15563           ACTIVITY-TRAILERS,
 15564           DFHEIV11,
 15565           AT-CONTROL-PRIMARY,
 15566           DFHEIV99,
 15567           DFHEIV99
 15568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15569
 15570
 15571 6176-APPROVAL-NOTE.
 15572
 15573     IF NOT APPROVAL-NEEDED
 15574         GO TO 6199-EXIT.
 15575
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 298
* EL156.cbl
 15576
 15577* EXEC CICS GETMAIN
 15578*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15579*        LENGTH    (200)
 15580*        INITIMG   (GETMAIN-SPACE)
 15581*    END-EXEC.
 15582     MOVE 200
 15583       TO DFHEIV11
 15584*    MOVE ',"IL                  $   #00014511' TO DFHEIV0
 15585     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15587     MOVE X'2020233030303134353131' TO DFHEIV0(25:11)
 15588     CALL 'kxdfhei1' USING DFHEIV0,
 15589           DFHEIV20,
 15590           DFHEIV11,
 15591           GETMAIN-SPACE
 15592     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15593         DFHEIV20
 15594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15595
 15596
 15597     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15598
 15599     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15600     MOVE 'AT'               TO AT-RECORD-ID
 15601     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15602     MOVE '6'                TO AT-TRAILER-TYPE
 15603     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15604                                AT-GEN-INFO-LAST-MAINT-DT
 15605     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15606                                AT-GEN-INFO-LAST-UPDATED-BY
 15607     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15608
 15609     IF PI-REAUDIT-NEEDED = 'Y'
 15610         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15611     ELSE
 15612         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15613     END-IF
 15614     MOVE SPACES             TO AT-INFO-LINE-2
 15615
 15616     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15617 6177-WRITE.
 15618
 15619
 15620* EXEC CICS HANDLE CONDITION
 15621*        DUPREC    (6185-DUPREC)
 15622*    END-EXEC.
 15623*    MOVE '"$%                   ! 5 #00014539' TO DFHEIV0
 15624     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15626     MOVE X'3520233030303134353339' TO DFHEIV0(25:11)
 15627     CALL 'kxdfhei1' USING DFHEIV0
 15628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15629
 15630
 15631
 15632* EXEC CICS WRITE
 15633*         DATASET     ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 299
* EL156.cbl
 15634*         FROM        (ACTIVITY-TRAILERS)
 15635*         RIDFLD      (AT-CONTROL-PRIMARY)
 15636*     END-EXEC.
 15637     MOVE LENGTH OF
 15638      ACTIVITY-TRAILERS
 15639       TO DFHEIV11
 15640     MOVE 'ELTRLR' TO DFHEIV1
 15641*    MOVE '&$ L                  ''   #00014543' TO DFHEIV0
 15642     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15643     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15644     MOVE X'2020233030303134353433' TO DFHEIV0(25:11)
 15645     CALL 'kxdfhei1' USING DFHEIV0,
 15646           DFHEIV1,
 15647           ACTIVITY-TRAILERS,
 15648           DFHEIV11,
 15649           AT-CONTROL-PRIMARY,
 15650           DFHEIV99,
 15651           DFHEIV99
 15652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15653
 15654
 15655
 15656     GO TO 6199-EXIT.
 15657
 15658 6180-DUPREC.
 15659
 15660     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15661     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15662     GO TO 6170-WRITE.
 15663
 15664 6185-DUPREC.
 15665     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15666     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15667     GO TO 6177-WRITE.
 15668
 15669 6190-DUPREC.
 15670     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15671     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15672     GO TO 6175-WRITE.
 15673
 15674 6199-EXIT.
 15675      EXIT.
 15676
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 300
* EL156.cbl
 15678 6200-UPDATE-CLAIM-MSTR.
 15679     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15680     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15681     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15682     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15683
 15684     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15685
 15686     MOVE ZEROS                  TO W-INTEREST.
 15687
 15688     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15689        IF (PI-OFFLINE = 'Y') OR
 15690           (PI-PMTTYPE = '7')
 15691           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15692                                 THRU 9870-EXIT
 15693        END-IF
 15694     END-IF
 15695     IF NOT ERROR-ON-OUTPUT
 15696        CONTINUE
 15697     ELSE
 15698
 15699* EXEC CICS REWRITE
 15700*          DATASET('ELMSTR')
 15701*          FROM(CLAIM-MASTER)
 15702*       END-EXEC
 15703     MOVE LENGTH OF
 15704      CLAIM-MASTER
 15705       TO DFHEIV11
 15706     MOVE 'ELMSTR' TO DFHEIV1
 15707*    MOVE '&& L                  %   #00014592' TO DFHEIV0
 15708     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15709     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15710     MOVE X'2020233030303134353932' TO DFHEIV0(25:11)
 15711     CALL 'kxdfhei1' USING DFHEIV0,
 15712           DFHEIV1,
 15713           CLAIM-MASTER,
 15714           DFHEIV11,
 15715           DFHEIV99
 15716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15717
 15718        MOVE -1                  TO ENTPFBL
 15719        MOVE AL-UANON            TO ENTPFBA
 15720        MOVE MAP-NAMEB           TO MAP-NAME
 15721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15722        GO TO 8200-SEND-DATAONLY
 15723     END-IF
 15724
 15725     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15726
 15727     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15728
 15729     IF PI-AIG-SPECIAL-BENEFIT
 15730         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15731
 15732     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15733
 15734     IF PI-SPECIAL-BEN-SW = 'Y'
 15735         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 301
* EL156.cbl
 15736         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 15737
 15738     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15739         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 15740     ELSE
 15741         IF PI-PMTTYPE NOT = '4'
 15742            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 15743
 15744     IF PI-PMTTYPE = '5' OR '6'
 15745        GO TO  6250-SET-MAINT.
 15746
 15747     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 15748                                         CL-LAG-REPORT-CODE.
 15749
 15750     IF CL-ACTIVITY-CODE = 09
 15751         GO TO 6200-CONT-UPDATE.
 15752
 15753     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15754         IF CL-ACTIVITY-CODE = 11
 15755             GO TO 6200-CONT-UPDATE.
 15756
 15757     IF WS-ACT-REC-FOUND-SW = 'N'
 15758         GO TO 6200-CONT-UPDATE.
 15759
 15760     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 15761         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 15762         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 15763         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 15764
 15765     IF WS-UPDATE-SW = 'Y'
 15766         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 15767                                         CL-NEXT-FOLLOWUP-DT.
 15768
 15769 6200-CONT-UPDATE.
 15770
 15771     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15772       IF CLAIM-IS-CLOSED
 15773         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15774           IF WS-OPEN-CLOSE-SW = '2'
 15775             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 15776                                        CL-LAST-CLOSE-DT.
 15777
 15778     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 15779        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 15780        MOVE 'O'                 TO CL-CLAIM-STATUS.
 15781
 15782     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 15783        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 15784        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 15785        MOVE 'C'                 TO CL-CLAIM-STATUS
 15786        IF PI-PMTTYPE = '2'
 15787           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15788           CONTINUE
 15789        ELSE
 15790           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15791        END-IF
 15792     ELSE
 15793        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 302
* EL156.cbl
 15794           IF PI-PMTTYPE = '2' AND
 15795              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15796              CONTINUE
 15797           ELSE
 15798              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 15799           END-IF
 15800        END-IF
 15801     END-IF
 15802
 15803     IF PI-PMTTYPE = '4'
 15804        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 15805
 15806     IF PI-COMPANY-ID = 'CVL'
 15807         IF PI-LOAN-UPDATE-SW = 'Y'
 15808             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 15809             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 15810             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 15811             MOVE CL-CERT-STATE      TO  CERT-STATE
 15812             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 15813             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 15814             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 15815             MOVE 'CERT'             TO  FILE-SWITCH
 15816             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 15817             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 15818             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 15819
 15820     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 15821        GO TO 6220-USE-COMPUTED.
 15822
 15823     IF (PI-PMTTYPE = '4')  AND
 15824        (PI-EPYAMT < ZEROS)
 15825          COMPUTE CL-NO-OF-DAYS-PAID =
 15826                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 15827          IF CL-NO-OF-DAYS-PAID < +0
 15828              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15829          ELSE
 15830              NEXT SENTENCE
 15831     ELSE
 15832          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 15833
 15834     IF PI-PROCESSOR-ID = 'FIX '
 15835        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15836           NEXT SENTENCE
 15837        ELSE
 15838           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 15839     ELSE
 15840        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 15841
 15842     IF PI-PMTTYPE = '4'
 15843        GO TO 6250-SET-MAINT.
 15844
 15845     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15846
 15847     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15848     MOVE '4'                    TO DC-OPTION-CODE.
 15849     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15850     IF DATE-CONVERSION-ERROR
 15851        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 303
* EL156.cbl
 15852     ELSE
 15853        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 15854           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 15855           IF PI-AIG-SPECIAL-BENEFIT
 15856               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 15857           ELSE
 15858               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 15859
 15860     GO TO 6250-SET-MAINT.
 15861
 15862 6220-USE-COMPUTED.
 15863
 15864     IF (PI-PMTTYPE = '4')  AND
 15865        (PI-CPYAMT < ZEROS)
 15866          COMPUTE CL-NO-OF-DAYS-PAID =
 15867                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 15868          IF CL-NO-OF-DAYS-PAID < +0
 15869              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 15870          ELSE
 15871              NEXT SENTENCE
 15872     ELSE
 15873          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 15874
 15875     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 15876
 15877     IF PI-PMTTYPE = '4'
 15878        GO TO 6250-SET-MAINT.
 15879
 15880     IF PI-AIG-SPECIAL-BENEFIT
 15881         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 15882     ELSE
 15883         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 15884
 15885     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 15886
 15887     IF PI-CPYTHRU > CL-PAID-THRU-DT
 15888        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 15889
 15890 6250-SET-MAINT.
 15891     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 15892
 15893     IF PI-PROCESSOR-ID = 'FIX '
 15894        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 15895           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 15896        ELSE
 15897           NEXT SENTENCE
 15898     ELSE
 15899        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 15900
 15901     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 15902     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 15903     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 15904
 15905 6299-EXIT.
 15906      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 304
* EL156.cbl
 15908 6300-UPDATE-CERT.
 15909
 15910*  ADD CERTNOTE FOR SC NP+6
 15911     IF PI-COMPANY-ID = 'CID' AND
 15912       (PI-PMTTYPE = '2' OR '3') AND
 15913        CL-CERT-STATE = 'SC'  AND
 15914        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 15915           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15916     END-IF.
 15917
 15918     IF PI-COMPANY-ID = 'AHL' AND
 15919       (PI-PMTTYPE = '2' OR '3') AND
 15920        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 15921           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 15922           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 15923     END-IF.
 15924
 15925     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 15926     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 15927     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 15928     MOVE CL-CERT-STATE    TO CERT-STATE.
 15929     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 15930     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 15931     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 15932     MOVE 'CERT'           TO FILE-SWITCH.
 15933
 15934     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 15935
 15936     IF CERT-NOTE-ADDED
 15937        IF CM-NOTE-SW = ' '
 15938           MOVE '4'             TO CM-NOTE-SW
 15939        ELSE
 15940           IF CM-NOTE-SW = '1'
 15941               MOVE '5'           TO CM-NOTE-SW
 15942           ELSE
 15943              IF CM-NOTE-SW = '2'
 15944                 MOVE '6'         TO CM-NOTE-SW
 15945              ELSE
 15946                 IF CM-NOTE-SW = '3'
 15947                    MOVE '7'      TO CM-NOTE-SW
 15948                 END-IF
 15949              END-IF
 15950           END-IF
 15951        END-IF
 15952     END-IF.
 15953
 15954     IF PI-COMPANY-ID = 'CVL'
 15955         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 15956         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 15957
 15958     IF PI-PMTTYPE NOT = '4'
 15959        GO TO 6340-UPDATE-CERT.
 15960
 15961     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15962        IF PI-PFKEY-USED = DFHPF5
 15963           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 15964        ELSE
 15965           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 305
* EL156.cbl
 15966
 15967*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15968*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 15969*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15970*               PI-LF-COVERAGE-TYPE = 'P'
 15971*                GO TO 6350-REWRITE-CERT.
 15972
 15973     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15974       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 15975          PI-LF-COVERAGE-TYPE = 'P'
 15976           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 15977                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 15978                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 15979                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 15980                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 15981                GO TO 6350-REWRITE-CERT
 15982            ELSE
 15983                GO TO 6350-REWRITE-CERT.
 15984
 15985     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15986         GO TO 6350-REWRITE-CERT.
 15987
 15988     IF NOT CM-AH-LUMP-SUM-DISAB
 15989        GO TO 6380-UNLOCK-CERT.
 15990
 15991     IF PI-PFKEY-USED = DFHPF5
 15992        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 15993                                    CM-AH-ITD-AH-PMT
 15994        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 15995        GO TO 6350-REWRITE-CERT
 15996     ELSE
 15997        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 15998                                    CM-AH-ITD-AH-PMT
 15999        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16000        GO TO 6350-REWRITE-CERT.
 16001
 16002 6340-UPDATE-CERT.
 16003
 16004     IF CL-CLAIM-TYPE = 'L'
 16005         IF PI-PFKEY-USED = DFHPF5
 16006             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16007         ELSE
 16008             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16009
 16010     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16011         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16012             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16013                PI-LF-COVERAGE-TYPE = 'P'
 16014                 GO TO 6350-REWRITE-CERT.
 16015
 16016     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16017       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16018          PI-LF-COVERAGE-TYPE = 'P'
 16019           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16020                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16021                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16022                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16023                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 306
* EL156.cbl
 16024                GO TO 6350-REWRITE-CERT.
 16025
 16026     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16027         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16028            PI-LF-COVERAGE-TYPE NOT = 'P'
 16029             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16030             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16031             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16032             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16033             GO TO 6350-REWRITE-CERT.
 16034
 16035     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16036         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16037         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16038         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16039         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16040         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16041         IF PI-PFKEY-USED = DFHPF5
 16042             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16043                                        CM-AH-ITD-AH-PMT
 16044             GO TO 6350-REWRITE-CERT
 16045         ELSE
 16046             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16047                                        CM-AH-ITD-AH-PMT
 16048             GO TO 6350-REWRITE-CERT.
 16049
 16050 6350-REWRITE-CERT.
 16051
 16052
 16053* EXEC CICS REWRITE
 16054*         DATASET  ('ELCERT')
 16055*         FROM(CERTIFICATE-MASTER)
 16056*     END-EXEC.
 16057     MOVE LENGTH OF
 16058      CERTIFICATE-MASTER
 16059       TO DFHEIV11
 16060     MOVE 'ELCERT' TO DFHEIV1
 16061*    MOVE '&& L                  %   #00014931' TO DFHEIV0
 16062     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16063     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16064     MOVE X'2020233030303134393331' TO DFHEIV0(25:11)
 16065     CALL 'kxdfhei1' USING DFHEIV0,
 16066           DFHEIV1,
 16067           CERTIFICATE-MASTER,
 16068           DFHEIV11,
 16069           DFHEIV99
 16070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16071
 16072
 16073     GO TO 6399-EXIT.
 16074
 16075 6380-UNLOCK-CERT.
 16076
 16077* EXEC CICS UNLOCK
 16078*         DATASET  ('ELCERT')
 16079*     END-EXEC.
 16080     MOVE 'ELCERT' TO DFHEIV1
 16081*    MOVE '&*                    #   #00014939' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 307
* EL156.cbl
 16082     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16083     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16084     MOVE X'2020233030303134393339' TO DFHEIV0(25:11)
 16085     CALL 'kxdfhei1' USING DFHEIV0,
 16086           DFHEIV1,
 16087           DFHEIV99
 16088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16089
 16090
 16091 6399-EXIT.
 16092      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 308
* EL156.cbl
 16094 6400-UPDATE-ZERO-TRAILER.
 16095     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16096     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16097
 16098     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16099
 16100     IF PI-EPYAMT NOT = ZEROS
 16101         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16102     ELSE
 16103         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16104
 16105     IF PI-ERESV NOT = ZEROS
 16106        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16107
 16108     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16109        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16110
 16111     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16112        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16113     ELSE
 16114        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16115
 16116     IF PI-PMTTYPE = '5'
 16117        IF PI-EPYAMT = ZEROS
 16118           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16119        ELSE
 16120           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16121
 16122     IF PI-PMTTYPE = '6'
 16123        IF PI-EPYAMT = ZEROS
 16124           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16125        ELSE
 16126           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16127
 16128 6420-CHECK-OPEN-CLOSE.
 16129     IF PI-PMTTYPE = '5' OR '6'
 16130        GO TO 6450-REWRITE.
 16131
 16132     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16133         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16134             IF CLAIM-IS-CLOSED
 16135                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16136                 MOVE 1          TO  SUB-1
 16137                 GO TO 6440-AIG-LOOP.
 16138
 16139     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16140        GO TO 6450-REWRITE.
 16141
 16142     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16143        GO TO 6450-REWRITE.
 16144
 16145     MOVE 1                      TO SUB-1.
 16146
 16147 6430-LOOP.
 16148     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16149        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16150        IF PI-PMTTYPE = '1' OR '4'
 16151           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 309
* EL156.cbl
 16152           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16153           GO TO 6450-REWRITE
 16154        ELSE
 16155           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16156           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16157           GO TO 6450-REWRITE.
 16158
 16159     IF SUB-1 = 6
 16160      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16161      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16162      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16163      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16164      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16165      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16166      GO TO 6430-LOOP.
 16167
 16168     ADD 1                       TO SUB-1.
 16169     GO TO 6430-LOOP.
 16170
 16171
 16172 6440-AIG-LOOP.
 16173
 16174     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16175       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16176       IF WS-OPEN-CLOSE-SW = '1'
 16177         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16178         IF PI-PMTTYPE = '2'
 16179           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16180           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16181         ELSE
 16182           IF PI-PMTTYPE = '3'
 16183             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16184             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16185           ELSE
 16186             IF PI-PMTTYPE = '4'
 16187               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16188               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16189             ELSE
 16190               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16191               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16192       ELSE
 16193         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16194         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16195         GO TO 6450-REWRITE.
 16196
 16197     IF SUB-1 = 6
 16198      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16199      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16200      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16201      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16202      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16203      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16204      GO TO 6440-AIG-LOOP.
 16205
 16206     ADD 1                       TO SUB-1.
 16207     GO TO 6440-AIG-LOOP.
 16208
 16209 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 310
* EL156.cbl
 16210     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16211     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16212     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16213
 16214     IF PI-COMPANY-ID = 'DMD'
 16215         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16216         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16217         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16218         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16219         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16220
 16221
 16222* EXEC CICS REWRITE
 16223*         DATASET  ('ELTRLR')
 16224*         FROM     (ACTIVITY-TRAILERS)
 16225*     END-EXEC.
 16226     MOVE LENGTH OF
 16227      ACTIVITY-TRAILERS
 16228       TO DFHEIV11
 16229     MOVE 'ELTRLR' TO DFHEIV1
 16230*    MOVE '&& L                  %   #00015073' TO DFHEIV0
 16231     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16232     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16233     MOVE X'2020233030303135303733' TO DFHEIV0(25:11)
 16234     CALL 'kxdfhei1' USING DFHEIV0,
 16235           DFHEIV1,
 16236           ACTIVITY-TRAILERS,
 16237           DFHEIV11,
 16238           DFHEIV99
 16239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16240
 16241
 16242 6499-EXIT.
 16243      EXIT.
 16244
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 311
* EL156.cbl
 16246 6500-READ-DLO035.
 16247     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16248     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16249     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16250     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16251
 16252
 16253* EXEC CICS LINK
 16254*        PROGRAM    ('DLO035')
 16255*        COMMAREA   (DLO035-KEY)
 16256*        LENGTH     (DL35-LENGTH)
 16257*    END-EXEC.
 16258     MOVE 'DLO035' TO DFHEIV1
 16259*    MOVE '."C                   (   #00015088' TO DFHEIV0
 16260     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16261     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16262     MOVE X'2020233030303135303838' TO DFHEIV0(25:11)
 16263     CALL 'kxdfhei1' USING DFHEIV0,
 16264           DFHEIV1,
 16265           DLO035-KEY,
 16266           DL35-LENGTH,
 16267           DFHEIV99,
 16268           DFHEIV99,
 16269           DFHEIV99,
 16270           DFHEIV99
 16271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16272
 16273
 16274     IF DL35-RETURN-CODE = 'OK'
 16275         GO TO 6500-EXIT.
 16276
 16277     IF DL35-RETURN-CODE = '01'
 16278         MOVE ER-7830            TO EMI-ERROR
 16279         GO TO 6500-BAD-EXIT.
 16280
 16281     IF DL35-RETURN-CODE = '02'
 16282         MOVE ER-7831            TO EMI-ERROR
 16283         GO TO 6500-BAD-EXIT.
 16284
 16285     IF DL35-RETURN-CODE = '03'
 16286         MOVE ER-7832            TO EMI-ERROR
 16287         GO TO 6500-BAD-EXIT.
 16288
 16289     IF DL35-RETURN-CODE = '04'
 16290         MOVE ER-7833            TO EMI-ERROR
 16291         GO TO 6500-BAD-EXIT.
 16292
 16293     IF DL35-RETURN-CODE = '05'
 16294         MOVE ER-7834            TO EMI-ERROR
 16295         GO TO 6500-BAD-EXIT.
 16296
 16297     IF DL35-RETURN-CODE = '06'
 16298         MOVE ER-7835            TO EMI-ERROR
 16299         GO TO 6500-BAD-EXIT.
 16300
 16301     IF DL35-RETURN-CODE = '07'
 16302         MOVE ER-7836            TO EMI-ERROR
 16303         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 312
* EL156.cbl
 16304
 16305     IF DL35-RETURN-CODE = 'E1'
 16306         MOVE ER-7837            TO EMI-ERROR
 16307         GO TO 6500-BAD-EXIT.
 16308
 16309     IF DL35-RETURN-CODE NOT = 'OK'
 16310         MOVE ER-7838            TO EMI-ERROR
 16311         GO TO 6500-BAD-EXIT.
 16312
 16313 6500-EXIT.
 16314      EXIT.
 16315
 16316 6500-BAD-EXIT.
 16317
 16318* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16319*    MOVE '6"R                   !   #00015137' TO DFHEIV0
 16320     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16322     MOVE X'2020233030303135313337' TO DFHEIV0(25:11)
 16323     CALL 'kxdfhei1' USING DFHEIV0
 16324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16325
 16326     MOVE -1                 TO PMTTYPEL.
 16327     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16328     GO TO 8200-SEND-DATAONLY.
 16329
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 313
* EL156.cbl
 16331 6600-UPDATE-DLO035.
 16332     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16333     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16334     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16335     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16336
 16337
 16338* EXEC CICS LINK
 16339*        PROGRAM    ('DLO035')
 16340*        COMMAREA   (DLO035-KEY)
 16341*        LENGTH     (DL35-LENGTH)
 16342*    END-EXEC.
 16343     MOVE 'DLO035' TO DFHEIV1
 16344*    MOVE '."C                   (   #00015149' TO DFHEIV0
 16345     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16347     MOVE X'2020233030303135313439' TO DFHEIV0(25:11)
 16348     CALL 'kxdfhei1' USING DFHEIV0,
 16349           DFHEIV1,
 16350           DLO035-KEY,
 16351           DL35-LENGTH,
 16352           DFHEIV99,
 16353           DFHEIV99,
 16354           DFHEIV99,
 16355           DFHEIV99
 16356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16357
 16358
 16359     IF DL35-RETURN-CODE = 'OK'
 16360         GO TO 6600-EXIT.
 16361
 16362     IF DL35-RETURN-CODE = '01'
 16363         MOVE ER-7830            TO EMI-ERROR
 16364         GO TO 6500-BAD-EXIT.
 16365
 16366     IF DL35-RETURN-CODE = '02'
 16367         MOVE ER-7831            TO EMI-ERROR
 16368         GO TO 6500-BAD-EXIT.
 16369
 16370     IF DL35-RETURN-CODE = '03'
 16371         MOVE ER-7832            TO EMI-ERROR
 16372         GO TO 6500-BAD-EXIT.
 16373
 16374     IF DL35-RETURN-CODE = '04'
 16375         MOVE ER-7833            TO EMI-ERROR
 16376         GO TO 6500-BAD-EXIT.
 16377
 16378     IF DL35-RETURN-CODE = '05'
 16379         MOVE ER-7834            TO EMI-ERROR
 16380         GO TO 6500-BAD-EXIT.
 16381
 16382     IF DL35-RETURN-CODE = '06'
 16383         MOVE ER-7835            TO EMI-ERROR
 16384         GO TO 6500-BAD-EXIT.
 16385
 16386     IF DL35-RETURN-CODE = '07'
 16387         MOVE ER-7836            TO EMI-ERROR
 16388         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 314
* EL156.cbl
 16389
 16390     IF DL35-RETURN-CODE = 'E1'
 16391         MOVE ER-7837            TO EMI-ERROR
 16392         GO TO 6500-BAD-EXIT.
 16393
 16394     IF DL35-RETURN-CODE NOT = 'OK'
 16395         MOVE ER-7838            TO EMI-ERROR
 16396         GO TO 6500-BAD-EXIT.
 16397
 16398 6600-EXIT.
 16399      EXIT.
 16400
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 315
* EL156.cbl
 16402 6700-UPDATE-ACTQ.
 16403***************************************************************
 16404*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16405*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16406*    ONE ALREADY THERE.                                       *
 16407***************************************************************
 16408
 16409
 16410* EXEC CICS HANDLE CONDITION
 16411*         NOTFND(6720-BUILD-NEW-RECORD)
 16412*     END-EXEC.
 16413*    MOVE '"$I                   ! 6 #00015205' TO DFHEIV0
 16414     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16416     MOVE X'3620233030303135323035' TO DFHEIV0(25:11)
 16417     CALL 'kxdfhei1' USING DFHEIV0
 16418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16419
 16420
 16421
 16422* EXEC CICS READ
 16423*         DATASET('ELACTQ')
 16424*         RIDFLD (ELMSTR-KEY)
 16425*         SET    (ADDRESS OF ACTIVITY-QUE)
 16426*         UPDATE
 16427*     END-EXEC.
 16428     MOVE 'ELACTQ' TO DFHEIV1
 16429*    MOVE '&"S        EU         (   #00015209' TO DFHEIV0
 16430     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16431     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16432     MOVE X'2020233030303135323039' TO DFHEIV0(25:11)
 16433     CALL 'kxdfhei1' USING DFHEIV0,
 16434           DFHEIV1,
 16435           DFHEIV20,
 16436           DFHEIV99,
 16437           ELMSTR-KEY,
 16438           DFHEIV99,
 16439           DFHEIV99,
 16440           DFHEIV99
 16441     SET ADDRESS OF ACTIVITY-QUE TO
 16442         DFHEIV20
 16443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16444
 16445
 16446     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16447
 16448     IF PI-AIG-SPECIAL-BENEFIT AND
 16449        PI-CASH = 'Y'
 16450         ADD 2                   TO AQ-PAYMENT-COUNTER
 16451     ELSE
 16452         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16453
 16454     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16455         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16456
 16457     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16458
 16459     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 316
* EL156.cbl
 16460         IF WS-PMT-APPROVAL-SW = 'A'
 16461             NEXT SENTENCE
 16462         ELSE
 16463            IF PI-AIG-SPECIAL-BENEFIT AND
 16464               PI-CASH = 'Y'
 16465                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16466                                     WS-PMT-UNAPPROVED-CNT
 16467            ELSE
 16468                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16469                                     WS-PMT-UNAPPROVED-CNT
 16470     ELSE
 16471         IF PI-PMT-APPR-SW = 'Y'
 16472            IF PI-AIG-SPECIAL-BENEFIT AND
 16473               PI-CASH = 'Y'
 16474                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16475                                     WS-PMT-UNAPPROVED-CNT
 16476            ELSE
 16477                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16478                                     WS-PMT-UNAPPROVED-CNT.
 16479
 16480     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16481         MOVE ER-3536 TO EMI-ERROR
 16482         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16483
 16484     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16485
 16486
 16487* EXEC CICS REWRITE
 16488*         DATASET('ELACTQ')
 16489*         FROM   (ACTIVITY-QUE)
 16490*     END-EXEC.
 16491     MOVE LENGTH OF
 16492      ACTIVITY-QUE
 16493       TO DFHEIV11
 16494     MOVE 'ELACTQ' TO DFHEIV1
 16495*    MOVE '&& L                  %   #00015256' TO DFHEIV0
 16496     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16497     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16498     MOVE X'2020233030303135323536' TO DFHEIV0(25:11)
 16499     CALL 'kxdfhei1' USING DFHEIV0,
 16500           DFHEIV1,
 16501           ACTIVITY-QUE,
 16502           DFHEIV11,
 16503           DFHEIV99
 16504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16505
 16506
 16507     GO TO 6799-EXIT.
 16508
 16509 6720-BUILD-NEW-RECORD.
 16510
 16511* EXEC CICS GETMAIN
 16512*         SET    (ADDRESS OF ACTIVITY-QUE)
 16513*         LENGTH (60)
 16514*         INITIMG(GETMAIN-SPACE)
 16515*     END-EXEC.
 16516     MOVE 60
 16517       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 317
* EL156.cbl
 16518*    MOVE ',"IL                  $   #00015264' TO DFHEIV0
 16519     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16520     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16521     MOVE X'2020233030303135323634' TO DFHEIV0(25:11)
 16522     CALL 'kxdfhei1' USING DFHEIV0,
 16523           DFHEIV20,
 16524           DFHEIV11,
 16525           GETMAIN-SPACE
 16526     SET ADDRESS OF ACTIVITY-QUE TO
 16527         DFHEIV20
 16528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16529
 16530
 16531     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16532
 16533     IF PI-AIG-SPECIAL-BENEFIT AND
 16534        PI-CASH = 'Y'
 16535         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16536     ELSE
 16537         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16538
 16539     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16540     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16541     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16542     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16543                                    AQ-FOLLOWUP-DATE.
 16544     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16545     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16546
 16547     IF PI-PMT-GRADUATED
 16548         IF WS-PMT-APPROVAL-SW = 'A'
 16549             NEXT SENTENCE
 16550         ELSE
 16551            IF PI-AIG-SPECIAL-BENEFIT AND
 16552               PI-CASH = 'Y'
 16553                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16554            ELSE
 16555                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16556     ELSE
 16557         IF PI-PMT-APPR-SW = 'Y'
 16558            IF PI-AIG-SPECIAL-BENEFIT AND
 16559               PI-CASH = 'Y'
 16560                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16561            ELSE
 16562                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16563
 16564     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16565         MOVE ER-3536 TO EMI-ERROR
 16566         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16567
 16568
 16569* EXEC CICS WRITE
 16570*         DATASET('ELACTQ')
 16571*         RIDFLD (ELMSTR-KEY)
 16572*         FROM   (ACTIVITY-QUE)
 16573*     END-EXEC.
 16574     MOVE LENGTH OF
 16575      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 318
* EL156.cbl
 16576       TO DFHEIV11
 16577     MOVE 'ELACTQ' TO DFHEIV1
 16578*    MOVE '&$ L                  ''   #00015307' TO DFHEIV0
 16579     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16581     MOVE X'2020233030303135333037' TO DFHEIV0(25:11)
 16582     CALL 'kxdfhei1' USING DFHEIV0,
 16583           DFHEIV1,
 16584           ACTIVITY-QUE,
 16585           DFHEIV11,
 16586           ELMSTR-KEY,
 16587           DFHEIV99,
 16588           DFHEIV99
 16589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16590
 16591
 16592 6799-EXIT.
 16593      EXIT.
 16594
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 319
* EL156.cbl
 16596 6800-BUILD-FORM-TRAILER.
 16597
 16598
 16599* EXEC CICS GETMAIN
 16600*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16601*         LENGTH   (200)
 16602*         INITIMG  (GETMAIN-SPACE)
 16603*    END-EXEC.
 16604     MOVE 200
 16605       TO DFHEIV11
 16606*    MOVE ',"IL                  $   #00015319' TO DFHEIV0
 16607     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16608     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16609     MOVE X'2020233030303135333139' TO DFHEIV0(25:11)
 16610     CALL 'kxdfhei1' USING DFHEIV0,
 16611           DFHEIV20,
 16612           DFHEIV11,
 16613           GETMAIN-SPACE
 16614     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16615         DFHEIV20
 16616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16617
 16618
 16619     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16620
 16621     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16622     MOVE 'AT'                   TO AT-RECORD-ID.
 16623     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16624
 16625     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16626     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16627                                    AT-FORM-LAST-MAINT-DT
 16628                                    AT-FORM-SEND-ON-DT.
 16629     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16630                                    AT-FORM-LAST-UPDATED-BY.
 16631     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16632     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16633     MOVE '6'                    TO DC-OPTION-CODE.
 16634     MOVE +29                    TO DC-ELAPSED-DAYS.
 16635     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16636     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16637     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16638
 16639     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16640         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16641
 16642     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16643                                    AT-FORM-RE-SEND-DT
 16644                                    AT-EMP-FORM-ANSWERED-DT
 16645                                    AT-PHY-FORM-ANSWERED-DT
 16646                                    AT-EMP-FORM-SEND-ON-DT
 16647                                    AT-PHY-FORM-SEND-ON-DT
 16648                                    AT-FORM-PRINTED-DT
 16649                                    AT-FORM-REPRINT-DT.
 16650     MOVE '2'                    TO AT-FORM-TYPE.
 16651
 16652     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16653     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 320
* EL156.cbl
 16654
 16655     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16656         NEXT SENTENCE
 16657     ELSE
 16658         IF CL-PROG-FORM-TYPE NOT = 'S'
 16659            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16660
 16661
 16662* EXEC CICS WRITE
 16663*         DATASET  ('ELTRLR')
 16664*         FROM     (ACTIVITY-TRAILERS)
 16665*         RIDFLD   (AT-CONTROL-PRIMARY)
 16666*     END-EXEC.
 16667     MOVE LENGTH OF
 16668      ACTIVITY-TRAILERS
 16669       TO DFHEIV11
 16670     MOVE 'ELTRLR' TO DFHEIV1
 16671*    MOVE '&$ L                  ''   #00015367' TO DFHEIV0
 16672     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16673     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16674     MOVE X'2020233030303135333637' TO DFHEIV0(25:11)
 16675     CALL 'kxdfhei1' USING DFHEIV0,
 16676           DFHEIV1,
 16677           ACTIVITY-TRAILERS,
 16678           DFHEIV11,
 16679           AT-CONTROL-PRIMARY,
 16680           DFHEIV99,
 16681           DFHEIV99
 16682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16683
 16684
 16685 6899-EXIT.
 16686      EXIT.
 16687
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 321
* EL156.cbl
 16689 6900-BUILD-ARCHIVE-HEADER.
 16690
 16691     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16692     MOVE '1'                    TO CNTL-REC-TYPE.
 16693     MOVE +0                     TO CNTL-SEQ-NO.
 16694     MOVE SPACES                 TO CNTL-ACCESS.
 16695
 16696
 16697* EXEC CICS READ
 16698*         DATASET  ('ELCNTL')
 16699*         SET      (ADDRESS OF CONTROL-FILE)
 16700*         RIDFLD   (ELCNTL-KEY)
 16701*         UPDATE
 16702*    END-EXEC.
 16703     MOVE 'ELCNTL' TO DFHEIV1
 16704*    MOVE '&"S        EU         (   #00015384' TO DFHEIV0
 16705     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16706     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16707     MOVE X'2020233030303135333834' TO DFHEIV0(25:11)
 16708     CALL 'kxdfhei1' USING DFHEIV0,
 16709           DFHEIV1,
 16710           DFHEIV20,
 16711           DFHEIV99,
 16712           ELCNTL-KEY,
 16713           DFHEIV99,
 16714           DFHEIV99,
 16715           DFHEIV99
 16716     SET ADDRESS OF CONTROL-FILE TO
 16717         DFHEIV20
 16718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16719
 16720
 16721     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16722     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16723
 16724
 16725* EXEC CICS REWRITE
 16726*         FROM     (CONTROL-FILE)
 16727*         DATASET  ('ELCNTL')
 16728*    END-EXEC.
 16729     MOVE LENGTH OF
 16730      CONTROL-FILE
 16731       TO DFHEIV11
 16732     MOVE 'ELCNTL' TO DFHEIV1
 16733*    MOVE '&& L                  %   #00015394' TO DFHEIV0
 16734     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16735     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16736     MOVE X'2020233030303135333934' TO DFHEIV0(25:11)
 16737     CALL 'kxdfhei1' USING DFHEIV0,
 16738           DFHEIV1,
 16739           CONTROL-FILE,
 16740           DFHEIV11,
 16741           DFHEIV99
 16742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16743
 16744
 16745
 16746* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 322
* EL156.cbl
 16747*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 16748*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 16749*    END-EXEC.
 16750*    MOVE '"$$%                  ! 7 #00015399' TO DFHEIV0
 16751     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 16752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16753     MOVE X'3720233030303135333939' TO DFHEIV0(25:11)
 16754     CALL 'kxdfhei1' USING DFHEIV0
 16755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16756
 16757
 16758
 16759* EXEC CICS GETMAIN
 16760*         SET     (ADDRESS OF LETTER-ARCHIVE)
 16761*         LENGTH  (ELARCH-LENGTH)
 16762*         INITIMG (GETMAIN-SPACE)
 16763*    END-EXEC.
 16764*    MOVE ',"IL                  $   #00015404' TO DFHEIV0
 16765     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16766     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16767     MOVE X'2020233030303135343034' TO DFHEIV0(25:11)
 16768     CALL 'kxdfhei1' USING DFHEIV0,
 16769           DFHEIV20,
 16770           ELARCH-LENGTH,
 16771           GETMAIN-SPACE
 16772     SET ADDRESS OF LETTER-ARCHIVE TO
 16773         DFHEIV20
 16774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16775
 16776
 16777     MOVE 'LA'                   TO LA-RECORD-ID.
 16778     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 16779                                    LA-ARCHIVE-NO-A1.
 16780     MOVE '4'                    TO LA-RECORD-TYPE
 16781                                    LA-RECORD-TYPE-A1.
 16782     MOVE +0                     TO LA-LINE-SEQ-NO
 16783                                    LA-LINE-SEQ-NO-A1.
 16784     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 16785                                    LA-COMPANY-CD-A1.
 16786     MOVE CL-CARRIER             TO LA4-CARRIER.
 16787     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 16788     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 16789     MOVE CL-CERT-STATE          TO LA4-STATE.
 16790     MOVE +0                     TO LA4-NO-OF-COPIES.
 16791     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 16792     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 16793     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 16794                                    LA4-INITIAL-PRINT-DATE
 16795                                    LA4-RESEND-PRINT-DATE
 16796                                    LA4-FORM-REM-PRINT-DT.
 16797     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 16798     MOVE '2'                    TO LA4-FORM-TYPE.
 16799
 16800
 16801* EXEC CICS WRITE
 16802*         DATASET  ('ELARCH')
 16803*         FROM     (LETTER-ARCHIVE)
 16804*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 323
* EL156.cbl
 16805*    END-EXEC.
 16806     MOVE LENGTH OF
 16807      LETTER-ARCHIVE
 16808       TO DFHEIV11
 16809     MOVE 'ELARCH' TO DFHEIV1
 16810*    MOVE '&$ L                  ''   #00015433' TO DFHEIV0
 16811     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16813     MOVE X'2020233030303135343333' TO DFHEIV0(25:11)
 16814     CALL 'kxdfhei1' USING DFHEIV0,
 16815           DFHEIV1,
 16816           LETTER-ARCHIVE,
 16817           DFHEIV11,
 16818           LA-CONTROL-PRIMARY,
 16819           DFHEIV99,
 16820           DFHEIV99
 16821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16822
 16823
 16824 6999-EXIT.
 16825      EXIT.
 16826
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 324
* EL156.cbl
 16828 7000-SHOW-CLAIM.
 16829     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 16830     MOVE 'A'                    TO PI-PASS-SW.
 16831     MOVE LOW-VALUES             TO PI-CPYFROM
 16832                                    PI-MONTH-END-SAVE
 16833                                    PI-CPYTHRU.
 16834
 16835     MOVE ZEROS                  TO PI-FATAL-COUNT
 16836                                    PI-DAILY-RATE
 16837                                    PI-BEN-DAYS
 16838                                    PI-MANUAL-SW
 16839                                    PI-SAVE-CURSOR
 16840                                    PI-FORCE-COUNT
 16841                                    PI-HOLDTIL
 16842                                    PI-EPYFROM
 16843                                    PI-EPYTHRU
 16844                                    PI-EDAYS
 16845                                    PI-EPYAMT
 16846                                    PI-ERESV
 16847                                    PI-EEXPENS
 16848                                    PI-CDAYS
 16849                                    PI-CPYAMT
 16850                                    PI-CRESV
 16851                                    PI-CEXPENS
 16852                                    PI-INT-RATE
 16853                                    PI-AIGFROM.
 16854     MOVE ZEROS                  TO PI-PROOF-DATE.
 16855     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 16856                                    PI-REM-BEN-AMT
 16857                                    PI-MO-BEN-AMT.
 16858
 16859     MOVE LOW-VALUES             TO EL156AI.
 16860     MOVE MAP-NAMEA              TO MAP-NAME.
 16861
 16862* EXEC CICS HANDLE CONDITION
 16863*        NOTFND   (7010-BUILD-MAP)
 16864*    END-EXEC.
 16865*    MOVE '"$I                   ! 8 #00015476' TO DFHEIV0
 16866     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16868     MOVE X'3820233030303135343736' TO DFHEIV0(25:11)
 16869     CALL 'kxdfhei1' USING DFHEIV0
 16870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16871
 16872
 16873     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16874     MOVE '2'                    TO CNTL-REC-TYPE.
 16875     MOVE +0                     TO CNTL-SEQ-NO.
 16876     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 16877
 16878
 16879* EXEC CICS READ
 16880*         DATASET  ('ELCNTL')
 16881*         SET      (ADDRESS OF CONTROL-FILE)
 16882*         RIDFLD   (ELCNTL-KEY)
 16883*    END-EXEC.
 16884     MOVE 'ELCNTL' TO DFHEIV1
 16885*    MOVE '&"S        E          (   #00015485' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 325
* EL156.cbl
 16886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16888     MOVE X'2020233030303135343835' TO DFHEIV0(25:11)
 16889     CALL 'kxdfhei1' USING DFHEIV0,
 16890           DFHEIV1,
 16891           DFHEIV20,
 16892           DFHEIV99,
 16893           ELCNTL-KEY,
 16894           DFHEIV99,
 16895           DFHEIV99,
 16896           DFHEIV99
 16897     SET ADDRESS OF CONTROL-FILE TO
 16898         DFHEIV20
 16899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16900
 16901
 16902     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 16903
 16904     IF PI-APPROVAL-LEVEL = '4' OR '5'
 16905         MOVE AL-UANON      TO SURVYYNA
 16906     END-IF.
 16907
 16908
 16909     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16910     MOVE '1'                    TO CNTL-REC-TYPE.
 16911     MOVE SPACES                 TO CNTL-ACCESS.
 16912     MOVE +0                     TO CNTL-SEQ-NO.
 16913
 16914
 16915* EXEC CICS READ
 16916*         DATASET  ('ELCNTL')
 16917*         SET      (ADDRESS OF CONTROL-FILE)
 16918*         RIDFLD   (ELCNTL-KEY)
 16919*    END-EXEC.
 16920     MOVE 'ELCNTL' TO DFHEIV1
 16921*    MOVE '&"S        E          (   #00015503' TO DFHEIV0
 16922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16924     MOVE X'2020233030303135353033' TO DFHEIV0(25:11)
 16925     CALL 'kxdfhei1' USING DFHEIV0,
 16926           DFHEIV1,
 16927           DFHEIV20,
 16928           DFHEIV99,
 16929           ELCNTL-KEY,
 16930           DFHEIV99,
 16931           DFHEIV99,
 16932           DFHEIV99
 16933     SET ADDRESS OF CONTROL-FILE TO
 16934         DFHEIV20
 16935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16936
 16937
 16938     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 16939
 16940 7010-BUILD-MAP.
 16941
 16942
 16943* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 326
* EL156.cbl
 16944*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 16945*    END-EXEC.
 16946*    MOVE '"$I                   ! 9 #00015513' TO DFHEIV0
 16947     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16949     MOVE X'3920233030303135353133' TO DFHEIV0(25:11)
 16950     CALL 'kxdfhei1' USING DFHEIV0
 16951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16952
 16953
 16954     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16955     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16956     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16957     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16958     MOVE 'MSTR'                 TO FILE-SWITCH.
 16959
 16960     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 16961
 16962     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 16963     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 16964     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 16965     MOVE CL-CCN                 TO PI-SV-CCN.
 16966
 16967     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 16968     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 16969     MOVE CL-CLAIM-NO            TO CLMNOO.
 16970     MOVE CL-CARRIER             TO CARRO.
 16971     MOVE CL-CERT-PRIME          TO CERTNOO.
 16972     MOVE CL-CERT-SFX            TO SUFXO.
 16973
 16974     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 16975        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 16976        CONTINUE
 16977     ELSE
 16978        MOVE AL-SADOF            TO ZINTHA
 16979                                    ZINTA
 16980                                    PINTHA
 16981                                    PINTA
 16982     END-IF
 16983     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 16984     EVALUATE TRUE
 16985     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 16986         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 16987     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16988         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 16989
 16990     WHEN CL-CLAIM-TYPE = 'I'
 16991         MOVE '  IU  '           TO CLMTYPO
 16992     WHEN CL-CLAIM-TYPE = 'G'
 16993         MOVE ' GAP  '           TO CLMTYPO
 16994     END-EVALUATE.
 16995     IF CLAIM-IS-OPEN
 16996         MOVE ' OPEN'            TO CLMSTATO
 16997     ELSE
 16998         MOVE 'CLOSED'           TO CLMSTATO.
 16999
 17000     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17001
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 327
* EL156.cbl
 17002     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17003         MOVE SPACES             TO  PCERTNOO
 17004                                     PSUFXO
 17005                                     PRIMHDGO
 17006                                     SEQUO
 17007         MOVE AL-SADOF           TO  PCERTNOA
 17008                                     PSUFXA
 17009                                     PRIMHDGA
 17010                                     SEQUA
 17011     ELSE
 17012         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17013         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17014         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17015         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17016         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17017         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17018         MOVE AL-SANON               TO  PCERTNOA
 17019                                         PSUFXA
 17020                                         PRIMHDGA
 17021         MOVE AL-SABON               TO  SEQUA.
 17022
 17023     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17024
 17025     IF CL-NO-OF-PMTS-MADE = 0 AND
 17026        CL-TOTAL-PAID-AMT = 0
 17027         NEXT SENTENCE
 17028     ELSE
 17029         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17030             IF NOT PI-USES-PAID-TO
 17031                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17032                 MOVE ' '                 TO DC-OPTION-CODE
 17033                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17034                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17035             ELSE
 17036                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17037                 MOVE '6'                 TO DC-OPTION-CODE
 17038                 MOVE +1                  TO DC-ELAPSED-DAYS
 17039                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17040                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17041                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17042
 17043     IF MAP-NAME = 'EL156A'
 17044        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17045           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17046             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17047           end-if
 17048        end-if
 17049     end-if
 17050     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17051         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17052         MOVE ' '                TO DC-OPTION-CODE
 17053         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17054         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17055
 17056     IF CL-INCURRED-DT NOT = LOW-VALUES
 17057         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17058         MOVE ' '                TO DC-OPTION-CODE
 17059         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 328
* EL156.cbl
 17060         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17061
 17062     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17063
 17064     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17065         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17066         MOVE ' '                TO DC-OPTION-CODE
 17067         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17068         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17069
 17070     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17071         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17072         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17073     ELSE
 17074         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17075         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17076
 17077     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17078     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17079     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17080     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17081                                    PI-GROUPING.
 17082     MOVE CL-CERT-STATE          TO CERT-STATE
 17083                                    PI-STATE.
 17084     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17085                                    PI-ACCOUNT.
 17086     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17087     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17088     MOVE 'CERT'                 TO FILE-SWITCH.
 17089
 17090     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17091     if pi-company-id = 'DCC'
 17092        perform 7975-read-acct   thru 7975-exit
 17093     end-if
 17094     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17095     MOVE PI-STATE               TO WS-ST-ACCESS.
 17096     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17097     MOVE '3'                    TO CNTL-REC-TYPE.
 17098     MOVE +0                     TO CNTL-SEQ-NO.
 17099     MOVE 'STAT'                 TO FILE-SWITCH.
 17100
 17101     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17102
 17103     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17104     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17105
 17106     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17107        GO TO 7020-BYPASS-BENEFIT.
 17108
 17109     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17110     MOVE '4'                    TO CNTL-REC-TYPE.
 17111     MOVE +0                     TO CNTL-SEQ-NO.
 17112     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17113     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17114     MOVE 'BENE'                 TO FILE-SWITCH.
 17115
 17116     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17117
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 329
* EL156.cbl
 17118     IF NO-BENEFIT-FOUND
 17119        GO TO 7020-BYPASS-BENEFIT.
 17120
 17121     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17122     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17123     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17124
 17125 7020-BYPASS-BENEFIT.
 17126
 17127*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17128*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17129*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17130
 17131     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17132         GO TO 7021-GO-TO-LIFE.
 17133     move zeros                  to PI-MAX-BENEFIT-AMT
 17134     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17135
 17136     IF (PI-COMPANY-ID = 'DCC')
 17137        and (acct-found)
 17138        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17139        MOVE ' '                 TO WS-PDEF-RECORD-SW
 17140        PERFORM 0900-GET-DDF-FACTORS
 17141                                 THRU 0900-EXIT
 17142        IF PDEF-FOUND
 17143           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17144              (P1 > +8)
 17145              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17146           END-PERFORM
 17147           IF P1 < +9
 17148              MOVE PD-MAX-AMT (P1)
 17149                                 TO PI-MAX-BENEFIT-AMT
 17150           END-IF
 17151        END-IF
 17152     end-if
 17153     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17154     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17155     if (pi-max-benefit-amt not = zeros)
 17156        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17157        move pi-max-benefit-amt  to beneo
 17158     else
 17159        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17160     end-if
 17161     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17162     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17163                                    CP-ORIGINAL-TERM.
 17164     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17165
 17166*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17167*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17168*    ELSE
 17169         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17170
 17171     MOVE ' '                    TO DC-OPTION-CODE.
 17172     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17173     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17174
 17175     IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 330
* EL156.cbl
 17176         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17177         GO TO 7023-BYPASS-REMAINING-TERM.
 17178
 17179     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17180     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17181     GO TO 7022-AROUND-LIFE.
 17182
 17183 7021-GO-TO-LIFE.
 17184
 17185     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17186     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17187     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17188                                    CP-ORIGINAL-TERM.
 17189     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17190     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17191     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17192     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17193
 17194     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17195         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17196     ELSE
 17197         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17198
 17199     MOVE ' '                    TO DC-OPTION-CODE.
 17200     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17201     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17202
 17203 7022-AROUND-LIFE.
 17204
 17205     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17206     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17207     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17208     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17209     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17210     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17211     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17212
 17213     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17214
 17215     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17216        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17217           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17218
 17219     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17220        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17221           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17222
 17223 7023-BYPASS-REMAINING-TERM.
 17224     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17225       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17226          MOVE ZEROS                  TO BENEO
 17227       ELSE
 17228          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17229          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17230          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17231          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17232          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17233          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 331
* EL156.cbl
 17234          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17235          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17236          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17237          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17238          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17239          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17240          IF (PI-COMPANY-ID = 'DCC')
 17241             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17242             MOVE ' '            TO WS-PDEF-RECORD-SW
 17243             PERFORM 0900-GET-DDF-FACTORS
 17244                                 THRU 0900-EXIT
 17245             IF PDEF-FOUND
 17246                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17247                   (P1 > +8)
 17248                   OR (PD-PROD-CODE (P1) = 'L')
 17249                END-PERFORM
 17250                IF P1 < +9
 17251                   MOVE PD-MAX-AMT (P1)
 17252                                 TO CP-R-MAX-TOT-BEN
 17253                END-IF
 17254             END-IF
 17255          END-IF
 17256
 17257* EXEC CICS LINK
 17258*            PROGRAM  (LINK-REMAMT)
 17259*            COMMAREA (CALCULATION-PASS-AREA)
 17260*            LENGTH   (CP-COMM-LENGTH)
 17261*         END-EXEC
 17262*    MOVE '."C                   (   #00015819' TO DFHEIV0
 17263     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17265     MOVE X'2020233030303135383139' TO DFHEIV0(25:11)
 17266     CALL 'kxdfhei1' USING DFHEIV0,
 17267           LINK-REMAMT,
 17268           CALCULATION-PASS-AREA,
 17269           CP-COMM-LENGTH,
 17270           DFHEIV99,
 17271           DFHEIV99,
 17272           DFHEIV99,
 17273           DFHEIV99
 17274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17275          MOVE CP-REMAINING-AMT       TO BENEO
 17276       end-if
 17277     end-if
 17278     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17279     MOVE +95                    TO TRLR-SEQ-NO
 17280
 17281* EXEC CICS READ
 17282*       DATASET  ('ELTRLR')
 17283*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17284*       RIDFLD   (ELTRLR-KEY)
 17285*       RESP     (WS-RESPONSE)
 17286*    END-EXEC
 17287     MOVE 'ELTRLR' TO DFHEIV1
 17288*    MOVE '&"S        E          (  N#00015829' TO DFHEIV0
 17289     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17290     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17291     MOVE X'204E233030303135383239' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 332
* EL156.cbl
 17292     CALL 'kxdfhei1' USING DFHEIV0,
 17293           DFHEIV1,
 17294           DFHEIV20,
 17295           DFHEIV99,
 17296           ELTRLR-KEY,
 17297           DFHEIV99,
 17298           DFHEIV99,
 17299           DFHEIV99
 17300     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17301         DFHEIV20
 17302     MOVE EIBRESP  TO WS-RESPONSE
 17303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17304
 17305     if ws-resp-normal
 17306        perform varying s1 from +1 by +1 until
 17307           at-note-error-no (s1) = spaces
 17308           move at-note-error-no (s1)
 17309                                 to emi-error
 17310           if at-note-error-no (s1) = '1653'
 17311              evaluate true
 17312                 when cl-claim-type = 'L'
 17313                    move '  LF  '
 17314                                 to emi-claim-type
 17315                 when cl-claim-type = 'I'
 17316                    move '  IU  '
 17317                                 to emi-claim-type
 17318                 when other
 17319                    move '  AH  '
 17320                                 to emi-claim-type
 17321              end-evaluate
 17322           end-if
 17323           PERFORM 9900-ERROR-FORMAT
 17324                                 THRU 9900-EXIT
 17325        end-perform
 17326     end-if
 17327     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17328         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17329            WS-LF-COVERAGE-TYPE = 'P'
 17330             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17331                                        CM-LF-ITD-DEATH-AMT
 17332             MOVE WS-REMAINING-AMT  TO  BENEO.
 17333
 17334     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17335     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17336     MOVE WS-TERMS               TO TERMSO.
 17337
 17338     IF WS-STATUS = '6' OR '7' OR '8'
 17339         MOVE AL-SABOF           TO CRTSTATA.
 17340
 17341     IF WS-STATUS = '1' OR '4'
 17342        IF CP-REMAINING-TERM-3 = ZEROS
 17343           MOVE 'EXPIRED'        TO CRTSTATO
 17344        ELSE
 17345           MOVE 'ACTIVE  '       TO CRTSTATO.
 17346
 17347     IF WS-STATUS = '2'
 17348         MOVE 'PEND    '         TO CRTSTATO.
 17349
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 333
* EL156.cbl
 17350     IF WS-STATUS = '3'
 17351         MOVE 'RESTORE '         TO CRTSTATO.
 17352
 17353     IF WS-STATUS = '5'
 17354         MOVE 'REISSUE '         TO CRTSTATO.
 17355
 17356     IF WS-STATUS = '6'
 17357         MOVE 'LMP DIS'          TO CRTSTATO.
 17358
 17359     IF WS-STATUS = '7'
 17360         MOVE 'DEATH'            TO CRTSTATO.
 17361
 17362     IF WS-STATUS = '8'
 17363         MOVE 'CANCEL'           TO CRTSTATO.
 17364
 17365     IF WS-STATUS = '9'
 17366         MOVE 'RE-ONLY '         TO CRTSTATO.
 17367
 17368     IF WS-STATUS = 'V'
 17369         MOVE 'VOID  '           TO CRTSTATO.
 17370
 17371     IF WS-STATUS = 'D'
 17372         MOVE 'DECLINE '         TO CRTSTATO.
 17373
 17374     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17375         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17376         MOVE '5'                TO CNTL-REC-TYPE
 17377     ELSE
 17378         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17379         MOVE '4'                TO CNTL-REC-TYPE.
 17380
 17381     MOVE '** NONE **'           TO COVERO.
 17382     MOVE AL-SABON               TO COVERA.
 17383
 17384     IF PI-COMPANY-ID = 'CVL'
 17385         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17386             MOVE CM-BENEFICIARY TO LOANNOO
 17387             MOVE AL-UANON       TO LOANNOA.
 17388
 17389     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17390        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17391        MOVE +91                 TO  TRLR-SEQ-NO
 17392
 17393* EXEC CICS READ
 17394*           DATASET  ('ELTRLR')
 17395*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17396*           RIDFLD   (ELTRLR-KEY)
 17397*           RESP     (WS-RESPONSE)
 17398*       END-EXEC
 17399     MOVE 'ELTRLR' TO DFHEIV1
 17400*    MOVE '&"S        E          (  N#00015923' TO DFHEIV0
 17401     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17403     MOVE X'204E233030303135393233' TO DFHEIV0(25:11)
 17404     CALL 'kxdfhei1' USING DFHEIV0,
 17405           DFHEIV1,
 17406           DFHEIV20,
 17407           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 334
* EL156.cbl
 17408           ELTRLR-KEY,
 17409           DFHEIV99,
 17410           DFHEIV99,
 17411           DFHEIV99
 17412     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17413         DFHEIV20
 17414     MOVE EIBRESP  TO WS-RESPONSE
 17415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17416
 17417        IF WS-RESP-NORMAL
 17418           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17419        ELSE
 17420           MOVE SPACES           TO  LOANNOO
 17421        END-IF
 17422*052506
 17423*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17424*052506
 17425     END-IF
 17426
 17427     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17428        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17429
 17430     IF WS-BEN-CD = ZEROS
 17431         GO TO 7050-SHOW-CONTINUE.
 17432
 17433     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17434     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17435     MOVE +0                     TO CNTL-SEQ-NO.
 17436     MOVE 'BENE'                 TO FILE-SWITCH.
 17437
 17438     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17439
 17440     IF BENEFIT-FOUND
 17441         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17442         MOVE AL-SANON                    TO COVERA.
 17443
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 335
* EL156.cbl
 17445 7050-SHOW-CONTINUE.
 17446
 17447     IF PI-COMPANY-ID = 'DMD'
 17448         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17449
 17450     MOVE -1                     TO PMTTYPEL.
 17451     GO TO 8100-SEND-INITIAL-MAP.
 17452
 17453 7100-SHOW-RECORD-NOT-FOUND.
 17454     IF FILE-SWITCH = 'MSTR'
 17455         MOVE ER-0204            TO EMI-ERROR.
 17456
 17457     IF FILE-SWITCH = 'CERT'
 17458         MOVE ER-0206            TO EMI-ERROR.
 17459
 17460     IF FILE-SWITCH = 'STAT'
 17461         MOVE ER-0149            TO EMI-ERROR.
 17462
 17463     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17464
 17465     MOVE -1                     TO PMTTYPEL.
 17466     GO TO 8100-SEND-INITIAL-MAP
 17467
 17468     .
 17469 7110-BUILD-PMT-TRLR.
 17470     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17471     MOVE +51                    TO TRLR-SEQ-NO
 17472
 17473* EXEC CICS READ
 17474*        DATASET  ('ELTRLR')
 17475*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17476*        RIDFLD   (ELTRLR-KEY)
 17477*        RESP     (WS-RESPONSE)
 17478*    END-EXEC
 17479     MOVE 'ELTRLR' TO DFHEIV1
 17480*    MOVE '&"S        E          (  N#00015985' TO DFHEIV0
 17481     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17483     MOVE X'204E233030303135393835' TO DFHEIV0(25:11)
 17484     CALL 'kxdfhei1' USING DFHEIV0,
 17485           DFHEIV1,
 17486           DFHEIV20,
 17487           DFHEIV99,
 17488           ELTRLR-KEY,
 17489           DFHEIV99,
 17490           DFHEIV99,
 17491           DFHEIV99
 17492     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17493         DFHEIV20
 17494     MOVE EIBRESP  TO WS-RESPONSE
 17495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17496     IF WS-RESP-NORMAL
 17497        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 17498     END-IF
 17499     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17500
 17501* EXEC CICS GETMAIN
 17502*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 336
* EL156.cbl
 17503*         LENGTH    (200)
 17504*         INITIMG   (GETMAIN-SPACE)
 17505*     END-EXEC
 17506     MOVE 200
 17507       TO DFHEIV11
 17508*    MOVE ',"IL                  $   #00015995' TO DFHEIV0
 17509     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17510     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17511     MOVE X'2020233030303135393935' TO DFHEIV0(25:11)
 17512     CALL 'kxdfhei1' USING DFHEIV0,
 17513           DFHEIV20,
 17514           DFHEIV11,
 17515           GETMAIN-SPACE
 17516     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17517         DFHEIV20
 17518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17519     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17520                                    AT-PREV-PAID-THRU-DT
 17521     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17522     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17523     MOVE 'AT'                   TO AT-RECORD-ID
 17524     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17525     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17526     MOVE '2'                    TO AT-TRAILER-TYPE
 17527     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17528                                    AT-PAYMENT-LAST-MAINT-DT
 17529     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17530                                    AT-PAYMENT-LAST-UPDATED-BY
 17531     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17532     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17533     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17534     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17535     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17536     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17537     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17538     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17539     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17540     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17541     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17542     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17543     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17544     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17545     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17546     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17547                                    AT-TO-BE-WRITTEN-DT
 17548     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17549                                    AT-CHECK-QUE-SEQUENCE
 17550                                    AT-ADDL-RESERVE
 17551     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17552                                    AT-VOID-SELECT-DT
 17553                                    AT-VOID-ACCEPT-DT
 17554                                    AT-VOID-DT
 17555                                    AT-PMT-PROOF-DT
 17556                                    AT-INT-PMT-SELECT-DT
 17557     MOVE ZEROS                  TO AT-DAILY-RATE
 17558                                    AT-ELIMINATION-DAYS
 17559     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17560*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 337
* EL156.cbl
 17561*        DUPREC    (7120-DUPREC)
 17562*    END-EXEC
 17563     .
 17564 7115-WRITE-INT-TRLR.
 17565
 17566* EXEC CICS WRITE
 17567*         DATASET       ('ELTRLR')
 17568*         FROM          (ACTIVITY-TRAILERS)
 17569*         RIDFLD        (AT-CONTROL-PRIMARY)
 17570*         RESP          (WS-RESPONSE)
 17571*     END-EXEC
 17572     MOVE LENGTH OF
 17573      ACTIVITY-TRAILERS
 17574       TO DFHEIV11
 17575     MOVE 'ELTRLR' TO DFHEIV1
 17576*    MOVE '&$ L                  ''  N#00016046' TO DFHEIV0
 17577     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17578     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17579     MOVE X'204E233030303136303436' TO DFHEIV0(25:11)
 17580     CALL 'kxdfhei1' USING DFHEIV0,
 17581           DFHEIV1,
 17582           ACTIVITY-TRAILERS,
 17583           DFHEIV11,
 17584           AT-CONTROL-PRIMARY,
 17585           DFHEIV99,
 17586           DFHEIV99
 17587     MOVE EIBRESP  TO WS-RESPONSE
 17588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17589      IF WS-RESP-DUPREC
 17590         GO TO 7120-DUPREC
 17591      END-IF
 17592     GO TO 7130-EXIT
 17593     .
 17594 7120-DUPREC.
 17595     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17596     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17597     GO TO 7115-WRITE-INT-TRLR
 17598     .
 17599 7130-EXIT.
 17600      EXIT.
 17601 7140-BUILD-NOTE-TRLR.
 17602
 17603
 17604* EXEC CICS GETMAIN
 17605*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17606*         LENGTH    (200)
 17607*         INITIMG   (GETMAIN-SPACE)
 17608*     END-EXEC
 17609     MOVE 200
 17610       TO DFHEIV11
 17611*    MOVE ',"IL                  $   #00016066' TO DFHEIV0
 17612     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17613     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17614     MOVE X'2020233030303136303636' TO DFHEIV0(25:11)
 17615     CALL 'kxdfhei1' USING DFHEIV0,
 17616           DFHEIV20,
 17617           DFHEIV11,
 17618           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 338
* EL156.cbl
 17619     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17620         DFHEIV20
 17621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17622     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17623     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17624     MOVE 'AT'                   TO AT-RECORD-ID
 17625     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17626     MOVE '6'                    TO AT-TRAILER-TYPE
 17627     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17628                                    AT-GEN-INFO-LAST-MAINT-DT
 17629     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17630                                    AT-GEN-INFO-LAST-UPDATED-BY
 17631     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17632     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17633     .
 17634 7150-WRITE.
 17635
 17636* EXEC CICS HANDLE CONDITION
 17637*        DUPREC    (7160-DUPREC)
 17638*    END-EXEC
 17639*    MOVE '"$%                   ! : #00016084' TO DFHEIV0
 17640     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17642     MOVE X'3A20233030303136303834' TO DFHEIV0(25:11)
 17643     CALL 'kxdfhei1' USING DFHEIV0
 17644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17645
 17646* EXEC CICS WRITE
 17647*         DATASET     ('ELTRLR')
 17648*         FROM        (ACTIVITY-TRAILERS)
 17649*         RIDFLD      (AT-CONTROL-PRIMARY)
 17650*         RESP        (WS-RESPONSE)
 17651*     END-EXEC
 17652     MOVE LENGTH OF
 17653      ACTIVITY-TRAILERS
 17654       TO DFHEIV11
 17655     MOVE 'ELTRLR' TO DFHEIV1
 17656*    MOVE '&$ L                  ''  N#00016087' TO DFHEIV0
 17657     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17658     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17659     MOVE X'204E233030303136303837' TO DFHEIV0(25:11)
 17660     CALL 'kxdfhei1' USING DFHEIV0,
 17661           DFHEIV1,
 17662           ACTIVITY-TRAILERS,
 17663           DFHEIV11,
 17664           AT-CONTROL-PRIMARY,
 17665           DFHEIV99,
 17666           DFHEIV99
 17667     MOVE EIBRESP  TO WS-RESPONSE
 17668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17669      IF WS-RESP-DUPREC
 17670         GO TO 7160-DUPREC
 17671      END-IF
 17672     GO TO 7170-EXIT
 17673     .
 17674 7160-DUPREC.
 17675     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17676     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 339
* EL156.cbl
 17677     GO TO 7150-WRITE
 17678     .
 17679 7170-EXIT.
 17680      EXIT.
 17681
 17682 7180-ADD-CERT-NOTE.
 17683*ADD CERT NOTE FOR SC NP+6
 17684
 17685
 17686* EXEC CICS GETMAIN
 17687*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17688*         LENGTH    (150)
 17689*         INITIMG   (GETMAIN-SPACE)
 17690*     END-EXEC.
 17691     MOVE 150
 17692       TO DFHEIV11
 17693*    MOVE ',"IL                  $   #00016109' TO DFHEIV0
 17694     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17695     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17696     MOVE X'2020233030303136313039' TO DFHEIV0(25:11)
 17697     CALL 'kxdfhei1' USING DFHEIV0,
 17698           DFHEIV20,
 17699           DFHEIV11,
 17700           GETMAIN-SPACE
 17701     SET ADDRESS OF CERT-NOTE-FILE TO
 17702         DFHEIV20
 17703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17704
 17705
 17706     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17707     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17708     MOVE +1                     TO WRK-NOTE-SEQ.
 17709     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17710     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17711     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17712     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17713     MOVE CL-CERT-STATE          TO CZ-STATE.
 17714     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17715     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17716     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17717     MOVE '2'                    TO CZ-RECORD-TYPE.
 17718     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17719     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17720     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17721     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17722     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17723     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 17724     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 17725     MOVE ' + 6 MO '             TO SC-NP6-COMM
 17726     IF PI-COMPANY-ID = 'AHL'
 17727        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 17728           CONTINUE
 17729        ELSE
 17730           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 17731              MOVE ' + 1 MO '    TO SC-NP6-COMM
 17732           ELSE
 17733              MOVE ' + 2 MO '    TO SC-NP6-COMM
 17734           END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 340
* EL156.cbl
 17735        END-IF
 17736     END-IF
 17737     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 17738     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 17739
 17740 7181-WRITE.
 17741
 17742
 17743* EXEC CICS WRITE
 17744*         DATASET     ('ERCNOT')
 17745*         FROM        (CERT-NOTE-FILE)
 17746*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17747*         RESP        (WS-RESPONSE)
 17748*    END-EXEC.
 17749     MOVE LENGTH OF
 17750      CERT-NOTE-FILE
 17751       TO DFHEIV11
 17752     MOVE 'ERCNOT' TO DFHEIV1
 17753*    MOVE '&$ L                  ''  N#00016151' TO DFHEIV0
 17754     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17756     MOVE X'204E233030303136313531' TO DFHEIV0(25:11)
 17757     CALL 'kxdfhei1' USING DFHEIV0,
 17758           DFHEIV1,
 17759           CERT-NOTE-FILE,
 17760           DFHEIV11,
 17761           CZ-CONTROL-PRIMARY,
 17762           DFHEIV99,
 17763           DFHEIV99
 17764     MOVE EIBRESP  TO WS-RESPONSE
 17765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17766
 17767
 17768     IF WS-RESP-DUPREC
 17769         GO TO 7182-DUPREC
 17770     END-IF.
 17771
 17772     SET CERT-NOTE-ADDED TO TRUE.
 17773
 17774     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 17775         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 17776     END-IF.
 17777
 17778     GO TO 7189-EXIT.
 17779
 17780 7182-DUPREC.
 17781
 17782     ADD +1                      TO  WRK-NOTE-SEQ.
 17783     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17784     GO TO 7181-WRITE.
 17785
 17786 7189-EXIT.
 17787      EXIT.
 17788
 17789 7190-ADD-ORIG-NOTE.
 17790
 17791
 17792* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 341
* EL156.cbl
 17793*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17794*         LENGTH    (150)
 17795*         INITIMG   (GETMAIN-SPACE)
 17796*     END-EXEC.
 17797     MOVE 150
 17798       TO DFHEIV11
 17799*    MOVE ',"IL                  $   #00016181' TO DFHEIV0
 17800     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17801     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17802     MOVE X'2020233030303136313831' TO DFHEIV0(25:11)
 17803     CALL 'kxdfhei1' USING DFHEIV0,
 17804           DFHEIV20,
 17805           DFHEIV11,
 17806           GETMAIN-SPACE
 17807     SET ADDRESS OF CERT-NOTE-FILE TO
 17808         DFHEIV20
 17809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17810
 17811
 17812     ADD +1                      TO WRK-NOTE-SEQ.
 17813     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17814     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17815     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17816     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17817     MOVE CL-CERT-STATE          TO CZ-STATE.
 17818     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17819     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17820     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17821     MOVE '2'                    TO CZ-RECORD-TYPE.
 17822     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17823     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17824     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17825     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17826     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17827     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 17828
 17829 7191-WRITE.
 17830
 17831
 17832* EXEC CICS WRITE
 17833*         DATASET     ('ERCNOT')
 17834*         FROM        (CERT-NOTE-FILE)
 17835*         RIDFLD      (CZ-CONTROL-PRIMARY)
 17836*         RESP        (WS-RESPONSE)
 17837*    END-EXEC.
 17838     MOVE LENGTH OF
 17839      CERT-NOTE-FILE
 17840       TO DFHEIV11
 17841     MOVE 'ERCNOT' TO DFHEIV1
 17842*    MOVE '&$ L                  ''  N#00016206' TO DFHEIV0
 17843     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17844     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17845     MOVE X'204E233030303136323036' TO DFHEIV0(25:11)
 17846     CALL 'kxdfhei1' USING DFHEIV0,
 17847           DFHEIV1,
 17848           CERT-NOTE-FILE,
 17849           DFHEIV11,
 17850           CZ-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 342
* EL156.cbl
 17851           DFHEIV99,
 17852           DFHEIV99
 17853     MOVE EIBRESP  TO WS-RESPONSE
 17854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17855
 17856
 17857     IF WS-RESP-DUPREC
 17858         GO TO 7192-DUPREC
 17859     END-IF.
 17860
 17861     GO TO 7199-EXIT.
 17862
 17863 7192-DUPREC.
 17864
 17865     ADD +1                      TO  WRK-NOTE-SEQ.
 17866     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 17867     GO TO 7191-WRITE.
 17868
 17869 7199-EXIT.
 17870      EXIT.
 17871 7200-FIND-BENEFIT.
 17872     MOVE 'N' TO WS-BEN-SEARCH-SW.
 17873
 17874
 17875* EXEC CICS HANDLE CONDITION
 17876*        ENDFILE(7200-EXIT)
 17877*        NOTFND(7200-EXIT)
 17878*    END-EXEC.
 17879*    MOVE '"$''I                  ! ; #00016230' TO DFHEIV0
 17880     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 17881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17882     MOVE X'3B20233030303136323330' TO DFHEIV0(25:11)
 17883     CALL 'kxdfhei1' USING DFHEIV0
 17884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17885
 17886
 17887
 17888* EXEC CICS READ
 17889*        DATASET('ELCNTL')
 17890*        SET(ADDRESS OF CONTROL-FILE)
 17891*        RIDFLD(ELCNTL-KEY)
 17892*        GTEQ
 17893*    END-EXEC.
 17894     MOVE 'ELCNTL' TO DFHEIV1
 17895*    MOVE '&"S        G          (   #00016235' TO DFHEIV0
 17896     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17898     MOVE X'2020233030303136323335' TO DFHEIV0(25:11)
 17899     CALL 'kxdfhei1' USING DFHEIV0,
 17900           DFHEIV1,
 17901           DFHEIV20,
 17902           DFHEIV99,
 17903           ELCNTL-KEY,
 17904           DFHEIV99,
 17905           DFHEIV99,
 17906           DFHEIV99
 17907     SET ADDRESS OF CONTROL-FILE TO
 17908         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 343
* EL156.cbl
 17909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17910
 17911
 17912     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 17913        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 17914           GO TO 7200-EXIT.
 17915
 17916     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 17917         VARYING SUB-1 FROM 1 BY 1 UNTIL
 17918            ((SUB-1 > 8) OR
 17919            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 17920
 17921     IF SUB-1 NOT = 9
 17922         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 17923
 17924     GO TO 7200-EXIT.
 17925
 17926 7200-BENEFIT-DUMMY.
 17927
 17928 7200-DUMMY-EXIT.
 17929     EXIT.
 17930
 17931 7200-EXIT.
 17932     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 344
* EL156.cbl
 17934*052506
 17935*052506 7250-FIND-LETTER-TRLR.
 17936*052506     EXEC CICS HANDLE CONDITION
 17937*052506         ENDFILE  (7250-END)
 17938*052506         NOTFND   (7250-END)
 17939*052506     END-EXEC.
 17940*052506
 17941*052506     EXEC CICS STARTBR
 17942*052506         DATASET   ('ELTRLR')
 17943*052506         RIDFLD    (ELTRLR-KEY)
 17944*052506         GTEQ
 17945*052506     END-EXEC.
 17946*052506
 17947*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 17948*052506
 17949*052506 7250-FIND-LOOP.
 17950*052506     EXEC CICS READNEXT
 17951*052506         DATASET   ('ELTRLR')
 17952*052506         RIDFLD    (ELTRLR-KEY)
 17953*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17954*052506     END-EXEC.
 17955*052506
 17956*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17957*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17958*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17959*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 17960*052506        GO TO 7250-END
 17961*052506     END-IF.
 17962*052506
 17963*052506     IF AT-TRAILER-TYPE NOT = '4'
 17964*052506         GO TO 7250-FIND-LOOP
 17965*052506     END-IF.
 17966*052506
 17967*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 17968*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 17969*052506     END-IF.
 17970*052506
 17971*052506     GO TO 7250-FIND-LOOP.
 17972*052506
 17973*052506 7250-END.
 17974*052506
 17975*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 17976*051506         MOVE SPACES             TO  DC-OPTION-CODE
 17977*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 17978*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17979*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 17980*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 17981*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 17982*052506     END-IF.
 17983*052506
 17984*052506     EXEC CICS ENDBR
 17985*052506          DATASET    ('ELTRLR')
 17986*052506     END-EXEC.
 17987*052506
 17988*052506 7250-EXIT.
 17989*052506     EXIT.
 17990*052506     EJECT
 17991*052506
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 345
* EL156.cbl
 17992 7300-CHECK-AUTO-ACTIVITY.
 17993
 17994     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 17995         NEXT SENTENCE
 17996     ELSE
 17997         GO TO 7399-EXIT.
 17998
 17999     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18000
 18001     IF WS-ACT-REC-FOUND-SW = 'N'
 18002         GO TO 7399-EXIT.
 18003
 18004     IF PI-ACTIVITY-CODE = 09
 18005         GO TO 7300-CONT-AUTO-ACTIVITY.
 18006
 18007     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18008        (PI-ACTIVITY-CODE = 11)
 18009         GO TO 7300-CONT-AUTO-ACTIVITY.
 18010
 18011     IF PI-PROVISIONAL-IND = 'P'
 18012         IF PI-PMTTYPE = '1'
 18013             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18014                 MOVE 'N'    TO  PI-RESET-SW
 18015                 GO TO 7399-EXIT.
 18016
 18017     IF PI-PMTTYPE = '1'
 18018         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18019             MOVE 'N'        TO  PI-RESET-SW
 18020             GO TO 7399-EXIT.
 18021
 18022     IF PI-PMTTYPE = '2' OR '3'
 18023         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18024             MOVE 'N'        TO  PI-RESET-SW
 18025             GO TO 7399-EXIT.
 18026
 18027     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18028         IF PI-PROVISIONAL-IND = 'P'
 18029             NEXT SENTENCE
 18030         ELSE
 18031             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18032
 18033 7300-CONT-AUTO-ACTIVITY.
 18034
 18035     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18036         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18037         MOVE '4'            TO DC-OPTION-CODE
 18038         MOVE +0             TO DC-ELAPSED-DAYS
 18039                                DC-ELAPSED-MONTHS
 18040         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18041         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18042         IF PI-USES-PAID-TO
 18043             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18044             IF NO-CONVERSION-ERROR
 18045                 MOVE +1     TO DC-ELAPSED-DAYS
 18046                 MOVE +0     TO DC-ELAPSED-MONTHS
 18047                 MOVE '6'    TO DC-OPTION-CODE
 18048                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18049                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 346
* EL156.cbl
 18050                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18051
 18052     IF PI-PFKEY-USED = DFHPF5
 18053         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18054         IF PI-USES-PAID-TO
 18055             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18056             MOVE +1                  TO DC-ELAPSED-DAYS
 18057             MOVE +0                  TO DC-ELAPSED-MONTHS
 18058             MOVE '6'                 TO DC-OPTION-CODE
 18059             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18060             IF NO-CONVERSION-ERROR
 18061                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18062
 18063     IF WS-CHK-THRU-DT < PI-EXP-DT
 18064         NEXT SENTENCE
 18065     ELSE
 18066         MOVE 03                     TO  WS-ACTIVITY-CODE
 18067         GO TO 7390-PROCESS-ACTIVITY.
 18068
 18069     IF PI-PROV-PMT
 18070         MOVE 09                     TO  WS-ACTIVITY-CODE
 18071     ELSE
 18072        IF PI-PMTTYPE = '1'
 18073            MOVE 02                  TO  WS-ACTIVITY-CODE
 18074        ELSE
 18075        IF PI-PMTTYPE = '2' OR '3'
 18076            MOVE 07                  TO  WS-ACTIVITY-CODE
 18077        ELSE
 18078        IF PI-PMTTYPE = '4'
 18079            MOVE 00                  TO  WS-ACTIVITY-CODE
 18080        ELSE
 18081            MOVE 'N'                 TO  PI-RESET-SW
 18082            GO TO 7399-EXIT.
 18083
 18084 7390-PROCESS-ACTIVITY.
 18085
 18086     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 18087
 18088 7399-EXIT.
 18089     EXIT.
 18090
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 347
* EL156.cbl
 18092 7400-CHECK-AUTO-ACTIVITY.
 18093
 18094
 18095* EXEC CICS HANDLE CONDITION
 18096*        NOTFND   (7400-NOT-FOUND)
 18097*    END-EXEC.
 18098*    MOVE '"$I                   ! < #00016424' TO DFHEIV0
 18099     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18101     MOVE X'3C20233030303136343234' TO DFHEIV0(25:11)
 18102     CALL 'kxdfhei1' USING DFHEIV0
 18103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18104
 18105
 18106     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18107     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18108     MOVE SPACES                 TO  CNTL-ACCESS.
 18109     MOVE +0                     TO  CNTL-SEQ-NO.
 18110
 18111
 18112* EXEC CICS READ
 18113*        DATASET   ('ELCNTL')
 18114*        RIDFLD    (ELCNTL-KEY)
 18115*        SET       (ADDRESS OF CONTROL-FILE)
 18116*    END-EXEC.
 18117     MOVE 'ELCNTL' TO DFHEIV1
 18118*    MOVE '&"S        E          (   #00016433' TO DFHEIV0
 18119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18121     MOVE X'2020233030303136343333' TO DFHEIV0(25:11)
 18122     CALL 'kxdfhei1' USING DFHEIV0,
 18123           DFHEIV1,
 18124           DFHEIV20,
 18125           DFHEIV99,
 18126           ELCNTL-KEY,
 18127           DFHEIV99,
 18128           DFHEIV99,
 18129           DFHEIV99
 18130     SET ADDRESS OF CONTROL-FILE TO
 18131         DFHEIV20
 18132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18133
 18134
 18135     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18136     GO TO 7400-EXIT.
 18137
 18138 7400-NOT-FOUND.
 18139     MOVE 'N'                        TO  PI-RESET-SW
 18140                                         WS-LETTER-SW
 18141                                         WS-ACT-REC-FOUND-SW.
 18142
 18143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18144
 18145 7400-EXIT.
 18146     EXIT.
 18147
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 348
* EL156.cbl
 18149 7450-FORMAT-AUTO-LETTER.
 18150
 18151     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18152         MOVE 'Y'                    TO PI-RESET-SW
 18153         GO TO 7450-CONTINUE-PROCESS.
 18154
 18155     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18156
 18157     IF SUB > 9
 18158         SUBTRACT 9 FROM SUB
 18159         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18160     ELSE
 18161         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18162
 18163 7450-CONTINUE-PROCESS.
 18164
 18165     IF WS-ACTIVITY-CODE = ZEROS
 18166         MOVE 'N'                    TO  WS-LETTER-SW
 18167         GO TO 7499-EXIT.
 18168
 18169     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18170
 18171     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18172         MOVE 'N'                    TO  PI-RESET-SW
 18173                                         WS-LETTER-SW
 18174         GO TO 7499-EXIT.
 18175
 18176     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18177         MOVE 'N'                    TO  WS-LETTER-SW
 18178         GO TO 7499-EXIT.
 18179
 18180     MOVE 'Y'                        TO  WS-LETTER-SW.
 18181     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18182     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18183
 18184     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18185
 18186     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18187         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18188         MOVE '6'                    TO  DC-OPTION-CODE
 18189         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18190         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18191         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18192         IF NO-CONVERSION-ERROR
 18193             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18194         ELSE
 18195              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18196
 18197     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18198         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18199         MOVE '6'                    TO  DC-OPTION-CODE
 18200         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18201         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18202         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18203         IF NO-CONVERSION-ERROR
 18204             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18205         ELSE
 18206             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 349
* EL156.cbl
 18207
 18208 7499-EXIT.
 18209     EXIT.
 18210
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 350
* EL156.cbl
 18212 7500-RESET-AUTO-ACTIVITY.
 18213
 18214     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18215     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18216     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18217     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18218     MOVE +100                   TO  TRLR-SEQ-NO.
 18219
 18220 7500-STARTBR-TRLR.
 18221
 18222
 18223* EXEC CICS HANDLE CONDITION
 18224*        ENDFILE  (7590-END)
 18225*        NOTFND   (7590-END)
 18226*    END-EXEC.
 18227*    MOVE '"$''I                  ! = #00016526' TO DFHEIV0
 18228     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18230     MOVE X'3D20233030303136353236' TO DFHEIV0(25:11)
 18231     CALL 'kxdfhei1' USING DFHEIV0
 18232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18233
 18234
 18235
 18236* EXEC CICS STARTBR
 18237*        DATASET   ('ELTRLR')
 18238*        RIDFLD    (ELTRLR-KEY)
 18239*        GTEQ
 18240*    END-EXEC.
 18241     MOVE 'ELTRLR' TO DFHEIV1
 18242     MOVE 0
 18243       TO DFHEIV11
 18244*    MOVE '&,         G          &   #00016531' TO DFHEIV0
 18245     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18246     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18247     MOVE X'2020233030303136353331' TO DFHEIV0(25:11)
 18248     CALL 'kxdfhei1' USING DFHEIV0,
 18249           DFHEIV1,
 18250           ELTRLR-KEY,
 18251           DFHEIV99,
 18252           DFHEIV11,
 18253           DFHEIV99
 18254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18255
 18256
 18257     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18258
 18259 7500-READ-NEXT.
 18260
 18261
 18262* EXEC CICS READNEXT
 18263*        DATASET   ('ELTRLR')
 18264*        RIDFLD    (ELTRLR-KEY)
 18265*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18266*    END-EXEC.
 18267     MOVE 'ELTRLR' TO DFHEIV1
 18268     MOVE 0
 18269       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 351
* EL156.cbl
 18270*    MOVE '&.S                   )   #00016541' TO DFHEIV0
 18271     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18272     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18273     MOVE X'2020233030303136353431' TO DFHEIV0(25:11)
 18274     CALL 'kxdfhei1' USING DFHEIV0,
 18275           DFHEIV1,
 18276           DFHEIV20,
 18277           DFHEIV99,
 18278           ELTRLR-KEY,
 18279           DFHEIV99,
 18280           DFHEIV11,
 18281           DFHEIV99,
 18282           DFHEIV99
 18283     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18284         DFHEIV20
 18285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18286
 18287
 18288     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18289        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18290        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18291        PI-CERT-NO    NOT = TRLR-CERT-NO
 18292         GO TO 7590-END.
 18293
 18294     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18295         GO TO 7500-READ-NEXT.
 18296
 18297     IF AT-TRAILER-TYPE NOT = '4'
 18298         GO TO 7500-READ-NEXT.
 18299
 18300     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18301         GO TO 7500-READ-NEXT.
 18302
 18303     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18304        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18305         GO TO 7500-READ-NEXT.
 18306
 18307     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18308        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18309        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18310         GO TO 7500-READ-NEXT.
 18311
 18312     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18313                         AND
 18314        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18315                         AND
 18316        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18317            GO TO 7500-READ-NEXT.
 18318
 18319     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18320
 18321
 18322* EXEC CICS ENDBR
 18323*        DATASET   ('ELTRLR')
 18324*    END-EXEC.
 18325     MOVE 'ELTRLR' TO DFHEIV1
 18326     MOVE 0
 18327       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 352
* EL156.cbl
 18328*    MOVE '&2                    $   #00016580' TO DFHEIV0
 18329     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18330     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18331     MOVE X'2020233030303136353830' TO DFHEIV0(25:11)
 18332     CALL 'kxdfhei1' USING DFHEIV0,
 18333           DFHEIV1,
 18334           DFHEIV11,
 18335           DFHEIV99
 18336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18337
 18338
 18339     MOVE 'N'                        TO  WS-BROWSE-SW.
 18340
 18341
 18342* EXEC CICS READ
 18343*        DATASET   ('ELTRLR')
 18344*        RIDFLD    (ELTRLR-KEY)
 18345*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18346*        UPDATE
 18347*    END-EXEC.
 18348     MOVE 'ELTRLR' TO DFHEIV1
 18349*    MOVE '&"S        EU         (   #00016586' TO DFHEIV0
 18350     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18351     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18352     MOVE X'2020233030303136353836' TO DFHEIV0(25:11)
 18353     CALL 'kxdfhei1' USING DFHEIV0,
 18354           DFHEIV1,
 18355           DFHEIV20,
 18356           DFHEIV99,
 18357           ELTRLR-KEY,
 18358           DFHEIV99,
 18359           DFHEIV99,
 18360           DFHEIV99
 18361     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18362         DFHEIV20
 18363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18364
 18365
 18366     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18367
 18368     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18369         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18370     ELSE
 18371         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18372             NEXT SENTENCE
 18373         ELSE
 18374             GO TO 7500-REWRITE-TRLR.
 18375
 18376     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18377
 18378     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18379     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18380     MOVE '1'                        TO  ARCH-REC-TYPE.
 18381     MOVE +0                         TO  ARCH-SEQ.
 18382
 18383     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18384
 18385 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 353
* EL156.cbl
 18386
 18387
 18388* EXEC CICS REWRITE
 18389*        DATASET   ('ELTRLR')
 18390*        FROM      (ACTIVITY-TRAILERS)
 18391*    END-EXEC.
 18392     MOVE LENGTH OF
 18393      ACTIVITY-TRAILERS
 18394       TO DFHEIV11
 18395     MOVE 'ELTRLR' TO DFHEIV1
 18396*    MOVE '&& L                  %   #00016614' TO DFHEIV0
 18397     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18398     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18399     MOVE X'2020233030303136363134' TO DFHEIV0(25:11)
 18400     CALL 'kxdfhei1' USING DFHEIV0,
 18401           DFHEIV1,
 18402           ACTIVITY-TRAILERS,
 18403           DFHEIV11,
 18404           DFHEIV99
 18405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18406
 18407
 18408     GO TO 7500-STARTBR-TRLR.
 18409
 18410 7590-END.
 18411
 18412     IF WS-BROWSE-SW = 'Y'
 18413         MOVE 'N'                    TO  WS-BROWSE-SW
 18414
 18415* EXEC CICS ENDBR
 18416*            DATASET   ('ELTRLR')
 18417*        END-EXEC.
 18418     MOVE 'ELTRLR' TO DFHEIV1
 18419     MOVE 0
 18420       TO DFHEIV11
 18421*    MOVE '&2                    $   #00016625' TO DFHEIV0
 18422     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18423     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18424     MOVE X'2020233030303136363235' TO DFHEIV0(25:11)
 18425     CALL 'kxdfhei1' USING DFHEIV0,
 18426           DFHEIV1,
 18427           DFHEIV11,
 18428           DFHEIV99
 18429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18430
 18431
 18432 7599-EXIT.
 18433     EXIT.
 18434
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 354
* EL156.cbl
 18436 7600-READ-ARCH-UPDATE.
 18437
 18438
 18439* EXEC CICS HANDLE CONDITION
 18440*        NOTFND   (7699-EXIT)
 18441*    END-EXEC.
 18442*    MOVE '"$I                   ! > #00016635' TO DFHEIV0
 18443     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18445     MOVE X'3E20233030303136363335' TO DFHEIV0(25:11)
 18446     CALL 'kxdfhei1' USING DFHEIV0
 18447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18448
 18449
 18450
 18451* EXEC CICS READ
 18452*        DATASET   ('ELARCH')
 18453*        RIDFLD    (ELARCH-KEY)
 18454*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18455*        UPDATE
 18456*    END-EXEC.
 18457     MOVE 'ELARCH' TO DFHEIV1
 18458*    MOVE '&"S        EU         (   #00016639' TO DFHEIV0
 18459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18461     MOVE X'2020233030303136363339' TO DFHEIV0(25:11)
 18462     CALL 'kxdfhei1' USING DFHEIV0,
 18463           DFHEIV1,
 18464           DFHEIV20,
 18465           DFHEIV99,
 18466           ELARCH-KEY,
 18467           DFHEIV99,
 18468           DFHEIV99,
 18469           DFHEIV99
 18470     SET ADDRESS OF LETTER-ARCHIVE TO
 18471         DFHEIV20
 18472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18473
 18474
 18475     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18476
 18477
 18478* EXEC CICS REWRITE
 18479*        DATASET   ('ELARCH')
 18480*        FROM      (LETTER-ARCHIVE)
 18481*    END-EXEC.
 18482     MOVE LENGTH OF
 18483      LETTER-ARCHIVE
 18484       TO DFHEIV11
 18485     MOVE 'ELARCH' TO DFHEIV1
 18486*    MOVE '&& L                  %   #00016648' TO DFHEIV0
 18487     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18488     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18489     MOVE X'2020233030303136363438' TO DFHEIV0(25:11)
 18490     CALL 'kxdfhei1' USING DFHEIV0,
 18491           DFHEIV1,
 18492           LETTER-ARCHIVE,
 18493           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 355
* EL156.cbl
 18494           DFHEIV99
 18495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18496
 18497
 18498 7699-EXIT.
 18499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 356
* EL156.cbl
 18501 7700-GET-DCT.
 18502
 18503     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18504     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18505     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18506     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18507                                    PI-MAX-BENEFIT-AMT
 18508                                    PI-MAX-BENEFIT-PYMT
 18509                                    PI-MIN-PAYMENT-AMT
 18510                                    PI-TIME-OF-LOSS-BAL.
 18511
 18512
 18513* EXEC CICS HANDLE CONDITION
 18514*         NOTFND (5300-NOTE-NOT-FOUND)
 18515*     END-EXEC.
 18516*    MOVE '"$I                   ! ? #00016667' TO DFHEIV0
 18517     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18519     MOVE X'3F20233030303136363637' TO DFHEIV0(25:11)
 18520     CALL 'kxdfhei1' USING DFHEIV0
 18521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18522
 18523
 18524
 18525* EXEC CICS READ
 18526*         DATASET('ERNOTE')
 18527*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18528*         RIDFLD (W-NOTE-KEY)
 18529*     END-EXEC.
 18530     MOVE 'ERNOTE' TO DFHEIV1
 18531*    MOVE '&"S        E          (   #00016671' TO DFHEIV0
 18532     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18534     MOVE X'2020233030303136363731' TO DFHEIV0(25:11)
 18535     CALL 'kxdfhei1' USING DFHEIV0,
 18536           DFHEIV1,
 18537           DFHEIV20,
 18538           DFHEIV99,
 18539           W-NOTE-KEY,
 18540           DFHEIV99,
 18541           DFHEIV99,
 18542           DFHEIV99
 18543     SET ADDRESS OF CERTIFICATE-NOTE TO
 18544         DFHEIV20
 18545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18546
 18547
 18548     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18549     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18550     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18551     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18552     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18553
 18554     IF PI-PAYEE-TYPE NOT = 'B'
 18555         GO TO 7700-EXIT.
 18556
 18557     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18558     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 357
* EL156.cbl
 18559     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18560
 18561     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18562         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18563     ELSE
 18564         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18565
 18566     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18567     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18568     MOVE 'DLO006'               TO PGM-NAME.
 18569
 18570
 18571* EXEC CICS LINK
 18572*        PROGRAM    (PGM-NAME)
 18573*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18574*        LENGTH     (DCT-RCRD-LENGTH)
 18575*    END-EXEC.
 18576*    MOVE '."C                   (   #00016699' TO DFHEIV0
 18577     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18579     MOVE X'2020233030303136363939' TO DFHEIV0(25:11)
 18580     CALL 'kxdfhei1' USING DFHEIV0,
 18581           PGM-NAME,
 18582           DCT-COMMUNICATION-AREA,
 18583           DCT-RCRD-LENGTH,
 18584           DFHEIV99,
 18585           DFHEIV99,
 18586           DFHEIV99,
 18587           DFHEIV99
 18588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18589
 18590
 18591     IF DCT-RETURN-CODE = 'OK'
 18592         GO TO 7700-CONT.
 18593
 18594     IF DCT-RETURN-CODE = '01' OR '02'
 18595         GO TO 7700-SET-TO-YES.
 18596
 18597     IF DCT-RETURN-CODE = '03'
 18598
 18599* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18600*    MOVE '6"R                   !   #00016712' TO DFHEIV0
 18601     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18603     MOVE X'2020233030303136373132' TO DFHEIV0(25:11)
 18604     CALL 'kxdfhei1' USING DFHEIV0
 18605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18606         MOVE ER-0951            TO EMI-ERROR
 18607         MOVE -1                 TO PMTTYPEL
 18608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18609         GO TO 8200-SEND-DATAONLY.
 18610
 18611     IF DCT-RETURN-CODE = '04'
 18612
 18613* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18614*    MOVE '6"R                   !   #00016719' TO DFHEIV0
 18615     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 358
* EL156.cbl
 18617     MOVE X'2020233030303136373139' TO DFHEIV0(25:11)
 18618     CALL 'kxdfhei1' USING DFHEIV0
 18619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18620         MOVE ER-0946            TO EMI-ERROR
 18621         MOVE -1                 TO PMTTYPEL
 18622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18623         GO TO 8200-SEND-DATAONLY.
 18624
 18625     IF DCT-RETURN-CODE = '05'
 18626
 18627* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18628*    MOVE '6"R                   !   #00016726' TO DFHEIV0
 18629     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18630     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18631     MOVE X'2020233030303136373236' TO DFHEIV0(25:11)
 18632     CALL 'kxdfhei1' USING DFHEIV0
 18633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18634         MOVE ER-0947            TO EMI-ERROR
 18635         MOVE -1                 TO PMTTYPEL
 18636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18637         GO TO 8200-SEND-DATAONLY.
 18638
 18639     IF DCT-RETURN-CODE = '06'
 18640
 18641* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18642*    MOVE '6"R                   !   #00016733' TO DFHEIV0
 18643     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18645     MOVE X'2020233030303136373333' TO DFHEIV0(25:11)
 18646     CALL 'kxdfhei1' USING DFHEIV0
 18647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18648         MOVE ER-0921            TO EMI-ERROR
 18649         MOVE -1                 TO PMTTYPEL
 18650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18651         GO TO 8200-SEND-DATAONLY.
 18652
 18653     IF DCT-RETURN-CODE = '07'
 18654
 18655* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18656*    MOVE '6"R                   !   #00016740' TO DFHEIV0
 18657     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18658     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18659     MOVE X'2020233030303136373430' TO DFHEIV0(25:11)
 18660     CALL 'kxdfhei1' USING DFHEIV0
 18661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18662         MOVE ER-0919            TO EMI-ERROR
 18663         MOVE -1                 TO PMTTYPEL
 18664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18665         GO TO 8200-SEND-DATAONLY.
 18666
 18667     IF DCT-RETURN-CODE = '08'
 18668
 18669* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18670*    MOVE '6"R                   !   #00016747' TO DFHEIV0
 18671     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18673     MOVE X'2020233030303136373437' TO DFHEIV0(25:11)
 18674     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 359
* EL156.cbl
 18675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18676         MOVE ER-0948            TO EMI-ERROR
 18677         MOVE -1                 TO PMTTYPEL
 18678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18679         GO TO 8200-SEND-DATAONLY.
 18680
 18681     IF DCT-RETURN-CODE = 'N1'
 18682
 18683* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18684*    MOVE '6"R                   !   #00016754' TO DFHEIV0
 18685     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18687     MOVE X'2020233030303136373534' TO DFHEIV0(25:11)
 18688     CALL 'kxdfhei1' USING DFHEIV0
 18689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18690         MOVE ER-0950            TO EMI-ERROR
 18691         MOVE -1                 TO PMTTYPEL
 18692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18693         GO TO 8200-SEND-DATAONLY.
 18694
 18695     IF DCT-RETURN-CODE = 'E1'
 18696
 18697* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18698*    MOVE '6"R                   !   #00016761' TO DFHEIV0
 18699     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18701     MOVE X'2020233030303136373631' TO DFHEIV0(25:11)
 18702     CALL 'kxdfhei1' USING DFHEIV0
 18703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18704         MOVE ER-0974            TO EMI-ERROR
 18705         MOVE -1                 TO PMTTYPEL
 18706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18707         GO TO 8200-SEND-DATAONLY.
 18708
 18709     IF DCT-RETURN-CODE = 'E2'
 18710
 18711* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18712*    MOVE '6"R                   !   #00016768' TO DFHEIV0
 18713     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18715     MOVE X'2020233030303136373638' TO DFHEIV0(25:11)
 18716     CALL 'kxdfhei1' USING DFHEIV0
 18717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18718         MOVE ER-0975            TO EMI-ERROR
 18719         MOVE -1                 TO PMTTYPEL
 18720         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18721         GO TO 8200-SEND-DATAONLY.
 18722
 18723     IF DCT-RETURN-CODE NOT = 'OK'
 18724
 18725* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18726*    MOVE '6"R                   !   #00016775' TO DFHEIV0
 18727     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18729     MOVE X'2020233030303136373735' TO DFHEIV0(25:11)
 18730     CALL 'kxdfhei1' USING DFHEIV0
 18731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18732         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 360
* EL156.cbl
 18733         MOVE -1                 TO PMTTYPEL
 18734         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18735         GO TO 8200-SEND-DATAONLY.
 18736
 18737 7700-CONT.
 18738
 18739*    MOVE 'N'                    TO CASHO.
 18740*    MOVE +1                     TO CASHL.
 18741*    MOVE AL-UANON               TO CASHA.
 18742
 18743     IF PI-OFFLINE = 'Y'
 18744         GO TO 7700-EXIT.
 18745
 18746     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 18747     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 18748     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 18749     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 18750     MOVE +7                     TO CHECKNOL.
 18751     MOVE AL-UANON               TO CHECKNOA.
 18752     GO TO 7700-EXIT.
 18753
 18754 7700-SET-TO-YES.
 18755
 18756*    MOVE 'Y'                    TO CASHO.
 18757*    MOVE +1                     TO CASHL.
 18758*    MOVE AL-UANON               TO CASHA.
 18759
 18760 7700-EXIT.
 18761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 361
* EL156.cbl
 18763 7800-READ-COMP-MSTR.
 18764
 18765
 18766* EXEC CICS HANDLE CONDITION
 18767*        NOTFND   (7800-COMP-NOTFND)
 18768*    END-EXEC.
 18769*    MOVE '"$I                   ! @ #00016809' TO DFHEIV0
 18770     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18771     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18772     MOVE X'4020233030303136383039' TO DFHEIV0(25:11)
 18773     CALL 'kxdfhei1' USING DFHEIV0
 18774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18775
 18776
 18777
 18778* EXEC CICS READ
 18779*        DATASET   ('ERCOMP')
 18780*        RIDFLD    (ERCOMP-KEY)
 18781*        SET       (ADDRESS OF COMPENSATION-MASTER)
 18782*    END-EXEC.
 18783     MOVE 'ERCOMP' TO DFHEIV1
 18784*    MOVE '&"S        E          (   #00016813' TO DFHEIV0
 18785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18787     MOVE X'2020233030303136383133' TO DFHEIV0(25:11)
 18788     CALL 'kxdfhei1' USING DFHEIV0,
 18789           DFHEIV1,
 18790           DFHEIV20,
 18791           DFHEIV99,
 18792           ERCOMP-KEY,
 18793           DFHEIV99,
 18794           DFHEIV99,
 18795           DFHEIV99
 18796     SET ADDRESS OF COMPENSATION-MASTER TO
 18797         DFHEIV20
 18798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18799
 18800
 18801     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 18802     GO TO 7800-COMP-EXIT.
 18803
 18804 7800-COMP-NOTFND.
 18805     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 18806
 18807 7800-COMP-EXIT.
 18808     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 362
* EL156.cbl
 18810 7900-READ-CLAIM.
 18811
 18812* EXEC CICS READ
 18813*        DATASET  ('ELMSTR')
 18814*        SET      (ADDRESS OF CLAIM-MASTER)
 18815*        RIDFLD   (ELMSTR-KEY)
 18816*    END-EXEC.
 18817     MOVE 'ELMSTR' TO DFHEIV1
 18818*    MOVE '&"S        E          (   #00016829' TO DFHEIV0
 18819     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18820     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18821     MOVE X'2020233030303136383239' TO DFHEIV0(25:11)
 18822     CALL 'kxdfhei1' USING DFHEIV0,
 18823           DFHEIV1,
 18824           DFHEIV20,
 18825           DFHEIV99,
 18826           ELMSTR-KEY,
 18827           DFHEIV99,
 18828           DFHEIV99,
 18829           DFHEIV99
 18830     SET ADDRESS OF CLAIM-MASTER TO
 18831         DFHEIV20
 18832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18833
 18834
 18835 7900-EXIT.
 18836      EXIT.
 18837
 18838 7910-READ-CLAIM-UPDATE.
 18839
 18840* EXEC CICS READ
 18841*        DATASET  ('ELMSTR')
 18842*        SET      (ADDRESS OF CLAIM-MASTER)
 18843*        RIDFLD   (ELMSTR-KEY)
 18844*        UPDATE
 18845*    END-EXEC.
 18846     MOVE 'ELMSTR' TO DFHEIV1
 18847*    MOVE '&"S        EU         (   #00016839' TO DFHEIV0
 18848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18849     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18850     MOVE X'2020233030303136383339' TO DFHEIV0(25:11)
 18851     CALL 'kxdfhei1' USING DFHEIV0,
 18852           DFHEIV1,
 18853           DFHEIV20,
 18854           DFHEIV99,
 18855           ELMSTR-KEY,
 18856           DFHEIV99,
 18857           DFHEIV99,
 18858           DFHEIV99
 18859     SET ADDRESS OF CLAIM-MASTER TO
 18860         DFHEIV20
 18861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18862
 18863
 18864 7910-EXIT.
 18865      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 363
* EL156.cbl
 18867 7920-READ-BENE.
 18868     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 18869     MOVE 'B'                TO BENE-RECORD-TYPE.
 18870     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 18871
 18872     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18873        IF PI-PAYEE-TYPE    = 'B' AND
 18874           PI-PAYEE-SEQ-NUM = 9
 18875             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 18876             MOVE WS-A-BENE           TO BENE-NUMBER.
 18877
 18878
 18879* EXEC CICS HANDLE CONDITION
 18880*        NOTFND   (7920-NOT-FOUND)
 18881*    END-EXEC.
 18882*    MOVE '"$I                   ! A #00016860' TO DFHEIV0
 18883     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18885     MOVE X'4120233030303136383630' TO DFHEIV0(25:11)
 18886     CALL 'kxdfhei1' USING DFHEIV0
 18887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18888
 18889
 18890
 18891* EXEC CICS READ
 18892*        DATASET  ('ELBENE')
 18893*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 18894*        RIDFLD   (ELBENE-KEY)
 18895*    END-EXEC.
 18896     MOVE 'ELBENE' TO DFHEIV1
 18897*    MOVE '&"S        E          (   #00016864' TO DFHEIV0
 18898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18900     MOVE X'2020233030303136383634' TO DFHEIV0(25:11)
 18901     CALL 'kxdfhei1' USING DFHEIV0,
 18902           DFHEIV1,
 18903           DFHEIV20,
 18904           DFHEIV99,
 18905           ELBENE-KEY,
 18906           DFHEIV99,
 18907           DFHEIV99,
 18908           DFHEIV99
 18909     SET ADDRESS OF BENEFICIARY-MASTER TO
 18910         DFHEIV20
 18911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18912
 18913
 18914     MOVE 'Y' TO BENE-FOUND-SW.
 18915     GO TO 7920-EXIT.
 18916
 18917 7920-NOT-FOUND.
 18918     MOVE 'N'                    TO BENE-FOUND-SW.
 18919
 18920 7920-EXIT.
 18921      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 364
* EL156.cbl
 18923 7930-READ-CONTROL.
 18924
 18925* EXEC CICS READ
 18926*        DATASET  ('ELCNTL')
 18927*        SET      (ADDRESS OF CONTROL-FILE)
 18928*        RIDFLD   (ELCNTL-KEY)
 18929*    END-EXEC.
 18930     MOVE 'ELCNTL' TO DFHEIV1
 18931*    MOVE '&"S        E          (   #00016880' TO DFHEIV0
 18932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18934     MOVE X'2020233030303136383830' TO DFHEIV0(25:11)
 18935     CALL 'kxdfhei1' USING DFHEIV0,
 18936           DFHEIV1,
 18937           DFHEIV20,
 18938           DFHEIV99,
 18939           ELCNTL-KEY,
 18940           DFHEIV99,
 18941           DFHEIV99,
 18942           DFHEIV99
 18943     SET ADDRESS OF CONTROL-FILE TO
 18944         DFHEIV20
 18945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18946
 18947
 18948 7930-EXIT.
 18949      EXIT.
 18950
 18951 7940-READ-CONTROL-UPDATE.
 18952
 18953* EXEC CICS READ
 18954*        DATASET  ('ELCNTL')
 18955*        SET      (ADDRESS OF CONTROL-FILE)
 18956*        RIDFLD   (ELCNTL-KEY)
 18957*        UPDATE
 18958*    END-EXEC.
 18959     MOVE 'ELCNTL' TO DFHEIV1
 18960*    MOVE '&"S        EU         (   #00016890' TO DFHEIV0
 18961     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18962     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18963     MOVE X'2020233030303136383930' TO DFHEIV0(25:11)
 18964     CALL 'kxdfhei1' USING DFHEIV0,
 18965           DFHEIV1,
 18966           DFHEIV20,
 18967           DFHEIV99,
 18968           ELCNTL-KEY,
 18969           DFHEIV99,
 18970           DFHEIV99,
 18971           DFHEIV99
 18972     SET ADDRESS OF CONTROL-FILE TO
 18973         DFHEIV20
 18974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18975
 18976
 18977 7940-EXIT.
 18978      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 365
* EL156.cbl
 18980 7950-READ-TRAILER.
 18981
 18982* EXEC CICS READ
 18983*        DATASET  ('ELTRLR')
 18984*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18985*        RIDFLD   (ELTRLR-KEY)
 18986*    END-EXEC.
 18987     MOVE 'ELTRLR' TO DFHEIV1
 18988*    MOVE '&"S        E          (   #00016901' TO DFHEIV0
 18989     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18990     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18991     MOVE X'2020233030303136393031' TO DFHEIV0(25:11)
 18992     CALL 'kxdfhei1' USING DFHEIV0,
 18993           DFHEIV1,
 18994           DFHEIV20,
 18995           DFHEIV99,
 18996           ELTRLR-KEY,
 18997           DFHEIV99,
 18998           DFHEIV99,
 18999           DFHEIV99
 19000     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19001         DFHEIV20
 19002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19003
 19004
 19005 7950-EXIT.
 19006      EXIT.
 19007
 19008 7960-READ-TRAILER-UPDATE.
 19009
 19010* EXEC CICS READ
 19011*        DATASET  ('ELTRLR')
 19012*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19013*        RIDFLD   (ELTRLR-KEY)
 19014*        UPDATE
 19015*    END-EXEC.
 19016     MOVE 'ELTRLR' TO DFHEIV1
 19017*    MOVE '&"S        EU         (   #00016911' TO DFHEIV0
 19018     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19019     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19020     MOVE X'2020233030303136393131' TO DFHEIV0(25:11)
 19021     CALL 'kxdfhei1' USING DFHEIV0,
 19022           DFHEIV1,
 19023           DFHEIV20,
 19024           DFHEIV99,
 19025           ELTRLR-KEY,
 19026           DFHEIV99,
 19027           DFHEIV99,
 19028           DFHEIV99
 19029     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19030         DFHEIV20
 19031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19032
 19033
 19034 7960-EXIT.
 19035      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 366
* EL156.cbl
 19037 7970-READ-CERT.
 19038
 19039* EXEC CICS READ
 19040*        DATASET  ('ELCERT')
 19041*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19042*        RIDFLD   (ELCERT-KEY)
 19043*    END-EXEC.
 19044     MOVE 'ELCERT' TO DFHEIV1
 19045*    MOVE '&"S        E          (   #00016922' TO DFHEIV0
 19046     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19048     MOVE X'2020233030303136393232' TO DFHEIV0(25:11)
 19049     CALL 'kxdfhei1' USING DFHEIV0,
 19050           DFHEIV1,
 19051           DFHEIV20,
 19052           DFHEIV99,
 19053           ELCERT-KEY,
 19054           DFHEIV99,
 19055           DFHEIV99,
 19056           DFHEIV99
 19057     SET ADDRESS OF CERTIFICATE-MASTER TO
 19058         DFHEIV20
 19059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19060
 19061
 19062 7970-EXIT.
 19063      EXIT.
 19064 7975-read-acct.
 19065
 19066     move spaces              to WS-ACCT-RECORD-SW
 19067                                 pi-dcc-product-code
 19068
 19069     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19070     MOVE PI-CARRIER          TO ACCT-CARRIER
 19071     MOVE PI-GROUPING         TO ACCT-GROUPING
 19072     MOVE PI-STATE            TO ACCT-STATE
 19073     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19074     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19075     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19076     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19077
 19078
 19079* EXEC CICS READ
 19080*       DATASET ('ERACCT')
 19081*       RIDFLD  (ERACCT-KEY)
 19082*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19083*       GTEQ
 19084*       resp    (WS-RESPONSE)
 19085*    END-EXEC
 19086     MOVE 'ERACCT' TO DFHEIV1
 19087*    MOVE '&"S        G          (  N#00016944' TO DFHEIV0
 19088     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19090     MOVE X'204E233030303136393434' TO DFHEIV0(25:11)
 19091     CALL 'kxdfhei1' USING DFHEIV0,
 19092           DFHEIV1,
 19093           DFHEIV20,
 19094           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 367
* EL156.cbl
 19095           ERACCT-KEY,
 19096           DFHEIV99,
 19097           DFHEIV99,
 19098           DFHEIV99
 19099     SET ADDRESS OF ACCOUNT-MASTER TO
 19100         DFHEIV20
 19101     MOVE EIBRESP  TO WS-RESPONSE
 19102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19103     IF WS-RESP-NORMAL
 19104        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19105        and pi-cert-eff-dt < am-expiration-dt
 19106        and pi-cert-eff-dt >= am-effective-dt
 19107        move am-dcc-product-code to pi-dcc-product-code
 19108        set acct-found to true
 19109     end-if
 19110
 19111     .
 19112 7975-exit.
 19113     exit.
 19114 7980-READ-CERT-UPDATE.
 19115
 19116* EXEC CICS READ
 19117*        DATASET  ('ELCERT')
 19118*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19119*        RIDFLD   (ELCERT-KEY)
 19120*        UPDATE
 19121*    END-EXEC.
 19122     MOVE 'ELCERT' TO DFHEIV1
 19123*    MOVE '&"S        EU         (   #00016963' TO DFHEIV0
 19124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19125     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19126     MOVE X'2020233030303136393633' TO DFHEIV0(25:11)
 19127     CALL 'kxdfhei1' USING DFHEIV0,
 19128           DFHEIV1,
 19129           DFHEIV20,
 19130           DFHEIV99,
 19131           ELCERT-KEY,
 19132           DFHEIV99,
 19133           DFHEIV99,
 19134           DFHEIV99
 19135     SET ADDRESS OF CERTIFICATE-MASTER TO
 19136         DFHEIV20
 19137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19138
 19139
 19140 7980-EXIT.
 19141      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 368
* EL156.cbl
 19143 8000-LOAD-ERROR-MESSAGES.
 19144     IF PI-PASS-SW = 'C'
 19145        MOVE EMI-LINE1           TO ERMSG1BO
 19146     ELSE
 19147        MOVE EMI-LINE1           TO ERRMSG1O
 19148        MOVE EMI-LINE2           TO ERRMSG2O.
 19149
 19150 8000-EXIT.
 19151     EXIT.
 19152
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 369
* EL156.cbl
 19154
 19155 8010-DMD-ERROR-CHECKS.
 19156     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19157
 19158     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19159         GO TO 8051-ISSUE-ERROR.
 19160
 19161     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19162     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19163     MOVE '3'                    TO DC-OPTION-CODE.
 19164     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19165     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19166         GO TO 8051-ISSUE-ERROR.
 19167
 19168     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19169       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19170                           OR
 19171          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19172           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19173             MOVE ER-0851         TO EMI-ERROR
 19174             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19175       END-IF
 19176       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19177             MOVE ER-8147         TO EMI-ERROR
 19178             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19179
 19180     GO TO 8090-EXIT.
 19181
 19182 8051-ISSUE-ERROR.
 19183     MOVE ER-8146            TO EMI-ERROR.
 19184     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19185     GO TO 8090-EXIT.
 19186
 19187 8090-EXIT.
 19188      EXIT.
 19189
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 370
* EL156.cbl
 19191 8100-SEND-INITIAL-MAP.
 19192
 19193     MOVE SAVE-DATE              TO RUNDTEAO.
 19194     MOVE EIBTIME                TO TIME-IN.
 19195     MOVE TIME-OUT               TO RUNTIMAO.
 19196     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19197
 19198     IF MAP-NAME = 'EL156A'
 19199        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19200           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19201        END-IF
 19202     END-IF
 19203*    IF MAP-NAME = 'EL156A'
 19204*       IF PI-COMPANY-ID = 'CRI'
 19205*          NEXT SENTENCE
 19206*       ELSE
 19207*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19208
 19209     IF MAP-NAME = 'EL156A'
 19210        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19211           NEXT SENTENCE
 19212        ELSE
 19213           MOVE AL-SADOF TO  PINTA    PINTHA.
 19214
 19215     IF MAP-NAME = 'EL156A'
 19216        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19217            NEXT SENTENCE
 19218        ELSE
 19219           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19220
 19221*    IF MAP-NAME = 'EL156A'
 19222*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19223*          NEXT SENTENCE
 19224*       ELSE
 19225*          MOVE AL-SADOF TO CASHHA CASHA.
 19226
 19227     IF MAP-NAME = 'EL156A'
 19228        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19229           NEXT SENTENCE
 19230        ELSE
 19231           MOVE AL-SADOF        TO  LOANHA
 19232                                    LOANNOA.
 19233
 19234     IF MAP-NAME = 'EL156A'
 19235        MOVE -1                 TO  ENTERPFL
 19236        IF PI-USES-PAID-TO
 19237           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19238           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19239           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19240        ELSE
 19241           NEXT SENTENCE
 19242     ELSE
 19243        IF MAP-NAME = 'EL156B'
 19244           IF PI-USES-PAID-TO
 19245              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19246              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19247
 19248
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 371
* EL156.cbl
 19249* EXEC CICS SEND
 19250*        MAP   (MAP-NAME)
 19251*        MAPSET(MAPSET-NAME)
 19252*        FROM  (EL156AI)
 19253*        ERASE
 19254*        CURSOR
 19255*    END-EXEC.
 19256     MOVE LENGTH OF
 19257      EL156AI
 19258       TO DFHEIV12
 19259     MOVE -1
 19260       TO DFHEIV11
 19261*    MOVE '8$     CT  E    H L F ,   #00017078' TO DFHEIV0
 19262     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19263     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19264     MOVE X'2020233030303137303738' TO DFHEIV0(25:11)
 19265     CALL 'kxdfhei1' USING DFHEIV0,
 19266           MAP-NAME,
 19267           EL156AI,
 19268           DFHEIV12,
 19269           MAPSET-NAME,
 19270           DFHEIV99,
 19271           DFHEIV99,
 19272           DFHEIV99,
 19273           DFHEIV11,
 19274           DFHEIV99,
 19275           DFHEIV99,
 19276           DFHEIV99
 19277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19278
 19279
 19280     GO TO 9100-RETURN-TRAN.
 19281
 19282 8200-SEND-DATAONLY.
 19283
 19284     IF FIRST-ENTRY = 'Y'
 19285         GO TO 8100-SEND-INITIAL-MAP.
 19286
 19287     IF RETURNED-FROM-B = 'Y'
 19288         GO TO 8100-SEND-INITIAL-MAP.
 19289
 19290     MOVE SAVE-DATE              TO RUNDTEAO.
 19291     MOVE EIBTIME                TO TIME-IN.
 19292     MOVE TIME-OUT               TO RUNTIMAO.
 19293
 19294     IF EIBAID = DFHPF11
 19295        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19297        MOVE 'EL001   '          TO RETURNED-FROM
 19298        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19299        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19300        GO TO 8100-SEND-INITIAL-MAP.
 19301
 19302     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19303
 19304     IF MAP-NAME =  'EL156A'
 19305        MOVE -1                 TO  ENTERPFL
 19306        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 372
* EL156.cbl
 19307           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19308           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19309           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19310        ELSE
 19311           NEXT SENTENCE
 19312     ELSE
 19313        IF MAP-NAME = 'EL156B'
 19314           IF PI-USES-PAID-TO
 19315              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19316              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19317
 19318     IF MAP-NAME =  'EL156A'
 19319        IF PI-COMPANY-ID = 'BOA'
 19320            IF PI-INT-RATE NUMERIC
 19321                MOVE PI-INT-RATE TO PINTO.
 19322     IF MAP-NAME = 'EL156A'
 19323        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19324           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19325*          MOVE 'Y'              TO EOBYNO
 19326        END-IF
 19327     END-IF
 19328
 19329
 19330* EXEC CICS SEND
 19331*        MAP   (MAP-NAME)
 19332*        MAPSET(MAPSET-NAME)
 19333*        FROM  (EL156AI)
 19334*        DATAONLY
 19335*        CURSOR
 19336*    END-EXEC.
 19337     MOVE LENGTH OF
 19338      EL156AI
 19339       TO DFHEIV12
 19340     MOVE -1
 19341       TO DFHEIV11
 19342*    MOVE '8$D    CT       H L F ,   #00017135' TO DFHEIV0
 19343     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19344     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19345     MOVE X'2020233030303137313335' TO DFHEIV0(25:11)
 19346     CALL 'kxdfhei1' USING DFHEIV0,
 19347           MAP-NAME,
 19348           EL156AI,
 19349           DFHEIV12,
 19350           MAPSET-NAME,
 19351           DFHEIV99,
 19352           DFHEIV99,
 19353           DFHEIV99,
 19354           DFHEIV11,
 19355           DFHEIV99,
 19356           DFHEIV99,
 19357           DFHEIV99
 19358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19359
 19360
 19361     GO TO 9100-RETURN-TRAN.
 19362
 19363 8300-SEND-TEXT.
 19364
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 373
* EL156.cbl
 19365* EXEC CICS SEND TEXT
 19366*        FROM(LOGOFF-TEXT)
 19367*        LENGTH(LOGOFF-LENGTH)
 19368*        ERASE
 19369*        FREEKB
 19370*    END-EXEC.
 19371*    MOVE '8&      T  E F  H   F -   #00017146' TO DFHEIV0
 19372     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19373     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19374     MOVE X'2020233030303137313436' TO DFHEIV0(25:11)
 19375     CALL 'kxdfhei1' USING DFHEIV0,
 19376           LOGOFF-TEXT,
 19377           LOGOFF-LENGTH,
 19378           DFHEIV99,
 19379           DFHEIV99,
 19380           DFHEIV99,
 19381           DFHEIV99,
 19382           DFHEIV99,
 19383           DFHEIV99,
 19384           DFHEIV99,
 19385           DFHEIV99,
 19386           DFHEIV99,
 19387           DFHEIV99
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19389
 19390
 19391
 19392* EXEC CICS RETURN
 19393*    END-EXEC.
 19394*    MOVE '.(                    ''   #00017153' TO DFHEIV0
 19395     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19396     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19397     MOVE X'2020233030303137313533' TO DFHEIV0(25:11)
 19398     CALL 'kxdfhei1' USING DFHEIV0,
 19399           DFHEIV99,
 19400           DFHEIV99,
 19401           DFHEIV99,
 19402           DFHEIV99,
 19403           DFHEIV99,
 19404           DFHEIV99
 19405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19406
 19407
 19408 8500-FILE-NOTOPEN.
 19409     IF FILE-SWITCH = 'MSTR'
 19410         MOVE ER-0154            TO EMI-ERROR.
 19411     IF FILE-SWITCH = 'TRLR'
 19412         MOVE ER-0172            TO EMI-ERROR.
 19413     IF FILE-SWITCH = 'CERT'
 19414         MOVE ER-0169            TO EMI-ERROR.
 19415     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19416                      'PROC' OR 'STAT'
 19417         MOVE ER-0042            TO EMI-ERROR.
 19418     IF FILE-SWITCH = 'ACTQ'
 19419         MOVE ER-0338            TO EMI-ERROR.
 19420     IF FILE-SWITCH = 'ACCT'
 19421         MOVE ER-0168            TO EMI-ERROR.
 19422
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 374
* EL156.cbl
 19423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19424     MOVE -1                     TO PMTTYPEL.
 19425
 19426     IF FIRST-ENTRY = 'Y'
 19427         GO TO 8100-SEND-INITIAL-MAP.
 19428
 19429     GO TO 8200-SEND-DATAONLY.
 19430
 19431 8600-PGRM-NOT-FOUND.
 19432
 19433     MOVE ER-0923                TO EMI-ERROR.
 19434     MOVE -1                     TO ENTPFBL.
 19435     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19436
 19437     IF FIRST-ENTRY = 'Y'
 19438         GO TO 8100-SEND-INITIAL-MAP
 19439     ELSE
 19440         GO TO 8200-SEND-DATAONLY.
 19441
 19442 8800-UNAUTHORIZED-ACCESS.
 19443     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19444     GO TO 8300-SEND-TEXT.
 19445
 19446 8810-PF23.
 19447     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19448     MOVE XCTL-005               TO PGM-NAME.
 19449     GO TO 9300-XCTL.
 19450
 19451 8820-PF7-8.
 19452     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19453     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19454                                    PI-SAVED-PROGRAM-2
 19455                                    PI-SAVED-PROGRAM-3
 19456                                    PI-SAVED-PROGRAM-4
 19457                                    PI-SAVED-PROGRAM-5
 19458                                    PI-SAVED-PROGRAM-6
 19459                                    PI-RETURN-TO-PROGRAM.
 19460     IF EIBAID = DFHPF8
 19461        MOVE XCTL-132            TO PGM-NAME
 19462     ELSE
 19463        MOVE XCTL-130            TO PGM-NAME.
 19464
 19465     GO TO 9300-XCTL.
 19466
 19467 9100-RETURN-TRAN.
 19468     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19469     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19470
 19471
 19472* EXEC CICS RETURN
 19473*        TRANSID(TRANS-ID)
 19474*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19475*        LENGTH(PI-COMM-LENGTH)
 19476*    END-EXEC.
 19477*    MOVE '.(CT                  ''   #00017219' TO DFHEIV0
 19478     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19479     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19480     MOVE X'2020233030303137323139' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 375
* EL156.cbl
 19481     CALL 'kxdfhei1' USING DFHEIV0,
 19482           TRANS-ID,
 19483           PROGRAM-INTERFACE-BLOCK,
 19484           PI-COMM-LENGTH,
 19485           DFHEIV99,
 19486           DFHEIV99,
 19487           DFHEIV99
 19488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19489
 19490
 19491 9200-RETURN-MAIN-MENU.
 19492     MOVE XCTL-126               TO PGM-NAME.
 19493     GO TO 9300-XCTL.
 19494
 19495 9300-XCTL.
 19496
 19497* EXEC CICS XCTL
 19498*        PROGRAM(PGM-NAME)
 19499*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19500*        LENGTH(PI-COMM-LENGTH)
 19501*    END-EXEC.
 19502*    MOVE '.$C                   %   #00017230' TO DFHEIV0
 19503     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19504     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19505     MOVE X'2020233030303137323330' TO DFHEIV0(25:11)
 19506     CALL 'kxdfhei1' USING DFHEIV0,
 19507           PGM-NAME,
 19508           PROGRAM-INTERFACE-BLOCK,
 19509           PI-COMM-LENGTH,
 19510           DFHEIV99
 19511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19512
 19513
 19514 9400-CLEAR.
 19515     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19516     GO TO 9300-XCTL.
 19517
 19518 9500-PF12.
 19519     MOVE XCTL-010               TO PGM-NAME.
 19520     GO TO 9300-XCTL.
 19521
 19522 9700-LINK-DATE-CONVERT.
 19523     MOVE LINK-ELDATCV           TO PGM-NAME.
 19524
 19525* EXEC CICS LINK
 19526*        PROGRAM   (PGM-NAME)
 19527*        COMMAREA  (DATE-CONVERSION-DATA)
 19528*        LENGTH    (DC-COMM-LENGTH)
 19529*    END-EXEC.
 19530*    MOVE '."C                   (   #00017246' TO DFHEIV0
 19531     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19532     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19533     MOVE X'2020233030303137323436' TO DFHEIV0(25:11)
 19534     CALL 'kxdfhei1' USING DFHEIV0,
 19535           PGM-NAME,
 19536           DATE-CONVERSION-DATA,
 19537           DC-COMM-LENGTH,
 19538           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 376
* EL156.cbl
 19539           DFHEIV99,
 19540           DFHEIV99,
 19541           DFHEIV99
 19542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19543
 19544
 19545 9700-EXIT.
 19546     EXIT.
 19547
 19548 9800-LINK-REM-TERM.
 19549     MOVE LINK-REMTERM TO PGM-NAME.
 19550
 19551
 19552* EXEC CICS LINK
 19553*        PROGRAM   (PGM-NAME)
 19554*        COMMAREA  (CALCULATION-PASS-AREA)
 19555*        LENGTH    (CP-COMM-LENGTH)
 19556*    END-EXEC.
 19557*    MOVE '."C                   (   #00017258' TO DFHEIV0
 19558     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19560     MOVE X'2020233030303137323538' TO DFHEIV0(25:11)
 19561     CALL 'kxdfhei1' USING DFHEIV0,
 19562           PGM-NAME,
 19563           CALCULATION-PASS-AREA,
 19564           CP-COMM-LENGTH,
 19565           DFHEIV99,
 19566           DFHEIV99,
 19567           DFHEIV99,
 19568           DFHEIV99
 19569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19570
 19571
 19572 9800-EXIT.
 19573     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 377
* EL156.cbl
 19575 9830-DMD-REMAINING-TERM.
 19576
 19577     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19578         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19579
 19580     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19581                              CM-PMT-EXTENSION-DAYS.
 19582
 19583     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19584                                  CL-NO-OF-DAYS-PAID.
 19585
 19586     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19587         GIVING W-REM REMAINDER W-REM-DAYS.
 19588
 19589     MOVE W-REM                  TO WST-REM.
 19590
 19591     IF W-REM-DAYS > ZEROS
 19592         MOVE '/'                TO WST-SLASH
 19593         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19594     ELSE
 19595         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19596
 19597 9830-EXIT.
 19598     EXIT.
 19599
 19600 9870-OUTPUT-ACTIVITY-RECORD.
 19601
 19602
 19603* EXEC CICS GETMAIN
 19604*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19605*         LENGTH(25)
 19606*         INITIMG(WS-BLANK)
 19607*    END-EXEC.
 19608     MOVE 25
 19609       TO DFHEIV11
 19610*    MOVE ',"IL                  $   #00017294' TO DFHEIV0
 19611     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19612     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19613     MOVE X'2020233030303137323934' TO DFHEIV0(25:11)
 19614     CALL 'kxdfhei1' USING DFHEIV0,
 19615           DFHEIV20,
 19616           DFHEIV11,
 19617           WS-BLANK
 19618     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19619         DFHEIV20
 19620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19621
 19622
 19623     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19624     MOVE ELMSTR-KEY             TO DA-KEY.
 19625     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19626
 19627     IF PI-PMTTYPE EQUAL '7'
 19628         MOVE 'V'                TO DA-RECORD-TYPE
 19629     ELSE
 19630         MOVE 'P'                TO DA-RECORD-TYPE.
 19631
 19632
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 378
* EL156.cbl
 19633* EXEC CICS HANDLE CONDITION
 19634*         NOTOPEN(9870-NOTOPEN)
 19635*         DUPREC(9870-EXIT)
 19636*    END-EXEC.
 19637*    MOVE '"$J%                  ! B #00017309' TO DFHEIV0
 19638     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19640     MOVE X'4220233030303137333039' TO DFHEIV0(25:11)
 19641     CALL 'kxdfhei1' USING DFHEIV0
 19642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19643
 19644
 19645
 19646* EXEC CICS WRITE
 19647*         DATASET('DLYACTV')
 19648*         RIDFLD(DA-KEY)
 19649*         FROM(DAILY-ACTIVITY-RECORD)
 19650*         LENGTH(25)
 19651*    END-EXEC.
 19652     MOVE 'DLYACTV' TO DFHEIV1
 19653     MOVE 25
 19654       TO DFHEIV11
 19655*    MOVE '&$ L                  ''   #00017314' TO DFHEIV0
 19656     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19657     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19658     MOVE X'2020233030303137333134' TO DFHEIV0(25:11)
 19659     CALL 'kxdfhei1' USING DFHEIV0,
 19660           DFHEIV1,
 19661           DAILY-ACTIVITY-RECORD,
 19662           DFHEIV11,
 19663           DA-KEY,
 19664           DFHEIV99,
 19665           DFHEIV99
 19666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19667
 19668     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19669     GO TO 9870-EXIT.
 19670
 19671 9870-NOTOPEN.
 19672
 19673     MOVE '2955'                 TO EMI-ERROR.
 19674     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19675
 19676 9870-EXIT.
 19677     EXIT.
 19678
 19679 9900-ERROR-FORMAT.
 19680
 19681     IF EMI-ERROR = ER-0923
 19682         MOVE PGM-NAME           TO W-CALLED-NAME.
 19683
 19684     MOVE LINK-001      TO PGM-NAME.
 19685     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19686
 19687
 19688* EXEC CICS LINK
 19689*        PROGRAM (PGM-NAME)
 19690*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 379
* EL156.cbl
 19691*        LENGTH  (EMI-COMM-LENGTH)
 19692*    END-EXEC.
 19693*    MOVE '."C                   (   #00017339' TO DFHEIV0
 19694     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19695     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19696     MOVE X'2020233030303137333339' TO DFHEIV0(25:11)
 19697     CALL 'kxdfhei1' USING DFHEIV0,
 19698           PGM-NAME,
 19699           ERROR-MESSAGE-INTERFACE-BLOCK,
 19700           EMI-COMM-LENGTH,
 19701           DFHEIV99,
 19702           DFHEIV99,
 19703           DFHEIV99,
 19704           DFHEIV99
 19705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19706
 19707
 19708     IF EMI-ERROR = ER-0923
 19709         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19710
 19711 9900-EXIT.
 19712     EXIT.
 19713
 19714 9990-ABEND.
 19715     MOVE LINK-004               TO PGM-NAME.
 19716     MOVE DFHEIBLK               TO EMI-LINE1.
 19717
 19718* EXEC CICS LINK
 19719*        PROGRAM   (PGM-NAME)
 19720*        COMMAREA  (EMI-LINE1)
 19721*        LENGTH    (64)
 19722*    END-EXEC.
 19723     MOVE 64
 19724       TO DFHEIV11
 19725*    MOVE '."C                   (   #00017354' TO DFHEIV0
 19726     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19728     MOVE X'2020233030303137333534' TO DFHEIV0(25:11)
 19729     CALL 'kxdfhei1' USING DFHEIV0,
 19730           PGM-NAME,
 19731           EMI-LINE1,
 19732           DFHEIV11,
 19733           DFHEIV99,
 19734           DFHEIV99,
 19735           DFHEIV99,
 19736           DFHEIV99
 19737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19738
 19739
 19740     MOVE 'EL156A'               TO  MAP-NAME.
 19741     MOVE LOW-VALUES             TO  EL156AO.
 19742     GO TO 8100-SEND-INITIAL-MAP.
 19743
 19744 9995-SECURITY-VIOLATION.
 19745*    COPY ELCSCTP.
 19746******************************************************************
 19747*                                                                *
 19748*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 380
* EL156.cbl
 19749*                            VMOD=2.001                          *
 19750*                                                                *
 19751*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 19752******************************************************************
 19753
 19754
 19755     MOVE EIBDATE          TO SM-JUL-DATE.
 19756     MOVE EIBTRMID         TO SM-TERMID.
 19757     MOVE THIS-PGM         TO SM-PGM.
 19758     MOVE EIBTIME          TO TIME-IN.
 19759     MOVE TIME-OUT         TO SM-TIME.
 19760     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 19761
 19762
 19763* EXEC CICS LINK
 19764*         PROGRAM  ('EL003')
 19765*         COMMAREA (SECURITY-MESSAGE)
 19766*         LENGTH   (80)
 19767*    END-EXEC.
 19768     MOVE 'EL003' TO DFHEIV1
 19769     MOVE 80
 19770       TO DFHEIV11
 19771*    MOVE '."C                   (   #00017382' TO DFHEIV0
 19772     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19773     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19774     MOVE X'2020233030303137333832' TO DFHEIV0(25:11)
 19775     CALL 'kxdfhei1' USING DFHEIV0,
 19776           DFHEIV1,
 19777           SECURITY-MESSAGE,
 19778           DFHEIV11,
 19779           DFHEIV99,
 19780           DFHEIV99,
 19781           DFHEIV99,
 19782           DFHEIV99
 19783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19784
 19785
 19786******************************************************************
 19787
 19788
 19789
 19790 9999-DFHBACK SECTION.
 19791     MOVE '9%                    "   ' TO DFHEIV0
 19792     MOVE 'EL156' TO DFHEIV1
 19793     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19794     GOBACK.
 19795 9999-DFHEXIT.
 19796     IF DFHEIGDJ EQUAL 0001
 19797         NEXT SENTENCE
 19798     ELSE IF DFHEIGDJ EQUAL 2
 19799         GO TO 9990-ABEND,
 19800               8600-PGRM-NOT-FOUND,
 19801               0400-FIRST-TIME,
 19802               6180-DUPREC,
 19803               9990-ABEND
 19804         DEPENDING ON DFHEIGDI
 19805     ELSE IF DFHEIGDJ EQUAL 3
 19806         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 381
* EL156.cbl
 19807               0380-CLAIM-END-FILE
 19808         DEPENDING ON DFHEIGDI
 19809     ELSE IF DFHEIGDJ EQUAL 4
 19810         GO TO 0380-CLAIM-END-FILE,
 19811               0380-CLAIM-END-FILE
 19812         DEPENDING ON DFHEIGDI
 19813     ELSE IF DFHEIGDJ EQUAL 5
 19814         GO TO 0800-EXIT
 19815         DEPENDING ON DFHEIGDI
 19816     ELSE IF DFHEIGDJ EQUAL 6
 19817         GO TO 1950-NOT-FOUND,
 19818               1950-NOT-FOUND
 19819         DEPENDING ON DFHEIGDI
 19820     ELSE IF DFHEIGDJ EQUAL 7
 19821         GO TO 1950-NOT-FOUND
 19822         DEPENDING ON DFHEIGDI
 19823     ELSE IF DFHEIGDJ EQUAL 8
 19824         GO TO 1950-NOT-FOUND,
 19825               1950-NOT-FOUND
 19826         DEPENDING ON DFHEIGDI
 19827     ELSE IF DFHEIGDJ EQUAL 9
 19828         GO TO 1166-END-CHECK,
 19829               1166-END-CHECK
 19830         DEPENDING ON DFHEIGDI
 19831     ELSE IF DFHEIGDJ EQUAL 10
 19832         GO TO 1950-NOT-FOUND,
 19833               1950-NOT-FOUND
 19834         DEPENDING ON DFHEIGDI
 19835     ELSE IF DFHEIGDJ EQUAL 11
 19836         GO TO 1950-NOT-FOUND,
 19837               1950-NOT-FOUND
 19838         DEPENDING ON DFHEIGDI
 19839     ELSE IF DFHEIGDJ EQUAL 12
 19840         GO TO 1950-NOT-FOUND
 19841         DEPENDING ON DFHEIGDI
 19842     ELSE IF DFHEIGDJ EQUAL 13
 19843         GO TO 3600-CONTINUE
 19844         DEPENDING ON DFHEIGDI
 19845     ELSE IF DFHEIGDJ EQUAL 14
 19846         GO TO 5300-NOTE-NOT-FOUND
 19847         DEPENDING ON DFHEIGDI
 19848     ELSE IF DFHEIGDJ EQUAL 15
 19849         GO TO 6065-NOT-FOUND
 19850         DEPENDING ON DFHEIGDI
 19851     ELSE IF DFHEIGDJ EQUAL 16
 19852         GO TO 6068-ACCT-NOT-FND
 19853         DEPENDING ON DFHEIGDI
 19854     ELSE IF DFHEIGDJ EQUAL 17
 19855         GO TO 6074-GET-COMP-DATA
 19856         DEPENDING ON DFHEIGDI
 19857     ELSE IF DFHEIGDJ EQUAL 18
 19858         GO TO 6170-WRITE
 19859         DEPENDING ON DFHEIGDI
 19860     ELSE IF DFHEIGDJ EQUAL 19
 19861         GO TO 6180-DUPREC
 19862         DEPENDING ON DFHEIGDI
 19863     ELSE IF DFHEIGDJ EQUAL 20
 19864         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 10-Mar-14 08:19 Page 382
* EL156.cbl
 19865         DEPENDING ON DFHEIGDI
 19866     ELSE IF DFHEIGDJ EQUAL 21
 19867         GO TO 6185-DUPREC
 19868         DEPENDING ON DFHEIGDI
 19869     ELSE IF DFHEIGDJ EQUAL 22
 19870         GO TO 6720-BUILD-NEW-RECORD
 19871         DEPENDING ON DFHEIGDI
 19872     ELSE IF DFHEIGDJ EQUAL 23
 19873         GO TO 6900-BUILD-ARCHIVE-HEADER,
 19874               6900-BUILD-ARCHIVE-HEADER
 19875         DEPENDING ON DFHEIGDI
 19876     ELSE IF DFHEIGDJ EQUAL 24
 19877         GO TO 7010-BUILD-MAP
 19878         DEPENDING ON DFHEIGDI
 19879     ELSE IF DFHEIGDJ EQUAL 25
 19880         GO TO 7100-SHOW-RECORD-NOT-FOUND
 19881         DEPENDING ON DFHEIGDI
 19882     ELSE IF DFHEIGDJ EQUAL 26
 19883         GO TO 7160-DUPREC
 19884         DEPENDING ON DFHEIGDI
 19885     ELSE IF DFHEIGDJ EQUAL 27
 19886         GO TO 7200-EXIT,
 19887               7200-EXIT
 19888         DEPENDING ON DFHEIGDI
 19889     ELSE IF DFHEIGDJ EQUAL 28
 19890         GO TO 7400-NOT-FOUND
 19891         DEPENDING ON DFHEIGDI
 19892     ELSE IF DFHEIGDJ EQUAL 29
 19893         GO TO 7590-END,
 19894               7590-END
 19895         DEPENDING ON DFHEIGDI
 19896     ELSE IF DFHEIGDJ EQUAL 30
 19897         GO TO 7699-EXIT
 19898         DEPENDING ON DFHEIGDI
 19899     ELSE IF DFHEIGDJ EQUAL 31
 19900         GO TO 5300-NOTE-NOT-FOUND
 19901         DEPENDING ON DFHEIGDI
 19902     ELSE IF DFHEIGDJ EQUAL 32
 19903         GO TO 7800-COMP-NOTFND
 19904         DEPENDING ON DFHEIGDI
 19905     ELSE IF DFHEIGDJ EQUAL 33
 19906         GO TO 7920-NOT-FOUND
 19907         DEPENDING ON DFHEIGDI
 19908     ELSE IF DFHEIGDJ EQUAL 34
 19909         GO TO 9870-NOTOPEN,
 19910               9870-EXIT
 19911         DEPENDING ON DFHEIGDI.
 19912     MOVE '9%                    "   ' TO DFHEIV0
 19913     MOVE 'EL156' TO DFHEIV1
 19914     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 19915     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12060     Code:       73392
