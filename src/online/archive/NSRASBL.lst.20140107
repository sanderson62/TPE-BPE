* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSRASLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   2
* NSRASBL.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    16* 071212    2011022800001  AJRA  ADD UNDW ID
    17* 072312    2011022800001  AJRA    ADD NEW FIELDS
    18* 090612  IR2012090600001  AJRA  NAPERSOFT
    19* 091112  IR2012091100002  AJRA  FIX AKA
    20* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    21* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    22* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    23* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    24* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    25* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    26* 110612    2012101700002  AJRA  ADD NEW FIELDS
    27* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    28* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    29* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    30******************************************************************
    31 ENVIRONMENT DIVISION.
    32 DATA DIVISION.
    33 working-storage section.
    34 01  DFH-START PIC X(04).
    35 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    36 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    37 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    38 77  S1                          PIC S999 COMP-3 VALUE +0.
    39 77  E1                          PIC S999 COMP-3 VALUE +0.
    40 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    41 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    42 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    43 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    44 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    45 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    46 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    47 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    48 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    49 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    50 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    51 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    52     88  FOUND-BENE                  VALUE 'Y'.
    53 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    54 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    55 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    56 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    57     88  END-OF-ERPNDB              VALUE 'Y'.
    58 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    59     88  ACCT-FOUND                 VALUE 'Y'.
    60 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    61     88  CERT-FOUND                 VALUE 'Y'.
    62     88  CERT-NOT-FOUND             VALUE 'N'.
    63 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    64     88  ENDT-FOUND                 VALUE 'Y'.
    65     88  ENDT-NOT-FOUND             VALUE 'N'.
    66 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    67     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    68 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    69 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    70 77  WS-LF-EARN                  PIC X     VALUE ' '.
    71 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   3
* NSRASBL.cbl
    72 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    73 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    74 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    75 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    76 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    77 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    78 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    79 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    80 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    81 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    82 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    83 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    84 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    85 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    86 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    87 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    88 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    89     88  PROCESS-ISSUE               VALUE 'I'.
    90     88  PROCESS-CANCEL              VALUE 'C'.
    91 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
    92 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
    93 77  WS-DIFF                     PIC 999 VALUE ZEROS.
    94 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    95 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
    96 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
    97 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
    98 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
    99 01  WS-CALC-FIELDS.
   100     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   101     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   102     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   103     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   104     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   105     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   106     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   107     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   108     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   109     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   110     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   111     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   112     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   113     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   114     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   115     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   116     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   117     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   118     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   119     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   120     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   121     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   122     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   123     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   124     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   125     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   126     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   127     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   128     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   129     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   4
* NSRASBL.cbl
   130     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   131     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   132     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   133     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   134     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   135     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   136     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   137     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   138     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   139     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   140     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   141     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   142 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   143 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   144 01 response-code         pic s9(8) comp.
   145 01 display-response      pic 9(8).
   146 01 bl-index              pic 9(8) comp.
   147 01 max-last-name         pic x(18).
   148 01 first-initial         pic x.
   149 01 name-in-range-flag    pic 9.
   150 01 max-entries           pic s9(8) comp value 100.
   151 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   152 01 lower-case    pic x(26) value
   153            "abcdefghijklmnopqrstuvwxyz".
   154 01 upper-case    pic x(26) value
   155            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   156
   157*                                COPY ELCVADS.
   158******************************************************************
   159*                                                                *
   160*                                                                *
   161*                            ELCVADS.                            *
   162*                                                                *
   163*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   164*   ELVADS                  LENGTH = 350                         *
   165******************************************************************
   166******************************************************************
   167*                   C H A N G E   L O G
   168*
   169* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   170*-----------------------------------------------------------------
   171*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   172* EFFECTIVE    NUMBER
   173*-----------------------------------------------------------------
   174* 100111    2011022800001  AJRA  NAPERSOFT
   175******************************************************************
   176
   177 01  VIRGINIA-DISCLOSURE.
   178     12  VD-COMPANY-CD              PIC X.
   179     12  VD-CARRIER                 PIC X.
   180     12  VD-GROUPING.
   181         20  VD-GROUPING-PREFIX     PIC XXX.
   182         20  VD-GROUPING-PRIME      PIC XXX.
   183     12  VD-STATE                   PIC XX.
   184     12  VD-ACCOUNT.
   185         20  VD-ACCOUNT-PREFIX      PIC X(4).
   186         20  VD-ACCOUNT-PRIME       PIC X(6).
   187     12  VD-CERT-EFF-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   5
* NSRASBL.cbl
   188     12  VD-CERT-NO.
   189         20  VD-CERT-PRIME          PIC X(10).
   190         20  VD-CERT-SFX            PIC X.
   191     12  VD-ENTRY-BATCH             PIC X(6).
   192     12  VD-CSR-ID                  PIC X(4).
   193     12  VD-NAME.
   194         20  VD-INSURED-LAST-NAME   PIC X(15).
   195         20  VD-INSURED-FIRST-NAME.
   196             24  VD-INSURED-1ST-INIT PIC X.
   197             24  FILLER             PIC X(9).
   198         20  VD-INSURED-MIDDLE-INIT PIC X.
   199     12  VD-JOINT-INSURED.
   200         20 VD-JOINT-LAST-NAME      PIC X(15).
   201         20 VD-JOINT-FIRST-NAME.
   202            24  VD-JOINT-FIRST-INIT PIC X.
   203            24  FILLER              PIC X(9).
   204         20 VD-JOINT-MIDDLE-INIT    PIC X.
   205     12  VD-INSURED-ADDRESS-1       PIC X(30).
   206     12  VD-INSURED-ADDRESS-2       PIC X(30).
   207     12  VD-INSURED-CITY-STATE.
   208         20  VD-INSURED-CITY        PIC X(28).
   209         20  VD-INSURED-STATE       PIC XX.
   210     12  VD-INSURED-ZIP-CODE.
   211         20  VD-INSURED-ZIP-PRIME.
   212             24  VD-INSURED-ZIP-1   PIC X.
   213                 88  VD-CANADIAN-POST-CODE
   214                                       VALUE 'A' THRU 'Z'.
   215             24  FILLER             PIC X(4).
   216         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   217     12  VD-BENEFICIARY-NAME        PIC X(30).
   218     12  VD-ACCOUNT-NAME            PIC X(30).
   219     12  VD-LOAN-TERM               PIC S999   COMP-3.
   220     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   221     12  VD-1ST-PMT-DT              PIC XX.
   222     12  VD-LIFE-BENEFIT-CD         PIC XX.
   223         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   224         88  VD-INVALID-LIFE           VALUE '  ' '00'
   225                                             '90' THRU '99'.
   226     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   227                                    PIC XX.
   228     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   229     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   230     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   231     12  VD-LF-TERM                 PIC S999   COMP-3.
   232     12  VD-AH-BENEFIT-CD           PIC XX.
   233         88  VD-VALID-AH               VALUE '01' THRU '89'.
   234         88  VD-INVALID-AH             VALUE '  ' '00'
   235                                             '90' THRU '99'.
   236     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   237     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   238     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   239     12  VD-AH-TERM                 PIC S999   COMP-3.
   240     12  VD-LETTER-ID               PIC X(4).
   241     12  VD-PROC-ID                 PIC X(4).
   242     12  VD-COMP-ID                 PIC X(3).
   243     12  VD-CURRENT-DATE            PIC XX.
   244     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   245     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   6
* NSRASBL.cbl
   246     12  FILLER                     PIC X(32).
   247 01  WS-PASS-AREA.
   248     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   249     05  WS-PASS-VADS-REC    PIC X(350).
   250
   251*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   252*                         COPY ELCZREC.
   253******************************************************************
   254*                                                                *
   255*                                                                *
   256*                            ELCZREC.                            *
   257*                                                                *
   258*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   259*                                                                *
   260******************************************************************
   261*-----------------------------------------------------------------
   262*                   C H A N G E   L O G
   263*
   264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   265*-----------------------------------------------------------------
   266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   267* EFFECTIVE    NUMBER
   268*-----------------------------------------------------------------
   269* 122011    2011022800001  AJRA  NEW FILE
   270* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   271* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   272*-----------------------------------------------------------------
   273 01  W-Z-CONTROL-DATA.
   274     05  W-NUMBER-OF-COPIES      PIC  9.
   275     05  FILLER                  PIC  X.
   276     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   277     05  FILLER                  PIC  X.
   278     05  W-DAYS-TO-RESEND        PIC  999.
   279     05  FILLER                  PIC  X.
   280     05  W-FORM-TO-RESEND        PIC  X(4).
   281     05  FILLER                  PIC  X.
   282     05  W-PROMPT-LETTER         PIC  X.
   283     05  FILLER                  PIC  X.
   284     05  W-ENCLOSURE-CD          PIC  XXX.
   285     05  FILLER                  PIC  X.
   286     05  W-AUTO-CLOSE-IND        PIC  X.
   287     05  FILLER                  PIC  X.
   288     05  W-LETTER-TO-BENE        PIC  X.
   289     05  FILLER                  PIC  X.
   290     05  W-LETTER-TO-ACCT        PIC  X.
   291     05  FILLER                  PIC  X.
   292     05  W-LETTER-TYPE           PIC  X.
   293     05  FILLER                  PIC  X.
   294     05  W-PRINT-CERTIFICATE     PIC  X.
   295     05  FILLER                  PIC  X.
   296     05  W-REFUND-REQUIRED       PIC  X.
   297     05  FILLER                  PIC  X.
   298     05  W-ONBASE-CODE           PIC  XX.
   299     05  FILLER                  PIC  X.
   300     05  W-ACCT-SUMM             PIC  X.
   301     05  FILLER                  PIC  X.
   302     05  W-CSO-SUMM              PIC  X.
   303     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   7
* NSRASBL.cbl
   304     05  W-REASONS-REQUIRED      PIC  X.
   305     05  FILLER                  PIC  X(29).
   306 01  MISC.
   307     12  WS-RESPONSE             PIC S9(8)   COMP.
   308         88  RESP-NORMAL                  VALUE +00.
   309         88  RESP-NOTFND                  VALUE +13.
   310         88  RESP-DUPREC                  VALUE +14.
   311         88  RESP-DUPKEY                  VALUE +15.
   312         88  RESP-NOTOPEN                 VALUE +19.
   313         88  RESP-ENDFILE                 VALUE +20.
   314 01  srch-commarea.
   315*                                copy ELCADLTRSPI.
   316******************************************************************
   317*                   C H A N G E   L O G
   318*
   319* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   320*-----------------------------------------------------------------
   321*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   322* EFFECTIVE    NUMBER
   323*-----------------------------------------------------------------
   324* 060611    2011022800001  PEMA  NEW COPYBOOK
   325* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   326* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   327******************************************************************
   328****************************************
   329*  commarea for NaperSoft On Demand Admin services letters
   330*  (business logic input & output)
   331****************************************
   332     03  BL-INPUT.
   333         05  BL-DATA-SRCE        PIC X.
   334         05  BL-LETTER-ID        PIC XXXX.
   335         05  BL-CARRIER          PIC X.
   336         05  BL-GROUP            PIC X(6).
   337         05  BL-STATE            PIC XX.
   338         05  BL-ACCOUNT          PIC X(10).
   339         05  BL-EFF-DT           PIC X(10).
   340         05  BL-CERT-NO          PIC X(11).
   341         05  BL-BATCH-NO         PIC X(6).
   342         05  BL-BATCH-SEQ        PIC 9(8).
   343         05  BL-RESP-NO          PIC X(10).
   344         05  BL-NO-OF-COPIES     PIC 99.
   345         05  BL-PROC-ID          PIC XXXX.
   346         05  BL-COMP-ID          PIC XXX.
   347         05  BL-PRINT-NOW-SW     PIC X.
   348         05  BL-ENC-CD           PIC XXX.
   349         05  BL-RESEND-DT        PIC X(10).
   350         05  BL-FOLLOW-UP-DT     PIC X(10).
   351         05  BL-ARCHIVE-NO       PIC 9(8).
   352         05  BL-FUNC             PIC X(8).
   353         05  BL-COMMENTS         PIC X(100).
   354         05  FILLER REDEFINES BL-COMMENTS.
   355             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   356             10  BL-LETTER-TO-ACCT PIC X.
   357             10  BL-LETTER-TO-BENE PIC X.
   358             10  BL-WRITE-ERARCH   PIC X.
   359                 88  ERARCH-QWS      VALUE 'Q'.
   360                 88  ERARCH-BATCH    VALUE 'B'.
   361                 88  ERARCH-TEMP     VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   8
* NSRASBL.cbl
   362             10  BL-PROCESS-TYPE PIC X(07).
   363             10  BL-CERT-FORM-ID PIC X(05).
   364             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   365             10  BL-SOURCE-SCREEN PIC X(8).
   366             10  FILLER          PIC X(25).
   367     03  BL-OUTPUT.
   368         05  BL-STATUS                   PIC X.
   369             88  BL-OK                      VALUE "P".
   370             88  BL-FAIL                  VALUE "F".
   371         05  BL-MESSAGE          PIC X(50).
   372     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   373     03  FILLER                  PIC X(31).
   374 01  filler                      pic x(500).
   375 01  WS-SAVE-CARRIER-INFO.
   376     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   377     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   378     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   379     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   380     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   381     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   382     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   383     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   384 01  WS-SAVE-STATE-INFO.
   385     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   386     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   387 01  WS-SAVE-LFBEN-INFO.
   388     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   389     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   390     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   391 01  WS-SAVE-AHBEN-INFO.
   392     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   393     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   394     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   395     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   396 01  WS-ERPNDB-KEY.
   397     05  WS-ERPNDB-COMPANY-CD    PIC X.
   398     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   399     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   400     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   401 01  WS-ELENCC-KEY.
   402     05  WS-ELENCC-COMPANY-CD    PIC X.
   403     05  WS-ELENCC-REC-TYPE      PIC X.
   404     05  WS-ELENCC-ENC-CODE      PIC X(5).
   405     05  F                       PIC X(9).
   406 01  WS-ELCERT-KEY.
   407     05  WS-ELCERT-COMPANY-CD    PIC X.
   408     05  WS-ELCERT-CARRIER       PIC X.
   409     05  WS-ELCERT-GROUP         PIC X(6).
   410     05  WS-ELCERT-STATE         PIC XX.
   411     05  WS-ELCERT-ACCOUNT       PIC X(10).
   412     05  WS-ELCERT-EFF-DT        PIC XX.
   413     05  WS-ELCERT-CERT-NO       PIC X(11).
   414 01  WS-ELCRTT-KEY.
   415     05  WS-ELCRTT-PRIMARY       PIC X(33).
   416     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   417
   418 01  WS-ERENDT-KEY.
   419     05  WS-ERENDT-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page   9
* NSRASBL.cbl
   420     05  WS-ERENDT-CARRIER       PIC X.
   421     05  WS-ERENDT-GROUP         PIC X(6).
   422     05  WS-ERENDT-STATE         PIC XX.
   423     05  WS-ERENDT-ACCOUNT       PIC X(10).
   424     05  WS-ERENDT-EFF-DT        PIC XX.
   425     05  WS-ERENDT-CERT-NO       PIC X(11).
   426     05  WS-ERENDT-REC-TYPE      PIC X.
   427     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   428
   429 01  WS-ERENDT-KEY-BY-ARCH.
   430     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   431     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   432 01  WS-ERCOMP-KEY.
   433     05  WS-ERCOMP-COMPANY-CD    PIC X.
   434     05  WS-ERCOMP-CARRIER       PIC X.
   435     05  WS-ERCOMP-GROUP         PIC X(6).
   436     05  WS-ERCOMP-RESP-NO       PIC X(10).
   437     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   438     05  WS-ERCOMP-REC-TYPE      PIC X.
   439 01  WS-ERMAIL-KEY.
   440     05  WS-ERMAIL-COMPANY-CD    PIC X.
   441     05  WS-ERMAIL-CARRIER       PIC X.
   442     05  WS-ERMAIL-GROUP         PIC X(6).
   443     05  WS-ERMAIL-STATE         PIC XX.
   444     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   445     05  WS-ERMAIL-EFF-DT        PIC XX.
   446     05  WS-ERMAIL-CERT-NO       PIC X(11).
   447 01  WS-ERACCT-KEY.
   448     05  WS-ERACCT-COMPANY-CD    PIC X.
   449     05  WS-ERACCT-CARRIER       PIC X.
   450     05  WS-ERACCT-GROUP         PIC X(6).
   451     05  WS-ERACCT-STATE         PIC XX.
   452     05  WS-ERACCT-ACCOUNT       PIC X(10).
   453     05  WS-ERACCT-EXP-DT        PIC XX.
   454     05  FILLER                  PIC XXXX.
   455 01  WS-ELLETR-KEY.
   456     05  WS-ELLETR-COMPANY-CD    PIC X.
   457     05  WS-ELLETR-LETTER-ID     PIC X(12).
   458     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   459 01  WS-ELCNTL-KEY.
   460     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   461     05  WS-ELCNTL-REC-TYPE      PIC X.
   462     05  WS-ELCNTL-GENL.
   463         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   464         10  WS-ELCNTL-BEN-CD.
   465             15  F               PIC X.
   466             15  WS-ELCNTL-CARR  PIC X.
   467     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   468*                                COPY ELCDATE.
   469******************************************************************
   470*                                                                *
   471*                                                                *
   472*                            ELCDATE.                            *
   473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   474*                            VMOD=2.003
   475*                                                                *
   476*                                                                *
   477*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  10
* NSRASBL.cbl
   478*                 LENGTH = 200                                   *
   479******************************************************************
   480
   481 01  DATE-CONVERSION-DATA.
   482     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   483     12  DC-OPTION-CODE                PIC X.
   484         88  BIN-TO-GREG                VALUE ' '.
   485         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   486         88  EDIT-GREG-TO-BIN           VALUE '2'.
   487         88  YMD-GREG-TO-BIN            VALUE '3'.
   488         88  MDY-GREG-TO-BIN            VALUE '4'.
   489         88  JULIAN-TO-BIN              VALUE '5'.
   490         88  BIN-PLUS-ELAPSED           VALUE '6'.
   491         88  FIND-CENTURY               VALUE '7'.
   492         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   493         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   494         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   495         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   496         88  JULIAN-TO-BIN-3            VALUE 'C'.
   497         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   498         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   499         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   500         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   501         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   502         88  CHECK-LEAP-YEAR            VALUE 'H'.
   503         88  BIN-3-TO-GREG              VALUE 'I'.
   504         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   505         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   506         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   507         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   508         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   509         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   510         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   511         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   512         88  THREE-CHARACTER-BIN
   513                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   514         88  GREGORIAN-TO-BIN
   515                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   516         88  BIN-TO-GREGORIAN
   517                  VALUES ' ' '1' 'I' '8' 'G'.
   518         88  JULIAN-TO-BINARY
   519                  VALUES '5' 'C' 'E' 'F'.
   520     12  DC-ERROR-CODE                 PIC X.
   521         88  NO-CONVERSION-ERROR        VALUE ' '.
   522         88  DATE-CONVERSION-ERROR
   523                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   524         88  DATE-IS-ZERO               VALUE '1'.
   525         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   526         88  DATE-IS-INVALID            VALUE '3'.
   527         88  DATE1-GREATER-DATE2        VALUE '4'.
   528         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   529         88  DATE-INVALID-OPTION        VALUE '9'.
   530         88  INVALID-CENTURY            VALUE 'A'.
   531         88  ONLY-CENTURY               VALUE 'B'.
   532         88  ONLY-LEAP-YEAR             VALUE 'C'.
   533         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   534     12  DC-END-OF-MONTH               PIC X.
   535         88  CALCULATE-END-OF-MONTH     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  11
* NSRASBL.cbl
   536     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   537         88  USE-NORMAL-PROCESS         VALUE ' '.
   538         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   539         88  ADJUST-UP-100-YRS          VALUE '2'.
   540     12  FILLER                        PIC X.
   541     12  DC-CONVERSION-DATES.
   542         16  DC-BIN-DATE-1             PIC XX.
   543         16  DC-BIN-DATE-2             PIC XX.
   544         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   545         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   546                       DC-GREG-DATE-1-EDIT.
   547             20  DC-EDIT1-MONTH        PIC 99.
   548             20  SLASH1-1              PIC X.
   549             20  DC-EDIT1-DAY          PIC 99.
   550             20  SLASH1-2              PIC X.
   551             20  DC-EDIT1-YEAR         PIC 99.
   552         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   553         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   554                     DC-GREG-DATE-2-EDIT.
   555             20  DC-EDIT2-MONTH        PIC 99.
   556             20  SLASH2-1              PIC X.
   557             20  DC-EDIT2-DAY          PIC 99.
   558             20  SLASH2-2              PIC X.
   559             20  DC-EDIT2-YEAR         PIC 99.
   560         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   561         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   562                     DC-GREG-DATE-1-YMD.
   563             20  DC-YMD-YEAR           PIC 99.
   564             20  DC-YMD-MONTH          PIC 99.
   565             20  DC-YMD-DAY            PIC 99.
   566         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   567         16  DC-GREG-DATE-1-MDY-R REDEFINES
   568                      DC-GREG-DATE-1-MDY.
   569             20  DC-MDY-MONTH          PIC 99.
   570             20  DC-MDY-DAY            PIC 99.
   571             20  DC-MDY-YEAR           PIC 99.
   572         16  DC-GREG-DATE-1-ALPHA.
   573             20  DC-ALPHA-MONTH        PIC X(10).
   574             20  DC-ALPHA-DAY          PIC 99.
   575             20  FILLER                PIC XX.
   576             20  DC-ALPHA-CENTURY.
   577                 24 DC-ALPHA-CEN-N     PIC 99.
   578             20  DC-ALPHA-YEAR         PIC 99.
   579         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   580         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   581         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   582         16  DC-JULIAN-DATE            PIC 9(05).
   583         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   584                                       PIC 9(05).
   585         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   586             20  DC-JULIAN-YEAR        PIC 99.
   587             20  DC-JULIAN-DAYS        PIC 999.
   588         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   589         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   590         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   591     12  DATE-CONVERSION-VARIBLES.
   592         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   593         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  12
* NSRASBL.cbl
   594             20  FILLER                PIC 9(3).
   595             20  HOLD-CEN-1-CCYY.
   596                 24  HOLD-CEN-1-CC     PIC 99.
   597                 24  HOLD-CEN-1-YY     PIC 99.
   598             20  HOLD-CEN-1-MO         PIC 99.
   599             20  HOLD-CEN-1-DA         PIC 99.
   600         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   601             20  HOLD-CEN-1-R-MO       PIC 99.
   602             20  HOLD-CEN-1-R-DA       PIC 99.
   603             20  HOLD-CEN-1-R-CCYY.
   604                 24  HOLD-CEN-1-R-CC   PIC 99.
   605                 24  HOLD-CEN-1-R-YY   PIC 99.
   606             20  FILLER                PIC 9(3).
   607         16  HOLD-CENTURY-1-X.
   608             20  FILLER                PIC X(3)  VALUE SPACES.
   609             20  HOLD-CEN-1-X-CCYY.
   610                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   611                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   612             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   613             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   614         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   615             20  HOLD-CEN-1-R-X-MO     PIC XX.
   616             20  HOLD-CEN-1-R-X-DA     PIC XX.
   617             20  HOLD-CEN-1-R-X-CCYY.
   618                 24  HOLD-CEN-1-R-X-CC PIC XX.
   619                 24  HOLD-CEN-1-R-X-YY PIC XX.
   620             20  FILLER                PIC XXX.
   621         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   622         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   623         16  DC-JULIAN-DATE-1          PIC 9(07).
   624         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   625             20  DC-JULIAN-1-CCYY.
   626                 24  DC-JULIAN-1-CC    PIC 99.
   627                 24  DC-JULIAN-1-YR    PIC 99.
   628             20  DC-JULIAN-DA-1        PIC 999.
   629         16  DC-JULIAN-DATE-2          PIC 9(07).
   630         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   631             20  DC-JULIAN-2-CCYY.
   632                 24  DC-JULIAN-2-CC    PIC 99.
   633                 24  DC-JULIAN-2-YR    PIC 99.
   634             20  DC-JULIAN-DA-2        PIC 999.
   635         16  DC-GREG-DATE-A-EDIT.
   636             20  DC-EDITA-MONTH        PIC 99.
   637             20  SLASHA-1              PIC X VALUE '/'.
   638             20  DC-EDITA-DAY          PIC 99.
   639             20  SLASHA-2              PIC X VALUE '/'.
   640             20  DC-EDITA-CCYY.
   641                 24  DC-EDITA-CENT     PIC 99.
   642                 24  DC-EDITA-YEAR     PIC 99.
   643         16  DC-GREG-DATE-B-EDIT.
   644             20  DC-EDITB-MONTH        PIC 99.
   645             20  SLASHB-1              PIC X VALUE '/'.
   646             20  DC-EDITB-DAY          PIC 99.
   647             20  SLASHB-2              PIC X VALUE '/'.
   648             20  DC-EDITB-CCYY.
   649                 24  DC-EDITB-CENT     PIC 99.
   650                 24  DC-EDITB-YEAR     PIC 99.
   651         16  DC-GREG-DATE-CYMD         PIC 9(08).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  13
* NSRASBL.cbl
   652         16  DC-GREG-DATE-CYMD-R REDEFINES
   653                              DC-GREG-DATE-CYMD.
   654             20  DC-CYMD-CEN           PIC 99.
   655             20  DC-CYMD-YEAR          PIC 99.
   656             20  DC-CYMD-MONTH         PIC 99.
   657             20  DC-CYMD-DAY           PIC 99.
   658         16  DC-GREG-DATE-MDCY         PIC 9(08).
   659         16  DC-GREG-DATE-MDCY-R REDEFINES
   660                              DC-GREG-DATE-MDCY.
   661             20  DC-MDCY-MONTH         PIC 99.
   662             20  DC-MDCY-DAY           PIC 99.
   663             20  DC-MDCY-CEN           PIC 99.
   664             20  DC-MDCY-YEAR          PIC 99.
   665    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   666        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   667    12  DC-EL310-DATE                  PIC X(21).
   668    12  FILLER                         PIC X(28).
   669*                                COPY NSCASEXTR.
   670******************************************************************
   671*                                                                *
   672*                                                                *
   673*                            NSCASEXTR.                          *
   674*                            VMOD=2.001                          *
   675*                                                                *
   676*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   677*                                                                *
   678*   FILE TYPE = VSAM,KSDS                                        *
   679*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   680*                                                                *
   681*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   682*                                                                *
   683*   LOG = NO                                                     *
   684*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   685******************************************************************
   686*-----------------------------------------------------------------
   687*                   C H A N G E   L O G
   688*
   689* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   690*-----------------------------------------------------------------
   691*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   692* EFFECTIVE    NUMBER
   693*-----------------------------------------------------------------
   694* 072211    2011022800001  PEMA  NEW FILE
   695*-----------------------------------------------------------------
   696 01 NSAS-EXTRACT-RECORD.
   697    05  NSAS-CONTROL-PRIMARY.
   698        10  NSAS-COMPANY-CD      PIC X.
   699        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   700        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   701    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   702    05  FILLER                   PIC X(143).
   703*                                COPY ERCPNDB.
   704******************************************************************
   705*                                                                *
   706*                                                                *
   707*                            ERCPNDB.                            *
   708*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   709*                            VMOD=2.025                          *
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  14
* NSRASBL.cbl
   710*                                                                *
   711*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   712*                                                                *
   713******************************************************************
   714*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   715*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   716******************************************************************
   717*                                                                *
   718*                                                                *
   719*   FILE TYPE = VSAM,KSDS                                        *
   720*   RECORD SIZE = 585  RECFORM = FIXED                           *
   721*                                                                *
   722*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   723*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   724*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   725*                                                 RKP=13,LEN=36  *
   726*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   727*                                      AND CHG-SEQ.)             *
   728*                                                RKP=49,LEN=11   *
   729*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   730*                                      AND CHG-SEQ.)             *
   731*                                                RKP=60,LEN=15   *
   732*                                                                *
   733*   LOG = NO                                                     *
   734*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   735******************************************************************
   736******************************************************************
   737*                   C H A N G E   L O G
   738*
   739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   740*-----------------------------------------------------------------
   741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   742* EFFECTIVE    NUMBER
   743*-----------------------------------------------------------------
   744* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   745* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   746* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   747* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   748* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   749* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   750* 032306                   PEMA  ADD BOW LOAN NUMBER
   751* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   752* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   753* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   754* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   755* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   756* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   757* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   758* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   759******************************************************************
   760
   761 01  PENDING-BUSINESS.
   762     12  PB-RECORD-ID                     PIC XX.
   763         88  VALID-PB-ID                        VALUE 'PB'.
   764
   765     12  PB-CONTROL-PRIMARY.
   766         16  PB-COMPANY-CD                PIC X.
   767         16  PB-ENTRY-BATCH               PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  15
* NSRASBL.cbl
   768         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   769         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   770
   771     12  PB-CONTROL-BY-ACCOUNT.
   772         16  PB-COMPANY-CD-A1             PIC X.
   773         16  PB-CARRIER                   PIC X.
   774         16  PB-GROUPING.
   775             20  PB-GROUPING-PREFIX       PIC XXX.
   776             20  PB-GROUPING-PRIME        PIC XXX.
   777         16  PB-STATE                     PIC XX.
   778         16  PB-ACCOUNT.
   779             20  PB-ACCOUNT-PREFIX        PIC X(4).
   780             20  PB-ACCOUNT-PRIME         PIC X(6).
   781         16  PB-CERT-EFF-DT               PIC XX.
   782         16  PB-CERT-NO.
   783             20  PB-CERT-PRIME            PIC X(10).
   784             20  PB-CERT-SFX              PIC X.
   785         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   786
   787         16  PB-RECORD-TYPE               PIC X.
   788             88  PB-MAILING-DATA                VALUE '0'.
   789             88  PB-ISSUE                       VALUE '1'.
   790             88  PB-CANCELLATION                VALUE '2'.
   791             88  PB-BATCH-TRAILER               VALUE '9'.
   792
   793     12  PB-CONTROL-BY-ORIG-BATCH.
   794         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   795         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   796         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   797         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   798
   799     12  PB-CONTROL-BY-CSR.
   800         16  PB-CSR-COMPANY-CD            PIC X.
   801         16  PB-CSR-ID                    PIC X(4).
   802         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   803         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   804         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   805******************************************************************
   806*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   807******************************************************************
   808
   809     12  PB-LAST-MAINT-DT                 PIC XX.
   810     12  PB-LAST-MAINT-BY                 PIC X(4).
   811     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   812
   813     12  PB-RECORD-BODY                   PIC X(375).
   814
   815     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   816         16  PB-CERT-ORIGIN               PIC X.
   817             88  CLASIC-CREATED-CERT         VALUE '1'.
   818         16  PB-I-NAME.
   819             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   820             20  PB-I-INSURED-FIRST-NAME.
   821                 24  PB-I-INSURED-1ST-INIT PIC X.
   822                 24  FILLER                PIC X(9).
   823             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   824         16  PB-I-AGE                     PIC S99   COMP-3.
   825         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  16
* NSRASBL.cbl
   826         16  PB-I-BIRTHDAY                PIC XX.
   827         16  PB-I-INSURED-SEX             PIC X.
   828             88  PB-SEX-MALE     VALUE 'M'.
   829             88  PB-SEX-FEMALE   VALUE 'F'.
   830
   831         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   832         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   833         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   834         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   835         16  PB-I-SKIP-CODE               PIC X.
   836             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   837             88  PB-SKIP-JULY              VALUE '1'.
   838             88  PB-SKIP-AUGUST            VALUE '2'.
   839             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   840             88  PB-SKIP-JULY-AUG          VALUE '4'.
   841             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   842             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   843             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   844             88  PB-SKIP-JUNE              VALUE '8'.
   845             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   846             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   847             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   848         16  PB-I-TERM-TYPE               PIC X.
   849             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   850             88  PB-PAID-WEEKLY            VALUE 'W'.
   851             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   852             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   853             88  PB-PAID-13-YEARLY         VALUE 'T'.
   854         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   855         16  PB-I-POLICY-FORM-NO          PIC X(12).
   856         16  PB-I-DATA-ENTRY-SW           PIC X.
   857             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   858             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   859             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   860             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   861         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   862         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   863*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   864         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   865         16  FILLER                       PIC X.
   866
   867         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   868             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   869             88  PB-INVALID-LIFE             VALUE '  ' '00'
   870                                                   '90' THRU '99'.
   871         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   872                                          PIC XX.
   873         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   874         16  PB-I-AMOUNT-FINANCED REDEFINES
   875                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   876         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   877         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   878                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   879         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   880         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   881         16  PB-I-CLP-AMOUNT REDEFINES
   882                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   883         16  PB-I-LF-CALC-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  17
* NSRASBL.cbl
   884             88 PB-COMP-LF-PREM               VALUE '?'.
   885         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   886         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   887         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   888         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   889         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   890         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   891         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   892         16  PB-I-LF-ABBR                 PIC XXX.
   893         16  PB-I-LF-INPUT-CD             PIC XX.
   894
   895         16  PB-I-AH-BENEFIT-CD           PIC XX.
   896             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   897             88  PB-INVALID-AH               VALUE '  ' '00'
   898                                                   '90' THRU '99'.
   899         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   900         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   901         16  PB-I-AH-CALC-FLAG            PIC X.
   902             88 PB-COMP-AH-PREM                  VALUE '?'.
   903         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   904         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   905         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   906         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   907         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   908         16  PB-I-AH-ABBR                 PIC XXX.
   909         16  PB-I-AH-INPUT-CD             PIC XXX.
   910
   911         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   912         16  PB-I-REIN-TABLE              PIC XXX.
   913         16  PB-I-BUSINESS-TYPE           PIC 99.
   914         16  PB-I-INDV-GRP-CD             PIC X.
   915         16  PB-I-MORT-CODE.
   916             20  PB-I-TABLE               PIC X.
   917             20  PB-I-INTEREST            PIC XX.
   918             20  PB-I-MORT-TYP            PIC X.
   919         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   920         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   921         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   922         16  PB-I-INDV-GRP-OVRD           PIC X.
   923         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   924         16  PB-I-SIG-SW                  PIC X.
   925             88  PB-POLICY-SIGNED             VALUE 'Y'.
   926         16  PB-I-RATE-CLASS              PIC XX.
   927         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   928         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   929         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   930         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   931         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   932         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   933         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   934         16  PB-I-BENEFIT-TYPE            PIC XXX.
   935         16  PB-I-OB-FLAG                 PIC X.
   936             88  PB-I-OB                      VALUE 'B'.
   937             88  PB-I-SUMMARY                 VALUE 'Z'.
   938         16  PB-I-ENTRY-STATUS            PIC X.
   939             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   940                                              'M' '5' '9' '2'.
   941             88  PB-I-NORMAL-ENTRY            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  18
* NSRASBL.cbl
   942             88  PB-I-POLICY-PENDING          VALUE '2'.
   943             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   944             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   945             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   946             88  PB-I-REIN-ONLY               VALUE '9'.
   947             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   948             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   949             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   950             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   951         16  PB-I-INT-CODE                PIC X.
   952             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   953             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   954         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   955         16  PB-I-SOC-SEC-NO              PIC X(11).
   956         16  PB-I-MEMBER-NO               PIC X(12).
   957         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   958*        16  PB-I-LOAN-OFFICER            PIC XXX.
   959         16  PB-I-OLD-LOF                 PIC XXX.
   960         16  PB-I-LF-EXPIRE-DT            PIC XX.
   961         16  PB-I-AH-EXPIRE-DT            PIC XX.
   962         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   963         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   964         16  PB-I-LIFE-INDICATOR          PIC X.
   965             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   966         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   967         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   968                                          PIC S9(5)V99    COMP-3.
   969         16  PB-I-MAIL-ADDRS-SW           PIC X.
   970             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   971             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   972         16  PB-I-1ST-PMT-DT              PIC XX.
   973         16  PB-I-JOINT-INSURED.
   974             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   975             20 PB-I-JOINT-FIRST-NAME.
   976                24  PB-I-JOINT-FIRST-INIT PIC X.
   977                24  FILLER                PIC X(9).
   978             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   979*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   980         16  PB-I-BENEFICIARY-NAME.
   981             20  PB-I-BANK-NUMBER         PIC X(10).
   982             20  FILLER                   PIC X(15).
   983         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   984         16  PB-I-REFERENCE               PIC X(12).
   985         16  FILLER REDEFINES PB-I-REFERENCE.
   986             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   987             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   988             20  PB-I-CLP-STATE           PIC XX.
   989         16  PB-I-UNDERWRITING-STATUS     PIC X.
   990             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   991             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   992             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   993         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   994         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   995         16  PB-I-RESIDENT-STATE          PIC XX.
   996         16  PB-I-RATE-CODE               PIC X(4).
   997         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   998         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   999         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  19
* NSRASBL.cbl
  1000         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1001         16  PB-I-BANK-NOCHRGB            PIC 99.
  1002         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1003         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1004
  1005     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1006         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1007             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1008         16  PB-C-CANCEL-ORIGIN           PIC X.
  1009             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1010         16  PB-C-LF-CANCEL-DT            PIC XX.
  1011         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1012         16  PB-C-LF-CALC-REQ             PIC X.
  1013             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1014         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1015         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1016         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1017             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1018         16  PB-C-AH-CANCEL-DT            PIC XX.
  1019         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1020         16  PB-C-AH-CALC-REQ             PIC X.
  1021             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1022         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1023         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1024         16  PB-C-LAST-NAME               PIC X(15).
  1025         16  PB-C-REFUND-SW               PIC X.
  1026             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1027             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1028         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1029         16  PB-C-PAYEE-CODE              PIC X(6).
  1030         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1031         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1032         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1033         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1034         16  PB-C-REFERENCE               PIC X(12).
  1035         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1036         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1037         16  PB-C-POST-CARD-IND           PIC X.
  1038         16  PB-C-CANCEL-REASON           PIC X.
  1039         16  PB-C-REF-INTERFACE-SW        PIC X.
  1040         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1041         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1042         16  FILLER                       PIC X(01).
  1043*        16  FILLER                       PIC X(18).
  1044         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1045*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1046         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1047         16  PB-CANCELED-CERT-DATA.
  1048             20  PB-CI-INSURED-NAME.
  1049                 24  PB-CI-LAST-NAME      PIC X(15).
  1050                 24  PB-CI-INITIALS       PIC XX.
  1051             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1052             20  PB-CI-INSURED-SEX        PIC X.
  1053             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1054             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1055             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1056             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1057             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  20
* NSRASBL.cbl
  1058             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1059             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1060             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1061             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1062             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1063             20  PB-CI-RATE-CLASS         PIC XX.
  1064             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1065             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1066             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1067             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1068             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1069             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1070             20  PB-CI-LF-ABBR            PIC X(3).
  1071             20  PB-CI-AH-ABBR            PIC X(3).
  1072             20  PB-CI-OB-FLAG            PIC X.
  1073                 88  PB-CI-OB                VALUE 'B'.
  1074             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1075                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1076                                           'M' '4' '5' '9' '2'.
  1077                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1078                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1079                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1080                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1081                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1082                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1083                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1084                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1085                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1086                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1087                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1088                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1089             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1090                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1091                                           'M' '4' '5' '9' '2'.
  1092                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1093                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1094                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1095                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1096                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1097                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1098                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1099                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1100                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1101                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1102                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1103                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1104             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1105             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1106             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1107             20  PB-CI-MEMBER-NO          PIC X(12).
  1108             20  PB-CI-INT-CODE           PIC X.
  1109                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1110                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1111             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1112             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1113             20  PB-CI-COMP-EXCP-SW       PIC X.
  1114                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1115                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  21
* NSRASBL.cbl
  1116             20  PB-CI-ENTRY-STATUS       PIC X.
  1117             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1118             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1119             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1120             20  PB-CI-DEATH-DT           PIC XX.
  1121             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1122             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1123             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1124             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1125             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1126             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1127             20  PB-CI-ENTRY-DT              PIC XX.
  1128             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1129             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1130             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1131             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1132             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1133             20  PB-CI-OLD-LOF               PIC XXX.
  1134*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1135             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1136             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1137             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1138             20  PB-CI-INDV-GRP-CD           PIC X.
  1139             20  PB-CI-BENEFICIARY-NAME.
  1140                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1141                 24  FILLER                  PIC X(15).
  1142             20  PB-CI-NOTE-SW               PIC X.
  1143             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1144             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1145             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1146             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1147             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1148             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1149             20  PB-CI-FIRST-NAME            PIC X(10).
  1150             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1151
  1152         16  FILLER                       PIC X(13).
  1153*032306  16  FILLER                       PIC X(27).
  1154*        16  FILLER                       PIC X(46).
  1155
  1156     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1157         16  FILLER                       PIC X(10).
  1158         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1159         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1160         16  PB-M-INSURED-MID-INIT        PIC X.
  1161         16  PB-M-INSURED-AGE             PIC 99.
  1162         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1163         16  PB-M-INSURED-SEX             PIC X.
  1164         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1165         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1166         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1167         16  PB-M-INSURED-CITY-STATE.
  1168             20  PB-M-INSURED-CITY        PIC X(28).
  1169             20  PB-M-INSURED-STATE       PIC XX.
  1170         16  PB-M-INSURED-ZIP-CODE.
  1171             20  PB-M-INSURED-ZIP-PRIME.
  1172                 24  PB-M-INSURED-ZIP-1   PIC X.
  1173                     88  PB-M-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  22
* NSRASBL.cbl
  1174                                             VALUE 'A' THRU 'Z'.
  1175                 24  FILLER               PIC X(4).
  1176             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1177         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1178                                        PB-M-INSURED-ZIP-CODE.
  1179             20  PM-M-INS-CAN-POST1       PIC XXX.
  1180             20  PM-M-INS-CAN-POST2       PIC XXX.
  1181             20  FILLER                   PIC XXX.
  1182         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1183         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1184         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1185         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1186         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1187         16  PB-M-CRED-BENE-CITYST.
  1188             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1189             20  PB-M-CRED-BENE-STATE     PIC XX.
  1190         16  FILLER                       PIC X(92).
  1191
  1192     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1193         16  FILLER                       PIC X(10).
  1194         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1195         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1196         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1197         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1198         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1199         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1200         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1201         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1202         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1203         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1204         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1205         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1206         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1207         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1208         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1209         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1210         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1211         16  PB-ACCOUNT-NAME              PIC X(30).
  1212         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1213         16  PB-REFERENCE                 PIC X(12).
  1214         16  PB-B-RECEIVED-DT             PIC XX.
  1215         16  FILLER                       PIC X(234).
  1216
  1217     12  PB-RECORD-STATUS.
  1218         16  PB-CREDIT-SELECT-DT          PIC XX.
  1219         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1220         16  PB-BILLED-DT                 PIC XX.
  1221         16  PB-BILLING-STATUS            PIC X.
  1222             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1223             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1224             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1225         16  PB-RECORD-BILL               PIC X.
  1226             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1227             88  PB-RECORD-RETURNED           VALUE 'R'.
  1228             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1229             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1230             88  PB-OVERRIDE-AH               VALUE 'A'.
  1231             88  PB-OVERRIDE-BOTH             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  23
* NSRASBL.cbl
  1232         16  PB-BATCH-ENTRY               PIC X.
  1233             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1234             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1235             88  PB-REISSUED-CERT             VALUE 'E'.
  1236             88  PB-MONTHLY-CERT              VALUE 'M'.
  1237             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1238             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1239             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1240         16  PB-FORCE-CODE                PIC X.
  1241             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1242             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1243             88  PB-CANCEL-FORCE              VALUE '8'.
  1244             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1245             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1246             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1247             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1248             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1249             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1250             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1251         16  PB-FATAL-FLAG                PIC X.
  1252             88  PB-FATAL-ERRORS              VALUE 'X'.
  1253         16  PB-FORCE-ER-CD               PIC X.
  1254             88  PB-FORCE-ERRORS              VALUE 'F'.
  1255             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1256         16  PB-WARN-ER-CD                PIC X.
  1257             88  PB-WARNING-ERRORS            VALUE 'W'.
  1258         16  FILLER                       PIC X.
  1259         16  PB-OUT-BAL-CD                PIC X.
  1260             88  PB-OUT-OF-BAL                VALUE 'O'.
  1261         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1262         16  PB-AH-OVERRIDE-L1            PIC X.
  1263         16  PB-INPUT-DT                  PIC XX.
  1264         16  PB-INPUT-BY                  PIC X(4).
  1265         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1266         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1267         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1268         16  PB-LF-EARNING-METHOD         PIC X.
  1269         16  PB-AH-EARNING-METHOD         PIC X.
  1270         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1271         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1272         16  PB-REIN-CD                   PIC XXX.
  1273         16  PB-LF-REFUND-TYPE            PIC X.
  1274         16  PB-AH-REFUND-TYPE            PIC X.
  1275         16  PB-ACCT-EFF-DT               PIC XX.
  1276         16  PB-ACCT-EXP-DT               PIC XX.
  1277         16  PB-COMPANY-ID                PIC X(3).
  1278         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1279         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1280         16  PB-SV-CARRIER                PIC X.
  1281         16  PB-SV-GROUPING               PIC X(6).
  1282         16  PB-SV-STATE                  PIC XX.
  1283         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1284         16  PB-GA-BILLING-INFO.
  1285             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1286                                          PIC XX.
  1287         16  PB-SV-REMIT-TO  REDEFINES
  1288             PB-GA-BILLING-INFO           PIC X(10).
  1289         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  24
* NSRASBL.cbl
  1290         16  PB-I-LOAN-OFFICER            PIC X(5).
  1291         16  PB-I-VIN                     PIC X(17).
  1292
  1293         16  FILLER                       PIC X(04).
  1294         16  IMNET-BYPASS-SW              PIC X.
  1295
  1296******************************************************************
  1297*                COMMON EDIT ERRORS                              *
  1298******************************************************************
  1299
  1300     12  PB-COMMON-ERRORS.
  1301         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1302                                           PIC S9(4)     COMP.
  1303
  1304******************************************************************
  1305*                                COPY ERCENDT.
  1306******************************************************************
  1307*                                                                *
  1308*                                                                *
  1309*                            ERCENDT.                            *
  1310*                            VMOD=2.001                          *
  1311*                                                                *
  1312*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1313*                                                                *
  1314*   FILE TYPE = VSAM,KSDS                                        *
  1315*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1316*                                                                *
  1317*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1318*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1319*                                                                *
  1320*   LOG = NO                                                     *
  1321*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1322******************************************************************
  1323*-----------------------------------------------------------------
  1324*                   C H A N G E   L O G
  1325*
  1326* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1327*-----------------------------------------------------------------
  1328*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1329* EFFECTIVE    NUMBER
  1330*-----------------------------------------------------------------
  1331* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1332*                                WITH OPEN CLAIMS
  1333* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1334* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1335* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1336*-----------------------------------------------------------------
  1337 01  ENDORSEMENT-RECORD.
  1338     12  EN-RECORD-ID                PIC XX.
  1339         88  VALID-EN-ID                VALUE 'EN'.
  1340     12  EN-CONTROL-PRIMARY.
  1341         16  EN-COMPANY-CD           PIC X.
  1342         16  EN-CARRIER              PIC X.
  1343         16  EN-GROUPING             PIC X(6).
  1344         16  EN-STATE                PIC XX.
  1345         16  EN-ACCOUNT              PIC X(10).
  1346         16  EN-CERT-EFF-DT          PIC XX.
  1347         16  EN-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  25
* NSRASBL.cbl
  1348             20  EN-CERT-PRIME       PIC X(10).
  1349             20  EN-CERT-SFX         PIC X.
  1350         16  EN-REC-TYPE             PIC X.
  1351             88  EN-ISSUE               VALUE 'I'.
  1352             88  EN-CANCELLATION        VALUE 'C'.
  1353         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1354     12  EN-CONTROL-BY-ARCH-NO.
  1355         16  EN-COMPANY-CD-A1              PIC X.
  1356         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1357     12  EN-LAST-MAINT-DT            PIC XX.
  1358     12  EN-LAST-MAINT-BY            PIC X(4).
  1359     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1360     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1361     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1362         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1363         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1364         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1365         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1366         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1367         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1368         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1369         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1370         16  EN-LF-ORIG-BENCD        PIC XX.
  1371         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1372         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1373         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1374         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1375         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1376         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1377*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1378         16  EN-ORIG-CRED-BENE       PIC X(25).
  1379         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1380         16  FILLER                  PIC X.
  1381         16  EN-AH-ORIG-BENCD        PIC XX.
  1382         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1383         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1384         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1385         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1386*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1387*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1388         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1389         16  F                       PIC X(09).
  1390         16  EN-AH-ORIG-CP           PIC 99.
  1391         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1392         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1393         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1394         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1395         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1396         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1397         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1398         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1399         16  EN-LF-NEW-BENCD         PIC XX.
  1400         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1401         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1402         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1403         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1404         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1405         16  EN-LF-NEW-EXP-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  26
* NSRASBL.cbl
  1406         16  EN-NEW-CRED-BENE        PIC X(25).
  1407         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1408         16  FILLER                  PIC X.
  1409         16  EN-AH-NEW-BENCD         PIC XX.
  1410         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1411         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1412         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1413         16  EN-AH-NEW-EXP-DT        PIC XX.
  1414*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1415*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1416*        16  F                       PIC X(12).
  1417         16  EN-AH-NEW-CP            PIC 99.
  1418         16  EN-SIG-SW               PIC X.
  1419         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1420         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1421         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1422         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1423         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1424         16  FILLER                  PIC X(33).
  1425     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1426         16  EN-LF-ORIG-REF-DT       PIC XX.
  1427         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1428         16  EN-AH-ORIG-REF-DT       PIC XX.
  1429         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1430         16  EN-LF-NEW-REF-DT        PIC XX.
  1431         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1432         16  EN-AH-NEW-REF-DT        PIC XX.
  1433         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1434         16  EN-FLAG-CERT            PIC X.
  1435         16  EN-INS-LAST-NAME        PIC X(15).
  1436         16  EN-INS-FIRST-NAME       PIC X(10).
  1437         16  EN-INS-MIDDLE-INIT      PIC X.
  1438         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1439         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1440         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1441         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1442         16  FILLER                  PIC X(262).
  1443     12  EN-MONEY-SW             PIC X.
  1444     12  EN-HEALTH-APP           PIC X.
  1445     12  EN-VOUCHER-SW           PIC X.
  1446     12  EN-PAYEE                PIC X(14).
  1447     12  EN-INPUT-DT             PIC XX.
  1448     12  EN-PROCESS-DT           PIC XX.
  1449     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1450     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1451     12  EN-REASON-CODES.
  1452         16  F OCCURS 12.
  1453             20  EN-REASON-CODE  PIC X(4).
  1454     12  EN-TEMPLATE-USED        PIC X(8).
  1455     12  EN-DOCU-TYPE            PIC X.
  1456         88  EN-VERI-DOCU          VALUE 'V'.
  1457         88  EN-GCE-DOCU           VALUE 'G'.
  1458         88  EN-CANC-DOCU          VALUE 'C'.
  1459     12  EN-COMMENTS1            PIC X(13).
  1460     12  EN-COMMENTS2            PIC X(70).
  1461     12  EN-COMM-CHGBK           PIC X.
  1462         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1463         88  EN-CHG-ACCT           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  27
* NSRASBL.cbl
  1464     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1465     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1466     12  EN-BATCH-NUMBER         PIC X(6).
  1467     12  EN-ACCT-SUMM            PIC X.
  1468     12  EN-CSO-SUMM             PIC X.
  1469     12  FILLER                  PIC X(13).
  1470******************************************************************
  1471*                                COPY ERCMAIL.
  1472******************************************************************
  1473*                                                                *
  1474*                                                                *
  1475*                            ERCMAIL                             *
  1476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1477*                            VMOD=2.003                          *
  1478*                                                                *
  1479*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1480*                                                                *
  1481*   FILE TYPE = VSAM,KSDS                                        *
  1482*   RECORD SIZE = 374   RECFORM = FIX                            *
  1483*                                                                *
  1484*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1485*   ALTERNATE PATH    = NOT USED                                 *
  1486*                                                                *
  1487*   LOG = YES                                                    *
  1488*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1489******************************************************************
  1490*                   C H A N G E   L O G
  1491*
  1492* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1493*-----------------------------------------------------------------
  1494*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1495* EFFECTIVE    NUMBER
  1496*-----------------------------------------------------------------
  1497* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1498* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1499* 111108                   PEMA  ADD CRED BENE ADDR2
  1500******************************************************************
  1501
  1502 01  MAILING-DATA.
  1503     12  MA-RECORD-ID                      PIC XX.
  1504         88  VALID-MA-ID                       VALUE 'MA'.
  1505
  1506     12  MA-CONTROL-PRIMARY.
  1507         16  MA-COMPANY-CD                 PIC X.
  1508         16  MA-CARRIER                    PIC X.
  1509         16  MA-GROUPING.
  1510             20  MA-GROUPING-PREFIX        PIC XXX.
  1511             20  MA-GROUPING-PRIME         PIC XXX.
  1512         16  MA-STATE                      PIC XX.
  1513         16  MA-ACCOUNT.
  1514             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1515             20  MA-ACCOUNT-PRIME          PIC X(6).
  1516         16  MA-CERT-EFF-DT                PIC XX.
  1517         16  MA-CERT-NO.
  1518             20  MA-CERT-PRIME             PIC X(10).
  1519             20  MA-CERT-SFX               PIC X.
  1520
  1521     12  FILLER                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  28
* NSRASBL.cbl
  1522
  1523     12  MA-ACCESS-CONTROL.
  1524         16  MA-SOURCE-SYSTEM              PIC XX.
  1525             88  MA-FROM-CREDIT                VALUE 'CR'.
  1526             88  MA-FROM-VSI                   VALUE 'VS'.
  1527             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1528             88  MA-FROM-OTHER                 VALUE 'OT'.
  1529         16  MA-RECORD-ADD-DT              PIC XX.
  1530         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1531         16  MA-LAST-MAINT-DT              PIC XX.
  1532         16  MA-LAST-MAINT-BY              PIC XXXX.
  1533         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1534
  1535     12  MA-PROFILE-INFO.
  1536         16  MA-QUALIFY-CODE-1             PIC XX.
  1537         16  MA-QUALIFY-CODE-2             PIC XX.
  1538         16  MA-QUALIFY-CODE-3             PIC XX.
  1539         16  MA-QUALIFY-CODE-4             PIC XX.
  1540         16  MA-QUALIFY-CODE-5             PIC XX.
  1541
  1542         16  MA-INSURED-LAST-NAME          PIC X(15).
  1543         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1544         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1545         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1546         16  MA-INSURED-BIRTH-DT           PIC XX.
  1547         16  MA-INSURED-SEX                PIC X.
  1548             88  MA-SEX-MALE                   VALUE 'M'.
  1549             88  MA-SEX-FEMALE                 VALUE 'F'.
  1550         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1551
  1552         16  MA-ADDRESS-CORRECTED          PIC X.
  1553         16  MA-JOINT-BIRTH-DT             PIC XX.
  1554*        16  FILLER                        PIC X(12).
  1555
  1556         16  MA-ADDRESS-LINE-1             PIC X(30).
  1557         16  MA-ADDRESS-LINE-2             PIC X(30).
  1558         16  MA-CITY-STATE.
  1559             20  MA-CITY                   PIC X(28).
  1560             20  MA-ADDR-STATE             PIC XX.
  1561         16  MA-ZIP.
  1562             20  MA-ZIP-CODE.
  1563                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1564                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1565                 24  FILLER                PIC X(4).
  1566             20  MA-ZIP-PLUS4              PIC X(4).
  1567         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1568             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1569             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1570             20  FILLER                    PIC X(3).
  1571
  1572         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1573
  1574         16  FILLER                        PIC XXX.
  1575*        16  FILLER                        PIC X(10).
  1576
  1577     12  MA-CRED-BENE-INFO.
  1578         16  MA-CRED-BENE-NAME                 PIC X(25).
  1579         16  MA-CRED-BENE-ADDR                 PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  29
* NSRASBL.cbl
  1580         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1581         16  MA-CRED-BENE-CTYST.
  1582             20  MA-CRED-BENE-CITY             PIC X(28).
  1583             20  MA-CRED-BENE-STATE            PIC XX.
  1584         16  MA-CRED-BENE-ZIP.
  1585             20  MA-CB-ZIP-CODE.
  1586                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1587                     88  MA-CB-CANADIAN-POST-CODE
  1588                                           VALUE 'A' THRU 'Z'.
  1589                 24  FILLER                    PIC X(4).
  1590             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1591         16  MA-CB-CANADIAN-POSTAL-CODE
  1592                            REDEFINES MA-CRED-BENE-ZIP.
  1593             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1594             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1595             20  FILLER                        PIC X(3).
  1596     12  MA-POST-CARD-MAIL-DATA.
  1597         16  MA-MAIL-DATA OCCURS 7.
  1598             20  MA-MAIL-TYPE              PIC X.
  1599                 88  MA-12MO-MAILING           VALUE '1'.
  1600                 88  MA-EXP-MAILING            VALUE '2'.
  1601             20  MA-MAIL-STATUS            PIC X.
  1602                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1603                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1604                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1605             20  MA-MAIL-DATE              PIC XX.
  1606     12  FILLER                            PIC XX.
  1607     12  FILLER                            PIC XX.
  1608*    12  FILLER                            PIC X(30).
  1609******************************************************************
  1610*                                COPY ERCCOMP.
  1611******************************************************************
  1612*                                                                *
  1613*                                                                *
  1614*                            ERCCOMP                             *
  1615*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1616*                            VMOD=2.019                          *
  1617*                                                                *
  1618*   ONLINE CREDIT SYSTEM                                         *
  1619*                                                                *
  1620*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1621*                                                                *
  1622*   FILE TYPE = VSAM,KSDS                                        *
  1623*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1624*                                                                *
  1625*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1626*       ALTERNATE PATH = NONE                                    *
  1627*                                                                *
  1628*   LOG = NO                                                     *
  1629*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1630*                                                                *
  1631******************************************************************
  1632*                   C H A N G E   L O G
  1633*
  1634* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1635*-----------------------------------------------------------------
  1636*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1637* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  30
* NSRASBL.cbl
  1638*-----------------------------------------------------------------
  1639* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1640* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1641* 092205    2005050300006  PEMA  ADD LEASE FEE
  1642* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1643* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1644* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1645* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1646* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1647* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1648******************************************************************
  1649
  1650 01  COMPENSATION-MASTER.
  1651     12  CO-RECORD-ID                          PIC XX.
  1652         88  VALID-CO-ID                          VALUE 'CO'.
  1653
  1654     12  CO-CONTROL-PRIMARY.
  1655         16  CO-COMPANY-CD                     PIC X.
  1656         16  CO-CONTROL.
  1657             20  CO-CTL-1.
  1658                 24  CO-CARR-GROUP.
  1659                     28  CO-CARRIER            PIC X.
  1660                     28  CO-GROUPING.
  1661                         32  CO-GROUP-PREFIX   PIC XXX.
  1662                         32  CO-GROUP-PRIME    PIC XXX.
  1663                 24  CO-RESP-NO.
  1664                     28  CO-RESP-PREFIX        PIC X(4).
  1665                     28  CO-RESP-PRIME         PIC X(6).
  1666             20  CO-CTL-2.
  1667                 24  CO-ACCOUNT.
  1668                     28  CO-ACCT-PREFIX        PIC X(4).
  1669                     28  CO-ACCT-PRIME         PIC X(6).
  1670         16  CO-TYPE                           PIC X.
  1671             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1672             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1673             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1674
  1675     12  CO-MAINT-INFORMATION.
  1676         16  CO-LAST-MAINT-DT                  PIC XX.
  1677         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1678         16  CO-LAST-MAINT-USER                PIC X(4).
  1679     12  FILLER                                PIC XX.
  1680     12  CO-STMT-TYPE                          PIC XXX.
  1681     12  CO-COMP-TYPE                          PIC X.
  1682         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1683     12  CO-STMT-OWNER                         PIC X(4).
  1684     12  CO-BALANCE-CONTROL                    PIC X.
  1685         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1686         88  CO-NO-BALANCE                        VALUE 'N'.
  1687
  1688     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1689         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1690         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1691         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1692
  1693     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1694         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1695         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  31
* NSRASBL.cbl
  1696
  1697     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1698     12  CO-GA-DIRECT-DEP                      PIC X.
  1699     12  CO-FUTURE-SPACE                       PIC X.
  1700         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1701
  1702     12  CO-ACCT-NAME                          PIC X(30).
  1703     12  CO-MAIL-NAME                          PIC X(30).
  1704     12  CO-ADDR-1                             PIC X(30).
  1705     12  CO-ADDR-2                             PIC X(30).
  1706     12  CO-ADDR-3.
  1707         16  CO-ADDR-CITY                      PIC X(27).
  1708         16  CO-ADDR-STATE                     PIC XX.
  1709     12  CO-CSO-1099                           PIC X.
  1710     12  CO-ZIP.
  1711         16  CO-ZIP-PRIME.
  1712             20  CO-ZIP-PRI-1ST                PIC X.
  1713                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1714             20  FILLER                        PIC X(4).
  1715         16  CO-ZIP-PLUS4                      PIC X(4).
  1716     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1717         16  CO-CAN-POSTAL-1                   PIC XXX.
  1718         16  CO-CAN-POSTAL-2                   PIC XXX.
  1719         16  FILLER                            PIC XXX.
  1720     12  CO-SOC-SEC                            PIC X(13).
  1721     12  CO-TELEPHONE.
  1722         16  CO-AREA-CODE                      PIC XXX.
  1723         16  CO-PREFIX                         PIC XXX.
  1724         16  CO-PHONE                          PIC X(4).
  1725
  1726     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1727
  1728     12  CO-AR-BAL-LEVEL                       PIC X.
  1729         88  CO-AR-REF-LVL                        VALUE '1'.
  1730         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1731         88  CO-AR-BILL-LVL                       VALUE '2'.
  1732         88  CO-AR-AGT-LVL                        VALUE '3'.
  1733         88  CO-AR-FR-LVL                         VALUE '4'.
  1734
  1735     12  CO-AR-NORMAL-PRINT                    PIC X.
  1736         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1737         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1738
  1739     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1740
  1741     12  CO-AR-REPORTING                       PIC X.
  1742         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1743         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1744
  1745     12  CO-AR-PULL-CHECK                      PIC X.
  1746         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1747         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1748
  1749     12  CO-AR-BALANCE-PRINT                   PIC X.
  1750         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1751
  1752     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1753         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  32
* NSRASBL.cbl
  1754         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1755         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1756
  1757     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1758
  1759     12  CO-USER-CODE                          PIC X.
  1760     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1761
  1762******************************************************************
  1763*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1764*    THE LAST MONTH END RUN.
  1765******************************************************************
  1766
  1767     12  CO-LAST-ACTIVITY-DATE.
  1768         16  CO-ACT-YEAR                       PIC 99.
  1769         16  CO-ACT-MONTH                      PIC 99.
  1770         16  CO-ACT-DAY                        PIC 99.
  1771
  1772     12  CO-LAST-STMT-DT.
  1773         16  CO-LAST-STMT-YEAR                 PIC 99.
  1774         16  CO-LAST-STMT-MONTH                PIC 99.
  1775         16  CO-LAST-STMT-DAY                  PIC 99.
  1776
  1777     12  CO-MO-END-TOTALS.
  1778         16  CO-MONTHLY-TOTALS.
  1779             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1780             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1781             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1782             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1783             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1784
  1785         16  CO-AGING-TOTALS.
  1786             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1787             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1788             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1789             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1790
  1791         16  CO-YTD-TOTALS.
  1792             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1793             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1794
  1795         16  CO-OVER-UNDER-TOTALS.
  1796             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1797             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1798
  1799     12  CO-MISCELLANEOUS-TOTALS.
  1800         16  CO-FICA-TOTALS.
  1801             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1802             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1803
  1804         16  CO-CLAIM-TOTALS.
  1805             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1806             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1807
  1808******************************************************************
  1809*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1810*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1811******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  33
* NSRASBL.cbl
  1812
  1813     12  CO-CURRENT-TOTALS.
  1814         16  CO-CURRENT-LAST-STMT-DT.
  1815             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1816             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1817             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1818
  1819         16  CO-CURRENT-MONTHLY-TOTALS.
  1820             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1821             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1822             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1823             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1824             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1825
  1826         16  CO-CURRENT-AGING-TOTALS.
  1827             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1828             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1829             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1830             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1831
  1832         16  CO-CURRENT-YTD-TOTALS.
  1833             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1834             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1835
  1836     12  CO-PAID-COMM-TOTALS.
  1837         16  CO-YTD-PAID-COMMS.
  1838             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1839             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1840
  1841     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1842         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1843         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1844
  1845     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1846         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1847         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1848         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1849         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1850         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1851         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1852         88  CO-FINAL-LETTER                  VALUE 'F'.
  1853         88  CO-RECONCILING                   VALUE 'R'.
  1854         88  CO-PHONE-CALL                    VALUE 'P'.
  1855         88  CO-LEGAL                         VALUE 'L'.
  1856         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1857         88  CO-WRITE-OFF                     VALUE 'W'.
  1858         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1859
  1860     12  CO-CSR-CODE                       PIC X(4).
  1861
  1862     12  CO-GA-STATUS-INFO.
  1863         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1864         16  CO-GA-TERMINATION-DT          PIC XX.
  1865         16  CO-GA-STATUS-CODE             PIC X.
  1866             88  CO-GA-ACTIVE                 VALUE 'A'.
  1867             88  CO-GA-INACTIVE               VALUE 'I'.
  1868             88  CO-GA-PENDING                VALUE 'P'.
  1869         16  CO-GA-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  34
* NSRASBL.cbl
  1870             20  CO-GA-COMMENT-1           PIC X(40).
  1871             20  CO-GA-COMMENT-2           PIC X(40).
  1872             20  CO-GA-COMMENT-3           PIC X(40).
  1873             20  CO-GA-COMMENT-4           PIC X(40).
  1874
  1875     12  CO-RPTCD2                         PIC X(10).
  1876     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1877         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1878         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1879
  1880     12  CO-TYPE-AGENT                     PIC X(01).
  1881         88  CO-CORPORATION                   VALUE 'C'.
  1882         88  CO-PARTNERSHIP                   VALUE 'P'.
  1883         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1884         88  CO-TRUST                         VALUE 'T'.
  1885         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1886
  1887     12  CO-FAXNO.
  1888         16  CO-FAX-AREA-CODE                  PIC XXX.
  1889         16  CO-FAX-PREFIX                     PIC XXX.
  1890         16  CO-FAX-PHONE                      PIC X(4).
  1891
  1892     12  CO-BANK-INFORMATION.
  1893         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1894         16  CO-BANK-TRANSIT-NON REDEFINES
  1895             CO-BANK-TRANSIT-NO                PIC 9(8).
  1896
  1897         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1898     12  CO-MISC-DEDUCT-INFO REDEFINES
  1899                  CO-BANK-INFORMATION.
  1900         16  CO-MD-GL-ACCT                     PIC X(10).
  1901         16  CO-MD-DIV                         PIC XX.
  1902         16  CO-MD-CENTER                      PIC X(4).
  1903         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1904         16  CO-CREATE-AP-CHECK                PIC X.
  1905         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1906         16  FILLER                            PIC XXX.
  1907     12  CO-ACH-STATUS                         PIC X.
  1908         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1909         88  CO-ACH-PENDING                        VALUE 'P'.
  1910
  1911     12  CO-BILL-SW                            PIC X.
  1912     12  CO-CONTROL-NAME                       PIC X(30).
  1913     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1914     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1915     12  CO-CLP-STATE                          PIC XX.
  1916     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1917     12  CO-SPP-REFUND-EDIT                    PIC X.
  1918
  1919******************************************************************
  1920*                                COPY ELCCERT.
  1921******************************************************************
  1922*                                                                *
  1923*                            ELCCERT.                            *
  1924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1925*                            VMOD=2.013                          *
  1926*                                                                *
  1927*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  35
* NSRASBL.cbl
  1928*                                                                *
  1929*   FILE TYPE = VSAM,KSDS                                        *
  1930*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1931*                                                                *
  1932*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1933*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1934*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1935*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1936*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1937*                                                                *
  1938*   LOG = YES                                                    *
  1939*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1940******************************************************************
  1941*                   C H A N G E   L O G
  1942*
  1943* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1944*-----------------------------------------------------------------
  1945*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1946* EFFECTIVE    NUMBER
  1947*-----------------------------------------------------------------
  1948* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1949* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1950* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1951* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1952* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1953* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1954* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1955* 032612  CR2011110200001  PEMA  AHL CHANGES
  1956******************************************************************
  1957
  1958 01  CERTIFICATE-MASTER.
  1959     12  CM-RECORD-ID                      PIC XX.
  1960         88  VALID-CM-ID                      VALUE 'CM'.
  1961
  1962     12  CM-CONTROL-PRIMARY.
  1963         16  CM-COMPANY-CD                 PIC X.
  1964         16  CM-CARRIER                    PIC X.
  1965         16  CM-GROUPING.
  1966             20  CM-GROUPING-PREFIX        PIC X(3).
  1967             20  CM-GROUPING-PRIME         PIC X(3).
  1968         16  CM-STATE                      PIC XX.
  1969         16  CM-ACCOUNT.
  1970             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1971             20  CM-ACCOUNT-PRIME          PIC X(6).
  1972         16  CM-CERT-EFF-DT                PIC XX.
  1973         16  CM-CERT-NO.
  1974             20  CM-CERT-PRIME             PIC X(10).
  1975             20  CM-CERT-SFX               PIC X.
  1976
  1977     12  CM-CONTROL-BY-NAME.
  1978         16  CM-COMPANY-CD-A1              PIC X.
  1979         16  CM-INSURED-LAST-NAME          PIC X(15).
  1980         16  CM-INSURED-INITIALS.
  1981             20  CM-INSURED-INITIAL1       PIC X.
  1982             20  CM-INSURED-INITIAL2       PIC X.
  1983
  1984     12  CM-CONTROL-BY-SSN.
  1985         16  CM-COMPANY-CD-A2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  36
* NSRASBL.cbl
  1986         16  CM-SOC-SEC-NO.
  1987             20  CM-SSN-STATE              PIC XX.
  1988             20  CM-SSN-ACCOUNT            PIC X(6).
  1989             20  CM-SSN-LN3.
  1990                 25  CM-INSURED-INITIALS-A2.
  1991                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1992                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1993                 25 CM-PART-LAST-NAME-A2         PIC X.
  1994
  1995     12  CM-CONTROL-BY-CERT-NO.
  1996         16  CM-COMPANY-CD-A4              PIC X.
  1997         16  CM-CERT-NO-A4                 PIC X(11).
  1998
  1999     12  CM-CONTROL-BY-MEMB.
  2000         16  CM-COMPANY-CD-A5              PIC X.
  2001         16  CM-MEMBER-NO.
  2002             20  CM-MEMB-STATE             PIC XX.
  2003             20  CM-MEMB-ACCOUNT           PIC X(6).
  2004             20  CM-MEMB-LN4.
  2005                 25  CM-INSURED-INITIALS-A5.
  2006                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2007                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2008                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2009
  2010     12  CM-INSURED-PROFILE-DATA.
  2011         16  CM-INSURED-FIRST-NAME.
  2012             20  CM-INSURED-1ST-INIT       PIC X.
  2013             20  FILLER                    PIC X(9).
  2014         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2015         16  CM-INSURED-SEX                PIC X.
  2016             88  CM-SEX-MALE                  VALUE 'M'.
  2017             88  CM-SEX-FEMAL                 VALUE 'F'.
  2018         16  CM-INSURED-JOINT-AGE          PIC 99.
  2019         16  CM-JOINT-INSURED-NAME.
  2020             20  CM-JT-LAST-NAME           PIC X(15).
  2021             20  CM-JT-FIRST-NAME.
  2022                 24  CM-JT-1ST-INIT        PIC X.
  2023                 24  FILLER                PIC X(9).
  2024             20  CM-JT-INITIAL             PIC X.
  2025
  2026     12  CM-LIFE-DATA.
  2027         16  CM-LF-BENEFIT-CD              PIC XX.
  2028         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2029         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2030         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2031         16  CM-LF-DEV-CODE                PIC XXX.
  2032         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2033         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2034         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2035         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2036         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2037         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2038         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2039         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2040         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2041         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2042         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2043         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  37
* NSRASBL.cbl
  2044         16  FILLER                        PIC XX.
  2045
  2046     12  CM-AH-DATA.
  2047         16  CM-AH-BENEFIT-CD              PIC XX.
  2048         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2049         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2050         16  CM-AH-DEV-CODE                PIC XXX.
  2051         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2052         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2053         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2054         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2055         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2056         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2057         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2058         16  CM-AH-PAID-THRU-DT            PIC XX.
  2059             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2060         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2061         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2062         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2063         16  FILLER                        PIC X.
  2064
  2065     12  CM-LOAN-INFORMATION.
  2066         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2067         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2068                                           PIC S9(5)V99  COMP-3.
  2069         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2070         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2071         16  CM-PAY-FREQUENCY              PIC S99.
  2072         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2073         16  CM-RATE-CLASS                 PIC XX.
  2074         16  CM-BENEFICIARY                PIC X(25).
  2075         16  CM-POLICY-FORM-NO             PIC X(12).
  2076         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2077         16  CM-LAST-ADD-ON-DT             PIC XX.
  2078         16  CM-DEDUCTIBLE-AMOUNTS.
  2079             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2080             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2081         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2082             20  CM-RESIDENT-STATE         PIC XX.
  2083             20  CM-RATE-CODE              PIC X(4).
  2084             20  FILLER                    PIC XX.
  2085         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2086             20  CM-LOAN-OFFICER           PIC X(5).
  2087             20  FILLER                    PIC XXX.
  2088         16  CM-CSR-CODE                   PIC XXX.
  2089         16  CM-UNDERWRITING-CODE          PIC X.
  2090             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2091         16  CM-POST-CARD-IND              PIC X.
  2092         16  CM-NH-INTERFACE-SW            PIC X.
  2093         16  CM-PREMIUM-TYPE               PIC X.
  2094             88  CM-SING-PRM                  VALUE '1'.
  2095             88  CM-O-B-COVERAGE              VALUE '2'.
  2096             88  CM-OPEN-END                  VALUE '3'.
  2097         16  CM-IND-GRP-TYPE               PIC X.
  2098             88  CM-INDIVIDUAL                VALUE 'I'.
  2099             88  CM-GROUP                     VALUE 'G'.
  2100         16  CM-SKIP-CODE                  PIC X.
  2101             88  NO-MONTHS-SKIPPED            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  38
* NSRASBL.cbl
  2102             88  SKIP-JULY                    VALUE '1'.
  2103             88  SKIP-AUGUST                  VALUE '2'.
  2104             88  SKIP-SEPTEMBER               VALUE '3'.
  2105             88  SKIP-JULY-AUG                VALUE '4'.
  2106             88  SKIP-AUG-SEPT                VALUE '5'.
  2107             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2108             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2109             88  SKIP-JUNE                    VALUE '8'.
  2110             88  SKIP-JUNE-JULY               VALUE '9'.
  2111             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2112             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2113         16  CM-PAYMENT-MODE               PIC X.
  2114             88  PAY-MONTHLY                  VALUE SPACE.
  2115             88  PAY-WEEKLY                   VALUE '1'.
  2116             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2117             88  PAY-BI-WEEKLY                VALUE '3'.
  2118             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2119         16  CM-LOAN-NUMBER                PIC X(8).
  2120         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2121         16  CM-OLD-LOF                    PIC XXX.
  2122*        16  CM-LOAN-OFFICER               PIC XXX.
  2123         16  CM-REIN-TABLE                 PIC XXX.
  2124         16  CM-SPECIAL-REIN-CODE          PIC X.
  2125         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2126         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2127         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2128
  2129     12  CM-STATUS-DATA.
  2130         16  CM-ENTRY-STATUS               PIC X.
  2131         16  CM-ENTRY-DT                   PIC XX.
  2132
  2133         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2134         16  CM-LF-CANCEL-DT               PIC XX.
  2135         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2136
  2137         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2138         16  CM-LF-DEATH-DT                PIC XX.
  2139         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2140
  2141         16  CM-LF-CURRENT-STATUS          PIC X.
  2142             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2143                                                'M' '4' '5' '9'.
  2144             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2145             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2146             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2147             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2148             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2149             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2150             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2151             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2152             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2153             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2154             88  CM-LF-DECLINED               VALUE 'D'.
  2155             88  CM-LF-VOIDED                 VALUE 'V'.
  2156
  2157         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2158         16  CM-AH-CANCEL-DT               PIC XX.
  2159         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  39
* NSRASBL.cbl
  2160
  2161         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2162         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2163         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2164
  2165         16  CM-AH-CURRENT-STATUS          PIC X.
  2166             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2167                                                'M' '4' '5' '9'.
  2168             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2169             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2170             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2171             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2172             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2173             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2174             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2175             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2176             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2177             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2178             88  CM-AH-DECLINED               VALUE 'D'.
  2179             88  CM-AH-VOIDED                 VALUE 'V'.
  2180
  2181         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2182             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2183             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2184             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2185         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2186
  2187         16  CM-ENTRY-BATCH                PIC X(6).
  2188         16  CM-LF-EXIT-BATCH              PIC X(6).
  2189         16  CM-AH-EXIT-BATCH              PIC X(6).
  2190         16  CM-LAST-MONTH-END             PIC XX.
  2191
  2192     12  CM-NOTE-SW                        PIC X.
  2193         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2194         88  CERT-NOTES-PRESENT               VALUE '1'.
  2195         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2196         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2197         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2198         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2199         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2200         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2201     12  CM-COMP-EXCP-SW                   PIC X.
  2202         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2203         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2204     12  CM-INSURED-ADDRESS-SW             PIC X.
  2205         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2206         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2207
  2208*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2209     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2210     12  FILLER                            PIC X.
  2211
  2212*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2213     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2214     12  FILLER                            PIC X.
  2215*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2216     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2217
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  40
* NSRASBL.cbl
  2218     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2219         88  CERT-ADDED-BATCH                 VALUE ' '.
  2220         88  CERT-ADDED-ONLINE                VALUE '1'.
  2221         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2222         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2223         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2224     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2225         88  CERT-AS-LOADED                   VALUE ' '.
  2226         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2227         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2228         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2229         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2230         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2231         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2232         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2233
  2234     12  CM-ACCOUNT-COMM-PCTS.
  2235         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2236         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2237
  2238     12  CM-USER-FIELD                     PIC X.
  2239     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2240     12  CM-CLP-STATE                      PIC XX.
  2241     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2242     12  CM-USER-RESERVED                  PIC XXX.
  2243     12  FILLER REDEFINES CM-USER-RESERVED.
  2244         16  CM-AH-CLASS-CD                PIC XX.
  2245         16  F                             PIC X.
  2246******************************************************************
  2247*                                COPY ELCCRTO.
  2248******************************************************************
  2249*                                                                *
  2250*                            ELCCRTO.                            *
  2251*                                                                *
  2252*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2253*                                                                *
  2254*   FILE TYPE = VSAM,KSDS                                        *
  2255*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2256*                                                                *
  2257*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2258*                                                                *
  2259*   LOG = YES                                                    *
  2260*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2261******************************************************************
  2262*                   C H A N G E   L O G
  2263*
  2264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2265*-----------------------------------------------------------------
  2266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2267* EFFECTIVE    NUMBER
  2268*-----------------------------------------------------------------
  2269* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2270* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2271* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2272* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2273* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2274******************************************************************
  2275 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  41
* NSRASBL.cbl
  2276     12  OC-RECORD-ID                      PIC XX.
  2277         88  VALID-OC-ID                      VALUE 'OC'.
  2278     12  OC-CONTROL-PRIMARY.
  2279         16  OC-COMPANY-CD                 PIC X.
  2280         16  OC-CARRIER                    PIC X.
  2281         16  OC-GROUPING                   PIC X(6).
  2282         16  OC-STATE                      PIC XX.
  2283         16  OC-ACCOUNT                    PIC X(10).
  2284         16  OC-CERT-EFF-DT                PIC XX.
  2285         16  OC-CERT-NO.
  2286             20  OC-CERT-PRIME             PIC X(10).
  2287             20  OC-CERT-SFX               PIC X.
  2288         16  OC-RECORD-TYPE                PIC X.
  2289         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2290     12  OC-LAST-MAINT-DT                  PIC XX.
  2291     12  OC-LAST-MAINT-BY                  PIC X(4).
  2292     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2293     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2294     12  FILLER                            PIC X(49).
  2295     12  OC-ORIG-REC.
  2296         16  OC-INS-LAST-NAME              PIC X(15).
  2297         16  OC-INS-FIRST-NAME             PIC X(10).
  2298         16  OC-INS-MIDDLE-INIT            PIC X.
  2299         16  OC-INS-AGE                    PIC S999     COMP-3.
  2300         16  OC-JNT-LAST-NAME              PIC X(15).
  2301         16  OC-JNT-FIRST-NAME             PIC X(10).
  2302         16  OC-JNT-MIDDLE-INIT            PIC X.
  2303         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2304         16  OC-LF-BENCD                   PIC XX.
  2305         16  OC-LF-TERM                    PIC S999      COMP-3.
  2306         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2307         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2308         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2309         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2310         16  OC-LF-EXP-DT                  PIC XX.
  2311         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2312         16  OC-LF-CANCEL-DT               PIC XX.
  2313         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2314         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2315         16  OC-AH-BENCD                   PIC XX.
  2316         16  OC-AH-TERM                    PIC S999      COMP-3.
  2317         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2318         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2319         16  OC-AH-EXP-DT                  PIC XX.
  2320         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2321         16  OC-AH-CP                      PIC 99.
  2322         16  OC-AH-CANCEL-DT               PIC XX.
  2323         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2324         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2325         16  OC-CRED-BENE-NAME             PIC X(25).
  2326         16  OC-1ST-PMT-DT                 PIC XX.
  2327         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2328         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  2329         16  OC-ISSUE-TRAN-IND             PIC X.
  2330         16  OC-CANCEL-TRAN-IND            PIC X.
  2331         16  FILLER                        PIC X(211).
  2332
  2333     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  42
* NSRASBL.cbl
  2334******************************************************************
  2335*                                COPY ERCACCT.
  2336******************************************************************
  2337*                                                                *
  2338*                                                                *
  2339*                            ERCACCT                             *
  2340*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2341*                            VMOD=2.031                          *
  2342*                                                                *
  2343*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2344*                                                                *
  2345*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2346*   VSAM ACCOUNT MASTER FILES.                                   *
  2347*                                                                *
  2348*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2349*                                                                *
  2350*   FILE TYPE = VSAM,KSDS                                        *
  2351*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2352*                                                                *
  2353*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2354*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2355*                                                                *
  2356*   LOG = NO                                                     *
  2357*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2358*                                                                *
  2359*                                                                *
  2360******************************************************************
  2361*                   C H A N G E   L O G
  2362*
  2363* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2364*-----------------------------------------------------------------
  2365*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2366* EFFECTIVE    NUMBER
  2367*-----------------------------------------------------------------
  2368* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2369* 092705    2005050300006  PEMA  ADD SPP LEASES
  2370* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2371* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2372* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2373* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2374* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2375******************************************************************
  2376
  2377 01  ACCOUNT-MASTER.
  2378     12  AM-RECORD-ID                      PIC XX.
  2379         88  VALID-AM-ID                      VALUE 'AM'.
  2380
  2381     12  AM-CONTROL-PRIMARY.
  2382         16  AM-COMPANY-CD                 PIC X.
  2383         16  AM-MSTR-CNTRL.
  2384             20  AM-CONTROL-A.
  2385                 24  AM-CARRIER            PIC X.
  2386                 24  AM-GROUPING.
  2387                     28 AM-GROUPING-PREFIX PIC XXX.
  2388                     28 AM-GROUPING-PRIME  PIC XXX.
  2389                 24  AM-STATE              PIC XX.
  2390                 24  AM-ACCOUNT.
  2391                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  43
* NSRASBL.cbl
  2392                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2393             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2394                                           PIC X(19).
  2395             20  AM-CNTRL-B.
  2396                 24  AM-EXPIRATION-DT      PIC XX.
  2397                 24  FILLER                PIC X(4).
  2398             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2399                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2400
  2401     12  AM-CONTROL-BY-VAR-GRP.
  2402         16  AM-COMPANY-CD-A1              PIC X.
  2403         16  AM-VG-CARRIER                 PIC X.
  2404         16  AM-VG-GROUPING                PIC X(6).
  2405         16  AM-VG-STATE                   PIC XX.
  2406         16  AM-VG-ACCOUNT                 PIC X(10).
  2407         16  AM-VG-DATE.
  2408             20  AM-VG-EXPIRATION-DT       PIC XX.
  2409             20  FILLER                    PIC X(4).
  2410         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2411                                           PIC 9(11)      COMP-3.
  2412     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2413         16  FILLER                        PIC X(10).
  2414         16  AM-VG-KEY3.
  2415             20  AM-VG3-ACCOUNT            PIC X(10).
  2416             20  AM-VG3-EXP-DT             PIC XX.
  2417         16  FILLER                        PIC X(4).
  2418     12  AM-MAINT-INFORMATION.
  2419         16  AM-LAST-MAINT-DT              PIC XX.
  2420         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2421         16  AM-LAST-MAINT-USER            PIC X(4).
  2422         16  FILLER                        PIC XX.
  2423
  2424     12  AM-EFFECTIVE-DT                   PIC XX.
  2425     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2426
  2427     12  AM-PREV-DATES  COMP-3.
  2428         16  AM-PREV-EXP-DT                PIC 9(11).
  2429         16  AM-PREV-EFF-DT                PIC 9(11).
  2430
  2431     12  AM-REPORT-CODE-1                  PIC X(10).
  2432     12  AM-REPORT-CODE-2                  PIC X(10).
  2433
  2434     12  AM-CITY-CODE                      PIC X(4).
  2435     12  AM-COUNTY-PARISH                  PIC X(6).
  2436
  2437     12  AM-NAME                           PIC X(30).
  2438     12  AM-PERSON                         PIC X(30).
  2439     12  AM-ADDRS                          PIC X(30).
  2440     12  AM-CITY.
  2441         16  AM-ADDR-CITY                  PIC X(28).
  2442         16  AM-ADDR-STATE                 PIC XX.
  2443     12  AM-ZIP.
  2444         16  AM-ZIP-PRIME.
  2445             20  AM-ZIP-PRI-1ST            PIC X.
  2446                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2447             20  FILLER                    PIC X(4).
  2448         16  AM-ZIP-PLUS4                  PIC X(4).
  2449     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  44
* NSRASBL.cbl
  2450         16  AM-CAN-POSTAL-1               PIC XXX.
  2451         16  AM-CAN-POSTAL-2               PIC XXX.
  2452         16  FILLER                        PIC XXX.
  2453     12  AM-TEL-NO.
  2454         16  AM-AREA-CODE                  PIC 999.
  2455         16  AM-TEL-PRE                    PIC 999.
  2456         16  AM-TEL-NBR                    PIC 9(4).
  2457     12  AM-TEL-LOC                        PIC X.
  2458         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2459         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2460
  2461     12  AM-COMM-STRUCTURE.
  2462         16  AM-DEFN-1.
  2463             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2464                 24  AM-AGT.
  2465                     28  AM-AGT-PREFIX     PIC X(4).
  2466                     28  AM-AGT-PRIME      PIC X(6).
  2467                 24  AM-COM-TYP            PIC X.
  2468                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2469                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2470                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2471                 24  AM-RECALC-LV-INDIC    PIC X.
  2472                 24  AM-RETRO-LV-INDIC     PIC X.
  2473                 24  AM-GL-CODES           PIC X.
  2474                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2475                 24  FILLER                PIC X(01).
  2476         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2477             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2478                 24  FILLER                PIC X(11).
  2479                 24  AM-L-COMA             PIC XXX.
  2480                 24  AM-J-COMA             PIC XXX.
  2481                 24  AM-A-COMA             PIC XXX.
  2482                 24  FILLER                PIC X(6).
  2483
  2484     12  AM-COMM-CHANGE-STATUS             PIC X.
  2485         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2486
  2487     12  AM-CSR-CODE                       PIC X(4).
  2488
  2489     12  AM-BILLING-STATUS                 PIC X.
  2490         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2491         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2492     12  AM-AUTO-REFUND-SW                 PIC X.
  2493         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2494         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2495     12  AM-GPCD                           PIC 99.
  2496     12  AM-IG                             PIC X.
  2497         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2498         88  AM-HAS-GROUP                     VALUE '2'.
  2499     12  AM-STATUS                         PIC X.
  2500         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2501         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2502         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2503         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2504         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2505         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2506     12  AM-REMIT-TO                       PIC 99.
  2507     12  AM-ID-NO                          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  45
* NSRASBL.cbl
  2508
  2509     12  AM-CAL-TABLE                      PIC XX.
  2510     12  AM-LF-DEVIATION                   PIC XXX.
  2511     12  AM-AH-DEVIATION                   PIC XXX.
  2512     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2513     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2514     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2515     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2516     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2517     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2518
  2519     12  AM-USER-FIELDS.
  2520         16  AM-FLD-1                      PIC XX.
  2521         16  AM-FLD-2                      PIC XX.
  2522         16  AM-FLD-3                      PIC XX.
  2523         16  AM-FLD-4                      PIC XX.
  2524         16  AM-FLD-5                      PIC XX.
  2525
  2526     12  AM-1ST-PROD-DATE.
  2527         16  AM-1ST-PROD-YR                PIC XX.
  2528         16  AM-1ST-PROD-MO                PIC XX.
  2529         16  AM-1ST-PROD-DA                PIC XX.
  2530     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2531     12  AM-CERTS-PURGED-DATE.
  2532         16  AM-PUR-YR                     PIC XX.
  2533         16  AM-PUR-MO                     PIC XX.
  2534         16  AM-PUR-DA                     PIC XX.
  2535     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2536     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2537     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2538     12  AM-INACTIVE-DATE.
  2539         16  AM-INA-MO                     PIC 99.
  2540         16  AM-INA-DA                     PIC 99.
  2541         16  AM-INA-YR                     PIC 99.
  2542     12  AM-AR-HI-CERT-DATE                PIC XX.
  2543
  2544     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2545     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2546
  2547     12  AM-OB-PAYMENT-MODE                PIC X.
  2548         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2549         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2550         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2551         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2552
  2553     12  AM-AH-ONLY-INDICATOR              PIC X.
  2554         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2555         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2556
  2557     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2558
  2559     12  AM-OVER-SHORT.
  2560         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2561         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2562
  2563     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2564     12  AM-DCC-CLP-STATE                  PIC XX.
  2565
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  46
* NSRASBL.cbl
  2566     12  AM-RECALC-COMM                    PIC X.
  2567     12  AM-RECALC-REIN                    PIC X.
  2568
  2569     12  AM-REI-TABLE                      PIC XXX.
  2570     12  AM-REI-ET-LF                      PIC X.
  2571     12  AM-REI-ET-AH                      PIC X.
  2572     12  AM-REI-PE-LF                      PIC X.
  2573     12  AM-REI-PE-AH                      PIC X.
  2574     12  AM-REI-PRT-ST                     PIC X.
  2575     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2576     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2577     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2578     12  AM-REI-GROUP-A                    PIC X(6).
  2579     12  AM-REI-MORT                       PIC X(4).
  2580     12  AM-REI-PRT-OW                     PIC X.
  2581     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2582     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2583     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2584     12  AM-REI-GROUP-B                    PIC X(6).
  2585
  2586     12  AM-TRUST-TYPE                     PIC X(2).
  2587
  2588     12  AM-EMPLOYER-STMT-USED             PIC X.
  2589     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2590
  2591     12  AM-STD-AH-TYPE                    PIC XX.
  2592     12  AM-EARN-METHODS.
  2593         16  AM-EARN-METHOD-R              PIC X.
  2594             88 AM-REF-RL-R78                 VALUE 'R'.
  2595             88 AM-REF-RL-PR                  VALUE 'P'.
  2596             88 AM-REF-RL-MEAN                VALUE 'M'.
  2597             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2598         16  AM-EARN-METHOD-L              PIC X.
  2599             88 AM-REF-LL-R78                 VALUE 'R'.
  2600             88 AM-REF-LL-PR                  VALUE 'P'.
  2601             88 AM-REF-LL-MEAN                VALUE 'M'.
  2602             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2603         16  AM-EARN-METHOD-A              PIC X.
  2604             88 AM-REF-AH-R78                 VALUE 'R'.
  2605             88 AM-REF-AH-PR                  VALUE 'P'.
  2606             88 AM-REF-AH-MEAN                VALUE 'M'.
  2607             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2608             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2609             88 AM-REF-AH-NET                 VALUE 'N'.
  2610
  2611     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2612     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2613     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2614
  2615     12  AM-RET-Y-N                        PIC X.
  2616     12  AM-RET-P-E                        PIC X.
  2617     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2618     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2619     12  AM-RET-GRP                        PIC X(6).
  2620     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2621         16  AM-POOL-PRIME                 PIC XXX.
  2622         16  AM-POOL-SUB                   PIC XXX.
  2623     12  AM-RETRO-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  47
* NSRASBL.cbl
  2624         16  AM-RET-EARN-R                 PIC X.
  2625         16  AM-RET-EARN-L                 PIC X.
  2626         16  AM-RET-EARN-A                 PIC X.
  2627     12  AM-RET-ST-TAX-USE                 PIC X.
  2628         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2629         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2630     12  AM-RETRO-BEG-EARNINGS.
  2631         16  AM-RET-BEG-EARN-R             PIC X.
  2632         16  AM-RET-BEG-EARN-L             PIC X.
  2633         16  AM-RET-BEG-EARN-A             PIC X.
  2634     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2635     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2636
  2637     12  AM-USER-SELECT-OPTIONS.
  2638         16  AM-USER-SELECT-1              PIC X(10).
  2639         16  AM-USER-SELECT-2              PIC X(10).
  2640         16  AM-USER-SELECT-3              PIC X(10).
  2641         16  AM-USER-SELECT-4              PIC X(10).
  2642         16  AM-USER-SELECT-5              PIC X(10).
  2643
  2644     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2645
  2646     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2647
  2648     12  AM-RPT045A-SWITCH                 PIC X.
  2649         88  RPT045A-OFF                   VALUE 'N'.
  2650
  2651     12  AM-INSURANCE-LIMITS.
  2652         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2653         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2654
  2655     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2656         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2657
  2658     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2659         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2660         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2661
  2662     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2663
  2664     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2665     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2666     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2667     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2668     12  AM-DCC-UEF-STATE                  PIC XX.
  2669     12  FILLER                            PIC XXX.
  2670     12  AM-REPORT-CODE-3                  PIC X(10).
  2671*    12  FILLER                            PIC X(22).
  2672
  2673     12  AM-RESERVE-DATE.
  2674         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2675         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2676         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2677
  2678     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2679     12  AM-NOTIFICATION-TYPES.
  2680         16  AM-NOTIF-OF-LETTERS           PIC X.
  2681         16  AM-NOTIF-OF-PAYMENTS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  48
* NSRASBL.cbl
  2682         16  AM-NOTIF-OF-REPORTS           PIC X.
  2683         16  AM-NOTIF-OF-STATUS            PIC X.
  2684
  2685     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2686         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2687         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2688         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2689         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2690
  2691     12  AM-BENEFIT-CONTROLS.
  2692         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2693             20  AM-BENEFIT-CODE           PIC XX.
  2694             20  AM-BENEFIT-TYPE           PIC X.
  2695             20  AM-BENEFIT-REVISION       PIC XXX.
  2696             20  AM-BENEFIT-REM-TERM       PIC X.
  2697             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2698             20  FILLER                    PIC XX.
  2699         16  FILLER                        PIC X(80).
  2700
  2701     12  AM-TRANSFER-DATA.
  2702         16  AM-TRANSFERRED-FROM.
  2703             20  AM-TRNFROM-CARRIER        PIC X.
  2704             20  AM-TRNFROM-GROUPING.
  2705                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2706                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2707             20  AM-TRNFROM-STATE          PIC XX.
  2708             20  AM-TRNFROM-ACCOUNT.
  2709                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2710                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2711             20  AM-TRNFROM-DTE            PIC XX.
  2712         16  AM-TRANSFERRED-TO.
  2713             20  AM-TRNTO-CARRIER          PIC X.
  2714             20  AM-TRNTO-GROUPING.
  2715                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2716                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2717             20  AM-TRNTO-STATE            PIC XX.
  2718             20  AM-TRNTO-ACCOUNT.
  2719                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2720                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2721             20  AM-TRNTO-DTE              PIC XX.
  2722         16  FILLER                        PIC X(10).
  2723
  2724     12  AM-SAVED-REMIT-TO                 PIC 99.
  2725
  2726     12  AM-COMM-STRUCTURE-SAVED.
  2727         16  AM-DEFN-1-SAVED.
  2728             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2729                 24  AM-AGT-SV             PIC X(10).
  2730                 24  AM-COM-TYP-SV         PIC X.
  2731                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2732                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2733                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2734                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2735                 24  FILLER                PIC X.
  2736                 24  AM-GL-CODES-SV        PIC X.
  2737                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2738                 24  FILLER                PIC X.
  2739         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  49
* NSRASBL.cbl
  2740             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2741                 24  FILLER                PIC X(11).
  2742                 24  AM-L-COMA-SV          PIC XXX.
  2743                 24  AM-J-COMA-SV          PIC XXX.
  2744                 24  AM-A-COMA-SV          PIC XXX.
  2745                 24  FILLER                PIC X(6).
  2746
  2747     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2748         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2749            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2750            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2751            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2752
  2753     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2754     12  FILLER                            PIC X(120).
  2755
  2756     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2757         16  AM-CONTROL-NAME               PIC X(30).
  2758         16  AM-EXECUTIVE-ONE.
  2759             20  AM-EXEC1-NAME             PIC X(15).
  2760             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2761                                                          COMP-3.
  2762             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2763                                                          COMP-3.
  2764         16  AM-EXECUTIVE-TWO.
  2765             20  AM-EXEC2-NAME             PIC X(15).
  2766             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2767                                                          COMP-3.
  2768             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2769                                                          COMP-3.
  2770
  2771     12  AM-RETRO-ADDITIONAL-DATA.
  2772         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2773         16  AM-RETRO-PREM-P-E             PIC X.
  2774         16  AM-RETRO-CLMS-P-I             PIC X.
  2775         16  AM-RETRO-RET-BRACKET-LF.
  2776             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2777                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2778                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2779             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2780                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2781                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2782             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2783                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2784                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2785         16  AM-RETRO-RET-BRACKET-AH.
  2786             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2787                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2788                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2789                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2790             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2791                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2792                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2793             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2794                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2795                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2796
  2797     12  AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  50
* NSRASBL.cbl
  2798         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2799
  2800     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2801         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2802         16  AM-FLI-BILLING-CODE           PIC X.
  2803         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2804         16  AM-FLI-UNITED-IDENT           PIC X.
  2805         16  AM-FLI-INTEREST-LOST-DATA.
  2806             20  AM-FLI-BANK-NO            PIC X(5).
  2807             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2808             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2809             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2810         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2811             20  AM-FLI-AGT                PIC X(9).
  2812             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2813             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2814         16  FILLER                        PIC X(102).
  2815
  2816     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2817         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2818             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2819             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2820             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2821             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2822             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2823         16  FILLER                          PIC X(10).
  2824******************************************************************
  2825*                                COPY ELCTEXT.
  2826******************************************************************
  2827*                                                                *
  2828*                                                                *
  2829*                            ELCTEXT.                            *
  2830*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2831*                            VMOD=2.008                          *
  2832*                                                                *
  2833*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2834*                                     FORM LETTERS,              *
  2835*                                     CERT FORM DISPLAY.
  2836*                                                                *
  2837*   FILE TYPE = VSAM,KSDS                                        *
  2838*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2839*                                                                *
  2840*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2841*       ALTERNATE INDEX = NONE                                   *
  2842*                                                                *
  2843*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2844*       ALTERNATE INDEX = NONE                                   *
  2845*                                                                *
  2846*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2847*       ALTERNATE INDEX = NONE                                   *
  2848*                                                                *
  2849*   LOG = NO                                                     *
  2850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2851******************************************************************
  2852 01  TEXT-FILES.
  2853     12  TEXT-FILE-ID                PIC XX.
  2854         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2855         88  LETTER-FILE-TEXT           VALUE 'TL'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  51
* NSRASBL.cbl
  2856         88  HELP-FILE-TEXT             VALUE 'TH'.
  2857
  2858     12  TX-CONTROL-PRIMARY.
  2859         16  TX-COMPANY-CD           PIC X.
  2860             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2861         16  TX-ACCESS-CD-GENL       PIC X(12).
  2862
  2863         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2864             20  TX-LETTER-NO        PIC X(4).
  2865             20  FILLER              PIC X(8).
  2866
  2867         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2868             20  TX-FORM-NO          PIC X(12).
  2869
  2870         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2871             20  TX-HELP-TYPE        PIC X.
  2872                 88  HELP-FOR-GENERAL   VALUE ' '.
  2873                 88  HELP-BY-SCREEN     VALUE 'S'.
  2874                 88  HELP-BY-ERROR      VALUE 'E'.
  2875             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2876                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2877             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2878                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2879             20  FILLER              PIC X(4).
  2880
  2881         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2882
  2883     12  TX-PROCESS-CONTROL          PIC XX.
  2884         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2885
  2886     12  TX-TEXT-LINE                PIC X(70).
  2887
  2888     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2889         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2890         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2891         88  TX-VALID-FORM-SQUEEZE-VALUE
  2892                                        VALUE 'Y' ' '.
  2893
  2894     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2895         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2896         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2897         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2898         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2899         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2900         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2901         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2902                                              'K' 'N' ' '
  2903                                              'Z'.
  2904
  2905     12  TX-ARCHIVE-SW               PIC X.
  2906         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2907         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2908         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2909
  2910     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2911     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2912
  2913     12  TX-BSR-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  52
* NSRASBL.cbl
  2914         88  TX-BSR-LETTER              VALUE 'B'.
  2915         88  TX-NON-BSR-LETTER          VALUE ' '.
  2916
  2917     12  FILLER                      PIC X.
  2918*****************************************************************
  2919*                                COPY ELCCNTL.
  2920******************************************************************
  2921*                                                                *
  2922*                                                                *
  2923*                            ELCCNTL.                            *
  2924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2925*                            VMOD=2.059                          *
  2926*                                                                *
  2927*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2928*                                                                *
  2929*   FILE TYPE = VSAM,KSDS                                        *
  2930*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2931*                                                                *
  2932*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2933*       ALTERNATE INDEX = NONE                                   *
  2934*                                                                *
  2935*   LOG = YES                                                    *
  2936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2937******************************************************************
  2938*                   C H A N G E   L O G
  2939*
  2940* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2941*-----------------------------------------------------------------
  2942*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2943* EFFECTIVE    NUMBER
  2944*-----------------------------------------------------------------
  2945* 082503                   PEMA  ADD BENEFIT GROUP
  2946* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2947* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2948* 092705    2005050300006  PEMA  ADD SPP LEASES
  2949* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2950* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2951* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2952* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2953* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2954* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2955* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2956* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2957******************************************************************
  2958*
  2959 01  CONTROL-FILE.
  2960     12  CF-RECORD-ID                       PIC XX.
  2961         88  VALID-CF-ID                        VALUE 'CF'.
  2962
  2963     12  CF-CONTROL-PRIMARY.
  2964         16  CF-COMPANY-ID                  PIC XXX.
  2965         16  CF-RECORD-TYPE                 PIC X.
  2966             88  CF-COMPANY-MASTER              VALUE '1'.
  2967             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2968             88  CF-STATE-MASTER                VALUE '3'.
  2969             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2970             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2971             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  53
* NSRASBL.cbl
  2972             88  CF-MORTALITY-MASTER            VALUE '7'.
  2973             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2974             88  CF-TERMINAL-MASTER             VALUE '9'.
  2975             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2976             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2977             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2978             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2979             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2980             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2981             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2982             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2983             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2984         16  CF-ACCESS-CD-GENL              PIC X(4).
  2985         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2986             20  CF-PROCESSOR               PIC X(4).
  2987         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2988             20  CF-STATE-CODE              PIC XX.
  2989             20  FILLER                     PIC XX.
  2990         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2991             20  FILLER                     PIC XX.
  2992             20  CF-HI-BEN-IN-REC           PIC XX.
  2993         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2994             20  FILLER                     PIC XXX.
  2995             20  CF-CARRIER-CNTL            PIC X.
  2996         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2997             20  FILLER                     PIC XX.
  2998             20  CF-HI-TYPE-IN-REC          PIC 99.
  2999         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3000             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3001                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3002             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3003             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3004         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3005             20  FILLER                     PIC X.
  3006             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3007         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3008             20  FILLER                     PIC XX.
  3009             20  CF-MORTGAGE-PLAN           PIC XX.
  3010         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3011
  3012     12  CF-LAST-MAINT-DT                   PIC XX.
  3013     12  CF-LAST-MAINT-BY                   PIC X(4).
  3014     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3015
  3016     12  CF-RECORD-BODY                     PIC X(728).
  3017
  3018
  3019****************************************************************
  3020*             COMPANY MASTER RECORD                            *
  3021****************************************************************
  3022
  3023     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3024         16  CF-COMPANY-ADDRESS.
  3025             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3026             20  CF-CL-IN-CARE-OF           PIC X(30).
  3027             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3028             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3029             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  54
* NSRASBL.cbl
  3030             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3031             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3032         16  CF-COMPANY-CD                  PIC X.
  3033         16  CF-COMPANY-PASSWORD            PIC X(8).
  3034         16  CF-SECURITY-OPTION             PIC X.
  3035             88  ALL-SECURITY                   VALUE '1'.
  3036             88  COMPANY-VERIFY                 VALUE '2'.
  3037             88  PROCESSOR-VERIFY               VALUE '3'.
  3038             88  NO-SECURITY                    VALUE '4'.
  3039             88  ALL-BUT-TERM                   VALUE '5'.
  3040         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3041             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3042         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3043             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3044         16  CF-INFORCE-LOCATION            PIC X.
  3045             88  CERTS-ARE-ONLINE               VALUE '1'.
  3046             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3047             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3048         16  CF-LOWER-CASE-LETTERS          PIC X.
  3049         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3050             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3051             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3052             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3053             88  CF-ACCNT-CNTL                  VALUE '3'.
  3054             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3055
  3056         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3057         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3058
  3059         16  CF-LGX-CREDIT-USER             PIC X.
  3060             88  CO-IS-NOT-USER                 VALUE 'N'.
  3061             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3062
  3063         16 CF-CREDIT-CALC-CODES.
  3064             20  CF-CR-REM-TERM-CALC PIC X.
  3065               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3066               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3067               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3068               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3069               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3070               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3071               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3072             20  CF-CR-R78-METHOD           PIC X.
  3073               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3074               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3075
  3076         16  CF-CLAIM-CONTROL-COUNTS.
  3077             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3078                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3079
  3080             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3081                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3082
  3083             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3084                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3085
  3086             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3087                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  55
* NSRASBL.cbl
  3088
  3089         16  CF-CURRENT-MONTH-END           PIC XX.
  3090
  3091         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3092             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3093             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3094             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3095             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3096                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3097                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3098             20  CF-CO-PREM-REJECT-SW       PIC X.
  3099                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3100                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3101             20  CF-CO-REF-REJECT-SW        PIC X.
  3102                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3103                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3104
  3105         16  CF-CO-REPORTING-DT             PIC XX.
  3106         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3107         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3108           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3109           88  CF-CO-MONTH-END                  VALUE '1'.
  3110
  3111         16  CF-LGX-CLAIM-USER              PIC X.
  3112             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3113             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3114
  3115         16  CF-CREDIT-EDIT-CONTROLS.
  3116             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3117             20  CF-MIN-AGE                 PIC 99.
  3118             20  CF-DEFAULT-AGE             PIC 99.
  3119             20  CF-MIN-TERM                PIC S999      COMP-3.
  3120             20  CF-MAX-TERM                PIC S999      COMP-3.
  3121             20  CF-DEFAULT-SEX             PIC X.
  3122             20  CF-JOINT-AGE-INPUT         PIC X.
  3123                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3124             20  CF-BIRTH-DATE-INPUT        PIC X.
  3125                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3126             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3127                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3128                 88  CF-ZERO-CARRIER            VALUE '1'.
  3129                 88  CF-ZERO-GROUPING           VALUE '2'.
  3130                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3131             20  CF-EDIT-SW                 PIC X.
  3132                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3133             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3134             20  CF-CR-PR-METHOD            PIC X.
  3135               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3136               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3137             20  FILLER                     PIC X.
  3138
  3139         16  CF-CREDIT-MISC-CONTROLS.
  3140             20  CF-REIN-TABLE-SW           PIC X.
  3141                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3142             20  CF-COMP-TABLE-SW           PIC X.
  3143                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3144             20  CF-EXPERIENCE-RETENTION-AGE
  3145                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  56
* NSRASBL.cbl
  3146             20  CF-CONVERSION-DT           PIC XX.
  3147             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3148             20  CF-RUN-FREQUENCY-SW        PIC X.
  3149                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3150                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3151
  3152             20  CF-CR-CHECK-NO-CONTROL.
  3153                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3154                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3155                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3156                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3157                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3158                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3159
  3160                 24  CF-CR-CHECK-COUNT       REDEFINES
  3161                     CF-CR-CHECK-COUNTER      PIC X(4).
  3162
  3163                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3164                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3165
  3166                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3167                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3168                 24  CF-MAIL-PROCESSING       PIC X.
  3169                     88  MAIL-PROCESSING          VALUE 'Y'.
  3170
  3171         16  CF-MISC-SYSTEM-CONTROL.
  3172             20  CF-SYSTEM-C                 PIC X.
  3173                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3174             20  CF-SYSTEM-D                 PIC X.
  3175                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3176             20  CF-SOC-SEC-NO-SW            PIC X.
  3177                 88  SOC-SEC-NO-USED             VALUE '1'.
  3178             20  CF-MEMBER-NO-SW             PIC X.
  3179                 88  MEMBER-NO-USED              VALUE '1'.
  3180             20  CF-TAX-ID-NUMBER            PIC X(11).
  3181             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3182             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3183                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3184                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3185                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3186                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3187             20  CF-SYSTEM-E                 PIC X.
  3188                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3189
  3190         16  CF-LGX-LIFE-USER               PIC X.
  3191             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3192             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3193
  3194         16  CF-CR-MONTH-END-DT             PIC XX.
  3195
  3196         16  CF-FILE-MAINT-DATES.
  3197             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3198                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3199             20  CF-LAST-BATCH       REDEFINES
  3200                 CF-LAST-BATCH-NO               PIC X(4).
  3201             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3202             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3203             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  57
* NSRASBL.cbl
  3204             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3205             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3206             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3207             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3208             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3209             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3210             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3211
  3212         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3213         16  FILLER                         PIC X.
  3214
  3215         16  CF-ALT-MORT-CODE               PIC X(4).
  3216         16  CF-MEMBER-CAPTION              PIC X(10).
  3217
  3218         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3219             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3220             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3221             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3222             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3223             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3224
  3225         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3226
  3227         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3228         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3229         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3230         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3231
  3232         16  CF-AH-OVERRIDE-L1              PIC X.
  3233         16  CF-AH-OVERRIDE-L2              PIC XX.
  3234         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3235         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3236
  3237         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3238         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3239
  3240         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3241         16  CF-AR-LAST-EL860-DT            PIC XX.
  3242         16  CF-MP-MONTH-END-DT             PIC XX.
  3243
  3244         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3245         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3246             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3247
  3248         16  CF-AR-MONTH-END-DT             PIC XX.
  3249
  3250         16  CF-CRDTCRD-USER                PIC X.
  3251             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3252             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3253
  3254         16  CF-CC-MONTH-END-DT             PIC XX.
  3255
  3256         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3257
  3258         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3259             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3260             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3261             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  58
* NSRASBL.cbl
  3262         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3263         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3264         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3265         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3266             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3267             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3268         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3269         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3270         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3271             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3272         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3273
  3274         16  CF-CL-ZIP-CODE.
  3275             20  CF-CL-ZIP-PRIME.
  3276                 24  CF-CL-ZIP-1ST          PIC X.
  3277                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3278                 24  FILLER                 PIC X(4).
  3279             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3280         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3281             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3282             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3283             20  FILLER                     PIC XXX.
  3284
  3285         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3286         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3287         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3288         16  CF-CO-OPTION-START-DATE        PIC XX.
  3289         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3290           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3291                                                      '3' '4'.
  3292           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3293           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3294           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3295           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3296           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3297           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3298
  3299         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3300
  3301         16  CF-PAYMENT-APPROVAL-LEVELS.
  3302             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3303             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3304             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3305             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3306             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3307             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3308
  3309         16  CF-END-USER-REPORTING-USER     PIC X.
  3310             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3311             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3312
  3313         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3314             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3315             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3316
  3317         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3318
  3319         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  59
* NSRASBL.cbl
  3320         16  FILLER                         PIC X.
  3321
  3322         16  CF-CREDIT-ARCHIVE-CNTL.
  3323             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3324             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3325             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3326
  3327         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3328
  3329         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3330             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3331             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3332
  3333         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3334             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3335             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3336
  3337         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3338
  3339         16  CF-CO-ACH-ID-CODE              PIC  X.
  3340             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3341             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3342             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3343         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3344         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3345         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3346         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3347         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3348         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3349         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3350         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3351         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3352                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3353         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3354                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3355
  3356         16  CF-CO-OVER-SHORT.
  3357             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3358             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3359
  3360*         16  FILLER                         PIC X(102).
  3361         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3362             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3363             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3364
  3365         16  CF-AH-APPROVAL-DAYS.
  3366             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3367             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3368             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3369             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3370
  3371         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3372
  3373         16  FILLER                         PIC X(79).
  3374****************************************************************
  3375*             PROCESSOR/USER RECORD                            *
  3376****************************************************************
  3377
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  60
* NSRASBL.cbl
  3378     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3379         16  CF-PROCESSOR-NAME              PIC X(30).
  3380         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3381         16  CF-PROCESSOR-TITLE             PIC X(26).
  3382         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3383                 88  MESSAGE-YES                VALUE 'Y'.
  3384                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3385
  3386*****************************************************
  3387****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3388****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3389****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3390****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3391*****************************************************
  3392
  3393         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3394             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3395             20  CF-APPLICATION-FORCE       PIC X.
  3396             20  CF-INDIVIDUAL-APP.
  3397                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3398                     28  CF-BROWSE-APP      PIC X.
  3399                     28  CF-UPDATE-APP      PIC X.
  3400
  3401         16  CF-CURRENT-TERM-ON             PIC X(4).
  3402         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3403             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3404             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3405             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3406             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3407             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3408             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3409             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3410         16  CF-PROCESSOR-CARRIER           PIC X.
  3411             88  NO-CARRIER-SECURITY            VALUE ' '.
  3412         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3413             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3414         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3415             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3416         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3417             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3418
  3419         16  CF-PROC-SYS-ACCESS-SW.
  3420             20  CF-PROC-CREDIT-CLAIMS-SW.
  3421                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3422                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3423                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3424                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3425             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3426                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3427                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3428             20  CF-PROC-LIFE-GNRLDGR-SW.
  3429                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3430                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3431                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3432                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3433             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3434                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3435                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  61
* NSRASBL.cbl
  3436         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3437             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3438             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3439         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3440
  3441         16  CF-APPROVAL-LEVEL                  PIC X.
  3442             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3443             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3444             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3445             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3446
  3447         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3448
  3449         16  CF-LANGUAGE-TYPE                   PIC X.
  3450             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3451             88  CF-LANG-IS-FR                      VALUE 'F'.
  3452
  3453         16  CF-CSR-IND                         PIC X.
  3454         16  FILLER                             PIC X(239).
  3455
  3456****************************************************************
  3457*             PROCESSOR/REMINDERS RECORD                       *
  3458****************************************************************
  3459
  3460     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3461         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3462             20  CF-START-REMIND-DT         PIC XX.
  3463             20  CF-END-REMIND-DT           PIC XX.
  3464             20  CF-REMINDER-TEXT           PIC X(50).
  3465         16  FILLER                         PIC X(296).
  3466
  3467
  3468****************************************************************
  3469*             STATE MASTER RECORD                              *
  3470****************************************************************
  3471
  3472     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3473         16  CF-STATE-ABBREVIATION          PIC XX.
  3474         16  CF-STATE-NAME                  PIC X(25).
  3475         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3476         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3477             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3478             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3479             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3480             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3481                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3482                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3483             20  CF-ST-PREM-REJECT-SW       PIC X.
  3484                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3485                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3486             20  CF-ST-REF-REJECT-SW        PIC X.
  3487                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3488                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3489         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3490         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3491         16  CF-ST-REFUND-RULES.
  3492             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3493             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  62
* NSRASBL.cbl
  3494             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3495         16  CF-ST-FST-PMT-EXTENSION.
  3496             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3497             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3498                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3499                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3500                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3501                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3502         16  CF-ST-STATE-CALL.
  3503             20  CF-ST-CALL-UNEARNED        PIC X.
  3504             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3505             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3506         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3507             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3508             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3509         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3510         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3511         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3512         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3513         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3514         16  FILLER                         PIC X.
  3515         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3516             20  CF-ST-BENEFIT-CD           PIC XX.
  3517             20  CF-ST-BENEFIT-KIND         PIC X.
  3518                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3519                 88  CF-ST-AH-KIND              VALUE 'A'.
  3520             20  CF-ST-REM-TERM-CALC        PIC X.
  3521                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3522                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3523                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3524                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3525                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3526                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3527                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3528                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3529
  3530             20  CF-ST-REFUND-CALC          PIC X.
  3531                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3532                 88  ST-REFD-BY-R78             VALUE '1'.
  3533                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3534                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3535                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3536                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3537                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3538                 88  ST-REFD-UTAH               VALUE '7'.
  3539                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3540                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3541                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3542
  3543             20  CF-ST-EARNING-CALC         PIC X.
  3544                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3545                 88  ST-EARN-BY-R78             VALUE '1'.
  3546                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3547                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3548                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3549                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3550                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3551                 88  ST-EARN-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  63
* NSRASBL.cbl
  3552                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3553
  3554             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3555                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3556                 88  ST-OVRD-BY-R78             VALUE '1'.
  3557                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3558                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3559                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3560                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3561                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3562                 88  ST-OVRD-MEAN               VALUE '8'.
  3563                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3564             20  FILLER                     PIC X.
  3565
  3566         16  CF-ST-COMMISSION-CAPS.
  3567             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3568             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3569             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3570             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3571         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3572                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3573
  3574         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3575
  3576         16  CF-ST-STATUTORY-INTEREST.
  3577             20  CF-ST-STAT-DATE-FROM       PIC X.
  3578                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3579                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3580             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3581             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3582             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3583             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3584             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3585
  3586         16  CF-ST-OVER-SHORT.
  3587             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3588             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3589
  3590         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3591
  3592         16  CF-ST-RT-CALC                  PIC X.
  3593
  3594         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3595         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3596         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3597         16  CF-ST-RF-LR-CALC               PIC X.
  3598         16  CF-ST-RF-LL-CALC               PIC X.
  3599         16  CF-ST-RF-LN-CALC               PIC X.
  3600         16  CF-ST-RF-AH-CALC               PIC X.
  3601         16  CF-ST-RF-CP-CALC               PIC X.
  3602*        16  FILLER                         PIC X(206).
  3603*CIDMOD         16  FILLER                         PIC X(192).
  3604         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3605             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3606         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3607         16  CF-ST-VFY-2ND-BENE             PIC X.
  3608         16  CF-ST-CAUSAL-STATE             PIC X.
  3609         16  FILLER                         PIC X(185).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  64
* NSRASBL.cbl
  3610
  3611****************************************************************
  3612*             BENEFIT MASTER RECORD                            *
  3613****************************************************************
  3614
  3615     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3616         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3617             20  CF-BENEFIT-CODE            PIC XX.
  3618             20  CF-BENEFIT-NUMERIC  REDEFINES
  3619                 CF-BENEFIT-CODE            PIC XX.
  3620             20  CF-BENEFIT-ALPHA           PIC XXX.
  3621             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3622             20  CF-BENEFIT-COMMENT         PIC X(10).
  3623
  3624             20  CF-LF-COVERAGE-TYPE        PIC X.
  3625                 88  CF-REDUCING                VALUE 'R'.
  3626                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3627
  3628             20  CF-SPECIAL-CALC-CD         PIC X.
  3629                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3630                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3631                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3632                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3633                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3634                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3635                 88  CF-FARM-PLAN               VALUE 'F'.
  3636                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3637                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3638                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3639                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3640                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3641                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3642                 88  CF-PRUDENTIAL              VALUE 'P'.
  3643                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3644                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3645                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3646                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3647                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3648                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3649
  3650             20  CF-JOINT-INDICATOR         PIC X.
  3651                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3652
  3653*            20  FILLER                     PIC X(12).
  3654             20  FILLER                     PIC X(11).
  3655             20  CF-BENEFIT-CATEGORY        PIC X.
  3656             20  CF-LOAN-TYPE               PIC X(8).
  3657
  3658             20  CF-CO-REM-TERM-CALC        PIC X.
  3659                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3660                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3661                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3662                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3663                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3664
  3665             20  CF-CO-EARNINGS-CALC        PIC X.
  3666                 88  CO-EARN-BY-R78             VALUE '1'.
  3667                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  65
* NSRASBL.cbl
  3668                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3669                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3670                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3671                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3672                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3673                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3674
  3675             20  CF-CO-REFUND-CALC          PIC X.
  3676                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3677                 88  CO-REFD-BY-R78             VALUE '1'.
  3678                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3679                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3680                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3681                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3682                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3683                 88  CO-REFD-MEAN               VALUE '8'.
  3684                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3685                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3686                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3687
  3688             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3689                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3690                 88  CO-OVRD-BY-R78             VALUE '1'.
  3691                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3692                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3693                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3694                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3695                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3696                 88  CO-OVRD-MEAN               VALUE '8'.
  3697                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3698
  3699             20  CF-CO-BEN-I-G-CD           PIC X.
  3700                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3701                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3702                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3703
  3704         16  FILLER                         PIC X(304).
  3705
  3706
  3707****************************************************************
  3708*             CARRIER MASTER RECORD                            *
  3709****************************************************************
  3710
  3711     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3712         16  CF-ADDRESS-DATA.
  3713             20  CF-MAIL-TO-NAME            PIC X(30).
  3714             20  CF-IN-CARE-OF              PIC X(30).
  3715             20  CF-ADDRESS-LINE-1          PIC X(30).
  3716             20  CF-ADDRESS-LINE-2          PIC X(30).
  3717             20  CF-CITY-STATE              PIC X(30).
  3718             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3719             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3720
  3721         16  CF-CLAIM-NO-CONTROL.
  3722             20  CF-CLAIM-NO-METHOD         PIC X.
  3723                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3724                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3725                 88  CLAIM-NO-SEQ               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  66
* NSRASBL.cbl
  3726                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3727             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3728                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3729                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3730                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3731
  3732         16  CF-CHECK-NO-CONTROL.
  3733             20  CF-CHECK-NO-METHOD         PIC X.
  3734                 88  CHECK-NO-MANUAL            VALUE '1'.
  3735                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3736                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3737                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3738             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3739                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3740
  3741         16  CF-DOMICILE-STATE              PIC XX.
  3742
  3743         16  CF-EXPENSE-CONTROLS.
  3744             20  CF-EXPENSE-METHOD          PIC X.
  3745                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3746                 88  DOLLARS-PER-PMT            VALUE '2'.
  3747                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3748                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3749             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3750             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3751
  3752         16  CF-CORRESPONDENCE-CONTROL.
  3753             20  CF-LETTER-RESEND-OPT       PIC X.
  3754                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3755                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3756             20  FILLER                     PIC X(4).
  3757
  3758         16  CF-RESERVE-CONTROLS.
  3759             20  CF-MANUAL-SW               PIC X.
  3760                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3761             20  CF-FUTURE-SW               PIC X.
  3762                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3763             20  CF-PTC-SW                  PIC X.
  3764                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3765             20  CF-IBNR-SW                 PIC X.
  3766                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3767             20  CF-PTC-LF-SW               PIC X.
  3768                 88  CF-LF-PTC-USED             VALUE '1'.
  3769             20  CF-CDT-ACCESS-METHOD       PIC X.
  3770                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3771                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3772                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3773             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3774
  3775         16  CF-CLAIM-CALC-METHOD           PIC X.
  3776             88  360-PLUS-MONTHS                VALUE '1'.
  3777             88  365-PLUS-MONTHS                VALUE '2'.
  3778             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3779             88  360-DAILY                      VALUE '4'.
  3780             88  365-DAILY                      VALUE '5'.
  3781
  3782         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3783         16  FILLER                         PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  67
* NSRASBL.cbl
  3784
  3785         16  CF-LIMIT-AMOUNTS.
  3786             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3787             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3788             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3789             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3790             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3791             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3792             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3793             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3794             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3795             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3796
  3797         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3798         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3799         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3800
  3801         16  CF-ZIP-CODE.
  3802             20  CF-ZIP-PRIME.
  3803                 24  CF-ZIP-1ST             PIC X.
  3804                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3805                 24  FILLER                 PIC X(4).
  3806             20  CF-ZIP-PLUS4               PIC X(4).
  3807         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3808             20  CF-CAN-POSTAL-1            PIC XXX.
  3809             20  CF-CAN-POSTAL-2            PIC XXX.
  3810             20  FILLER                     PIC XXX.
  3811
  3812         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3813         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3814         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3815
  3816         16  CF-RATING-SWITCH               PIC X.
  3817             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3818             88  CF-NO-RATING                   VALUE 'N'.
  3819
  3820         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3821
  3822         16  CF-CARRIER-OVER-SHORT.
  3823             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3824             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3825
  3826         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3827         16  CF-SECPAY-SWITCH               PIC X.
  3828             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3829             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3830         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3831         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3832         16  FILLER                         PIC X(444).
  3833*        16  FILLER                         PIC X(452).
  3834
  3835
  3836****************************************************************
  3837*             MORTALITY MASTER RECORD                          *
  3838****************************************************************
  3839
  3840     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3841         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  68
* NSRASBL.cbl
  3842                                INDEXED BY CF-MORT-NDX.
  3843             20  CF-MORT-TABLE              PIC X(5).
  3844             20  CF-MORT-TABLE-TYPE         PIC X.
  3845                 88  CF-MORT-JOINT              VALUE 'J'.
  3846                 88  CF-MORT-SINGLE             VALUE 'S'.
  3847                 88  CF-MORT-COMBINED           VALUE 'C'.
  3848                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3849                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3850             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3851             20  CF-MORT-AGE-METHOD         PIC XX.
  3852                 88  CF-AGE-LAST                VALUE 'AL'.
  3853                 88  CF-AGE-NEAR                VALUE 'AN'.
  3854             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3855             20  CF-MORT-ADJUSTMENT-DIRECTION
  3856                                            PIC X.
  3857                 88  CF-MINUS                   VALUE '-'.
  3858                 88  CF-PLUS                    VALUE '+'.
  3859             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3860             20  CF-MORT-JOINT-CODE         PIC X.
  3861                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3862             20  CF-MORT-PC-Q               PIC X.
  3863                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3864             20  CF-MORT-TABLE-CODE         PIC X(4).
  3865             20  CF-MORT-COMMENTS           PIC X(15).
  3866             20  FILLER                     PIC X(14).
  3867
  3868         16  FILLER                         PIC X(251).
  3869
  3870
  3871****************************************************************
  3872*             BUSSINESS TYPE MASTER RECORD                     *
  3873****************************************************************
  3874
  3875     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3876* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3877* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3878* AND RECORD 05 IS TYPES 81-99
  3879         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3880             20  CF-BUSINESS-TITLE          PIC  X(19).
  3881             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3882                                            PIC S9V9(4) COMP-3.
  3883             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3884             20  FILLER                     PIC  X.
  3885         16  FILLER                         PIC  X(248).
  3886
  3887
  3888****************************************************************
  3889*             TERMINAL MASTER RECORD                           *
  3890****************************************************************
  3891
  3892     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3893
  3894         16  CF-COMPANY-TERMINALS.
  3895             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3896                                  PIC X(4).
  3897         16  FILLER               PIC X(248).
  3898
  3899
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  69
* NSRASBL.cbl
  3900****************************************************************
  3901*             LIFE EDIT MASTER RECORD                          *
  3902****************************************************************
  3903
  3904     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3905         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3906             20  CF-LIFE-CODE-IN            PIC XX.
  3907             20  CF-LIFE-CODE-OUT           PIC XX.
  3908         16  FILLER                         PIC X(248).
  3909
  3910
  3911****************************************************************
  3912*             AH EDIT MASTER RECORD                            *
  3913****************************************************************
  3914
  3915     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3916         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3917             20  CF-AH-CODE-IN              PIC XXX.
  3918             20  CF-AH-CODE-OUT             PIC XX.
  3919         16  FILLER                         PIC X(248).
  3920
  3921
  3922****************************************************************
  3923*             CREDIBILITY TABLES                               *
  3924****************************************************************
  3925
  3926     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3927         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3928                             INDEXED BY CF-CRDB-NDX.
  3929             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3930             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3931             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3932         16  FILLER                         PIC  X(332).
  3933
  3934
  3935****************************************************************
  3936*             REPORT CUSTOMIZATION RECORD                      *
  3937****************************************************************
  3938
  3939     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3940         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3941             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3942             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3943             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3944**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3945****       A T-TRANSFER.                                   ****
  3946             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3947
  3948         16  FILLER                         PIC XX.
  3949
  3950         16  CF-CARRIER-CNTL-OPT.
  3951             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3952                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3953                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3954             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3955                                            PIC X.
  3956         16  CF-GROUP-CNTL-OPT.
  3957             20  CF-GROUP-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  70
* NSRASBL.cbl
  3958                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3959                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3960             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3961                                            PIC X(6).
  3962         16  CF-STATE-CNTL-OPT.
  3963             20  CF-STATE-OPT-SEQ           PIC 9.
  3964                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3965                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3966             20  CF-STATE-SELECT OCCURS 3 TIMES
  3967                                            PIC XX.
  3968         16  CF-ACCOUNT-CNTL-OPT.
  3969             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3970                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3971                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3972             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3973                                            PIC X(10).
  3974         16  CF-BUS-TYP-CNTL-OPT.
  3975             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3976                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3977                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3978             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3979                                            PIC XX.
  3980         16  CF-LF-TYP-CNTL-OPT.
  3981             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3982                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3983                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3984             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3985                                            PIC XX.
  3986         16  CF-AH-TYP-CNTL-OPT.
  3987             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3988                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3989                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3990             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3991                                            PIC XX.
  3992         16  CF-REPTCD1-CNTL-OPT.
  3993             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3994                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3995                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3996             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3997                                            PIC X(10).
  3998         16  CF-REPTCD2-CNTL-OPT.
  3999             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4000                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4001                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4002             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4003                                            PIC X(10).
  4004         16  CF-USER1-CNTL-OPT.
  4005             20  CF-USER1-OPT-SEQ           PIC 9.
  4006                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4007                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4008             20  CF-USER1-SELECT OCCURS 3 TIMES
  4009                                            PIC X(10).
  4010         16  CF-USER2-CNTL-OPT.
  4011             20  CF-USER2-OPT-SEQ           PIC 9.
  4012                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4013                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4014             20  CF-USER2-SELECT OCCURS 3 TIMES
  4015                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  71
* NSRASBL.cbl
  4016         16  CF-USER3-CNTL-OPT.
  4017             20  CF-USER3-OPT-SEQ           PIC 9.
  4018                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4019                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4020             20  CF-USER3-SELECT OCCURS 3 TIMES
  4021                                            PIC X(10).
  4022         16  CF-USER4-CNTL-OPT.
  4023             20  CF-USER4-OPT-SEQ           PIC 9.
  4024                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4025                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4026             20  CF-USER4-SELECT OCCURS 3 TIMES
  4027                                            PIC X(10).
  4028         16  CF-USER5-CNTL-OPT.
  4029             20  CF-USER5-OPT-SEQ           PIC 9.
  4030                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4031                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4032             20  CF-USER5-SELECT OCCURS 3 TIMES
  4033                                            PIC X(10).
  4034         16  CF-REINS-CNTL-OPT.
  4035             20  CF-REINS-OPT-SEQ           PIC 9.
  4036                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4037                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4038             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4039                 24  CF-REINS-PRIME         PIC XXX.
  4040                 24  CF-REINS-SUB           PIC XXX.
  4041
  4042         16  CF-AGENT-CNTL-OPT.
  4043             20  CF-AGENT-OPT-SEQ           PIC 9.
  4044                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4045                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4046             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4047                                            PIC X(10).
  4048
  4049         16  FILLER                         PIC X(43).
  4050
  4051         16  CF-LOSS-RATIO-SELECT.
  4052             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4053             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4054         16  CF-ENTRY-DATE-SELECT.
  4055             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4056             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4057         16  CF-EFFECTIVE-DATE-SELECT.
  4058             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4059             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4060
  4061         16  CF-EXCEPTION-LIST-IND          PIC X.
  4062             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4063
  4064         16  FILLER                         PIC X(318).
  4065
  4066****************************************************************
  4067*                  EXCEPTION REPORTING RECORD                  *
  4068****************************************************************
  4069
  4070     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4071         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4072             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4073
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  72
* NSRASBL.cbl
  4074         16  CF-COMBINED-LIFE-AH-OPT.
  4075             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4076             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4077             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4078             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4079
  4080         16  CF-LIFE-OPT.
  4081             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4082             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4083             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4084             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4085             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4086             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4087             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4088             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4089             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4090             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4091
  4092         16  CF-AH-OPT.
  4093             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4094             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4095             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4096             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4097             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4098             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4099             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4100             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4101             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4102             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4103
  4104         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4105             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4106             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4107             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4108
  4109         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4110
  4111         16  FILLER                         PIC X(673).
  4112
  4113
  4114****************************************************************
  4115*             MORTGAGE SYSTEM PLAN RECORD                      *
  4116****************************************************************
  4117
  4118     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4119         16  CF-PLAN-TYPE                   PIC X.
  4120             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4121             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4122             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4123         16  CF-PLAN-ABBREV                 PIC XXX.
  4124         16  CF-PLAN-DESCRIPT               PIC X(10).
  4125         16  CF-PLAN-NOTES                  PIC X(20).
  4126         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4127         16  CF-PLAN-UNDERWRITING.
  4128             20  CF-PLAN-TERM-DATA.
  4129                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4130                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4131             20  CF-PLAN-AGE-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  73
* NSRASBL.cbl
  4132                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4133                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4134                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4135             20  CF-PLAN-BENEFIT-DATA.
  4136                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4137                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4138                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4139                                            PIC S9(7)V99  COMP-3.
  4140         16  CF-PLAN-POLICY-FORMS.
  4141             20  CF-POLICY-FORM             PIC X(12).
  4142             20  CF-MASTER-APPLICATION      PIC X(12).
  4143             20  CF-MASTER-POLICY           PIC X(12).
  4144         16  CF-PLAN-RATING.
  4145             20  CF-RATE-CODE               PIC X(5).
  4146             20  CF-SEX-RATING              PIC X.
  4147                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4148                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4149             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4150             20  CF-SUB-STD-TYPE            PIC X.
  4151                 88  CF-PCT-OF-PREM            VALUE '1'.
  4152                 88  CF-PCT-OF-BENE            VALUE '2'.
  4153         16  CF-PLAN-PREM-TOLERANCES.
  4154             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4155             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4156         16  CF-PLAN-PYMT-TOLERANCES.
  4157             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4158             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4159         16  CF-PLAN-MISC-DATA.
  4160             20  FILLER                     PIC X.
  4161             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4162             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4163         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4164         16  CF-PLAN-IND-GRP                PIC X.
  4165             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4166                                                     '1'.
  4167             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4168                                                     '2'.
  4169         16  CF-MIB-SEARCH-SW               PIC X.
  4170             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4171             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4172             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4173             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4174         16  CF-ALPHA-SEARCH-SW             PIC X.
  4175             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4176             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4177             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4178             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4179             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4180             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4181             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4182             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4183             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4184             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4185                                                     'A' 'B' 'C'
  4186                                                     'X' 'Y' 'Z'.
  4187         16  CF-EFF-DT-RULE-SW              PIC X.
  4188             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4189             88  CF-EFF-DT-MONTH               VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  74
* NSRASBL.cbl
  4190             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4191             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4192             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4193         16  FILLER                         PIC X(4).
  4194         16  CF-HEALTH-QUESTIONS            PIC X.
  4195             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4196         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4197         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4198         16  CF-PLAN-SNGL-JNT               PIC X.
  4199             88  CF-COMBINED-PLAN              VALUE 'C'.
  4200             88  CF-JNT-PLAN                   VALUE 'J'.
  4201             88  CF-SNGL-PLAN                  VALUE 'S'.
  4202         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4203         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4204         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4205         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4206         16  CF-RERATE-CNTL                 PIC  X.
  4207             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4208             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4209             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4210             88  CF-AUTO-RECALC                 VALUE '4'.
  4211         16  CF-BENEFIT-TYPE                PIC  X.
  4212             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4213             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4214         16  CF-POLICY-FEE                  PIC S999V99
  4215                                                    COMP-3.
  4216         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4217         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4218         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4219         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4220         16  FILLER                         PIC  X(32).
  4221         16  CF-TERMINATION-FORM            PIC  X(04).
  4222         16  FILLER                         PIC  X(08).
  4223         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4224                                                       COMP-3.
  4225         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4226         16  CF-ISSUE-LETTER                PIC  X(4).
  4227         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4228         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4229             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4230             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4231         16  CF-MP-REFUND-CALC              PIC X.
  4232             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4233             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4234             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4235             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4236             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4237             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4238             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4239             88  CF-MP-REFD-MEAN                VALUE '8'.
  4240         16  CF-ALT-RATE-CODE               PIC  X(5).
  4241
  4242
  4243         16  FILLER                         PIC X(498).
  4244****************************************************************
  4245*             MORTGAGE COMPANY MASTER RECORD                   *
  4246****************************************************************
  4247
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  75
* NSRASBL.cbl
  4248     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4249         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4250         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4251             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4252             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4253             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4254             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4255             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4256
  4257         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4258         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4259         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4260         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4261         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4262
  4263         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4264             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4265         16  CF-MP-RECON-USE-IND            PIC X(1).
  4266             88  CF-MP-USE-RECON             VALUE 'Y'.
  4267         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4268             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4269         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4270             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4271             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4272         16  FILLER                         PIC X(1).
  4273         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4274             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4275         16  CF-MORTG-MIB-VERSION           PIC X.
  4276             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4277             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4278             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4279         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4280             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4281                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4282             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4283                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4284             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4285                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4286             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4287                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4288             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4289                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4290             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4291                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4292         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4293         16  FILLER                         PIC X(7).
  4294         16  CF-MORTG-DESTINATION-SYMBOL.
  4295             20  CF-MORTG-MIB-COMM          PIC X(5).
  4296             20  CF-MORTG-MIB-TERM          PIC X(5).
  4297         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4298             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4299         16  FILLER                         PIC X(03).
  4300         16  CF-MP-CHECK-NO-CONTROL.
  4301             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4302                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4303                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4304                                                ' ' LOW-VALUES.
  4305                 88  CF-MP-CHECK-NO-PRE-PRINTED
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  76
* NSRASBL.cbl
  4306                                               VALUE '3'.
  4307         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4308         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4309         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4310             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4311                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4312             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4313                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4314             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4315                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4316             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4317                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4318             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4319                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4320             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4321                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4322         16  CF-MORTG-BILLING-AREA.
  4323             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4324                                            PIC X.
  4325         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4326         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4327         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4328         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4329             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4330             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4331         16  FILLER                         PIC X.
  4332         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4333             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4334             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4335         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4336         16  FILLER                         PIC X(8).
  4337         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4338         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4339         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4340         16  CF-ACH-COMPANY-ID.
  4341             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4342                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4343                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4344                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4345             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4346         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4347             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4348         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4349             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4350             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4351         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4352         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4353         16  FILLER                         PIC X(536).
  4354
  4355****************************************************************
  4356*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4357****************************************************************
  4358
  4359     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4360         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4361             20  CF-FEMALE-HEIGHT.
  4362                 24  CF-FEMALE-FT           PIC 99.
  4363                 24  CF-FEMALE-IN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  77
* NSRASBL.cbl
  4364             20  CF-FEMALE-MIN-WT           PIC 999.
  4365             20  CF-FEMALE-MAX-WT           PIC 999.
  4366         16  FILLER                         PIC X(428).
  4367
  4368     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4369         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4370             20  CF-MALE-HEIGHT.
  4371                 24  CF-MALE-FT             PIC 99.
  4372                 24  CF-MALE-IN             PIC 99.
  4373             20  CF-MALE-MIN-WT             PIC 999.
  4374             20  CF-MALE-MAX-WT             PIC 999.
  4375         16  FILLER                         PIC X(428).
  4376******************************************************************
  4377*             AUTOMATIC ACTIVITY RECORD                          *
  4378******************************************************************
  4379     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4380         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4381             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4382             20  CF-SYS-LETTER-ID           PIC X(04).
  4383             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4384             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4385             20  CF-SYS-RESET-SW            PIC X(01).
  4386             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4387             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4388
  4389         16  FILLER                         PIC X(50).
  4390
  4391         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4392             20  CF-USER-ACTIVE-SW          PIC X(01).
  4393             20  CF-USER-LETTER-ID          PIC X(04).
  4394             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4395             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4396             20  CF-USER-RESET-SW           PIC X(01).
  4397             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4398             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4399             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4400
  4401         16  FILLER                         PIC X(246).
  4402*                                COPY NSCASVARS.
  4403******************************************************************
  4404*                   C H A N G E   L O G
  4405*
  4406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4407*-----------------------------------------------------------------
  4408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4409* EFFECTIVE    NUMBER
  4410*-----------------------------------------------------------------
  4411* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4412* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4413******************************************************************
  4414 01 NAPER-OUTPUT-DATA.
  4415    05  F                       PIC X(07) VALUE "LETTER=".
  4416    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4417    05  F                       PIC X(08) VALUE "~PROCID=".
  4418    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4419    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4420    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4421    05  F                       PIC X(11) VALUE "~PROCTITLE=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  78
* NSRASBL.cbl
  4422    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4423    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4424    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4425    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4426    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4427    05  F                       PIC X(06) VALUE "~CARR=".
  4428    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4429    05  F                       PIC X(10) VALUE "~GROUPING=".
  4430    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4431    05  F                       PIC X(08) VALUE "~CERTST=".
  4432    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4433    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4434    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4435    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4436    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4437    05  F                       PIC X(07) VALUE "~CRTNO=".
  4438    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4439    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4440    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4441    05  F                       PIC X(08) VALUE "~ILNAME=".
  4442    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4443    05  F                       PIC X(08) VALUE "~IFNAME=".
  4444    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4445    05  F                       PIC X(08) VALUE "~IFINIT=".
  4446    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4447    05  F                       PIC X(08) VALUE "~IMINIT=".
  4448    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4449    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4450    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4451    05  F                       PIC X(06) VALUE "~ISEX=".
  4452    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4453    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4454    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4455    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4456    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4457    05  F                       PIC X(09) VALUE "~INSCITY=".
  4458    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4459    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4460    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4461    05  F                       PIC X(08) VALUE "~INSZIP=".
  4462    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4463    05  F                       PIC X(05) VALUE "~SSN=".
  4464    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4465    05  F                       PIC X(07) VALUE "~MEMNO=".
  4466    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4467    05  F                       PIC X(08) VALUE "~JLNAME=".
  4468    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4469    05  F                       PIC X(08) VALUE "~JFNAME=".
  4470    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4471    05  F                       PIC X(08) VALUE "~JMINIT=".
  4472    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4473    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4474    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4475    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4476    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4477    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4478    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4479    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  79
* NSRASBL.cbl
  4480    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4481    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4482    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4483    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4484    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4485    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4486    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4487    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4488    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4489    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4490    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4491    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4492    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4493    05  F                       PIC X(10) VALUE "~BENENAME=".
  4494    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4495    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4496    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4497    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4498    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4499    05  F                       PIC X(10) VALUE "~BENECITY=".
  4500    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4501    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4502    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4503    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4504    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4505    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4506    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4507    05  F                       PIC X(08) VALUE "~RESPNO=".
  4508    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4509    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4510    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4511    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4512    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4513    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4514    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4515    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4516    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4517    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4518    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4519    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4520    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4521    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4522    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4523    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4524    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4525    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4526    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4527    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4528    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4529    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4530    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4531    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4532    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4533    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4534    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4535    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4536    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4537    05  F                       PIC X(07) VALUE "~BATCH=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  80
* NSRASBL.cbl
  4538    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4539    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4540    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4541    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4542    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4543    05  F                       PIC X(05) VALUE "~APR=".
  4544    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4545    05  F                       PIC X(08) VALUE "~LNTERM=".
  4546    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4547    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4548    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4549    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4550    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4551    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4552    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4553    05  F                       PIC X(07) VALUE "~UCODE=".
  4554    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4555    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4556    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4557    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4558    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4559    05  F                       PIC X(06) VALUE "~SKIP=".
  4560    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4561    05  F                       PIC X(06) VALUE "~MODE=".
  4562    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4563    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4564    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4565    05  F                       PIC X(06) VALUE "~RTBL=".
  4566    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4567    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4568    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4569    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4570    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4571    05  F                       PIC X(08) VALUE "~LFTERM=".
  4572    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4573    05  F                       PIC X(07) VALUE "~LFDEV=".
  4574    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4575    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4576    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4577    05  F                       PIC X(07) VALUE "~LFBEN=".
  4578    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4579    05  F                       PIC X(08) VALUE "~LFPREM=".
  4580    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4581    05  F                       PIC X(08) VALUE "~LFABEN=".
  4582    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4583    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4584    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4585    05  F                       PIC X(07) VALUE "~LFNSP=".
  4586    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4587    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4588    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4589    05  F                       PIC X(07) VALUE "~LFCAN=".
  4590    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4591    05  F                       PIC X(07) VALUE "~LFDTH=".
  4592    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4593    05  F                       PIC X(08) VALUE "~LFRATE=".
  4594    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4595    05  F                       PIC X(09) VALUE "~LFARATE=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  81
* NSRASBL.cbl
  4596    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4597    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4598    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4599    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4600    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4601    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4602    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4603    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4604    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4605    05  F                       PIC X(07) VALUE "~DTHDT=".
  4606    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4607    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4608    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4609    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4610    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4611    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4612    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4613    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4614    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4615    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4616    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4617    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4618    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4619    05  F                       PIC X(08) VALUE "~AHTERM=".
  4620    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4621    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4622    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4623    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4624    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4625    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4626    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4627    05  F                       PIC X(07) VALUE "~AHBEN=".
  4628    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4629    05  F                       PIC X(08) VALUE "~AHPREM=".
  4630    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4631    05  F                       PIC X(07) VALUE "~AHNSP=".
  4632    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4633    05  F                       PIC X(07) VALUE "~AHCAN=".
  4634    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4635    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4636    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4637    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4638    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4639    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4640    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4641    05  F                       PIC X(08) VALUE "~AHRATE=".
  4642    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4643    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4644    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4645    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4646    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4647    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4648    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4649    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4650    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4651    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4652    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4653    05  F                       PIC X(08) VALUE "~AHCOMM=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  82
* NSRASBL.cbl
  4654    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4655    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4656    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4657    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4658    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4659    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4660    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4661    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4662    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4663    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4664    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4665    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4666                                PIC X(2).
  4667    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4668    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4669    05  F                       PIC X(08) VALUE "~TOTREF=".
  4670    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4671    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4672    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4673    05  F                       PIC X(07) VALUE "~STERM=".
  4674    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4675    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4676    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4677    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4678    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4679    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4680    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4681    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4682    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4683    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4684    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4685    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4686    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4687    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4688    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4689    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4690    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4691    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4692    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4693    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4694    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4695    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4696    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4697    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4698                                PIC X(12).
  4699    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4700    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4701    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4702                                PIC X(12).
  4703    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4704    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4705    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4706    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4707    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4708    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4709    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4710    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4711    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  83
* NSRASBL.cbl
  4712                                PIC X(12).
  4713    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4714    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4715    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4716                                PIC X(10).
  4717    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4718    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4719    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4720    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4721    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4722    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4723    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4724    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4725    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4726    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4727    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4728    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4729    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4730                                PIC X(10).
  4731    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4732    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4733    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4734                                PIC X(10).
  4735    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4736    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4737    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4738    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4739    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4740    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4741    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4742    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4743    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4744    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4745    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4746    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4747    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4748    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4749    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4750    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4751    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4752    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4753    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4754                                PIC X(2).
  4755    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4756    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4757    05  F                       PIC X(08) VALUE "~OSTERM=".
  4758    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4759    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4760    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4761    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4762    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4763    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4764    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4765    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4766    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4767    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4768                                PIC X(09).
  4769    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  84
* NSRASBL.cbl
  4770    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4771    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4772    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4773    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4774    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4775    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4776    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4777    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4778                                PIC X(09).
  4779    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4780    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4781    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4782    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4783    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4784                                PIC X(09).
  4785    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4786    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4787    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4788                                PIC X(12).
  4789    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4790    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4791    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4792                                PIC X(10).
  4793    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4794    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4795    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4796    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4797    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4798                                PIC X(12).
  4799    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4800    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4801    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4802                                PIC X(10).
  4803    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4804    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4805    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4806    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4807    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4808    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4809    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4810    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4811    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4812                                PIC X(09).
  4813    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4814    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4815    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4816                                PIC X(09).
  4817    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4818    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4819    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4820                                PIC X(10).
  4821    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4822    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4823    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4824                                PIC X(10).
  4825    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4826    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4827    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  85
* NSRASBL.cbl
  4828    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4829    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4830    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4831    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4832    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4833    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4834    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  4835    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  4836    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  4837    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  4838    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  4839    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  4840                                PIC X(09).
  4841    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  4842    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  4843    05  F                       PIC X(08) VALUE "~NSTERM=".
  4844    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  4845    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  4846                                PIC X(09).
  4847    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  4848    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  4849    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  4850    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  4851    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  4852    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  4853    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  4854    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  4855    05  F                       PIC X(09) VALUE "~BALLOON=".
  4856    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  4857    05  F                       PIC X(10) VALUE "~LEASEIND=".
  4858    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  4859    05  F                       PIC X(09) VALUE "~RESCIND=".
  4860    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  4861    05  F                       PIC X(07) VALUE "~RCD01=".
  4862    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  4863    05  F                       PIC X(07) VALUE "~RCD02=".
  4864    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  4865    05  F                       PIC X(07) VALUE "~RCD03=".
  4866    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  4867    05  F                       PIC X(07) VALUE "~RCD04=".
  4868    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  4869    05  F                       PIC X(07) VALUE "~RCD05=".
  4870    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  4871    05  F                       PIC X(07) VALUE "~RCD06=".
  4872    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  4873    05  F                       PIC X(07) VALUE "~RCD07=".
  4874    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  4875    05  F                       PIC X(07) VALUE "~RCD08=".
  4876    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  4877    05  F                       PIC X(07) VALUE "~RCD09=".
  4878    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  4879    05  F                       PIC X(07) VALUE "~RCD10=".
  4880    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  4881    05  F                       PIC X(07) VALUE "~RCD11=".
  4882    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  4883    05  F                       PIC X(07) VALUE "~RCD12=".
  4884    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  4885    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  86
* NSRASBL.cbl
  4886    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  4887    05  F                       PIC X(08) VALUE "~ARCHNO=".
  4888    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  4889    05  F                       PIC X(06) VALUE "~FORM=".
  4890    05  OUT-FORM                PIC X(03) VALUE SPACES.
  4891    05  F                       PIC X(09) VALUE "~ENCLINE=".
  4892    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  4893    05  F                       PIC X(08) VALUE "~ATTACH=".
  4894    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  4895    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  4896    05  OUT-STACK               PIC X(10) VALUE SPACES.
  4897    05  F                       PIC X(11) VALUE "~STATENAME=".
  4898    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  4899    05  F                       PIC X(08) VALUE "~PRTNOW=".
  4900    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  4901    05  F                       PIC X(05) VALUE "~NCB=".
  4902    05  OUT-CHGBACK             PIC X     VALUE ' '.
  4903    05  F                       PIC X(8) VALUE "~CSOAMT=".
  4904    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  4905    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  4906    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  4907    05  F                       PIC X(09) VALUE "~LETRTYP=".
  4908    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  4909    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  4910    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  4911    05  F                       PIC X(08) VALUE "~INSBDT=".
  4912    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  4913    05  F                       PIC X(08) VALUE "~JNTBDT=".
  4914    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  4915    05  F                       PIC X(08) VALUE "~TOTINT=".
  4916    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  4917    05  F                       PIC X(8) VALUE "~TOPREM=".
  4918    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  4919    05  F                       PIC X(7) VALUE "~TOREF=".
  4920    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  4921    05  F                       PIC X(7) VALUE "~CANDT=".
  4922    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  4923    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  4924    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  4925    05  F                       PIC X(08) VALUE "~CERTID=".
  4926    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  4927    05  F                       PIC X(08) VALUE "~UNDWID=".
  4928    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
  4929    05  F                       PIC X(8) VALUE "~TNPREM=".
  4930    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  4931    05  F                       PIC X(7) VALUE "~TNREF=".
  4932    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  4933    05  F                       PIC X(8)  VALUE "~COVIND=".
  4934    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  4935    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  4936    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  4937    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  4938    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  4939    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  4940    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  4941    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  4942    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  4943    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  87
* NSRASBL.cbl
  4944    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  4945    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  4946                                PIC X(10).
  4947    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  4948    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4949    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  4950    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4951    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  4952    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4953    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  4954    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4955    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  4956    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4957    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  4958    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4959    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  4960    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  4961    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  4962    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4963    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  4964    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4965    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  4966    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  4967    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  4968    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  4969    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  4970    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4971    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  4972    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4973    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  4974    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  4975    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  4976    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  4977    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  4978    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4979    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  4980    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4981    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  4982    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  4983    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  4984    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  4985    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  4986    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4987    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  4988    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4989    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  4990    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4991    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  4992    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  4993    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  4994    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  4995    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  4996    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4997    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  4998    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4999    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5000    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5001    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  88
* NSRASBL.cbl
  5002    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5003    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5004    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5005    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5006    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5007    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5008    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5009    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5010    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5011    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5012    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5013    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5014    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5015    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5016    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5017    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5018    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5019    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5020    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5021    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5022    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5023    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5024    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5025    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5026    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5027    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5028    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5029    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5030    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5031    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5032    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5033    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5034    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5035    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5036    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5037    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5038    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5039    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5040    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5041    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5042    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5043    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5044    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
  5045    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5046    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5047    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5048    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5049    05  F                       PIC X(11) VALUE 'EndOfString'.
  5050    05  f                       pic x(12) value spaces.
  5051*                                COPY ERCARCH.
  5052******************************************************************
  5053*                                                                *
  5054*                            ERCARCH.                            *
  5055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5056*                            VMOD=2.002                          *
  5057*                                                                *
  5058*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5059*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  89
* NSRASBL.cbl
  5060*   FILE TYPE = VSAM,KSDS                                        *
  5061*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5062*                                                                *
  5063*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5064*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5065*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5066*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5067*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5068*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5069*                                                                *
  5070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5071******************************************************************
  5072*                   C H A N G E   L O G
  5073*
  5074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5075*-----------------------------------------------------------------
  5076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5077* EFFECTIVE    NUMBER
  5078*-----------------------------------------------------------------
  5079* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5080* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5081* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5082******************************************************************
  5083 01  LETTER-ARCHIVE.
  5084     12  LA-RECORD-ID                PIC  X(02).
  5085         88  LA-VALID-ID                VALUE 'LA'.
  5086
  5087     12  LA-CONTROL-PRIMARY.
  5088         16  LA-COMPANY-CD           PIC  X(01).
  5089         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5090
  5091     12  LA-CONTROL-BY-CERT-RESP.
  5092         16  LA-COMPANY-CD-A2        PIC  X(01).
  5093         16  LA-CERT-NO-A2.
  5094             20  LA-CERT-PRIME-A2    PIC  X(10).
  5095             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5096         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5097             20  LA-RESP-PERSON-A2   PIC  X(10).
  5098             20  LA-TYPE-A2          PIC  X(01).
  5099         16  LA-CARRIER-A2           PIC  X(01).
  5100         16  LA-GROUPING-A2          PIC  X(06).
  5101         16  LA-STATE-A2             PIC  X(02).
  5102         16  LA-ACCOUNT-A2           PIC  X(10).
  5103         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5104         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5105
  5106     12  LA-CONTROL-BY-FORM.
  5107         16  LA-COMPANY-CD-A3        PIC  X(01).
  5108         16  LA-FORM-A3              PIC  X(04).
  5109         16  LA-CARRIER-A3           PIC  X(01).
  5110         16  LA-GROUPING-A3          PIC  X(06).
  5111         16  LA-STATE-A3             PIC  X(02).
  5112         16  LA-ACCOUNT-A3           PIC  X(10).
  5113         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5114
  5115     12  LA-CONTROL-BY-PROCESSOR.
  5116         16  LA-COMPANY-CD-A4        PIC  X(01).
  5117         16  LA-PROCESSOR-CD         PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  90
* NSRASBL.cbl
  5118         16  LA-CARRIER-A4           PIC  X(01).
  5119         16  LA-GROUPING-A4          PIC  X(06).
  5120         16  LA-STATE-A4             PIC  X(02).
  5121         16  LA-ACCOUNT-A4           PIC  X(10).
  5122         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5123
  5124     12  LA-CONTROL-BY-KEY-FIELDS.
  5125         16  LA-COMPANY-CD-A5        PIC  X(01).
  5126         16  LA-CARRIER-A5           PIC  X(01).
  5127         16  LA-GROUPING-A5          PIC  X(06).
  5128         16  LA-STATE-A5             PIC  X(02).
  5129         16  LA-ACCOUNT-A5           PIC  X(10).
  5130         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5131
  5132     12  LA-CONTROL-BY-GROUP-CODE.
  5133         16  LA-COMPANY-CD-A6        PIC  X(01).
  5134         16  LA-ENTRY-A6.
  5135             20  LA-FILLER           PIC  X(02).
  5136             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5137         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5138
  5139     12  FILLER                      PIC  X(09).
  5140
  5141     12  LA-HEADER-RECORD.
  5142         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5143         16  LA-CREATION-DATE        PIC  X(02).
  5144         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5145         16  LA-FINAL-ACT-DATE       REDEFINES
  5146               LA-FOLLOW-UP-DATE     PIC  X(02).
  5147         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5148         16  LA-NO-OF-COPIES         PIC S9(01).
  5149         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5150         16  LA-REPLY-DATE           PIC  X(02).
  5151         16  LA-RESEND-DATES.
  5152             20  LA-RESEND-DATE      PIC  X(02).
  5153             20  LA-SENT-DATE        PIC  X(02).
  5154             20  FILLER              PIC  X(08).
  5155         16  LA-SOURCE-INFORMATION.
  5156             20  LA-DATA-SOURCE      PIC  X(01).
  5157             20  LA-ADDR-SOURCE      PIC  X(01).
  5158         16  LA-STATUS               PIC  X(01).
  5159             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5160             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5161             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5162             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5163             88  LA-STATUS-PURGED         VALUE 'P'.
  5164             88  LA-STATUS-VOIDED         VALUE 'V'.
  5165         16  LA-LAST-RESENT-PRINT-DATE
  5166                                     PIC  X(02).
  5167         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5168             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5169                                          VALUE 'C'.
  5170             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5171                                          VALUE 'F'.
  5172             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5173                                          VALUE 'P'.
  5174         16  LA-PURGED-DATE          PIC  X(02).
  5175         16  LA-VOIDED-DATE          PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  91
* NSRASBL.cbl
  5176         16  LA-RESEND-LETR          PIC  X(4).
  5177         16  FILLER                  PIC  X(08).
  5178*        16  LA-RESEND-LETR-2        PIC  X(4).
  5179*        16  LA-RESEND-LETR-3        PIC  X(4).
  5180*        16  FILLER                  PIC  X(59).
  5181         16  LA-ARCHIVE-STATUS       PIC  X.
  5182             88  LA-TEMP                VALUE 'T'.
  5183             88  LA-QWS                 VALUE 'Q'.
  5184             88  LA-BATCH               VALUE 'B'.
  5185         16  LA-FINAL-ACT-IND        PIC  X(1).
  5186         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5187         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5188         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5189                                     PIC X(4).
  5190         16  FILLER                  PIC  X(42).
  5191*        16  FILLER                  PIC  X(71).
  5192         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5193         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5194         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5195                                     PIC  X(4).
  5196         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5197
  5198******************************************************************
  5199*                                COPY ELCCRTT.
  5200******************************************************************
  5201*                                                                *
  5202*                            ELCCRTT.                            *
  5203*                                                                *
  5204*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5205*                                                                *
  5206*   FILE TYPE = VSAM,KSDS                                        *
  5207*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5208*                                                                *
  5209*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5210*                                                                *
  5211*   LOG = YES                                                    *
  5212*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5213******************************************************************
  5214*                   C H A N G E   L O G
  5215*
  5216* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5217*-----------------------------------------------------------------
  5218*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5219* EFFECTIVE    NUMBER
  5220*-----------------------------------------------------------------
  5221* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5222* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5223* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5224* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5225******************************************************************
  5226
  5227 01  CERTIFICATE-TRAILERS.
  5228     12  CS-RECORD-ID                      PIC XX.
  5229         88  VALID-CS-ID                      VALUE 'CS'.
  5230
  5231     12  CS-CONTROL-PRIMARY.
  5232         16  CS-COMPANY-CD                 PIC X.
  5233         16  CS-CARRIER                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  92
* NSRASBL.cbl
  5234         16  CS-GROUPING                   PIC X(6).
  5235         16  CS-STATE                      PIC XX.
  5236         16  CS-ACCOUNT                    PIC X(10).
  5237         16  CS-CERT-EFF-DT                PIC XX.
  5238         16  CS-CERT-NO.
  5239             20  CS-CERT-PRIME             PIC X(10).
  5240             20  CS-CERT-SFX               PIC X.
  5241         16  CS-TRAILER-TYPE               PIC X.
  5242             88  COMM-TRLR           VALUE 'A'.
  5243             88  FUTURE-TRLR         VALUE 'B'.
  5244             88  CERT-DATA-TRLR      VALUE 'C'.
  5245
  5246     12  CS-DATA-AREA                      PIC X(516).
  5247
  5248     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5249         16  CS-BANK-COMMISSION-AREA.
  5250             20  CS-BANK-COMMS       OCCURS 10.
  5251                 24  CS-AGT                PIC X(10).
  5252                 24  CS-COM-TYP            PIC X.
  5253                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5254                 24  CS-RECALC-LV-INDIC    PIC X.
  5255                 24  FILLER                PIC X(10).
  5256         16  FILLER                        PIC X(256).
  5257
  5258     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5259         16  CS-VIN-NUMBER                 PIC X(17).
  5260         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5261         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5262         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5263         16  FILLER                        PIC X(496).
  5264******************************************************************
  5265 01  FILLER                      PIC X(500)  VALUE SPACES.
  5266*                                COPY ELCENCC.
  5267******************************************************************
  5268*                                                                *
  5269*                                                                *
  5270*                            ELCENCC                             *
  5271*                            VMOD=2.001                          *
  5272*                                                                *
  5273*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5274*                                                                *
  5275*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5276*   A NAPERSOFT DOCUMENT                                         *
  5277*                                                                *
  5278*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5279*                                                                *
  5280*   FILE TYPE = VSAM,KSDS                                        *
  5281*   RECORD SIZE = 400   RECFORM = FIX                            *
  5282*                                                                *
  5283*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5284*                                                                *
  5285*   LOG = NO                                                     *
  5286*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5287*                                                                *
  5288*                                                                *
  5289******************************************************************
  5290*                   C H A N G E   L O G
  5291*
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  93
* NSRASBL.cbl
  5292* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5293*-----------------------------------------------------------------
  5294*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5295* EFFECTIVE    NUMBER
  5296*-----------------------------------------------------------------
  5297* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5298******************************************************************
  5299 01  ENCLOSURE-CODES.
  5300     12  NC-RECORD-ID                      PIC XX.
  5301         88  VALID-NC-ID                      VALUE 'NC'.
  5302     12  NC-CONTROL-PRIMARY.
  5303         16  NC-COMPANY-CD                 PIC X.
  5304         16  NC-REC-TYPE                   PIC X.
  5305             88  NC-CLAIMS                   VALUE '1'.
  5306             88  NC-ADMIN                    VALUE '2'.
  5307         16  NC-ENC-CODE                   PIC X(5).
  5308         16  FILLER                        PIC X(09).
  5309     12  NC-MAINT-INFORMATION.
  5310         16  NC-LAST-MAINT-DT              PIC XX.
  5311         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5312         16  NC-LAST-MAINT-USER            PIC X(4).
  5313         16  FILLER                        PIC XX.
  5314     12  NC-OUTPUT-STACK                   PIC XXX.
  5315     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5316     12  NC-ATTACHMENTS                    PIC X(100).
  5317     12  NC-FUTURE                         PIC X(50).
  5318     12  FILLER                            PIC X(117).
  5319******************************************************************
  5320****************************************************************
  5321*
  5322* Copyright (c) 2007 by Clerity Solutions, Inc.
  5323* All rights reserved.
  5324*
  5325****************************************************************
  5326 01  DFHEIV.
  5327   02  DFHEIV0               PIC X(35).
  5328   02  DFHEIV1               PIC X(08).
  5329   02  DFHEIV2               PIC X(08).
  5330   02  DFHEIV3               PIC X(08).
  5331   02  DFHEIV4               PIC X(06).
  5332   02  DFHEIV5               PIC X(04).
  5333   02  DFHEIV6               PIC X(04).
  5334   02  DFHEIV7               PIC X(02).
  5335   02  DFHEIV8               PIC X(02).
  5336   02  DFHEIV9               PIC X(01).
  5337   02  DFHEIV10              PIC S9(7) COMP-3.
  5338   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5339   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5340   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5341   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5342   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5343   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5344   02  DFHEIV17              PIC X(04).
  5345   02  DFHEIV18              PIC X(04).
  5346   02  DFHEIV19              PIC X(04).
  5347   02  DFHEIV20              USAGE IS POINTER.
  5348   02  DFHEIV21              USAGE IS POINTER.
  5349   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  94
* NSRASBL.cbl
  5350   02  DFHEIV23              USAGE IS POINTER.
  5351   02  DFHEIV24              USAGE IS POINTER.
  5352   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5353   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5354   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5355   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5356   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5357   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5358   02  FILLER                PIC X(02).
  5359   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5360   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5361   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5362   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5363   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5364 LINKAGE  SECTION.
  5365*****************************************************************
  5366*                                                               *
  5367* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5368* All rights reserved.                                          *
  5369*                                                               *
  5370*****************************************************************
  5371 01  dfheiblk.
  5372     02  eibtime          pic s9(7) comp-3.
  5373     02  eibdate          pic s9(7) comp-3.
  5374     02  eibtrnid         pic x(4).
  5375     02  eibtaskn         pic s9(7) comp-3.
  5376     02  eibtrmid         pic x(4).
  5377     02  dfheigdi         pic s9(4) comp.
  5378     02  eibcposn         pic s9(4) comp.
  5379     02  eibcalen         pic s9(4) comp.
  5380     02  eibaid           pic x(1).
  5381     02  eibfiller1       pic x(1).
  5382     02  eibfn            pic x(2).
  5383     02  eibfiller2       pic x(2).
  5384     02  eibrcode         pic x(6).
  5385     02  eibfiller3       pic x(2).
  5386     02  eibds            pic x(8).
  5387     02  eibreqid         pic x(8).
  5388     02  eibrsrce         pic x(8).
  5389     02  eibsync          pic x(1).
  5390     02  eibfree          pic x(1).
  5391     02  eibrecv          pic x(1).
  5392     02  eibsend          pic x(1).
  5393     02  eibatt           pic x(1).
  5394     02  eibeoc           pic x(1).
  5395     02  eibfmh           pic x(1).
  5396     02  eibcompl         pic x(1).
  5397     02  eibsig           pic x(1).
  5398     02  eibconf          pic x(1).
  5399     02  eiberr           pic x(1).
  5400     02  eibrldbk         pic x(1).
  5401     02  eiberrcd         pic x(4).
  5402     02  eibsynrb         pic x(1).
  5403     02  eibnodat         pic x(1).
  5404     02  eibfiller5       pic x(2).
  5405     02  eibresp          pic 9(09) comp.
  5406     02  eibresp2         pic 9(09) comp.
  5407     02  dfheigdj         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  95
* NSRASBL.cbl
  5408     02  dfheigdk         pic s9(4) comp.
  5409 01 dfhcommarea                  PIC X(6500).
  5410 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  5411 0000-DFHEXIT SECTION.
  5412     MOVE '9#                    $   ' TO DFHEIV0.
  5413     MOVE 'NSRASBL' TO DFHEIV1.
  5414     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5415     display ' entering pgm nsrasbl '
  5416     display ' commarea ' dfhcommarea
  5417     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5418     MOVE '5'                    TO DC-OPTION-CODE
  5419     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5420     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5421     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5422     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5423     move dfhcommarea            to srch-commarea
  5424*****************************************************
  5425* The full       key has been established and passed
  5426* to this program via NSRASLTR
  5427*****************************************************
  5428     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5429     display ' input data ' bl-carrier ' ' bl-group ' '
  5430        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5431     MOVE BL-LETTER-ID           TO OUT-LETTER
  5432     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5433     MOVE BL-CARRIER             TO OUT-CARRIER
  5434     MOVE BL-GROUP               TO OUT-GROUPING
  5435     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5436     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5437     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5438     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5439     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5440        DC-EDITA-DAY  DELIMITED BY SIZE
  5441        INTO OUT-CYCLE-DT
  5442     END-STRING
  5443     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5444        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5445     ELSE
  5446        IF BL-EFF-DT = SPACES
  5447           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5448        ELSE
  5449           IF BL-EFF-DT (9:2) = SPACES
  5450              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5451                     BL-EFF-DT (4:2)
  5452                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5453              END-STRING
  5454           ELSE
  5455              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5456                     BL-EFF-DT (4:2)
  5457                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5458              END-STRING
  5459           END-IF
  5460           MOVE '3'              TO DC-OPTION-CODE
  5461           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5462           IF NO-CONVERSION-ERROR
  5463              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5464           ELSE
  5465              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  96
* NSRASBL.cbl
  5466              SET BL-FAIL TO TRUE
  5467              GO TO 0000-RETURN
  5468           END-IF
  5469        END-IF
  5470     END-IF
  5471     perform 0800-init-out-data  thru 0800-exit
  5472     SET BL-FAIL TO TRUE
  5473******************************************************************
  5474* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5475*    1) FROM ACCT MAINT
  5476*    2) FROM CERT UPDATE
  5477*    3) FROM COMP MAINT
  5478*    4) FROM REVIEW AND CORRECTIONS
  5479******************************************************************
  5480     EVALUATE BL-DATA-SRCE
  5481        WHEN '1'
  5482           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5483        WHEN '2'
  5484           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5485        WHEN '3'
  5486           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5487        WHEN '4'
  5488           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5489        WHEN OTHER
  5490           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5491     END-EVALUATE
  5492     IF BL-OK
  5493        display ' bl write erarch ' bl-write-erarch
  5494        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5495        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5496        IF BL-ARCHIVE-NO = ZEROS
  5497           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5498           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5499           display ' arch zeros, new arch ' bl-archive-no
  5500        END-IF
  5501        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5502        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5503        display ' bl write erarch ' bl-write-erarch
  5504        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5505           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5506           IF BL-FAIL
  5507              GO TO 0000-RETURN
  5508           END-IF
  5509        END-IF
  5510        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5511        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5512     END-IF
  5513     .
  5514 0000-RETURN.
  5515     move srch-commarea          to dfhcommarea
  5516
  5517* exec cics
  5518*       return
  5519*    end-exec
  5520*    MOVE '.(                    ''   #00005512' TO DFHEIV0
  5521     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5522     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5523     MOVE X'2020233030303035353132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  97
* NSRASBL.cbl
  5524     CALL 'kxdfhei1' USING DFHEIV0,
  5525           DFHEIV99,
  5526           DFHEIV99,
  5527           DFHEIV99,
  5528           DFHEIV99,
  5529           DFHEIV99,
  5530           DFHEIV99
  5531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5532     .
  5533 0100-DATA-SRCE-1.
  5534     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5535     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5536     MOVE ' '                    TO WS-ERACCT-SW
  5537     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5538     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5539     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5540     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5541     MOVE BL-STATE               TO WS-ERACCT-STATE
  5542     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5543     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5544                                    WS-CERT-EFF-DT
  5545     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5546     IF ACCT-FOUND
  5547        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5548        PERFORM 1025-GET-CSR-INFO
  5549                                 THRU 1025-EXIT
  5550        PERFORM 1300-DETERMINE-COMM
  5551                                 THRU 1300-EXIT
  5552        SET BL-OK TO TRUE
  5553     ELSE
  5554        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5555        SET BL-FAIL TO TRUE
  5556     END-IF
  5557     .
  5558 0100-EXIT.
  5559     EXIT.
  5560 0200-DATA-SRCE-2.
  5561     display ' made it to data srce 2 '
  5562     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5563     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5564     MOVE ' '                    TO WS-ELCERT-SW
  5565     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5566     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5567     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5568     MOVE BL-STATE               TO WS-ELCERT-STATE
  5569     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5570     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5571                                    WS-CERT-EFF-DT
  5572     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5573
  5574     MOVE ' '                 TO WS-ERACCT-SW
  5575     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5576     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5577     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5578     IF ACCT-FOUND
  5579        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5580        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5581     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  98
* NSRASBL.cbl
  5582     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5583     IF CERT-FOUND
  5584        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5585        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5586        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5587        IF WS-LF-EARN = 'B'
  5588           MOVE 'B'              TO OUT-BALLOON-IND
  5589        END-IF
  5590        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5591        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5592        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5593        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5594
  5595        IF BL-ENDT-ARCH-NO > ZERO
  5596           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5597           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5598           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5599        ELSE
  5600           IF BL-ARCHIVE-NO > ZERO
  5601              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5602              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5603              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5604           END-IF
  5605        END-IF
  5606
  5607        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5608           AND (OUT-BALLOON-IND = 'B')
  5609           MOVE 'B'              TO OUT-FORM (3:1)
  5610        END-IF
  5611        SET BL-OK TO TRUE
  5612     ELSE
  5613        display ' cert not found ' ws-elcert-cert-no
  5614        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5615        SET BL-FAIL TO TRUE
  5616     END-IF
  5617     .
  5618 0200-EXIT.
  5619     EXIT.
  5620 0300-DATA-SRCE-3.
  5621     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5622     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5623     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5624     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5625     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5626     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5627     IF WS-ERCOMP-ACCOUNT = SPACES
  5628        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5629        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5630     ELSE
  5631        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5632     END-IF
  5633     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5634     IF RESP-NORMAL
  5635        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5636        PERFORM 1025-GET-CSR-INFO
  5637                                 THRU 1025-EXIT
  5638        SET BL-OK TO TRUE
  5639     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page  99
* NSRASBL.cbl
  5640        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5641        SET BL-FAIL TO TRUE
  5642     END-IF
  5643     .
  5644 0300-EXIT.
  5645     EXIT.
  5646 0400-DATA-SRCE-4.
  5647     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5648     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5649     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  5650     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5651     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5652                                    WS-ELCERT-SW WS-ERENDT-SW
  5653
  5654* EXEC CICS READ
  5655*         DATASET    ('ERPNDB')
  5656*         INTO       (PENDING-BUSINESS)
  5657*         RIDFLD     (WS-ERPNDB-KEY)
  5658*         RESP       (WS-RESPONSE)
  5659*    END-EXEC
  5660     MOVE LENGTH OF
  5661      PENDING-BUSINESS
  5662       TO DFHEIV11
  5663     MOVE 'ERPNDB' TO DFHEIV1
  5664*    MOVE '&"IL       E          (  N#00005636' TO DFHEIV0
  5665     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5667     MOVE X'204E233030303035363336' TO DFHEIV0(25:11)
  5668     CALL 'kxdfhei1' USING DFHEIV0,
  5669           DFHEIV1,
  5670           PENDING-BUSINESS,
  5671           DFHEIV11,
  5672           WS-ERPNDB-KEY,
  5673           DFHEIV99,
  5674           DFHEIV99,
  5675           DFHEIV99
  5676     MOVE EIBRESP  TO WS-RESPONSE
  5677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5678     IF RESP-NORMAL
  5679        IF PB-RECORD-TYPE = '1' OR '2'
  5680           MOVE PB-CARRIER       TO BL-CARRIER
  5681           MOVE PB-GROUPING      TO BL-GROUP
  5682           MOVE PB-STATE         TO BL-STATE
  5683           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5684           MOVE PB-CERT-NO       TO BL-CERT-NO
  5685           MOVE PB-CSR-ID        TO WS-CSR-ID
  5686           IF PB-ISSUE
  5687              SET PROCESS-ISSUE TO TRUE
  5688              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  5689              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  5690              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  5691              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  5692           ELSE
  5693              SET PROCESS-CANCEL TO TRUE
  5694              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  5695              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  5696              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  5697              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 100
* NSRASBL.cbl
  5698           END-IF
  5699           PERFORM 1120-MATCH-CARRIER
  5700                                 THRU 1120-EXIT
  5701           PERFORM 1125-MATCH-STATE
  5702                                 THRU 1125-EXIT
  5703           PERFORM 1130-MATCH-BENCDS
  5704                                 THRU 1130-EXIT
  5705           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  5706           MOVE WS-LF-DESC       TO OUT-LF-DESC
  5707                                    OUT-ORIG-LF-DESC
  5708           IF WS-LF-EARN = 'B'
  5709              MOVE 'B'           TO OUT-BALLOON-IND
  5710           END-IF
  5711           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  5712                                    OUT-ORIG-WAIT-PER
  5713           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  5714                                    OUT-ORIG-RET-ELIM
  5715           MOVE WS-AH-DESC       TO OUT-AH-DESC
  5716                                    OUT-ORIG-AH-DESC
  5717           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  5718                                    OUT-ORIG-BEN-DAYS
  5719           PERFORM 1025-GET-CSR-INFO
  5720                                 THRU 1025-EXIT
  5721
  5722           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  5723           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  5724                                 TO WS-ERACCT-KEY (1:22)
  5725           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  5726           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  5727           IF ACCT-FOUND
  5728              MOVE AM-CSR-CODE      TO WS-CSR-ID
  5729              PERFORM 1025-GET-CSR-INFO
  5730                                    THRU 1025-EXIT
  5731              PERFORM 1300-DETERMINE-COMM
  5732                                    THRU 1300-EXIT
  5733           END-IF
  5734
  5735           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  5736                                 TO WS-ELCERT-KEY
  5737           PERFORM 1100-GET-ELCERT
  5738                                 THRU 1100-EXIT
  5739
  5740           IF BL-ENDT-ARCH-NO > ZERO
  5741              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  5742              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  5743              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5744           ELSE
  5745              IF BL-ARCHIVE-NO > ZERO
  5746                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  5747                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  5748                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5749              END-IF
  5750           END-IF
  5751
  5752           SET BL-OK TO TRUE
  5753           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  5754              AND (OUT-BALLOON-IND = 'B')
  5755              MOVE 'B'           TO OUT-FORM (3:1)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 101
* NSRASBL.cbl
  5756           END-IF
  5757        END-IF
  5758     END-IF
  5759     .
  5760 0400-EXIT.
  5761     EXIT.
  5762 0500-SCRUB-DATA.
  5763*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  5764*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  5765*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  5766*   TO A HEX 26 TO GET BY THE DECODER
  5767     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  5768                                 TO M1
  5769     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  5770     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5771        (A1 > M1)
  5772        OR (WS-WORK-FIELD (A1:1) = '*')
  5773        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5774        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5775     END-PERFORM
  5776     IF A1 > M1
  5777        CONTINUE
  5778     ELSE
  5779        MOVE WS-WORK-FIELD (1:A1 - 1)
  5780                                 TO OUT-ACCT-NAME
  5781     END-IF
  5782     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  5783                                 TO M1
  5784     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  5785     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5786        (A1 > M1)
  5787        OR (WS-WORK-FIELD (A1:1) = '*')
  5788        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5789        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5790     END-PERFORM
  5791     IF A1 > M1
  5792        CONTINUE
  5793     ELSE
  5794        MOVE WS-WORK-FIELD (1:A1 - 1)
  5795                                 TO OUT-BENE-NAME
  5796     END-IF
  5797     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  5798         MOVE '0000000000 '  TO OUT-CERT-NO
  5799     END-IF
  5800     MOVE +1 TO M1
  5801     MOVE SPACES TO BL-RECORD-PASSED-DATA
  5802     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  5803                                 TO NS-LEN
  5804     display ' naper output data length ' ns-len
  5805     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5806        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  5807        OR (A1 > NS-LEN)
  5808        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  5809           CONTINUE
  5810        ELSE
  5811           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  5812              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  5813              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 102
* NSRASBL.cbl
  5814              ADD +1 TO M1
  5815           ELSE
  5816              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  5817                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  5818                 ADD +3 TO M1
  5819              ELSE
  5820                 MOVE NAPER-OUTPUT-DATA (A1:1)
  5821                                 TO BL-RECORD-PASSED-DATA (M1:1)
  5822                 ADD +1 TO M1
  5823              END-IF
  5824           END-IF
  5825        END-IF
  5826     END-PERFORM
  5827     .
  5828 0500-EXIT.
  5829     EXIT.
  5830 0600-GET-ERENDT.
  5831
  5832* EXEC CICS READ
  5833*         DATASET    ('ERENDT2')
  5834*         INTO       (ENDORSEMENT-RECORD)
  5835*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  5836*         RESP       (WS-RESPONSE)
  5837*    END-EXEC
  5838     MOVE LENGTH OF
  5839      ENDORSEMENT-RECORD
  5840       TO DFHEIV11
  5841     MOVE 'ERENDT2' TO DFHEIV1
  5842*    MOVE '&"IL       E          (  N#00005795' TO DFHEIV0
  5843     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5844     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5845     MOVE X'204E233030303035373935' TO DFHEIV0(25:11)
  5846     CALL 'kxdfhei1' USING DFHEIV0,
  5847           DFHEIV1,
  5848           ENDORSEMENT-RECORD,
  5849           DFHEIV11,
  5850           WS-ERENDT-KEY-BY-ARCH,
  5851           DFHEIV99,
  5852           DFHEIV99,
  5853           DFHEIV99
  5854     MOVE EIBRESP  TO WS-RESPONSE
  5855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5856     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  5857         WS-ERENDT-ARCHIVE
  5858     IF (RESP-NORMAL)
  5859        SET ENDT-FOUND TO TRUE
  5860        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  5861        PERFORM 0650-PROCESS-NO-Change
  5862                                 THRU 0650-EXIT
  5863     END-IF
  5864     .
  5865 0600-EXIT.
  5866     EXIT.
  5867 0620-BUILD-ENDT.
  5868     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  5869                                    OUT-NEW-LF-CAN-DT
  5870                                    OUT-ORIG-AH-CAN-DT
  5871                                    OUT-NEW-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 103
* NSRASBL.cbl
  5872                                    OUT-ORIG-CAN-DT
  5873                                    OUT-NEW-CAN-DT
  5874     IF EN-REC-TYPE = 'C'
  5875        GO TO 0620-PROCESS-CANCEL
  5876     END-IF
  5877     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  5878     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  5879     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5880     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  5881     IF WS-LF-EARN = 'B'
  5882        MOVE 'B'                 TO OUT-BALLOON-IND
  5883     END-IF
  5884     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  5885     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  5886     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  5887     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  5888     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  5889     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  5890     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  5891     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  5892         MOVE ZERO                 TO OUT-ORIG-IAGE
  5893     ELSE
  5894         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  5895     END-IF
  5896     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  5897     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  5898     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  5899     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  5900         MOVE ZERO                 TO OUT-ORIG-JAGE
  5901     ELSE
  5902         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  5903     END-IF
  5904     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  5905     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  5906     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  5907     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  5908     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  5909     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  5910     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  5911                             EN-LF-ORIG-ALT-PRM-AMT
  5912     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  5913     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  5914         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  5915                                    OUT-ORIG-LF-PRM-A
  5916                                    OUT-ORIG-LF-ALT-BEN-A
  5917                                    OUT-ORIG-LF-ALT-PRM-A
  5918                                    OUT-ORIG-COVERAGE-IND
  5919     ELSE
  5920         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  5921         IF EN-LF-ORIG-PRM-AMT = .01
  5922             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  5923         END-IF
  5924         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  5925             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  5926         END-IF
  5927     END-IF
  5928     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5929     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 104
* NSRASBL.cbl
  5930     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5931     IF NO-CONVERSION-ERROR
  5932        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5933           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5934              INTO OUT-ORIG-LF-EXP-DT
  5935        END-STRING
  5936     END-IF
  5937     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  5938     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  5939     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  5940     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  5941     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5942         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  5943                                    OUT-ORIG-AH-PRM-A
  5944     ELSE
  5945        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  5946            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  5947        ELSE
  5948            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  5949        END-IF
  5950        IF EN-AH-ORIG-PRM-AMT = .01
  5951            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  5952        END-IF
  5953        IF EN-AH-ORIG-BEN-AMT = 999999999.99
  5954            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  5955        END-IF
  5956     END-IF
  5957     COMPUTE WS-WORK-PREM =
  5958        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  5959           + EN-AH-ORIG-PRM-AMT
  5960     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  5961     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5962     MOVE ' '                    TO DC-OPTION-CODE
  5963     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5964     IF NO-CONVERSION-ERROR
  5965        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5966           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5967              INTO OUT-ORIG-AH-EXP-DT
  5968        END-STRING
  5969     END-IF
  5970     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  5971                                    OUT-ORIG-MAX-PMTS
  5972     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5973         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  5974     END-IF
  5975     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  5976     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  5977     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  5978     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  5979         MOVE ZERO                TO OUT-NEW-IAGE
  5980     ELSE
  5981         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  5982     END-IF
  5983     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  5984     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  5985     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  5986     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  5987         MOVE ZERO                TO OUT-NEW-JAGE
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 105
* NSRASBL.cbl
  5988     ELSE
  5989         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  5990     END-IF
  5991     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  5992     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  5993     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5994     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  5995     IF WS-LF-EARN = 'B'
  5996        MOVE 'B'                 TO OUT-BALLOON-IND
  5997     END-IF
  5998     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  5999     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6000     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6001     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6002     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6003     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6004     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6005     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6006     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6007     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6008     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6009                             EN-LF-NEW-ALT-PRM-AMT
  6010     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6011     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6012         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6013                                    OUT-NEW-LF-PRM-A
  6014                                    OUT-NEW-LF-ALT-BEN-A
  6015                                    OUT-NEW-LF-ALT-PRM-A
  6016                                    OUT-NEW-LF-CMB-PREM-A
  6017                                    OUT-NEW-COVERAGE-IND
  6018     ELSE
  6019         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6020     END-IF
  6021    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  6022     MOVE ' '                     TO DC-OPTION-CODE
  6023     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6024     IF NO-CONVERSION-ERROR
  6025        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6026           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6027              INTO OUT-NEW-LF-EXP-DT
  6028        END-STRING
  6029     END-IF
  6030     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6031     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6032     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6033     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6034     COMPUTE WS-WORK-PREM =
  6035        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6036           + EN-AH-NEW-PRM-AMT
  6037     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6038     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6039         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6040                                    OUT-NEW-AH-PRM-A
  6041     ELSE
  6042        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6043            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6044        ELSE
  6045            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 106
* NSRASBL.cbl
  6046        END-IF
  6047     END-IF
  6048     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6049     MOVE ' '                     TO DC-OPTION-CODE
  6050     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6051     IF NO-CONVERSION-ERROR
  6052        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6053           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6054              INTO OUT-NEW-AH-EXP-DT
  6055        END-STRING
  6056     END-IF
  6057     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6058                                     OUT-NEW-MAX-PMTS
  6059     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6060         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6061     END-IF
  6062     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6063        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6064     ELSE
  6065        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6066     END-IF
  6067     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6068        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6069     ELSE
  6070        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6071     END-IF
  6072     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6073        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6074     ELSE
  6075        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6076     END-IF
  6077     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6078        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6079     ELSE
  6080        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6081     END-IF
  6082     COMPUTE WS-WORK-PREM =
  6083        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6084        EN-AH-NEW-PRM-AMT) -
  6085        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6086        EN-AH-ORIG-PRM-AMT)
  6087     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6088     IF EN-CSO-PORTION NOT NUMERIC
  6089        MOVE ZEROS               TO EN-CSO-PORTION
  6090     END-IF
  6091     IF EN-ACCT-PORTION NOT NUMERIC
  6092        MOVE ZERO                TO EN-ACCT-PORTION
  6093     END-IF
  6094*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6095*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6096     IF WS-WORK-PREM > +0
  6097        MOVE 'CSO'               TO OUT-PAYEE
  6098     ELSE
  6099      IF WS-WORK-PREM = +0
  6100         MOVE 'ZERO'             TO OUT-PAYEE
  6101      ELSE
  6102         MOVE 'ACCT'             TO OUT-PAYEE
  6103      END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 107
* NSRASBL.cbl
  6104     END-IF
  6105     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6106        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6107     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6108     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6109        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6110     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6111     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6112        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6113        * EN-LF-ORIG-COMM-PCT
  6114     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6115     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6116        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6117     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6118     COMPUTE WS-ACCT-ORIG-PORTION =
  6119        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6120     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6121
  6122     COMPUTE WS-CSO-ORIG-LF-PORT =
  6123       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6124     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6125     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6126       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6127     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6128     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6129       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6130        WS-ACCT-ORIG-CMB-LF-PORT
  6131     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6132     COMPUTE WS-CSO-ORIG-AH-PORT =
  6133        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6134     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6135     COMPUTE WS-CSO-ORIG-PORTION =
  6136        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6137     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6138     COMPUTE WS-ACCT-NEW-LF-PORT =
  6139        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6140     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6141     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6142        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6143     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6144     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6145        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6146        * EN-LF-NEW-COMM-PCT
  6147     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6148     COMPUTE WS-ACCT-NEW-AH-PORT =
  6149        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6150     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6151     COMPUTE WS-ACCT-NEW-PORTION =
  6152        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6153     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6154
  6155     COMPUTE WS-CSO-NEW-LF-PORT =
  6156       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6157     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6158     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6159       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6160     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6161     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 108
* NSRASBL.cbl
  6162       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6163        WS-ACCT-NEW-CMB-LF-PORT
  6164     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6165     COMPUTE WS-CSO-NEW-AH-PORT =
  6166        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6167     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6168     COMPUTE WS-CSO-NEW-PORTION =
  6169        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6170     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6171
  6172     COMPUTE WS-ACCT-LF-PORT-CHG =
  6173        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6174     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6175     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6176        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6177     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6178     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6179        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6180     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6181     COMPUTE WS-ACCT-AH-PORT-CHG =
  6182        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6183     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6184     COMPUTE WS-ACCT-PORTION-CHG =
  6185        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6186     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6187
  6188     COMPUTE WS-CSO-LF-PORT-CHG =
  6189        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6190     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6191     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6192        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6193     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6194     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6195        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6196     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6197     COMPUTE WS-CSO-AH-PORT-CHG =
  6198        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6199     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6200     COMPUTE WS-CSO-PORTION-CHG =
  6201        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6202     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6203
  6204     COMPUTE WS-WORK-PREM =
  6205         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6206     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6207     COMPUTE WS-WORK-PREM =
  6208         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6209     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6210     COMPUTE WS-WORK-PREM =
  6211        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6212        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6213     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6214     COMPUTE WS-WORK-PREM =
  6215        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6216     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6217
  6218     move en-sig-sw              to out-sig-sw
  6219     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 109
* NSRASBL.cbl
  6220     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6221     GO TO 0620-CONTINUE
  6222     .
  6223 0620-PROCESS-CANCEL.
  6224     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6225        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6226        MOVE ' '                 TO DC-OPTION-CODE
  6227        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6228        IF NO-CONVERSION-ERROR
  6229           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6230              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6231                 INTO OUT-ORIG-LF-CAN-DT
  6232           END-STRING
  6233        END-IF
  6234        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6235     END-IF
  6236
  6237     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6238        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6239        MOVE ' '                 TO DC-OPTION-CODE
  6240        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6241        IF NO-CONVERSION-ERROR
  6242           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6243              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6244                 INTO OUT-NEW-LF-CAN-DT
  6245           END-STRING
  6246        END-IF
  6247        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6248     END-IF
  6249
  6250     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6251        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6252        MOVE ' '                    TO DC-OPTION-CODE
  6253        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6254        IF NO-CONVERSION-ERROR
  6255           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6256              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6257                 INTO OUT-ORIG-AH-CAN-DT
  6258           END-STRING
  6259        END-IF
  6260        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6261           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6262        END-IF
  6263     END-IF
  6264
  6265     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6266        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6267        MOVE ' '                    TO DC-OPTION-CODE
  6268        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6269        IF NO-CONVERSION-ERROR
  6270           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6271              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6272                 INTO OUT-NEW-AH-CAN-DT
  6273           END-STRING
  6274        END-IF
  6275        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6276           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6277        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 110
* NSRASBL.cbl
  6278     END-IF
  6279     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6280     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6281     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6282     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6283     COMPUTE WS-WORK-PREM =
  6284        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6285     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6286     COMPUTE WS-WORK-PREM =
  6287        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6288     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6289     COMPUTE WS-WORK-PREM =
  6290        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6291        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6292     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6293
  6294     COMPUTE WS-WORK-PREM =
  6295        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6296     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6297     COMPUTE WS-WORK-PREM =
  6298        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6299     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6300
  6301*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6302*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6303     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6304
  6305     IF EN-COMM-CHGBK = 'N'
  6306         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6307                                   OUT-CSO-ORIG-ALT-LF-PORT
  6308         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6309         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6310         COMPUTE WS-CSO-ORIG-PORTION =
  6311             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6312         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6313         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6314                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6315                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6316                                   OUT-ACCT-ORIG-AH-PORT
  6317                                   OUT-ACCT-ORIG-PORTION
  6318
  6319         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6320                                   OUT-CSO-NEW-ALT-LF-PORT
  6321         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6322         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6323         COMPUTE WS-CSO-NEW-PORTION =
  6324             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6325         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6326         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6327                                   OUT-ACCT-NEW-ALT-LF-PORT
  6328                                   OUT-ACCT-NEW-CMB-LF-PORT
  6329                                   OUT-ACCT-NEW-AH-PORT
  6330                                   OUT-ACCT-NEW-PORTION
  6331
  6332         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6333                                   OUT-CSO-ALT-LF-PORT-CHG
  6334         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6335           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 111
* NSRASBL.cbl
  6336         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6337         COMPUTE WS-CSO-AH-PORT-CHG =
  6338           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6339         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6340         COMPUTE WS-CSO-PORTION-CHG =
  6341           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6342           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6343         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6344         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6345                                   OUT-ACCT-ALT-LF-PORT-CHG
  6346                                   OUT-ACCT-CMB-LF-PORT-CHG
  6347                                   OUT-ACCT-AH-PORT-CHG
  6348                                   OUT-ACCT-PORTION-CHG
  6349     ELSE
  6350         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6351                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6352         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6353           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6354         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6355                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6356         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6357           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6358         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6359         COMPUTE WS-ACCT-ORIG-PORTION =
  6360            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6361         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6362
  6363         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6364                                   OUT-CSO-ORIG-ALT-LF-PORT
  6365         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6366           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6367         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6368         COMPUTE WS-CSO-ORIG-AH-PORT =
  6369           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
  6370         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6371         COMPUTE WS-CSO-ORIG-PORTION =
  6372            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6373         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6374
  6375         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6376                                   OUT-ACCT-NEW-ALT-LF-PORT
  6377         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6378           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6379         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6380         COMPUTE WS-ACCT-NEW-AH-PORT =
  6381           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6382         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6383         COMPUTE WS-ACCT-NEW-PORTION =
  6384            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6385         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6386
  6387         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6388                                   OUT-CSO-NEW-ALT-LF-PORT
  6389         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6390           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6391         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6392         COMPUTE WS-CSO-NEW-AH-PORT =
  6393           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 112
* NSRASBL.cbl
  6394         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6395         COMPUTE WS-CSO-NEW-PORTION =
  6396            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6397         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6398
  6399         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6400                                    OUT-ACCT-ALT-LF-PORT-CHG
  6401         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6402            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6403         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6404         COMPUTE WS-ACCT-AH-PORT-CHG =
  6405            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6406         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6407         COMPUTE WS-ACCT-PORTION-CHG =
  6408            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6409         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6410
  6411         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6412                                    OUT-CSO-ALT-LF-PORT-CHG
  6413         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6414            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6415         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6416         COMPUTE WS-CSO-AH-PORT-CHG =
  6417            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6418         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6419         COMPUTE WS-CSO-PORTION-CHG =
  6420            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6421         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6422
  6423     END-IF
  6424     .
  6425 0620-CONTINUE.
  6426     display ' about to bld reason codes ' en-reason-code (1)
  6427     move en-reason-code (1)     to out-rea-cd1
  6428     move en-reason-code (2)     to out-rea-cd2
  6429     move en-reason-code (3)     to out-rea-cd3
  6430     move en-reason-code (4)     to out-rea-cd4
  6431     move en-reason-code (5)     to out-rea-cd5
  6432     move en-reason-code (6)     to out-rea-cd6
  6433     move en-reason-code (7)     to out-rea-cd7
  6434     move en-reason-code (8)     to out-rea-cd8
  6435     move en-reason-code (9)     to out-rea-cd9
  6436     move en-reason-code (10)    to out-rea-cd10
  6437     move en-reason-code (11)    to out-rea-cd11
  6438     move en-reason-code (12)    to out-rea-cd12
  6439*    PERFORM 1300-DETERMINE-COMM
  6440*                                THRU 1300-EXIT
  6441     .
  6442 0620-EXIT.
  6443     EXIT.
  6444 0650-PROCESS-NO-Change.
  6445     IF EN-REC-TYPE = 'C'
  6446        GO TO 0650-PROCESS-CANCEL
  6447     END-IF
  6448     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6449        AND (OUT-NEW-ILNAME NOT = SPACES))
  6450                      AND
  6451        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 113
* NSRASBL.cbl
  6452        AND (OUT-NEW-IFNAME NOT = SPACES))
  6453                      AND
  6454        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6455        AND (OUT-NEW-IFNAME NOT = SPACES))
  6456        move 'No Change'         to out-new-Ifname
  6457        MOVE SPACES              TO OUT-NEW-IMINIT
  6458        move spaces              to out-new-Ilname
  6459     ELSE
  6460         IF OUT-NEW-ILNAME = SPACES
  6461           AND OUT-NEW-IFNAME = SPACES
  6462           AND OUT-NEW-IMINIT = SPACES
  6463           AND OUT-ORIG-ILNAME NOT = SPACES
  6464            MOVE 'None'          TO OUT-NEW-IFNAME
  6465            MOVE SPACES          TO OUT-NEW-IMINIT
  6466            MOVE SPACES          TO OUT-NEW-ILNAME
  6467         END-IF
  6468     END-IF
  6469     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6470        AND (OUT-NEW-JLNAME NOT = SPACES))
  6471                    AND
  6472        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6473        AND (OUT-NEW-JFNAME NOT = SPACES))
  6474                    AND
  6475        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6476        AND (OUT-NEW-JFNAME NOT = SPACES))
  6477        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6478        MOVE SPACES              TO OUT-NEW-JMINIT
  6479        MOVE SPACES              TO OUT-NEW-JLNAME
  6480     ELSE
  6481         IF OUT-NEW-JLNAME = SPACES
  6482           AND OUT-NEW-JFNAME = SPACES
  6483           AND OUT-NEW-JMINIT = SPACES
  6484           AND OUT-ORIG-JLNAME NOT = SPACES
  6485            MOVE 'None'          TO OUT-NEW-JFNAME
  6486            MOVE SPACES          TO OUT-NEW-JMINIT
  6487            MOVE SPACES          TO OUT-NEW-JLNAME
  6488         END-IF
  6489     END-IF
  6490     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6491        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6492        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6493     ELSE
  6494         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6495           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6496             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6497         END-IF
  6498     END-IF
  6499     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6500        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6501        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6502     ELSE
  6503         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6504           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6505             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6506         END-IF
  6507     END-IF
  6508     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6509        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 114
* NSRASBL.cbl
  6510        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6511     ELSE
  6512         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6513           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6514             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6515         END-IF
  6516     END-IF
  6517     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6518        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6519        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6520     ELSE
  6521         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6522           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6523             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6524         END-IF
  6525     END-IF
  6526
  6527     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6528                              EN-LF-ORIG-ALT-PRM-AMT
  6529     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6530                               EN-LF-NEW-ALT-PRM-AMT
  6531     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6532        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6533        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6534     ELSE
  6535         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6536           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6537            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6538         END-IF
  6539     END-IF
  6540     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6541        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6542     END-IF
  6543     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  6544        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6545        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6546     END-IF
  6547     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6548        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6549        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6550     ELSE
  6551        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6552          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6553            MOVE 'None'          TO OUT-NEW-LF-DESC
  6554        END-IF
  6555     end-if
  6556     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6557       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6558        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6559     END-IF
  6560     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6561        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6562        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6563     ELSE
  6564         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6565           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6566             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6567         END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 115
* NSRASBL.cbl
  6568     END-IF
  6569     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6570        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6571        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6572     ELSE
  6573         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6574           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6575             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6576         END-IF
  6577     END-IF
  6578     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6579        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6580        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6581     ELSE
  6582         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6583           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6584             MOVE 'None'         TO OUT-NEW-AH-DESC
  6585         END-IF
  6586     END-IF
  6587     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6588       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  6589        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6590     END-IF
  6591     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6592        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6593        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  6594        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6595     ELSE
  6596         IF (EN-JNT-ORIG-AGE NOT = ZEROS AND SPACES)
  6597           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6598             MOVE 'None'         TO OUT-NEW-JAGE-A
  6599         END-IF
  6600     END-IF
  6601     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6602        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6603        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6604     ELSE
  6605         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6606           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6607             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6608         END-IF
  6609     END-IF
  6610     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6611        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6612        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6613     ELSE
  6614         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6615           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6616             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6617         END-IF
  6618     END-IF
  6619     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  6620        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6621        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  6622                                    OUT-NEW-MAX-PMTS-A
  6623     ELSE
  6624         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6625           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 116
* NSRASBL.cbl
  6626             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  6627                                    OUT-NEW-MAX-PMTS-A
  6628         END-IF
  6629     END-IF
  6630     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  6631        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  6632     END-IF
  6633     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  6634       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  6635         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  6636     ELSE
  6637         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6638           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6639             MOVE 'None'         TO OUT-NEW-WAIT-PER
  6640         END-IF
  6641     END-IF
  6642     .
  6643 0650-PROCESS-CANCEL.
  6644     .
  6645 0650-EXIT.
  6646     EXIT.
  6647 0700-WRITE-EXTR.
  6648     display ' made it to 0700 '
  6649     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  6650     IF BL-FAIL
  6651        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  6652        GO TO 0700-EXIT
  6653     END-IF
  6654     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6655     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6656     MOVE +0                     TO NSAS-SEQ-NO
  6657     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6658     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6659     IF BL-FAIL
  6660        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  6661        GO TO 0700-EXIT
  6662     END-IF
  6663     IF W-LETTER-TO-ACCT NOT = SPACES
  6664        display ' acct ne spaces ' bl-archive-no
  6665        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  6666        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6667        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6668        MOVE +1                  TO NSAS-SEQ-NO
  6669        PERFORM 0720-WRITE-NSASEXTR
  6670                                 THRU 0720-EXIT
  6671        IF BL-FAIL
  6672           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  6673           GO TO 0700-EXIT
  6674        END-IF
  6675     END-IF
  6676     IF W-LETTER-TO-BENE NOT = SPACES
  6677        display ' bene ne spaces ' bl-archive-no
  6678        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  6679        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6680        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6681        MOVE +2                  TO NSAS-SEQ-NO
  6682        PERFORM 0720-WRITE-NSASEXTR
  6683                                 THRU 0720-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 117
* NSRASBL.cbl
  6684        IF BL-FAIL
  6685           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  6686        END-IF
  6687     END-IF
  6688     IF W-PRINT-CERTIFICATE = 'Y' AND
  6689        BL-STATE = 'VA'
  6690           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  6691           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  6692           MOVE BL-CARRIER          TO VD-CARRIER
  6693           MOVE BL-GROUP            TO VD-GROUPING
  6694           MOVE BL-STATE            TO VD-STATE
  6695           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  6696           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  6697           MOVE BL-CERT-NO          TO VD-CERT-NO
  6698           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  6699           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  6700           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  6701           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  6702           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  6703           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  6704           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  6705           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  6706           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  6707           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  6708           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  6709           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  6710           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  6711           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  6712           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  6713           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  6714           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  6715           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  6716           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  6717           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  6718           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  6719           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  6720           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  6721           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  6722           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  6723           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  6724           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  6725           MOVE 'VADS'              TO VD-LETTER-ID
  6726           MOVE OUT-PROC-ID         TO VD-PROC-ID
  6727           MOVE BL-COMP-ID          TO VD-COMP-ID
  6728           MOVE EIBTIME             TO VD-CURRENT-TIME
  6729           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  6730           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  6731           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  6732
  6733* EXEC CICS LINK
  6734*              PROGRAM    (LINK-ELVADS)
  6735*              COMMAREA   (WS-PASS-AREA)
  6736*              LENGTH     (WS-PASS-AREA-LENGTH)
  6737*          END-EXEC
  6738*    MOVE '."C                   (   #00006677' TO DFHEIV0
  6739     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6740     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6741     MOVE X'2020233030303036363737' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 118
* NSRASBL.cbl
  6742     CALL 'kxdfhei1' USING DFHEIV0,
  6743           LINK-ELVADS,
  6744           WS-PASS-AREA,
  6745           WS-PASS-AREA-LENGTH,
  6746           DFHEIV99,
  6747           DFHEIV99,
  6748           DFHEIV99,
  6749           DFHEIV99
  6750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6751     END-IF
  6752     .
  6753 0700-EXIT.
  6754     EXIT.
  6755  0710-BUILD-NSASEXTR.
  6756***  i added the extra space in front of the 1st ~
  6757***  only because there may be a letter to acct or bene
  6758     STRING
  6759         OUT-LETTER             ' ~'
  6760         OUT-PROC-ID            '~'
  6761         OUT-PROC-NAME          '~'
  6762         OUT-PROC-TITLE         '~'
  6763         OUT-CSR-NAME           '~'
  6764         OUT-CSR-TITLE          '~'
  6765         OUT-CARRIER            '~'
  6766         OUT-GROUPING           '~'
  6767         OUT-STATE              '~'
  6768         OUT-ACCOUNT            '~'
  6769         OUT-CERT-EFF-DT        '~'
  6770         OUT-CERT-NO            '~'
  6771         OUT-CERT-SFX           '~'
  6772         OUT-ILNAME             '~'
  6773         OUT-IFNAME             '~'
  6774         OUT-IFINIT             '~'
  6775         OUT-IMINIT             '~'
  6776         OUT-IAGE               '~'
  6777         OUT-ISEX               '~'
  6778         OUT-INS-ADDR1          '~'
  6779         OUT-INS-ADDR2          '~'
  6780         OUT-INS-CITY           '~'
  6781         OUT-INS-STATE          '~'
  6782         OUT-INS-ZIP            '~'
  6783         OUT-SOC-SEC-NO         '~'
  6784         OUT-MEMBER-NO          '~'
  6785         OUT-JLNAME             '~'
  6786         OUT-JFNAME             '~'
  6787         OUT-JMINIT             '~'
  6788         OUT-JAGE               '~'
  6789         OUT-ACCT-NAME          '~'
  6790         OUT-ACCT-ADDR1         '~'
  6791         OUT-ACCT-ADDR2         '~'
  6792         OUT-ACCT-CITY          '~'
  6793         OUT-ACCT-STATE         '~'
  6794         OUT-ACCT-ZIP           '~'
  6795         OUT-ACCT-PHONE         '~'
  6796         OUT-ACCT-CNTRL-NAME    '~'
  6797         OUT-ACCT-BUS-TYPE      '~'
  6798         OUT-BENE-NAME          '~'
  6799         OUT-BENE-ADDR1         '~'
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 119
* NSRASBL.cbl
  6800         OUT-BENE-ADDR2         '~'
  6801         OUT-BENE-CITY          '~'
  6802         OUT-BENE-STATE         '~'
  6803         OUT-BENE-ZIP           '~'
  6804         OUT-CARR-NAME          '~'
  6805         OUT-RESP-NO            '~'
  6806         OUT-COMP-NAME          '~'
  6807         OUT-COMP-MAIL-TO       '~'
  6808         OUT-COMP-ADDR1         '~'
  6809         OUT-COMP-ADDR2         '~'
  6810         OUT-COMP-CITY          '~'
  6811         OUT-COMP-STATE         '~'
  6812         OUT-COMP-ZIP           '~'
  6813         OUT-COMP-PHONE         '~'
  6814         OUT-COMP-FAX           '~'
  6815         OUT-COMP-STATUS        '~'
  6816         OUT-BILL-SW            '~'
  6817         OUT-RPT-CD1            '~'
  6818         OUT-RPT-CD2            '~'
  6819         OUT-ENTRY-DT           '~'
  6820         OUT-ENTRY-BATCH        '~'
  6821         OUT-ENTRY-STATUS       '~'
  6822         OUT-1ST-PMT-DT         '~'
  6823         OUT-LOAN-APR           '~'
  6824         OUT-LOAN-TERM          '~'
  6825         OUT-RATE-CLASS         '~'
  6826         OUT-EXT-DAYS           '~'
  6827         OUT-CSR-CODE           '~'
  6828         OUT-UCODE              '~'
  6829         OUT-PREM-TYPE          '~'
  6830         OUT-IND-GRP            '~'
  6831         OUT-SKIP-CD            '~'
  6832         OUT-PMT-MODE           '~'
  6833         OUT-LOAN-OFF           '~'
  6834         OUT-REIN-TABLE         '~'
  6835         OUT-SPEC-REIN          '~'
  6836         OUT-LF-BENCD           '~'
  6837         OUT-LF-TERM            '~'
  6838         OUT-LF-DEV-CD          '~'
  6839         OUT-LF-DEV-PCT         '~'
  6840         OUT-LF-BEN             '~'
  6841         OUT-LF-PRM             '~'
  6842         OUT-LF-ALT-BEN         '~'
  6843         OUT-LF-ALT-PRM         '~'
  6844         OUT-LF-NSP             '~'
  6845         OUT-LF-REM-BEN         '~'
  6846         OUT-LF-REF             '~'
  6847         OUT-LF-DTH             '~'
  6848         OUT-LF-RATE            '~'
  6849         OUT-LF-ALT-RATE        '~'
  6850         OUT-LF-EXP-DT          '~'
  6851         OUT-LF-CUR-STATUS      '~'
  6852         OUT-LF-CAN-DT          '~'
  6853         OUT-LF-CAN-EXIT-DT     '~'
  6854         OUT-LF-DTH-DT          '~'
  6855         OUT-LF-DTH-EXIT-DT     '~'
  6856         OUT-LF-EXIT-BATCH      '~'
  6857         OUT-LF-COMM-PCT        '~'
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 120
* NSRASBL.cbl
  6858         OUT-LF-DESC            '~'
  6859         OUT-LF-ABBRV           '~'
  6860         OUT-AH-BENCD           '~'
  6861         OUT-AH-TERM            '~'
  6862         OUT-CRIT-PER           '~'
  6863         OUT-AH-DEV-CD          '~'
  6864         OUT-AH-DEV-PCT         '~'
  6865         OUT-AH-BEN             '~'
  6866         OUT-AH-PRM             '~'
  6867         OUT-AH-NSP             '~'
  6868         OUT-AH-REF             '~'
  6869         OUT-AH-CLM             '~'
  6870         OUT-AH-TOT-BEN         '~'
  6871         OUT-AH-PDTHRU-DT       '~'
  6872         OUT-AH-RATE            '~'
  6873         OUT-AH-EXP-DT          '~'
  6874         OUT-AH-CUR-STATUS      '~'
  6875         OUT-AH-CAN-DT          '~'
  6876         OUT-AH-CAN-EXIT-DT     '~'
  6877         OUT-AH-EXIT-BATCH      '~'
  6878         OUT-AH-COMM-PCT        '~'
  6879         OUT-AH-DESC            '~'
  6880         OUT-RET-ELIM           '~'
  6881         OUT-BEN-DAYS           '~'
  6882         OUT-WAIT-PER           '~'
  6883         OUT-MAX-PMTS           '~'
  6884         OUT-TOT-PRM            '~'
  6885         OUT-TOT-REF            '~'
  6886         OUT-SCHED-EXP-DT       '~'
  6887         OUT-SCHED-TERM         '~'
  6888         OUT-ORIG-ILNAME        '~'
  6889         OUT-ORIG-IFNAME        '~'
  6890         OUT-ORIG-MINIT         '~'
  6891         OUT-ORIG-IAGE          '~'
  6892         OUT-ORIG-JLNAME        '~'
  6893         OUT-ORIG-JFNAME        '~'
  6894         OUT-ORIG-JMINIT        '~'
  6895         OUT-ORIG-JAGE          '~'
  6896         OUT-ORIG-LF-BENCD      '~'
  6897         OUT-ORIG-LF-TERM       '~'
  6898         OUT-ORIG-LF-BEN        '~'
  6899         OUT-ORIG-LF-PRM        '~'
  6900         OUT-LF-CALC-PRM        '~'
  6901         OUT-ORIG-LF-REF        '~'
  6902         OUT-LF-CALC-REF        '~'
  6903         OUT-ORIG-LF-ALT-BEN    '~'
  6904         OUT-ORIG-LF-ALT-PRM    '~'
  6905         OUT-ORIG-LF-EXP-DT     '~'
  6906         OUT-ORIG-LF-DESC       '~'
  6907         OUT-ORIG-AH-BENCD      '~'
  6908         OUT-ORIG-AH-TERM       '~'
  6909         OUT-ORIG-CRIT-PER      '~'
  6910         OUT-ORIG-AH-BEN        '~'
  6911         OUT-ORIG-AH-PRM        '~'
  6912         OUT-AH-CALC-PRM        '~'
  6913         OUT-ORIG-AH-REF        '~'
  6914         OUT-AH-CALC-REF        '~'
  6915         OUT-ORIG-AH-EXP-DT     '~'
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 121
* NSRASBL.cbl
  6916         OUT-ORIG-AH-DESC       '~'
  6917         OUT-ORIG-RET-ELIM      '~'
  6918         OUT-ORIG-BEN-DAYS      '~'
  6919         OUT-ORIG-WAIT-PER      '~'
  6920         OUT-ORIG-MAX-PMTS      '~'
  6921         OUT-ORIG-SCHED-EXP-DT  '~'
  6922         OUT-ORIG-SCHED-TERM    '~'
  6923         OUT-NEW-ILNAME         '~'
  6924         OUT-NEW-IFNAME         '~'
  6925         OUT-NEW-IMINIT         '~'
  6926         OUT-NEW-IAGE           '~'
  6927         OUT-NEW-JLNAME         '~'
  6928         OUT-NEW-JFNAME         '~'
  6929         OUT-NEW-JMINIT         '~'
  6930         OUT-NEW-JAGE           '~'
  6931         OUT-NEW-LF-BENCD       '~'
  6932         OUT-NEW-LF-TERM        '~'
  6933         OUT-NEW-LF-BEN         '~'
  6934         OUT-NEW-LF-PRM         '~'
  6935         OUT-NEW-LF-REF         '~'
  6936         OUT-NEW-LF-ALT-BEN     '~'
  6937         OUT-NEW-LF-ALT-PRM     '~'
  6938         OUT-NEW-LF-EXP-DT      '~'
  6939         OUT-NEW-LF-DESC        '~'
  6940         OUT-NEW-AH-BENCD       '~'
  6941         OUT-NEW-AH-TERM        '~'
  6942         OUT-NEW-CRIT-PER       '~'
  6943         OUT-NEW-AH-BEN         '~'
  6944         OUT-NEW-AH-PRM         '~'
  6945         OUT-NEW-AH-REF         '~'
  6946         OUT-NEW-AH-EXP-DT      '~'
  6947         OUT-NEW-AH-DESC        '~'
  6948         OUT-NEW-RET-ELIM       '~'
  6949         OUT-NEW-BEN-DAYS       '~'
  6950         OUT-NEW-WAIT-PER       '~'
  6951         OUT-NEW-MAX-PMTS       '~'
  6952         OUT-NEW-SCHED-EXP-DT   '~'
  6953         OUT-NEW-SCHED-TERM     '~'
  6954         OUT-TOT-PRM-CHG        '~'
  6955         OUT-TOT-REF-CHG        '~'
  6956         OUT-PAYEE              '~'
  6957         OUT-SIG-SW             '~'
  6958         OUT-BALLOON-IND        '~'
  6959         OUT-LEASE-IND          '~'
  6960         OUT-RESCIND            '~'
  6961         OUT-REA-CD1            '~'
  6962         OUT-REA-CD2            '~'
  6963         OUT-REA-CD3            '~'
  6964         OUT-REA-CD4            '~'
  6965         OUT-REA-CD5            '~'
  6966         OUT-REA-CD6            '~'
  6967         OUT-REA-CD7            '~'
  6968         OUT-REA-CD8            '~'
  6969         OUT-REA-CD9            '~'
  6970         OUT-REA-CD10           '~'
  6971         OUT-REA-CD11           '~'
  6972         OUT-REA-CD12           '~'
  6973         OUT-CYCLE-DT           '~'
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 122
* NSRASBL.cbl
  6974         OUT-ARCH-NO            '~'
  6975         OUT-FORM               '~'
  6976         OUT-ENC-LINE           '~'
  6977         OUT-ATTACH             '~'
  6978         OUT-STACK              '~'
  6979         OUT-STATE-NAME         '~'
  6980         OUT-PRINT-NOW          '~'
  6981         OUT-CHGBACK            '~'
  6982         OUT-CSO-PORTION        '~'
  6983         OUT-ACCT-PORTION       '~'
  6984         OUT-LETTER-TYPE        '~'
  6985         OUT-PRINT-CERTIFICATE  '~'
  6986         OUT-INS-BIRTHDATE      '~'
  6987         OUT-JNT-BIRTHDATE      '~'
  6988         OUT-TOT-INTEREST       '~'
  6989         OUT-ORIG-TOT-PREM      '~'
  6990         OUT-ORIG-TOT-REF       '~'
  6991         OUT-CANCEL-DT          '~'
  6992         OUT-HEALTH-APP         '~'
  6993         OUT-CERTIFICATE-ID     '~'
  6994         OUT-UNDW-ID            '~'
  6995         OUT-NEW-TOT-PREM       '~'
  6996         OUT-NEW-TOT-REF        '~'
  6997         OUT-COVERAGE-IND       '~'
  6998         OUT-ORIG-COVERAGE-IND  '~'
  6999         OUT-NEW-COVERAGE-IND   '~'
  7000         OUT-LF-CMB-PREM        '~'
  7001         OUT-ORIG-LF-CMB-PREM   '~'
  7002         OUT-NEW-LF-CMB-PREM    '~'
  7003         OUT-LF-PREM-CHG        '~'
  7004         OUT-LF-ALT-PREM-CHG    '~'
  7005         OUT-LF-CMB-PREM-CHG    '~'
  7006         OUT-AH-PREM-CHG        '~'
  7007         OUT-LF-REF-CHG         '~'
  7008         OUT-AH-REF-CHG         '~'
  7009         OUT-ACCT-LF-PORTION    '~'
  7010         OUT-ACCT-ALT-LF-PORT   '~'
  7011         OUT-ACCT-CMB-LF-PORT   '~'
  7012         OUT-ACCT-AH-PORTION    '~'
  7013         OUT-CSO-LF-PORTION     '~'
  7014         OUT-CSO-ALT-LF-PORT    '~'
  7015         OUT-CSO-CMB-LF-PORT    '~'
  7016         OUT-CSO-AH-PORTION     '~'
  7017         OUT-ACCT-ORIG-LF-PORT  '~'
  7018         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7019         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7020         OUT-ACCT-ORIG-AH-PORT  '~'
  7021         OUT-ACCT-ORIG-PORTION  '~'
  7022         OUT-CSO-ORIG-LF-PORT   '~'
  7023         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7024         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7025         OUT-CSO-ORIG-AH-PORT   '~'
  7026         OUT-CSO-ORIG-PORTION   '~'
  7027         OUT-ACCT-NEW-LF-PORT   '~'
  7028         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7029         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7030         OUT-ACCT-NEW-AH-PORT   '~'
  7031         OUT-ACCT-NEW-PORTION   '~'
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 123
* NSRASBL.cbl
  7032         OUT-CSO-NEW-LF-PORT    '~'
  7033         OUT-CSO-NEW-ALT-LF-PORT '~'
  7034         OUT-CSO-NEW-CMB-LF-PORT '~'
  7035         OUT-CSO-NEW-AH-PORT    '~'
  7036         OUT-CSO-NEW-PORTION    '~'
  7037         OUT-ACCT-LF-PORT-CHG   '~'
  7038         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7039         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7040         OUT-ACCT-AH-PORT-CHG   '~'
  7041         OUT-ACCT-PORTION-CHG   '~'
  7042         OUT-CSO-LF-PORT-CHG    '~'
  7043         OUT-CSO-ALT-LF-PORT-CHG '~'
  7044         OUT-CSO-CMB-LF-PORT-CHG '~'
  7045         OUT-CSO-AH-PORT-CHG    '~'
  7046         OUT-CSO-PORTION-CHG    '~'
  7047         OUT-ORIG-LF-CAN-DT     '~'
  7048         OUT-NEW-LF-CAN-DT      '~'
  7049         OUT-ORIG-AH-CAN-DT     '~'
  7050         OUT-NEW-AH-CAN-DT      '~'
  7051         OUT-ORIG-CAN-DT        '~'
  7052         OUT-NEW-CAN-DT         '~'
  7053         OUT-SCREEN-ID          '~'
  7054            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7055     END-STRING
  7056     .
  7057 0710-exit.
  7058     EXIT.
  7059 0720-WRITE-NSASEXTR.
  7060
  7061* EXEC CICS WRITE
  7062*       DATASET    ('NSASEXTR')
  7063*       FROM       (NSAS-EXTRACT-RECORD)
  7064*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7065*       RESP       (WS-RESPONSE)
  7066*    END-EXEC
  7067     MOVE LENGTH OF
  7068      NSAS-EXTRACT-RECORD
  7069       TO DFHEIV11
  7070     MOVE 'NSASEXTR' TO DFHEIV1
  7071*    MOVE '&$ L                  ''  N#00006991' TO DFHEIV0
  7072     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7073     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7074     MOVE X'204E233030303036393931' TO DFHEIV0(25:11)
  7075     CALL 'kxdfhei1' USING DFHEIV0,
  7076           DFHEIV1,
  7077           NSAS-EXTRACT-RECORD,
  7078           DFHEIV11,
  7079           NSAS-CONTROL-PRIMARY,
  7080           DFHEIV99,
  7081           DFHEIV99
  7082     MOVE EIBRESP  TO WS-RESPONSE
  7083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7084     IF NOT RESP-NORMAL
  7085        display ' bad write nsasextr ' ws-response
  7086        SET BL-FAIL TO TRUE
  7087     END-IF
  7088     .
  7089 0720-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 124
* NSRASBL.cbl
  7090     EXIT.
  7091 0800-init-out-data.
  7092     MOVE ZEROS                  TO OUT-IAGE
  7093                                    OUT-JAGE
  7094                                    OUT-LOAN-APR
  7095                                    OUT-LOAN-TERM
  7096                                    OUT-EXT-DAYS
  7097                                    OUT-LF-TERM
  7098                                    OUT-AH-TERM
  7099                                    OUT-LF-DEV-PCT
  7100                                    OUT-AH-DEV-PCT
  7101                                    OUT-LF-BEN
  7102                                    OUT-AH-BEN
  7103                                    OUT-CRIT-PER
  7104                                    OUT-MAX-PMTS
  7105                                    OUT-SCHED-TERM
  7106                                    OUT-ORIG-IAGE
  7107                                    OUT-ORIG-JAGE
  7108                                    OUT-NEW-IAGE
  7109                                    OUT-NEW-JAGE
  7110                                    OUT-ORIG-LF-TERM
  7111                                    OUT-ORIG-AH-TERM
  7112                                    OUT-NEW-LF-TERM
  7113                                    OUT-NEW-AH-TERM
  7114                                    OUT-ORIG-CRIT-PER
  7115                                    OUT-ORIG-MAX-PMTS
  7116                                    OUT-ORIG-SCHED-TERM
  7117                                    OUT-NEW-SCHED-TERM
  7118                                    OUT-NEW-CRIT-PER
  7119                                    OUT-NEW-MAX-PMTS
  7120                                    OUT-CSO-PORTION
  7121                                    OUT-CSO-LF-PORTION
  7122                                    OUT-CSO-ALT-LF-PORT
  7123                                    OUT-CSO-CMB-LF-PORT
  7124                                    OUT-CSO-AH-PORTION
  7125                                    OUT-ACCT-PORTION
  7126                                    OUT-ACCT-LF-PORTION
  7127                                    OUT-ACCT-ALT-LF-PORT
  7128                                    OUT-ACCT-CMB-LF-PORT
  7129                                    OUT-ACCT-AH-PORTION
  7130                                    OUT-LF-PREM-CHG
  7131                                    OUT-LF-ALT-PREM-CHG
  7132                                    OUT-LF-CMB-PREM-CHG
  7133                                    OUT-AH-PREM-CHG
  7134                                    OUT-LF-REF-CHG
  7135                                    OUT-AH-REF-CHG
  7136     .
  7137 0800-exit.
  7138     exit.
  7139 1000-BUILD-ERARCH.
  7140* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7141*    1) FROM ACCT MAINT
  7142*    2) FROM CERT UPDATE
  7143*    3) FROM COMP MAINT
  7144*    4) FROM REVIEW AND CORRECTIONS
  7145******************************************************************
  7146     MOVE 'LA'                   TO LETTER-ARCHIVE
  7147     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 125
* NSRASBL.cbl
  7148                                    LA-ARCHIVE-NO-A2
  7149                                    LA-ARCHIVE-NO-A3
  7150                                    LA-ARCHIVE-NO-A4
  7151                                    LA-ARCHIVE-NO-A5
  7152                                    LA-ARCHIVE-NO-A6
  7153     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7154                                    LA-COMPANY-CD-A2
  7155                                    LA-COMPANY-CD-A3
  7156                                    LA-COMPANY-CD-A4
  7157                                    LA-COMPANY-CD-A5
  7158                                    LA-COMPANY-CD-A6
  7159     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7160                                    LA-CARRIER-A3
  7161                                    LA-CARRIER-A4
  7162                                    LA-CARRIER-A5
  7163     MOVE BL-GROUP               TO LA-GROUPING-A2
  7164                                    LA-GROUPING-A3
  7165                                    LA-GROUPING-A4
  7166                                    LA-GROUPING-A5
  7167     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7168                                    LA-ACCOUNT-A3
  7169                                    LA-ACCOUNT-A4
  7170                                    LA-ACCOUNT-A5
  7171     MOVE BL-STATE               TO LA-STATE-A2
  7172                                    LA-STATE-A3
  7173                                    LA-STATE-A4
  7174                                    LA-STATE-A5
  7175     IF BL-DATA-SRCE = '2' OR '4'
  7176        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7177        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7178     ELSE
  7179        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7180     END-IF
  7181     IF BL-DATA-SRCE = '4'
  7182        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7183     END-IF
  7184     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7185                                    LA-LAST-UPDATED-BY
  7186     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7187                                    LA-INITIAL-PRINT-DATE
  7188                                    LA-SENT-DATE
  7189                                    LA-REPLY-DATE
  7190                                    LA-RESEND-DATE
  7191                                    LA-FOLLOW-UP-DATE
  7192     MOVE 'A'                    TO LA-STATUS
  7193     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7194     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7195     IF W-DAYS-TO-RESEND NOT NUMERIC
  7196        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7197     END-IF
  7198     IF W-DAYS-TO-RESEND > ZEROS
  7199        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7200        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7201        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7202        MOVE '6'                 TO DC-OPTION-CODE
  7203        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7204        IF NO-CONVERSION-ERROR
  7205           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 126
* NSRASBL.cbl
  7206        END-IF
  7207     END-IF
  7208     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7209        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7210        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7211        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7212        MOVE '6'                 TO DC-OPTION-CODE
  7213        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7214        IF NO-CONVERSION-ERROR
  7215           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7216        END-IF
  7217     END-IF
  7218
  7219     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7220     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7221     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7222     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7223     IF BL-ENDT-ARCH-NO > ZEROS
  7224        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7225     ELSE
  7226        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7227     END-IF
  7228     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7229                                    LA-LAST-MAINT-DATE
  7230     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7231                                    LA-NO-OF-TEXT-RECORDS
  7232     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7233
  7234* EXEC CICS WRITE
  7235*         DATASET   ('ERARCH')
  7236*         FROM      (LETTER-ARCHIVE)
  7237*         RIDFLD    (LA-CONTROL-PRIMARY)
  7238*         RESP      (WS-RESPONSE)
  7239*    END-EXEC
  7240     MOVE LENGTH OF
  7241      LETTER-ARCHIVE
  7242       TO DFHEIV11
  7243     MOVE 'ERARCH' TO DFHEIV1
  7244*    MOVE '&$ L                  ''  N#00007146' TO DFHEIV0
  7245     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7246     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7247     MOVE X'204E233030303037313436' TO DFHEIV0(25:11)
  7248     CALL 'kxdfhei1' USING DFHEIV0,
  7249           DFHEIV1,
  7250           LETTER-ARCHIVE,
  7251           DFHEIV11,
  7252           LA-CONTROL-PRIMARY,
  7253           DFHEIV99,
  7254           DFHEIV99
  7255     MOVE EIBRESP  TO WS-RESPONSE
  7256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7257     IF NOT RESP-NORMAL
  7258        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7259        la-archive-no
  7260        SET BL-FAIL TO TRUE
  7261     END-IF
  7262     .
  7263 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 127
* NSRASBL.cbl
  7264     EXIT.
  7265 1025-GET-CSR-INFO.
  7266     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7267                                    OUT-CSR-TITLE
  7268                                    OUT-PROC-TITLE
  7269                                    OUT-UNDW-ID
  7270     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7271     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7272     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7273     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7274
  7275* EXEC CICS READ
  7276*       INTO    (CONTROL-FILE)
  7277*       DATASET ('ELCNTL')
  7278*       RIDFLD  (WS-ELCNTL-KEY)
  7279*       RESP    (WS-RESPONSE)
  7280*    END-EXEC
  7281     MOVE LENGTH OF
  7282      CONTROL-FILE
  7283       TO DFHEIV11
  7284     MOVE 'ELCNTL' TO DFHEIV1
  7285*    MOVE '&"IL       E          (  N#00007169' TO DFHEIV0
  7286     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7288     MOVE X'204E233030303037313639' TO DFHEIV0(25:11)
  7289     CALL 'kxdfhei1' USING DFHEIV0,
  7290           DFHEIV1,
  7291           CONTROL-FILE,
  7292           DFHEIV11,
  7293           WS-ELCNTL-KEY,
  7294           DFHEIV99,
  7295           DFHEIV99,
  7296           DFHEIV99
  7297     MOVE EIBRESP  TO WS-RESPONSE
  7298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7299     IF RESP-NORMAL
  7300        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7301                                    OUT-PROC-NAME
  7302*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7303*                                   OUT-PROC-TITLE
  7304     END-IF
  7305     IF BL-PROC-ID NOT = PB-CSR-ID
  7306        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7307        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7308        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7309                                    OUT-PROC-TITLE
  7310        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7311
  7312* EXEC CICS READ
  7313*          INTO    (CONTROL-FILE)
  7314*          DATASET ('ELCNTL')
  7315*          RIDFLD  (WS-ELCNTL-KEY)
  7316*          RESP    (WS-RESPONSE)
  7317*       END-EXEC
  7318     MOVE LENGTH OF
  7319      CONTROL-FILE
  7320       TO DFHEIV11
  7321     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 128
* NSRASBL.cbl
  7322*    MOVE '&"IL       E          (  N#00007187' TO DFHEIV0
  7323     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7324     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7325     MOVE X'204E233030303037313837' TO DFHEIV0(25:11)
  7326     CALL 'kxdfhei1' USING DFHEIV0,
  7327           DFHEIV1,
  7328           CONTROL-FILE,
  7329           DFHEIV11,
  7330           WS-ELCNTL-KEY,
  7331           DFHEIV99,
  7332           DFHEIV99,
  7333           DFHEIV99
  7334     MOVE EIBRESP  TO WS-RESPONSE
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7336        IF RESP-NORMAL
  7337           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7338*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7339        END-IF
  7340     END-IF
  7341     .
  7342 1025-EXIT.
  7343     EXIT.
  7344 1050-GET-ERMAIL.
  7345     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7346
  7347* EXEC CICS READ
  7348*         DATASET    ('ERMAIL')
  7349*         INTO       (MAILING-DATA)
  7350*         RIDFLD     (WS-ERMAIL-KEY)
  7351*         RESP       (WS-RESPONSE)
  7352*    END-EXEC
  7353     MOVE LENGTH OF
  7354      MAILING-DATA
  7355       TO DFHEIV11
  7356     MOVE 'ERMAIL' TO DFHEIV1
  7357*    MOVE '&"IL       E          (  N#00007203' TO DFHEIV0
  7358     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7360     MOVE X'204E233030303037323033' TO DFHEIV0(25:11)
  7361     CALL 'kxdfhei1' USING DFHEIV0,
  7362           DFHEIV1,
  7363           MAILING-DATA,
  7364           DFHEIV11,
  7365           WS-ERMAIL-KEY,
  7366           DFHEIV99,
  7367           DFHEIV99,
  7368           DFHEIV99
  7369     MOVE EIBRESP  TO WS-RESPONSE
  7370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7371     IF RESP-NORMAL
  7372        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7373        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7374        MOVE MA-CITY             TO OUT-INS-CITY
  7375        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7376        MOVE MA-ZIP              TO OUT-INS-ZIP
  7377        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7378        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7379        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 129
* NSRASBL.cbl
  7380        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7381        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7382        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7383        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7384           MOVE MA-INSURED-BIRTH-DT
  7385                                 TO DC-BIN-DATE-1
  7386           MOVE ' '              TO DC-OPTION-CODE
  7387           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7388           IF NO-CONVERSION-ERROR
  7389              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7390                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7391                INTO OUT-INS-BIRTHDATE
  7392              END-STRING
  7393           END-IF
  7394        END-IF
  7395        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7396           MOVE MA-JOINT-BIRTH-DT
  7397                                 TO DC-BIN-DATE-1
  7398           MOVE ' '              TO DC-OPTION-CODE
  7399           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7400           IF NO-CONVERSION-ERROR
  7401              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7402                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7403                INTO OUT-JNT-BIRTHDATE
  7404              END-STRING
  7405           END-IF
  7406        END-IF
  7407     END-IF
  7408     .
  7409 1050-EXIT.
  7410     EXIT.
  7411 1100-GET-ELCERT.
  7412
  7413* EXEC CICS READ
  7414*         DATASET    ('ELCERT')
  7415*         INTO       (CERTIFICATE-MASTER)
  7416*         RIDFLD     (WS-ELCERT-KEY)
  7417*         RESP       (WS-RESPONSE)
  7418*    END-EXEC.
  7419     MOVE LENGTH OF
  7420      CERTIFICATE-MASTER
  7421       TO DFHEIV11
  7422     MOVE 'ELCERT' TO DFHEIV1
  7423*    MOVE '&"IL       E          (  N#00007250' TO DFHEIV0
  7424     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7426     MOVE X'204E233030303037323530' TO DFHEIV0(25:11)
  7427     CALL 'kxdfhei1' USING DFHEIV0,
  7428           DFHEIV1,
  7429           CERTIFICATE-MASTER,
  7430           DFHEIV11,
  7431           WS-ELCERT-KEY,
  7432           DFHEIV99,
  7433           DFHEIV99,
  7434           DFHEIV99
  7435     MOVE EIBRESP  TO WS-RESPONSE
  7436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7437
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 130
* NSRASBL.cbl
  7438     IF RESP-NORMAL
  7439        SET CERT-FOUND TO TRUE
  7440        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7441        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7442     END-IF
  7443     .
  7444 1100-EXIT.
  7445     EXIT.
  7446 1110-BUILD-CERT.
  7447     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7448     MOVE SPACES                 TO OUT-COVERAGE-IND
  7449     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7450     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7451     MOVE CM-CARRIER             TO OUT-CARRIER
  7452     MOVE CM-GROUPING            TO OUT-GROUPING
  7453     MOVE CM-STATE               TO OUT-STATE
  7454     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7455     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7456     MOVE ' '                    TO DC-OPTION-CODE
  7457     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7458     IF NO-CONVERSION-ERROR
  7459        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7460           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7461              INTO OUT-CERT-EFF-DT
  7462        END-STRING
  7463     END-IF
  7464     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7465     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7466                                    OUT-ORIG-ILNAME
  7467     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7468     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7469                                    OUT-ORIG-MINIT
  7470     IF (CM-SSN-STATE = CM-STATE)
  7471        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7472        MOVE SPACES              TO OUT-SOC-SEC-NO
  7473     ELSE
  7474        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7475     END-IF
  7476     IF (CM-MEMB-STATE = CM-STATE)
  7477        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7478        MOVE SPACES              TO OUT-MEMBER-NO
  7479     ELSE
  7480        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7481     END-IF
  7482     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7483                                    OUT-ORIG-IFNAME
  7484     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7485                                    OUT-ORIG-IAGE
  7486     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7487     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7488                                    OUT-ORIG-JAGE
  7489     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7490                                    OUT-ORIG-JLNAME
  7491     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7492                                    OUT-ORIG-JFNAME
  7493     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7494                                    OUT-ORIG-JMINIT
  7495     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 131
* NSRASBL.cbl
  7496                                    OUT-ORIG-LF-BENCD
  7497     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7498                                    OUT-ORIG-LF-TERM
  7499     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7500     IF CM-LF-DEV-PCT NOT NUMERIC
  7501        MOVE ZEROS               TO CM-LF-DEV-PCT
  7502     END-IF
  7503     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7504     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7505     IF NOT CERT-TRL-REC-NOT-FOUND
  7506         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7507             MOVE ZERO           TO OUT-IAGE
  7508                                    OUT-ORIG-IAGE
  7509         END-IF
  7510         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7511             MOVE ZERO           TO OUT-JAGE
  7512                                    OUT-ORIG-JAGE
  7513         END-IF
  7514     END-IF
  7515
  7516     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7517        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7518          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7519           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7520             MOVE SPACES          TO OUT-LF-BENCD
  7521                                     WS-LF-BENCD
  7522                                     OUT-LF-CAN-DT
  7523             MOVE ZEROS           TO OUT-LF-TERM
  7524                                     OUT-LF-BEN
  7525                                     OUT-LF-PRM
  7526                                     OUT-LF-ALT-BEN
  7527                                     OUT-LF-ALT-PRM
  7528                                     OUT-LF-COMM-PCT
  7529                                     OUT-LF-NSP
  7530                                     OUT-LF-REM-BEN
  7531                                     WS-WORK-LF-PREM
  7532                                     WS-WORK-ALT-LF-PREM
  7533                                     WS-WORK-CMB-LF-PREM
  7534                                     OUT-LF-REF
  7535                                     OUT-ORIG-LF-REF
  7536                                     WS-WORK-LF-REF
  7537             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7538             GO TO 1100-LF-CONT
  7539        END-IF
  7540     END-IF
  7541
  7542     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7543        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7544             MOVE SPACES          TO OUT-LF-BENCD
  7545                                     WS-LF-BENCD
  7546                                     OUT-LF-CAN-DT
  7547             MOVE ZEROS           TO OUT-LF-TERM
  7548                                     OUT-LF-BEN
  7549                                     OUT-LF-PRM
  7550                                     OUT-LF-ALT-BEN
  7551                                     OUT-LF-ALT-PRM
  7552                                     OUT-LF-COMM-PCT
  7553                                     OUT-LF-NSP
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 132
* NSRASBL.cbl
  7554                                     OUT-LF-REM-BEN
  7555                                     WS-WORK-LF-PREM
  7556                                     WS-WORK-ALT-LF-PREM
  7557                                     WS-WORK-CMB-LF-PREM
  7558                                     OUT-LF-REF
  7559                                     OUT-ORIG-LF-REF
  7560                                     WS-WORK-LF-REF
  7561             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7562             GO TO 1100-LF-CONT
  7563        END-IF
  7564     END-IF
  7565     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7566         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7567                                    OUT-ORIG-COVERAGE-IND
  7568     END-IF
  7569
  7570     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7571     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7572                                    OUT-ORIG-LF-BEN
  7573     IF CM-LF-BENEFIT-AMT = 999999999.99
  7574        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7575     END-IF
  7576     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7577                                    OUT-ORIG-LF-PRM
  7578                                    WS-WORK-LF-PREM
  7579     IF CM-LF-PREMIUM-AMT = .01
  7580         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  7581     END-IF
  7582     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7583        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7584     END-IF
  7585     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7586                                    OUT-ORIG-LF-ALT-BEN
  7587     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7588        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7589     END-IF
  7590     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7591                                    OUT-ORIG-LF-ALT-PRM
  7592                                    WS-WORK-ALT-LF-PREM
  7593     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7594                             CM-LF-ALT-PREMIUM-AMT
  7595     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7596                                 OUT-ORIG-LF-CMB-PREM
  7597                                 WS-WORK-CMB-LF-PREM
  7598     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7599        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7600     END-IF
  7601     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7602     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7603     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7604                                    OUT-ORIG-LF-REF
  7605                                    WS-WORK-LF-REF
  7606     IF CM-LF-DEATH-CLAIM-APPLIED
  7607        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7608            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  7609                                    OUT-ORIG-LF-REF
  7610                                    WS-WORK-LF-REF
  7611     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 133
* NSRASBL.cbl
  7612     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  7613     MOVE ' '                    TO DC-OPTION-CODE
  7614     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7615     IF NO-CONVERSION-ERROR
  7616        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7617           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7618              INTO OUT-LF-CAN-DT
  7619        END-STRING
  7620     END-IF
  7621
  7622     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7623         MOVE ZEROS          TO WS-WORK-LF-PREM
  7624                                WS-WORK-ALT-LF-PREM
  7625                                WS-WORK-CMB-LF-PREM
  7626     END-IF
  7627
  7628      .
  7629 1100-LF-CONT.
  7630
  7631     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  7632     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  7633        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  7634     END-IF
  7635     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  7636     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  7637        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  7638     END-IF
  7639     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  7640     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7641        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7642          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7643              MOVE SPACES              TO OUT-AH-BENCD
  7644                                          WS-AH-BENCD
  7645                                          OUT-AH-CAN-DT
  7646              MOVE ZEROS               TO OUT-AH-TERM
  7647                                          OUT-AH-BEN
  7648                                          OUT-AH-PRM
  7649                                          OUT-AH-NSP
  7650                                          OUT-AH-COMM-PCT
  7651                                          OUT-CRIT-PER
  7652                                          WS-WORK-AH-PREM
  7653                                          OUT-AH-REF
  7654                                          OUT-ORIG-AH-REF
  7655                                          WS-WORK-AH-REF
  7656              MOVE SPACES              TO OUT-MAX-PMTS-A
  7657                                          OUT-WAIT-PER
  7658                                          OUT-RET-ELIM
  7659                                          OUT-AH-DESC
  7660                                          OUT-BEN-DAYS
  7661              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7662             GO TO 1100-AH-CONT
  7663        END-IF
  7664     END-IF
  7665
  7666     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7667        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7668              MOVE SPACES              TO OUT-AH-BENCD
  7669                                          WS-AH-BENCD
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 134
* NSRASBL.cbl
  7670                                          OUT-AH-CAN-DT
  7671              MOVE ZEROS               TO OUT-AH-TERM
  7672                                          OUT-AH-BEN
  7673                                          OUT-AH-PRM
  7674                                          OUT-AH-NSP
  7675                                          OUT-AH-COMM-PCT
  7676                                          OUT-CRIT-PER
  7677                                          WS-WORK-AH-PREM
  7678                                          OUT-AH-REF
  7679                                          OUT-ORIG-AH-REF
  7680                                          WS-WORK-AH-REF
  7681              MOVE SPACES              TO OUT-MAX-PMTS-A
  7682                                          OUT-WAIT-PER
  7683                                          OUT-RET-ELIM
  7684                                          OUT-AH-DESC
  7685                                          OUT-BEN-DAYS
  7686              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7687             GO TO 1100-AH-CONT
  7688        END-IF
  7689     END-IF
  7690     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  7691     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  7692                                    OUT-ORIG-AH-BENCD
  7693     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  7694        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  7695           CM-AH-BENEFIT-AMT
  7696        IF OUT-COVERAGE-IND = 'LIFE'
  7697            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  7698                                    OUT-ORIG-COVERAGE-IND
  7699        ELSE
  7700            MOVE 'AH  '          TO OUT-COVERAGE-IND
  7701                                    OUT-ORIG-COVERAGE-IND
  7702        END-IF
  7703     ELSE
  7704        MOVE ZEROS               TO OUT-AH-TOT-BEN
  7705     END-IF
  7706     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  7707                                    OUT-ORIG-AH-TERM
  7708     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  7709                                    OUT-ORIG-CRIT-PER
  7710                                    OUT-MAX-PMTS
  7711                                    OUT-ORIG-MAX-PMTS
  7712     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  7713         MOVE SPACES             TO OUT-MAX-PMTS-A
  7714     END-IF
  7715     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  7716     IF CM-AH-DEV-PCT NOT NUMERIC
  7717        MOVE ZEROS               TO CM-AH-DEV-PCT
  7718     END-IF
  7719     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  7720     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  7721                                    OUT-ORIG-AH-BEN
  7722     IF CM-AH-BENEFIT-AMT = 999999999.99
  7723        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  7724     END-IF
  7725     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  7726                                    OUT-ORIG-AH-PRM
  7727                                    WS-WORK-AH-PREM
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 135
* NSRASBL.cbl
  7728     IF CM-AH-PREMIUM-AMT = .01
  7729         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  7730     END-IF
  7731     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  7732     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  7733                                    OUT-ORIG-AH-REF
  7734                                    WS-WORK-AH-REF
  7735     IF CM-AH-DEATH-CLAIM-APPLIED
  7736        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7737            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  7738                                    OUT-ORIG-AH-REF
  7739                                    WS-WORK-AH-REF
  7740     END-IF
  7741     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  7742     MOVE ' '                    TO DC-OPTION-CODE
  7743     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7744     IF NO-CONVERSION-ERROR
  7745        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7746           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7747              INTO OUT-AH-CAN-DT
  7748        END-STRING
  7749     END-IF
  7750
  7751     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7752         MOVE ZEROS          TO WS-WORK-AH-PREM
  7753     END-IF
  7754
  7755      .
  7756 1100-AH-CONT.
  7757
  7758     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  7759     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  7760     MOVE ' '                    TO DC-OPTION-CODE
  7761     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7762     IF NO-CONVERSION-ERROR
  7763        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7764           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7765              INTO OUT-AH-PDTHRU-DT
  7766        END-STRING
  7767     END-IF
  7768     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  7769        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  7770     END-IF
  7771     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  7772     IF CM-LOAN-APR NOT NUMERIC
  7773        MOVE ZEROS               TO CM-LOAN-APR
  7774     END-IF
  7775     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  7776     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  7777     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  7778     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  7779     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  7780     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  7781     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  7782     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  7783     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  7784     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  7785     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 136
* NSRASBL.cbl
  7786     MOVE ' '                    TO DC-OPTION-CODE
  7787     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7788     IF NO-CONVERSION-ERROR
  7789        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7790           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7791              INTO OUT-LF-EXP-DT
  7792        END-STRING
  7793     END-IF
  7794     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  7795     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7796     MOVE ' '                    TO DC-OPTION-CODE
  7797     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7798     IF NO-CONVERSION-ERROR
  7799        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7800           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7801              INTO OUT-AH-EXP-DT
  7802        END-STRING
  7803     END-IF
  7804     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  7805     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  7806     MOVE ' '                    TO DC-OPTION-CODE
  7807     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7808     IF NO-CONVERSION-ERROR
  7809        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7810           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7811              INTO OUT-1ST-PMT-DT
  7812        END-STRING
  7813     END-IF
  7814     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  7815     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  7816     MOVE ' '                    TO DC-OPTION-CODE
  7817     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7818     IF NO-CONVERSION-ERROR
  7819        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7820           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7821              INTO OUT-ENTRY-DT
  7822        END-STRING
  7823     END-IF
  7824     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7825     MOVE ' '                    TO DC-OPTION-CODE
  7826     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7827     IF NO-CONVERSION-ERROR
  7828        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7829           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7830              INTO OUT-LF-CAN-EXIT-DT
  7831        END-STRING
  7832     END-IF
  7833     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  7834     MOVE ' '                    TO DC-OPTION-CODE
  7835     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7836     IF NO-CONVERSION-ERROR
  7837        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7838           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7839              INTO OUT-LF-DTH-DT
  7840        END-STRING
  7841     END-IF
  7842     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  7843     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 137
* NSRASBL.cbl
  7844     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7845     IF NO-CONVERSION-ERROR
  7846        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7847           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7848              INTO OUT-LF-DTH-EXIT-DT
  7849        END-STRING
  7850     END-IF
  7851     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  7852     IF OUT-AH-CAN-DT NOT = SPACES
  7853        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  7854     ELSE
  7855        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  7856     END-IF
  7857     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7858     MOVE ' '                    TO DC-OPTION-CODE
  7859     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7860     IF NO-CONVERSION-ERROR
  7861        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7862           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7863              INTO OUT-AH-CAN-EXIT-DT
  7864        END-STRING
  7865     END-IF
  7866     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  7867     IF CM-ENTRY-BATCH = LOW-VALUES
  7868        MOVE SPACES              TO CM-ENTRY-BATCH
  7869     END-IF
  7870     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  7871     IF CM-LF-EXIT-BATCH = LOW-VALUES
  7872        MOVE SPACES              TO CM-LF-EXIT-BATCH
  7873     END-IF
  7874     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  7875     IF CM-AH-EXIT-BATCH = LOW-VALUES
  7876        MOVE SPACES              TO CM-AH-EXIT-BATCH
  7877     END-IF
  7878     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  7879     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  7880     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  7881     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  7882     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  7883     COMPUTE WS-WORK-PREM =
  7884        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  7885           + CM-AH-PREMIUM-AMT)
  7886     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  7887                                    OUT-ORIG-TOT-PREM
  7888     COMPUTE WS-WORK-REF =
  7889        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  7890     MOVE WS-WORK-REF            TO OUT-TOT-REF
  7891                                    OUT-ORIG-TOT-REF
  7892     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  7893        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  7894     ELSE
  7895        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  7896     END-IF
  7897     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  7898     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  7899        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  7900     ELSE
  7901        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 138
* NSRASBL.cbl
  7902     END-IF
  7903     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  7904     IF CM-NH-INT-ON-REFS NUMERIC
  7905        IF CM-NH-INT-ON-REFS NOT = ZEROS
  7906           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  7907        END-IF
  7908     END-IF
  7909
  7910     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7911        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7912            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  7913        END-IF
  7914        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7915            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  7916        END-IF
  7917     END-IF
  7918*
  7919*     IF BL-DATA-SRCE = '2'
  7920*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7921*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  7922*        END-IF
  7923*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7924*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  7925*        END-IF
  7926*     END-IF
  7927
  7928     COMPUTE WS-ACCT-LF-PORTION =
  7929        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  7930     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  7931                                OUT-ACCT-ORIG-LF-PORT
  7932     COMPUTE WS-ACCT-ALT-LF-PORTION =
  7933        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  7934     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  7935                                OUT-ACCT-ORIG-ALT-LF-PORT
  7936     COMPUTE WS-ACCT-CMB-LF-PORTION =
  7937        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  7938     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  7939                                OUT-ACCT-ORIG-CMB-LF-PORT
  7940     COMPUTE WS-ACCT-AH-PORTION =
  7941        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  7942     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  7943                                OUT-ACCT-ORIG-AH-PORT
  7944     COMPUTE WS-ACCT-PORTION =
  7945        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  7946     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  7947                                OUT-ACCT-ORIG-PORTION
  7948
  7949     COMPUTE WS-CSO-LF-PORTION =
  7950       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  7951     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  7952                               OUT-CSO-ORIG-LF-PORT
  7953     COMPUTE WS-CSO-ALT-LF-PORTION =
  7954       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  7955     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  7956                                   OUT-CSO-ORIG-ALT-LF-PORT
  7957     COMPUTE WS-CSO-CMB-LF-PORTION =
  7958       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  7959     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 139
* NSRASBL.cbl
  7960                                   OUT-CSO-ORIG-CMB-LF-PORT
  7961     COMPUTE WS-CSO-AH-PORTION =
  7962        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  7963     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  7964                               OUT-CSO-ORIG-AH-PORT
  7965     COMPUTE WS-CSO-PORTION =
  7966        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  7967     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  7968                            OUT-CSO-ORIG-PORTION
  7969     .
  7970 1110-EXIT.
  7971     EXIT.
  7972 1115-MATCH-COMPANY.
  7973     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7974     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  7975     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7976
  7977* EXEC CICS READ
  7978*       INTO    (CONTROL-FILE)
  7979*       DATASET ('ELCNTL')
  7980*       RIDFLD  (WS-ELCNTL-KEY)
  7981*       RESP    (WS-RESPONSE)
  7982*    END-EXEC
  7983     MOVE LENGTH OF
  7984      CONTROL-FILE
  7985       TO DFHEIV11
  7986     MOVE 'ELCNTL' TO DFHEIV1
  7987*    MOVE '&"IL       E          (  N#00007794' TO DFHEIV0
  7988     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7990     MOVE X'204E233030303037373934' TO DFHEIV0(25:11)
  7991     CALL 'kxdfhei1' USING DFHEIV0,
  7992           DFHEIV1,
  7993           CONTROL-FILE,
  7994           DFHEIV11,
  7995           WS-ELCNTL-KEY,
  7996           DFHEIV99,
  7997           DFHEIV99,
  7998           DFHEIV99
  7999     MOVE EIBRESP  TO WS-RESPONSE
  8000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8001     IF RESP-NORMAL
  8002        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8003     END-IF
  8004     .
  8005 1115-EXIT.
  8006     EXIT.
  8007 1120-MATCH-CARRIER.
  8008     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8009     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8010     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8011     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8012
  8013* EXEC CICS READ
  8014*       INTO    (CONTROL-FILE)
  8015*       DATASET ('ELCNTL')
  8016*       RIDFLD  (WS-ELCNTL-KEY)
  8017*       RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 140
* NSRASBL.cbl
  8018*    END-EXEC
  8019     MOVE LENGTH OF
  8020      CONTROL-FILE
  8021       TO DFHEIV11
  8022     MOVE 'ELCNTL' TO DFHEIV1
  8023*    MOVE '&"IL       E          (  N#00007811' TO DFHEIV0
  8024     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8025     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8026     MOVE X'204E233030303037383131' TO DFHEIV0(25:11)
  8027     CALL 'kxdfhei1' USING DFHEIV0,
  8028           DFHEIV1,
  8029           CONTROL-FILE,
  8030           DFHEIV11,
  8031           WS-ELCNTL-KEY,
  8032           DFHEIV99,
  8033           DFHEIV99,
  8034           DFHEIV99
  8035     MOVE EIBRESP  TO WS-RESPONSE
  8036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8037     IF RESP-NORMAL
  8038        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8039     ELSE
  8040        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8041     END-IF
  8042     .
  8043 1120-EXIT.
  8044     EXIT.
  8045 1125-MATCH-STATE.
  8046     MOVE BL-STATE               TO OUT-STATE
  8047     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8048     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8049     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8050     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8051
  8052* EXEC CICS READ
  8053*       INTO    (CONTROL-FILE)
  8054*       DATASET ('ELCNTL')
  8055*       RIDFLD  (WS-ELCNTL-KEY)
  8056*       RESP    (WS-RESPONSE)
  8057*    END-EXEC
  8058     MOVE LENGTH OF
  8059      CONTROL-FILE
  8060       TO DFHEIV11
  8061     MOVE 'ELCNTL' TO DFHEIV1
  8062*    MOVE '&"IL       E          (  N#00007831' TO DFHEIV0
  8063     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8064     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8065     MOVE X'204E233030303037383331' TO DFHEIV0(25:11)
  8066     CALL 'kxdfhei1' USING DFHEIV0,
  8067           DFHEIV1,
  8068           CONTROL-FILE,
  8069           DFHEIV11,
  8070           WS-ELCNTL-KEY,
  8071           DFHEIV99,
  8072           DFHEIV99,
  8073           DFHEIV99
  8074     MOVE EIBRESP  TO WS-RESPONSE
  8075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 141
* NSRASBL.cbl
  8076     IF RESP-NORMAL
  8077        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8078     ELSE
  8079        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8080     END-IF
  8081     .
  8082 1125-EXIT.
  8083     EXIT.
  8084 1130-MATCH-BENCDS.
  8085     MOVE SPACES                 TO WS-LF-ABBRV
  8086                                    WS-LF-DESC
  8087                                    WS-LF-EARN
  8088                                    WS-WAIT-PER
  8089                                    WS-RET-ELIM
  8090                                    WS-AH-DESC
  8091                                    WS-BEN-DAYS
  8092     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8093        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8094     END-IF
  8095     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8096        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8097     END-IF
  8098     .
  8099 1130-EXIT.
  8100     EXIT.
  8101 1140-MATCH-LFBEN.
  8102     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8103     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8104     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8105     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8106
  8107* EXEC CICS READ
  8108*       INTO    (CONTROL-FILE)
  8109*       DATASET ('ELCNTL')
  8110*       RIDFLD  (WS-ELCNTL-KEY)
  8111*       GTEQ
  8112*       RESP    (WS-RESPONSE)
  8113*    END-EXEC
  8114     MOVE LENGTH OF
  8115      CONTROL-FILE
  8116       TO DFHEIV11
  8117     MOVE 'ELCNTL' TO DFHEIV1
  8118*    MOVE '&"IL       G          (  N#00007867' TO DFHEIV0
  8119     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8121     MOVE X'204E233030303037383637' TO DFHEIV0(25:11)
  8122     CALL 'kxdfhei1' USING DFHEIV0,
  8123           DFHEIV1,
  8124           CONTROL-FILE,
  8125           DFHEIV11,
  8126           WS-ELCNTL-KEY,
  8127           DFHEIV99,
  8128           DFHEIV99,
  8129           DFHEIV99
  8130     MOVE EIBRESP  TO WS-RESPONSE
  8131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8132     IF RESP-NORMAL
  8133        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 142
* NSRASBL.cbl
  8134           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8135           OR (S1 > +8)
  8136        END-PERFORM
  8137        IF S1 < + 9
  8138           MOVE CF-BENEFIT-ALPHA (S1)
  8139                                 TO WS-LF-ABBRV
  8140           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8141           MOVE CF-CO-EARNINGS-CALC (S1)
  8142                                 TO WS-LF-EARN
  8143        ELSE
  8144           MOVE 'XX'             TO WS-LF-DESC
  8145           MOVE 'XXX'            TO WS-LF-ABBRV
  8146        END-IF
  8147     ELSE
  8148        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8149     END-IF
  8150     .
  8151 1140-EXIT.
  8152     EXIT.
  8153 1150-MATCH-AHBEN.
  8154     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8155     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8156     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8157     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8158
  8159* EXEC CICS READ
  8160*       INTO    (CONTROL-FILE)
  8161*       DATASET ('ELCNTL')
  8162*       RIDFLD  (WS-ELCNTL-KEY)
  8163*       GTEQ
  8164*       RESP    (WS-RESPONSE)
  8165*    END-EXEC
  8166     MOVE LENGTH OF
  8167      CONTROL-FILE
  8168       TO DFHEIV11
  8169     MOVE 'ELCNTL' TO DFHEIV1
  8170*    MOVE '&"IL       G          (  N#00007900' TO DFHEIV0
  8171     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8172     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8173     MOVE X'204E233030303037393030' TO DFHEIV0(25:11)
  8174     CALL 'kxdfhei1' USING DFHEIV0,
  8175           DFHEIV1,
  8176           CONTROL-FILE,
  8177           DFHEIV11,
  8178           WS-ELCNTL-KEY,
  8179           DFHEIV99,
  8180           DFHEIV99,
  8181           DFHEIV99
  8182     MOVE EIBRESP  TO WS-RESPONSE
  8183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8184     IF RESP-NORMAL
  8185        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8186           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8187           OR (S1 > +8)
  8188        END-PERFORM
  8189        IF S1 < + 9
  8190           MOVE CF-BENEFIT-ALPHA (S1)
  8191                                 TO WS-WAIT-PER
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 143
* NSRASBL.cbl
  8192           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8193                                 TO WS-RET-ELIM
  8194           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8195                                 TO WS-BEN-DAYS
  8196           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8197              IF CF-JOINT-INDICATOR (S1) = 'J'
  8198                 MOVE 'Joint Critical Period Disability'
  8199                                 TO WS-AH-DESC
  8200              ELSE
  8201                 MOVE 'Single Critical Period-Primary Only'
  8202                                 TO WS-AH-DESC
  8203              END-IF
  8204           ELSE
  8205              IF CF-JOINT-INDICATOR (S1) = 'J'
  8206                 MOVE 'Joint Disability'
  8207                                 TO WS-AH-DESC
  8208              ELSE
  8209                 MOVE 'Single Disability (Primary Only)'
  8210                                 TO WS-AH-DESC
  8211              END-IF
  8212           END-IF
  8213        ELSE
  8214           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8215        END-IF
  8216     ELSE
  8217        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8218     END-IF
  8219     .
  8220 1150-EXIT.
  8221     EXIT.
  8222
  8223 1160-READ-CERT-TRAILER.
  8224
  8225     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8226     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8227     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8228
  8229
  8230* EXEC CICS HANDLE CONDITION
  8231*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8232*    END-EXEC.
  8233*    MOVE '"$I                   ! " #00007952' TO DFHEIV0
  8234     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8236     MOVE X'2220233030303037393532' TO DFHEIV0(25:11)
  8237     CALL 'kxdfhei1' USING DFHEIV0
  8238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8239
  8240
  8241
  8242* EXEC CICS READ
  8243*        DATASET  ('ELCRTT')
  8244*        RIDFLD   (WS-ELCRTT-KEY)
  8245*        INTO     (CERTIFICATE-TRAILERS)
  8246*    END-EXEC.
  8247     MOVE LENGTH OF
  8248      CERTIFICATE-TRAILERS
  8249       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 144
* NSRASBL.cbl
  8250     MOVE 'ELCRTT' TO DFHEIV1
  8251*    MOVE '&"IL       E          (   #00007956' TO DFHEIV0
  8252     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8254     MOVE X'2020233030303037393536' TO DFHEIV0(25:11)
  8255     CALL 'kxdfhei1' USING DFHEIV0,
  8256           DFHEIV1,
  8257           CERTIFICATE-TRAILERS,
  8258           DFHEIV11,
  8259           WS-ELCRTT-KEY,
  8260           DFHEIV99,
  8261           DFHEIV99,
  8262           DFHEIV99
  8263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8264
  8265
  8266     GO TO 1160-EXIT.
  8267
  8268 1160-CERT-TRL-REC-NOTFND.
  8269     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8270
  8271 1160-EXIT.
  8272     EXIT.
  8273 1200-GET-ERACCT.
  8274     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8275     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8276                                    OUT-ACCT-ADDR1
  8277                                    OUT-ACCT-ADDR2
  8278                                    OUT-ACCT-CITY
  8279     MOVE ZEROS                  TO WS-CHGBACK
  8280
  8281* EXEC CICS STARTBR
  8282*        DATASET   ('ERACCT')
  8283*        RIDFLD    (WS-ERACCT-KEY)
  8284*        GTEQ
  8285*        RESP      (WS-RESPONSE)
  8286*    END-EXEC
  8287     MOVE 'ERACCT' TO DFHEIV1
  8288     MOVE 0
  8289       TO DFHEIV11
  8290*    MOVE '&,         G          &  N#00007976' TO DFHEIV0
  8291     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8292     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8293     MOVE X'204E233030303037393736' TO DFHEIV0(25:11)
  8294     CALL 'kxdfhei1' USING DFHEIV0,
  8295           DFHEIV1,
  8296           WS-ERACCT-KEY,
  8297           DFHEIV99,
  8298           DFHEIV11,
  8299           DFHEIV99
  8300     MOVE EIBRESP  TO WS-RESPONSE
  8301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8302     IF RESP-NORMAL
  8303
  8304* EXEC CICS READNEXT
  8305*          INTO    (ACCOUNT-MASTER)
  8306*          DATASET ('ERACCT')
  8307*          RIDFLD  (WS-ERACCT-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 145
* NSRASBL.cbl
  8308*          RESP    (WS-RESPONSE)
  8309*       END-EXEC
  8310     MOVE LENGTH OF
  8311      ACCOUNT-MASTER
  8312       TO DFHEIV12
  8313     MOVE 'ERACCT' TO DFHEIV1
  8314     MOVE 0
  8315       TO DFHEIV11
  8316*    MOVE '&.IL                  )  N#00007983' TO DFHEIV0
  8317     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8318     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8319     MOVE X'204E233030303037393833' TO DFHEIV0(25:11)
  8320     CALL 'kxdfhei1' USING DFHEIV0,
  8321           DFHEIV1,
  8322           ACCOUNT-MASTER,
  8323           DFHEIV12,
  8324           WS-ERACCT-KEY,
  8325           DFHEIV99,
  8326           DFHEIV11,
  8327           DFHEIV99,
  8328           DFHEIV99
  8329     MOVE EIBRESP  TO WS-RESPONSE
  8330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8331     END-IF
  8332     IF RESP-NORMAL
  8333        PERFORM UNTIL
  8334           NOT (RESP-NORMAL)
  8335           OR (WS-SAVE-ERACCT-KEY NOT =
  8336                        AM-CONTROL-PRIMARY (1:20))
  8337           IF BL-DATA-SRCE = '4' OR '2'
  8338              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8339                 AND >= AM-EFFECTIVE-DT)
  8340                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8341                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8342                    OR (S1 > +10)
  8343                 END-PERFORM
  8344                 IF S1 < +11
  8345                    MOVE AM-COMM-CHARGEBACK (S1)
  8346                                 TO WS-CHGBACK
  8347                 END-IF
  8348              END-IF
  8349           END-IF
  8350           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8351
  8352* EXEC CICS READNEXT
  8353*             INTO    (ACCOUNT-MASTER)
  8354*             DATASET ('ERACCT')
  8355*             RIDFLD  (WS-ERACCT-KEY)
  8356*             RESP    (WS-RESPONSE)
  8357*          END-EXEC
  8358     MOVE LENGTH OF
  8359      ACCOUNT-MASTER
  8360       TO DFHEIV12
  8361     MOVE 'ERACCT' TO DFHEIV1
  8362     MOVE 0
  8363       TO DFHEIV11
  8364*    MOVE '&.IL                  )  N#00008009' TO DFHEIV0
  8365     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 146
* NSRASBL.cbl
  8366     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8367     MOVE X'204E233030303038303039' TO DFHEIV0(25:11)
  8368     CALL 'kxdfhei1' USING DFHEIV0,
  8369           DFHEIV1,
  8370           ACCOUNT-MASTER,
  8371           DFHEIV12,
  8372           WS-ERACCT-KEY,
  8373           DFHEIV99,
  8374           DFHEIV11,
  8375           DFHEIV99,
  8376           DFHEIV99
  8377     MOVE EIBRESP  TO WS-RESPONSE
  8378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8379        END-PERFORM
  8380        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8381        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8382           SET ACCT-FOUND TO TRUE
  8383           MOVE AM-NAME          TO OUT-ACCT-NAME
  8384           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  8385           MOVE SPACES           TO OUT-ACCT-ADDR2
  8386           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8387           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8388           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8389           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8390           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8391           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8392              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8393                 INTO OUT-ACCT-ZIP (6:5)
  8394              END-STRING
  8395           END-IF
  8396           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8397           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8398           MOVE AM-STATE         TO OUT-FORM
  8399           IF AM-ACCOUNT (10:1) = 'L'
  8400              MOVE 'L'           TO OUT-FORM (3:1)
  8401                                    OUT-LEASE-IND
  8402           END-IF
  8403           MOVE AM-CONTROL-PRIMARY (1:8)
  8404                                 TO WS-ERCOMP-KEY
  8405           IF AM-REMIT-TO NOT NUMERIC
  8406              MOVE 01            TO AM-REMIT-TO
  8407           END-IF
  8408           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8409           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8410              (AM-COM-TYP (S1) = 'C' OR 'D')
  8411              OR (S1 > +10)
  8412           END-PERFORM
  8413           IF S1 < +11
  8414              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8415           END-IF
  8416           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8417           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8418        END-IF
  8419     END-IF
  8420
  8421* EXEC CICS ENDBR
  8422*        DATASET   ('ERACCT')
  8423*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 147
* NSRASBL.cbl
  8424     MOVE 'ERACCT' TO DFHEIV1
  8425     MOVE 0
  8426       TO DFHEIV11
  8427*    MOVE '&2                    $   #00008056' TO DFHEIV0
  8428     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8429     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8430     MOVE X'2020233030303038303536' TO DFHEIV0(25:11)
  8431     CALL 'kxdfhei1' USING DFHEIV0,
  8432           DFHEIV1,
  8433           DFHEIV11,
  8434           DFHEIV99
  8435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8436    .
  8437 1200-EXIT.
  8438     EXIT.
  8439 1225-GET-ERCOMP.
  8440
  8441* EXEC CICS READ
  8442*       INTO    (COMPENSATION-MASTER)
  8443*       DATASET ('ERCOMP')
  8444*       RIDFLD  (WS-ERCOMP-KEY)
  8445*       RESP    (WS-RESPONSE)
  8446*    END-EXEC
  8447     MOVE LENGTH OF
  8448      COMPENSATION-MASTER
  8449       TO DFHEIV11
  8450     MOVE 'ERCOMP' TO DFHEIV1
  8451*    MOVE '&"IL       E          (  N#00008063' TO DFHEIV0
  8452     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8454     MOVE X'204E233030303038303633' TO DFHEIV0(25:11)
  8455     CALL 'kxdfhei1' USING DFHEIV0,
  8456           DFHEIV1,
  8457           COMPENSATION-MASTER,
  8458           DFHEIV11,
  8459           WS-ERCOMP-KEY,
  8460           DFHEIV99,
  8461           DFHEIV99,
  8462           DFHEIV99
  8463     MOVE EIBRESP  TO WS-RESPONSE
  8464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8465     IF RESP-NORMAL
  8466        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8467        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8468        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8469        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8470        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8471        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8472        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8473        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8474        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8475        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8476        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8477        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8478     END-IF
  8479     .
  8480 1225-EXIT.
  8481     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 148
* NSRASBL.cbl
  8482 1250-GET-ELLETR.
  8483     display ' made it to 1250 '
  8484     move spaces                 to W-Z-CONTROL-DATA
  8485     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8486     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8487     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8488
  8489* EXEC CICS READ
  8490*         DATASET    ('ELLETR')
  8491*         INTO       (TEXT-FILES)
  8492*         RIDFLD     (WS-ELLETR-KEY)
  8493*         RESP       (WS-RESPONSE)
  8494*         GTEQ
  8495*    END-EXEC
  8496     MOVE LENGTH OF
  8497      TEXT-FILES
  8498       TO DFHEIV11
  8499     MOVE 'ELLETR' TO DFHEIV1
  8500*    MOVE '&"IL       G          (  N#00008092' TO DFHEIV0
  8501     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8503     MOVE X'204E233030303038303932' TO DFHEIV0(25:11)
  8504     CALL 'kxdfhei1' USING DFHEIV0,
  8505           DFHEIV1,
  8506           TEXT-FILES,
  8507           DFHEIV11,
  8508           WS-ELLETR-KEY,
  8509           DFHEIV99,
  8510           DFHEIV99,
  8511           DFHEIV99
  8512     MOVE EIBRESP  TO WS-RESPONSE
  8513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8514     IF RESP-NORMAL
  8515        IF (LETTER-FILE-TEXT)
  8516           AND (BL-LETTER-ID = TX-LETTER-NO)
  8517           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8518           display ' found good z record '
  8519           PERFORM 1280-PROCESS-Z-CONTROLS
  8520                                 THRU 1280-EXIT
  8521        END-IF
  8522     END-IF
  8523     .
  8524 1250-EXIT.
  8525     EXIT.
  8526 1280-PROCESS-Z-CONTROLS.
  8527     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8528*    IF W-FORM-TO-RESEND > SPACES
  8529*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8530*    ELSE
  8531*       MOVE SPACES              TO OUT-FORM
  8532*    END-IF
  8533     MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8534     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8535     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8536     .
  8537 1280-EXIT.
  8538     EXIT.
  8539 1300-DETERMINE-COMM.
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 149
* NSRASBL.cbl
  8540******************************************************************
  8541* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8542*    1) FROM ACCT MAINT
  8543*    2) FROM CERT UPDATE
  8544*    3) FROM COMP MAINT
  8545*    4) FROM REVIEW AND CORRECTIONS
  8546******************************************************************
  8547     MOVE 'Y'                    TO OUT-CHGBACK
  8548     MOVE ZEROS                  TO WS-DIFF
  8549                                    WS-CHGBK-LIFE-PCT
  8550                                    WS-CHGBK-AH-PCT
  8551     IF BL-DATA-SRCE = '4'
  8552        IF PB-CANCELLATION
  8553           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8554           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8555           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  8556           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8557           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8558              MOVE PB-C-LF-CANCEL-DT
  8559                                 TO DC-BIN-DATE-2
  8560           END-IF
  8561           MOVE '1'              TO DC-OPTION-CODE
  8562           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8563           IF NO-CONVERSION-ERROR
  8564              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8565              IF DC-ODD-DAYS-OVER > +1
  8566                 ADD +1          TO WS-DIFF
  8567              END-IF
  8568              IF (WS-CHGBACK = 99)
  8569                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8570                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8571                                WS-CHGBK-AH-PCT
  8572                   MOVE 'N'  TO OUT-CHGBACK
  8573              END-IF
  8574           END-IF
  8575        ELSE
  8576           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8577           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8578        END-IF
  8579     ELSE
  8580        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8581        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8582        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8583           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8584           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8585           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8586           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8587              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8588           END-IF
  8589           MOVE '1'              TO DC-OPTION-CODE
  8590           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8591           IF NO-CONVERSION-ERROR
  8592              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8593              IF DC-ODD-DAYS-OVER > +1
  8594                 ADD +1          TO WS-DIFF
  8595              END-IF
  8596              IF (WS-CHGBACK = 99)
  8597                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 150
* NSRASBL.cbl
  8598                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8599                                WS-CHGBK-AH-PCT
  8600                   MOVE 'N'  TO OUT-CHGBACK
  8601              END-IF
  8602           END-IF
  8603        END-IF
  8604     END-IF
  8605     .
  8606 1300-EXIT.
  8607     EXIT.
  8608 1500-GET-ARCH-NO.
  8609     DISPLAY ' MADE IT TO 1500 '
  8610     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  8611     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8612     MOVE SPACES                 TO WS-ELCNTL-GENL
  8613     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8614
  8615* EXEC CICS READ
  8616*       INTO    (CONTROL-FILE)
  8617*       DATASET ('ELCNTL')
  8618*       RIDFLD  (WS-ELCNTL-KEY)
  8619*       UPDATE
  8620*       RESP    (WS-RESPONSE)
  8621*    END-EXEC
  8622     MOVE LENGTH OF
  8623      CONTROL-FILE
  8624       TO DFHEIV11
  8625     MOVE 'ELCNTL' TO DFHEIV1
  8626*    MOVE '&"IL       EU         (  N#00008199' TO DFHEIV0
  8627     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8628     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8629     MOVE X'204E233030303038313939' TO DFHEIV0(25:11)
  8630     CALL 'kxdfhei1' USING DFHEIV0,
  8631           DFHEIV1,
  8632           CONTROL-FILE,
  8633           DFHEIV11,
  8634           WS-ELCNTL-KEY,
  8635           DFHEIV99,
  8636           DFHEIV99,
  8637           DFHEIV99
  8638     MOVE EIBRESP  TO WS-RESPONSE
  8639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8640     IF RESP-NORMAL
  8641        AND (CF-COMPANY-ID  = BL-COMP-ID)
  8642        AND (CF-RECORD-TYPE = '1')
  8643        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  8644        MOVE CF-CREDIT-LAST-ARCH-NUM
  8645                                 TO WS-ARCHIVE-NO
  8646
  8647* EXEC CICS REWRITE
  8648*          FROM    (CONTROL-FILE)
  8649*          DATASET ('ELCNTL')
  8650*       END-EXEC
  8651     MOVE LENGTH OF
  8652      CONTROL-FILE
  8653       TO DFHEIV11
  8654     MOVE 'ELCNTL' TO DFHEIV1
  8655*    MOVE '&& L                  %   #00008212' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 151
* NSRASBL.cbl
  8656     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8657     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8658     MOVE X'2020233030303038323132' TO DFHEIV0(25:11)
  8659     CALL 'kxdfhei1' USING DFHEIV0,
  8660           DFHEIV1,
  8661           CONTROL-FILE,
  8662           DFHEIV11,
  8663           DFHEIV99
  8664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8665     ELSE
  8666        MOVE +0                  TO WS-ARCHIVE-NO
  8667     END-IF
  8668    .
  8669 1500-EXIT.
  8670     EXIT.
  8671 1700-GET-ELENCC.
  8672     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  8673     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  8674     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  8675     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  8676        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  8677        OR (E1 > +5)
  8678     END-PERFORM
  8679     IF E1 < +5
  8680        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  8681     END-IF
  8682
  8683* EXEC CICS READ
  8684*        DATASET   ('ELENCC')
  8685*        INTO      (ENCLOSURE-CODES)
  8686*        RIDFLD    (WS-ELENCC-KEY)
  8687*        RESP      (WS-RESPONSE)
  8688*    END-EXEC
  8689     MOVE LENGTH OF
  8690      ENCLOSURE-CODES
  8691       TO DFHEIV11
  8692     MOVE 'ELENCC' TO DFHEIV1
  8693*    MOVE '&"IL       E          (  N#00008233' TO DFHEIV0
  8694     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8695     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8696     MOVE X'204E233030303038323333' TO DFHEIV0(25:11)
  8697     CALL 'kxdfhei1' USING DFHEIV0,
  8698           DFHEIV1,
  8699           ENCLOSURE-CODES,
  8700           DFHEIV11,
  8701           WS-ELENCC-KEY,
  8702           DFHEIV99,
  8703           DFHEIV99,
  8704           DFHEIV99
  8705     MOVE EIBRESP  TO WS-RESPONSE
  8706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8707     IF NOT RESP-NORMAL
  8708        display ' elencc resp not normal ' ws-response
  8709        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  8710
  8711* EXEC CICS READ
  8712*           DATASET   ('ELENCC')
  8713*           INTO      (ENCLOSURE-CODES)
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 152
* NSRASBL.cbl
  8714*           RIDFLD    (WS-ELENCC-KEY)
  8715*           RESP      (WS-RESPONSE)
  8716*       END-EXEC
  8717     MOVE LENGTH OF
  8718      ENCLOSURE-CODES
  8719       TO DFHEIV11
  8720     MOVE 'ELENCC' TO DFHEIV1
  8721*    MOVE '&"IL       E          (  N#00008242' TO DFHEIV0
  8722     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8723     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8724     MOVE X'204E233030303038323432' TO DFHEIV0(25:11)
  8725     CALL 'kxdfhei1' USING DFHEIV0,
  8726           DFHEIV1,
  8727           ENCLOSURE-CODES,
  8728           DFHEIV11,
  8729           WS-ELENCC-KEY,
  8730           DFHEIV99,
  8731           DFHEIV99,
  8732           DFHEIV99
  8733     MOVE EIBRESP  TO WS-RESPONSE
  8734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8735     END-IF
  8736     IF RESP-NORMAL
  8737        display ' elencc resp normal ' ws-response
  8738        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  8739        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  8740        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  8741     END-IF
  8742     .
  8743 1700-EXIT.
  8744     EXIT.
  8745 9700-DATE-LINK.
  8746
  8747* EXEC CICS LINK
  8748*        PROGRAM   ('ELDATCV')
  8749*        COMMAREA  (DATE-CONVERSION-DATA)
  8750*        LENGTH    (DC-COMM-LENGTH)
  8751*    END-EXEC.
  8752     MOVE 'ELDATCV' TO DFHEIV1
  8753*    MOVE '."C                   (   #00008259' TO DFHEIV0
  8754     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8756     MOVE X'2020233030303038323539' TO DFHEIV0(25:11)
  8757     CALL 'kxdfhei1' USING DFHEIV0,
  8758           DFHEIV1,
  8759           DATE-CONVERSION-DATA,
  8760           DC-COMM-LENGTH,
  8761           DFHEIV99,
  8762           DFHEIV99,
  8763           DFHEIV99,
  8764           DFHEIV99
  8765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8766
  8767 9700-EXIT.
  8768      EXIT.
  8769
  8770 9999-DFHBACK SECTION.
  8771     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-May-13 12:10 Page 153
* NSRASBL.cbl
  8772     MOVE 'NSRASBL' TO DFHEIV1
  8773     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8774     GOBACK.
  8775 9999-DFHEXIT.
  8776     IF DFHEIGDJ EQUAL 0001
  8777         NEXT SENTENCE
  8778     ELSE IF DFHEIGDJ EQUAL 2
  8779         GO TO 1160-CERT-TRL-REC-NOTFND
  8780         DEPENDING ON DFHEIGDI.
  8781     MOVE '9%                    "   ' TO DFHEIV0
  8782     MOVE 'NSRASBL' TO DFHEIV1
  8783     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8784     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35076     Code:       53901
