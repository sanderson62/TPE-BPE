* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    77******************************************************************
    78
    79 ENVIRONMENT DIVISION.
    80
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   4
* EL6311.cbl
    82 DATA DIVISION.
    83 WORKING-STORAGE SECTION.
    84 01  DFH-START PIC X(04).
    85 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    86 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    87 77  FILLER  PIC X(32)  VALUE '********************************'.
    88 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    89 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    90 77  A1                          PIC S999 COMP-3 VALUE +0.
    91 77  N1                          PIC S999 COMP-3 VALUE +0.
    92 77  N2                          PIC S999 COMP-3 VALUE +0.
    93 77  N3                          PIC S999 COMP-3 VALUE +0.
    94 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    95 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    96 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    97     88  REVERSAL                    VALUE 'Y'.
    98 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    99 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   100 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   101 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   102 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   103     88  ERMAIL-FOUND                 VALUE 'Y'.
   104 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   105 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   106 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   107 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   108     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   109 77  ws-stop-sw                  pic x value ' '.
   110     88  i-say-stop                 value 'Y'.
   111 77  ws-check-sw                 pic x value ' '.
   112     88  i-have-checks              value 'Y'.
   113 77  ws-proc-check-sw            pic x value ' '.
   114     88  i-have-processed-checks    value 'Y'.
   115 77  ws-chek-browse-sw           pic x value ' '.
   116 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   117 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   118 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   119 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   120 01  P pointer.
   121 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   122 01  var-ptr pointer.
   123 01  env-var-len                 pic 9(4)  binary.
   124 01  rc                          pic 9(9)  binary.
   125 01  WS-KIXSYS.
   126     05  WS-KIX-FIL1             PIC X(10).
   127     05  WS-KIX-APPS             PIC X(10).
   128     05  WS-KIX-ENV              PIC X(10).
   129     05  WS-KIX-MYENV            PIC X(10).
   130     05  WS-KIX-SYS              PIC X(10).
   131*    COPY ELCSCTM.
   132******************************************************************
   133*                                                                *
   134*                                                                *
   135*                            ELCSCTM                             *
   136*                            VMOD=2.001                          *
   137*                                                                *
   138*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   139*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   5
* EL6311.cbl
   140******************************************************************
   141 01  SECURITY-MESSAGE.
   142     12  FILLER                          PIC X(30)
   143            VALUE '** LOGIC SECURITY VIOLATION -'.
   144     12  SM-READ                         PIC X(6).
   145     12  FILLER                          PIC X(5)
   146            VALUE ' PGM='.
   147     12  SM-PGM                          PIC X(6).
   148     12  FILLER                          PIC X(5)
   149            VALUE ' OPR='.
   150     12  SM-PROCESSOR-ID                 PIC X(4).
   151     12  FILLER                          PIC X(6)
   152            VALUE ' TERM='.
   153     12  SM-TERMID                       PIC X(4).
   154     12  FILLER                          PIC XX   VALUE SPACE.
   155     12  SM-JUL-DATE                     PIC 9(5).
   156     12  FILLER                          PIC X    VALUE SPACE.
   157     12  SM-TIME                         PIC 99.99.
   158
   159
   160*    COPY ELCSCRTY.
   161******************************************************************
   162*                                                                *
   163*                                                                *
   164*                            ELCSCRTY                            *
   165*                            VMOD=2.001                          *
   166*                                                                *
   167*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   168*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   169*        SAVED IN PI-SECURITY-ADDRESS.                           *
   170*                                                                *
   171******************************************************************
   172 01  SECURITY-CONTROL.
   173     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   174     12  FILLER                       PIC XX    VALUE 'SC'.
   175     12  SC-CREDIT-CODES.
   176         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   177             20  SC-CREDIT-DISPLAY    PIC X.
   178             20  SC-CREDIT-UPDATE     PIC X.
   179     12  SC-CLAIMS-CODES.
   180         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   181             20  SC-CLAIMS-DISPLAY    PIC X.
   182             20  SC-CLAIMS-UPDATE     PIC X.
   183
   184 01  WS-VA-NO-COMM-MESS.
   185     12  FILLER                  PIC X(41) VALUE
   186        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   187 01  WS-OC-MESSAGE.
   188     12  FILLER                  PIC X(43) VALUE
   189        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   190     12  WS-OC-DIS-AMT           PIC -----9.99.
   191     12  FILLER                  PIC X(4) VALUE ' ON '.
   192     12  WS-OC-DATE              PIC X(10).
   193 01  WS-DATE-AREA.
   194     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   195     12  WS-CURRENT-DT.
   196         16  FILLER              PIC X(6)    VALUE SPACES.
   197         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   6
* EL6311.cbl
   198     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   199     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   200     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   201
   202 01  STANDARD-AREAS.
   203     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   204     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   205     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   206     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   207     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   208     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   209     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   210     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   211     12  PGM-NAME                PIC X(8).
   212     12  TIME-IN                 PIC S9(7).
   213     12  TIME-OUT-R  REDEFINES TIME-IN.
   214         16  FILLER              PIC X.
   215         16  TIME-OUT            PIC 99V99.
   216         16  FILLER              PIC XX.
   217     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   218     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   219     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   220     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   221     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   222     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   223     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   224     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   225     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   226     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   227     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   228     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   229     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   230     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   231     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   232     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   233     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   234     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   235     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   236     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   237     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   238     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   239     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   240     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   241     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   242     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   243     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   244     12  FILE-ID                 PIC X(8).
   245     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   246     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   247     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   248     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   249     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   250     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   251     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   252     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   253     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   254     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   255     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   7
* EL6311.cbl
   256     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   257     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   258     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   259     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   260
   261 01  WS-PASS-AREA.
   262     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   263     05  WS-PASS-VADS-REC    PIC X(350).
   264*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   265*                                COPY ELCZREC.
   266******************************************************************
   267*                                                                *
   268*                                                                *
   269*                            ELCZREC.                            *
   270*                                                                *
   271*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   272*                                                                *
   273******************************************************************
   274*-----------------------------------------------------------------
   275*                   C H A N G E   L O G
   276*
   277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   278*-----------------------------------------------------------------
   279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   280* EFFECTIVE    NUMBER
   281*-----------------------------------------------------------------
   282* 122011    2011022800001  AJRA  NEW FILE
   283* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   284* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   285* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   286* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   287*-----------------------------------------------------------------
   288 01  W-Z-CONTROL-DATA.
   289     05  W-NUMBER-OF-COPIES      PIC  9.
   290     05  FILLER                  PIC  X.
   291     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   292     05  FILLER                  PIC  X.
   293     05  W-DAYS-TO-RESEND        PIC  999.
   294     05  FILLER                  PIC  X.
   295     05  W-FORM-TO-RESEND        PIC  X(4).
   296     05  W-ADD-BAR-CODE          PIC  X.
   297     05  W-PROMPT-LETTER         PIC  X.
   298     05  W-HAS-RETURN-ENV        PIC  X.
   299     05  W-ENCLOSURE-CD          PIC  XXX.
   300     05  W-SIG-FLAG-DEFAULT      PIC  X.
   301     05  W-AUTO-CLOSE-IND        PIC  X.
   302     05  FILLER                  PIC  X.
   303     05  W-LETTER-TO-BENE        PIC  X.
   304     05  FILLER                  PIC  X.
   305     05  W-LETTER-TO-ACCT        PIC  X.
   306     05  FILLER                  PIC  X.
   307     05  W-LETTER-TYPE           PIC  X.
   308     05  FILLER                  PIC  X.
   309     05  W-PRINT-CERTIFICATE     PIC  X.
   310     05  FILLER                  PIC  X.
   311     05  W-REFUND-REQUIRED       PIC  X.
   312     05  FILLER                  PIC  X.
   313     05  W-ONBASE-CODE           PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   8
* EL6311.cbl
   314     05  FILLER                  PIC  X.
   315     05  W-ACCT-SUMM             PIC  X.
   316     05  FILLER                  PIC  X.
   317     05  W-CSO-SUMM              PIC  X.
   318     05  FILLER                  PIC  X.
   319     05  W-REASONS-REQUIRED      PIC  X.
   320     05  FILLER                  PIC  X(29).
   321******************************************************************
   322*                                                                *
   323*              A C C E S S   K E Y S                             *
   324*                                                                *
   325******************************************************************
   326
   327 01  ACCESS-KEYS.
   328     12  ERPYAJ-KEY.
   329         16  ERPYAJ-COMPANY-CD       PIC X.
   330         16  ERPYAJ-CARRIER          PIC X.
   331         16  ERPYAJ-GROUPING         PIC X(6).
   332         16  ERPYAJ-FIN-RESP         PIC X(10).
   333         16  ERPYAJ-ACCOUNT          PIC X(10).
   334         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   335         16  ERPYAJ-TYPE             PIC X.
   336     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   337     12  ELCERT-KEY.
   338         16  ELCERT-COMPANY-CD       PIC X.
   339         16  ELCERT-CARRIER          PIC X.
   340         16  ELCERT-GROUPING         PIC X(6).
   341         16  ELCERT-STATE            PIC XX.
   342         16  ELCERT-ACCOUNT          PIC X(10).
   343         16  ELCERT-CERT-EFF-DT      PIC XX.
   344         16  ELCERT-CERT-NO.
   345             20  ELCERT-CERT-PRIME   PIC X(10).
   346             20  ELCERT-CERT-SFX     PIC X.
   347
   348     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   349     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   350     12  ELCRTO-KEY.
   351         16  ELCRTO-COMPANY-CD       PIC X.
   352         16  ELCRTO-CARRIER          PIC X.
   353         16  ELCRTO-GROUPING         PIC X(6).
   354         16  ELCRTO-STATE            PIC XX.
   355         16  ELCRTO-ACCOUNT          PIC X(10).
   356         16  ELCRTO-CERT-EFF-DT      PIC XX.
   357         16  ELCRTO-CERT-NO.
   358             20  ELCRTO-CERT-PRIME   PIC X(10).
   359             20  ELCRTO-CERT-SFX     PIC X.
   360         16  ELCRTO-RECORD-TYPE      PIC X.
   361         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   362
   363     12  ELCRTT-KEY.
   364         16  ELCRTT-PRIMARY          PIC X(33).
   365         16  ELCRTT-REC-TYPE         PIC X(1).
   366     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   367     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   368
   369     12  ERPNDB-KEY.
   370         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   371         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   9
* EL6311.cbl
   372         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   373         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   374             ERPNDB-BATCH-SEQ-NO     PIC XX.
   375         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   376
   377     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   378     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   379     12  ERCHEK-KEY.
   380         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   381         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   382         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   383         16  CHEK-STATE              PIC XX      VALUE SPACES.
   384         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   385         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   386         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   387         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   388         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   389     12  ELLETR-KEY.
   390         16  LETR-COMPANY-CD     PIC X.
   391         16  LETR-LETTER-ID      PIC X(4).
   392         16  LETR-FILLER         PIC X(8).
   393         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   394     12  ERPNDM-KEY.
   395         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   396         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   397         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   398         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   399
   400*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   401     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   402*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   403     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   404
   405     12  ERPNDB-ALT-KEY.
   406         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   407         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   408         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   409         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   410         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   411         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   412         16  ERPNDB-CERT-NO.
   413             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   414             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   415         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   416         16  ERPNDB-RECORD-TYPE      PIC X.
   417
   418      12  ERPNDB-CSR-KEY.
   419          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   420          20  ERPNDB-CSR-ID                PIC X(4).
   421          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   422          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   423          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   424
   425     12  ERNOTE-KEY.
   426         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   427         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   428         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   429         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  10
* EL6311.cbl
   430         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   431         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   432         16  ERNOTE-CERT-NO.
   433             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   434             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   435
   436     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   437     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   438
   439     12  ERCNOT-KEY.
   440         16  ERCNOT-PART-KEY.
   441             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   442             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   443             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   444             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   445             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   446             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   447             20  ERCNOT-CERT-NO.
   448                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   449                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   450         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   451         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   452
   453     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   454     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   455
   456     12  ERMAIL-KEY.
   457         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   458         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   459         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   460         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   461         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   462         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   463         16  ERMAIL-CERT-NO.
   464             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   465             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   466
   467     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   468     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   469
   470     12  ERRQST-KEY.
   471         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   472         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   473
   474     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   475     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   476
   477     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   478
   479     12  ERLOFC-KEY.
   480         16  ERLOFC-COMPANY-CD          PIC  X.
   481         16  ERLOFC-CARRIER             PIC  X.
   482         16  ERLOFC-GROUPING            PIC  X(6).
   483         16  ERLOFC-STATE               PIC  XX.
   484         16  ERLOFC-ACCOUNT             PIC  X(10).
   485         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   486*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   487
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  11
* EL6311.cbl
   488     12  ERACCT-KEY.
   489         16  ERACCT-COMPANY-CD          PIC  X.
   490         16  ERACCT-CARRIER             PIC  X.
   491         16  ERACCT-GROUPING            PIC  X(6).
   492         16  ERACCT-STATE               PIC  XX.
   493         16  ERACCT-ACCOUNT             PIC  X(10).
   494         16  ERACCT-EXP-DT.
   495             20  ERACCT-DT              PIC  XX.
   496             20  ERACCT-FILL            PIC  X(4).
   497
   498     12  ERENDT-KEY.
   499         16  ENDT-COMPANY-CD       PIC X.
   500         16  ENDT-CARRIER          PIC X.
   501         16  ENDT-GROUPING         PIC X(6).
   502         16  ENDT-STATE            PIC XX.
   503         16  ENDT-ACCOUNT          PIC X(10).
   504         16  ENDT-CERT-EFF-DT      PIC XX.
   505         16  ENDT-CERT-PRIME       PIC X(10).
   506         16  ENDT-CERT-SFX         PIC X.
   507         16  ENDT-RECORD-TYPE      PIC X.
   508         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   509
   510 01  WS-ELMSTR-WORK.
   511     12  ELMSTR-KEY.
   512         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   513         16  MSTR-CERT-NO.
   514             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   515             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   516     12  W-CLAIM-KEY.
   517         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   518         16  W-CL-CERT-NO.
   519             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   520             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   521      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   522 01  CANCEL-GEN-PASS-AREA.
   523     05  CG-OPTION-CODE          PIC X.
   524         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   525         88  CG-FLAT-CANCEL        VALUE '1'.
   526         88  CG-CANCEL             VALUE '2'.
   527         88  CG-CANCEL-REISSUE     VALUE '3'.
   528     05  CG-ERROR-CODE           PIC 99.
   529         88  CG-SUCCESS            VALUE 00.
   530         88  CG-DATE-ERROR         VALUE 01.
   531         88  CG-CERT-NOT-FOUND     VALUE 02.
   532         88  CG-AMOUNT-ERROR       VALUE 04.
   533         88  CG-OPTION-ERROR       VALUE 05.
   534         88  CG-PREV-CAN           VALUE 06.
   535         88  CG-INVALID-DATA       VALUE 07.
   536         88  CG-NO-ACCT-MSTR       VALUE 08.
   537         88  CG-SFX-A-EXIST        VALUE 09.
   538         88  CG-MISC-ERROR         VALUE 99.
   539     05  CG-COMPANY-ID           PIC XXX.
   540     05  CG-PROC-ID              PIC XXXX.
   541     05  CG-CURRENT-DT           PIC XX.
   542     05  CG-MONTH-END-DT         PIC XX.
   543     05  CG-CERT-KEY.
   544         10  CG-CERT-COMPANY-CD  PIC X.
   545         10  CG-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  12
* EL6311.cbl
   546         10  CG-CERT-GROUP       PIC X(6).
   547         10  CG-CERT-STATE       PIC XX.
   548         10  CG-CERT-ACCOUNT     PIC X(10).
   549         10  CG-CERT-EFF-DT      PIC XX.
   550         10  CG-CERT-CERT-NO     PIC X(11).
   551     05  CG-LF-CAN-DATA.
   552         10  CG-LF-CAN-DT        PIC XX.
   553         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   554     05  CG-AH-CAN-DATA.
   555         10  CG-AH-CAN-DT        PIC XX.
   556         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   557     05  CG-CERT-PROFILE-DATA.
   558         10  CG-INS-LNAME        PIC X(15).
   559         10  CG-INS-FNAME        PIC X(10).
   560         10  CG-INS-MID-INIT     PIC X.
   561         10  CG-INS-AGE          PIC 99.
   562         10  CG-JNT-LNAME        PIC X(15).
   563         10  CG-JNT-FNAME        PIC X(10).
   564         10  CG-JNT-MID-INIT     PIC X.
   565         10  CG-JNT-AGE          PIC 99.
   566     05  CG-LF-ISS-DATA.
   567         10  CG-LF-BENCD         PIC XX.
   568         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   569         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   570     05  CG-AH-ISS-DATA.
   571         10  CG-AH-BENCD         PIC XX.
   572         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   573     05  CG-BATCH-NO             PIC X(6).
   574     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   575     05  FILLER                  PIC X(306).
   576******************************************************************
   577*                                                                *
   578*            G E N E R A L   W O R K   A R E A                   *
   579*                                                                *
   580******************************************************************
   581
   582 01  WORK-AREA.
   583     12  WS-RESPONSE             PIC S9(8)   COMP.
   584         88  RESP-NORMAL           VALUE +0.
   585         88  resp-file-notfnd      value +12.
   586         88  RESP-NOTFND           VALUE +13.
   587         88  resp-duprec           value +14.
   588         88  resp-dupkey           value +15.
   589         88  resp-invreq           value +16.
   590         88  RESP-NOTOPEN          VALUE +19.
   591         88  RESP-ENDFILE          VALUE +20.
   592         88  resp-lengtherr        value +22.
   593     12  DEEDIT-FIELD            PIC X(15).
   594     12  FILLER          REDEFINES DEEDIT-FIELD.
   595         16  FILLER              PIC X(4).
   596         16  DEEDIT-FIELD-X11    PIC X(11).
   597     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   598                                 PIC S9(15).
   599     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   600                                 PIC S9(13)V99.
   601     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   602                                 PIC S9(11)V9999.
   603     12  W-ONE                   PIC S9(4) COMP VALUE +1.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  13
* EL6311.cbl
   604     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   605     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   606         16  WS-CALC-TERM-WHOLE  PIC S999.
   607         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   608
   609     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   610     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   611         16  WS-HR-MINS          PIC 99V99.
   612         16  FILLER              PIC XX.
   613
   614     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   615     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   616
   617     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   618     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   619
   620     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   621     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   622     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   623     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   624     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   625     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   626     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   627
   628     12  QID.
   629         16  QID-TERM            PIC X(4).
   630         16  FILLER              PIC X(4)    VALUE '607B'.
   631
   632     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   633         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   634
   635     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   636         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   637
   638     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   639         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   640                                         'A'.
   641
   642     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   643
   644     12  WS-NUMERIC-SW           PIC X.
   645        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   646
   647     12  WS-EDIT-CSO-FIELD.
   648         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   649                                 PIC X.
   650
   651     12  WS-SAVE-INPUT-FIELDS.
   652         16  WS-BAGE             PIC 99       VALUE ZERO.
   653*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   654         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   655         16  FILLER REDEFINES WS-BAPR.
   656             20  WS-APR-WHOLE-NUM    PIC 99.
   657             20  WS-APR-DEC          PIC 9999.
   658         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   659         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   660
   661         16  WS-B-COVERAGE OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  14
* EL6311.cbl
   662             20  WS-TERM-IN-DAYS-SW  PIC X.
   663                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   664             20  WS-BTERM        PIC 999       COMP-3.
   665             20  WS-BALT-TERM    PIC 999       COMP-3.
   666             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   667             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   668             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   669             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   670             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   671             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   672
   673         16  WS-C-FIELDS COMP-3.
   674             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   675             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   676             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   677
   678         16  WS-D-FIELDS COMP-3.
   679             20  WS-DRISS        PIC S9(5)    VALUE +0.
   680             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   681             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   682             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   683             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   684             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   685
   686     12  WS-SAVE-BIRTH-DATE.
   687         16  FILLER              PIC X(4)   VALUE SPACES.
   688         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   689
   690     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   691     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   692     12  FILLER REDEFINES WS-WORK-BIN-RED.
   693         16  FILLER              PIC X(02).
   694         16  WS-WORK-BIN-DT      PIC X(02).
   695     12  WS-SW-1                 PIC X     VALUE SPACE.
   696     12  WS-SW-2                 PIC X     VALUE SPACE.
   697     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   698         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   699     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   700         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   701
   702     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   703     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   704     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   705     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   706     12  WS-CONVERTED-CANCEL-DATES.
   707         16  WS-CONVERTED-CANDT1                  PIC XX.
   708         16  WS-CONVERTED-CANDT2                  PIC XX.
   709
   710     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   711
   712     12  WS-REC-FOUND-SW         PIC X.
   713         88  RECORD-NOT-FOUND    VALUE 'N'.
   714
   715     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   716         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   717         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   718
   719     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  15
* EL6311.cbl
   720         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   721         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   722
   723     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   724         88  BROWSE-STARTED      VALUE 'Y'.
   725
   726     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   727         88  FIRST-TIME          VALUE 'Y'.
   728
   729     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   730         88  FIRST-ENTRY         VALUE 'Y'.
   731
   732     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   733         88  REC-BILLED          VALUE 'Y'.
   734
   735     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   736         88  NO-CURSOR-SET       VALUE +0.
   737         88  CURSOR-SET          VALUE +1.
   738
   739     12  WS-ERR-SW               PIC X.
   740         88  STD-ERRORS          VALUE 'S'.
   741         88  TRN-ERRORS          VALUE 'T'.
   742
   743     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   744         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   745
   746     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   747         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   748
   749     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   750         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   751
   752     12  WS-ERR-CODE.
   753         16  FILLER              PIC 99.
   754         16  WS-ERROR-SUB        PIC 99.
   755
   756     12  WS-DATE-WORK.
   757         16  WS-WORK-MM          PIC XX.
   758         16  WS-WORK-DD          PIC XX.
   759         16  WS-WORK-YY          PIC XX.
   760
   761     12  WS-MM-YY.
   762         16  WS-MM               PIC XX.
   763         16  FILLER              PIC X     VALUE '/'.
   764         16  WS-YY               PIC XX.
   765
   766     12  WS-CERT-EFF-DT          PIC XX.
   767
   768     12  WS-MEMBER-NO            PIC X(12).
   769     12  FILLER  REDEFINES  WS-MEMBER-NO.
   770         16  WS-MEMBER-NO-1-8    PIC 9(8).
   771         16  FILLER              PIC X(4).
   772
   773     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   774
   775     12  WS-ERPNDB-ALT-KEY.
   776         16  WS-PB-COMPANY-CD-A1         PIC X.
   777         16  WS-PB-CARRIER               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  16
* EL6311.cbl
   778         16  WS-PB-GROUPING              PIC X(6).
   779         16  WS-PB-STATE                 PIC XX.
   780         16  WS-PB-ACCOUNT               PIC X(10).
   781         16  WS-PB-CERT-EFF-DT           PIC XX.
   782         16  WS-PB-CERT-NO.
   783             20  WS-PB-CERT-PRIME        PIC X(10).
   784             20  WS-PB-CERT-SFX          PIC X.
   785         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   786         16  WS-PB-RECORD-TYPE           PIC X.
   787
   788     12  WS-SHOW-SAVE-AREAS.
   789         16  WS-NEW-CERT-NO.
   790             20  WS-NEW-PRIME    PIC X(10).
   791             20  WS-NEW-SUFFIX   PIC X.
   792         16  WS-NEW-CERT-EFF-DT  PIC XX.
   793         16  WS-NEW-RECORD-TYPE  PIC X.
   794         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   795             88   SHOW-RECORD            VALUE 'Y'.
   796
   797     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   798
   799     12  WS-BATCH-NO.
   800         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   801         16  FILLER              PIC X(5) VALUE SPACES.
   802
   803     12  WS-FIRST-NAME.
   804         16  WS-1ST-INIT         PIC X.
   805         16  FILLER              PIC X(9).
   806
   807     12  WS-INITIALS.
   808         16  WS-INITIAL-1        PIC X.
   809         16  WS-INITIAL-2        PIC X.
   810
   811     12  WS-C-HDG.
   812         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   813         16  FILLER              PIC X(4) VALUE '-REF'.
   814
   815     12  WS-D-PREM-HDG.
   816         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   817         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   818
   819     12  WS-D-REFUND-HDG.
   820         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   821         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   822
   823     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   824
   825     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   826     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   827     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   828     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   829     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   830     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   831     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   832
   833     12  WS-01-CANCEL-ERR        PIC X(25)
   834         VALUE 'CANCEL DATE ERROR'.
   835     12  WS-02-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  17
* EL6311.cbl
   836         VALUE 'CERT NOT FOUND'.
   837     12  WS-04-CANCEL-ERR        PIC X(25)
   838         VALUE 'CANCEL AMOUNT ERROR'.
   839     12  WS-05-CANCEL-ERR        PIC X(25)
   840         VALUE 'CANCEL OPTION ERROR'.
   841     12  WS-06-CANCEL-ERR        PIC X(25)
   842         VALUE 'PREVIOUSLY CANCELLED'.
   843     12  WS-07-CANCEL-ERR        PIC X(25)
   844         VALUE 'INVALID DATA'.
   845     12  WS-08-CANCEL-ERR        PIC X(25)
   846         VALUE 'NO ACCOUNT MASTER'.
   847     12  WS-09-CANCEL-ERR        PIC X(25)
   848         VALUE 'SUFFIX ALREADY EXISTS'.
   849     12  WS-99-CANCEL-ERR        PIC X(25)
   850         VALUE 'MISC CANCEL ERROR'.
   851
   852     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   853     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   854
   855     12  WS-AGE-FIELDS.
   856         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   857         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   858         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   859         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   860
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  18
* EL6311.cbl
   862
   863******************************************************************
   864*                                                                *
   865*                 B A T C H   T O T A L S                        *
   866*                                                                *
   867******************************************************************
   868
   869     12  WS-BATCH-RECORD.
   870         16  FILLER                       PIC X(10).
   871         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   872         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   873         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   874         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   875         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   876         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   877         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   878         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   879         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   880         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   881         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   882         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   883         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   884         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   885         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   886         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   887         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   888         16  WS-ACCOUNT-NAME              PIC X(30).
   889         16  FILLER                       PIC X.
   890         16  WS-REFERENCE                 PIC X(12).
   891         16  FILLER                       PIC X(197).
   892
   893     12  WS-BATCH-TOTALS.
   894         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   895         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   896         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   897         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   898         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   899         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   900         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   902         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   903         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   904         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   905         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   906         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   909         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   910         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   911         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   912         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   913
   914     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   915
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  19
* EL6311.cbl
   917
   918******************************************************************
   919*                                                                *
   920*                E R R O R   M E S S A G E S                     *
   921*                                                                *
   922******************************************************************
   923
   924 01  ERROR-MESSAGES.
   925     12  ER-0004                 PIC  9(4) VALUE 0004.
   926     12  ER-0008                 PIC  9(4) VALUE 0008.
   927     12  ER-0023                 PIC  9(4) VALUE 0023.
   928     12  ER-0029                 PIC  9(4) VALUE 0029.
   929     12  ER-0033                 PIC  9(4) VALUE 0033.
   930     12  ER-0070                 PIC  9(4) VALUE 0070.
   931     12  ER-0220                 PIC  9(4) VALUE 0220.
   932     12  ER-0248                 PIC  9(4) VALUE 0248.
   933     12  ER-0280                 PIC  9(4) VALUE 0280.
   934     12  ER-0348                 PIC  9(4) VALUE 0348.
   935     12  ER-0582                 PIC  9(4) VALUE 0582.
   936     12  ER-0877                 PIC  9(4) VALUE 0877.
   937     12  ER-1236                 PIC  9(4) VALUE 1236.
   938     12  ER-1570                 PIC  9(4) VALUE 1570.
   939     12  ER-1575                 PIC  9(4) VALUE 1575.
   940     12  ER-1609                 PIC  9(4) VALUE 1609.
   941     12  ER-1819                 PIC  9(4) VALUE 1819.
   942     12  ER-2077                 PIC  9(4) VALUE 2077.
   943     12  ER-2129                 PIC  9(4) VALUE 2129.
   944     12  ER-2188                 PIC  9(4) VALUE 2188.
   945     12  ER-2192                 PIC  9(4) VALUE 2192.
   946     12  ER-2196                 PIC  9(4) VALUE 2196.
   947     12  ER-2197                 PIC  9(4) VALUE 2197.
   948     12  ER-2198                 PIC  9(4) VALUE 2198.
   949     12  ER-2200                 PIC  9(4) VALUE 2200.
   950     12  ER-2212                 PIC  9(4) VALUE 2212.
   951     12  ER-2218                 PIC  9(4) VALUE 2218.
   952     12  ER-2220                 PIC  9(4) VALUE 2220.
   953     12  ER-2222                 PIC  9(4) VALUE 2222.
   954     12  ER-2223                 PIC  9(4) VALUE 2223.
   955     12  ER-2224                 PIC  9(4) VALUE 2224.
   956     12  ER-2225                 PIC  9(4) VALUE 2225.
   957     12  ER-2226                 PIC  9(4) VALUE 2226.
   958     12  ER-2227                 PIC  9(4) VALUE 2227.
   959     12  ER-2228                 PIC  9(4) VALUE 2228.
   960     12  ER-2240                 PIC  9(4) VALUE 2240.
   961     12  ER-2241                 PIC  9(4) VALUE 2241.
   962     12  ER-2242                 PIC  9(4) VALUE 2242.
   963     12  ER-2243                 PIC  9(4) VALUE 2243.
   964     12  ER-2244                 PIC  9(4) VALUE 2244.
   965     12  ER-2245                 PIC  9(4) VALUE 2245.
   966     12  ER-2246                 PIC  9(4) VALUE 2246.
   967     12  ER-2247                 PIC  9(4) VALUE 2247.
   968     12  ER-2251                 PIC  9(4) VALUE 2251.
   969     12  ER-2252                 PIC  9(4) VALUE 2252.
   970     12  ER-2253                 PIC  9(4) VALUE 2253.
   971     12  ER-2254                 PIC  9(4) VALUE 2254.
   972     12  ER-2255                 PIC  9(4) VALUE 2255.
   973     12  ER-2256                 PIC  9(4) VALUE 2256.
   974     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  20
* EL6311.cbl
   975     12  ER-2258                 PIC  9(4) VALUE 2258.
   976     12  ER-2259                 PIC  9(4) VALUE 2259.
   977     12  ER-2260                 PIC  9(4) VALUE 2260.
   978     12  ER-2261                 PIC  9(4) VALUE 2261.
   979     12  ER-2287                 PIC  9(4) VALUE 2287.
   980     12  ER-2336                 PIC  9(4) VALUE 2336.
   981     12  ER-2337                 PIC  9(4) VALUE 2337.
   982     12  ER-2437                 PIC  9(4) VALUE 2437.
   983     12  ER-2471                 PIC  9(4) VALUE 2471.
   984     12  ER-2530                 PIC  9(4) VALUE 2530.
   985     12  ER-2531                 PIC  9(4) VALUE 2531.
   986     12  ER-2532                 PIC  9(4) VALUE 2532.
   987     12  ER-2533                 PIC  9(4) VALUE 2533.
   988     12  ER-2547                 PIC  9(4) VALUE 2547.
   989     12  ER-2591                 PIC  9(4) VALUE 2591.
   990     12  ER-2592                 PIC  9(4) VALUE 2592.
   991     12  ER-2593                 PIC  9(4) VALUE 2593.
   992     12  ER-2600                 PIC  9(4) VALUE 2600.
   993     12  ER-2601                 PIC  9(4) VALUE 2601.
   994     12  ER-2604                 PIC  9(4) VALUE 2604.
   995     12  ER-2605                 PIC  9(4) VALUE 2605.
   996     12  ER-2606                 PIC  9(4) VALUE 2606.
   997     12  ER-2607                 PIC  9(4) VALUE 2607.
   998     12  ER-2622                 PIC  9(4) VALUE 2622.
   999     12  ER-2625                 PIC  9(4) VALUE 2625.
  1000     12  ER-2626                 PIC  9(4) VALUE 2626.
  1001     12  ER-2627                 PIC  9(4) VALUE 2627.
  1002     12  ER-2628                 PIC  9(4) VALUE 2628.
  1003     12  ER-2629                 PIC  9(4) VALUE 2629.
  1004     12  ER-2630                 PIC  9(4) VALUE 2630.
  1005     12  ER-2631                 PIC  9(4) VALUE 2631.
  1006     12  ER-2632                 PIC  9(4) VALUE 2632.
  1007     12  ER-2633                 PIC  9(4) VALUE 2633.
  1008     12  ER-2634                 PIC  9(4) VALUE 2634.
  1009     12  ER-2635                 PIC  9(4) VALUE 2635.
  1010     12  ER-2636                 PIC  9(4) VALUE 2636.
  1011     12  ER-2639                 PIC  9(4) VALUE 2639.
  1012     12  ER-2640                 PIC  9(4) VALUE 2640.
  1013     12  ER-2647                 PIC  9(4) VALUE 2647.
  1014     12  ER-2648                 PIC  9(4) VALUE 2648.
  1015     12  ER-2649                 PIC  9(4) VALUE 2649.
  1016     12  ER-2650                 PIC  9(4) VALUE 2650.
  1017     12  ER-2653                 PIC  9(4) VALUE 2653.
  1018     12  ER-2654                 PIC  9(4) VALUE 2654.
  1019     12  ER-2655                 PIC  9(4) VALUE 2655.
  1020     12  ER-2656                 PIC  9(4) VALUE 2656.
  1021     12  ER-2657                 PIC  9(4) VALUE 2657.
  1022     12  ER-2660                 PIC  9(4) VALUE 2660.
  1023     12  ER-2661                 PIC  9(4) VALUE 2661.
  1024     12  ER-2662                 PIC  9(4) VALUE 2662.
  1025     12  ER-2663                 PIC  9(4) VALUE 2663.
  1026     12  ER-2664                 PIC  9(4) VALUE 2664.
  1027     12  ER-2667                 PIC  9(4) VALUE 2667.
  1028     12  ER-2668                 PIC  9(4) VALUE 2668.
  1029     12  ER-2669                 PIC  9(4) VALUE 2669.
  1030     12  ER-2670                 PIC  9(4) VALUE 2670.
  1031     12  ER-2671                 PIC  9(4) VALUE 2671.
  1032     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  21
* EL6311.cbl
  1033     12  ER-2673                 PIC  9(4) VALUE 2673.
  1034     12  ER-2677                 PIC  9(4) VALUE 2677.
  1035     12  ER-2678                 PIC  9(4) VALUE 2678.
  1036     12  ER-2679                 PIC  9(4) VALUE 2679.
  1037     12  ER-2680                 PIC  9(4) VALUE 2680.
  1038     12  ER-2681                 PIC  9(4) VALUE 2681.
  1039     12  ER-2682                 PIC  9(4) VALUE 2682.
  1040     12  ER-2683                 PIC  9(4) VALUE 2683.
  1041     12  ER-2684                 PIC  9(4) VALUE 2684.
  1042     12  ER-2686                 PIC  9(4) VALUE 2686.
  1043     12  ER-2689                 PIC  9(4) VALUE 2689.
  1044     12  ER-2690                 PIC  9(4) VALUE 2690.
  1045     12  ER-2693                 PIC  9(4) VALUE 2693.
  1046     12  ER-2695                 PIC  9(4) VALUE 2695.
  1047     12  ER-2701                 PIC  9(4) VALUE 2701.
  1048     12  ER-2720                 PIC  9(4) VALUE 2720.
  1049     12  ER-2709                 PIC  9(4) VALUE 2709.
  1050     12  ER-2704                 PIC  9(4) VALUE 2704.
  1051     12  ER-2725                 PIC  9(4) VALUE 2725.
  1052     12  ER-2726                 PIC  9(4) VALUE 2726.
  1053     12  ER-2728                 PIC  9(4) VALUE 2728.
  1054     12  ER-2729                 PIC  9(4) VALUE 2729.
  1055     12  ER-2731                 PIC  9(4) VALUE 2731.
  1056     12  ER-2732                 PIC  9(4) VALUE 2732.
  1057     12  ER-2733                 PIC  9(4) VALUE 2733.
  1058     12  ER-2735                 PIC  9(4) VALUE 2735.
  1059     12  ER-2738                 PIC  9(4) VALUE 2738.
  1060     12  ER-2742                 PIC  9(4) VALUE 2742.
  1061     12  ER-2743                 PIC  9(4) VALUE 2743.
  1062     12  ER-2744                 PIC  9(4) VALUE 2744.
  1063     12  ER-2747                 PIC  9(4) VALUE 2747.
  1064     12  ER-2749                 PIC  9(4) VALUE 2749.
  1065     12  ER-2753                 PIC  9(4) VALUE 2753.
  1066     12  ER-2755                 PIC  9(4) VALUE 2755.
  1067     12  ER-2757                 PIC  9(4) VALUE 2757.
  1068     12  ER-2771                 PIC  9(4) VALUE 2771.
  1069     12  ER-2774                 PIC  9(4) VALUE 2774.
  1070     12  ER-2775                 PIC  9(4) VALUE 2775.
  1071     12  ER-2776                 PIC  9(4) VALUE 2776.
  1072     12  ER-2777                 PIC  9(4) VALUE 2777.
  1073     12  ER-2794                 PIC  9(4) VALUE 2794.
  1074     12  ER-2799                 PIC  9(4) VALUE 2799.
  1075     12  ER-2900                 PIC  9(4) VALUE 2900.
  1076     12  ER-2902                 PIC  9(4) VALUE 2902.
  1077     12  ER-2945                 PIC  9(4) VALUE 2945.
  1078     12  ER-3000                 PIC  9(4) VALUE 3000.
  1079     12  ER-3006                 PIC  9(4) VALUE 3006.
  1080     12  ER-3054                 PIC  9(4) VALUE 3054.
  1081     12  ER-3224                 PIC  9(4) VALUE 3224.
  1082     12  ER-3269                 PIC  9(4) VALUE 3269.
  1083     12  er-3444                 pic  9(4) value 3444.
  1084     12  er-3446                 pic  9(4) value 3446.
  1085     12  er-3447                 pic  9(4) value 3447.
  1086     12  er-3448                 pic  9(4) value 3448.
  1087     12  er-3449                 pic  9(4) value 3449.
  1088     12  ER-3504                 PIC  9(4) VALUE 3504.
  1089     12  ER-3513                 PIC  9(4) VALUE 3513.
  1090     12  ER-3831                 PIC  9(4) VALUE 3831.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  22
* EL6311.cbl
  1091     12  ER-3834                 PIC  9(4) VALUE 3834.
  1092     12  ER-3835                 PIC  9(4) VALUE 3835.
  1093     12  ER-4005                 PIC  9(4) VALUE 4005.
  1094     12  ER-7144                 PIC  9(4) VALUE 7144.
  1095     12  ER-7401                 PIC  9(4) VALUE 7401.
  1096     12  ER-7402                 PIC  9(4) VALUE 7402.
  1097     12  ER-7403                 PIC  9(4) VALUE 7403.
  1098     12  ER-7404                 PIC  9(4) VALUE 7404.
  1099     12  ER-7423                 PIC  9(4) VALUE 7423.
  1100     12  ER-7424                 PIC  9(4) VALUE 7424.
  1101     12  ER-7433                 PIC  9(4) VALUE 7433.
  1102     12  ER-7450                 PIC  9(4) VALUE 7450.
  1103     12  ER-7451                 PIC  9(4) VALUE 7451.
  1104     12  ER-7530                 PIC  9(4) VALUE 7530.
  1105     12  ER-7573                 PIC  9(4) VALUE 7573.
  1106     12  ER-7631                 PIC  9(4) VALUE 7631.
  1107     12  ER-7632                 PIC  9(4) VALUE 7632.
  1108     12  ER-7633                 PIC  9(4) VALUE 7633.
  1109     12  ER-7537                 PIC  9(4) VALUE 7537.
  1110     12  ER-7538                 PIC  9(4) VALUE 7538.
  1111     12  ER-7574                 PIC  9(4) VALUE 7574.
  1112     12  ER-7997                 PIC  9(4) VALUE 7997.
  1113     12  ER-7998                 PIC  9(4) VALUE 7998.
  1114     12  ER-8148                 PIC  9(4) VALUE 8148.
  1115     12  ER-9063                 PIC  9(4) VALUE 9063.
  1116     12  ER-9076                 PIC  9(4) VALUE 9076.
  1117     12  ER-9618                 PIC  9(4) VALUE 9618.
  1118     12  ER-9841                 PIC  9(4) VALUE 9841.
  1119
  1120*                                COPY ELCTEXT.
  1121******************************************************************
  1122*                                                                *
  1123*                                                                *
  1124*                            ELCTEXT.                            *
  1125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1126*                            VMOD=2.008                          *
  1127*                                                                *
  1128*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1129*                                     FORM LETTERS,              *
  1130*                                     CERT FORM DISPLAY.
  1131*                                                                *
  1132*   FILE TYPE = VSAM,KSDS                                        *
  1133*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1134*                                                                *
  1135*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1136*       ALTERNATE INDEX = NONE                                   *
  1137*                                                                *
  1138*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1139*       ALTERNATE INDEX = NONE                                   *
  1140*                                                                *
  1141*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1142*       ALTERNATE INDEX = NONE                                   *
  1143*                                                                *
  1144*   LOG = NO                                                     *
  1145*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1146******************************************************************
  1147 01  TEXT-FILES.
  1148     12  TEXT-FILE-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  23
* EL6311.cbl
  1149         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1150         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1151         88  HELP-FILE-TEXT             VALUE 'TH'.
  1152
  1153     12  TX-CONTROL-PRIMARY.
  1154         16  TX-COMPANY-CD           PIC X.
  1155             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1156         16  TX-ACCESS-CD-GENL       PIC X(12).
  1157
  1158         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1159             20  TX-LETTER-NO        PIC X(4).
  1160             20  FILLER              PIC X(8).
  1161
  1162         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1163             20  TX-FORM-NO          PIC X(12).
  1164
  1165         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1166             20  TX-HELP-TYPE        PIC X.
  1167                 88  HELP-FOR-GENERAL   VALUE ' '.
  1168                 88  HELP-BY-SCREEN     VALUE 'S'.
  1169                 88  HELP-BY-ERROR      VALUE 'E'.
  1170             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1171                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1172             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1173                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1174             20  FILLER              PIC X(4).
  1175
  1176         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1177
  1178     12  TX-PROCESS-CONTROL          PIC XX.
  1179         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1180
  1181     12  TX-TEXT-LINE                PIC X(70).
  1182
  1183     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1184         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1185         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1186         88  TX-VALID-FORM-SQUEEZE-VALUE
  1187                                        VALUE 'Y' ' '.
  1188
  1189     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1190         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1191         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1192         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1193         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1194         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1195         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1196         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1197                                              'K' 'N' ' '
  1198                                              'Z'.
  1199
  1200     12  TX-ARCHIVE-SW               PIC X.
  1201         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1202         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1203         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1204
  1205     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1206     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  24
* EL6311.cbl
  1207
  1208     12  TX-BSR-CODE                 PIC X.
  1209         88  TX-BSR-LETTER              VALUE 'B'.
  1210         88  TX-NON-BSR-LETTER          VALUE ' '.
  1211
  1212     12  FILLER                      PIC X.
  1213*****************************************************************
  1214*                                COPY ELCCRTO.
  1215******************************************************************
  1216*                                                                *
  1217*                            ELCCRTO.                            *
  1218*                                                                *
  1219*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1220*                                                                *
  1221*   FILE TYPE = VSAM,KSDS                                        *
  1222*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1223*                                                                *
  1224*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1225*                                                                *
  1226*   LOG = YES                                                    *
  1227*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1228******************************************************************
  1229*                   C H A N G E   L O G
  1230*
  1231* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1232*-----------------------------------------------------------------
  1233*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1234* EFFECTIVE    NUMBER
  1235*-----------------------------------------------------------------
  1236* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1237* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1238* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1239* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1240* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1241******************************************************************
  1242 01  ORIGINAL-CERTIFICATE.
  1243     12  OC-RECORD-ID                      PIC XX.
  1244         88  VALID-OC-ID                      VALUE 'OC'.
  1245     12  OC-CONTROL-PRIMARY.
  1246         16  OC-COMPANY-CD                 PIC X.
  1247         16  OC-CARRIER                    PIC X.
  1248         16  OC-GROUPING                   PIC X(6).
  1249         16  OC-STATE                      PIC XX.
  1250         16  OC-ACCOUNT                    PIC X(10).
  1251         16  OC-CERT-EFF-DT                PIC XX.
  1252         16  OC-CERT-NO.
  1253             20  OC-CERT-PRIME             PIC X(10).
  1254             20  OC-CERT-SFX               PIC X.
  1255         16  OC-RECORD-TYPE                PIC X.
  1256         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1257     12  OC-LAST-MAINT-DT                  PIC XX.
  1258     12  OC-LAST-MAINT-BY                  PIC X(4).
  1259     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1260     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1261     12  FILLER                            PIC X(49).
  1262     12  OC-ORIG-REC.
  1263         16  OC-INS-LAST-NAME              PIC X(15).
  1264         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  25
* EL6311.cbl
  1265         16  OC-INS-MIDDLE-INIT            PIC X.
  1266         16  OC-INS-AGE                    PIC S999     COMP-3.
  1267         16  OC-JNT-LAST-NAME              PIC X(15).
  1268         16  OC-JNT-FIRST-NAME             PIC X(10).
  1269         16  OC-JNT-MIDDLE-INIT            PIC X.
  1270         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1271         16  OC-LF-BENCD                   PIC XX.
  1272         16  OC-LF-TERM                    PIC S999      COMP-3.
  1273         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1274         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1275         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1276         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1277         16  OC-LF-EXP-DT                  PIC XX.
  1278         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1279         16  OC-LF-CANCEL-DT               PIC XX.
  1280         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1281         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1282         16  OC-AH-BENCD                   PIC XX.
  1283         16  OC-AH-TERM                    PIC S999      COMP-3.
  1284         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1285         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1286         16  OC-AH-EXP-DT                  PIC XX.
  1287         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1288         16  OC-AH-CP                      PIC 99.
  1289         16  OC-AH-CANCEL-DT               PIC XX.
  1290         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1291         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1292         16  OC-CRED-BENE-NAME             PIC X(25).
  1293         16  OC-1ST-PMT-DT                 PIC XX.
  1294         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1295         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1296         16  OC-ISSUE-TRAN-IND             PIC X.
  1297         16  OC-CANCEL-TRAN-IND            PIC X.
  1298         16  FILLER                        PIC X(211).
  1299
  1300     12  FILLER                            PIC X(50).
  1301******************************************************************
  1302*                                COPY ERCACCT.
  1303******************************************************************
  1304*                                                                *
  1305*                                                                *
  1306*                            ERCACCT                             *
  1307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1308*                            VMOD=2.031                          *
  1309*                                                                *
  1310*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1311*                                                                *
  1312*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1313*   VSAM ACCOUNT MASTER FILES.                                   *
  1314*                                                                *
  1315*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1316*                                                                *
  1317*   FILE TYPE = VSAM,KSDS                                        *
  1318*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1319*                                                                *
  1320*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1321*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1322*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  26
* EL6311.cbl
  1323*   LOG = NO                                                     *
  1324*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1325*                                                                *
  1326*                                                                *
  1327******************************************************************
  1328*                   C H A N G E   L O G
  1329*
  1330* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1331*-----------------------------------------------------------------
  1332*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1333* EFFECTIVE    NUMBER
  1334*-----------------------------------------------------------------
  1335* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1336* 092705    2005050300006  PEMA  ADD SPP LEASES
  1337* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1338* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1339* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1340* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1341* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1342******************************************************************
  1343
  1344 01  ACCOUNT-MASTER.
  1345     12  AM-RECORD-ID                      PIC XX.
  1346         88  VALID-AM-ID                      VALUE 'AM'.
  1347
  1348     12  AM-CONTROL-PRIMARY.
  1349         16  AM-COMPANY-CD                 PIC X.
  1350         16  AM-MSTR-CNTRL.
  1351             20  AM-CONTROL-A.
  1352                 24  AM-CARRIER            PIC X.
  1353                 24  AM-GROUPING.
  1354                     28 AM-GROUPING-PREFIX PIC XXX.
  1355                     28 AM-GROUPING-PRIME  PIC XXX.
  1356                 24  AM-STATE              PIC XX.
  1357                 24  AM-ACCOUNT.
  1358                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1359                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1360             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1361                                           PIC X(19).
  1362             20  AM-CNTRL-B.
  1363                 24  AM-EXPIRATION-DT      PIC XX.
  1364                 24  FILLER                PIC X(4).
  1365             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1366                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1367
  1368     12  AM-CONTROL-BY-VAR-GRP.
  1369         16  AM-COMPANY-CD-A1              PIC X.
  1370         16  AM-VG-CARRIER                 PIC X.
  1371         16  AM-VG-GROUPING                PIC X(6).
  1372         16  AM-VG-STATE                   PIC XX.
  1373         16  AM-VG-ACCOUNT                 PIC X(10).
  1374         16  AM-VG-DATE.
  1375             20  AM-VG-EXPIRATION-DT       PIC XX.
  1376             20  FILLER                    PIC X(4).
  1377         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1378                                           PIC 9(11)      COMP-3.
  1379     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1380         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  27
* EL6311.cbl
  1381         16  AM-VG-KEY3.
  1382             20  AM-VG3-ACCOUNT            PIC X(10).
  1383             20  AM-VG3-EXP-DT             PIC XX.
  1384         16  FILLER                        PIC X(4).
  1385     12  AM-MAINT-INFORMATION.
  1386         16  AM-LAST-MAINT-DT              PIC XX.
  1387         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1388         16  AM-LAST-MAINT-USER            PIC X(4).
  1389         16  FILLER                        PIC XX.
  1390
  1391     12  AM-EFFECTIVE-DT                   PIC XX.
  1392     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1393
  1394     12  AM-PREV-DATES  COMP-3.
  1395         16  AM-PREV-EXP-DT                PIC 9(11).
  1396         16  AM-PREV-EFF-DT                PIC 9(11).
  1397
  1398     12  AM-REPORT-CODE-1                  PIC X(10).
  1399     12  AM-REPORT-CODE-2                  PIC X(10).
  1400
  1401     12  AM-CITY-CODE                      PIC X(4).
  1402     12  AM-COUNTY-PARISH                  PIC X(6).
  1403
  1404     12  AM-NAME                           PIC X(30).
  1405     12  AM-PERSON                         PIC X(30).
  1406     12  AM-ADDRS                          PIC X(30).
  1407     12  AM-CITY.
  1408         16  AM-ADDR-CITY                  PIC X(28).
  1409         16  AM-ADDR-STATE                 PIC XX.
  1410     12  AM-ZIP.
  1411         16  AM-ZIP-PRIME.
  1412             20  AM-ZIP-PRI-1ST            PIC X.
  1413                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1414             20  FILLER                    PIC X(4).
  1415         16  AM-ZIP-PLUS4                  PIC X(4).
  1416     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1417         16  AM-CAN-POSTAL-1               PIC XXX.
  1418         16  AM-CAN-POSTAL-2               PIC XXX.
  1419         16  FILLER                        PIC XXX.
  1420     12  AM-TEL-NO.
  1421         16  AM-AREA-CODE                  PIC 999.
  1422         16  AM-TEL-PRE                    PIC 999.
  1423         16  AM-TEL-NBR                    PIC 9(4).
  1424     12  AM-TEL-LOC                        PIC X.
  1425         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1426         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1427
  1428     12  AM-COMM-STRUCTURE.
  1429         16  AM-DEFN-1.
  1430             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1431                 24  AM-AGT.
  1432                     28  AM-AGT-PREFIX     PIC X(4).
  1433                     28  AM-AGT-PRIME      PIC X(6).
  1434                 24  AM-COM-TYP            PIC X.
  1435                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1436                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1437                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1438                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  28
* EL6311.cbl
  1439                 24  AM-RETRO-LV-INDIC     PIC X.
  1440                 24  AM-GL-CODES           PIC X.
  1441                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1442                 24  FILLER                PIC X(01).
  1443         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1444             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1445                 24  FILLER                PIC X(11).
  1446                 24  AM-L-COMA             PIC XXX.
  1447                 24  AM-J-COMA             PIC XXX.
  1448                 24  AM-A-COMA             PIC XXX.
  1449                 24  FILLER                PIC X(6).
  1450
  1451     12  AM-COMM-CHANGE-STATUS             PIC X.
  1452         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1453
  1454     12  AM-CSR-CODE                       PIC X(4).
  1455
  1456     12  AM-BILLING-STATUS                 PIC X.
  1457         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1458         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1459     12  AM-AUTO-REFUND-SW                 PIC X.
  1460         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1461         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1462     12  AM-GPCD                           PIC 99.
  1463     12  AM-IG                             PIC X.
  1464         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1465         88  AM-HAS-GROUP                     VALUE '2'.
  1466     12  AM-STATUS                         PIC X.
  1467         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1468         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1469         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1470         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1471         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1472         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1473     12  AM-REMIT-TO                       PIC 99.
  1474     12  AM-ID-NO                          PIC X(11).
  1475
  1476     12  AM-CAL-TABLE                      PIC XX.
  1477     12  AM-LF-DEVIATION                   PIC XXX.
  1478     12  AM-AH-DEVIATION                   PIC XXX.
  1479     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1480     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1481     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1482     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1483     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1484     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1485
  1486     12  AM-USER-FIELDS.
  1487         16  AM-FLD-1                      PIC XX.
  1488         16  AM-FLD-2                      PIC XX.
  1489         16  AM-FLD-3                      PIC XX.
  1490         16  AM-FLD-4                      PIC XX.
  1491         16  AM-FLD-5                      PIC XX.
  1492
  1493     12  AM-1ST-PROD-DATE.
  1494         16  AM-1ST-PROD-YR                PIC XX.
  1495         16  AM-1ST-PROD-MO                PIC XX.
  1496         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  29
* EL6311.cbl
  1497     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1498     12  AM-CERTS-PURGED-DATE.
  1499         16  AM-PUR-YR                     PIC XX.
  1500         16  AM-PUR-MO                     PIC XX.
  1501         16  AM-PUR-DA                     PIC XX.
  1502     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1503     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1504     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1505     12  AM-INACTIVE-DATE.
  1506         16  AM-INA-MO                     PIC 99.
  1507         16  AM-INA-DA                     PIC 99.
  1508         16  AM-INA-YR                     PIC 99.
  1509     12  AM-AR-HI-CERT-DATE                PIC XX.
  1510
  1511     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1512     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1513
  1514     12  AM-OB-PAYMENT-MODE                PIC X.
  1515         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1516         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1517         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1518         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1519
  1520     12  AM-AH-ONLY-INDICATOR              PIC X.
  1521         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1522         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1523
  1524     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1525
  1526     12  AM-OVER-SHORT.
  1527         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1528         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1529
  1530     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1531     12  AM-DCC-CLP-STATE                  PIC XX.
  1532
  1533     12  AM-RECALC-COMM                    PIC X.
  1534     12  AM-RECALC-REIN                    PIC X.
  1535
  1536     12  AM-REI-TABLE                      PIC XXX.
  1537     12  AM-REI-ET-LF                      PIC X.
  1538     12  AM-REI-ET-AH                      PIC X.
  1539     12  AM-REI-PE-LF                      PIC X.
  1540     12  AM-REI-PE-AH                      PIC X.
  1541     12  AM-REI-PRT-ST                     PIC X.
  1542     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1543     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1544     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1545     12  AM-REI-GROUP-A                    PIC X(6).
  1546     12  AM-REI-MORT                       PIC X(4).
  1547     12  AM-REI-PRT-OW                     PIC X.
  1548     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1549     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1550     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1551     12  AM-REI-GROUP-B                    PIC X(6).
  1552
  1553     12  AM-TRUST-TYPE                     PIC X(2).
  1554
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  30
* EL6311.cbl
  1555     12  AM-EMPLOYER-STMT-USED             PIC X.
  1556     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1557
  1558     12  AM-STD-AH-TYPE                    PIC XX.
  1559     12  AM-EARN-METHODS.
  1560         16  AM-EARN-METHOD-R              PIC X.
  1561             88 AM-REF-RL-R78                 VALUE 'R'.
  1562             88 AM-REF-RL-PR                  VALUE 'P'.
  1563             88 AM-REF-RL-MEAN                VALUE 'M'.
  1564             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1565         16  AM-EARN-METHOD-L              PIC X.
  1566             88 AM-REF-LL-R78                 VALUE 'R'.
  1567             88 AM-REF-LL-PR                  VALUE 'P'.
  1568             88 AM-REF-LL-MEAN                VALUE 'M'.
  1569             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1570         16  AM-EARN-METHOD-A              PIC X.
  1571             88 AM-REF-AH-R78                 VALUE 'R'.
  1572             88 AM-REF-AH-PR                  VALUE 'P'.
  1573             88 AM-REF-AH-MEAN                VALUE 'M'.
  1574             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1575             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1576             88 AM-REF-AH-NET                 VALUE 'N'.
  1577
  1578     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1579     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1580     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1581
  1582     12  AM-RET-Y-N                        PIC X.
  1583     12  AM-RET-P-E                        PIC X.
  1584     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1585     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1586     12  AM-RET-GRP                        PIC X(6).
  1587     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1588         16  AM-POOL-PRIME                 PIC XXX.
  1589         16  AM-POOL-SUB                   PIC XXX.
  1590     12  AM-RETRO-EARNINGS.
  1591         16  AM-RET-EARN-R                 PIC X.
  1592         16  AM-RET-EARN-L                 PIC X.
  1593         16  AM-RET-EARN-A                 PIC X.
  1594     12  AM-RET-ST-TAX-USE                 PIC X.
  1595         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1596         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1597     12  AM-RETRO-BEG-EARNINGS.
  1598         16  AM-RET-BEG-EARN-R             PIC X.
  1599         16  AM-RET-BEG-EARN-L             PIC X.
  1600         16  AM-RET-BEG-EARN-A             PIC X.
  1601     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1602     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1603
  1604     12  AM-USER-SELECT-OPTIONS.
  1605         16  AM-USER-SELECT-1              PIC X(10).
  1606         16  AM-USER-SELECT-2              PIC X(10).
  1607         16  AM-USER-SELECT-3              PIC X(10).
  1608         16  AM-USER-SELECT-4              PIC X(10).
  1609         16  AM-USER-SELECT-5              PIC X(10).
  1610
  1611     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1612
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  31
* EL6311.cbl
  1613     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1614
  1615     12  AM-RPT045A-SWITCH                 PIC X.
  1616         88  RPT045A-OFF                   VALUE 'N'.
  1617
  1618     12  AM-INSURANCE-LIMITS.
  1619         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1620         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1621
  1622     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1623         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1624
  1625     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1626         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1627         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1628
  1629     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1630
  1631     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1632     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1633     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1634     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1635     12  AM-DCC-UEF-STATE                  PIC XX.
  1636     12  FILLER                            PIC XXX.
  1637     12  AM-REPORT-CODE-3                  PIC X(10).
  1638*    12  FILLER                            PIC X(22).
  1639
  1640     12  AM-RESERVE-DATE.
  1641         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1642         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1643         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1644
  1645     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1646     12  AM-NOTIFICATION-TYPES.
  1647         16  AM-NOTIF-OF-LETTERS           PIC X.
  1648         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1649         16  AM-NOTIF-OF-REPORTS           PIC X.
  1650         16  AM-NOTIF-OF-STATUS            PIC X.
  1651
  1652     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1653         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1654         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1655         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1656         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1657
  1658     12  AM-BENEFIT-CONTROLS.
  1659         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1660             20  AM-BENEFIT-CODE           PIC XX.
  1661             20  AM-BENEFIT-TYPE           PIC X.
  1662             20  AM-BENEFIT-REVISION       PIC XXX.
  1663             20  AM-BENEFIT-REM-TERM       PIC X.
  1664             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1665             20  FILLER                    PIC XX.
  1666         16  FILLER                        PIC X(80).
  1667
  1668     12  AM-TRANSFER-DATA.
  1669         16  AM-TRANSFERRED-FROM.
  1670             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  32
* EL6311.cbl
  1671             20  AM-TRNFROM-GROUPING.
  1672                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1673                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1674             20  AM-TRNFROM-STATE          PIC XX.
  1675             20  AM-TRNFROM-ACCOUNT.
  1676                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1677                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1678             20  AM-TRNFROM-DTE            PIC XX.
  1679         16  AM-TRANSFERRED-TO.
  1680             20  AM-TRNTO-CARRIER          PIC X.
  1681             20  AM-TRNTO-GROUPING.
  1682                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1683                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1684             20  AM-TRNTO-STATE            PIC XX.
  1685             20  AM-TRNTO-ACCOUNT.
  1686                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1687                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1688             20  AM-TRNTO-DTE              PIC XX.
  1689         16  FILLER                        PIC X(10).
  1690
  1691     12  AM-SAVED-REMIT-TO                 PIC 99.
  1692
  1693     12  AM-COMM-STRUCTURE-SAVED.
  1694         16  AM-DEFN-1-SAVED.
  1695             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1696                 24  AM-AGT-SV             PIC X(10).
  1697                 24  AM-COM-TYP-SV         PIC X.
  1698                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1699                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1700                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1701                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1702                 24  FILLER                PIC X.
  1703                 24  AM-GL-CODES-SV        PIC X.
  1704                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1705                 24  FILLER                PIC X.
  1706         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1707             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1708                 24  FILLER                PIC X(11).
  1709                 24  AM-L-COMA-SV          PIC XXX.
  1710                 24  AM-J-COMA-SV          PIC XXX.
  1711                 24  AM-A-COMA-SV          PIC XXX.
  1712                 24  FILLER                PIC X(6).
  1713
  1714     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1715         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1716            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1717            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1718            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1719
  1720     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1721     12  FILLER                            PIC X(120).
  1722
  1723     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1724         16  AM-CONTROL-NAME               PIC X(30).
  1725         16  AM-EXECUTIVE-ONE.
  1726             20  AM-EXEC1-NAME             PIC X(15).
  1727             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1728                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  33
* EL6311.cbl
  1729             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1730                                                          COMP-3.
  1731         16  AM-EXECUTIVE-TWO.
  1732             20  AM-EXEC2-NAME             PIC X(15).
  1733             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1734                                                          COMP-3.
  1735             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1736                                                          COMP-3.
  1737
  1738     12  AM-RETRO-ADDITIONAL-DATA.
  1739         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1740         16  AM-RETRO-PREM-P-E             PIC X.
  1741         16  AM-RETRO-CLMS-P-I             PIC X.
  1742         16  AM-RETRO-RET-BRACKET-LF.
  1743             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1744                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1745                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1746             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1747                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1748                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1749             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1750                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1751                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1752         16  AM-RETRO-RET-BRACKET-AH.
  1753             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1754                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1755                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1756                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1757             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1758                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1759                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1760             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1761                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1762                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1763
  1764     12  AM-COMMENTS.
  1765         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1766
  1767     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1768         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1769         16  AM-FLI-BILLING-CODE           PIC X.
  1770         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1771         16  AM-FLI-UNITED-IDENT           PIC X.
  1772         16  AM-FLI-INTEREST-LOST-DATA.
  1773             20  AM-FLI-BANK-NO            PIC X(5).
  1774             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1775             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1776             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1777         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1778             20  AM-FLI-AGT                PIC X(9).
  1779             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1780             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1781         16  FILLER                        PIC X(102).
  1782
  1783     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1784         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1785             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1786             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  34
* EL6311.cbl
  1787             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1788             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1789             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1790         16  FILLER                          PIC X(10).
  1791******************************************************************
  1792*                                COPY ELCVADS.
  1793******************************************************************
  1794*                                                                *
  1795*                                                                *
  1796*                            ELCVADS.                            *
  1797*                                                                *
  1798*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1799*   ELVADS                  LENGTH = 350                         *
  1800******************************************************************
  1801******************************************************************
  1802*                   C H A N G E   L O G
  1803*
  1804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1805*-----------------------------------------------------------------
  1806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1807* EFFECTIVE    NUMBER
  1808*-----------------------------------------------------------------
  1809* 100111    2011022800001  AJRA  NAPERSOFT
  1810******************************************************************
  1811
  1812 01  VIRGINIA-DISCLOSURE.
  1813     12  VD-COMPANY-CD              PIC X.
  1814     12  VD-CARRIER                 PIC X.
  1815     12  VD-GROUPING.
  1816         20  VD-GROUPING-PREFIX     PIC XXX.
  1817         20  VD-GROUPING-PRIME      PIC XXX.
  1818     12  VD-STATE                   PIC XX.
  1819     12  VD-ACCOUNT.
  1820         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1821         20  VD-ACCOUNT-PRIME       PIC X(6).
  1822     12  VD-CERT-EFF-DT             PIC XX.
  1823     12  VD-CERT-NO.
  1824         20  VD-CERT-PRIME          PIC X(10).
  1825         20  VD-CERT-SFX            PIC X.
  1826     12  VD-ENTRY-BATCH             PIC X(6).
  1827     12  VD-CSR-ID                  PIC X(4).
  1828     12  VD-NAME.
  1829         20  VD-INSURED-LAST-NAME   PIC X(15).
  1830         20  VD-INSURED-FIRST-NAME.
  1831             24  VD-INSURED-1ST-INIT PIC X.
  1832             24  FILLER             PIC X(9).
  1833         20  VD-INSURED-MIDDLE-INIT PIC X.
  1834     12  VD-JOINT-INSURED.
  1835         20 VD-JOINT-LAST-NAME      PIC X(15).
  1836         20 VD-JOINT-FIRST-NAME.
  1837            24  VD-JOINT-FIRST-INIT PIC X.
  1838            24  FILLER              PIC X(9).
  1839         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1840     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1841     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1842     12  VD-INSURED-CITY-STATE.
  1843         20  VD-INSURED-CITY        PIC X(28).
  1844         20  VD-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  35
* EL6311.cbl
  1845     12  VD-INSURED-ZIP-CODE.
  1846         20  VD-INSURED-ZIP-PRIME.
  1847             24  VD-INSURED-ZIP-1   PIC X.
  1848                 88  VD-CANADIAN-POST-CODE
  1849                                       VALUE 'A' THRU 'Z'.
  1850             24  FILLER             PIC X(4).
  1851         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1852     12  VD-BENEFICIARY-NAME        PIC X(30).
  1853     12  VD-ACCOUNT-NAME            PIC X(30).
  1854     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1855     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1856     12  VD-1ST-PMT-DT              PIC XX.
  1857     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1858         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1859         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1860                                             '90' THRU '99'.
  1861     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1862                                    PIC XX.
  1863     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1864     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1865     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1866     12  VD-LF-TERM                 PIC S999   COMP-3.
  1867     12  VD-AH-BENEFIT-CD           PIC XX.
  1868         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1869         88  VD-INVALID-AH             VALUE '  ' '00'
  1870                                             '90' THRU '99'.
  1871     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1872     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1873     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1874     12  VD-AH-TERM                 PIC S999   COMP-3.
  1875     12  VD-LETTER-ID               PIC X(4).
  1876     12  VD-PROC-ID                 PIC X(4).
  1877     12  VD-COMP-ID                 PIC X(3).
  1878     12  VD-CURRENT-DATE            PIC XX.
  1879     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1880     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1881     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  36
* EL6311.cbl
  1883*    COPY ELCDATE.
  1884******************************************************************
  1885*                                                                *
  1886*                                                                *
  1887*                            ELCDATE.                            *
  1888*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1889*                            VMOD=2.003
  1890*                                                                *
  1891*                                                                *
  1892*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1893*                 LENGTH = 200                                   *
  1894******************************************************************
  1895
  1896 01  DATE-CONVERSION-DATA.
  1897     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1898     12  DC-OPTION-CODE                PIC X.
  1899         88  BIN-TO-GREG                VALUE ' '.
  1900         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1901         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1902         88  YMD-GREG-TO-BIN            VALUE '3'.
  1903         88  MDY-GREG-TO-BIN            VALUE '4'.
  1904         88  JULIAN-TO-BIN              VALUE '5'.
  1905         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1906         88  FIND-CENTURY               VALUE '7'.
  1907         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1908         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1909         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1910         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1911         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1912         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1913         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1914         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1915         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1916         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1917         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1918         88  BIN-3-TO-GREG              VALUE 'I'.
  1919         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1920         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1921         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1922         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1923         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1924         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1925         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1926         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1927         88  THREE-CHARACTER-BIN
  1928                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1929         88  GREGORIAN-TO-BIN
  1930                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1931         88  BIN-TO-GREGORIAN
  1932                  VALUES ' ' '1' 'I' '8' 'G'.
  1933         88  JULIAN-TO-BINARY
  1934                  VALUES '5' 'C' 'E' 'F'.
  1935     12  DC-ERROR-CODE                 PIC X.
  1936         88  NO-CONVERSION-ERROR        VALUE ' '.
  1937         88  DATE-CONVERSION-ERROR
  1938                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1939         88  DATE-IS-ZERO               VALUE '1'.
  1940         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  37
* EL6311.cbl
  1941         88  DATE-IS-INVALID            VALUE '3'.
  1942         88  DATE1-GREATER-DATE2        VALUE '4'.
  1943         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1944         88  DATE-INVALID-OPTION        VALUE '9'.
  1945         88  INVALID-CENTURY            VALUE 'A'.
  1946         88  ONLY-CENTURY               VALUE 'B'.
  1947         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1948         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1949     12  DC-END-OF-MONTH               PIC X.
  1950         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1951     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1952         88  USE-NORMAL-PROCESS         VALUE ' '.
  1953         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1954         88  ADJUST-UP-100-YRS          VALUE '2'.
  1955     12  FILLER                        PIC X.
  1956     12  DC-CONVERSION-DATES.
  1957         16  DC-BIN-DATE-1             PIC XX.
  1958         16  DC-BIN-DATE-2             PIC XX.
  1959         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1960         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1961                       DC-GREG-DATE-1-EDIT.
  1962             20  DC-EDIT1-MONTH        PIC 99.
  1963             20  SLASH1-1              PIC X.
  1964             20  DC-EDIT1-DAY          PIC 99.
  1965             20  SLASH1-2              PIC X.
  1966             20  DC-EDIT1-YEAR         PIC 99.
  1967         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1968         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1969                     DC-GREG-DATE-2-EDIT.
  1970             20  DC-EDIT2-MONTH        PIC 99.
  1971             20  SLASH2-1              PIC X.
  1972             20  DC-EDIT2-DAY          PIC 99.
  1973             20  SLASH2-2              PIC X.
  1974             20  DC-EDIT2-YEAR         PIC 99.
  1975         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1976         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1977                     DC-GREG-DATE-1-YMD.
  1978             20  DC-YMD-YEAR           PIC 99.
  1979             20  DC-YMD-MONTH          PIC 99.
  1980             20  DC-YMD-DAY            PIC 99.
  1981         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1982         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1983                      DC-GREG-DATE-1-MDY.
  1984             20  DC-MDY-MONTH          PIC 99.
  1985             20  DC-MDY-DAY            PIC 99.
  1986             20  DC-MDY-YEAR           PIC 99.
  1987         16  DC-GREG-DATE-1-ALPHA.
  1988             20  DC-ALPHA-MONTH        PIC X(10).
  1989             20  DC-ALPHA-DAY          PIC 99.
  1990             20  FILLER                PIC XX.
  1991             20  DC-ALPHA-CENTURY.
  1992                 24 DC-ALPHA-CEN-N     PIC 99.
  1993             20  DC-ALPHA-YEAR         PIC 99.
  1994         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1995         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1996         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1997         16  DC-JULIAN-DATE            PIC 9(05).
  1998         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  38
* EL6311.cbl
  1999                                       PIC 9(05).
  2000         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2001             20  DC-JULIAN-YEAR        PIC 99.
  2002             20  DC-JULIAN-DAYS        PIC 999.
  2003         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2004         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2005         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2006     12  DATE-CONVERSION-VARIBLES.
  2007         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2008         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2009             20  FILLER                PIC 9(3).
  2010             20  HOLD-CEN-1-CCYY.
  2011                 24  HOLD-CEN-1-CC     PIC 99.
  2012                 24  HOLD-CEN-1-YY     PIC 99.
  2013             20  HOLD-CEN-1-MO         PIC 99.
  2014             20  HOLD-CEN-1-DA         PIC 99.
  2015         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2016             20  HOLD-CEN-1-R-MO       PIC 99.
  2017             20  HOLD-CEN-1-R-DA       PIC 99.
  2018             20  HOLD-CEN-1-R-CCYY.
  2019                 24  HOLD-CEN-1-R-CC   PIC 99.
  2020                 24  HOLD-CEN-1-R-YY   PIC 99.
  2021             20  FILLER                PIC 9(3).
  2022         16  HOLD-CENTURY-1-X.
  2023             20  FILLER                PIC X(3)  VALUE SPACES.
  2024             20  HOLD-CEN-1-X-CCYY.
  2025                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2026                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2027             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2028             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2029         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2030             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2031             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2032             20  HOLD-CEN-1-R-X-CCYY.
  2033                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2034                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2035             20  FILLER                PIC XXX.
  2036         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2037         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2038         16  DC-JULIAN-DATE-1          PIC 9(07).
  2039         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2040             20  DC-JULIAN-1-CCYY.
  2041                 24  DC-JULIAN-1-CC    PIC 99.
  2042                 24  DC-JULIAN-1-YR    PIC 99.
  2043             20  DC-JULIAN-DA-1        PIC 999.
  2044         16  DC-JULIAN-DATE-2          PIC 9(07).
  2045         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2046             20  DC-JULIAN-2-CCYY.
  2047                 24  DC-JULIAN-2-CC    PIC 99.
  2048                 24  DC-JULIAN-2-YR    PIC 99.
  2049             20  DC-JULIAN-DA-2        PIC 999.
  2050         16  DC-GREG-DATE-A-EDIT.
  2051             20  DC-EDITA-MONTH        PIC 99.
  2052             20  SLASHA-1              PIC X VALUE '/'.
  2053             20  DC-EDITA-DAY          PIC 99.
  2054             20  SLASHA-2              PIC X VALUE '/'.
  2055             20  DC-EDITA-CCYY.
  2056                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  39
* EL6311.cbl
  2057                 24  DC-EDITA-YEAR     PIC 99.
  2058         16  DC-GREG-DATE-B-EDIT.
  2059             20  DC-EDITB-MONTH        PIC 99.
  2060             20  SLASHB-1              PIC X VALUE '/'.
  2061             20  DC-EDITB-DAY          PIC 99.
  2062             20  SLASHB-2              PIC X VALUE '/'.
  2063             20  DC-EDITB-CCYY.
  2064                 24  DC-EDITB-CENT     PIC 99.
  2065                 24  DC-EDITB-YEAR     PIC 99.
  2066         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2067         16  DC-GREG-DATE-CYMD-R REDEFINES
  2068                              DC-GREG-DATE-CYMD.
  2069             20  DC-CYMD-CEN           PIC 99.
  2070             20  DC-CYMD-YEAR          PIC 99.
  2071             20  DC-CYMD-MONTH         PIC 99.
  2072             20  DC-CYMD-DAY           PIC 99.
  2073         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2074         16  DC-GREG-DATE-MDCY-R REDEFINES
  2075                              DC-GREG-DATE-MDCY.
  2076             20  DC-MDCY-MONTH         PIC 99.
  2077             20  DC-MDCY-DAY           PIC 99.
  2078             20  DC-MDCY-CEN           PIC 99.
  2079             20  DC-MDCY-YEAR          PIC 99.
  2080    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2081        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2082    12  DC-EL310-DATE                  PIC X(21).
  2083    12  FILLER                         PIC X(28).
  2084
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  40
* EL6311.cbl
  2086*    COPY ELCLOGOF.
  2087******************************************************************
  2088*                                                                *
  2089*                                                                *
  2090*                            ELCLOGOF.                           *
  2091*                            VMOD=2.001                          *
  2092*                                                                *
  2093*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2094*                                                                *
  2095******************************************************************
  2096 01  CLASIC-LOGOFF.
  2097     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2098     12  LOGOFF-TEXT.
  2099         16  FILLER          PIC X(5)    VALUE SPACES.
  2100         16  LOGOFF-MSG.
  2101             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2102             20  FILLER      PIC X       VALUE SPACES.
  2103             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2104         16  FILLER          PIC X(80)
  2105           VALUE '* YOU ARE NOW LOGGED OFF'.
  2106         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2107         16  FILLER          PIC X       VALUE QUOTE.
  2108         16  LOGOFF-SYS-MSG  PIC X(17)
  2109           VALUE 'S CLAS-IC SYSTEM '.
  2110     12  TEXT-MESSAGES.
  2111         16  UNACCESS-MSG    PIC X(29)
  2112             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2113         16  PGMIDERR-MSG    PIC X(17)
  2114             VALUE 'PROGRAM NOT FOUND'.
  2115
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  41
* EL6311.cbl
  2117*    COPY ELCATTR.
  2118******************************************************************
  2119*                                                                *
  2120*                            ELCATTR.                            *
  2121*                            VMOD=2.001                          *
  2122*                                                                *
  2123*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2124*                                                                *
  2125*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2126*                                                                *
  2127*                   POS 1   P=PROTECTED                          *
  2128*                           U=UNPROTECTED                        *
  2129*                           S=ASKIP                              *
  2130*                   POS 2   A=ALPHA/NUMERIC                      *
  2131*                           N=NUMERIC                            *
  2132*                   POS 3   N=NORMAL                             *
  2133*                           B=BRIGHT                             *
  2134*                           D=DARK                               *
  2135*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2136*                           OF=MODIFIED DATA TAG OFF             *
  2137*                                                                *
  2138*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2139******************************************************************
  2140 01  ATTRIBUTE-LIST.
  2141     12  AL-PABOF            PIC X       VALUE 'Y'.
  2142     12  AL-PABON            PIC X       VALUE 'Z'.
  2143     12  AL-PADOF            PIC X       VALUE '%'.
  2144     12  AL-PADON            PIC X       VALUE '_'.
  2145     12  AL-PANOF            PIC X       VALUE '-'.
  2146     12  AL-PANON            PIC X       VALUE '/'.
  2147     12  AL-SABOF            PIC X       VALUE '8'.
  2148     12  AL-SABON            PIC X       VALUE '9'.
  2149     12  AL-SADOF            PIC X       VALUE '@'.
  2150     12  AL-SADON            PIC X       VALUE QUOTE.
  2151     12  AL-SANOF            PIC X       VALUE '0'.
  2152     12  AL-SANON            PIC X       VALUE '1'.
  2153     12  AL-UABOF            PIC X       VALUE 'H'.
  2154     12  AL-UABON            PIC X       VALUE 'I'.
  2155     12  AL-UADOF            PIC X       VALUE '<'.
  2156     12  AL-UADON            PIC X       VALUE '('.
  2157     12  AL-UANOF            PIC X       VALUE ' '.
  2158     12  AL-UANON            PIC X       VALUE 'A'.
  2159     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2160     12  AL-UNBON            PIC X       VALUE 'R'.
  2161     12  AL-UNDOF            PIC X       VALUE '*'.
  2162     12  AL-UNDON            PIC X       VALUE ')'.
  2163     12  AL-UNNOF            PIC X       VALUE '&'.
  2164     12  AL-UNNON            PIC X       VALUE 'J'.
  2165
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  42
* EL6311.cbl
  2167*    COPY ELCEMIB.
  2168******************************************************************
  2169*                                                                *
  2170*                                                                *
  2171*                            ELCEMIB.                            *
  2172*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2173*                            VMOD=2.005                          *
  2174*                                                                *
  2175*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2176*                                                                *
  2177******************************************************************
  2178 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2179     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2180     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2181     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2182     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2183     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2184     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2185     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2186     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2187     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2188         88  EMI-NO-ERRORS                    VALUE '1'.
  2189         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2190         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2191     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2192         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2193     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2194         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2195         88  EMI-AREA1-FULL                   VALUE '2'.
  2196     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2197         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2198         88  EMI-AREA2-FULL                   VALUE '2'.
  2199     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2200         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2201         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2202         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2203         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2204         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2205     12  EMI-ERROR-LINES.
  2206         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2207         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2208         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2209         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2210             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2211                 24  EMI-ERR-NUM         PIC X(4).
  2212                 24  EMI-FILLER          PIC X.
  2213                 24  EMI-SEV             PIC X.
  2214                 24  FILLER              PIC X.
  2215             20  FILLER                  PIC X(02).
  2216     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2217         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2218             20  EMI-ERROR-NUMBER    PIC X(4).
  2219             20  EMI-FILL            PIC X.
  2220             20  EMI-SEVERITY        PIC X.
  2221             20  FILLER              PIC X.
  2222             20  EMI-ERROR-TEXT.
  2223                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2224                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  43
* EL6311.cbl
  2225     12  EMI-SEVERITY-SAVE           PIC X.
  2226         88  EMI-NOTE                    VALUE 'N'.
  2227         88  EMI-WARNING                 VALUE 'W'.
  2228         88  EMI-FORCABLE                VALUE 'F'.
  2229         88  EMI-FATAL                   VALUE 'X'.
  2230     12  EMI-MESSAGE-FLAG            PIC X.
  2231         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2232         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2233     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2234     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2235         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2236         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2237         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2238     12  emi-claim-no                pic x(7).
  2239     12  emi-claim-type              pic x(6).
  2240     12  FILLER                      PIC X(124)  VALUE SPACES.
  2241     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2242     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2243     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2244     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2245
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  44
* EL6311.cbl
  2247*    COPY ELCINTF.
  2248******************************************************************
  2249*                                                                *
  2250*                                                                *
  2251*                            ELCINTF.                            *
  2252*                            VMOD=2.017                          *
  2253*                                                                *
  2254*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2255*                                                                *
  2256*       LENGTH = 1024                                            *
  2257*                                                                *
  2258******************************************************************
  2259*                   C H A N G E   L O G
  2260*
  2261* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2262*-----------------------------------------------------------------
  2263*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2264* EFFECTIVE    NUMBER
  2265*-----------------------------------------------------------------
  2266* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2267******************************************************************
  2268 01  PROGRAM-INTERFACE-BLOCK.
  2269     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2270     12  PI-CALLING-PROGRAM              PIC X(8).
  2271     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2272     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2273     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2274     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2275     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2276     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2277     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2278     12  PI-COMPANY-ID                   PIC XXX.
  2279     12  PI-COMPANY-CD                   PIC X.
  2280
  2281     12  PI-COMPANY-PASSWORD             PIC X(8).
  2282
  2283     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2284
  2285     12  PI-CONTROL-IN-PROGRESS.
  2286         16  PI-CARRIER                  PIC X.
  2287         16  PI-GROUPING                 PIC X(6).
  2288         16  PI-STATE                    PIC XX.
  2289         16  PI-ACCOUNT                  PIC X(10).
  2290         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2291                                         PIC X(10).
  2292         16  PI-CLAIM-CERT-GRP.
  2293             20  PI-CLAIM-NO             PIC X(7).
  2294             20  PI-CERT-NO.
  2295                 25  PI-CERT-PRIME       PIC X(10).
  2296                 25  PI-CERT-SFX         PIC X.
  2297             20  PI-CERT-EFF-DT          PIC XX.
  2298         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2299             20  PI-PLAN-CODE            PIC X(2).
  2300             20  PI-REVISION-NUMBER      PIC X(3).
  2301             20  PI-PLAN-EFF-DT          PIC X(2).
  2302             20  PI-PLAN-EXP-DT          PIC X(2).
  2303             20  FILLER                  PIC X(11).
  2304         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  45
* EL6311.cbl
  2305             20  PI-OE-REFERENCE-1.
  2306                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2307                 25  PI-OE-REF-1-SUFF    PIC XX.
  2308
  2309     12  PI-SESSION-IN-PROGRESS          PIC X.
  2310         88  CLAIM-SESSION                   VALUE '1'.
  2311         88  CREDIT-SESSION                  VALUE '2'.
  2312         88  WARRANTY-SESSION                VALUE '3'.
  2313         88  MORTGAGE-SESSION                VALUE '4'.
  2314         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2315
  2316
  2317*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2318
  2319     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2320     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2321
  2322     12  PI-CREDIT-USER                  PIC X.
  2323         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2324         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2325
  2326     12  PI-CLAIM-USER                   PIC X.
  2327         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2328         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2329
  2330     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2331         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2332         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2333         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2334         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2335         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2336
  2337     12  PI-PROCESSOR-ID                 PIC X(4).
  2338
  2339     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2340
  2341     12  PI-MEMBER-CAPTION               PIC X(10).
  2342
  2343     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2344         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2345
  2346     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2347     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2348     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2349     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2350
  2351     12  PI-AH-OVERRIDE-L1               PIC X.
  2352     12  PI-AH-OVERRIDE-L2               PIC XX.
  2353     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2354     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2355
  2356     12  PI-NEW-SYSTEM                   PIC X(2).
  2357
  2358     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2359     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2360         88  PI-USES-PAID-TO                 VALUE '1'.
  2361     12  PI-CRDTCRD-SYSTEM.
  2362         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  46
* EL6311.cbl
  2363             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2364             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2365         16  PI-CC-MONTH-END-DT          PIC XX.
  2366     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2367
  2368     12  PI-OE-REFERENCE-2.
  2369         16  PI-OE-REF-2-PRIME           PIC X(10).
  2370         16  PI-OE-REF-2-SUFF            PIC X.
  2371
  2372     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2373
  2374     12  PI-LANGUAGE-TYPE                PIC X.
  2375             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2376             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2377             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2378
  2379     12  PI-POLICY-LINKAGE-IND           PIC X.
  2380         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2381         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2382                                                   LOW-VALUES.
  2383
  2384     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2385     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2386         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2387         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2388
  2389     12  PI-PROCESSOR-CSR-IND            PIC X.
  2390         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2391         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2392
  2393     12  FILLER                          PIC X(3).
  2394
  2395     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2396
  2397     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2398         PI-SYSTEM-LEVEL.
  2399
  2400         16  PI-ENTRY-CODES.
  2401             20  PI-ENTRY-CD-1           PIC X.
  2402             20  PI-ENTRY-CD-2           PIC X.
  2403
  2404         16  PI-RETURN-CODES.
  2405             20  PI-RETURN-CD-1          PIC X.
  2406             20  PI-RETURN-CD-2          PIC X.
  2407
  2408         16  PI-UPDATE-STATUS-SAVE.
  2409             20  PI-UPDATE-BY            PIC X(4).
  2410             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2411
  2412         16  PI-LOWER-CASE-LETTERS       PIC X.
  2413             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2414
  2415*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2416*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2417*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2418
  2419         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2420             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  47
* EL6311.cbl
  2421             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2422             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2423             88  ACCNT-CNTL                  VALUE '3'.
  2424             88  CARR-ACCNT-CNTL             VALUE '4'.
  2425
  2426         16  PI-PROCESSOR-CAP-LIST.
  2427             20  PI-SYSTEM-CONTROLS.
  2428                24 PI-SYSTEM-DISPLAY     PIC X.
  2429                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2430                24 PI-SYSTEM-MODIFY      PIC X.
  2431                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2432             20  FILLER                  PIC XX.
  2433             20  PI-DISPLAY-CAP          PIC X.
  2434                 88  DISPLAY-CAP             VALUE 'Y'.
  2435             20  PI-MODIFY-CAP           PIC X.
  2436                 88  MODIFY-CAP              VALUE 'Y'.
  2437             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2438                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2439             20  PI-FORCE-CAP            PIC X.
  2440                 88  FORCE-CAP               VALUE 'Y'.
  2441
  2442         16  PI-PROGRAM-CONTROLS.
  2443             20  PI-PGM-PRINT-OPT        PIC X.
  2444             20  PI-PGM-FORMAT-OPT       PIC X.
  2445             20  PI-PGM-PROCESS-OPT      PIC X.
  2446             20  PI-PGM-TOTALS-OPT       PIC X.
  2447
  2448         16  PI-HELP-INTERFACE.
  2449             20  PI-LAST-ERROR-NO        PIC X(4).
  2450             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2451
  2452         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2453             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2454
  2455         16  PI-CR-CONTROL-IN-PROGRESS.
  2456             20  PI-CR-CARRIER           PIC X.
  2457             20  PI-CR-GROUPING          PIC X(6).
  2458             20  PI-CR-STATE             PIC XX.
  2459             20  PI-CR-ACCOUNT           PIC X(10).
  2460             20  PI-CR-FIN-RESP          PIC X(10).
  2461             20  PI-CR-TYPE              PIC X.
  2462
  2463         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2464
  2465         16  PI-CR-MONTH-END-DT          PIC XX.
  2466
  2467         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2468             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2469             88  PI-ZERO-CARRIER             VALUE '1'.
  2470             88  PI-ZERO-GROUPING            VALUE '2'.
  2471             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2472
  2473         16  PI-CARRIER-SECURITY         PIC X.
  2474             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2475
  2476         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2477             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2478             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  48
* EL6311.cbl
  2479
  2480         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2481             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2482                                         INDEXED BY PI-ACCESS-NDX
  2483                                         PIC X.
  2484
  2485         16  PI-GA-BILLING-CONTROL       PIC X.
  2486             88  PI-GA-BILLING               VALUE '1'.
  2487
  2488         16  PI-MAIL-PROCESSING          PIC X.
  2489             88  PI-MAIL-YES                 VALUE 'Y'.
  2490
  2491         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2492
  2493         16  PI-AR-SYSTEM.
  2494             20  PI-AR-PROCESSING-CNTL   PIC X.
  2495                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2496             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2497             20  PI-AR-MONTH-END-DT      PIC XX.
  2498
  2499         16  PI-MP-SYSTEM.
  2500             20  PI-MORTGAGE-USER            PIC X.
  2501                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2502                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2503             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2504                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2505                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2506                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2507                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2508                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2509             20  PI-MP-MONTH-END-DT          PIC XX.
  2510             20  PI-MP-REFERENCE-NO.
  2511                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2512                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2513
  2514         16  PI-LABEL-CONTROL            PIC X(01).
  2515             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2516             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2517
  2518         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2519             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2520
  2521         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2522             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2523             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2524
  2525         16  FILLER                      PIC X(14).
  2526
  2527     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2528******************************************************************
  2529
  2530     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2531*    COPY ELC631PI.
  2532******************************************************************
  2533*                                                                *
  2534*                                                                *
  2535*                            ELC631PI                            *
  2536*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  49
* EL6311.cbl
  2537*                                                                *
  2538*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2539*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2540*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2541*                                                                *
  2542*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2543*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2544*    BETWEEN PROGRAMS.                                           *
  2545*                                                                *
  2546*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2547*                                                                *
  2548*               EL631 - EL6311 - EL6312 - EL6313                 *
  2549*                                                                *
  2550******************************************************************
  2551*                   C H A N G E   L O G
  2552*
  2553* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2554*-----------------------------------------------------------------
  2555*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2556* EFFECTIVE    NUMBER
  2557*-----------------------------------------------------------------
  2558* 021414    2003053000001  PEMA  changes for auto chk request
  2559******************************************************************
  2560
  2561         16  PI-631-DATA.
  2562             20  PI-ERPNDB-KEY.
  2563                 24  PI-PB-COMPANY-CD     PIC X.
  2564                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2565                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2566                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2567
  2568             20  PI-ERPNDB-ALT-KEY.
  2569                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2570                 24  PI-PB-CARRIER        PIC X.
  2571                 24  PI-PB-GROUPING       PIC X(6).
  2572                 24  PI-PB-STATE          PIC XX.
  2573                 24  PI-PB-ACCOUNT        PIC X(10).
  2574                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2575                 24  PI-PB-CERT-NO.
  2576                     28  PI-PB-CERT-PRIME PIC X(10).
  2577                     28  PI-PB-CERT-SFX   PIC X.
  2578                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2579                 24  PI-PB-RECORD-TYPE    PIC X.
  2580
  2581             20  PI-ERPNDB-CSR-KEY.
  2582                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2583                 24  PI-PB-CSR-ID             PIC X(4).
  2584                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2585                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2586                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2587
  2588             20  PI-BROWSE-TYPE               PIC X.
  2589                 88  PI-FILE-BROWSE             VALUE ' '.
  2590                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2591                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2592                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2593                 88  PI-CSR-BROWSE              VALUE '4'.
  2594
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  50
* EL6311.cbl
  2595             20  PI-MAINT-FUNCTION            PIC X.
  2596                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2597                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2598                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2599                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2600                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2601                 88  PI-PF5-FUNCTION            VALUE '5'.
  2602                 88  PI-PF6-FUNCTION            VALUE '6'.
  2603
  2604             20  PI-FILE-SWITCHES.
  2605                 24  PI-ALL-ISSUES-SW         PIC X.
  2606                     88  ALL-ISSUES             VALUE 'Y'.
  2607                 24  PI-ALL-CANCELS-SW        PIC X.
  2608                     88  ALL-CANCELS            VALUE 'Y'.
  2609                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2610                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2611                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2612                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2613                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2614                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2615                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2616                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2617                 24  PI-HOLD-REC-SW           PIC X.
  2618                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2619                 24  PI-CHANGE-REC-SW         PIC X.
  2620                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2621                 24  PI-CHK-REQ-REC-SW        PIC X.
  2622                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2623                 24  PI-ISSUE-WARNING-SW      PIC X.
  2624                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2625                 24  PI-CANCEL-WARNING-SW     PIC X.
  2626                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2627             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2628                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2629             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2630                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2631
  2632             20  PI-MAP-NAME                  PIC X(8).
  2633
  2634             20  PI-CURSOR                    PIC S9(4) COMP.
  2635
  2636             20  PI-PREV-ALT-KEY              PIC X(36).
  2637             20  PI-PREV-CSR-KEY              PIC X(15).
  2638             20  PI-PREV-KEY.
  2639                 24  PI-PREV-COMPANY-CD       PIC X.
  2640                 24  PI-PREV-BATCH            PIC X(6).
  2641                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2642                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2643             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2644             20  PI-BROWSE-SW                 PIC X.
  2645                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2646                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2647             20  PI-SV-CARRIER                PIC X.
  2648             20  PI-SV-GROUPING               PIC X(6).
  2649             20  PI-SV-STATE                  PIC XX.
  2650             20  PI-EDIT-SW                   PIC X.
  2651             20  PI-DISPLAY-SW                PIC XX.
  2652                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  51
* EL6311.cbl
  2653                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2654             20  PI-CRITERIA-DATA             PIC X(350).
  2655             20  PI-BMODE                     PIC X.
  2656             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2657             20  PI-BPMTS                     PIC S999     COMP-3.
  2658             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2659             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2660             20  PI-CSR-SESSION-SW            PIC X.
  2661                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2662             20  PI-ERRORS-SW                 PIC X.
  2663                 88  FATAL-ERRORS               VALUE 'X'.
  2664*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2665             20  pi-unforced-sw               pic x.
  2666                 88  unforced-errors            value 'X'.
  2667             20  FILLER                       PIC X(4).
  2668
  2669        16  FILLER             PIC X(94).
  2670
  2671 01  W-LETTER-COMMUNICATION-AREAS.
  2672*    COPY ELC1042.
  2673******************************************************************
  2674*                                                                *
  2675*                                                                *
  2676*                           ELC1042                              *
  2677*                            VMOD=2.002                          *
  2678*                                                                *
  2679*    NOTE                                                        *
  2680*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2681*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2682*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2683*        TO THESE PROGRAMS.                                      *
  2684*                                                                *
  2685*    NOTE                                                        *
  2686*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2687*        USE ONLY!                                               *
  2688*                                                                *
  2689******************************************************************
  2690
  2691         16  PI-1042-WA.
  2692             20  PI-ACTION       PIC  X(01).
  2693                 88 PI-SHOW-MODE           VALUE '1'.
  2694                 88 PI-CLEAR-MODE          VALUE '2'.
  2695                 88 PI-CREATE-MODE         VALUE '3'.
  2696             20  PI-COMM-CONTROL PIC  X(12).
  2697             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2698             20  PI-EOF-SW       PIC  X(01).
  2699                 88  PI-FILE-EOF           VALUE 'Y'.
  2700             20  PI-FILETYP      PIC  X(01).
  2701             20  PI-FORM-SQUEEZE-CONTROL
  2702                                 PIC  X(01).
  2703                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2704                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2705             20  PI-LAST-CONTROL PIC  X(12).
  2706             20  PI-TEMP-STOR-ITEMS
  2707                                 PIC S9(04) COMP.
  2708             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2709             20  PI-UPDATE-SW    PIC  9(01).
  2710                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  52
* EL6311.cbl
  2711             20  PI-104-SCREEN-SENT-IND
  2712                                 PIC  X(01).
  2713                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2714                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2715             20  PI-1042-SCREEN-SENT-IND
  2716                                 PIC  X(01).
  2717                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2718                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2719             20  PI-1042-ARCHIVE-IND
  2720                                 PIC  X(01).
  2721                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2722             20  FILLER          PIC  X(29).
  2723*    COPY ELC689PI.
  2724******************************************************************
  2725*                                                                *
  2726*                            ELC689PI                            *
  2727*                            VMOD=2.003                          *
  2728*                                                                *
  2729*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2730*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2731*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2732*                                                                *
  2733*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2734*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2735*    BETWEEN PROGRAMS.                                           *
  2736*                                                                *
  2737*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2738*                                                                *
  2739*               EL631 - EL689  - EL6891 - EL6892                 *
  2740*                                                                *
  2741******************************************************************
  2742*                   C H A N G E   L O G
  2743*
  2744* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2745*-----------------------------------------------------------------
  2746*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2747* EFFECTIVE    NUMBER
  2748*-----------------------------------------------------------------
  2749* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2750* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2751* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2752******************************************************************
  2753
  2754
  2755         16  PI-689-WORK-AREA.
  2756             20  PI-689-ALT-PRINTER-ID
  2757                                 PIC  X(04).
  2758             20  PI-689-ARCHIVE-NUMBER
  2759                                 PIC  9(08).
  2760             20  PI-689-ARCHIVE-SW
  2761                                 PIC  X(01).
  2762                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2763             20  PI-689-DATA-SOURCE
  2764                                 PIC  X(01).
  2765                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2766                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2767                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2768                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  53
* EL6311.cbl
  2769                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2770             20  PI-689-ERROR-IND
  2771                                 PIC  X(01).
  2772                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2773             20  PI-689-ERROR    PIC  9(04).
  2774                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2775                 88  PI-689-FATAL-ERROR
  2776                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2777                            0042 0047 0051 0066 0067 0070
  2778                            0168 0169 0174 0175 0176 0177 0179
  2779                            0180 0181 0182 0184 0185 0189 0190
  2780                            0191
  2781                            0215 0279 0280
  2782                            0412 0413 0454
  2783                            0533 0537
  2784                            2055 2114 2208 2209 2216 2232 2369
  2785                            2398 2433 2908 2999
  2786                            3000 3770 3771 3775
  2787                            7250 7365 7367 7368 7369 7370 7371
  2788                            7272 7373 7374 7376 7377 7378 7379
  2789                            7381 7388 7390 7393 7395 7396 7398
  2790                            9095 9096 9281 9298 9299 9320 9327
  2791                            9426 9427.
  2792                 88  PI-689-STOP-ERROR
  2793                     VALUES 0004 0008 0013 0023 0029 0033
  2794                            0042 0047 0066 0067 0070
  2795                            0168 0169 0174 0175 0176 0177
  2796                            0181 0182 0184 0185 0189 0190
  2797                            0279 0280
  2798                            0412 0413 0454
  2799                            2055 2208 2209 2216 2232
  2800                            2398 2999
  2801                            3000 3770 3771 3775
  2802                            7250 7365 7369 7370 7371
  2803                            7272 7373 7374 7376 7377 7378 7379
  2804                            7381 7388 7390 7393 7396 7398
  2805                            9095 9096 9299 9320 9426.
  2806             20  PI-689-FOLLOW-UP-DATE
  2807                                 PIC  X(02).
  2808             20  PI-689-FORM-NUMBER
  2809                                 PIC  X(04).
  2810             20  PI-689-LABEL-SOURCE
  2811                                 PIC X(01).
  2812                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2813                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2814                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2815                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2816                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2817                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2818                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2819             20  PI-689-NUMBER-COPIES
  2820                                 PIC  9(01).
  2821             20  PI-689-NUMBER-LABEL-LINES
  2822                                 PIC  9(01).
  2823             20  PI-689-NUMBER-TEXT-RECORDS
  2824                                 PIC  9(03).
  2825             20  PI-689-PRINT-ORDER-SW
  2826                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  54
* EL6311.cbl
  2827                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2828                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2829                 88  PI-689-PRINT-LATER     VALUE '3'.
  2830                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2831             20  PI-689-PRINT-RESTRICTION
  2832                                 PIC  X(01).
  2833                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2834                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2835                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2836             20  PI-689-PRINT-SW PIC  X(01).
  2837                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2838             20  PI-689-RESEND-DATE-1
  2839                                 PIC  X(02).
  2840             20  PI-689-RESEND-LETR-1
  2841                                 PIC X(4).
  2842             20  PI-689-TEMP-STOR-ID
  2843                                 PIC  X(08).
  2844             20  PI-689-USE-SCREEN-IND
  2845                                 PIC  X(01).
  2846                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2847             20  PI-689-ARCH-POINTER
  2848                                 PIC S9(08) COMP.
  2849                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2850             20  PI-689-ARCT-POINTER
  2851                                 PIC S9(08) COMP.
  2852                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2853             20  PI-689-VARIABLE-DATA-GRP.
  2854                 24  PI-689-VARIABLE-DATA-1
  2855                                 PIC  X(30).
  2856                 24  PI-689-VARIABLE-DATA-2
  2857                                 PIC  X(30).
  2858                 24  PI-689-VARIABLE-DATA-3
  2859                                 PIC  X(30).
  2860                 24  PI-689-VARIABLE-DATA-4
  2861                                 PIC  X(30).
  2862
  2863         16  PI-689-KEY-DATA-FIELDS.
  2864             20  PI-689-ACCOUNT  PIC  X(10).
  2865             20  PI-689-CARRIER  PIC  X(01).
  2866             20  PI-689-CERT-NO.
  2867                 24  PI-689-CERT-PRIME
  2868                                 PIC  X(10).
  2869                 24  PI-689-CERT-SFX
  2870                                 PIC  X(01).
  2871             20  PI-689-CHG-SEQ-NO
  2872                                 PIC S9(04)    COMP.
  2873             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2874                                 PIC  X(02).
  2875             20  PI-689-ENTRY-BATCH
  2876                                 PIC  X(06).
  2877             20  PI-689-EFF-DATE PIC  X(02).
  2878             20  PI-689-EXP-DATE PIC  X(02).
  2879             20  PI-689-GROUPING PIC  X(06).
  2880             20  PI-689-RESP-PERSON
  2881                                 PIC  X(10).
  2882             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2883             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2884                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  55
* EL6311.cbl
  2885             20  PI-689-STATE    PIC  X(02).
  2886             20  PI-689-TYPE     PIC  X(01).
  2887             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2888             20  PI-689-ALT-SEQ-NO
  2889                                 PIC S9(04)    COMP.
  2890         16  PI-689-DATE-EDIT    PIC  X(08).
  2891         16  PI-689-FOLLOW-UP-EDIT
  2892                                 PIC  X(08).
  2893         16  PI-689-RESEND1-EDIT PIC  X(08).
  2894         16  PI-689-SEQ-EDIT     PIC  X(08).
  2895         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2896         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2897             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2898         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2899         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  56
* EL6311.cbl
  2901
  2902 01  WS-EL6315-PASS-AREA.
  2903        16  PI-6315-ISS-CAN-SW      PIC X.
  2904        16  FILLER                  PIC X(120).
  2905        16  PI-RES-REF-CLM-TYPE     PIC X.
  2906        16  FILLER                  PIC X.
  2907        16  PI-6315-PASS-AREA.
  2908            20 FILLER               PIC X(236).
  2909            20 PI-6315-FINALIZED    PIC X.
  2910            20 FILLER               PIC X(280).
  2911
  2912 01  WS-EL6316-PASS-AREA.
  2913        16  PI-ISS-CAN-SW           PIC X.
  2914        16  FILLER                  PIC X(121).
  2915        16  PI-CLM-RESC-IND         PIC X.
  2916        16  PI-6316-PASS-AREA.
  2917            20 FILLER               PIC X(236).
  2918            20 PI-6316-FINALIZED    PIC X.
  2919            20 FILLER               PIC X(280).
  2920
  2921******************************************************************
  2922*                                                                *
  2923*         P A S S   A R E A   F O R   E D I T                    *
  2924*                                                                *
  2925******************************************************************
  2926
  2927 01  PASSED-RECORD.
  2928     12  RECORD-SAVE                  PIC X(585).
  2929* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2930*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2931*                    BY  WK-CURRENT-DATE.
  2932******************************************************************
  2933*                                                                *
  2934*                                                                *
  2935*                             ELC50W1                            *
  2936*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2937*                            VMOD=2.004                          *
  2938*                                                                *
  2939*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2940*                                                                *
  2941*                                                                *
  2942******************************************************************
  2943
  2944     12  WK-WORK-AREA.
  2945         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2946         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2947         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2948         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2949         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2950         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2951         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2952         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2953         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2954         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2955         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2956         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2957         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2958         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  57
* EL6311.cbl
  2959         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2960         16  WK-CREDIT-EDIT-CONTROLS.
  2961             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2962             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2963             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2964             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2965             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2966             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2967         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2968         16  WK-SAVE-REIN-DATA.
  2969             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2970             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2971             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2972         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2973             88  ENTRY-FROM-EL6311       VALUE '6'.
  2974         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2975         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2976     12  WK-RECORD-ADDRESSES.
  2977         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2978         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2979         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2980         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2981         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2982         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2983         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2984         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2985     12  WK-OVER-SHORT-AREA.
  2986         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2987         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2988         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2989             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2990         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  58
* EL6311.cbl
  2992
  2993*    COPY ELCEDITC.
  2994******************************************************************
  2995*                                                                *
  2996*                                                                *
  2997*                            ELCEDITC                            *
  2998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2999*                            VMOD=2.012                          *
  3000*                                                                *
  3001*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3002*                     EL6313, EL050 AND EL517.                   *
  3003*                                                                *
  3004******************************************************************
  3005******************************************************************
  3006*                   C H A N G E   L O G
  3007*
  3008* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3009*-----------------------------------------------------------------
  3010*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3011* EFFECTIVE    NUMBER
  3012*-----------------------------------------------------------------
  3013* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3014******************************************************************
  3015
  3016     12  EDIT-CRITERIA-DATA.
  3017         16  EC-CO-MONTH-END-DT       PIC XX.
  3018         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3019         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3020         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3021         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3022         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3023         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3024         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3025         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3026         16  EC-CO-REM-TERM-CALC      PIC X.
  3027               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3028               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3029               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3030               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3031
  3032         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3033               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3034               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3035               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3036               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3037               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3038               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3039               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3040               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3041               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3042               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3043
  3044         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3045               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3046               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3047               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3048               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3049               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  59
* EL6311.cbl
  3050               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3051               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3052               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3053
  3054         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3055                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3056                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3057
  3058         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3059                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3060                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3061                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3062                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3063                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3064                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3065                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3066                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3067
  3068         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3069               88  EC-BR-REDUCING                   VALUE 'R'.
  3070               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3071
  3072         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3073         16  EC-BR-LF-DESC             PIC X(10).
  3074         16  EC-BR-AH-DESC             PIC X(10).
  3075         16  EC-BR-LF-COMMENT          PIC X(10).
  3076         16  EC-BR-AH-COMMENT          PIC X(10).
  3077
  3078         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3079               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3080               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3081               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3082               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3083
  3084         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3085               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3086               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3087               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3088               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3089
  3090         16  EC-BR-LF-REFUND-CALC      PIC X.
  3091                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3092                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3093                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3094                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3095                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3096                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3097                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3098
  3099         16  EC-BR-AH-REFUND-CALC      PIC X.
  3100                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3101                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3102                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3103                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3104                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3105                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3106                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3107                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  60
* EL6311.cbl
  3108
  3109         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3110                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3111                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3112                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3113
  3114         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3115                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3116                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3117                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3118
  3119         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3120         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3121         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3122         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3123
  3124         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3125         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3126                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3127                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3128                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3129                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3130
  3131         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3132               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3133               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3134               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3135               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3136               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3137
  3138         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3139               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3140               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3141               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3142               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3143               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3144
  3145         16  EC-ST-LF-REFUND-CALC      PIC X.
  3146                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3147                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3148                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3149                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3150                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3151                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3152                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3153                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3154
  3155         16  EC-ST-AH-REFUND-CALC      PIC X.
  3156                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3157                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3158                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3159                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3160                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3161                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3162                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3163                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3164
  3165         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  61
* EL6311.cbl
  3166         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3167         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3168         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3169         16  EC-AM-EXPIRATION-DT       PIC XX.
  3170         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3171         16  EC-AM-CLASS-CD            PIC XX.
  3172         16  EC-AM-LF-DEVIATION        PIC XXX.
  3173         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3174         16  EC-AM-AH-DEVIATION        PIC XXX.
  3175         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3176         16  EC-AM-PHONE-NO            PIC X(10).
  3177
  3178         16  EC-AM-LF-REFUND-CALC      PIC X.
  3179                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3180                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3181                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3182                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3183                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3184                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3185                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3186
  3187         16  EC-AM-AH-REFUND-CALC      PIC X.
  3188                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3189                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3190                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3191                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3192                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3193                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3194                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3195
  3196         16  EC-AM-BEN-I-G-CD          PIC X.
  3197                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3198                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3199                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3200
  3201         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3202         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3203         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3204         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3205         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3206         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3207         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3208         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3209         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3210
  3211         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3212         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3213         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3214         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3215         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3216         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3217         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3218         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3219         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3220         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3221         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3222         16  EC-RT-LF-NSP-ST           PIC XX.
  3223         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  62
* EL6311.cbl
  3224         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3225         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3226
  3227         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3228             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3229                                             'M' '5' '9' '2'.
  3230             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3231             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3232             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3233             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3234             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3235             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3236             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3237             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3238             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3239             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3240
  3241         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3242             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3243                                             'M' '5' '9' '2'.
  3244             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3245             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3246             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3247             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3248             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3249             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3250             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3251             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3252             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3253             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3254
  3255         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3256         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3257         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3258         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3259         16  EC-CM-DEATH-DT            PIC XX.
  3260
  3261*DMD CUSTOM CODING FIELDS BELOW
  3262*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3263         16  EC-BR-DMD-RATING-SW       PIC X.
  3264                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3265                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3266                 88  NO-DMD-RATING               VALUE 'N'.
  3267
  3268         16  EC-NEW-CERT               PIC X(11).
  3269         16  EC-NEW-STATE              PIC XX.
  3270         16  FILLER                    PIC X.
  3271*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3272         16  OVER-SHORT-EDIT-FIELDS.
  3273             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3274             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3275             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3276             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3277             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3278             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3279             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3280             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3281             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  63
* EL6311.cbl
  3282         16  FILLER                    PIC X(71).
  3283
  3284******************************************************************
  3285
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  64
* EL6311.cbl
  3287
  3288*    COPY ELCJPFX.
  3289******************************************************************
  3290*                                                                *
  3291*                                                                *
  3292*                            ELCJPFX.                            *
  3293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3294*                            VMOD=2.002                          *
  3295*                                                                *
  3296*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3297*                                                                *
  3298*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3299*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3300*        ELCNTL - CONTROL FILE                                   *
  3301*        ELMSTR - CLAIM MASTERS                                  *
  3302*        ELTRLR - ACTIVITY TRAILERS                              *
  3303*        ELCHKQ - CHECK QUE                                      *
  3304******************************************************************
  3305 01  JOURNAL-RECORD.
  3306     12  jp-date                     pic s9(5) comp-3.
  3307     12  jp-time                     pic s9(7) comp-3.
  3308     12  JP-USER-ID                  PIC X(4).
  3309     12  JP-FILE-ID                  PIC X(8).
  3310     12  JP-PROGRAM-ID               PIC X(8).
  3311     12  JP-RECORD-TYPE              PIC X.
  3312         88 JP-ADD              VALUE 'A'.
  3313         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3314         88 JP-AFTER-CHANGE     VALUE 'C'.
  3315         88 JP-DELETE           VALUE 'D'.
  3316         88 JP-GENERIC-DELETE   VALUE 'G'.
  3317         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3318         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3319     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3320     12  JP-RECORD-AREA
  3321
  3322
  3323                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  65
* EL6311.cbl
  3325*    COPY ELCAID.
  3326******************************************************************
  3327*                                                                *
  3328*                            ELCAID.                             *
  3329*                            VMOD=2.001                          *
  3330*                                                                *
  3331*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3332*                                                                *
  3333*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3334*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3335******************************************************************
  3336
  3337 01  DFHAID.
  3338   02  DFHNULL   PIC  X  VALUE  ' '.
  3339   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3340   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3341   02  DFHPEN    PIC  X  VALUE  '='.
  3342   02  DFHOPID   PIC  X  VALUE  'W'.
  3343   02  DFHPA1    PIC  X  VALUE  '%'.
  3344   02  DFHPA2    PIC  X  VALUE  '>'.
  3345   02  DFHPA3    PIC  X  VALUE  ','.
  3346   02  DFHPF1    PIC  X  VALUE  '1'.
  3347   02  DFHPF2    PIC  X  VALUE  '2'.
  3348   02  DFHPF3    PIC  X  VALUE  '3'.
  3349   02  DFHPF4    PIC  X  VALUE  '4'.
  3350   02  DFHPF5    PIC  X  VALUE  '5'.
  3351   02  DFHPF6    PIC  X  VALUE  '6'.
  3352   02  DFHPF7    PIC  X  VALUE  '7'.
  3353   02  DFHPF8    PIC  X  VALUE  '8'.
  3354   02  DFHPF9    PIC  X  VALUE  '9'.
  3355   02  DFHPF10   PIC  X  VALUE  ':'.
  3356   02  DFHPF11   PIC  X  VALUE  '#'.
  3357   02  DFHPF12   PIC  X  VALUE  '@'.
  3358   02  DFHPF13   PIC  X  VALUE  'A'.
  3359   02  DFHPF14   PIC  X  VALUE  'B'.
  3360   02  DFHPF15   PIC  X  VALUE  'C'.
  3361   02  DFHPF16   PIC  X  VALUE  'D'.
  3362   02  DFHPF17   PIC  X  VALUE  'E'.
  3363   02  DFHPF18   PIC  X  VALUE  'F'.
  3364   02  DFHPF19   PIC  X  VALUE  'G'.
  3365   02  DFHPF20   PIC  X  VALUE  'H'.
  3366   02  DFHPF21   PIC  X  VALUE  'I'.
  3367*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3368   02  DFHPF22   PIC  X  VALUE  '['.
  3369   02  DFHPF23   PIC  X  VALUE  '.'.
  3370   02  DFHPF24   PIC  X  VALUE  '<'.
  3371   02  DFHMSRE   PIC  X  VALUE  'X'.
  3372   02  DFHSTRF   PIC  X  VALUE  'h'.
  3373   02  DFHTRIG   PIC  X  VALUE  '"'.
  3374
  3375 01  FILLER    REDEFINES DFHAID.
  3376     12  FILLER              PIC X(8).
  3377     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3378
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  66
* EL6311.cbl
  3380*    COPY EL6311S.
  3381 01  EL631BI.
  3382     05  FILLER            PIC  X(0012).
  3383*    -------------------------------
  3384     05  BDATEL PIC S9(0004) COMP.
  3385     05  BDATEF PIC  X(0001).
  3386     05  FILLER REDEFINES BDATEF.
  3387         10  BDATEA PIC  X(0001).
  3388     05  BDATEI PIC  X(0008).
  3389*    -------------------------------
  3390     05  BTIMEL PIC S9(0004) COMP.
  3391     05  BTIMEF PIC  X(0001).
  3392     05  FILLER REDEFINES BTIMEF.
  3393         10  BTIMEA PIC  X(0001).
  3394     05  BTIMEI PIC  X(0005).
  3395*    -------------------------------
  3396     05  BHEADL PIC S9(0004) COMP.
  3397     05  BHEADF PIC  X(0001).
  3398     05  FILLER REDEFINES BHEADF.
  3399         10  BHEADA PIC  X(0001).
  3400     05  BHEADI PIC  X(0038).
  3401*    -------------------------------
  3402     05  BNCERTLL PIC S9(0004) COMP.
  3403     05  BNCERTLF PIC  X(0001).
  3404     05  FILLER REDEFINES BNCERTLF.
  3405         10  BNCERTLA PIC  X(0001).
  3406     05  BNCERTLI PIC  X(0008).
  3407*    -------------------------------
  3408     05  BNCERTL PIC S9(0004) COMP.
  3409     05  BNCERTF PIC  X(0001).
  3410     05  FILLER REDEFINES BNCERTF.
  3411         10  BNCERTA PIC  X(0001).
  3412     05  BNCERTI PIC  X(0011).
  3413*    -------------------------------
  3414     05  BNSTATLL PIC S9(0004) COMP.
  3415     05  BNSTATLF PIC  X(0001).
  3416     05  FILLER REDEFINES BNSTATLF.
  3417         10  BNSTATLA PIC  X(0001).
  3418     05  BNSTATLI PIC  X(0009).
  3419*    -------------------------------
  3420     05  BNSTATL PIC S9(0004) COMP.
  3421     05  BNSTATF PIC  X(0001).
  3422     05  FILLER REDEFINES BNSTATF.
  3423         10  BNSTATA PIC  X(0001).
  3424     05  BNSTATI PIC  X(0002).
  3425*    -------------------------------
  3426     05  BCHGTL PIC S9(0004) COMP.
  3427     05  BCHGTF PIC  X(0001).
  3428     05  FILLER REDEFINES BCHGTF.
  3429         10  BCHGTA PIC  X(0001).
  3430     05  BCHGTI PIC  X(0004).
  3431*    -------------------------------
  3432     05  BCHGL PIC S9(0004) COMP.
  3433     05  BCHGF PIC  X(0001).
  3434     05  FILLER REDEFINES BCHGF.
  3435         10  BCHGA PIC  X(0001).
  3436     05  BCHGI PIC  X(0004).
  3437*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  67
* EL6311.cbl
  3438     05  BCOMPIDL PIC S9(0004) COMP.
  3439     05  BCOMPIDF PIC  X(0001).
  3440     05  FILLER REDEFINES BCOMPIDF.
  3441         10  BCOMPIDA PIC  X(0001).
  3442     05  BCOMPIDI PIC  X(0003).
  3443*    -------------------------------
  3444     05  BREGIONL PIC S9(0004) COMP.
  3445     05  BREGIONF PIC  X(0001).
  3446     05  FILLER REDEFINES BREGIONF.
  3447         10  BREGIONA PIC  X(0001).
  3448     05  BREGIONI PIC  X(0006).
  3449*    -------------------------------
  3450     05  BUSERL PIC S9(0004) COMP.
  3451     05  BUSERF PIC  X(0001).
  3452     05  FILLER REDEFINES BUSERF.
  3453         10  BUSERA PIC  X(0001).
  3454     05  BUSERI PIC  X(0004).
  3455*    -------------------------------
  3456     05  BMAINTL PIC S9(0004) COMP.
  3457     05  BMAINTF PIC  X(0001).
  3458     05  FILLER REDEFINES BMAINTF.
  3459         10  BMAINTA PIC  X(0001).
  3460     05  BMAINTI PIC  X(0001).
  3461*    -------------------------------
  3462     05  BMANTBYL PIC S9(0004) COMP.
  3463     05  BMANTBYF PIC  X(0001).
  3464     05  FILLER REDEFINES BMANTBYF.
  3465         10  BMANTBYA PIC  X(0001).
  3466     05  BMANTBYI PIC  X(0004).
  3467*    -------------------------------
  3468     05  BCHGHDGL PIC S9(0004) COMP.
  3469     05  BCHGHDGF PIC  X(0001).
  3470     05  FILLER REDEFINES BCHGHDGF.
  3471         10  BCHGHDGA PIC  X(0001).
  3472     05  BCHGHDGI PIC  X(0003).
  3473*    -------------------------------
  3474     05  BMANTDTL PIC S9(0004) COMP.
  3475     05  BMANTDTF PIC  X(0001).
  3476     05  FILLER REDEFINES BMANTDTF.
  3477         10  BMANTDTA PIC  X(0001).
  3478     05  BMANTDTI PIC  X(0008).
  3479*    -------------------------------
  3480     05  BMANTATL PIC S9(0004) COMP.
  3481     05  BMANTATF PIC  X(0001).
  3482     05  FILLER REDEFINES BMANTATF.
  3483         10  BMANTATA PIC  X(0001).
  3484     05  BMANTATI PIC  X(0005).
  3485*    -------------------------------
  3486     05  BCSRL PIC S9(0004) COMP.
  3487     05  BCSRF PIC  X(0001).
  3488     05  FILLER REDEFINES BCSRF.
  3489         10  BCSRA PIC  X(0001).
  3490     05  BCSRI PIC  X(0004).
  3491*    -------------------------------
  3492     05  BBATCHL PIC S9(0004) COMP.
  3493     05  BBATCHF PIC  X(0001).
  3494     05  FILLER REDEFINES BBATCHF.
  3495         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  68
* EL6311.cbl
  3496     05  BBATCHI PIC  X(0006).
  3497*    -------------------------------
  3498     05  BSEQL PIC S9(0004) COMP.
  3499     05  BSEQF PIC  X(0001).
  3500     05  FILLER REDEFINES BSEQF.
  3501         10  BSEQA PIC  X(0001).
  3502     05  BSEQI PIC  X(0004).
  3503*    -------------------------------
  3504     05  BMOENDTL PIC S9(0004) COMP.
  3505     05  BMOENDTF PIC  X(0001).
  3506     05  FILLER REDEFINES BMOENDTF.
  3507         10  BMOENDTA PIC  X(0001).
  3508     05  BMOENDTI PIC  X(0008).
  3509*    -------------------------------
  3510     05  BCARRL PIC S9(0004) COMP.
  3511     05  BCARRF PIC  X(0001).
  3512     05  FILLER REDEFINES BCARRF.
  3513         10  BCARRA PIC  X(0001).
  3514     05  BCARRI PIC  X(0001).
  3515*    -------------------------------
  3516     05  BGROUPL PIC S9(0004) COMP.
  3517     05  BGROUPF PIC  X(0001).
  3518     05  FILLER REDEFINES BGROUPF.
  3519         10  BGROUPA PIC  X(0001).
  3520     05  BGROUPI PIC  X(0006).
  3521*    -------------------------------
  3522     05  BSTATEL PIC S9(0004) COMP.
  3523     05  BSTATEF PIC  X(0001).
  3524     05  FILLER REDEFINES BSTATEF.
  3525         10  BSTATEA PIC  X(0001).
  3526     05  BSTATEI PIC  X(0002).
  3527*    -------------------------------
  3528     05  BACCTL PIC S9(0004) COMP.
  3529     05  BACCTF PIC  X(0001).
  3530     05  FILLER REDEFINES BACCTF.
  3531         10  BACCTA PIC  X(0001).
  3532     05  BACCTI PIC  X(0010).
  3533*    -------------------------------
  3534     05  BVINHL PIC S9(0004) COMP.
  3535     05  BVINHF PIC  X(0001).
  3536     05  FILLER REDEFINES BVINHF.
  3537         10  BVINHA PIC  X(0001).
  3538     05  BVINHI PIC  X(0004).
  3539*    -------------------------------
  3540     05  BVINL PIC S9(0004) COMP.
  3541     05  BVINF PIC  X(0001).
  3542     05  FILLER REDEFINES BVINF.
  3543         10  BVINA PIC  X(0001).
  3544     05  BVINI PIC  X(0017).
  3545*    -------------------------------
  3546     05  BREFHDGL PIC S9(0004) COMP.
  3547     05  BREFHDGF PIC  X(0001).
  3548     05  FILLER REDEFINES BREFHDGF.
  3549         10  BREFHDGA PIC  X(0001).
  3550     05  BREFHDGI PIC  X(0004).
  3551*    -------------------------------
  3552     05  BREFL PIC S9(0004) COMP.
  3553     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  69
* EL6311.cbl
  3554     05  FILLER REDEFINES BREFF.
  3555         10  BREFA PIC  X(0001).
  3556     05  BREFI PIC  X(0012).
  3557*    -------------------------------
  3558     05  BAGEDEFL PIC S9(0004) COMP.
  3559     05  BAGEDEFF PIC  X(0001).
  3560     05  FILLER REDEFINES BAGEDEFF.
  3561         10  BAGEDEFA PIC  X(0001).
  3562     05  BAGEDEFI PIC  X(0004).
  3563*    -------------------------------
  3564     05  BCERTNOL PIC S9(0004) COMP.
  3565     05  BCERTNOF PIC  X(0001).
  3566     05  FILLER REDEFINES BCERTNOF.
  3567         10  BCERTNOA PIC  X(0001).
  3568     05  BCERTNOI PIC  X(0010).
  3569*    -------------------------------
  3570     05  BSUFIXL PIC S9(0004) COMP.
  3571     05  BSUFIXF PIC  X(0001).
  3572     05  FILLER REDEFINES BSUFIXF.
  3573         10  BSUFIXA PIC  X(0001).
  3574     05  BSUFIXI PIC  X(0001).
  3575*    -------------------------------
  3576     05  BEFFDTL PIC S9(0004) COMP.
  3577     05  BEFFDTF PIC  X(0001).
  3578     05  FILLER REDEFINES BEFFDTF.
  3579         10  BEFFDTA PIC  X(0001).
  3580     05  BEFFDTI PIC  X(0008).
  3581*    -------------------------------
  3582     05  BLSTNML PIC S9(0004) COMP.
  3583     05  BLSTNMF PIC  X(0001).
  3584     05  FILLER REDEFINES BLSTNMF.
  3585         10  BLSTNMA PIC  X(0001).
  3586     05  BLSTNMI PIC  X(0015).
  3587*    -------------------------------
  3588     05  B1STNML PIC S9(0004) COMP.
  3589     05  B1STNMF PIC  X(0001).
  3590     05  FILLER REDEFINES B1STNMF.
  3591         10  B1STNMA PIC  X(0001).
  3592     05  B1STNMI PIC  X(0010).
  3593*    -------------------------------
  3594     05  BINITL PIC S9(0004) COMP.
  3595     05  BINITF PIC  X(0001).
  3596     05  FILLER REDEFINES BINITF.
  3597         10  BINITA PIC  X(0001).
  3598     05  BINITI PIC  X(0001).
  3599*    -------------------------------
  3600     05  BSEXL PIC S9(0004) COMP.
  3601     05  BSEXF PIC  X(0001).
  3602     05  FILLER REDEFINES BSEXF.
  3603         10  BSEXA PIC  X(0001).
  3604     05  BSEXI PIC  X(0001).
  3605*    -------------------------------
  3606     05  BAGEL PIC S9(0004) COMP.
  3607     05  BAGEF PIC  X(0001).
  3608     05  FILLER REDEFINES BAGEF.
  3609         10  BAGEA PIC  X(0001).
  3610     05  BAGEI PIC  X(0002).
  3611*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  70
* EL6311.cbl
  3612     05  BBIRTHL PIC S9(0004) COMP.
  3613     05  BBIRTHF PIC  X(0001).
  3614     05  FILLER REDEFINES BBIRTHF.
  3615         10  BBIRTHA PIC  X(0001).
  3616     05  BBIRTHI PIC  X(0008).
  3617*    -------------------------------
  3618     05  B1STPMTL PIC S9(0004) COMP.
  3619     05  B1STPMTF PIC  X(0001).
  3620     05  FILLER REDEFINES B1STPMTF.
  3621         10  B1STPMTA PIC  X(0001).
  3622     05  B1STPMTI PIC  X(0008).
  3623*    -------------------------------
  3624     05  BDAYSL PIC S9(0004) COMP.
  3625     05  BDAYSF PIC  X(0001).
  3626     05  FILLER REDEFINES BDAYSF.
  3627         10  BDAYSA PIC  X(0001).
  3628     05  BDAYSI PIC  X(0003).
  3629*    -------------------------------
  3630     05  BLNTRML PIC S9(0004) COMP.
  3631     05  BLNTRMF PIC  X(0001).
  3632     05  FILLER REDEFINES BLNTRMF.
  3633         10  BLNTRMA PIC  X(0001).
  3634     05  BLNTRMI PIC  X(0003).
  3635*    -------------------------------
  3636     05  BLNOFCRL PIC S9(0004) COMP.
  3637     05  BLNOFCRF PIC  X(0001).
  3638     05  FILLER REDEFINES BLNOFCRF.
  3639         10  BLNOFCRA PIC  X(0001).
  3640     05  BLNOFCRI PIC  X(0005).
  3641*    -------------------------------
  3642     05  BMODEL PIC S9(0004) COMP.
  3643     05  BMODEF PIC  X(0001).
  3644     05  FILLER REDEFINES BMODEF.
  3645         10  BMODEA PIC  X(0001).
  3646     05  BMODEI PIC  X(0001).
  3647*    -------------------------------
  3648     05  BFREQL PIC S9(0004) COMP.
  3649     05  BFREQF PIC  X(0001).
  3650     05  FILLER REDEFINES BFREQF.
  3651         10  BFREQA PIC  X(0001).
  3652     05  BFREQI PIC  X(0002).
  3653*    -------------------------------
  3654     05  BPMTSL PIC S9(0004) COMP.
  3655     05  BPMTSF PIC  X(0001).
  3656     05  FILLER REDEFINES BPMTSF.
  3657         10  BPMTSA PIC  X(0001).
  3658     05  BPMTSI PIC  999.
  3659*    -------------------------------
  3660     05  BPMTAMTL PIC S9(0004) COMP.
  3661     05  BPMTAMTF PIC  X(0001).
  3662     05  FILLER REDEFINES BPMTAMTF.
  3663         10  BPMTAMTA PIC  X(0001).
  3664     05  BPMTAMTI PIC  9(7)V99.
  3665*    -------------------------------
  3666     05  BAPRL PIC S9(0004) COMP.
  3667     05  BAPRF PIC  X(0001).
  3668     05  FILLER REDEFINES BAPRF.
  3669         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  71
* EL6311.cbl
  3670     05  BAPRI PIC  X(7).
  3671*    -------------------------------
  3672     05  BLIVESL PIC S9(0004) COMP.
  3673     05  BLIVESF PIC  X(0001).
  3674     05  FILLER REDEFINES BLIVESF.
  3675         10  BLIVESA PIC  X(0001).
  3676     05  BLIVESI PIC  X(0009).
  3677*    -------------------------------
  3678     05  BMEMCAPL PIC S9(0004) COMP.
  3679     05  BMEMCAPF PIC  X(0001).
  3680     05  FILLER REDEFINES BMEMCAPF.
  3681         10  BMEMCAPA PIC  X(0001).
  3682     05  BMEMCAPI PIC  X(0011).
  3683*    -------------------------------
  3684     05  BORIGHDL PIC S9(0004) COMP.
  3685     05  BORIGHDF PIC  X(0001).
  3686     05  FILLER REDEFINES BORIGHDF.
  3687         10  BORIGHDA PIC  X(0001).
  3688     05  BORIGHDI PIC  X(0009).
  3689*    -------------------------------
  3690     05  DMDBILL PIC S9(0004) COMP.
  3691     05  DMDBILF PIC  X(0001).
  3692     05  FILLER REDEFINES DMDBILF.
  3693         10  DMDBILA PIC  X(0001).
  3694     05  DMDBILI PIC  X(0006).
  3695*    -------------------------------
  3696     05  BFORCEL PIC S9(0004) COMP.
  3697     05  BFORCEF PIC  X(0001).
  3698     05  FILLER REDEFINES BFORCEF.
  3699         10  BFORCEA PIC  X(0001).
  3700     05  BFORCEI PIC  X(0001).
  3701*    -------------------------------
  3702     05  BENTRYL PIC S9(0004) COMP.
  3703     05  BENTRYF PIC  X(0001).
  3704     05  FILLER REDEFINES BENTRYF.
  3705         10  BENTRYA PIC  X(0001).
  3706     05  BENTRYI PIC  X(0001).
  3707*    -------------------------------
  3708     05  BREINL PIC S9(0004) COMP.
  3709     05  BREINF PIC  X(0001).
  3710     05  FILLER REDEFINES BREINF.
  3711         10  BREINA PIC  X(0001).
  3712     05  BREINI PIC  X(0001).
  3713*    -------------------------------
  3714     05  BBILCDL PIC S9(0004) COMP.
  3715     05  BBILCDF PIC  X(0001).
  3716     05  FILLER REDEFINES BBILCDF.
  3717         10  BBILCDA PIC  X(0001).
  3718     05  BBILCDI PIC  X(0001).
  3719*    -------------------------------
  3720     05  BUNWRITL PIC S9(0004) COMP.
  3721     05  BUNWRITF PIC  X(0001).
  3722     05  FILLER REDEFINES BUNWRITF.
  3723         10  BUNWRITA PIC  X(0001).
  3724     05  BUNWRITI PIC  X(0001).
  3725*    -------------------------------
  3726     05  BSKPCDL PIC S9(0004) COMP.
  3727     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  72
* EL6311.cbl
  3728     05  FILLER REDEFINES BSKPCDF.
  3729         10  BSKPCDA PIC  X(0001).
  3730     05  BSKPCDI PIC  X(0001).
  3731*    -------------------------------
  3732     05  BINDGRPL PIC S9(0004) COMP.
  3733     05  BINDGRPF PIC  X(0001).
  3734     05  FILLER REDEFINES BINDGRPF.
  3735         10  BINDGRPA PIC  X(0001).
  3736     05  BINDGRPI PIC  X(0001).
  3737*    -------------------------------
  3738     05  BSIGL PIC S9(0004) COMP.
  3739     05  BSIGF PIC  X(0001).
  3740     05  FILLER REDEFINES BSIGF.
  3741         10  BSIGA PIC  X(0001).
  3742     05  BSIGI PIC  X(0001).
  3743*    -------------------------------
  3744     05  BRTCLSL PIC S9(0004) COMP.
  3745     05  BRTCLSF PIC  X(0001).
  3746     05  FILLER REDEFINES BRTCLSF.
  3747         10  BRTCLSA PIC  X(0001).
  3748     05  BRTCLSI PIC  X(0002).
  3749*    -------------------------------
  3750     05  BCHGCNTL PIC S9(0004) COMP.
  3751     05  BCHGCNTF PIC  X(0001).
  3752     05  FILLER REDEFINES BCHGCNTF.
  3753         10  BCHGCNTA PIC  X(0001).
  3754     05  BCHGCNTI PIC  X(0003).
  3755*    -------------------------------
  3756     05  BMEMBERL PIC S9(0004) COMP.
  3757     05  BMEMBERF PIC  X(0001).
  3758     05  FILLER REDEFINES BMEMBERF.
  3759         10  BMEMBERA PIC  X(0001).
  3760     05  BMEMBERI PIC  X(0012).
  3761*    -------------------------------
  3762     05  BORGNOL PIC S9(0004) COMP.
  3763     05  BORGNOF PIC  X(0001).
  3764     05  FILLER REDEFINES BORGNOF.
  3765         10  BORGNOA PIC  X(0001).
  3766     05  BORGNOI PIC  X(0006).
  3767*    -------------------------------
  3768     05  BORGSEQL PIC S9(0004) COMP.
  3769     05  BORGSEQF PIC  X(0001).
  3770     05  FILLER REDEFINES BORGSEQF.
  3771         10  BORGSEQA PIC  X(0001).
  3772     05  BORGSEQI PIC  X(0004).
  3773*    -------------------------------
  3774     05  BBILLEDL PIC S9(0004) COMP.
  3775     05  BBILLEDF PIC  X(0001).
  3776     05  FILLER REDEFINES BBILLEDF.
  3777         10  BBILLEDA PIC  X(0001).
  3778     05  BBILLEDI PIC  9(9).
  3779*    -------------------------------
  3780     05  BKIND1L PIC S9(0004) COMP.
  3781     05  BKIND1F PIC  X(0001).
  3782     05  FILLER REDEFINES BKIND1F.
  3783         10  BKIND1A PIC  X(0001).
  3784     05  BKIND1I PIC  X(0002).
  3785*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  73
* EL6311.cbl
  3786     05  BTYPE1L PIC S9(0004) COMP.
  3787     05  BTYPE1F PIC  X(0001).
  3788     05  FILLER REDEFINES BTYPE1F.
  3789         10  BTYPE1A PIC  X(0001).
  3790     05  BTYPE1I PIC  X(0003).
  3791*    -------------------------------
  3792     05  BTERM1L PIC S9(0004) COMP.
  3793     05  BTERM1F PIC  X(0001).
  3794     05  FILLER REDEFINES BTERM1F.
  3795         10  BTERM1A PIC  X(0001).
  3796     05  BTERM1I PIC  X(0003).
  3797*    -------------------------------
  3798     05  BBEN1L PIC S9(0004) COMP.
  3799     05  BBEN1F PIC  X(0001).
  3800     05  FILLER REDEFINES BBEN1F.
  3801         10  BBEN1A PIC  X(0001).
  3802     05  BBEN1I PIC  X(0012).
  3803*    -------------------------------
  3804     05  BPREM1L PIC S9(0004) COMP.
  3805     05  BPREM1F PIC  X(0001).
  3806     05  FILLER REDEFINES BPREM1F.
  3807         10  BPREM1A PIC  X(0001).
  3808     05  BPREM1I PIC  X(0011).
  3809*    -------------------------------
  3810     05  BEXPIR1L PIC S9(0004) COMP.
  3811     05  BEXPIR1F PIC  X(0001).
  3812     05  FILLER REDEFINES BEXPIR1F.
  3813         10  BEXPIR1A PIC  X(0001).
  3814     05  BEXPIR1I PIC  X(0008).
  3815*    -------------------------------
  3816     05  BCP1L PIC S9(0004) COMP.
  3817     05  BCP1F PIC  X(0001).
  3818     05  FILLER REDEFINES BCP1F.
  3819         10  BCP1A PIC  X(0001).
  3820     05  BCP1I PIC  X(0002).
  3821*    -------------------------------
  3822     05  BALTBN1L PIC S9(0004) COMP.
  3823     05  BALTBN1F PIC  X(0001).
  3824     05  FILLER REDEFINES BALTBN1F.
  3825         10  BALTBN1A PIC  X(0001).
  3826     05  BALTBN1I PIC  X(0012).
  3827*    -------------------------------
  3828     05  BALTPR1L PIC S9(0004) COMP.
  3829     05  BALTPR1F PIC  X(0001).
  3830     05  FILLER REDEFINES BALTPR1F.
  3831         10  BALTPR1A PIC  X(0001).
  3832     05  BALTPR1I PIC  X(0011).
  3833*    -------------------------------
  3834     05  BBNCD1L PIC S9(0004) COMP.
  3835     05  BBNCD1F PIC  X(0001).
  3836     05  FILLER REDEFINES BBNCD1F.
  3837         10  BBNCD1A PIC  X(0001).
  3838     05  BBNCD1I PIC  X(0003).
  3839*    -------------------------------
  3840     05  BCPRM1L PIC S9(0004) COMP.
  3841     05  BCPRM1F PIC  X(0001).
  3842     05  FILLER REDEFINES BCPRM1F.
  3843         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  74
* EL6311.cbl
  3844     05  BCPRM1I PIC  X(0011).
  3845*    -------------------------------
  3846     05  BCAPRM1L PIC S9(0004) COMP.
  3847     05  BCAPRM1F PIC  X(0001).
  3848     05  FILLER REDEFINES BCAPRM1F.
  3849         10  BCAPRM1A PIC  X(0001).
  3850     05  BCAPRM1I PIC  X(0011).
  3851*    -------------------------------
  3852     05  BENABR1L PIC S9(0004) COMP.
  3853     05  BENABR1F PIC  X(0001).
  3854     05  FILLER REDEFINES BENABR1F.
  3855         10  BENABR1A PIC  X(0001).
  3856     05  BENABR1I PIC  X(0005).
  3857*    -------------------------------
  3858     05  BDIFF1L PIC S9(0004) COMP.
  3859     05  BDIFF1F PIC  X(0001).
  3860     05  FILLER REDEFINES BDIFF1F.
  3861         10  BDIFF1A PIC  X(0001).
  3862     05  BDIFF1I PIC  X(0011).
  3863*    -------------------------------
  3864     05  BBILIT1L PIC S9(0004) COMP.
  3865     05  BBILIT1F PIC  X(0001).
  3866     05  FILLER REDEFINES BBILIT1F.
  3867         10  BBILIT1A PIC  X(0001).
  3868     05  BBILIT1I PIC  X(0008).
  3869*    -------------------------------
  3870     05  BADIFF1L PIC S9(0004) COMP.
  3871     05  BADIFF1F PIC  X(0001).
  3872     05  FILLER REDEFINES BADIFF1F.
  3873         10  BADIFF1A PIC  X(0001).
  3874     05  BADIFF1I PIC  X(0011).
  3875*    -------------------------------
  3876     05  BKIND2L PIC S9(0004) COMP.
  3877     05  BKIND2F PIC  X(0001).
  3878     05  FILLER REDEFINES BKIND2F.
  3879         10  BKIND2A PIC  X(0001).
  3880     05  BKIND2I PIC  X(0002).
  3881*    -------------------------------
  3882     05  BTYPE2L PIC S9(0004) COMP.
  3883     05  BTYPE2F PIC  X(0001).
  3884     05  FILLER REDEFINES BTYPE2F.
  3885         10  BTYPE2A PIC  X(0001).
  3886     05  BTYPE2I PIC  X(0003).
  3887*    -------------------------------
  3888     05  BTERM2L PIC S9(0004) COMP.
  3889     05  BTERM2F PIC  X(0001).
  3890     05  FILLER REDEFINES BTERM2F.
  3891         10  BTERM2A PIC  X(0001).
  3892     05  BTERM2I PIC  X(0003).
  3893*    -------------------------------
  3894     05  BBEN2L PIC S9(0004) COMP.
  3895     05  BBEN2F PIC  X(0001).
  3896     05  FILLER REDEFINES BBEN2F.
  3897         10  BBEN2A PIC  X(0001).
  3898     05  BBEN2I PIC  X(0012).
  3899*    -------------------------------
  3900     05  BPREM2L PIC S9(0004) COMP.
  3901     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  75
* EL6311.cbl
  3902     05  FILLER REDEFINES BPREM2F.
  3903         10  BPREM2A PIC  X(0001).
  3904     05  BPREM2I PIC  X(0011).
  3905*    -------------------------------
  3906     05  BEXPIR2L PIC S9(0004) COMP.
  3907     05  BEXPIR2F PIC  X(0001).
  3908     05  FILLER REDEFINES BEXPIR2F.
  3909         10  BEXPIR2A PIC  X(0001).
  3910     05  BEXPIR2I PIC  X(0008).
  3911*    -------------------------------
  3912     05  BCP2L PIC S9(0004) COMP.
  3913     05  BCP2F PIC  X(0001).
  3914     05  FILLER REDEFINES BCP2F.
  3915         10  BCP2A PIC  X(0001).
  3916     05  BCP2I PIC  X(0002).
  3917*    -------------------------------
  3918     05  BALTBN2L PIC S9(0004) COMP.
  3919     05  BALTBN2F PIC  X(0001).
  3920     05  FILLER REDEFINES BALTBN2F.
  3921         10  BALTBN2A PIC  X(0001).
  3922     05  BALTBN2I PIC  X(0012).
  3923*    -------------------------------
  3924     05  BALTPR2L PIC S9(0004) COMP.
  3925     05  BALTPR2F PIC  X(0001).
  3926     05  FILLER REDEFINES BALTPR2F.
  3927         10  BALTPR2A PIC  X(0001).
  3928     05  BALTPR2I PIC  X(0011).
  3929*    -------------------------------
  3930     05  BBNCD2L PIC S9(0004) COMP.
  3931     05  BBNCD2F PIC  X(0001).
  3932     05  FILLER REDEFINES BBNCD2F.
  3933         10  BBNCD2A PIC  X(0001).
  3934     05  BBNCD2I PIC  X(0003).
  3935*    -------------------------------
  3936     05  BCPRM2L PIC S9(0004) COMP.
  3937     05  BCPRM2F PIC  X(0001).
  3938     05  FILLER REDEFINES BCPRM2F.
  3939         10  BCPRM2A PIC  X(0001).
  3940     05  BCPRM2I PIC  X(0011).
  3941*    -------------------------------
  3942     05  BCAPRM2L PIC S9(0004) COMP.
  3943     05  BCAPRM2F PIC  X(0001).
  3944     05  FILLER REDEFINES BCAPRM2F.
  3945         10  BCAPRM2A PIC  X(0001).
  3946     05  BCAPRM2I PIC  X(0011).
  3947*    -------------------------------
  3948     05  BENABR2L PIC S9(0004) COMP.
  3949     05  BENABR2F PIC  X(0001).
  3950     05  FILLER REDEFINES BENABR2F.
  3951         10  BENABR2A PIC  X(0001).
  3952     05  BENABR2I PIC  X(0005).
  3953*    -------------------------------
  3954     05  BDIFF2L PIC S9(0004) COMP.
  3955     05  BDIFF2F PIC  X(0001).
  3956     05  FILLER REDEFINES BDIFF2F.
  3957         10  BDIFF2A PIC  X(0001).
  3958     05  BDIFF2I PIC  X(0011).
  3959*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  76
* EL6311.cbl
  3960     05  BBILIT2L PIC S9(0004) COMP.
  3961     05  BBILIT2F PIC  X(0001).
  3962     05  FILLER REDEFINES BBILIT2F.
  3963         10  BBILIT2A PIC  X(0001).
  3964     05  BBILIT2I PIC  X(0008).
  3965*    -------------------------------
  3966     05  BADIFF2L PIC S9(0004) COMP.
  3967     05  BADIFF2F PIC  X(0001).
  3968     05  FILLER REDEFINES BADIFF2F.
  3969         10  BADIFF2A PIC  X(0001).
  3970     05  BADIFF2I PIC  X(0011).
  3971*    -------------------------------
  3972     05  BERMSG1L PIC S9(0004) COMP.
  3973     05  BERMSG1F PIC  X(0001).
  3974     05  FILLER REDEFINES BERMSG1F.
  3975         10  BERMSG1A PIC  X(0001).
  3976     05  BERMSG1I PIC  X(0078).
  3977*    -------------------------------
  3978     05  BERMSG2L PIC S9(0004) COMP.
  3979     05  BERMSG2F PIC  X(0001).
  3980     05  FILLER REDEFINES BERMSG2F.
  3981         10  BERMSG2A PIC  X(0001).
  3982     05  BERMSG2I PIC  X(0078).
  3983*    -------------------------------
  3984     05  BERMSG3L PIC S9(0004) COMP.
  3985     05  BERMSG3F PIC  X(0001).
  3986     05  FILLER REDEFINES BERMSG3F.
  3987         10  BERMSG3A PIC  X(0001).
  3988     05  BERMSG3I PIC  X(0078).
  3989*    -------------------------------
  3990     05  BPFENTRL PIC S9(0004) COMP.
  3991     05  BPFENTRF PIC  X(0001).
  3992     05  FILLER REDEFINES BPFENTRF.
  3993         10  BPFENTRA PIC  X(0001).
  3994     05  BPFENTRI PIC  9(2).
  3995*    -------------------------------
  3996     05  BPF5HDRL PIC S9(0004) COMP.
  3997     05  BPF5HDRF PIC  X(0001).
  3998     05  FILLER REDEFINES BPF5HDRF.
  3999         10  BPF5HDRA PIC  X(0001).
  4000     05  BPF5HDRI PIC  X(0005).
  4001*    -------------------------------
  4002     05  BPF4HDRL PIC S9(0004) COMP.
  4003     05  BPF4HDRF PIC  X(0001).
  4004     05  FILLER REDEFINES BPF4HDRF.
  4005         10  BPF4HDRA PIC  X(0001).
  4006     05  BPF4HDRI PIC  X(0013).
  4007*    -------------------------------
  4008     05  BF15HDRL PIC S9(0004) COMP.
  4009     05  BF15HDRF PIC  X(0001).
  4010     05  FILLER REDEFINES BF15HDRF.
  4011         10  BF15HDRA PIC  X(0001).
  4012     05  BF15HDRI PIC  X(0010).
  4013 01  EL631BO REDEFINES EL631BI.
  4014     05  FILLER            PIC  X(0012).
  4015*    -------------------------------
  4016     05  FILLER            PIC  X(0003).
  4017     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  77
* EL6311.cbl
  4018*    -------------------------------
  4019     05  FILLER            PIC  X(0003).
  4020     05  BTIMEO PIC  99.99.
  4021*    -------------------------------
  4022     05  FILLER            PIC  X(0003).
  4023     05  BHEADO PIC  X(0038).
  4024*    -------------------------------
  4025     05  FILLER            PIC  X(0003).
  4026     05  BNCERTLO PIC  X(0008).
  4027*    -------------------------------
  4028     05  FILLER            PIC  X(0003).
  4029     05  BNCERTO PIC  X(0011).
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BNSTATLO PIC  X(0009).
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  BNSTATO PIC  X(0002).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BCHGTO PIC  X(0004).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BCHGO PIC  ZZZ9.
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BCOMPIDO PIC  X(0003).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BREGIONO PIC  X(0006).
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  BUSERO PIC  X(0004).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BMAINTO PIC  X(0001).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BMANTBYO PIC  X(0004).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BCHGHDGO PIC  X(0003).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BMANTDTO PIC  X(0008).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BMANTATO PIC  99.99.
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BCSRO PIC  X(0004).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BBATCHO PIC  X(0006).
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BSEQO PIC  X(0004).
  4075*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  78
* EL6311.cbl
  4076     05  FILLER            PIC  X(0003).
  4077     05  BMOENDTO PIC  X(0008).
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BCARRO PIC  X(0001).
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  BGROUPO PIC  X(0006).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  BSTATEO PIC  X(0002).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BACCTO PIC  X(0010).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
  4092     05  BVINHO PIC  X(0004).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BVINO PIC  X(0017).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BREFHDGO PIC  X(0004).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BREFO PIC  X(0012).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BAGEDEFO PIC  X(0004).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BCERTNOO PIC  X(0010).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BSUFIXO PIC  X(0001).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BEFFDTO PIC  X(0008).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BLSTNMO PIC  X(0015).
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  B1STNMO PIC  X(0010).
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BINITO PIC  X(0001).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BSEXO PIC  X(0001).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BAGEO PIC  X(0002).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  BBIRTHO PIC  X(0008).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  79
* EL6311.cbl
  4134     05  B1STPMTO PIC  X(0008).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BDAYSO PIC  X(0003).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BLNTRMO PIC  X(0003).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BLNOFCRO PIC  X(0005).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BMODEO PIC  X(0001).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BFREQO PIC  X(0002).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BPMTSO PIC  X(0003).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BPMTAMTO PIC  ZZZZZ9.99.
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BAPRO PIC  99.9999.
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BMEMCAPO PIC  X(0011).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BORIGHDO PIC  X(0009).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  DMDBILO PIC  X(0006).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BFORCEO PIC  X(0001).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BENTRYO PIC  X(0001).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BREINO PIC  X(0001).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BBILCDO PIC  X(0001).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BUNWRITO PIC  X(0001).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BSKPCDO PIC  X(0001).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  80
* EL6311.cbl
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BSIGO PIC  X(0001).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BRTCLSO PIC  X(0002).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BCHGCNTO PIC  X(0003).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BMEMBERO PIC  X(0012).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BORGNOO PIC  X(0006).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BORGSEQO PIC  X(0004).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BKIND1O PIC  X(0002).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BTYPE1O PIC  X(0003).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BTERM1O PIC  X(0003).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BBEN1O PIC  X(0012).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BPREM1O PIC  X(0011).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BEXPIR1O PIC  X(0008).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BCP1O PIC  X(0002).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BALTBN1O PIC  X(0012).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BALTPR1O PIC  X(0011).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BBNCD1O PIC  X(0003).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BCPRM1O PIC  X(0011).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BCAPRM1O PIC  X(0011).
  4249*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  81
* EL6311.cbl
  4250     05  FILLER            PIC  X(0003).
  4251     05  BENABR1O PIC  X(0005).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BDIFF1O PIC  X(0011).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BBILIT1O PIC  X(0008).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BADIFF1O PIC  X(0011).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BKIND2O PIC  X(0002).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BTYPE2O PIC  X(0003).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BTERM2O PIC  X(0003).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BBEN2O PIC  X(0012).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BPREM2O PIC  X(0011).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BEXPIR2O PIC  X(0008).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BCP2O PIC  X(0002).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BALTBN2O PIC  X(0012).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BALTPR2O PIC  X(0011).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BBNCD2O PIC  X(0003).
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BCPRM2O PIC  X(0011).
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BCAPRM2O PIC  X(0011).
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BENABR2O PIC  X(0005).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BDIFF2O PIC  X(0011).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  BBILIT2O PIC  X(0008).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  82
* EL6311.cbl
  4308     05  BADIFF2O PIC  X(0011).
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BERMSG1O PIC  X(0078).
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  BERMSG2O PIC  X(0078).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BERMSG3O PIC  X(0078).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  BPFENTRO PIC  X(0002).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  BPF5HDRO PIC  X(0005).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BPF4HDRO PIC  X(0013).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BF15HDRO PIC  X(0010).
  4330*    -------------------------------
  4331 01  EL631CI REDEFINES EL631BI.
  4332     05  FILLER            PIC  X(0012).
  4333*    -------------------------------
  4334     05  CDATEL PIC S9(0004) COMP.
  4335     05  CDATEF PIC  X(0001).
  4336     05  FILLER REDEFINES CDATEF.
  4337         10  CDATEA PIC  X(0001).
  4338     05  CDATEI PIC  X(0008).
  4339*    -------------------------------
  4340     05  CTIMEL PIC S9(0004) COMP.
  4341     05  CTIMEF PIC  X(0001).
  4342     05  FILLER REDEFINES CTIMEF.
  4343         10  CTIMEA PIC  X(0001).
  4344     05  CTIMEI PIC  X(0005).
  4345*    -------------------------------
  4346     05  CHEADL PIC S9(0004) COMP.
  4347     05  CHEADF PIC  X(0001).
  4348     05  FILLER REDEFINES CHEADF.
  4349         10  CHEADA PIC  X(0001).
  4350     05  CHEADI PIC  X(0038).
  4351*    -------------------------------
  4352     05  CCHGTL PIC S9(0004) COMP.
  4353     05  CCHGTF PIC  X(0001).
  4354     05  FILLER REDEFINES CCHGTF.
  4355         10  CCHGTA PIC  X(0001).
  4356     05  CCHGTI PIC  X(0004).
  4357*    -------------------------------
  4358     05  CCHGL PIC S9(0004) COMP.
  4359     05  CCHGF PIC  X(0001).
  4360     05  FILLER REDEFINES CCHGF.
  4361         10  CCHGA PIC  X(0001).
  4362     05  CCHGI PIC  X(0004).
  4363*    -------------------------------
  4364     05  CMAINTL PIC S9(0004) COMP.
  4365     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  83
* EL6311.cbl
  4366     05  FILLER REDEFINES CMAINTF.
  4367         10  CMAINTA PIC  X(0001).
  4368     05  CMAINTI PIC  X(0001).
  4369*    -------------------------------
  4370     05  CMANTBYL PIC S9(0004) COMP.
  4371     05  CMANTBYF PIC  X(0001).
  4372     05  FILLER REDEFINES CMANTBYF.
  4373         10  CMANTBYA PIC  X(0001).
  4374     05  CMANTBYI PIC  X(0004).
  4375*    -------------------------------
  4376     05  CCHGHDGL PIC S9(0004) COMP.
  4377     05  CCHGHDGF PIC  X(0001).
  4378     05  FILLER REDEFINES CCHGHDGF.
  4379         10  CCHGHDGA PIC  X(0001).
  4380     05  CCHGHDGI PIC  X(0003).
  4381*    -------------------------------
  4382     05  CMANTDTL PIC S9(0004) COMP.
  4383     05  CMANTDTF PIC  X(0001).
  4384     05  FILLER REDEFINES CMANTDTF.
  4385         10  CMANTDTA PIC  X(0001).
  4386     05  CMANTDTI PIC  X(0008).
  4387*    -------------------------------
  4388     05  CMANTATL PIC S9(0004) COMP.
  4389     05  CMANTATF PIC  X(0001).
  4390     05  FILLER REDEFINES CMANTATF.
  4391         10  CMANTATA PIC  X(0001).
  4392     05  CMANTATI PIC  X(0005).
  4393*    -------------------------------
  4394     05  CCSRL PIC S9(0004) COMP.
  4395     05  CCSRF PIC  X(0001).
  4396     05  FILLER REDEFINES CCSRF.
  4397         10  CCSRA PIC  X(0001).
  4398     05  CCSRI PIC  X(0004).
  4399*    -------------------------------
  4400     05  CBATCHL PIC S9(0004) COMP.
  4401     05  CBATCHF PIC  X(0001).
  4402     05  FILLER REDEFINES CBATCHF.
  4403         10  CBATCHA PIC  X(0001).
  4404     05  CBATCHI PIC  X(0006).
  4405*    -------------------------------
  4406     05  CSEQL PIC S9(0004) COMP.
  4407     05  CSEQF PIC  X(0001).
  4408     05  FILLER REDEFINES CSEQF.
  4409         10  CSEQA PIC  X(0001).
  4410     05  CSEQI PIC  X(0004).
  4411*    -------------------------------
  4412     05  CMOENDTL PIC S9(0004) COMP.
  4413     05  CMOENDTF PIC  X(0001).
  4414     05  FILLER REDEFINES CMOENDTF.
  4415         10  CMOENDTA PIC  X(0001).
  4416     05  CMOENDTI PIC  X(0008).
  4417*    -------------------------------
  4418     05  CCARRL PIC S9(0004) COMP.
  4419     05  CCARRF PIC  X(0001).
  4420     05  FILLER REDEFINES CCARRF.
  4421         10  CCARRA PIC  X(0001).
  4422     05  CCARRI PIC  X(0001).
  4423*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  84
* EL6311.cbl
  4424     05  CGROUPL PIC S9(0004) COMP.
  4425     05  CGROUPF PIC  X(0001).
  4426     05  FILLER REDEFINES CGROUPF.
  4427         10  CGROUPA PIC  X(0001).
  4428     05  CGROUPI PIC  X(0006).
  4429*    -------------------------------
  4430     05  CSTATEL PIC S9(0004) COMP.
  4431     05  CSTATEF PIC  X(0001).
  4432     05  FILLER REDEFINES CSTATEF.
  4433         10  CSTATEA PIC  X(0001).
  4434     05  CSTATEI PIC  X(0002).
  4435*    -------------------------------
  4436     05  CACCTL PIC S9(0004) COMP.
  4437     05  CACCTF PIC  X(0001).
  4438     05  FILLER REDEFINES CACCTF.
  4439         10  CACCTA PIC  X(0001).
  4440     05  CACCTI PIC  X(0010).
  4441*    -------------------------------
  4442     05  CORIGHDL PIC S9(0004) COMP.
  4443     05  CORIGHDF PIC  X(0001).
  4444     05  FILLER REDEFINES CORIGHDF.
  4445         10  CORIGHDA PIC  X(0001).
  4446     05  CORIGHDI PIC  X(0011).
  4447*    -------------------------------
  4448     05  CORGNOL PIC S9(0004) COMP.
  4449     05  CORGNOF PIC  X(0001).
  4450     05  FILLER REDEFINES CORGNOF.
  4451         10  CORGNOA PIC  X(0001).
  4452     05  CORGNOI PIC  X(0006).
  4453*    -------------------------------
  4454     05  CORGSEQL PIC S9(0004) COMP.
  4455     05  CORGSEQF PIC  X(0001).
  4456     05  FILLER REDEFINES CORGSEQF.
  4457         10  CORGSEQA PIC  X(0001).
  4458     05  CORGSEQI PIC  X(0004).
  4459*    -------------------------------
  4460     05  CREFHDGL PIC S9(0004) COMP.
  4461     05  CREFHDGF PIC  X(0001).
  4462     05  FILLER REDEFINES CREFHDGF.
  4463         10  CREFHDGA PIC  X(0001).
  4464     05  CREFHDGI PIC  X(0010).
  4465*    -------------------------------
  4466     05  CREFL PIC S9(0004) COMP.
  4467     05  CREFF PIC  X(0001).
  4468     05  FILLER REDEFINES CREFF.
  4469         10  CREFA PIC  X(0001).
  4470     05  CREFI PIC  X(0012).
  4471*    -------------------------------
  4472     05  CNHINTL PIC S9(0004) COMP.
  4473     05  CNHINTF PIC  X(0001).
  4474     05  FILLER REDEFINES CNHINTF.
  4475         10  CNHINTA PIC  X(0001).
  4476     05  CNHINTI PIC  9(7)V99.
  4477*    -------------------------------
  4478     05  CCERTNOL PIC S9(0004) COMP.
  4479     05  CCERTNOF PIC  X(0001).
  4480     05  FILLER REDEFINES CCERTNOF.
  4481         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  85
* EL6311.cbl
  4482     05  CCERTNOI PIC  X(0010).
  4483*    -------------------------------
  4484     05  CSUFIXL PIC S9(0004) COMP.
  4485     05  CSUFIXF PIC  X(0001).
  4486     05  FILLER REDEFINES CSUFIXF.
  4487         10  CSUFIXA PIC  X(0001).
  4488     05  CSUFIXI PIC  X(0001).
  4489*    -------------------------------
  4490     05  CEFFDTL PIC S9(0004) COMP.
  4491     05  CEFFDTF PIC  X(0001).
  4492     05  FILLER REDEFINES CEFFDTF.
  4493         10  CEFFDTA PIC  X(0001).
  4494     05  CEFFDTI PIC  X(0008).
  4495*    -------------------------------
  4496     05  CLSTNML PIC S9(0004) COMP.
  4497     05  CLSTNMF PIC  X(0001).
  4498     05  FILLER REDEFINES CLSTNMF.
  4499         10  CLSTNMA PIC  X(0001).
  4500     05  CLSTNMI PIC  X(0015).
  4501*    -------------------------------
  4502     05  CPCYNL PIC S9(0004) COMP.
  4503     05  CPCYNF PIC  X(0001).
  4504     05  FILLER REDEFINES CPCYNF.
  4505         10  CPCYNA PIC  X(0001).
  4506     05  CPCYNI PIC  X(0001).
  4507*    -------------------------------
  4508     05  CINAMEL PIC S9(0004) COMP.
  4509     05  CINAMEF PIC  X(0001).
  4510     05  FILLER REDEFINES CINAMEF.
  4511         10  CINAMEA PIC  X(0001).
  4512     05  CINAMEI PIC  X(0015).
  4513*    -------------------------------
  4514     05  CINITSL PIC S9(0004) COMP.
  4515     05  CINITSF PIC  X(0001).
  4516     05  FILLER REDEFINES CINITSF.
  4517         10  CINITSA PIC  X(0001).
  4518     05  CINITSI PIC  X(0010).
  4519*    -------------------------------
  4520     05  CCANREAL PIC S9(0004) COMP.
  4521     05  CCANREAF PIC  X(0001).
  4522     05  FILLER REDEFINES CCANREAF.
  4523         10  CCANREAA PIC  X(0001).
  4524     05  CCANREAI PIC  X(0001).
  4525*    -------------------------------
  4526     05  CKIND1L PIC S9(0004) COMP.
  4527     05  CKIND1F PIC  X(0001).
  4528     05  FILLER REDEFINES CKIND1F.
  4529         10  CKIND1A PIC  X(0001).
  4530     05  CKIND1I PIC  X(0002).
  4531*    -------------------------------
  4532     05  CCANDT1L PIC S9(0004) COMP.
  4533     05  CCANDT1F PIC  X(0001).
  4534     05  FILLER REDEFINES CCANDT1F.
  4535         10  CCANDT1A PIC  X(0001).
  4536     05  CCANDT1I PIC  X(0008).
  4537*    -------------------------------
  4538     05  CREFND1L PIC S9(0004) COMP.
  4539     05  CREFND1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  86
* EL6311.cbl
  4540     05  FILLER REDEFINES CREFND1F.
  4541         10  CREFND1A PIC  X(0001).
  4542     05  CREFND1I PIC  S9(9)V99.
  4543*    -------------------------------
  4544     05  CMTHD1L PIC S9(0004) COMP.
  4545     05  CMTHD1F PIC  X(0001).
  4546     05  FILLER REDEFINES CMTHD1F.
  4547         10  CMTHD1A PIC  X(0001).
  4548     05  CMTHD1I PIC  X(0001).
  4549*    -------------------------------
  4550     05  CKIND2L PIC S9(0004) COMP.
  4551     05  CKIND2F PIC  X(0001).
  4552     05  FILLER REDEFINES CKIND2F.
  4553         10  CKIND2A PIC  X(0001).
  4554     05  CKIND2I PIC  X(0002).
  4555*    -------------------------------
  4556     05  CCANDT2L PIC S9(0004) COMP.
  4557     05  CCANDT2F PIC  X(0001).
  4558     05  FILLER REDEFINES CCANDT2F.
  4559         10  CCANDT2A PIC  X(0001).
  4560     05  CCANDT2I PIC  X(0008).
  4561*    -------------------------------
  4562     05  CREFND2L PIC S9(0004) COMP.
  4563     05  CREFND2F PIC  X(0001).
  4564     05  FILLER REDEFINES CREFND2F.
  4565         10  CREFND2A PIC  X(0001).
  4566     05  CREFND2I PIC  S9(9)V99.
  4567*    -------------------------------
  4568     05  CMTHD2L PIC S9(0004) COMP.
  4569     05  CMTHD2F PIC  X(0001).
  4570     05  FILLER REDEFINES CMTHD2F.
  4571         10  CMTHD2A PIC  X(0001).
  4572     05  CMTHD2I PIC  X(0001).
  4573*    -------------------------------
  4574     05  CLIVESL PIC S9(0004) COMP.
  4575     05  CLIVESF PIC  X(0001).
  4576     05  FILLER REDEFINES CLIVESF.
  4577         10  CLIVESA PIC  X(0001).
  4578     05  CLIVESI PIC  X(0003).
  4579*    -------------------------------
  4580     05  CFORCEL PIC S9(0004) COMP.
  4581     05  CFORCEF PIC  X(0001).
  4582     05  FILLER REDEFINES CFORCEF.
  4583         10  CFORCEA PIC  X(0001).
  4584     05  CFORCEI PIC  X(0001).
  4585*    -------------------------------
  4586     05  CBILCDL PIC S9(0004) COMP.
  4587     05  CBILCDF PIC  X(0001).
  4588     05  FILLER REDEFINES CBILCDF.
  4589         10  CBILCDA PIC  X(0001).
  4590     05  CBILCDI PIC  X(0001).
  4591*    -------------------------------
  4592     05  CCRFND1L PIC S9(0004) COMP.
  4593     05  CCRFND1F PIC  X(0001).
  4594     05  FILLER REDEFINES CCRFND1F.
  4595         10  CCRFND1A PIC  X(0001).
  4596     05  CCRFND1I PIC  X(0011).
  4597*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  87
* EL6311.cbl
  4598     05  CCRFND2L PIC S9(0004) COMP.
  4599     05  CCRFND2F PIC  X(0001).
  4600     05  FILLER REDEFINES CCRFND2F.
  4601         10  CCRFND2A PIC  X(0001).
  4602     05  CCRFND2I PIC  X(0011).
  4603*    -------------------------------
  4604     05  CBILIT1L PIC S9(0004) COMP.
  4605     05  CBILIT1F PIC  X(0001).
  4606     05  FILLER REDEFINES CBILIT1F.
  4607         10  CBILIT1A PIC  X(0001).
  4608     05  CBILIT1I PIC  X(0008).
  4609*    -------------------------------
  4610     05  CDRFND1L PIC S9(0004) COMP.
  4611     05  CDRFND1F PIC  X(0001).
  4612     05  FILLER REDEFINES CDRFND1F.
  4613         10  CDRFND1A PIC  X(0001).
  4614     05  CDRFND1I PIC  X(0011).
  4615*    -------------------------------
  4616     05  CBILIT2L PIC S9(0004) COMP.
  4617     05  CBILIT2F PIC  X(0001).
  4618     05  FILLER REDEFINES CBILIT2F.
  4619         10  CBILIT2A PIC  X(0001).
  4620     05  CBILIT2I PIC  X(0008).
  4621*    -------------------------------
  4622     05  CDRFND2L PIC S9(0004) COMP.
  4623     05  CDRFND2F PIC  X(0001).
  4624     05  FILLER REDEFINES CDRFND2F.
  4625         10  CDRFND2A PIC  X(0001).
  4626     05  CDRFND2I PIC  X(0011).
  4627*    -------------------------------
  4628     05  CCANTXTL PIC S9(0004) COMP.
  4629     05  CCANTXTF PIC  X(0001).
  4630     05  FILLER REDEFINES CCANTXTF.
  4631         10  CCANTXTA PIC  X(0001).
  4632     05  CCANTXTI PIC  X(0005).
  4633*    -------------------------------
  4634     05  CCANFEEL PIC S9(0004) COMP.
  4635     05  CCANFEEF PIC  X(0001).
  4636     05  FILLER REDEFINES CCANFEEF.
  4637         10  CCANFEEA PIC  X(0001).
  4638     05  CCANFEEI PIC  X(0002).
  4639*    -------------------------------
  4640     05  CTERM1L PIC S9(0004) COMP.
  4641     05  CTERM1F PIC  X(0001).
  4642     05  FILLER REDEFINES CTERM1F.
  4643         10  CTERM1A PIC  X(0001).
  4644     05  CTERM1I PIC  X(0003).
  4645*    -------------------------------
  4646     05  CRTERM1L PIC S9(0004) COMP.
  4647     05  CRTERM1F PIC  X(0001).
  4648     05  FILLER REDEFINES CRTERM1F.
  4649         10  CRTERM1A PIC  X(0001).
  4650     05  CRTERM1I PIC  X(0003).
  4651*    -------------------------------
  4652     05  CPREM1L PIC S9(0004) COMP.
  4653     05  CPREM1F PIC  X(0001).
  4654     05  FILLER REDEFINES CPREM1F.
  4655         10  CPREM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  88
* EL6311.cbl
  4656     05  CPREM1I PIC  X(0011).
  4657*    -------------------------------
  4658     05  CTERM2L PIC S9(0004) COMP.
  4659     05  CTERM2F PIC  X(0001).
  4660     05  FILLER REDEFINES CTERM2F.
  4661         10  CTERM2A PIC  X(0001).
  4662     05  CTERM2I PIC  X(0003).
  4663*    -------------------------------
  4664     05  CRTERM2L PIC S9(0004) COMP.
  4665     05  CRTERM2F PIC  X(0001).
  4666     05  FILLER REDEFINES CRTERM2F.
  4667         10  CRTERM2A PIC  X(0001).
  4668     05  CRTERM2I PIC  X(0003).
  4669*    -------------------------------
  4670     05  CPREM2L PIC S9(0004) COMP.
  4671     05  CPREM2F PIC  X(0001).
  4672     05  FILLER REDEFINES CPREM2F.
  4673         10  CPREM2A PIC  X(0001).
  4674     05  CPREM2I PIC  X(0011).
  4675*    -------------------------------
  4676     05  CENTRDTL PIC S9(0004) COMP.
  4677     05  CENTRDTF PIC  X(0001).
  4678     05  FILLER REDEFINES CENTRDTF.
  4679         10  CENTRDTA PIC  X(0001).
  4680     05  CENTRDTI PIC  X(0008).
  4681*    -------------------------------
  4682     05  CPAYEEL PIC S9(0004) COMP.
  4683     05  CPAYEEF PIC  X(0001).
  4684     05  FILLER REDEFINES CPAYEEF.
  4685         10  CPAYEEA PIC  X(0001).
  4686     05  CPAYEEI PIC  X(0006).
  4687*    -------------------------------
  4688     05  CRFNDSWL PIC S9(0004) COMP.
  4689     05  CRFNDSWF PIC  X(0001).
  4690     05  FILLER REDEFINES CRFNDSWF.
  4691         10  CRFNDSWA PIC  X(0001).
  4692     05  CRFNDSWI PIC  X(0003).
  4693*    -------------------------------
  4694     05  CLFHDGL PIC S9(0004) COMP.
  4695     05  CLFHDGF PIC  X(0001).
  4696     05  FILLER REDEFINES CLFHDGF.
  4697         10  CLFHDGA PIC  X(0001).
  4698     05  CLFHDGI PIC  X(0006).
  4699*    -------------------------------
  4700     05  CAHHDGL PIC S9(0004) COMP.
  4701     05  CAHHDGF PIC  X(0001).
  4702     05  FILLER REDEFINES CAHHDGF.
  4703         10  CAHHDGA PIC  X(0001).
  4704     05  CAHHDGI PIC  X(0006).
  4705*    -------------------------------
  4706     05  CENTDTL PIC S9(0004) COMP.
  4707     05  CENTDTF PIC  X(0001).
  4708     05  FILLER REDEFINES CENTDTF.
  4709         10  CENTDTA PIC  X(0001).
  4710     05  CENTDTI PIC  X(0008).
  4711*    -------------------------------
  4712     05  CENTBYL PIC S9(0004) COMP.
  4713     05  CENTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  89
* EL6311.cbl
  4714     05  FILLER REDEFINES CENTBYF.
  4715         10  CENTBYA PIC  X(0001).
  4716     05  CENTBYI PIC  X(0004).
  4717*    -------------------------------
  4718     05  CCHGCNTL PIC S9(0004) COMP.
  4719     05  CCHGCNTF PIC  X(0001).
  4720     05  FILLER REDEFINES CCHGCNTF.
  4721         10  CCHGCNTA PIC  X(0001).
  4722     05  CCHGCNTI PIC  X(0003).
  4723*    -------------------------------
  4724     05  CLFREFNL PIC S9(0004) COMP.
  4725     05  CLFREFNF PIC  X(0001).
  4726     05  FILLER REDEFINES CLFREFNF.
  4727         10  CLFREFNA PIC  X(0001).
  4728     05  CLFREFNI PIC  X(0006).
  4729*    -------------------------------
  4730     05  CAHREFNL PIC S9(0004) COMP.
  4731     05  CAHREFNF PIC  X(0001).
  4732     05  FILLER REDEFINES CAHREFNF.
  4733         10  CAHREFNA PIC  X(0001).
  4734     05  CAHREFNI PIC  X(0006).
  4735*    -------------------------------
  4736     05  CREINCDL PIC S9(0004) COMP.
  4737     05  CREINCDF PIC  X(0001).
  4738     05  FILLER REDEFINES CREINCDF.
  4739         10  CREINCDA PIC  X(0001).
  4740     05  CREINCDI PIC  X(0003).
  4741*    -------------------------------
  4742     05  CAEFFDTL PIC S9(0004) COMP.
  4743     05  CAEFFDTF PIC  X(0001).
  4744     05  FILLER REDEFINES CAEFFDTF.
  4745         10  CAEFFDTA PIC  X(0001).
  4746     05  CAEFFDTI PIC  X(0008).
  4747*    -------------------------------
  4748     05  CAEXPDTL PIC S9(0004) COMP.
  4749     05  CAEXPDTF PIC  X(0001).
  4750     05  FILLER REDEFINES CAEXPDTF.
  4751         10  CAEXPDTA PIC  X(0001).
  4752     05  CAEXPDTI PIC  X(0008).
  4753*    -------------------------------
  4754     05  COMMLFL PIC S9(0004) COMP.
  4755     05  COMMLFF PIC  X(0001).
  4756     05  FILLER REDEFINES COMMLFF.
  4757         10  COMMLFA PIC  X(0001).
  4758     05  COMMLFI PIC  X(0006).
  4759*    -------------------------------
  4760     05  COMMAHL PIC S9(0004) COMP.
  4761     05  COMMAHF PIC  X(0001).
  4762     05  FILLER REDEFINES COMMAHF.
  4763         10  COMMAHA PIC  X(0001).
  4764     05  COMMAHI PIC  X(0006).
  4765*    -------------------------------
  4766     05  CERMSG1L PIC S9(0004) COMP.
  4767     05  CERMSG1F PIC  X(0001).
  4768     05  FILLER REDEFINES CERMSG1F.
  4769         10  CERMSG1A PIC  X(0001).
  4770     05  CERMSG1I PIC  X(0078).
  4771*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  90
* EL6311.cbl
  4772     05  CERMSG2L PIC S9(0004) COMP.
  4773     05  CERMSG2F PIC  X(0001).
  4774     05  FILLER REDEFINES CERMSG2F.
  4775         10  CERMSG2A PIC  X(0001).
  4776     05  CERMSG2I PIC  X(0078).
  4777*    -------------------------------
  4778     05  CERMSG3L PIC S9(0004) COMP.
  4779     05  CERMSG3F PIC  X(0001).
  4780     05  FILLER REDEFINES CERMSG3F.
  4781         10  CERMSG3A PIC  X(0001).
  4782     05  CERMSG3I PIC  X(0078).
  4783*    -------------------------------
  4784     05  CPFENTRL PIC S9(0004) COMP.
  4785     05  CPFENTRF PIC  X(0001).
  4786     05  FILLER REDEFINES CPFENTRF.
  4787         10  CPFENTRA PIC  X(0001).
  4788     05  CPFENTRI PIC  9(2).
  4789*    -------------------------------
  4790     05  CPF5HDRL PIC S9(0004) COMP.
  4791     05  CPF5HDRF PIC  X(0001).
  4792     05  FILLER REDEFINES CPF5HDRF.
  4793         10  CPF5HDRA PIC  X(0001).
  4794     05  CPF5HDRI PIC  X(0005).
  4795*    -------------------------------
  4796     05  CPF4HDRL PIC S9(0004) COMP.
  4797     05  CPF4HDRF PIC  X(0001).
  4798     05  FILLER REDEFINES CPF4HDRF.
  4799         10  CPF4HDRA PIC  X(0001).
  4800     05  CPF4HDRI PIC  X(0013).
  4801*    -------------------------------
  4802     05  CF15HDRL PIC S9(0004) COMP.
  4803     05  CF15HDRF PIC  X(0001).
  4804     05  FILLER REDEFINES CF15HDRF.
  4805         10  CF15HDRA PIC  X(0001).
  4806     05  CF15HDRI PIC  X(0022).
  4807 01  EL631CO REDEFINES EL631BI.
  4808     05  FILLER            PIC  X(0012).
  4809*    -------------------------------
  4810     05  FILLER            PIC  X(0003).
  4811     05  CDATEO PIC  X(0008).
  4812*    -------------------------------
  4813     05  FILLER            PIC  X(0003).
  4814     05  CTIMEO PIC  99.99.
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  CHEADO PIC  X(0038).
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  CCHGTO PIC  X(0004).
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CCHGO PIC  ZZZ9.
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CMAINTO PIC  X(0001).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CMANTBYO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  91
* EL6311.cbl
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CCHGHDGO PIC  X(0003).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CMANTDTO PIC  X(0008).
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CMANTATO PIC  99.99.
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CCSRO PIC  X(0004).
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CBATCHO PIC  X(0006).
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CSEQO PIC  X(0004).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CMOENDTO PIC  X(0008).
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CCARRO PIC  X(0001).
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CGROUPO PIC  X(0006).
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CSTATEO PIC  X(0002).
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CACCTO PIC  X(0010).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CORIGHDO PIC  X(0011).
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CORGNOO PIC  X(0006).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CORGSEQO PIC  X(0004).
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CREFHDGO PIC  X(0010).
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CREFO PIC  X(0012).
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CNHINTO PIC  999999.99.
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CCERTNOO PIC  X(0010).
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CSUFIXO PIC  X(0001).
  4887*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  92
* EL6311.cbl
  4888     05  FILLER            PIC  X(0003).
  4889     05  CEFFDTO PIC  X(0008).
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CLSTNMO PIC  X(0015).
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CPCYNO PIC  X(0001).
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CINAMEO PIC  X(0015).
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CINITSO PIC  X(0010).
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  CCANREAO PIC  X(0001).
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CKIND1O PIC  X(0002).
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CCANDT1O PIC  X(0008).
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CREFND1O PIC  Z(7).99-.
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CMTHD1O PIC  X(0001).
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CKIND2O PIC  X(0002).
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CCANDT2O PIC  X(0008).
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CREFND2O PIC  Z(7).99-.
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CMTHD2O PIC  X(0001).
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CLIVESO PIC  X(0003).
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CFORCEO PIC  X(0001).
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CBILCDO PIC  X(0001).
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CCRFND1O PIC  Z(7).99-.
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CCRFND2O PIC  Z(7).99-.
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  93
* EL6311.cbl
  4946     05  CBILIT1O PIC  X(0008).
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CDRFND1O PIC  Z(7).99-.
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CBILIT2O PIC  X(0008).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CDRFND2O PIC  Z(7).99-.
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CCANTXTO PIC  X(0005).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CCANFEEO PIC  Z9.
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CTERM1O PIC  ZZ9.
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CRTERM1O PIC  ZZ9.
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CPREM1O PIC  ZZZZZZ9.99-.
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CTERM2O PIC  ZZ9.
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CRTERM2O PIC  ZZ9.
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CPREM2O PIC  ZZZZZZ9.99-.
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CENTRDTO PIC  X(0008).
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CPAYEEO PIC  X(0006).
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CRFNDSWO PIC  X(0003).
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CLFHDGO PIC  X(0006).
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CAHHDGO PIC  X(0006).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CENTDTO PIC  X(0008).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CENTBYO PIC  X(0004).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CCHGCNTO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  94
* EL6311.cbl
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CLFREFNO PIC  X(0006).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CAHREFNO PIC  X(0006).
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CREINCDO PIC  X(0003).
  5013*    -------------------------------
  5014     05  FILLER            PIC  X(0003).
  5015     05  CAEFFDTO PIC  X(0008).
  5016*    -------------------------------
  5017     05  FILLER            PIC  X(0003).
  5018     05  CAEXPDTO PIC  X(0008).
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  COMMLFO PIC  .99999.
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  COMMAHO PIC  .99999.
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  CERMSG1O PIC  X(0078).
  5028*    -------------------------------
  5029     05  FILLER            PIC  X(0003).
  5030     05  CERMSG2O PIC  X(0078).
  5031*    -------------------------------
  5032     05  FILLER            PIC  X(0003).
  5033     05  CERMSG3O PIC  X(0078).
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  CPFENTRO PIC  X(0002).
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  CPF5HDRO PIC  X(0005).
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  CPF4HDRO PIC  X(0013).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CF15HDRO PIC  X(0022).
  5046*    -------------------------------
  5047 01  EL631DI REDEFINES EL631BI.
  5048     05  FILLER            PIC  X(0012).
  5049*    -------------------------------
  5050     05  DDATEL PIC S9(0004) COMP.
  5051     05  DDATEF PIC  X(0001).
  5052     05  FILLER REDEFINES DDATEF.
  5053         10  DDATEA PIC  X(0001).
  5054     05  DDATEI PIC  X(0008).
  5055*    -------------------------------
  5056     05  DTIMEL PIC S9(0004) COMP.
  5057     05  DTIMEF PIC  X(0001).
  5058     05  FILLER REDEFINES DTIMEF.
  5059         10  DTIMEA PIC  X(0001).
  5060     05  DTIMEI PIC  X(0005).
  5061*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  95
* EL6311.cbl
  5062     05  DHEADL PIC S9(0004) COMP.
  5063     05  DHEADF PIC  X(0001).
  5064     05  FILLER REDEFINES DHEADF.
  5065         10  DHEADA PIC  X(0001).
  5066     05  DHEADI PIC  X(0038).
  5067*    -------------------------------
  5068     05  DLDATEL PIC S9(0004) COMP.
  5069     05  DLDATEF PIC  X(0001).
  5070     05  FILLER REDEFINES DLDATEF.
  5071         10  DLDATEA PIC  X(0001).
  5072     05  DLDATEI PIC  X(0010).
  5073*    -------------------------------
  5074     05  DBATCHL PIC S9(0004) COMP.
  5075     05  DBATCHF PIC  X(0001).
  5076     05  FILLER REDEFINES DBATCHF.
  5077         10  DBATCHA PIC  X(0001).
  5078     05  DBATCHI PIC  X(0011).
  5079*    -------------------------------
  5080     05  DACCTNML PIC S9(0004) COMP.
  5081     05  DACCTNMF PIC  X(0001).
  5082     05  FILLER REDEFINES DACCTNMF.
  5083         10  DACCTNMA PIC  X(0001).
  5084     05  DACCTNMI PIC  X(0030).
  5085*    -------------------------------
  5086     05  DPROCDTL PIC S9(0004) COMP.
  5087     05  DPROCDTF PIC  X(0001).
  5088     05  FILLER REDEFINES DPROCDTF.
  5089         10  DPROCDTA PIC  X(0001).
  5090     05  DPROCDTI PIC  X(0008).
  5091*    -------------------------------
  5092     05  DINPUTL PIC S9(0004) COMP.
  5093     05  DINPUTF PIC  X(0001).
  5094     05  FILLER REDEFINES DINPUTF.
  5095         10  DINPUTA PIC  X(0001).
  5096     05  DINPUTI PIC  X(0008).
  5097*    -------------------------------
  5098     05  DMAINDTL PIC S9(0004) COMP.
  5099     05  DMAINDTF PIC  X(0001).
  5100     05  FILLER REDEFINES DMAINDTF.
  5101         10  DMAINDTA PIC  X(0001).
  5102     05  DMAINDTI PIC  X(0008).
  5103*    -------------------------------
  5104     05  DCARRL PIC S9(0004) COMP.
  5105     05  DCARRF PIC  X(0001).
  5106     05  FILLER REDEFINES DCARRF.
  5107         10  DCARRA PIC  X(0001).
  5108     05  DCARRI PIC  X(0001).
  5109*    -------------------------------
  5110     05  DGROUPL PIC S9(0004) COMP.
  5111     05  DGROUPF PIC  X(0001).
  5112     05  FILLER REDEFINES DGROUPF.
  5113         10  DGROUPA PIC  X(0001).
  5114     05  DGROUPI PIC  X(0006).
  5115*    -------------------------------
  5116     05  DSTATEL PIC S9(0004) COMP.
  5117     05  DSTATEF PIC  X(0001).
  5118     05  FILLER REDEFINES DSTATEF.
  5119         10  DSTATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  96
* EL6311.cbl
  5120     05  DSTATEI PIC  X(0002).
  5121*    -------------------------------
  5122     05  DACCTL PIC S9(0004) COMP.
  5123     05  DACCTF PIC  X(0001).
  5124     05  FILLER REDEFINES DACCTF.
  5125         10  DACCTA PIC  X(0001).
  5126     05  DACCTI PIC  X(0010).
  5127*    -------------------------------
  5128     05  DRECVDTL PIC S9(0004) COMP.
  5129     05  DRECVDTF PIC  X(0001).
  5130     05  FILLER REDEFINES DRECVDTF.
  5131         10  DRECVDTA PIC  X(0001).
  5132     05  DRECVDTI PIC  X(0008).
  5133*    -------------------------------
  5134     05  DCSRL PIC S9(0004) COMP.
  5135     05  DCSRF PIC  X(0001).
  5136     05  FILLER REDEFINES DCSRF.
  5137         10  DCSRA PIC  X(0001).
  5138     05  DCSRI PIC  X(0004).
  5139*    -------------------------------
  5140     05  DREFHDGL PIC S9(0004) COMP.
  5141     05  DREFHDGF PIC  X(0001).
  5142     05  FILLER REDEFINES DREFHDGF.
  5143         10  DREFHDGA PIC  X(0001).
  5144     05  DREFHDGI PIC  X(0010).
  5145*    -------------------------------
  5146     05  DREFL PIC S9(0004) COMP.
  5147     05  DREFF PIC  X(0001).
  5148     05  FILLER REDEFINES DREFF.
  5149         10  DREFA PIC  X(0001).
  5150     05  DREFI PIC  X(0012).
  5151*    -------------------------------
  5152     05  DLFPHDGL PIC S9(0004) COMP.
  5153     05  DLFPHDGF PIC  X(0001).
  5154     05  FILLER REDEFINES DLFPHDGF.
  5155         10  DLFPHDGA PIC  X(0001).
  5156     05  DLFPHDGI PIC  X(0010).
  5157*    -------------------------------
  5158     05  DAHPHDGL PIC S9(0004) COMP.
  5159     05  DAHPHDGF PIC  X(0001).
  5160     05  FILLER REDEFINES DAHPHDGF.
  5161         10  DAHPHDGA PIC  X(0001).
  5162     05  DAHPHDGI PIC  X(0010).
  5163*    -------------------------------
  5164     05  DLFRHDGL PIC S9(0004) COMP.
  5165     05  DLFRHDGF PIC  X(0001).
  5166     05  FILLER REDEFINES DLFRHDGF.
  5167         10  DLFRHDGA PIC  X(0001).
  5168     05  DLFRHDGI PIC  X(0009).
  5169*    -------------------------------
  5170     05  DAHRHDGL PIC S9(0004) COMP.
  5171     05  DAHRHDGF PIC  X(0001).
  5172     05  FILLER REDEFINES DAHRHDGF.
  5173         10  DAHRHDGA PIC  X(0001).
  5174     05  DAHRHDGI PIC  X(0009).
  5175*    -------------------------------
  5176     05  DRISSL PIC S9(0004) COMP.
  5177     05  DRISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  97
* EL6311.cbl
  5178     05  FILLER REDEFINES DRISSF.
  5179         10  DRISSA PIC  X(0001).
  5180     05  DRISSI PIC  X(0005).
  5181*    -------------------------------
  5182     05  DRLFPRML PIC S9(0004) COMP.
  5183     05  DRLFPRMF PIC  X(0001).
  5184     05  FILLER REDEFINES DRLFPRMF.
  5185         10  DRLFPRMA PIC  X(0001).
  5186     05  DRLFPRMI PIC  S9(9)V99.
  5187*    -------------------------------
  5188     05  DRAHPRML PIC S9(0004) COMP.
  5189     05  DRAHPRMF PIC  X(0001).
  5190     05  FILLER REDEFINES DRAHPRMF.
  5191         10  DRAHPRMA PIC  X(0001).
  5192     05  DRAHPRMI PIC  S9(9)V99.
  5193*    -------------------------------
  5194     05  DRCANCL PIC S9(0004) COMP.
  5195     05  DRCANCF PIC  X(0001).
  5196     05  FILLER REDEFINES DRCANCF.
  5197         10  DRCANCA PIC  X(0001).
  5198     05  DRCANCI PIC  X(0005).
  5199*    -------------------------------
  5200     05  DRLFRFDL PIC S9(0004) COMP.
  5201     05  DRLFRFDF PIC  X(0001).
  5202     05  FILLER REDEFINES DRLFRFDF.
  5203         10  DRLFRFDA PIC  X(0001).
  5204     05  DRLFRFDI PIC  S9(9)V99.
  5205*    -------------------------------
  5206     05  DRAHRFDL PIC S9(0004) COMP.
  5207     05  DRAHRFDF PIC  X(0001).
  5208     05  FILLER REDEFINES DRAHRFDF.
  5209         10  DRAHRFDA PIC  X(0001).
  5210     05  DRAHRFDI PIC  S9(9)V99.
  5211*    -------------------------------
  5212     05  DEISSL PIC S9(0004) COMP.
  5213     05  DEISSF PIC  X(0001).
  5214     05  FILLER REDEFINES DEISSF.
  5215         10  DEISSA PIC  X(0001).
  5216     05  DEISSI PIC  X(0005).
  5217*    -------------------------------
  5218     05  DELFPRML PIC S9(0004) COMP.
  5219     05  DELFPRMF PIC  X(0001).
  5220     05  FILLER REDEFINES DELFPRMF.
  5221         10  DELFPRMA PIC  X(0001).
  5222     05  DELFPRMI PIC  X(0011).
  5223*    -------------------------------
  5224     05  DEAHPRML PIC S9(0004) COMP.
  5225     05  DEAHPRMF PIC  X(0001).
  5226     05  FILLER REDEFINES DEAHPRMF.
  5227         10  DEAHPRMA PIC  X(0001).
  5228     05  DEAHPRMI PIC  X(0011).
  5229*    -------------------------------
  5230     05  DECANCL PIC S9(0004) COMP.
  5231     05  DECANCF PIC  X(0001).
  5232     05  FILLER REDEFINES DECANCF.
  5233         10  DECANCA PIC  X(0001).
  5234     05  DECANCI PIC  X(0005).
  5235*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  98
* EL6311.cbl
  5236     05  DELFRFDL PIC S9(0004) COMP.
  5237     05  DELFRFDF PIC  X(0001).
  5238     05  FILLER REDEFINES DELFRFDF.
  5239         10  DELFRFDA PIC  X(0001).
  5240     05  DELFRFDI PIC  X(0011).
  5241*    -------------------------------
  5242     05  DEAHRFDL PIC S9(0004) COMP.
  5243     05  DEAHRFDF PIC  X(0001).
  5244     05  FILLER REDEFINES DEAHRFDF.
  5245         10  DEAHRFDA PIC  X(0001).
  5246     05  DEAHRFDI PIC  X(0011).
  5247*    -------------------------------
  5248     05  DCISSL PIC S9(0004) COMP.
  5249     05  DCISSF PIC  X(0001).
  5250     05  FILLER REDEFINES DCISSF.
  5251         10  DCISSA PIC  X(0001).
  5252     05  DCISSI PIC  X(0005).
  5253*    -------------------------------
  5254     05  DCLFPRML PIC S9(0004) COMP.
  5255     05  DCLFPRMF PIC  X(0001).
  5256     05  FILLER REDEFINES DCLFPRMF.
  5257         10  DCLFPRMA PIC  X(0001).
  5258     05  DCLFPRMI PIC  X(0011).
  5259*    -------------------------------
  5260     05  DCAHPRML PIC S9(0004) COMP.
  5261     05  DCAHPRMF PIC  X(0001).
  5262     05  FILLER REDEFINES DCAHPRMF.
  5263         10  DCAHPRMA PIC  X(0001).
  5264     05  DCAHPRMI PIC  X(0011).
  5265*    -------------------------------
  5266     05  DCCANCL PIC S9(0004) COMP.
  5267     05  DCCANCF PIC  X(0001).
  5268     05  FILLER REDEFINES DCCANCF.
  5269         10  DCCANCA PIC  X(0001).
  5270     05  DCCANCI PIC  X(0005).
  5271*    -------------------------------
  5272     05  DCLFRFDL PIC S9(0004) COMP.
  5273     05  DCLFRFDF PIC  X(0001).
  5274     05  FILLER REDEFINES DCLFRFDF.
  5275         10  DCLFRFDA PIC  X(0001).
  5276     05  DCLFRFDI PIC  X(0011).
  5277*    -------------------------------
  5278     05  DCAHRFDL PIC S9(0004) COMP.
  5279     05  DCAHRFDF PIC  X(0001).
  5280     05  FILLER REDEFINES DCAHRFDF.
  5281         10  DCAHRFDA PIC  X(0001).
  5282     05  DCAHRFDI PIC  X(0011).
  5283*    -------------------------------
  5284     05  DOISSL PIC S9(0004) COMP.
  5285     05  DOISSF PIC  X(0001).
  5286     05  FILLER REDEFINES DOISSF.
  5287         10  DOISSA PIC  X(0001).
  5288     05  DOISSI PIC  X(0005).
  5289*    -------------------------------
  5290     05  DOLFPRML PIC S9(0004) COMP.
  5291     05  DOLFPRMF PIC  X(0001).
  5292     05  FILLER REDEFINES DOLFPRMF.
  5293         10  DOLFPRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  99
* EL6311.cbl
  5294     05  DOLFPRMI PIC  X(0011).
  5295*    -------------------------------
  5296     05  DOAHPRML PIC S9(0004) COMP.
  5297     05  DOAHPRMF PIC  X(0001).
  5298     05  FILLER REDEFINES DOAHPRMF.
  5299         10  DOAHPRMA PIC  X(0001).
  5300     05  DOAHPRMI PIC  X(0011).
  5301*    -------------------------------
  5302     05  DOCANCL PIC S9(0004) COMP.
  5303     05  DOCANCF PIC  X(0001).
  5304     05  FILLER REDEFINES DOCANCF.
  5305         10  DOCANCA PIC  X(0001).
  5306     05  DOCANCI PIC  X(0005).
  5307*    -------------------------------
  5308     05  DOLFRFDL PIC S9(0004) COMP.
  5309     05  DOLFRFDF PIC  X(0001).
  5310     05  FILLER REDEFINES DOLFRFDF.
  5311         10  DOLFRFDA PIC  X(0001).
  5312     05  DOLFRFDI PIC  X(0011).
  5313*    -------------------------------
  5314     05  DOAHRFDL PIC S9(0004) COMP.
  5315     05  DOAHRFDF PIC  X(0001).
  5316     05  FILLER REDEFINES DOAHRFDF.
  5317         10  DOAHRFDA PIC  X(0001).
  5318     05  DOAHRFDI PIC  X(0011).
  5319*    -------------------------------
  5320     05  DITOTALL PIC S9(0004) COMP.
  5321     05  DITOTALF PIC  X(0001).
  5322     05  FILLER REDEFINES DITOTALF.
  5323         10  DITOTALA PIC  X(0001).
  5324     05  DITOTALI PIC  X(0005).
  5325*    -------------------------------
  5326     05  DIFATALL PIC S9(0004) COMP.
  5327     05  DIFATALF PIC  X(0001).
  5328     05  FILLER REDEFINES DIFATALF.
  5329         10  DIFATALA PIC  X(0001).
  5330     05  DIFATALI PIC  X(0005).
  5331*    -------------------------------
  5332     05  DIFORCEL PIC S9(0004) COMP.
  5333     05  DIFORCEF PIC  X(0001).
  5334     05  FILLER REDEFINES DIFORCEF.
  5335         10  DIFORCEA PIC  X(0001).
  5336     05  DIFORCEI PIC  X(0005).
  5337*    -------------------------------
  5338     05  DIHOLDL PIC S9(0004) COMP.
  5339     05  DIHOLDF PIC  X(0001).
  5340     05  FILLER REDEFINES DIHOLDF.
  5341         10  DIHOLDA PIC  X(0001).
  5342     05  DIHOLDI PIC  X(0005).
  5343*    -------------------------------
  5344     05  DIAVAILL PIC S9(0004) COMP.
  5345     05  DIAVAILF PIC  X(0001).
  5346     05  FILLER REDEFINES DIAVAILF.
  5347         10  DIAVAILA PIC  X(0001).
  5348     05  DIAVAILI PIC  X(0005).
  5349*    -------------------------------
  5350     05  DIGPREML PIC S9(0004) COMP.
  5351     05  DIGPREMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 100
* EL6311.cbl
  5352     05  FILLER REDEFINES DIGPREMF.
  5353         10  DIGPREMA PIC  X(0001).
  5354     05  DIGPREMI PIC  X(0011).
  5355*    -------------------------------
  5356     05  DIBPREML PIC S9(0004) COMP.
  5357     05  DIBPREMF PIC  X(0001).
  5358     05  FILLER REDEFINES DIBPREMF.
  5359         10  DIBPREMA PIC  X(0001).
  5360     05  DIBPREMI PIC  X(0011).
  5361*    -------------------------------
  5362     05  DCTOTALL PIC S9(0004) COMP.
  5363     05  DCTOTALF PIC  X(0001).
  5364     05  FILLER REDEFINES DCTOTALF.
  5365         10  DCTOTALA PIC  X(0001).
  5366     05  DCTOTALI PIC  X(0005).
  5367*    -------------------------------
  5368     05  DCFATALL PIC S9(0004) COMP.
  5369     05  DCFATALF PIC  X(0001).
  5370     05  FILLER REDEFINES DCFATALF.
  5371         10  DCFATALA PIC  X(0001).
  5372     05  DCFATALI PIC  X(0005).
  5373*    -------------------------------
  5374     05  DCFORCEL PIC S9(0004) COMP.
  5375     05  DCFORCEF PIC  X(0001).
  5376     05  FILLER REDEFINES DCFORCEF.
  5377         10  DCFORCEA PIC  X(0001).
  5378     05  DCFORCEI PIC  X(0005).
  5379*    -------------------------------
  5380     05  DCHOLDL PIC S9(0004) COMP.
  5381     05  DCHOLDF PIC  X(0001).
  5382     05  FILLER REDEFINES DCHOLDF.
  5383         10  DCHOLDA PIC  X(0001).
  5384     05  DCHOLDI PIC  X(0005).
  5385*    -------------------------------
  5386     05  DCAVAILL PIC S9(0004) COMP.
  5387     05  DCAVAILF PIC  X(0001).
  5388     05  FILLER REDEFINES DCAVAILF.
  5389         10  DCAVAILA PIC  X(0001).
  5390     05  DCAVAILI PIC  X(0005).
  5391*    -------------------------------
  5392     05  DCGPREML PIC S9(0004) COMP.
  5393     05  DCGPREMF PIC  X(0001).
  5394     05  FILLER REDEFINES DCGPREMF.
  5395         10  DCGPREMA PIC  X(0001).
  5396     05  DCGPREMI PIC  X(0011).
  5397*    -------------------------------
  5398     05  DCBPREML PIC S9(0004) COMP.
  5399     05  DCBPREMF PIC  X(0001).
  5400     05  FILLER REDEFINES DCBPREMF.
  5401         10  DCBPREMA PIC  X(0001).
  5402     05  DCBPREMI PIC  X(0011).
  5403*    -------------------------------
  5404     05  DNTOTALL PIC S9(0004) COMP.
  5405     05  DNTOTALF PIC  X(0001).
  5406     05  FILLER REDEFINES DNTOTALF.
  5407         10  DNTOTALA PIC  X(0001).
  5408     05  DNTOTALI PIC  X(0005).
  5409*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 101
* EL6311.cbl
  5410     05  DNFATALL PIC S9(0004) COMP.
  5411     05  DNFATALF PIC  X(0001).
  5412     05  FILLER REDEFINES DNFATALF.
  5413         10  DNFATALA PIC  X(0001).
  5414     05  DNFATALI PIC  X(0005).
  5415*    -------------------------------
  5416     05  DNFORCEL PIC S9(0004) COMP.
  5417     05  DNFORCEF PIC  X(0001).
  5418     05  FILLER REDEFINES DNFORCEF.
  5419         10  DNFORCEA PIC  X(0001).
  5420     05  DNFORCEI PIC  X(0005).
  5421*    -------------------------------
  5422     05  DNHOLDL PIC S9(0004) COMP.
  5423     05  DNHOLDF PIC  X(0001).
  5424     05  FILLER REDEFINES DNHOLDF.
  5425         10  DNHOLDA PIC  X(0001).
  5426     05  DNHOLDI PIC  X(0005).
  5427*    -------------------------------
  5428     05  DNAVAILL PIC S9(0004) COMP.
  5429     05  DNAVAILF PIC  X(0001).
  5430     05  FILLER REDEFINES DNAVAILF.
  5431         10  DNAVAILA PIC  X(0001).
  5432     05  DNAVAILI PIC  X(0005).
  5433*    -------------------------------
  5434     05  DNGPREML PIC S9(0004) COMP.
  5435     05  DNGPREMF PIC  X(0001).
  5436     05  FILLER REDEFINES DNGPREMF.
  5437         10  DNGPREMA PIC  X(0001).
  5438     05  DNGPREMI PIC  X(0011).
  5439*    -------------------------------
  5440     05  DNBPREML PIC S9(0004) COMP.
  5441     05  DNBPREMF PIC  X(0001).
  5442     05  FILLER REDEFINES DNBPREMF.
  5443         10  DNBPREMA PIC  X(0001).
  5444     05  DNBPREMI PIC  X(0011).
  5445*    -------------------------------
  5446     05  DERMSGL PIC S9(0004) COMP.
  5447     05  DERMSGF PIC  X(0001).
  5448     05  FILLER REDEFINES DERMSGF.
  5449         10  DERMSGA PIC  X(0001).
  5450     05  DERMSGI PIC  X(0075).
  5451*    -------------------------------
  5452     05  DPFENTRL PIC S9(0004) COMP.
  5453     05  DPFENTRF PIC  X(0001).
  5454     05  FILLER REDEFINES DPFENTRF.
  5455         10  DPFENTRA PIC  X(0001).
  5456     05  DPFENTRI PIC  9(2).
  5457 01  EL631DO REDEFINES EL631BI.
  5458     05  FILLER            PIC  X(0012).
  5459*    -------------------------------
  5460     05  FILLER            PIC  X(0003).
  5461     05  DDATEO PIC  X(0008).
  5462*    -------------------------------
  5463     05  FILLER            PIC  X(0003).
  5464     05  DTIMEO PIC  99.99.
  5465*    -------------------------------
  5466     05  FILLER            PIC  X(0003).
  5467     05  DHEADO PIC  X(0038).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 102
* EL6311.cbl
  5468*    -------------------------------
  5469     05  FILLER            PIC  X(0003).
  5470     05  DLDATEO PIC  X(0010).
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DBATCHO PIC  X(0011).
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DACCTNMO PIC  X(0030).
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DPROCDTO PIC  X(0008).
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DINPUTO PIC  X(0008).
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DMAINDTO PIC  X(0008).
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DCARRO PIC  X(0001).
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DGROUPO PIC  X(0006).
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DSTATEO PIC  X(0002).
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DACCTO PIC  X(0010).
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DRECVDTO PIC  X(0008).
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DCSRO PIC  X(0004).
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DREFHDGO PIC  X(0010).
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DREFO PIC  X(0012).
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DLFPHDGO PIC  X(0010).
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DAHPHDGO PIC  X(0010).
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DLFRHDGO PIC  X(0009).
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DAHRHDGO PIC  X(0009).
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DRISSO PIC  ZZ99-.
  5525*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 103
* EL6311.cbl
  5526     05  FILLER            PIC  X(0003).
  5527     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DRCANCO PIC  ZZ99-.
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
  5542     05  DEISSO PIC  ZZ99-.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DECANCO PIC  ZZ99-.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DCISSO PIC  ZZ99-.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
  5569     05  DCCANCO PIC  ZZ99-.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
  5572     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DOISSO PIC  ZZ99-.
  5579*    -------------------------------
  5580     05  FILLER            PIC  X(0003).
  5581     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5582*    -------------------------------
  5583     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 104
* EL6311.cbl
  5584     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DOCANCO PIC  ZZ99-.
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
  5590     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
  5596     05  DITOTALO PIC  ZZZ99.
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
  5599     05  DIFATALO PIC  ZZZ99.
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DIFORCEO PIC  ZZZ99.
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DIHOLDO PIC  ZZZ99.
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DIAVAILO PIC  ZZZ99.
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DCTOTALO PIC  ZZZ99.
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DCFATALO PIC  ZZZ99.
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DCFORCEO PIC  ZZZ99.
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DCHOLDO PIC  ZZZ99.
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DCAVAILO PIC  ZZZ99.
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DNTOTALO PIC  ---99.
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DNFATALO PIC  ---99.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 105
* EL6311.cbl
  5642*    -------------------------------
  5643     05  FILLER            PIC  X(0003).
  5644     05  DNFORCEO PIC  ---99.
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DNHOLDO PIC  ---99.
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DNAVAILO PIC  ---99.
  5651*    -------------------------------
  5652     05  FILLER            PIC  X(0003).
  5653     05  DNGPREMO PIC  -------9.99.
  5654*    -------------------------------
  5655     05  FILLER            PIC  X(0003).
  5656     05  DNBPREMO PIC  -------9.99.
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DERMSGO PIC  X(0075).
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DPFENTRO PIC  X(0002).
  5663*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 106
* EL6311.cbl
  5665 01  MAP-B REDEFINES EL631BI.
  5666     12  FILLER                  PIC X(591).
  5667*    12  FILLER                  PIC X(512).
  5668*    12  FILLER                  PIC X(510).
  5669     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5670         16  BKIND-LEN               PIC S9(4)  COMP.
  5671         16  BKIND-ATTRB             PIC X.
  5672         16  BKIND                   PIC XX.
  5673         16  BTYPE-LEN               PIC S9(4)  COMP.
  5674         16  BTYPE-ATTRB             PIC X.
  5675         16  BTYPE                   PIC X(3).
  5676         16  BTERM-LEN               PIC S9(4)  COMP.
  5677         16  BTERM-ATTRB             PIC X.
  5678         16  BTERMI                  PIC 999.
  5679         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5680         16  BBEN-LEN                PIC S9(4)  COMP.
  5681         16  BBEN-ATTRB              PIC X.
  5682         16  BBENI                   PIC 9(10)V99.
  5683*        16  BBENI                   PIC 9(12).
  5684         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5685         16  BPREM-LEN               PIC S9(4)  COMP.
  5686         16  BPREM-ATTRB             PIC X.
  5687         16  BPREMI                  PIC S9(9)V99.
  5688*        16  BPREMI                  PIC 9(11).
  5689         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5690         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5691         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5692         16  BEXPIRE-ATTRB           PIC X.
  5693         16  BEXPIRE                 PIC X(8).
  5694         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5695         16  BCRIT-PERD-ATTRB        PIC X.
  5696         16  BCRIT-PERDI             PIC 99.
  5697         16  BCRIT-PERDO REDEFINES
  5698                         BCRIT-PERDI PIC ZZ.
  5699         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5700         16  BALT-BEN-ATTRB          PIC X.
  5701         16  BALT-BENI               PIC 9(10)V99.
  5702*        16  BALT-BENI               PIC 9(12).
  5703         16  BALT-BENO REDEFINES
  5704                           BALT-BENI PIC Z(9).ZZ.
  5705         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5706         16  BALT-PREM-ATTRB         PIC X.
  5707         16  BALT-PREMI              PIC 9(9)V99.
  5708*        16  BALT-PREMI              PIC 9(11).
  5709         16  BALT-PREMO REDEFINES
  5710                          BALT-PREMI PIC Z(7).ZZ-.
  5711         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5712         16  BBEN-CD-ATTRB           PIC X.
  5713         16  BBEN-CD                 PIC XXX.
  5714         16  BCPREM-LEN              PIC S9(4)  COMP.
  5715         16  BCPREM-ATTRB            PIC X.
  5716         16  BCPREMI                 PIC S9(9)V99.
  5717*        16  BCPREMI                 PIC X(11).
  5718         16  BCPREMO REDEFINES BCPREMI
  5719                                     PIC Z(7).99-.
  5720         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5721         16  BCALT-PREM-ATTRB        PIC X.
  5722         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 107
* EL6311.cbl
  5723         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5724         16  BBEN-ABBR-ATTRB         PIC X.
  5725         16  BBEN-ABBR               PIC X(5).
  5726         16  BDIFF-LEN               PIC S9(4)  COMP.
  5727         16  BDIFF-ATTRB             PIC X.
  5728         16  BDIFFO                  PIC Z(7).99-.
  5729         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5730         16  BBILL-LIT-ATTRB         PIC X.
  5731         16  BBILL-LIT               PIC X(8).
  5732         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5733         16  BDALT-PREM-ATTRB        PIC X.
  5734         16  BDALT-PREM              PIC Z(7).99-.
  5735
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 108
* EL6311.cbl
  5737
  5738****************************************************************
  5739*
  5740* Copyright (c) 2007 by Clerity Solutions, Inc.
  5741* All rights reserved.
  5742*
  5743****************************************************************
  5744 01  DFHEIV.
  5745   02  DFHEIV0               PIC X(35).
  5746   02  DFHEIV1               PIC X(08).
  5747   02  DFHEIV2               PIC X(08).
  5748   02  DFHEIV3               PIC X(08).
  5749   02  DFHEIV4               PIC X(06).
  5750   02  DFHEIV5               PIC X(04).
  5751   02  DFHEIV6               PIC X(04).
  5752   02  DFHEIV7               PIC X(02).
  5753   02  DFHEIV8               PIC X(02).
  5754   02  DFHEIV9               PIC X(01).
  5755   02  DFHEIV10              PIC S9(7) COMP-3.
  5756   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5757   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5758   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5759   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5760   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5761   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5762   02  DFHEIV17              PIC X(04).
  5763   02  DFHEIV18              PIC X(04).
  5764   02  DFHEIV19              PIC X(04).
  5765   02  DFHEIV20              USAGE IS POINTER.
  5766   02  DFHEIV21              USAGE IS POINTER.
  5767   02  DFHEIV22              USAGE IS POINTER.
  5768   02  DFHEIV23              USAGE IS POINTER.
  5769   02  DFHEIV24              USAGE IS POINTER.
  5770   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5771   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5772   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5773   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5774   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5775   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5776   02  FILLER                PIC X(02).
  5777   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5778   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5779   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5780   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5781   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5782 LINKAGE  SECTION.
  5783*****************************************************************
  5784*                                                               *
  5785* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5786* All rights reserved.                                          *
  5787*                                                               *
  5788*****************************************************************
  5789 01  dfheiblk.
  5790     02  eibtime          pic s9(7) comp-3.
  5791     02  eibdate          pic s9(7) comp-3.
  5792     02  eibtrnid         pic x(4).
  5793     02  eibtaskn         pic s9(7) comp-3.
  5794     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 109
* EL6311.cbl
  5795     02  dfheigdi         pic s9(4) comp.
  5796     02  eibcposn         pic s9(4) comp.
  5797     02  eibcalen         pic s9(4) comp.
  5798     02  eibaid           pic x(1).
  5799     02  eibfiller1       pic x(1).
  5800     02  eibfn            pic x(2).
  5801     02  eibfiller2       pic x(2).
  5802     02  eibrcode         pic x(6).
  5803     02  eibfiller3       pic x(2).
  5804     02  eibds            pic x(8).
  5805     02  eibreqid         pic x(8).
  5806     02  eibrsrce         pic x(8).
  5807     02  eibsync          pic x(1).
  5808     02  eibfree          pic x(1).
  5809     02  eibrecv          pic x(1).
  5810     02  eibsend          pic x(1).
  5811     02  eibatt           pic x(1).
  5812     02  eibeoc           pic x(1).
  5813     02  eibfmh           pic x(1).
  5814     02  eibcompl         pic x(1).
  5815     02  eibsig           pic x(1).
  5816     02  eibconf          pic x(1).
  5817     02  eiberr           pic x(1).
  5818     02  eibrldbk         pic x(1).
  5819     02  eiberrcd         pic x(4).
  5820     02  eibsynrb         pic x(1).
  5821     02  eibnodat         pic x(1).
  5822     02  eibfiller5       pic x(2).
  5823     02  eibresp          pic 9(09) comp.
  5824     02  eibresp2         pic 9(09) comp.
  5825     02  dfheigdj         pic s9(4) comp.
  5826     02  dfheigdk         pic s9(4) comp.
  5827 01  DFHCOMMAREA                 PIC X(1300).
  5828*                                COPY ERCPNDB.
  5829******************************************************************
  5830*                                                                *
  5831*                                                                *
  5832*                            ERCPNDB.                            *
  5833*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5834*                            VMOD=2.025                          *
  5835*                                                                *
  5836*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5837*                                                                *
  5838******************************************************************
  5839*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5840*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5841******************************************************************
  5842*                                                                *
  5843*                                                                *
  5844*   FILE TYPE = VSAM,KSDS                                        *
  5845*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5846*                                                                *
  5847*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5848*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5849*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5850*                                                 RKP=13,LEN=36  *
  5851*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5852*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 110
* EL6311.cbl
  5853*                                                RKP=49,LEN=11   *
  5854*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5855*                                      AND CHG-SEQ.)             *
  5856*                                                RKP=60,LEN=15   *
  5857*                                                                *
  5858*   LOG = NO                                                     *
  5859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5860******************************************************************
  5861******************************************************************
  5862*                   C H A N G E   L O G
  5863*
  5864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5865*-----------------------------------------------------------------
  5866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5867* EFFECTIVE    NUMBER
  5868*-----------------------------------------------------------------
  5869* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5870* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5871* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5872* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5873* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5874* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5875* 032306                   PEMA  ADD BOW LOAN NUMBER
  5876* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5877* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5878* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5879* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5880* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5881* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5882* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5883* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5884* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5885******************************************************************
  5886
  5887 01  PENDING-BUSINESS.
  5888     12  PB-RECORD-ID                     PIC XX.
  5889         88  VALID-PB-ID                        VALUE 'PB'.
  5890
  5891     12  PB-CONTROL-PRIMARY.
  5892         16  PB-COMPANY-CD                PIC X.
  5893         16  PB-ENTRY-BATCH               PIC X(6).
  5894         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5895         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5896
  5897     12  PB-CONTROL-BY-ACCOUNT.
  5898         16  PB-COMPANY-CD-A1             PIC X.
  5899         16  PB-CARRIER                   PIC X.
  5900         16  PB-GROUPING.
  5901             20  PB-GROUPING-PREFIX       PIC XXX.
  5902             20  PB-GROUPING-PRIME        PIC XXX.
  5903         16  PB-STATE                     PIC XX.
  5904         16  PB-ACCOUNT.
  5905             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5906             20  PB-ACCOUNT-PRIME         PIC X(6).
  5907         16  PB-CERT-EFF-DT               PIC XX.
  5908         16  PB-CERT-NO.
  5909             20  PB-CERT-PRIME            PIC X(10).
  5910             20  PB-CERT-SFX              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 111
* EL6311.cbl
  5911         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5912
  5913         16  PB-RECORD-TYPE               PIC X.
  5914             88  PB-MAILING-DATA                VALUE '0'.
  5915             88  PB-ISSUE                       VALUE '1'.
  5916             88  PB-CANCELLATION                VALUE '2'.
  5917             88  PB-BATCH-TRAILER               VALUE '9'.
  5918
  5919     12  PB-CONTROL-BY-ORIG-BATCH.
  5920         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5921         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5922         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5923         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5924
  5925     12  PB-CONTROL-BY-CSR.
  5926         16  PB-CSR-COMPANY-CD            PIC X.
  5927         16  PB-CSR-ID                    PIC X(4).
  5928         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5929         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5930         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5931******************************************************************
  5932*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5933******************************************************************
  5934
  5935     12  PB-LAST-MAINT-DT                 PIC XX.
  5936     12  PB-LAST-MAINT-BY                 PIC X(4).
  5937     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5938
  5939     12  PB-RECORD-BODY                   PIC X(375).
  5940
  5941     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5942         16  PB-CERT-ORIGIN               PIC X.
  5943             88  CLASIC-CREATED-CERT         VALUE '1'.
  5944         16  PB-I-NAME.
  5945             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5946             20  PB-I-INSURED-FIRST-NAME.
  5947                 24  PB-I-INSURED-1ST-INIT PIC X.
  5948                 24  FILLER                PIC X(9).
  5949             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5950         16  PB-I-AGE                     PIC S99   COMP-3.
  5951         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5952         16  PB-I-BIRTHDAY                PIC XX.
  5953         16  PB-I-INSURED-SEX             PIC X.
  5954             88  PB-SEX-MALE     VALUE 'M'.
  5955             88  PB-SEX-FEMALE   VALUE 'F'.
  5956
  5957         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5958         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5959         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5960         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5961         16  PB-I-SKIP-CODE               PIC X.
  5962             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5963             88  PB-SKIP-JULY              VALUE '1'.
  5964             88  PB-SKIP-AUGUST            VALUE '2'.
  5965             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5966             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5967             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5968             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 112
* EL6311.cbl
  5969             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5970             88  PB-SKIP-JUNE              VALUE '8'.
  5971             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5972             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5973             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5974         16  PB-I-TERM-TYPE               PIC X.
  5975             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5976             88  PB-PAID-WEEKLY            VALUE 'W'.
  5977             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5978             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5979             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5980         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5981         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5982         16  PB-I-DATA-ENTRY-SW           PIC X.
  5983             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5984             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5985             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5986             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5987         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5988         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5989*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5990         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5991         16  FILLER                       PIC X.
  5992
  5993         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5994             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5995             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5996                                                   '90' THRU '99'.
  5997         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5998                                          PIC XX.
  5999         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6000         16  PB-I-AMOUNT-FINANCED REDEFINES
  6001                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6002         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6003         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6004                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6005         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6006         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6007         16  PB-I-CLP-AMOUNT REDEFINES
  6008                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6009         16  PB-I-LF-CALC-FLAG            PIC X.
  6010             88 PB-COMP-LF-PREM               VALUE '?'.
  6011         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6012         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6013         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6014         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6015         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6016         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6017         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6018         16  PB-I-LF-ABBR                 PIC XXX.
  6019         16  PB-I-LF-INPUT-CD             PIC XX.
  6020
  6021         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6022             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6023             88  PB-INVALID-AH               VALUE '  ' '00'
  6024                                                   '90' THRU '99'.
  6025         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6026         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 113
* EL6311.cbl
  6027         16  PB-I-AH-CALC-FLAG            PIC X.
  6028             88 PB-COMP-AH-PREM                  VALUE '?'.
  6029         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6030         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6031         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6032         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6033         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6034         16  PB-I-AH-ABBR                 PIC XXX.
  6035         16  PB-I-AH-INPUT-CD             PIC XXX.
  6036
  6037         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6038         16  PB-I-REIN-TABLE              PIC XXX.
  6039         16  PB-I-BUSINESS-TYPE           PIC 99.
  6040         16  PB-I-INDV-GRP-CD             PIC X.
  6041         16  PB-I-MORT-CODE.
  6042             20  PB-I-TABLE               PIC X.
  6043             20  PB-I-INTEREST            PIC XX.
  6044             20  PB-I-MORT-TYP            PIC X.
  6045         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6046         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6047         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6048         16  PB-I-INDV-GRP-OVRD           PIC X.
  6049         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6050         16  PB-I-SIG-SW                  PIC X.
  6051             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6052         16  PB-I-RATE-CLASS              PIC XX.
  6053         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6054         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6055         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6056         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6057         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6058         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6059         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6060         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6061         16  PB-I-OB-FLAG                 PIC X.
  6062             88  PB-I-OB                      VALUE 'B'.
  6063             88  PB-I-SUMMARY                 VALUE 'Z'.
  6064         16  PB-I-ENTRY-STATUS            PIC X.
  6065             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6066                                              'M' '5' '9' '2'.
  6067             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6068             88  PB-I-POLICY-PENDING          VALUE '2'.
  6069             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6070             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6071             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6072             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6073             88  PB-I-REIN-ONLY               VALUE '9'.
  6074             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6075             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6076             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6077             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6078         16  PB-I-INT-CODE                PIC X.
  6079             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6080             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6081         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6082         16  PB-I-SOC-SEC-NO              PIC X(11).
  6083         16  PB-I-MEMBER-NO               PIC X(12).
  6084         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 114
* EL6311.cbl
  6085*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6086         16  PB-I-OLD-LOF                 PIC XXX.
  6087         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6088         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6089         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6090         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6091         16  PB-I-LIFE-INDICATOR          PIC X.
  6092             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6093         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6094         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6095                                          PIC S9(5)V99    COMP-3.
  6096         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6097             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6098             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6099         16  PB-I-1ST-PMT-DT              PIC XX.
  6100         16  PB-I-JOINT-INSURED.
  6101             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6102             20 PB-I-JOINT-FIRST-NAME.
  6103                24  PB-I-JOINT-FIRST-INIT PIC X.
  6104                24  FILLER                PIC X(9).
  6105             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6106*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6107         16  PB-I-BENEFICIARY-NAME.
  6108             20  PB-I-BANK-NUMBER         PIC X(10).
  6109             20  FILLER                   PIC X(15).
  6110         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6111         16  PB-I-REFERENCE               PIC X(12).
  6112         16  FILLER REDEFINES PB-I-REFERENCE.
  6113             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6114             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6115             20  PB-I-CLP-STATE           PIC XX.
  6116         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6117             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6118             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6119             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6120         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6121         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6122         16  PB-I-RESIDENT-STATE          PIC XX.
  6123         16  PB-I-RATE-CODE               PIC X(4).
  6124         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6125         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6126         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6127         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6128         16  PB-I-BANK-NOCHRGB            PIC 99.
  6129         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6130         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6131
  6132     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6133         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6134             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6135         16  PB-C-CANCEL-ORIGIN           PIC X.
  6136             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6137         16  PB-C-LF-CANCEL-DT            PIC XX.
  6138         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6139         16  PB-C-LF-CALC-REQ             PIC X.
  6140             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6141         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6142         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 115
* EL6311.cbl
  6143         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6144             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6145         16  PB-C-AH-CANCEL-DT            PIC XX.
  6146         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6147         16  PB-C-AH-CALC-REQ             PIC X.
  6148             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6149         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6150         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6151         16  PB-C-LAST-NAME               PIC X(15).
  6152         16  PB-C-REFUND-SW               PIC X.
  6153             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6154             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6155         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6156         16  PB-C-PAYEE-CODE              PIC X(6).
  6157         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6158         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6159         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6160         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6161         16  PB-C-REFERENCE               PIC X(12).
  6162         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6163         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6164         16  PB-C-POST-CARD-IND           PIC X.
  6165         16  PB-C-CANCEL-REASON           PIC X.
  6166         16  PB-C-REF-INTERFACE-SW        PIC X.
  6167         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6168         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6169         16  FILLER                       PIC X(01).
  6170*        16  FILLER                       PIC X(18).
  6171         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6172*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6173         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6174         16  PB-CANCELED-CERT-DATA.
  6175             20  PB-CI-INSURED-NAME.
  6176                 24  PB-CI-LAST-NAME      PIC X(15).
  6177                 24  PB-CI-INITIALS       PIC XX.
  6178             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6179             20  PB-CI-INSURED-SEX        PIC X.
  6180             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6181             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6182             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6183             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6184             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6185             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6186             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6187             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6188             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6189             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6190             20  PB-CI-RATE-CLASS         PIC XX.
  6191             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6192             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6193             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6194             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6195             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6196             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6197             20  PB-CI-LF-ABBR            PIC X(3).
  6198             20  PB-CI-AH-ABBR            PIC X(3).
  6199             20  PB-CI-OB-FLAG            PIC X.
  6200                 88  PB-CI-OB                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 116
* EL6311.cbl
  6201             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6202                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6203                                           'M' '4' '5' '9' '2'.
  6204                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6205                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6206                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6207                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6208                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6209                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6210                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6211                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6212                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6213                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6214                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6215                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6216                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6217             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6218                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6219                                           'M' '4' '5' '9' '2'.
  6220                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6221                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6222                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6223                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6224                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6225                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6226                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6227                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6228                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6229                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6230                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6231                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6232                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6233             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6234             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6235             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6236             20  PB-CI-MEMBER-NO          PIC X(12).
  6237             20  PB-CI-INT-CODE           PIC X.
  6238                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6239                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6240             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6241             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6242             20  PB-CI-COMP-EXCP-SW       PIC X.
  6243                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6244                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6245             20  PB-CI-ENTRY-STATUS       PIC X.
  6246             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6247             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6248             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6249             20  PB-CI-DEATH-DT           PIC XX.
  6250             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6251             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6252             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6253             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6254             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6255             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6256             20  PB-CI-ENTRY-DT              PIC XX.
  6257             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6258             20  PB-CI-LF-EXPIRE-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 117
* EL6311.cbl
  6259             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6260             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6261             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6262             20  PB-CI-OLD-LOF               PIC XXX.
  6263*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6264             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6265             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6266             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6267             20  PB-CI-INDV-GRP-CD           PIC X.
  6268             20  PB-CI-BENEFICIARY-NAME.
  6269                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6270                 24  FILLER                  PIC X(15).
  6271             20  PB-CI-NOTE-SW               PIC X.
  6272             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6273             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6274             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6275             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6276             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6277             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6278             20  PB-CI-FIRST-NAME            PIC X(10).
  6279             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6280
  6281         16  FILLER                       PIC X(13).
  6282*032306  16  FILLER                       PIC X(27).
  6283*        16  FILLER                       PIC X(46).
  6284
  6285     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6286         16  FILLER                       PIC X(10).
  6287         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6288         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6289         16  PB-M-INSURED-MID-INIT        PIC X.
  6290         16  PB-M-INSURED-AGE             PIC 99.
  6291         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6292         16  PB-M-INSURED-SEX             PIC X.
  6293         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6294         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6295         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6296         16  PB-M-INSURED-CITY-STATE.
  6297             20  PB-M-INSURED-CITY        PIC X(28).
  6298             20  PB-M-INSURED-STATE       PIC XX.
  6299         16  PB-M-INSURED-ZIP-CODE.
  6300             20  PB-M-INSURED-ZIP-PRIME.
  6301                 24  PB-M-INSURED-ZIP-1   PIC X.
  6302                     88  PB-M-CANADIAN-POST-CODE
  6303                                             VALUE 'A' THRU 'Z'.
  6304                 24  FILLER               PIC X(4).
  6305             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6306         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6307                                        PB-M-INSURED-ZIP-CODE.
  6308             20  PM-M-INS-CAN-POST1       PIC XXX.
  6309             20  PM-M-INS-CAN-POST2       PIC XXX.
  6310             20  FILLER                   PIC XXX.
  6311         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6312         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6313         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6314         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6315         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6316         16  PB-M-CRED-BENE-CITYST.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 118
* EL6311.cbl
  6317             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6318             20  PB-M-CRED-BENE-STATE     PIC XX.
  6319         16  FILLER                       PIC X(92).
  6320
  6321     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6322         16  FILLER                       PIC X(10).
  6323         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6324         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6325         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6326         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6327         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6328         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6329         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6330         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6331         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6332         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6333         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6334         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6335         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6336         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6337         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6338         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6339         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6340         16  PB-ACCOUNT-NAME              PIC X(30).
  6341         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6342         16  PB-REFERENCE                 PIC X(12).
  6343         16  PB-B-RECEIVED-DT             PIC XX.
  6344         16  FILLER                       PIC X(234).
  6345
  6346     12  PB-RECORD-STATUS.
  6347         16  PB-CREDIT-SELECT-DT          PIC XX.
  6348         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6349         16  PB-BILLED-DT                 PIC XX.
  6350         16  PB-BILLING-STATUS            PIC X.
  6351             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6352             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6353             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6354         16  PB-RECORD-BILL               PIC X.
  6355             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6356             88  PB-RECORD-RETURNED           VALUE 'R'.
  6357             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6358             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6359             88  PB-OVERRIDE-AH               VALUE 'A'.
  6360             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6361         16  PB-BATCH-ENTRY               PIC X.
  6362             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6363             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6364             88  PB-REISSUED-CERT             VALUE 'E'.
  6365             88  PB-CASH-CERT                 VALUE 'C'.
  6366             88  PB-MONTHLY-CERT              VALUE 'M'.
  6367             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6368             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6369             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6370         16  PB-FORCE-CODE                PIC X.
  6371             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6372             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6373             88  PB-CANCEL-FORCE              VALUE '8'.
  6374             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 119
* EL6311.cbl
  6375             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6376             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6377             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6378             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6379             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6380             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6381         16  PB-FATAL-FLAG                PIC X.
  6382             88  PB-FATAL-ERRORS              VALUE 'X'.
  6383         16  PB-FORCE-ER-CD               PIC X.
  6384             88  PB-FORCE-ERRORS              VALUE 'F'.
  6385             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6386         16  PB-WARN-ER-CD                PIC X.
  6387             88  PB-WARNING-ERRORS            VALUE 'W'.
  6388         16  FILLER                       PIC X.
  6389         16  PB-OUT-BAL-CD                PIC X.
  6390             88  PB-OUT-OF-BAL                VALUE 'O'.
  6391         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6392         16  PB-AH-OVERRIDE-L1            PIC X.
  6393         16  PB-INPUT-DT                  PIC XX.
  6394         16  PB-INPUT-BY                  PIC X(4).
  6395         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6396         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6397         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6398         16  PB-LF-EARNING-METHOD         PIC X.
  6399         16  PB-AH-EARNING-METHOD         PIC X.
  6400         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6401         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6402         16  PB-REIN-CD                   PIC XXX.
  6403         16  PB-LF-REFUND-TYPE            PIC X.
  6404         16  PB-AH-REFUND-TYPE            PIC X.
  6405         16  PB-ACCT-EFF-DT               PIC XX.
  6406         16  PB-ACCT-EXP-DT               PIC XX.
  6407         16  PB-COMPANY-ID                PIC X(3).
  6408         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6409         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6410         16  PB-SV-CARRIER                PIC X.
  6411         16  PB-SV-GROUPING               PIC X(6).
  6412         16  PB-SV-STATE                  PIC XX.
  6413         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6414         16  PB-GA-BILLING-INFO.
  6415             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6416                                          PIC XX.
  6417         16  PB-SV-REMIT-TO  REDEFINES
  6418             PB-GA-BILLING-INFO           PIC X(10).
  6419         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6420         16  PB-I-LOAN-OFFICER            PIC X(5).
  6421         16  PB-I-VIN                     PIC X(17).
  6422
  6423         16  FILLER                       PIC X(04).
  6424         16  IMNET-BYPASS-SW              PIC X.
  6425
  6426******************************************************************
  6427*                COMMON EDIT ERRORS                              *
  6428******************************************************************
  6429
  6430     12  PB-COMMON-ERRORS.
  6431         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6432                                           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 120
* EL6311.cbl
  6433
  6434******************************************************************
  6435*                                COPY ELCCERT.
  6436******************************************************************
  6437*                                                                *
  6438*                            ELCCERT.                            *
  6439*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6440*                            VMOD=2.013                          *
  6441*                                                                *
  6442*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6443*                                                                *
  6444*   FILE TYPE = VSAM,KSDS                                        *
  6445*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6446*                                                                *
  6447*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6448*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6449*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6450*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6451*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6452*                                                                *
  6453*   LOG = YES                                                    *
  6454*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6455******************************************************************
  6456*                   C H A N G E   L O G
  6457*
  6458* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6459*-----------------------------------------------------------------
  6460*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6461* EFFECTIVE    NUMBER
  6462*-----------------------------------------------------------------
  6463* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6464* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6465* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6466* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6467* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6468* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6469* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6470* 032612  CR2011110200001  PEMA  AHL CHANGES
  6471* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6472******************************************************************
  6473
  6474 01  CERTIFICATE-MASTER.
  6475     12  CM-RECORD-ID                      PIC XX.
  6476         88  VALID-CM-ID                      VALUE 'CM'.
  6477
  6478     12  CM-CONTROL-PRIMARY.
  6479         16  CM-COMPANY-CD                 PIC X.
  6480         16  CM-CARRIER                    PIC X.
  6481         16  CM-GROUPING.
  6482             20  CM-GROUPING-PREFIX        PIC X(3).
  6483             20  CM-GROUPING-PRIME         PIC X(3).
  6484         16  CM-STATE                      PIC XX.
  6485         16  CM-ACCOUNT.
  6486             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6487             20  CM-ACCOUNT-PRIME          PIC X(6).
  6488         16  CM-CERT-EFF-DT                PIC XX.
  6489         16  CM-CERT-NO.
  6490             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 121
* EL6311.cbl
  6491             20  CM-CERT-SFX               PIC X.
  6492
  6493     12  CM-CONTROL-BY-NAME.
  6494         16  CM-COMPANY-CD-A1              PIC X.
  6495         16  CM-INSURED-LAST-NAME          PIC X(15).
  6496         16  CM-INSURED-INITIALS.
  6497             20  CM-INSURED-INITIAL1       PIC X.
  6498             20  CM-INSURED-INITIAL2       PIC X.
  6499
  6500     12  CM-CONTROL-BY-SSN.
  6501         16  CM-COMPANY-CD-A2              PIC X.
  6502         16  CM-SOC-SEC-NO.
  6503             20  CM-SSN-STATE              PIC XX.
  6504             20  CM-SSN-ACCOUNT            PIC X(6).
  6505             20  CM-SSN-LN3.
  6506                 25  CM-INSURED-INITIALS-A2.
  6507                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6508                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6509                 25 CM-PART-LAST-NAME-A2         PIC X.
  6510
  6511     12  CM-CONTROL-BY-CERT-NO.
  6512         16  CM-COMPANY-CD-A4              PIC X.
  6513         16  CM-CERT-NO-A4                 PIC X(11).
  6514
  6515     12  CM-CONTROL-BY-MEMB.
  6516         16  CM-COMPANY-CD-A5              PIC X.
  6517         16  CM-MEMBER-NO.
  6518             20  CM-MEMB-STATE             PIC XX.
  6519             20  CM-MEMB-ACCOUNT           PIC X(6).
  6520             20  CM-MEMB-LN4.
  6521                 25  CM-INSURED-INITIALS-A5.
  6522                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6523                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6524                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6525
  6526     12  CM-INSURED-PROFILE-DATA.
  6527         16  CM-INSURED-FIRST-NAME.
  6528             20  CM-INSURED-1ST-INIT       PIC X.
  6529             20  FILLER                    PIC X(9).
  6530         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6531         16  CM-INSURED-SEX                PIC X.
  6532             88  CM-SEX-MALE                  VALUE 'M'.
  6533             88  CM-SEX-FEMAL                 VALUE 'F'.
  6534         16  CM-INSURED-JOINT-AGE          PIC 99.
  6535         16  CM-JOINT-INSURED-NAME.
  6536             20  CM-JT-LAST-NAME           PIC X(15).
  6537             20  CM-JT-FIRST-NAME.
  6538                 24  CM-JT-1ST-INIT        PIC X.
  6539                 24  FILLER                PIC X(9).
  6540             20  CM-JT-INITIAL             PIC X.
  6541
  6542     12  CM-LIFE-DATA.
  6543         16  CM-LF-BENEFIT-CD              PIC XX.
  6544         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6545         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6546         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6547         16  CM-LF-DEV-CODE                PIC XXX.
  6548         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 122
* EL6311.cbl
  6549         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6550         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6551         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6552         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6553         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6554         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6555         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6556         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6557         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6558         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6559         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6560         16  cm-temp-epiq                  pic xx.
  6561             88  EPIQ-CLASS                  value 'EQ'.
  6562*        16  FILLER                        PIC XX.
  6563
  6564     12  CM-AH-DATA.
  6565         16  CM-AH-BENEFIT-CD              PIC XX.
  6566         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6567         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6568         16  CM-AH-DEV-CODE                PIC XXX.
  6569         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6570         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6571         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6572         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6573         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6574         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6575         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6576         16  CM-AH-PAID-THRU-DT            PIC XX.
  6577             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6578         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6579         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6580         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6581         16  FILLER                        PIC X.
  6582
  6583     12  CM-LOAN-INFORMATION.
  6584         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6585         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6586                                           PIC S9(5)V99  COMP-3.
  6587         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6588         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6589         16  CM-PAY-FREQUENCY              PIC S99.
  6590         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6591         16  CM-RATE-CLASS                 PIC XX.
  6592         16  CM-BENEFICIARY                PIC X(25).
  6593         16  CM-POLICY-FORM-NO             PIC X(12).
  6594         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6595         16  CM-LAST-ADD-ON-DT             PIC XX.
  6596         16  CM-DEDUCTIBLE-AMOUNTS.
  6597             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6598             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6599         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6600             20  CM-RESIDENT-STATE         PIC XX.
  6601             20  CM-RATE-CODE              PIC X(4).
  6602             20  FILLER                    PIC XX.
  6603         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6604             20  CM-LOAN-OFFICER           PIC X(5).
  6605             20  FILLER                    PIC XXX.
  6606         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 123
* EL6311.cbl
  6607         16  CM-UNDERWRITING-CODE          PIC X.
  6608             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6609         16  CM-POST-CARD-IND              PIC X.
  6610         16  CM-NH-INTERFACE-SW            PIC X.
  6611         16  CM-PREMIUM-TYPE               PIC X.
  6612             88  CM-SING-PRM                  VALUE '1'.
  6613             88  CM-O-B-COVERAGE              VALUE '2'.
  6614             88  CM-OPEN-END                  VALUE '3'.
  6615         16  CM-IND-GRP-TYPE               PIC X.
  6616             88  CM-INDIVIDUAL                VALUE 'I'.
  6617             88  CM-GROUP                     VALUE 'G'.
  6618         16  CM-SKIP-CODE                  PIC X.
  6619             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6620             88  SKIP-JULY                    VALUE '1'.
  6621             88  SKIP-AUGUST                  VALUE '2'.
  6622             88  SKIP-SEPTEMBER               VALUE '3'.
  6623             88  SKIP-JULY-AUG                VALUE '4'.
  6624             88  SKIP-AUG-SEPT                VALUE '5'.
  6625             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6626             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6627             88  SKIP-JUNE                    VALUE '8'.
  6628             88  SKIP-JUNE-JULY               VALUE '9'.
  6629             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6630             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6631         16  CM-PAYMENT-MODE               PIC X.
  6632             88  PAY-MONTHLY                  VALUE SPACE.
  6633             88  PAY-WEEKLY                   VALUE '1'.
  6634             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6635             88  PAY-BI-WEEKLY                VALUE '3'.
  6636             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6637         16  CM-LOAN-NUMBER                PIC X(8).
  6638         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6639         16  CM-OLD-LOF                    PIC XXX.
  6640*        16  CM-LOAN-OFFICER               PIC XXX.
  6641         16  CM-REIN-TABLE                 PIC XXX.
  6642         16  CM-SPECIAL-REIN-CODE          PIC X.
  6643         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6644         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6645         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6646
  6647     12  CM-STATUS-DATA.
  6648         16  CM-ENTRY-STATUS               PIC X.
  6649         16  CM-ENTRY-DT                   PIC XX.
  6650
  6651         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6652         16  CM-LF-CANCEL-DT               PIC XX.
  6653         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6654
  6655         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6656         16  CM-LF-DEATH-DT                PIC XX.
  6657         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6658
  6659         16  CM-LF-CURRENT-STATUS          PIC X.
  6660             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6661                                                'M' '4' '5' '9'.
  6662             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6663             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6664             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 124
* EL6311.cbl
  6665             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6666             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6667             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6668             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6669             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6670             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6671             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6672             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6673             88  CM-LF-DECLINED               VALUE 'D'.
  6674             88  CM-LF-VOIDED                 VALUE 'V'.
  6675
  6676         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6677         16  CM-AH-CANCEL-DT               PIC XX.
  6678         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6679
  6680         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6681         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6682         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6683
  6684         16  CM-AH-CURRENT-STATUS          PIC X.
  6685             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6686                                                'M' '4' '5' '9'.
  6687             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6688             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6689             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6690             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6691             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6692             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6693             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6694             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6695             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6696             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6697             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6698             88  CM-AH-DECLINED               VALUE 'D'.
  6699             88  CM-AH-VOIDED                 VALUE 'V'.
  6700
  6701         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6702             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6703             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6704             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6705         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6706
  6707         16  CM-ENTRY-BATCH                PIC X(6).
  6708         16  CM-LF-EXIT-BATCH              PIC X(6).
  6709         16  CM-AH-EXIT-BATCH              PIC X(6).
  6710         16  CM-LAST-MONTH-END             PIC XX.
  6711
  6712     12  CM-NOTE-SW                        PIC X.
  6713         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6714         88  CERT-NOTES-PRESENT               VALUE '1'.
  6715         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6716         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6717         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6718         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6719         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6720         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6721     12  CM-COMP-EXCP-SW                   PIC X.
  6722         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 125
* EL6311.cbl
  6723         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6724     12  CM-INSURED-ADDRESS-SW             PIC X.
  6725         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6726         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6727
  6728*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6729     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6730     12  FILLER                            PIC X.
  6731
  6732*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6733     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6734     12  FILLER                            PIC X.
  6735*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6736     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6737
  6738     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6739         88  CERT-ADDED-BATCH                 VALUE ' '.
  6740         88  CERT-ADDED-ONLINE                VALUE '1'.
  6741         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6742         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6743         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6744     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6745         88  CERT-AS-LOADED                   VALUE ' '.
  6746         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6747         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6748         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6749         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6750         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6751         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6752         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6753
  6754     12  CM-ACCOUNT-COMM-PCTS.
  6755         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6756         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6757
  6758     12  CM-USER-FIELD                     PIC X.
  6759     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6760     12  CM-CLP-STATE                      PIC XX.
  6761     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6762     12  CM-USER-RESERVED                  PIC XXX.
  6763     12  FILLER REDEFINES CM-USER-RESERVED.
  6764         16  CM-AH-CLASS-CD                PIC XX.
  6765         16  F                             PIC X.
  6766******************************************************************
  6767*                                COPY ERCNOTE.
  6768******************************************************************
  6769*                                                                *
  6770*                                                                *
  6771*                            ERCNOTE                             *
  6772*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6773*                            VMOD=2.003                          *
  6774*                                                                *
  6775*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6776*                                                                *
  6777*        FILE TYPE= VSAM,KSDS                                    *
  6778*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6779*                                                                *
  6780*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 126
* EL6311.cbl
  6781*                                                                *
  6782*        LOG = YES                                               *
  6783*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6784*                                                                *
  6785******************************************************************
  6786*                   C H A N G E   L O G
  6787*
  6788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6789*-----------------------------------------------------------------
  6790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6791* EFFECTIVE    NUMBER
  6792*-----------------------------------------------------------------
  6793* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6794*                                FILE WILL CONTAIN BILLING NOTES O
  6795******************************************************************
  6796
  6797 01  CERTIFICATE-NOTE.
  6798     12  CN-RECORD-ID                PIC  XX.
  6799         88  VALID-CN-ID                  VALUE 'CN'.
  6800
  6801     12  CN-CONTROL-PRIMARY.
  6802         16  CN-COMPANY-CD           PIC X.
  6803         16  CN-CARRIER              PIC X.
  6804         16  CN-GROUPING.
  6805             20 CN-GROUPING-PREFIX   PIC XXX.
  6806             20 CN-GROUPING-PRIME    PIC XXX.
  6807         16  CN-STATE                PIC XX.
  6808         16  CN-ACCOUNT.
  6809             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6810             20 CN-ACCOUNT-PRIME     PIC X(6).
  6811         16  CN-CERT-EFF-DT          PIC XX.
  6812         16  CN-CERT-NO.
  6813             20  CN-CERT-PRIME       PIC X(10).
  6814             20  CN-CERT-SFX         PIC X.
  6815
  6816     12  CN-BILLING-START-LINE-NO    PIC 99.
  6817     12  CN-BILLING-END-LINE-NO      PIC 99.
  6818
  6819     12  CN-LINES.
  6820         16  CN-LINE OCCURS 10       PIC X(77).
  6821
  6822     12  CN-LAST-MAINT-DT            PIC XX.
  6823     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6824     12  CN-LAST-MAINT-USER          PIC X(4).
  6825     12  FILLER                      PIC X(6).
  6826******************************************************************
  6827*                                COPY ERCPNDM.
  6828******************************************************************
  6829*                                                                *
  6830*                                                                *
  6831*                            ERCPNDM                             *
  6832*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6833*                            VMOD=2.003                          *
  6834*                                                                *
  6835*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6836*                                                                *
  6837*   FILE TYPE = VSAM,KSDS                                        *
  6838*   RECORD SIZE = 374   RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 127
* EL6311.cbl
  6839*                                                                *
  6840*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6841*   ALTERNATE PATH    = NOT USED                                 *
  6842*                                                                *
  6843*   LOG = YES                                                    *
  6844*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6845******************************************************************
  6846*                   C H A N G E   L O G
  6847*
  6848* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6849*-----------------------------------------------------------------
  6850*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6851* EFFECTIVE    NUMBER
  6852*-----------------------------------------------------------------
  6853* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6854* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6855* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6856******************************************************************
  6857
  6858 01  PENDING-MAILING-DATA.
  6859     12  PM-RECORD-ID                      PIC XX.
  6860         88  VALID-MA-ID                       VALUE 'PM'.
  6861
  6862     12  PM-CONTROL-PRIMARY.
  6863         16  PM-COMPANY-CD                 PIC X.
  6864         16  PM-ENTRY-BATCH                PIC X(6).
  6865         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6866         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6867
  6868     12  FILLER                            PIC X(14).
  6869
  6870     12  PM-ACCESS-CONTROL.
  6871         16  PM-SOURCE-SYSTEM              PIC XX.
  6872             88  PM-FROM-CREDIT                VALUE 'CR'.
  6873             88  PM-FROM-VSI                   VALUE 'VS'.
  6874             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6875             88  PM-FROM-OTHER                 VALUE 'OT'.
  6876         16  PM-RECORD-ADD-DT              PIC XX.
  6877         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6878         16  PM-LAST-MAINT-DT              PIC XX.
  6879         16  PM-LAST-MAINT-BY              PIC XXXX.
  6880         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6881
  6882     12  PM-PROFILE-INFO.
  6883         16  PM-QUALIFY-CODE-1             PIC XX.
  6884         16  PM-QUALIFY-CODE-2             PIC XX.
  6885         16  PM-QUALIFY-CODE-3             PIC XX.
  6886         16  PM-QUALIFY-CODE-4             PIC XX.
  6887         16  PM-QUALIFY-CODE-5             PIC XX.
  6888
  6889         16  PM-INSURED-LAST-NAME          PIC X(15).
  6890         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6891         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6892         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6893         16  PM-INSURED-BIRTH-DT           PIC XX.
  6894         16  PM-INSURED-SEX                PIC X.
  6895             88  PM-SEX-MALE                   VALUE 'M'.
  6896             88  PM-SEX-FEMALE                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 128
* EL6311.cbl
  6897         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6898
  6899         16  PM-ADDRESS-CORRECTED          PIC X.
  6900         16  PM-JOINT-BIRTH-DT             PIC XX.
  6901*        16  FILLER                        PIC X(12).
  6902
  6903         16  PM-ADDRESS-LINE-1             PIC X(30).
  6904         16  PM-ADDRESS-LINE-2             PIC X(30).
  6905         16  PM-CITY-STATE.
  6906             20  PM-CITY                   PIC X(28).
  6907             20  PM-STATE                  PIC XX.
  6908         16  PM-ZIP.
  6909             20  PM-ZIP-CODE.
  6910                 24  PM-ZIP-1              PIC X.
  6911                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6912                 24  FILLER                PIC X(4).
  6913             20  PM-ZIP-PLUS4              PIC X(4).
  6914         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6915             20  PM-CAN-POST1              PIC XXX.
  6916             20  PM-CAN-POST2              PIC XXX.
  6917             20  FILLER                    PIC XXX.
  6918
  6919         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6920
  6921         16  FILLER                        PIC X(03).
  6922
  6923     12  PM-CRED-BENE-INFO.
  6924         16  PM-CRED-BENE-NAME             PIC X(25).
  6925         16  PM-CRED-BENE-ADDR             PIC X(30).
  6926         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6927         16  PM-CRED-BENE-CTYST.
  6928             20  PM-CRED-BENE-CITY         PIC X(28).
  6929             20  PM-CRED-BENE-STATE        PIC XX.
  6930         16  PM-CRED-BENE-ZIP.
  6931             20  PM-CB-ZIP-CODE.
  6932                 24  PM-CB-ZIP-1           PIC X.
  6933                     88  PM-CB-CANADIAN-POST-CODE
  6934                                  VALUE 'A' THRU 'Z'.
  6935                 24  FILLER                PIC X(4).
  6936             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6937         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6938             20  PM-CB-CAN-POST1           PIC XXX.
  6939             20  PM-CB-CAN-POST2           PIC XXX.
  6940             20  FILLER                    PIC XXX.
  6941     12  PM-POST-CARD-MAIL-DATA.
  6942         16  PM-MAIL-DATA OCCURS 7.
  6943             20  PM-MAIL-TYPE              PIC X.
  6944                 88  PM-12MO-MAILING           VALUE '1'.
  6945                 88  PM-EXP-MAILING            VALUE '2'.
  6946             20  PM-MAIL-STATUS            PIC X.
  6947                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6948                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6949                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6950             20  PM-MAIL-DATE              PIC XX.
  6951     12  FILLER                            PIC XX.
  6952     12  FILLER                            PIC X(12).
  6953*    12  FILLER                            PIC X(30).
  6954
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 129
* EL6311.cbl
  6955******************************************************************
  6956*                                COPY ERCMAIL.
  6957******************************************************************
  6958*                                                                *
  6959*                                                                *
  6960*                            ERCMAIL                             *
  6961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6962*                            VMOD=2.003                          *
  6963*                                                                *
  6964*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6965*                                                                *
  6966*   FILE TYPE = VSAM,KSDS                                        *
  6967*   RECORD SIZE = 374   RECFORM = FIX                            *
  6968*                                                                *
  6969*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6970*   ALTERNATE PATH    = NOT USED                                 *
  6971*                                                                *
  6972*   LOG = YES                                                    *
  6973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6974******************************************************************
  6975*                   C H A N G E   L O G
  6976*
  6977* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6978*-----------------------------------------------------------------
  6979*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6980* EFFECTIVE    NUMBER
  6981*-----------------------------------------------------------------
  6982* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6983* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6984* 111108                   PEMA  ADD CRED BENE ADDR2
  6985******************************************************************
  6986
  6987 01  MAILING-DATA.
  6988     12  MA-RECORD-ID                      PIC XX.
  6989         88  VALID-MA-ID                       VALUE 'MA'.
  6990
  6991     12  MA-CONTROL-PRIMARY.
  6992         16  MA-COMPANY-CD                 PIC X.
  6993         16  MA-CARRIER                    PIC X.
  6994         16  MA-GROUPING.
  6995             20  MA-GROUPING-PREFIX        PIC XXX.
  6996             20  MA-GROUPING-PRIME         PIC XXX.
  6997         16  MA-STATE                      PIC XX.
  6998         16  MA-ACCOUNT.
  6999             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7000             20  MA-ACCOUNT-PRIME          PIC X(6).
  7001         16  MA-CERT-EFF-DT                PIC XX.
  7002         16  MA-CERT-NO.
  7003             20  MA-CERT-PRIME             PIC X(10).
  7004             20  MA-CERT-SFX               PIC X.
  7005
  7006     12  FILLER                            PIC XX.
  7007
  7008     12  MA-ACCESS-CONTROL.
  7009         16  MA-SOURCE-SYSTEM              PIC XX.
  7010             88  MA-FROM-CREDIT                VALUE 'CR'.
  7011             88  MA-FROM-VSI                   VALUE 'VS'.
  7012             88  MA-FROM-WARRANTY              VALUE 'WA'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 130
* EL6311.cbl
  7013             88  MA-FROM-OTHER                 VALUE 'OT'.
  7014         16  MA-RECORD-ADD-DT              PIC XX.
  7015         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7016         16  MA-LAST-MAINT-DT              PIC XX.
  7017         16  MA-LAST-MAINT-BY              PIC XXXX.
  7018         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7019
  7020     12  MA-PROFILE-INFO.
  7021         16  MA-QUALIFY-CODE-1             PIC XX.
  7022         16  MA-QUALIFY-CODE-2             PIC XX.
  7023         16  MA-QUALIFY-CODE-3             PIC XX.
  7024         16  MA-QUALIFY-CODE-4             PIC XX.
  7025         16  MA-QUALIFY-CODE-5             PIC XX.
  7026
  7027         16  MA-INSURED-LAST-NAME          PIC X(15).
  7028         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7029         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7030         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7031         16  MA-INSURED-BIRTH-DT           PIC XX.
  7032         16  MA-INSURED-SEX                PIC X.
  7033             88  MA-SEX-MALE                   VALUE 'M'.
  7034             88  MA-SEX-FEMALE                 VALUE 'F'.
  7035         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7036
  7037         16  MA-ADDRESS-CORRECTED          PIC X.
  7038         16  MA-JOINT-BIRTH-DT             PIC XX.
  7039*        16  FILLER                        PIC X(12).
  7040
  7041         16  MA-ADDRESS-LINE-1             PIC X(30).
  7042         16  MA-ADDRESS-LINE-2             PIC X(30).
  7043         16  MA-CITY-STATE.
  7044             20  MA-CITY                   PIC X(28).
  7045             20  MA-ADDR-STATE             PIC XX.
  7046         16  MA-ZIP.
  7047             20  MA-ZIP-CODE.
  7048                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7049                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7050                 24  FILLER                PIC X(4).
  7051             20  MA-ZIP-PLUS4              PIC X(4).
  7052         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7053             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7054             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7055             20  FILLER                    PIC X(3).
  7056
  7057         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7058
  7059         16  FILLER                        PIC XXX.
  7060*        16  FILLER                        PIC X(10).
  7061
  7062     12  MA-CRED-BENE-INFO.
  7063         16  MA-CRED-BENE-NAME                 PIC X(25).
  7064         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7065         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7066         16  MA-CRED-BENE-CTYST.
  7067             20  MA-CRED-BENE-CITY             PIC X(28).
  7068             20  MA-CRED-BENE-STATE            PIC XX.
  7069         16  MA-CRED-BENE-ZIP.
  7070             20  MA-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 131
* EL6311.cbl
  7071                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7072                     88  MA-CB-CANADIAN-POST-CODE
  7073                                           VALUE 'A' THRU 'Z'.
  7074                 24  FILLER                    PIC X(4).
  7075             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7076         16  MA-CB-CANADIAN-POSTAL-CODE
  7077                            REDEFINES MA-CRED-BENE-ZIP.
  7078             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7079             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7080             20  FILLER                        PIC X(3).
  7081     12  MA-POST-CARD-MAIL-DATA.
  7082         16  MA-MAIL-DATA OCCURS 7.
  7083             20  MA-MAIL-TYPE              PIC X.
  7084                 88  MA-12MO-MAILING           VALUE '1'.
  7085                 88  MA-EXP-MAILING            VALUE '2'.
  7086             20  MA-MAIL-STATUS            PIC X.
  7087                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7088                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7089                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7090             20  MA-MAIL-DATE              PIC XX.
  7091     12  FILLER                            PIC XX.
  7092     12  FILLER                            PIC XX.
  7093*    12  FILLER                            PIC X(30).
  7094******************************************************************
  7095*                                COPY ERCRQST.
  7096******************************************************************
  7097*                                                                *
  7098*                                                                *
  7099*                            ERCRQST.                            *
  7100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7101*                            VMOD=2.002                          *
  7102*                                                                *
  7103*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7104*                                                                *
  7105*   FILE TYPE = VSAM,KSDS                                        *
  7106*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7107*                                                                *
  7108*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7109*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7110*                                   ACCOUNT, REF, BATCH)         *
  7111*                                                RKP=9, LEN=38   *
  7112*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7113*                                   ACCOUNT, REF, BATCH)         *
  7114*                                                RKP=47, LEN=46  *
  7115*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7116*                                   BATCH)                       *
  7117*                                                RKP=93, LEN=24  *
  7118*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7119*                                   REF, BATCH)                  *
  7120*                                                RKP=117, LEN=35 *
  7121*   LOG = NO                                                     *
  7122*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7123******************************************************************
  7124
  7125 01  AR-REQUEST-RECORD.
  7126     12  RQ-RECORD-ID                     PIC XX.
  7127         88  VALID-RQ-ID                        VALUE 'RQ'.
  7128
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 132
* EL6311.cbl
  7129     12  RQ-CONTROL-PRIMARY.
  7130         16  RQ-COMPANY-CD                PIC X.
  7131         16  RQ-ENTRY-BATCH               PIC X(6).
  7132
  7133     12  RQ-CONTROL-BY-ACCT-REF.
  7134         16  RQ-COMPANY-CD-A1             PIC X.
  7135         16  RQ-CARRIER-A1                PIC X.
  7136         16  RQ-GROUPING-A1               PIC X(6).
  7137         16  RQ-STATE-A1                  PIC XX.
  7138         16  RQ-ACCOUNT-A1                PIC X(10).
  7139         16  RQ-REFERENCE-A1              PIC X(12).
  7140         16  RQ-BATCH-A1                  PIC X(6).
  7141
  7142     12  RQ-CONTROL-BY-FIN-RESP.
  7143         16  RQ-COMPANY-CD-A2             PIC X.
  7144         16  RQ-CARRIER-A2                PIC X.
  7145         16  RQ-GROUPING-A2               PIC X(6).
  7146         16  RQ-FIN-RESP-A2               PIC X(10).
  7147         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7148         16  RQ-REFERENCE-A2              PIC X(12).
  7149         16  RQ-BATCH-A2                  PIC X(6).
  7150
  7151     12  RQ-CONTROL-BY-ACCT-AGENT.
  7152         16  RQ-COMPANY-CD-A3             PIC X.
  7153         16  RQ-CARRIER-A3                PIC X.
  7154         16  RQ-GROUPING-A3               PIC X(6).
  7155         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7156         16  RQ-BATCH-A3                  PIC X(6).
  7157
  7158     12  RQ-CONTROL-BY-SUMMARY.
  7159         16  RQ-COMPANY-CD-A4             PIC X.
  7160         16  RQ-SUMMARY-CODE              PIC X(6).
  7161         16  RQ-ACCOUNT-A4                PIC X(10).
  7162         16  RQ-REFERENCE-A4              PIC X(12).
  7163         16  RQ-BATCH-A4                  PIC X(6).
  7164
  7165     12  RQ-REQUEST-METHOD                PIC X.
  7166         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7167         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7168         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7169         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7170     12  FILLER                           PIC X.
  7171     12  RQ-STATUS                        PIC X.
  7172         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7173         88  RQ-RESUBMIT                      VALUE 'R'.
  7174     12  RQ-PROCESSOR-ID                  PIC X(4).
  7175     12  RQ-ENTRY-DT                      PIC XX.
  7176     12  RQ-MO-END-DT                     PIC XX.
  7177     12  RQ-REQUEST-DT                    PIC XX.
  7178     12  RQ-STMT-DT                       PIC XX.
  7179     12  RQ-REVERSAL-DT                   PIC XX.
  7180     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7181     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7182
  7183     12  FILLER                           PIC X(27).
  7184
  7185******************************************************************
  7186
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 133
* EL6311.cbl
  7187*                                COPY ERCLOFC.
  7188******************************************************************
  7189*                                                                *
  7190*                                                                *
  7191*                            ERCLOFC                             *
  7192*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7193*                            VMOD=2.003                          *
  7194*                                                                *
  7195*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7196*                                                                *
  7197*   FILE TYPE = VSAM,KSDS                                        *
  7198*   RECORD SIZE = 670   RECFORM = FIX                            *
  7199*                                                                *
  7200*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7201*                                                                *
  7202*   LOG = YES                                                    *
  7203*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7204*                                                                *
  7205******************************************************************
  7206
  7207 01  LOAN-OFFICER-MASTER.
  7208     12  LO-RECORD-ID                PIC XX.
  7209         88  VALID-LO-ID                VALUE 'LO'.
  7210
  7211     12  LO-CONTROL-PRIMARY.
  7212         16  LO-COMPANY-CD           PIC X.
  7213         16  LO-CARRIER              PIC X.
  7214         16  LO-GROUPING.
  7215             20  LO-GROUPING-PREFIX  PIC XXX.
  7216             20  LO-GROUPING-PRIME   PIC XXX.
  7217         16  LO-STATE                PIC XX.
  7218         16  LO-ACCOUNT.
  7219             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7220             20  LO-ACCOUNT-PRIME    PIC X(6).
  7221         16  LO-OFFICER-CODE         PIC X(5).
  7222
  7223     12  LO-OFFICER-NAME             PIC X(30).
  7224
  7225     12  LO-LAST-MAINT-DT            PIC XX.
  7226     12  LO-LAST-USER                PIC X(4).
  7227     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7228
  7229     12  LO-COMP-CONTROL             PIC X.
  7230             88  LO-SHOW-COMP           VALUE 'Y'.
  7231             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7232     12  LO-DETAIL-CONTROL           PIC X.
  7233             88  LO-PRINT-DETAIL        VALUE 'D'.
  7234             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7235
  7236     12  LO-SV-CARRIER               PIC X.
  7237     12  LO-SV-GROUPING              PIC X(6).
  7238     12  LO-SV-STATE                 PIC XX.
  7239
  7240     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7241     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7242
  7243     12  LO-OFFICER-INFO.
  7244         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 134
* EL6311.cbl
  7245             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7246             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7247             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7248             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7249             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7250             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7251             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7252             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7253     12  FILLER                      PIC X(198).
  7254******************************************************************
  7255*                                COPY ERCPYAJ.
  7256******************************************************************
  7257*                                                                *
  7258*                            ERCPYAJ                             *
  7259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7260*                            VMOD=2.015                          *
  7261*                                                                *
  7262*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7263*                                                                *
  7264*                                                                *
  7265*   FILE TYPE = VSAM,KSDS                                        *
  7266*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7267*                                                                *
  7268*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7269*       ALTERNATE PATHS = NONE                                   *
  7270*                                                                *
  7271*   LOG = YES                                                    *
  7272*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7273******************************************************************
  7274******************************************************************
  7275*                   C H A N G E   L O G
  7276*
  7277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7278*-----------------------------------------------------------------
  7279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7280* EFFECTIVE    NUMBER
  7281*-----------------------------------------------------------------
  7282* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7283* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7284******************************************************************
  7285
  7286 01  PENDING-PAY-ADJ.
  7287     12  PY-RECORD-ID                     PIC XX.
  7288         88  VALID-PY-ID                        VALUE 'PY'.
  7289
  7290     12  PY-CONTROL-PRIMARY.
  7291         16  PY-COMPANY-CD                PIC X.
  7292         16  PY-CARRIER                   PIC X.
  7293         16  PY-GROUPING                  PIC X(6).
  7294         16  PY-FIN-RESP                  PIC X(10).
  7295         16  PY-ACCOUNT                   PIC X(10).
  7296         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7297                                          PIC X(10).
  7298         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7299         16  PY-RECORD-TYPE               PIC X.
  7300             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7301             88  PY-DEPOSIT                   VALUE 'D'.
  7302             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 135
* EL6311.cbl
  7303             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7304             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7305             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7306             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7307             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7308             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7309             88  PY-FICA-ENTRY                VALUE 'F'.
  7310             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7311             88  PY-POLICY-FEE                VALUE 'W'.
  7312             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7313
  7314     12  PY-PYMT-TYPE                     PIC X.
  7315             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7316             88  PY-REINS-PYMT                VALUE 'R'.
  7317             88  PY-EXP-PYMT                  VALUE 'E'.
  7318
  7319     12  PY-BIL-INV                       PIC X(6).
  7320     12  PY-REF-NO                        PIC X(12).
  7321
  7322     12  PY-LAST-MAINT-DT                 PIC XX.
  7323     12  PY-LAST-MAINT-BY                 PIC X(4).
  7324     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7325
  7326     12  PY-PYADJ-RECORD.
  7327         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7328         16  PY-ENTRY-COMMENT             PIC X(30).
  7329         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7330             20  PY-GL-ACCOUNT            PIC X(10).
  7331             20  PY-GL-STATE              PIC X(02).
  7332             20  PY-GL-CANC-SW            PIC X(01).
  7333                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7334                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7335             20  PY-GL-COMMENT            PIC X(10).
  7336             20  FILLER      REDEFINES PY-GL-COMMENT.
  7337                 24  PY-GL-CHECK-NO       PIC 9(06).
  7338                 24  FILLER               PIC X(04).
  7339             20  FILLER                   PIC X(07).
  7340         16  PY-SAVE-ACCOUNT              PIC X(10).
  7341         16  PY-SAVE-TYPE                 PIC X(01).
  7342
  7343         16  PY-LETTERS.
  7344             20  PY-LETTER OCCURS 3 TIMES
  7345                           INDEXED BY PY-LET-NDX
  7346                                          PIC X(04).
  7347
  7348         16  PY-ERCOMP-TYPE               PIC X.
  7349             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7350             88  PY-GA-TYPE                   VALUE 'G'.
  7351             88  PY-BANK-TYPE                 VALUE 'B'.
  7352         16  FILLER                       PIC X(05).
  7353
  7354     12  PY-RECORD-STATUS.
  7355         16  PY-CREDIT-SELECT-DT          PIC XX.
  7356         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7357         16  PY-BILLED-DATE               PIC XX.
  7358         16  PY-REPORTED-DT               PIC XX.
  7359         16  PY-PMT-APPLIED               PIC X.
  7360             88  PY-ACCOUNT-PMT               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 136
* EL6311.cbl
  7361             88  PY-GA-PMT                    VALUE 'G'.
  7362             88  PY-OVWRITE-PMT               VALUE 'O'.
  7363             88  PY-NON-AR-PMT                VALUE 'N'.
  7364         16  FILLER                       PIC X(5).
  7365         16  PY-INPUT-DT                  PIC XX.
  7366         16  PY-CHECK-NUMBER              PIC X(6).
  7367         16  PY-VOID-SW                   PIC X.
  7368             88  PY-CHECK-VOIDED              VALUE 'V'.
  7369         16  PY-CHECK-ORIGIN-SW           PIC X.
  7370             88  PY-BILLING-CHECK             VALUE 'B'.
  7371             88  PY-REFUND-CHECK              VALUE 'R'.
  7372             88  PY-GA-CHECK                  VALUE 'G'.
  7373             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7374             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7375         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7376         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7377         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7378         16  PY-BILL-FLAG                 PIC X.
  7379             88  PY-BILLED                    VALUE 'B'.
  7380         16  PY-AR-FLAG                   PIC X.
  7381             88  PY-AR-CYCLE                  VALUE 'C'.
  7382             88  PY-AR-MONTH-END              VALUE 'M'.
  7383         16  PY-AR-DATE                   PIC XX.
  7384
  7385     12  PY-GL-CODES.
  7386         16  PY-GL-DB                     PIC X(14).
  7387         16  PY-GL-CR                     PIC X(14).
  7388         16  PY-GL-FLAG                   PIC X.
  7389         16  PY-GL-DATE                   PIC XX.
  7390
  7391     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7392     12  FILLER                           PIC X(3).
  7393******************************************************************
  7394*                                COPY ERCCNOT.
  7395******************************************************************
  7396*                                                                *
  7397*                            ERCCNOT                             *
  7398*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7399*                            VMOD=2.003                          *
  7400*                                                                *
  7401*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7402*                                                                *
  7403*        FILE TYPE= VSAM,KSDS                                    *
  7404*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7405*                                                                *
  7406*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7407*                                                                *
  7408*        LOG = YES                                               *
  7409*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7410*                                                                *
  7411******************************************************************
  7412*                   C H A N G E   L O G
  7413*
  7414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7415*-----------------------------------------------------------------
  7416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7417* EFFECTIVE    NUMBER
  7418*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 137
* EL6311.cbl
  7419* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7420******************************************************************
  7421
  7422 01  CERT-NOTE-FILE.
  7423     12  CZ-RECORD-ID                PIC  XX.
  7424         88  VALID-CZ-ID                  VALUE 'CZ'.
  7425
  7426     12  CZ-CONTROL-PRIMARY.
  7427         16  CZ-COMPANY-CD           PIC X.
  7428         16  CZ-CARRIER              PIC X.
  7429         16  CZ-GROUPING.
  7430             20 CZ-GROUPING-PREFIX   PIC XXX.
  7431             20 CZ-GROUPING-PRIME    PIC XXX.
  7432         16  CZ-STATE                PIC XX.
  7433         16  CZ-ACCOUNT.
  7434             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7435             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7436         16  CZ-CERT-EFF-DT          PIC XX.
  7437         16  CZ-CERT-NO.
  7438             20  CZ-CERT-PRIME       PIC X(10).
  7439             20  CZ-CERT-SFX         PIC X.
  7440         16  CZ-RECORD-TYPE          PIC X.
  7441             88  CERT-NOTE           VALUE '1'.
  7442             88  CLAIM-CERT-NOTE     VALUE '2'.
  7443         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7444
  7445     12  CZ-LAST-MAINT-DT            PIC XX.
  7446     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7447     12  CZ-LAST-MAINT-USER          PIC X(4).
  7448
  7449     12  CZ-NOTE-INFORMATION.
  7450         16  CZ-NOTE                 PIC X(63).
  7451         16  FILLER                  PIC X(39).
  7452******************************************************************
  7453*                                COPY ELCMSTR.
  7454******************************************************************
  7455*                                                                *
  7456*                            ELCMSTR.                            *
  7457*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7458*                            VMOD=2.012                          *
  7459*                                                                *
  7460*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7461*                                                                *
  7462*   FILE TYPE = VSAM,KSDS                                        *
  7463*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7464*                                                                *
  7465*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7466*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7467*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7468*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7469*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7470*                                                 RKP=75,LEN=21  *
  7471*                                                                *
  7472*   **** NOTE ****                                               *
  7473*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7474*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7475*                                                                *
  7476*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 138
* EL6311.cbl
  7477*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7478******************************************************************
  7479*                   C H A N G E   L O G
  7480*
  7481* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7482*-----------------------------------------------------------------
  7483*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7484* EFFECTIVE    NUMBER
  7485*-----------------------------------------------------------------
  7486* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7487* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7488* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7489* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7490* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7491******************************************************************
  7492 01  CLAIM-MASTER.
  7493     12  CL-RECORD-ID                PIC XX.
  7494         88  VALID-CL-ID         VALUE 'CL'.
  7495
  7496     12  CL-CONTROL-PRIMARY.
  7497         16  CL-COMPANY-CD           PIC X.
  7498         16  CL-CARRIER              PIC X.
  7499         16  CL-CLAIM-NO             PIC X(7).
  7500         16  CL-CERT-NO.
  7501             20  CL-CERT-PRIME       PIC X(10).
  7502             20  CL-CERT-SFX         PIC X.
  7503
  7504     12  CL-CONTROL-BY-NAME.
  7505         16  CL-COMPANY-CD-A1        PIC X.
  7506         16  CL-INSURED-LAST-NAME    PIC X(15).
  7507         16  CL-INSURED-NAME.
  7508             20  CL-INSURED-1ST-NAME PIC X(12).
  7509             20  CL-INSURED-MID-INIT PIC X.
  7510
  7511     12  CL-CONTROL-BY-SSN.
  7512         16  CL-COMPANY-CD-A2        PIC X.
  7513         16  CL-SOC-SEC-NO.
  7514             20  CL-SSN-STATE        PIC XX.
  7515             20  CL-SSN-ACCOUNT      PIC X(6).
  7516             20  CL-SSN-LN3          PIC X(3).
  7517
  7518     12  CL-CONTROL-BY-CERT-NO.
  7519         16  CL-COMPANY-CD-A4        PIC X.
  7520         16  CL-CERT-NO-A4.
  7521             20  CL-CERT-A4-PRIME    PIC X(10).
  7522             20  CL-CERT-A4-SFX      PIC X.
  7523
  7524     12  CL-CONTROL-BY-CCN.
  7525         16  CL-COMPANY-CD-A5        PIC X.
  7526         16  CL-CCN-A5.
  7527             20  CL-CCN.
  7528                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7529                 24  CL-CCN-PRIME-A5 PIC X(12).
  7530             20  CL-CCN-FILLER-A5    PIC X(4).
  7531
  7532     12  CL-INSURED-PROFILE-DATA.
  7533         16  CL-INSURED-BIRTH-DT     PIC XX.
  7534         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 139
* EL6311.cbl
  7535             88  INSURED-IS-MALE        VALUE 'M'.
  7536             88  INSURED-IS-FEMALE      VALUE 'F'.
  7537             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7538         16  CL-INSURED-OCC-CD       PIC X(6).
  7539         16  FILLER                  PIC X(5).
  7540
  7541     12  CL-PROCESSING-INFO.
  7542         16  CL-PROCESSOR-ID         PIC X(4).
  7543         16  CL-CLAIM-STATUS         PIC X.
  7544             88  CLAIM-IS-OPEN          VALUE 'O'.
  7545             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7546         16  CL-CLAIM-TYPE           PIC X.
  7547*            88  AH-CLAIM               VALUE 'A'.
  7548*            88  LIFE-CLAIM             VALUE 'L'.
  7549*            88  PROPERTY-CLAIM         VALUE 'P'.
  7550*            88  IUI-CLAIM              VALUE 'I'.
  7551*            88  GAP-CLAIM              VALUE 'G'.
  7552*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7553         16  CL-CLAIM-PREM-TYPE      PIC X.
  7554             88  SINGLE-PREMIUM         VALUE '1'.
  7555             88  O-B-COVERAGE           VALUE '2'.
  7556             88  OPEN-END-COVERAGE      VALUE '3'.
  7557         16  CL-INCURRED-DT          PIC XX.
  7558         16  CL-REPORTED-DT          PIC XX.
  7559         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7560         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7561         16  CL-LAST-PMT-DT          PIC XX.
  7562         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7563         16  CL-PAID-THRU-DT         PIC XX.
  7564         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7565         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7566         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7567         16  CL-PMT-CALC-METHOD      PIC X.
  7568             88  CL-360-DAY-YR          VALUE '1'.
  7569             88  CL-365-DAY-YR          VALUE '2'.
  7570             88  CL-FULL-MONTHS         VALUE '3'.
  7571         16  CL-CAUSE-CD             PIC X(6).
  7572
  7573         16  CL-PRIME-CERT-NO.
  7574             20  CL-PRIME-CERT-PRIME PIC X(10).
  7575             20  CL-PRIME-CERT-SFX   PIC X.
  7576
  7577         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7578             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7579             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7580
  7581         16  CL-MICROFILM-NO         PIC X(10).
  7582         16  FILLER REDEFINES CL-MICROFILM-NO.
  7583             20  CL-BENEFIT-PERIOD   PIC 99.
  7584             20  FILLER              PIC X(8).
  7585         16  CL-PROG-FORM-TYPE       PIC X.
  7586         16  CL-LAST-ADD-ON-DT       PIC XX.
  7587
  7588         16  CL-LAST-REOPEN-DT       PIC XX.
  7589         16  CL-LAST-CLOSE-DT        PIC XX.
  7590         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7591             88  FINAL-PAID             VALUE '1'.
  7592             88  CLAIM-DENIED           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 140
* EL6311.cbl
  7593             88  AUTO-CLOSE             VALUE '3'.
  7594             88  MANUAL-CLOSE           VALUE '4'.
  7595             88  BENEFITS-CHANGED       VALUE 'C'.
  7596             88  SETUP-ERRORS           VALUE 'E'.
  7597         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7598         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7599         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7600             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7601         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7602         16  FILLER                  PIC X.
  7603
  7604     12  CL-CERTIFICATE-DATA.
  7605         16  CL-CERT-ORIGIN          PIC X.
  7606             88  CERT-WAS-ONLINE        VALUE '1'.
  7607             88  CERT-WAS-CREATED       VALUE '2'.
  7608             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7609         16  CL-CERT-KEY-DATA.
  7610             20  CL-CERT-CARRIER     PIC X.
  7611             20  CL-CERT-GROUPING    PIC X(6).
  7612             20  CL-CERT-STATE       PIC XX.
  7613             20  CL-CERT-ACCOUNT.
  7614                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7615                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7616             20  CL-CERT-EFF-DT      PIC XX.
  7617
  7618     12  CL-STATUS-CONTROLS.
  7619         16  CL-PRIORITY-CD          PIC X.
  7620             88  CONFIDENTIAL-DATA      VALUE '8'.
  7621             88  HIGHEST-PRIORITY       VALUE '9'.
  7622         16  CL-SUPV-ATTN-CD         PIC X.
  7623             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7624             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7625         16  CL-PURGED-DT            PIC XX.
  7626         16  CL-RESTORED-DT          PIC XX.
  7627         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7628         16  CL-NEXT-RESEND-DT       PIC XX.
  7629         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7630         16  CL-CRITICAL-PERIOD      PIC 99.
  7631*        16  FILLER                  PIC XX.
  7632         16  CL-LAST-MAINT-DT        PIC XX.
  7633         16  CL-LAST-MAINT-USER      PIC X(4).
  7634         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7635         16  CL-LAST-MAINT-TYPE      PIC X.
  7636             88  CLAIM-SET-UP           VALUE ' '.
  7637             88  PAYMENT-MADE           VALUE '1'.
  7638             88  LETTER-SENT            VALUE '2'.
  7639             88  MASTER-WAS-ALTERED     VALUE '3'.
  7640             88  MASTER-WAS-RESTORED    VALUE '4'.
  7641             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7642             88  FILE-CONVERTED         VALUE '6'.
  7643             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7644             88  ERROR-CORRECTION       VALUE 'E'.
  7645         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7646         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7647         16  CL-BENEFICIARY          PIC X(10).
  7648         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7649         16  CL-DENIAL-TYPE          PIC X.
  7650             88  CL-TYPE-DENIAL          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 141
* EL6311.cbl
  7651             88  CL-TYPE-RESCISSION      VALUE '2'.
  7652             88  CL-TYPE-REFORMATION     VALUE '3'.
  7653             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7654             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7655         16  filler                  pic x(5).
  7656*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7657*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7658*        16  CL-RTW-DT               PIC XX.
  7659
  7660     12  CL-TRAILER-CONTROLS.
  7661         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7662             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7663             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7664             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7665         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7666         16  FILLER                  PIC XX.
  7667         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7668         16  CL-ADDRESS-TRAILER-CNT.
  7669             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7670                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7671             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7672                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7673             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7674                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7675             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7676                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7677             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7678                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7679             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7680                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7681             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7682                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7683
  7684     12  CL-CV-REFERENCE-NO.
  7685         16  CL-CV-REFNO-PRIME       PIC X(18).
  7686         16  CL-CV-REFNO-SFX         PIC XX.
  7687
  7688     12  CL-FILE-LOCATION            PIC X(4).
  7689
  7690     12  CL-PROCESS-ERRORS.
  7691         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7692             88  NO-FATAL-ERRORS        VALUE ZERO.
  7693         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7694             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7695
  7696     12  CL-PRODUCT-CD               PIC X.
  7697
  7698     12  CL-CURRENT-KEY-DATA.
  7699         16  CL-CURRENT-CARRIER      PIC X.
  7700         16  CL-CURRENT-GROUPING     PIC X(6).
  7701         16  CL-CURRENT-STATE        PIC XX.
  7702         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7703
  7704     12  CL-ASSOCIATES               PIC X.
  7705         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7706         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7707         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7708         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 142
* EL6311.cbl
  7709
  7710     12  CL-ACTIVITY-CODE            PIC 99.
  7711     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7712     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7713
  7714     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7715     12  CL-LAG-REPORT-CODE          PIC 9.
  7716     12  CL-LOAN-TYPE                PIC XX.
  7717     12  CL-LEGAL-STATE              PIC XX.
  7718
  7719     12  CL-YESNOSW                  PIC X.
  7720     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7721         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7722         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7723         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7724     12  cl-insured-type             pic x.
  7725         88  cl-claim-on-primary         value 'P'.
  7726         88  cl-claim-on-co-borrower     value 'C'.
  7727     12  cl-benefit-expiration-dt    PIC XX.
  7728*                                COPY ERCENDT.
  7729******************************************************************
  7730*                                                                *
  7731*                                                                *
  7732*                            ERCENDT.                            *
  7733*                            VMOD=2.001                          *
  7734*                                                                *
  7735*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7736*                                                                *
  7737*   FILE TYPE = VSAM,KSDS                                        *
  7738*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7739*                                                                *
  7740*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7741*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7742*                                                                *
  7743*   LOG = NO                                                     *
  7744*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7745******************************************************************
  7746*-----------------------------------------------------------------
  7747*                   C H A N G E   L O G
  7748*
  7749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7750*-----------------------------------------------------------------
  7751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7752* EFFECTIVE    NUMBER
  7753*-----------------------------------------------------------------
  7754* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7755*                                WITH OPEN CLAIMS
  7756* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7757* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7758* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7759*-----------------------------------------------------------------
  7760 01  ENDORSEMENT-RECORD.
  7761     12  EN-RECORD-ID                PIC XX.
  7762         88  VALID-EN-ID                VALUE 'EN'.
  7763     12  EN-CONTROL-PRIMARY.
  7764         16  EN-COMPANY-CD           PIC X.
  7765         16  EN-CARRIER              PIC X.
  7766         16  EN-GROUPING             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 143
* EL6311.cbl
  7767         16  EN-STATE                PIC XX.
  7768         16  EN-ACCOUNT              PIC X(10).
  7769         16  EN-CERT-EFF-DT          PIC XX.
  7770         16  EN-CERT-NO.
  7771             20  EN-CERT-PRIME       PIC X(10).
  7772             20  EN-CERT-SFX         PIC X.
  7773         16  EN-REC-TYPE             PIC X.
  7774             88  EN-ISSUE               VALUE 'I'.
  7775             88  EN-CANCELLATION        VALUE 'C'.
  7776         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7777     12  EN-CONTROL-BY-ARCH-NO.
  7778         16  EN-COMPANY-CD-A1              PIC X.
  7779         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7780     12  EN-LAST-MAINT-DT            PIC XX.
  7781     12  EN-LAST-MAINT-BY            PIC X(4).
  7782     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7783     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7784     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7785         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7786         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7787         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7788         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7789         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7790         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7791         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7792         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7793         16  EN-LF-ORIG-BENCD        PIC XX.
  7794         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7795         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7796         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7797         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7798         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7799         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7800*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7801         16  EN-ORIG-CRED-BENE       PIC X(25).
  7802         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7803         16  FILLER                  PIC X.
  7804         16  EN-AH-ORIG-BENCD        PIC XX.
  7805         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7806         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7807         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7808         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7809*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7810*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7811         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7812         16  F                       PIC X(09).
  7813         16  EN-AH-ORIG-CP           PIC 99.
  7814         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7815         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7816         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7817         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7818         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7819         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7820         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7821         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7822         16  EN-LF-NEW-BENCD         PIC XX.
  7823         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7824         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 144
* EL6311.cbl
  7825         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7826         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7827         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7828         16  EN-LF-NEW-EXP-DT        PIC XX.
  7829         16  EN-NEW-CRED-BENE        PIC X(25).
  7830         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7831         16  FILLER                  PIC X.
  7832         16  EN-AH-NEW-BENCD         PIC XX.
  7833         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7834         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7835         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7836         16  EN-AH-NEW-EXP-DT        PIC XX.
  7837*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7838*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7839*        16  F                       PIC X(12).
  7840         16  EN-AH-NEW-CP            PIC 99.
  7841         16  EN-SIG-SW               PIC X.
  7842         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7843         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7844         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7845         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7846         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7847         16  FILLER                  PIC X(33).
  7848     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7849         16  EN-LF-ORIG-REF-DT       PIC XX.
  7850         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7851         16  EN-AH-ORIG-REF-DT       PIC XX.
  7852         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7853         16  EN-LF-NEW-REF-DT        PIC XX.
  7854         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7855         16  EN-AH-NEW-REF-DT        PIC XX.
  7856         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7857         16  EN-FLAG-CERT            PIC X.
  7858         16  EN-INS-LAST-NAME        PIC X(15).
  7859         16  EN-INS-FIRST-NAME       PIC X(10).
  7860         16  EN-INS-MIDDLE-INIT      PIC X.
  7861         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7862         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7863         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7864         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7865         16  FILLER                  PIC X(262).
  7866     12  EN-MONEY-SW             PIC X.
  7867     12  EN-HEALTH-APP           PIC X.
  7868     12  EN-VOUCHER-SW           PIC X.
  7869     12  EN-PAYEE                PIC X(14).
  7870     12  EN-INPUT-DT             PIC XX.
  7871     12  EN-PROCESS-DT           PIC XX.
  7872     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7873     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7874     12  EN-REASON-CODES.
  7875         16  F OCCURS 12.
  7876             20  EN-REASON-CODE  PIC X(4).
  7877     12  EN-TEMPLATE-USED        PIC X(8).
  7878     12  EN-DOCU-TYPE            PIC X.
  7879         88  EN-VERI-DOCU          VALUE 'V'.
  7880         88  EN-GCE-DOCU           VALUE 'G'.
  7881         88  EN-CANC-DOCU          VALUE 'C'.
  7882     12  EN-COMMENTS1            PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 145
* EL6311.cbl
  7883     12  EN-COMMENTS2            PIC X(70).
  7884     12  EN-COMM-CHGBK           PIC X.
  7885         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7886         88  EN-CHG-ACCT           VALUE 'Y'.
  7887     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7888     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7889     12  EN-BATCH-NUMBER         PIC X(6).
  7890     12  EN-ACCT-SUMM            PIC X.
  7891     12  EN-CSO-SUMM             PIC X.
  7892     12  FILLER                  PIC X(13).
  7893******************************************************************
  7894*                                COPY ELCCRTT.
  7895******************************************************************
  7896*                                                                *
  7897*                            ELCCRTT.                            *
  7898*                                                                *
  7899*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7900*                                                                *
  7901*   FILE TYPE = VSAM,KSDS                                        *
  7902*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7903*                                                                *
  7904*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7905*                                                                *
  7906*   LOG = YES                                                    *
  7907*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7908******************************************************************
  7909*                   C H A N G E   L O G
  7910*
  7911* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7912*-----------------------------------------------------------------
  7913*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7914* EFFECTIVE    NUMBER
  7915*-----------------------------------------------------------------
  7916* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7917* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7918* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7919* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7920* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7921* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7922* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7923* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7924******************************************************************
  7925
  7926 01  CERTIFICATE-TRAILERS.
  7927     12  CS-RECORD-ID                      PIC XX.
  7928         88  VALID-CS-ID                      VALUE 'CS'.
  7929
  7930     12  CS-CONTROL-PRIMARY.
  7931         16  CS-COMPANY-CD                 PIC X.
  7932         16  CS-CARRIER                    PIC X.
  7933         16  CS-GROUPING                   PIC X(6).
  7934         16  CS-STATE                      PIC XX.
  7935         16  CS-ACCOUNT                    PIC X(10).
  7936         16  CS-CERT-EFF-DT                PIC XX.
  7937         16  CS-CERT-NO.
  7938             20  CS-CERT-PRIME             PIC X(10).
  7939             20  CS-CERT-SFX               PIC X.
  7940         16  CS-TRAILER-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 146
* EL6311.cbl
  7941             88  COMM-TRLR           VALUE 'A'.
  7942             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7943             88  CERT-DATA-TRLR      VALUE 'C'.
  7944
  7945     12  CS-DATA-AREA                      PIC X(516).
  7946
  7947     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7948         16  CS-BANK-COMMISSION-AREA.
  7949             20  CS-BANK-COMMS       OCCURS 10.
  7950                 24  CS-AGT                PIC X(10).
  7951                 24  CS-COM-TYP            PIC X.
  7952                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7953                 24  CS-RECALC-LV-INDIC    PIC X.
  7954                 24  FILLER                PIC X(10).
  7955         16  FILLER                        PIC X(256).
  7956
  7957     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7958****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7959         16  CS-MB-CLAIM-DATA OCCURS 24.
  7960             20  CS-CLAIM-NO               PIC X(7).
  7961             20  CS-CLAIM-TYPE             PIC X.
  7962                 88  CS-AH-CLM               VALUE 'A'.
  7963                 88  CS-IU-CLM               VALUE 'I'.
  7964                 88  CS-GP-CLM               VALUE 'G'.
  7965                 88  CS-LF-CLM               VALUE 'L'.
  7966                 88  CS-PR-CLM               VALUE 'P'.
  7967                 88  CS-FL-CLM               VALUE 'F'.
  7968             20  CS-INSURED-TYPE           PIC X.
  7969                 88  CS-PRIM-INSURED          VALUE 'P'.
  7970                 88  CS-CO-BORROWER           VALUE 'C'.
  7971             20  CS-BENEFIT-PERIOD         PIC 99.
  7972             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7973             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7974             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7975         16  FILLER                        PIC X(12).
  7976     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7977         16  CS-VIN-NUMBER                 PIC X(17).
  7978         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7979         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7980         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7981         16  cs-agent-name.
  7982             20  cs-agent-fname            pic x(20).
  7983             20  cs-agent-mi               pic x.
  7984             20  cs-agent-lname            pic x(25).
  7985         16  cs-license-no                 pic x(15).
  7986         16  cs-npn-number                 pic x(10).
  7987         16  cs-agent-edit-status          pic x.
  7988             88  cs-ae-refer-to-manager      value 'M'.
  7989             88  cs-ae-cover-sheet           value 'C'.
  7990             88  cs-ae-sig-form              value 'S'.
  7991             88  cs-ae-verified              value 'V'.
  7992             88  cs-unidentified-signature   value 'U'.
  7993             88  cs-cert-returned            value 'R'.
  7994             88  cs-accept-no-commission     value 'N'.
  7995         16  FILLER                        PIC X(424).
  7996*        16  FILLER                        PIC X(496).
  7997*                                COPY ERCCHEK.
  7998******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 147
* EL6311.cbl
  7999*                                                                *
  8000*                                                                *
  8001*                            ERCCHEK                             *
  8002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8003*                            VMOD=2.008                          *
  8004*                                                                *
  8005*   FILE DESCRIPTION = CHECK RECORDS                             *
  8006*                                                                *
  8007*   FILE TYPE = VSAM,KSDS                                        *
  8008*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8009*                                                                *
  8010*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8011*       ALTERNATE INDEX = NONE                                   *
  8012*                                                                *
  8013*   LOG = YES                                                    *
  8014*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8015******************************************************************
  8016*                   C H A N G E   L O G
  8017*
  8018* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8019*-----------------------------------------------------------------
  8020*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8021* EFFECTIVE    NUMBER
  8022*-----------------------------------------------------------------
  8023* 021414    2003053000001  PEMA  changes for auto chk request
  8024******************************************************************
  8025 01  CHECK-RECORDS.
  8026     12  CH-RECORD-ID                      PIC XX.
  8027         88  VALID-CH-ID                      VALUE 'CH'.
  8028
  8029     12  CH-CONTROL-PRIMARY.
  8030         16  CH-COMPANY-CD                 PIC X.
  8031         16  CH-CARRIER                    PIC X.
  8032         16  CH-GROUPING                   PIC X(6).
  8033         16  CH-STATE                      PIC XX.
  8034         16  CH-ACCOUNT                    PIC X(10).
  8035         16  CH-CERT-EFF-DT                PIC XX.
  8036         16  CH-CERT-NO.
  8037             20  CH-CERT-PRIME             PIC X(10).
  8038             20  CH-CERT-SFX               PIC X.
  8039         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8040
  8041     12  CH-RECORDED-DT                    PIC XX.
  8042     12  CH-RECORDED-BY                    PIC X(4).
  8043     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8044
  8045     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8046     12  CH-CHECK-NO                       PIC X(7).
  8047     12  CH-REASON-FOR-CHECK               PIC X(25).
  8048     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8049     12  FILLER                            PIC X.
  8050
  8051     12  CH-PAYEE-INFO.
  8052         16  CH-PAYEE-NAME-1               PIC X(30).
  8053         16  CH-PAYEE-NAME-2               PIC X(30).
  8054         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8055         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8056         16  CH-PAYEE-CITY-ST.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 148
* EL6311.cbl
  8057             20  CH-PAYEE-CITY             PIC X(28).
  8058             20  CH-PAYEE-STATE            PIC XX.
  8059         16  CH-PAYEE-ZIP-CODE.
  8060             20  CH-PAYEE-ZIP.
  8061                 24  CH-ZIP-PRI-1ST        PIC X.
  8062                     88  CH-CANADIAN-POST-CODE
  8063                                           VALUES 'A' THRU 'Z'.
  8064                 24  FILLER                PIC X(4).
  8065             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8066         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8067             20  CH-CAN-POSTAL-1           PIC XXX.
  8068             20  CH-CAN-POSTAL-2           PIC XXX.
  8069             20  FILLER                    PIC XXX.
  8070
  8071     12  CH-CHECK-STUB-TEXT.
  8072         16  CH-STUB-LINE-1                PIC X(30).
  8073         16  CH-TEXT-LINE-1                PIC X(50).
  8074         16  CH-TEXT-LINE-2                PIC X(50).
  8075         16  CH-TEXT-LINE-3                PIC X(40).
  8076     12  CH-RETURN-TO                      PIC X(30).
  8077
  8078     12  CH-COMPENSATION-CONTROL.
  8079         16  CH-COMP-CARRIER               PIC X.
  8080         16  CH-COMP-GROUPING              PIC X(6).
  8081         16  CH-COMP-FIN-RESP              PIC X(10).
  8082         16  CH-COMP-ACCOUNT               PIC X(10).
  8083
  8084     12  CH-CREDIT-SELECT-DT               PIC XX.
  8085     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8086     12  CH-PAYEE-CODE                     PIC X(6).
  8087
  8088     12  CH-VOID-DATA.
  8089         20  CH-VOID-DT                    PIC XX.
  8090         20  CH-VOID-BY                    PIC X(4).
  8091         20  CH-VOID-REASON                PIC X(25).
  8092
  8093     12  CH-APPROVAL-DATA.
  8094         20  CH-APPROVAL-DT                PIC XX.
  8095         20  CH-APPROVAL-STATUS            PIC X.
  8096             88  CH-IN-LIMBO                  VALUE ' '.
  8097             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8098             88  CH-APPROVED                  VALUE 'A'.
  8099             88  CH-DENIED                    VALUE 'D'.
  8100         20  CH-APPROVED-BY                PIC XXXX.
  8101     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8102             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8103     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8104
  8105     12  ch-released-dt                    pic xx.
  8106     12  ch-check-cashed-dt                pic xx.
  8107     12  FILLER                            PIC X.
  8108*    12  CH-CHECK-REFERENCE                PIC X(12).
  8109     12  CH-CHECK-ORIGIN-SW                PIC X.
  8110             88  CH-REFUND-CHECK              VALUE 'R'.
  8111             88  CH-MAINT-CHECK               VALUE 'M'.
  8112
  8113     12  CH-CANC-DT                        PIC XX.
  8114     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 149
* EL6311.cbl
  8115     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8116
  8117     12  CH-INSURED-NAME                   PIC X(28).
  8118
  8119     12  ch-released-by                    pic x(4).
  8120     12  ch-csr                            pic x(4).
  8121     12  ch-deduct-commission              pic x.
  8122         88  ch-deduct-comm                  value 'Y'.
  8123         88  ch-do-not-deduct-comm           value 'N'.
  8124
  8125     12  FILLER                            PIC X(11).
  8126*    12  CH-LETTER-TABLE.
  8127*        16  CH-LETTERS OCCURS 3 TIMES
  8128*                       INDEXED BY CH-LT-NDX
  8129*                                          PIC X(04).
  8130
  8131     12  FILLER                            PIC X(07).
  8132
  8133 01  var                         pic x(30).
  8134 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8135                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8136                          PENDING-MAILING-DATA MAILING-DATA
  8137                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8138                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8139                          CLAIM-MASTER ENDORSEMENT-RECORD
  8140                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8141                          VAR.
  8142 0000-DFHEXIT SECTION.
  8143     MOVE '9#                    $   ' TO DFHEIV0.
  8144     MOVE 'EL6311' TO DFHEIV1.
  8145     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8146
  8147     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8148     MOVE EIBTRMID               TO QID-TERM.
  8149     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8150     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8151     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8152     MOVE 2                      TO EMI-SWITCH2.
  8153
  8154     move spaces to ws-kix-myenv
  8155     set P to address of KIXSYS
  8156     CALL "getenv" using by value P returning var-ptr
  8157     if var-ptr = null then
  8158        display ' kixsys not set '
  8159     else
  8160        set address of var to var-ptr
  8161        move 0 to env-var-len
  8162        inspect var tallying env-var-len
  8163          for characters before X'00'
  8164        unstring var (1:env-var-len) delimited by '/'
  8165           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8166              WS-KIX-SYS
  8167        end-unstring
  8168     end-if
  8169     perform varying a1 from +1 by +1 until a1 > +10
  8170        if ws-kix-myenv (a1:1) = low-values or high-values
  8171           display ' found low or hi val '
  8172           move spaces to ws-kix-myenv (a1:1)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 150
* EL6311.cbl
  8173        end-if
  8174     end-perform
  8175*    display ' env *' ws-kix-myenv '*'
  8176     IF EIBCALEN = 0
  8177         GO TO 8800-UNAUTHORIZED-ACCESS.
  8178
  8179     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8180     MOVE '5'                   TO DC-OPTION-CODE.
  8181     PERFORM 9700-DATE-LINK.
  8182     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8183     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8184
  8185     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8186     MOVE SPACE                  TO DC-OPTION-CODE.
  8187     PERFORM 9700-DATE-LINK.
  8188     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8189     MOVE LOW-VALUES             TO EL631BI.
  8190
  8191
  8192* EXEC CICS HANDLE CONDITION
  8193*        PGMIDERR  (9600-PGMID-ERROR)
  8194*        ERROR     (9990-ABEND)
  8195*        INVREQ    (9990-ABEND)
  8196*        QIDERR    (0010-MAIN-LOGIC)
  8197*    END-EXEC.
  8198*    MOVE '"$L.8N                ! " #00008187' TO DFHEIV0
  8199     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8201     MOVE X'2220233030303038313837' TO DFHEIV0(25:11)
  8202     CALL 'kxdfhei1' USING DFHEIV0
  8203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8204
  8205
  8206     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8207         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8208             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8209             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8210             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8211             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8212             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8213             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8214             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8215             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8216
  8217             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8218                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8219
  8220             ELSE
  8221                 NEXT SENTENCE
  8222
  8223         ELSE
  8224             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8225             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8226             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8227             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8228             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8229             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8230             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 151
* EL6311.cbl
  8231             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8232             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8233             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8234             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8235             GO TO 3900-RE-DISPLAY-RECORD
  8236     ELSE
  8237         GO TO 0020-MAIN-LOGIC.
  8238
  8239 0010-MAIN-LOGIC.
  8240     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8241                                    WS-FIRST-ENTRY-SW.
  8242
  8243     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8244
  8245     MOVE LOW-VALUES             TO EC-NEW-CERT
  8246                                    EC-NEW-STATE.
  8247
  8248     IF PI-DISPLAY-ORIGINAL-BATCH
  8249         NEXT SENTENCE
  8250     ELSE
  8251         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8252             GO TO 5000-BROWSE-BATCH-HEADERS.
  8253
  8254     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8255         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8256
  8257     IF PI-CSR-BROWSE
  8258        GO TO 4200-BROWSE-CSR-FORWARD.
  8259
  8260     IF PI-FILE-BROWSE
  8261         GO TO 4300-BROWSE-FILE-FORWARD.
  8262
  8263     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8264
  8265 0020-MAIN-LOGIC.
  8266     IF EIBAID = DFHCLEAR
  8267         GO TO 9400-CLEAR.
  8268
  8269     MOVE LOW-VALUES             TO EC-NEW-CERT
  8270                                    EC-NEW-STATE.
  8271
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 152
* EL6311.cbl
  8273
  8274******************************************************************
  8275*                                                                *
  8276*              R E C E I V E   M A P                             *
  8277*                                                                *
  8278******************************************************************
  8279
  8280 0200-RECEIVE.
  8281     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8282         MOVE ER-0008            TO EMI-ERROR
  8283         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8284         IF PI-MAP-NAME = EL631B
  8285             MOVE -1                 TO BMAINTL
  8286             GO TO 8200-SEND-DATAONLY
  8287         ELSE
  8288             IF PI-MAP-NAME = EL631C
  8289                 MOVE -1                 TO CMAINTL
  8290                 GO TO 8200-SEND-DATAONLY
  8291             ELSE
  8292                 IF PI-MAP-NAME = EL631D
  8293                     MOVE -1                 TO DPFENTRL
  8294                     GO TO 8200-SEND-DATAONLY.
  8295
  8296
  8297* EXEC CICS RECEIVE
  8298*        MAP      (PI-MAP-NAME)
  8299*        MAPSET   (MAPSET-EL6311S)
  8300*        INTO     (EL631BI)
  8301*    END-EXEC.
  8302     MOVE LENGTH OF
  8303      EL631BI
  8304       TO DFHEIV11
  8305*    MOVE '8"T I  L              ''   #00008284' TO DFHEIV0
  8306     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8307     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8308     MOVE X'2020233030303038323834' TO DFHEIV0(25:11)
  8309     CALL 'kxdfhei1' USING DFHEIV0,
  8310           PI-MAP-NAME,
  8311           EL631BI,
  8312           DFHEIV11,
  8313           MAPSET-EL6311S,
  8314           DFHEIV99,
  8315           DFHEIV99
  8316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8317
  8318
  8319******************************************************************
  8320*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8321******************************************************************
  8322
  8323     IF BTYPE-LEN (1) EQUAL +3
  8324        IF BTYPE (1) EQUAL ALL ' '
  8325            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8326
  8327     IF BTYPE-LEN (2) EQUAL +3
  8328        IF BTYPE (2) EQUAL ALL ' '
  8329            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8330
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 153
* EL6311.cbl
  8331     INSPECT EL631BI CONVERTING '_' TO ' '.
  8332
  8333     IF PI-MAP-NAME = EL631B
  8334         IF BPFENTRL GREATER THAN ZEROS
  8335             IF EIBAID NOT = DFHENTER
  8336                 MOVE ER-0004       TO EMI-ERROR
  8337                 MOVE -1            TO BPFENTRL
  8338                 MOVE AL-UNBOF      TO BPFENTRA
  8339                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8340                 GO TO 8200-SEND-DATAONLY
  8341             ELSE
  8342                 IF BPFENTRI NUMERIC AND
  8343                   (BPFENTRI GREATER 0 AND LESS 25)
  8344                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8345                 ELSE
  8346                     MOVE ER-0029  TO EMI-ERROR
  8347                     MOVE AL-UNBON TO BPFENTRA
  8348                     MOVE -1       TO BPFENTRL
  8349                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8350                     GO TO 8200-SEND-DATAONLY
  8351         ELSE
  8352             NEXT SENTENCE
  8353     ELSE
  8354         IF PI-MAP-NAME = EL631C
  8355            IF CPFENTRL GREATER THAN ZEROS
  8356                IF EIBAID NOT = DFHENTER
  8357                 MOVE ER-0004         TO EMI-ERROR
  8358                 MOVE -1              TO CPFENTRL
  8359                 MOVE AL-UNBOF        TO CPFENTRA
  8360                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8361                 GO TO 8200-SEND-DATAONLY
  8362             ELSE
  8363                 IF CPFENTRI NUMERIC AND
  8364                   (CPFENTRI GREATER 0 AND LESS 25)
  8365                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8366                 ELSE
  8367                     MOVE ER-0029      TO EMI-ERROR
  8368                     MOVE AL-UNBON     TO CPFENTRA
  8369                     MOVE -1           TO CPFENTRL
  8370                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8371                     GO TO 8200-SEND-DATAONLY
  8372         ELSE
  8373             NEXT SENTENCE
  8374     ELSE
  8375     IF PI-MAP-NAME = EL631D
  8376         IF DPFENTRL GREATER THAN ZEROS
  8377             IF EIBAID NOT = DFHENTER
  8378                 MOVE ER-0004         TO EMI-ERROR
  8379                 MOVE -1              TO DPFENTRL
  8380                 MOVE AL-UNBOF        TO DPFENTRA
  8381                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8382                 GO TO 8200-SEND-DATAONLY
  8383             ELSE
  8384                 IF DPFENTRI NUMERIC AND
  8385                   (DPFENTRI GREATER 0 AND LESS 25)
  8386                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8387                 ELSE
  8388                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 154
* EL6311.cbl
  8389                     MOVE AL-UNBON     TO DPFENTRA
  8390                     MOVE -1           TO DPFENTRL
  8391                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8392                     GO TO 8200-SEND-DATAONLY.
  8393
  8394     IF EIBAID = DFHPF23
  8395         GO TO 8810-PF23.
  8396
  8397     IF EIBAID = DFHPF24
  8398         GO TO 9200-RETURN-MAIN-MENU.
  8399
  8400     IF EIBAID = DFHPF12
  8401         GO TO 9500-PF12.
  8402
  8403     IF PI-MAP-NAME = EL631B
  8404        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8405
  8406     IF PI-MAP-NAME = EL631C
  8407        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8408
  8409     IF PI-MAP-NAME = EL631D
  8410        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8411
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 155
* EL6311.cbl
  8413
  8414******************************************************************
  8415*                                                                *
  8416*      ISSUE SCREEN PF KEY CHECKING                              *
  8417*                                                                *
  8418******************************************************************
  8419
  8420******************************************************************
  8421*                                                                *
  8422*      PF KEY FUNCTIONS:                                         *
  8423*                                                                *
  8424*      PF1  = BROWSE FORWARD                                     *
  8425*      PF2  = BROWSE BACKWARD                                    *
  8426*      PF3  = CERTIFICATE LOOKUP                                 *
  8427*      PF4  = DISPLAY BATCH HEADER                               *
  8428*      PF5  = ADD ISSUE  SCREEN                                  *
  8429*      PF6  = ADD CANCEL SCREEN                                  *
  8430*      PF7  = CERTIFICATE DISPLAY                                *
  8431*      PF8  = CERTIFICATE NOTES                                  *
  8432*      PF9  = EDIT CONTROL                                       *
  8433*      PF10 = DISPLAY LETTER SCREEN                              *
  8434*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8435*      PF12 = HELP SCREEN                                        *
  8436*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8437*      PF14 = ACCOUNT MASTER                                     *
  8438*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8439*      PF16 = DISPLAY LETTER REVIEW                              *
  8440*                                                                *
  8441******************************************************************
  8442
  8443 0300-CHECK-ISSUE-PF-KEYS.
  8444     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8445        MOVE ER-2337            TO EMI-ERROR
  8446        MOVE -1                  TO BMAINTL
  8447        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8448        GO TO 8200-SEND-DATAONLY.
  8449
  8450     IF EIBAID = DFHPF1
  8451        MOVE '0'                TO PI-EDIT-SW
  8452        IF PI-PRIMARY-BROWSE
  8453           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8454        ELSE
  8455           IF PI-PRIMARY-WITH-SELECT
  8456              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8457           ELSE
  8458              IF PI-FILE-BROWSE
  8459                 GO TO 4300-BROWSE-FILE-FORWARD
  8460              ELSE
  8461                 IF PI-CSR-BROWSE
  8462                    GO TO 4200-BROWSE-CSR-FORWARD
  8463                 ELSE
  8464                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8465
  8466     IF EIBAID = DFHPF2
  8467        MOVE '0'                TO PI-EDIT-SW
  8468        IF PI-PRIMARY-BROWSE
  8469           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8470        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 156
* EL6311.cbl
  8471           IF PI-PRIMARY-WITH-SELECT
  8472              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8473           ELSE
  8474              IF PI-FILE-BROWSE
  8475                 GO TO 4800-BROWSE-FILE-BACKWARD
  8476              ELSE
  8477                 IF PI-CSR-BROWSE
  8478                    GO TO 4900-BROWSE-CSR-BACKWARD
  8479                 ELSE
  8480                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8481
  8482     IF EIBAID = DFHPF3
  8483        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8484        MOVE XCTL-EL127         TO PGM-NAME
  8485        GO TO 9300-XCTL.
  8486
  8487     IF (EIBAID = DFHPF15 OR DFHPF6)
  8488        AND (CSR-EDIT-SESSION)
  8489*       AND (FATAL-OR-UNFORCED)
  8490        AND (FATAL-ERRORS)
  8491        MOVE ER-1819             TO EMI-ERROR
  8492        MOVE -1                  TO BMAINTL
  8493        MOVE AL-UANON            TO BMAINTA
  8494        PERFORM 9900-ERROR-FORMAT
  8495                                 THRU 9900-EXIT
  8496        GO TO 8200-SEND-DATAONLY
  8497     END-IF
  8498     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8499      OR (EIBAID = DFHPF10)
  8500        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8501        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8502        IF (RESP-NORMAL)
  8503           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8504              AM-CONTROL-PRIMARY (1:20))
  8505            IF AM-NAME NOT GREATER THAN SPACES OR
  8506               AM-ADDRS NOT GREATER THAN SPACES  OR
  8507               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8508               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8509               AM-ZIP NOT GREATER THAN SPACES
  8510               MOVE ER-3834             TO EMI-ERROR
  8511               MOVE -1                  TO BMAINTL
  8512               MOVE AL-UANON            TO BMAINTA
  8513               PERFORM 9900-ERROR-FORMAT
  8514                                 THRU 9900-EXIT
  8515               GO TO 8200-SEND-DATAONLY
  8516            END-IF
  8517        ELSE
  8518           MOVE ER-1609             TO EMI-ERROR
  8519           MOVE -1                  TO BMAINTL
  8520           MOVE AL-UANON            TO BMAINTA
  8521           PERFORM 9900-ERROR-FORMAT
  8522                                THRU 9900-EXIT
  8523           GO TO 8200-SEND-DATAONLY
  8524        END-IF
  8525
  8526        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8527        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8528        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 157
* EL6311.cbl
  8529            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8530               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8531               MA-CITY NOT GREATER THAN SPACES OR
  8532               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8533               MA-ZIP-CODE NOT GREATER THAN SPACES
  8534               MOVE ER-3835             TO EMI-ERROR
  8535               MOVE -1                  TO BMAINTL
  8536               MOVE AL-UANON            TO BMAINTA
  8537               PERFORM 9900-ERROR-FORMAT
  8538                                 THRU 9900-EXIT
  8539               GO TO 8200-SEND-DATAONLY
  8540            END-IF
  8541        ELSE
  8542           MOVE ER-3000             TO EMI-ERROR
  8543           MOVE -1                  TO BMAINTL
  8544           MOVE AL-UANON            TO BMAINTA
  8545           PERFORM 9900-ERROR-FORMAT
  8546                                THRU 9900-EXIT
  8547           GO TO 8200-SEND-DATAONLY
  8548        END-IF
  8549
  8550     END-IF
  8551     IF (EIBAID = DFHPF15)
  8552        AND (CSR-EDIT-SESSION)
  8553        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8554        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8555        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8556        MOVE PI-SV-STATE         TO PI-STATE
  8557        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8558        MOVE BCERTNOI            TO PI-CERT-PRIME
  8559        MOVE BSUFIXI             TO PI-CERT-SFX
  8560        MOVE BEFFDTI             TO DEEDIT-FIELD
  8561        PERFORM 8600-DEEDIT
  8562        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8563        MOVE '4'                 TO DC-OPTION-CODE
  8564        PERFORM 9700-DATE-LINK
  8565        IF DATE-CONVERSION-ERROR
  8566           MOVE ER-0348          TO EMI-ERROR
  8567           MOVE -1               TO BEFFDTL
  8568           MOVE AL-UABON         TO BEFFDTA
  8569           PERFORM 9900-ERROR-FORMAT
  8570                                 THRU 9900-EXIT
  8571           GO TO 8200-SEND-DATAONLY
  8572        ELSE
  8573           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8574           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8575           MOVE XCTL-EL6315      TO PGM-NAME
  8576           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8577           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8578           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8579           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8580           GO TO 9300-XCTL
  8581        END-IF
  8582     END-IF
  8583
  8584     IF EIBAID = DFHPF4
  8585        MOVE '0'                TO PI-EDIT-SW
  8586        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 158
* EL6311.cbl
  8587           NEXT SENTENCE
  8588        ELSE
  8589           GO TO 7200-DISPLAY-BATCHES.
  8590
  8591     IF EIBAID = DFHPF5
  8592        MOVE ER-0029                TO EMI-ERROR
  8593        MOVE -1                     TO BPFENTRL
  8594        MOVE AL-UNBON               TO BPFENTRA
  8595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8596        GO TO 8200-SEND-DATAONLY.
  8597*        MOVE '0'                TO PI-EDIT-SW
  8598*        IF PI-DISPLAY-ORIGINAL-BATCH
  8599*           NEXT SENTENCE
  8600*        ELSE
  8601*           MOVE EL631B              TO PI-MAP-NAME
  8602*           MOVE LOW-VALUES          TO EL631BI
  8603*           MOVE 'A'                 TO BMAINTO
  8604*           MOVE AL-UANON            TO BMAINTA
  8605*           MOVE -1                  TO BMAINTL
  8606*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8607*           GO TO 8100-SEND-INITIAL-MAP.
  8608
  8609     IF EIBAID = DFHPF6
  8610        IF NOT CSR-EDIT-SESSION
  8611           MOVE ER-0029                TO EMI-ERROR
  8612           MOVE -1                     TO BPFENTRL
  8613           MOVE AL-UNBON               TO BPFENTRA
  8614           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8615           GO TO 8200-SEND-DATAONLY
  8616*           MOVE '0'              TO PI-EDIT-SW
  8617*           IF PI-DISPLAY-ORIGINAL-BATCH
  8618*              NEXT SENTENCE
  8619*           ELSE
  8620*              MOVE EL631C        TO PI-MAP-NAME
  8621*              MOVE LOW-VALUES    TO EL631CI
  8622*              MOVE 'A'           TO CMAINTO
  8623*              MOVE AL-UANON      TO CMAINTA
  8624*              MOVE -1            TO CMAINTL
  8625*              MOVE '6'           TO PI-MAINT-FUNCTION
  8626*              GO TO 8100-SEND-INITIAL-MAP
  8627*           END-IF
  8628        ELSE
  8629           PERFORM 5100-PROCESS-POL-RESC
  8630                                 THRU 5100-EXIT
  8631           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8632           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8633                                    PI-PREV-SEQ-NO
  8634           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8635*                                    WS-CANCEL-LETTER-SW
  8636                                    PI-ALL-ISSUES-SW
  8637                                    PI-ALL-CANCELS-SW
  8638           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8639        END-IF
  8640     END-IF
  8641     IF EIBAID = DFHPF7
  8642        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8643        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8644        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 159
* EL6311.cbl
  8645        MOVE PI-SV-STATE            TO PI-STATE
  8646        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8647        MOVE BCERTNOI               TO PI-CERT-PRIME
  8648        MOVE BSUFIXI                TO PI-CERT-SFX
  8649        MOVE BEFFDTI                TO DEEDIT-FIELD
  8650        PERFORM 8600-DEEDIT
  8651        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8652        MOVE '4'                    TO DC-OPTION-CODE
  8653        PERFORM 9700-DATE-LINK
  8654        IF DATE-CONVERSION-ERROR
  8655           MOVE ER-0348            TO EMI-ERROR
  8656           MOVE -1                  TO BEFFDTL
  8657           MOVE AL-UABON            TO BEFFDTA
  8658           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8659           GO TO 8200-SEND-DATAONLY
  8660        ELSE
  8661           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8662           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8663           MOVE XCTL-EL1273        TO PGM-NAME
  8664           GO TO 9300-XCTL.
  8665
  8666     IF EIBAID = DFHPF8
  8667        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8668        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8669        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8670        MOVE PI-SV-STATE            TO PI-STATE
  8671        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8672        MOVE BCERTNOI               TO PI-CERT-PRIME
  8673        MOVE BSUFIXI                TO PI-CERT-SFX
  8674        MOVE BEFFDTI                TO DEEDIT-FIELD
  8675        PERFORM 8600-DEEDIT
  8676        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8677        MOVE '4'                    TO DC-OPTION-CODE
  8678        PERFORM 9700-DATE-LINK
  8679        IF DATE-CONVERSION-ERROR
  8680           MOVE ER-0348            TO EMI-ERROR
  8681           MOVE -1                  TO BEFFDTL
  8682           MOVE AL-UABON            TO BEFFDTA
  8683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8684           GO TO 8200-SEND-DATAONLY
  8685        ELSE
  8686           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8687           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8688           IF PI-COMPANY-ID = 'DMD'
  8689               MOVE XCTL-EL401DMD      TO PGM-NAME
  8690             ELSE
  8691               MOVE XCTL-EL1279        TO PGM-NAME
  8692           END-IF
  8693           GO TO 9300-XCTL.
  8694
  8695     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8696        MOVE XCTL-EL6312         TO PGM-NAME
  8697
  8698* EXEC CICS XCTL
  8699*           PROGRAM   (PGM-NAME)
  8700*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8701*           LENGTH    (WS-COMM-LENGTH)
  8702*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 160
* EL6311.cbl
  8703*    MOVE '.$C                   %   #00008668' TO DFHEIV0
  8704     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8705     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8706     MOVE X'2020233030303038363638' TO DFHEIV0(25:11)
  8707     CALL 'kxdfhei1' USING DFHEIV0,
  8708           PGM-NAME,
  8709           PROGRAM-INTERFACE-BLOCK,
  8710           WS-COMM-LENGTH,
  8711           DFHEIV99
  8712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8713     ELSE
  8714        MOVE '0'                 TO  PI-EDIT-SW.
  8715
  8716     IF  EIBAID = DFHPF10
  8717         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8718         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8719         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8720                                    PI-1042-WA
  8721         MOVE 4                  TO PI-689-DATA-SOURCE
  8722         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8723         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8724         MOVE PI-SV-STATE        TO PI-689-STATE
  8725         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8726         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8727         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8728         MOVE PI-PB-ALT-CHG-SEQ-NO
  8729                                 TO PI-689-ALT-SEQ-NO
  8730         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8731         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8732         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8733         MOVE +0                 TO PI-689-CONTROL
  8734         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8735                                    PI-689-EXP-DATE
  8736                                    PI-689-RESP-PERSON
  8737                                    PI-689-TYPE
  8738                                    PI-689-FOLLOW-UP-EDIT
  8739                                    PI-689-RESEND1-EDIT
  8740                                    PI-689-SEQ-EDIT
  8741                                    PI-689-BCSEQ-EDIT
  8742                                    PI-689-LBL-OVERRIDE
  8743         MOVE W-LETTER-COMMUNICATION-AREAS
  8744                                 TO PI-PROGRAM-WORK-AREA
  8745         MOVE XCTL-EL689         TO PGM-NAME
  8746         GO TO 9300-XCTL.
  8747
  8748     IF  EIBAID = DFHPF16
  8749         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8750         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8751         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8752                                    PI-1042-WA
  8753         MOVE 4                  TO PI-689-DATA-SOURCE
  8754         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8755         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8756         MOVE PI-SV-STATE        TO PI-689-STATE
  8757         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8758         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8759         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8760         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 161
* EL6311.cbl
  8761                                 TO PI-689-ALT-SEQ-NO
  8762         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8763         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8764         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8765         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8766         MOVE W-LETTER-COMMUNICATION-AREAS
  8767                                 TO PI-PROGRAM-WORK-AREA
  8768         MOVE XCTL-EL690         TO PGM-NAME
  8769         GO TO 9300-XCTL.
  8770
  8771     IF EIBAID = DFHPF13
  8772         MOVE XCTL-EL6313        TO PGM-NAME
  8773         GO TO 9300-XCTL.
  8774
  8775     IF EIBAID = DFHPF17
  8776        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8777        IF (PB-I-LOAN-APR numeric)
  8778           and (pb-i-loan-apr < 99.9999)
  8779           AND (PB-I-BENEFICIARY-NAME NOT
  8780              = SPACES AND LOW-VALUES)
  8781
  8782           MOVE LINK-ELVADS          TO PGM-NAME
  8783
  8784* EXEC CICS LINK
  8785*              PROGRAM    (PGM-NAME)
  8786*              COMMAREA   (WS-PASS-AREA)
  8787*              LENGTH     (WS-PASS-AREA-LENGTH)
  8788*          END-EXEC
  8789*    MOVE '."C                   (   #00008743' TO DFHEIV0
  8790     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8792     MOVE X'2020233030303038373433' TO DFHEIV0(25:11)
  8793     CALL 'kxdfhei1' USING DFHEIV0,
  8794           PGM-NAME,
  8795           WS-PASS-AREA,
  8796           WS-PASS-AREA-LENGTH,
  8797           DFHEIV99,
  8798           DFHEIV99,
  8799           DFHEIV99,
  8800           DFHEIV99
  8801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8802
  8803           MOVE 0000             TO EMI-ERROR
  8804           MOVE -1               TO BMAINTL
  8805           PERFORM 9900-ERROR-FORMAT
  8806                                 THRU 9900-EXIT
  8807           GO TO 8200-SEND-DATAONLY
  8808        ELSE
  8809           MOVE ER-0877            TO EMI-ERROR
  8810           MOVE -1                  TO BEFFDTL
  8811           MOVE AL-UABON            TO BEFFDTA
  8812           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8813           GO TO 8200-SEND-DATAONLY
  8814        END-IF
  8815     END-IF
  8816     IF EIBAID = DFHPF14
  8817        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8818        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 162
* EL6311.cbl
  8819        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8820        MOVE PI-SV-STATE            TO PI-CR-STATE
  8821        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8822        MOVE SPACE                  TO PI-EDIT-SW
  8823        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8824        MOVE XCTL-EL650             TO PGM-NAME
  8825        GO TO 9300-XCTL.
  8826
  8827     IF EIBAID = DFHPF15
  8828        IF PI-COMPANY-ID  =  'HER'
  8829            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8830            MOVE XCTL-EL680         TO PGM-NAME
  8831            GO TO 9300-XCTL.
  8832
  8833     IF EIBAID = DFHENTER OR DFHPF11
  8834        GO TO 1000-ISSUE-MAINLINE.
  8835
  8836     MOVE ER-0029                TO EMI-ERROR
  8837     MOVE -1                     TO BPFENTRL
  8838     MOVE AL-UNBON               TO BPFENTRA
  8839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8840     GO TO 8200-SEND-DATAONLY.
  8841
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 163
* EL6311.cbl
  8843
  8844******************************************************************
  8845*                                                                *
  8846*      CANCEL SCREEN PF KEY CHECKING                             *
  8847*                                                                *
  8848******************************************************************
  8849
  8850******************************************************************
  8851*                                                                *
  8852*      PF KEY FUNCTIONS:                                         *
  8853*                                                                *
  8854*      PF1  = BROWSE FORWARD                                     *
  8855*      PF2  = BROWSE BACKWARD                                    *
  8856*      PF3  = CERTIFICATE LOOKUP                                 *
  8857*      PF4  = DISPLAY BATCH HEADER                               *
  8858*      PF5  = ADD ISSUE SCREEN                                   *
  8859*      PF6  = ADD CANCEL SCREEN                                  *
  8860*      PF7  = CERTIFICATE DISPLAY                                *
  8861*      PF8  = CERTIFICATE NOTES                                  *
  8862*      PF9  = EDIT CONTROL                                       *
  8863*      PF10 = DISPLAY LETTER SCREEN                              *
  8864*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8865*      PF12 = DISPLAY HELP SCREEN                                *
  8866*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8867*      PF14 = ACCOUNT MASTER                                     *
  8868*      PF16 = LETTER REVIEW                                      *
  8869*                                                                *
  8870******************************************************************
  8871
  8872 0400-CHECK-CANCEL-PF-KEYS.
  8873     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8874        MOVE ER-2337             TO EMI-ERROR
  8875        MOVE -1                  TO CMAINTL
  8876        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8877        GO TO 8200-SEND-DATAONLY.
  8878
  8879     IF EIBAID = DFHPF1
  8880        MOVE '0'                TO PI-EDIT-SW
  8881        IF PI-PRIMARY-BROWSE
  8882           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8883        ELSE
  8884           IF PI-PRIMARY-WITH-SELECT
  8885              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8886           ELSE
  8887              IF PI-FILE-BROWSE
  8888                 GO TO 4300-BROWSE-FILE-FORWARD
  8889              ELSE
  8890                 IF PI-CSR-BROWSE
  8891                    GO TO 4200-BROWSE-CSR-FORWARD
  8892                 ELSE
  8893                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8894
  8895     IF EIBAID = DFHPF2
  8896        MOVE '0'                TO PI-EDIT-SW
  8897        IF PI-PRIMARY-BROWSE
  8898           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8899        ELSE
  8900           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 164
* EL6311.cbl
  8901              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8902           ELSE
  8903              IF PI-FILE-BROWSE
  8904                 GO TO 4800-BROWSE-FILE-BACKWARD
  8905              ELSE
  8906                 IF PI-CSR-BROWSE
  8907                    GO TO 4900-BROWSE-CSR-BACKWARD
  8908                 ELSE
  8909                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8910
  8911     IF EIBAID = DFHPF3
  8912        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8913        MOVE XCTL-EL127         TO PGM-NAME
  8914        GO TO 9300-XCTL.
  8915
  8916     IF (EIBAID = DFHPF15 OR DFHPF17)
  8917        AND (CSR-EDIT-SESSION)
  8918*       AND (FATAL-OR-UNFORCED)
  8919        AND (FATAL-ERRORS)
  8920        MOVE ER-1819             TO EMI-ERROR
  8921        MOVE -1                  TO CMAINTL
  8922        MOVE AL-UANON            TO CMAINTA
  8923        PERFORM 9900-ERROR-FORMAT
  8924                                 THRU 9900-EXIT
  8925        GO TO 8200-SEND-DATAONLY
  8926     END-IF
  8927     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8928       AND (CSR-EDIT-SESSION)
  8929        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8930        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8931        IF (RESP-NORMAL)
  8932           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8933              AM-CONTROL-PRIMARY (1:20))
  8934            IF AM-NAME NOT GREATER THAN SPACES OR
  8935               AM-ADDRS NOT GREATER THAN SPACES  OR
  8936               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8937               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8938               AM-ZIP NOT GREATER THAN SPACES
  8939               MOVE ER-3834             TO EMI-ERROR
  8940               MOVE -1                  TO BMAINTL
  8941               MOVE AL-UANON            TO BMAINTA
  8942               PERFORM 9900-ERROR-FORMAT
  8943                                 THRU 9900-EXIT
  8944               GO TO 8200-SEND-DATAONLY
  8945            END-IF
  8946        ELSE
  8947           MOVE ER-1609             TO EMI-ERROR
  8948           MOVE -1                  TO BMAINTL
  8949           MOVE AL-UANON            TO BMAINTA
  8950           PERFORM 9900-ERROR-FORMAT
  8951                                THRU 9900-EXIT
  8952           GO TO 8200-SEND-DATAONLY
  8953        END-IF
  8954
  8955        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8956        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8957        IF (ERMAIL-FOUND)
  8958            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 165
* EL6311.cbl
  8959               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8960               MA-CITY NOT GREATER THAN SPACES OR
  8961               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8962               MA-ZIP-CODE NOT GREATER THAN SPACES
  8963               MOVE ER-3835             TO EMI-ERROR
  8964               MOVE -1                  TO BMAINTL
  8965               MOVE AL-UANON            TO BMAINTA
  8966               PERFORM 9900-ERROR-FORMAT
  8967                                 THRU 9900-EXIT
  8968               GO TO 8200-SEND-DATAONLY
  8969            END-IF
  8970        ELSE
  8971           MOVE ER-3000             TO EMI-ERROR
  8972           MOVE -1                  TO BMAINTL
  8973           MOVE AL-UANON            TO BMAINTA
  8974           PERFORM 9900-ERROR-FORMAT
  8975                                THRU 9900-EXIT
  8976           GO TO 8200-SEND-DATAONLY
  8977        END-IF
  8978
  8979     END-IF
  8980     IF (EIBAID = DFHPF15 OR DFHPF17)
  8981        AND (CSR-EDIT-SESSION)
  8982        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8983        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8984        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8985        MOVE PI-SV-STATE         TO PI-STATE
  8986        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8987        MOVE CCERTNOI            TO PI-CERT-PRIME
  8988        MOVE CSUFIXI             TO PI-CERT-SFX
  8989        MOVE CEFFDTI             TO DEEDIT-FIELD
  8990        PERFORM 8600-DEEDIT
  8991        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8992        MOVE '4'                 TO DC-OPTION-CODE
  8993        PERFORM 9700-DATE-LINK
  8994        IF DATE-CONVERSION-ERROR
  8995           MOVE ER-0348          TO EMI-ERROR
  8996           MOVE -1               TO CEFFDTL
  8997           MOVE AL-UABON         TO CEFFDTA
  8998           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8999           GO TO 8200-SEND-DATAONLY
  9000        ELSE
  9001           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9002           PERFORM 6000-CREATE-TEMP-STORAGE
  9003                                 THRU 6000-EXIT
  9004           IF EIBAID = DFHPF17
  9005               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9006                                  THRU 6400-EXIT
  9007               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9008                                 '2' AND '3' AND '4'
  9009                  MOVE ER-3831     TO  EMI-ERROR
  9010                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9011                  GO TO 8200-SEND-DATAONLY
  9012               END-IF
  9013               MOVE 'Y'          TO PI-CLM-RESC-IND
  9014           ELSE
  9015               MOVE 'N'          TO PI-CLM-RESC-IND
  9016           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 166
* EL6311.cbl
  9017           MOVE XCTL-EL6316      TO PGM-NAME
  9018           MOVE '2'              TO PI-ISS-CAN-SW
  9019           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9020           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9021           GO TO 9300-XCTL
  9022        END-IF
  9023     END-IF
  9024
  9025     IF EIBAID = DFHPF4
  9026        MOVE '0'                TO PI-EDIT-SW
  9027        IF PI-DISPLAY-ORIGINAL-BATCH
  9028           NEXT SENTENCE
  9029        ELSE
  9030           GO TO 7200-DISPLAY-BATCHES.
  9031
  9032     IF EIBAID = DFHPF5
  9033        MOVE ER-0029                TO EMI-ERROR
  9034        MOVE -1                     TO BPFENTRL
  9035        MOVE AL-UNBON               TO BPFENTRA
  9036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9037        GO TO 8200-SEND-DATAONLY.
  9038*        MOVE '0'                TO PI-EDIT-SW
  9039*        IF PI-DISPLAY-ORIGINAL-BATCH
  9040*           NEXT SENTENCE
  9041*        ELSE
  9042*           MOVE EL631B              TO PI-MAP-NAME
  9043*           MOVE LOW-VALUES          TO EL631BI
  9044*           MOVE 'A'                 TO BMAINTO
  9045*           MOVE AL-UANON            TO BMAINTA
  9046*           MOVE -1                  TO BMAINTL
  9047*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9048*           GO TO 8100-SEND-INITIAL-MAP.
  9049
  9050     IF EIBAID = DFHPF6
  9051        MOVE ER-0029                TO EMI-ERROR
  9052        MOVE -1                     TO BPFENTRL
  9053        MOVE AL-UNBON               TO BPFENTRA
  9054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9055        GO TO 8200-SEND-DATAONLY.
  9056*        MOVE '0'                TO PI-EDIT-SW
  9057*        IF PI-DISPLAY-ORIGINAL-BATCH
  9058*           NEXT SENTENCE
  9059*        ELSE
  9060*           MOVE EL631C              TO PI-MAP-NAME
  9061*           MOVE LOW-VALUES          TO EL631CI
  9062*           MOVE 'A'                 TO CMAINTO
  9063*           MOVE AL-UANON            TO CMAINTA
  9064*           MOVE -1                  TO CMAINTL
  9065*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9066*           GO TO 8100-SEND-INITIAL-MAP.
  9067
  9068     IF EIBAID = DFHPF7
  9069        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9070        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9071        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9072        MOVE PI-SV-STATE            TO PI-STATE
  9073        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9074        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 167
* EL6311.cbl
  9075        MOVE CSUFIXI                TO PI-CERT-SFX
  9076        MOVE CEFFDTI                TO DEEDIT-FIELD
  9077        PERFORM 8600-DEEDIT
  9078        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9079        MOVE '4'                    TO DC-OPTION-CODE
  9080        PERFORM 9700-DATE-LINK
  9081        IF DATE-CONVERSION-ERROR
  9082           MOVE ER-0348            TO EMI-ERROR
  9083           MOVE -1                  TO BEFFDTL
  9084           MOVE AL-UABON            TO BEFFDTA
  9085           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9086           GO TO 8200-SEND-DATAONLY
  9087        ELSE
  9088           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9089           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9090           MOVE XCTL-EL1273        TO PGM-NAME
  9091           GO TO 9300-XCTL.
  9092
  9093     IF EIBAID = DFHPF8
  9094        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9095        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9096        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9097        MOVE PI-SV-STATE            TO PI-STATE
  9098        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9099        MOVE CCERTNOI               TO PI-CERT-PRIME
  9100        MOVE CSUFIXI                TO PI-CERT-SFX
  9101        MOVE CEFFDTI                TO DEEDIT-FIELD
  9102        PERFORM 8600-DEEDIT
  9103        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9104        MOVE '4'                    TO DC-OPTION-CODE
  9105        PERFORM 9700-DATE-LINK
  9106        IF DATE-CONVERSION-ERROR
  9107           MOVE ER-0348             TO EMI-ERROR
  9108           MOVE -1                  TO BEFFDTL
  9109           MOVE AL-UABON            TO BEFFDTA
  9110           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111           GO TO 8200-SEND-DATAONLY
  9112        ELSE
  9113           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9114           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9115           IF PI-COMPANY-ID = 'DMD'
  9116               MOVE XCTL-EL401DMD      TO PGM-NAME
  9117             ELSE
  9118               MOVE XCTL-EL1279        TO PGM-NAME
  9119           END-IF
  9120           GO TO 9300-XCTL.
  9121
  9122     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9123        MOVE XCTL-EL6312     TO PGM-NAME
  9124
  9125* EXEC CICS XCTL
  9126*           PROGRAM  (PGM-NAME)
  9127*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9128*           LENGTH   (WS-COMM-LENGTH)
  9129*       END-EXEC
  9130*    MOVE '.$C                   %   #00009070' TO DFHEIV0
  9131     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9132     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 168
* EL6311.cbl
  9133     MOVE X'2020233030303039303730' TO DFHEIV0(25:11)
  9134     CALL 'kxdfhei1' USING DFHEIV0,
  9135           PGM-NAME,
  9136           PROGRAM-INTERFACE-BLOCK,
  9137           WS-COMM-LENGTH,
  9138           DFHEIV99
  9139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9140     ELSE
  9141        MOVE '0'                 TO  PI-EDIT-SW.
  9142
  9143     IF EIBAID = DFHPF10
  9144         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9145         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9146         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9147         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9148                                    PI-1042-WA
  9149         MOVE 4                  TO PI-689-DATA-SOURCE
  9150         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9151         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9152         MOVE PI-SV-STATE        TO PI-689-STATE
  9153         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9154         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9155         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9156         MOVE PI-PB-ALT-CHG-SEQ-NO
  9157                                 TO PI-689-ALT-SEQ-NO
  9158         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9159         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9160         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9161         MOVE +0                 TO PI-689-CONTROL
  9162         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9163                                    PI-689-EXP-DATE
  9164                                    PI-689-RESP-PERSON
  9165                                    PI-689-TYPE
  9166                                    PI-689-FOLLOW-UP-EDIT
  9167                                    PI-689-RESEND1-EDIT
  9168                                    PI-689-SEQ-EDIT
  9169                                    PI-689-BCSEQ-EDIT
  9170                                    PI-689-LBL-OVERRIDE
  9171         MOVE W-LETTER-COMMUNICATION-AREAS
  9172                                 TO PI-PROGRAM-WORK-AREA
  9173         MOVE XCTL-EL689         TO PGM-NAME
  9174         GO TO 9300-XCTL.
  9175
  9176     IF  EIBAID = DFHPF16
  9177         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9178         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9179         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9180                                    PI-1042-WA
  9181         MOVE 4                  TO PI-689-DATA-SOURCE
  9182         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9183         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9184         MOVE PI-SV-STATE        TO PI-689-STATE
  9185         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9186         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9187         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9188         MOVE PI-PB-ALT-CHG-SEQ-NO
  9189                                 TO PI-689-ALT-SEQ-NO
  9190         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 169
* EL6311.cbl
  9191         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9192         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9193         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9194         MOVE W-LETTER-COMMUNICATION-AREAS
  9195                                 TO PI-PROGRAM-WORK-AREA
  9196         MOVE XCTL-EL690         TO PGM-NAME
  9197         GO TO 9300-XCTL.
  9198     IF (EIBAID = DFHPF13)
  9199        if (not fatal-errors)
  9200           and (not unforced-errors)
  9201           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9202           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9203           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9204           MOVE PI-SV-STATE      TO PI-STATE
  9205           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9206           MOVE CCERTNOI         TO PI-CERT-PRIME
  9207           MOVE CSUFIXI          TO PI-CERT-SFX
  9208           MOVE CEFFDTI          TO DEEDIT-FIELD
  9209           PERFORM 8600-DEEDIT
  9210           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9211           MOVE '4'              TO DC-OPTION-CODE
  9212           PERFORM 9700-DATE-LINK
  9213           IF DATE-CONVERSION-ERROR
  9214              MOVE ER-0348       TO EMI-ERROR
  9215              MOVE -1            TO CEFFDTL
  9216              MOVE AL-UABON      TO CEFFDTA
  9217              PERFORM 9900-ERROR-FORMAT
  9218                                 THRU 9900-EXIT
  9219              GO TO 8200-SEND-DATAONLY
  9220           ELSE
  9221              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9222              MOVE AL-UANON      TO CEFFDTA
  9223              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9224              PERFORM 6000-CREATE-TEMP-STORAGE
  9225                                 THRU 6000-EXIT
  9226              MOVE XCTL-EL677    TO PGM-NAME
  9227              GO TO 9300-XCTL
  9228           end-if
  9229        else
  9230           MOVE ER-3444          TO EMI-ERROR
  9231           MOVE -1               TO CPFENTRL
  9232           MOVE AL-UNBON         TO CPFENTRA
  9233           PERFORM 9900-ERROR-FORMAT
  9234                                 THRU 9900-EXIT
  9235           GO TO 8200-SEND-DATAONLY
  9236        end-if
  9237     end-if
  9238
  9239     IF EIBAID = DFHPF14
  9240        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9241        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9242        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9243        MOVE PI-SV-STATE            TO PI-CR-STATE
  9244        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9245        MOVE SPACE                  TO PI-EDIT-SW
  9246        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9247        MOVE XCTL-EL650             TO PGM-NAME
  9248        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 170
* EL6311.cbl
  9249
  9250     IF EIBAID = DFHENTER OR DFHPF11
  9251        GO TO 2000-CANCEL-MAINLINE.
  9252
  9253     MOVE ER-0029                TO EMI-ERROR.
  9254     MOVE -1                     TO CPFENTRL.
  9255     MOVE AL-UNBON               TO CPFENTRA.
  9256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9257     GO TO 8200-SEND-DATAONLY.
  9258
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 171
* EL6311.cbl
  9260
  9261******************************************************************
  9262*                                                                *
  9263*      BATCH SCREEN PF KEY CHECKING                              *
  9264*                                                                *
  9265******************************************************************
  9266
  9267******************************************************************
  9268*                                                                *
  9269*      PF KEY FUNCTIONS:                                         *
  9270*                                                                *
  9271*      PF1 = BROWSE FORWARD                                      *
  9272*      PF2 = BROWSE BACKWARD                                     *
  9273*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9274*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9275*                                                                *
  9276*                                                                *
  9277******************************************************************
  9278
  9279 0500-CHECK-BATCH-PF-KEYS.
  9280     IF EIBAID = DFHPF1
  9281        MOVE '0'                TO PI-EDIT-SW
  9282        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9283           GO TO 5000-BROWSE-BATCH-HEADERS
  9284        ELSE
  9285           IF PI-GOOD-BROWSE
  9286              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9287                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9288              ELSE
  9289                 IF PI-FILE-BROWSE
  9290                    GO TO 4300-BROWSE-FILE-FORWARD
  9291                 ELSE
  9292                    IF PI-CSR-BROWSE
  9293                       GO TO 4200-BROWSE-CSR-FORWARD
  9294                    ELSE
  9295                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9296           ELSE
  9297              GO TO 0800-BROWSE-ERROR.
  9298
  9299     IF EIBAID = DFHPF2
  9300        MOVE '0'                TO PI-EDIT-SW
  9301        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9302           GO TO 5500-BROWSE-BATCH-BACKWARD
  9303        ELSE
  9304           IF PI-GOOD-BROWSE
  9305              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9306                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9307              ELSE
  9308                 IF PI-FILE-BROWSE
  9309                    GO TO 4800-BROWSE-FILE-BACKWARD
  9310                 ELSE
  9311                    IF PI-CSR-BROWSE
  9312                       GO TO 4900-BROWSE-CSR-BACKWARD
  9313                    ELSE
  9314                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9315           ELSE
  9316              GO TO 0800-BROWSE-ERROR.
  9317
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 172
* EL6311.cbl
  9318     IF EIBAID = DFHPF3
  9319        GO TO 3000-BATCH-MAINLINE.
  9320
  9321     IF  EIBAID = DFHPF4
  9322        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9323        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9324        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9325        MOVE PI-SV-STATE            TO PI-CR-STATE
  9326        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9327                                       PI-CR-FIN-RESP
  9328        MOVE 'A'                    TO PI-CR-TYPE
  9329        MOVE SPACE                  TO PI-EDIT-SW
  9330        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9331        MOVE XCTL-EL640             TO PGM-NAME
  9332        GO TO 9300-XCTL.
  9333
  9334     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9335       AND
  9336        (EIBAID = DFHENTER)
  9337           GO TO 3500-EDIT-BATCH-DATA.
  9338
  9339     IF EIBAID = DFHENTER
  9340        GO TO 3500-EDIT-BATCH-DATA.
  9341
  9342     MOVE ER-0029             TO EMI-ERROR.
  9343     MOVE -1                  TO DPFENTRL.
  9344     MOVE AL-UNBON            TO DPFENTRA.
  9345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9346     GO TO 8200-SEND-DATAONLY.
  9347
  9348 0800-BROWSE-ERROR.
  9349     MOVE ER-2258                TO EMI-ERROR.
  9350     MOVE -1                     TO DPFENTRL.
  9351     MOVE AL-UNBON               TO DPFENTRA.
  9352     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9353     GO TO 8200-SEND-DATAONLY.
  9354
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 173
* EL6311.cbl
  9356
  9357******************************************************************
  9358*                                                                *
  9359*                I S S U E   M A I N L I N E                     *
  9360*                                                                *
  9361******************************************************************
  9362
  9363 1000-ISSUE-MAINLINE.
  9364     IF PI-DISPLAY-ORIGINAL-BATCH
  9365        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9366           MOVE ER-0023             TO EMI-ERROR
  9367           MOVE -1                  TO BMAINTL
  9368           MOVE AL-UABON            TO BMAINTA
  9369           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9370           GO TO 8200-SEND-DATAONLY
  9371        ELSE
  9372           NEXT SENTENCE
  9373     ELSE
  9374        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9375           MOVE ER-0023             TO EMI-ERROR
  9376           MOVE -1                  TO BMAINTL
  9377           MOVE AL-UABON            TO BMAINTA
  9378           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9379           GO TO 8200-SEND-DATAONLY.
  9380
  9381     IF BMAINTI = 'S'
  9382        GO TO 1100-SHOW-REQUEST.
  9383
  9384     IF NOT MODIFY-CAP
  9385         MOVE 'UPDATE'       TO SM-READ
  9386         PERFORM 9995-SECURITY-VIOLATION
  9387         MOVE ER-0070        TO EMI-ERROR
  9388         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9389         GO TO 8100-SEND-INITIAL-MAP.
  9390
  9391     IF BMAINTL GREATER THAN ZEROS
  9392        IF PI-PF5-FUNCTION
  9393           IF BMAINTI NOT = 'A'
  9394              MOVE AL-UABON  TO BMAINTA
  9395              MOVE -1        TO BMAINTL
  9396              MOVE ER-2260   TO EMI-ERROR
  9397              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9398              GO TO 8200-SEND-DATAONLY.
  9399
  9400     IF BCERTNOL = ZEROS
  9401       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9402         NEXT SENTENCE
  9403     ELSE
  9404         IF BCERTNOL NOT = ZEROS
  9405             MOVE AL-UANON       TO BCERTNOA
  9406         ELSE
  9407             MOVE -1             TO BCERTNOL
  9408             MOVE  1             TO SET-CURSOR-SW
  9409             MOVE ER-2218        TO EMI-ERROR
  9410             MOVE AL-UABON       TO BCERTNOA
  9411             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9412
  9413     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 174
* EL6311.cbl
  9414         MOVE AL-UANON       TO BSUFIXA
  9415     ELSE
  9416         MOVE AL-SANOF       TO BSUFIXA.
  9417
  9418     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9419        NEXT SENTENCE
  9420     ELSE
  9421        IF BEFFDTL NOT = ZEROS
  9422           MOVE AL-UNNON             TO BEFFDTA
  9423           MOVE BEFFDTI              TO DEEDIT-FIELD
  9424           PERFORM 8600-DEEDIT
  9425           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9426           MOVE 4                    TO DC-OPTION-CODE
  9427           PERFORM 9700-DATE-LINK
  9428           IF NO-CONVERSION-ERROR
  9429              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9430              ELSE
  9431              MOVE -1                TO BEFFDTL
  9432              MOVE  1                TO SET-CURSOR-SW
  9433              MOVE ER-2226           TO EMI-ERROR
  9434              MOVE AL-UNBON          TO BEFFDTA
  9435              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9436           ELSE
  9437              MOVE -1                TO BEFFDTL
  9438              MOVE  1                TO SET-CURSOR-SW
  9439              MOVE ER-2220           TO EMI-ERROR
  9440              MOVE AL-UNBON          TO BEFFDTA
  9441              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9442
  9443     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9444
  9445     IF BCERTNOL NOT = ZEROS
  9446        MOVE BCERTNOI                TO WS-NEW-PRIME
  9447     ELSE
  9448        MOVE SPACES                  TO WS-NEW-PRIME.
  9449
  9450     IF BSUFIXL NOT = ZEROS
  9451        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9452     ELSE
  9453        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9454
  9455     IF BEFFDTL NOT = ZEROS
  9456        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9457     ELSE
  9458        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9459
  9460     IF BMAINTI = 'A' OR 'K' OR 'S'
  9461        NEXT SENTENCE
  9462     ELSE
  9463        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9464        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9465           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9466           WS-PB-RECORD-TYPE NOT = '1'
  9467           IF BMAINTI = 'C'
  9468               MOVE ER-2287          TO EMI-ERROR
  9469               MOVE -1               TO BCERTNOL
  9470               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9471               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 175
* EL6311.cbl
  9472               GO TO 8200-SEND-DATAONLY
  9473             ELSE
  9474               MOVE ER-2260          TO EMI-ERROR
  9475               MOVE -1               TO BCERTNOL
  9476               MOVE AL-UABON         TO BCERTNOA
  9477               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9478               GO TO 8200-SEND-DATAONLY.
  9479
  9480     IF BMAINTI = 'D'
  9481         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9482
  9483*    IF BMICRNOL  NOT =  ZEROS
  9484*        IF BMICRNOI  NUMERIC
  9485*            MOVE AL-UNNON       TO  BMICRNOA
  9486*        ELSE
  9487*            MOVE -1             TO  BMICRNOL
  9488*            MOVE 1              TO  SET-CURSOR-SW
  9489*            MOVE AL-UNBON       TO  BMICRNOA
  9490*            MOVE ER-2701        TO  EMI-ERROR
  9491*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9492     IF BVINL NOT = ZEROS
  9493        MOVE AL-UANON            TO BVINA
  9494     END-IF
  9495     IF B1STNML NOT = ZEROS
  9496         MOVE AL-UANON                TO B1STNMA.
  9497
  9498     IF BINITL  NOT = ZEROS
  9499        MOVE AL-UANON                TO BINITA.
  9500
  9501     IF BSEXL NOT = ZEROS
  9502        IF BSEXI = 'M' OR 'F'
  9503           MOVE AL-UANON             TO BSEXA
  9504        ELSE
  9505           MOVE -1               TO BSEXL
  9506           MOVE ER-2629          TO EMI-ERROR
  9507           MOVE AL-UABON         TO BSEXA
  9508           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9509
  9510     IF BAGEL NOT = ZEROS
  9511         IF BAGEI NUMERIC
  9512             MOVE BAGEI              TO WS-BAGE
  9513             MOVE AL-UNNON           TO BAGEA
  9514         ELSE
  9515             MOVE -1                 TO BAGEL
  9516             MOVE  1                 TO SET-CURSOR-SW
  9517             MOVE ER-2223            TO EMI-ERROR
  9518             MOVE AL-UNBON           TO BAGEA
  9519             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9520
  9521     IF BLSTNML NOT = ZERO  OR
  9522        B1STNML NOT = ZERO  OR
  9523        BINITL NOT = ZERO
  9524         IF BAGEL = ZEROS
  9525             MOVE -1                 TO BAGEL
  9526             MOVE  1                 TO SET-CURSOR-SW
  9527             MOVE ER-3269            TO EMI-ERROR
  9528             MOVE AL-UNBON           TO BAGEA
  9529             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 176
* EL6311.cbl
  9530         END-IF
  9531     END-IF.
  9532
  9533     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9534
  9535     IF (BBIRTHL GREATER THAN +0) AND
  9536        (BBIRTHI NOT EQUAL SPACES)
  9537        NEXT SENTENCE
  9538     ELSE
  9539        GO TO 1010-CHECK-AGE.
  9540
  9541     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9542     PERFORM 8600-DEEDIT.
  9543     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9544     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9545     MOVE AL-UNNON               TO BBIRTHA.
  9546     MOVE '4'                    TO DC-OPTION-CODE.
  9547     PERFORM 9700-DATE-LINK.
  9548     IF DATE-CONVERSION-ERROR
  9549        MOVE -1                  TO BBIRTHL
  9550        MOVE  1                  TO SET-CURSOR-SW
  9551        MOVE ER-2228             TO EMI-ERROR
  9552        MOVE AL-UNBON            TO BBIRTHA
  9553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9554        GO TO 1010-CHECK-AGE.
  9555
  9556     IF (NO-CONVERSION-ERROR) AND
  9557        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9558        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9559        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9560        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9561                                    WS-CONVERTED-BIRTH
  9562        MOVE AL-UANON            TO BBIRTHA
  9563     ELSE
  9564        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9565        MOVE AL-UANON            TO BBIRTHA.
  9566
  9567 1010-CHECK-AGE.
  9568
  9569*    IF BAGEL = ZERO
  9570*       IF BBIRTHL GREATER THAN ZERO
  9571*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9572
  9573     IF B1STPMTL NOT = ZEROS
  9574        IF B1STPMTI = SPACES
  9575           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9576        ELSE
  9577           MOVE B1STPMTI             TO DEEDIT-FIELD
  9578           PERFORM 8600-DEEDIT
  9579           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9580           MOVE AL-UNNON             TO B1STPMTA
  9581           MOVE 4                    TO DC-OPTION-CODE
  9582           PERFORM 9700-DATE-LINK
  9583           IF NO-CONVERSION-ERROR
  9584              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9585              MOVE AL-UANON          TO B1STPMTA
  9586           ELSE
  9587              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 177
* EL6311.cbl
  9588              MOVE  1                TO SET-CURSOR-SW
  9589              MOVE ER-2200           TO EMI-ERROR
  9590              MOVE AL-UNBON          TO B1STPMTA
  9591              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9592
  9593     IF BDAYSL NOT = ZEROS
  9594         IF BDAYSI NUMERIC
  9595             MOVE AL-UNNON           TO BDAYSA
  9596         ELSE
  9597             MOVE -1                 TO BDAYSL
  9598             MOVE ER-2530            TO EMI-ERROR
  9599             MOVE AL-UNBON           TO BDAYSA
  9600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9601
  9602     IF BLNTRML NOT = ZEROS
  9603         IF BLNTRMI NUMERIC
  9604             MOVE AL-UNNON       TO BLNTRMA
  9605         ELSE
  9606             MOVE -1             TO BLNTRML
  9607             MOVE ER-2533        TO EMI-ERROR
  9608             MOVE AL-UNBON       TO BLNTRMA
  9609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9610
  9611**   IF PI-COMPANY-ID = 'DMD'
  9612     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9613        NEXT SENTENCE
  9614     ELSE
  9615         IF BLNOFCRL NOT = ZEROS
  9616            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9617            IF LOAN-OFFICER-FOUND
  9618                MOVE AL-UANON        TO BLNOFCRA
  9619             ELSE
  9620                 MOVE SPACE          TO WS-LOAN-OFFICER
  9621                 MOVE -1             TO BLNOFCRL
  9622                 MOVE  1             TO SET-CURSOR-SW
  9623                 MOVE ER-3006        TO EMI-ERROR
  9624                 MOVE AL-UNBON       TO BLNOFCRA
  9625                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9626
  9627     IF BFREQL NOT = ZEROS
  9628         IF BFREQI NUMERIC
  9629             MOVE AL-UNNON       TO BFREQA
  9630         ELSE
  9631             MOVE -1             TO BFREQL
  9632             MOVE  1             TO SET-CURSOR-SW
  9633             MOVE ER-2223        TO EMI-ERROR
  9634             MOVE AL-UNBON       TO BFREQA
  9635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9636
  9637     IF BMODEL NOT = ZEROS
  9638         MOVE BMODEI             TO WS-MODE-CODE
  9639                                    PI-BMODE
  9640         IF WS-MODE-CODE-VALID
  9641             MOVE AL-UANON       TO BMODEA
  9642         ELSE
  9643             MOVE -1             TO BMODEL
  9644             MOVE ER-2591        TO EMI-ERROR
  9645             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 178
* EL6311.cbl
  9646             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9647
  9648     IF BPMTSL NOT = ZEROS
  9649         IF BPMTSI NUMERIC
  9650             MOVE AL-UNNON           TO BPMTSA
  9651             MOVE BPMTSI             TO PI-BPMTS
  9652         ELSE
  9653             MOVE -1                 TO BPMTSL
  9654             MOVE ER-2592            TO EMI-ERROR
  9655             MOVE AL-UNBON           TO BPMTSA
  9656             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9657
  9658     IF BPMTAMTL NOT = ZEROS
  9659
  9660* EXEC CICS BIF DEEDIT
  9661*            FIELD  (BPMTAMTI)
  9662*            LENGTH (9)
  9663*       END-EXEC
  9664     MOVE 9
  9665       TO DFHEIV11
  9666*    MOVE '@"L                   #   #00009594' TO DFHEIV0
  9667     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9668     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9669     MOVE X'2020233030303039353934' TO DFHEIV0(25:11)
  9670     CALL 'kxdfhei1' USING DFHEIV0,
  9671           BPMTAMTI,
  9672           DFHEIV11
  9673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9674        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9675*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9676*        PERFORM 8600-DEEDIT
  9677*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9678
  9679*    IF BAPRL NOT = ZEROS
  9680*        EXEC CICS BIF DEEDIT
  9681*            FIELD  (BAPRI)
  9682*            LENGTH (7)
  9683*        END-EXEC
  9684*        MOVE BAPRI              TO WS-BAPR.
  9685
  9686     IF BAPRL > 0
  9687        MOVE +0                  TO  WS-BAPR
  9688        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9689           (WS-SUB > 7)
  9690           OR (BAPRI (WS-SUB:1) NUMERIC)
  9691           OR (BAPRI (WS-SUB:1) = '.')
  9692        END-PERFORM
  9693        IF WS-SUB > 7
  9694           MOVE ER-2471       TO EMI-ERROR
  9695           MOVE -1            TO BAPRL
  9696           MOVE AL-UNBON      TO BAPRA
  9697           PERFORM 9900-ERROR-FORMAT
  9698                                 THRU 9900-EXIT
  9699        ELSE
  9700           IF BAPRI (WS-SUB:1) NUMERIC
  9701              MOVE WS-SUB           TO WS-BEG
  9702              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9703                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 179
* EL6311.cbl
  9704                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9705              END-PERFORM
  9706              COMPUTE WS-END = WS-SUB - WS-BEG
  9707              MOVE BAPRI (WS-BEG:WS-END)
  9708                                 TO WS-APR-WHOLE-NUM
  9709           END-IF
  9710           IF BAPRI (WS-SUB:1) = '.'
  9711              COMPUTE WS-BEG = WS-SUB + 1
  9712              IF (WS-BEG < 8)
  9713                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9714                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9715                    (WS-SUB > 7)
  9716                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9717                 END-PERFORM
  9718                 COMPUTE WS-END = WS-SUB - WS-BEG
  9719                 MOVE BAPRI (WS-BEG:WS-END)
  9720                                 TO WS-APR-DEC (1:WS-END)
  9721              END-IF
  9722           END-IF
  9723           MOVE AL-UNNON      TO BAPRA
  9724           MOVE WS-BAPR       TO BAPRO
  9725        END-IF
  9726     END-IF
  9727*     IF BAPRL NOT = ZEROS
  9728*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9729*        PERFORM 8600-DEEDIT
  9730*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9731
  9732     IF BLIVESL NOT = ZEROS
  9733        MOVE BLIVESI             TO DEEDIT-FIELD
  9734        PERFORM 8600-DEEDIT
  9735        IF DEEDIT-FIELD-V0 NUMERIC
  9736           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9737           MOVE AL-UNNON         TO BLIVESA
  9738        ELSE
  9739           MOVE -1               TO BLIVESL
  9740           MOVE AL-UNBON         TO BLIVESA
  9741           MOVE ER-2223          TO EMI-ERROR
  9742           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9743
  9744*DMD CUSTOM CODING*************START
  9745*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9746     IF PI-COMPANY-ID NOT = 'DMD'
  9747         MOVE ZEROS               TO BBILLEDL
  9748         GO TO 1010-EDIT-CONT.
  9749
  9750     IF BBILLEDL NOT = ZEROS
  9751        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9752        MOVE 'Y'                 TO WS-NUMERIC-SW
  9753        MOVE +1                  TO WS-CSO-SUB
  9754        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9755        IF CSO-NUMERIC-FIELD
  9756
  9757* EXEC CICS BIF DEEDIT
  9758*              FIELD  (BBILLEDI)
  9759*              LENGTH (9)
  9760*          END-EXEC
  9761     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 180
* EL6311.cbl
  9762       TO DFHEIV11
  9763*    MOVE '@"L                   #   #00009680' TO DFHEIV0
  9764     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9765     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9766     MOVE X'2020233030303039363830' TO DFHEIV0(25:11)
  9767     CALL 'kxdfhei1' USING DFHEIV0,
  9768           BBILLEDI,
  9769           DFHEIV11
  9770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9771           MOVE BBILLEDI         TO WS-BILLED
  9772           MOVE AL-UNNON         TO BBILLEDA
  9773        ELSE
  9774           MOVE -1               TO BBILLEDL
  9775           MOVE AL-UNBON         TO BBILLEDA
  9776           MOVE ER-2547          TO EMI-ERROR
  9777           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9778     ELSE
  9779        IF BMAINTI EQUAL 'A'
  9780           MOVE -1               TO BBILLEDL
  9781           MOVE AL-UNBON         TO BBILLEDA
  9782           MOVE ER-8148          TO EMI-ERROR
  9783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9784
  9785 1010-EDIT-CONT.
  9786
  9787     IF BFORCEL  NOT = ZEROS
  9788         IF FORCE-CAP
  9789            MOVE AL-UANON            TO BFORCEA
  9790         ELSE
  9791            MOVE ER-2945             TO EMI-ERROR
  9792            MOVE AL-UABON            TO BFORCEA
  9793            MOVE -1                  TO BFORCEL
  9794            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9795
  9796     IF BENTRYL NOT = ZEROS
  9797        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9798                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9799           MOVE ER-2224              TO EMI-ERROR
  9800           MOVE AL-UABON             TO BENTRYA
  9801           MOVE -1                   TO BENTRYL
  9802           MOVE  1                   TO SET-CURSOR-SW
  9803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9804        ELSE
  9805           MOVE AL-UANON             TO BENTRYA.
  9806
  9807     IF BUNWRITL NOT = ZEROS
  9808        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9809           MOVE ER-7574              TO EMI-ERROR
  9810           MOVE AL-UABON             TO BUNWRITA
  9811           MOVE -1                   TO BUNWRITL
  9812           MOVE  1                   TO SET-CURSOR-SW
  9813           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9814        ELSE
  9815           MOVE AL-UANON             TO BUNWRITA.
  9816
  9817     IF BREINL  NOT = ZEROS
  9818         MOVE AL-UANON               TO BREINA.
  9819
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 181
* EL6311.cbl
  9820     IF BBILCDL NOT = ZEROS
  9821        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9822                             AND 'A' AND 'B' AND 'E'
  9823           MOVE ER-2225              TO EMI-ERROR
  9824           MOVE AL-UABON             TO BBILCDA
  9825           MOVE -1                   TO BBILCDL
  9826           MOVE  1                   TO SET-CURSOR-SW
  9827           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9828        ELSE
  9829           MOVE AL-UANON             TO BBILCDA.
  9830
  9831     IF BSKPCDL NOT = ZEROS
  9832         MOVE AL-UANON               TO BSKPCDA.
  9833
  9834     IF BINDGRPL NOT = ZEROS
  9835         MOVE AL-UANON               TO BINDGRPA.
  9836
  9837     IF BSIGL   NOT = ZEROS
  9838         MOVE AL-UANON               TO BSIGA.
  9839
  9840     IF BRTCLSL NOT = ZEROS
  9841         MOVE AL-UANON               TO BRTCLSA.
  9842
  9843     IF BMEMBERL NOT = ZEROS
  9844         MOVE AL-UANON               TO BMEMBERA.
  9845
  9846     MOVE +0                         TO WS-SUB1.
  9847
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 182
* EL6311.cbl
  9849
  9850******************************************************************
  9851*                                                                *
  9852*           E D I T   I S S U E   C O V E R A G E S              *
  9853*                                                                *
  9854******************************************************************
  9855
  9856 1020-EDIT-COVERAGES.
  9857     ADD +1                      TO WS-SUB1.
  9858
  9859     IF WS-SUB1 GREATER +2
  9860        GO TO 1025-EDIT-COMPLETE.
  9861
  9862     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9863       IF (BMODEL   GREATER ZERO  OR
  9864            BPMTSL   GREATER ZERO  OR
  9865            BPMTAMTL GREATER ZERO)
  9866          AND
  9867            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9868               GO TO 1021-CONT-EDIT.
  9869
  9870     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9871        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9872        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9873        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9874        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9875        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9876        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9877        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9878        NEXT SENTENCE
  9879         ELSE
  9880            GO TO 1020-EDIT-COVERAGES.
  9881
  9882 1021-CONT-EDIT.
  9883
  9884     IF BMAINTI = 'A'
  9885        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9886           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9887        ELSE
  9888           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9889           MOVE ER-7404          TO EMI-ERROR
  9890           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9891           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9892     ELSE
  9893        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9894           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9895
  9896     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9897        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9898        PERFORM 8600-DEEDIT
  9899        IF DEEDIT-FIELD-V0 NUMERIC
  9900           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9901        ELSE
  9902           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9903
  9904     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9905*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9906        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 183
* EL6311.cbl
  9907           BPMTSL  GREATER THAN ZEROS
  9908           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9909
  9910     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9911         IF BMODEL   GREATER THAN ZEROS  OR
  9912            BPMTSL   GREATER THAN ZEROS  OR
  9913            BPMTAMTL GREATER THAN ZEROS
  9914             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9915
  9916     IF BMAINTI = ('C' OR 'K')
  9917        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9918           NEXT SENTENCE
  9919        ELSE
  9920           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9921           PERFORM 8600-DEEDIT
  9922           IF DEEDIT-FIELD-V0 NUMERIC
  9923              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9924              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9925                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9926              ELSE
  9927                    MOVE ER-2241      TO EMI-ERROR
  9928                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9929                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9930                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9931           ELSE
  9932              MOVE ER-2223          TO EMI-ERROR
  9933              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9934              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9935              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9936     ELSE
  9937        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9938            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9939            PERFORM 8600-DEEDIT
  9940            IF DEEDIT-FIELD-V0      NUMERIC
  9941               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9942                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9943                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9944               ELSE
  9945                  MOVE ER-2241         TO EMI-ERROR
  9946                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9947                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9948                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9949            ELSE
  9950              MOVE ER-2223             TO EMI-ERROR
  9951              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9952              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9953              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9954        ELSE
  9955            MOVE ER-2240               TO EMI-ERROR
  9956            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9957            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9958*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9959*        IF BMODEL  GREATER THAN ZEROS  AND
  9960*           BPMTSL  GREATER THAN ZEROS
  9961*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9962
  9963     IF BBEN-LEN (WS-SUB1) = ZEROS
  9964        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 184
* EL6311.cbl
  9965           NEXT SENTENCE
  9966     ELSE
  9967        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9968           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9969
  9970* EXEC CICS BIF DEEDIT
  9971*              FIELD  (BBENI (WS-SUB1))
  9972*              LENGTH (12)
  9973*          END-EXEC
  9974     MOVE 12
  9975       TO DFHEIV11
  9976*    MOVE '@"L                   #   #00009882' TO DFHEIV0
  9977     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9978     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9979     MOVE X'2020233030303039383832' TO DFHEIV0(25:11)
  9980     CALL 'kxdfhei1' USING DFHEIV0,
  9981           BBENI(WS-SUB1),
  9982           DFHEIV11
  9983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9984           IF BBENI (WS-SUB1)  NUMERIC
  9985              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9986                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9987*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9988*          PERFORM 8600-DEEDIT
  9989*          IF DEEDIT-FIELD-V2  NUMERIC
  9990*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9991*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9992              ELSE
  9993                 MOVE ER-7632    TO EMI-ERROR
  9994                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9995                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9996                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9997           ELSE
  9998              MOVE ER-2223         TO EMI-ERROR
  9999              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10000              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10001              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10002        ELSE
 10003           MOVE ER-7632    TO EMI-ERROR
 10004           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10005           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10006           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10007
 10008     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10009        AND (BMAINTI = ('C' OR 'K'))
 10010        CONTINUE
 10011     ELSE
 10012        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10013           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10014           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10015              FOR ALL '.'
 10016           IF WS-TALLY > 1
 10017              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10018                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10019              END-PERFORM
 10020              IF A1 < 9
 10021                 ADD 3 TO A1
 10022                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 185
* EL6311.cbl
 10023              END-IF
 10024           ELSE
 10025              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10026                (A1 > 11)
 10027                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10028                  LOW-VALUES OR SPACES)
 10029              END-PERFORM
 10030              IF A1 > 1 AND < 12
 10031                 MOVE SPACES
 10032                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10033              END-IF
 10034           END-IF
 10035
 10036* EXEC CICS BIF DEEDIT
 10037*              FIELD  (BPREMI (WS-SUB1))
 10038*              LENGTH (11)
 10039*          END-EXEC
 10040     MOVE 11
 10041       TO DFHEIV11
 10042*    MOVE '@"L                   #   #00009937' TO DFHEIV0
 10043     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10044     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10045     MOVE X'2020233030303039393337' TO DFHEIV0(25:11)
 10046     CALL 'kxdfhei1' USING DFHEIV0,
 10047           BPREMI(WS-SUB1),
 10048           DFHEIV11
 10049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10050           IF BPREMI (WS-SUB1) NUMERIC
 10051              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10052                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10053*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10054*          PERFORM 8600-DEEDIT
 10055*          IF DEEDIT-FIELD-V2  NUMERIC
 10056*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10057*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10058              ELSE
 10059                 IF PI-COMPANY-ID NOT = 'DCC'
 10060                    MOVE ER-7633    TO EMI-ERROR
 10061                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10062                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10063                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10064                 END-IF
 10065              END-IF
 10066           ELSE
 10067              MOVE ER-2223         TO EMI-ERROR
 10068              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10069              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10070              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10071           END-IF
 10072        ELSE
 10073           IF PI-COMPANY-ID NOT = 'DCC'
 10074              MOVE ER-7633         TO EMI-ERROR
 10075              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10076              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10077              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10078           END-IF
 10079        END-IF
 10080     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 186
* EL6311.cbl
 10081
 10082     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10083        NEXT SENTENCE
 10084     ELSE
 10085        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10086
 10087* EXEC CICS BIF DEEDIT
 10088*           FIELD  (BCPREMI (WS-SUB1))
 10089*           LENGTH (11)
 10090*       END-EXEC
 10091     MOVE 11
 10092       TO DFHEIV11
 10093*    MOVE '@"L                   #   #00009977' TO DFHEIV0
 10094     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10095     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10096     MOVE X'2020233030303039393737' TO DFHEIV0(25:11)
 10097     CALL 'kxdfhei1' USING DFHEIV0,
 10098           BCPREMI(WS-SUB1),
 10099           DFHEIV11
 10100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10101        IF BCPREMI (WS-SUB1) NUMERIC
 10102           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10103*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10104*       PERFORM 8600-DEEDIT
 10105*       IF DEEDIT-FIELD-V2  NUMERIC
 10106*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10107        ELSE
 10108           MOVE ER-2223         TO EMI-ERROR
 10109           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10110           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10111           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10112
 10113     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10114        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10115        PERFORM 8600-DEEDIT
 10116        IF DEEDIT-FIELD-V0 NUMERIC
 10117           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10118           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10119         ELSE
 10120           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10121           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10122           MOVE ER-2223              TO EMI-ERROR
 10123           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10124
 10125     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10126        IF BEXPIRE   (WS-SUB1) = SPACES
 10127           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10128        ELSE
 10129           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10130           PERFORM 8600-DEEDIT
 10131           IF DEEDIT-FIELD-V0        NUMERIC
 10132              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10133              MOVE 4                TO DC-OPTION-CODE
 10134              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10135              PERFORM 9700-DATE-LINK
 10136              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10137                                                        (WS-SUB1)
 10138              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 187
* EL6311.cbl
 10139                 NEXT SENTENCE
 10140              ELSE
 10141                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10142                 MOVE ER-2531    TO EMI-ERROR
 10143                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10144                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10145           ELSE
 10146             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10147             MOVE ER-2532        TO EMI-ERROR
 10148             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10150
 10151     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10152        NEXT SENTENCE
 10153     ELSE
 10154
 10155* EXEC CICS BIF DEEDIT
 10156*           FIELD  (BALT-BENI (WS-SUB1))
 10157*           LENGTH (12)
 10158*       END-EXEC
 10159     MOVE 12
 10160       TO DFHEIV11
 10161*    MOVE '@"L                   #   #00010034' TO DFHEIV0
 10162     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10163     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10164     MOVE X'2020233030303130303334' TO DFHEIV0(25:11)
 10165     CALL 'kxdfhei1' USING DFHEIV0,
 10166           BALT-BENI(WS-SUB1),
 10167           DFHEIV11
 10168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10169        IF BALT-BENI (WS-SUB1) NUMERIC
 10170           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10171*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10172*       PERFORM 8600-DEEDIT
 10173*       IF DEEDIT-FIELD-V0 NUMERIC
 10174*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10175        ELSE
 10176           MOVE ER-2223         TO EMI-ERROR
 10177           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10178           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10179           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10180
 10181     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10182        NEXT SENTENCE
 10183     ELSE
 10184
 10185* EXEC CICS BIF DEEDIT
 10186*           FIELD  (BALT-PREMI (WS-SUB1))
 10187*           LENGTH (11)
 10188*       END-EXEC
 10189     MOVE 11
 10190       TO DFHEIV11
 10191*    MOVE '@"L                   #   #00010053' TO DFHEIV0
 10192     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10193     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10194     MOVE X'2020233030303130303533' TO DFHEIV0(25:11)
 10195     CALL 'kxdfhei1' USING DFHEIV0,
 10196           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 188
* EL6311.cbl
 10197           DFHEIV11
 10198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10199        IF BALT-PREMI (WS-SUB1) NUMERIC
 10200           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10201*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10202*       PERFORM 8600-DEEDIT
 10203*       IF DEEDIT-FIELD-V0 NUMERIC
 10204*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10205        ELSE
 10206           MOVE ER-2223         TO EMI-ERROR
 10207           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10208           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10209           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10210
 10211      GO TO 1020-EDIT-COVERAGES.
 10212
 10213 1025-EDIT-COMPLETE.
 10214     IF PI-COMPANY-ID  =  'DMD'
 10215        MOVE LOW-VALUES             TO BNCERTI
 10216                                       BNSTATI.
 10217
 10218     IF EMI-ERROR = ZEROS
 10219         NEXT SENTENCE
 10220     ELSE
 10221         GO TO 8200-SEND-DATAONLY.
 10222
 10223     IF BMAINTI = 'A'
 10224         GO TO 1200-ADD-ISSUE-ROUTINE.
 10225
 10226     IF BMAINTI = 'C'
 10227         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10228
 10229     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10230
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 189
* EL6311.cbl
 10232
 10233 1030-EDIT-FOR-NUMERICS.
 10234     IF WS-CSO-SUB EQUAL 10
 10235        GO TO 1030-EDIT-EXIT.
 10236
 10237     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10238        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10239        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10240           ADD +1               TO WS-CSO-SUB
 10241           GO TO 1030-EDIT-FOR-NUMERICS.
 10242
 10243     MOVE 'N'                   TO WS-NUMERIC-SW.
 10244
 10245 1030-EDIT-EXIT.
 10246******************************************************************
 10247*                                                                *
 10248*                 C A L C U L A T E   A G E                      *
 10249*                                                                *
 10250******************************************************************
 10251
 10252
 10253 1095-CALC-AGE.
 10254
 10255     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10256     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10257     MOVE 1                  TO DC-OPTION-CODE.
 10258     PERFORM 9700-DATE-LINK
 10259     IF NO-CONVERSION-ERROR
 10260         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10261         MOVE WS-BAGE            TO BAGEI
 10262         MOVE +2                 TO BAGEL
 10263         MOVE AL-UNNON TO BAGEA.
 10264
 10265 1099-EXIT.
 10266     EXIT.
 10267
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 190
* EL6311.cbl
 10269
 10270******************************************************************
 10271*                                                                *
 10272*                   S H O W   I S S U E                          *
 10273*                                                                *
 10274******************************************************************
 10275
 10276 1100-SHOW-REQUEST.
 10277     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10278
 10279     IF BCERTNOL = ZEROS AND
 10280        BEFFDTL  = ZEROS
 10281        MOVE -1                  TO BMAINTL
 10282        GO TO 8200-SEND-DATAONLY.
 10283
 10284     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10285
 10286     IF BSUFIXL NOT = ZEROS
 10287        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10288     ELSE
 10289        MOVE SPACE               TO WS-NEW-SUFFIX.
 10290
 10291     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10292     PERFORM 8600-DEEDIT.
 10293     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10294     MOVE '4'                    TO DC-OPTION-CODE.
 10295     PERFORM 9700-DATE-LINK.
 10296     IF DATE-CONVERSION-ERROR
 10297        MOVE ER-0348             TO EMI-ERROR
 10298        MOVE -1                  TO BEFFDTL
 10299        MOVE AL-UABON            TO BEFFDTA
 10300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10301        GO TO 8200-SEND-DATAONLY
 10302     ELSE
 10303        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10304        MOVE AL-UANON            TO BEFFDTA
 10305        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10306
 10307     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10308
 10309     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10310        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10311          MOVE 'Y'                    TO WS-SHOW-SW
 10312          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10313             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10314           ELSE
 10315             IF PI-FILE-BROWSE
 10316                GO TO 4300-BROWSE-FILE-FORWARD
 10317              ELSE
 10318                IF PI-CSR-BROWSE
 10319                   GO TO 4200-BROWSE-CSR-FORWARD
 10320                ELSE
 10321                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10322        ELSE
 10323           GO TO 3900-RE-DISPLAY-RECORD.
 10324
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 191
* EL6311.cbl
 10326
 10327******************************************************************
 10328*                                                                *
 10329*            A D D   I S S U E   R O U T I N E                   *
 10330*                                                                *
 10331******************************************************************
 10332
 10333***************************************************************
 10334*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10335*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10336*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10337*     4. LINK TO THE EDIT ROUTINE.                            *
 10338*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10339*     6. WRITE THE NEW ISSUE RECORD.                          *
 10340*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10341*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10342*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10343*        ELSE                                                 *
 10344*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10345***************************************************************
 10346
 10347 1200-ADD-ISSUE-ROUTINE.
 10348     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10349
 10350
 10351* EXEC CICS GETMAIN
 10352*        SET     (ADDRESS OF PENDING-BUSINESS)
 10353*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10354*    END-EXEC.
 10355*    MOVE '," L                  $   #00010208' TO DFHEIV0
 10356     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10357     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10358     MOVE X'2020233030303130323038' TO DFHEIV0(25:11)
 10359     CALL 'kxdfhei1' USING DFHEIV0,
 10360           DFHEIV20,
 10361           ERPNDB-RECORD-LENGTH,
 10362           DFHEIV99
 10363     SET ADDRESS OF PENDING-BUSINESS TO
 10364         DFHEIV20
 10365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10366
 10367
 10368
 10369* EXEC CICS HANDLE CONDITION
 10370*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10371*    END-EXEC.
 10372*    MOVE '"$I                   ! # #00010213' TO DFHEIV0
 10373     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10375     MOVE X'2320233030303130323133' TO DFHEIV0(25:11)
 10376     CALL 'kxdfhei1' USING DFHEIV0
 10377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10378
 10379
 10380     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10381     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10382     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10383
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 192
* EL6311.cbl
 10384
 10385* EXEC CICS READ
 10386*        INTO    (PENDING-BUSINESS)
 10387*        DATASET (FILE-ID-ERPNDB)
 10388*        RIDFLD  (ERPNDB-KEY)
 10389*    END-EXEC.
 10390     MOVE LENGTH OF
 10391      PENDING-BUSINESS
 10392       TO DFHEIV11
 10393*    MOVE '&"IL       E          (   #00010221' TO DFHEIV0
 10394     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10396     MOVE X'2020233030303130323231' TO DFHEIV0(25:11)
 10397     CALL 'kxdfhei1' USING DFHEIV0,
 10398           FILE-ID-ERPNDB,
 10399           PENDING-BUSINESS,
 10400           DFHEIV11,
 10401           ERPNDB-KEY,
 10402           DFHEIV99,
 10403           DFHEIV99,
 10404           DFHEIV99
 10405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10406
 10407
 10408     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10409
 10410     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10411     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10412     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10413     MOVE SPACES                 TO PENDING-BUSINESS.
 10414     MOVE 'PB'                   TO PB-RECORD-ID.
 10415     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10416     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10417     MOVE SPACES                 TO PB-CERT-SFX.
 10418     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10419     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10420                                    PB-ALT-CHG-SEQ-NO.
 10421
 10422     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10423     MOVE '1'                    TO PB-RECORD-TYPE.
 10424
 10425     IF BSUFIXL NOT = ZEROS
 10426        MOVE BSUFIXI             TO PB-CERT-SFX.
 10427
 10428     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10429
 10430     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10431     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10432
 10433     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10434                                    PB-I-LF-PREM-CALC
 10435                                    PB-I-LF-ALT-PREM-CALC
 10436                                    PB-I-LF-RATE
 10437                                    PB-I-LF-ALT-RATE
 10438                                    PB-I-LF-REI-RATE
 10439                                    PB-I-LF-ALT-REI-RATE
 10440                                    PB-I-RATE-DEV-PCT-LF
 10441                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 193
* EL6311.cbl
 10442                                    PB-I-AH-RATE
 10443                                    PB-I-AH-REI-RATE
 10444                                    PB-I-AH-RATE-TRM
 10445                                    PB-I-RATE-DEV-PCT-AH
 10446                                    PB-I-BUSINESS-TYPE
 10447                                    PB-I-LIFE-COMMISSION
 10448                                    PB-I-JOINT-COMMISSION
 10449                                    PB-I-JOINT-AGE
 10450                                    PB-I-AH-COMMISSION
 10451                                    PB-I-CURR-SEQ
 10452                                    PB-CHG-COUNT
 10453                                    PB-LF-BILLED-AMTS
 10454                                    PB-AH-BILLED-AMTS
 10455                                    PB-CALC-TOLERANCE
 10456                                    PB-I-EXTENTION-DAYS
 10457*                                   PB-I-MICROFILM-NO
 10458                                    PB-I-TERM-IN-DAYS.
 10459
 10460     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10461                                    PB-I-LF-EXPIRE-DT
 10462                                    PB-I-AH-EXPIRE-DT
 10463                                    PB-BILLED-DT
 10464                                    PB-ACCT-EFF-DT
 10465                                    PB-ACCT-EXP-DT
 10466                                    PB-I-1ST-PMT-DT.
 10467
 10468     MOVE 'X'                    TO PB-FATAL-FLAG.
 10469
 10470     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10471
 10472     IF BLSTNML GREATER THAN ZEROS
 10473         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10474
 10475*    IF BMICRNOL  GREATER  ZEROS
 10476*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10477*    ELSE
 10478*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10479     IF BVINL > ZEROS
 10480        MOVE BVINI               TO PB-I-VIN
 10481     END-IF
 10482     IF B1STNML GREATER THAN ZEROS
 10483         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10484
 10485     IF BINITL  GREATER THAN ZEROS
 10486         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10487
 10488     IF BBIRTHL GREATER THAN ZERO
 10489         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10490     ELSE
 10491         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10492
 10493     IF B1STPMTL GREATER THAN ZERO
 10494         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10495     ELSE
 10496         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10497
 10498     IF BAGEL    GREATER THAN ZEROS
 10499         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 194
* EL6311.cbl
 10500        ELSE
 10501         MOVE ZEROS              TO PB-I-AGE.
 10502
 10503     IF BSEXL    GREATER THAN ZEROS
 10504         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10505
 10506     IF BTERM-LEN (1) GREATER THAN ZEROS
 10507        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10508     ELSE
 10509        MOVE ZEROS               TO PB-I-LF-TERM.
 10510
 10511     IF BTERM-LEN (2) GREATER THAN ZEROS
 10512        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10513     ELSE
 10514        MOVE ZEROS               TO PB-I-AH-TERM.
 10515
 10516     IF BLNTRML       GREATER THAN ZEROS
 10517         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10518        ELSE
 10519         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10520
 10521     IF BFREQL        GREATER THAN ZEROS
 10522         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10523        ELSE
 10524         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10525
 10526     IF BSKPCDL       GREATER THAN ZEROS
 10527         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10528
 10529     IF BMODEL        GREATER THAN ZEROS
 10530         MOVE BMODEI             TO PB-I-TERM-TYPE
 10531                                    PI-BMODE.
 10532
 10533     IF BPMTSL        GREATER THAN ZEROS
 10534         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10535                                    PI-BPMTS
 10536        ELSE
 10537         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10538                                    PI-BPMTS.
 10539
 10540     IF BPMTAMTL      GREATER THAN ZEROS
 10541         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10542        ELSE
 10543         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10544
 10545     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10546        IF BTYPE  (1)   NOT = ZEROS
 10547           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10548                                    PI-BTYPE (1)
 10549           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10550           MOVE SPACES           TO PB-I-LF-ABBR
 10551        ELSE
 10552           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10553                                    PB-I-LF-ABBR
 10554           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10555     ELSE
 10556        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10557                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 195
* EL6311.cbl
 10558        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10559
 10560     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10561         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10562     ELSE
 10563         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10564
 10565     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10566         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10567     ELSE
 10568         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10569
 10570     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10571         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10572            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10573            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10574         ELSE
 10575            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10576*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10577*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10578         END-IF
 10579     ELSE
 10580         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10581
 10582     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10583         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10584
 10585     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10586         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10587         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10588     ELSE
 10589         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10590
 10591     IF  BALT-PREM-LEN     (2) > ZEROS
 10592         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10593     ELSE
 10594         MOVE ZEROS            TO PB-I-TOT-FEES.
 10595
 10596     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10597        IF BTYPE      (2)   NOT = ZEROS
 10598           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10599                                  PI-BTYPE (2)
 10600           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10601           MOVE SPACES         TO PB-I-AH-ABBR
 10602        ELSE
 10603           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10604                                  PB-I-AH-ABBR
 10605           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10606     ELSE
 10607        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10608                                  PB-I-AH-ABBR
 10609        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10610
 10611     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10612         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10613     ELSE
 10614         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10615
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 196
* EL6311.cbl
 10616     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10617         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10618            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10619            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10620         ELSE
 10621            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10622*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10623*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10624         END-IF
 10625     ELSE
 10626         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10627
 10628     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10629         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10630
 10631     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10632        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10633     ELSE
 10634        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10635
 10636     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10637        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10638     ELSE
 10639        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10640
 10641     IF BINDGRPL  GREATER THAN ZEROS
 10642         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10643
 10644     IF BRTCLSL   GREATER THAN ZEROS
 10645         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10646
 10647     IF BSIGL     GREATER THAN ZEROS
 10648         MOVE BSIGI              TO PB-I-SIG-SW.
 10649     IF BAPRL > ZEROS
 10650         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10651     ELSE
 10652        if pi-company-id = 'CID'
 10653           move +99.9999         to pb-i-loan-apr
 10654        else
 10655           MOVE ZEROS            TO PB-I-LOAN-APR
 10656        end-if
 10657     end-if
 10658     IF BMEMBERL  GREATER THAN ZEROS
 10659         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10660
 10661     IF BLNOFCRL  GREATER THAN ZEROS
 10662         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10663
 10664     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10665        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10666     ELSE
 10667        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10668
 10669     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10670        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10671     ELSE
 10672        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10673
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 197
* EL6311.cbl
 10674     IF BDAYSL   GREATER THAN ZEROS
 10675        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10676                                    PB-I-EXTENTION-DAYS
 10677     ELSE
 10678        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10679                                    PB-I-EXTENTION-DAYS.
 10680
 10681     IF BDAYSL GREATER THAN ZEROS
 10682        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10683
 10684     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10685        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10686           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10687
 10688     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10689        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10690           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10691
 10692     IF B1STPMTL GREATER THAN ZEROS
 10693        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10694
 10695     IF PB-EXT-DAYS-PROCESSING
 10696        IF PB-I-EXTENTION-DAYS = ZEROS
 10697           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10698
 10699     IF PB-EXPIRE-DT-PROCESSING
 10700        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10701           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10702             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10703
 10704     IF PB-1ST-PMT-DT-PROCESSING
 10705        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10706           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10707
 10708     IF BREINL GREATER THAN ZEROS
 10709        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10710
 10711     IF BENTRYL NOT = ZEROS
 10712        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10713        IF PI-COMPANY-ID = 'CID'
 10714           AND (PB-BATCH-ENTRY = 'P')
 10715           AND (PB-STATE = 'VA')
 10716           PERFORM 1500-UPDATE-ERNOTE
 10717                                 THRU 1500-EXIT
 10718        END-IF
 10719     END-IF
 10720     IF BUNWRITL NOT = ZEROS
 10721        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10722
 10723     IF BFORCEL NOT = ZEROS
 10724        MOVE BFORCEI             TO PB-FORCE-CODE.
 10725
 10726     IF BBILCDL NOT = ZEROS
 10727        MOVE BBILCDI             TO PB-RECORD-BILL.
 10728
 10729     IF BLIVESL GREATER THAN ZEROS
 10730        MOVE WS-BLIVES           TO PB-I-LIVES
 10731     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 198
* EL6311.cbl
 10732        MOVE ZEROS               TO PB-I-LIVES.
 10733
 10734     IF BBILLEDL GREATER THAN ZEROS
 10735        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10736     ELSE
 10737        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10738
 10739*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10740
 10741 1260-WRITE-PB-RECORD.
 10742     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10743                                    PB-INPUT-BY.
 10744     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10745     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10746                                    PB-INPUT-DT.
 10747
 10748     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10749     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10750                                    PB-CONTROL-BY-ORIG-BATCH.
 10751
 10752
 10753     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10754     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10755     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10756     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10757     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10758
 10759     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10760
 10761     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10762
 10763     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10764     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10765     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10766
 10767     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10768     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10769
 10770 1275-WRITE-PENDING-BUSINESS.
 10771     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10772     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10773     MOVE 'A'                    TO JP-RECORD-TYPE.
 10774     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10775
 10776
 10777* EXEC CICS HANDLE CONDITION
 10778*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10779*    END-EXEC.
 10780*    MOVE '"$%                   ! $ #00010595' TO DFHEIV0
 10781     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10783     MOVE X'2420233030303130353935' TO DFHEIV0(25:11)
 10784     CALL 'kxdfhei1' USING DFHEIV0
 10785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10786
 10787
 10788
 10789* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 199
* EL6311.cbl
 10790*        DATASET (FILE-ID-ERPNDB)
 10791*        FROM    (PENDING-BUSINESS)
 10792*        RIDFLD  (PB-CONTROL-PRIMARY)
 10793*    END-EXEC.
 10794     MOVE LENGTH OF
 10795      PENDING-BUSINESS
 10796       TO DFHEIV11
 10797*    MOVE '&$ L                  ''   #00010599' TO DFHEIV0
 10798     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10799     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10800     MOVE X'2020233030303130353939' TO DFHEIV0(25:11)
 10801     CALL 'kxdfhei1' USING DFHEIV0,
 10802           FILE-ID-ERPNDB,
 10803           PENDING-BUSINESS,
 10804           DFHEIV11,
 10805           PB-CONTROL-PRIMARY,
 10806           DFHEIV99,
 10807           DFHEIV99
 10808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10809
 10810
 10811     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10812
 10813     PERFORM 8400-LOG-JOURNAL-RECORD.
 10814
 10815******************************************************************
 10816*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10817******************************************************************
 10818*    display ' made it to add orig cert '
 10819     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10820     MOVE ' '                    TO WS-ERMAIL-SW
 10821
 10822* EXEC CICS READ
 10823*       DATASET   (FILE-ID-ERMAIL)
 10824*       SET       (ADDRESS OF MAILING-DATA)
 10825*       RIDFLD    (ERMAIL-KEY)
 10826*       RESP      (WS-RESPONSE)
 10827*    END-EXEC
 10828*    MOVE '&"S        E          (  N#00010615' TO DFHEIV0
 10829     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10831     MOVE X'204E233030303130363135' TO DFHEIV0(25:11)
 10832     CALL 'kxdfhei1' USING DFHEIV0,
 10833           FILE-ID-ERMAIL,
 10834           DFHEIV20,
 10835           DFHEIV99,
 10836           ERMAIL-KEY,
 10837           DFHEIV99,
 10838           DFHEIV99,
 10839           DFHEIV99
 10840     SET ADDRESS OF MAILING-DATA TO
 10841         DFHEIV20
 10842     MOVE EIBRESP  TO WS-RESPONSE
 10843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10844     IF RESP-NORMAL
 10845        SET ERMAIL-FOUND TO TRUE
 10846     END-IF
 10847
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 200
* EL6311.cbl
 10848     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10849     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10850     MOVE 'OC'                   TO OC-RECORD-ID
 10851     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10852                                 TO OC-CONTROL-PRIMARY (1:33)
 10853     MOVE 'I'                    TO OC-RECORD-TYPE
 10854     MOVE +4096                  TO OC-KEY-SEQ-NO
 10855     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10856     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10857     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10858     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10859     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10860     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10861     MOVE PB-I-AGE               TO OC-INS-AGE
 10862     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10863     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10864     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10865     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10866     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10867     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10868     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10869     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10870     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10871     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10872     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10873     IF PB-I-JOINT-COMMISSION > +0
 10874         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10875     ELSE
 10876         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10877     END-IF
 10878     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10879     MOVE +0                     TO OC-LF-CANCEL-AMT
 10880                                    OC-LF-ITD-CANCEL-AMT
 10881     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10882     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10883     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10884     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10885     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10886     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10887     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10888     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10889     MOVE +0                     TO OC-AH-CANCEL-AMT
 10890                                    OC-AH-ITD-CANCEL-AMT
 10891     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10892     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10893     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10894     IF ERMAIL-FOUND
 10895        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10896     END-IF
 10897     IF NOT CERT-TRL-REC-NOT-FOUND
 10898        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10899                           OC-INS-AGE-DEFAULT-FLAG
 10900        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10901                           OC-JNT-AGE-DEFAULT-FLAG
 10902     END-IF
 10903     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10904     .
 10905 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 201
* EL6311.cbl
 10906
 10907* EXEC CICS WRITE
 10908*       DATASET   ('ELCRTO')
 10909*       FROM      (ORIGINAL-CERTIFICATE)
 10910*       RIDFLD    (OC-CONTROL-PRIMARY)
 10911*       RESP      (WS-RESPONSE)
 10912*    END-EXEC
 10913     MOVE LENGTH OF
 10914      ORIGINAL-CERTIFICATE
 10915       TO DFHEIV11
 10916     MOVE 'ELCRTO' TO DFHEIV1
 10917*    MOVE '&$ L                  ''  N#00010683' TO DFHEIV0
 10918     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10919     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10920     MOVE X'204E233030303130363833' TO DFHEIV0(25:11)
 10921     CALL 'kxdfhei1' USING DFHEIV0,
 10922           DFHEIV1,
 10923           ORIGINAL-CERTIFICATE,
 10924           DFHEIV11,
 10925           OC-CONTROL-PRIMARY,
 10926           DFHEIV99,
 10927           DFHEIV99
 10928     MOVE EIBRESP  TO WS-RESPONSE
 10929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10930*    display ' just wrote 1275 ' ws-response
 10931     IF RESP-DUPKEY
 10932        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10933        GO TO 1275-WRITE-ELCRTO
 10934     ELSE
 10935        IF NOT RESP-NORMAL
 10936           MOVE -1               TO BMAINTL
 10937           MOVE ER-7450          TO EMI-ERROR
 10938           PERFORM 9900-ERROR-FORMAT
 10939                                 THRU 9900-EXIT
 10940           GO TO 8200-SEND-DATAONLY
 10941        END-IF
 10942     END-IF
 10943******************************************************************
 10944*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10945******************************************************************
 10946
 10947
 10948* EXEC CICS READ
 10949*        INTO    (PENDING-BUSINESS)
 10950*        DATASET (FILE-ID-ERPNDB)
 10951*        RIDFLD  (ERPNDB-KEY)
 10952*        UPDATE
 10953*    END-EXEC.
 10954     MOVE LENGTH OF
 10955      PENDING-BUSINESS
 10956       TO DFHEIV11
 10957*    MOVE '&"IL       EU         (   #00010706' TO DFHEIV0
 10958     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10959     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10960     MOVE X'2020233030303130373036' TO DFHEIV0(25:11)
 10961     CALL 'kxdfhei1' USING DFHEIV0,
 10962           FILE-ID-ERPNDB,
 10963           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 202
* EL6311.cbl
 10964           DFHEIV11,
 10965           ERPNDB-KEY,
 10966           DFHEIV99,
 10967           DFHEIV99,
 10968           DFHEIV99
 10969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10970
 10971
 10972     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10973     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10974     MOVE 'B'                    TO JP-RECORD-TYPE.
 10975     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10976
 10977     PERFORM 8400-LOG-JOURNAL-RECORD.
 10978
 10979     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10980
 10981
 10982* EXEC CICS REWRITE
 10983*        DATASET (FILE-ID-ERPNDB)
 10984*        FROM    (PENDING-BUSINESS)
 10985*    END-EXEC.
 10986     MOVE LENGTH OF
 10987      PENDING-BUSINESS
 10988       TO DFHEIV11
 10989*    MOVE '&& L                  %   #00010722' TO DFHEIV0
 10990     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10991     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10992     MOVE X'2020233030303130373232' TO DFHEIV0(25:11)
 10993     CALL 'kxdfhei1' USING DFHEIV0,
 10994           FILE-ID-ERPNDB,
 10995           PENDING-BUSINESS,
 10996           DFHEIV11,
 10997           DFHEIV99
 10998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10999
 11000
 11001     MOVE 'C'                    TO JP-RECORD-TYPE.
 11002     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11003
 11004     PERFORM 8400-LOG-JOURNAL-RECORD.
 11005
 11006     IF WS-ERRORS-PRESENT
 11007         GO TO 3900-RE-DISPLAY-RECORD.
 11008
 11009     MOVE ZEROS                  TO EMI-ERROR.
 11010     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11011     MOVE LOW-VALUES             TO EL631BI.
 11012     MOVE  -1                    TO BMAINTL.
 11013     GO TO 8100-SEND-INITIAL-MAP.
 11014
 11015 1280-BATCH-HDR-NOT-FOUND.
 11016     MOVE -1                     TO BMAINTL.
 11017     MOVE ER-7450                TO EMI-ERROR.
 11018     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11019     GO TO 8200-SEND-DATAONLY.
 11020
 11021 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 203
* EL6311.cbl
 11022
 11023******************************************************************
 11024*                                                                *
 11025*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11026*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11027*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11028*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11029*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11030*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11031*                                                                *
 11032******************************************************************
 11033
 11034     IF LCP-ONCTR-01 =  0
 11035         ADD 1 TO LCP-ONCTR-01
 11036        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11037
 11038     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11039
 11040     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11041         NEXT SENTENCE
 11042     ELSE
 11043         ADD +1 TO PB-BATCH-SEQ-NO
 11044                   PB-CSR-BATCH-SEQ-NO
 11045         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11046         GO TO 1275-WRITE-PENDING-BUSINESS.
 11047
 11048     MOVE -1                     TO BCERTNOL.
 11049     MOVE AL-UABON               TO BCERTNOA.
 11050     MOVE AL-UNBON               TO BEFFDTA.
 11051
 11052     MOVE 1                      TO EMI-SUB
 11053                                    EMI-SWITCH1
 11054                                    EMI-SWITCH-AREA-1
 11055                                    EMI-SWITCH-AREA-2.
 11056
 11057     MOVE SPACES                 TO EMI-ERROR-LINES.
 11058
 11059
 11060* EXEC CICS SYNCPOINT ROLLBACK
 11061*    END-EXEC.
 11062*    MOVE '6"R                   !   #00010785' TO DFHEIV0
 11063     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11064     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11065     MOVE X'2020233030303130373835' TO DFHEIV0(25:11)
 11066     CALL 'kxdfhei1' USING DFHEIV0
 11067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11068
 11069
 11070     MOVE ER-2247                TO EMI-ERROR.
 11071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11072     GO TO 8200-SEND-DATAONLY.
 11073
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 204
* EL6311.cbl
 11075
 11076
 11077 1295-READ-CERT-TRAILER.
 11078
 11079
 11080* EXEC CICS GETMAIN
 11081*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11082*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11083*        INITIMG (GETMAIN-SPACE)
 11084*    END-EXEC
 11085*    MOVE ',"IL                  $   #00010797' TO DFHEIV0
 11086     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11087     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11088     MOVE X'2020233030303130373937' TO DFHEIV0(25:11)
 11089     CALL 'kxdfhei1' USING DFHEIV0,
 11090           DFHEIV20,
 11091           ELCRTT-RECORD-LENGTH,
 11092           GETMAIN-SPACE
 11093     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11094         DFHEIV20
 11095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11096
 11097     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11098     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11099     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11100
 11101
 11102* EXEC CICS HANDLE CONDITION
 11103*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11104*    END-EXEC.
 11105*    MOVE '"$I                   ! % #00010807' TO DFHEIV0
 11106     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11108     MOVE X'2520233030303130383037' TO DFHEIV0(25:11)
 11109     CALL 'kxdfhei1' USING DFHEIV0
 11110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11111
 11112
 11113
 11114* EXEC CICS READ
 11115*        DATASET  (CRTT-ID)
 11116*        RIDFLD   (ELCRTT-KEY)
 11117*        INTO     (CERTIFICATE-TRAILERS)
 11118*    END-EXEC.
 11119     MOVE LENGTH OF
 11120      CERTIFICATE-TRAILERS
 11121       TO DFHEIV11
 11122*    MOVE '&"IL       E          (   #00010811' TO DFHEIV0
 11123     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11125     MOVE X'2020233030303130383131' TO DFHEIV0(25:11)
 11126     CALL 'kxdfhei1' USING DFHEIV0,
 11127           CRTT-ID,
 11128           CERTIFICATE-TRAILERS,
 11129           DFHEIV11,
 11130           ELCRTT-KEY,
 11131           DFHEIV99,
 11132           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 205
* EL6311.cbl
 11133           DFHEIV99
 11134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11135
 11136
 11137     GO TO 1295-EXIT.
 11138
 11139 1295-CERT-TRL-REC-NOTFND.
 11140     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11141
 11142 1295-EXIT.
 11143     EXIT.
 11144
 11145******************************************************************
 11146*                                                                *
 11147*          C H A N G E   I S S U E   R O U T I N E               *
 11148*                                                                *
 11149******************************************************************
 11150
 11151***************************************************************
 11152*                                                             *
 11153*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11154*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11155*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11156*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11157*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11158*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11159*     5. LINK TO THE EDIT ROUTINE.                            *
 11160*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11161*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11162*              THE EDIT ROUTINE.                              *
 11163*     7. REWRITE THE NEW ISSUE                                *
 11164*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11165*                                                             *
 11166***************************************************************
 11167
 11168 1300-CHANGE-ISSUE-ROUTINE.
 11169     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11170
 11171     IF BCHGL NOT = ZEROS
 11172        MOVE ER-2196             TO EMI-ERROR
 11173        MOVE AL-UABON            TO BMAINTA
 11174        MOVE -1                  TO BMAINTL
 11175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11176        GO TO 8200-SEND-DATAONLY.
 11177
 11178     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11179
 11180     IF BSUFIXL NOT = ZEROS
 11181        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11182     ELSE
 11183        MOVE SPACE               TO WS-NEW-SUFFIX.
 11184
 11185     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11186     PERFORM 8600-DEEDIT.
 11187     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11188     MOVE '4'                    TO DC-OPTION-CODE.
 11189     PERFORM 9700-DATE-LINK.
 11190     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 206
* EL6311.cbl
 11191        MOVE ER-0348             TO EMI-ERROR
 11192        MOVE -1                  TO BEFFDTL
 11193        MOVE AL-UABON            TO BEFFDTA
 11194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11195        GO TO 8200-SEND-DATAONLY
 11196     ELSE
 11197        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11198        MOVE AL-UANON            TO BEFFDTA
 11199        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11200
 11201 1325-PROCESS-ISSUE-CHANGES.
 11202
 11203* EXEC CICS HANDLE CONDITION
 11204*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11205*    END-EXEC.
 11206*    MOVE '"$I                   ! & #00010882' TO DFHEIV0
 11207     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11209     MOVE X'2620233030303130383832' TO DFHEIV0(25:11)
 11210     CALL 'kxdfhei1' USING DFHEIV0
 11211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11212
 11213
 11214     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11215     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11216     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11217
 11218
 11219* EXEC CICS GETMAIN
 11220*        SET      (ADDRESS OF PENDING-BUSINESS)
 11221*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11222*        INITIMG  (GETMAIN-SPACE)
 11223*     END-EXEC.
 11224*    MOVE ',"IL                  $   #00010890' TO DFHEIV0
 11225     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11226     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11227     MOVE X'2020233030303130383930' TO DFHEIV0(25:11)
 11228     CALL 'kxdfhei1' USING DFHEIV0,
 11229           DFHEIV20,
 11230           ERPNDB-RECORD-LENGTH,
 11231           GETMAIN-SPACE
 11232     SET ADDRESS OF PENDING-BUSINESS TO
 11233         DFHEIV20
 11234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11235
 11236
 11237
 11238* EXEC CICS READ
 11239*        INTO    (PENDING-BUSINESS)
 11240*        DATASET (FILE-ID-ERPNDB)
 11241*        RIDFLD  (ERPNDB-KEY)
 11242*    END-EXEC.
 11243     MOVE LENGTH OF
 11244      PENDING-BUSINESS
 11245       TO DFHEIV11
 11246*    MOVE '&"IL       E          (   #00010896' TO DFHEIV0
 11247     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11248     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 207
* EL6311.cbl
 11249     MOVE X'2020233030303130383936' TO DFHEIV0(25:11)
 11250     CALL 'kxdfhei1' USING DFHEIV0,
 11251           FILE-ID-ERPNDB,
 11252           PENDING-BUSINESS,
 11253           DFHEIV11,
 11254           ERPNDB-KEY,
 11255           DFHEIV99,
 11256           DFHEIV99,
 11257           DFHEIV99
 11258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11259
 11260
 11261     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11262
 11263
 11264* EXEC CICS HANDLE CONDITION
 11265*         NOTFND     (1385-REC-NOT-FOUND)
 11266*    END-EXEC.
 11267*    MOVE '"$I                   ! '' #00010904' TO DFHEIV0
 11268     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11269     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11270     MOVE X'2720233030303130393034' TO DFHEIV0(25:11)
 11271     CALL 'kxdfhei1' USING DFHEIV0
 11272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11273
 11274
 11275**********************************************************
 11276*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11277*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11278**********************************************************
 11279
 11280
 11281* EXEC CICS READ
 11282*        DATASET (FILE-ID-ERPNDB)
 11283*        INTO    (PENDING-BUSINESS)
 11284*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11285*    END-EXEC.
 11286     MOVE LENGTH OF
 11287      PENDING-BUSINESS
 11288       TO DFHEIV11
 11289*    MOVE '&"IL       E          (   #00010913' TO DFHEIV0
 11290     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11292     MOVE X'2020233030303130393133' TO DFHEIV0(25:11)
 11293     CALL 'kxdfhei1' USING DFHEIV0,
 11294           FILE-ID-ERPNDB,
 11295           PENDING-BUSINESS,
 11296           DFHEIV11,
 11297           PI-PREV-CONTROL-PRIMARY,
 11298           DFHEIV99,
 11299           DFHEIV99,
 11300           DFHEIV99
 11301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11302
 11303
 11304********** DO NOT ALLOW CHANGES IF THRU A/R
 11305     IF BMAINTI = 'C'
 11306         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 208
* EL6311.cbl
 11307             MOVE ER-4005          TO EMI-ERROR
 11308             MOVE -1               TO BMAINTL
 11309             MOVE AL-UABON         TO BMAINTA
 11310             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11311             GO TO 8200-SEND-DATAONLY.
 11312**********
 11313
 11314     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11315        MOVE -1                 TO BMAINTL
 11316        MOVE ER-2197            TO EMI-ERROR
 11317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11318        GO TO 8200-SEND-DATAONLY.
 11319
 11320     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11321        MOVE ER-2196             TO EMI-ERROR
 11322        MOVE AL-UABON            TO BMAINTA
 11323        MOVE -1                  TO BMAINTL
 11324        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11325        GO TO 8200-SEND-DATAONLY.
 11326
 11327     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11328
 11329     IF PB-BILLED-DT = LOW-VALUES AND
 11330        PB-CHG-COUNT = ZEROS
 11331        NEXT SENTENCE
 11332     ELSE
 11333        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11334            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11335           OR
 11336           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11337            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11338           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11339
 11340
 11341* EXEC CICS READ
 11342*        DATASET (FILE-ID-ERPNDB)
 11343*        INTO    (PENDING-BUSINESS)
 11344*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11345*        UPDATE
 11346*    END-EXEC.
 11347     MOVE LENGTH OF
 11348      PENDING-BUSINESS
 11349       TO DFHEIV11
 11350*    MOVE '&"IL       EU         (   #00010955' TO DFHEIV0
 11351     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11352     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11353     MOVE X'2020233030303130393535' TO DFHEIV0(25:11)
 11354     CALL 'kxdfhei1' USING DFHEIV0,
 11355           FILE-ID-ERPNDB,
 11356           PENDING-BUSINESS,
 11357           DFHEIV11,
 11358           PI-PREV-CONTROL-PRIMARY,
 11359           DFHEIV99,
 11360           DFHEIV99,
 11361           DFHEIV99
 11362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11363
 11364
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 209
* EL6311.cbl
 11365     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11366     MOVE 'B'                    TO JP-RECORD-TYPE
 11367     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11368     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11369
 11370     PERFORM 8400-LOG-JOURNAL-RECORD.
 11371
 11372     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11373        PB-CHG-COUNT NOT = ZEROS
 11374        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11375            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11376           OR
 11377           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11378            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11379            MOVE LOW-VALUES             TO PB-BILLED-DT
 11380            ADD +1                      TO PB-CHG-COUNT.
 11381
 11382     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11383     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11384     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11385     MOVE '5'                    TO DC-OPTION-CODE.
 11386     PERFORM 9700-DATE-LINK
 11387     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11388
 11389*    IF BMICRNOL  GREATER  ZEROS
 11390*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11391
 11392     IF BVINL > ZEROS
 11393        MOVE BVINI               TO PB-I-VIN
 11394     END-IF
 11395     IF (BFORCEL NOT = ZEROS)
 11396        AND (PB-COMPANY-ID = 'DCC')
 11397        AND (BFORCEI = ' ')
 11398        AND (PB-FORCE-CODE = 'O')
 11399        COMPUTE PB-I-AH-PREMIUM-AMT =
 11400           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11401        PERFORM 1800-REMOVE-CERT-NOTES
 11402                                 THRU 1800-EXIT
 11403        PERFORM 1900-DELETE-ERPYAJ
 11404                                 THRU 1900-EXIT
 11405        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11406     END-IF
 11407     IF (BFORCEL NOT = ZEROS)
 11408        AND (PB-COMPANY-ID = 'DCC')
 11409        AND (BFORCEI = 'O')
 11410        AND (PB-FORCE-CODE NOT = 'O')
 11411        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11412           PB-I-AH-PREM-CALC
 11413        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11414        MOVE SPACE               TO DC-OPTION-CODE
 11415        PERFORM 9700-DATE-LINK
 11416        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11417        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11418        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11419        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11420        PERFORM 1500-UPDATE-ERNOTE
 11421                                 THRU 1500-EXIT
 11422        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 210
* EL6311.cbl
 11423                                 THRU 1600-EXIT
 11424     END-IF
 11425     IF BLSTNML  GREATER THAN ZEROS
 11426         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11427
 11428     IF B1STNML  GREATER THAN ZEROS
 11429         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11430
 11431     IF BINITL   GREATER THAN ZEROS
 11432         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11433
 11434     IF BBIRTHL  GREATER THAN ZERO
 11435         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11436
 11437     IF B1STPMTL GREATER THAN ZERO
 11438         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11439
 11440     IF BAGEL    GREATER THAN ZEROS
 11441         MOVE BAGEI              TO PB-I-AGE.
 11442
 11443     MOVE 'N'                    TO WS-INS-AGE-SET
 11444                                    WS-JNT-AGE-SET.
 11445     IF BAGEL    GREATER THAN ZEROS
 11446        MOVE 'Y'                TO WS-INS-AGE-SET
 11447        IF BAGEI = ZERO AND
 11448             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11449           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11450           MOVE 'AGE*'          TO BAGEDEFO
 11451        ELSE
 11452           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11453           MOVE 'AGE '          TO BAGEDEFO
 11454        END-IF
 11455        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11456     END-IF.
 11457
 11458     IF BSEXL    GREATER THAN ZEROS
 11459         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11460
 11461     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11462        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11463
 11464     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11465        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11466
 11467     IF BLNTRML  GREATER THAN ZEROS
 11468         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11469
 11470     IF BFREQL   GREATER THAN ZEROS
 11471         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11472
 11473     IF BSKPCDL  GREATER THAN ZEROS
 11474         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11475
 11476     IF BMODEL   GREATER THAN ZEROS
 11477         MOVE BMODEI             TO PB-I-TERM-TYPE
 11478                                    PI-BMODE.
 11479
 11480     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 211
* EL6311.cbl
 11481         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11482                                    PI-BPMTS.
 11483
 11484     IF BPMTAMTL GREATER THAN ZEROS
 11485         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11486
 11487     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11488         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11489
 11490     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11491         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11492
 11493     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11494
 11495     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11496         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11497            SUBTRACT PB-I-LF-PREMIUM-AMT
 11498                     FROM WS-B-LF-ISS-PRM-ENTERED
 11499            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11500            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11501            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11502         ELSE
 11503            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11504*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11505*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11506         END-IF
 11507     END-IF.
 11508
 11509     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11510            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11511                     FROM WS-B-LF-ISS-PRM-ENTERED
 11512         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11513         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11514
 11515     IF  BALT-PREM-LEN     (2)  > ZEROS
 11516         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11517
 11518     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11519         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11520
 11521     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11522         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11523            SUBTRACT PB-I-AH-PREMIUM-AMT
 11524                     FROM WS-B-AH-ISS-PRM-ENTERED
 11525            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11526            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11527            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11528         ELSE
 11529            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11530*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11531*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11532         END-IF
 11533     END-IF
 11534
 11535     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11536        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11537
 11538     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 212
* EL6311.cbl
 11539        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11540
 11541     IF BINDGRPL            GREATER THAN ZEROS
 11542         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11543
 11544     IF BRTCLSL             GREATER THAN ZEROS
 11545         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11546
 11547     IF BSIGL               GREATER THAN ZEROS
 11548         MOVE BSIGI              TO PB-I-SIG-SW.
 11549
 11550     IF BAPRL               GREATER THAN ZEROS
 11551         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11552
 11553     IF BMEMBERL            GREATER THAN ZEROS
 11554         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11555
 11556     IF BLNOFCRL            GREATER THAN ZEROS
 11557         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11558
 11559     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11560        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11561
 11562     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11563        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11564
 11565     IF BDAYSL              GREATER THAN ZEROS
 11566        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11567                                    PB-I-EXTENTION-DAYS.
 11568
 11569     IF BDAYSL GREATER THAN ZEROS
 11570        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11571
 11572     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11573        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11574           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11575
 11576     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11577        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11578           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11579
 11580     IF B1STPMTL GREATER THAN ZEROS
 11581        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11582
 11583     IF PB-EXT-DAYS-PROCESSING
 11584        IF PB-I-EXTENTION-DAYS = ZEROS
 11585           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11586
 11587     IF PB-EXPIRE-DT-PROCESSING
 11588        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11589           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11590             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11591
 11592     IF PB-1ST-PMT-DT-PROCESSING
 11593        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11594           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11595
 11596     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 213
* EL6311.cbl
 11597        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11598
 11599     IF BFORCEL NOT = ZEROS
 11600        MOVE BFORCEI             TO PB-FORCE-CODE.
 11601     IF (BENTRYL NOT = ZEROS)
 11602        AND (PB-COMPANY-ID = 'CID')
 11603        AND (PB-STATE = 'VA')
 11604        AND (BENTRYI NOT = 'P')
 11605        AND (PB-BATCH-ENTRY = 'P')
 11606        PERFORM 1800-REMOVE-CERT-NOTES
 11607                                 THRU 1800-EXIT
 11608     END-IF
 11609     IF BENTRYL NOT = ZEROS
 11610        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11611        IF PI-COMPANY-ID = 'CID'
 11612           AND (PB-BATCH-ENTRY = 'P')
 11613           AND (PB-STATE = 'VA')
 11614           PERFORM 1500-UPDATE-ERNOTE
 11615                                 THRU 1500-EXIT
 11616        END-IF
 11617     END-IF
 11618
 11619     IF BUNWRITL NOT = ZEROS
 11620        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11621
 11622     IF BBILCDL NOT = ZEROS
 11623        MOVE BBILCDI             TO PB-RECORD-BILL.
 11624
 11625     IF BLIVESL GREATER THAN ZEROS
 11626        MOVE WS-BLIVES           TO PB-I-LIVES.
 11627
 11628
 11629*DMD CUSTOM CODING*************START
 11630     IF PI-COMPANY-ID NOT = 'DMD'
 11631         MOVE ZEROS               TO BBILLEDL.
 11632*DMD CUSTOM CODING*************END
 11633
 11634     IF BBILLEDL GREATER THAN ZEROS
 11635        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11636
 11637
 11638*****************************************************************
 11639*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11640*****************************************************************
 11641
 11642     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11643        IF BTYPE  (1)   = ZEROS OR SPACES
 11644           IF REMOVE-LF-COVERAGE
 11645               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11646                                        PI-BTYPE (1)
 11647               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11648                                        WS-B-LF-ISS-PRM-ENTERED
 11649               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11650                                        WS-B-LF-ISS-PRM-ENTERED
 11651               SUBTRACT PB-I-LF-PREM-CALC FROM
 11652                                        WS-B-LF-ISS-PRM-COMPUTED
 11653               MOVE ZEROS            TO PB-I-LF-TERM
 11654                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 214
* EL6311.cbl
 11655                                        PB-I-LF-PREMIUM-AMT
 11656                                        PB-I-LF-BENEFIT-CD
 11657                                        PB-I-LF-PREM-CALC
 11658                                        PB-I-LF-CRIT-PER
 11659                                        PB-I-LF-ALT-BENEFIT-AMT
 11660                                        PB-I-LF-ALT-PREMIUM-AMT
 11661               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11662           ELSE
 11663               NEXT SENTENCE
 11664        ELSE
 11665           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11666                                    PI-BTYPE (1).
 11667     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11668        IF BTYPE  (2)   = ZEROS OR SPACES
 11669           IF  REMOVE-AH-COVERAGE
 11670               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11671                                        PI-BTYPE (2)
 11672               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11673                                        WS-B-AH-ISS-PRM-ENTERED
 11674               SUBTRACT PB-I-AH-PREM-CALC FROM
 11675                                        WS-B-AH-ISS-PRM-COMPUTED
 11676               MOVE ZEROS            TO PB-I-AH-TERM
 11677                                        PB-I-AH-BENEFIT-AMT
 11678                                        PB-I-AH-PREMIUM-AMT
 11679                                        PB-I-AH-BENEFIT-CD
 11680                                        PB-I-AH-PREM-CALC
 11681                                        PB-I-AH-CRIT-PER
 11682               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11683           ELSE
 11684               NEXT SENTENCE
 11685        ELSE
 11686           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11687                                    PI-BTYPE (2).
 11688 1360-REWRITE-PB-RECORD.
 11689     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11690
 11691     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11692     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11693
 11694     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11695
 11696     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11697     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11698
 11699     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11700         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11701
 11702     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11703         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11704
 11705     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11706
 11707     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11708
 11709     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11710
 11711     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11712     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 215
* EL6311.cbl
 11713     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11714
 11715     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11716     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11717
 11718 1375-REWRITE-PB-RECORD.
 11719     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11720     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11721     MOVE 'C'                    TO JP-RECORD-TYPE.
 11722     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11723
 11724
 11725* EXEC CICS REWRITE
 11726*        DATASET (FILE-ID-ERPNDB)
 11727*        FROM    (PENDING-BUSINESS)
 11728*    END-EXEC.
 11729     MOVE LENGTH OF
 11730      PENDING-BUSINESS
 11731       TO DFHEIV11
 11732*    MOVE '&& L                  %   #00011321' TO DFHEIV0
 11733     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11734     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11735     MOVE X'2020233030303131333231' TO DFHEIV0(25:11)
 11736     CALL 'kxdfhei1' USING DFHEIV0,
 11737           FILE-ID-ERPNDB,
 11738           PENDING-BUSINESS,
 11739           DFHEIV11,
 11740           DFHEIV99
 11741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11742
 11743
 11744     PERFORM 8400-LOG-JOURNAL-RECORD.
 11745******************************************************************
 11746*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11747******************************************************************
 11748*    display ' made it to update orig cert '
 11749     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11750     MOVE ' '                    TO WS-ERMAIL-SW
 11751
 11752* EXEC CICS READ
 11753*       DATASET   (FILE-ID-ERMAIL)
 11754*       SET       (ADDRESS OF MAILING-DATA)
 11755*       RIDFLD    (ERMAIL-KEY)
 11756*       RESP      (WS-RESPONSE)
 11757*    END-EXEC
 11758*    MOVE '&"S        E          (  N#00011333' TO DFHEIV0
 11759     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11761     MOVE X'204E233030303131333333' TO DFHEIV0(25:11)
 11762     CALL 'kxdfhei1' USING DFHEIV0,
 11763           FILE-ID-ERMAIL,
 11764           DFHEIV20,
 11765           DFHEIV99,
 11766           ERMAIL-KEY,
 11767           DFHEIV99,
 11768           DFHEIV99,
 11769           DFHEIV99
 11770     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 216
* EL6311.cbl
 11771         DFHEIV20
 11772     MOVE EIBRESP  TO WS-RESPONSE
 11773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11774     IF RESP-NORMAL
 11775        SET ERMAIL-FOUND TO TRUE
 11776     END-IF
 11777
 11778     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11779     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11780                                 TO ELCRTO-KEY
 11781     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11782     MOVE +0                     TO ELCRTO-SEQ-NO
 11783
 11784* EXEC CICS READ
 11785*       DATASET   ('ELCRTO')
 11786*       INTO      (ORIGINAL-CERTIFICATE)
 11787*       RIDFLD    (ELCRTO-KEY)
 11788*       GTEQ
 11789*       RESP      (WS-RESPONSE)
 11790*    END-EXEC
 11791     MOVE LENGTH OF
 11792      ORIGINAL-CERTIFICATE
 11793       TO DFHEIV11
 11794     MOVE 'ELCRTO' TO DFHEIV1
 11795*    MOVE '&"IL       G          (  N#00011348' TO DFHEIV0
 11796     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11798     MOVE X'204E233030303131333438' TO DFHEIV0(25:11)
 11799     CALL 'kxdfhei1' USING DFHEIV0,
 11800           DFHEIV1,
 11801           ORIGINAL-CERTIFICATE,
 11802           DFHEIV11,
 11803           ELCRTO-KEY,
 11804           DFHEIV99,
 11805           DFHEIV99,
 11806           DFHEIV99
 11807     MOVE EIBRESP  TO WS-RESPONSE
 11808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11809*    display ' just read gteq ' ws-response
 11810     IF RESP-NORMAL
 11811        AND (OC-CONTROL-PRIMARY (1:33) =
 11812                 PB-CONTROL-BY-ACCOUNT (1:33))
 11813        AND (OC-RECORD-TYPE = 'I')
 11814*       display ' resp norm, key =, type i '
 11815        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11816*          display ' end proc blank '
 11817           display ' csr edit session ' PI-CSR-SESSION-SW
 11818           IF NOT CSR-EDIT-SESSION
 11819
 11820* EXEC CICS READ
 11821*                DATASET   ('ELCRTO')
 11822*                INTO      (ORIGINAL-CERTIFICATE)
 11823*                RIDFLD    (OC-CONTROL-PRIMARY)
 11824*                UPDATE
 11825*                RESP      (WS-RESPONSE)
 11826*             END-EXEC
 11827     MOVE LENGTH OF
 11828      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 217
* EL6311.cbl
 11829       TO DFHEIV11
 11830     MOVE 'ELCRTO' TO DFHEIV1
 11831*    MOVE '&"IL       EU         (  N#00011365' TO DFHEIV0
 11832     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11833     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11834     MOVE X'204E233030303131333635' TO DFHEIV0(25:11)
 11835     CALL 'kxdfhei1' USING DFHEIV0,
 11836           DFHEIV1,
 11837           ORIGINAL-CERTIFICATE,
 11838           DFHEIV11,
 11839           OC-CONTROL-PRIMARY,
 11840           DFHEIV99,
 11841           DFHEIV99,
 11842           DFHEIV99
 11843     MOVE EIBRESP  TO WS-RESPONSE
 11844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11845              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11846              IF RESP-NORMAL
 11847                 display ' good read upd '
 11848                 MOVE PB-I-INSURED-LAST-NAME TO
 11849                         OC-INS-LAST-NAME
 11850                 MOVE PB-I-INSURED-FIRST-NAME TO
 11851                         OC-INS-FIRST-NAME
 11852                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11853                         OC-INS-MIDDLE-INIT
 11854                 MOVE PB-I-AGE         TO OC-INS-AGE
 11855                 MOVE PB-I-JOINT-LAST-NAME   TO
 11856                         OC-JNT-LAST-NAME
 11857                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11858                         OC-JNT-FIRST-NAME
 11859                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11860                         OC-JNT-MIDDLE-INIT
 11861                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11862                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11863                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11864                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11865                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11866                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11867                         OC-LF-ALT-BEN-AMT
 11868                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11869                         OC-LF-ALT-PRM-AMT
 11870                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11871                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11872                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11873                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11874                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11875                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11876                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11877                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11878                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11879                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11880                 IF OC-CANCEL-TRAN-IND = 'N'
 11881                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11882                    MOVE +0            TO OC-LF-CANCEL-AMT
 11883                                          OC-LF-ITD-CANCEL-AMT
 11884                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11885                    MOVE +0            TO OC-AH-CANCEL-AMT
 11886                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 218
* EL6311.cbl
 11887                 END-IF
 11888                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11889                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11890                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11891                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11892                 IF ERMAIL-FOUND
 11893                    MOVE MA-CRED-BENE-NAME
 11894                                 TO OC-CRED-BENE-NAME
 11895                 END-IF
 11896                 IF NOT CERT-TRL-REC-NOT-FOUND
 11897                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11898                           OC-INS-AGE-DEFAULT-FLAG
 11899                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11900                           OC-JNT-AGE-DEFAULT-FLAG
 11901                 END-IF
 11902
 11903* EXEC CICS REWRITE
 11904*                   DATASET   ('ELCRTO')
 11905*                   FROM      (ORIGINAL-CERTIFICATE)
 11906*                   RESP      (WS-RESPONSE)
 11907*                END-EXEC
 11908     MOVE LENGTH OF
 11909      ORIGINAL-CERTIFICATE
 11910       TO DFHEIV11
 11911     MOVE 'ELCRTO' TO DFHEIV1
 11912*    MOVE '&& L                  %  N#00011429' TO DFHEIV0
 11913     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11914     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11915     MOVE X'204E233030303131343239' TO DFHEIV0(25:11)
 11916     CALL 'kxdfhei1' USING DFHEIV0,
 11917           DFHEIV1,
 11918           ORIGINAL-CERTIFICATE,
 11919           DFHEIV11,
 11920           DFHEIV99
 11921     MOVE EIBRESP  TO WS-RESPONSE
 11922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11923                 display ' just rewrote ' ws-response
 11924              END-IF
 11925           END-IF
 11926        ELSE
 11927           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11928           MOVE 'OC'             TO OC-RECORD-ID
 11929           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11930           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11931           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11932           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11933           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11934           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11935           MOVE PB-I-AGE         TO OC-INS-AGE
 11936           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11937           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11938           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11939           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11940           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11941           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11942           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11943           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11944           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 219
* EL6311.cbl
 11945           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11946           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11947           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11948           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11949           MOVE +0               TO OC-LF-CANCEL-AMT
 11950                                    OC-LF-ITD-CANCEL-AMT
 11951           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11952           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11953           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11954           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11955           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11956           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11957           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11958           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11959           MOVE +0               TO OC-AH-CANCEL-AMT
 11960                                    OC-AH-ITD-CANCEL-AMT
 11961           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11962           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11963           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11964           IF ERMAIL-FOUND
 11965              MOVE MA-CRED-BENE-NAME
 11966                                 TO OC-CRED-BENE-NAME
 11967           END-IF
 11968           IF NOT CERT-TRL-REC-NOT-FOUND
 11969              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11970                           OC-INS-AGE-DEFAULT-FLAG
 11971              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11972                           OC-JNT-AGE-DEFAULT-FLAG
 11973           END-IF
 11974           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11975
 11976* EXEC CICS WRITE
 11977*             DATASET   ('ELCRTO')
 11978*             FROM      (ORIGINAL-CERTIFICATE)
 11979*             RIDFLD    (OC-CONTROL-PRIMARY)
 11980*             RESP      (WS-RESPONSE)
 11981*          END-EXEC
 11982     MOVE LENGTH OF
 11983      ORIGINAL-CERTIFICATE
 11984       TO DFHEIV11
 11985     MOVE 'ELCRTO' TO DFHEIV1
 11986*    MOVE '&$ L                  ''  N#00011486' TO DFHEIV0
 11987     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11989     MOVE X'204E233030303131343836' TO DFHEIV0(25:11)
 11990     CALL 'kxdfhei1' USING DFHEIV0,
 11991           DFHEIV1,
 11992           ORIGINAL-CERTIFICATE,
 11993           DFHEIV11,
 11994           OC-CONTROL-PRIMARY,
 11995           DFHEIV99,
 11996           DFHEIV99
 11997     MOVE EIBRESP  TO WS-RESPONSE
 11998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11999        END-IF
 12000     ELSE
 12001        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12002        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 220
* EL6311.cbl
 12003        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12004                                 TO OC-CONTROL-PRIMARY (1:33)
 12005        MOVE 'I'                 TO OC-RECORD-TYPE
 12006        MOVE +4096               TO OC-KEY-SEQ-NO
 12007        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12008        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12009        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12010        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12011        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12012        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12013        MOVE PB-I-AGE            TO OC-INS-AGE
 12014        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12015        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12016        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12017        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12018        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12019        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12020        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12021        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12022        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12023        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12024        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12025        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12026        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12027        MOVE +0                  TO OC-LF-CANCEL-AMT
 12028                                    OC-LF-ITD-CANCEL-AMT
 12029        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12030        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12031        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12032        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12033        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12034        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12035        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12036        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12037        MOVE +0                  TO OC-AH-CANCEL-AMT
 12038                                    OC-AH-ITD-CANCEL-AMT
 12039        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12040        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12041        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12042        IF ERMAIL-FOUND
 12043           MOVE MA-CRED-BENE-NAME
 12044                                 TO OC-CRED-BENE-NAME
 12045        END-IF
 12046        IF NOT CERT-TRL-REC-NOT-FOUND
 12047           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12048                           OC-INS-AGE-DEFAULT-FLAG
 12049           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12050                           OC-JNT-AGE-DEFAULT-FLAG
 12051        END-IF
 12052        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12053
 12054* EXEC CICS WRITE
 12055*          DATASET   ('ELCRTO')
 12056*          FROM      (ORIGINAL-CERTIFICATE)
 12057*          RIDFLD    (OC-CONTROL-PRIMARY)
 12058*          RESP      (WS-RESPONSE)
 12059*       END-EXEC
 12060     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 221
* EL6311.cbl
 12061      ORIGINAL-CERTIFICATE
 12062       TO DFHEIV11
 12063     MOVE 'ELCRTO' TO DFHEIV1
 12064*    MOVE '&$ L                  ''  N#00011546' TO DFHEIV0
 12065     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12067     MOVE X'204E233030303131353436' TO DFHEIV0(25:11)
 12068     CALL 'kxdfhei1' USING DFHEIV0,
 12069           DFHEIV1,
 12070           ORIGINAL-CERTIFICATE,
 12071           DFHEIV11,
 12072           OC-CONTROL-PRIMARY,
 12073           DFHEIV99,
 12074           DFHEIV99
 12075     MOVE EIBRESP  TO WS-RESPONSE
 12076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12077     END-IF
 12078******************************************************************
 12079*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12080******************************************************************
 12081
 12082     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12083     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12084
 12085
 12086* EXEC CICS READ
 12087*        INTO    (PENDING-BUSINESS)
 12088*        DATASET (FILE-ID-ERPNDB)
 12089*        RIDFLD  (ERPNDB-KEY)
 12090*        UPDATE
 12091*    END-EXEC.
 12092     MOVE LENGTH OF
 12093      PENDING-BUSINESS
 12094       TO DFHEIV11
 12095*    MOVE '&"IL       EU         (   #00011560' TO DFHEIV0
 12096     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12097     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12098     MOVE X'2020233030303131353630' TO DFHEIV0(25:11)
 12099     CALL 'kxdfhei1' USING DFHEIV0,
 12100           FILE-ID-ERPNDB,
 12101           PENDING-BUSINESS,
 12102           DFHEIV11,
 12103           ERPNDB-KEY,
 12104           DFHEIV99,
 12105           DFHEIV99,
 12106           DFHEIV99
 12107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12108
 12109
 12110     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12111     MOVE 'B'                    TO JP-RECORD-TYPE.
 12112     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12113
 12114     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12115
 12116     PERFORM 8400-LOG-JOURNAL-RECORD.
 12117
 12118     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 222
* EL6311.cbl
 12119
 12120     MOVE 'C'                    TO JP-RECORD-TYPE.
 12121     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12122
 12123
 12124* EXEC CICS REWRITE
 12125*        DATASET    (FILE-ID-ERPNDB)
 12126*        FROM       (PENDING-BUSINESS)
 12127*    END-EXEC.
 12128     MOVE LENGTH OF
 12129      PENDING-BUSINESS
 12130       TO DFHEIV11
 12131*    MOVE '&& L                  %   #00011580' TO DFHEIV0
 12132     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12133     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12134     MOVE X'2020233030303131353830' TO DFHEIV0(25:11)
 12135     CALL 'kxdfhei1' USING DFHEIV0,
 12136           FILE-ID-ERPNDB,
 12137           PENDING-BUSINESS,
 12138           DFHEIV11,
 12139           DFHEIV99
 12140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12141
 12142
 12143     PERFORM 8400-LOG-JOURNAL-RECORD.
 12144
 12145     IF WS-ERRORS-PRESENT
 12146        GO TO 3900-RE-DISPLAY-RECORD.
 12147
 12148     MOVE ZEROS                  TO EMI-ERROR.
 12149     MOVE -1                     TO BMAINTL.
 12150     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12151     GO TO 3900-RE-DISPLAY-RECORD.
 12152
 12153 1380-BATCH-HDR-NOT-FOUND.
 12154     MOVE -1                     TO BMAINTL.
 12155     MOVE ER-7450                TO EMI-ERROR.
 12156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12157     GO TO 8200-SEND-DATAONLY.
 12158
 12159 1385-REC-NOT-FOUND.
 12160     MOVE -1                     TO BMAINTL.
 12161     MOVE ER-7451                TO EMI-ERROR.
 12162     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12163     GO TO 8200-SEND-DATAONLY.
 12164
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 223
* EL6311.cbl
 12166
 12167 1386-UPDATE-AGE-FLAGS.
 12168
 12169
 12170* EXEC CICS GETMAIN
 12171*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12172*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12173*        INITIMG (GETMAIN-SPACE)
 12174*    END-EXEC
 12175*    MOVE ',"IL                  $   #00011611' TO DFHEIV0
 12176     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12177     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12178     MOVE X'2020233030303131363131' TO DFHEIV0(25:11)
 12179     CALL 'kxdfhei1' USING DFHEIV0,
 12180           DFHEIV20,
 12181           ELCRTT-RECORD-LENGTH,
 12182           GETMAIN-SPACE
 12183     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12184         DFHEIV20
 12185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12186
 12187
 12188* EXEC CICS HANDLE CONDITION
 12189*        NOTFND   (1386-NOTFND)
 12190*    END-EXEC.
 12191*    MOVE '"$I                   ! ( #00011617' TO DFHEIV0
 12192     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12194     MOVE X'2820233030303131363137' TO DFHEIV0(25:11)
 12195     CALL 'kxdfhei1' USING DFHEIV0
 12196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12197
 12198
 12199     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12200     MOVE 'C'                TO ELCRTT-REC-TYPE
 12201
 12202
 12203* EXEC CICS READ
 12204*        UPDATE
 12205*        DATASET  (CRTT-ID)
 12206*        RIDFLD   (ELCRTT-KEY)
 12207*        INTO     (CERTIFICATE-TRAILERS)
 12208*    END-EXEC.
 12209     MOVE LENGTH OF
 12210      CERTIFICATE-TRAILERS
 12211       TO DFHEIV11
 12212*    MOVE '&"IL       EU         (   #00011624' TO DFHEIV0
 12213     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12214     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12215     MOVE X'2020233030303131363234' TO DFHEIV0(25:11)
 12216     CALL 'kxdfhei1' USING DFHEIV0,
 12217           CRTT-ID,
 12218           CERTIFICATE-TRAILERS,
 12219           DFHEIV11,
 12220           ELCRTT-KEY,
 12221           DFHEIV99,
 12222           DFHEIV99,
 12223           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 224
* EL6311.cbl
 12224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12225
 12226
 12227     IF WS-INS-AGE-SET = 'Y'
 12228        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12229     END-IF
 12230     IF WS-JNT-AGE-SET = 'Y'
 12231        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12232     END-IF
 12233
 12234
 12235* EXEC CICS REWRITE
 12236*       DATASET  (CRTT-ID)
 12237*       FROM     (CERTIFICATE-TRAILERS)
 12238*    END-EXEC.
 12239     MOVE LENGTH OF
 12240      CERTIFICATE-TRAILERS
 12241       TO DFHEIV11
 12242*    MOVE '&& L                  %   #00011638' TO DFHEIV0
 12243     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12244     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12245     MOVE X'2020233030303131363338' TO DFHEIV0(25:11)
 12246     CALL 'kxdfhei1' USING DFHEIV0,
 12247           CRTT-ID,
 12248           CERTIFICATE-TRAILERS,
 12249           DFHEIV11,
 12250           DFHEIV99
 12251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12252
 12253
 12254     GO TO 1386-EXIT.
 12255
 12256 1386-NOTFND.
 12257
 12258     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12259     MOVE 'CS'         TO CS-RECORD-ID.
 12260     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12261     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12262     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12263     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12264     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12265
 12266* EXEC CICS WRITE
 12267*       DATASET  (CRTT-ID)
 12268*       RIDFLD   (ELCRTT-KEY)
 12269*       FROM     (CERTIFICATE-TRAILERS)
 12270*    END-EXEC.
 12271     MOVE LENGTH OF
 12272      CERTIFICATE-TRAILERS
 12273       TO DFHEIV11
 12274*    MOVE '&$ L                  ''   #00011654' TO DFHEIV0
 12275     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12276     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12277     MOVE X'2020233030303131363534' TO DFHEIV0(25:11)
 12278     CALL 'kxdfhei1' USING DFHEIV0,
 12279           CRTT-ID,
 12280           CERTIFICATE-TRAILERS,
 12281           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 225
* EL6311.cbl
 12282           ELCRTT-KEY,
 12283           DFHEIV99,
 12284           DFHEIV99
 12285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12286
 12287
 12288 1386-EXIT.
 12289     EXIT.
 12290
 12291 1390-UPDATE-ERPNDM.
 12292
 12293
 12294* EXEC CICS HANDLE CONDITION
 12295*        NOTFND (1399-EXIT)
 12296*    END-EXEC.
 12297*    MOVE '"$I                   ! ) #00011665' TO DFHEIV0
 12298     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12300     MOVE X'2920233030303131363635' TO DFHEIV0(25:11)
 12301     CALL 'kxdfhei1' USING DFHEIV0
 12302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12303
 12304
 12305     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12306
 12307
 12308* EXEC CICS READ
 12309*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12310*        DATASET (FILE-ID-ERPNDM)
 12311*        RIDFLD  (ERPNDM-KEY)
 12312*        UPDATE
 12313*    END-EXEC.
 12314*    MOVE '&"S        EU         (   #00011671' TO DFHEIV0
 12315     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12316     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12317     MOVE X'2020233030303131363731' TO DFHEIV0(25:11)
 12318     CALL 'kxdfhei1' USING DFHEIV0,
 12319           FILE-ID-ERPNDM,
 12320           DFHEIV20,
 12321           DFHEIV99,
 12322           ERPNDM-KEY,
 12323           DFHEIV99,
 12324           DFHEIV99,
 12325           DFHEIV99
 12326     SET ADDRESS OF PENDING-MAILING-DATA TO
 12327         DFHEIV20
 12328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12329
 12330
 12331     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12332     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12333     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12334
 12335     IF BLSTNML GREATER THAN ZEROS
 12336         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12337
 12338     IF B1STNML GREATER  THAN ZEROS
 12339         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 226
* EL6311.cbl
 12340
 12341     IF BINITL GREATER THAN ZEROS
 12342         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12343
 12344     IF BAGEL GREATER THAN ZEROS
 12345         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12346
 12347     IF BBIRTHL GREATER THAN ZEROS
 12348         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12349
 12350     IF BSEXL GREATER THAN ZEROS
 12351         MOVE  BSEXI             TO PM-INSURED-SEX.
 12352
 12353
 12354* EXEC CICS REWRITE
 12355*        DATASET (FILE-ID-ERPNDM)
 12356*        FROM    (PENDING-MAILING-DATA)
 12357*    END-EXEC.
 12358     MOVE LENGTH OF
 12359      PENDING-MAILING-DATA
 12360       TO DFHEIV11
 12361*    MOVE '&& L                  %   #00011700' TO DFHEIV0
 12362     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12363     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12364     MOVE X'2020233030303131373030' TO DFHEIV0(25:11)
 12365     CALL 'kxdfhei1' USING DFHEIV0,
 12366           FILE-ID-ERPNDM,
 12367           PENDING-MAILING-DATA,
 12368           DFHEIV11,
 12369           DFHEIV99
 12370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12371
 12372
 12373 1399-EXIT.
 12374     EXIT.
 12375
 12376******************************************************************
 12377*                                                                *
 12378*          D E L E T E   I S S U E   R O U T I N E               *
 12379*                                                                *
 12380******************************************************************
 12381
 12382 1400-DELETE-ISSUE-ROUTINE.
 12383     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12384
 12385     IF BCHGL NOT = ZEROS
 12386        MOVE ER-2196             TO EMI-ERROR
 12387        MOVE AL-UABON            TO BMAINTA
 12388        MOVE -1                  TO BMAINTL
 12389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12390        GO TO 8200-SEND-DATAONLY.
 12391
 12392
 12393* EXEC CICS HANDLE CONDITION
 12394*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12395*    END-EXEC.
 12396*    MOVE '"$I                   ! * #00011724' TO DFHEIV0
 12397     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 227
* EL6311.cbl
 12398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12399     MOVE X'2A20233030303131373234' TO DFHEIV0(25:11)
 12400     CALL 'kxdfhei1' USING DFHEIV0
 12401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12402
 12403
 12404     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12405     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12406     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12407
 12408
 12409* EXEC CICS READ
 12410*        SET     (ADDRESS OF PENDING-BUSINESS)
 12411*        DATASET (FILE-ID-ERPNDB)
 12412*        RIDFLD  (ERPNDB-KEY)
 12413*    END-EXEC.
 12414*    MOVE '&"S        E          (   #00011732' TO DFHEIV0
 12415     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12417     MOVE X'2020233030303131373332' TO DFHEIV0(25:11)
 12418     CALL 'kxdfhei1' USING DFHEIV0,
 12419           FILE-ID-ERPNDB,
 12420           DFHEIV20,
 12421           DFHEIV99,
 12422           ERPNDB-KEY,
 12423           DFHEIV99,
 12424           DFHEIV99,
 12425           DFHEIV99
 12426     SET ADDRESS OF PENDING-BUSINESS TO
 12427         DFHEIV20
 12428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12429
 12430
 12431     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12432
 12433     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12434
 12435     IF BSUFIXL NOT = ZEROS
 12436        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12437     ELSE
 12438        MOVE SPACE               TO WS-NEW-SUFFIX.
 12439
 12440     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12441     PERFORM 8600-DEEDIT.
 12442     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12443     MOVE '4'                    TO DC-OPTION-CODE.
 12444     PERFORM 9700-DATE-LINK.
 12445     IF DATE-CONVERSION-ERROR
 12446        MOVE ER-0348             TO EMI-ERROR
 12447        MOVE -1                  TO BEFFDTL
 12448        MOVE AL-UABON            TO BEFFDTA
 12449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12450        GO TO 8200-SEND-DATAONLY
 12451     ELSE
 12452        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12453        MOVE AL-UANON            TO BEFFDTA
 12454        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12455
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 228
* EL6311.cbl
 12456
 12457* EXEC CICS HANDLE CONDITION
 12458*         NOTFND    (1490-RECORD-NOT-FOUND)
 12459*    END-EXEC.
 12460*    MOVE '"$I                   ! + #00011763' TO DFHEIV0
 12461     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12463     MOVE X'2B20233030303131373633' TO DFHEIV0(25:11)
 12464     CALL 'kxdfhei1' USING DFHEIV0
 12465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12466
 12467
 12468
 12469* EXEC CICS READ
 12470*        SET     (ADDRESS OF PENDING-BUSINESS)
 12471*        DATASET (FILE-ID-ERPNDB)
 12472*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12473*        UPDATE
 12474*    END-EXEC.
 12475*    MOVE '&"S        EU         (   #00011767' TO DFHEIV0
 12476     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12477     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12478     MOVE X'2020233030303131373637' TO DFHEIV0(25:11)
 12479     CALL 'kxdfhei1' USING DFHEIV0,
 12480           FILE-ID-ERPNDB,
 12481           DFHEIV20,
 12482           DFHEIV99,
 12483           PI-PREV-CONTROL-PRIMARY,
 12484           DFHEIV99,
 12485           DFHEIV99,
 12486           DFHEIV99
 12487     SET ADDRESS OF PENDING-BUSINESS TO
 12488         DFHEIV20
 12489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12490
 12491
 12492     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12493        MOVE -1                 TO BMAINTL
 12494        MOVE ER-2197            TO EMI-ERROR
 12495        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12496        GO TO 8200-SEND-DATAONLY.
 12497
 12498     IF PB-BILLED-DT NOT = LOW-VALUES
 12499        MOVE -1                 TO BMAINTL
 12500        MOVE ER-2129            TO EMI-ERROR
 12501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12502        GO TO 8200-SEND-DATAONLY.
 12503
 12504     IF PB-CHG-COUNT NOT = ZEROS
 12505        MOVE ER-2336            TO EMI-ERROR
 12506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12507        MOVE AL-UABON            TO BMAINTA
 12508        MOVE -1                  TO BMAINTL
 12509        GO TO 8200-SEND-DATAONLY.
 12510
 12511     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12512        PB-CHG-COUNT NOT = ZEROS
 12513        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 229
* EL6311.cbl
 12514        MOVE AL-UABON            TO BMAINTA
 12515        MOVE -1                  TO BMAINTL
 12516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12517        GO TO 8200-SEND-DATAONLY.
 12518******************************************************************
 12519*                                                                *
 12520*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12521*                                                                *
 12522******************************************************************
 12523     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12524     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12525     MOVE +0                     TO ELCRTO-SEQ-NO
 12526
 12527* EXEC CICS READ
 12528*       DATASET   ('ELCRTO')
 12529*       INTO      (ORIGINAL-CERTIFICATE)
 12530*       RIDFLD    (ELCRTO-KEY)
 12531*       GTEQ
 12532*       RESP      (WS-RESPONSE)
 12533*    END-EXEC
 12534     MOVE LENGTH OF
 12535      ORIGINAL-CERTIFICATE
 12536       TO DFHEIV11
 12537     MOVE 'ELCRTO' TO DFHEIV1
 12538*    MOVE '&"IL       G          (  N#00011808' TO DFHEIV0
 12539     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12541     MOVE X'204E233030303131383038' TO DFHEIV0(25:11)
 12542     CALL 'kxdfhei1' USING DFHEIV0,
 12543           DFHEIV1,
 12544           ORIGINAL-CERTIFICATE,
 12545           DFHEIV11,
 12546           ELCRTO-KEY,
 12547           DFHEIV99,
 12548           DFHEIV99,
 12549           DFHEIV99
 12550     MOVE EIBRESP  TO WS-RESPONSE
 12551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12552     IF RESP-NORMAL
 12553        AND (OC-CONTROL-PRIMARY (1:33) =
 12554                 PB-CONTROL-BY-ACCOUNT (1:33))
 12555        AND (OC-RECORD-TYPE = 'I')
 12556
 12557* EXEC CICS READ
 12558*          DATASET   ('ELCRTO')
 12559*          INTO      (ORIGINAL-CERTIFICATE)
 12560*          RIDFLD    (ELCRTO-KEY)
 12561*          UPDATE
 12562*          RESP      (WS-RESPONSE)
 12563*       END-EXEC
 12564     MOVE LENGTH OF
 12565      ORIGINAL-CERTIFICATE
 12566       TO DFHEIV11
 12567     MOVE 'ELCRTO' TO DFHEIV1
 12568*    MOVE '&"IL       EU         (  N#00011819' TO DFHEIV0
 12569     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12570     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12571     MOVE X'204E233030303131383139' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 230
* EL6311.cbl
 12572     CALL 'kxdfhei1' USING DFHEIV0,
 12573           DFHEIV1,
 12574           ORIGINAL-CERTIFICATE,
 12575           DFHEIV11,
 12576           ELCRTO-KEY,
 12577           DFHEIV99,
 12578           DFHEIV99,
 12579           DFHEIV99
 12580     MOVE EIBRESP  TO WS-RESPONSE
 12581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12582        IF RESP-NORMAL
 12583
 12584* EXEC CICS DELETE
 12585*             DATASET   ('ELCRTO')
 12586*          END-EXEC
 12587     MOVE 'ELCRTO' TO DFHEIV1
 12588*    MOVE '&(                    &   #00011827' TO DFHEIV0
 12589     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12590     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12591     MOVE X'2020233030303131383237' TO DFHEIV0(25:11)
 12592     CALL 'kxdfhei1' USING DFHEIV0,
 12593           DFHEIV1,
 12594           DFHEIV99,
 12595           DFHEIV99,
 12596           DFHEIV99,
 12597           DFHEIV99
 12598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12599        END-IF
 12600     END-IF
 12601******************************************************************
 12602*                                                                *
 12603*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12604*                                                                *
 12605******************************************************************
 12606
 12607* EXEC CICS HANDLE CONDITION
 12608*        NOTFND    (1405-DELETE-CERTIFICATE)
 12609*    END-EXEC.
 12610*    MOVE '"$I                   ! , #00011837' TO DFHEIV0
 12611     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12613     MOVE X'2C20233030303131383337' TO DFHEIV0(25:11)
 12614     CALL 'kxdfhei1' USING DFHEIV0
 12615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12616
 12617
 12618
 12619* EXEC CICS READ
 12620*        EQUAL
 12621*        DATASET   (FILE-ID-ERPNDM)
 12622*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12623*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12624*        UPDATE
 12625*    END-EXEC.
 12626*    MOVE '&"S        EU         (   #00011841' TO DFHEIV0
 12627     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12628     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12629     MOVE X'2020233030303131383431' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 231
* EL6311.cbl
 12630     CALL 'kxdfhei1' USING DFHEIV0,
 12631           FILE-ID-ERPNDM,
 12632           DFHEIV20,
 12633           DFHEIV99,
 12634           PI-PREV-CONTROL-PRIMARY,
 12635           DFHEIV99,
 12636           DFHEIV99,
 12637           DFHEIV99
 12638     SET ADDRESS OF PENDING-MAILING-DATA TO
 12639         DFHEIV20
 12640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12641
 12642
 12643     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12644     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12645     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12646
 12647     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12648
 12649
 12650* EXEC CICS DELETE
 12651*        DATASET   (FILE-ID-ERPNDM)
 12652*    END-EXEC.
 12653*    MOVE '&(                    &   #00011855' TO DFHEIV0
 12654     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12656     MOVE X'2020233030303131383535' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0,
 12658           FILE-ID-ERPNDM,
 12659           DFHEIV99,
 12660           DFHEIV99,
 12661           DFHEIV99,
 12662           DFHEIV99
 12663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12664
 12665
 12666******************************************************************
 12667*                PROCESS   CERTIFICATE                           *
 12668******************************************************************
 12669
 12670 1405-DELETE-CERTIFICATE.
 12671
 12672* EXEC CICS HANDLE CONDITION
 12673*         NOTFND  (1420-CONTINUE-DELETE)
 12674*    END-EXEC.
 12675*    MOVE '"$I                   ! - #00011864' TO DFHEIV0
 12676     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12678     MOVE X'2D20233030303131383634' TO DFHEIV0(25:11)
 12679     CALL 'kxdfhei1' USING DFHEIV0
 12680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12681
 12682
 12683     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12684     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12685     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12686     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12687
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 232
* EL6311.cbl
 12688
 12689* EXEC CICS READ
 12690*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12691*        DATASET (FILE-ID-ELCERT)
 12692*        RIDFLD  (ELCERT-KEY)
 12693*        UPDATE
 12694*    END-EXEC.
 12695*    MOVE '&"S        EU         (   #00011873' TO DFHEIV0
 12696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12698     MOVE X'2020233030303131383733' TO DFHEIV0(25:11)
 12699     CALL 'kxdfhei1' USING DFHEIV0,
 12700           FILE-ID-ELCERT,
 12701           DFHEIV20,
 12702           DFHEIV99,
 12703           ELCERT-KEY,
 12704           DFHEIV99,
 12705           DFHEIV99,
 12706           DFHEIV99
 12707     SET ADDRESS OF CERTIFICATE-MASTER TO
 12708         DFHEIV20
 12709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12710
 12711
 12712     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12713
 12714     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12715     MOVE 'B'                    TO JP-RECORD-TYPE
 12716     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12717
 12718     PERFORM 8400-LOG-JOURNAL-RECORD.
 12719
 12720     IF CERT-NOTES-ARE-NOT-PRESENT
 12721        MOVE ' '                 TO WS-CERT-NOTE-SW
 12722     ELSE
 12723        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12724
 12725     IF INSURED-ADDR-PRESENT
 12726        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12727
 12728******************************************************************
 12729******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12730******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12731******************************************************************
 12732******************************************************************
 12733
 12734     IF CERT-ADDED-BATCH AND
 12735        (NOT NO-CLAIM-ATTACHED
 12736         OR
 12737         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12738        GO TO 1410-REWRITE-CERT.
 12739
 12740******************************************************************
 12741******************************************************************
 12742
 12743     IF CERT-ADDED-BATCH  AND
 12744        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12745        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 233
* EL6311.cbl
 12746
 12747     IF NO-CLAIM-ATTACHED
 12748        NEXT SENTENCE
 12749     ELSE
 12750        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12751        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12752        GO TO 1410-REWRITE-CERT.
 12753
 12754     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12755     MOVE 'D'                      TO JP-RECORD-TYPE.
 12756     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12757
 12758
 12759* EXEC CICS DELETE
 12760*         DATASET    (FILE-ID-ELCERT)
 12761*    END-EXEC.
 12762*    MOVE '&(                    &   #00011926' TO DFHEIV0
 12763     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12764     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12765     MOVE X'2020233030303131393236' TO DFHEIV0(25:11)
 12766     CALL 'kxdfhei1' USING DFHEIV0,
 12767           FILE-ID-ELCERT,
 12768           DFHEIV99,
 12769           DFHEIV99,
 12770           DFHEIV99,
 12771           DFHEIV99
 12772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12773
 12774
 12775     PERFORM 8400-LOG-JOURNAL-RECORD.
 12776
 12777******************************************************************
 12778*                                                                *
 12779*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12780*                                                                *
 12781******************************************************************
 12782
 12783     IF  CERT-NOTES-ARE-PRESENT
 12784         NEXT SENTENCE
 12785     ELSE
 12786         GO TO 1407-DELETE-MAILING.
 12787
 12788
 12789* EXEC CICS HANDLE CONDITION
 12790*         NOTFND  (1406-DELETE-ERNOTE)
 12791*    END-EXEC.
 12792*    MOVE '"$I                   ! . #00011943' TO DFHEIV0
 12793     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12795     MOVE X'2E20233030303131393433' TO DFHEIV0(25:11)
 12796     CALL 'kxdfhei1' USING DFHEIV0
 12797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12798
 12799
 12800     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12801     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12802     MOVE 0                     TO ERCNOT-SEQUENCE.
 12803
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 234
* EL6311.cbl
 12804 1406-DELETE-ERCNOT-LOOP.
 12805
 12806
 12807* EXEC CICS READ
 12808*        GTEQ
 12809*        DATASET   (FILE-ID-ERCNOT)
 12810*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12811*        RIDFLD    (ERCNOT-KEY)
 12812*    END-EXEC.
 12813*    MOVE '&"S        G          (   #00011953' TO DFHEIV0
 12814     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12816     MOVE X'2020233030303131393533' TO DFHEIV0(25:11)
 12817     CALL 'kxdfhei1' USING DFHEIV0,
 12818           FILE-ID-ERCNOT,
 12819           DFHEIV20,
 12820           DFHEIV99,
 12821           ERCNOT-KEY,
 12822           DFHEIV99,
 12823           DFHEIV99,
 12824           DFHEIV99
 12825     SET ADDRESS OF CERT-NOTE-FILE TO
 12826         DFHEIV20
 12827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12828
 12829
 12830     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12831     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12832         GO TO 1406-DELETE-ERNOTE
 12833     END-IF.
 12834
 12835     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12836     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12837     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12838
 12839     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12840
 12841
 12842* EXEC CICS DELETE
 12843*        DATASET   (FILE-ID-ERCNOT)
 12844*        RIDFLD    (ERCNOT-KEY)
 12845*        END-EXEC.
 12846*    MOVE '&(  R                 &   #00011971' TO DFHEIV0
 12847     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12848     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12849     MOVE X'2020233030303131393731' TO DFHEIV0(25:11)
 12850     CALL 'kxdfhei1' USING DFHEIV0,
 12851           FILE-ID-ERCNOT,
 12852           ERCNOT-KEY,
 12853           DFHEIV99,
 12854           DFHEIV99,
 12855           DFHEIV99
 12856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12857
 12858
 12859     PERFORM 8400-LOG-JOURNAL-RECORD.
 12860
 12861     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 235
* EL6311.cbl
 12862
 12863 1406-DELETE-ERNOTE.
 12864
 12865
 12866* EXEC CICS HANDLE CONDITION
 12867*         NOTFND  (1407-DELETE-MAILING)
 12868*    END-EXEC.
 12869*    MOVE '"$I                   ! / #00011982' TO DFHEIV0
 12870     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12871     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12872     MOVE X'2F20233030303131393832' TO DFHEIV0(25:11)
 12873     CALL 'kxdfhei1' USING DFHEIV0
 12874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12875
 12876
 12877
 12878* EXEC CICS READ
 12879*        EQUAL
 12880*        DATASET   (FILE-ID-ERNOTE)
 12881*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12882*        RIDFLD    (ELCERT-KEY)
 12883*        UPDATE
 12884*    END-EXEC.
 12885*    MOVE '&"S        EU         (   #00011986' TO DFHEIV0
 12886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12887     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12888     MOVE X'2020233030303131393836' TO DFHEIV0(25:11)
 12889     CALL 'kxdfhei1' USING DFHEIV0,
 12890           FILE-ID-ERNOTE,
 12891           DFHEIV20,
 12892           DFHEIV99,
 12893           ELCERT-KEY,
 12894           DFHEIV99,
 12895           DFHEIV99,
 12896           DFHEIV99
 12897     SET ADDRESS OF CERTIFICATE-NOTE TO
 12898         DFHEIV20
 12899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12900
 12901
 12902     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12903     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12904     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12905
 12906     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12907
 12908
 12909* EXEC CICS DELETE
 12910*        DATASET   (FILE-ID-ERNOTE)
 12911*        END-EXEC.
 12912*    MOVE '&(                    &   #00012000' TO DFHEIV0
 12913     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12915     MOVE X'2020233030303132303030' TO DFHEIV0(25:11)
 12916     CALL 'kxdfhei1' USING DFHEIV0,
 12917           FILE-ID-ERNOTE,
 12918           DFHEIV99,
 12919           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 236
* EL6311.cbl
 12920           DFHEIV99,
 12921           DFHEIV99
 12922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12923
 12924
 12925     PERFORM 8400-LOG-JOURNAL-RECORD.
 12926
 12927******************************************************************
 12928*                                                                *
 12929*                DELETE MAILING ADDRESS RECORDS                  *
 12930*                                                                *
 12931******************************************************************
 12932
 12933 1407-DELETE-MAILING.
 12934     IF CERT-ADDRESS-PRESENT
 12935        NEXT SENTENCE
 12936     ELSE
 12937        GO TO 1420-CONTINUE-DELETE.
 12938
 12939
 12940* EXEC CICS HANDLE CONDITION
 12941*         NOTFND  (1420-CONTINUE-DELETE)
 12942*    END-EXEC.
 12943*    MOVE '"$I                   ! 0 #00012018' TO DFHEIV0
 12944     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12945     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12946     MOVE X'3020233030303132303138' TO DFHEIV0(25:11)
 12947     CALL 'kxdfhei1' USING DFHEIV0
 12948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12949
 12950
 12951
 12952* EXEC CICS READ
 12953*        EQUAL
 12954*        DATASET   (FILE-ID-ERMAIL)
 12955*        SET       (ADDRESS OF MAILING-DATA)
 12956*        RIDFLD    (ELCERT-KEY)
 12957*        UPDATE
 12958*    END-EXEC.
 12959*    MOVE '&"S        EU         (   #00012022' TO DFHEIV0
 12960     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12961     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12962     MOVE X'2020233030303132303232' TO DFHEIV0(25:11)
 12963     CALL 'kxdfhei1' USING DFHEIV0,
 12964           FILE-ID-ERMAIL,
 12965           DFHEIV20,
 12966           DFHEIV99,
 12967           ELCERT-KEY,
 12968           DFHEIV99,
 12969           DFHEIV99,
 12970           DFHEIV99
 12971     SET ADDRESS OF MAILING-DATA TO
 12972         DFHEIV20
 12973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12974
 12975
 12976     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12977     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 237
* EL6311.cbl
 12978     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12979
 12980     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12981
 12982
 12983* EXEC CICS DELETE
 12984*        DATASET   (FILE-ID-ERMAIL)
 12985*    END-EXEC.
 12986*    MOVE '&(                    &   #00012036' TO DFHEIV0
 12987     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12988     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12989     MOVE X'2020233030303132303336' TO DFHEIV0(25:11)
 12990     CALL 'kxdfhei1' USING DFHEIV0,
 12991           FILE-ID-ERMAIL,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99,
 12995           DFHEIV99
 12996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12997
 12998
 12999     GO TO 1420-CONTINUE-DELETE.
 13000
 13001 1410-REWRITE-CERT.
 13002     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13003     MOVE 'C'                      TO JP-RECORD-TYPE.
 13004     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13005     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13006
 13007
 13008* EXEC CICS REWRITE
 13009*         DATASET    (FILE-ID-ELCERT)
 13010*         FROM       (CERTIFICATE-MASTER)
 13011*         END-EXEC.
 13012     MOVE LENGTH OF
 13013      CERTIFICATE-MASTER
 13014       TO DFHEIV11
 13015*    MOVE '&& L                  %   #00012048' TO DFHEIV0
 13016     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13017     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13018     MOVE X'2020233030303132303438' TO DFHEIV0(25:11)
 13019     CALL 'kxdfhei1' USING DFHEIV0,
 13020           FILE-ID-ELCERT,
 13021           CERTIFICATE-MASTER,
 13022           DFHEIV11,
 13023           DFHEIV99
 13024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13025
 13026
 13027     PERFORM 8400-LOG-JOURNAL-RECORD.
 13028
 13029 1420-CONTINUE-DELETE.
 13030     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13031     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13032
 13033     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13034     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13035
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 238
* EL6311.cbl
 13036     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13037
 13038 1450-DELETE-PB-RECORD.
 13039     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13040     MOVE 'D'                      TO JP-RECORD-TYPE
 13041     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13042
 13043
 13044* EXEC CICS DELETE
 13045*        DATASET    (FILE-ID-ERPNDB)
 13046*    END-EXEC.
 13047*    MOVE '&(                    &   #00012069' TO DFHEIV0
 13048     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13049     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13050     MOVE X'2020233030303132303639' TO DFHEIV0(25:11)
 13051     CALL 'kxdfhei1' USING DFHEIV0,
 13052           FILE-ID-ERPNDB,
 13053           DFHEIV99,
 13054           DFHEIV99,
 13055           DFHEIV99,
 13056           DFHEIV99
 13057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13058
 13059
 13060     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13061
 13062     PERFORM 8400-LOG-JOURNAL-RECORD.
 13063
 13064     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13065     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13066     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13067
 13068
 13069* EXEC CICS HANDLE CONDITION
 13070*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13071*    END-EXEC.
 13072*    MOVE '"$I                   ! 1 #00012081' TO DFHEIV0
 13073     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13075     MOVE X'3120233030303132303831' TO DFHEIV0(25:11)
 13076     CALL 'kxdfhei1' USING DFHEIV0
 13077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13078
 13079
 13080
 13081* EXEC CICS READ
 13082*        SET     (ADDRESS OF PENDING-BUSINESS)
 13083*        DATASET (FILE-ID-ERPNDB)
 13084*        RIDFLD  (ERPNDB-KEY)
 13085*        UPDATE
 13086*    END-EXEC.
 13087*    MOVE '&"S        EU         (   #00012085' TO DFHEIV0
 13088     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13089     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13090     MOVE X'2020233030303132303835' TO DFHEIV0(25:11)
 13091     CALL 'kxdfhei1' USING DFHEIV0,
 13092           FILE-ID-ERPNDB,
 13093           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 239
* EL6311.cbl
 13094           DFHEIV99,
 13095           ERPNDB-KEY,
 13096           DFHEIV99,
 13097           DFHEIV99,
 13098           DFHEIV99
 13099     SET ADDRESS OF PENDING-BUSINESS TO
 13100         DFHEIV20
 13101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13102
 13103
 13104     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13105
 13106     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13107
 13108     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13109        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13110        MOVE 'D'                   TO JP-RECORD-TYPE
 13111        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13112
 13113* EXEC CICS DELETE
 13114*            DATASET    (FILE-ID-ERPNDB)
 13115*       END-EXEC
 13116*    MOVE '&(                    &   #00012100' TO DFHEIV0
 13117     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13119     MOVE X'2020233030303132313030' TO DFHEIV0(25:11)
 13120     CALL 'kxdfhei1' USING DFHEIV0,
 13121           FILE-ID-ERPNDB,
 13122           DFHEIV99,
 13123           DFHEIV99,
 13124           DFHEIV99,
 13125           DFHEIV99
 13126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13127        PERFORM 8400-LOG-JOURNAL-RECORD
 13128     ELSE
 13129        MOVE 'B'                 TO JP-RECORD-TYPE
 13130        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13131        PERFORM 8400-LOG-JOURNAL-RECORD
 13132        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13133        MOVE 'C'                 TO JP-RECORD-TYPE
 13134        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13135
 13136* EXEC CICS REWRITE
 13137*            DATASET    (FILE-ID-ERPNDB)
 13138*            FROM       (PENDING-BUSINESS)
 13139*       END-EXEC
 13140     MOVE LENGTH OF
 13141      PENDING-BUSINESS
 13142       TO DFHEIV11
 13143*    MOVE '&& L                  %   #00012111' TO DFHEIV0
 13144     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13145     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13146     MOVE X'2020233030303132313131' TO DFHEIV0(25:11)
 13147     CALL 'kxdfhei1' USING DFHEIV0,
 13148           FILE-ID-ERPNDB,
 13149           PENDING-BUSINESS,
 13150           DFHEIV11,
 13151           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 240
* EL6311.cbl
 13152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13153        PERFORM 8400-LOG-JOURNAL-RECORD.
 13154
 13155******************************************************************
 13156*                                                                *
 13157*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13158*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13159*                                                                *
 13160******************************************************************
 13161
 13162     IF NOT PI-AR-PROCESSING
 13163        GO TO 1475-DELETE-FINISHED.
 13164
 13165     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13166        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13167        NEXT SENTENCE
 13168     ELSE
 13169        GO TO 1475-DELETE-FINISHED.
 13170
 13171
 13172* EXEC CICS HANDLE CONDITION
 13173*         NOTFND    (1475-DELETE-FINISHED)
 13174*         END-EXEC.
 13175*    MOVE '"$I                   ! 2 #00012133' TO DFHEIV0
 13176     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13178     MOVE X'3220233030303132313333' TO DFHEIV0(25:11)
 13179     CALL 'kxdfhei1' USING DFHEIV0
 13180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13181
 13182
 13183     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13184     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13185
 13186
 13187* EXEC CICS READ
 13188*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13189*        DATASET (FILE-ID-ERRQST)
 13190*        RIDFLD  (ERRQST-KEY)
 13191*        UPDATE
 13192*    END-EXEC.
 13193*    MOVE '&"S        EU         (   #00012140' TO DFHEIV0
 13194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13195     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13196     MOVE X'2020233030303132313430' TO DFHEIV0(25:11)
 13197     CALL 'kxdfhei1' USING DFHEIV0,
 13198           FILE-ID-ERRQST,
 13199           DFHEIV20,
 13200           DFHEIV99,
 13201           ERRQST-KEY,
 13202           DFHEIV99,
 13203           DFHEIV99,
 13204           DFHEIV99
 13205     SET ADDRESS OF AR-REQUEST-RECORD TO
 13206         DFHEIV20
 13207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13208
 13209
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 241
* EL6311.cbl
 13210     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13211
 13212     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13213
 13214     MOVE 'D'                      TO JP-RECORD-TYPE.
 13215     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13216
 13217
 13218* EXEC CICS DELETE
 13219*         DATASET    (FILE-ID-ERRQST)
 13220*    END-EXEC.
 13221*    MOVE '&(                    &   #00012154' TO DFHEIV0
 13222     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13224     MOVE X'2020233030303132313534' TO DFHEIV0(25:11)
 13225     CALL 'kxdfhei1' USING DFHEIV0,
 13226           FILE-ID-ERRQST,
 13227           DFHEIV99,
 13228           DFHEIV99,
 13229           DFHEIV99,
 13230           DFHEIV99
 13231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13232
 13233
 13234     PERFORM 8400-LOG-JOURNAL-RECORD.
 13235
 13236 1475-DELETE-FINISHED.
 13237     MOVE ZEROS                  TO EMI-ERROR.
 13238     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13239     MOVE LOW-VALUES             TO EL631BI.
 13240     MOVE -1                     TO BMAINTL.
 13241     GO TO 8100-SEND-INITIAL-MAP.
 13242
 13243 1480-BATCH-HDR-NOT-FOUND.
 13244     MOVE -1                     TO BMAINTL.
 13245     MOVE ER-7450                TO EMI-ERROR.
 13246     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13247     GO TO 8200-SEND-DATAONLY.
 13248
 13249 1490-RECORD-NOT-FOUND.
 13250     MOVE -1                     TO BMAINTL.
 13251     MOVE ER-7451                TO EMI-ERROR.
 13252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13253     GO TO 8200-SEND-DATAONLY.
 13254
 13255******************************************************************
 13256*            O V E R   C H A R G E   P R O C E S S I N G         *
 13257******************************************************************
 13258 1500-UPDATE-ERNOTE.
 13259     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13260     MOVE 'A'                    TO WS-NOTE-SW
 13261     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13262     .
 13263 1500-EXIT.
 13264     EXIT.
 13265 1510-ADD-ERNOTE-REC.
 13266
 13267* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 242
* EL6311.cbl
 13268*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13269*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13270*        INITIMG (GETMAIN-SPACE)
 13271*    END-EXEC
 13272*    MOVE ',"IL                  $   #00012190' TO DFHEIV0
 13273     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13274     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13275     MOVE X'2020233030303132313930' TO DFHEIV0(25:11)
 13276     CALL 'kxdfhei1' USING DFHEIV0,
 13277           DFHEIV20,
 13278           ERNOTE-RECORD-LENGTH,
 13279           GETMAIN-SPACE
 13280     SET ADDRESS OF CERTIFICATE-NOTE TO
 13281         DFHEIV20
 13282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13283     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13284                                 TO ERNOTE-KEY
 13285
 13286* EXEC CICS READ
 13287*       DATASET    (FILE-ID-ERNOTE)
 13288*       RIDFLD     (ERNOTE-KEY)
 13289*       INTO       (CERTIFICATE-NOTE)
 13290*       RESP       (WS-RESPONSE)
 13291*       UPDATE
 13292*    END-EXEC
 13293     MOVE LENGTH OF
 13294      CERTIFICATE-NOTE
 13295       TO DFHEIV11
 13296*    MOVE '&"IL       EU         (  N#00012197' TO DFHEIV0
 13297     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13298     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13299     MOVE X'204E233030303132313937' TO DFHEIV0(25:11)
 13300     CALL 'kxdfhei1' USING DFHEIV0,
 13301           FILE-ID-ERNOTE,
 13302           CERTIFICATE-NOTE,
 13303           DFHEIV11,
 13304           ERNOTE-KEY,
 13305           DFHEIV99,
 13306           DFHEIV99,
 13307           DFHEIV99
 13308     MOVE EIBRESP  TO WS-RESPONSE
 13309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13310     IF RESP-NORMAL
 13311        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13312           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13313        END-IF
 13314        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13315           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13316        END-IF
 13317        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13318           (N1 > +10)
 13319           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13320           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13321        END-PERFORM
 13322        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13323          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13324
 13325* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 243
* EL6311.cbl
 13326*            DATASET    (FILE-ID-ERNOTE)
 13327*          END-EXEC
 13328*    MOVE '&*                    #   #00012218' TO DFHEIV0
 13329     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13330     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13331     MOVE X'2020233030303132323138' TO DFHEIV0(25:11)
 13332     CALL 'kxdfhei1' USING DFHEIV0,
 13333           FILE-ID-ERNOTE,
 13334           DFHEIV99
 13335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13336        ELSE
 13337          PERFORM VARYING N1 FROM +1 BY +1
 13338           UNTIL (N1 > +10)
 13339           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13340          END-PERFORM
 13341          IF (N1 < +11)
 13342            IF N1 >= CN-BILLING-START-LINE-NO AND
 13343              N1 <= CN-BILLING-END-LINE-NO
 13344              IF PI-COMPANY-ID = 'DCC'
 13345                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13346              ELSE
 13347                 MOVE WS-VA-NO-COMM-MESS
 13348                                    TO CN-LINE (N1)
 13349              END-IF
 13350            ELSE
 13351              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13352               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13353                IF PI-COMPANY-ID = 'DCC'
 13354                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13355                ELSE
 13356                  MOVE WS-VA-NO-COMM-MESS
 13357                                    TO CN-LINE (N1)
 13358                END-IF
 13359                MOVE N1             TO CN-BILLING-END-LINE-NO
 13360              ELSE
 13361                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13362                  IF PI-COMPANY-ID = 'DCC'
 13363                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13364                  ELSE
 13365                     MOVE WS-VA-NO-COMM-MESS
 13366                                    TO CN-LINE (N1)
 13367                  END-IF
 13368                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13369                                      CN-BILLING-START-LINE-NO
 13370                ELSE
 13371                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13372                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13373                     IF PI-COMPANY-ID = 'DCC'
 13374                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13375                     ELSE
 13376                       MOVE WS-VA-NO-COMM-MESS
 13377                                    TO CN-LINE (N1)
 13378                     END-IF
 13379                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13380                  ELSE
 13381                     PERFORM 1700-SQUEEZE-IT-IN
 13382                                 THRU 1700-EXIT
 13383                  END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 244
* EL6311.cbl
 13384                END-IF
 13385              END-IF
 13386            END-IF
 13387            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13388            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13389            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13390
 13391* EXEC CICS REWRITE
 13392*              DATASET    (FILE-ID-ERNOTE)
 13393*              FROM       (CERTIFICATE-NOTE)
 13394*              RESP       (WS-RESPONSE)
 13395*           END-EXEC
 13396     MOVE LENGTH OF
 13397      CERTIFICATE-NOTE
 13398       TO DFHEIV11
 13399*    MOVE '&& L                  %  N#00012275' TO DFHEIV0
 13400     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13401     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13402     MOVE X'204E233030303132323735' TO DFHEIV0(25:11)
 13403     CALL 'kxdfhei1' USING DFHEIV0,
 13404           FILE-ID-ERNOTE,
 13405           CERTIFICATE-NOTE,
 13406           DFHEIV11,
 13407           DFHEIV99
 13408     MOVE EIBRESP  TO WS-RESPONSE
 13409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13410          END-IF
 13411        END-IF
 13412     ELSE
 13413        MOVE SPACES              TO CERTIFICATE-NOTE
 13414        MOVE 'CN'                TO CN-RECORD-ID
 13415        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13416                                 TO CN-CONTROL-PRIMARY
 13417                                    ERNOTE-KEY
 13418        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13419                                    CN-BILLING-END-LINE-NO
 13420        IF PI-COMPANY-ID = 'DCC'
 13421           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13422        ELSE
 13423           MOVE WS-VA-NO-COMM-MESS
 13424                                 TO CN-LINE (1)
 13425        END-IF
 13426        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13427        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13428        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13429
 13430* EXEC CICS WRITE
 13431*          DATASET    (FILE-ID-ERNOTE)
 13432*          FROM       (CERTIFICATE-NOTE)
 13433*          RIDFLD     (ERNOTE-KEY)
 13434*          RESP       (WS-RESPONSE)
 13435*       END-EXEC
 13436     MOVE LENGTH OF
 13437      CERTIFICATE-NOTE
 13438       TO DFHEIV11
 13439*    MOVE '&$ L                  ''  N#00012299' TO DFHEIV0
 13440     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13441     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 245
* EL6311.cbl
 13442     MOVE X'204E233030303132323939' TO DFHEIV0(25:11)
 13443     CALL 'kxdfhei1' USING DFHEIV0,
 13444           FILE-ID-ERNOTE,
 13445           CERTIFICATE-NOTE,
 13446           DFHEIV11,
 13447           ERNOTE-KEY,
 13448           DFHEIV99,
 13449           DFHEIV99
 13450     MOVE EIBRESP  TO WS-RESPONSE
 13451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13452     END-IF
 13453     .
 13454 1510-EXIT.
 13455     EXIT.
 13456 1520-UPDATE-ELCERT.
 13457     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13458                                 TO ELCERT-KEY
 13459
 13460* EXEC CICS READ
 13461*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13462*        DATASET (FILE-ID-ELCERT)
 13463*        RIDFLD  (ELCERT-KEY)
 13464*        UPDATE
 13465*        RESP    (WS-RESPONSE)
 13466*    END-EXEC
 13467*    MOVE '&"S        EU         (  N#00012312' TO DFHEIV0
 13468     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13469     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13470     MOVE X'204E233030303132333132' TO DFHEIV0(25:11)
 13471     CALL 'kxdfhei1' USING DFHEIV0,
 13472           FILE-ID-ELCERT,
 13473           DFHEIV20,
 13474           DFHEIV99,
 13475           ELCERT-KEY,
 13476           DFHEIV99,
 13477           DFHEIV99,
 13478           DFHEIV99
 13479     SET ADDRESS OF CERTIFICATE-MASTER TO
 13480         DFHEIV20
 13481     MOVE EIBRESP  TO WS-RESPONSE
 13482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13483     IF RESP-NORMAL
 13484        IF WS-NOTE-SW = 'A'
 13485           IF CM-NOTE-SW = ' '
 13486              MOVE '2'             TO CM-NOTE-SW
 13487           ELSE
 13488             IF CM-NOTE-SW = '1'
 13489                MOVE '3'           TO CM-NOTE-SW
 13490             ELSE
 13491               IF CM-NOTE-SW = '4'
 13492                  MOVE '6'         TO CM-NOTE-SW
 13493               ELSE
 13494                 IF CM-NOTE-SW = '5'
 13495                    MOVE '7'       TO CM-NOTE-SW
 13496                 END-IF
 13497               END-IF
 13498             END-IF
 13499           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 246
* EL6311.cbl
 13500        ELSE
 13501           IF CM-NOTE-SW = '2'
 13502              MOVE ' '             TO CM-NOTE-SW
 13503           ELSE
 13504             IF CM-NOTE-SW = '3'
 13505                MOVE '1'           TO CM-NOTE-SW
 13506             ELSE
 13507               IF CM-NOTE-SW = '6'
 13508                  MOVE '4'         TO CM-NOTE-SW
 13509               ELSE
 13510                 IF CM-NOTE-SW = '7'
 13511                    MOVE '5'       TO CM-NOTE-SW
 13512                 END-IF
 13513               END-IF
 13514             END-IF
 13515           END-IF
 13516        END-IF
 13517
 13518* EXEC CICS REWRITE
 13519*          DATASET    (FILE-ID-ELCERT)
 13520*          FROM       (CERTIFICATE-MASTER)
 13521*          RESP       (WS-RESPONSE)
 13522*       END-EXEC
 13523     MOVE LENGTH OF
 13524      CERTIFICATE-MASTER
 13525       TO DFHEIV11
 13526*    MOVE '&& L                  %  N#00012353' TO DFHEIV0
 13527     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13528     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13529     MOVE X'204E233030303132333533' TO DFHEIV0(25:11)
 13530     CALL 'kxdfhei1' USING DFHEIV0,
 13531           FILE-ID-ELCERT,
 13532           CERTIFICATE-MASTER,
 13533           DFHEIV11,
 13534           DFHEIV99
 13535     MOVE EIBRESP  TO WS-RESPONSE
 13536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13537        IF RESP-NORMAL
 13538           CONTINUE
 13539        ELSE
 13540           MOVE WS-RESPONSE TO EMI-ERROR
 13541           PERFORM 9900-ERROR-FORMAT
 13542                                 THRU 9900-EXIT
 13543           GO TO 8200-SEND-DATAONLY
 13544        END-IF
 13545     ELSE
 13546        MOVE -1                  TO BMAINTL
 13547        MOVE 0249                TO EMI-ERROR
 13548        PERFORM 9900-ERROR-FORMAT
 13549                                 THRU 9900-EXIT
 13550        GO TO 8200-SEND-DATAONLY
 13551     END-IF
 13552     .
 13553 1520-EXIT.
 13554     EXIT.
 13555 1600-UPDATE-ERPYAJ.
 13556     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13557                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 247
* EL6311.cbl
 13558     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13559                                 THRU 1620-EXIT
 13560     .
 13561 1600-EXIT.
 13562     EXIT.
 13563 1610-ADD-ERPYAJ-BANK-REC.
 13564
 13565* EXEC CICS GETMAIN
 13566*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13567*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13568*        INITIMG (GETMAIN-SPACE)
 13569*    END-EXEC
 13570*    MOVE ',"IL                  $   #00012385' TO DFHEIV0
 13571     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13573     MOVE X'2020233030303132333835' TO DFHEIV0(25:11)
 13574     CALL 'kxdfhei1' USING DFHEIV0,
 13575           DFHEIV20,
 13576           ERPYAJ-RECORD-LENGTH,
 13577           GETMAIN-SPACE
 13578     SET ADDRESS OF PENDING-PAY-ADJ TO
 13579         DFHEIV20
 13580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13581     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13582     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13583     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13584     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13585     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13586     MOVE +10                    TO ERPYAJ-SEQ-NO
 13587     MOVE 'R'                    TO ERPYAJ-TYPE
 13588     IF REVERSAL
 13589        MOVE 'C'                 TO ERPYAJ-TYPE
 13590     END-IF
 13591     MOVE SPACES                 TO PENDING-PAY-ADJ
 13592     MOVE 'PY'                   TO PY-RECORD-ID
 13593     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13594     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13595     IF REVERSAL
 13596        MOVE PB-I-DCC-OVER-CHG-AMT
 13597                                 TO PY-ENTRY-AMT
 13598     END-IF
 13599     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13600                                    PY-INPUT-DT
 13601*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13602*                                   PY-INPUT-DT
 13603     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13604     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13605     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13606     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13607     IF PB-CARRIER = '2'
 13608        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13609     ELSE
 13610        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13611     END-IF
 13612     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13613                                    PY-BILLED-DATE
 13614                                    PY-AR-DATE
 13615                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 248
* EL6311.cbl
 13616                                    PY-CHECK-WRITTEN-DT
 13617     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13618                                    PY-CHECK-QUE-SEQUENCE
 13619     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13620     PERFORM WITH TEST AFTER
 13621        UNTIL (NOT RESP-DUPKEY)
 13622           AND (NOT RESP-DUPREC)
 13623
 13624* EXEC CICS WRITE
 13625*          DATASET    (FILE-ID-ERPYAJ)
 13626*          FROM       (PENDING-PAY-ADJ)
 13627*          RIDFLD     (ERPYAJ-KEY)
 13628*          RESP       (WS-RESPONSE)
 13629*       END-EXEC
 13630     MOVE LENGTH OF
 13631      PENDING-PAY-ADJ
 13632       TO DFHEIV11
 13633*    MOVE '&$ L                  ''  N#00012432' TO DFHEIV0
 13634     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13635     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13636     MOVE X'204E233030303132343332' TO DFHEIV0(25:11)
 13637     CALL 'kxdfhei1' USING DFHEIV0,
 13638           FILE-ID-ERPYAJ,
 13639           PENDING-PAY-ADJ,
 13640           DFHEIV11,
 13641           ERPYAJ-KEY,
 13642           DFHEIV99,
 13643           DFHEIV99
 13644     MOVE EIBRESP  TO WS-RESPONSE
 13645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13646        IF RESP-DUPKEY OR RESP-DUPREC
 13647           ADD +1                TO ERPYAJ-SEQ-NO
 13648           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13649        END-IF
 13650     END-PERFORM
 13651     .
 13652 1610-EXIT.
 13653     EXIT.
 13654 1620-ADD-ERPYAJ-DLR-REC.
 13655     MOVE 'C'                    TO ERPYAJ-TYPE
 13656     IF REVERSAL
 13657        MOVE 'R'                 TO ERPYAJ-TYPE
 13658     END-IF
 13659     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13660                                    ERPYAJ-ACCOUNT
 13661     ADD +1                      TO ERPYAJ-SEQ-NO
 13662     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13663     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13664     IF PB-CARRIER = '2'
 13665        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13666     ELSE
 13667        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13668     END-IF
 13669     PERFORM WITH TEST AFTER
 13670        UNTIL (NOT RESP-DUPKEY)
 13671           AND (NOT RESP-DUPREC)
 13672
 13673* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 249
* EL6311.cbl
 13674*          DATASET    (FILE-ID-ERPYAJ)
 13675*          FROM       (PENDING-PAY-ADJ)
 13676*          RIDFLD     (ERPYAJ-KEY)
 13677*          RESP       (WS-RESPONSE)
 13678*       END-EXEC
 13679     MOVE LENGTH OF
 13680      PENDING-PAY-ADJ
 13681       TO DFHEIV11
 13682*    MOVE '&$ L                  ''  N#00012464' TO DFHEIV0
 13683     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13684     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13685     MOVE X'204E233030303132343634' TO DFHEIV0(25:11)
 13686     CALL 'kxdfhei1' USING DFHEIV0,
 13687           FILE-ID-ERPYAJ,
 13688           PENDING-PAY-ADJ,
 13689           DFHEIV11,
 13690           ERPYAJ-KEY,
 13691           DFHEIV99,
 13692           DFHEIV99
 13693     MOVE EIBRESP  TO WS-RESPONSE
 13694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13695        IF RESP-DUPKEY OR RESP-DUPREC
 13696           ADD +1                TO ERPYAJ-SEQ-NO
 13697           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13698        END-IF
 13699     END-PERFORM
 13700     .
 13701 1620-EXIT.
 13702     EXIT.
 13703 1700-SQUEEZE-IT-IN.
 13704     IF (N1 > CN-BILLING-END-LINE-NO)
 13705        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13706           N1 = +1
 13707           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13708           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13709              IF PI-COMPANY-ID = 'DCC'
 13710                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13711              ELSE
 13712                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13713              END-IF
 13714              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13715              MOVE +2 TO N1
 13716           END-IF
 13717        END-PERFORM
 13718     ELSE
 13719        IF (N1 < CN-BILLING-START-LINE-NO)
 13720           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13721              N1 = +10
 13722              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13723              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13724                 IF PI-COMPANY-ID = 'DCC'
 13725                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13726                 ELSE
 13727                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13728                 END-IF
 13729                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13730                 MOVE +9 TO N1
 13731              END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 250
* EL6311.cbl
 13732           END-PERFORM
 13733        END-IF
 13734     END-IF
 13735     .
 13736 1700-EXIT.
 13737     EXIT.
 13738 1800-REMOVE-CERT-NOTES.
 13739     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13740                                 TO ERNOTE-KEY
 13741
 13742* EXEC CICS READ
 13743*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13744*       DATASET    (FILE-ID-ERNOTE)
 13745*       RIDFLD     (ERNOTE-KEY)
 13746*       RESP       (WS-RESPONSE)
 13747*       UPDATE
 13748*    END-EXEC
 13749*    MOVE '&"S        EU         (  N#00012516' TO DFHEIV0
 13750     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13751     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13752     MOVE X'204E233030303132353136' TO DFHEIV0(25:11)
 13753     CALL 'kxdfhei1' USING DFHEIV0,
 13754           FILE-ID-ERNOTE,
 13755           DFHEIV20,
 13756           DFHEIV99,
 13757           ERNOTE-KEY,
 13758           DFHEIV99,
 13759           DFHEIV99,
 13760           DFHEIV99
 13761     SET ADDRESS OF CERTIFICATE-NOTE TO
 13762         DFHEIV20
 13763     MOVE EIBRESP  TO WS-RESPONSE
 13764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13765     IF RESP-NORMAL
 13766        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13767           (N1 > +10)
 13768           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13769           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13770        END-PERFORM
 13771        IF N1 < +11
 13772           MOVE SPACES              TO CN-LINE (N1)
 13773           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13774              N1 <= CN-BILLING-END-LINE-NO
 13775              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13776              IF CN-BILLING-END-LINE-NO <
 13777                               CN-BILLING-START-LINE-NO
 13778                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13779                                     CN-BILLING-START-LINE-NO
 13780              END-IF
 13781              PERFORM 1820-SQUEEZE-ERNOTE
 13782                                  THRU 1820-EXIT
 13783           END-IF
 13784           IF CN-LINES = SPACES
 13785
 13786* EXEC CICS DELETE
 13787*                DATASET    (FILE-ID-ERNOTE)
 13788*                RESP       (WS-RESPONSE)
 13789*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 251
* EL6311.cbl
 13790*    MOVE '&(                    &  N#00012543' TO DFHEIV0
 13791     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13792     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13793     MOVE X'204E233030303132353433' TO DFHEIV0(25:11)
 13794     CALL 'kxdfhei1' USING DFHEIV0,
 13795           FILE-ID-ERNOTE,
 13796           DFHEIV99,
 13797           DFHEIV99,
 13798           DFHEIV99,
 13799           DFHEIV99
 13800     MOVE EIBRESP  TO WS-RESPONSE
 13801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13802              IF RESP-NORMAL
 13803                 MOVE 'D'        TO WS-NOTE-SW
 13804                 PERFORM 1520-UPDATE-ELCERT
 13805                                 THRU 1520-EXIT
 13806              END-IF
 13807           ELSE
 13808
 13809* EXEC CICS REWRITE
 13810*                DATASET    (FILE-ID-ERNOTE)
 13811*                FROM       (CERTIFICATE-NOTE)
 13812*                RESP       (WS-RESPONSE)
 13813*             END-EXEC
 13814     MOVE LENGTH OF
 13815      CERTIFICATE-NOTE
 13816       TO DFHEIV11
 13817*    MOVE '&& L                  %  N#00012553' TO DFHEIV0
 13818     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13819     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13820     MOVE X'204E233030303132353533' TO DFHEIV0(25:11)
 13821     CALL 'kxdfhei1' USING DFHEIV0,
 13822           FILE-ID-ERNOTE,
 13823           CERTIFICATE-NOTE,
 13824           DFHEIV11,
 13825           DFHEIV99
 13826     MOVE EIBRESP  TO WS-RESPONSE
 13827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13828           END-IF
 13829        END-IF
 13830     END-IF
 13831     .
 13832 1800-EXIT.
 13833     EXIT.
 13834 1820-SQUEEZE-ERNOTE.
 13835     MOVE CN-BILLING-START-LINE-NO TO N2
 13836     IF N2 = 0
 13837         MOVE +1                 TO N2
 13838     END-IF
 13839     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13840        (N1 > +9)
 13841        IF CN-LINE (N1) = SPACES
 13842           MOVE CN-LINE (N1 + +1)
 13843                                 TO CN-LINE (N1)
 13844           MOVE SPACES           TO CN-LINE (N1 + +1)
 13845        END-IF
 13846     END-PERFORM
 13847     .
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 252
* EL6311.cbl
 13848 1820-EXIT.
 13849     EXIT.
 13850 1900-DELETE-ERPYAJ.
 13851     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13852     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13853     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13854     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13855     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13856     MOVE +10                    TO ERPYAJ-SEQ-NO
 13857     MOVE 'R'                    TO ERPYAJ-TYPE
 13858     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13859
 13860* EXEC CICS STARTBR
 13861*       DATASET    (FILE-ID-ERPYAJ)
 13862*       RIDFLD     (ERPYAJ-KEY)
 13863*       RESP       (WS-RESPONSE)
 13864*    END-EXEC
 13865     MOVE 0
 13866       TO DFHEIV11
 13867*    MOVE '&,         G          &  N#00012589' TO DFHEIV0
 13868     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13869     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13870     MOVE X'204E233030303132353839' TO DFHEIV0(25:11)
 13871     CALL 'kxdfhei1' USING DFHEIV0,
 13872           FILE-ID-ERPYAJ,
 13873           ERPYAJ-KEY,
 13874           DFHEIV99,
 13875           DFHEIV11,
 13876           DFHEIV99
 13877     MOVE EIBRESP  TO WS-RESPONSE
 13878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13879     IF RESP-NORMAL
 13880        CONTINUE
 13881     ELSE
 13882        GO TO 1900-GET-DEALER
 13883     END-IF
 13884     .
 13885 1900-READNEXT-ERPYAJ-B.
 13886*  GET THE BANK ERPYAJ RECORD
 13887
 13888* EXEC CICS READNEXT
 13889*       DATASET    (FILE-ID-ERPYAJ)
 13890*       RIDFLD     (ERPYAJ-KEY)
 13891*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13892*       RESP       (WS-RESPONSE)
 13893*    END-EXEC
 13894     MOVE 0
 13895       TO DFHEIV11
 13896*    MOVE '&.S                   )  N#00012602' TO DFHEIV0
 13897     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13898     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13899     MOVE X'204E233030303132363032' TO DFHEIV0(25:11)
 13900     CALL 'kxdfhei1' USING DFHEIV0,
 13901           FILE-ID-ERPYAJ,
 13902           DFHEIV20,
 13903           DFHEIV99,
 13904           ERPYAJ-KEY,
 13905           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 253
* EL6311.cbl
 13906           DFHEIV11,
 13907           DFHEIV99,
 13908           DFHEIV99
 13909     SET ADDRESS OF PENDING-PAY-ADJ TO
 13910         DFHEIV20
 13911     MOVE EIBRESP  TO WS-RESPONSE
 13912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13913     IF RESP-NORMAL
 13914        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13915           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13916              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13917                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13918
 13919* EXEC CICS READ
 13920*                   DATASET    (FILE-ID-ERPYAJ)
 13921*                   RIDFLD     (ERPYAJ-KEY)
 13922*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13923*                   RESP       (WS-RESPONSE)
 13924*                   UPDATE
 13925*                END-EXEC
 13926*    MOVE '&"S        EU         (  N#00012613' TO DFHEIV0
 13927     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13928     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13929     MOVE X'204E233030303132363133' TO DFHEIV0(25:11)
 13930     CALL 'kxdfhei1' USING DFHEIV0,
 13931           FILE-ID-ERPYAJ,
 13932           DFHEIV20,
 13933           DFHEIV99,
 13934           ERPYAJ-KEY,
 13935           DFHEIV99,
 13936           DFHEIV99,
 13937           DFHEIV99
 13938     SET ADDRESS OF PENDING-PAY-ADJ TO
 13939         DFHEIV20
 13940     MOVE EIBRESP  TO WS-RESPONSE
 13941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13942                 IF RESP-NORMAL
 13943
 13944* EXEC CICS DELETE
 13945*                      DATASET   (FILE-ID-ERPYAJ)
 13946*                      RESP      (WS-RESPONSE)
 13947*                   END-EXEC
 13948*    MOVE '&(                    &  N#00012621' TO DFHEIV0
 13949     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13950     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13951     MOVE X'204E233030303132363231' TO DFHEIV0(25:11)
 13952     CALL 'kxdfhei1' USING DFHEIV0,
 13953           FILE-ID-ERPYAJ,
 13954           DFHEIV99,
 13955           DFHEIV99,
 13956           DFHEIV99,
 13957           DFHEIV99
 13958     MOVE EIBRESP  TO WS-RESPONSE
 13959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13960                 END-IF
 13961              ELSE
 13962                 SET REVERSAL    TO TRUE
 13963                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 254
* EL6311.cbl
 13964                                 THRU 1600-EXIT
 13965                 GO TO 1900-EXIT
 13966              END-IF
 13967           ELSE
 13968              GO TO 1900-READNEXT-ERPYAJ-B
 13969           END-IF
 13970        END-IF
 13971
 13972* EXEC CICS ENDBR
 13973*          DATASET   (FILE-ID-ERPYAJ)
 13974*       END-EXEC
 13975     MOVE 0
 13976       TO DFHEIV11
 13977*    MOVE '&2                    $   #00012636' TO DFHEIV0
 13978     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13979     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13980     MOVE X'2020233030303132363336' TO DFHEIV0(25:11)
 13981     CALL 'kxdfhei1' USING DFHEIV0,
 13982           FILE-ID-ERPYAJ,
 13983           DFHEIV11,
 13984           DFHEIV99
 13985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13986     END-IF
 13987     .
 13988 1900-GET-DEALER.
 13989     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13990     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13991     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13992     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13993     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13994     MOVE +10                    TO ERPYAJ-SEQ-NO
 13995     MOVE 'C'                    TO ERPYAJ-TYPE
 13996     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13997
 13998* EXEC CICS STARTBR
 13999*       DATASET    (FILE-ID-ERPYAJ)
 14000*       RIDFLD     (ERPYAJ-KEY)
 14001*       RESP       (WS-RESPONSE)
 14002*    END-EXEC
 14003     MOVE 0
 14004       TO DFHEIV11
 14005*    MOVE '&,         G          &  N#00012650' TO DFHEIV0
 14006     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14007     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14008     MOVE X'204E233030303132363530' TO DFHEIV0(25:11)
 14009     CALL 'kxdfhei1' USING DFHEIV0,
 14010           FILE-ID-ERPYAJ,
 14011           ERPYAJ-KEY,
 14012           DFHEIV99,
 14013           DFHEIV11,
 14014           DFHEIV99
 14015     MOVE EIBRESP  TO WS-RESPONSE
 14016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14017     IF RESP-NORMAL
 14018        CONTINUE
 14019     ELSE
 14020        GO TO 1900-EXIT
 14021     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 255
* EL6311.cbl
 14022     .
 14023 1900-READNEXT-ERPYAJ-D.
 14024*  GET THE DEALER ERPYAJ RECORD
 14025
 14026* EXEC CICS READNEXT
 14027*       DATASET    (FILE-ID-ERPYAJ)
 14028*       RIDFLD     (ERPYAJ-KEY)
 14029*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14030*       RESP       (WS-RESPONSE)
 14031*    END-EXEC
 14032     MOVE 0
 14033       TO DFHEIV11
 14034*    MOVE '&.S                   )  N#00012663' TO DFHEIV0
 14035     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14036     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14037     MOVE X'204E233030303132363633' TO DFHEIV0(25:11)
 14038     CALL 'kxdfhei1' USING DFHEIV0,
 14039           FILE-ID-ERPYAJ,
 14040           DFHEIV20,
 14041           DFHEIV99,
 14042           ERPYAJ-KEY,
 14043           DFHEIV99,
 14044           DFHEIV11,
 14045           DFHEIV99,
 14046           DFHEIV99
 14047     SET ADDRESS OF PENDING-PAY-ADJ TO
 14048         DFHEIV20
 14049     MOVE EIBRESP  TO WS-RESPONSE
 14050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14051     IF RESP-NORMAL
 14052        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14053           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14054              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14055                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14056
 14057* EXEC CICS READ
 14058*                   DATASET    (FILE-ID-ERPYAJ)
 14059*                   RIDFLD     (ERPYAJ-KEY)
 14060*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14061*                   RESP       (WS-RESPONSE)
 14062*                   UPDATE
 14063*                END-EXEC
 14064*    MOVE '&"S        EU         (  N#00012674' TO DFHEIV0
 14065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14066     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14067     MOVE X'204E233030303132363734' TO DFHEIV0(25:11)
 14068     CALL 'kxdfhei1' USING DFHEIV0,
 14069           FILE-ID-ERPYAJ,
 14070           DFHEIV20,
 14071           DFHEIV99,
 14072           ERPYAJ-KEY,
 14073           DFHEIV99,
 14074           DFHEIV99,
 14075           DFHEIV99
 14076     SET ADDRESS OF PENDING-PAY-ADJ TO
 14077         DFHEIV20
 14078     MOVE EIBRESP  TO WS-RESPONSE
 14079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 256
* EL6311.cbl
 14080                 IF RESP-NORMAL
 14081
 14082* EXEC CICS DELETE
 14083*                      DATASET   (FILE-ID-ERPYAJ)
 14084*                      RESP      (WS-RESPONSE)
 14085*                   END-EXEC
 14086*    MOVE '&(                    &  N#00012682' TO DFHEIV0
 14087     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14088     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14089     MOVE X'204E233030303132363832' TO DFHEIV0(25:11)
 14090     CALL 'kxdfhei1' USING DFHEIV0,
 14091           FILE-ID-ERPYAJ,
 14092           DFHEIV99,
 14093           DFHEIV99,
 14094           DFHEIV99,
 14095           DFHEIV99
 14096     MOVE EIBRESP  TO WS-RESPONSE
 14097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14098                 END-IF
 14099              ELSE
 14100                 SET REVERSAL    TO TRUE
 14101              END-IF
 14102           ELSE
 14103              GO TO 1900-READNEXT-ERPYAJ-D
 14104           END-IF
 14105        END-IF
 14106
 14107* EXEC CICS ENDBR
 14108*          DATASET   (FILE-ID-ERPYAJ)
 14109*       END-EXEC
 14110     MOVE 0
 14111       TO DFHEIV11
 14112*    MOVE '&2                    $   #00012694' TO DFHEIV0
 14113     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14114     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14115     MOVE X'2020233030303132363934' TO DFHEIV0(25:11)
 14116     CALL 'kxdfhei1' USING DFHEIV0,
 14117           FILE-ID-ERPYAJ,
 14118           DFHEIV11,
 14119           DFHEIV99
 14120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14121     END-IF
 14122     .
 14123 1900-EXIT.
 14124     EXIT.
 14125******************************************************************
 14126*            C A N C E L   M A I N L I N E                       *
 14127******************************************************************
 14128
 14129 2000-CANCEL-MAINLINE.
 14130     IF PI-DISPLAY-ORIGINAL-BATCH
 14131        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14132           MOVE ER-0023             TO EMI-ERROR
 14133           MOVE -1                  TO CMAINTL
 14134           MOVE AL-UABON            TO CMAINTA
 14135           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14136           GO TO 8200-SEND-DATAONLY
 14137        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 257
* EL6311.cbl
 14138           NEXT SENTENCE
 14139     ELSE
 14140        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14141           MOVE ER-0023             TO EMI-ERROR
 14142           MOVE -1                  TO CMAINTL
 14143           MOVE AL-UABON            TO CMAINTA
 14144           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14145           GO TO 8200-SEND-DATAONLY.
 14146
 14147     IF CMAINTI = 'S'
 14148        GO TO 2100-SHOW-REQUEST.
 14149
 14150     IF NOT MODIFY-CAP
 14151         MOVE 'UPDATE'       TO SM-READ
 14152         PERFORM 9995-SECURITY-VIOLATION
 14153         MOVE ER-0070        TO EMI-ERROR
 14154         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14155         GO TO 8100-SEND-INITIAL-MAP.
 14156
 14157     IF CMAINTL GREATER THAN ZEROS
 14158        IF PI-PF6-FUNCTION
 14159           IF CMAINTI NOT = 'A'
 14160              MOVE AL-UABON  TO CMAINTA
 14161              MOVE -1        TO CMAINTL
 14162              MOVE ER-2260   TO EMI-ERROR
 14163              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14164              GO TO 8200-SEND-DATAONLY.
 14165
 14166     IF CCERTNOL = ZEROS
 14167       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14168         NEXT SENTENCE
 14169     ELSE
 14170         IF CCERTNOL NOT = ZEROS
 14171             MOVE AL-UANON       TO CCERTNOA
 14172         ELSE
 14173             MOVE -1             TO CCERTNOL
 14174             MOVE  1             TO SET-CURSOR-SW
 14175             MOVE ER-2218       TO EMI-ERROR
 14176             MOVE AL-UABON       TO CCERTNOA
 14177             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14178
 14179     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14180        NEXT SENTENCE
 14181     ELSE
 14182        IF CEFFDTL NOT = ZEROS
 14183           MOVE AL-UNNON         TO CEFFDTA
 14184           MOVE CEFFDTI TO DEEDIT-FIELD
 14185           PERFORM 8600-DEEDIT
 14186           MOVE 4                TO DC-OPTION-CODE
 14187           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14188           PERFORM 9700-DATE-LINK
 14189           IF NO-CONVERSION-ERROR
 14190              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14191              ELSE
 14192              MOVE -1            TO CEFFDTL
 14193              MOVE  1            TO SET-CURSOR-SW
 14194              MOVE ER-2226      TO EMI-ERROR
 14195              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 258
* EL6311.cbl
 14196              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14197          ELSE
 14198          MOVE -1                 TO CEFFDTL
 14199          MOVE  1                 TO SET-CURSOR-SW
 14200          MOVE ER-2220            TO EMI-ERROR
 14201          MOVE AL-UNBON           TO CEFFDTA
 14202          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14203
 14204     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14205
 14206     IF CCERTNOL NOT = ZEROS
 14207        MOVE CCERTNOI                TO WS-NEW-PRIME
 14208     ELSE
 14209        MOVE SPACES                  TO WS-NEW-PRIME.
 14210
 14211     IF CSUFIXL NOT = ZEROS
 14212        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14213     ELSE
 14214        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14215
 14216     IF CEFFDTL NOT = ZEROS
 14217        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14218     ELSE
 14219        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14220
 14221     IF CMAINTI = 'A' OR 'K' OR 'S'
 14222        NEXT SENTENCE
 14223     ELSE
 14224        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14225        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14226           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14227           WS-PB-RECORD-TYPE NOT = '2'
 14228           IF CMAINTI = 'C'
 14229              MOVE ER-2287          TO EMI-ERROR
 14230              MOVE -1               TO CCERTNOL
 14231              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14232              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14233              GO TO 8200-SEND-DATAONLY
 14234             ELSE
 14235              MOVE ER-2260          TO EMI-ERROR
 14236              MOVE -1               TO CCERTNOL
 14237              MOVE AL-UABON         TO CCERTNOA
 14238              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14239              GO TO 8200-SEND-DATAONLY.
 14240
 14241     IF CMAINTI = 'D'
 14242        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14243
 14244     IF CLSTNML GREATER THAN ZEROS
 14245         MOVE AL-UANON           TO CLSTNMA.
 14246
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 259
* EL6311.cbl
 14248
 14249******************************************************************
 14250*                                                                *
 14251*           E D I T   C A N C E L   C O V E R A G E S            *
 14252*                                                                *
 14253******************************************************************
 14254
 14255 2015-EDIT-COVERAGES.
 14256     IF CCANDT1L      GREATER THAN ZEROS OR
 14257        CREFND1L      GREATER THAN ZEROS OR
 14258        CCANDT2L      GREATER THAN ZEROS OR
 14259        CREFND2L      GREATER THAN ZEROS OR
 14260        CMTHD1L       GREATER THAN ZEROS OR
 14261        CMTHD2L       GREATER THAN ZEROS OR
 14262        CLIVESL       GREATER THAN ZEROS OR
 14263        CPAYEEL       GREATER THAN ZEROS OR
 14264        CFORCEL       GREATER THAN ZEROS OR
 14265        CBILCDL       GREATER THAN ZEROS OR
 14266        CCANREAL      GREATER THAN ZEROS
 14267            NEXT SENTENCE
 14268         ELSE
 14269            GO TO 2030-EDIT-COMPLETE.
 14270
 14271     IF CCANDT1L = ZEROS
 14272        AND (CMAINTI = 'C' OR 'K')
 14273        NEXT SENTENCE
 14274     ELSE
 14275        IF CCANDT1L      GREATER THAN ZEROS
 14276            MOVE AL-UNNON            TO CCANDT1A
 14277            IF CCANDT1I = SPACES
 14278               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14279            ELSE
 14280               MOVE CCANDT1I            TO DEEDIT-FIELD
 14281               PERFORM 8600-DEEDIT
 14282               IF DEEDIT-FIELD-V0   NUMERIC
 14283                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14284                  MOVE 4                TO DC-OPTION-CODE
 14285                  PERFORM 9700-DATE-LINK
 14286                  IF NO-CONVERSION-ERROR
 14287                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14288                  ELSE
 14289                      MOVE -1        TO CCANDT1L
 14290                      MOVE ER-2227   TO EMI-ERROR
 14291                      MOVE AL-UNBON  TO CCANDT1A
 14292                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14293               ELSE
 14294                  MOVE -1         TO CCANDT1L
 14295                  MOVE ER-2223    TO EMI-ERROR
 14296                  MOVE AL-UNBON   TO CCANDT1A
 14297                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14298        ELSE
 14299            IF CREFND1L GREATER THAN ZEROS
 14300               MOVE -1             TO CCANDT1L
 14301               MOVE ER-2222        TO EMI-ERROR
 14302               MOVE AL-UNBOF       TO CCANDT1A
 14303               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14304
 14305     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 260
* EL6311.cbl
 14306        AND (CMAINTI = 'C' OR 'K')
 14307         NEXT SENTENCE
 14308     ELSE
 14309         IF CREFND1L NOT = ZEROS
 14310            MOVE AL-UNNON        TO CREFND1A
 14311
 14312* EXEC CICS BIF DEEDIT
 14313*               FIELD  (CREFND1I)
 14314*               LENGTH (11)
 14315*           END-EXEC
 14316     MOVE 11
 14317       TO DFHEIV11
 14318*    MOVE '@"L                   #   #00012887' TO DFHEIV0
 14319     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14321     MOVE X'2020233030303132383837' TO DFHEIV0(25:11)
 14322     CALL 'kxdfhei1' USING DFHEIV0,
 14323           CREFND1I,
 14324           DFHEIV11
 14325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14326            MOVE CREFND1I        TO WS-CREFND1
 14327*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14328*           PERFORM 8600-DEEDIT
 14329*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14330            IF WS-CREFND1  = ZEROS
 14331               AND CMAINTI = 'A'
 14332             MOVE ER-2437        TO EMI-ERROR
 14333             MOVE -1             TO CREFND1L
 14334             MOVE AL-UNBON       TO CREFND1A
 14335             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14336
 14337     IF CCANREAL > +0
 14338        MOVE AL-UANON            TO CCANREAA
 14339        IF CCANREAI = 'R' OR ' '
 14340           CONTINUE
 14341        ELSE
 14342           MOVE ER-9841        TO EMI-ERROR
 14343           MOVE -1             TO CCANREAL
 14344           MOVE AL-UABON       TO CCANREAA
 14345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14346        END-IF
 14347     END-IF
 14348     IF CMTHD1L EQUAL +0
 14349        NEXT SENTENCE
 14350     ELSE
 14351        IF CMTHD1L NOT = +0
 14352           MOVE AL-UNNON        TO CMTHD1A
 14353           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14354                         OR '5' OR '6' OR '8' OR '9'
 14355                         OR 'R' OR ' '
 14356              NEXT SENTENCE
 14357           ELSE
 14358              MOVE ER-0582        TO EMI-ERROR
 14359              MOVE -1             TO CMTHD1L
 14360              MOVE AL-UNBON       TO CMTHD1A
 14361              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14362
 14363     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 261
* EL6311.cbl
 14364        AND (CMAINTI = 'C' OR 'K')
 14365         NEXT SENTENCE
 14366     ELSE
 14367         IF CCANDT2L  GREATER THAN ZEROS
 14368             MOVE AL-UNNON       TO CCANDT2A
 14369             IF CCANDT2I = SPACES
 14370                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14371             ELSE
 14372                MOVE CCANDT2I       TO DEEDIT-FIELD
 14373                PERFORM 8600-DEEDIT
 14374                IF DEEDIT-FIELD-V0   NUMERIC
 14375                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14376                   MOVE 4                TO DC-OPTION-CODE
 14377                   PERFORM 9700-DATE-LINK
 14378                   IF NO-CONVERSION-ERROR
 14379                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14380                   ELSE
 14381                      MOVE -1       TO CCANDT2L
 14382                      MOVE ER-2227  TO EMI-ERROR
 14383                      MOVE AL-UNBON TO CCANDT2A
 14384                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14385                ELSE
 14386                   MOVE -1         TO CCANDT2L
 14387                   MOVE ER-2223    TO EMI-ERROR
 14388                   MOVE AL-UNBON   TO CCANDT2A
 14389                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14390         ELSE
 14391            IF CREFND2L GREATER THAN ZEROS
 14392               MOVE -1             TO CCANDT2L
 14393               MOVE ER-2222        TO EMI-ERROR
 14394               MOVE AL-UNBOF       TO CCANDT2A
 14395               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14396
 14397     IF CREFND2L = ZEROS
 14398        AND (CMAINTI = 'C' OR 'K')
 14399         NEXT SENTENCE
 14400     ELSE
 14401         IF CREFND2L NOT = ZEROS
 14402            MOVE AL-UNNON        TO CREFND2A
 14403
 14404* EXEC CICS BIF DEEDIT
 14405*               FIELD  (CREFND2I)
 14406*               LENGTH (11)
 14407*           END-EXEC
 14408     MOVE 11
 14409       TO DFHEIV11
 14410*    MOVE '@"L                   #   #00012968' TO DFHEIV0
 14411     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14412     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14413     MOVE X'2020233030303132393638' TO DFHEIV0(25:11)
 14414     CALL 'kxdfhei1' USING DFHEIV0,
 14415           CREFND2I,
 14416           DFHEIV11
 14417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14418            MOVE CREFND2I        TO WS-CREFND2
 14419*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14420*           PERFORM 8600-DEEDIT
 14421*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 262
* EL6311.cbl
 14422            IF WS-CREFND2  = ZEROS
 14423               AND CMAINTI = 'A'
 14424             MOVE ER-2437        TO EMI-ERROR
 14425             MOVE -1             TO CREFND2L
 14426             MOVE AL-UNBON       TO CREFND2A
 14427             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14428
 14429     IF CMTHD2L EQUAL +0
 14430        NEXT SENTENCE
 14431     ELSE
 14432        IF CMTHD2L NOT = +0
 14433           MOVE AL-UNNON        TO CMTHD2A
 14434           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14435                         OR '5' OR '6' OR '8' OR '9'
 14436                         OR ' ' OR 'R'
 14437              NEXT SENTENCE
 14438           ELSE
 14439              MOVE ER-0582        TO EMI-ERROR
 14440              MOVE -1             TO CMTHD2L
 14441              MOVE AL-UNBON       TO CMTHD2A
 14442              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14443
 14444     IF CLIVESL GREATER THAN ZEROS
 14445         MOVE CLIVESI            TO DEEDIT-FIELD
 14446         PERFORM 8600-DEEDIT
 14447         IF DEEDIT-FIELD-V0 NUMERIC
 14448             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14449             MOVE AL-UNNON       TO CLIVESA
 14450         ELSE
 14451             MOVE -1             TO CLIVESL
 14452             MOVE AL-UNBON       TO CLIVESA
 14453             MOVE ER-2223        TO EMI-ERROR
 14454             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14455
 14456     IF CFORCEL  NOT = ZEROS
 14457         IF FORCE-CAP
 14458            MOVE AL-UANON            TO CFORCEA
 14459         ELSE
 14460            MOVE ER-2945             TO EMI-ERROR
 14461            MOVE AL-UABON            TO CFORCEA
 14462            MOVE -1                  TO CFORCEL
 14463            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14464
 14465     IF CPAYEEL GREATER THAN ZEROS
 14466        MOVE AL-UANON            TO CPAYEEA.
 14467
 14468     IF CBILCDL NOT = ZEROS
 14469        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14470                             AND 'A' AND 'B' AND 'E'
 14471           MOVE ER-2225              TO EMI-ERROR
 14472           MOVE AL-UABON             TO CBILCDA
 14473           MOVE -1                   TO CBILCDL
 14474           MOVE  1                   TO SET-CURSOR-SW
 14475           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14476        ELSE
 14477           MOVE AL-UANON             TO CBILCDA.
 14478
 14479 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 263
* EL6311.cbl
 14480     IF EMI-ERROR = ZEROS
 14481         NEXT SENTENCE
 14482     ELSE
 14483         GO TO 8200-SEND-DATAONLY.
 14484
 14485     IF CMAINTI = 'A'
 14486        GO TO 2200-ADD-CANCEL-ROUTINE.
 14487
 14488     IF CMAINTI = 'C'
 14489        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14490
 14491     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14492
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 264
* EL6311.cbl
 14494
 14495******************************************************************
 14496*                                                                *
 14497*                   S H O W   C A N C E L                        *
 14498*                                                                *
 14499******************************************************************
 14500
 14501 2100-SHOW-REQUEST.
 14502     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14503
 14504     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14505        MOVE -1                  TO CMAINTL
 14506        GO TO 8200-SEND-DATAONLY.
 14507
 14508     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14509
 14510     IF CSUFIXL NOT = ZEROS
 14511        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14512       ELSE
 14513        MOVE SPACE            TO WS-NEW-SUFFIX.
 14514
 14515     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14516     PERFORM 8600-DEEDIT.
 14517     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14518     MOVE '4'                    TO DC-OPTION-CODE.
 14519     PERFORM 9700-DATE-LINK.
 14520     IF DATE-CONVERSION-ERROR
 14521        MOVE ER-0348             TO EMI-ERROR
 14522        MOVE -1                  TO CEFFDTL
 14523        MOVE AL-UABON            TO CEFFDTA
 14524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14525        GO TO 8200-SEND-DATAONLY
 14526     ELSE
 14527        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14528        MOVE AL-UANON            TO CEFFDTA
 14529        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14530
 14531     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14532
 14533     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14534        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14535        MOVE 'Y'                    TO WS-SHOW-SW
 14536        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14537           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14538        ELSE
 14539           IF PI-FILE-BROWSE
 14540              GO TO 4300-BROWSE-FILE-FORWARD
 14541           ELSE
 14542              IF PI-CSR-BROWSE
 14543                 GO TO 4200-BROWSE-CSR-FORWARD
 14544              ELSE
 14545                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14546     ELSE
 14547        GO TO 3900-RE-DISPLAY-RECORD.
 14548
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 265
* EL6311.cbl
 14550
 14551
 14552******************************************************************
 14553*                                                                *
 14554*            A D D   C A N C E L   R O U T I N E                 *
 14555*                                                                *
 14556******************************************************************
 14557
 14558 2200-ADD-CANCEL-ROUTINE.
 14559     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14560
 14561
 14562* EXEC CICS GETMAIN
 14563*        SET     (ADDRESS OF PENDING-BUSINESS)
 14564*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14565*    END-EXEC.
 14566*    MOVE '," L                  $   #00013115' TO DFHEIV0
 14567     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14568     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14569     MOVE X'2020233030303133313135' TO DFHEIV0(25:11)
 14570     CALL 'kxdfhei1' USING DFHEIV0,
 14571           DFHEIV20,
 14572           ERPNDB-RECORD-LENGTH,
 14573           DFHEIV99
 14574     SET ADDRESS OF PENDING-BUSINESS TO
 14575         DFHEIV20
 14576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14577
 14578
 14579
 14580* EXEC CICS HANDLE CONDITION
 14581*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14582*    END-EXEC.
 14583*    MOVE '"$I                   ! 3 #00013120' TO DFHEIV0
 14584     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14586     MOVE X'3320233030303133313230' TO DFHEIV0(25:11)
 14587     CALL 'kxdfhei1' USING DFHEIV0
 14588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14589
 14590
 14591     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14592     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14593     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14594
 14595
 14596* EXEC CICS READ
 14597*        INTO    (PENDING-BUSINESS)
 14598*        DATASET (FILE-ID-ERPNDB)
 14599*        RIDFLD  (ERPNDB-KEY)
 14600*    END-EXEC.
 14601     MOVE LENGTH OF
 14602      PENDING-BUSINESS
 14603       TO DFHEIV11
 14604*    MOVE '&"IL       E          (   #00013128' TO DFHEIV0
 14605     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14607     MOVE X'2020233030303133313238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 266
* EL6311.cbl
 14608     CALL 'kxdfhei1' USING DFHEIV0,
 14609           FILE-ID-ERPNDB,
 14610           PENDING-BUSINESS,
 14611           DFHEIV11,
 14612           ERPNDB-KEY,
 14613           DFHEIV99,
 14614           DFHEIV99,
 14615           DFHEIV99
 14616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14617
 14618
 14619     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14620
 14621     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14622     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14623     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14624     MOVE SPACES                 TO PENDING-BUSINESS.
 14625     MOVE 'PB'                   TO PB-RECORD-ID.
 14626     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14627     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14628     MOVE SPACES                 TO PB-CERT-SFX.
 14629     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14630     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14631                                    PB-ALT-CHG-SEQ-NO.
 14632
 14633     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14634     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14635     MOVE '2'                    TO PB-RECORD-TYPE.
 14636
 14637     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14638     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14639
 14640
 14641     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14642                                    PB-ALT-CHG-SEQ-NO
 14643                                    PB-C-LF-REF-CALC
 14644                                    PB-C-AH-REF-CALC
 14645                                    PB-C-LF-RFND-CLP
 14646                                    PB-C-AH-RFND-CLP
 14647                                    PB-CI-INSURED-AGE
 14648                                    PB-CI-LF-TERM
 14649                                    PB-CI-AH-TERM
 14650                                    PB-CI-LF-BENEFIT-CD
 14651                                    PB-CI-LF-BENEFIT-AMT
 14652                                    PB-CI-LF-ALT-BENEFIT-AMT
 14653                                    PB-CI-LF-PREMIUM-AMT
 14654                                    PB-CI-LF-ALT-PREMIUM-AMT
 14655                                    PB-CI-AH-BENEFIT-CD
 14656                                    PB-CI-AH-BENEFIT-AMT
 14657                                    PB-CI-AH-PREMIUM-AMT
 14658                                    PB-CI-PAY-FREQUENCY
 14659                                    PB-CI-LOAN-APR
 14660                                    PB-CI-LOAN-TERM
 14661                                    PB-CI-LIFE-COMMISSION
 14662                                    PB-CI-AH-COMMISSION
 14663                                    PB-CI-CURR-SEQ
 14664                                    PB-CI-AH-CANCEL-AMT
 14665                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 267
* EL6311.cbl
 14666                                    PB-CI-RATE-DEV-PCT-LF
 14667                                    PB-CI-RATE-DEV-PCT-AH
 14668                                    PB-CI-EXTENTION-DAYS
 14669                                    PB-CI-TERM-IN-DAYS
 14670                                    PB-CI-LIVES
 14671                                    PB-CI-LF-CRIT-PER
 14672                                    PB-CI-AH-CRIT-PER
 14673                                    PB-C-LF-REM-TERM
 14674                                    PB-C-AH-REM-TERM
 14675                                    PB-CHG-COUNT
 14676                                    PB-LF-BILLED-AMTS
 14677                                    PB-AH-BILLED-AMTS
 14678                                    PB-C-NH-INT-ON-REFS
 14679*                                   PB-C-MICROFILM-NO
 14680                                    PB-CALC-TOLERANCE.
 14681
 14682     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14683                                    PB-CI-AH-SETTLEMENT-DT
 14684                                    PB-CI-DEATH-DT
 14685                                    PB-CI-LF-PRIOR-CANCEL-DT
 14686                                    PB-CI-AH-PRIOR-CANCEL-DT
 14687                                    PB-CI-ENTRY-DT
 14688                                    PB-CI-LF-EXPIRE-DT
 14689                                    PB-CI-AH-EXPIRE-DT
 14690                                    PB-CI-LOAN-1ST-PMT-DT
 14691                                    PB-C-LF-CANCEL-DT
 14692                                    PB-C-AH-CANCEL-DT
 14693                                    PB-CREDIT-ACCEPT-DT
 14694                                    PB-BILLED-DT
 14695                                    PB-ACCT-EFF-DT
 14696                                    PB-ACCT-EXP-DT.
 14697
 14698     MOVE 'X'                    TO PB-FATAL-FLAG.
 14699
 14700     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14701
 14702     IF CSUFIXL     GREATER THAN ZEROS
 14703        MOVE CSUFIXI             TO PB-CERT-SFX.
 14704
 14705*    IF CMICRNOL  GREATER  ZEROS
 14706*        IF CMICRNOI  NUMERIC
 14707*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14708*            MOVE AL-UNNON       TO  CMICRNOA
 14709*        ELSE
 14710*            MOVE -1             TO  CMICRNOL
 14711*            MOVE AL-UNBON       TO  CMICRNOA
 14712*            MOVE ER-2701        TO  EMI-ERROR
 14713*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14714
 14715     IF CLSTNML     GREATER THAN ZEROS
 14716        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14717
 14718     IF CCANREAL > ZEROS
 14719        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14720     END-IF
 14721     IF CPCYNL > ZEROS
 14722        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14723     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 268
* EL6311.cbl
 14724     IF CCANDT1L    GREATER THAN ZEROS
 14725        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14726
 14727     IF CCANDT2L    GREATER THAN ZEROS
 14728        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14729
 14730     IF CMTHD1L    GREATER THAN +0
 14731        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14732
 14733     IF CMTHD2L    GREATER THAN +0
 14734        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14735
 14736     IF CREFND1L    GREATER THAN ZEROS
 14737        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14738        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14739     ELSE
 14740        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14741
 14742     IF CREFND2L    GREATER THAN ZEROS
 14743        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14744        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14745     ELSE
 14746        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14747
 14748     IF CLIVESL     GREATER THAN ZEROS
 14749        MOVE WS-CLIVES           TO PB-C-LIVES
 14750     ELSE
 14751        MOVE ZEROS               TO PB-C-LIVES.
 14752
 14753     IF CPAYEEL     GREATER THAN ZEROS
 14754        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14755
 14756     IF CFORCEL     GREATER THAN ZEROS
 14757        MOVE CFORCEI             TO PB-FORCE-CODE.
 14758
 14759     IF CBILCDL     GREATER THAN ZEROS
 14760        MOVE CBILCDI             TO PB-RECORD-BILL.
 14761
 14762*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14763
 14764 2260-WRITE-PB-RECORD.
 14765     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14766                                    PB-INPUT-BY.
 14767     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14768     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14769                                    PB-INPUT-DT.
 14770
 14771     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14772     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14773                                    PB-CONTROL-BY-ORIG-BATCH.
 14774
 14775     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14776     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14777     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14778     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14779     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14780
 14781     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 269
* EL6311.cbl
 14782
 14783     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14784
 14785     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14786     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14787     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14788
 14789     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14790     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14791
 14792 2275-WRITE-PENDING-BUSINESS.
 14793     MOVE 'A'                    TO JP-RECORD-TYPE.
 14794     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14795     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14796     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14797
 14798
 14799* EXEC CICS HANDLE CONDITION
 14800*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14801*    END-EXEC.
 14802*    MOVE '"$%                   ! 4 #00013313' TO DFHEIV0
 14803     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14805     MOVE X'3420233030303133333133' TO DFHEIV0(25:11)
 14806     CALL 'kxdfhei1' USING DFHEIV0
 14807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14808
 14809
 14810
 14811* EXEC CICS WRITE
 14812*        DATASET (FILE-ID-ERPNDB)
 14813*        FROM    (PENDING-BUSINESS)
 14814*        RIDFLD  (PB-CONTROL-PRIMARY)
 14815*    END-EXEC.
 14816     MOVE LENGTH OF
 14817      PENDING-BUSINESS
 14818       TO DFHEIV11
 14819*    MOVE '&$ L                  ''   #00013317' TO DFHEIV0
 14820     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14821     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14822     MOVE X'2020233030303133333137' TO DFHEIV0(25:11)
 14823     CALL 'kxdfhei1' USING DFHEIV0,
 14824           FILE-ID-ERPNDB,
 14825           PENDING-BUSINESS,
 14826           DFHEIV11,
 14827           PB-CONTROL-PRIMARY,
 14828           DFHEIV99,
 14829           DFHEIV99
 14830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14831
 14832
 14833     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14834
 14835     PERFORM 8400-LOG-JOURNAL-RECORD.
 14836
 14837******************************************************************
 14838*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14839******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 270
* EL6311.cbl
 14840
 14841     display ' made it to add orig CANCEL cert '
 14842     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14843     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14844     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14845     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14846
 14847
 14848* EXEC CICS READ
 14849*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14850*        DATASET (FILE-ID-ELCERT)
 14851*        RIDFLD  (ELCERT-KEY)
 14852*        RESP    (WS-RESPONSE)
 14853*    END-EXEC.
 14854*    MOVE '&"S        E          (  N#00013337' TO DFHEIV0
 14855     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14857     MOVE X'204E233030303133333337' TO DFHEIV0(25:11)
 14858     CALL 'kxdfhei1' USING DFHEIV0,
 14859           FILE-ID-ELCERT,
 14860           DFHEIV20,
 14861           DFHEIV99,
 14862           ELCERT-KEY,
 14863           DFHEIV99,
 14864           DFHEIV99,
 14865           DFHEIV99
 14866     SET ADDRESS OF CERTIFICATE-MASTER TO
 14867         DFHEIV20
 14868     MOVE EIBRESP  TO WS-RESPONSE
 14869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14870
 14871
 14872     IF NOT RESP-NORMAL
 14873        GO TO 2276-BYPASS-CRTO
 14874     END-IF
 14875
 14876     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14877     MOVE ' '                    TO WS-ERMAIL-SW
 14878
 14879
 14880* EXEC CICS READ
 14881*       DATASET   (FILE-ID-ERMAIL)
 14882*       SET       (ADDRESS OF MAILING-DATA)
 14883*       RIDFLD    (ERMAIL-KEY)
 14884*       RESP      (WS-RESPONSE)
 14885*    END-EXEC
 14886*    MOVE '&"S        E          (  N#00013351' TO DFHEIV0
 14887     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14888     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14889     MOVE X'204E233030303133333531' TO DFHEIV0(25:11)
 14890     CALL 'kxdfhei1' USING DFHEIV0,
 14891           FILE-ID-ERMAIL,
 14892           DFHEIV20,
 14893           DFHEIV99,
 14894           ERMAIL-KEY,
 14895           DFHEIV99,
 14896           DFHEIV99,
 14897           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 271
* EL6311.cbl
 14898     SET ADDRESS OF MAILING-DATA TO
 14899         DFHEIV20
 14900     MOVE EIBRESP  TO WS-RESPONSE
 14901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14902
 14903     IF RESP-NORMAL
 14904        SET ERMAIL-FOUND TO TRUE
 14905     END-IF
 14906
 14907     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14908
 14909     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14910     MOVE 'OC'                   TO OC-RECORD-ID
 14911     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14912                                 TO OC-CONTROL-PRIMARY (1:33)
 14913     MOVE 'I'                    TO OC-RECORD-TYPE
 14914     MOVE +4096                  TO OC-KEY-SEQ-NO
 14915     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14916     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14917     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14918
 14919     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14920     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14921     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14922     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14923     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14924     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14925     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14926     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14927     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14928     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14929     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14930     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14931     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14932     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14933     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14934     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14935     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14936     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14937     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14938     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14939     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14940     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14941     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14942     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14943     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14944     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14945     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14946     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14947     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14948     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14949     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14950     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14951
 14952     IF ERMAIL-FOUND
 14953        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14954     END-IF
 14955     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 272
* EL6311.cbl
 14956        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14957                           OC-INS-AGE-DEFAULT-FLAG
 14958        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14959                           OC-JNT-AGE-DEFAULT-FLAG
 14960     END-IF
 14961     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14962     .
 14963 2275-WRITE-ELCRTO.
 14964
 14965
 14966* EXEC CICS WRITE
 14967*       DATASET   ('ELCRTO')
 14968*       FROM      (ORIGINAL-CERTIFICATE)
 14969*       RIDFLD    (OC-CONTROL-PRIMARY)
 14970*       RESP      (WS-RESPONSE)
 14971*    END-EXEC
 14972     MOVE LENGTH OF
 14973      ORIGINAL-CERTIFICATE
 14974       TO DFHEIV11
 14975     MOVE 'ELCRTO' TO DFHEIV1
 14976*    MOVE '&$ L                  ''  N#00013420' TO DFHEIV0
 14977     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14978     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14979     MOVE X'204E233030303133343230' TO DFHEIV0(25:11)
 14980     CALL 'kxdfhei1' USING DFHEIV0,
 14981           DFHEIV1,
 14982           ORIGINAL-CERTIFICATE,
 14983           DFHEIV11,
 14984           OC-CONTROL-PRIMARY,
 14985           DFHEIV99,
 14986           DFHEIV99
 14987     MOVE EIBRESP  TO WS-RESPONSE
 14988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14989
 14990     display ' just wrote 2275 ' ws-response
 14991     IF RESP-DUPKEY
 14992        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14993        GO TO 2275-WRITE-ELCRTO
 14994     ELSE
 14995        IF NOT RESP-NORMAL
 14996           MOVE -1               TO BMAINTL
 14997           MOVE ER-7450          TO EMI-ERROR
 14998           PERFORM 9900-ERROR-FORMAT
 14999                                 THRU 9900-EXIT
 15000           GO TO 8200-SEND-DATAONLY
 15001        END-IF
 15002     END-IF.
 15003
 15004 2276-BYPASS-CRTO.
 15005******************************************************************
 15006*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15007******************************************************************
 15008
 15009
 15010* EXEC CICS READ
 15011*        INTO    (PENDING-BUSINESS)
 15012*        DATASET (FILE-ID-ERPNDB)
 15013*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 273
* EL6311.cbl
 15014*        UPDATE
 15015*    END-EXEC.
 15016     MOVE LENGTH OF
 15017      PENDING-BUSINESS
 15018       TO DFHEIV11
 15019*    MOVE '&"IL       EU         (   #00013446' TO DFHEIV0
 15020     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15021     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15022     MOVE X'2020233030303133343436' TO DFHEIV0(25:11)
 15023     CALL 'kxdfhei1' USING DFHEIV0,
 15024           FILE-ID-ERPNDB,
 15025           PENDING-BUSINESS,
 15026           DFHEIV11,
 15027           ERPNDB-KEY,
 15028           DFHEIV99,
 15029           DFHEIV99,
 15030           DFHEIV99
 15031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15032
 15033
 15034     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15035     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15036     MOVE 'B'                    TO JP-RECORD-TYPE.
 15037     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15038
 15039     PERFORM 8400-LOG-JOURNAL-RECORD.
 15040
 15041     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15042
 15043
 15044* EXEC CICS REWRITE
 15045*        DATASET (FILE-ID-ERPNDB)
 15046*        FROM    (PENDING-BUSINESS)
 15047*    END-EXEC.
 15048     MOVE LENGTH OF
 15049      PENDING-BUSINESS
 15050       TO DFHEIV11
 15051*    MOVE '&& L                  %   #00013462' TO DFHEIV0
 15052     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15053     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15054     MOVE X'2020233030303133343632' TO DFHEIV0(25:11)
 15055     CALL 'kxdfhei1' USING DFHEIV0,
 15056           FILE-ID-ERPNDB,
 15057           PENDING-BUSINESS,
 15058           DFHEIV11,
 15059           DFHEIV99
 15060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15061
 15062
 15063     MOVE 'C'                    TO JP-RECORD-TYPE.
 15064     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15065
 15066     PERFORM 8400-LOG-JOURNAL-RECORD.
 15067
 15068     IF WS-ERRORS-PRESENT
 15069        GO TO 3900-RE-DISPLAY-RECORD.
 15070
 15071     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 274
* EL6311.cbl
 15072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15073     MOVE LOW-VALUES             TO EL631CI.
 15074     MOVE  -1                    TO CMAINTL.
 15075     GO TO 8100-SEND-INITIAL-MAP.
 15076
 15077 2280-BATCH-HDR-NOT-FOUND.
 15078     MOVE -1                     TO BMAINTL.
 15079     MOVE ER-7450                TO EMI-ERROR.
 15080     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15081     GO TO 8200-SEND-DATAONLY.
 15082
 15083 2290-DUPLICATE-ALT-INDEX.
 15084
 15085******************************************************************
 15086*                                                                *
 15087*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15088*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15089*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15090*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15091*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15092*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15093*                                                                *
 15094******************************************************************
 15095
 15096     IF LCP-ONCTR-02 =  0
 15097         ADD 1 TO LCP-ONCTR-02
 15098        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15099
 15100     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15101
 15102     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15103         NEXT SENTENCE
 15104     ELSE
 15105         ADD +1 TO PB-BATCH-SEQ-NO
 15106                   PB-CSR-BATCH-SEQ-NO
 15107         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15108         GO TO 2275-WRITE-PENDING-BUSINESS.
 15109
 15110     MOVE -1                     TO CCERTNOL.
 15111     MOVE AL-UABON               TO CCERTNOA.
 15112     MOVE AL-UNBON               TO CEFFDTA.
 15113
 15114     MOVE 1                      TO EMI-SUB
 15115                                    EMI-SWITCH1
 15116                                    EMI-SWITCH-AREA-1
 15117                                    EMI-SWITCH-AREA-2.
 15118
 15119     MOVE SPACES                 TO EMI-ERROR-LINES.
 15120
 15121
 15122* EXEC CICS SYNCPOINT ROLLBACK
 15123*    END-EXEC.
 15124*    MOVE '6"R                   !   #00013525' TO DFHEIV0
 15125     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15127     MOVE X'2020233030303133353235' TO DFHEIV0(25:11)
 15128     CALL 'kxdfhei1' USING DFHEIV0
 15129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 275
* EL6311.cbl
 15130
 15131
 15132     MOVE ER-2247                TO EMI-ERROR.
 15133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15134     GO TO 8200-SEND-DATAONLY.
 15135
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 276
* EL6311.cbl
 15137
 15138******************************************************************
 15139*                                                                *
 15140*          C H A N G E   C A N C E L   R O U T I N E             *
 15141*                                                                *
 15142******************************************************************
 15143
 15144***************************************************************
 15145*                                                             *
 15146*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15147*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15148*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15149*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15150*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15151*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15152*     5. LINK TO THE EDIT ROUTINE.                            *
 15153*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15154*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15155*              THE EDIT ROUTINE.                              *
 15156*     7. REWRITE THE NEW ISSUE                                *
 15157*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15158*                                                             *
 15159***************************************************************
 15160 2300-CHANGE-CANCEL-ROUTINE.
 15161     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15162
 15163     IF CCHGL NOT = ZEROS
 15164        MOVE ER-2196             TO EMI-ERROR
 15165        MOVE AL-UABON            TO CMAINTA
 15166        MOVE -1                  TO CMAINTL
 15167        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15168        GO TO 8200-SEND-DATAONLY.
 15169
 15170     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15171
 15172     IF CSUFIXL NOT = ZEROS
 15173        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15174     ELSE
 15175        MOVE SPACE               TO WS-NEW-SUFFIX.
 15176
 15177     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15178     PERFORM 8600-DEEDIT.
 15179     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15180     MOVE '4'                    TO DC-OPTION-CODE.
 15181
 15182     PERFORM 9700-DATE-LINK.
 15183
 15184     IF DATE-CONVERSION-ERROR
 15185        MOVE ER-0348             TO EMI-ERROR
 15186        MOVE -1                  TO CEFFDTL
 15187        MOVE AL-UABON            TO CEFFDTA
 15188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15189        GO TO 8200-SEND-DATAONLY
 15190     ELSE
 15191        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15192        MOVE AL-UANON            TO CEFFDTA
 15193        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15194
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 277
* EL6311.cbl
 15195 2325-PROCESS-CANCEL-CHANGES.
 15196
 15197* EXEC CICS HANDLE CONDITION
 15198*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15199*    END-EXEC.
 15200*    MOVE '"$I                   ! 5 #00013592' TO DFHEIV0
 15201     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15203     MOVE X'3520233030303133353932' TO DFHEIV0(25:11)
 15204     CALL 'kxdfhei1' USING DFHEIV0
 15205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15206
 15207
 15208     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15209     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15210     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15211
 15212
 15213* EXEC CICS GETMAIN
 15214*        SET      (ADDRESS OF PENDING-BUSINESS)
 15215*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15216*        INITIMG  (GETMAIN-SPACE)
 15217*     END-EXEC.
 15218*    MOVE ',"IL                  $   #00013600' TO DFHEIV0
 15219     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15221     MOVE X'2020233030303133363030' TO DFHEIV0(25:11)
 15222     CALL 'kxdfhei1' USING DFHEIV0,
 15223           DFHEIV20,
 15224           ERPNDB-RECORD-LENGTH,
 15225           GETMAIN-SPACE
 15226     SET ADDRESS OF PENDING-BUSINESS TO
 15227         DFHEIV20
 15228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15229
 15230
 15231
 15232* EXEC CICS READ
 15233*        INTO    (PENDING-BUSINESS)
 15234*        DATASET (FILE-ID-ERPNDB)
 15235*        RIDFLD  (ERPNDB-KEY)
 15236*    END-EXEC.
 15237     MOVE LENGTH OF
 15238      PENDING-BUSINESS
 15239       TO DFHEIV11
 15240*    MOVE '&"IL       E          (   #00013606' TO DFHEIV0
 15241     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15243     MOVE X'2020233030303133363036' TO DFHEIV0(25:11)
 15244     CALL 'kxdfhei1' USING DFHEIV0,
 15245           FILE-ID-ERPNDB,
 15246           PENDING-BUSINESS,
 15247           DFHEIV11,
 15248           ERPNDB-KEY,
 15249           DFHEIV99,
 15250           DFHEIV99,
 15251           DFHEIV99
 15252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 278
* EL6311.cbl
 15253
 15254
 15255     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15256
 15257
 15258* EXEC CICS HANDLE CONDITION
 15259*         NOTFND     (2385-REC-NOT-FOUND)
 15260*    END-EXEC.
 15261*    MOVE '"$I                   ! 6 #00013614' TO DFHEIV0
 15262     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15264     MOVE X'3620233030303133363134' TO DFHEIV0(25:11)
 15265     CALL 'kxdfhei1' USING DFHEIV0
 15266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15267
 15268
 15269**********************************************************
 15270*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15271*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15272**********************************************************
 15273
 15274
 15275* EXEC CICS READ
 15276*        DATASET (FILE-ID-ERPNDB)
 15277*        INTO    (PENDING-BUSINESS)
 15278*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15279*    END-EXEC.
 15280     MOVE LENGTH OF
 15281      PENDING-BUSINESS
 15282       TO DFHEIV11
 15283*    MOVE '&"IL       E          (   #00013623' TO DFHEIV0
 15284     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15285     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15286     MOVE X'2020233030303133363233' TO DFHEIV0(25:11)
 15287     CALL 'kxdfhei1' USING DFHEIV0,
 15288           FILE-ID-ERPNDB,
 15289           PENDING-BUSINESS,
 15290           DFHEIV11,
 15291           PI-PREV-CONTROL-PRIMARY,
 15292           DFHEIV99,
 15293           DFHEIV99,
 15294           DFHEIV99
 15295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15296
 15297
 15298********** DO NOT ALLOW CHANGES IF THRU A/R
 15299     IF BMAINTI = 'C'
 15300         IF PB-EL860-INTERNAL-PROCESS
 15301             MOVE ER-4005          TO EMI-ERROR
 15302             MOVE -1               TO BMAINTL
 15303             MOVE AL-UABON         TO BMAINTA
 15304             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15305             GO TO 8200-SEND-DATAONLY.
 15306**********
 15307
 15308     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15309        MOVE -1                 TO CMAINTL
 15310        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 279
* EL6311.cbl
 15311        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15312        GO TO 8200-SEND-DATAONLY.
 15313
 15314     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15315        MOVE ER-2196             TO EMI-ERROR
 15316        MOVE AL-UABON            TO CMAINTA
 15317        MOVE -1                  TO CMAINTL
 15318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15319        GO TO 8200-SEND-DATAONLY.
 15320     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15321
 15322     IF PB-BILLED-DT = LOW-VALUES AND
 15323        PB-CHG-COUNT = ZEROS
 15324        NEXT SENTENCE
 15325     ELSE
 15326        IF (CREFND1L GREATER THAN ZEROS AND
 15327            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15328           OR
 15329           (CREFND2L GREATER THAN ZEROS AND
 15330            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15331           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15332     if ((crefnd1l <> zeros)
 15333        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15334                      or
 15335        ((crefnd2l <> zeros)
 15336        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15337        continue
 15338     else
 15339        go to 2330-continue-change
 15340     end-if
 15341
 15342     move zeros                  to ws-check-amts
 15343     move ' '                    to ws-stop-sw
 15344                                    ws-check-sw
 15345                                    ws-proc-check-sw
 15346                                    ws-chek-browse-sw
 15347
 15348     perform 2500-browse-checks  thru 2500-exit
 15349
 15350     if i-have-processed-checks
 15351        or i-have-checks
 15352        continue
 15353     else
 15354        go to 2330-continue-change
 15355     end-if
 15356
 15357     display ' pb lf can ' pb-c-lf-cancel-amt
 15358     display ' ws lf can ' ws-crefnd1
 15359     if crefnd1l <> zeros
 15360        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15361        move ws-crefnd1 to ws-new-ref-total
 15362     else
 15363        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15364     end-if
 15365     display ' pb ah can ' pb-c-ah-cancel-amt
 15366     display ' ws ah can ' ws-crefnd2
 15367     display ' chk amts  ' ws-check-amts
 15368     if crefnd2l <> zeros
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 280
* EL6311.cbl
 15369        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15370        compute ws-new-ref-total = ws-new-ref-total +
 15371           ws-crefnd2
 15372     else
 15373        compute ws-new-ref-total = ws-new-ref-total +
 15374           pb-c-ah-cancel-amt
 15375     end-if
 15376
 15377     if zeros = (ws-lf-diff + ws-ah-diff)
 15378        move er-3449             to emi-error
 15379        perform 9900-error-format thru 9900-exit
 15380        go to 2330-continue-change
 15381     end-if
 15382
 15383     if (ws-new-ref-total < ws-check-amts)
 15384        and (pb-c-refund-sw = 'Y')
 15385        move er-3447             to emi-error
 15386        perform 9900-error-format thru 9900-exit
 15387        move al-uabon            to cmainta
 15388        move -1                  to cmaintl
 15389        go to 8200-send-dataonly
 15390     end-if
 15391
 15392     if (ws-new-ref-total > ws-check-amts)
 15393        and (ws-check-amts not = zeros)
 15394        move er-3448             to emi-error
 15395        move al-uabon            to crefnd1a
 15396                                    crefnd2a
 15397        perform 9900-error-format thru 9900-exit
 15398     end-if
 15399
 15400*     if (ws-lf-diff + ws-ah-diff) < zeros
 15401*        move er-3447             to emi-error
 15402*        perform 9900-error-format thru 9900-exit
 15403*        move al-uabon            to cmainta
 15404*        move -1                  to cmaintl
 15405*        go to 8200-send-dataonly
 15406*     end-if
 15407     .
 15408 2330-continue-change.
 15409
 15410
 15411* EXEC CICS READ
 15412*        DATASET (FILE-ID-ERPNDB)
 15413*        INTO    (PENDING-BUSINESS)
 15414*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15415*        UPDATE
 15416*    END-EXEC.
 15417     MOVE LENGTH OF
 15418      PENDING-BUSINESS
 15419       TO DFHEIV11
 15420*    MOVE '&"IL       EU         (   #00013741' TO DFHEIV0
 15421     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15422     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15423     MOVE X'2020233030303133373431' TO DFHEIV0(25:11)
 15424     CALL 'kxdfhei1' USING DFHEIV0,
 15425           FILE-ID-ERPNDB,
 15426           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 281
* EL6311.cbl
 15427           DFHEIV11,
 15428           PI-PREV-CONTROL-PRIMARY,
 15429           DFHEIV99,
 15430           DFHEIV99,
 15431           DFHEIV99
 15432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15433
 15434
 15435     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15436     MOVE 'B'                    TO JP-RECORD-TYPE
 15437     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15438     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15439
 15440     PERFORM 8400-LOG-JOURNAL-RECORD.
 15441
 15442     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15443          PB-CHG-COUNT NOT = ZEROS
 15444        IF (CREFND1L GREATER THAN ZEROS AND
 15445            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15446           OR
 15447           (CREFND2L GREATER THAN ZEROS AND
 15448            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15449            ADD +1                      TO PB-CHG-COUNT
 15450            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15451
 15452*    IF CMICRNOL  GREATER  ZEROS
 15453*        IF CMICRNOI  NUMERIC
 15454*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15455*            MOVE AL-UNNON       TO  CMICRNOA
 15456*        ELSE
 15457*            MOVE -1             TO  CMICRNOL
 15458*            MOVE AL-UNBON       TO  CMICRNOA
 15459*            MOVE ER-2701        TO  EMI-ERROR
 15460*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15461
 15462     IF CSUFIXL GREATER THAN ZEROS
 15463        MOVE CSUFIXI             TO PB-CERT-SFX.
 15464
 15465     IF CLSTNML GREATER THAN ZEROS
 15466         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15467
 15468     IF CCANREAL > ZEROS
 15469        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15470     END-IF
 15471     IF CPCYNL > ZEROS
 15472        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15473     END-IF
 15474     IF CCANDT1L    GREATER THAN ZEROS
 15475        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15476
 15477     IF CCANDT2L    GREATER THAN ZEROS
 15478        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15479
 15480     IF CMTHD1L    GREATER THAN +0
 15481        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15482
 15483     IF CMTHD2L    GREATER THAN +0
 15484        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 282
* EL6311.cbl
 15485
 15486     IF CREFND1L    GREATER THAN ZEROS
 15487        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15488        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15489        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15490        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15491
 15492     IF CREFND2L    GREATER THAN ZEROS
 15493        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15494        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15495        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15496        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15497
 15498     IF CLIVESL     GREATER THAN ZEROS
 15499        MOVE WS-CLIVES           TO PB-C-LIVES.
 15500
 15501     IF CPAYEEL     GREATER THAN ZEROS
 15502        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15503
 15504     IF CFORCEL     GREATER THAN ZEROS
 15505        MOVE CFORCEI             TO PB-FORCE-CODE.
 15506
 15507     IF CBILCDL     GREATER THAN ZEROS
 15508        MOVE CBILCDI             TO PB-RECORD-BILL.
 15509
 15510 2360-REWRITE-PB-RECORD.
 15511     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15512     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15513     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15514     MOVE 'C'                    TO JP-RECORD-TYPE.
 15515     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15516     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15517     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15518
 15519     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15520
 15521     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15522     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15523
 15524     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15525
 15526     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15527
 15528     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15529     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15530     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15531
 15532     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15533     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15534
 15535 2375-REWRITE-PENDING-BUSINESS.
 15536     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15537     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15538     MOVE 'C'                    TO JP-RECORD-TYPE.
 15539     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15540
 15541
 15542* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 283
* EL6311.cbl
 15543*        DATASET (FILE-ID-ERPNDB)
 15544*        FROM    (PENDING-BUSINESS)
 15545*    END-EXEC.
 15546     MOVE LENGTH OF
 15547      PENDING-BUSINESS
 15548       TO DFHEIV11
 15549*    MOVE '&& L                  %   #00013854' TO DFHEIV0
 15550     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15551     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15552     MOVE X'2020233030303133383534' TO DFHEIV0(25:11)
 15553     CALL 'kxdfhei1' USING DFHEIV0,
 15554           FILE-ID-ERPNDB,
 15555           PENDING-BUSINESS,
 15556           DFHEIV11,
 15557           DFHEIV99
 15558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15559
 15560
 15561     PERFORM 8400-LOG-JOURNAL-RECORD.
 15562
 15563******************************************************************
 15564*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15565******************************************************************
 15566
 15567     display ' made it to update orig cancel cert '
 15568
 15569     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15570     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15571     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15572     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15573
 15574
 15575* EXEC CICS READ
 15576*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15577*        DATASET (FILE-ID-ELCERT)
 15578*        RIDFLD  (ELCERT-KEY)
 15579*        RESP    (WS-RESPONSE)
 15580*    END-EXEC.
 15581*    MOVE '&"S        E          (  N#00013872' TO DFHEIV0
 15582     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15584     MOVE X'204E233030303133383732' TO DFHEIV0(25:11)
 15585     CALL 'kxdfhei1' USING DFHEIV0,
 15586           FILE-ID-ELCERT,
 15587           DFHEIV20,
 15588           DFHEIV99,
 15589           ELCERT-KEY,
 15590           DFHEIV99,
 15591           DFHEIV99,
 15592           DFHEIV99
 15593     SET ADDRESS OF CERTIFICATE-MASTER TO
 15594         DFHEIV20
 15595     MOVE EIBRESP  TO WS-RESPONSE
 15596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15597
 15598
 15599     IF NOT RESP-NORMAL
 15600        GO TO 2376-BYPASS-CRTO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 284
* EL6311.cbl
 15601     END-IF
 15602
 15603
 15604     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15605     MOVE ' '                    TO WS-ERMAIL-SW
 15606
 15607
 15608* EXEC CICS READ
 15609*       DATASET   (FILE-ID-ERMAIL)
 15610*       SET       (ADDRESS OF MAILING-DATA)
 15611*       RIDFLD    (ERMAIL-KEY)
 15612*       RESP      (WS-RESPONSE)
 15613*    END-EXEC
 15614*    MOVE '&"S        E          (  N#00013887' TO DFHEIV0
 15615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15617     MOVE X'204E233030303133383837' TO DFHEIV0(25:11)
 15618     CALL 'kxdfhei1' USING DFHEIV0,
 15619           FILE-ID-ERMAIL,
 15620           DFHEIV20,
 15621           DFHEIV99,
 15622           ERMAIL-KEY,
 15623           DFHEIV99,
 15624           DFHEIV99,
 15625           DFHEIV99
 15626     SET ADDRESS OF MAILING-DATA TO
 15627         DFHEIV20
 15628     MOVE EIBRESP  TO WS-RESPONSE
 15629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15630
 15631     IF RESP-NORMAL
 15632        SET ERMAIL-FOUND TO TRUE
 15633     END-IF
 15634
 15635     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15636
 15637     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15638                                 TO ELCRTO-KEY
 15639     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15640     MOVE +0                     TO ELCRTO-SEQ-NO
 15641
 15642
 15643* EXEC CICS READ
 15644*       DATASET   ('ELCRTO')
 15645*       INTO      (ORIGINAL-CERTIFICATE)
 15646*       RIDFLD    (ELCRTO-KEY)
 15647*       GTEQ
 15648*       RESP      (WS-RESPONSE)
 15649*    END-EXEC
 15650     MOVE LENGTH OF
 15651      ORIGINAL-CERTIFICATE
 15652       TO DFHEIV11
 15653     MOVE 'ELCRTO' TO DFHEIV1
 15654*    MOVE '&"IL       G          (  N#00013905' TO DFHEIV0
 15655     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15657     MOVE X'204E233030303133393035' TO DFHEIV0(25:11)
 15658     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 285
* EL6311.cbl
 15659           DFHEIV1,
 15660           ORIGINAL-CERTIFICATE,
 15661           DFHEIV11,
 15662           ELCRTO-KEY,
 15663           DFHEIV99,
 15664           DFHEIV99,
 15665           DFHEIV99
 15666     MOVE EIBRESP  TO WS-RESPONSE
 15667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15668
 15669     display ' just read gteq ' ws-response
 15670     IF RESP-NORMAL
 15671        AND (OC-CONTROL-PRIMARY (1:33) =
 15672                 PB-CONTROL-BY-ACCOUNT (1:33))
 15673        AND (OC-RECORD-TYPE = 'I')
 15674        display ' resp norm, key =, type i '
 15675        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15676           display ' end proc blank '
 15677           display ' csr edit session ' PI-CSR-SESSION-SW
 15678           IF NOT CSR-EDIT-SESSION
 15679
 15680* EXEC CICS READ
 15681*                DATASET   ('ELCRTO')
 15682*                INTO      (ORIGINAL-CERTIFICATE)
 15683*                RIDFLD    (OC-CONTROL-PRIMARY)
 15684*                UPDATE
 15685*                RESP      (WS-RESPONSE)
 15686*             END-EXEC
 15687     MOVE LENGTH OF
 15688      ORIGINAL-CERTIFICATE
 15689       TO DFHEIV11
 15690     MOVE 'ELCRTO' TO DFHEIV1
 15691*    MOVE '&"IL       EU         (  N#00013923' TO DFHEIV0
 15692     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15693     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15694     MOVE X'204E233030303133393233' TO DFHEIV0(25:11)
 15695     CALL 'kxdfhei1' USING DFHEIV0,
 15696           DFHEIV1,
 15697           ORIGINAL-CERTIFICATE,
 15698           DFHEIV11,
 15699           OC-CONTROL-PRIMARY,
 15700           DFHEIV99,
 15701           DFHEIV99,
 15702           DFHEIV99
 15703     MOVE EIBRESP  TO WS-RESPONSE
 15704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15705              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15706              IF RESP-NORMAL
 15707                 display ' good read upd '
 15708                 IF OC-ISSUE-TRAN-IND = 'N'
 15709                    MOVE CM-INSURED-LAST-NAME   TO
 15710                         OC-INS-LAST-NAME
 15711                    MOVE CM-INSURED-FIRST-NAME  TO
 15712                         OC-INS-FIRST-NAME
 15713                    MOVE CM-INSURED-INITIAL2    TO
 15714                         OC-INS-MIDDLE-INIT
 15715                    MOVE CM-INSURED-ISSUE-AGE   TO
 15716                         OC-INS-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 286
* EL6311.cbl
 15717                    MOVE CM-JT-LAST-NAME        TO
 15718                         OC-JNT-LAST-NAME
 15719                    MOVE CM-JT-FIRST-NAME       TO
 15720                         OC-JNT-FIRST-NAME
 15721                    MOVE CM-JT-INITIAL          TO
 15722                         OC-JNT-MIDDLE-INIT
 15723                    MOVE CM-INSURED-JOINT-AGE   TO
 15724                         OC-JNT-AGE
 15725                    MOVE CM-LF-BENEFIT-CD       TO
 15726                         OC-LF-BENCD
 15727                    MOVE CM-LF-ORIG-TERM        TO
 15728                         OC-LF-TERM
 15729                    MOVE CM-LF-BENEFIT-AMT      TO
 15730                         OC-LF-BEN-AMT
 15731                    MOVE CM-LF-PREMIUM-AMT      TO
 15732                         OC-LF-PRM-AMT
 15733                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15734                         OC-LF-ALT-BEN-AMT
 15735                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15736                         OC-LF-ALT-PRM-AMT
 15737                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15738                         OC-LF-EXP-DT
 15739                    MOVE CM-LIFE-COMM-PCT       TO
 15740                         OC-LF-COMM-PCT
 15741                    MOVE CM-AH-BENEFIT-CD       TO
 15742                         OC-AH-BENCD
 15743                    MOVE CM-AH-ORIG-TERM        TO
 15744                         OC-AH-TERM
 15745                    MOVE CM-AH-BENEFIT-AMT      TO
 15746                         OC-AH-BEN-AMT
 15747                    MOVE CM-AH-PREMIUM-AMT      TO
 15748                         OC-AH-PRM-AMT
 15749                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15750                         OC-AH-EXP-DT
 15751                    MOVE CM-AH-COMM-PCT         TO
 15752                         OC-AH-COMM-PCT
 15753                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15754                         OC-AH-CP
 15755                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15756                         OC-1ST-PMT-DT
 15757                 END-IF
 15758                 MOVE PB-C-LF-CANCEL-DT      TO
 15759                         OC-LF-CANCEL-DT
 15760                 MOVE PB-C-LF-CANCEL-AMT     TO
 15761                         OC-LF-CANCEL-AMT
 15762                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15763                         OC-LF-ITD-CANCEL-AMT
 15764                 MOVE PB-C-AH-CANCEL-DT      TO
 15765                         OC-AH-CANCEL-DT
 15766                 MOVE PB-C-AH-CANCEL-AMT     TO
 15767                         OC-AH-CANCEL-AMT
 15768                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15769                         OC-AH-ITD-CANCEL-AMT
 15770                 MOVE 'Y'                    TO
 15771                         OC-CANCEL-TRAN-IND
 15772                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15773                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15774                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 287
* EL6311.cbl
 15775                 IF ERMAIL-FOUND
 15776                    MOVE MA-CRED-BENE-NAME
 15777                                 TO OC-CRED-BENE-NAME
 15778                 END-IF
 15779                 IF NOT CERT-TRL-REC-NOT-FOUND
 15780                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15781                           OC-INS-AGE-DEFAULT-FLAG
 15782                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15783                           OC-JNT-AGE-DEFAULT-FLAG
 15784                 END-IF
 15785
 15786* EXEC CICS REWRITE
 15787*                   DATASET   ('ELCRTO')
 15788*                   FROM      (ORIGINAL-CERTIFICATE)
 15789*                   RESP      (WS-RESPONSE)
 15790*                END-EXEC
 15791     MOVE LENGTH OF
 15792      ORIGINAL-CERTIFICATE
 15793       TO DFHEIV11
 15794     MOVE 'ELCRTO' TO DFHEIV1
 15795*    MOVE '&& L                  %  N#00014010' TO DFHEIV0
 15796     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15797     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15798     MOVE X'204E233030303134303130' TO DFHEIV0(25:11)
 15799     CALL 'kxdfhei1' USING DFHEIV0,
 15800           DFHEIV1,
 15801           ORIGINAL-CERTIFICATE,
 15802           DFHEIV11,
 15803           DFHEIV99
 15804     MOVE EIBRESP  TO WS-RESPONSE
 15805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15806                 display ' just rewrote ' ws-response
 15807              END-IF
 15808           END-IF
 15809        ELSE
 15810           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15811           MOVE 'OC'             TO OC-RECORD-ID
 15812           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15813           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15814           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15815           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15816           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15817           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15818           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15819           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15820           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15821           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15822           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15823           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15824           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15825           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15826           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15827           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15828           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15829           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15830           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15831           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15832           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 288
* EL6311.cbl
 15833           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15834           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15835           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15836           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15837           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15838           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15839           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15840           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15841           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15842           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15843           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15844           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15845           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15846           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15847           IF ERMAIL-FOUND
 15848              MOVE MA-CRED-BENE-NAME
 15849                                 TO OC-CRED-BENE-NAME
 15850           END-IF
 15851           IF NOT CERT-TRL-REC-NOT-FOUND
 15852              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15853                           OC-INS-AGE-DEFAULT-FLAG
 15854              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15855                           OC-JNT-AGE-DEFAULT-FLAG
 15856           END-IF
 15857           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15858
 15859* EXEC CICS WRITE
 15860*             DATASET   ('ELCRTO')
 15861*             FROM      (ORIGINAL-CERTIFICATE)
 15862*             RIDFLD    (OC-CONTROL-PRIMARY)
 15863*             RESP      (WS-RESPONSE)
 15864*          END-EXEC
 15865     MOVE LENGTH OF
 15866      ORIGINAL-CERTIFICATE
 15867       TO DFHEIV11
 15868     MOVE 'ELCRTO' TO DFHEIV1
 15869*    MOVE '&$ L                  ''  N#00014067' TO DFHEIV0
 15870     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15871     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15872     MOVE X'204E233030303134303637' TO DFHEIV0(25:11)
 15873     CALL 'kxdfhei1' USING DFHEIV0,
 15874           DFHEIV1,
 15875           ORIGINAL-CERTIFICATE,
 15876           DFHEIV11,
 15877           OC-CONTROL-PRIMARY,
 15878           DFHEIV99,
 15879           DFHEIV99
 15880     MOVE EIBRESP  TO WS-RESPONSE
 15881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15882        END-IF
 15883     ELSE
 15884        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15885        MOVE 'OC'                TO OC-RECORD-ID
 15886        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15887                                 TO OC-CONTROL-PRIMARY (1:33)
 15888        MOVE 'I'                 TO OC-RECORD-TYPE
 15889        MOVE +4096               TO OC-KEY-SEQ-NO
 15890        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 289
* EL6311.cbl
 15891        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15892        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15893        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15894        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15895        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15896        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15897        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15898        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15899        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15900        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15901        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15902        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15903        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15904        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15905        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15906        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15907        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15908        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15909        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15910        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15911        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15912        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15913        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15914        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15915        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15916        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15917        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15918        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15919        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15920        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15921        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15922        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15923        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15924        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15925        IF ERMAIL-FOUND
 15926           MOVE MA-CRED-BENE-NAME
 15927                                 TO OC-CRED-BENE-NAME
 15928        END-IF
 15929        IF NOT CERT-TRL-REC-NOT-FOUND
 15930           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15931                           OC-INS-AGE-DEFAULT-FLAG
 15932           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15933                           OC-JNT-AGE-DEFAULT-FLAG
 15934        END-IF
 15935        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15936
 15937
 15938* EXEC CICS WRITE
 15939*          DATASET   ('ELCRTO')
 15940*          FROM      (ORIGINAL-CERTIFICATE)
 15941*          RIDFLD    (OC-CONTROL-PRIMARY)
 15942*          RESP      (WS-RESPONSE)
 15943*       END-EXEC
 15944     MOVE LENGTH OF
 15945      ORIGINAL-CERTIFICATE
 15946       TO DFHEIV11
 15947     MOVE 'ELCRTO' TO DFHEIV1
 15948*    MOVE '&$ L                  ''  N#00014128' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 290
* EL6311.cbl
 15949     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15950     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15951     MOVE X'204E233030303134313238' TO DFHEIV0(25:11)
 15952     CALL 'kxdfhei1' USING DFHEIV0,
 15953           DFHEIV1,
 15954           ORIGINAL-CERTIFICATE,
 15955           DFHEIV11,
 15956           OC-CONTROL-PRIMARY,
 15957           DFHEIV99,
 15958           DFHEIV99
 15959     MOVE EIBRESP  TO WS-RESPONSE
 15960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15961     END-IF.
 15962
 15963 2376-BYPASS-CRTO.
 15964******************************************************************
 15965*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15966******************************************************************
 15967
 15968
 15969* EXEC CICS HANDLE CONDITION
 15970*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15971*    END-EXEC.
 15972*    MOVE '"$I                   ! 7 #00014141' TO DFHEIV0
 15973     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15975     MOVE X'3720233030303134313431' TO DFHEIV0(25:11)
 15976     CALL 'kxdfhei1' USING DFHEIV0
 15977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15978
 15979
 15980
 15981* EXEC CICS READ
 15982*        INTO    (PENDING-BUSINESS)
 15983*        DATASET (FILE-ID-ERPNDB)
 15984*        RIDFLD  (ERPNDB-KEY)
 15985*        UPDATE
 15986*    END-EXEC.
 15987     MOVE LENGTH OF
 15988      PENDING-BUSINESS
 15989       TO DFHEIV11
 15990*    MOVE '&"IL       EU         (   #00014145' TO DFHEIV0
 15991     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15992     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15993     MOVE X'2020233030303134313435' TO DFHEIV0(25:11)
 15994     CALL 'kxdfhei1' USING DFHEIV0,
 15995           FILE-ID-ERPNDB,
 15996           PENDING-BUSINESS,
 15997           DFHEIV11,
 15998           ERPNDB-KEY,
 15999           DFHEIV99,
 16000           DFHEIV99,
 16001           DFHEIV99
 16002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16003
 16004
 16005     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16006     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 291
* EL6311.cbl
 16007     MOVE 'B'                    TO JP-RECORD-TYPE.
 16008     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16009
 16010     PERFORM 8400-LOG-JOURNAL-RECORD.
 16011
 16012     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16013
 16014
 16015* EXEC CICS REWRITE
 16016*        DATASET (FILE-ID-ERPNDB)
 16017*        FROM    (PENDING-BUSINESS)
 16018*    END-EXEC.
 16019     MOVE LENGTH OF
 16020      PENDING-BUSINESS
 16021       TO DFHEIV11
 16022*    MOVE '&& L                  %   #00014161' TO DFHEIV0
 16023     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16024     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16025     MOVE X'2020233030303134313631' TO DFHEIV0(25:11)
 16026     CALL 'kxdfhei1' USING DFHEIV0,
 16027           FILE-ID-ERPNDB,
 16028           PENDING-BUSINESS,
 16029           DFHEIV11,
 16030           DFHEIV99
 16031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16032
 16033
 16034     MOVE 'C'                    TO JP-RECORD-TYPE.
 16035     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16036
 16037     PERFORM 8400-LOG-JOURNAL-RECORD.
 16038
 16039     IF WS-ERRORS-PRESENT
 16040         GO TO 3900-RE-DISPLAY-RECORD.
 16041
 16042     MOVE ZEROS                  TO EMI-ERROR
 16043     MOVE -1                     TO CMAINTL
 16044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16045     GO TO 3900-RE-DISPLAY-RECORD.
 16046
 16047 2380-BATCH-HDR-NOT-FOUND.
 16048     MOVE -1                     TO BMAINTL.
 16049     MOVE ER-7450                TO EMI-ERROR.
 16050     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16051     GO TO 8200-SEND-DATAONLY.
 16052
 16053 2385-REC-NOT-FOUND.
 16054     MOVE -1                     TO BMAINTL.
 16055     MOVE ER-7451                TO EMI-ERROR.
 16056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16057     GO TO 8200-SEND-DATAONLY.
 16058
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 292
* EL6311.cbl
 16060
 16061******************************************************************
 16062*                                                                *
 16063*          D E L E T E   C A N C E L   R O U T I N E             *
 16064*                                                                *
 16065******************************************************************
 16066
 16067 2400-DELETE-CANCEL-ROUTINE.
 16068     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16069
 16070     IF CCHGL NOT = ZEROS
 16071        MOVE ER-2196             TO EMI-ERROR
 16072        MOVE AL-UABON            TO CMAINTA
 16073        MOVE -1                  TO CMAINTL
 16074        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16075        GO TO 8200-SEND-DATAONLY.
 16076
 16077
 16078* EXEC CICS HANDLE CONDITION
 16079*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16080*    END-EXEC.
 16081*    MOVE '"$I                   ! 8 #00014209' TO DFHEIV0
 16082     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16084     MOVE X'3820233030303134323039' TO DFHEIV0(25:11)
 16085     CALL 'kxdfhei1' USING DFHEIV0
 16086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16087
 16088
 16089     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16090     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16091     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16092
 16093
 16094* EXEC CICS READ
 16095*        SET     (ADDRESS OF PENDING-BUSINESS)
 16096*        DATASET (FILE-ID-ERPNDB)
 16097*        RIDFLD  (ERPNDB-KEY)
 16098*    END-EXEC.
 16099*    MOVE '&"S        E          (   #00014217' TO DFHEIV0
 16100     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16102     MOVE X'2020233030303134323137' TO DFHEIV0(25:11)
 16103     CALL 'kxdfhei1' USING DFHEIV0,
 16104           FILE-ID-ERPNDB,
 16105           DFHEIV20,
 16106           DFHEIV99,
 16107           ERPNDB-KEY,
 16108           DFHEIV99,
 16109           DFHEIV99,
 16110           DFHEIV99
 16111     SET ADDRESS OF PENDING-BUSINESS TO
 16112         DFHEIV20
 16113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16114
 16115
 16116     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16117
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 293
* EL6311.cbl
 16118     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16119
 16120     IF CSUFIXL NOT = ZEROS
 16121        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16122     ELSE
 16123        MOVE SPACE               TO WS-NEW-SUFFIX.
 16124
 16125     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16126
 16127     PERFORM 8600-DEEDIT.
 16128     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16129     MOVE '4'                    TO DC-OPTION-CODE.
 16130     PERFORM 9700-DATE-LINK.
 16131
 16132     IF DATE-CONVERSION-ERROR
 16133        MOVE ER-0348             TO EMI-ERROR
 16134        MOVE -1                  TO CEFFDTL
 16135        MOVE AL-UABON            TO CEFFDTA
 16136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16137        GO TO 8200-SEND-DATAONLY
 16138     ELSE
 16139        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16140        MOVE AL-UANON            TO CEFFDTA
 16141        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16142
 16143
 16144* EXEC CICS HANDLE CONDITION
 16145*         NOTFND    (2490-RECORD-NOT-FOUND)
 16146*    END-EXEC.
 16147*    MOVE '"$I                   ! 9 #00014250' TO DFHEIV0
 16148     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16150     MOVE X'3920233030303134323530' TO DFHEIV0(25:11)
 16151     CALL 'kxdfhei1' USING DFHEIV0
 16152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16153
 16154
 16155
 16156* EXEC CICS READ
 16157*        SET     (ADDRESS OF PENDING-BUSINESS)
 16158*        DATASET (FILE-ID-ERPNDB)
 16159*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16160*        UPDATE
 16161*    END-EXEC.
 16162*    MOVE '&"S        EU         (   #00014254' TO DFHEIV0
 16163     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16164     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16165     MOVE X'2020233030303134323534' TO DFHEIV0(25:11)
 16166     CALL 'kxdfhei1' USING DFHEIV0,
 16167           FILE-ID-ERPNDB,
 16168           DFHEIV20,
 16169           DFHEIV99,
 16170           PI-PREV-CONTROL-PRIMARY,
 16171           DFHEIV99,
 16172           DFHEIV99,
 16173           DFHEIV99
 16174     SET ADDRESS OF PENDING-BUSINESS TO
 16175         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 294
* EL6311.cbl
 16176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16177
 16178
 16179     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16180        MOVE -1                 TO CMAINTL
 16181        MOVE ER-2197            TO EMI-ERROR
 16182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16183        GO TO 8200-SEND-DATAONLY.
 16184
 16185     IF PB-BILLED-DT NOT = LOW-VALUES
 16186        MOVE -1                 TO CMAINTL
 16187        MOVE ER-2129            TO EMI-ERROR
 16188        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16189        GO TO 8200-SEND-DATAONLY.
 16190
 16191     IF PB-CHG-COUNT NOT = ZEROS
 16192        MOVE ER-2336            TO EMI-ERROR
 16193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16194        MOVE AL-UABON            TO CMAINTA
 16195        MOVE -1                  TO CMAINTL
 16196        GO TO 8200-SEND-DATAONLY.
 16197
 16198     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16199        PB-CHG-COUNT NOT = ZEROS
 16200        MOVE ER-2196             TO EMI-ERROR
 16201        MOVE AL-UABON            TO CMAINTA
 16202        MOVE -1                  TO CMAINTL
 16203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16204        GO TO 8200-SEND-DATAONLY.
 16205
 16206     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16207        MOVE ER-2900 TO EMI-ERROR
 16208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16209        MOVE AL-UABON         TO CMAINTA
 16210        MOVE -1               TO CMAINTL
 16211        GO TO 8200-SEND-DATAONLY.
 16212     move ' '                    to ws-stop-sw
 16213                                    ws-check-sw
 16214                                    ws-proc-check-sw
 16215                                    ws-chek-browse-sw
 16216
 16217     perform 2500-browse-checks  thru 2500-exit
 16218     if (i-have-processed-checks)
 16219        and (pb-c-refund-sw = 'Y')
 16220        move er-3446             to emi-error
 16221        perform 9900-error-format thru 9900-exit
 16222        move al-uabon            to cmainta
 16223        move -1                  to cmaintl
 16224        go to 8200-send-dataonly
 16225     end-if
 16226
 16227* EXEC CICS HANDLE CONDITION
 16228*         NOTFND  (2475-CONTINUE-DELETE)
 16229*    END-EXEC
 16230*    MOVE '"$I                   ! : #00014308' TO DFHEIV0
 16231     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16233     MOVE X'3A20233030303134333038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 295
* EL6311.cbl
 16234     CALL 'kxdfhei1' USING DFHEIV0
 16235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16236
 16237     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16238     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16239     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16240     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16241
 16242
 16243* EXEC CICS READ
 16244*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16245*        DATASET (FILE-ID-ELCERT)
 16246*        RIDFLD  (ELCERT-KEY)
 16247*        UPDATE
 16248*    END-EXEC.
 16249*    MOVE '&"S        EU         (   #00014317' TO DFHEIV0
 16250     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16251     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16252     MOVE X'2020233030303134333137' TO DFHEIV0(25:11)
 16253     CALL 'kxdfhei1' USING DFHEIV0,
 16254           FILE-ID-ELCERT,
 16255           DFHEIV20,
 16256           DFHEIV99,
 16257           ELCERT-KEY,
 16258           DFHEIV99,
 16259           DFHEIV99,
 16260           DFHEIV99
 16261     SET ADDRESS OF CERTIFICATE-MASTER TO
 16262         DFHEIV20
 16263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16264
 16265
 16266     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16267
 16268     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16269     MOVE 'B'                    TO JP-RECORD-TYPE.
 16270     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16271     PERFORM 8400-LOG-JOURNAL-RECORD.
 16272
 16273     IF PB-CI-LIVES NOT NUMERIC
 16274         MOVE ZERO                    TO PB-CI-LIVES.
 16275
 16276     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16277        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16278           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16279           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16280           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16281                                            CM-LF-CANCEL-DT
 16282           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16283        ELSE
 16284           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16285           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16286           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16287           MOVE PB-CI-LIVES              TO CM-LIVES.
 16288
 16289     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16290        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16291           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 296
* EL6311.cbl
 16292               MOVE CM-LF-STATUS-AT-CANCEL
 16293                                        TO CM-LF-CURRENT-STATUS
 16294               MOVE SPACE
 16295                                        TO CM-LF-STATUS-AT-CANCEL
 16296           ELSE
 16297               MOVE PB-CI-LF-POLICY-STATUS
 16298                                        TO CM-LF-CURRENT-STATUS
 16299        ELSE
 16300           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16301
 16302
 16303     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16304        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16305           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16306           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16307           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16308                                            CM-AH-CANCEL-DT
 16309           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16310        ELSE
 16311           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16312           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16313           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16314           MOVE PB-CI-LIVES              TO CM-LIVES.
 16315
 16316     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16317        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16318           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16319               MOVE CM-AH-STATUS-AT-CANCEL
 16320                                        TO CM-AH-CURRENT-STATUS
 16321               MOVE SPACE
 16322                                        TO CM-AH-STATUS-AT-CANCEL
 16323           ELSE
 16324               MOVE PB-CI-AH-POLICY-STATUS
 16325                                        TO CM-AH-CURRENT-STATUS
 16326        ELSE
 16327           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16328
 16329 2450-REWRITE-CERT.
 16330     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16331     MOVE 'C'                      TO JP-RECORD-TYPE.
 16332     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16333
 16334
 16335* EXEC CICS REWRITE
 16336*        DATASET  (FILE-ID-ELCERT)
 16337*        FROM     (CERTIFICATE-MASTER)
 16338*    END-EXEC.
 16339     MOVE LENGTH OF
 16340      CERTIFICATE-MASTER
 16341       TO DFHEIV11
 16342*    MOVE '&& L                  %   #00014392' TO DFHEIV0
 16343     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16344     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16345     MOVE X'2020233030303134333932' TO DFHEIV0(25:11)
 16346     CALL 'kxdfhei1' USING DFHEIV0,
 16347           FILE-ID-ELCERT,
 16348           CERTIFICATE-MASTER,
 16349           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 297
* EL6311.cbl
 16350           DFHEIV99
 16351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16352
 16353
 16354     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16355
 16356     PERFORM 8400-LOG-JOURNAL-RECORD.
 16357
 16358     move ' '                    to ws-stop-sw
 16359                                    ws-proc-check-sw
 16360                                    ws-chek-browse-sw
 16361
 16362     if i-have-checks
 16363        perform until i-say-stop
 16364           perform 2510-startbr-erchek
 16365                                 thru 2510-exit
 16366           if resp-normal
 16367              perform 2520-readnext-erchek
 16368                                 thru 2520-exit
 16369           end-if
 16370           if (not resp-normal)
 16371              or (pb-control-by-account (1:33) not =
 16372                 ch-control-primary (1:33))
 16373                 set i-say-stop to true
 16374           else
 16375              perform 2530-readupd-erchek
 16376                                 thru 2530-exit
 16377              if resp-normal
 16378                 perform 2540-delete-erchek
 16379                                 thru 2540-exit
 16380              end-if
 16381              if ws-chek-browse-sw = 'Y'
 16382                 perform 2525-endbr-erchek
 16383                                 thru 2525-exit
 16384                 move ' '        to ws-chek-browse-sw
 16385              end-if
 16386           end-if
 16387        end-perform
 16388     end-if
 16389
 16390     if ws-chek-browse-sw = 'Y'
 16391        perform 2525-endbr-erchek thru 2525-exit
 16392     end-if
 16393     .
 16394 2475-CONTINUE-DELETE.
 16395     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16396     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16397
 16398     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16399     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16400
 16401     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16402
 16403     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16404     MOVE 'D'                    TO JP-RECORD-TYPE
 16405     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16406
 16407
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 298
* EL6311.cbl
 16408* EXEC CICS DELETE
 16409*        DATASET    (FILE-ID-ERPNDB)
 16410*    END-EXEC.
 16411*    MOVE '&(                    &   #00014450' TO DFHEIV0
 16412     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16413     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16414     MOVE X'2020233030303134343530' TO DFHEIV0(25:11)
 16415     CALL 'kxdfhei1' USING DFHEIV0,
 16416           FILE-ID-ERPNDB,
 16417           DFHEIV99,
 16418           DFHEIV99,
 16419           DFHEIV99,
 16420           DFHEIV99
 16421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16422
 16423
 16424     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16425
 16426     PERFORM 8400-LOG-JOURNAL-RECORD.
 16427
 16428     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16429     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16430
 16431
 16432* EXEC CICS HANDLE CONDITION
 16433*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16434*    END-EXEC.
 16435*    MOVE '"$I                   ! ; #00014461' TO DFHEIV0
 16436     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16437     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16438     MOVE X'3B20233030303134343631' TO DFHEIV0(25:11)
 16439     CALL 'kxdfhei1' USING DFHEIV0
 16440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16441
 16442
 16443
 16444* EXEC CICS READ
 16445*        SET     (ADDRESS OF PENDING-BUSINESS)
 16446*        DATASET (FILE-ID-ERPNDB)
 16447*        RIDFLD  (ERPNDB-KEY)
 16448*        UPDATE
 16449*    END-EXEC.
 16450*    MOVE '&"S        EU         (   #00014465' TO DFHEIV0
 16451     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16452     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16453     MOVE X'2020233030303134343635' TO DFHEIV0(25:11)
 16454     CALL 'kxdfhei1' USING DFHEIV0,
 16455           FILE-ID-ERPNDB,
 16456           DFHEIV20,
 16457           DFHEIV99,
 16458           ERPNDB-KEY,
 16459           DFHEIV99,
 16460           DFHEIV99,
 16461           DFHEIV99
 16462     SET ADDRESS OF PENDING-BUSINESS TO
 16463         DFHEIV20
 16464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16465
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 299
* EL6311.cbl
 16466
 16467     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16468     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16469
 16470     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16471        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16472        MOVE 'D'                 TO JP-RECORD-TYPE
 16473        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16474
 16475* EXEC CICS DELETE
 16476*            DATASET    (FILE-ID-ERPNDB)
 16477*       END-EXEC
 16478*    MOVE '&(                    &   #00014479' TO DFHEIV0
 16479     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16480     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16481     MOVE X'2020233030303134343739' TO DFHEIV0(25:11)
 16482     CALL 'kxdfhei1' USING DFHEIV0,
 16483           FILE-ID-ERPNDB,
 16484           DFHEIV99,
 16485           DFHEIV99,
 16486           DFHEIV99,
 16487           DFHEIV99
 16488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16489        PERFORM 8400-LOG-JOURNAL-RECORD
 16490     ELSE
 16491        MOVE 'B'                 TO JP-RECORD-TYPE
 16492        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16493        PERFORM 8400-LOG-JOURNAL-RECORD
 16494        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16495        MOVE 'C'                 TO JP-RECORD-TYPE
 16496        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16497
 16498* EXEC CICS REWRITE
 16499*            DATASET    (FILE-ID-ERPNDB)
 16500*            FROM       (PENDING-BUSINESS)
 16501*       END-EXEC
 16502     MOVE LENGTH OF
 16503      PENDING-BUSINESS
 16504       TO DFHEIV11
 16505*    MOVE '&& L                  %   #00014490' TO DFHEIV0
 16506     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16507     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16508     MOVE X'2020233030303134343930' TO DFHEIV0(25:11)
 16509     CALL 'kxdfhei1' USING DFHEIV0,
 16510           FILE-ID-ERPNDB,
 16511           PENDING-BUSINESS,
 16512           DFHEIV11,
 16513           DFHEIV99
 16514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16515        PERFORM 8400-LOG-JOURNAL-RECORD.
 16516
 16517******************************************************************
 16518*                                                                *
 16519*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16520*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16521*                                                                *
 16522******************************************************************
 16523
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 300
* EL6311.cbl
 16524     IF NOT PI-AR-PROCESSING
 16525        GO TO 2480-DELETE-FINISHED.
 16526
 16527     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16528        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16529        NEXT SENTENCE
 16530     ELSE
 16531        GO TO 2480-DELETE-FINISHED.
 16532
 16533
 16534* EXEC CICS HANDLE CONDITION
 16535*         NOTFND    (2480-DELETE-FINISHED)
 16536*    END-EXEC.
 16537*    MOVE '"$I                   ! < #00014512' TO DFHEIV0
 16538     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16540     MOVE X'3C20233030303134353132' TO DFHEIV0(25:11)
 16541     CALL 'kxdfhei1' USING DFHEIV0
 16542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16543
 16544
 16545     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16546     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16547
 16548
 16549* EXEC CICS READ
 16550*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16551*        DATASET (FILE-ID-ERRQST)
 16552*        RIDFLD  (ERRQST-KEY)
 16553*        UPDATE
 16554*    END-EXEC.
 16555*    MOVE '&"S        EU         (   #00014519' TO DFHEIV0
 16556     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16557     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16558     MOVE X'2020233030303134353139' TO DFHEIV0(25:11)
 16559     CALL 'kxdfhei1' USING DFHEIV0,
 16560           FILE-ID-ERRQST,
 16561           DFHEIV20,
 16562           DFHEIV99,
 16563           ERRQST-KEY,
 16564           DFHEIV99,
 16565           DFHEIV99,
 16566           DFHEIV99
 16567     SET ADDRESS OF AR-REQUEST-RECORD TO
 16568         DFHEIV20
 16569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16570
 16571
 16572     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16573
 16574     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16575
 16576     MOVE 'D'                      TO JP-RECORD-TYPE.
 16577     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16578
 16579
 16580* EXEC CICS DELETE
 16581*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 301
* EL6311.cbl
 16582*    END-EXEC.
 16583*    MOVE '&(                    &   #00014533' TO DFHEIV0
 16584     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16585     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16586     MOVE X'2020233030303134353333' TO DFHEIV0(25:11)
 16587     CALL 'kxdfhei1' USING DFHEIV0,
 16588           FILE-ID-ERRQST,
 16589           DFHEIV99,
 16590           DFHEIV99,
 16591           DFHEIV99,
 16592           DFHEIV99
 16593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16594
 16595
 16596     PERFORM 8400-LOG-JOURNAL-RECORD.
 16597
 16598 2480-DELETE-FINISHED.
 16599     MOVE ZEROS                  TO EMI-ERROR.
 16600     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16601     MOVE LOW-VALUES             TO EL631CI.
 16602     MOVE -1                     TO CMAINTL.
 16603     GO TO 8100-SEND-INITIAL-MAP.
 16604
 16605 2485-BATCH-HDR-NOT-FOUND.
 16606     MOVE -1                     TO CMAINTL
 16607     MOVE AL-UABON               TO CMAINTA.
 16608     MOVE ER-7450                TO EMI-ERROR.
 16609     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16610     GO TO 8200-SEND-DATAONLY.
 16611
 16612 2490-RECORD-NOT-FOUND.
 16613     MOVE -1                     TO CMAINTL
 16614     MOVE AL-UABON               TO CMAINTA.
 16615     MOVE ER-7451                TO EMI-ERROR.
 16616     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16617     GO TO 8200-SEND-DATAONLY.
 16618***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16619***                                                            ***
 16620***     2500  B R O W S E   C H E C K S                        ***
 16621***  We perform this routine from 2 different places.          ***
 16622***  1. If the user changes the refund amount on a cancel, we  ***
 16623***    want to.........                                        ***
 16624***    a. determine if prior checks have been processed        ***
 16625***    b. If the amt is larger, display message instructing    ***
 16626***     them to create another check to make up the difference.***
 16627***    c. If the amt is less, do not allow the change and      ***
 16628***     display a FATAL error suggesting they deal with check  ***
 16629***     records befor continuing.                              ***
 16630***  2. If the user wants to delete a cancel record we......   ***
 16631***    a. browse through all the checks and if there is a      ***
 16632***     processed check, send FATAL message.                   ***
 16633***    b. If there is a non-released check, then delete that   ***
 16634***     check after you delete the pending cancel record.      ***
 16635***                                                            ***
 16636***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16637
 16638 2500-browse-checks.
 16639
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 302
* EL6311.cbl
 16640     perform 2510-startbr-erchek thru 2510-exit
 16641
 16642     if not resp-normal
 16643        go to 2500-exit
 16644     end-if
 16645
 16646     perform until i-say-stop
 16647        perform 2520-readnext-erchek
 16648                                 thru 2520-exit
 16649        if (not resp-normal)
 16650           or (pb-control-by-account (1:33) not =
 16651              ch-control-primary (1:33))
 16652              set i-say-stop to true
 16653        else
 16654           if (ch-approval-status) = ' '
 16655              and (ch-void-dt = low-values)
 16656              and (ch-released-dt = low-values)
 16657              set i-have-checks to true
 16658           else
 16659              if ch-void-dt = low-values
 16660                 set i-have-processed-checks to true
 16661              end-if
 16662           end-if
 16663           if (ch-credit-accept-dt = low-values)
 16664              and (ch-void-dt = low-values)
 16665              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16666              compute ws-check-amts = ws-check-amts +
 16667                 ch-amount-paid
 16668           end-if
 16669        end-if
 16670     end-perform
 16671
 16672     if ws-chek-browse-sw = 'Y'
 16673        perform 2525-endbr-erchek thru 2525-exit
 16674     end-if
 16675
 16676    .
 16677 2500-exit.
 16678     exit.
 16679
 16680 2510-startbr-erchek.
 16681
 16682     move pb-control-by-account  to erchek-key
 16683     move +0                     to chek-record-seq
 16684
 16685
 16686* exec cics startbr
 16687*       dataset   ('ERCHEK')
 16688*       ridfld    (erchek-key)
 16689*       gteq
 16690*       resp      (ws-response)
 16691*    end-exec
 16692     MOVE 'ERCHEK' TO DFHEIV1
 16693     MOVE 0
 16694       TO DFHEIV11
 16695*    MOVE '&,         G          &  N#00014626' TO DFHEIV0
 16696     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16697     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 303
* EL6311.cbl
 16698     MOVE X'204E233030303134363236' TO DFHEIV0(25:11)
 16699     CALL 'kxdfhei1' USING DFHEIV0,
 16700           DFHEIV1,
 16701           erchek-key,
 16702           DFHEIV99,
 16703           DFHEIV11,
 16704           DFHEIV99
 16705     MOVE EIBRESP  TO ws-response
 16706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16707
 16708     IF RESP-NORMAL
 16709        move 'Y'                 to ws-chek-browse-sw
 16710     end-if
 16711
 16712     .
 16713 2510-exit.
 16714     exit.
 16715
 16716 2520-readnext-erchek.
 16717
 16718
 16719* EXEC CICS READNEXT
 16720*       SET     (ADDRESS OF CHECK-RECORDS)
 16721*       DATASET ('ERCHEK')
 16722*       RIDFLD  (ERCHEK-KEY)
 16723*       RESP    (WS-RESPONSE)
 16724*    END-EXEC
 16725     MOVE 'ERCHEK' TO DFHEIV1
 16726     MOVE 0
 16727       TO DFHEIV11
 16728*    MOVE '&.S                   )  N#00014643' TO DFHEIV0
 16729     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16730     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16731     MOVE X'204E233030303134363433' TO DFHEIV0(25:11)
 16732     CALL 'kxdfhei1' USING DFHEIV0,
 16733           DFHEIV1,
 16734           DFHEIV20,
 16735           DFHEIV99,
 16736           ERCHEK-KEY,
 16737           DFHEIV99,
 16738           DFHEIV11,
 16739           DFHEIV99,
 16740           DFHEIV99
 16741     SET ADDRESS OF CHECK-RECORDS TO
 16742         DFHEIV20
 16743     MOVE EIBRESP  TO WS-RESPONSE
 16744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16745
 16746     .
 16747 2520-exit.
 16748     exit.
 16749
 16750 2525-endbr-erchek.
 16751
 16752
 16753* exec cics endbr
 16754*       dataset  ('ERCHEK')
 16755*    end-exec
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 304
* EL6311.cbl
 16756     MOVE 'ERCHEK' TO DFHEIV1
 16757     MOVE 0
 16758       TO DFHEIV11
 16759*    MOVE '&2                    $   #00014656' TO DFHEIV0
 16760     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16761     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16762     MOVE X'2020233030303134363536' TO DFHEIV0(25:11)
 16763     CALL 'kxdfhei1' USING DFHEIV0,
 16764           DFHEIV1,
 16765           DFHEIV11,
 16766           DFHEIV99
 16767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16768
 16769     .
 16770 2525-exit.
 16771     exit.
 16772
 16773 2530-readupd-erchek.
 16774
 16775
 16776* EXEC CICS READ
 16777*       UPDATE
 16778*       SET     (ADDRESS OF CHECK-RECORDS)
 16779*       DATASET ('ERCHEK')
 16780*       RIDFLD  (ERCHEK-KEY)
 16781*       RESP    (WS-RESPONSE)
 16782*    END-EXEC
 16783     MOVE 'ERCHEK' TO DFHEIV1
 16784*    MOVE '&"S        EU         (  N#00014666' TO DFHEIV0
 16785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16786     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16787     MOVE X'204E233030303134363636' TO DFHEIV0(25:11)
 16788     CALL 'kxdfhei1' USING DFHEIV0,
 16789           DFHEIV1,
 16790           DFHEIV20,
 16791           DFHEIV99,
 16792           ERCHEK-KEY,
 16793           DFHEIV99,
 16794           DFHEIV99,
 16795           DFHEIV99
 16796     SET ADDRESS OF CHECK-RECORDS TO
 16797         DFHEIV20
 16798     MOVE EIBRESP  TO WS-RESPONSE
 16799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16800
 16801     .
 16802 2530-exit.
 16803     exit.
 16804
 16805 2540-delete-erchek.
 16806
 16807
 16808* EXEC CICS DELETE
 16809*       DATASET ('ERCHEK')
 16810*       RESP    (WS-RESPONSE)
 16811*    END-EXEC
 16812     MOVE 'ERCHEK' TO DFHEIV1
 16813*    MOVE '&(                    &  N#00014680' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 305
* EL6311.cbl
 16814     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16815     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16816     MOVE X'204E233030303134363830' TO DFHEIV0(25:11)
 16817     CALL 'kxdfhei1' USING DFHEIV0,
 16818           DFHEIV1,
 16819           DFHEIV99,
 16820           DFHEIV99,
 16821           DFHEIV99,
 16822           DFHEIV99
 16823     MOVE EIBRESP  TO WS-RESPONSE
 16824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16825
 16826     .
 16827 2540-exit.
 16828     exit.
 16829***************************************************************
 16830*                                                             *
 16831*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16832*                                                             *
 16833***************************************************************
 16834
 16835***************************************************************
 16836*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16837*     AN ALREADY BILLED RECORD.                               *
 16838***************************************************************
 16839
 16840 2700-BUILD-CORRECTION-RECORD.
 16841     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16842     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16843     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16844     MOVE '5'                    TO DC-OPTION-CODE.
 16845     PERFORM 9700-DATE-LINK.
 16846     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16847
 16848     IF PB-CHG-COUNT = ZEROS
 16849        MOVE +1                  TO WS-SEQ-SAVE
 16850     ELSE
 16851        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16852
 16853     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16854     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16855
 16856     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16857
 16858     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16859     MOVE 'A'                    TO JP-RECORD-TYPE.
 16860     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16861
 16862
 16863* EXEC CICS WRITE
 16864*        DATASET    (FILE-ID-ERPNDB)
 16865*        FROM       (PENDING-BUSINESS)
 16866*        RIDFLD     (PB-CONTROL-PRIMARY)
 16867*    END-EXEC.
 16868     MOVE LENGTH OF
 16869      PENDING-BUSINESS
 16870       TO DFHEIV11
 16871*    MOVE '&$ L                  ''   #00014721' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 306
* EL6311.cbl
 16872     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16873     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16874     MOVE X'2020233030303134373231' TO DFHEIV0(25:11)
 16875     CALL 'kxdfhei1' USING DFHEIV0,
 16876           FILE-ID-ERPNDB,
 16877           PENDING-BUSINESS,
 16878           DFHEIV11,
 16879           PB-CONTROL-PRIMARY,
 16880           DFHEIV99,
 16881           DFHEIV99
 16882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16883
 16884
 16885     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16886
 16887     PERFORM 8400-LOG-JOURNAL-RECORD.
 16888
 16889 2799-EXIT.
 16890      EXIT.
 16891
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 307
* EL6311.cbl
 16893
 16894******************************************************************
 16895*                                                                *
 16896*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16897*                                                                *
 16898******************************************************************
 16899
 16900 2800-REWRITE-ISSUE-CERT-KEY.
 16901     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16902
 16903     IF  BCERTNOL GREATER THAN ZEROS
 16904         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16905
 16906     IF  BSUFIXL  GREATER THAN ZEROS
 16907         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16908
 16909     IF  BEFFDTL  GREATER THAN ZEROS
 16910         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16911
 16912 2810-READ-BY-ACCOUNT.
 16913
 16914* EXEC CICS HANDLE CONDITION
 16915*         NOTFND    (2820-PROCESS-REWRITE)
 16916*    END-EXEC.
 16917*    MOVE '"$I                   ! = #00014755' TO DFHEIV0
 16918     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16920     MOVE X'3D20233030303134373535' TO DFHEIV0(25:11)
 16921     CALL 'kxdfhei1' USING DFHEIV0
 16922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16923
 16924
 16925
 16926* EXEC CICS READ
 16927*        SET     (ADDRESS OF PENDING-BUSINESS)
 16928*        DATASET (FILE-ID-ERPNDB2)
 16929*        RIDFLD  (ERPNDB-ALT-KEY)
 16930*    END-EXEC.
 16931*    MOVE '&"S        E          (   #00014759' TO DFHEIV0
 16932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16934     MOVE X'2020233030303134373539' TO DFHEIV0(25:11)
 16935     CALL 'kxdfhei1' USING DFHEIV0,
 16936           FILE-ID-ERPNDB2,
 16937           DFHEIV20,
 16938           DFHEIV99,
 16939           ERPNDB-ALT-KEY,
 16940           DFHEIV99,
 16941           DFHEIV99,
 16942           DFHEIV99
 16943     SET ADDRESS OF PENDING-BUSINESS TO
 16944         DFHEIV20
 16945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16946
 16947
 16948     GO TO 2890-DUPLICATE-RECORD.
 16949
 16950  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 308
* EL6311.cbl
 16951
 16952* EXEC CICS HANDLE CONDITION
 16953*         NOTFND    (2885-RECORD-MISSING)
 16954*    END-EXEC.
 16955*    MOVE '"$I                   ! > #00014768' TO DFHEIV0
 16956     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16958     MOVE X'3E20233030303134373638' TO DFHEIV0(25:11)
 16959     CALL 'kxdfhei1' USING DFHEIV0
 16960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16961
 16962
 16963     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16964
 16965
 16966* EXEC CICS READ
 16967*        SET     (ADDRESS OF PENDING-BUSINESS)
 16968*        DATASET (FILE-ID-ERPNDB)
 16969*        RIDFLD  (ERPNDB-KEY)
 16970*        UPDATE
 16971*    END-EXEC.
 16972*    MOVE '&"S        EU         (   #00014774' TO DFHEIV0
 16973     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16974     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16975     MOVE X'2020233030303134373734' TO DFHEIV0(25:11)
 16976     CALL 'kxdfhei1' USING DFHEIV0,
 16977           FILE-ID-ERPNDB,
 16978           DFHEIV20,
 16979           DFHEIV99,
 16980           ERPNDB-KEY,
 16981           DFHEIV99,
 16982           DFHEIV99,
 16983           DFHEIV99
 16984     SET ADDRESS OF PENDING-BUSINESS TO
 16985         DFHEIV20
 16986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16987
 16988
 16989     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16990     MOVE 'D'                    TO JP-RECORD-TYPE.
 16991     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16992     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16993
 16994     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16995
 16996     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16997     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16998     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16999
 17000
 17001* EXEC CICS DELETE
 17002*        DATASET    (FILE-ID-ERPNDB)
 17003*    END-EXEC.
 17004*    MOVE '&(                    &   #00014792' TO DFHEIV0
 17005     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17007     MOVE X'2020233030303134373932' TO DFHEIV0(25:11)
 17008     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 309
* EL6311.cbl
 17009           FILE-ID-ERPNDB,
 17010           DFHEIV99,
 17011           DFHEIV99,
 17012           DFHEIV99,
 17013           DFHEIV99
 17014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17015
 17016
 17017     PERFORM 8400-LOG-JOURNAL-RECORD.
 17018
 17019
 17020* EXEC CICS GETMAIN
 17021*        SET      (ADDRESS OF PENDING-BUSINESS)
 17022*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17023*        INITIMG  (GETMAIN-SPACE)
 17024*    END-EXEC.
 17025*    MOVE ',"IL                  $   #00014798' TO DFHEIV0
 17026     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17027     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17028     MOVE X'2020233030303134373938' TO DFHEIV0(25:11)
 17029     CALL 'kxdfhei1' USING DFHEIV0,
 17030           DFHEIV20,
 17031           ERPNDB-RECORD-LENGTH,
 17032           GETMAIN-SPACE
 17033     SET ADDRESS OF PENDING-BUSINESS TO
 17034         DFHEIV20
 17035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17036
 17037
 17038     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17039
 17040
 17041* EXEC CICS HANDLE CONDITION
 17042*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17043*    END-EXEC.
 17044*    MOVE '"$I                   ! ? #00014806' TO DFHEIV0
 17045     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17047     MOVE X'3F20233030303134383036' TO DFHEIV0(25:11)
 17048     CALL 'kxdfhei1' USING DFHEIV0
 17049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17050
 17051
 17052
 17053* EXEC CICS READ
 17054*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17055*        DATASET (FILE-ID-ELCERT)
 17056*        RIDFLD  (ELCERT-KEY)
 17057*        UPDATE
 17058*    END-EXEC.
 17059*    MOVE '&"S        EU         (   #00014810' TO DFHEIV0
 17060     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17061     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17062     MOVE X'2020233030303134383130' TO DFHEIV0(25:11)
 17063     CALL 'kxdfhei1' USING DFHEIV0,
 17064           FILE-ID-ELCERT,
 17065           DFHEIV20,
 17066           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 310
* EL6311.cbl
 17067           ELCERT-KEY,
 17068           DFHEIV99,
 17069           DFHEIV99,
 17070           DFHEIV99
 17071     SET ADDRESS OF CERTIFICATE-MASTER TO
 17072         DFHEIV20
 17073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17074
 17075
 17076     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17077     MOVE 'B'                    TO JP-RECORD-TYPE
 17078     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17079     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17080
 17081     IF INSURED-ADDR-PRESENT
 17082        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17083
 17084     IF CERT-NOTES-ARE-NOT-PRESENT
 17085        MOVE SPACE               TO WS-CERT-NOTE-SW
 17086     ELSE
 17087        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17088
 17089     IF CERT-ADDED-BATCH      OR
 17090        CERT-AND-CLAIM-ONLINE OR
 17091        CERT-WAS-CREATED-FOR-CLAIM
 17092        NEXT SENTENCE
 17093     ELSE
 17094        GO TO 2825-DELETE-CERTIFICATE.
 17095
 17096     PERFORM 8400-LOG-JOURNAL-RECORD.
 17097
 17098*********************************************************
 17099** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17100     IF CERT-ADDED-BATCH
 17101         GO TO 2822-REWRITE-ELCERT.
 17102*********************************************************
 17103
 17104     IF NO-CLAIM-ATTACHED
 17105        NEXT SENTENCE
 17106     ELSE
 17107        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17108        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17109
 17110 2822-REWRITE-ELCERT.
 17111     MOVE 'C'                    TO JP-RECORD-TYPE
 17112     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17113
 17114     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17115
 17116
 17117* EXEC CICS REWRITE
 17118*         DATASET    (FILE-ID-ELCERT)
 17119*         FROM       (CERTIFICATE-MASTER)
 17120*    END-EXEC.
 17121     MOVE LENGTH OF
 17122      CERTIFICATE-MASTER
 17123       TO DFHEIV11
 17124*    MOVE '&& L                  %   #00014857' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 311
* EL6311.cbl
 17125     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17126     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17127     MOVE X'2020233030303134383537' TO DFHEIV0(25:11)
 17128     CALL 'kxdfhei1' USING DFHEIV0,
 17129           FILE-ID-ELCERT,
 17130           CERTIFICATE-MASTER,
 17131           DFHEIV11,
 17132           DFHEIV99
 17133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17134
 17135
 17136     PERFORM 8400-LOG-JOURNAL-RECORD.
 17137
 17138     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17139
 17140 2825-DELETE-CERTIFICATE.
 17141     MOVE 'D'                      TO JP-RECORD-TYPE.
 17142     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17143
 17144     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17145
 17146
 17147* EXEC CICS DELETE
 17148*         DATASET    (FILE-ID-ELCERT)
 17149*    END-EXEC.
 17150*    MOVE '&(                    &   #00014872' TO DFHEIV0
 17151     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17152     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17153     MOVE X'2020233030303134383732' TO DFHEIV0(25:11)
 17154     CALL 'kxdfhei1' USING DFHEIV0,
 17155           FILE-ID-ELCERT,
 17156           DFHEIV99,
 17157           DFHEIV99,
 17158           DFHEIV99,
 17159           DFHEIV99
 17160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17161
 17162
 17163     PERFORM 8400-LOG-JOURNAL-RECORD.
 17164
 17165******************************************************************
 17166*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17167******************************************************************
 17168
 17169     IF CERT-NOTES-ARE-PRESENT
 17170        NEXT SENTENCE
 17171     ELSE
 17172        GO TO 2827-DELETE-MAILING.
 17173
 17174
 17175* EXEC CICS HANDLE CONDITION
 17176*         NOTFND  (2827-DELETE-MAILING)
 17177*    END-EXEC.
 17178*    MOVE '"$I                   ! @ #00014887' TO DFHEIV0
 17179     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17181     MOVE X'4020233030303134383837' TO DFHEIV0(25:11)
 17182     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 312
* EL6311.cbl
 17183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17184
 17185
 17186
 17187* EXEC CICS READ
 17188*        EQUAL
 17189*        DATASET   (FILE-ID-ERNOTE)
 17190*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17191*        RIDFLD    (ELCERT-KEY)
 17192*        UPDATE
 17193*    END-EXEC.
 17194*    MOVE '&"S        EU         (   #00014891' TO DFHEIV0
 17195     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17196     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17197     MOVE X'2020233030303134383931' TO DFHEIV0(25:11)
 17198     CALL 'kxdfhei1' USING DFHEIV0,
 17199           FILE-ID-ERNOTE,
 17200           DFHEIV20,
 17201           DFHEIV99,
 17202           ELCERT-KEY,
 17203           DFHEIV99,
 17204           DFHEIV99,
 17205           DFHEIV99
 17206     SET ADDRESS OF CERTIFICATE-NOTE TO
 17207         DFHEIV20
 17208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17209
 17210
 17211     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17212     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17213     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17214
 17215     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17216
 17217
 17218* EXEC CICS DELETE
 17219*        DATASET   (FILE-ID-ERNOTE)
 17220*    END-EXEC.
 17221*    MOVE '&(                    &   #00014905' TO DFHEIV0
 17222     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17224     MOVE X'2020233030303134393035' TO DFHEIV0(25:11)
 17225     CALL 'kxdfhei1' USING DFHEIV0,
 17226           FILE-ID-ERNOTE,
 17227           DFHEIV99,
 17228           DFHEIV99,
 17229           DFHEIV99,
 17230           DFHEIV99
 17231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17232
 17233
 17234     PERFORM 8400-LOG-JOURNAL-RECORD.
 17235
 17236******************************************************************
 17237*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17238******************************************************************
 17239
 17240 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 313
* EL6311.cbl
 17241     IF CERT-ADDRESS-PRESENT
 17242        NEXT SENTENCE
 17243     ELSE
 17244        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17245
 17246
 17247* EXEC CICS HANDLE CONDITION
 17248*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17249*    END-EXEC.
 17250*    MOVE '"$I                   ! A #00014921' TO DFHEIV0
 17251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17253     MOVE X'4120233030303134393231' TO DFHEIV0(25:11)
 17254     CALL 'kxdfhei1' USING DFHEIV0
 17255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17256
 17257
 17258     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17259
 17260
 17261* EXEC CICS READ
 17262*        EQUAL
 17263*        DATASET   (FILE-ID-ERMAIL)
 17264*        SET       (ADDRESS OF MAILING-DATA)
 17265*        RIDFLD    (ERMAIL-KEY)
 17266*        UPDATE
 17267*    END-EXEC.
 17268*    MOVE '&"S        EU         (   #00014927' TO DFHEIV0
 17269     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17270     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17271     MOVE X'2020233030303134393237' TO DFHEIV0(25:11)
 17272     CALL 'kxdfhei1' USING DFHEIV0,
 17273           FILE-ID-ERMAIL,
 17274           DFHEIV20,
 17275           DFHEIV99,
 17276           ERMAIL-KEY,
 17277           DFHEIV99,
 17278           DFHEIV99,
 17279           DFHEIV99
 17280     SET ADDRESS OF MAILING-DATA TO
 17281         DFHEIV20
 17282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17283
 17284
 17285     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17286     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17287     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17288
 17289     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17290
 17291
 17292* EXEC CICS DELETE
 17293*        DATASET   (FILE-ID-ERMAIL)
 17294*    END-EXEC.
 17295*    MOVE '&(                    &   #00014941' TO DFHEIV0
 17296     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17297     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17298     MOVE X'2020233030303134393431' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 314
* EL6311.cbl
 17299     CALL 'kxdfhei1' USING DFHEIV0,
 17300           FILE-ID-ERMAIL,
 17301           DFHEIV99,
 17302           DFHEIV99,
 17303           DFHEIV99,
 17304           DFHEIV99
 17305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17306
 17307
 17308     PERFORM 8400-LOG-JOURNAL-RECORD.
 17309
 17310 2830-BUILD-NEW-ISSUE-RECORD.
 17311     MOVE SPACES                 TO ELCERT-KEY.
 17312
 17313     IF  BCERTNOL GREATER THAN ZEROS
 17314         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17315
 17316     IF  BSUFIXL  GREATER THAN ZEROS
 17317         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17318
 17319     IF BEFFDTL GREATER THAN ZEROS
 17320        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17321
 17322 2870-WRITE-PENDING-BUSINESS.
 17323     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17324     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17325     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17326     MOVE '5'                    TO DC-OPTION-CODE.
 17327     PERFORM 9700-DATE-LINK.
 17328     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17329
 17330     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17331
 17332     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17333     MOVE 'A'                    TO JP-RECORD-TYPE.
 17334     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17335
 17336
 17337* EXEC CICS WRITE
 17338*        DATASET  (FILE-ID-ERPNDB)
 17339*        FROM     (PENDING-BUSINESS)
 17340*        RIDFLD   (PB-CONTROL-PRIMARY)
 17341*    END-EXEC.
 17342     MOVE LENGTH OF
 17343      PENDING-BUSINESS
 17344       TO DFHEIV11
 17345*    MOVE '&$ L                  ''   #00014973' TO DFHEIV0
 17346     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17347     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17348     MOVE X'2020233030303134393733' TO DFHEIV0(25:11)
 17349     CALL 'kxdfhei1' USING DFHEIV0,
 17350           FILE-ID-ERPNDB,
 17351           PENDING-BUSINESS,
 17352           DFHEIV11,
 17353           PB-CONTROL-PRIMARY,
 17354           DFHEIV99,
 17355           DFHEIV99
 17356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 315
* EL6311.cbl
 17357
 17358
 17359     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17360
 17361     PERFORM 8400-LOG-JOURNAL-RECORD.
 17362
 17363     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17364
 17365 2885-RECORD-MISSING.
 17366     MOVE -1                     TO BMAINTL
 17367     MOVE AL-UABON               TO BMAINTA
 17368     MOVE ER-2902                TO EMI-ERROR.
 17369     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17370     GO TO 8200-SEND-DATAONLY.
 17371
 17372 2890-DUPLICATE-RECORD.
 17373     MOVE -1                     TO BMAINTL.
 17374     MOVE AL-UABON               TO BCERTNOA.
 17375     MOVE AL-UNBON               TO BEFFDTA.
 17376     MOVE SPACE                  TO BMAINTI.
 17377
 17378     MOVE 1                      TO EMI-SUB
 17379                                    EMI-SWITCH1
 17380                                    EMI-SWITCH-AREA-1
 17381                                    EMI-SWITCH-AREA-2.
 17382
 17383     MOVE SPACES                 TO EMI-ERROR-LINES.
 17384
 17385
 17386* EXEC CICS SYNCPOINT ROLLBACK
 17387*    END-EXEC.
 17388*    MOVE '6"R                   !   #00015005' TO DFHEIV0
 17389     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17391     MOVE X'2020233030303135303035' TO DFHEIV0(25:11)
 17392     CALL 'kxdfhei1' USING DFHEIV0
 17393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17394
 17395
 17396     MOVE ER-2247                TO EMI-ERROR.
 17397     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17398     GO TO 8200-SEND-DATAONLY.
 17399
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 316
* EL6311.cbl
 17401
 17402******************************************************************
 17403*                                                                *
 17404*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17405*                                                                *
 17406******************************************************************
 17407
 17408 2900-REWRITE-CAN-CERT-KEY.
 17409     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17410
 17411     IF  CCERTNOL GREATER THAN ZEROS
 17412         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17413
 17414     IF  CSUFIXL  GREATER THAN ZEROS
 17415         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17416
 17417     IF  CEFFDTL  GREATER THAN ZEROS
 17418         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17419
 17420 2910-READ-BY-ACCOUNT.
 17421
 17422* EXEC CICS HANDLE CONDITION
 17423*         NOTFND    (2920-PROCESS-REWRITE)
 17424*    END-EXEC.
 17425*    MOVE '"$I                   ! B #00015033' TO DFHEIV0
 17426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17428     MOVE X'4220233030303135303333' TO DFHEIV0(25:11)
 17429     CALL 'kxdfhei1' USING DFHEIV0
 17430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17431
 17432
 17433
 17434* EXEC CICS READ
 17435*        SET     (ADDRESS OF PENDING-BUSINESS)
 17436*        DATASET (FILE-ID-ERPNDB2)
 17437*        RIDFLD  (ERPNDB-ALT-KEY)
 17438*    END-EXEC.
 17439*    MOVE '&"S        E          (   #00015037' TO DFHEIV0
 17440     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17442     MOVE X'2020233030303135303337' TO DFHEIV0(25:11)
 17443     CALL 'kxdfhei1' USING DFHEIV0,
 17444           FILE-ID-ERPNDB2,
 17445           DFHEIV20,
 17446           DFHEIV99,
 17447           ERPNDB-ALT-KEY,
 17448           DFHEIV99,
 17449           DFHEIV99,
 17450           DFHEIV99
 17451     SET ADDRESS OF PENDING-BUSINESS TO
 17452         DFHEIV20
 17453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17454
 17455
 17456     GO TO 2990-DUPLICATE-RECORD.
 17457
 17458  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 317
* EL6311.cbl
 17459
 17460* EXEC CICS HANDLE CONDITION
 17461*         NOTFND    (2985-RECORD-MISSING)
 17462*    END-EXEC.
 17463*    MOVE '"$I                   ! C #00015046' TO DFHEIV0
 17464     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17466     MOVE X'4320233030303135303436' TO DFHEIV0(25:11)
 17467     CALL 'kxdfhei1' USING DFHEIV0
 17468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17469
 17470
 17471     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17472
 17473
 17474* EXEC CICS READ
 17475*        SET     (ADDRESS OF PENDING-BUSINESS)
 17476*        DATASET (FILE-ID-ERPNDB)
 17477*        RIDFLD  (ERPNDB-KEY)
 17478*        UPDATE
 17479*    END-EXEC.
 17480*    MOVE '&"S        EU         (   #00015052' TO DFHEIV0
 17481     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17482     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17483     MOVE X'2020233030303135303532' TO DFHEIV0(25:11)
 17484     CALL 'kxdfhei1' USING DFHEIV0,
 17485           FILE-ID-ERPNDB,
 17486           DFHEIV20,
 17487           DFHEIV99,
 17488           ERPNDB-KEY,
 17489           DFHEIV99,
 17490           DFHEIV99,
 17491           DFHEIV99
 17492     SET ADDRESS OF PENDING-BUSINESS TO
 17493         DFHEIV20
 17494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17495
 17496
 17497     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17498     MOVE 'D'                    TO JP-RECORD-TYPE.
 17499     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17500     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17501
 17502     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17503
 17504     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17505     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17506     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17507
 17508
 17509* EXEC CICS DELETE
 17510*        DATASET    (FILE-ID-ERPNDB)
 17511*    END-EXEC.
 17512*    MOVE '&(                    &   #00015070' TO DFHEIV0
 17513     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17514     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17515     MOVE X'2020233030303135303730' TO DFHEIV0(25:11)
 17516     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 318
* EL6311.cbl
 17517           FILE-ID-ERPNDB,
 17518           DFHEIV99,
 17519           DFHEIV99,
 17520           DFHEIV99,
 17521           DFHEIV99
 17522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17523
 17524
 17525     PERFORM 8400-LOG-JOURNAL-RECORD.
 17526
 17527
 17528* EXEC CICS GETMAIN
 17529*        SET      (ADDRESS OF PENDING-BUSINESS)
 17530*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17531*        INITIMG  (GETMAIN-SPACE)
 17532*    END-EXEC.
 17533*    MOVE ',"IL                  $   #00015076' TO DFHEIV0
 17534     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17535     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17536     MOVE X'2020233030303135303736' TO DFHEIV0(25:11)
 17537     CALL 'kxdfhei1' USING DFHEIV0,
 17538           DFHEIV20,
 17539           ERPNDB-RECORD-LENGTH,
 17540           GETMAIN-SPACE
 17541     SET ADDRESS OF PENDING-BUSINESS TO
 17542         DFHEIV20
 17543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17544
 17545
 17546     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17547
 17548 2950-PROCESS-CANCELS.
 17549
 17550
 17551* EXEC CICS HANDLE CONDITION
 17552*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17553*    END-EXEC.
 17554*    MOVE '"$I                   ! D #00015086' TO DFHEIV0
 17555     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17557     MOVE X'4420233030303135303836' TO DFHEIV0(25:11)
 17558     CALL 'kxdfhei1' USING DFHEIV0
 17559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17560
 17561
 17562
 17563* EXEC CICS READ
 17564*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17565*        DATASET (FILE-ID-ELCERT)
 17566*        RIDFLD  (ELCERT-KEY)
 17567*        UPDATE
 17568*    END-EXEC.
 17569*    MOVE '&"S        EU         (   #00015090' TO DFHEIV0
 17570     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17571     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17572     MOVE X'2020233030303135303930' TO DFHEIV0(25:11)
 17573     CALL 'kxdfhei1' USING DFHEIV0,
 17574           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 319
* EL6311.cbl
 17575           DFHEIV20,
 17576           DFHEIV99,
 17577           ELCERT-KEY,
 17578           DFHEIV99,
 17579           DFHEIV99,
 17580           DFHEIV99
 17581     SET ADDRESS OF CERTIFICATE-MASTER TO
 17582         DFHEIV20
 17583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17584
 17585
 17586     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17587
 17588     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17589     MOVE 'B'                      TO JP-RECORD-TYPE.
 17590     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17591     PERFORM 8400-LOG-JOURNAL-RECORD.
 17592
 17593     IF PB-CI-LIVES NOT NUMERIC
 17594         MOVE ZERO                    TO PB-CI-LIVES.
 17595
 17596     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17597        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17598        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17599        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17600                                         CM-LF-CANCEL-DT
 17601     ELSE
 17602        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17603        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17604        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17605        MOVE PB-CI-LIVES              TO CM-LIVES.
 17606
 17607     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17608        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17609            MOVE CM-LF-STATUS-AT-CANCEL
 17610                                     TO CM-LF-CURRENT-STATUS
 17611            MOVE SPACE
 17612                                     TO CM-LF-STATUS-AT-CANCEL
 17613        ELSE
 17614            MOVE PB-CI-LF-POLICY-STATUS
 17615                                     TO CM-LF-CURRENT-STATUS
 17616     ELSE
 17617        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17618
 17619     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17620        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17621        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17622        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17623                                         CM-AH-CANCEL-DT
 17624     ELSE
 17625        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17626        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17627        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17628        MOVE PB-CI-LIVES              TO CM-LIVES.
 17629
 17630     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17631        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17632            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 320
* EL6311.cbl
 17633                                     TO CM-AH-CURRENT-STATUS
 17634            MOVE SPACE
 17635                                     TO CM-AH-STATUS-AT-CANCEL
 17636        ELSE
 17637            MOVE PB-CI-AH-POLICY-STATUS
 17638                                     TO CM-AH-CURRENT-STATUS
 17639     ELSE
 17640        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17641
 17642 2975-REWRITE-CERT.
 17643     MOVE 'C'                      TO JP-RECORD-TYPE.
 17644     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17645
 17646
 17647* EXEC CICS REWRITE
 17648*        DATASET    (FILE-ID-ELCERT)
 17649*        FROM       (CERTIFICATE-MASTER)
 17650*    END-EXEC.
 17651     MOVE LENGTH OF
 17652      CERTIFICATE-MASTER
 17653       TO DFHEIV11
 17654*    MOVE '&& L                  %   #00015157' TO DFHEIV0
 17655     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17656     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17657     MOVE X'2020233030303135313537' TO DFHEIV0(25:11)
 17658     CALL 'kxdfhei1' USING DFHEIV0,
 17659           FILE-ID-ELCERT,
 17660           CERTIFICATE-MASTER,
 17661           DFHEIV11,
 17662           DFHEIV99
 17663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17664
 17665
 17666     PERFORM 8400-LOG-JOURNAL-RECORD.
 17667
 17668 2960-BUILD-NEW-CANCEL-RECORD.
 17669     IF  CCERTNOL GREATER THAN ZEROS
 17670         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17671
 17672     IF  CSUFIXL  GREATER THAN ZEROS
 17673         MOVE CSUFIXI             TO PB-CERT-SFX.
 17674
 17675     IF  CEFFDTL  GREATER  THAN ZEROS
 17676         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17677
 17678 2970-WRITE-PENDING-BUSINESS.
 17679     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17680     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17681     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17682     MOVE '5'                    TO DC-OPTION-CODE.
 17683     PERFORM 9700-DATE-LINK.
 17684     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17685
 17686     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17687
 17688     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17689                                    PB-CI-INSURED-SEX
 17690                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 321
* EL6311.cbl
 17691                                    PB-CI-AH-BENEFIT-CD
 17692                                    PB-CI-RATE-CLASS
 17693                                    PB-CI-RATE-DEV-LF
 17694                                    PB-CI-RATE-DEV-AH
 17695                                    PB-CI-LF-ABBR
 17696                                    PB-CI-AH-ABBR
 17697                                    PB-CI-OB-FLAG
 17698                                    PB-CI-LF-POLICY-STATUS
 17699                                    PB-CI-AH-POLICY-STATUS
 17700                                    PB-CI-INDV-GRP-CD
 17701                                    PB-CI-BENEFICIARY-NAME
 17702                                    PB-CI-NOTE-SW
 17703                                    PB-CI-SOC-SEC-NO
 17704                                    PB-CI-MEMBER-NO
 17705                                    PB-CI-INT-CODE
 17706                                    PB-CI-COMP-EXCP-SW
 17707                                    PB-CI-ENTRY-STATUS
 17708                                    PB-CI-CREDIT-INTERFACE-SW-1
 17709                                    PB-CI-CREDIT-INTERFACE-SW-2
 17710                                    PB-CI-ENTRY-BATCH.
 17711
 17712     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17713                                    PB-CI-AH-SETTLEMENT-DT
 17714                                    PB-CI-DEATH-DT
 17715                                    PB-CI-LF-PRIOR-CANCEL-DT
 17716                                    PB-CI-AH-PRIOR-CANCEL-DT
 17717                                    PB-CI-LOAN-1ST-PMT-DT
 17718                                    PB-CI-ENTRY-DT
 17719                                    PB-CI-LF-EXPIRE-DT
 17720                                    PB-CI-AH-EXPIRE-DT.
 17721
 17722     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17723                                    PB-CI-LF-TERM
 17724                                    PB-CI-LF-BENEFIT-AMT
 17725                                    PB-CI-LF-ALT-BENEFIT-AMT
 17726                                    PB-CI-LF-PREMIUM-AMT
 17727                                    PB-CI-LF-ALT-PREMIUM-AMT
 17728                                    PB-CI-AH-TERM
 17729                                    PB-CI-AH-BENEFIT-AMT
 17730                                    PB-CI-AH-PREMIUM-AMT
 17731                                    PB-CI-RATE-DEV-PCT-LF
 17732                                    PB-CI-RATE-DEV-PCT-AH
 17733                                    PB-CI-LIFE-COMMISSION
 17734                                    PB-CI-AH-COMMISSION
 17735                                    PB-CI-PAY-FREQUENCY
 17736                                    PB-CI-LOAN-APR
 17737                                    PB-CI-LOAN-TERM
 17738                                    PB-CI-CURR-SEQ
 17739                                    PB-CI-AH-CANCEL-AMT
 17740                                    PB-CI-LF-CANCEL-AMT
 17741                                    PB-CI-EXTENTION-DAYS
 17742                                    PB-CI-TERM-IN-DAYS
 17743                                    PB-CI-LOAN-OFFICER
 17744                                    PB-CI-LIVES
 17745                                    PB-CI-LF-CRIT-PER
 17746                                    PB-CI-AH-CRIT-PER
 17747                                    PB-C-LF-REM-TERM
 17748                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 322
* EL6311.cbl
 17749
 17750     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17751     MOVE 'A'                    TO JP-RECORD-TYPE.
 17752     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17753
 17754
 17755* EXEC CICS HANDLE CONDITION
 17756*        DUPREC   (2990-DUPLICATE-RECORD)
 17757*    END-EXEC.
 17758*    MOVE '"$%                   ! E #00015250' TO DFHEIV0
 17759     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17760     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17761     MOVE X'4520233030303135323530' TO DFHEIV0(25:11)
 17762     CALL 'kxdfhei1' USING DFHEIV0
 17763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17764
 17765
 17766
 17767* EXEC CICS WRITE
 17768*        DATASET  (FILE-ID-ERPNDB)
 17769*        FROM     (PENDING-BUSINESS)
 17770*        RIDFLD   (PB-CONTROL-PRIMARY)
 17771*    END-EXEC.
 17772     MOVE LENGTH OF
 17773      PENDING-BUSINESS
 17774       TO DFHEIV11
 17775*    MOVE '&$ L                  ''   #00015254' TO DFHEIV0
 17776     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17777     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17778     MOVE X'2020233030303135323534' TO DFHEIV0(25:11)
 17779     CALL 'kxdfhei1' USING DFHEIV0,
 17780           FILE-ID-ERPNDB,
 17781           PENDING-BUSINESS,
 17782           DFHEIV11,
 17783           PB-CONTROL-PRIMARY,
 17784           DFHEIV99,
 17785           DFHEIV99
 17786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17787
 17788
 17789     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17790
 17791     PERFORM 8400-LOG-JOURNAL-RECORD.
 17792
 17793     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17794
 17795 2985-RECORD-MISSING.
 17796     MOVE -1                     TO CMAINTL
 17797     MOVE AL-UABON               TO CMAINTA.
 17798
 17799     MOVE ER-2902                TO EMI-ERROR.
 17800     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17801     GO TO 8200-SEND-DATAONLY.
 17802
 17803 2990-DUPLICATE-RECORD.
 17804     MOVE SPACE                  TO CMAINTI.
 17805     MOVE -1                     TO CMAINTL.
 17806     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 323
* EL6311.cbl
 17807     MOVE AL-UNBON               TO CEFFDTA.
 17808
 17809     MOVE 1                      TO EMI-SUB
 17810                                    EMI-SWITCH1
 17811                                    EMI-SWITCH-AREA-1
 17812                                    EMI-SWITCH-AREA-2.
 17813     MOVE SPACES                 TO EMI-ERROR-LINES.
 17814
 17815
 17816* EXEC CICS SYNCPOINT ROLLBACK
 17817*    END-EXEC.
 17818*    MOVE '6"R                   !   #00015286' TO DFHEIV0
 17819     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17821     MOVE X'2020233030303135323836' TO DFHEIV0(25:11)
 17822     CALL 'kxdfhei1' USING DFHEIV0
 17823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17824
 17825
 17826     MOVE ER-2247                TO EMI-ERROR.
 17827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17828     GO TO 8200-SEND-DATAONLY.
 17829
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 324
* EL6311.cbl
 17831
 17832***************************************************************
 17833*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17834*     PREMIUM FOR A SINGLE BATCH.                             *
 17835*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17836***************************************************************
 17837
 17838 3000-BATCH-MAINLINE.
 17839     IF PI-PREV-KEY NOT = SPACES
 17840         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17841     ELSE
 17842         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17843
 17844     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17845
 17846 3010-READNEXT.
 17847
 17848* EXEC CICS READ
 17849*         DATASET    (FILE-ID-ERPNDB)
 17850*         SET        (ADDRESS OF PENDING-BUSINESS)
 17851*         RIDFLD     (ERPNDB-KEY)
 17852*         GTEQ
 17853*    END-EXEC.
 17854*    MOVE '&"S        G          (   #00015310' TO DFHEIV0
 17855     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17857     MOVE X'2020233030303135333130' TO DFHEIV0(25:11)
 17858     CALL 'kxdfhei1' USING DFHEIV0,
 17859           FILE-ID-ERPNDB,
 17860           DFHEIV20,
 17861           DFHEIV99,
 17862           ERPNDB-KEY,
 17863           DFHEIV99,
 17864           DFHEIV99,
 17865           DFHEIV99
 17866     SET ADDRESS OF PENDING-BUSINESS TO
 17867         DFHEIV20
 17868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17869
 17870
 17871     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17872        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17873          GO TO 3030-END-BATCH.
 17874
 17875     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17876
 17877     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17878        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17879          GO TO 3020-BUMP-SEQ.
 17880
 17881     IF PB-ISSUE
 17882        ADD +1                   TO WS-ISS-TOTAL-CNT
 17883        IF PB-FATAL-ERRORS
 17884           ADD +1                      TO WS-ISS-FATAL-CNT
 17885           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17886           GO TO 3020-BUMP-SEQ
 17887        ELSE
 17888           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 325
* EL6311.cbl
 17889              ADD +1                      TO WS-ISS-FORCE-CNT
 17890              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17891              GO TO 3020-BUMP-SEQ
 17892           ELSE
 17893              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17894                 ADD +1                      TO WS-ISS-HOLD-CNT
 17895                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17896                 GO TO 3020-BUMP-SEQ
 17897              ELSE
 17898                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17899                     THRU  3299-EXIT
 17900                 GO TO 3020-BUMP-SEQ.
 17901
 17902     IF PB-CANCELLATION
 17903        ADD +1                   TO WS-CAN-TOTAL-CNT
 17904        IF PB-FATAL-ERRORS
 17905           ADD +1                 TO WS-CAN-FATAL-CNT
 17906           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17907           GO TO 3020-BUMP-SEQ
 17908        ELSE
 17909           IF PB-UNFORCED-ERRORS
 17910              ADD +1                 TO WS-CAN-FORCE-CNT
 17911              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17912              GO TO 3020-BUMP-SEQ
 17913           ELSE
 17914              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17915                 ADD +1                 TO WS-CAN-HOLD-CNT
 17916                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17917                 GO TO 3020-BUMP-SEQ
 17918              ELSE
 17919                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17920                     THRU  3499-EXIT
 17921                 GO TO 3020-BUMP-SEQ.
 17922
 17923     IF PB-BATCH-TRAILER
 17924         GO TO 3030-END-BATCH.
 17925
 17926 3020-BUMP-SEQ.
 17927     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17928     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17929     GO TO 3010-READNEXT.
 17930
 17931 3030-END-BATCH.
 17932     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17933     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17934     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17935     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17936
 17937     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17938                                          - WS-ISS-FORCE-CNT
 17939                                          - WS-ISS-HOLD-CNT).
 17940
 17941     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17942     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17943
 17944     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17945     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17946     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 326
* EL6311.cbl
 17947     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17948     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17949                                          - WS-CAN-FORCE-CNT
 17950                                          - WS-CAN-HOLD-CNT).
 17951     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17952     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17953
 17954     COMPUTE WS-NET-TOTAL-CNT
 17955         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17956     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17957     COMPUTE WS-NET-FATAL-CNT
 17958         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17959     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17960     COMPUTE WS-NET-FORCE-CNT
 17961         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17962     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17963     COMPUTE WS-NET-HOLD-CNT
 17964         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17965     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17966
 17967     COMPUTE WS-NET-AVAIL-CNT
 17968          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17969                              - WS-ISS-FORCE-CNT
 17970                              - WS-ISS-HOLD-CNT)
 17971          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17972                              - WS-CAN-FORCE-CNT
 17973                              - WS-CAN-HOLD-CNT).
 17974     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17975
 17976     COMPUTE WS-NET-GOOD-PREM
 17977         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17978     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17979     COMPUTE WS-NET-BAD-PREM
 17980         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17981     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17982
 17983     MOVE 0000                   TO EMI-ERROR.
 17984     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17985     MOVE -1                     TO DPFENTRL.
 17986     GO TO 8200-SEND-DATAONLY.
 17987
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 327
* EL6311.cbl
 17989
 17990******************************************************************
 17991*                                                                *
 17992*           A D D    B A D   I S S U E   P R E M I U M           *
 17993*                                                                *
 17994******************************************************************
 17995
 17996 3100-ADD-BAD-ISSUE-PREM.
 17997     IF PB-OVERRIDE-LIFE
 17998       OR PB-OVERRIDE-BOTH
 17999           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18000           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18001       ELSE
 18002           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18003           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18004
 18005     IF PB-OVERRIDE-AH
 18006       OR PB-OVERRIDE-BOTH
 18007           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18008       ELSE
 18009           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18010
 18011 3199-EXIT.
 18012     EXIT.
 18013
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 328
* EL6311.cbl
 18015
 18016******************************************************************
 18017*                                                                *
 18018*       A D D   G O O D   I S S U E   P R E M I U M              *
 18019*                                                                *
 18020******************************************************************
 18021
 18022 3200-ADD-GOOD-ISSUE-PREM.
 18023     IF PB-OVERRIDE-LIFE
 18024       OR PB-OVERRIDE-BOTH
 18025           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18026           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18027       ELSE
 18028           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18029           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18030
 18031     IF PB-OVERRIDE-AH
 18032       OR PB-OVERRIDE-BOTH
 18033           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18034       ELSE
 18035           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18036
 18037 3299-EXIT.
 18038     EXIT.
 18039
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 329
* EL6311.cbl
 18041
 18042
 18043******************************************************************
 18044*                                                                *
 18045*        A D D   B A D   C A N C E L   P R E M I U M             *
 18046*                                                                *
 18047******************************************************************
 18048
 18049 3300-ADD-BAD-CANCEL-PREM.
 18050     IF PB-OVERRIDE-LIFE
 18051       OR PB-OVERRIDE-BOTH
 18052           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18053       ELSE
 18054           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18055
 18056     IF PB-OVERRIDE-AH
 18057       OR PB-OVERRIDE-BOTH
 18058           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18059       ELSE
 18060           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18061
 18062 3399-EXIT.
 18063     EXIT.
 18064
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 330
* EL6311.cbl
 18066
 18067******************************************************************
 18068*                                                                *
 18069*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18070*                                                                *
 18071******************************************************************
 18072
 18073 3400-ADD-GOOD-CANCEL-PREM.
 18074     IF PB-OVERRIDE-LIFE
 18075       OR PB-OVERRIDE-BOTH
 18076           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18077       ELSE
 18078           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18079
 18080     IF PB-OVERRIDE-AH
 18081       OR PB-OVERRIDE-BOTH
 18082           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18083       ELSE
 18084           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18085
 18086 3499-EXIT.
 18087     EXIT.
 18088
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 331
* EL6311.cbl
 18090
 18091******************************************************************
 18092*                                                                *
 18093*           E D I T   B A T C H   D A T A                        *
 18094*                                                                *
 18095******************************************************************
 18096
 18097 3500-EDIT-BATCH-DATA.
 18098     IF PI-PREV-KEY NOT = SPACES
 18099        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18100     ELSE
 18101        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18102
 18103     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18104     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18105
 18106
 18107* EXEC CICS HANDLE CONDITION
 18108*         NOTFND      (3590-NOT-FOUND)
 18109*    END-EXEC.
 18110*    MOVE '"$I                   ! F #00015552' TO DFHEIV0
 18111     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18113     MOVE X'4620233030303135353532' TO DFHEIV0(25:11)
 18114     CALL 'kxdfhei1' USING DFHEIV0
 18115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18116
 18117
 18118     IF DRISSL   GREATER THAN ZEROS OR
 18119        DRISSL   GREATER THAN ZEROS OR
 18120        DRLFPRML GREATER THAN ZEROS OR
 18121        DRAHPRML GREATER THAN ZEROS OR
 18122        DRCANCL  GREATER THAN ZEROS OR
 18123        DRLFRFDL GREATER THAN ZEROS OR
 18124        DRAHRFDL GREATER THAN ZEROS
 18125              NEXT SENTENCE
 18126          ELSE
 18127              MOVE ER-3224    TO EMI-ERROR
 18128              MOVE -1         TO DPFENTRL
 18129              MOVE AL-UNBON   TO DPFENTRA
 18130              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18131              GO TO 8200-SEND-DATAONLY.
 18132
 18133     IF NOT MODIFY-CAP
 18134         MOVE 'UPDATE'       TO SM-READ
 18135         PERFORM 9995-SECURITY-VIOLATION
 18136         MOVE ER-0070        TO EMI-ERROR
 18137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18138         GO TO 8100-SEND-INITIAL-MAP.
 18139
 18140        IF DRISSL GREATER THAN ZEROS
 18141           MOVE AL-UNNON         TO DRISSA
 18142           MOVE DRISSI           TO DEEDIT-FIELD
 18143           PERFORM 8600-DEEDIT
 18144           IF DEEDIT-FIELD-V0  NUMERIC
 18145              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18146           ELSE
 18147              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 332
* EL6311.cbl
 18148              MOVE -1         TO DRISSL
 18149              MOVE AL-UNBON   TO DRISSA
 18150              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18151
 18152        IF DRLFPRML GREATER THAN ZEROS
 18153           MOVE AL-UNNON         TO DRLFPRMA
 18154
 18155* EXEC CICS BIF DEEDIT
 18156*              FIELD  (DRLFPRMI)
 18157*              LENGTH (11)
 18158*          END-EXEC
 18159     MOVE 11
 18160       TO DFHEIV11
 18161*    MOVE '@"L                   #   #00015592' TO DFHEIV0
 18162     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18163     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18164     MOVE X'2020233030303135353932' TO DFHEIV0(25:11)
 18165     CALL 'kxdfhei1' USING DFHEIV0,
 18166           DRLFPRMI,
 18167           DFHEIV11
 18168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18169           IF DRLFPRMI NUMERIC
 18170              MOVE DRLFPRMI   TO WS-DRLFPRM
 18171*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18172*          PERFORM 8600-DEEDIT
 18173*          IF DEEDIT-FIELD-V2  NUMERIC
 18174*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18175           ELSE
 18176              MOVE ER-2223    TO EMI-ERROR
 18177              MOVE -1         TO DRLFPRML
 18178              MOVE AL-UNBON   TO DRLFPRMA
 18179              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18180
 18181        IF DRAHPRML GREATER THAN ZEROS
 18182           MOVE AL-UNNON         TO DRAHPRMA
 18183
 18184* EXEC CICS BIF DEEDIT
 18185*              FIELD  (DRAHPRMI)
 18186*              LENGTH (11)
 18187*          END-EXEC
 18188     MOVE 11
 18189       TO DFHEIV11
 18190*    MOVE '@"L                   #   #00015610' TO DFHEIV0
 18191     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18192     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18193     MOVE X'2020233030303135363130' TO DFHEIV0(25:11)
 18194     CALL 'kxdfhei1' USING DFHEIV0,
 18195           DRAHPRMI,
 18196           DFHEIV11
 18197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18198           IF DRAHPRMI NUMERIC
 18199              MOVE DRAHPRMI   TO WS-DRAHPRM
 18200*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18201*          PERFORM 8600-DEEDIT
 18202*          IF DEEDIT-FIELD-V2  NUMERIC
 18203*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18204           ELSE
 18205              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 333
* EL6311.cbl
 18206              MOVE -1         TO DRAHPRML
 18207              MOVE AL-UNBON   TO DRAHPRMA
 18208              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18209
 18210        IF DRCANCL GREATER THAN ZEROS
 18211           MOVE AL-UNNON         TO DRCANCA
 18212           MOVE DRCANCI          TO DEEDIT-FIELD
 18213           PERFORM 8600-DEEDIT
 18214           IF DEEDIT-FIELD-V0  NUMERIC
 18215              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18216           ELSE
 18217              MOVE ER-2223    TO EMI-ERROR
 18218              MOVE -1         TO DRCANCL
 18219              MOVE AL-UNBON   TO DRCANCL
 18220              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18221
 18222        IF DRLFRFDL GREATER THAN ZEROS
 18223           MOVE AL-UNNON         TO DRLFRFDA
 18224
 18225* EXEC CICS BIF DEEDIT
 18226*              FIELD  (DRLFRFDI)
 18227*              LENGTH (11)
 18228*          END-EXEC
 18229     MOVE 11
 18230       TO DFHEIV11
 18231*    MOVE '@"L                   #   #00015640' TO DFHEIV0
 18232     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18233     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18234     MOVE X'2020233030303135363430' TO DFHEIV0(25:11)
 18235     CALL 'kxdfhei1' USING DFHEIV0,
 18236           DRLFRFDI,
 18237           DFHEIV11
 18238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18239           IF DRLFRFDI NUMERIC
 18240              MOVE DRLFRFDI   TO WS-DRLFRFD
 18241*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18242*          PERFORM 8600-DEEDIT
 18243*          IF DEEDIT-FIELD-V2  NUMERIC
 18244*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18245           ELSE
 18246              MOVE ER-2223    TO EMI-ERROR
 18247              MOVE -1         TO DRLFRFDL
 18248              MOVE AL-UNBON   TO DRLFRFDA
 18249              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18250
 18251        IF DRAHRFDL GREATER THAN ZEROS
 18252           MOVE AL-UNNON         TO DRAHRFDA
 18253
 18254* EXEC CICS BIF DEEDIT
 18255*              FIELD  (DRAHRFDI)
 18256*              LENGTH (11)
 18257*          END-EXEC
 18258     MOVE 11
 18259       TO DFHEIV11
 18260*    MOVE '@"L                   #   #00015658' TO DFHEIV0
 18261     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18262     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18263     MOVE X'2020233030303135363538' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 334
* EL6311.cbl
 18264     CALL 'kxdfhei1' USING DFHEIV0,
 18265           DRAHRFDI,
 18266           DFHEIV11
 18267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18268           IF DRAHRFDI NUMERIC
 18269              MOVE DRAHRFDI   TO WS-DRAHRFD
 18270*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18271*          PERFORM 8600-DEEDIT
 18272*          IF DEEDIT-FIELD-V2  NUMERIC
 18273*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18274           ELSE
 18275              MOVE ER-2223    TO EMI-ERROR
 18276              MOVE -1         TO DRAHRFDL
 18277              MOVE AL-UNBON   TO DRAHRFDA
 18278              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18279
 18280     IF EMI-ERROR = ZEROS
 18281        GO 3600-UPDATE-BATCH-HEADER.
 18282
 18283     GO TO 8200-SEND-DATAONLY.
 18284
 18285 3590-NOT-FOUND.
 18286     MOVE ER-2192                TO EMI-ERROR.
 18287     MOVE -1                     TO DPFENTRL.
 18288     MOVE AL-UNBON               TO DPFENTRA.
 18289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18290     GO TO 8200-SEND-DATAONLY.
 18291
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 335
* EL6311.cbl
 18293
 18294******************************************************************
 18295*                                                                *
 18296*           U P D A T E   B A T C H   H E A D E R                *
 18297*                                                                *
 18298******************************************************************
 18299
 18300 3600-UPDATE-BATCH-HEADER.
 18301
 18302* EXEC CICS HANDLE CONDITION
 18303*         NOTFND      (3690-NOT-FOUND)
 18304*    END-EXEC.
 18305*    MOVE '"$I                   ! G #00015695' TO DFHEIV0
 18306     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18308     MOVE X'4720233030303135363935' TO DFHEIV0(25:11)
 18309     CALL 'kxdfhei1' USING DFHEIV0
 18310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18311
 18312
 18313
 18314* EXEC CICS READ
 18315*        DATASET (FILE-ID-ERPNDB)
 18316*        RIDFLD  (ERPNDB-KEY)
 18317*        SET     (ADDRESS OF PENDING-BUSINESS)
 18318*        UPDATE
 18319*    END-EXEC.
 18320*    MOVE '&"S        EU         (   #00015699' TO DFHEIV0
 18321     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18322     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18323     MOVE X'2020233030303135363939' TO DFHEIV0(25:11)
 18324     CALL 'kxdfhei1' USING DFHEIV0,
 18325           FILE-ID-ERPNDB,
 18326           DFHEIV20,
 18327           DFHEIV99,
 18328           ERPNDB-KEY,
 18329           DFHEIV99,
 18330           DFHEIV99,
 18331           DFHEIV99
 18332     SET ADDRESS OF PENDING-BUSINESS TO
 18333         DFHEIV20
 18334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18335
 18336
 18337     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18338     MOVE 'B'                    TO JP-RECORD-TYPE.
 18339     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18340
 18341     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18342
 18343     PERFORM 8400-LOG-JOURNAL-RECORD.
 18344
 18345     IF DRISSL GREATER THAN ZEROS
 18346        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18347
 18348     IF DRCANCL GREATER THAN ZEROS
 18349        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18350
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 336
* EL6311.cbl
 18351
 18352     IF DRLFPRML GREATER THAN ZEROS
 18353        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18354
 18355     IF DRAHPRML GREATER THAN ZEROS
 18356        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18357
 18358     IF DRLFRFDL GREATER THAN ZEROS
 18359        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18360
 18361     IF DRAHRFDL GREATER THAN ZEROS
 18362        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18363
 18364 3670-REWRITE-BATCH-HEADER.
 18365     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18366        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18367        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18368        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18369        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18370        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18371        MOVE SPACE               TO PB-OUT-BAL-CD
 18372     ELSE
 18373        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18374
 18375     MOVE 'C'                    TO JP-RECORD-TYPE.
 18376     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18377
 18378
 18379* EXEC CICS REWRITE
 18380*         DATASET      (FILE-ID-ERPNDB)
 18381*         FROM         (PENDING-BUSINESS)
 18382*    END-EXEC.
 18383     MOVE LENGTH OF
 18384      PENDING-BUSINESS
 18385       TO DFHEIV11
 18386*    MOVE '&& L                  %   #00015747' TO DFHEIV0
 18387     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18388     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18389     MOVE X'2020233030303135373437' TO DFHEIV0(25:11)
 18390     CALL 'kxdfhei1' USING DFHEIV0,
 18391           FILE-ID-ERPNDB,
 18392           PENDING-BUSINESS,
 18393           DFHEIV11,
 18394           DFHEIV99
 18395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18396
 18397
 18398     PERFORM 8400-LOG-JOURNAL-RECORD.
 18399
 18400     GO TO 7200-DISPLAY-BATCHES.
 18401
 18402 3690-NOT-FOUND.
 18403     MOVE ER-2192                TO EMI-ERROR.
 18404     MOVE -1                     TO DPFENTRL.
 18405     MOVE AL-UNBON               TO DPFENTRA.
 18406     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18407     GO TO 8200-SEND-DATAONLY.
 18408
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 337
* EL6311.cbl
 18410
 18411******************************************************************
 18412*                                                                *
 18413*           R E - D I S P L A Y   R E C O R D                    *
 18414*                                                                *
 18415******************************************************************
 18416
 18417 3900-RE-DISPLAY-RECORD.
 18418
 18419* EXEC CICS HANDLE CONDITION
 18420*         NOTFND   (3990-NOT-FOUND)
 18421*    END-EXEC.
 18422*    MOVE '"$I                   ! H #00015772' TO DFHEIV0
 18423     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18424     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18425     MOVE X'4820233030303135373732' TO DFHEIV0(25:11)
 18426     CALL 'kxdfhei1' USING DFHEIV0
 18427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18428
 18429
 18430     IF PI-DISPLAY-ORIGINAL-BATCH
 18431         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18432     ELSE
 18433         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18434
 18435
 18436* EXEC CICS READ
 18437*         DATASET   (FILE-ID)
 18438*         RIDFLD    (PI-PREV-KEY)
 18439*         SET       (ADDRESS OF PENDING-BUSINESS)
 18440*    END-EXEC.
 18441*    MOVE '&"S        E          (   #00015781' TO DFHEIV0
 18442     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18443     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18444     MOVE X'2020233030303135373831' TO DFHEIV0(25:11)
 18445     CALL 'kxdfhei1' USING DFHEIV0,
 18446           FILE-ID,
 18447           DFHEIV20,
 18448           DFHEIV99,
 18449           PI-PREV-KEY,
 18450           DFHEIV99,
 18451           DFHEIV99,
 18452           DFHEIV99
 18453     SET ADDRESS OF PENDING-BUSINESS TO
 18454         DFHEIV20
 18455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18456
 18457
 18458     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18459
 18460     IF PB-ISSUE
 18461         GO TO 7000-DISPLAY-ISSUES.
 18462
 18463     IF PB-CANCELLATION
 18464         GO TO 7100-DISPLAY-CANCELS.
 18465
 18466     IF PB-BATCH-TRAILER
 18467         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 338
* EL6311.cbl
 18468
 18469 3990-NOT-FOUND.
 18470     MOVE LOW-VALUES             TO EL631BI.
 18471
 18472     IF PI-MAP-NAME = EL631B
 18473         MOVE -1                  TO BMAINTL
 18474     ELSE
 18475         MOVE -1                  TO CMAINTL.
 18476
 18477     GO TO 8100-SEND-INITIAL-MAP.
 18478
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 339
* EL6311.cbl
 18480
 18481***************************************************************
 18482*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18483*                                                             *
 18484*      1. START BROWSE WITH                                   *
 18485*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18486*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18487*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18488*                                                             *
 18489*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18490*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18491*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18492*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18493*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18494*               AND IS IT TO BE DISPLAYED.                    *
 18495*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18496*               DISPLAYED.                                    *
 18497*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18498*               DISPLAYED.                                    *
 18499*                                                             *
 18500*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18501*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18502***************************************************************
 18503
 18504 4000-BROWSE-DETAIL-FORWARD.
 18505     IF FIRST-TIME
 18506        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18507     ELSE
 18508        IF SHOW-RECORD
 18509           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18510           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18511           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18512           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18513           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18514        ELSE
 18515           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18516
 18517
 18518* EXEC CICS HANDLE CONDITION
 18519*         NOTFND   (4050-END-RECORDS)
 18520*         ENDFILE  (4050-END-RECORDS)
 18521*    END-EXEC.
 18522*    MOVE '"$I''                  ! I #00015846' TO DFHEIV0
 18523     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18525     MOVE X'4920233030303135383436' TO DFHEIV0(25:11)
 18526     CALL 'kxdfhei1' USING DFHEIV0
 18527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18528
 18529
 18530
 18531* EXEC CICS STARTBR
 18532*         DATASET   (FILE-ID-ERPNDB2)
 18533*         RIDFLD    (ERPNDB-ALT-KEY)
 18534*    END-EXEC.
 18535     MOVE 0
 18536       TO DFHEIV11
 18537*    MOVE '&,         G          &   #00015851' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 340
* EL6311.cbl
 18538     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18540     MOVE X'2020233030303135383531' TO DFHEIV0(25:11)
 18541     CALL 'kxdfhei1' USING DFHEIV0,
 18542           FILE-ID-ERPNDB2,
 18543           ERPNDB-ALT-KEY,
 18544           DFHEIV99,
 18545           DFHEIV11,
 18546           DFHEIV99
 18547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18548
 18549
 18550     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18551
 18552     IF FIRST-TIME OR SHOW-RECORD
 18553        MOVE SPACE               TO WS-FIRST-TIME-SW
 18554        GO TO 4005-READ-NEXT-RECORD.
 18555
 18556
 18557* EXEC CICS READNEXT
 18558*         DATASET    (FILE-ID-ERPNDB2)
 18559*         SET        (ADDRESS OF PENDING-BUSINESS)
 18560*         RIDFLD     (ERPNDB-ALT-KEY)
 18561*    END-EXEC.
 18562     MOVE 0
 18563       TO DFHEIV11
 18564*    MOVE '&.S                   )   #00015862' TO DFHEIV0
 18565     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18566     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18567     MOVE X'2020233030303135383632' TO DFHEIV0(25:11)
 18568     CALL 'kxdfhei1' USING DFHEIV0,
 18569           FILE-ID-ERPNDB2,
 18570           DFHEIV20,
 18571           DFHEIV99,
 18572           ERPNDB-ALT-KEY,
 18573           DFHEIV99,
 18574           DFHEIV11,
 18575           DFHEIV99,
 18576           DFHEIV99
 18577     SET ADDRESS OF PENDING-BUSINESS TO
 18578         DFHEIV20
 18579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18580
 18581
 18582 4005-READ-NEXT-RECORD.
 18583
 18584* EXEC CICS READNEXT
 18585*         DATASET    (FILE-ID-ERPNDB2)
 18586*         SET        (ADDRESS OF PENDING-BUSINESS)
 18587*         RIDFLD     (ERPNDB-ALT-KEY)
 18588*    END-EXEC.
 18589     MOVE 0
 18590       TO DFHEIV11
 18591*    MOVE '&.S                   )   #00015869' TO DFHEIV0
 18592     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18593     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18594     MOVE X'2020233030303135383639' TO DFHEIV0(25:11)
 18595     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 341
* EL6311.cbl
 18596           FILE-ID-ERPNDB2,
 18597           DFHEIV20,
 18598           DFHEIV99,
 18599           ERPNDB-ALT-KEY,
 18600           DFHEIV99,
 18601           DFHEIV11,
 18602           DFHEIV99,
 18603           DFHEIV99
 18604     SET ADDRESS OF PENDING-BUSINESS TO
 18605         DFHEIV20
 18606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18607
 18608
 18609     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18610
 18611     IF WS-BATCH-PREFIX = '#CL'
 18612        GO TO 4005-READ-NEXT-RECORD.
 18613
 18614     IF SHOW-RECORD
 18615        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18616           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18617           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18618           PB-STATE         NOT = PI-PB-STATE          OR
 18619           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18620           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18621           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18622           GO TO 4050-END-RECORDS
 18623        ELSE
 18624           GO TO 4010-CHECK-REC-TYPE.
 18625
 18626     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18627        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18628        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18629        PB-STATE            NOT = PI-PB-STATE          OR
 18630        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18631        GO TO 4050-END-RECORDS.
 18632
 18633     IF PB-BATCH-TRAILER
 18634        GO TO 4005-READ-NEXT-RECORD.
 18635
 18636     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18637        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18638           GO TO 4005-READ-NEXT-RECORD
 18639        ELSE
 18640           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18641              GO TO 4010-CHECK-REC-TYPE
 18642           ELSE
 18643              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18644                 GO TO 4010-CHECK-REC-TYPE
 18645              ELSE
 18646                 GO TO 4005-READ-NEXT-RECORD.
 18647
 18648     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18649        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18650           GO TO 4005-READ-NEXT-RECORD.
 18651
 18652 4010-CHECK-REC-TYPE.
 18653     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 342
* EL6311.cbl
 18654         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18655             NEXT SENTENCE
 18656         ELSE
 18657             GO TO 4005-READ-NEXT-RECORD.
 18658
 18659     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18660         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18661             NEXT SENTENCE
 18662        ELSE
 18663             GO TO 4005-READ-NEXT-RECORD.
 18664
 18665     IF NOT DISPLAY-CHANGE-RECORDS AND
 18666            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18667        GO TO 4005-READ-NEXT-RECORD.
 18668
 18669     IF DISPLAY-HOLD-RECORDS AND
 18670        NOT PB-RECORD-ON-HOLD
 18671          GO TO 4005-READ-NEXT-RECORD.
 18672
 18673     IF PB-ISSUE
 18674        IF DISPLAY-CHK-REQ-RECORDS
 18675            GO TO 4005-READ-NEXT-RECORD.
 18676
 18677     IF PB-ISSUE
 18678        IF ISSUE-WITH-WARNING
 18679           IF PB-WARNING-ERRORS
 18680              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18681                  GO TO 4005-READ-NEXT-RECORD
 18682              ELSE
 18683                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18684                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18685                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18686                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18687                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18688                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18689                 GO TO 7000-DISPLAY-ISSUES
 18690           ELSE
 18691              GO TO 4005-READ-NEXT-RECORD.
 18692
 18693     IF PB-ISSUE
 18694        IF (ISSUES-IN-ERROR AND
 18695            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18696            ALL-ISSUES
 18697            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18698            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18699            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18700            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18701            MOVE PB-SV-STATE            TO PI-SV-STATE
 18702            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18703            GO TO 7000-DISPLAY-ISSUES
 18704        ELSE
 18705            GO TO 4005-READ-NEXT-RECORD.
 18706
 18707     IF PB-CANCELLATION
 18708        IF DISPLAY-CHK-REQ-RECORDS
 18709           IF PB-C-REFUND-REQUESTED
 18710              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18711              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 343
* EL6311.cbl
 18712              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18713              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18714              MOVE PB-SV-STATE            TO PI-SV-STATE
 18715              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18716              GO TO 7100-DISPLAY-CANCELS
 18717           ELSE
 18718               GO TO 4005-READ-NEXT-RECORD.
 18719
 18720     IF PB-CANCELLATION
 18721        IF CANCEL-WITH-WARNING
 18722           IF PB-WARNING-ERRORS
 18723              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18724                  GO TO 4005-READ-NEXT-RECORD
 18725              ELSE
 18726                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18727                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18728                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18729                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18730                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18731                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18732                 GO TO 7100-DISPLAY-CANCELS
 18733           ELSE
 18734              GO TO 4005-READ-NEXT-RECORD.
 18735
 18736     IF PB-CANCELLATION
 18737        IF (CANCEL-IN-ERROR  AND
 18738            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18739            ALL-CANCELS
 18740            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18741            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18742            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18743            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18744            MOVE PB-SV-STATE            TO PI-SV-STATE
 18745            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18746            GO TO 7100-DISPLAY-CANCELS.
 18747
 18748     GO TO 4005-READ-NEXT-RECORD.
 18749
 18750 4050-END-RECORDS.
 18751******************************************************************
 18752*                                                                *
 18753*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18754*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18755*         PROGRAM.                                               *
 18756*                                                                *
 18757******************************************************************
 18758
 18759     IF BROWSE-STARTED
 18760        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18761
 18762* EXEC CICS ENDBR
 18763*            DATASET  (FILE-ID-ERPNDB2)
 18764*       END-EXEC.
 18765     MOVE 0
 18766       TO DFHEIV11
 18767*    MOVE '&2                    $   #00016027' TO DFHEIV0
 18768     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18769     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 344
* EL6311.cbl
 18770     MOVE X'2020233030303136303237' TO DFHEIV0(25:11)
 18771     CALL 'kxdfhei1' USING DFHEIV0,
 18772           FILE-ID-ERPNDB2,
 18773           DFHEIV11,
 18774           DFHEIV99
 18775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18776
 18777
 18778     IF  EIBTRNID NOT = TRANS-EXB1
 18779         IF PENDING-BUS-RECS-FOUND
 18780             NEXT SENTENCE
 18781           ELSE
 18782             MOVE '9'            TO PI-BROWSE-SW
 18783             GO TO 9400-CLEAR.
 18784
 18785     IF SHOW-RECORD
 18786        MOVE ER-2253            TO EMI-ERROR
 18787       ELSE
 18788        MOVE ER-2254            TO EMI-ERROR.
 18789
 18790     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18791
 18792     IF PI-MAP-NAME = SPACES
 18793        MOVE -1                  TO DPFENTRL
 18794        MOVE EL631D               TO PI-MAP-NAME
 18795        GO TO 8100-SEND-INITIAL-MAP.
 18796
 18797     IF PI-MAP-NAME = EL631B
 18798        MOVE -1                  TO BMAINTL
 18799     ELSE
 18800        IF PI-MAP-NAME = EL631C
 18801           MOVE -1               TO CMAINTL
 18802        ELSE
 18803           MOVE -1               TO DPFENTRL.
 18804
 18805     GO TO 8200-SEND-DATAONLY.
 18806
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 345
* EL6311.cbl
 18808
 18809***************************************************************
 18810*                                                             *
 18811*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18812*                                                             *
 18813*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18814*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18815*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18816*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18817*                                                             *
 18818*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18819*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18820*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18821*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18822*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18823*                AND IS IT TO BE DISPLAYED.                   *
 18824*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18825*                DISPLAYED.                                   *
 18826*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18827*                DISPLAYED.                                   *
 18828*                                                             *
 18829*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18830*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18831*                                                             *
 18832*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18833*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18834*                THEY ARE NOT TO BE DISPLAYED.                *
 18835*                                                             *
 18836***************************************************************
 18837
 18838 4100-BROWSE-PRIMARY-FORWARD.
 18839     IF FIRST-TIME  OR SHOW-RECORD
 18840        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18841        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18842        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18843     ELSE
 18844        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18845        IF ERPNDB-BATCH-SEQ-NO = +9999
 18846           GO TO 4150-END-BATCH
 18847        ELSE
 18848           IF DISPLAY-CHANGE-RECORDS
 18849              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18850           ELSE
 18851              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18852              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18853
 18854     IF FIRST-TIME
 18855         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18856            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18857              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18858
 18859
 18860* EXEC CICS HANDLE CONDITION
 18861*         ENDFILE  (4150-END-BATCH)
 18862*    END-EXEC.
 18863*    MOVE '"$''                   ! J #00016112' TO DFHEIV0
 18864     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 346
* EL6311.cbl
 18866     MOVE X'4A20233030303136313132' TO DFHEIV0(25:11)
 18867     CALL 'kxdfhei1' USING DFHEIV0
 18868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18869
 18870
 18871 4105-READ-NEXT.
 18872
 18873* EXEC CICS HANDLE CONDITION
 18874*         NOTFND    (4150-END-BATCH)
 18875*    END-EXEC.
 18876*    MOVE '"$I                   ! K #00016117' TO DFHEIV0
 18877     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18879     MOVE X'4B20233030303136313137' TO DFHEIV0(25:11)
 18880     CALL 'kxdfhei1' USING DFHEIV0
 18881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18882
 18883
 18884     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18885
 18886     IF PI-DISPLAY-ORIGINAL-BATCH
 18887        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18888     ELSE
 18889        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18890
 18891
 18892* EXEC CICS READ
 18893*         DATASET   (FILE-ID)
 18894*         SET       (ADDRESS OF PENDING-BUSINESS)
 18895*         RIDFLD    (ERPNDB-KEY)
 18896*         GTEQ
 18897*    END-EXEC.
 18898*    MOVE '&"S        G          (   #00016128' TO DFHEIV0
 18899     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18901     MOVE X'2020233030303136313238' TO DFHEIV0(25:11)
 18902     CALL 'kxdfhei1' USING DFHEIV0,
 18903           FILE-ID,
 18904           DFHEIV20,
 18905           DFHEIV99,
 18906           ERPNDB-KEY,
 18907           DFHEIV99,
 18908           DFHEIV99,
 18909           DFHEIV99
 18910     SET ADDRESS OF PENDING-BUSINESS TO
 18911         DFHEIV20
 18912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18913
 18914
 18915     IF PI-DISPLAY-ORIGINAL-BATCH
 18916        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18917           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18918           GO TO 4150-END-BATCH
 18919        ELSE
 18920           IF PB-BATCH-TRAILER
 18921              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18922              GO TO 4105-READ-NEXT
 18923           ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 347
* EL6311.cbl
 18924              NEXT SENTENCE
 18925     ELSE
 18926        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18927           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18928           GO TO 4150-END-BATCH.
 18929
 18930     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18931
 18932     IF WS-BATCH-PREFIX = '#CL'
 18933         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18934         GO TO 4105-READ-NEXT.
 18935
 18936     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18937     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18938     MOVE PB-STATE               TO PI-PB-STATE.
 18939     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18940
 18941     IF PB-BATCH-TRAILER
 18942        IF SHOW-RECORD
 18943           GO TO 4150-END-BATCH
 18944        ELSE
 18945           MOVE ER-2251         TO EMI-ERROR
 18946           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18947           MOVE 1               TO PI-BROWSE-TYPE
 18948           GO TO 7200-DISPLAY-BATCHES.
 18949
 18950     IF SHOW-RECORD
 18951           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18952              GO TO 4110-BUMP-SEQ
 18953           ELSE
 18954              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18955                 GO TO 4110-BUMP-SEQ
 18956              ELSE
 18957                 GO TO 4107-CHECK-REC-TYPE.
 18958
 18959     IF NOT  PI-PRIMARY-WITH-SELECT
 18960        GO TO 4107-CHECK-REC-TYPE.
 18961
 18962     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18963        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18964           GO TO 4110-BUMP-SEQ
 18965        ELSE
 18966           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18967              GO TO 4107-CHECK-REC-TYPE
 18968           ELSE
 18969              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18970                 GO TO 4107-CHECK-REC-TYPE
 18971              ELSE
 18972                 GO TO 4110-BUMP-SEQ.
 18973
 18974     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18975        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18976           GO TO 4110-BUMP-SEQ.
 18977
 18978 4107-CHECK-REC-TYPE.
 18979     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18980         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18981             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 348
* EL6311.cbl
 18982           ELSE
 18983             GO TO 4110-BUMP-SEQ.
 18984
 18985     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18986         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18987             NEXT SENTENCE
 18988           ELSE
 18989             GO TO 4110-BUMP-SEQ.
 18990
 18991     IF NOT DISPLAY-CHANGE-RECORDS AND
 18992        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18993           GO TO 4110-BUMP-SEQ.
 18994
 18995     IF DISPLAY-HOLD-RECORDS AND
 18996        NOT PB-RECORD-ON-HOLD
 18997          GO TO 4110-BUMP-SEQ.
 18998
 18999     IF PB-ISSUE
 19000        IF DISPLAY-CHK-REQ-RECORDS
 19001            GO TO 4110-BUMP-SEQ.
 19002
 19003     IF PB-ISSUE
 19004        IF ISSUE-WITH-WARNING
 19005           IF PB-WARNING-ERRORS
 19006              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19007                  GO TO 4110-BUMP-SEQ
 19008              ELSE
 19009                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19010                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19011                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19012                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19013                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19014                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19015                 GO TO 7000-DISPLAY-ISSUES
 19016        ELSE
 19017            GO TO 4110-BUMP-SEQ.
 19018
 19019     IF PB-ISSUE
 19020        IF (ISSUES-IN-ERROR AND
 19021            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19022            ALL-ISSUES
 19023            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19024            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19025            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19026            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19027            MOVE PB-SV-STATE            TO PI-SV-STATE
 19028            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19029            GO TO 7000-DISPLAY-ISSUES
 19030        ELSE
 19031            GO TO 4110-BUMP-SEQ.
 19032
 19033     IF PB-CANCELLATION
 19034        IF DISPLAY-CHK-REQ-RECORDS
 19035           IF PB-C-REFUND-REQUESTED
 19036              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19037              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19038              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19039              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 349
* EL6311.cbl
 19040              MOVE PB-SV-STATE            TO PI-SV-STATE
 19041              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19042              GO TO 7100-DISPLAY-CANCELS
 19043           ELSE
 19044              GO TO 4110-BUMP-SEQ.
 19045
 19046     IF PB-CANCELLATION
 19047        IF CANCEL-WITH-WARNING
 19048           IF PB-WARNING-ERRORS
 19049              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19050                  GO TO 4110-BUMP-SEQ
 19051              ELSE
 19052                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19053                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19054                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19055                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19056                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19057                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19058                 GO TO 7100-DISPLAY-CANCELS
 19059           ELSE
 19060              GO TO 4110-BUMP-SEQ.
 19061
 19062     IF PB-CANCELLATION
 19063        IF (CANCEL-IN-ERROR  AND
 19064            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19065            ALL-CANCELS
 19066            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19067            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19068            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19069            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19070            MOVE PB-SV-STATE            TO PI-SV-STATE
 19071            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19072            GO TO 7100-DISPLAY-CANCELS.
 19073
 19074 4110-BUMP-SEQ.
 19075     IF NOT DISPLAY-CHANGE-RECORDS
 19076        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19077        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19078     ELSE
 19079        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19080           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19081           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19082        ELSE
 19083           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19084           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19085
 19086     GO TO 4105-READ-NEXT.
 19087
 19088 4150-END-BATCH.
 19089******************************************************************
 19090*                                                                *
 19091*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19092*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19093*         PROGRAM.                                               *
 19094*                                                                *
 19095******************************************************************
 19096
 19097     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 350
* EL6311.cbl
 19098         IF PENDING-BUS-RECS-FOUND
 19099             NEXT SENTENCE
 19100           ELSE
 19101             MOVE '9'            TO PI-BROWSE-SW
 19102             GO TO 9400-CLEAR.
 19103
 19104     IF SHOW-RECORD
 19105        MOVE ER-2253             TO EMI-ERROR
 19106     ELSE
 19107        MOVE ER-2251             TO EMI-ERROR.
 19108
 19109     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19110
 19111     IF PI-MAP-NAME = SPACES
 19112        MOVE -1                  TO BMAINTL
 19113        MOVE EL631B              TO PI-MAP-NAME
 19114        GO TO 8100-SEND-INITIAL-MAP.
 19115
 19116     IF PI-MAP-NAME = EL631B
 19117        MOVE -1                  TO BMAINTL
 19118     ELSE
 19119        IF PI-MAP-NAME = EL631C
 19120           MOVE -1               TO CMAINTL
 19121        ELSE
 19122           MOVE -1               TO DPFENTRL.
 19123
 19124     GO TO 8200-SEND-DATAONLY.
 19125
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 351
* EL6311.cbl
 19127
 19128***************************************************************
 19129*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19130*                                                             *
 19131*      1. START BROWSE WITH                                   *
 19132*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19133*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19134*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19135*                                                             *
 19136*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19137*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19138*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19139*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19140*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19141*               AND IS IT TO BE DISPLAYED.                    *
 19142*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19143*               DISPLAYED.                                    *
 19144*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19145*               DISPLAYED.                                    *
 19146*                                                             *
 19147*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19148*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19149***************************************************************
 19150
 19151 4200-BROWSE-CSR-FORWARD.
 19152
 19153     IF FIRST-TIME
 19154        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19155     ELSE
 19156        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19157
 19158
 19159* EXEC CICS HANDLE CONDITION
 19160*         NOTFND   (4250-END-RECORDS)
 19161*         ENDFILE  (4250-END-RECORDS)
 19162*    END-EXEC.
 19163*    MOVE '"$I''                  ! L #00016378' TO DFHEIV0
 19164     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19166     MOVE X'4C20233030303136333738' TO DFHEIV0(25:11)
 19167     CALL 'kxdfhei1' USING DFHEIV0
 19168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19169
 19170
 19171
 19172* EXEC CICS STARTBR
 19173*         DATASET   (FILE-ID-ERPNDB4)
 19174*         RIDFLD    (ERPNDB-CSR-KEY)
 19175*    END-EXEC.
 19176     MOVE 0
 19177       TO DFHEIV11
 19178*    MOVE '&,         G          &   #00016383' TO DFHEIV0
 19179     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19180     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19181     MOVE X'2020233030303136333833' TO DFHEIV0(25:11)
 19182     CALL 'kxdfhei1' USING DFHEIV0,
 19183           FILE-ID-ERPNDB4,
 19184           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 352
* EL6311.cbl
 19185           DFHEIV99,
 19186           DFHEIV11,
 19187           DFHEIV99
 19188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19189
 19190
 19191     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19192
 19193     IF FIRST-TIME
 19194        MOVE SPACE               TO WS-FIRST-TIME-SW
 19195        GO TO 4205-READ-NEXT-RECORD.
 19196
 19197
 19198* EXEC CICS READNEXT
 19199*         DATASET    (FILE-ID-ERPNDB4)
 19200*         SET        (ADDRESS OF PENDING-BUSINESS)
 19201*         RIDFLD     (ERPNDB-CSR-KEY)
 19202*    END-EXEC.
 19203     MOVE 0
 19204       TO DFHEIV11
 19205*    MOVE '&.S                   )   #00016394' TO DFHEIV0
 19206     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19207     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19208     MOVE X'2020233030303136333934' TO DFHEIV0(25:11)
 19209     CALL 'kxdfhei1' USING DFHEIV0,
 19210           FILE-ID-ERPNDB4,
 19211           DFHEIV20,
 19212           DFHEIV99,
 19213           ERPNDB-CSR-KEY,
 19214           DFHEIV99,
 19215           DFHEIV11,
 19216           DFHEIV99,
 19217           DFHEIV99
 19218     SET ADDRESS OF PENDING-BUSINESS TO
 19219         DFHEIV20
 19220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19221
 19222
 19223 4205-READ-NEXT-RECORD.
 19224
 19225
 19226* EXEC CICS READNEXT
 19227*         DATASET    (FILE-ID-ERPNDB4)
 19228*         SET        (ADDRESS OF PENDING-BUSINESS)
 19229*         RIDFLD     (ERPNDB-CSR-KEY)
 19230*    END-EXEC.
 19231     MOVE 0
 19232       TO DFHEIV11
 19233*    MOVE '&.S                   )   #00016402' TO DFHEIV0
 19234     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19235     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19236     MOVE X'2020233030303136343032' TO DFHEIV0(25:11)
 19237     CALL 'kxdfhei1' USING DFHEIV0,
 19238           FILE-ID-ERPNDB4,
 19239           DFHEIV20,
 19240           DFHEIV99,
 19241           ERPNDB-CSR-KEY,
 19242           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 353
* EL6311.cbl
 19243           DFHEIV11,
 19244           DFHEIV99,
 19245           DFHEIV99
 19246     SET ADDRESS OF PENDING-BUSINESS TO
 19247         DFHEIV20
 19248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19249
 19250
 19251     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19252
 19253     IF WS-BATCH-PREFIX = '#CL'
 19254        GO TO 4205-READ-NEXT-RECORD.
 19255
 19256     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19257        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19258        GO TO 4250-END-RECORDS.
 19259
 19260     IF PB-BATCH-TRAILER
 19261        GO TO 4205-READ-NEXT-RECORD.
 19262
 19263     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19264        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19265           GO TO 4205-READ-NEXT-RECORD
 19266        ELSE
 19267           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19268              GO TO 4210-CHECK-REC-TYPE
 19269           ELSE
 19270              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19271                 GO TO 4210-CHECK-REC-TYPE
 19272              ELSE
 19273                 GO TO 4205-READ-NEXT-RECORD.
 19274
 19275     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19276        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19277           GO TO 4205-READ-NEXT-RECORD.
 19278
 19279 4210-CHECK-REC-TYPE.
 19280     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19281         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19282             NEXT SENTENCE
 19283         ELSE
 19284             GO TO 4205-READ-NEXT-RECORD.
 19285
 19286     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19287         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19288             NEXT SENTENCE
 19289        ELSE
 19290             GO TO 4205-READ-NEXT-RECORD.
 19291
 19292     IF NOT DISPLAY-CHANGE-RECORDS AND
 19293            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19294        GO TO 4205-READ-NEXT-RECORD.
 19295
 19296     IF DISPLAY-HOLD-RECORDS AND
 19297        NOT PB-RECORD-ON-HOLD
 19298          GO TO 4205-READ-NEXT-RECORD.
 19299
 19300     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 354
* EL6311.cbl
 19301        IF DISPLAY-CHK-REQ-RECORDS
 19302            GO TO 4205-READ-NEXT-RECORD.
 19303
 19304     IF PB-ISSUE
 19305        IF ISSUE-WITH-WARNING
 19306           IF PB-WARNING-ERRORS
 19307              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19308                  GO TO 4205-READ-NEXT-RECORD
 19309              ELSE
 19310                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19311                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19312                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19313                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19314                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19315                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19316                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19317                 GO TO 7000-DISPLAY-ISSUES
 19318           ELSE
 19319              GO TO 4205-READ-NEXT-RECORD.
 19320
 19321     IF PB-ISSUE
 19322        IF (ISSUES-IN-ERROR AND
 19323            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19324            ALL-ISSUES
 19325            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19326            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19327            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19328            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19329            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19330            MOVE PB-SV-STATE            TO PI-SV-STATE
 19331            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19332            GO TO 7000-DISPLAY-ISSUES
 19333        ELSE
 19334            GO TO 4205-READ-NEXT-RECORD.
 19335
 19336     IF PB-CANCELLATION
 19337        IF DISPLAY-CHK-REQ-RECORDS
 19338           IF PB-C-REFUND-REQUESTED
 19339              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19340              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19341              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19342              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19343              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19344              MOVE PB-SV-STATE            TO PI-SV-STATE
 19345              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19346              GO TO 7100-DISPLAY-CANCELS
 19347           ELSE
 19348               GO TO 4205-READ-NEXT-RECORD.
 19349
 19350     IF PB-CANCELLATION
 19351        IF CANCEL-WITH-WARNING
 19352           IF PB-WARNING-ERRORS
 19353              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19354                  GO TO 4205-READ-NEXT-RECORD
 19355              ELSE
 19356                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19357                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19358                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 355
* EL6311.cbl
 19359                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19360                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19361                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19362                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19363                 GO TO 7100-DISPLAY-CANCELS
 19364           ELSE
 19365              GO TO 4205-READ-NEXT-RECORD.
 19366
 19367     IF PB-CANCELLATION
 19368        IF (CANCEL-IN-ERROR  AND
 19369            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19370            ALL-CANCELS
 19371            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19372            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19373            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19374            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19375            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19376            MOVE PB-SV-STATE            TO PI-SV-STATE
 19377            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19378            GO TO 7100-DISPLAY-CANCELS.
 19379
 19380     GO TO 4205-READ-NEXT-RECORD.
 19381
 19382 4250-END-RECORDS.
 19383******************************************************************
 19384*                                                                *
 19385*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19386*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19387*         PROGRAM.                                               *
 19388*                                                                *
 19389******************************************************************
 19390
 19391     IF BROWSE-STARTED
 19392        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19393
 19394* EXEC CICS ENDBR
 19395*            DATASET  (FILE-ID-ERPNDB4)
 19396*       END-EXEC.
 19397     MOVE 0
 19398       TO DFHEIV11
 19399*    MOVE '&2                    $   #00016550' TO DFHEIV0
 19400     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19401     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19402     MOVE X'2020233030303136353530' TO DFHEIV0(25:11)
 19403     CALL 'kxdfhei1' USING DFHEIV0,
 19404           FILE-ID-ERPNDB4,
 19405           DFHEIV11,
 19406           DFHEIV99
 19407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19408
 19409
 19410     IF  EIBTRNID NOT = TRANS-EXB1
 19411         IF PENDING-BUS-RECS-FOUND
 19412             NEXT SENTENCE
 19413           ELSE
 19414             MOVE '9'            TO PI-BROWSE-SW
 19415             GO TO 9400-CLEAR.
 19416
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 356
* EL6311.cbl
 19417     IF SHOW-RECORD
 19418        MOVE ER-2253            TO EMI-ERROR
 19419       ELSE
 19420        MOVE ER-2254            TO EMI-ERROR.
 19421
 19422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19423
 19424     IF PI-MAP-NAME = SPACES
 19425        MOVE -1                  TO DPFENTRL
 19426        MOVE EL631D               TO PI-MAP-NAME
 19427        GO TO 8100-SEND-INITIAL-MAP.
 19428
 19429     IF PI-MAP-NAME = EL631B
 19430        MOVE -1                  TO BMAINTL
 19431     ELSE
 19432        IF PI-MAP-NAME = EL631C
 19433           MOVE -1               TO CMAINTL
 19434        ELSE
 19435           MOVE -1               TO DPFENTRL.
 19436
 19437     GO TO 8200-SEND-DATAONLY.
 19438
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 357
* EL6311.cbl
 19440
 19441***************************************************************
 19442*                                                             *
 19443*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19444*                                                             *
 19445*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19446*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19447*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19448*                                                             *
 19449*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19450*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19451*          A. IS IT WITHIN THE SAME COMPANY                   *
 19452*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19453*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19454*                AND IS IT TO BE DISPLAYED.                   *
 19455*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19456*                DISPLAYED.                                   *
 19457*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19458*                DISPLAYED.                                   *
 19459*                                                             *
 19460*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19461*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19462*                                                             *
 19463*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19464*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19465*                THEY ARE NOT TO BE DISPLAYED.                *
 19466*                                                             *
 19467***************************************************************
 19468
 19469 4300-BROWSE-FILE-FORWARD.
 19470     IF FIRST-TIME OR SHOW-RECORD
 19471        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19472        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19473        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19474     ELSE
 19475        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19476        IF ERPNDB-BATCH-SEQ-NO = +9999
 19477           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19478        ELSE
 19479           IF DISPLAY-CHANGE-RECORDS
 19480              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19481           ELSE
 19482              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19483              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19484
 19485
 19486* EXEC CICS HANDLE CONDITION
 19487*         ENDFILE  (4350-END-BATCH)
 19488*         NOTFND   (4350-END-BATCH)
 19489*    END-EXEC.
 19490*    MOVE '"$''I                  ! M #00016629' TO DFHEIV0
 19491     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19493     MOVE X'4D20233030303136363239' TO DFHEIV0(25:11)
 19494     CALL 'kxdfhei1' USING DFHEIV0
 19495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19496
 19497
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 358
* EL6311.cbl
 19498 4305-READ-NEXT.
 19499     IF PI-DISPLAY-ORIGINAL-BATCH
 19500        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19501     ELSE
 19502        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19503
 19504
 19505* EXEC CICS READ
 19506*         DATASET   (FILE-ID)
 19507*         SET       (ADDRESS OF PENDING-BUSINESS)
 19508*         RIDFLD    (ERPNDB-KEY)
 19509*         GTEQ
 19510*    END-EXEC.
 19511*    MOVE '&"S        G          (   #00016640' TO DFHEIV0
 19512     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19514     MOVE X'2020233030303136363430' TO DFHEIV0(25:11)
 19515     CALL 'kxdfhei1' USING DFHEIV0,
 19516           FILE-ID,
 19517           DFHEIV20,
 19518           DFHEIV99,
 19519           ERPNDB-KEY,
 19520           DFHEIV99,
 19521           DFHEIV99,
 19522           DFHEIV99
 19523     SET ADDRESS OF PENDING-BUSINESS TO
 19524         DFHEIV20
 19525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19526
 19527
 19528     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19529        GO TO 4350-END-BATCH.
 19530
 19531     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19532                                    WS-BATCH-NO.
 19533
 19534     IF  WS-BATCH-PREFIX = '#CL'
 19535         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19536         GO TO 4305-READ-NEXT.
 19537
 19538     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19539     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19540     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19541     MOVE PB-STATE               TO PI-PB-STATE.
 19542     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19543
 19544     IF PB-BATCH-TRAILER
 19545        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19546        GO TO 4305-READ-NEXT.
 19547
 19548     IF SHOW-RECORD
 19549           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19550              GO TO 4310-BUMP-SEQ
 19551           ELSE
 19552              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19553                 GO TO 4310-BUMP-SEQ
 19554              ELSE
 19555                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 359
* EL6311.cbl
 19556
 19557     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19558        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19559           GO TO 4310-BUMP-SEQ
 19560        ELSE
 19561           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19562              GO TO 4307-CHECK-REC-TYPE
 19563           ELSE
 19564              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19565                 GO TO 4307-CHECK-REC-TYPE
 19566              ELSE
 19567                 GO TO 4310-BUMP-SEQ.
 19568
 19569     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19570        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19571           GO TO 4310-BUMP-SEQ.
 19572
 19573 4307-CHECK-REC-TYPE.
 19574     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19575         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19576             NEXT SENTENCE
 19577         ELSE
 19578             GO TO 4310-BUMP-SEQ.
 19579
 19580     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19581         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19582             NEXT SENTENCE
 19583        ELSE
 19584             GO TO 4310-BUMP-SEQ.
 19585
 19586     IF NOT DISPLAY-CHANGE-RECORDS AND
 19587            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19588        GO TO 4310-BUMP-SEQ.
 19589
 19590     IF DISPLAY-HOLD-RECORDS AND
 19591        NOT PB-RECORD-ON-HOLD
 19592          GO TO 4310-BUMP-SEQ.
 19593
 19594     IF PB-ISSUE
 19595        IF DISPLAY-CHK-REQ-RECORDS
 19596           GO TO 4310-BUMP-SEQ.
 19597
 19598     IF PB-ISSUE
 19599        IF ISSUE-WITH-WARNING
 19600           IF PB-WARNING-ERRORS
 19601              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19602                  GO TO 4310-BUMP-SEQ
 19603              ELSE
 19604                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19605                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19606                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19607                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19608                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19609                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19610                 GO TO 7000-DISPLAY-ISSUES
 19611           ELSE
 19612              GO TO 4310-BUMP-SEQ.
 19613
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 360
* EL6311.cbl
 19614     IF PB-ISSUE
 19615        IF (ISSUES-IN-ERROR AND
 19616            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19617            ALL-ISSUES
 19618            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19619            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19620            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19621            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19622            MOVE PB-SV-STATE            TO PI-SV-STATE
 19623            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19624            GO TO 7000-DISPLAY-ISSUES
 19625        ELSE
 19626            GO TO 4310-BUMP-SEQ.
 19627
 19628     IF PB-CANCELLATION
 19629        IF DISPLAY-CHK-REQ-RECORDS
 19630           IF PB-C-REFUND-REQUESTED
 19631              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19632              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19633              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19634              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19635              MOVE PB-SV-STATE            TO PI-SV-STATE
 19636              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19637              GO TO 7100-DISPLAY-CANCELS
 19638           ELSE
 19639              GO TO 4310-BUMP-SEQ.
 19640
 19641     IF PB-CANCELLATION
 19642        IF CANCEL-WITH-WARNING
 19643           IF PB-WARNING-ERRORS
 19644              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19645                  GO TO 4310-BUMP-SEQ
 19646              ELSE
 19647                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19648                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19649                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19650                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19651                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19652                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19653                 GO TO 7100-DISPLAY-CANCELS
 19654           ELSE
 19655              GO TO 4310-BUMP-SEQ.
 19656
 19657     IF PB-CANCELLATION
 19658        IF (CANCEL-IN-ERROR  AND
 19659            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19660            ALL-CANCELS
 19661            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19662            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19663            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19664            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19665            MOVE PB-SV-STATE            TO PI-SV-STATE
 19666            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19667            GO TO 7100-DISPLAY-CANCELS.
 19668
 19669 4310-BUMP-SEQ.
 19670     IF NOT DISPLAY-CHANGE-RECORDS
 19671        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 361
* EL6311.cbl
 19672        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19673     ELSE
 19674        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19675           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19676           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19677        ELSE
 19678           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19679           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19680
 19681     GO TO 4305-READ-NEXT.
 19682
 19683 4350-END-BATCH.
 19684
 19685******************************************************************
 19686*                                                                *
 19687*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19688*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19689*         PROGRAM.                                               *
 19690*                                                                *
 19691******************************************************************
 19692
 19693     IF  EIBTRNID NOT = TRANS-EXB1
 19694         IF PENDING-BUS-RECS-FOUND
 19695             NEXT SENTENCE
 19696           ELSE
 19697             MOVE '9'            TO PI-BROWSE-SW
 19698             GO TO 9400-CLEAR.
 19699
 19700     IF SHOW-RECORD
 19701        MOVE ER-2253            TO EMI-ERROR
 19702     ELSE
 19703        MOVE ER-2251            TO EMI-ERROR.
 19704
 19705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19706
 19707     IF PI-MAP-NAME = SPACES
 19708        MOVE -1                  TO BMAINTL
 19709        MOVE EL631B               TO PI-MAP-NAME
 19710        GO TO 8100-SEND-INITIAL-MAP.
 19711
 19712     IF PI-MAP-NAME = EL631B
 19713        MOVE -1                  TO BMAINTL
 19714     ELSE
 19715        IF PI-MAP-NAME = EL631C
 19716           MOVE -1               TO CMAINTL
 19717        ELSE
 19718           MOVE -1               TO DPFENTRL.
 19719
 19720     GO TO 8200-SEND-DATAONLY.
 19721
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 362
* EL6311.cbl
 19723
 19724******************************************************************
 19725*                                                                *
 19726*        B R O W S E   D E T A I L   B A C K W A R D             *
 19727*                                                                *
 19728******************************************************************
 19729
 19730 4500-BROWSE-DETAIL-BACKWARD.
 19731
 19732     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19733
 19734
 19735* EXEC CICS HANDLE CONDITION
 19736*         NOTFND   (4570-NOT-FOUND)
 19737*         ENDFILE  (4550-END-RECORDS)
 19738*    END-EXEC
 19739*    MOVE '"$I''                  ! N #00016853' TO DFHEIV0
 19740     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19742     MOVE X'4E20233030303136383533' TO DFHEIV0(25:11)
 19743     CALL 'kxdfhei1' USING DFHEIV0
 19744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19745
 19746
 19747* EXEC CICS STARTBR
 19748*         DATASET   (FILE-ID-ERPNDB2)
 19749*         RIDFLD    (ERPNDB-ALT-KEY)
 19750*    END-EXEC.
 19751     MOVE 0
 19752       TO DFHEIV11
 19753*    MOVE '&,         G          &   #00016858' TO DFHEIV0
 19754     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19755     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19756     MOVE X'2020233030303136383538' TO DFHEIV0(25:11)
 19757     CALL 'kxdfhei1' USING DFHEIV0,
 19758           FILE-ID-ERPNDB2,
 19759           ERPNDB-ALT-KEY,
 19760           DFHEIV99,
 19761           DFHEIV11,
 19762           DFHEIV99
 19763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19764
 19765
 19766     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19767                                    WS-FIRST-TIME-SW.
 19768
 19769 4505-READ-PREV-RECORD.
 19770
 19771* EXEC CICS READPREV
 19772*         DATASET    (FILE-ID-ERPNDB2)
 19773*         SET        (ADDRESS OF PENDING-BUSINESS)
 19774*         RIDFLD     (ERPNDB-ALT-KEY)
 19775*    END-EXEC.
 19776     MOVE 0
 19777       TO DFHEIV11
 19778*    MOVE '&0S                   )   #00016867' TO DFHEIV0
 19779     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19780     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 363
* EL6311.cbl
 19781     MOVE X'2020233030303136383637' TO DFHEIV0(25:11)
 19782     CALL 'kxdfhei1' USING DFHEIV0,
 19783           FILE-ID-ERPNDB2,
 19784           DFHEIV20,
 19785           DFHEIV99,
 19786           ERPNDB-ALT-KEY,
 19787           DFHEIV99,
 19788           DFHEIV11,
 19789           DFHEIV99,
 19790           DFHEIV99
 19791     SET ADDRESS OF PENDING-BUSINESS TO
 19792         DFHEIV20
 19793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19794
 19795
 19796     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19797
 19798     IF WS-BATCH-PREFIX = '#CL'
 19799         GO TO 4505-READ-PREV-RECORD.
 19800
 19801     IF FIRST-TIME
 19802         MOVE SPACE               TO WS-FIRST-TIME-SW
 19803         GO TO 4505-READ-PREV-RECORD.
 19804
 19805     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19806        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19807        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19808        PB-STATE         NOT = PI-PB-STATE    OR
 19809        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19810          GO TO 4550-END-RECORDS.
 19811
 19812
 19813     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19814
 19815     IF PB-BATCH-TRAILER
 19816        GO TO 4505-READ-PREV-RECORD.
 19817
 19818     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19819
 19820     IF  WS-BATCH-PREFIX = '#CL'
 19821         GO TO 4505-READ-PREV-RECORD.
 19822
 19823     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19824        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19825           GO TO 4505-READ-PREV-RECORD
 19826        ELSE
 19827           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19828              GO TO 4510-CHECK-REC-TYPE
 19829           ELSE
 19830              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19831                 GO TO 4510-CHECK-REC-TYPE
 19832              ELSE
 19833                 GO TO 4505-READ-PREV-RECORD.
 19834
 19835     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19836        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19837           GO TO 4505-READ-PREV-RECORD.
 19838
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 364
* EL6311.cbl
 19839 4510-CHECK-REC-TYPE.
 19840     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19841         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19842             NEXT SENTENCE
 19843         ELSE
 19844             GO TO 4505-READ-PREV-RECORD.
 19845
 19846     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19847         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19848             NEXT SENTENCE
 19849        ELSE
 19850             GO TO 4505-READ-PREV-RECORD.
 19851
 19852     IF NOT DISPLAY-CHANGE-RECORDS AND
 19853            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19854        GO TO 4505-READ-PREV-RECORD.
 19855
 19856     IF DISPLAY-HOLD-RECORDS AND
 19857        NOT PB-RECORD-ON-HOLD
 19858          GO TO 4505-READ-PREV-RECORD.
 19859
 19860     IF PB-ISSUE
 19861        IF DISPLAY-CHK-REQ-RECORDS
 19862           GO TO 4505-READ-PREV-RECORD.
 19863
 19864     IF PB-ISSUE
 19865        IF ISSUE-WITH-WARNING
 19866           IF PB-WARNING-ERRORS
 19867              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19868                  GO TO 4505-READ-PREV-RECORD
 19869              ELSE
 19870                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19871                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19872                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19873                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19874                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19875                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19876                 GO TO 7000-DISPLAY-ISSUES
 19877           ELSE
 19878              GO TO 4505-READ-PREV-RECORD.
 19879
 19880     IF PB-ISSUE
 19881        IF (ISSUES-IN-ERROR AND
 19882            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19883            ALL-ISSUES
 19884            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19885            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19886            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19887            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19888            MOVE PB-SV-STATE            TO PI-SV-STATE
 19889            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19890            GO TO 7000-DISPLAY-ISSUES
 19891        ELSE
 19892            GO TO 4505-READ-PREV-RECORD.
 19893
 19894     IF PB-CANCELLATION
 19895        IF DISPLAY-CHK-REQ-RECORDS
 19896           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 365
* EL6311.cbl
 19897              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19898              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19899              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19900              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19901              MOVE PB-SV-STATE            TO PI-SV-STATE
 19902              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19903              GO TO 7100-DISPLAY-CANCELS
 19904           ELSE
 19905              GO TO 4505-READ-PREV-RECORD.
 19906
 19907     IF PB-CANCELLATION
 19908        IF CANCEL-WITH-WARNING
 19909           IF PB-WARNING-ERRORS
 19910              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19911                  GO TO 4505-READ-PREV-RECORD
 19912              ELSE
 19913                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19914                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19915                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19916                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19917                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19918                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19919                 GO TO 7100-DISPLAY-CANCELS
 19920           ELSE
 19921              GO TO 4505-READ-PREV-RECORD.
 19922
 19923     IF PB-CANCELLATION
 19924        IF (CANCEL-IN-ERROR  AND
 19925            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19926            ALL-CANCELS
 19927            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19928            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19929            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19930            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19931            MOVE PB-SV-STATE            TO PI-SV-STATE
 19932            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19933            GO TO 7100-DISPLAY-CANCELS.
 19934
 19935     GO TO 4505-READ-PREV-RECORD.
 19936
 19937 4550-END-RECORDS.
 19938     IF PI-MAP-NAME = EL631B
 19939        MOVE -1                  TO BMAINTL
 19940     ELSE
 19941        IF PI-MAP-NAME = EL631C
 19942           MOVE -1               TO CMAINTL
 19943        ELSE
 19944           MOVE -1               TO DPFENTRL.
 19945
 19946     MOVE ER-2255               TO EMI-ERROR.
 19947     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19948     GO TO 8200-SEND-DATAONLY.
 19949
 19950 4570-NOT-FOUND.
 19951
 19952******************************************************************
 19953*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19954******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 366
* EL6311.cbl
 19955
 19956
 19957* EXEC CICS RESETBR
 19958*         DATASET    (FILE-ID-ERPNDB2)
 19959*         RIDFLD     (ERPNDB-ALT-KEY)
 19960*    END-EXEC.
 19961     MOVE 0
 19962       TO DFHEIV11
 19963*    MOVE '&4         G          &   #00017033' TO DFHEIV0
 19964     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19965     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19966     MOVE X'2020233030303137303333' TO DFHEIV0(25:11)
 19967     CALL 'kxdfhei1' USING DFHEIV0,
 19968           FILE-ID-ERPNDB2,
 19969           ERPNDB-ALT-KEY,
 19970           DFHEIV99,
 19971           DFHEIV11,
 19972           DFHEIV99
 19973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19974
 19975
 19976
 19977* EXEC CICS READNEXT
 19978*         DATASET    (FILE-ID-ERPNDB2)
 19979*         SET        (ADDRESS OF PENDING-BUSINESS)
 19980*         RIDFLD     (ERPNDB-ALT-KEY)
 19981*    END-EXEC.
 19982     MOVE 0
 19983       TO DFHEIV11
 19984*    MOVE '&.S                   )   #00017038' TO DFHEIV0
 19985     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19986     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19987     MOVE X'2020233030303137303338' TO DFHEIV0(25:11)
 19988     CALL 'kxdfhei1' USING DFHEIV0,
 19989           FILE-ID-ERPNDB2,
 19990           DFHEIV20,
 19991           DFHEIV99,
 19992           ERPNDB-ALT-KEY,
 19993           DFHEIV99,
 19994           DFHEIV11,
 19995           DFHEIV99,
 19996           DFHEIV99
 19997     SET ADDRESS OF PENDING-BUSINESS TO
 19998         DFHEIV20
 19999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20000
 20001
 20002
 20003* EXEC CICS READPREV
 20004*         DATASET    (FILE-ID-ERPNDB2)
 20005*         SET        (ADDRESS OF PENDING-BUSINESS)
 20006*         RIDFLD     (ERPNDB-ALT-KEY)
 20007*    END-EXEC.
 20008     MOVE 0
 20009       TO DFHEIV11
 20010*    MOVE '&0S                   )   #00017044' TO DFHEIV0
 20011     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20012     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 367
* EL6311.cbl
 20013     MOVE X'2020233030303137303434' TO DFHEIV0(25:11)
 20014     CALL 'kxdfhei1' USING DFHEIV0,
 20015           FILE-ID-ERPNDB2,
 20016           DFHEIV20,
 20017           DFHEIV99,
 20018           ERPNDB-ALT-KEY,
 20019           DFHEIV99,
 20020           DFHEIV11,
 20021           DFHEIV99,
 20022           DFHEIV99
 20023     SET ADDRESS OF PENDING-BUSINESS TO
 20024         DFHEIV20
 20025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20026
 20027
 20028 4580-READ-PREV-RECORD.
 20029
 20030* EXEC CICS READPREV
 20031*         DATASET    (FILE-ID-ERPNDB2)
 20032*         SET        (ADDRESS OF PENDING-BUSINESS)
 20033*         RIDFLD     (ERPNDB-ALT-KEY)
 20034*    END-EXEC.
 20035     MOVE 0
 20036       TO DFHEIV11
 20037*    MOVE '&0S                   )   #00017051' TO DFHEIV0
 20038     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20039     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20040     MOVE X'2020233030303137303531' TO DFHEIV0(25:11)
 20041     CALL 'kxdfhei1' USING DFHEIV0,
 20042           FILE-ID-ERPNDB2,
 20043           DFHEIV20,
 20044           DFHEIV99,
 20045           ERPNDB-ALT-KEY,
 20046           DFHEIV99,
 20047           DFHEIV11,
 20048           DFHEIV99,
 20049           DFHEIV99
 20050     SET ADDRESS OF PENDING-BUSINESS TO
 20051         DFHEIV20
 20052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20053
 20054
 20055     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20056
 20057     IF WS-BATCH-PREFIX = '#CL'
 20058        GO TO 4580-READ-PREV-RECORD.
 20059
 20060     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20061     GO TO 4505-READ-PREV-RECORD.
 20062
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 368
* EL6311.cbl
 20064
 20065******************************************************************
 20066*                                                                *
 20067*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20068*                                                                *
 20069******************************************************************
 20070
 20071 4600-BROWSE-PRIMARY-BACKWARD.
 20072        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20073
 20074     IF ERPNDB-BATCH-SEQ-NO = +9999
 20075        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20076
 20077        IF ERPNDB-BATCH-SEQ-NO = +0000
 20078           GO TO 4650-END-BATCH
 20079        ELSE
 20080           IF PI-MAP-NAME NOT = EL631D
 20081              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20082                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20083              ELSE
 20084                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20085                 IF DISPLAY-CHANGE-RECORDS
 20086                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20087                 ELSE
 20088                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20089
 20090
 20091* EXEC CICS HANDLE CONDITION
 20092*         NOTFND    (4680-NOT-FOUND)
 20093*         ENDFILE   (4680-NOT-FOUND)
 20094*    END-EXEC.
 20095*    MOVE '"$I''                  ! O #00017092' TO DFHEIV0
 20096     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20098     MOVE X'4F20233030303137303932' TO DFHEIV0(25:11)
 20099     CALL 'kxdfhei1' USING DFHEIV0
 20100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20101
 20102
 20103 4605-READ-NEXT.
 20104     IF ERPNDB-BATCH-SEQ-NO = +0000
 20105        GO TO 4650-END-BATCH.
 20106
 20107     IF PI-DISPLAY-ORIGINAL-BATCH
 20108        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20109     ELSE
 20110        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20111
 20112
 20113* EXEC CICS READ
 20114*         DATASET   (FILE-ID)
 20115*         SET       (ADDRESS OF PENDING-BUSINESS)
 20116*         RIDFLD    (ERPNDB-KEY)
 20117*    END-EXEC.
 20118*    MOVE '&"S        E          (   #00017106' TO DFHEIV0
 20119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303137313036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 369
* EL6311.cbl
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           FILE-ID,
 20124           DFHEIV20,
 20125           DFHEIV99,
 20126           ERPNDB-KEY,
 20127           DFHEIV99,
 20128           DFHEIV99,
 20129           DFHEIV99
 20130     SET ADDRESS OF PENDING-BUSINESS TO
 20131         DFHEIV20
 20132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20133
 20134
 20135     IF NOT  PI-PRIMARY-WITH-SELECT
 20136        GO TO 4607-CHECK-REC-TYPE.
 20137
 20138     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20139
 20140     IF  WS-BATCH-PREFIX = '#CL'
 20141         GO TO 4610-BUMP-SEQ.
 20142
 20143     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20144        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20145           GO TO 4610-BUMP-SEQ
 20146        ELSE
 20147           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20148              GO TO 4607-CHECK-REC-TYPE
 20149           ELSE
 20150              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20151                 GO TO 4607-CHECK-REC-TYPE
 20152              ELSE
 20153                 GO TO 4610-BUMP-SEQ.
 20154
 20155     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20156        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20157           GO TO 4610-BUMP-SEQ.
 20158
 20159 4607-CHECK-REC-TYPE.
 20160     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20161         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20162             NEXT SENTENCE
 20163         ELSE
 20164             GO TO 4610-BUMP-SEQ.
 20165
 20166     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20167         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20168             NEXT SENTENCE
 20169        ELSE
 20170             GO TO 4610-BUMP-SEQ.
 20171
 20172     IF NOT DISPLAY-CHANGE-RECORDS AND
 20173            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20174        GO TO 4610-BUMP-SEQ.
 20175
 20176     IF DISPLAY-HOLD-RECORDS AND
 20177        NOT PB-RECORD-ON-HOLD
 20178          GO TO 4610-BUMP-SEQ.
 20179
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 370
* EL6311.cbl
 20180     IF PB-ISSUE
 20181        IF DISPLAY-CHK-REQ-RECORDS
 20182           GO TO 4610-BUMP-SEQ.
 20183
 20184     IF PB-ISSUE
 20185        IF ISSUE-WITH-WARNING
 20186           IF PB-WARNING-ERRORS
 20187              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20188                  GO TO 4610-BUMP-SEQ
 20189              ELSE
 20190                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20191                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20192                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20193                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20194                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20195                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20196                 GO TO 7000-DISPLAY-ISSUES
 20197           ELSE
 20198              GO TO 4610-BUMP-SEQ.
 20199
 20200     IF PB-ISSUE
 20201        IF (ISSUES-IN-ERROR AND
 20202            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20203            ALL-ISSUES
 20204            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20205            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20206            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20207            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20208            MOVE PB-SV-STATE            TO PI-SV-STATE
 20209            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20210            GO TO 7000-DISPLAY-ISSUES
 20211        ELSE
 20212            GO TO 4610-BUMP-SEQ.
 20213
 20214     IF PB-CANCELLATION
 20215        IF DISPLAY-CHK-REQ-RECORDS
 20216           IF PB-C-REFUND-REQUESTED
 20217              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20218              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20219              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20220              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20221              MOVE PB-SV-STATE            TO PI-SV-STATE
 20222              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20223              GO TO 7100-DISPLAY-CANCELS
 20224           ELSE
 20225              GO TO 4610-BUMP-SEQ.
 20226
 20227     IF PB-CANCELLATION
 20228        IF CANCEL-WITH-WARNING
 20229           IF PB-WARNING-ERRORS
 20230              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20231                  GO TO 4610-BUMP-SEQ
 20232              ELSE
 20233                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20234                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20235                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20236                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20237                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 371
* EL6311.cbl
 20238                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20239                 GO TO 7100-DISPLAY-CANCELS
 20240           ELSE
 20241              GO TO 4610-BUMP-SEQ.
 20242
 20243     IF PB-CANCELLATION
 20244        IF (CANCEL-IN-ERROR  AND
 20245            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20246            ALL-CANCELS
 20247            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20248            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20249            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20250            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20251            MOVE PB-SV-STATE            TO PI-SV-STATE
 20252            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20253            GO TO 7100-DISPLAY-CANCELS.
 20254
 20255 4610-BUMP-SEQ.
 20256     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20257        GO TO 4650-END-BATCH.
 20258
 20259     IF DISPLAY-CHANGE-RECORDS
 20260        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20261           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20262        ELSE
 20263           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20264           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20265        ELSE
 20266           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20267           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20268
 20269        GO TO 4605-READ-NEXT.
 20270
 20271 4650-END-BATCH.
 20272     IF PI-MAP-NAME = EL631B
 20273        MOVE -1                  TO BMAINTL
 20274     ELSE
 20275        IF PI-MAP-NAME = EL631C
 20276           MOVE -1               TO CMAINTL
 20277        ELSE
 20278           MOVE -1               TO DPFENTRL.
 20279
 20280     MOVE ER-2252               TO EMI-ERROR.
 20281     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20282     GO TO 8200-SEND-DATAONLY.
 20283
 20284 4680-NOT-FOUND.
 20285     IF DISPLAY-CHANGE-RECORDS
 20286        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20287           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20288        ELSE
 20289           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20290           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20291     ELSE
 20292        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20293
 20294     GO TO 4605-READ-NEXT.
 20295
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 372
* EL6311.cbl
 20297
 20298******************************************************************
 20299*                                                                *
 20300*        B R O W S E   F I L E   B A C K W A R D S               *
 20301*                                                                *
 20302******************************************************************
 20303
 20304 4800-BROWSE-FILE-BACKWARD.
 20305
 20306* EXEC CICS HANDLE CONDITION
 20307*         NOTFND   (4860-NOT-FOUND)
 20308*         ENDFILE  (4850-END-RECORDS)
 20309*    END-EXEC.
 20310*    MOVE '"$I''                  ! P #00017282' TO DFHEIV0
 20311     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20313     MOVE X'5020233030303137323832' TO DFHEIV0(25:11)
 20314     CALL 'kxdfhei1' USING DFHEIV0
 20315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20316
 20317
 20318     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20319
 20320     IF PI-DISPLAY-ORIGINAL-BATCH
 20321        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20322     ELSE
 20323        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20324
 20325
 20326* EXEC CICS STARTBR
 20327*         DATASET   (FILE-ID)
 20328*         RIDFLD    (ERPNDB-KEY)
 20329*    END-EXEC.
 20330     MOVE 0
 20331       TO DFHEIV11
 20332*    MOVE '&,         G          &   #00017294' TO DFHEIV0
 20333     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20334     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20335     MOVE X'2020233030303137323934' TO DFHEIV0(25:11)
 20336     CALL 'kxdfhei1' USING DFHEIV0,
 20337           FILE-ID,
 20338           ERPNDB-KEY,
 20339           DFHEIV99,
 20340           DFHEIV11,
 20341           DFHEIV99
 20342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20343
 20344
 20345     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20346
 20347
 20348* EXEC CICS READPREV
 20349*         DATASET    (FILE-ID-ERPNDB)
 20350*         SET        (ADDRESS OF PENDING-BUSINESS)
 20351*         RIDFLD     (ERPNDB-KEY)
 20352*    END-EXEC.
 20353     MOVE 0
 20354       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 373
* EL6311.cbl
 20355*    MOVE '&0S                   )   #00017301' TO DFHEIV0
 20356     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20357     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20358     MOVE X'2020233030303137333031' TO DFHEIV0(25:11)
 20359     CALL 'kxdfhei1' USING DFHEIV0,
 20360           FILE-ID-ERPNDB,
 20361           DFHEIV20,
 20362           DFHEIV99,
 20363           ERPNDB-KEY,
 20364           DFHEIV99,
 20365           DFHEIV11,
 20366           DFHEIV99,
 20367           DFHEIV99
 20368     SET ADDRESS OF PENDING-BUSINESS TO
 20369         DFHEIV20
 20370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20371
 20372
 20373 4810-READ-PREV-RECORD.
 20374
 20375* EXEC CICS READPREV
 20376*         DATASET    (FILE-ID-ERPNDB)
 20377*         SET        (ADDRESS OF PENDING-BUSINESS)
 20378*         RIDFLD     (ERPNDB-KEY)
 20379*    END-EXEC.
 20380     MOVE 0
 20381       TO DFHEIV11
 20382*    MOVE '&0S                   )   #00017308' TO DFHEIV0
 20383     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20384     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20385     MOVE X'2020233030303137333038' TO DFHEIV0(25:11)
 20386     CALL 'kxdfhei1' USING DFHEIV0,
 20387           FILE-ID-ERPNDB,
 20388           DFHEIV20,
 20389           DFHEIV99,
 20390           ERPNDB-KEY,
 20391           DFHEIV99,
 20392           DFHEIV11,
 20393           DFHEIV99,
 20394           DFHEIV99
 20395     SET ADDRESS OF PENDING-BUSINESS TO
 20396         DFHEIV20
 20397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20398
 20399
 20400     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20401        GO TO 4850-END-RECORDS.
 20402
 20403     IF PB-BATCH-TRAILER
 20404        GO TO 4810-READ-PREV-RECORD.
 20405
 20406     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20407
 20408     IF  WS-BATCH-PREFIX = '#CL'
 20409         GO TO 4810-READ-PREV-RECORD.
 20410
 20411     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20412        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 374
* EL6311.cbl
 20413           GO TO 4810-READ-PREV-RECORD
 20414        ELSE
 20415           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20416              GO TO 4820-CHECK-REC-TYPE
 20417           ELSE
 20418              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20419                 GO TO 4820-CHECK-REC-TYPE
 20420              ELSE
 20421                 GO TO 4810-READ-PREV-RECORD.
 20422
 20423     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20424        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20425           GO TO 4810-READ-PREV-RECORD.
 20426
 20427 4820-CHECK-REC-TYPE.
 20428     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20429         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20430             NEXT SENTENCE
 20431         ELSE
 20432             GO TO 4810-READ-PREV-RECORD.
 20433
 20434     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20435         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20436             NEXT SENTENCE
 20437        ELSE
 20438             GO TO 4810-READ-PREV-RECORD.
 20439
 20440     IF NOT DISPLAY-CHANGE-RECORDS AND
 20441            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20442        GO TO 4810-READ-PREV-RECORD.
 20443
 20444     IF DISPLAY-HOLD-RECORDS AND
 20445        NOT PB-RECORD-ON-HOLD
 20446          GO TO 4810-READ-PREV-RECORD.
 20447
 20448     IF PB-ISSUE
 20449        IF DISPLAY-CHK-REQ-RECORDS
 20450           GO TO 4810-READ-PREV-RECORD.
 20451
 20452     IF PB-ISSUE
 20453        IF ISSUE-WITH-WARNING
 20454           IF PB-WARNING-ERRORS
 20455              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20456                  GO TO 4810-READ-PREV-RECORD
 20457              ELSE
 20458                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20459                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20460                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20461                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20462                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20463                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20464                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20465                 GO TO 7000-DISPLAY-ISSUES
 20466           ELSE
 20467              GO TO 4810-READ-PREV-RECORD.
 20468
 20469     IF PB-ISSUE
 20470        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 375
* EL6311.cbl
 20471            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20472            ALL-ISSUES
 20473            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20474            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20475            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20476            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20477            MOVE PB-SV-STATE            TO PI-SV-STATE
 20478            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20479            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20480            GO TO 7000-DISPLAY-ISSUES
 20481        ELSE
 20482            GO TO 4810-READ-PREV-RECORD.
 20483
 20484     IF PB-CANCELLATION
 20485        IF DISPLAY-CHK-REQ-RECORDS
 20486           IF PB-C-REFUND-REQUESTED
 20487              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20488              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20489              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20490              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20491              MOVE PB-SV-STATE            TO PI-SV-STATE
 20492              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20493              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20494              GO TO 7100-DISPLAY-CANCELS
 20495           ELSE
 20496              GO TO 4810-READ-PREV-RECORD.
 20497
 20498     IF PB-CANCELLATION
 20499        IF CANCEL-WITH-WARNING
 20500           IF PB-WARNING-ERRORS
 20501              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20502                  GO TO 4810-READ-PREV-RECORD
 20503              ELSE
 20504                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20505                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20506                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20507                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20508                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20509                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20510                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20511                 GO TO 7100-DISPLAY-CANCELS
 20512           ELSE
 20513              GO TO 4810-READ-PREV-RECORD.
 20514
 20515     IF PB-CANCELLATION
 20516        IF (CANCEL-IN-ERROR  AND
 20517            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20518            ALL-CANCELS
 20519            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20520            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20521            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20522            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20523            MOVE PB-SV-STATE            TO PI-SV-STATE
 20524            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20525            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20526            GO TO 7100-DISPLAY-CANCELS.
 20527
 20528     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 376
* EL6311.cbl
 20529
 20530 4850-END-RECORDS.
 20531     MOVE ER-2252                TO EMI-ERROR.
 20532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20533
 20534     IF PI-MAP-NAME = EL631B
 20535        MOVE -1                  TO BPFENTRL
 20536     ELSE
 20537        MOVE -1                  TO CPFENTRL.
 20538
 20539     GO TO 8200-SEND-DATAONLY.
 20540
 20541 4860-NOT-FOUND.
 20542
 20543******************************************************************
 20544*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20545******************************************************************
 20546
 20547
 20548* EXEC CICS RESETBR
 20549*         DATASET    (FILE-ID-ERPNDB)
 20550*         RIDFLD     (ERPNDB-KEY)
 20551*     END-EXEC.
 20552     MOVE 0
 20553       TO DFHEIV11
 20554*    MOVE '&4         G          &   #00017461' TO DFHEIV0
 20555     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20556     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20557     MOVE X'2020233030303137343631' TO DFHEIV0(25:11)
 20558     CALL 'kxdfhei1' USING DFHEIV0,
 20559           FILE-ID-ERPNDB,
 20560           ERPNDB-KEY,
 20561           DFHEIV99,
 20562           DFHEIV11,
 20563           DFHEIV99
 20564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20565
 20566
 20567
 20568* EXEC CICS READNEXT
 20569*         DATASET    (FILE-ID-ERPNDB)
 20570*         SET        (ADDRESS OF PENDING-BUSINESS)
 20571*         RIDFLD     (ERPNDB-KEY)
 20572*    END-EXEC.
 20573     MOVE 0
 20574       TO DFHEIV11
 20575*    MOVE '&.S                   )   #00017466' TO DFHEIV0
 20576     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20577     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20578     MOVE X'2020233030303137343636' TO DFHEIV0(25:11)
 20579     CALL 'kxdfhei1' USING DFHEIV0,
 20580           FILE-ID-ERPNDB,
 20581           DFHEIV20,
 20582           DFHEIV99,
 20583           ERPNDB-KEY,
 20584           DFHEIV99,
 20585           DFHEIV11,
 20586           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 377
* EL6311.cbl
 20587           DFHEIV99
 20588     SET ADDRESS OF PENDING-BUSINESS TO
 20589         DFHEIV20
 20590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20591
 20592
 20593
 20594* EXEC CICS READPREV
 20595*         DATASET    (FILE-ID-ERPNDB)
 20596*         SET        (ADDRESS OF PENDING-BUSINESS)
 20597*         RIDFLD     (ERPNDB-KEY)
 20598*    END-EXEC.
 20599     MOVE 0
 20600       TO DFHEIV11
 20601*    MOVE '&0S                   )   #00017472' TO DFHEIV0
 20602     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20603     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20604     MOVE X'2020233030303137343732' TO DFHEIV0(25:11)
 20605     CALL 'kxdfhei1' USING DFHEIV0,
 20606           FILE-ID-ERPNDB,
 20607           DFHEIV20,
 20608           DFHEIV99,
 20609           ERPNDB-KEY,
 20610           DFHEIV99,
 20611           DFHEIV11,
 20612           DFHEIV99,
 20613           DFHEIV99
 20614     SET ADDRESS OF PENDING-BUSINESS TO
 20615         DFHEIV20
 20616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20617
 20618
 20619     GO TO 4810-READ-PREV-RECORD.
 20620
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 378
* EL6311.cbl
 20622
 20623******************************************************************
 20624*                                                                *
 20625*           B R O W S E   C S R   B A C K W A R D                *
 20626*                                                                *
 20627******************************************************************
 20628
 20629 4900-BROWSE-CSR-BACKWARD.
 20630
 20631     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20632
 20633
 20634* EXEC CICS HANDLE CONDITION
 20635*         NOTFND   (4970-NOT-FOUND)
 20636*         ENDFILE  (4950-END-RECORDS)
 20637*    END-EXEC
 20638*    MOVE '"$I''                  ! Q #00017492' TO DFHEIV0
 20639     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20641     MOVE X'5120233030303137343932' TO DFHEIV0(25:11)
 20642     CALL 'kxdfhei1' USING DFHEIV0
 20643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20644
 20645
 20646* EXEC CICS STARTBR
 20647*         DATASET   (FILE-ID-ERPNDB4)
 20648*         RIDFLD    (ERPNDB-CSR-KEY)
 20649*    END-EXEC.
 20650     MOVE 0
 20651       TO DFHEIV11
 20652*    MOVE '&,         G          &   #00017497' TO DFHEIV0
 20653     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20654     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20655     MOVE X'2020233030303137343937' TO DFHEIV0(25:11)
 20656     CALL 'kxdfhei1' USING DFHEIV0,
 20657           FILE-ID-ERPNDB4,
 20658           ERPNDB-CSR-KEY,
 20659           DFHEIV99,
 20660           DFHEIV11,
 20661           DFHEIV99
 20662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20663
 20664
 20665     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20666                                    WS-FIRST-TIME-SW.
 20667
 20668 4905-READ-PREV-RECORD.
 20669
 20670* EXEC CICS READPREV
 20671*         DATASET    (FILE-ID-ERPNDB4)
 20672*         SET        (ADDRESS OF PENDING-BUSINESS)
 20673*         RIDFLD     (ERPNDB-CSR-KEY)
 20674*    END-EXEC.
 20675     MOVE 0
 20676       TO DFHEIV11
 20677*    MOVE '&0S                   )   #00017506' TO DFHEIV0
 20678     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20679     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 379
* EL6311.cbl
 20680     MOVE X'2020233030303137353036' TO DFHEIV0(25:11)
 20681     CALL 'kxdfhei1' USING DFHEIV0,
 20682           FILE-ID-ERPNDB4,
 20683           DFHEIV20,
 20684           DFHEIV99,
 20685           ERPNDB-CSR-KEY,
 20686           DFHEIV99,
 20687           DFHEIV11,
 20688           DFHEIV99,
 20689           DFHEIV99
 20690     SET ADDRESS OF PENDING-BUSINESS TO
 20691         DFHEIV20
 20692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20693
 20694
 20695     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20696
 20697     IF WS-BATCH-PREFIX = '#CL'
 20698         GO TO 4905-READ-PREV-RECORD.
 20699
 20700     IF FIRST-TIME
 20701         MOVE SPACE               TO WS-FIRST-TIME-SW
 20702         GO TO 4905-READ-PREV-RECORD.
 20703
 20704     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20705        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20706        GO TO 4950-END-RECORDS.
 20707
 20708     IF PB-BATCH-TRAILER
 20709        GO TO 4905-READ-PREV-RECORD.
 20710
 20711     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20712
 20713     IF  WS-BATCH-PREFIX = '#CL'
 20714         GO TO 4905-READ-PREV-RECORD.
 20715
 20716     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20717        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20718           GO TO 4905-READ-PREV-RECORD
 20719        ELSE
 20720           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20721              GO TO 4910-CHECK-REC-TYPE
 20722           ELSE
 20723              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20724                 GO TO 4910-CHECK-REC-TYPE
 20725              ELSE
 20726                 GO TO 4905-READ-PREV-RECORD.
 20727
 20728     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20729        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20730           GO TO 4905-READ-PREV-RECORD.
 20731
 20732 4910-CHECK-REC-TYPE.
 20733     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20734         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20735             NEXT SENTENCE
 20736         ELSE
 20737             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 380
* EL6311.cbl
 20738
 20739     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20740         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20741             NEXT SENTENCE
 20742        ELSE
 20743             GO TO 4905-READ-PREV-RECORD.
 20744
 20745     IF NOT DISPLAY-CHANGE-RECORDS AND
 20746            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20747        GO TO 4905-READ-PREV-RECORD.
 20748
 20749     IF DISPLAY-HOLD-RECORDS AND
 20750        NOT PB-RECORD-ON-HOLD
 20751          GO TO 4905-READ-PREV-RECORD.
 20752
 20753     IF PB-ISSUE
 20754        IF DISPLAY-CHK-REQ-RECORDS
 20755           GO TO 4905-READ-PREV-RECORD.
 20756
 20757     IF PB-ISSUE
 20758        IF ISSUE-WITH-WARNING
 20759           IF PB-WARNING-ERRORS
 20760              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20761                  GO TO 4505-READ-PREV-RECORD
 20762              ELSE
 20763                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20764                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20765                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20766                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20767                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20768                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20769                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20770                 GO TO 7000-DISPLAY-ISSUES
 20771           ELSE
 20772              GO TO 4905-READ-PREV-RECORD.
 20773
 20774     IF PB-ISSUE
 20775        IF (ISSUES-IN-ERROR AND
 20776            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20777            ALL-ISSUES
 20778            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20779            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20780            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20781            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20782            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20783            MOVE PB-SV-STATE            TO PI-SV-STATE
 20784            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20785            GO TO 7000-DISPLAY-ISSUES
 20786        ELSE
 20787            GO TO 4905-READ-PREV-RECORD.
 20788
 20789     IF PB-CANCELLATION
 20790        IF DISPLAY-CHK-REQ-RECORDS
 20791           IF PB-C-REFUND-REQUESTED
 20792              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20793              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20794              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20795              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 381
* EL6311.cbl
 20796              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20797              MOVE PB-SV-STATE            TO PI-SV-STATE
 20798              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20799              GO TO 7100-DISPLAY-CANCELS
 20800           ELSE
 20801              GO TO 4905-READ-PREV-RECORD.
 20802
 20803     IF PB-CANCELLATION
 20804        IF CANCEL-WITH-WARNING
 20805           IF PB-WARNING-ERRORS
 20806              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20807                  GO TO 4505-READ-PREV-RECORD
 20808              ELSE
 20809                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20810                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20811                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20812                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20813                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20814                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20815                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20816                 GO TO 7100-DISPLAY-CANCELS
 20817           ELSE
 20818              GO TO 4905-READ-PREV-RECORD.
 20819
 20820     IF PB-CANCELLATION
 20821        IF (CANCEL-IN-ERROR  AND
 20822            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20823            ALL-CANCELS
 20824            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20825            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20826            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20827            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20828            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20829            MOVE PB-SV-STATE            TO PI-SV-STATE
 20830            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20831            GO TO 7100-DISPLAY-CANCELS.
 20832
 20833     GO TO 4905-READ-PREV-RECORD.
 20834
 20835 4950-END-RECORDS.
 20836     IF PI-MAP-NAME = EL631B
 20837        MOVE -1                  TO BMAINTL
 20838     ELSE
 20839        IF PI-MAP-NAME = EL631C
 20840           MOVE -1               TO CMAINTL
 20841        ELSE
 20842           MOVE -1               TO DPFENTRL.
 20843
 20844     MOVE ER-2255               TO EMI-ERROR.
 20845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20846     GO TO 8200-SEND-DATAONLY.
 20847
 20848 4970-NOT-FOUND.
 20849
 20850******************************************************************
 20851*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20852******************************************************************
 20853
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 382
* EL6311.cbl
 20854
 20855* EXEC CICS RESETBR
 20856*         DATASET    (FILE-ID-ERPNDB4)
 20857*         RIDFLD     (ERPNDB-CSR-KEY)
 20858*    END-EXEC.
 20859     MOVE 0
 20860       TO DFHEIV11
 20861*    MOVE '&4         G          &   #00017671' TO DFHEIV0
 20862     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20863     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20864     MOVE X'2020233030303137363731' TO DFHEIV0(25:11)
 20865     CALL 'kxdfhei1' USING DFHEIV0,
 20866           FILE-ID-ERPNDB4,
 20867           ERPNDB-CSR-KEY,
 20868           DFHEIV99,
 20869           DFHEIV11,
 20870           DFHEIV99
 20871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20872
 20873
 20874
 20875* EXEC CICS READNEXT
 20876*         DATASET    (FILE-ID-ERPNDB4)
 20877*         SET        (ADDRESS OF PENDING-BUSINESS)
 20878*         RIDFLD     (ERPNDB-CSR-KEY)
 20879*    END-EXEC.
 20880     MOVE 0
 20881       TO DFHEIV11
 20882*    MOVE '&.S                   )   #00017676' TO DFHEIV0
 20883     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20884     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20885     MOVE X'2020233030303137363736' TO DFHEIV0(25:11)
 20886     CALL 'kxdfhei1' USING DFHEIV0,
 20887           FILE-ID-ERPNDB4,
 20888           DFHEIV20,
 20889           DFHEIV99,
 20890           ERPNDB-CSR-KEY,
 20891           DFHEIV99,
 20892           DFHEIV11,
 20893           DFHEIV99,
 20894           DFHEIV99
 20895     SET ADDRESS OF PENDING-BUSINESS TO
 20896         DFHEIV20
 20897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20898
 20899
 20900
 20901* EXEC CICS READPREV
 20902*         DATASET    (FILE-ID-ERPNDB4)
 20903*         SET        (ADDRESS OF PENDING-BUSINESS)
 20904*         RIDFLD     (ERPNDB-CSR-KEY)
 20905*    END-EXEC.
 20906     MOVE 0
 20907       TO DFHEIV11
 20908*    MOVE '&0S                   )   #00017682' TO DFHEIV0
 20909     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20910     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20911     MOVE X'2020233030303137363832' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 383
* EL6311.cbl
 20912     CALL 'kxdfhei1' USING DFHEIV0,
 20913           FILE-ID-ERPNDB4,
 20914           DFHEIV20,
 20915           DFHEIV99,
 20916           ERPNDB-CSR-KEY,
 20917           DFHEIV99,
 20918           DFHEIV11,
 20919           DFHEIV99,
 20920           DFHEIV99
 20921     SET ADDRESS OF PENDING-BUSINESS TO
 20922         DFHEIV20
 20923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20924
 20925
 20926 4980-READ-PREV-RECORD.
 20927
 20928* EXEC CICS READPREV
 20929*         DATASET    (FILE-ID-ERPNDB4)
 20930*         SET        (ADDRESS OF PENDING-BUSINESS)
 20931*         RIDFLD     (ERPNDB-CSR-KEY)
 20932*    END-EXEC.
 20933     MOVE 0
 20934       TO DFHEIV11
 20935*    MOVE '&0S                   )   #00017689' TO DFHEIV0
 20936     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20937     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20938     MOVE X'2020233030303137363839' TO DFHEIV0(25:11)
 20939     CALL 'kxdfhei1' USING DFHEIV0,
 20940           FILE-ID-ERPNDB4,
 20941           DFHEIV20,
 20942           DFHEIV99,
 20943           ERPNDB-CSR-KEY,
 20944           DFHEIV99,
 20945           DFHEIV11,
 20946           DFHEIV99,
 20947           DFHEIV99
 20948     SET ADDRESS OF PENDING-BUSINESS TO
 20949         DFHEIV20
 20950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20951
 20952
 20953     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20954
 20955     IF WS-BATCH-PREFIX = '#CL'
 20956        GO TO 4980-READ-PREV-RECORD.
 20957
 20958     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20959     GO TO 4905-READ-PREV-RECORD.
 20960
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 384
* EL6311.cbl
 20962
 20963
 20964******************************************************************
 20965*                                                                *
 20966*        B R O W S E   B A T C H   H E A D E R S                 *
 20967*                                                                *
 20968******************************************************************
 20969
 20970 5000-BROWSE-BATCH-HEADERS.
 20971
 20972     IF EIBTRNID NOT = TRANS-EXB1
 20973        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20974        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20975        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20976        GO TO 5010-READ-NEXT-RECORD.
 20977
 20978     IF EIBAID = DFHPF4
 20979        MOVE '0'                TO PI-EDIT-SW
 20980        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20981        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20982        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20983        GO TO 5010-READ-NEXT-RECORD.
 20984
 20985     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20986     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20987     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20988
 20989
 20990* EXEC CICS HANDLE CONDITION
 20991*         ENDFILE  (5050-NOT-FOUND)
 20992*    END-EXEC.
 20993*    MOVE '"$''                   ! R #00017731' TO DFHEIV0
 20994     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20996     MOVE X'5220233030303137373331' TO DFHEIV0(25:11)
 20997     CALL 'kxdfhei1' USING DFHEIV0
 20998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20999
 21000
 21001 5010-READ-NEXT-RECORD.
 21002
 21003* EXEC CICS HANDLE CONDITION
 21004*         NOTFND    (5050-NOT-FOUND)
 21005*    END-EXEC.
 21006*    MOVE '"$I                   ! S #00017736' TO DFHEIV0
 21007     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21009     MOVE X'5320233030303137373336' TO DFHEIV0(25:11)
 21010     CALL 'kxdfhei1' USING DFHEIV0
 21011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21012
 21013
 21014
 21015* EXEC CICS READ
 21016*         DATASET   (FILE-ID-ERPNDB)
 21017*         SET       (ADDRESS OF PENDING-BUSINESS)
 21018*         RIDFLD    (ERPNDB-KEY)
 21019*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 385
* EL6311.cbl
 21020*    END-EXEC.
 21021*    MOVE '&"S        G          (   #00017740' TO DFHEIV0
 21022     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21024     MOVE X'2020233030303137373430' TO DFHEIV0(25:11)
 21025     CALL 'kxdfhei1' USING DFHEIV0,
 21026           FILE-ID-ERPNDB,
 21027           DFHEIV20,
 21028           DFHEIV99,
 21029           ERPNDB-KEY,
 21030           DFHEIV99,
 21031           DFHEIV99,
 21032           DFHEIV99
 21033     SET ADDRESS OF PENDING-BUSINESS TO
 21034         DFHEIV20
 21035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21036
 21037
 21038     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21039         GO TO 5050-NOT-FOUND.
 21040
 21041     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21042
 21043     IF WS-BATCH-PREFIX = '#CL'
 21044         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21045         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21046         GO TO 5010-READ-NEXT-RECORD.
 21047
 21048     IF NOT PB-BATCH-TRAILER
 21049         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21050         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21051         GO TO 5010-READ-NEXT-RECORD.
 21052
 21053     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21054         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21055             NEXT SENTENCE
 21056         ELSE
 21057             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21058             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21059             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21060             GO TO 5010-READ-NEXT-RECORD.
 21061
 21062     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21063         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21064             NEXT SENTENCE
 21065        ELSE
 21066             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21067             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21068             GO TO 5010-READ-NEXT-RECORD.
 21069
 21070     IF EIBAID = DFHPF4
 21071        MOVE '0'                TO PI-EDIT-SW
 21072        GO TO 7200-DISPLAY-BATCHES.
 21073
 21074     IF PI-CSR-BROWSE
 21075        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21076           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21077           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 386
* EL6311.cbl
 21078           GO TO 5010-READ-NEXT-RECORD.
 21079
 21080     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21081       IF PI-PB-CARRIER    = SPACES AND
 21082          PI-PB-GROUPING   = SPACES AND
 21083          PI-PB-STATE      = SPACES AND
 21084          PI-PB-ACCOUNT    = SPACES
 21085            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21086            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21087            GO TO 7200-DISPLAY-BATCHES
 21088         ELSE
 21089           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21090              PI-PB-GROUPING   = PB-GROUPING AND
 21091              PI-PB-STATE      = PB-STATE    AND
 21092              PI-PB-ACCOUNT    = PB-ACCOUNT
 21093              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21094              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21095              GO TO 7200-DISPLAY-BATCHES.
 21096
 21097     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21098     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21099
 21100
 21101* EXEC CICS HANDLE CONDITION
 21102*         NOTFND    (5050-NOT-FOUND)
 21103*    END-EXEC.
 21104*    MOVE '"$I                   ! T #00017809' TO DFHEIV0
 21105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21107     MOVE X'5420233030303137383039' TO DFHEIV0(25:11)
 21108     CALL 'kxdfhei1' USING DFHEIV0
 21109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21110
 21111
 21112
 21113* EXEC CICS READ
 21114*         DATASET   (FILE-ID-ERPNDB)
 21115*         SET       (ADDRESS OF PENDING-BUSINESS)
 21116*         RIDFLD    (ERPNDB-KEY)
 21117*         GTEQ
 21118*    END-EXEC.
 21119*    MOVE '&"S        G          (   #00017813' TO DFHEIV0
 21120     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21122     MOVE X'2020233030303137383133' TO DFHEIV0(25:11)
 21123     CALL 'kxdfhei1' USING DFHEIV0,
 21124           FILE-ID-ERPNDB,
 21125           DFHEIV20,
 21126           DFHEIV99,
 21127           ERPNDB-KEY,
 21128           DFHEIV99,
 21129           DFHEIV99,
 21130           DFHEIV99
 21131     SET ADDRESS OF PENDING-BUSINESS TO
 21132         DFHEIV20
 21133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21134
 21135
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 387
* EL6311.cbl
 21136     GO TO 5010-READ-NEXT-RECORD.
 21137
 21138 5050-NOT-FOUND.
 21139
 21140******************************************************************
 21141*                                                                *
 21142*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21143*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21144*         PROGRAM.                                               *
 21145*                                                                *
 21146******************************************************************
 21147
 21148     IF EIBTRNID NOT = TRANS-EXB1
 21149        IF PENDING-BUS-RECS-FOUND
 21150            NEXT SENTENCE
 21151          ELSE
 21152            MOVE '9'            TO PI-BROWSE-SW
 21153            GO TO 9400-CLEAR.
 21154
 21155     MOVE ER-2256                TO EMI-ERROR.
 21156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21157
 21158     IF PI-MAP-NAME = SPACES
 21159        MOVE EL631D              TO PI-MAP-NAME
 21160        MOVE -1                  TO DPFENTRL
 21161        GO TO 8100-SEND-INITIAL-MAP.
 21162
 21163     IF PI-MAP-NAME = EL631B
 21164        MOVE -1                  TO BMAINTL
 21165     ELSE
 21166        IF PI-MAP-NAME = EL631C
 21167           MOVE -1               TO CMAINTL
 21168        ELSE
 21169           MOVE -1               TO DPFENTRL
 21170           GO TO 8200-SEND-DATAONLY.
 21171
 21172     GO TO 8100-SEND-INITIAL-MAP.
 21173
 21174     .
 21175 5100-PROCESS-POL-RESC.
 21176     MOVE ZEROS                  TO CG-LF-BENCD
 21177                                    CG-AH-BENCD
 21178                                    CG-LF-CAN-AMT
 21179                                    CG-AH-CAN-AMT
 21180     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21181                                    CG-AH-CAN-DT
 21182     MOVE SPACES                 TO CG-BATCH-NO
 21183     MOVE '4'                    TO CG-OPTION-CODE
 21184     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21185     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21186     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21187     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21188     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21189     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21190     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21191     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21192     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21193     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 388
* EL6311.cbl
 21194     MOVE PI-PREV-ALT-KEY (1:33)
 21195                                 TO CG-CERT-KEY
 21196     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21197     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21198                                    CG-AH-CAN-AMT
 21199     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21200                                    CG-AH-CAN-DT
 21201     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21202     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21203      display 'about to cancel ' cg-cert-key
 21204
 21205* EXEC CICS LINK
 21206*        PROGRAM  ('ELCANC')
 21207*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21208*    END-EXEC
 21209     MOVE LENGTH OF
 21210      CANCEL-GEN-PASS-AREA
 21211       TO DFHEIV11
 21212     MOVE 'ELCANC' TO DFHEIV1
 21213*    MOVE '."C                   (   #00017888' TO DFHEIV0
 21214     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21215     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21216     MOVE X'2020233030303137383838' TO DFHEIV0(25:11)
 21217     CALL 'kxdfhei1' USING DFHEIV0,
 21218           DFHEIV1,
 21219           CANCEL-GEN-PASS-AREA,
 21220           DFHEIV11,
 21221           DFHEIV99,
 21222           DFHEIV99,
 21223           DFHEIV99,
 21224           DFHEIV99
 21225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21226     IF CG-SUCCESS
 21227        CONTINUE
 21228     ELSE
 21229        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21230        MOVE '3'                 TO EMI-SWITCH1
 21231        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21232        EVALUATE TRUE
 21233           WHEN CG-DATE-ERROR
 21234             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21235           WHEN CG-CERT-NOT-FOUND
 21236             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21237           WHEN CG-AMOUNT-ERROR
 21238             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21239           WHEN CG-OPTION-ERROR
 21240             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21241           WHEN CG-PREV-CAN
 21242             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21243           WHEN CG-INVALID-DATA
 21244             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21245           WHEN CG-NO-ACCT-MSTR
 21246             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21247           WHEN CG-SFX-A-EXIST
 21248             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21249           WHEN CG-MISC-ERROR
 21250             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21251           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 389
* EL6311.cbl
 21252             MOVE ' ERROR - ELCANC - RETURN '
 21253                                 TO EMI-ERROR-TEXT (1) (12:25)
 21254        END-EVALUATE
 21255        GO TO 8200-SEND-DATAONLY
 21256     END-IF
 21257     .
 21258 5100-EXIT.
 21259     EXIT.
 21260
 21261******************************************************************
 21262*                                                                *
 21263*        B R O W S E   B A T C H   B A C K W A R D S             *
 21264*                                                                *
 21265******************************************************************
 21266
 21267 5500-BROWSE-BATCH-BACKWARD.
 21268
 21269* EXEC CICS HANDLE CONDITION
 21270*         NOTFND   (5550-END-RECORDS)
 21271*         ENDFILE  (5550-END-RECORDS)
 21272*    END-EXEC.
 21273*    MOVE '"$I''                  ! U #00017934' TO DFHEIV0
 21274     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21276     MOVE X'5520233030303137393334' TO DFHEIV0(25:11)
 21277     CALL 'kxdfhei1' USING DFHEIV0
 21278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21279
 21280
 21281 5505-START-BROWSE.
 21282     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21283     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21284     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21285
 21286
 21287* EXEC CICS STARTBR
 21288*         DATASET   (FILE-ID-ERPNDB)
 21289*         RIDFLD    (ERPNDB-ALT-KEY)
 21290*    END-EXEC.
 21291     MOVE 0
 21292       TO DFHEIV11
 21293*    MOVE '&,         G          &   #00017944' TO DFHEIV0
 21294     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21295     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21296     MOVE X'2020233030303137393434' TO DFHEIV0(25:11)
 21297     CALL 'kxdfhei1' USING DFHEIV0,
 21298           FILE-ID-ERPNDB,
 21299           ERPNDB-ALT-KEY,
 21300           DFHEIV99,
 21301           DFHEIV11,
 21302           DFHEIV99
 21303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21304
 21305
 21306     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21307
 21308
 21309* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 390
* EL6311.cbl
 21310*         DATASET    (FILE-ID-ERPNDB)
 21311*         SET        (ADDRESS OF PENDING-BUSINESS)
 21312*         RIDFLD     (ERPNDB-KEY)
 21313*    END-EXEC.
 21314     MOVE 0
 21315       TO DFHEIV11
 21316*    MOVE '&.S                   )   #00017951' TO DFHEIV0
 21317     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21318     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21319     MOVE X'2020233030303137393531' TO DFHEIV0(25:11)
 21320     CALL 'kxdfhei1' USING DFHEIV0,
 21321           FILE-ID-ERPNDB,
 21322           DFHEIV20,
 21323           DFHEIV99,
 21324           ERPNDB-KEY,
 21325           DFHEIV99,
 21326           DFHEIV11,
 21327           DFHEIV99,
 21328           DFHEIV99
 21329     SET ADDRESS OF PENDING-BUSINESS TO
 21330         DFHEIV20
 21331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21332
 21333
 21334
 21335* EXEC CICS READPREV
 21336*         DATASET    (FILE-ID-ERPNDB)
 21337*         SET        (ADDRESS OF PENDING-BUSINESS)
 21338*         RIDFLD     (ERPNDB-KEY)
 21339*    END-EXEC.
 21340     MOVE 0
 21341       TO DFHEIV11
 21342*    MOVE '&0S                   )   #00017957' TO DFHEIV0
 21343     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21344     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21345     MOVE X'2020233030303137393537' TO DFHEIV0(25:11)
 21346     CALL 'kxdfhei1' USING DFHEIV0,
 21347           FILE-ID-ERPNDB,
 21348           DFHEIV20,
 21349           DFHEIV99,
 21350           ERPNDB-KEY,
 21351           DFHEIV99,
 21352           DFHEIV11,
 21353           DFHEIV99,
 21354           DFHEIV99
 21355     SET ADDRESS OF PENDING-BUSINESS TO
 21356         DFHEIV20
 21357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21358
 21359
 21360
 21361* EXEC CICS READPREV
 21362*         DATASET    (FILE-ID-ERPNDB)
 21363*         SET        (ADDRESS OF PENDING-BUSINESS)
 21364*         RIDFLD     (ERPNDB-KEY)
 21365*    END-EXEC.
 21366     MOVE 0
 21367       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 391
* EL6311.cbl
 21368*    MOVE '&0S                   )   #00017963' TO DFHEIV0
 21369     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21370     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21371     MOVE X'2020233030303137393633' TO DFHEIV0(25:11)
 21372     CALL 'kxdfhei1' USING DFHEIV0,
 21373           FILE-ID-ERPNDB,
 21374           DFHEIV20,
 21375           DFHEIV99,
 21376           ERPNDB-KEY,
 21377           DFHEIV99,
 21378           DFHEIV11,
 21379           DFHEIV99,
 21380           DFHEIV99
 21381     SET ADDRESS OF PENDING-BUSINESS TO
 21382         DFHEIV20
 21383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21384
 21385
 21386     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21387        GO TO 5550-END-RECORDS.
 21388
 21389     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21390
 21391     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21392
 21393     IF  WS-BATCH-PREFIX = '#CL'
 21394             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21395
 21396* EXEC CICS ENDBR
 21397*                 DATASET  (FILE-ID-ERPNDB)
 21398*            END-EXEC
 21399     MOVE 0
 21400       TO DFHEIV11
 21401*    MOVE '&2                    $   #00017978' TO DFHEIV0
 21402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21404     MOVE X'2020233030303137393738' TO DFHEIV0(25:11)
 21405     CALL 'kxdfhei1' USING DFHEIV0,
 21406           FILE-ID-ERPNDB,
 21407           DFHEIV11,
 21408           DFHEIV99
 21409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21410         GO TO 5505-START-BROWSE.
 21411
 21412     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21413         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21414             NEXT SENTENCE
 21415         ELSE
 21416             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21417
 21418* EXEC CICS ENDBR
 21419*                 DATASET  (FILE-ID-ERPNDB)
 21420*            END-EXEC
 21421     MOVE 0
 21422       TO DFHEIV11
 21423*    MOVE '&2                    $   #00017988' TO DFHEIV0
 21424     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21425     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 392
* EL6311.cbl
 21426     MOVE X'2020233030303137393838' TO DFHEIV0(25:11)
 21427     CALL 'kxdfhei1' USING DFHEIV0,
 21428           FILE-ID-ERPNDB,
 21429           DFHEIV11,
 21430           DFHEIV99
 21431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21432             GO TO 5505-START-BROWSE.
 21433
 21434
 21435     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21436         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21437             NEXT SENTENCE
 21438        ELSE
 21439             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21440
 21441* EXEC CICS ENDBR
 21442*                 DATASET  (FILE-ID-ERPNDB)
 21443*            END-EXEC
 21444     MOVE 0
 21445       TO DFHEIV11
 21446*    MOVE '&2                    $   #00017999' TO DFHEIV0
 21447     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21448     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21449     MOVE X'2020233030303137393939' TO DFHEIV0(25:11)
 21450     CALL 'kxdfhei1' USING DFHEIV0,
 21451           FILE-ID-ERPNDB,
 21452           DFHEIV11,
 21453           DFHEIV99
 21454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21455             GO TO 5505-START-BROWSE.
 21456
 21457     IF NOT PB-BATCH-TRAILER
 21458        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21459
 21460* EXEC CICS ENDBR
 21461*            DATASET  (FILE-ID-ERPNDB)
 21462*       END-EXEC
 21463     MOVE 0
 21464       TO DFHEIV11
 21465*    MOVE '&2                    $   #00018006' TO DFHEIV0
 21466     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21467     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21468     MOVE X'2020233030303138303036' TO DFHEIV0(25:11)
 21469     CALL 'kxdfhei1' USING DFHEIV0,
 21470           FILE-ID-ERPNDB,
 21471           DFHEIV11,
 21472           DFHEIV99
 21473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21474        GO TO 5505-START-BROWSE.
 21475
 21476     IF PI-CSR-BROWSE
 21477        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21478           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21479
 21480* EXEC CICS ENDBR
 21481*               DATASET  (FILE-ID-ERPNDB)
 21482*          END-EXEC
 21483     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 393
* EL6311.cbl
 21484       TO DFHEIV11
 21485*    MOVE '&2                    $   #00018014' TO DFHEIV0
 21486     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21487     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21488     MOVE X'2020233030303138303134' TO DFHEIV0(25:11)
 21489     CALL 'kxdfhei1' USING DFHEIV0,
 21490           FILE-ID-ERPNDB,
 21491           DFHEIV11,
 21492           DFHEIV99
 21493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21494           GO TO 5505-START-BROWSE.
 21495
 21496     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21497        IF PI-PB-CARRIER    = SPACES AND
 21498           PI-PB-GROUPING   = SPACES AND
 21499           PI-PB-STATE      = SPACES AND
 21500           PI-PB-ACCOUNT    = SPACES
 21501             GO TO 7200-DISPLAY-BATCHES
 21502          ELSE
 21503            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21504               PI-PB-GROUPING   = PB-GROUPING AND
 21505               PI-PB-STATE      = PB-STATE    AND
 21506               PI-PB-ACCOUNT    = PB-ACCOUNT
 21507                 GO TO 7200-DISPLAY-BATCHES.
 21508
 21509     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21510
 21511
 21512* EXEC CICS ENDBR
 21513*         DATASET  (FILE-ID-ERPNDB)
 21514*    END-EXEC.
 21515     MOVE 0
 21516       TO DFHEIV11
 21517*    MOVE '&2                    $   #00018034' TO DFHEIV0
 21518     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21519     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21520     MOVE X'2020233030303138303334' TO DFHEIV0(25:11)
 21521     CALL 'kxdfhei1' USING DFHEIV0,
 21522           FILE-ID-ERPNDB,
 21523           DFHEIV11,
 21524           DFHEIV99
 21525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21526
 21527
 21528     GO TO 5505-START-BROWSE.
 21529
 21530 5550-END-RECORDS.
 21531     MOVE ER-2257                TO EMI-ERROR.
 21532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21533     MOVE -1                     TO DPFENTRL.
 21534
 21535     GO TO 8200-SEND-DATAONLY.
 21536
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 394
* EL6311.cbl
 21538
 21539******************************************************************
 21540*                                                                *
 21541*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21542*                                                                *
 21543******************************************************************
 21544
 21545 6000-CREATE-TEMP-STORAGE.
 21546
 21547
 21548* EXEC CICS HANDLE CONDITION
 21549*        QIDERR  (6050-QID-ERROR)
 21550*    END-EXEC.
 21551*    MOVE '"$N                   ! V #00018057' TO DFHEIV0
 21552     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21554     MOVE X'5620233030303138303537' TO DFHEIV0(25:11)
 21555     CALL 'kxdfhei1' USING DFHEIV0
 21556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21557
 21558
 21559
 21560* EXEC CICS WRITEQ TS
 21561*        QUEUE    (QID)
 21562*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21563*        LENGTH   (WS-COMM-LENGTH)
 21564*        ITEM     (W-ONE)
 21565*    END-EXEC.
 21566*    MOVE '*" I                  ''   #00018061' TO DFHEIV0
 21567     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21568     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21569     MOVE X'2020233030303138303631' TO DFHEIV0(25:11)
 21570     CALL 'kxdfhei1' USING DFHEIV0,
 21571           QID,
 21572           PROGRAM-INTERFACE-BLOCK,
 21573           WS-COMM-LENGTH,
 21574           W-ONE,
 21575           DFHEIV99,
 21576           DFHEIV99
 21577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21578
 21579
 21580 6000-EXIT.
 21581      EXIT.
 21582
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 395
* EL6311.cbl
 21584
 21585******************************************************************
 21586*                                                                *
 21587*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21588*                                                                *
 21589******************************************************************
 21590
 21591 6050-RECOVER-TEMP-STORAGE.
 21592     IF PGM-NAME = XCTL-EL6312
 21593        GO TO 6050-EXIT.
 21594
 21595     IF PGM-NAME = XCTL-EL6313
 21596        GO TO 6050-EXIT.
 21597
 21598     IF PGM-NAME = XCTL-EL6315
 21599         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21600     END-IF
 21601
 21602     IF PGM-NAME = XCTL-EL6316
 21603         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21604     END-IF
 21605
 21606
 21607* EXEC CICS HANDLE CONDITION
 21608*        QIDERR  (6050-QID-ERROR)
 21609*    END-EXEC.
 21610*    MOVE '"$N                   ! W #00018094' TO DFHEIV0
 21611     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21613     MOVE X'5720233030303138303934' TO DFHEIV0(25:11)
 21614     CALL 'kxdfhei1' USING DFHEIV0
 21615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21616
 21617
 21618
 21619* EXEC CICS READQ TS
 21620*         QUEUE   (QID)
 21621*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21622*         LENGTH  (WS-COMM-LENGTH)
 21623*         ITEM    (W-ONE)
 21624*     END-EXEC.
 21625*    MOVE '*$II   L              ''   #00018098' TO DFHEIV0
 21626     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21627     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21628     MOVE X'2020233030303138303938' TO DFHEIV0(25:11)
 21629     CALL 'kxdfhei1' USING DFHEIV0,
 21630           QID,
 21631           PROGRAM-INTERFACE-BLOCK,
 21632           WS-COMM-LENGTH,
 21633           W-ONE,
 21634           DFHEIV99,
 21635           DFHEIV99
 21636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21637
 21638
 21639 6050-DELETE-TEMP-STORAGE.
 21640
 21641
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 396
* EL6311.cbl
 21642* EXEC CICS DELETEQ TS
 21643*        QUEUE   (QID)
 21644*    END-EXEC.
 21645*    MOVE '*&                    #   #00018107' TO DFHEIV0
 21646     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21647     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21648     MOVE X'2020233030303138313037' TO DFHEIV0(25:11)
 21649     CALL 'kxdfhei1' USING DFHEIV0,
 21650           QID,
 21651           DFHEIV99
 21652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21653
 21654
 21655     GO TO 6050-EXIT.
 21656
 21657 6050-QID-ERROR.
 21658     MOVE ER-0033                TO EMI-ERROR
 21659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21660
 21661 6050-EXIT.
 21662      EXIT.
 21663
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 397
* EL6311.cbl
 21665
 21666******************************************************************
 21667*                                                                *
 21668*            T E R M   C O N V E R S I O N                       *
 21669*                                                                *
 21670******************************************************************
 21671
 21672 6100-TERM-CONVERSION.
 21673
 21674     IF PI-BPMTS = ZERO
 21675         GO TO 6199-EXIT.
 21676
 21677     IF PI-BMODE = ' ' OR 'M'
 21678         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21679         GO TO 6105-ROUND-TERM.
 21680
 21681     IF PI-BMODE = 'S'
 21682         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21683         GO TO 6105-ROUND-TERM.
 21684
 21685     IF PI-BMODE = 'W'
 21686         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21687         GO TO 6105-ROUND-TERM.
 21688
 21689     IF PI-BMODE = 'B'
 21690         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21691         GO TO 6105-ROUND-TERM.
 21692
 21693     IF PI-BMODE = 'T'
 21694         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21695
 21696 6105-ROUND-TERM.
 21697
 21698     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21699         ADD +1                  TO WS-CALC-TERM-WHOLE
 21700         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21701
 21702     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21703         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21704
 21705     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21706         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21707                                      WS-BTERM    (WS-SUB1)
 21708         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21709
 21710     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21711         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21712             MOVE -1               TO BMODEL
 21713             MOVE ER-2593          TO EMI-ERROR
 21714             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21715             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21716
 21717 6124-CHECK-BENEFIT.
 21718
 21719     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21720        GO TO 6126-COMPUTE-BENEFIT.
 21721
 21722     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 398
* EL6311.cbl
 21723
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 399
* EL6311.cbl
 21725******************************************************************
 21726**         COMPUTE TERM AND BENEFIT
 21727******************************************************************
 21728 6125-COMPUTE-TERM-BENEFIT.
 21729
 21730     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21731        PI-BPMTAMT = ZERO
 21732         GO TO 6199-EXIT.
 21733
 21734     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21735                                     WS-BTERM  (WS-SUB1).
 21736     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21737
 21738 6126-COMPUTE-BENEFIT.
 21739
 21740     IF PI-BMODE = 'M' OR  ' '
 21741         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21742
 21743     IF PI-BMODE = 'W'
 21744         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21745
 21746     IF PI-BMODE = 'S'
 21747         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21748
 21749     IF PI-BMODE = 'B'
 21750         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21751
 21752     IF PI-BMODE = 'T'
 21753         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21754
 21755     IF WS-SUB1 = +1
 21756        COMPUTE WS-BBEN (WS-SUB1) =
 21757                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21758
 21759     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21760     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21761     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21762
 21763 6199-EXIT.
 21764     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 400
* EL6311.cbl
 21766
 21767******************************************************************
 21768*                                                                *
 21769*             D I S P L A Y   I S S U E S                        *
 21770*                                                                *
 21771******************************************************************
 21772
 21773 6200-CREATE-VADS.
 21774     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21775     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21776     MOVE SPACES                 TO WS-PASS-VADS-REC
 21777
 21778* EXEC CICS GETMAIN
 21779*       SET      (ADDRESS OF PENDING-BUSINESS)
 21780*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21781*       INITIMG  (GETMAIN-SPACE)
 21782*       RESP     (WS-RESPONSE)
 21783*    END-EXEC
 21784*    MOVE ',"IL                  $  N#00018233' TO DFHEIV0
 21785     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21786     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21787     MOVE X'204E233030303138323333' TO DFHEIV0(25:11)
 21788     CALL 'kxdfhei1' USING DFHEIV0,
 21789           DFHEIV20,
 21790           ERPNDB-RECORD-LENGTH,
 21791           GETMAIN-SPACE
 21792     SET ADDRESS OF PENDING-BUSINESS TO
 21793         DFHEIV20
 21794     MOVE EIBRESP  TO WS-RESPONSE
 21795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21796
 21797* EXEC CICS READ
 21798*       INTO    (PENDING-BUSINESS)
 21799*       DATASET (FILE-ID-ERPNDB)
 21800*       RIDFLD  (ERPNDB-KEY)
 21801*       RESP    (WS-RESPONSE)
 21802*    END-EXEC
 21803     MOVE LENGTH OF
 21804      PENDING-BUSINESS
 21805       TO DFHEIV11
 21806*    MOVE '&"IL       E          (  N#00018239' TO DFHEIV0
 21807     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21808     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21809     MOVE X'204E233030303138323339' TO DFHEIV0(25:11)
 21810     CALL 'kxdfhei1' USING DFHEIV0,
 21811           FILE-ID-ERPNDB,
 21812           PENDING-BUSINESS,
 21813           DFHEIV11,
 21814           ERPNDB-KEY,
 21815           DFHEIV99,
 21816           DFHEIV99,
 21817           DFHEIV99
 21818     MOVE EIBRESP  TO WS-RESPONSE
 21819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21820     IF RESP-NORMAL
 21821        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21822        IF (RESP-NORMAL)
 21823           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 401
* EL6311.cbl
 21824              AM-CONTROL-PRIMARY (1:20))
 21825           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21826        ELSE
 21827           MOVE 'ACCOUNT NOT FOUND'
 21828                                 TO VD-ACCOUNT-NAME
 21829        END-IF
 21830        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21831                                    TO M1
 21832        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21833        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21834           (A2 > M1)
 21835           OR (WS-WORK-FIELD (A2:1) = '*')
 21836           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21837           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21838        END-PERFORM
 21839        IF A2 > M1
 21840           CONTINUE
 21841        ELSE
 21842           MOVE WS-WORK-FIELD (1:A2 - 1)
 21843                                    TO VD-ACCOUNT-NAME
 21844        END-IF
 21845        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21846        MOVE PB-CARRIER          TO VD-CARRIER
 21847        MOVE PB-GROUPING         TO VD-GROUPING
 21848        MOVE PB-STATE            TO VD-STATE
 21849        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21850        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21851        MOVE PB-CERT-NO          TO VD-CERT-NO
 21852        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21853        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21854        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21855        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21856        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21857        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21858        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21859        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21860        MOVE PB-CSR-ID           TO VD-CSR-ID
 21861        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21862        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21863        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21864        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21865        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21866        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21867        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21868        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21869        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21870        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21871        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21872        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21873        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21874     END-IF
 21875     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21876
 21877
 21878* EXEC CICS GETMAIN
 21879*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21880*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21881*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 402
* EL6311.cbl
 21882*       RESP     (WS-RESPONSE)
 21883*    END-EXEC
 21884*    MOVE ',"IL                  $  N#00018302' TO DFHEIV0
 21885     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21886     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21887     MOVE X'204E233030303138333032' TO DFHEIV0(25:11)
 21888     CALL 'kxdfhei1' USING DFHEIV0,
 21889           DFHEIV20,
 21890           ERPNDM-RECORD-LENGTH,
 21891           GETMAIN-SPACE
 21892     SET ADDRESS OF PENDING-MAILING-DATA TO
 21893         DFHEIV20
 21894     MOVE EIBRESP  TO WS-RESPONSE
 21895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21896
 21897
 21898* EXEC CICS READ
 21899*       INTO    (PENDING-MAILING-DATA)
 21900*       DATASET (FILE-ID-ERPNDM)
 21901*       RIDFLD  (ERPNDM-KEY)
 21902*       RESP    (WS-RESPONSE)
 21903*    END-EXEC
 21904     MOVE LENGTH OF
 21905      PENDING-MAILING-DATA
 21906       TO DFHEIV11
 21907*    MOVE '&"IL       E          (  N#00018309' TO DFHEIV0
 21908     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21910     MOVE X'204E233030303138333039' TO DFHEIV0(25:11)
 21911     CALL 'kxdfhei1' USING DFHEIV0,
 21912           FILE-ID-ERPNDM,
 21913           PENDING-MAILING-DATA,
 21914           DFHEIV11,
 21915           ERPNDM-KEY,
 21916           DFHEIV99,
 21917           DFHEIV99,
 21918           DFHEIV99
 21919     MOVE EIBRESP  TO WS-RESPONSE
 21920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21921
 21922     IF RESP-NORMAL
 21923        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21924        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21925        MOVE PM-CITY              TO VD-INSURED-CITY
 21926        MOVE PM-STATE             TO VD-INSURED-STATE
 21927        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21928     END-IF
 21929
 21930     MOVE 'VAC1'                  TO VD-LETTER-ID
 21931     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21932     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21933     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21934     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21935     MOVE +0                      TO VD-ARCHIVE-NO
 21936     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21937     .
 21938 6200-EXIT.
 21939     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 403
* EL6311.cbl
 21940 6210-READ-ERACCT.
 21941     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21942     MOVE LOW-VALUES             TO ERACCT-FILL
 21943
 21944* EXEC CICS READ
 21945*         DATASET   ('ERACCT')
 21946*         INTO      (ACCOUNT-MASTER)
 21947*         RIDFLD    (ERACCT-KEY)
 21948*         GTEQ
 21949*         RESP      (WS-RESPONSE)
 21950*    END-EXEC
 21951     MOVE LENGTH OF
 21952      ACCOUNT-MASTER
 21953       TO DFHEIV11
 21954     MOVE 'ERACCT' TO DFHEIV1
 21955*    MOVE '&"IL       G          (  N#00018337' TO DFHEIV0
 21956     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21958     MOVE X'204E233030303138333337' TO DFHEIV0(25:11)
 21959     CALL 'kxdfhei1' USING DFHEIV0,
 21960           DFHEIV1,
 21961           ACCOUNT-MASTER,
 21962           DFHEIV11,
 21963           ERACCT-KEY,
 21964           DFHEIV99,
 21965           DFHEIV99,
 21966           DFHEIV99
 21967     MOVE EIBRESP  TO WS-RESPONSE
 21968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21969     .
 21970 6210-EXIT.
 21971     EXIT.
 21972
 21973 6220-READ-ERMAIL.
 21974
 21975     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21976     MOVE ' '                    TO WS-ERMAIL-SW
 21977
 21978
 21979* EXEC CICS READ
 21980*       DATASET   (FILE-ID-ERMAIL)
 21981*       SET       (ADDRESS OF MAILING-DATA)
 21982*       RIDFLD    (ERMAIL-KEY)
 21983*       RESP      (WS-RESPONSE)
 21984*    END-EXEC
 21985*    MOVE '&"S        E          (  N#00018353' TO DFHEIV0
 21986     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21987     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21988     MOVE X'204E233030303138333533' TO DFHEIV0(25:11)
 21989     CALL 'kxdfhei1' USING DFHEIV0,
 21990           FILE-ID-ERMAIL,
 21991           DFHEIV20,
 21992           DFHEIV99,
 21993           ERMAIL-KEY,
 21994           DFHEIV99,
 21995           DFHEIV99,
 21996           DFHEIV99
 21997     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 404
* EL6311.cbl
 21998         DFHEIV20
 21999     MOVE EIBRESP  TO WS-RESPONSE
 22000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22001
 22002     IF RESP-NORMAL
 22003        SET ERMAIL-FOUND TO TRUE
 22004     END-IF
 22005     .
 22006 6220-EXIT.
 22007     EXIT.
 22008
 22009 6400-CHECK-FOR-RES-REF-CLAIM.
 22010     display 'made it to 6400- for ' pi-cert-no
 22011     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22012
 22013     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22014                                    W-CL-COMP-CD.
 22015     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22016                                    W-CL-CERT-NO.
 22017     MOVE SPACES                 TO MSTR-CERT-SFX.
 22018
 22019
 22020* EXEC CICS HANDLE CONDITION
 22021*        NOTFND  (6400-CONTINUE)
 22022*        ENDFILE (6400-CONTINUE)
 22023*    END-EXEC.
 22024*    MOVE '"$I''                  ! X #00018377' TO DFHEIV0
 22025     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22027     MOVE X'5820233030303138333737' TO DFHEIV0(25:11)
 22028     CALL 'kxdfhei1' USING DFHEIV0
 22029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22030
 22031
 22032
 22033* EXEC CICS IGNORE CONDITION
 22034*        DUPKEY
 22035*    END-EXEC.
 22036*    MOVE '"*$                   !   #00018382' TO DFHEIV0
 22037     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22038     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22039     MOVE X'2020233030303138333832' TO DFHEIV0(25:11)
 22040     CALL 'kxdfhei1' USING DFHEIV0
 22041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22042
 22043
 22044
 22045* EXEC CICS STARTBR
 22046*        DATASET   (CLMS-ID)
 22047*        RIDFLD    (ELMSTR-KEY)
 22048*        GENERIC   EQUAL
 22049*        KEYLENGTH (ELMSTR-LENGTH)
 22050*    END-EXEC.
 22051     MOVE 0
 22052       TO DFHEIV11
 22053*    MOVE '&,   KG    E          &   #00018386' TO DFHEIV0
 22054     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22055     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 405
* EL6311.cbl
 22056     MOVE X'2020233030303138333836' TO DFHEIV0(25:11)
 22057     CALL 'kxdfhei1' USING DFHEIV0,
 22058           CLMS-ID,
 22059           ELMSTR-KEY,
 22060           ELMSTR-LENGTH,
 22061           DFHEIV11,
 22062           DFHEIV99
 22063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22064
 22065
 22066     display 'browse started'
 22067     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22068
 22069 6400-NEXT-CLAIM.
 22070
 22071
 22072* EXEC CICS READNEXT
 22073*        DATASET   (CLMS-ID)
 22074*        RIDFLD    (ELMSTR-KEY)
 22075*        SET       (ADDRESS OF CLAIM-MASTER)
 22076*    END-EXEC.
 22077     MOVE 0
 22078       TO DFHEIV11
 22079*    MOVE '&.S                   )   #00018398' TO DFHEIV0
 22080     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22081     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22082     MOVE X'2020233030303138333938' TO DFHEIV0(25:11)
 22083     CALL 'kxdfhei1' USING DFHEIV0,
 22084           CLMS-ID,
 22085           DFHEIV20,
 22086           DFHEIV99,
 22087           ELMSTR-KEY,
 22088           DFHEIV99,
 22089           DFHEIV11,
 22090           DFHEIV99,
 22091           DFHEIV99
 22092     SET ADDRESS OF CLAIM-MASTER TO
 22093         DFHEIV20
 22094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22095
 22096
 22097     display 'read claim for ' mstr-cert-no
 22098     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22099        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22100         GO TO 6400-CONTINUE
 22101     END-IF.
 22102
 22103     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22104        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22105        PI-STATE       NOT = CL-CERT-STATE     OR
 22106        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22107        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22108         GO TO 6400-NEXT-CLAIM
 22109     END-IF.
 22110
 22111     display 'found claim ' cl-claim-no
 22112        ' with denial type ' cl-denial-type
 22113     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 406
* EL6311.cbl
 22114         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22115         GO TO 6400-CONTINUE
 22116     END-IF.
 22117
 22118     GO TO 6400-NEXT-CLAIM.
 22119
 22120 6400-CONTINUE.
 22121
 22122     IF WS-BROWSE-STARTED-SW = 'Y'
 22123
 22124* EXEC CICS ENDBR
 22125*            DATASET   (CLMS-ID)
 22126*        END-EXEC
 22127     MOVE 0
 22128       TO DFHEIV11
 22129*    MOVE '&2                    $   #00018430' TO DFHEIV0
 22130     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22131     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22132     MOVE X'2020233030303138343330' TO DFHEIV0(25:11)
 22133     CALL 'kxdfhei1' USING DFHEIV0,
 22134           CLMS-ID,
 22135           DFHEIV11,
 22136           DFHEIV99
 22137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22138         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22139     END-IF.
 22140
 22141 6400-EXIT.
 22142     EXIT.
 22143
 22144 7000-DISPLAY-ISSUES.
 22145
 22146     IF PI-DISPLAY-ORIGINAL-BATCH
 22147        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22148        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22149     ELSE
 22150        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22151
 22152     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22153
 22154     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22155     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22156
 22157     MOVE LOW-VALUES                 TO EL631BI.
 22158     MOVE ZEROS                      TO PI-BPMTAMT
 22159                                        PI-BPMTS.
 22160     MOVE SPACE                      TO PI-BMODE
 22161                                        PI-BTYPE (1)
 22162                                        PI-BTYPE (2).
 22163     MOVE EL631B                     TO PI-MAP-NAME.
 22164     MOVE 'Y'                        TO PI-BROWSE-SW.
 22165     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22166                                        PI-HIGH-SEQ-NO.
 22167
 22168     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22169        MOVE AL-SABOF                TO BCHGTA
 22170        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22171        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 407
* EL6311.cbl
 22172     ELSE
 22173        MOVE AL-SADOF                TO BCHGTA
 22174                                        BCHGA
 22175        MOVE PB-CHG-COUNT            TO BCHGO.
 22176
 22177     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22178     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22179     MOVE WS-HR-MINS                 TO BMANTATO.
 22180
 22181     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22182        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22183        MOVE SPACE                   TO DC-OPTION-CODE
 22184        PERFORM 9700-DATE-LINK
 22185        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22186        MOVE 'INACTIVE'              TO BMOENDTO
 22187     ELSE
 22188        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22189        MOVE SPACE                   TO DC-OPTION-CODE
 22190        PERFORM 9700-DATE-LINK
 22191        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22192        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22193        MOVE SPACE                   TO DC-OPTION-CODE
 22194        PERFORM 9700-DATE-LINK
 22195        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22196
 22197*    MOVE PB-I-REFERENCE             TO BREFO.
 22198
 22199*    IF PI-COMPANY-ID EQUAL 'HER'
 22200*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22201*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22202*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22203*                MOVE WS-MEMBER-NO-1-8
 22204*                                TO  BMICRNOO.
 22205
 22206*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22207*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22208*            MOVE PB-I-MICROFILM-NO
 22209*                                TO  BMICRNOO.
 22210     IF PB-I-VIN NOT = SPACES
 22211        MOVE PB-I-VIN            TO BVINO
 22212     END-IF
 22213
 22214     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22215     MOVE PB-CERT-SFX                TO BSUFIXO.
 22216     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22217     MOVE SPACE                      TO DC-OPTION-CODE.
 22218     PERFORM 9700-DATE-LINK.
 22219     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22220
 22221     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22222     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22223     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22224     MOVE PB-I-INSURED-SEX           TO BSEXO
 22225
 22226     IF PB-I-AGE NOT = ZEROS
 22227         MOVE PB-I-AGE               TO BAGEO.
 22228
 22229     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 408
* EL6311.cbl
 22230                                 TO ELCERT-KEY
 22231     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22232     IF NOT CERT-TRL-REC-NOT-FOUND
 22233         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22234             MOVE 'AGE*'             TO BAGEDEFO
 22235         ELSE
 22236             MOVE 'AGE '             TO BAGEDEFO
 22237         END-IF
 22238     ELSE
 22239         MOVE 'AGE '             TO BAGEDEFO
 22240     END-IF
 22241
 22242     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22243         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22244         MOVE SPACE                  TO DC-OPTION-CODE
 22245         PERFORM 9700-DATE-LINK
 22246         IF NO-CONVERSION-ERROR
 22247            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22248
 22249     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22250         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22251         MOVE SPACE                  TO DC-OPTION-CODE
 22252         PERFORM 9700-DATE-LINK
 22253         IF NO-CONVERSION-ERROR
 22254            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22255
 22256     IF PB-I-EXTENTION-DAYS NUMERIC
 22257        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22258           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22259        ELSE
 22260           IF PB-I-TERM-IN-DAYS NUMERIC
 22261              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22262                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22263
 22264     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22265        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22266
 22267     MOVE PB-FORCE-CODE              TO BFORCEO.
 22268     MOVE PB-I-TERM-TYPE             TO BMODEO
 22269                                        PI-BMODE.
 22270
 22271     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22272        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22273
 22274     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22275         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22276                                        PI-BPMTS.
 22277
 22278     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22279         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22280           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22281                                        PI-BPMTAMT.
 22282
 22283     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22284     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22285     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22286     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22287     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 409
* EL6311.cbl
 22288     MOVE PB-I-SIG-SW                TO BSIGO.
 22289     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22290     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22291     MOVE PB-RECORD-BILL             TO BBILCDO.
 22292     MOVE PB-FORCE-CODE              TO BFORCEO.
 22293
 22294     IF (PB-I-LIVES NUMERIC)
 22295        AND (PB-I-LIVES > ZEROS)
 22296        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22297        IF (RESP-NORMAL)
 22298           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22299           CONTINUE
 22300        ELSE
 22301           MOVE PB-I-LIVES       TO BLIVESO
 22302        END-IF
 22303     END-IF
 22304
 22305     IF PB-I-NUM-BILLED NUMERIC AND
 22306        PB-I-NUM-BILLED GREATER THAN ZEROS
 22307        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22308*    ELSE
 22309*       MOVE ZEROS                   TO BBILLEDO.
 22310
 22311     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22312
 22313     IF PB-I-LOAN-APR NOT = +99.9999
 22314        MOVE PB-I-LOAN-APR           TO BAPRO.
 22315
 22316     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22317        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22318
 22319     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22320        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22321           MOVE AL-SANOF                TO BORIGHDA
 22322           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22323           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22324
 22325     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22326
 22327     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22328        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22329
 22330     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22331        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22332                                        PI-BTYPE (1).
 22333
 22334     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22335        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22336
 22337     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22338        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22339
 22340     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22341        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22342
 22343     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22344        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22345
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 410
* EL6311.cbl
 22346     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22347        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22348
 22349     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22350         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22351         MOVE SPACE                  TO DC-OPTION-CODE
 22352         PERFORM 9700-DATE-LINK
 22353         IF NO-CONVERSION-ERROR
 22354            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22355
 22356     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22357        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22358        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22359        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22360        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22361                 GIVING BDIFFO (1)
 22362     ELSE
 22363        MOVE SPACES                  TO BBEN-CD     (1)
 22364                                        BBEN-ABBR   (1).
 22365
 22366     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22367        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22368        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22369                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22370
 22371     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22372       IF PB-RECORD-ON-HOLD
 22373          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22374
 22375     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22376       IF PB-RECORD-RETURNED
 22377          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22378
 22379     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22380        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22381             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22382
 22383     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22384
 22385     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22386        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22387
 22388     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22389        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22390                                        PI-BTYPE (2).
 22391
 22392     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22393        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22394
 22395     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22396        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22397
 22398     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22399        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22400
 22401     IF PB-I-TOT-FEES NOT NUMERIC
 22402        MOVE ZEROS               TO PB-I-TOT-FEES
 22403     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 411
* EL6311.cbl
 22404     IF PB-I-TOT-FEES > ZEROS
 22405        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22406
 22407     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22408         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22409         MOVE SPACE                  TO DC-OPTION-CODE
 22410         PERFORM 9700-DATE-LINK
 22411         IF NO-CONVERSION-ERROR
 22412            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22413
 22414     IF PB-I-TOT-FEES > ZEROS
 22415        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22416        SUBTRACT PB-I-TOT-FEES FROM
 22417                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22418
 22419     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22420        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22421        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22422        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22423        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22424                 GIVING BDIFFO (2)
 22425     ELSE
 22426        MOVE SPACES                  TO BBEN-CD     (2)
 22427                                        BBEN-ABBR   (2).
 22428
 22429     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22430       IF PB-RECORD-ON-HOLD
 22431          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22432
 22433     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22434       IF PB-RECORD-RETURNED
 22435          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22436
 22437     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22438        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22439             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22440
 22441     MOVE PB-CSR-ID                  TO BCSRO.
 22442
 22443     IF PI-COMPANY-ID  =  'DMD'
 22444        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22445            NEXT SENTENCE
 22446        ELSE
 22447            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22448               MOVE 'NEW CERT'       TO BNCERTLI
 22449               MOVE EC-NEW-CERT      TO BNCERTO.
 22450
 22451     IF PI-COMPANY-ID  =  'DMD'
 22452        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22453            NEXT SENTENCE
 22454        ELSE
 22455           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22456               MOVE 'NEW STATE'      TO BNSTATLI
 22457               MOVE EC-NEW-STATE     TO BNSTATO.
 22458
 22459 7000-CONTINUE.
 22460     MOVE 'C'                        TO BMAINTI.
 22461     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 412
* EL6311.cbl
 22462
 22463     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22464        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22465
 22466     IF PI-6315-FINALIZED = 'Y'   AND
 22467        PB-UNFORCED-ERRORS
 22468          MOVE -1                TO BFORCEL
 22469          MOVE  1                TO SET-CURSOR-SW
 22470     END-IF
 22471
 22472     IF NO-CURSOR-SET
 22473        MOVE -1                      TO BMAINTL.
 22474
 22475     GO TO 8100-SEND-INITIAL-MAP.
 22476
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 413
* EL6311.cbl
 22478
 22479******************************************************************
 22480*                                                                *
 22481*             D I S P L A Y   C A N C E L S                      *
 22482*                                                                *
 22483******************************************************************
 22484
 22485 7100-DISPLAY-CANCELS.
 22486     IF PI-DISPLAY-ORIGINAL-BATCH
 22487        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22488        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22489     ELSE
 22490        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22491
 22492     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22493
 22494     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22495     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22496
 22497     MOVE LOW-VALUES                 TO EL631CI.
 22498     MOVE EL631C                     TO PI-MAP-NAME.
 22499     MOVE 'Y'                        TO PI-BROWSE-SW.
 22500     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22501                                        PI-HIGH-SEQ-NO.
 22502
 22503     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22504        MOVE AL-SABOF                TO CCHGTA
 22505        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22506        MOVE AL-SANON                TO CCHGA
 22507      ELSE
 22508        MOVE AL-SADOF                TO CCHGTA
 22509                                        CCHGA
 22510        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22511
 22512*    MOVE PB-C-REFERENCE             TO CREFO.
 22513
 22514*    IF PB-C-MICROFILM-NO IS NUMERIC
 22515*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22516*          MOVE PB-C-MICROFILM-NO
 22517*                                TO CMICRNOO
 22518*          MOVE AL-UNNON         TO CMICRNOA
 22519*       END-IF
 22520*    END-IF
 22521     IF PB-C-NH-INT-ON-REFS NUMERIC
 22522        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22523           MOVE PB-C-NH-INT-ON-REFS
 22524                                 TO CNHINTO
 22525           MOVE AL-SANOF         TO CNHINTA
 22526        END-IF
 22527     END-IF
 22528     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22529     MOVE PB-CERT-SFX                TO CSUFIXO.
 22530     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22531     MOVE SPACE                      TO DC-OPTION-CODE.
 22532     PERFORM 9700-DATE-LINK.
 22533     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22534
 22535     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 414
* EL6311.cbl
 22536        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22537        MOVE SPACE                   TO DC-OPTION-CODE
 22538        PERFORM 9700-DATE-LINK
 22539        IF NO-CONVERSION-ERROR
 22540           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22541
 22542     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22543        NEXT SENTENCE
 22544     ELSE
 22545        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22546
 22547     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22548        NEXT SENTENCE
 22549     ELSE
 22550        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22551
 22552     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22553        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22554        MOVE SPACE                   TO DC-OPTION-CODE
 22555        PERFORM 9700-DATE-LINK
 22556        IF NO-CONVERSION-ERROR
 22557           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22558
 22559     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22560         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22561
 22562     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22563         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22564
 22565     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22566        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22567        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22568                 GIVING CDRFND1O.
 22569
 22570     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22571        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22572        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22573                 GIVING CDRFND2O.
 22574
 22575     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22576       IF PB-RECORD-ON-HOLD
 22577          MOVE 'ON HOLD'             TO CBILIT1O.
 22578
 22579     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22580       IF PB-RECORD-RETURNED
 22581          MOVE 'RETURNED'            TO CBILIT1O.
 22582
 22583     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22584        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22585             MOVE 'OVERRIDE'         TO CBILIT1O.
 22586
 22587     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22588       IF PB-RECORD-ON-HOLD
 22589          MOVE 'ON HOLD'             TO CBILIT2O.
 22590
 22591     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22592       IF PB-RECORD-RETURNED
 22593          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 415
* EL6311.cbl
 22594
 22595     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22596        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22597             MOVE 'OVERRIDE'         TO CBILIT2O.
 22598
 22599     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22600     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22601     IF PB-C-POST-CARD-IND = 'Y'
 22602        MOVE 'Y'                     TO CPCYNO
 22603     ELSE
 22604        MOVE 'N'                     TO CPCYNO
 22605     END-IF
 22606     MOVE PB-FORCE-CODE              TO CFORCEO.
 22607     MOVE PB-RECORD-BILL             TO CBILCDO.
 22608     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22609     MOVE SPACES                     TO CINITSO.
 22610     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22611         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22612     ELSE
 22613         MOVE PB-CI-INITIALS         TO CINITSO
 22614     END-IF.
 22615
 22616     IF PB-CI-CANCEL-FEE NUMERIC
 22617        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22618        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22619     ELSE
 22620        MOVE ZEROES                  TO W-CANCEL-FEE.
 22621
 22622     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22623
 22624     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22625        ADD PB-CI-LF-PREMIUM-AMT
 22626             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22627
 22628     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22629        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22630
 22631     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22632     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22633     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22634     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22635
 22636     IF PB-C-LIVES NUMERIC
 22637        MOVE PB-C-LIVES              TO CLIVESO.
 22638
 22639     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22640        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22641
 22642     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22643        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22644        MOVE SPACE                   TO DC-OPTION-CODE
 22645        PERFORM 9700-DATE-LINK
 22646        IF NO-CONVERSION-ERROR
 22647           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22648
 22649     IF  PB-C-REFUND-CREATED
 22650         MOVE 'YES'                  TO CRFNDSWO
 22651     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 416
* EL6311.cbl
 22652         IF PB-C-REFUND-REQUESTED
 22653            MOVE 'REQ'               TO CRFNDSWO
 22654         ELSE
 22655            MOVE 'NO'                TO CRFNDSWO.
 22656
 22657     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22658     MOVE SPACE                      TO DC-OPTION-CODE.
 22659     PERFORM 9700-DATE-LINK.
 22660     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22661     MOVE PB-INPUT-BY                TO CENTBYO.
 22662
 22663     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22664        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22665        MOVE SPACE                   TO DC-OPTION-CODE
 22666        PERFORM 9700-DATE-LINK
 22667        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22668        MOVE 'INACTIVE'              TO CMOENDTO
 22669     ELSE
 22670        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22671        MOVE SPACE                   TO DC-OPTION-CODE
 22672        PERFORM 9700-DATE-LINK
 22673        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22674        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22675        MOVE SPACE                   TO DC-OPTION-CODE
 22676        PERFORM 9700-DATE-LINK
 22677        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22678
 22679     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22680
 22681     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22682     MOVE WS-HR-MINS                 TO CMANTATO.
 22683
 22684     EVALUATE PB-LF-REFUND-TYPE
 22685        WHEN '1'
 22686           MOVE 'RULE78'            TO CLFREFNO
 22687        WHEN '2'
 22688           MOVE 'PRORAT'            TO CLFREFNO
 22689        WHEN '3'
 22690           MOVE 'CALIF'             TO CLFREFNO
 22691        WHEN '4'
 22692           MOVE 'IRREG'             TO CLFREFNO
 22693        WHEN '5'
 22694           MOVE 'NETPAY'            TO CLFREFNO
 22695        WHEN '6'
 22696           MOVE 'ATCP'              TO CLFREFNO
 22697        WHEN '7'
 22698           MOVE 'UTAH'              TO CLFREFNO
 22699        WHEN '8'
 22700           MOVE 'MEAN'              TO CLFREFNO
 22701        WHEN '9'
 22702           MOVE 'SUM '              TO CLFREFNO
 22703        WHEN 'B'
 22704           MOVE 'BALN'              TO CLFREFNO
 22705     END-EVALUATE.
 22706
 22707     EVALUATE TRUE
 22708        WHEN PB-AH-REFUND-TYPE =  '1'
 22709           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 417
* EL6311.cbl
 22710        WHEN PB-AH-REFUND-TYPE =  '2'
 22711           MOVE 'PRORAT'            TO CAHREFNO
 22712        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22713           MOVE 'CALIF'             TO CAHREFNO
 22714        WHEN PB-AH-REFUND-TYPE =  '4'
 22715           MOVE 'IRREG'             TO CAHREFNO
 22716        WHEN PB-AH-REFUND-TYPE =  '5'
 22717           MOVE 'NETPAY'            TO CAHREFNO
 22718        WHEN PB-AH-REFUND-TYPE =  '6'
 22719           MOVE 'ATCP'              TO CAHREFNO
 22720        WHEN PB-AH-REFUND-TYPE =  '7'
 22721           MOVE 'UTAH'              TO CAHREFNO
 22722        WHEN PB-AH-REFUND-TYPE =  '8'
 22723           MOVE 'MEAN'              TO CAHREFNO
 22724        WHEN PB-AH-REFUND-TYPE =  '9'
 22725           MOVE 'SUM '              TO CAHREFNO
 22726        WHEN PB-AH-REFUND-TYPE =  'B'
 22727           MOVE 'BALN'              TO CAHREFNO
 22728     END-EVALUATE.
 22729
 22730     MOVE PB-REIN-CD                 TO CREINCDO.
 22731
 22732     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22733        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22734        MOVE SPACE                   TO DC-OPTION-CODE
 22735        PERFORM 9700-DATE-LINK
 22736        IF NO-CONVERSION-ERROR
 22737           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22738
 22739     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22740        MOVE 999999                  TO WS-EXP-DT-EDIT
 22741        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22742        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22743     ELSE
 22744        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22745           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22746           MOVE SPACE                   TO DC-OPTION-CODE
 22747           PERFORM 9700-DATE-LINK
 22748           IF NO-CONVERSION-ERROR
 22749              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22750
 22751     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22752        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22753           MOVE AL-SANOF                TO CORIGHDA
 22754           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22755           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22756
 22757     MOVE PB-CSR-ID              TO CCSRO.
 22758
 22759     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22760     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22761
 22762     MOVE 'C'                    TO CMAINTI.
 22763     MOVE AL-UANON               TO CMAINTA.
 22764
 22765     IF PI-6316-FINALIZED = 'Y'  AND
 22766        PB-UNFORCED-ERRORS
 22767          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 418
* EL6311.cbl
 22768          MOVE  1                TO SET-CURSOR-SW
 22769     END-IF
 22770
 22771     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22772        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22773
 22774     IF NO-CURSOR-SET
 22775        MOVE -1                  TO CMAINTL.
 22776
 22777     GO TO 8100-SEND-INITIAL-MAP.
 22778
 22779
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 419
* EL6311.cbl
 22781***************************************************************
 22782*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22783*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22784***************************************************************
 22785
 22786 7200-DISPLAY-BATCHES.
 22787     MOVE EL631D                 TO PI-MAP-NAME.
 22788     MOVE LOW-VALUES             TO EL631DI.
 22789
 22790     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22791
 22792
 22793* EXEC CICS HANDLE CONDITION
 22794*         NOTFND   (3690-NOT-FOUND)
 22795*    END-EXEC.
 22796*    MOVE '"$I                   ! Y #00019087' TO DFHEIV0
 22797     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22799     MOVE X'5920233030303139303837' TO DFHEIV0(25:11)
 22800     CALL 'kxdfhei1' USING DFHEIV0
 22801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22802
 22803
 22804     IF PI-DISPLAY-SCREEN
 22805        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22806     ELSE
 22807        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22808
 22809     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22810     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22811
 22812
 22813* EXEC CICS READ
 22814*         DATASET   (FILE-ID-ERPNDB)
 22815*         RIDFLD    (ERPNDB-KEY)
 22816*         SET       (ADDRESS OF PENDING-BUSINESS)
 22817*    END-EXEC.
 22818*    MOVE '&"S        E          (   #00019099' TO DFHEIV0
 22819     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22820     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22821     MOVE X'2020233030303139303939' TO DFHEIV0(25:11)
 22822     CALL 'kxdfhei1' USING DFHEIV0,
 22823           FILE-ID-ERPNDB,
 22824           DFHEIV20,
 22825           DFHEIV99,
 22826           ERPNDB-KEY,
 22827           DFHEIV99,
 22828           DFHEIV99,
 22829           DFHEIV99
 22830     SET ADDRESS OF PENDING-BUSINESS TO
 22831         DFHEIV20
 22832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22833
 22834
 22835     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22836     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22837     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22838     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 420
* EL6311.cbl
 22839     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22840
 22841     MOVE EL631D                 TO PI-MAP-NAME.
 22842     MOVE LOW-VALUES             TO EL631DI.
 22843     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22844
 22845*    IF PI-AR-PROCESSING
 22846*       MOVE PB-REFERENCE        TO DREFO.
 22847
 22848     MOVE PB-CSR-ID              TO DCSRO.
 22849
 22850     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22851        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22852        MOVE SPACE               TO DC-OPTION-CODE
 22853        PERFORM 9700-DATE-LINK
 22854        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22855        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22856        MOVE 'INACTIVE'          TO DLDATEO
 22857     ELSE
 22858        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22859        MOVE SPACE               TO DC-OPTION-CODE
 22860        PERFORM 9700-DATE-LINK
 22861        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22862
 22863     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22864     MOVE SPACE                  TO DC-OPTION-CODE.
 22865     PERFORM 9700-DATE-LINK.
 22866     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22867
 22868     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22869        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22870     ELSE
 22871        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22872        MOVE SPACE               TO DC-OPTION-CODE
 22873        PERFORM 9700-DATE-LINK
 22874        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22875
 22876     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22877     MOVE SPACE                  TO DC-OPTION-CODE.
 22878     PERFORM 9700-DATE-LINK.
 22879     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22880
 22881     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22882     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22883
 22884     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22885        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22886                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22887
 22888     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22889     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22890     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22891
 22892     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22893        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22894                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22895
 22896     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 421
* EL6311.cbl
 22897     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22898     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22899
 22900     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22901        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22902                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22903
 22904     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22905     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22906
 22907     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22908        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22909                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22910
 22911     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22912     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22913     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22914
 22915     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22916        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22917                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22918
 22919     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22920     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22921     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22922
 22923     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22924        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22925                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22926
 22927     MOVE -1                     TO DPFENTRL.
 22928     GO TO 8100-SEND-INITIAL-MAP.
 22929
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 422
* EL6311.cbl
 22931
 22932***************************************************************
 22933*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22934*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22935*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22936*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22937*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22938*     ARE THEN SET ACCORDINGLY.                               *
 22939*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22940*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22941*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22942***************************************************************
 22943
 22944******************************************************************
 22945*                                                                *
 22946*            E R R O R   A N A L Y S I S                         *
 22947*                                                                *
 22948******************************************************************
 22949
 22950******************************************************************
 22951*                                                                *
 22952*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22953*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22954*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22955*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22956*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22957*                                                                *
 22958*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22959*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22960*                                                                *
 22961******************************************************************
 22962
 22963 7300-FORMAT-ERRORS.
 22964     MOVE ' '                    TO PI-ERRORS-SW
 22965     IF PB-COMMON-ERRORS = LOW-VALUES
 22966        IF PB-FATAL-ERRORS
 22967           MOVE ER-2695          TO EMI-ERROR
 22968           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22969           GO TO 7399-EXIT.
 22970
 22971     MOVE +0                     TO WS-SUB4.
 22972
 22973 7310-ERROR-LOOP.
 22974
 22975     ADD +1                      TO WS-SUB4.
 22976
 22977     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22978        GO TO 7350-SET-ERROR-FLAGS.
 22979
 22980     IF PI-COMPANY-ID = 'UCL'
 22981         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22982             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22983             MOVE ' '                   TO DC-OPTION-CODE
 22984             PERFORM 9700-DATE-LINK
 22985             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22986
 22987     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22988     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 423
* EL6311.cbl
 22989     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22990
 22991     GO TO 7310-ERROR-LOOP.
 22992
 22993
 22994 7350-SET-ERROR-FLAGS.
 22995
 22996     IF EMI-FATAL-CTR NOT = ZEROS
 22997        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22998        MOVE 'X'                 TO PB-FATAL-FLAG
 22999                                    PI-ERRORS-SW
 23000        GO TO 7355-SET-ERROR-FLAGS.
 23001
 23002     move ' ' to pi-unforced-sw
 23003     IF EMI-FORCABLE-CTR NOT = ZEROS
 23004        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23005        IF PB-ISSUE
 23006           IF PB-ISSUE-FORCE
 23007              MOVE 'F'           TO PB-FORCE-ER-CD
 23008              MOVE ER-2600       TO EMI-ERROR
 23009              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23010             ELSE
 23011              MOVE 'X'           TO PB-FORCE-ER-CD
 23012*                                   PI-ERRORS-SW
 23013          ELSE
 23014           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23015              MOVE 'F'           TO PB-FORCE-ER-CD
 23016                                    pi-unforced-sw
 23017              MOVE ER-2600       TO EMI-ERROR
 23018              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23019             ELSE
 23020              MOVE 'X'           TO PB-FORCE-ER-CD
 23021                                    pi-unforced-sw.
 23022*                                   PI-ERRORS-SW.
 23023
 23024     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23025     IF PB-ISSUE
 23026         MOVE 'I'                TO ENDT-RECORD-TYPE
 23027     ELSE
 23028         MOVE 'C'                TO ENDT-RECORD-TYPE
 23029     END-IF
 23030     MOVE +0                     TO ENDT-SEQ-NO
 23031
 23032
 23033* EXEC CICS READ
 23034*        DATASET   (FILE-ID-ERENDT)
 23035*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23036*        RIDFLD    (ERENDT-KEY)
 23037*        RESP      (WS-RESPONSE)
 23038*        GTEQ
 23039*    END-EXEC
 23040*    MOVE '&"S        G          (  N#00019302' TO DFHEIV0
 23041     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23043     MOVE X'204E233030303139333032' TO DFHEIV0(25:11)
 23044     CALL 'kxdfhei1' USING DFHEIV0,
 23045           FILE-ID-ERENDT,
 23046           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 424
* EL6311.cbl
 23047           DFHEIV99,
 23048           ERENDT-KEY,
 23049           DFHEIV99,
 23050           DFHEIV99,
 23051           DFHEIV99
 23052     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23053         DFHEIV20
 23054     MOVE EIBRESP  TO WS-RESPONSE
 23055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23056
 23057     IF RESP-NORMAL
 23058        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23059        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23060            MOVE ER-0280          TO EMI-ERROR
 23061            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23062            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23063            EVALUATE TRUE
 23064              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23065                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23066              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23067                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23068              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23069                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23070            END-EVALUATE
 23071        END-IF
 23072     END-IF
 23073
 23074
 23075
 23076     IF FIRST-ENTRY OR
 23077        EIBAID = DFHPF1 OR DFHPF2
 23078        MOVE '0'                TO PI-EDIT-SW
 23079        GO TO 7399-EXIT.
 23080
 23081 7355-SET-ERROR-FLAGS.
 23082
 23083     IF EMI-WARNING-CTR NOT = ZEROS
 23084        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23085        MOVE 'W'                 TO PB-WARN-ER-CD.
 23086
 23087     IF PB-UNFORCED-ERRORS OR
 23088        PB-FATAL-ERRORS    OR
 23089        PB-RECORD-ON-HOLD  OR
 23090        PB-RECORD-RETURNED OR
 23091        PB-CANCELLATION
 23092          NEXT SENTENCE
 23093        ELSE
 23094          GO TO 7399-EXIT.
 23095
 23096
 23097* EXEC CICS  HANDLE CONDITION
 23098*           NOTFND   (7399-EXIT)
 23099*    END-EXEC.
 23100*    MOVE '"$I                   ! Z #00019349' TO DFHEIV0
 23101     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23103     MOVE X'5A20233030303139333439' TO DFHEIV0(25:11)
 23104     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 425
* EL6311.cbl
 23105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23106
 23107
 23108     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23109     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23110     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23111     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23112
 23113
 23114* EXEC CICS READ
 23115*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23116*        DATASET (FILE-ID-ELCERT)
 23117*        RIDFLD  (ELCERT-KEY)
 23118*        UPDATE
 23119*    END-EXEC.
 23120*    MOVE '&"S        EU         (   #00019358' TO DFHEIV0
 23121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23123     MOVE X'2020233030303139333538' TO DFHEIV0(25:11)
 23124     CALL 'kxdfhei1' USING DFHEIV0,
 23125           FILE-ID-ELCERT,
 23126           DFHEIV20,
 23127           DFHEIV99,
 23128           ELCERT-KEY,
 23129           DFHEIV99,
 23130           DFHEIV99,
 23131           DFHEIV99
 23132     SET ADDRESS OF CERTIFICATE-MASTER TO
 23133         DFHEIV20
 23134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23135
 23136
 23137
 23138     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23139     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23140
 23141     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23142        GO TO 7360-REWRITE-CERT-MASTER.
 23143
 23144     IF PB-ISSUE
 23145        IF PB-RECORD-RETURNED
 23146            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23147            GO TO 7360-REWRITE-CERT-MASTER
 23148        ELSE
 23149            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23150            GO TO 7360-REWRITE-CERT-MASTER.
 23151
 23152     IF PB-RECORD-RETURNED
 23153         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23154         GO TO 7360-REWRITE-CERT-MASTER.
 23155
 23156     IF (PB-C-LF-CANCEL-VOIDED)
 23157        or (pb-c-ah-cancel-voided)
 23158        IF (PB-UNFORCED-ERRORS OR
 23159            PB-FATAL-ERRORS    OR
 23160            PB-RECORD-ON-HOLD)
 23161            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23162            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 426
* EL6311.cbl
 23163        ELSE
 23164            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23165            GO TO 7360-REWRITE-CERT-MASTER.
 23166
 23167     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23168                            OR PB-RECORD-ON-HOLD)
 23169        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23170     ELSE
 23171        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23172
 23173 7360-REWRITE-CERT-MASTER.
 23174
 23175     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23176        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23177
 23178* EXEC CICS UNLOCK
 23179*            DATASET    (FILE-ID-ELCERT)
 23180*       END-EXEC
 23181*    MOVE '&*                    #   #00019405' TO DFHEIV0
 23182     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23183     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23184     MOVE X'2020233030303139343035' TO DFHEIV0(25:11)
 23185     CALL 'kxdfhei1' USING DFHEIV0,
 23186           FILE-ID-ELCERT,
 23187           DFHEIV99
 23188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23189        GO TO 7399-EXIT.
 23190
 23191
 23192* EXEC CICS REWRITE
 23193*         DATASET    (FILE-ID-ELCERT)
 23194*         FROM       (CERTIFICATE-MASTER)
 23195*    END-EXEC.
 23196     MOVE LENGTH OF
 23197      CERTIFICATE-MASTER
 23198       TO DFHEIV11
 23199*    MOVE '&& L                  %   #00019410' TO DFHEIV0
 23200     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23201     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23202     MOVE X'2020233030303139343130' TO DFHEIV0(25:11)
 23203     CALL 'kxdfhei1' USING DFHEIV0,
 23204           FILE-ID-ELCERT,
 23205           CERTIFICATE-MASTER,
 23206           DFHEIV11,
 23207           DFHEIV99
 23208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23209
 23210
 23211 7399-EXIT.
 23212      EXIT.
 23213
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 427
* EL6311.cbl
 23215
 23216*************************************************************
 23217*                                                           *
 23218*              S E T   A T T R I B U T E S                  *
 23219*                                                           *
 23220*************************************************************
 23221
 23222 7400-SET-ATTRIBUTES.
 23223
 23224     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23225        GO TO 7499-EXIT.
 23226
 23227**2601**
 23228
 23229     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23230        IF PB-ISSUE
 23231           MOVE AL-UABON         TO BEFFDTA
 23232           GO TO 7499-EXIT
 23233         ELSE
 23234           MOVE AL-UABON         TO CEFFDTA
 23235           GO TO 7499-EXIT.
 23236
 23237**2604**
 23238
 23239     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23240        IF PB-ISSUE
 23241           MOVE AL-UABON         TO BTYPE1A
 23242           MOVE -1               TO BTYPE1L
 23243           MOVE  1               TO SET-CURSOR-SW
 23244           GO TO 7499-EXIT.
 23245
 23246**2605**
 23247
 23248     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23249        IF PB-ISSUE
 23250           MOVE AL-UABON         TO BTYPE2A
 23251           MOVE -1               TO BTYPE2L
 23252           MOVE  1               TO SET-CURSOR-SW
 23253           GO TO 7499-EXIT.
 23254
 23255**2606**
 23256
 23257     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23258        IF PB-ISSUE
 23259           MOVE AL-UABON         TO BSIGA
 23260           MOVE -1               TO BSIGL
 23261           MOVE  1               TO SET-CURSOR-SW
 23262           GO TO 7499-EXIT.
 23263
 23264**2607**
 23265
 23266     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23267        IF PB-ISSUE
 23268           MOVE AL-UABON         TO BSIGA
 23269           MOVE -1               TO BSIGL
 23270           MOVE  1               TO SET-CURSOR-SW
 23271           GO TO 7499-EXIT.
 23272
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 428
* EL6311.cbl
 23273**2615**
 23274
 23275     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23276        IF PB-ISSUE
 23277           MOVE AL-UABOF         TO BREINA
 23278           MOVE -1               TO BREINL
 23279           GO TO 7499-EXIT.
 23280
 23281**2622**
 23282
 23283     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23284        IF PB-ISSUE
 23285           MOVE AL-UABON         TO BEFFDTA
 23286           GO TO 7499-EXIT
 23287        ELSE
 23288           MOVE AL-UABON         TO CEFFDTA
 23289           GO TO 7499-EXIT.
 23290
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 429
* EL6311.cbl
 23292
 23293*************************************************************
 23294*                                                           *
 23295*              I S S U E   E R R O R S                      *
 23296*                                                           *
 23297*************************************************************
 23298
 23299 7420-ISSUE-ERRORS.
 23300
 23301**2626**
 23302
 23303     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23304        MOVE AL-UABON            TO BCERTNOA
 23305        GO TO 7499-EXIT.
 23306
 23307**2627**
 23308
 23309     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23310        MOVE AL-UNBON            TO BAGEA
 23311        MOVE -1                  TO BAGEL
 23312        MOVE  1                  TO SET-CURSOR-SW
 23313        GO TO 7499-EXIT.
 23314
 23315**2628**
 23316
 23317     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23318        MOVE AL-UNBON            TO BAGEA
 23319        MOVE -1                  TO BAGEL
 23320        MOVE  1                  TO SET-CURSOR-SW
 23321        GO TO 7499-EXIT.
 23322
 23323**2629**
 23324
 23325     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23326        MOVE AL-UABON            TO BSEXA
 23327        MOVE -1                  TO BSEXL
 23328        MOVE  1                  TO SET-CURSOR-SW
 23329        GO TO 7499-EXIT.
 23330
 23331**2630**
 23332
 23333     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23334        MOVE -1                  TO BTYPE1L
 23335        MOVE  1                  TO SET-CURSOR-SW
 23336        GO TO 7499-EXIT.
 23337
 23338**2631**
 23339
 23340     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23341        MOVE -1                  TO BTYPE1L
 23342        MOVE  1                  TO SET-CURSOR-SW
 23343        GO TO 7499-EXIT.
 23344
 23345**2632**
 23346
 23347     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23348        MOVE AL-UNBON            TO BBEN1A
 23349        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 430
* EL6311.cbl
 23350        MOVE  1                  TO SET-CURSOR-SW
 23351        GO TO 7499-EXIT.
 23352
 23353**2633**
 23354
 23355     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23356        MOVE AL-UNBON            TO BPREM1A
 23357        MOVE -1                  TO BPREM1L
 23358        MOVE  1                  TO SET-CURSOR-SW
 23359        GO TO 7499-EXIT.
 23360
 23361**2634**
 23362
 23363     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23364        MOVE -1                  TO BTYPE2L
 23365        MOVE  1                  TO SET-CURSOR-SW
 23366        GO TO 7499-EXIT.
 23367
 23368**2635**
 23369
 23370     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23371        MOVE AL-UNBON            TO BBEN2A
 23372        MOVE -1                  TO BBEN2L
 23373        MOVE  1                  TO SET-CURSOR-SW
 23374        GO TO 7499-EXIT.
 23375
 23376**2636**
 23377
 23378     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23379        MOVE AL-UNBON            TO BPREM2A
 23380        MOVE -1                  TO BPREM2L
 23381        MOVE  1                  TO SET-CURSOR-SW
 23382        GO TO 7499-EXIT.
 23383
 23384**2639**
 23385
 23386     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23387        MOVE AL-UNBON            TO BBEN1A
 23388        MOVE -1                  TO BBEN1L
 23389        MOVE  1                  TO SET-CURSOR-SW
 23390        GO TO 7499-EXIT.
 23391
 23392**2640**
 23393
 23394     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23395        MOVE AL-UNBON            TO BBEN2A
 23396        MOVE -1                  TO BBEN2L
 23397        MOVE  1                  TO SET-CURSOR-SW
 23398        GO TO 7499-EXIT.
 23399
 23400**2647**
 23401
 23402     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23403        MOVE AL-UNBON            TO BTERM1A
 23404        MOVE -1                  TO BTERM1L
 23405        MOVE  1                  TO SET-CURSOR-SW
 23406        GO TO 7499-EXIT.
 23407
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 431
* EL6311.cbl
 23408**2648**
 23409
 23410     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23411        MOVE AL-UNBON            TO BLNTRMA
 23412        MOVE -1                  TO BLNTRML
 23413        MOVE  1                  TO SET-CURSOR-SW
 23414        GO TO 7499-EXIT.
 23415
 23416**2649**
 23417
 23418     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23419        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23420            MOVE AL-UNBON            TO BPREM1A
 23421            MOVE -1                  TO BPREM1L
 23422            MOVE  1                  TO SET-CURSOR-SW
 23423            GO TO 7499-EXIT
 23424     ELSE
 23425        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23426           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23427            MOVE AL-UNBON            TO BPREM2A
 23428            MOVE -1                  TO BPREM2L
 23429            MOVE  1                  TO SET-CURSOR-SW
 23430            GO TO 7499-EXIT.
 23431
 23432**2650**
 23433
 23434     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23435        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23436            MOVE AL-UNBON        TO BPREM1A
 23437            MOVE -1              TO BPREM1L
 23438            MOVE  1              TO SET-CURSOR-SW
 23439            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23440                MOVE AL-UNBON        TO BPREM2A
 23441                MOVE -1              TO BPREM2L
 23442                MOVE  1              TO SET-CURSOR-SW
 23443                GO TO 7499-EXIT
 23444            ELSE
 23445                GO TO 7499-EXIT
 23446        ELSE
 23447            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23448                MOVE AL-UNBON        TO BPREM2A
 23449                MOVE -1              TO BPREM2L
 23450                MOVE  1              TO SET-CURSOR-SW
 23451                GO TO 7499-EXIT
 23452            ELSE
 23453                GO TO 7499-EXIT.
 23454
 23455**2651**
 23456
 23457     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23458        MOVE AL-UABON            TO BSIGA
 23459        MOVE -1                  TO BSIGL
 23460        MOVE  1                  TO SET-CURSOR-SW
 23461        GO TO 7499-EXIT.
 23462
 23463**2653**
 23464
 23465     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 432
* EL6311.cbl
 23466        MOVE AL-UABON            TO BFREQA
 23467        MOVE -1                  TO BFREQL
 23468        MOVE  1                  TO SET-CURSOR-SW
 23469        GO TO 7499-EXIT.
 23470
 23471**2654**
 23472
 23473     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23474        MOVE AL-UABON            TO BFREQA
 23475        MOVE -1                  TO BFREQL
 23476        MOVE  1                  TO SET-CURSOR-SW
 23477        GO TO 7499-EXIT.
 23478
 23479**2655**
 23480
 23481     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23482        MOVE AL-UABON            TO BFREQA
 23483        MOVE -1                  TO BFREQL
 23484        MOVE  1                  TO SET-CURSOR-SW
 23485        GO TO 7499-EXIT.
 23486
 23487**2656**
 23488
 23489     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23490        MOVE AL-UNBON            TO BAPRA
 23491        MOVE -1                  TO BAPRL
 23492        MOVE  1                  TO SET-CURSOR-SW
 23493        GO TO 7499-EXIT.
 23494
 23495**2657**
 23496
 23497     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23498        MOVE AL-UNBON            TO BAPRA
 23499        MOVE -1                  TO BAPRL
 23500        MOVE  1                  TO SET-CURSOR-SW
 23501        GO TO 7499-EXIT.
 23502
 23503**2658**
 23504
 23505     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23506        MOVE AL-UNBON            TO BTERM2A
 23507        MOVE -1                  TO BTERM2L
 23508        MOVE  1                  TO SET-CURSOR-SW
 23509        GO TO 7499-EXIT.
 23510
 23511**2660**
 23512
 23513     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23514        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23515        MOVE -1                  TO BLSTNML
 23516        MOVE  1                  TO SET-CURSOR-SW
 23517        GO TO 7499-EXIT.
 23518
 23519
 23520**2662**
 23521
 23522     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23523        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 433
* EL6311.cbl
 23524        MOVE -1                  TO BAGEL
 23525        MOVE  1                  TO SET-CURSOR-SW
 23526        GO TO 7499-EXIT.
 23527
 23528**2663**
 23529
 23530     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23531        MOVE AL-UNBON            TO BAGEA
 23532        MOVE -1                  TO BAGEL
 23533        MOVE  1                  TO SET-CURSOR-SW
 23534        GO TO 7499-EXIT.
 23535
 23536**2664**
 23537
 23538     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23539        MOVE AL-UABON            TO BREINA
 23540        MOVE -1                  TO BREINL
 23541        MOVE  1                  TO SET-CURSOR-SW
 23542        GO TO 7499-EXIT.
 23543
 23544**2667**
 23545
 23546     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23547        MOVE AL-UNBON            TO BBEN2A
 23548        MOVE -1                  TO BBEN2L
 23549        MOVE  1                  TO SET-CURSOR-SW
 23550        GO TO 7499-EXIT.
 23551
 23552**2668**
 23553
 23554     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23555        MOVE AL-UABON            TO BEFFDTA
 23556        GO TO 7499-EXIT.
 23557
 23558**2669**
 23559
 23560     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23561       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23562       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23563        MOVE AL-UNBON            TO BAGEA
 23564        MOVE -1                  TO BAGEL
 23565        MOVE  1                  TO SET-CURSOR-SW
 23566        GO TO 7499-EXIT.
 23567
 23568**2670**
 23569
 23570     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23571        MOVE AL-UABON            TO BFORCEA
 23572        MOVE -1                  TO BFORCEL
 23573        MOVE  1                  TO SET-CURSOR-SW
 23574        GO TO 7499-EXIT.
 23575
 23576**2671**
 23577
 23578     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23579        MOVE AL-UABON            TO BEFFDTA
 23580        GO TO 7499-EXIT.
 23581
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 434
* EL6311.cbl
 23582**2672**
 23583
 23584     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23585        MOVE AL-UABON            TO BEFFDTA
 23586        GO TO 7499-EXIT.
 23587
 23588**2673**
 23589
 23590     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23591        MOVE AL-UABON            TO BEFFDTA
 23592        GO TO 7499-EXIT.
 23593
 23594**2674**
 23595
 23596     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23597        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23598        MOVE -1                  TO BTYPE1L
 23599        MOVE  1                  TO SET-CURSOR-SW
 23600        GO TO 7499-EXIT.
 23601
 23602**2677**
 23603
 23604     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23605        MOVE AL-UNBON            TO BTERM1A
 23606        MOVE -1                  TO BTERM1L
 23607        MOVE  1                  TO SET-CURSOR-SW
 23608        GO TO 7499-EXIT.
 23609
 23610**2678**
 23611
 23612     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23613        MOVE AL-UNBON            TO BTERM2A
 23614        MOVE -1                  TO BTERM2L
 23615        MOVE  1                  TO SET-CURSOR-SW
 23616        GO TO 7499-EXIT.
 23617
 23618**2679**
 23619
 23620     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23621        MOVE AL-UABON            TO BTYPE1A
 23622        MOVE -1                  TO BTYPE1L
 23623        MOVE  1                  TO SET-CURSOR-SW
 23624        GO TO 7499-EXIT.
 23625
 23626**2680**
 23627
 23628     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23629        MOVE AL-UABOF            TO B1STPMTA
 23630        MOVE -1                  TO B1STPMTL
 23631        MOVE  1                  TO SET-CURSOR-SW
 23632        GO TO 7499-EXIT.
 23633
 23634**2681**
 23635
 23636     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23637        MOVE AL-UABON            TO BDAYSA
 23638        MOVE -1                  TO BDAYSL
 23639        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 435
* EL6311.cbl
 23640        GO TO 7499-EXIT.
 23641
 23642**2682**
 23643
 23644     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23645        MOVE AL-UABON            TO BTERM1A
 23646        MOVE -1                  TO BTERM1L
 23647        MOVE  1                  TO SET-CURSOR-SW
 23648        GO TO 7499-EXIT.
 23649
 23650**2683**
 23651
 23652     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23653        MOVE AL-UABON            TO BSKPCDA
 23654        MOVE -1                  TO BSKPCDL
 23655        MOVE  1                  TO SET-CURSOR-SW
 23656        GO TO 7499-EXIT.
 23657
 23658**2684**
 23659
 23660     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23661        MOVE AL-UABON            TO BTYPE2A
 23662        MOVE -1                  TO BTYPE2L
 23663        MOVE  1                  TO SET-CURSOR-SW
 23664        GO TO 7499-EXIT.
 23665
 23666**2686**
 23667
 23668     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23669        MOVE AL-UABON            TO BTYPE2A
 23670        MOVE -1                  TO BTYPE2L
 23671        MOVE  1                  TO SET-CURSOR-SW
 23672        GO TO 7499-EXIT.
 23673
 23674**2689**
 23675
 23676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23677        MOVE AL-UABON            TO BSIGA
 23678        MOVE -1                  TO BSIGL
 23679        MOVE  1                  TO SET-CURSOR-SW
 23680        GO TO 7499-EXIT.
 23681
 23682**2690**
 23683
 23684     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23685        MOVE AL-UABOF            TO BLNOFCRA
 23686        MOVE -1                  TO BLNOFCRL
 23687        MOVE  1                  TO SET-CURSOR-SW
 23688        GO TO 7499-EXIT.
 23689
 23690**2693**
 23691
 23692     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23693        MOVE AL-UABOF            TO BLNOFCRA
 23694        MOVE AL-UNBON            TO BBEN1A
 23695        MOVE -1                  TO BBEN1L
 23696        MOVE  1                  TO SET-CURSOR-SW
 23697        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 436
* EL6311.cbl
 23698
 23699**2720**
 23700
 23701     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23702        MOVE AL-UNBON            TO BBEN1A
 23703        MOVE -1                  TO BBEN1L
 23704        MOVE  1                  TO SET-CURSOR-SW
 23705        GO TO 7499-EXIT.
 23706
 23707**2709**
 23708
 23709*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23710*       MOVE AL-UNBON            TO BBEN1A
 23711*       MOVE -1                  TO BBEN1L
 23712*       MOVE  1                  TO SET-CURSOR-SW
 23713*       GO TO 7499-EXIT.
 23714
 23715*************************************************************
 23716*                                                           *
 23717*            C A N C E L   E R R O R S                      *
 23718*                                                           *
 23719*************************************************************
 23720
 23721**2726**
 23722
 23723     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23724        MOVE AL-UABON            TO CCERTNOA
 23725        GO TO 7499-EXIT.
 23726
 23727**2728**
 23728
 23729     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23730        MOVE AL-UABON            TO CCERTNOA
 23731        GO TO 7499-EXIT.
 23732
 23733**2729**
 23734
 23735     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23736        MOVE AL-UABON            TO CCERTNOA
 23737        GO TO 7499-EXIT.
 23738
 23739**2730**
 23740
 23741     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23742        MOVE AL-UABON            TO CCERTNOA
 23743        GO TO 7499-EXIT.
 23744
 23745**2731**
 23746
 23747     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23748        MOVE AL-UABON            TO CCANDT1A
 23749        MOVE -1                  TO CCANDT1L
 23750        MOVE  1                  TO SET-CURSOR-SW
 23751        GO TO 7499-EXIT.
 23752
 23753**2732**
 23754
 23755     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 437
* EL6311.cbl
 23756        MOVE AL-UABON            TO CCANDT1A
 23757        MOVE -1                  TO CCANDT1L
 23758        MOVE  1                  TO SET-CURSOR-SW
 23759        GO TO 7499-EXIT.
 23760
 23761**2733**
 23762
 23763     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23764        MOVE AL-UABON            TO CCANDT1A
 23765        MOVE -1                  TO CCANDT1L
 23766        MOVE  1                  TO SET-CURSOR-SW
 23767        GO TO 7499-EXIT.
 23768
 23769**2734**
 23770
 23771     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23772        MOVE AL-UNBON            TO CREFND1A
 23773        MOVE -1                  TO CREFND1L
 23774        MOVE  1                  TO SET-CURSOR-SW
 23775        GO TO 7499-EXIT.
 23776
 23777**2735**
 23778
 23779     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23780        MOVE AL-UABON            TO CCANDT2A
 23781        MOVE -1                  TO CCANDT2L
 23782        MOVE  1                  TO SET-CURSOR-SW
 23783        GO TO 7499-EXIT.
 23784
 23785**2736**
 23786
 23787     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23788        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23789            MOVE AL-UNBON        TO CREFND1A
 23790            MOVE -1              TO CREFND1L
 23791            MOVE  1              TO SET-CURSOR-SW
 23792            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23793                MOVE AL-UNBON        TO CREFND2A
 23794                MOVE -1              TO CREFND2L
 23795                MOVE  1              TO SET-CURSOR-SW
 23796                GO TO 7499-EXIT
 23797            ELSE
 23798                GO TO 7499-EXIT
 23799        ELSE
 23800            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23801                MOVE AL-UNBON        TO CREFND2A
 23802                MOVE -1              TO CREFND2L
 23803                MOVE  1              TO SET-CURSOR-SW
 23804                GO TO 7499-EXIT
 23805            ELSE
 23806                GO TO 7499-EXIT.
 23807
 23808**2738**
 23809
 23810     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23811        MOVE -1                  TO CREFND2L
 23812        MOVE  1                  TO SET-CURSOR-SW
 23813        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 438
* EL6311.cbl
 23814
 23815**2739**
 23816
 23817     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23818        MOVE -1                  TO CREFND1L
 23819        MOVE  1                  TO SET-CURSOR-SW
 23820        GO TO 7499-EXIT.
 23821
 23822**2741**
 23823
 23824     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23825        MOVE -1                  TO CREFND1L
 23826        MOVE  1                  TO SET-CURSOR-SW
 23827        GO TO 7499-EXIT.
 23828
 23829**2743**
 23830
 23831     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23832        MOVE AL-UNBON            TO CCANDT1A
 23833        MOVE -1                  TO CCANDT1L
 23834        MOVE  1                  TO SET-CURSOR-SW
 23835        GO TO 7499-EXIT.
 23836
 23837**2744**
 23838
 23839     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23840        MOVE AL-UNBON            TO CCANDT2A
 23841        MOVE -1                  TO CCANDT2L
 23842        MOVE  1                  TO SET-CURSOR-SW
 23843        GO TO 7499-EXIT.
 23844
 23845**2747**
 23846
 23847     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23848        MOVE AL-UABON            TO CLSTNMA
 23849        MOVE -1                  TO CLSTNML
 23850        MOVE  1                  TO SET-CURSOR-SW
 23851        GO TO 7499-EXIT.
 23852
 23853**2749**
 23854
 23855     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23856        MOVE AL-UABON            TO CFORCEA
 23857        MOVE -1                  TO CFORCEL
 23858        MOVE  1                  TO SET-CURSOR-SW
 23859        GO TO 7499-EXIT.
 23860
 23861**2753**
 23862
 23863     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23864        MOVE AL-UNBON            TO CCANDT1A
 23865        MOVE -1                  TO CCANDT1L
 23866        MOVE  1                  TO SET-CURSOR-SW
 23867        GO TO 7499-EXIT.
 23868
 23869**2755**
 23870
 23871     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 439
* EL6311.cbl
 23872        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23873            MOVE AL-UNBON        TO CREFND1A
 23874            MOVE -1              TO CREFND1L
 23875            MOVE  1              TO SET-CURSOR-SW
 23876            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23877                MOVE AL-UNBON        TO CREFND2A
 23878                MOVE -1              TO CREFND2L
 23879                MOVE  1              TO SET-CURSOR-SW
 23880                GO TO 7499-EXIT
 23881            ELSE
 23882                GO TO 7499-EXIT
 23883        ELSE
 23884            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23885                MOVE AL-UNBON        TO CREFND2A
 23886                MOVE -1              TO CREFND2L
 23887                MOVE  1              TO SET-CURSOR-SW
 23888            ELSE
 23889                GO TO 7499-EXIT.
 23890
 23891**2757**
 23892
 23893     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23894        MOVE AL-UNBON            TO CLIVESA
 23895        MOVE -1                  TO CLIVESL
 23896        MOVE  1                  TO SET-CURSOR-SW
 23897        GO TO 7499-EXIT.
 23898
 23899**2771**
 23900
 23901     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23902        MOVE AL-UABON            TO CCANDT2A
 23903        MOVE -1                  TO CCANDT2L
 23904        MOVE  1                  TO SET-CURSOR-SW
 23905        GO TO 7499-EXIT.
 23906
 23907**2774**
 23908
 23909     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23910        MOVE AL-UABON            TO CCANDT1A
 23911        MOVE -1                  TO CCANDT1L
 23912        MOVE  1                  TO SET-CURSOR-SW
 23913        GO TO 7499-EXIT.
 23914
 23915**2775**
 23916
 23917     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23918        MOVE AL-UABON            TO CCANDT2A
 23919        MOVE -1                  TO CCANDT2L
 23920        MOVE  1                  TO SET-CURSOR-SW
 23921        GO TO 7499-EXIT.
 23922
 23923**2776**
 23924
 23925     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23926        MOVE AL-UABON            TO CCANDT1A
 23927        MOVE -1                  TO CCANDT1L
 23928        MOVE  1                  TO SET-CURSOR-SW
 23929        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 440
* EL6311.cbl
 23930
 23931
 23932**2777**
 23933
 23934     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23935        MOVE AL-UABON            TO CCANDT2A
 23936        MOVE -1                  TO CCANDT2L
 23937        MOVE  1                  TO SET-CURSOR-SW
 23938        GO TO 7499-EXIT.
 23939
 23940**2794**
 23941
 23942     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23943        MOVE AL-UABON            TO CFORCEA
 23944        MOVE -1                  TO CFORCEL
 23945        MOVE  1                  TO SET-CURSOR-SW
 23946        GO TO 7499-EXIT.
 23947
 23948**2799**
 23949
 23950     IF PI-COMPANY-ID = 'UCL'
 23951         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23952             MOVE AL-UNBON            TO BEFFDTA
 23953             MOVE -1                  TO BEFFDTL
 23954             MOVE  1                  TO SET-CURSOR-SW
 23955             GO TO 7499-EXIT.
 23956
 23957 7499-EXIT.
 23958      EXIT.
 23959
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 441
* EL6311.cbl
 23961
 23962 7500-READ-ERLOFC.
 23963     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23964                                     ERLOFC-KEY.
 23965
 23966     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23967
 23968     IF ST-ACCNT-CNTL
 23969         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23970
 23971     IF CARR-GROUP-ST-ACCNT-CNTL
 23972         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23973         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23974         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23975
 23976     IF CARR-ST-ACCNT-CNTL
 23977         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23978         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23979
 23980     IF CARR-ACCNT-CNTL
 23981         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23982
 23983     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23984
 23985     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23986
 23987
 23988* EXEC CICS HANDLE CONDITION
 23989*        NOTFND   (7550-OFFICER-NOTFND)
 23990*    END-EXEC.
 23991*    MOVE '"$I                   ! [ #00020191' TO DFHEIV0
 23992     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23994     MOVE X'5B20233030303230313931' TO DFHEIV0(25:11)
 23995     CALL 'kxdfhei1' USING DFHEIV0
 23996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23997
 23998
 23999
 24000* EXEC CICS READ
 24001*        DATASET   (FILE-ID-ERLOFC)
 24002*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24003*        RIDFLD    (ERLOFC-KEY)
 24004*        EQUAL
 24005*    END-EXEC.
 24006*    MOVE '&"S        E          (   #00020195' TO DFHEIV0
 24007     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24009     MOVE X'2020233030303230313935' TO DFHEIV0(25:11)
 24010     CALL 'kxdfhei1' USING DFHEIV0,
 24011           FILE-ID-ERLOFC,
 24012           DFHEIV20,
 24013           DFHEIV99,
 24014           ERLOFC-KEY,
 24015           DFHEIV99,
 24016           DFHEIV99,
 24017           DFHEIV99
 24018     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 442
* EL6311.cbl
 24019         DFHEIV20
 24020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24021
 24022
 24023     GO TO 7599-EXIT.
 24024
 24025 7550-OFFICER-NOTFND.
 24026     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24027
 24028 7599-EXIT.
 24029      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 443
* EL6311.cbl
 24031******************************************************************
 24032*                                                                *
 24033*            S  E N D    I N I T I A L   M A P                   *
 24034*                                                                *
 24035******************************************************************
 24036
 24037 8100-SEND-INITIAL-MAP.
 24038     MOVE EIBTIME                TO TIME-IN.
 24039
 24040     IF EIBAID = DFHPF11
 24041        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24042        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24043
 24044
 24045     IF PI-COMPANY-ID = CLIENT-GIC
 24046        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24047                                       BCPREM-ATTRB (2).
 24048
 24049     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24050                         CLIENT-PEM OR
 24051                         CLIENT-CSO)
 24052        AND PI-DISPLAY-ORIGINAL-BATCH
 24053          IF PI-MAP-NAME = EL631B
 24054             MOVE AL-SADOF               TO BPF5HDRA
 24055                                            BPF4HDRA
 24056          ELSE
 24057             IF PI-MAP-NAME = EL631C
 24058                MOVE AL-SADOF            TO CPF5HDRA
 24059                                            CPF4HDRA.
 24060
 24061     IF PI-MAP-NAME = EL631B
 24062        MOVE AL-SADOF               TO BPF5HDRA
 24063     ELSE
 24064        MOVE AL-SADOF               TO CPF5HDRA
 24065     END-IF
 24066
 24067*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24068     IF PI-MAP-NAME = EL631B
 24069          IF PI-COMPANY-ID NOT = 'DMD'
 24070             MOVE AL-SANOF            TO BBILLEDA
 24071             MOVE AL-SADOF            TO DMDBILA.
 24072*DMD CUSTOM CODING*************END
 24073
 24074     IF PI-PROCESSOR-ID = 'LGXX'
 24075        IF PI-MAP-NAME = EL631B
 24076           MOVE AL-SABOF                    TO BREFHDGA
 24077           MOVE AL-SANOF                    TO BREFA
 24078        ELSE
 24079           IF PI-MAP-NAME = EL631C
 24080              MOVE AL-SABOF                 TO CREFHDGA
 24081              MOVE AL-SANOF                 TO CREFA.
 24082
 24083*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 24084     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 24085        NEXT SENTENCE
 24086     ELSE
 24087        IF PI-MAP-NAME = EL631C
 24088           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 444
* EL6311.cbl
 24089                                       CCANFEEA.
 24090
 24091     IF PI-MAP-NAME = EL631D
 24092        IF PI-AR-PROCESSING
 24093           MOVE AL-SANOF            TO DREFHDGA
 24094        ELSE
 24095           MOVE AL-SADOF            TO DREFHDGA.
 24096
 24097     IF (PI-COMPANY-ID NOT = 'DCC' and 'CID')
 24098        AND (PI-MAP-NAME = EL631B)
 24099        MOVE AL-SADOF            TO BVINHA
 24100                                    BVINA
 24101     END-IF
 24102     IF PI-MAP-NAME = EL631B
 24103        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24104        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24105                                 TO BREGIONO
 24106        MOVE PI-PROCESSOR-ID     TO BUSERO
 24107        IF CSR-EDIT-SESSION
 24108           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24109                                 TO BHEADO
 24110           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24111        ELSE
 24112           MOVE AL-SADOF         TO BF15HDRA
 24113           MOVE '4=B-HDR      '  TO BPF4HDRO
 24114        END-IF
 24115        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24116        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24117        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24118        MOVE WS-CURRENT-DT          TO BDATEO
 24119        MOVE TIME-OUT               TO BTIMEO
 24120        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24121        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24122        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24123        IF   WS-DISPLAY-SCREEN
 24124             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24125             MOVE PB-SV-CARRIER     TO BCARRO
 24126             MOVE PB-SV-GROUPING    TO BGROUPO
 24127             MOVE PB-SV-STATE       TO BSTATEO
 24128             MOVE PB-ACCOUNT        TO BACCTO
 24129        ELSE
 24130             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24131     ELSE
 24132        IF PI-MAP-NAME = EL631C
 24133           MOVE '4=B-HDR      '     TO CPF4HDRO
 24134           IF CSR-EDIT-SESSION
 24135              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24136                                 TO CHEADO
 24137           ELSE
 24138              MOVE AL-SADOF      TO CF15HDRA
 24139           END-IF
 24140           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24141           MOVE WS-CURRENT-DT          TO CDATEO
 24142           MOVE TIME-OUT               TO CTIMEO
 24143           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24144           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24145           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24146           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 445
* EL6311.cbl
 24147           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24148           MOVE WS-C-HDG               TO CAHHDGO
 24149           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24150           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24151           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24152           IF   WS-DISPLAY-SCREEN
 24153                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24154                MOVE PB-SV-CARRIER     TO CCARRO
 24155                MOVE PB-SV-GROUPING    TO CGROUPO
 24156                MOVE PB-SV-STATE       TO CSTATEO
 24157                MOVE PB-ACCOUNT        TO CACCTO
 24158           ELSE
 24159                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24160        ELSE
 24161           MOVE WS-CURRENT-DT          TO DDATEO
 24162           MOVE TIME-OUT               TO DTIMEO
 24163           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24164                                          WS-REFUND-HDG-OVERRIDE
 24165           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24166           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24167           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24168                                          WS-REFUND-HDG-OVERRIDE
 24169           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24170           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24171           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24172           IF CSR-EDIT-SESSION
 24173              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24174                                 TO DHEADO
 24175           END-IF
 24176           IF  WS-DISPLAY-SCREEN
 24177               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24178               MOVE PB-CARRIER         TO DCARRO
 24179               MOVE PB-GROUPING        TO DGROUPO
 24180               MOVE PB-STATE           TO DSTATEO
 24181               MOVE PB-ACCOUNT         TO DACCTO
 24182               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24183           ELSE
 24184               MOVE EL631D             TO PI-MAP-NAME
 24185               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24186               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24187
 24188     MOVE SPACE                        TO WS-DISPLAY-SW.
 24189
 24190
 24191* EXEC CICS SEND
 24192*        MAP      (PI-MAP-NAME)
 24193*        MAPSET   (MAPSET-EL6311S)
 24194*        FROM     (EL631BI)
 24195*        ERASE
 24196*        CURSOR
 24197*    END-EXEC.
 24198     MOVE LENGTH OF
 24199      EL631BI
 24200       TO DFHEIV12
 24201     MOVE -1
 24202       TO DFHEIV11
 24203*    MOVE '8$     CT  E    H L F ,   #00020369' TO DFHEIV0
 24204     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 446
* EL6311.cbl
 24205     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24206     MOVE X'2020233030303230333639' TO DFHEIV0(25:11)
 24207     CALL 'kxdfhei1' USING DFHEIV0,
 24208           PI-MAP-NAME,
 24209           EL631BI,
 24210           DFHEIV12,
 24211           MAPSET-EL6311S,
 24212           DFHEIV99,
 24213           DFHEIV99,
 24214           DFHEIV99,
 24215           DFHEIV11,
 24216           DFHEIV99,
 24217           DFHEIV99,
 24218           DFHEIV99
 24219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24220
 24221
 24222     GO TO 9100-RETURN-TRAN.
 24223
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 447
* EL6311.cbl
 24225
 24226******************************************************************
 24227*                                                                *
 24228*              S E N D    D A T A O N L Y                        *
 24229*                                                                *
 24230******************************************************************
 24231
 24232 8200-SEND-DATAONLY.
 24233     MOVE EIBTIME                TO TIME-IN.
 24234
 24235     IF PI-COMPANY-ID = CLIENT-GIC
 24236        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24237                                       BCPREM-ATTRB (2).
 24238
 24239     IF PI-MAP-NAME = EL631B
 24240        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24241        MOVE WS-CURRENT-DT          TO BDATEO
 24242        MOVE TIME-OUT               TO BTIMEO
 24243        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24244        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24245        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24246        MOVE SPACES                 TO BPFENTRO
 24247        MOVE AL-UANOF               TO BPFENTRA
 24248
 24249*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24250        IF PI-COMPANY-ID NOT = 'DMD'
 24251             MOVE AL-SANOF            TO BBILLEDA
 24252             MOVE AL-SADOF            TO DMDBILA
 24253         ELSE
 24254            NEXT SENTENCE
 24255*DMD CUSTOM CODING*************END
 24256     ELSE
 24257        IF PI-MAP-NAME = EL631C
 24258           MOVE WS-CURRENT-DT          TO CDATEO
 24259           MOVE TIME-OUT               TO CTIMEO
 24260           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24261           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24262           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24263           MOVE SPACES                 TO CPFENTRO
 24264           MOVE AL-UANOF               TO CPFENTRA
 24265        ELSE
 24266           MOVE WS-CURRENT-DT          TO DDATEO
 24267           MOVE TIME-OUT               TO DTIMEO
 24268           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24269
 24270
 24271* EXEC CICS SEND
 24272*        MAP      (PI-MAP-NAME)
 24273*        MAPSET   (MAPSET-EL6311S)
 24274*        FROM     (EL631BI)
 24275*        DATAONLY
 24276*        CURSOR
 24277*    END-EXEC.
 24278     MOVE LENGTH OF
 24279      EL631BI
 24280       TO DFHEIV12
 24281     MOVE -1
 24282       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 448
* EL6311.cbl
 24283*    MOVE '8$D    CT       H L F ,   #00020425' TO DFHEIV0
 24284     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24285     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24286     MOVE X'2020233030303230343235' TO DFHEIV0(25:11)
 24287     CALL 'kxdfhei1' USING DFHEIV0,
 24288           PI-MAP-NAME,
 24289           EL631BI,
 24290           DFHEIV12,
 24291           MAPSET-EL6311S,
 24292           DFHEIV99,
 24293           DFHEIV99,
 24294           DFHEIV99,
 24295           DFHEIV11,
 24296           DFHEIV99,
 24297           DFHEIV99,
 24298           DFHEIV99
 24299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24300
 24301
 24302     GO TO 9100-RETURN-TRAN.
 24303
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 449
* EL6311.cbl
 24305
 24306******************************************************************
 24307*                                                                *
 24308*           U T I L I T Y   R O U T I N E S                      *
 24309*                                                                *
 24310******************************************************************
 24311
 24312 8300-SEND-TEXT.
 24313
 24314* EXEC CICS SEND TEXT
 24315*        FROM     (LOGOFF-TEXT)
 24316*        LENGTH   (LOGOFF-LENGTH)
 24317*        ERASE
 24318*        FREEKB
 24319*    END-EXEC.
 24320*    MOVE '8&      T  E F  H   F -   #00020444' TO DFHEIV0
 24321     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24322     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24323     MOVE X'2020233030303230343434' TO DFHEIV0(25:11)
 24324     CALL 'kxdfhei1' USING DFHEIV0,
 24325           LOGOFF-TEXT,
 24326           LOGOFF-LENGTH,
 24327           DFHEIV99,
 24328           DFHEIV99,
 24329           DFHEIV99,
 24330           DFHEIV99,
 24331           DFHEIV99,
 24332           DFHEIV99,
 24333           DFHEIV99,
 24334           DFHEIV99,
 24335           DFHEIV99,
 24336           DFHEIV99
 24337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24338
 24339
 24340
 24341* EXEC CICS RETURN
 24342*    END-EXEC.
 24343*    MOVE '.(                    ''   #00020451' TO DFHEIV0
 24344     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24345     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24346     MOVE X'2020233030303230343531' TO DFHEIV0(25:11)
 24347     CALL 'kxdfhei1' USING DFHEIV0,
 24348           DFHEIV99,
 24349           DFHEIV99,
 24350           DFHEIV99,
 24351           DFHEIV99,
 24352           DFHEIV99,
 24353           DFHEIV99
 24354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24355
 24356
 24357 8400-LOG-JOURNAL-RECORD.
 24358     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24359     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24360
 24361*    EXEC CICS JOURNAL
 24362*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 450
* EL6311.cbl
 24363*        JTYPEID     ('EL')
 24364*        FROM        (JOURNAL-RECORD)
 24365*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24366*    END-EXEC.
 24367
 24368 8600-DEEDIT.
 24369
 24370* EXEC CICS BIF DEEDIT
 24371*         FIELD   (DEEDIT-FIELD)
 24372*         LENGTH  (15)
 24373*    END-EXEC.
 24374     MOVE 15
 24375       TO DFHEIV11
 24376*    MOVE '@"L                   #   #00020466' TO DFHEIV0
 24377     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24378     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24379     MOVE X'2020233030303230343636' TO DFHEIV0(25:11)
 24380     CALL 'kxdfhei1' USING DFHEIV0,
 24381           DEEDIT-FIELD,
 24382           DFHEIV11
 24383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24384
 24385
 24386 8800-UNAUTHORIZED-ACCESS.
 24387     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24388     GO TO 8300-SEND-TEXT.
 24389
 24390 8810-PF23.
 24391     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24392     MOVE XCTL-EL005             TO PGM-NAME.
 24393     GO TO 9300-XCTL.
 24394
 24395 9100-RETURN-TRAN.
 24396     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24397
 24398     IF  PI-MAP-NAME =  EL631B
 24399         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24400
 24401     IF  PI-MAP-NAME =  EL631C
 24402         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24403
 24404     IF  PI-MAP-NAME =  EL631D
 24405         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24406
 24407
 24408* EXEC CICS RETURN
 24409*        TRANSID    (TRANS-EXB1)
 24410*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24411*        LENGTH     (1300)
 24412*    END-EXEC.
 24413     MOVE 1300
 24414       TO DFHEIV11
 24415*    MOVE '.(CT                  ''   #00020492' TO DFHEIV0
 24416     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24417     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24418     MOVE X'2020233030303230343932' TO DFHEIV0(25:11)
 24419     CALL 'kxdfhei1' USING DFHEIV0,
 24420           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 451
* EL6311.cbl
 24421           PROGRAM-INTERFACE-BLOCK,
 24422           DFHEIV11,
 24423           DFHEIV99,
 24424           DFHEIV99,
 24425           DFHEIV99
 24426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24427
 24428
 24429 9200-RETURN-MAIN-MENU.
 24430     MOVE XCTL-EL626             TO PGM-NAME.
 24431     GO TO 9300-XCTL.
 24432
 24433 9300-XCTL.
 24434
 24435* EXEC CICS XCTL
 24436*        PROGRAM    (PGM-NAME)
 24437*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24438*        LENGTH     (PI-COMM-LENGTH)
 24439*    END-EXEC.
 24440*    MOVE '.$C                   %   #00020503' TO DFHEIV0
 24441     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24442     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24443     MOVE X'2020233030303230353033' TO DFHEIV0(25:11)
 24444     CALL 'kxdfhei1' USING DFHEIV0,
 24445           PGM-NAME,
 24446           PROGRAM-INTERFACE-BLOCK,
 24447           PI-COMM-LENGTH,
 24448           DFHEIV99
 24449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24450
 24451
 24452 9400-CLEAR.
 24453     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24454     GO TO 9300-XCTL.
 24455
 24456 9500-PF12.
 24457     MOVE XCTL-EL010             TO PGM-NAME.
 24458     GO TO 9300-XCTL.
 24459
 24460 9600-PGMID-ERROR.
 24461
 24462* EXEC CICS HANDLE CONDITION
 24463*        PGMIDERR    (8300-SEND-TEXT)
 24464*    END-EXEC.
 24465*    MOVE '"$L                   ! \ #00020518' TO DFHEIV0
 24466     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24468     MOVE X'5C20233030303230353138' TO DFHEIV0(25:11)
 24469     CALL 'kxdfhei1' USING DFHEIV0
 24470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24471
 24472
 24473     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24474     MOVE ' '                    TO PI-ENTRY-CD-1.
 24475     MOVE XCTL-EL005             TO PGM-NAME.
 24476     MOVE PGM-NAME               TO LOGOFF-PGM.
 24477     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24478     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 452
* EL6311.cbl
 24479
 24480 9700-DATE-LINK.
 24481     MOVE LINK-ELDATCV           TO PGM-NAME.
 24482
 24483* EXEC CICS LINK
 24484*        PROGRAM    (PGM-NAME)
 24485*        COMMAREA   (DATE-CONVERSION-DATA)
 24486*        LENGTH     (DC-COMM-LENGTH)
 24487*    END-EXEC.
 24488*    MOVE '."C                   (   #00020531' TO DFHEIV0
 24489     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24491     MOVE X'2020233030303230353331' TO DFHEIV0(25:11)
 24492     CALL 'kxdfhei1' USING DFHEIV0,
 24493           PGM-NAME,
 24494           DATE-CONVERSION-DATA,
 24495           DC-COMM-LENGTH,
 24496           DFHEIV99,
 24497           DFHEIV99,
 24498           DFHEIV99,
 24499           DFHEIV99
 24500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24501
 24502
 24503 9800-LINK-PENDING-EDIT.
 24504     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24505     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24506
 24507     MOVE LINK-EL050             TO PGM-NAME
 24508     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24509     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24510                                    WK-CO-TOL-CLAIM
 24511                                    WK-CO-TOL-PREM
 24512                                    WK-CO-TOL-REFUND
 24513                                    WK-CO-TOL-PREM-PCT
 24514                                    WK-CO-TOL-REFUND-PCT
 24515                                    WK-REFUND-OVS-AMT
 24516                                    WK-REFUND-OVS-PCT
 24517                                    WK-ACCT-ADDR
 24518                                    WK-LIFE-EDIT-ADDR
 24519                                    WK-AH-EDIT-ADDR
 24520                                    WK-LIFE-BEN-ADDR
 24521                                    WK-AH-BEN-ADDR
 24522                                    WK-STATE-ADDR
 24523                                    WK-PLAN-ADDR
 24524                                    WK-FORM-ADDR
 24525     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24526
 24527     MOVE '6'                    TO WK-ENTRY-SW.
 24528
 24529     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24530
 24531     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24532                                    EC-AM-EXPIRATION-DT
 24533                                    EC-AM-EFFECTIVE-DT
 24534                                    EC-CM-LF-CANCEL-DT
 24535                                    EC-CM-AH-CANCEL-DT
 24536                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 453
* EL6311.cbl
 24537
 24538     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24539                                    EC-CO-TOL-REFUND
 24540                                    EC-CO-MIN-AGE
 24541                                    EC-CO-MIN-PREMIUM
 24542                                    EC-CO-MIN-TERM
 24543                                    EC-CO-MAX-TERM
 24544                                    EC-ST-TOL-PREM
 24545                                    EC-ST-TOL-REFUND
 24546                                    EC-AM-LF-TOL-PREM
 24547                                    EC-AM-AH-TOL-PREM
 24548                                    EC-AM-LF-MAX-ATT-AGE
 24549                                    EC-AM-LF-MAX-AGE
 24550                                    EC-AM-LF-MAX-TERM
 24551                                    EC-AM-LF-MAX-TOT-BEN
 24552                                    EC-AM-AH-MAX-ATT-AGE
 24553                                    EC-AM-AH-MAX-AGE
 24554                                    EC-AM-AH-MAX-TERM
 24555                                    EC-AM-AH-MAX-TOT-BEN
 24556                                    EC-AM-AH-MAX-MON-BEN
 24557                                    EC-RT-LF-MAX-ATT-AGE
 24558                                    EC-RT-LF-MAX-AGE
 24559                                    EC-RT-LF-MAX-TERM
 24560                                    EC-RT-LF-MAX-TOT-BEN
 24561                                    EC-RT-AH-MAX-ATT-AGE
 24562                                    EC-RT-AH-MAX-AGE
 24563                                    EC-RT-AH-MAX-TERM
 24564                                    EC-RT-AH-MAX-TOT-BEN
 24565                                    EC-RT-AH-MAX-MON-BEN
 24566                                    EC-RT-AH-RATE
 24567                                    EC-RT-LF-RATE
 24568                                    EC-RT-LF-NSP-RATE
 24569                                    EC-RT-AH-NSP-RATE
 24570                                    EC-CM-LF-PRIOR-REFUND
 24571                                    EC-CM-AH-PRIOR-REFUND.
 24572
 24573     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24574                                    EC-ST-TOL-PREM-PCT
 24575                                    EC-AM-LF-TOL-REFUND
 24576                                    EC-AM-LF-DEV-PERCENT
 24577                                    EC-CO-TOL-REFUND-PCT
 24578                                    EC-ST-TOL-REFUND-PCT
 24579                                    EC-AM-AH-TOL-REFUND
 24580                                    EC-AM-AH-DEV-PERCENT.
 24581
 24582
 24583* EXEC CICS LINK
 24584*         PROGRAM   (PGM-NAME)
 24585*         COMMAREA  (PASSED-RECORD)
 24586*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24587*    END-EXEC.
 24588*    MOVE '."C                   (   #00020616' TO DFHEIV0
 24589     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24591     MOVE X'2020233030303230363136' TO DFHEIV0(25:11)
 24592     CALL 'kxdfhei1' USING DFHEIV0,
 24593           PGM-NAME,
 24594           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 454
* EL6311.cbl
 24595           WS-EDIT-PASS-LENGTH,
 24596           DFHEIV99,
 24597           DFHEIV99,
 24598           DFHEIV99,
 24599           DFHEIV99
 24600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24601
 24602
 24603     MOVE '1'                    TO PI-EDIT-SW.
 24604     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24605
 24606     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24607
 24608     IF PI-COMPANY-ID = 'UCL'
 24609         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24610
 24611     IF VALID-PB-ID
 24612        GO TO 9800-EXIT.
 24613
 24614     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24615
 24616     IF PI-MAP-NAME = EL631B
 24617        MOVE -1                  TO BMAINTL
 24618       ELSE
 24619        MOVE -1                  TO CMAINTL.
 24620
 24621     GO TO 8200-SEND-DATAONLY.
 24622
 24623 9800-EXIT.
 24624      EXIT.
 24625
 24626 9900-ERROR-FORMAT.
 24627
 24628     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24629
 24630     IF NOT EMI-ERRORS-COMPLETE
 24631         MOVE LINK-EL001         TO PGM-NAME
 24632
 24633* EXEC CICS LINK
 24634*            PROGRAM    (PGM-NAME)
 24635*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24636*            LENGTH     (EMI-COMM-LENGTH)
 24637*        END-EXEC.
 24638*    MOVE '."C                   (   #00020651' TO DFHEIV0
 24639     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24641     MOVE X'2020233030303230363531' TO DFHEIV0(25:11)
 24642     CALL 'kxdfhei1' USING DFHEIV0,
 24643           PGM-NAME,
 24644           ERROR-MESSAGE-INTERFACE-BLOCK,
 24645           EMI-COMM-LENGTH,
 24646           DFHEIV99,
 24647           DFHEIV99,
 24648           DFHEIV99,
 24649           DFHEIV99
 24650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24651
 24652
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 455
* EL6311.cbl
 24653 9900-EXIT.
 24654     EXIT.
 24655
 24656 9990-ABEND.
 24657     MOVE LINK-EL004             TO PGM-NAME.
 24658     MOVE DFHEIBLK               TO EMI-LINE1.
 24659
 24660* EXEC CICS LINK
 24661*        PROGRAM   (PGM-NAME)
 24662*        COMMAREA  (EMI-LINE1)
 24663*        LENGTH    (72)
 24664*    END-EXEC.
 24665     MOVE 72
 24666       TO DFHEIV11
 24667*    MOVE '."C                   (   #00020663' TO DFHEIV0
 24668     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24670     MOVE X'2020233030303230363633' TO DFHEIV0(25:11)
 24671     CALL 'kxdfhei1' USING DFHEIV0,
 24672           PGM-NAME,
 24673           EMI-LINE1,
 24674           DFHEIV11,
 24675           DFHEIV99,
 24676           DFHEIV99,
 24677           DFHEIV99,
 24678           DFHEIV99
 24679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24680
 24681
 24682     IF PI-MAP-NAME = EL631B
 24683        MOVE -1                  TO BMAINTL
 24684       ELSE
 24685        MOVE -1                  TO CMAINTL.
 24686
 24687     IF EIBTRNID NOT = TRANS-EXB1
 24688        GO TO 8100-SEND-INITIAL-MAP
 24689       ELSE
 24690        GO TO 8200-SEND-DATAONLY.
 24691
 24692 9995-SECURITY-VIOLATION.
 24693*                            COPY ELCSCTP.
 24694******************************************************************
 24695*                                                                *
 24696*                            ELCSCTP                             *
 24697*                            VMOD=2.001                          *
 24698*                                                                *
 24699*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24700******************************************************************
 24701
 24702
 24703     MOVE EIBDATE          TO SM-JUL-DATE.
 24704     MOVE EIBTRMID         TO SM-TERMID.
 24705     MOVE THIS-PGM         TO SM-PGM.
 24706     MOVE EIBTIME          TO TIME-IN.
 24707     MOVE TIME-OUT         TO SM-TIME.
 24708     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24709
 24710
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 456
* EL6311.cbl
 24711* EXEC CICS LINK
 24712*         PROGRAM  ('EL003')
 24713*         COMMAREA (SECURITY-MESSAGE)
 24714*         LENGTH   (80)
 24715*    END-EXEC.
 24716     MOVE 'EL003' TO DFHEIV1
 24717     MOVE 80
 24718       TO DFHEIV11
 24719*    MOVE '."C                   (   #00020697' TO DFHEIV0
 24720     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24721     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24722     MOVE X'2020233030303230363937' TO DFHEIV0(25:11)
 24723     CALL 'kxdfhei1' USING DFHEIV0,
 24724           DFHEIV1,
 24725           SECURITY-MESSAGE,
 24726           DFHEIV11,
 24727           DFHEIV99,
 24728           DFHEIV99,
 24729           DFHEIV99,
 24730           DFHEIV99
 24731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24732
 24733
 24734******************************************************************
 24735
 24736
 24737 9999-DFHBACK SECTION.
 24738     MOVE '9%                    "   ' TO DFHEIV0
 24739     MOVE 'EL6311' TO DFHEIV1
 24740     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24741     GOBACK.
 24742 9999-DFHEXIT.
 24743     IF DFHEIGDJ EQUAL 0001
 24744         NEXT SENTENCE
 24745     ELSE IF DFHEIGDJ EQUAL 2
 24746         GO TO 9600-PGMID-ERROR,
 24747               9990-ABEND,
 24748               9990-ABEND,
 24749               0010-MAIN-LOGIC
 24750         DEPENDING ON DFHEIGDI
 24751     ELSE IF DFHEIGDJ EQUAL 3
 24752         GO TO 1280-BATCH-HDR-NOT-FOUND
 24753         DEPENDING ON DFHEIGDI
 24754     ELSE IF DFHEIGDJ EQUAL 4
 24755         GO TO 1290-DUPLICATE-ALT-INDEX
 24756         DEPENDING ON DFHEIGDI
 24757     ELSE IF DFHEIGDJ EQUAL 5
 24758         GO TO 1295-CERT-TRL-REC-NOTFND
 24759         DEPENDING ON DFHEIGDI
 24760     ELSE IF DFHEIGDJ EQUAL 6
 24761         GO TO 1380-BATCH-HDR-NOT-FOUND
 24762         DEPENDING ON DFHEIGDI
 24763     ELSE IF DFHEIGDJ EQUAL 7
 24764         GO TO 1385-REC-NOT-FOUND
 24765         DEPENDING ON DFHEIGDI
 24766     ELSE IF DFHEIGDJ EQUAL 8
 24767         GO TO 1386-NOTFND
 24768         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 457
* EL6311.cbl
 24769     ELSE IF DFHEIGDJ EQUAL 9
 24770         GO TO 1399-EXIT
 24771         DEPENDING ON DFHEIGDI
 24772     ELSE IF DFHEIGDJ EQUAL 10
 24773         GO TO 1480-BATCH-HDR-NOT-FOUND
 24774         DEPENDING ON DFHEIGDI
 24775     ELSE IF DFHEIGDJ EQUAL 11
 24776         GO TO 1490-RECORD-NOT-FOUND
 24777         DEPENDING ON DFHEIGDI
 24778     ELSE IF DFHEIGDJ EQUAL 12
 24779         GO TO 1405-DELETE-CERTIFICATE
 24780         DEPENDING ON DFHEIGDI
 24781     ELSE IF DFHEIGDJ EQUAL 13
 24782         GO TO 1420-CONTINUE-DELETE
 24783         DEPENDING ON DFHEIGDI
 24784     ELSE IF DFHEIGDJ EQUAL 14
 24785         GO TO 1406-DELETE-ERNOTE
 24786         DEPENDING ON DFHEIGDI
 24787     ELSE IF DFHEIGDJ EQUAL 15
 24788         GO TO 1407-DELETE-MAILING
 24789         DEPENDING ON DFHEIGDI
 24790     ELSE IF DFHEIGDJ EQUAL 16
 24791         GO TO 1420-CONTINUE-DELETE
 24792         DEPENDING ON DFHEIGDI
 24793     ELSE IF DFHEIGDJ EQUAL 17
 24794         GO TO 1480-BATCH-HDR-NOT-FOUND
 24795         DEPENDING ON DFHEIGDI
 24796     ELSE IF DFHEIGDJ EQUAL 18
 24797         GO TO 1475-DELETE-FINISHED
 24798         DEPENDING ON DFHEIGDI
 24799     ELSE IF DFHEIGDJ EQUAL 19
 24800         GO TO 2280-BATCH-HDR-NOT-FOUND
 24801         DEPENDING ON DFHEIGDI
 24802     ELSE IF DFHEIGDJ EQUAL 20
 24803         GO TO 2290-DUPLICATE-ALT-INDEX
 24804         DEPENDING ON DFHEIGDI
 24805     ELSE IF DFHEIGDJ EQUAL 21
 24806         GO TO 2380-BATCH-HDR-NOT-FOUND
 24807         DEPENDING ON DFHEIGDI
 24808     ELSE IF DFHEIGDJ EQUAL 22
 24809         GO TO 2385-REC-NOT-FOUND
 24810         DEPENDING ON DFHEIGDI
 24811     ELSE IF DFHEIGDJ EQUAL 23
 24812         GO TO 2380-BATCH-HDR-NOT-FOUND
 24813         DEPENDING ON DFHEIGDI
 24814     ELSE IF DFHEIGDJ EQUAL 24
 24815         GO TO 2485-BATCH-HDR-NOT-FOUND
 24816         DEPENDING ON DFHEIGDI
 24817     ELSE IF DFHEIGDJ EQUAL 25
 24818         GO TO 2490-RECORD-NOT-FOUND
 24819         DEPENDING ON DFHEIGDI
 24820     ELSE IF DFHEIGDJ EQUAL 26
 24821         GO TO 2475-CONTINUE-DELETE
 24822         DEPENDING ON DFHEIGDI
 24823     ELSE IF DFHEIGDJ EQUAL 27
 24824         GO TO 2485-BATCH-HDR-NOT-FOUND
 24825         DEPENDING ON DFHEIGDI
 24826     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 458
* EL6311.cbl
 24827         GO TO 2480-DELETE-FINISHED
 24828         DEPENDING ON DFHEIGDI
 24829     ELSE IF DFHEIGDJ EQUAL 29
 24830         GO TO 2820-PROCESS-REWRITE
 24831         DEPENDING ON DFHEIGDI
 24832     ELSE IF DFHEIGDJ EQUAL 30
 24833         GO TO 2885-RECORD-MISSING
 24834         DEPENDING ON DFHEIGDI
 24835     ELSE IF DFHEIGDJ EQUAL 31
 24836         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24837         DEPENDING ON DFHEIGDI
 24838     ELSE IF DFHEIGDJ EQUAL 32
 24839         GO TO 2827-DELETE-MAILING
 24840         DEPENDING ON DFHEIGDI
 24841     ELSE IF DFHEIGDJ EQUAL 33
 24842         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24843         DEPENDING ON DFHEIGDI
 24844     ELSE IF DFHEIGDJ EQUAL 34
 24845         GO TO 2920-PROCESS-REWRITE
 24846         DEPENDING ON DFHEIGDI
 24847     ELSE IF DFHEIGDJ EQUAL 35
 24848         GO TO 2985-RECORD-MISSING
 24849         DEPENDING ON DFHEIGDI
 24850     ELSE IF DFHEIGDJ EQUAL 36
 24851         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24852         DEPENDING ON DFHEIGDI
 24853     ELSE IF DFHEIGDJ EQUAL 37
 24854         GO TO 2990-DUPLICATE-RECORD
 24855         DEPENDING ON DFHEIGDI
 24856     ELSE IF DFHEIGDJ EQUAL 38
 24857         GO TO 3590-NOT-FOUND
 24858         DEPENDING ON DFHEIGDI
 24859     ELSE IF DFHEIGDJ EQUAL 39
 24860         GO TO 3690-NOT-FOUND
 24861         DEPENDING ON DFHEIGDI
 24862     ELSE IF DFHEIGDJ EQUAL 40
 24863         GO TO 3990-NOT-FOUND
 24864         DEPENDING ON DFHEIGDI
 24865     ELSE IF DFHEIGDJ EQUAL 41
 24866         GO TO 4050-END-RECORDS,
 24867               4050-END-RECORDS
 24868         DEPENDING ON DFHEIGDI
 24869     ELSE IF DFHEIGDJ EQUAL 42
 24870         GO TO 4150-END-BATCH
 24871         DEPENDING ON DFHEIGDI
 24872     ELSE IF DFHEIGDJ EQUAL 43
 24873         GO TO 4150-END-BATCH
 24874         DEPENDING ON DFHEIGDI
 24875     ELSE IF DFHEIGDJ EQUAL 44
 24876         GO TO 4250-END-RECORDS,
 24877               4250-END-RECORDS
 24878         DEPENDING ON DFHEIGDI
 24879     ELSE IF DFHEIGDJ EQUAL 45
 24880         GO TO 4350-END-BATCH,
 24881               4350-END-BATCH
 24882         DEPENDING ON DFHEIGDI
 24883     ELSE IF DFHEIGDJ EQUAL 46
 24884         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 459
* EL6311.cbl
 24885               4550-END-RECORDS
 24886         DEPENDING ON DFHEIGDI
 24887     ELSE IF DFHEIGDJ EQUAL 47
 24888         GO TO 4680-NOT-FOUND,
 24889               4680-NOT-FOUND
 24890         DEPENDING ON DFHEIGDI
 24891     ELSE IF DFHEIGDJ EQUAL 48
 24892         GO TO 4860-NOT-FOUND,
 24893               4850-END-RECORDS
 24894         DEPENDING ON DFHEIGDI
 24895     ELSE IF DFHEIGDJ EQUAL 49
 24896         GO TO 4970-NOT-FOUND,
 24897               4950-END-RECORDS
 24898         DEPENDING ON DFHEIGDI
 24899     ELSE IF DFHEIGDJ EQUAL 50
 24900         GO TO 5050-NOT-FOUND
 24901         DEPENDING ON DFHEIGDI
 24902     ELSE IF DFHEIGDJ EQUAL 51
 24903         GO TO 5050-NOT-FOUND
 24904         DEPENDING ON DFHEIGDI
 24905     ELSE IF DFHEIGDJ EQUAL 52
 24906         GO TO 5050-NOT-FOUND
 24907         DEPENDING ON DFHEIGDI
 24908     ELSE IF DFHEIGDJ EQUAL 53
 24909         GO TO 5550-END-RECORDS,
 24910               5550-END-RECORDS
 24911         DEPENDING ON DFHEIGDI
 24912     ELSE IF DFHEIGDJ EQUAL 54
 24913         GO TO 6050-QID-ERROR
 24914         DEPENDING ON DFHEIGDI
 24915     ELSE IF DFHEIGDJ EQUAL 55
 24916         GO TO 6050-QID-ERROR
 24917         DEPENDING ON DFHEIGDI
 24918     ELSE IF DFHEIGDJ EQUAL 56
 24919         GO TO 6400-CONTINUE,
 24920               6400-CONTINUE
 24921         DEPENDING ON DFHEIGDI
 24922     ELSE IF DFHEIGDJ EQUAL 57
 24923         GO TO 3690-NOT-FOUND
 24924         DEPENDING ON DFHEIGDI
 24925     ELSE IF DFHEIGDJ EQUAL 58
 24926         GO TO 7399-EXIT
 24927         DEPENDING ON DFHEIGDI
 24928     ELSE IF DFHEIGDJ EQUAL 59
 24929         GO TO 7550-OFFICER-NOTFND
 24930         DEPENDING ON DFHEIGDI
 24931     ELSE IF DFHEIGDJ EQUAL 60
 24932         GO TO 8300-SEND-TEXT
 24933         DEPENDING ON DFHEIGDI.
 24934     MOVE '9%                    "   ' TO DFHEIV0
 24935     MOVE 'EL6311' TO DFHEIV1
 24936     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24937     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15028     Code:       98746
