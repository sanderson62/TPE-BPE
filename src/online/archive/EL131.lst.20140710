* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39******************************************************************
    40
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   3
* EL131.cbl
    42 ENVIRONMENT DIVISION.
    43
    44 DATA DIVISION.
    45
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    52 77  s1                          pic s999 comp-3 value+0.
    53 77  s2                          pic s999 comp-3 value+0.
    54 77  a1                          pic s999 comp-3 value+0.
    55 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    56 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    57 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    58 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    59 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    60 77  ws-max-extension            pic s999 comp-3 value +0.
    61 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    62 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    63 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    64     88  ERPDEF-FOUND                 VALUE 'Y'.
    65 77  ws-eracct-sw                pic x  value ' '.
    66     88  acct-found                value 'Y'.
    67 77  ws-benper-sw                pic x   value ' '.
    68     88  good-benper               value 'Y'.
    69 77  ws-claim-type               pic x value ' '.
    70 77  ws-ben-per                  pic 99 value 00.
    71 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    72 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    73 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    74 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    75
    76 01  LCP-TIME-OF-DAY-XX.
    77     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    78     05  FILLER                    PIC 99.
    79 01  LCP-CICS-TIME                 PIC 9(15).
    80*                            COPY ELCSCTM.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCTM                             *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-MESSAGE.
    91     12  FILLER                          PIC X(30)
    92            VALUE '** LOGIC SECURITY VIOLATION -'.
    93     12  SM-READ                         PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' PGM='.
    96     12  SM-PGM                          PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' OPR='.
    99     12  SM-PROCESSOR-ID                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   4
* EL131.cbl
   100     12  FILLER                          PIC X(6)
   101            VALUE ' TERM='.
   102     12  SM-TERMID                       PIC X(4).
   103     12  FILLER                          PIC XX   VALUE SPACE.
   104     12  SM-JUL-DATE                     PIC 9(5).
   105     12  FILLER                          PIC X    VALUE SPACE.
   106     12  SM-TIME                         PIC 99.99.
   107
   108
   109*                            COPY ELCSCRTY.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCRTY                            *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   117*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   118*        SAVED IN PI-SECURITY-ADDRESS.                           *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-CONTROL.
   122     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   123     12  FILLER                       PIC XX    VALUE 'SC'.
   124     12  SC-CREDIT-CODES.
   125         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   126             20  SC-CREDIT-DISPLAY    PIC X.
   127             20  SC-CREDIT-UPDATE     PIC X.
   128     12  SC-CLAIMS-CODES.
   129         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   130             20  SC-CLAIMS-DISPLAY    PIC X.
   131             20  SC-CLAIMS-UPDATE     PIC X.
   132
   133*                            COPY ELCNWA.
   134*****************************************************************
   135*                                                               *
   136*                                                               *
   137*                            ELCNWA.                            *
   138*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   139*                            VMOD=2.003                         *
   140*                                                               *
   141*            M O V E   N A M E   W O R K   A R E A.             *
   142*                                                               *
   143*****************************************************************.
   144
   145 01  WS-NAME-WORK-AREA.
   146     05  WS-INSURED-LAST-NAME        PIC X(15).
   147     05  WS-INSURED-1ST-NAME         PIC X(12).
   148     05  WS-INSURED-MID-INIT         PIC X.
   149
   150     05  WS-NAME-WORK.
   151         10  WS-NW                   PIC X
   152             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   153
   154     05  WS-NAME-WORK2.
   155         10  WS-NW2                  PIC X
   156             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   157                                        NWA-INDEX0.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   5
* EL131.cbl
   158
   159     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   160                                     COMP-3.
   161
   162
   163 01  ws-dcc-error-line.
   164     05  filler occurs 15.
   165         10  ws-error-no        pic x(4).
   166 01  WS-DATE-AREA.
   167     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   168     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   169     12  SAVE-DATE-CCYYMMDD.
   170         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   171         16  SAVE-DATE-YMD.
   172             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   173             20  FILLER         PIC X(4)    VALUE SPACES.
   174
   175 01  WS-BLANK                   PIC X       VALUE ' '.
   176
   177 01  CSO-WORK-FIELDS.
   178     05  WS-HOLD-CLAIM-STATUS    PIC X.
   179     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   180     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   181         10  WS-RECURRENT-YN     PIC X.
   182         10  FILLER              PIC X.
   183
   184 01  LITERALS-NUMBERS.
   185     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   186     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   187     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   188     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   189     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   190     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   191     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   192     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   193
   194     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   195     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   196     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   197     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   198     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   199     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   200     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   201     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   202     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   203     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   204
   205     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   206
   207     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   208
   209     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   210     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   211     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   212     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   213     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   214     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   215     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   6
* EL131.cbl
   216     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   217     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   218     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   219     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   220
   221     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   222     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   223     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   224     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   225         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   226     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   227     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   228     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   229     12  WS-ICD-CODE-1           PIC X(8).
   230     12  WS-ICD-CODE-2           PIC X(8).
   231     12  WS-CLAIM-SEQU.
   232         16  FILLER              PIC X VALUE '('.
   233         16  WS-CURRENT-SEQU     PIC Z9.
   234         16  FILLER              PIC X(04) VALUE ' OF '.
   235         16  WS-OF-SEQU          PIC Z9.
   236         16  FILLER              PIC X VALUE ')'.
   237     12  WS-EDIT-BEN-CODE        PIC XX.
   238         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   239                                          '90' THRU '99'.
   240
   241     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   242     12  WS-EDIT-NUMBER          PIC ZZZ9.
   243
   244     12  WS-RESPONSE             PIC S9(8)   COMP.
   245         88  WS-RESP-NORMAL              VALUE +00.
   246         88  WS-RESP-ERROR               VALUE +01.
   247         88  WS-RESP-NOTFND              VALUE +13.
   248         88  WS-RESP-DUPKEY              VALUE +15.
   249         88  WS-RESP-NOTOPEN             VALUE +19.
   250         88  WS-RESP-ENDFILE             VALUE +20.
   251
   252     12  WS-MOS-PAID             PIC 999.
   253     12  WS-ODD-DAYS             PIC 99.
   254     12  WS-REM-MOS              PIC 999.
   255     12  WS-REM-DAYS             PIC 99.
   256     12  WS-TERM-IN-DAYS         PIC 9(4).
   257     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   258
   259     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   260     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   261     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   262     12  WS-RESET-SW             PIC X       VALUE 'N'.
   263     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   264     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   265     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   266
   267 01  DMD-DATE-YYYYMMDD.
   268     12  DMD-DECADE          PIC XX      VALUE SPACES.
   269     12  DMD-YYMMDD.
   270         16  DMD-YY          PIC XX      VALUE SPACES.
   271         16  DMD-MM          PIC XX      VALUE SPACES.
   272         16  DMD-DD          PIC XX      VALUE SPACES.
   273
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   7
* EL131.cbl
   274 01  DMD-DATE-MMDDYYYY.
   275     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   276     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   277     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   278     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   279     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   280     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   281
   282 01  WS-MAIL-CODE.
   283     12  FILLER              PIC X.
   284     12  DMD-MAIL-CODE.
   285         16  WS-MAIL-4       PIC X(4).
   286         16  WS-MAIL-5       PIC X.
   287     12  FILLER              PIC X(4).
   288
   289     12  W-NAME-LAST             PIC  X(15).
   290     12  W-NAME-FIRST            PIC  X(15).
   291     12  W-NAME-MIDDLE.
   292         16  FILLER              PIC  X.
   293         16  W-NAME-MIDDLE-2     PIC  X.
   294         16  FILLER              PIC  X(13).
   295
   296*    COPY ELCDCTB.
   297******************************************************************
   298*                                                                *
   299*                                                                *
   300*                            ELCDCTB.                            *
   301*                            VMOD=2.002                          *
   302*                                                                *
   303*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   304*       COMMUNICATIONS AREA                                      *
   305*                                                                *
   306******************************************************************
   307 01  DCT-COMMUNICATION-AREA.
   308     12  DCT-BILLING-BANK-ID      PIC  X(05).
   309     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   310     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   311     12  DCT-PRODUCT-CODE         PIC  X(02).
   312     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   313     12  DCT-RETURN-CODE          PIC  X(02).
   314     12  DCT-MAIL-CODE            PIC  X(05).
   315     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   316     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   8
* EL131.cbl
   318 01  ERROR-SWITCHES.
   319     12  ERROR-SWITCH            PIC X.
   320         88  SCREEN-ERROR                    VALUE 'X'.
   321     12  MSTR-KEY-SWITCH         PIC X.
   322         88  MSTR-KEY-CHANGED                VALUE 'X'.
   323     12  CERT-KEY-SWITCH         PIC X.
   324*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   325         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   326*********SET TO Y IF PRIMARY KEY WILL CHANGE
   327         88  CERT-KEY-CHANGED                VALUE 'Y'.
   328     12  MSTR-SWITCH             PIC X.
   329         88  MSTR-UPDATES                    VALUE 'X'.
   330     12  crtt-switch             pic x value spaces.
   331         88  crtt-update             value 'X'.
   332     12  CERT-SWITCH             PIC X.
   333         88  CERT-UPDATES                    VALUE 'X'.
   334     12  UPDATE-SWITCH           PIC X.
   335         88  UPDATES-PRESENT                 VALUE 'X'.
   336     12  TRLR-SWITCH             PIC X.
   337         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   338         88  UPDATE-MADE                     VALUE 'Y'.
   339     12  NINETY-TRLR-SWITCH      PIC X.
   340         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   341     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   342         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   343     12  EARNINGS-CALC-SWITCH    PIC X.
   344         88  TEX-REG                         VALUE '4'.
   345         88  NET-PAY                         VALUE '5'.
   346     12  DLYACTV-SW              PIC X       VALUE 'N'.
   347         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page   9
* EL131.cbl
   349 01  EDIT-WORK-AREA.
   350     12  COUNT-2                 PIC 9.
   351     12  CALL-PGM                PIC X(8).
   352     12  TRANS-ID                PIC X(4).
   353     12  CHECK-PFKEYS            PIC 99.
   354     12  CHECK-MAINT             PIC X.
   355         88  ADD-ALPHA-RECORD                VALUE 'A'.
   356         88  CHANGE-CLAIM                    VALUE 'C'.
   357         88  DELETE-CLAIM                    VALUE 'D'.
   358         88  CHANGE-NAME                     VALUE 'N'.
   359         88  VALID-OPTIONS                   VALUE 'A' 'C'
   360                                                   'D' 'N'.
   361
   362     12  HOLD-BENEFIT            PIC XX.
   363     12  HOLD-FREQ               PIC XX.
   364     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   365     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   366     12  HOLD-PDTHRU             PIC XX.
   367     12  HOLD-ADDON              PIC XX.
   368     12  HOLD-NODAYS             PIC 9(4).
   369     12  HOLD-NOPMTS             PIC 9(3).
   370     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   371     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   372     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   373     12  HOLD-BIRTH              PIC XX.
   374     12  HOLD-END                PIC XX.
   375     12  HOLD-EFF                PIC XX.
   376     12  HOLD-ENTRY              PIC XX.
   377     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   378     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   379     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   380     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   381     12  HOLD-LF-CV-CAN          PIC XX.
   382     12  HOLD-AH-CV-CAN          PIC XX.
   383     12  DIVIDE-QUOT             PIC 9(3).
   384     12  DIVIDE-REM              PIC 9(3).
   385
   386     12  WS-ALPHA-DATE.
   387         16  WS-ALPHA-YEAR.
   388             20  WS-ALPHA-YY-1   PIC 99.
   389             20  WS-ALPHA-YY-2   PIC 99.
   390         16  WS-ALPHA-MM         PIC 99.
   391         16  WS-ALPHA-DD         PIC 99.
   392
   393     12  BUILD-VALID-DATE.
   394         16  BUILD-MONTH         PIC 99.
   395         16  BUILD-DAY           PIC 99.
   396         16  BUILD-YEAR          PIC 99.
   397     12  DEEDIT-MMYY-INPUT.
   398         16  FILLER              PIC X.
   399         16  DEEDIT-MONTH        PIC XX.
   400         16  DEEDIT-YEAR         PIC XX.
   401     12  DEEDIT-BEN              PIC 9(9)V99.
   402     12  DEEDIT-DATE-INPUT.
   403         16  FILLER              PIC XX.
   404         16  DEEDIT-DATE         PIC X(6).
   405     12  WORK-DATE-MDY.
   406         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  10
* EL131.cbl
   407         16  FILLER              PIC X(4).
   408         16  YEAR-WORK           PIC XX.
   409     12  WORK-DATE-MY.
   410         16  WORK-MONTH          PIC XX.
   411         16  WORK-SLASH          PIC X       VALUE '/'.
   412         16  WORK-YEAR           PIC XX.
   413     12  HOLD-DATE.
   414         16  HOLD-MONTH          PIC 99.
   415         16  FILLER              PIC X(4).
   416         16  HOLD-YEAR           PIC 99.
   417     12  SPLIT-INFO-LINE-1.
   418         16  SPLIT-INFO-DESC     PIC X(15).
   419         16  FILLER              PIC X(5)    VALUE ' OLD='.
   420         16  SPLIT-INFO-OLD      PIC X(40).
   421     12  EFF-TERM-MO             PIC 9(4).
   422     12  CURR-MO                 PIC 9(4).
   423     12  WS-BIN-CURRENT-DT       PIC XX.
   424     12  WS-CALC-METHOD          PIC X.
   425     12  WS-INITIALS.
   426         16  WS-INIT-1           PIC X.
   427         16  WS-INIT-2           PIC X.
   428     12  WS-REIN-TABLE.
   429         16  WS-REIN-1           PIC X.
   430         16  WS-REIN-2           PIC X.
   431         16  WS-REIN-3           PIC X.
   432     12  PI-KEY.
   433         16  PI-TERM             PIC X(4).
   434         16  PI-QUAL             PIC X(4).
   435     12  CHECK-KEY               PIC X(20).
   436     12  SAVE-ACCT-KEY           PIC X(20).
   437     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   438     12  WS-SOC-SEC-NUMBER.
   439         16  WS-SOC-SEC-NO       PIC 9(9).
   440         16  WS-SOC-SEC-BLANK    PIC X(2).
   441     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   442         16  WS-SSN-1-3          PIC 9(3).
   443         16  WS-SSN-DASH1        PIC X(1).
   444         16  WS-SSN-4-5          PIC 9(2).
   445         16  WS-SSN-DASH2        PIC X(1).
   446         16  WS-SSN-6-9          PIC 9(4).
   447     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   448     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   449
   450 01  WS-SAVE-FIELDS.
   451     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   452     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   453     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   454     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   455     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   456     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   457     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   458     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   459     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   460     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   461     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   462     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   463     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   464     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  11
* EL131.cbl
   465     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   466     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   467     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   468     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   469     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   470     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   471     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   472     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   473     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   474     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   475     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   477     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   479     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   481     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   483     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   485     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   487     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   489     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   491     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   493     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   495     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   497     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   499     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   501     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   503     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   505     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   506
   507 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   508     12  M                   PIC S9(7)V99           VALUE ZEROS.
   509     12  L                   PIC S9(7)V99           VALUE ZEROS.
   510     12  N                   PIC S9(3)              VALUE ZEROS.
   511     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   512     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   513     12  I                   PIC S99V9(5)           VALUE ZEROS.
   514     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   515     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   516     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   517     12  R                   PIC S9(3)              VALUE ZEROS.
   518     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   519     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   520     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   521     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   522     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  12
* EL131.cbl
   523     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   524     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   525     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   526     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   527
   528 01  TERM-CALC-WORK-AREA.
   529     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   530     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   531     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   532     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   533     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   534     12  V-EXPONENTS.
   535        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   536     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   537
   538 01  TIME-IN.
   539     12  UN-HOURS                PIC XX.
   540     12  UN-MINUTES              PIC XX.
   541     12  FILLER                  PIC XX.
   542
   543 01  TIME-OUT.
   544     12  FOR-HOURS               PIC XX.
   545     12  FILLER                  PIC X       VALUE '.'.
   546     12  FOR-MINUTES             PIC XX.
   547
   548 01  ERROR-NUMBERS.
   549     12  ER-0000                 PIC X(4)    VALUE '0000'.
   550     12  ER-0004                 PIC X(4)    VALUE '0004'.
   551     12  ER-0008                 PIC X(4)    VALUE '0008'.
   552     12  ER-0023                 PIC X(4)    VALUE '0023'.
   553     12  ER-0029                 PIC X(4)    VALUE '0029'.
   554     12  ER-0068                 PIC X(4)    VALUE '0068'.
   555     12  ER-0070                 PIC X(4)    VALUE '0070'.
   556     12  ER-0149                 PIC X(4)    VALUE '0149'.
   557     12  ER-0154                 PIC X(4)    VALUE '0154'.
   558     12  ER-0169                 PIC X(4)    VALUE '0169'.
   559     12  ER-0192                 PIC X(4)    VALUE '0192'.
   560     12  ER-0199                 PIC X(4)    VALUE '0199'.
   561     12  ER-0203                 PIC X(4)    VALUE '0203'.
   562     12  ER-0204                 PIC X(4)    VALUE '0204'.
   563     12  ER-0205                 PIC X(4)    VALUE '0205'.
   564     12  ER-0206                 PIC X(4)    VALUE '0206'.
   565     12  ER-0208                 PIC X(4)    VALUE '0208'.
   566     12  ER-0210                 PIC X(4)    VALUE '0210'.
   567     12  ER-0215                 PIC X(4)    VALUE '0215'.
   568     12  ER-0219                 PIC X(4)    VALUE '0219'.
   569     12  ER-0220                 PIC X(4)    VALUE '0220'.
   570     12  ER-0222                 PIC X(4)    VALUE '0222'.
   571     12  ER-0223                 PIC X(4)    VALUE '0223'.
   572     12  ER-0224                 PIC X(4)    VALUE '0224'.
   573     12  ER-0227                 PIC X(4)    VALUE '0227'.
   574     12  ER-0230                 PIC X(4)    VALUE '0230'.
   575     12  ER-0232                 PIC X(4)    VALUE '0232'.
   576     12  ER-0233                 PIC X(4)    VALUE '0233'.
   577     12  ER-0236                 PIC X(4)    VALUE '0236'.
   578     12  ER-0237                 PIC X(4)    VALUE '0237'.
   579     12  ER-0238                 PIC X(4)    VALUE '0238'.
   580     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  13
* EL131.cbl
   581     12  ER-0241                 PIC X(4)    VALUE '0241'.
   582     12  ER-0243                 PIC X(4)    VALUE '0243'.
   583     12  ER-0244                 PIC X(4)    VALUE '0244'.
   584     12  ER-0246                 PIC X(4)    VALUE '0246'.
   585     12  ER-0247                 PIC X(4)    VALUE '0247'.
   586     12  ER-0248                 PIC X(4)    VALUE '0248'.
   587     12  ER-0250                 PIC X(4)    VALUE '0250'.
   588     12  ER-0251                 PIC X(4)    VALUE '0251'.
   589     12  ER-0253                 PIC X(4)    VALUE '0253'.
   590     12  ER-0256                 PIC X(4)    VALUE '0256'.
   591     12  ER-0257                 PIC X(4)    VALUE '0257'.
   592     12  ER-0258                 PIC X(4)    VALUE '0258'.
   593     12  ER-0259                 PIC X(4)    VALUE '0259'.
   594     12  ER-0260                 PIC X(4)    VALUE '0260'.
   595     12  ER-0261                 PIC X(4)    VALUE '0261'.
   596     12  ER-0262                 PIC X(4)    VALUE '0262'.
   597     12  ER-0263                 PIC X(4)    VALUE '0263'.
   598     12  ER-0273                 PIC X(4)    VALUE '0273'.
   599     12  ER-0274                 PIC X(4)    VALUE '0274'.
   600     12  ER-0276                 PIC X(4)    VALUE '0276'.
   601     12  ER-0282                 PIC X(4)    VALUE '0282'.
   602     12  ER-0283                 PIC X(4)    VALUE '0283'.
   603     12  ER-0309                 PIC X(4)    VALUE '0309'.
   604     12  ER-0310                 PIC X(4)    VALUE '0310'.
   605     12  ER-0311                 PIC X(4)    VALUE '0311'.
   606     12  ER-0333                 PIC X(4)    VALUE '0333'.
   607     12  ER-0360                 PIC X(4)    VALUE '0360'.
   608     12  ER-0377                 PIC X(4)    VALUE '0377'.
   609     12  ER-0402                 PIC X(4)    VALUE '0402'.
   610     12  ER-0416                 PIC X(4)    VALUE '0416'.
   611     12  ER-0426                 PIC X(4)    VALUE '0426'.
   612     12  ER-0427                 PIC X(4)    VALUE '0427'.
   613     12  ER-0428                 PIC X(4)    VALUE '0428'.
   614     12  ER-0429                 PIC X(4)    VALUE '0429'.
   615     12  ER-0430                 PIC X(4)    VALUE '0430'.
   616     12  ER-0458                 PIC X(4)    VALUE '0458'.
   617     12  ER-0475                 PIC X(4)    VALUE '0475'.
   618     12  ER-0491                 PIC X(4)    VALUE '0491'.
   619     12  ER-0509                 PIC X(4)    VALUE '0509'.
   620     12  ER-0510                 PIC X(4)    VALUE '0510'.
   621     12  ER-0511                 PIC X(4)    VALUE '0511'.
   622     12  ER-0512                 PIC X(4)    VALUE '0512'.
   623     12  ER-0519                 PIC X(4)    VALUE '0519'.
   624     12  ER-0520                 PIC X(4)    VALUE '0520'.
   625     12  ER-0521                 PIC X(4)    VALUE '0521'.
   626     12  ER-0547                 PIC X(4)    VALUE '0547'.
   627     12  ER-0548                 PIC X(4)    VALUE '0548'.
   628     12  ER-0549                 PIC X(4)    VALUE '0549'.
   629     12  ER-0565                 PIC X(4)    VALUE '0565'.
   630     12  ER-0598                 PIC X(4)    VALUE '0598'.
   631     12  ER-0639                 PIC X(4)    VALUE '0639'.
   632     12  ER-0797                 PIC X(4)    VALUE '0797'.
   633     12  ER-0802                 PIC X(4)    VALUE '0802'.
   634     12  ER-0803                 PIC X(4)    VALUE '0803'.
   635     12  ER-0849                 PIC X(4)    VALUE '0849'.
   636     12  ER-0885                 PIC X(4)    VALUE '0885'.
   637     12  ER-0887                 PIC X(4)    VALUE '0887'.
   638     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  14
* EL131.cbl
   639     12  ER-0921                 PIC X(4)    VALUE '0921'.
   640     12  ER-0938                 PIC X(4)    VALUE '0938'.
   641     12  ER-0946                 PIC X(4)    VALUE '0946'.
   642     12  ER-0947                 PIC X(4)    VALUE '0947'.
   643     12  ER-0948                 PIC X(4)    VALUE '0948'.
   644     12  ER-0949                 PIC X(4)    VALUE '0949'.
   645     12  ER-0950                 PIC X(4)    VALUE '0950'.
   646     12  ER-0951                 PIC X(4)    VALUE '0951'.
   647     12  ER-0954                 PIC X(4)    VALUE '0954'.
   648     12  ER-0974                 PIC X(4)    VALUE '0974'.
   649     12  ER-0975                 PIC X(4)    VALUE '0975'.
   650     12  ER-0992                 PIC X(4)    VALUE '0992'.
   651     12  ER-1651                 PIC X(4)    VALUE '1651'.
   652     12  ER-1652                 PIC X(4)    VALUE '1652'.
   653     12  ER-1653                 PIC X(4)    VALUE '1653'.
   654     12  ER-1654                 PIC X(4)    VALUE '1654'.
   655     12  ER-1655                 PIC X(4)    VALUE '1655'.
   656     12  er-1656                 pic x(4)    value '1656'.
   657     12  ER-1661                 PIC X(4)    VALUE '1661'.
   658     12  ER-1662                 PIC X(4)    VALUE '1662'.
   659     12  ER-1663                 PIC X(4)    VALUE '1663'.
   660     12  er-1664                 pic x(4)    value '1664'.
   661     12  er-1665                 pic x(4)    value '1665'.
   662     12  er-1666                 pic x(4)    value '1666'.
   663     12  er-1668                 pic x(4)    value '1668'.
   664     12  er-1669                 pic x(4)    value '1669'.
   665     12  er-1676                 pic x(4)    value '1676'.
   666     12  ER-1773                 PIC X(4)    VALUE '1773'.
   667     12  ER-2280                 PIC X(4)    VALUE '2280'.
   668     12  ER-2878                 PIC X(4)    VALUE '2878'.
   669     12  ER-7641                 PIC X(4)    VALUE '7641'.
   670     12  ER-7642                 PIC X(4)    VALUE '7642'.
   671     12  ER-7650                 PIC X(4)    VALUE '7650'.
   672     12  ER-7651                 PIC X(4)    VALUE '7651'.
   673     12  ER-7687                 PIC X(4)    VALUE '7687'.
   674     12  ER-7689                 PIC X(4)    VALUE '7689'.
   675     12  ER-7690                 PIC X(4)    VALUE '7690'.
   676     12  ER-7691                 PIC X(4)    VALUE '7691'.
   677     12  ER-8003                 PIC X(4)    VALUE '8003'.
   678     12  ER-8051                 PIC X(4)    VALUE '8051'.
   679     12  ER-8052                 PIC X(4)    VALUE '8052'.
   680     12  ER-8053                 PIC X(4)    VALUE '8053'.
   681     12  ER-8054                 PIC X(4)    VALUE '8054'.
   682     12  ER-8055                 PIC X(4)    VALUE '8055'.
   683     12  ER-8056                 PIC X(4)    VALUE '8056'.
   684     12  ER-8057                 PIC X(4)    VALUE '8057'.
   685     12  ER-8058                 PIC X(4)    VALUE '8058'.
   686     12  ER-8059                 PIC X(4)    VALUE '8059'.
   687     12  ER-8060                 PIC X(4)    VALUE '8060'.
   688     12  ER-8061                 PIC X(4)    VALUE '8061'.
   689     12  ER-8062                 PIC X(4)    VALUE '8062'.
   690     12  ER-8063                 PIC X(4)    VALUE '8063'.
   691     12  ER-8064                 PIC X(4)    VALUE '8064'.
   692     12  ER-8065                 PIC X(4)    VALUE '8065'.
   693     12  ER-8066                 PIC X(4)    VALUE '8066'.
   694     12  ER-8152                 PIC X(4)    VALUE '8152'.
   695     12  ER-8153                 PIC X(4)    VALUE '8153'.
   696     12  ER-8154                 PIC X(4)    VALUE '8154'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  15
* EL131.cbl
   697     12  ER-8155                 PIC X(4)    VALUE '8155'.
   698 01  ERPDEF-KEY-SAVE             PIC X(18).
   699 01  ERPDEF-KEY.
   700     12  ERPDEF-COMPANY-CD       PIC X.
   701     12  ERPDEF-STATE            PIC XX.
   702     12  ERPDEF-PROD-CD          PIC XXX.
   703     12  F                       PIC X(7).
   704     12  ERPDEF-BEN-TYPE         PIC X.
   705     12  ERPDEF-BEN-CODE         PIC XX.
   706     12  ERPDEF-EXP-DT           PIC XX.
   707 01  MSTR-KEY.
   708     12  COMPANY-CODE            PIC X.
   709     12  CARRIER-CODE            PIC X.
   710     12  CLAIM-NO                PIC X(7).
   711     12  CERT-NO.
   712         16  CERT-NO-PRIME       PIC X(10).
   713         16  CERT-NO-SUFX        PIC X.
   714
   715 01  WS-SAVE-CLAIM-KEY.
   716     12  WS-SAVE-COMPANY-CD      PIC X.
   717     12  WS-SAVE-CARRIER         PIC X.
   718     12  WS-SAVE-CLAIM-NO        PIC X(7).
   719     12  WS-SAVE-CERT-NO.
   720         16  WS-CERT-NO-PRIME    PIC X(10).
   721         16  WS-CERT-NO-SUFX     PIC X.
   722
   723 01  CERT-KEY.
   724     12  CERT-COMPANY-CODE       PIC X.
   725     12  CERT-CARRIER            PIC X.
   726     12  CERT-GROUP              PIC X(6).
   727     12  CERT-STATE              PIC XX.
   728     12  CERT-ACCOUNT            PIC X(10).
   729     12  CERT-DATE               PIC XX.
   730     12  CERT-CERT.
   731         16  CERT-CERT-PRIME     PIC X(10).
   732         16  CERT-CERT-SUFX      PIC X.
   733
   734 01  ELCRTT-KEY.
   735     05  CTRLR-COMP-CD       PIC X.
   736     05  CTRLR-CARRIER       PIC X.
   737     05  CTRLR-GROUPING      PIC X(6).
   738     05  CTRLR-STATE         PIC X(2).
   739     05  CTRLR-ACCOUNT       PIC X(10).
   740     05  CTRLR-EFF-DT        PIC XX.
   741     05  CTRLR-CERT-NO       PIC X(11).
   742     05  CTRLR-REC-TYPE      PIC X.
   743 01  NOTE-KEY.
   744     12  NOTE-COMP-CD            PIC X.
   745     12  NOTE-CERT-KEY.
   746         16  NOTE-CARRIER        PIC X.
   747         16  NOTE-GROUP          PIC X(6).
   748         16  NOTE-STATE          PIC XX.
   749         16  NOTE-ACCOUNT        PIC X(10).
   750         16  NOTE-DATE           PIC XX.
   751         16  NOTE-CERT-NO        PIC X(11).
   752
   753 01  TRLR-KEY.
   754     12  TRLR-MAIN-KEY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  16
* EL131.cbl
   755         16  TRLR-COMPANY-CD     PIC X.
   756         16  TRLR-CARRIER        PIC X.
   757         16  TRLR-CLAIM-NO       PIC X(07).
   758         16  TRLR-CERT-NO        PIC X(11).
   759     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   760
   761 01  BENEFIT-KEY.
   762     12  BEN-CO-ID               PIC X(3).
   763     12  BEN-REC-TYPE            PIC X.
   764     12  FILLER                  PIC XX.
   765     12  BEN-ACC-CD              PIC XX.
   766     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   767
   768 01  CNTL-KEY.
   769     12  CNTL-CO-ID              PIC X(3).
   770     12  CNTL-REC-TYPE           PIC X.
   771     12  CNTL-PROC-ID            PIC X(4).
   772     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   773         16  CNTL-STATE-NUMBER   PIC XX.
   774         16  FILLER              PIC XX.
   775     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   776         16  FILLER              PIC X(3).
   777         16  CNTL-CARRIER        PIC X.
   778     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   779
   780 01  ACTQ-KEY                    PIC X(20).
   781
   782 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   783
   784 01  CHKQ-KEY.
   785     12  CHKQ-COMPANY-CODE       PIC X.
   786     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   787     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   788
   789 01  ARCH-KEY.
   790     12  ARCH-COMPANY-CODE       PIC X.
   791     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   792     12  ARCH-RECORD-TYPE        PIC X.
   793     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   794
   795 01  ACCT-KEY.
   796     05  ACCT-PARTIAL-KEY.
   797         12  ACCT-COMPANY-CODE   PIC X.
   798         12  ACCT-CARRIER        PIC X.
   799         12  ACCT-GROUP          PIC X(6).
   800         12  ACCT-STATE          PIC XX.
   801         12  ACCT-ACCOUNT        PIC X(10).
   802     05  ACCT-DATE               PIC XX.
   803
   804 01  WS-ELBENE-KEY.
   805     12  WS-ELBENE-COMPANY-CD    PIC X.
   806     12  WS-ELBENE-RECORD-TYPE   PIC X.
   807     12  WS-ELBENE-ID            PIC X(10).
   808
   809 01  ELALPH-KEY.
   810     12  ELALPH-COMPANY-CD       PIC X.
   811     12  ELALPH-SOURCE           PIC X.
   812     12  ELALPH-NAME.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  17
* EL131.cbl
   813         16  ELALPH-LAST-NAME    PIC X(15).
   814         16  ELALPH-FIRST-NAME.
   815             20  ELALPH-FIRST-INIT   PIC X.
   816             20  FILLER              PIC X(11).
   817         16  ELALPH-MIDDLE-INIT  PIC X.
   818     12  ELALPH-DATE             PIC X(08).
   819     12  ELALPH-TIME             PIC S9(04)    COMP.
   820
   821 01  COMP-LENGTHS.
   822     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   823     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   824     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   825     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   826     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   827     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   828     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   829     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   830     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   831     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   832     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   833     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   834     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   835     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  18
* EL131.cbl
   837*                                COPY ELCLNKLT.
   838******************************************************************
   839*                                                                *
   840*                                                                *
   841*                           ELCLNKLT                             *
   842*                            VMOD=2.003                          *
   843*                                                                *
   844*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   845*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   846*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   847*                                                                *
   848*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   849*   COMPLETING THE REQUIRED FIELDS.                              *
   850*                                                                *
   851*   THE CALLING PROGRAM SHOULD CHECK:                            *
   852*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   853*                              9999 INDICATES AN UNKNOWN ABEND   *
   854*                                   WAS DETECTED.                *
   855*                              ALL OTHER VALUES ARE NORMAL ERROR *
   856*                              CODES FOUND IN THE ERROR FILE.    *
   857******************************************************************
   858 01  W-1523-LINKDATA.
   859     12  W-1523-COMMON-PI-DATA.
   860         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   861         16  FILLER              PIC  X(67).
   862         16  W-1523-COMPANY-CD   PIC  X(01).
   863         16  FILLER              PIC  X(10).
   864         16  W-1523-CONTROL-IN-PROGRESS.
   865             20  W-1523-CARRIER  PIC  X(01).
   866             20  W-1523-GROUPING PIC  X(06).
   867             20  W-1523-STATE    PIC  X(02).
   868             20  W-1523-ACCOUNT  PIC  X(10).
   869             20  W-1523-CLAIM-CERT-GRP.
   870                 24  W-1523-CLAIM-NO
   871                                 PIC  X(07).
   872                 24  W-1523-CERT-NO.
   873                     28  W-1523-CERT-PRIME
   874                                 PIC  X(10).
   875                     28  W-1523-CERT-SFX
   876                                 PIC  X(01).
   877                 24  W-1523-CERT-EFF-DT
   878                                 PIC  X(02).
   879         16  FILLER              PIC X(265).
   880
   881     12  W-1523-WORK-AREA.
   882         16  W-1523-FORM-NUMBER  PIC  X(04).
   883         16  W-1523-NUMBER-COPIES
   884                                 PIC  9(01).
   885         16  W-1523-ADDR-TYPE    PIC  X(02).
   886         16  W-1523-FOLLOW-UP-DATE
   887                                 PIC  X(02).
   888         16  W-1523-RESEND-DATE  PIC  X(02).
   889         16  W-1523-ERROR-CODE   PIC  9(04).
   890             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   891             88  W-1523-FATAL-ERROR
   892                                    VALUES  0006 0013 0042
   893                                            0154 0168 0169
   894                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  19
* EL131.cbl
   895                                            0179 0186 0281
   896                                            0332 2055 3697
   897                                            3698 3699 3770
   898                                            3771 3772 7675
   899                                            9106 9808 9883
   900                                            9887.
   901             88  W-1523-STOP-ERRORS
   902                                    VALUES  0013 0042 0154
   903                                            0168 0169 0172
   904                                            0281 0332 2055
   905                                            3698 3699 7675
   906                                            9106 9808 9883
   907                                            9999.
   908         16  W-1523-REASON       PIC  X(70).
   909         16  W-1523-ARCHIVE-NUMBER
   910                                 PIC  9(08).
   911     12  W-1523-POINTER-AREA.
   912         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   913         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   914         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   915         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   916         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  20
* EL131.cbl
   918*                                COPY ELCINTF.
   919******************************************************************
   920*                                                                *
   921*                                                                *
   922*                            ELCINTF.                            *
   923*                            VMOD=2.017                          *
   924*                                                                *
   925*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   926*                                                                *
   927*       LENGTH = 1024                                            *
   928*                                                                *
   929******************************************************************
   930*                   C H A N G E   L O G
   931*
   932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   933*-----------------------------------------------------------------
   934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   935* EFFECTIVE    NUMBER
   936*-----------------------------------------------------------------
   937* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   938******************************************************************
   939 01  PROGRAM-INTERFACE-BLOCK.
   940     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   941     12  PI-CALLING-PROGRAM              PIC X(8).
   942     12  PI-SAVED-PROGRAM-1              PIC X(8).
   943     12  PI-SAVED-PROGRAM-2              PIC X(8).
   944     12  PI-SAVED-PROGRAM-3              PIC X(8).
   945     12  PI-SAVED-PROGRAM-4              PIC X(8).
   946     12  PI-SAVED-PROGRAM-5              PIC X(8).
   947     12  PI-SAVED-PROGRAM-6              PIC X(8).
   948     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   949     12  PI-COMPANY-ID                   PIC XXX.
   950     12  PI-COMPANY-CD                   PIC X.
   951
   952     12  PI-COMPANY-PASSWORD             PIC X(8).
   953
   954     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   955
   956     12  PI-CONTROL-IN-PROGRESS.
   957         16  PI-CARRIER                  PIC X.
   958         16  PI-GROUPING                 PIC X(6).
   959         16  PI-STATE                    PIC XX.
   960         16  PI-ACCOUNT                  PIC X(10).
   961         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   962                                         PIC X(10).
   963         16  PI-CLAIM-CERT-GRP.
   964             20  PI-CLAIM-NO             PIC X(7).
   965             20  PI-CERT-NO.
   966                 25  PI-CERT-PRIME       PIC X(10).
   967                 25  PI-CERT-SFX         PIC X.
   968             20  PI-CERT-EFF-DT          PIC XX.
   969         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   970             20  PI-PLAN-CODE            PIC X(2).
   971             20  PI-REVISION-NUMBER      PIC X(3).
   972             20  PI-PLAN-EFF-DT          PIC X(2).
   973             20  PI-PLAN-EXP-DT          PIC X(2).
   974             20  FILLER                  PIC X(11).
   975         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  21
* EL131.cbl
   976             20  PI-OE-REFERENCE-1.
   977                 25  PI-OE-REF-1-PRIME   PIC X(18).
   978                 25  PI-OE-REF-1-SUFF    PIC XX.
   979
   980     12  PI-SESSION-IN-PROGRESS          PIC X.
   981         88  CLAIM-SESSION                   VALUE '1'.
   982         88  CREDIT-SESSION                  VALUE '2'.
   983         88  WARRANTY-SESSION                VALUE '3'.
   984         88  MORTGAGE-SESSION                VALUE '4'.
   985         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   986
   987
   988*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   989
   990     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   991     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   992
   993     12  PI-CREDIT-USER                  PIC X.
   994         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   995         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   996
   997     12  PI-CLAIM-USER                   PIC X.
   998         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   999         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1000
  1001     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1002         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1003         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1004         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1005         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1006         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1007
  1008     12  PI-PROCESSOR-ID                 PIC X(4).
  1009
  1010     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1011
  1012     12  PI-MEMBER-CAPTION               PIC X(10).
  1013
  1014     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1015         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1016
  1017     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1018     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1019     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1020     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1021
  1022     12  PI-AH-OVERRIDE-L1               PIC X.
  1023     12  PI-AH-OVERRIDE-L2               PIC XX.
  1024     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1025     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1026
  1027     12  PI-NEW-SYSTEM                   PIC X(2).
  1028
  1029     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1030     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1031         88  PI-USES-PAID-TO                 VALUE '1'.
  1032     12  PI-CRDTCRD-SYSTEM.
  1033         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  22
* EL131.cbl
  1034             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1035             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1036         16  PI-CC-MONTH-END-DT          PIC XX.
  1037     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1038
  1039     12  PI-OE-REFERENCE-2.
  1040         16  PI-OE-REF-2-PRIME           PIC X(10).
  1041         16  PI-OE-REF-2-SUFF            PIC X.
  1042
  1043     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1044
  1045     12  PI-LANGUAGE-TYPE                PIC X.
  1046             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1047             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1048             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1049
  1050     12  PI-POLICY-LINKAGE-IND           PIC X.
  1051         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1052         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1053                                                   LOW-VALUES.
  1054
  1055     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1056     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1057         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1058         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1059
  1060     12  PI-PROCESSOR-CSR-IND            PIC X.
  1061         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1062         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1063
  1064     12  FILLER                          PIC X(3).
  1065
  1066     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1067
  1068     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1069         PI-SYSTEM-LEVEL.
  1070
  1071         16  PI-ENTRY-CODES.
  1072             20  PI-ENTRY-CD-1           PIC X.
  1073             20  PI-ENTRY-CD-2           PIC X.
  1074
  1075         16  PI-RETURN-CODES.
  1076             20  PI-RETURN-CD-1          PIC X.
  1077             20  PI-RETURN-CD-2          PIC X.
  1078
  1079         16  PI-UPDATE-STATUS-SAVE.
  1080             20  PI-UPDATE-BY            PIC X(4).
  1081             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1082
  1083         16  PI-LOWER-CASE-LETTERS       PIC X.
  1084             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1085
  1086*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1087*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1088*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1089
  1090         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1091             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  23
* EL131.cbl
  1092             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1093             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1094             88  ACCNT-CNTL                  VALUE '3'.
  1095             88  CARR-ACCNT-CNTL             VALUE '4'.
  1096
  1097         16  PI-PROCESSOR-CAP-LIST.
  1098             20  PI-SYSTEM-CONTROLS.
  1099                24 PI-SYSTEM-DISPLAY     PIC X.
  1100                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1101                24 PI-SYSTEM-MODIFY      PIC X.
  1102                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1103             20  FILLER                  PIC XX.
  1104             20  PI-DISPLAY-CAP          PIC X.
  1105                 88  DISPLAY-CAP             VALUE 'Y'.
  1106             20  PI-MODIFY-CAP           PIC X.
  1107                 88  MODIFY-CAP              VALUE 'Y'.
  1108             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1109                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1110             20  PI-FORCE-CAP            PIC X.
  1111                 88  FORCE-CAP               VALUE 'Y'.
  1112
  1113         16  PI-PROGRAM-CONTROLS.
  1114             20  PI-PGM-PRINT-OPT        PIC X.
  1115             20  PI-PGM-FORMAT-OPT       PIC X.
  1116             20  PI-PGM-PROCESS-OPT      PIC X.
  1117             20  PI-PGM-TOTALS-OPT       PIC X.
  1118
  1119         16  PI-HELP-INTERFACE.
  1120             20  PI-LAST-ERROR-NO        PIC X(4).
  1121             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1122
  1123         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1124             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1125
  1126         16  PI-CR-CONTROL-IN-PROGRESS.
  1127             20  PI-CR-CARRIER           PIC X.
  1128             20  PI-CR-GROUPING          PIC X(6).
  1129             20  PI-CR-STATE             PIC XX.
  1130             20  PI-CR-ACCOUNT           PIC X(10).
  1131             20  PI-CR-FIN-RESP          PIC X(10).
  1132             20  PI-CR-TYPE              PIC X.
  1133
  1134         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1135
  1136         16  PI-CR-MONTH-END-DT          PIC XX.
  1137
  1138         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1139             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1140             88  PI-ZERO-CARRIER             VALUE '1'.
  1141             88  PI-ZERO-GROUPING            VALUE '2'.
  1142             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1143
  1144         16  PI-CARRIER-SECURITY         PIC X.
  1145             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1146
  1147         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1148             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1149             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  24
* EL131.cbl
  1150
  1151         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1152             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1153                                         INDEXED BY PI-ACCESS-NDX
  1154                                         PIC X.
  1155
  1156         16  PI-GA-BILLING-CONTROL       PIC X.
  1157             88  PI-GA-BILLING               VALUE '1'.
  1158
  1159         16  PI-MAIL-PROCESSING          PIC X.
  1160             88  PI-MAIL-YES                 VALUE 'Y'.
  1161
  1162         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1163
  1164         16  PI-AR-SYSTEM.
  1165             20  PI-AR-PROCESSING-CNTL   PIC X.
  1166                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1167             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1168             20  PI-AR-MONTH-END-DT      PIC XX.
  1169
  1170         16  PI-MP-SYSTEM.
  1171             20  PI-MORTGAGE-USER            PIC X.
  1172                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1173                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1174             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1175                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1176                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1177                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1178                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1179                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1180             20  PI-MP-MONTH-END-DT          PIC XX.
  1181             20  PI-MP-REFERENCE-NO.
  1182                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1183                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1184
  1185         16  PI-LABEL-CONTROL            PIC X(01).
  1186             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1187             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1188
  1189         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1190             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1191
  1192         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1193             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1194             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1195
  1196         16  FILLER                      PIC X(14).
  1197
  1198     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1199******************************************************************
  1200     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1201         16  PI-NO-PMTS                    PIC 9(4).
  1202         16  PI-CERT-SWITCH                PIC X.
  1203             88  CREATED-CERT              VALUE '2'.
  1204         16  PI-PREM-TYPE                  PIC X.
  1205         16  PI-SAVE-CERT-NO.
  1206             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1207             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  25
* EL131.cbl
  1208         16  FILLER                        PIC X(46).
  1209         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1210         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1211         16  PI-REC-FOUND-SW               PIC X.
  1212         16  PI-LETTER-SW                  PIC X.
  1213         16  PI-PREV-TRLR-KEY              PIC X(22).
  1214         16  pi-claim-type                 pic x.
  1215         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1216         16  pi-approval-level             pic x.
  1217         16  FILLER                        PIC X(543).
  1218
  1219 01  SAVE-RECORD                 PIC X(450).
  1220
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  26
* EL131.cbl
  1222*                                COPY ELCLOGOF SUPPRESS.
  1223******************************************************************
  1224*                                                                *
  1225*                                                                *
  1226*                            ELCLOGOF.                           *
  1227*                            VMOD=2.001                          *
  1228*                                                                *
  1229*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1230*                                                                *
  1231******************************************************************
  1232 01  CLASIC-LOGOFF.
  1233     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1234     12  LOGOFF-TEXT.
  1235         16  FILLER          PIC X(5)    VALUE SPACES.
  1236         16  LOGOFF-MSG.
  1237             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1238             20  FILLER      PIC X       VALUE SPACES.
  1239             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1240         16  FILLER          PIC X(80)
  1241           VALUE '* YOU ARE NOW LOGGED OFF'.
  1242         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1243         16  FILLER          PIC X       VALUE QUOTE.
  1244         16  LOGOFF-SYS-MSG  PIC X(17)
  1245           VALUE 'S CLAS-IC SYSTEM '.
  1246     12  TEXT-MESSAGES.
  1247         16  UNACCESS-MSG    PIC X(29)
  1248             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1249         16  PGMIDERR-MSG    PIC X(17)
  1250             VALUE 'PROGRAM NOT FOUND'.
  1251
  1252*                                COPY ELCATTR SUPPRESS.
  1253******************************************************************
  1254*                                                                *
  1255*                            ELCATTR.                            *
  1256*                            VMOD=2.001                          *
  1257*                                                                *
  1258*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1259*                                                                *
  1260*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1261*                                                                *
  1262*                   POS 1   P=PROTECTED                          *
  1263*                           U=UNPROTECTED                        *
  1264*                           S=ASKIP                              *
  1265*                   POS 2   A=ALPHA/NUMERIC                      *
  1266*                           N=NUMERIC                            *
  1267*                   POS 3   N=NORMAL                             *
  1268*                           B=BRIGHT                             *
  1269*                           D=DARK                               *
  1270*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1271*                           OF=MODIFIED DATA TAG OFF             *
  1272*                                                                *
  1273*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1274******************************************************************
  1275 01  ATTRIBUTE-LIST.
  1276     12  AL-PABOF            PIC X       VALUE 'Y'.
  1277     12  AL-PABON            PIC X       VALUE 'Z'.
  1278     12  AL-PADOF            PIC X       VALUE '%'.
  1279     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  27
* EL131.cbl
  1280     12  AL-PANOF            PIC X       VALUE '-'.
  1281     12  AL-PANON            PIC X       VALUE '/'.
  1282     12  AL-SABOF            PIC X       VALUE '8'.
  1283     12  AL-SABON            PIC X       VALUE '9'.
  1284     12  AL-SADOF            PIC X       VALUE '@'.
  1285     12  AL-SADON            PIC X       VALUE QUOTE.
  1286     12  AL-SANOF            PIC X       VALUE '0'.
  1287     12  AL-SANON            PIC X       VALUE '1'.
  1288     12  AL-UABOF            PIC X       VALUE 'H'.
  1289     12  AL-UABON            PIC X       VALUE 'I'.
  1290     12  AL-UADOF            PIC X       VALUE '<'.
  1291     12  AL-UADON            PIC X       VALUE '('.
  1292     12  AL-UANOF            PIC X       VALUE ' '.
  1293     12  AL-UANON            PIC X       VALUE 'A'.
  1294     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1295     12  AL-UNBON            PIC X       VALUE 'R'.
  1296     12  AL-UNDOF            PIC X       VALUE '*'.
  1297     12  AL-UNDON            PIC X       VALUE ')'.
  1298     12  AL-UNNOF            PIC X       VALUE '&'.
  1299     12  AL-UNNON            PIC X       VALUE 'J'.
  1300
  1301*                                COPY ELCAID SUPPRESS.
  1302******************************************************************
  1303*                                                                *
  1304*                            ELCAID.                             *
  1305*                            VMOD=2.001                          *
  1306*                                                                *
  1307*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1308*                                                                *
  1309*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1310*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1311******************************************************************
  1312
  1313 01  DFHAID.
  1314   02  DFHNULL   PIC  X  VALUE  ' '.
  1315   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1316   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1317   02  DFHPEN    PIC  X  VALUE  '='.
  1318   02  DFHOPID   PIC  X  VALUE  'W'.
  1319   02  DFHPA1    PIC  X  VALUE  '%'.
  1320   02  DFHPA2    PIC  X  VALUE  '>'.
  1321   02  DFHPA3    PIC  X  VALUE  ','.
  1322   02  DFHPF1    PIC  X  VALUE  '1'.
  1323   02  DFHPF2    PIC  X  VALUE  '2'.
  1324   02  DFHPF3    PIC  X  VALUE  '3'.
  1325   02  DFHPF4    PIC  X  VALUE  '4'.
  1326   02  DFHPF5    PIC  X  VALUE  '5'.
  1327   02  DFHPF6    PIC  X  VALUE  '6'.
  1328   02  DFHPF7    PIC  X  VALUE  '7'.
  1329   02  DFHPF8    PIC  X  VALUE  '8'.
  1330   02  DFHPF9    PIC  X  VALUE  '9'.
  1331   02  DFHPF10   PIC  X  VALUE  ':'.
  1332   02  DFHPF11   PIC  X  VALUE  '#'.
  1333   02  DFHPF12   PIC  X  VALUE  '@'.
  1334   02  DFHPF13   PIC  X  VALUE  'A'.
  1335   02  DFHPF14   PIC  X  VALUE  'B'.
  1336   02  DFHPF15   PIC  X  VALUE  'C'.
  1337   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  28
* EL131.cbl
  1338   02  DFHPF17   PIC  X  VALUE  'E'.
  1339   02  DFHPF18   PIC  X  VALUE  'F'.
  1340   02  DFHPF19   PIC  X  VALUE  'G'.
  1341   02  DFHPF20   PIC  X  VALUE  'H'.
  1342   02  DFHPF21   PIC  X  VALUE  'I'.
  1343*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1344   02  DFHPF22   PIC  X  VALUE  '['.
  1345   02  DFHPF23   PIC  X  VALUE  '.'.
  1346   02  DFHPF24   PIC  X  VALUE  '<'.
  1347   02  DFHMSRE   PIC  X  VALUE  'X'.
  1348   02  DFHSTRF   PIC  X  VALUE  'h'.
  1349   02  DFHTRIG   PIC  X  VALUE  '"'.
  1350 01  FILLER REDEFINES DFHAID.
  1351     12  FILLER                  PIC X(8).
  1352     12  AID-KEYS OCCURS 24 TIMES.
  1353         16  FILLER              PIC X.
  1354
  1355*                                COPY EL131S.
  1356 01  EL131AI.
  1357     05  FILLER            PIC  X(0012).
  1358*    -------------------------------
  1359     05  DATEL PIC S9(0004) COMP.
  1360     05  DATEF PIC  X(0001).
  1361     05  FILLER REDEFINES DATEF.
  1362         10  DATEA PIC  X(0001).
  1363     05  DATEI PIC  X(0008).
  1364*    -------------------------------
  1365     05  TIMEL PIC S9(0004) COMP.
  1366     05  TIMEF PIC  X(0001).
  1367     05  FILLER REDEFINES TIMEF.
  1368         10  TIMEA PIC  X(0001).
  1369     05  TIMEI PIC  X(0005).
  1370*    -------------------------------
  1371     05  SEQUL PIC S9(0004) COMP.
  1372     05  SEQUF PIC  X(0001).
  1373     05  FILLER REDEFINES SEQUF.
  1374         10  SEQUA PIC  X(0001).
  1375     05  SEQUI PIC  X(0010).
  1376*    -------------------------------
  1377     05  COMPL PIC S9(0004) COMP.
  1378     05  COMPF PIC  X(0001).
  1379     05  FILLER REDEFINES COMPF.
  1380         10  COMPA PIC  X(0001).
  1381     05  COMPI PIC  X(0003).
  1382*    -------------------------------
  1383     05  USERIDL PIC S9(0004) COMP.
  1384     05  USERIDF PIC  X(0001).
  1385     05  FILLER REDEFINES USERIDF.
  1386         10  USERIDA PIC  X(0001).
  1387     05  USERIDI PIC  X(0004).
  1388*    -------------------------------
  1389     05  LABEL1L PIC S9(0004) COMP.
  1390     05  LABEL1F PIC  X(0001).
  1391     05  FILLER REDEFINES LABEL1F.
  1392         10  LABEL1A PIC  X(0001).
  1393     05  LABEL1I PIC  X(0011).
  1394*    -------------------------------
  1395     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  29
* EL131.cbl
  1396     05  PCERTNOF PIC  X(0001).
  1397     05  FILLER REDEFINES PCERTNOF.
  1398         10  PCERTNOA PIC  X(0001).
  1399     05  PCERTNOI PIC  X(0010).
  1400*    -------------------------------
  1401     05  PSUFXL PIC S9(0004) COMP.
  1402     05  PSUFXF PIC  X(0001).
  1403     05  FILLER REDEFINES PSUFXF.
  1404         10  PSUFXA PIC  X(0001).
  1405     05  PSUFXI PIC  X(0001).
  1406*    -------------------------------
  1407     05  CCNOL PIC S9(0004) COMP.
  1408     05  CCNOF PIC  X(0001).
  1409     05  FILLER REDEFINES CCNOF.
  1410         10  CCNOA PIC  X(0001).
  1411     05  CCNOI PIC  X(0016).
  1412*    -------------------------------
  1413     05  MAINTL PIC S9(0004) COMP.
  1414     05  MAINTF PIC  X(0001).
  1415     05  FILLER REDEFINES MAINTF.
  1416         10  MAINTA PIC  X(0001).
  1417     05  MAINTI PIC  X(0001).
  1418*    -------------------------------
  1419     05  CLAIML PIC S9(0004) COMP.
  1420     05  CLAIMF PIC  X(0001).
  1421     05  FILLER REDEFINES CLAIMF.
  1422         10  CLAIMA PIC  X(0001).
  1423     05  CLAIMI PIC  X(0007).
  1424*    -------------------------------
  1425     05  CARRL PIC S9(0004) COMP.
  1426     05  CARRF PIC  X(0001).
  1427     05  FILLER REDEFINES CARRF.
  1428         10  CARRA PIC  X(0001).
  1429     05  CARRI PIC  X(0001).
  1430*    -------------------------------
  1431     05  CERTL PIC S9(0004) COMP.
  1432     05  CERTF PIC  X(0001).
  1433     05  FILLER REDEFINES CERTF.
  1434         10  CERTA PIC  X(0001).
  1435     05  CERTI PIC  X(0010).
  1436*    -------------------------------
  1437     05  SUFXL PIC S9(0004) COMP.
  1438     05  SUFXF PIC  X(0001).
  1439     05  FILLER REDEFINES SUFXF.
  1440         10  SUFXA PIC  X(0001).
  1441     05  SUFXI PIC  X(0001).
  1442*    -------------------------------
  1443     05  TYPEL PIC S9(0004) COMP.
  1444     05  TYPEF PIC  X(0001).
  1445     05  FILLER REDEFINES TYPEF.
  1446         10  TYPEA PIC  X(0001).
  1447     05  TYPEI PIC  X(0001).
  1448*    -------------------------------
  1449     05  BENPERL PIC S9(0004) COMP.
  1450     05  BENPERF PIC  X(0001).
  1451     05  FILLER REDEFINES BENPERF.
  1452         10  BENPERA PIC  X(0001).
  1453     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  30
* EL131.cbl
  1454*    -------------------------------
  1455     05  INSTYPEL PIC S9(0004) COMP.
  1456     05  INSTYPEF PIC  X(0001).
  1457     05  FILLER REDEFINES INSTYPEF.
  1458         10  INSTYPEA PIC  X(0001).
  1459     05  INSTYPEI PIC  X(0001).
  1460*    -------------------------------
  1461     05  STATUSL PIC S9(0004) COMP.
  1462     05  STATUSF PIC  X(0001).
  1463     05  FILLER REDEFINES STATUSF.
  1464         10  STATUSA PIC  X(0001).
  1465     05  STATUSI PIC  X(0006).
  1466*    -------------------------------
  1467     05  INCL PIC S9(0004) COMP.
  1468     05  INCF PIC  X(0001).
  1469     05  FILLER REDEFINES INCF.
  1470         10  INCA PIC  X(0001).
  1471     05  INCI PIC  X(0008).
  1472*    -------------------------------
  1473     05  REPL PIC S9(0004) COMP.
  1474     05  REPF PIC  X(0001).
  1475     05  FILLER REDEFINES REPF.
  1476         10  REPA PIC  X(0001).
  1477     05  REPI PIC  X(0008).
  1478*    -------------------------------
  1479     05  ICD1L PIC S9(0004) COMP.
  1480     05  ICD1F PIC  X(0001).
  1481     05  FILLER REDEFINES ICD1F.
  1482         10  ICD1A PIC  X(0001).
  1483     05  ICD1I PIC  X(0008).
  1484*    -------------------------------
  1485     05  ICD2L PIC S9(0004) COMP.
  1486     05  ICD2F PIC  X(0001).
  1487     05  FILLER REDEFINES ICD2F.
  1488         10  ICD2A PIC  X(0001).
  1489     05  ICD2I PIC  X(0008).
  1490*    -------------------------------
  1491     05  DIAGL PIC S9(0004) COMP.
  1492     05  DIAGF PIC  X(0001).
  1493     05  FILLER REDEFINES DIAGF.
  1494         10  DIAGA PIC  X(0001).
  1495     05  DIAGI PIC  X(0060).
  1496*    -------------------------------
  1497     05  ACCSWL PIC S9(0004) COMP.
  1498     05  ACCSWF PIC  X(0001).
  1499     05  FILLER REDEFINES ACCSWF.
  1500         10  ACCSWA PIC  X(0001).
  1501     05  ACCSWI PIC  X(0001).
  1502*    -------------------------------
  1503     05  BENEL PIC S9(0004) COMP.
  1504     05  BENEF PIC  X(0001).
  1505     05  FILLER REDEFINES BENEF.
  1506         10  BENEA PIC  X(0001).
  1507     05  BENEI PIC  X(0010).
  1508*    -------------------------------
  1509     05  BIRTHL PIC S9(0004) COMP.
  1510     05  BIRTHF PIC  X(0001).
  1511     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  31
* EL131.cbl
  1512         10  BIRTHA PIC  X(0001).
  1513     05  BIRTHI PIC  X(0008).
  1514*    -------------------------------
  1515     05  SOCIALL PIC S9(0004) COMP.
  1516     05  SOCIALF PIC  X(0001).
  1517     05  FILLER REDEFINES SOCIALF.
  1518         10  SOCIALA PIC  X(0001).
  1519     05  SOCIALI PIC  X(0011).
  1520*    -------------------------------
  1521     05  SEXL PIC S9(0004) COMP.
  1522     05  SEXF PIC  X(0001).
  1523     05  FILLER REDEFINES SEXF.
  1524         10  SEXA PIC  X(0001).
  1525     05  SEXI PIC  X(0001).
  1526*    -------------------------------
  1527     05  MLNAMEL PIC S9(0004) COMP.
  1528     05  MLNAMEF PIC  X(0001).
  1529     05  FILLER REDEFINES MLNAMEF.
  1530         10  MLNAMEA PIC  X(0001).
  1531     05  MLNAMEI PIC  X(0015).
  1532*    -------------------------------
  1533     05  MFNAMEL PIC S9(0004) COMP.
  1534     05  MFNAMEF PIC  X(0001).
  1535     05  FILLER REDEFINES MFNAMEF.
  1536         10  MFNAMEA PIC  X(0001).
  1537     05  MFNAMEI PIC  X(0012).
  1538*    -------------------------------
  1539     05  MMINITL PIC S9(0004) COMP.
  1540     05  MMINITF PIC  X(0001).
  1541     05  FILLER REDEFINES MMINITF.
  1542         10  MMINITA PIC  X(0001).
  1543     05  MMINITI PIC  X(0001).
  1544*    -------------------------------
  1545     05  LOANNOL PIC S9(0004) COMP.
  1546     05  LOANNOF PIC  X(0001).
  1547     05  FILLER REDEFINES LOANNOF.
  1548         10  LOANNOA PIC  X(0001).
  1549     05  LOANNOI PIC  X(0008).
  1550*    -------------------------------
  1551     05  CRTLNMEL PIC S9(0004) COMP.
  1552     05  CRTLNMEF PIC  X(0001).
  1553     05  FILLER REDEFINES CRTLNMEF.
  1554         10  CRTLNMEA PIC  X(0001).
  1555     05  CRTLNMEI PIC  X(0015).
  1556*    -------------------------------
  1557     05  CRTFNMEL PIC S9(0004) COMP.
  1558     05  CRTFNMEF PIC  X(0001).
  1559     05  FILLER REDEFINES CRTFNMEF.
  1560         10  CRTFNMEA PIC  X(0001).
  1561     05  CRTFNMEI PIC  X(0012).
  1562*    -------------------------------
  1563     05  CRTINITL PIC S9(0004) COMP.
  1564     05  CRTINITF PIC  X(0001).
  1565     05  FILLER REDEFINES CRTINITF.
  1566         10  CRTINITA PIC  X(0001).
  1567     05  CRTINITI PIC  X(0001).
  1568*    -------------------------------
  1569     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  32
* EL131.cbl
  1570     05  LOANBALF PIC  X(0001).
  1571     05  FILLER REDEFINES LOANBALF.
  1572         10  LOANBALA PIC  X(0001).
  1573     05  LOANBALI PIC  9(7)V99.
  1574*    -------------------------------
  1575     05  PROCL PIC S9(0004) COMP.
  1576     05  PROCF PIC  X(0001).
  1577     05  FILLER REDEFINES PROCF.
  1578         10  PROCA PIC  X(0001).
  1579     05  PROCI PIC  X(0004).
  1580*    -------------------------------
  1581     05  SUPVL PIC S9(0004) COMP.
  1582     05  SUPVF PIC  X(0001).
  1583     05  FILLER REDEFINES SUPVF.
  1584         10  SUPVA PIC  X(0001).
  1585     05  SUPVI PIC  X(0001).
  1586*    -------------------------------
  1587     05  PRICDL PIC S9(0004) COMP.
  1588     05  PRICDF PIC  X(0001).
  1589     05  FILLER REDEFINES PRICDF.
  1590         10  PRICDA PIC  X(0001).
  1591     05  PRICDI PIC  X(0001).
  1592*    -------------------------------
  1593     05  CRITPL PIC S9(0004) COMP.
  1594     05  CRITPF PIC  X(0001).
  1595     05  FILLER REDEFINES CRITPF.
  1596         10  CRITPA PIC  X(0001).
  1597     05  CRITPI PIC  X(0002).
  1598*    -------------------------------
  1599     05  CRITPTL PIC S9(0004) COMP.
  1600     05  CRITPTF PIC  X(0001).
  1601     05  FILLER REDEFINES CRITPTF.
  1602         10  CRITPTA PIC  X(0001).
  1603     05  CRITPTI PIC  X(0002).
  1604*    -------------------------------
  1605     05  RTWMOSL PIC S9(0004) COMP.
  1606     05  RTWMOSF PIC  X(0001).
  1607     05  FILLER REDEFINES RTWMOSF.
  1608         10  RTWMOSA PIC  X(0001).
  1609     05  RTWMOSI PIC  X(0002).
  1610*    -------------------------------
  1611     05  FILETOL PIC S9(0004) COMP.
  1612     05  FILETOF PIC  X(0001).
  1613     05  FILLER REDEFINES FILETOF.
  1614         10  FILETOA PIC  X(0001).
  1615     05  FILETOI PIC  X(0004).
  1616*    -------------------------------
  1617     05  PTHRHDGL PIC S9(0004) COMP.
  1618     05  PTHRHDGF PIC  X(0001).
  1619     05  FILLER REDEFINES PTHRHDGF.
  1620         10  PTHRHDGA PIC  X(0001).
  1621     05  PTHRHDGI PIC  X(0010).
  1622*    -------------------------------
  1623     05  PDTHRUL PIC S9(0004) COMP.
  1624     05  PDTHRUF PIC  X(0001).
  1625     05  FILLER REDEFINES PDTHRUF.
  1626         10  PDTHRUA PIC  X(0001).
  1627     05  PDTHRUI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  33
* EL131.cbl
  1628*    -------------------------------
  1629     05  PDAMTL PIC S9(0004) COMP.
  1630     05  PDAMTF PIC  X(0001).
  1631     05  FILLER REDEFINES PDAMTF.
  1632         10  PDAMTA PIC  X(0001).
  1633     05  PDAMTI PIC  9(7)V99.
  1634*    -------------------------------
  1635     05  NODAYSL PIC S9(0004) COMP.
  1636     05  NODAYSF PIC  X(0001).
  1637     05  FILLER REDEFINES NODAYSF.
  1638         10  NODAYSA PIC  X(0001).
  1639     05  NODAYSI PIC  9(5).
  1640*    -------------------------------
  1641     05  NOPMTSL PIC S9(0004) COMP.
  1642     05  NOPMTSF PIC  X(0001).
  1643     05  FILLER REDEFINES NOPMTSF.
  1644         10  NOPMTSA PIC  X(0001).
  1645     05  NOPMTSI PIC  9(4).
  1646*    -------------------------------
  1647     05  FORMTYPL PIC S9(0004) COMP.
  1648     05  FORMTYPF PIC  X(0001).
  1649     05  FILLER REDEFINES FORMTYPF.
  1650         10  FORMTYPA PIC  X(0001).
  1651     05  FORMTYPI PIC  X(0001).
  1652*    -------------------------------
  1653     05  ESTL PIC S9(0004) COMP.
  1654     05  ESTF PIC  X(0001).
  1655     05  FILLER REDEFINES ESTF.
  1656         10  ESTA PIC  X(0001).
  1657     05  ESTI PIC  X(0008).
  1658*    -------------------------------
  1659     05  AUIDL PIC S9(0004) COMP.
  1660     05  AUIDF PIC  X(0001).
  1661     05  FILLER REDEFINES AUIDF.
  1662         10  AUIDA PIC  X(0001).
  1663     05  AUIDI PIC  X(0004).
  1664*    -------------------------------
  1665     05  OCCL PIC S9(0004) COMP.
  1666     05  OCCF PIC  X(0001).
  1667     05  FILLER REDEFINES OCCF.
  1668         10  OCCA PIC  X(0001).
  1669     05  OCCI PIC  X(0006).
  1670*    -------------------------------
  1671     05  MNTDTL PIC S9(0004) COMP.
  1672     05  MNTDTF PIC  X(0001).
  1673     05  FILLER REDEFINES MNTDTF.
  1674         10  MNTDTA PIC  X(0001).
  1675     05  MNTDTI PIC  X(0008).
  1676*    -------------------------------
  1677     05  MNTTYPEL PIC S9(0004) COMP.
  1678     05  MNTTYPEF PIC  X(0001).
  1679     05  FILLER REDEFINES MNTTYPEF.
  1680         10  MNTTYPEA PIC  X(0001).
  1681     05  MNTTYPEI PIC  X(0006).
  1682*    -------------------------------
  1683     05  CERTCARL PIC S9(0004) COMP.
  1684     05  CERTCARF PIC  X(0001).
  1685     05  FILLER REDEFINES CERTCARF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  34
* EL131.cbl
  1686         10  CERTCARA PIC  X(0001).
  1687     05  CERTCARI PIC  X(0001).
  1688*    -------------------------------
  1689     05  CERTGRPL PIC S9(0004) COMP.
  1690     05  CERTGRPF PIC  X(0001).
  1691     05  FILLER REDEFINES CERTGRPF.
  1692         10  CERTGRPA PIC  X(0001).
  1693     05  CERTGRPI PIC  X(0006).
  1694*    -------------------------------
  1695     05  CERTSTL PIC S9(0004) COMP.
  1696     05  CERTSTF PIC  X(0001).
  1697     05  FILLER REDEFINES CERTSTF.
  1698         10  CERTSTA PIC  X(0001).
  1699     05  CERTSTI PIC  X(0002).
  1700*    -------------------------------
  1701     05  CERTACTL PIC S9(0004) COMP.
  1702     05  CERTACTF PIC  X(0001).
  1703     05  FILLER REDEFINES CERTACTF.
  1704         10  CERTACTA PIC  X(0001).
  1705     05  CERTACTI PIC  X(0010).
  1706*    -------------------------------
  1707     05  CERTEFFL PIC S9(0004) COMP.
  1708     05  CERTEFFF PIC  X(0001).
  1709     05  FILLER REDEFINES CERTEFFF.
  1710         10  CERTEFFA PIC  X(0001).
  1711     05  CERTEFFI PIC  X(0008).
  1712*    -------------------------------
  1713     05  ISSAGEL PIC S9(0004) COMP.
  1714     05  ISSAGEF PIC  X(0001).
  1715     05  FILLER REDEFINES ISSAGEF.
  1716         10  ISSAGEA PIC  X(0001).
  1717     05  ISSAGEI PIC  X(0002).
  1718*    -------------------------------
  1719     05  APRL PIC S9(0004) COMP.
  1720     05  APRF PIC  X(0001).
  1721     05  FILLER REDEFINES APRF.
  1722         10  APRA PIC  X(0001).
  1723     05  APRI PIC  9(4)V9(4).
  1724*    -------------------------------
  1725     05  PMTFREQL PIC S9(0004) COMP.
  1726     05  PMTFREQF PIC  X(0001).
  1727     05  FILLER REDEFINES PMTFREQF.
  1728         10  PMTFREQA PIC  X(0001).
  1729     05  PMTFREQI PIC  99.
  1730*    -------------------------------
  1731     05  INDGRPL PIC S9(0004) COMP.
  1732     05  INDGRPF PIC  X(0001).
  1733     05  FILLER REDEFINES INDGRPF.
  1734         10  INDGRPA PIC  X(0001).
  1735     05  INDGRPI PIC  X(0001).
  1736*    -------------------------------
  1737     05  PREMTYPL PIC S9(0004) COMP.
  1738     05  PREMTYPF PIC  X(0001).
  1739     05  FILLER REDEFINES PREMTYPF.
  1740         10  PREMTYPA PIC  X(0001).
  1741     05  PREMTYPI PIC  X(0001).
  1742*    -------------------------------
  1743     05  REINCDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  35
* EL131.cbl
  1744     05  REINCDF PIC  X(0001).
  1745     05  FILLER REDEFINES REINCDF.
  1746         10  REINCDA PIC  X(0001).
  1747     05  REINCDI PIC  X(0001).
  1748*    -------------------------------
  1749     05  JNTLNMEL PIC S9(0004) COMP.
  1750     05  JNTLNMEF PIC  X(0001).
  1751     05  FILLER REDEFINES JNTLNMEF.
  1752         10  JNTLNMEA PIC  X(0001).
  1753     05  JNTLNMEI PIC  X(0015).
  1754*    -------------------------------
  1755     05  JNTFNMEL PIC S9(0004) COMP.
  1756     05  JNTFNMEF PIC  X(0001).
  1757     05  FILLER REDEFINES JNTFNMEF.
  1758         10  JNTFNMEA PIC  X(0001).
  1759     05  JNTFNMEI PIC  X(0012).
  1760*    -------------------------------
  1761     05  JNTINITL PIC S9(0004) COMP.
  1762     05  JNTINITF PIC  X(0001).
  1763     05  FILLER REDEFINES JNTINITF.
  1764         10  JNTINITA PIC  X(0001).
  1765     05  JNTINITI PIC  X(0001).
  1766*    -------------------------------
  1767     05  JNTAGEL PIC S9(0004) COMP.
  1768     05  JNTAGEF PIC  X(0001).
  1769     05  FILLER REDEFINES JNTAGEF.
  1770         10  JNTAGEA PIC  X(0001).
  1771     05  JNTAGEI PIC  X(0002).
  1772*    -------------------------------
  1773     05  ADDONDTL PIC S9(0004) COMP.
  1774     05  ADDONDTF PIC  X(0001).
  1775     05  FILLER REDEFINES ADDONDTF.
  1776         10  ADDONDTA PIC  X(0001).
  1777     05  ADDONDTI PIC  X(0008).
  1778*    -------------------------------
  1779     05  LCVDSCRL PIC S9(0004) COMP.
  1780     05  LCVDSCRF PIC  X(0001).
  1781     05  FILLER REDEFINES LCVDSCRF.
  1782         10  LCVDSCRA PIC  X(0001).
  1783     05  LCVDSCRI PIC  X(0006).
  1784*    -------------------------------
  1785     05  LCVKINDL PIC S9(0004) COMP.
  1786     05  LCVKINDF PIC  X(0001).
  1787     05  FILLER REDEFINES LCVKINDF.
  1788         10  LCVKINDA PIC  X(0001).
  1789     05  LCVKINDI PIC  X(0003).
  1790*    -------------------------------
  1791     05  LCVCDL PIC S9(0004) COMP.
  1792     05  LCVCDF PIC  X(0001).
  1793     05  FILLER REDEFINES LCVCDF.
  1794         10  LCVCDA PIC  X(0001).
  1795     05  LCVCDI PIC  X(0002).
  1796*    -------------------------------
  1797     05  LCVOTRML PIC S9(0004) COMP.
  1798     05  LCVOTRMF PIC  X(0001).
  1799     05  FILLER REDEFINES LCVOTRMF.
  1800         10  LCVOTRMA PIC  X(0001).
  1801     05  LCVOTRMI PIC  999.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  36
* EL131.cbl
  1802*    -------------------------------
  1803     05  LCVRTRML PIC S9(0004) COMP.
  1804     05  LCVRTRMF PIC  X(0001).
  1805     05  FILLER REDEFINES LCVRTRMF.
  1806         10  LCVRTRMA PIC  X(0001).
  1807     05  LCVRTRMI PIC  X(0003).
  1808*    -------------------------------
  1809     05  LCVRATEL PIC S9(0004) COMP.
  1810     05  LCVRATEF PIC  X(0001).
  1811     05  FILLER REDEFINES LCVRATEF.
  1812         10  LCVRATEA PIC  X(0001).
  1813     05  LCVRATEI PIC  9999V99.
  1814*    -------------------------------
  1815     05  LCVBENEL PIC S9(0004) COMP.
  1816     05  LCVBENEF PIC  X(0001).
  1817     05  FILLER REDEFINES LCVBENEF.
  1818         10  LCVBENEA PIC  X(0001).
  1819     05  LCVBENEI PIC  9(9)V99.
  1820*    -------------------------------
  1821     05  LCVFORML PIC S9(0004) COMP.
  1822     05  LCVFORMF PIC  X(0001).
  1823     05  FILLER REDEFINES LCVFORMF.
  1824         10  LCVFORMA PIC  X(0001).
  1825     05  LCVFORMI PIC  X(0012).
  1826*    -------------------------------
  1827     05  LCVCNDTL PIC S9(0004) COMP.
  1828     05  LCVCNDTF PIC  X(0001).
  1829     05  FILLER REDEFINES LCVCNDTF.
  1830         10  LCVCNDTA PIC  X(0001).
  1831     05  LCVCNDTI PIC  X(0008).
  1832*    -------------------------------
  1833     05  LCVEXITL PIC S9(0004) COMP.
  1834     05  LCVEXITF PIC  X(0001).
  1835     05  FILLER REDEFINES LCVEXITF.
  1836         10  LCVEXITA PIC  X(0001).
  1837     05  LCVEXITI PIC  X(0008).
  1838*    -------------------------------
  1839     05  LCVSTATL PIC S9(0004) COMP.
  1840     05  LCVSTATF PIC  X(0001).
  1841     05  FILLER REDEFINES LCVSTATF.
  1842         10  LCVSTATA PIC  X(0001).
  1843     05  LCVSTATI PIC  X(0006).
  1844*    -------------------------------
  1845     05  ACVDSCRL PIC S9(0004) COMP.
  1846     05  ACVDSCRF PIC  X(0001).
  1847     05  FILLER REDEFINES ACVDSCRF.
  1848         10  ACVDSCRA PIC  X(0001).
  1849     05  ACVDSCRI PIC  X(0006).
  1850*    -------------------------------
  1851     05  ACVKINDL PIC S9(0004) COMP.
  1852     05  ACVKINDF PIC  X(0001).
  1853     05  FILLER REDEFINES ACVKINDF.
  1854         10  ACVKINDA PIC  X(0001).
  1855     05  ACVKINDI PIC  X(0003).
  1856*    -------------------------------
  1857     05  ACVCDL PIC S9(0004) COMP.
  1858     05  ACVCDF PIC  X(0001).
  1859     05  FILLER REDEFINES ACVCDF.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  37
* EL131.cbl
  1860         10  ACVCDA PIC  X(0001).
  1861     05  ACVCDI PIC  X(0002).
  1862*    -------------------------------
  1863     05  ACVOTRML PIC S9(0004) COMP.
  1864     05  ACVOTRMF PIC  X(0001).
  1865     05  FILLER REDEFINES ACVOTRMF.
  1866         10  ACVOTRMA PIC  X(0001).
  1867     05  ACVOTRMI PIC  999.
  1868*    -------------------------------
  1869     05  ACVRTRML PIC S9(0004) COMP.
  1870     05  ACVRTRMF PIC  X(0001).
  1871     05  FILLER REDEFINES ACVRTRMF.
  1872         10  ACVRTRMA PIC  X(0001).
  1873     05  ACVRTRMI PIC  X(0003).
  1874*    -------------------------------
  1875     05  ACVRATEL PIC S9(0004) COMP.
  1876     05  ACVRATEF PIC  X(0001).
  1877     05  FILLER REDEFINES ACVRATEF.
  1878         10  ACVRATEA PIC  X(0001).
  1879     05  ACVRATEI PIC  9999V99.
  1880*    -------------------------------
  1881     05  ACVBENEL PIC S9(0004) COMP.
  1882     05  ACVBENEF PIC  X(0001).
  1883     05  FILLER REDEFINES ACVBENEF.
  1884         10  ACVBENEA PIC  X(0001).
  1885     05  ACVBENEI PIC  9(9)V99.
  1886*    -------------------------------
  1887     05  ACVFORML PIC S9(0004) COMP.
  1888     05  ACVFORMF PIC  X(0001).
  1889     05  FILLER REDEFINES ACVFORMF.
  1890         10  ACVFORMA PIC  X(0001).
  1891     05  ACVFORMI PIC  X(0012).
  1892*    -------------------------------
  1893     05  ACVCNDTL PIC S9(0004) COMP.
  1894     05  ACVCNDTF PIC  X(0001).
  1895     05  FILLER REDEFINES ACVCNDTF.
  1896         10  ACVCNDTA PIC  X(0001).
  1897     05  ACVCNDTI PIC  X(0008).
  1898*    -------------------------------
  1899     05  ACVEXITL PIC S9(0004) COMP.
  1900     05  ACVEXITF PIC  X(0001).
  1901     05  FILLER REDEFINES ACVEXITF.
  1902         10  ACVEXITA PIC  X(0001).
  1903     05  ACVEXITI PIC  X(0008).
  1904*    -------------------------------
  1905     05  ACVSTATL PIC S9(0004) COMP.
  1906     05  ACVSTATF PIC  X(0001).
  1907     05  FILLER REDEFINES ACVSTATF.
  1908         10  ACVSTATA PIC  X(0001).
  1909     05  ACVSTATI PIC  X(0006).
  1910*    -------------------------------
  1911     05  LABEL2L PIC S9(0004) COMP.
  1912     05  LABEL2F PIC  X(0001).
  1913     05  FILLER REDEFINES LABEL2F.
  1914         10  LABEL2A PIC  X(0001).
  1915     05  LABEL2I PIC  X(0014).
  1916*    -------------------------------
  1917     05  BCERT1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  38
* EL131.cbl
  1918     05  BCERT1F PIC  X(0001).
  1919     05  FILLER REDEFINES BCERT1F.
  1920         10  BCERT1A PIC  X(0001).
  1921     05  BCERT1I PIC  X(0010).
  1922*    -------------------------------
  1923     05  BSUFX1L PIC S9(0004) COMP.
  1924     05  BSUFX1F PIC  X(0001).
  1925     05  FILLER REDEFINES BSUFX1F.
  1926         10  BSUFX1A PIC  X(0001).
  1927     05  BSUFX1I PIC  X(0001).
  1928*    -------------------------------
  1929     05  BCERT2L PIC S9(0004) COMP.
  1930     05  BCERT2F PIC  X(0001).
  1931     05  FILLER REDEFINES BCERT2F.
  1932         10  BCERT2A PIC  X(0001).
  1933     05  BCERT2I PIC  X(0010).
  1934*    -------------------------------
  1935     05  BSUFX2L PIC S9(0004) COMP.
  1936     05  BSUFX2F PIC  X(0001).
  1937     05  FILLER REDEFINES BSUFX2F.
  1938         10  BSUFX2A PIC  X(0001).
  1939     05  BSUFX2I PIC  X(0001).
  1940*    -------------------------------
  1941     05  BCERT3L PIC S9(0004) COMP.
  1942     05  BCERT3F PIC  X(0001).
  1943     05  FILLER REDEFINES BCERT3F.
  1944         10  BCERT3A PIC  X(0001).
  1945     05  BCERT3I PIC  X(0010).
  1946*    -------------------------------
  1947     05  BSUFX3L PIC S9(0004) COMP.
  1948     05  BSUFX3F PIC  X(0001).
  1949     05  FILLER REDEFINES BSUFX3F.
  1950         10  BSUFX3A PIC  X(0001).
  1951     05  BSUFX3I PIC  X(0001).
  1952*    -------------------------------
  1953     05  BCERT4L PIC S9(0004) COMP.
  1954     05  BCERT4F PIC  X(0001).
  1955     05  FILLER REDEFINES BCERT4F.
  1956         10  BCERT4A PIC  X(0001).
  1957     05  BCERT4I PIC  X(0010).
  1958*    -------------------------------
  1959     05  BSUFX4L PIC S9(0004) COMP.
  1960     05  BSUFX4F PIC  X(0001).
  1961     05  FILLER REDEFINES BSUFX4F.
  1962         10  BSUFX4A PIC  X(0001).
  1963     05  BSUFX4I PIC  X(0001).
  1964*    -------------------------------
  1965     05  BCERT5L PIC S9(0004) COMP.
  1966     05  BCERT5F PIC  X(0001).
  1967     05  FILLER REDEFINES BCERT5F.
  1968         10  BCERT5A PIC  X(0001).
  1969     05  BCERT5I PIC  X(0010).
  1970*    -------------------------------
  1971     05  BSUFX5L PIC S9(0004) COMP.
  1972     05  BSUFX5F PIC  X(0001).
  1973     05  FILLER REDEFINES BSUFX5F.
  1974         10  BSUFX5A PIC  X(0001).
  1975     05  BSUFX5I PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  39
* EL131.cbl
  1976*    -------------------------------
  1977     05  MSG1L PIC S9(0004) COMP.
  1978     05  MSG1F PIC  X(0001).
  1979     05  FILLER REDEFINES MSG1F.
  1980         10  MSG1A PIC  X(0001).
  1981     05  MSG1I PIC  X(0072).
  1982*    -------------------------------
  1983     05  MSG2L PIC S9(0004) COMP.
  1984     05  MSG2F PIC  X(0001).
  1985     05  FILLER REDEFINES MSG2F.
  1986         10  MSG2A PIC  X(0001).
  1987     05  MSG2I PIC  X(0072).
  1988*    -------------------------------
  1989     05  PFKEYL PIC S9(0004) COMP.
  1990     05  PFKEYF PIC  X(0001).
  1991     05  FILLER REDEFINES PFKEYF.
  1992         10  PFKEYA PIC  X(0001).
  1993     05  PFKEYI PIC  99.
  1994*    -------------------------------
  1995     05  PFKEY6L PIC S9(0004) COMP.
  1996     05  PFKEY6F PIC  X(0001).
  1997     05  FILLER REDEFINES PFKEY6F.
  1998         10  PFKEY6A PIC  X(0001).
  1999     05  PFKEY6I PIC  X(0016).
  2000 01  EL131AO REDEFINES EL131AI.
  2001     05  FILLER            PIC  X(0012).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  DATEO PIC  X(0008).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  TIMEO PIC  99.99.
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  SEQUO PIC  X(0010).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  COMPO PIC  X(0003).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  USERIDO PIC  X(0004).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  LABEL1O PIC  X(0011).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  PCERTNOO PIC  X(0010).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  PSUFXO PIC  X(0001).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  CCNOO PIC  X(0016).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  MAINTO PIC  X(0001).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  40
* EL131.cbl
  2034     05  CLAIMO PIC  X(0007).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  CARRO PIC  X(0001).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  CERTO PIC  X(0010).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  SUFXO PIC  X(0001).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  TYPEO PIC  X(0001).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  BENPERO PIC  X(0002).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  INSTYPEO PIC  X(0001).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  STATUSO PIC  X(0006).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  INCO PIC  X(0008).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  REPO PIC  X(0008).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  ICD1O PIC  X(0008).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  ICD2O PIC  X(0008).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  DIAGO PIC  X(0060).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  ACCSWO PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BENEO PIC  X(0010).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BIRTHO PIC  X(0008).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  SOCIALO PIC  X(0011).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  SEXO PIC  X(0001).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  MLNAMEO PIC  X(0015).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  MFNAMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  41
* EL131.cbl
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  MMINITO PIC  X(0001).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  LOANNOO PIC  X(0008).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  CRTLNMEO PIC  X(0015).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  CRTFNMEO PIC  X(0012).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  CRTINITO PIC  X(0001).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  LOANBALO PIC  ZZZZZ9.99.
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  PROCO PIC  X(0004).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  SUPVO PIC  X(0001).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  PRICDO PIC  X(0001).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  CRITPO PIC  X(0002).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  CRITPTO PIC  X(0002).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  RTWMOSO PIC  X(0002).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  FILETOO PIC  X(0004).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  PTHRHDGO PIC  X(0010).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  PDTHRUO PIC  X(0008).
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  PDAMTO PIC  Z(06).99.
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  NODAYSO PIC  ZZZ99.
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  NOPMTSO PIC  ZZ99.
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  FORMTYPO PIC  X(0001).
  2149*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  42
* EL131.cbl
  2150     05  FILLER            PIC  X(0003).
  2151     05  ESTO PIC  X(0008).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  AUIDO PIC  X(0004).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  OCCO PIC  X(0006).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  MNTDTO PIC  X(0008).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  MNTTYPEO PIC  X(0006).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  CERTCARO PIC  X(0001).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  CERTGRPO PIC  X(0006).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  CERTSTO PIC  X(0002).
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  CERTACTO PIC  X(0010).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  CERTEFFO PIC  X(0008).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  ISSAGEO PIC  X(0002).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  APRO PIC  9(3).9(4).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  PMTFREQO PIC  99.
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  INDGRPO PIC  X(0001).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  PREMTYPO PIC  X(0001).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  REINCDO PIC  X(0001).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  JNTLNMEO PIC  X(0015).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  JNTFNMEO PIC  X(0012).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  JNTINITO PIC  X(0001).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  43
* EL131.cbl
  2208     05  JNTAGEO PIC  X(0002).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  ADDONDTO PIC  X(0008).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  LCVDSCRO PIC  X(0006).
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  LCVKINDO PIC  X(0003).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  LCVCDO PIC  X(0002).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  LCVOTRMO PIC  999.
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  LCVRTRMO PIC  999.
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  LCVRATEO PIC  ZZZ.ZZ.
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  LCVFORMO PIC  X(0012).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  LCVCNDTO PIC  X(0008).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  LCVEXITO PIC  X(0008).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  LCVSTATO PIC  X(0006).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  ACVDSCRO PIC  X(0006).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  ACVKINDO PIC  X(0003).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  ACVCDO PIC  X(0002).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  ACVOTRMO PIC  999.
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  ACVRTRMO PIC  999.
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  ACVRATEO PIC  ZZZ.ZZ.
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  44
* EL131.cbl
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  ACVFORMO PIC  X(0012).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  ACVCNDTO PIC  X(0008).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  ACVEXITO PIC  X(0008).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  ACVSTATO PIC  X(0006).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  LABEL2O PIC  X(0014).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  BCERT1O PIC  X(0010).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  BSUFX1O PIC  X(0001).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  BCERT2O PIC  X(0010).
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  BSUFX2O PIC  X(0001).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  BCERT3O PIC  X(0010).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  BSUFX3O PIC  X(0001).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  BCERT4O PIC  X(0010).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  BSUFX4O PIC  X(0001).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  BCERT5O PIC  X(0010).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  BSUFX5O PIC  X(0001).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  MSG1O PIC  X(0072).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  MSG2O PIC  X(0072).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  PFKEYO PIC  X(0002).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  PFKEY6O PIC  X(0016).
  2323*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  45
* EL131.cbl
  2324
  2325*                                COPY ELCEMIB SUPPRESS.
  2326******************************************************************
  2327*                                                                *
  2328*                                                                *
  2329*                            ELCEMIB.                            *
  2330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2331*                            VMOD=2.005                          *
  2332*                                                                *
  2333*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2334*                                                                *
  2335******************************************************************
  2336 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2337     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2338     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2339     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2340     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2341     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2342     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2343     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2344     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2345     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2346         88  EMI-NO-ERRORS                    VALUE '1'.
  2347         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2348         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2349     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2350         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2351     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2352         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2353         88  EMI-AREA1-FULL                   VALUE '2'.
  2354     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2355         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2356         88  EMI-AREA2-FULL                   VALUE '2'.
  2357     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2358         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2359         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2360         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2361         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2362         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2363     12  EMI-ERROR-LINES.
  2364         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2365         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2366         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2367         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2368             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2369                 24  EMI-ERR-NUM         PIC X(4).
  2370                 24  EMI-FILLER          PIC X.
  2371                 24  EMI-SEV             PIC X.
  2372                 24  FILLER              PIC X.
  2373             20  FILLER                  PIC X(02).
  2374     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2375         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2376             20  EMI-ERROR-NUMBER    PIC X(4).
  2377             20  EMI-FILL            PIC X.
  2378             20  EMI-SEVERITY        PIC X.
  2379             20  FILLER              PIC X.
  2380             20  EMI-ERROR-TEXT.
  2381                 24  EMI-TEXT-VARIABLE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  46
* EL131.cbl
  2382                 24  FILLER          PIC X(55).
  2383     12  EMI-SEVERITY-SAVE           PIC X.
  2384         88  EMI-NOTE                    VALUE 'N'.
  2385         88  EMI-WARNING                 VALUE 'W'.
  2386         88  EMI-FORCABLE                VALUE 'F'.
  2387         88  EMI-FATAL                   VALUE 'X'.
  2388     12  EMI-MESSAGE-FLAG            PIC X.
  2389         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2390         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2391     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2392     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2393         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2394         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2395         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2396     12  emi-claim-no                pic x(7).
  2397     12  emi-claim-type              pic x(6).
  2398     12  FILLER                      PIC X(124)  VALUE SPACES.
  2399     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2400     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2401     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2402     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2403
  2404*                                COPY ELCJPFX SUPPRESS.
  2405******************************************************************
  2406*                                                                *
  2407*                                                                *
  2408*                            ELCJPFX.                            *
  2409*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2410*                            VMOD=2.002                          *
  2411*                                                                *
  2412*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2413*                                                                *
  2414*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2415*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2416*        ELCNTL - CONTROL FILE                                   *
  2417*        ELMSTR - CLAIM MASTERS                                  *
  2418*        ELTRLR - ACTIVITY TRAILERS                              *
  2419*        ELCHKQ - CHECK QUE                                      *
  2420******************************************************************
  2421 01  JOURNAL-RECORD.
  2422     12  jp-date                     pic s9(5) comp-3.
  2423     12  jp-time                     pic s9(7) comp-3.
  2424     12  JP-USER-ID                  PIC X(4).
  2425     12  JP-FILE-ID                  PIC X(8).
  2426     12  JP-PROGRAM-ID               PIC X(8).
  2427     12  JP-RECORD-TYPE              PIC X.
  2428         88 JP-ADD              VALUE 'A'.
  2429         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2430         88 JP-AFTER-CHANGE     VALUE 'C'.
  2431         88 JP-DELETE           VALUE 'D'.
  2432         88 JP-GENERIC-DELETE   VALUE 'G'.
  2433         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2434         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2435     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2436     12  JP-RECORD-AREA
  2437
  2438
  2439                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  47
* EL131.cbl
  2440
  2441*                                COPY ELCCALC.
  2442******************************************************************
  2443*                                                                *
  2444*                           ELCCALC.                            *
  2445*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2446*                            VMOD=2.025                          *
  2447*                                                                *
  2448*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2449*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2450*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2451*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2452*                                                                *
  2453*  PASSED TO ELRTRM                                              *
  2454*  -----------------                                             *
  2455*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2456*  ORIGINAL TERM                                                 *
  2457*  BEGINNING DATE                                                *
  2458*  ENDING DATE                                                   *
  2459*  COMPANY I.D.                                                  *
  2460*  ACCOUNT MASTER USER FIELD                                     *
  2461*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2462*  FREE LOOK DAYS                                                *
  2463*                                                                *
  2464*  RETURNED FROM ELRTRM                                          *
  2465*  ---------------------                                         *
  2466*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2467*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2468*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2469*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2470*----------------------------------------------------------------*
  2471*  PASSED TO ELRAMT                                              *
  2472*  ----------------                                              *
  2473*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2474*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2475*  ORIGINAL AMOUNT                                               *
  2476*  ALTERNATE BENEFIT (BALLON)                                    *
  2477*  A.P.R. - NET PAY ONLY                                         *
  2478*  METHOD
  2479*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2480*  COMPANY I.D.                                                  *
  2481*  BENEFIT TYPE                                                  *
  2482*                                                                *
  2483*  RETURNED FROM ELRAMT                                          *
  2484*  --------------------                                          *
  2485*  REMAINING AMOUNT 1 - CURRENT                                  *
  2486*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2487*  REMAINING AMOUNT FACTOR
  2488*----------------------------------------------------------------*
  2489*  PASSED TO ELRESV                                              *
  2490*  -----------------                                             *
  2491*  CERTIFICATE EFFECTIVE DATE                                    *
  2492*  VALUATION DATE                                                *
  2493*  PAID THRU DATE                                                *
  2494*  BENEFIT                                                       *
  2495*  INCURRED DATE                                                 *
  2496*  REPORTED DATE                                                 *
  2497*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  48
* EL131.cbl
  2498*  TERM                                                          *
  2499*  CDT PERCENT                                                   *
  2500*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2501* *CLAIM TYPE (LIFE, A/H)                                        *
  2502* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2503* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2504*                                                                *
  2505*  RETURNED FROM ELRESV                                          *
  2506*  --------------------                                          *
  2507*  CDT TABLE USED                                                *
  2508*  CDT FACTOR USED                                               *
  2509*  PAY TO CURRENT RESERVE                                        *
  2510*  I.B.N.R. - A/H ONLY                                           *
  2511*  FUTURE (ACCRUED) AH ONLY                                      *
  2512*----------------------------------------------------------------*
  2513*  PASSED TO ELRATE                                              *
  2514*  ----------------                                              *
  2515*  CERT ISSUE DATE                                               *
  2516*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2517*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2518*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2519*  STATE CODE (CLIENT DEFINED)                                   *
  2520*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2521*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2522*  DEVIATION CODE                                                *
  2523*  ISSUE AGE                                                     *
  2524*  ORIGINAL BENEFIT AMOUNT                                       *
  2525*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2526*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2527*  BENEFIT KIND (LIFE OR A/H)                                    *
  2528*  A.P.R.                                                        *
  2529*  METHOD
  2530*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2531*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2532*  COMPANY I.D. (3 CHARACTER)                                    *
  2533*  BENEFIT CODE                                                  *
  2534*  BENEFIT OVERRIDE CODE                                         *
  2535*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2536*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2537*  JOINT INDICATOR (CSL ONLY)                                    *
  2538*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2539*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2540*                                                                *
  2541*  RETURNED FROM ELRATE                                          *
  2542*  --------------------                                          *
  2543*  CALCULATED PREMIUM                                            *
  2544*  PREMIUM RATE                                                  *
  2545*  MORTALITY CODE                                                *
  2546*  MAX ATTAINED AGE                                              *
  2547*  MAX AGE                                                       *
  2548*  MAX TERM                                                      *
  2549*  MAX MONTHLY BENEFIT                                           *
  2550*  MAX TOTAL BENIFIT                                             *
  2551*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2552*----------------------------------------------------------------*
  2553*  PASSED TO ELRFND                                              *
  2554*  ----------------                                              *
  2555*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  49
* EL131.cbl
  2556*  REFUND DATE                                                   *
  2557*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2558*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2559*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2560*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2561*  STATE CODE (CLIENT DEFINED)                                   *
  2562*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2563*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2564*  DEVIATION CODE                                                *
  2565*  ISSUE AGE                                                     *
  2566*  ORIGINAL BENEFIT AMOUNT                                       *
  2567*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2568*  PROCESS TYPE (CANCEL)                                         *
  2569*  BENEFIT KIND (LIFE OR A/H)                                    *
  2570*  A.P.R.                                                        *
  2571*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2572*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2573*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2574*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2575*  COMPANY I.D. (3 CHARACTER)                                    *
  2576*  BENEFIT CODE                                                  *
  2577*  BENEFIT OVERRIDE CODE                                         *
  2578*                                                                *
  2579*  RETURNED FROM ELRFND                                          *
  2580*  --------------------                                          *
  2581*  CALCULATED REFUND                                             *
  2582*----------------------------------------------------------------*
  2583*  PASSED TO ELEARN                                              *
  2584*  ----------------                                              *
  2585*  CERT ISSUE DATE                                               *
  2586*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2587*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2588*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2589*  STATE CODE (CLIENT DEFINED)                                   *
  2590*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2591*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2592*  DEVIATION CODE                                                *
  2593*  ISSUE AGE                                                     *
  2594*  ORIGINAL BENEFIT AMOUNT                                       *
  2595*  BENEFIT KIND (LIFE OR A/H)                                    *
  2596*  A.P.R.                                                        *
  2597*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2598*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2599*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2600*  COMPANY I.D. (3 CHARACTER)                                    *
  2601*  BENEFIT CODE                                                  *
  2602*  BENEFIT OVERRIDE CODE                                         *
  2603*                                                                *
  2604*  RETURNED FROM ELEARN                                          *
  2605*  --------------------                                          *
  2606*  INDICATED  EARNINGS                                           *
  2607*----------------------------------------------------------------*
  2608*                 LENGTH = 450                                   *
  2609*                                                                *
  2610******************************************************************
  2611******************************************************************
  2612*                   C H A N G E   L O G
  2613*
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  50
* EL131.cbl
  2614* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2615*-----------------------------------------------------------------
  2616*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2617* EFFECTIVE    NUMBER
  2618*-----------------------------------------------------------------
  2619* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2620* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2621* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2622* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2623* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2624* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2625* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2626* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2627* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2628******************************************************************
  2629
  2630 01  CALCULATION-PASS-AREA.
  2631     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2632                                     COMP.
  2633
  2634     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2635       88  NO-CP-ERROR                             VALUE ZERO.
  2636       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2637                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2638       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2639       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2640       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2641       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2642       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2643       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2644       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2645       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2646       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2647       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2648       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2649       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2650       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2651       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2652       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2653       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2654       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2655
  2656     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2657       88  NO-CP-ERROR-2                           VALUE ZERO.
  2658***********************  INPUT AREAS ****************************
  2659
  2660     12  CP-CALCULATION-AREA.
  2661         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2662         16  CP-CERT-EFF-DT        PIC XX.
  2663         16  CP-VALUATION-DT       PIC XX.
  2664         16  CP-PAID-THRU-DT       PIC XX.
  2665         16  CP-BENEFIT-TYPE       PIC X.
  2666           88  CP-AH                               VALUE 'A' 'D'
  2667                                                   'I' 'U'.
  2668           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2669           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2670         16  CP-INCURRED-DT        PIC XX.
  2671         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  51
* EL131.cbl
  2672         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2673         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2674         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2675                                     COMP-3.
  2676         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2677                                     COMP-3.
  2678         16  CP-CDT-METHOD         PIC X.
  2679           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2680           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2681           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2682         16  CP-CLAIM-TYPE         PIC X.
  2683           88  CP-AH-CLAIM                         VALUE 'A'.
  2684           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2685         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2686                                     COMP-3.
  2687         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2688                                     COMP-3.
  2689         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2690                                     COMP-3.
  2691         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2692                                     COMP-3.
  2693         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2694                                     COMP-3.
  2695         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2696                                     COMP-3.
  2697         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2698                                     COMP-3.
  2699         16  CP-REM-TERM-METHOD    PIC X.
  2700           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2701           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2702           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2703           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2704           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2705           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2706           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2707         16  CP-EARNING-METHOD     PIC X.
  2708           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2709           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2710           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2711           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2712           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2713           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2714           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2715           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2716           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2717           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2718           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2719           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2720           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2721           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2722         16  CP-PROCESS-TYPE       PIC X.
  2723           88  CP-CLAIM                            VALUE '1'.
  2724           88  CP-CANCEL                           VALUE '2'.
  2725           88  CP-ISSUE                            VALUE '3'.
  2726         16  CP-SPECIAL-CALC-CD    PIC X.
  2727           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2728           88  CP-1-MTH-INTEREST               VALUE ' '.
  2729           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  52
* EL131.cbl
  2730           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2731           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2732           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2733           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2734           88  CP-FARM-PLAN                    VALUE 'F'.
  2735           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2736           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2737           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2738           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2739           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2740           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2741           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2742           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2743           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2744           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2745                                                     'W' 'X'.
  2746           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2747           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2748           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2749           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2750           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2751           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2752           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2753           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2754           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2755           88  CP-CSL-METH-1                   VALUE '5'.
  2756           88  CP-CSL-METH-2                   VALUE '6'.
  2757           88  CP-CSL-METH-3                   VALUE '7'.
  2758           88  CP-CSL-METH-4                   VALUE '8'.
  2759
  2760         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2761                                     COMP-3.
  2762         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2763         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2764         16  CP-STATE              PIC XX          VALUE SPACE.
  2765         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2766         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2767           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2768               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2769         16  CP-R78-OPTION         PIC X.
  2770           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2771           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2772
  2773         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2774         16  CP-IBNR-RESERVE-SW    PIC X.
  2775         16  CP-CLAIM-STATUS       PIC X.
  2776         16  CP-RATE-FILE          PIC X.
  2777         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2778                                     COMP-3.
  2779
  2780         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2781         16  CP-AH-OVERRIDE-CODE   PIC X.
  2782
  2783         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2784                                     COMP-3.
  2785         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2786                                   PIC S9(5)V99 COMP-3.
  2787         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  53
* EL131.cbl
  2788                                     COMP-3.
  2789         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2790                                     COMP-3.
  2791         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2792                                     COMP-3.
  2793         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2794                                  PIC S9(7)V99 COMP-3.
  2795
  2796         16  CP-PAID-FROM-DATE     PIC X(02).
  2797         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2798         16  CP-EXT-DAYS-CALC      PIC X.
  2799           88  CP-EXT-NO-CHG                   VALUE ' '.
  2800           88  CP-EXT-CHG-LF                   VALUE '1'.
  2801           88  CP-EXT-CHG-AH                   VALUE '2'.
  2802           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2803         16  CP-DOMICILE-STATE     PIC XX.
  2804         16  CP-CARRIER            PIC X.
  2805         16  CP-REIN-FLAG          PIC X.
  2806         16  CP-REM-TRM-CALC-OPTION PIC X.
  2807           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2808                      '2' '3' '4' '5'.
  2809           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2810           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2811           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2812           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2813           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2814           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2815           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2816           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2817         16  CP-SIG-SWITCH         PIC X.
  2818         16  CP-RATING-METHOD      PIC X.
  2819           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2820           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2821           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2822           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2823           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2824           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2825           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2826           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2827           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2828         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2829                                     COMP-3.
  2830         16  CP-BEN-CATEGORY       PIC X.
  2831         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2832         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2833                                   PIC S99V9(5) COMP-3.
  2834         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2835         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2836                                   PIC S99V9(5) COMP-3.
  2837         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2838         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2839         16  CP-EXPIRE-DT          PIC XX.
  2840         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2841         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2842         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2843         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2844         16  CP-DDF-SPEC-CALC      PIC X.
  2845             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  54
* EL131.cbl
  2846             88  CP-CALC-CLP              VALUE 'C'.
  2847         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2848         16  CP-CANCEL-REASON      PIC X.
  2849         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2850         16  CP-PMT-MODE           PIC X.
  2851         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2852         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2853         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2854         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2855         16  FILLER                PIC X.
  2856
  2857***************    OUTPUT FROM ELRESV   ************************
  2858
  2859         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2860
  2861         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2862                                     COMP-3.
  2863         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2864                                     COMP-3.
  2865         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2866                                     COMP-3.
  2867         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2868                                     COMP-3.
  2869         16  FILLER                PIC X(09).
  2870***************    OUTPUT FROM ELRTRM   *************************
  2871
  2872         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2873                                     COMP-3.
  2874         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2875                                     COMP-3.
  2876         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2877                                     COMP-3.
  2878         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2879                                     COMP-3.
  2880         16  FILLER                PIC X(12).
  2881
  2882***************    OUTPUT FROM ELRAMT   *************************
  2883
  2884         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2885                                     COMP-3.
  2886         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2887                                     COMP-3.
  2888         16  FILLER                PIC X(12).
  2889
  2890***************    OUTPUT FROM ELRATE   *************************
  2891
  2892         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2893                                     COMP-3.
  2894         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2895                                     COMP-3.
  2896         16  CP-MORTALITY-CODE     PIC X(4).
  2897         16  CP-RATE-EDIT-FLAG     PIC X.
  2898             88  CP-RATES-NEED-APR                  VALUE '1'.
  2899         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2900                                     COMP-3.
  2901         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2902         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2903         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  55
* EL131.cbl
  2904                                   PIC S9(7)V99 COMP-3.
  2905         16  FILLER                PIC X(07).
  2906
  2907***************    OUTPUT FROM ELRFND   *************************
  2908
  2909         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2910                                     COMP-3.
  2911         16  CP-REFUND-TYPE-USED   PIC X.
  2912           88  CP-R-AS-R78                         VALUE '1'.
  2913           88  CP-R-AS-PRORATA                     VALUE '2'.
  2914           88  CP-R-AS-CALIF                       VALUE '3'.
  2915           88  CP-R-AS-TEXAS                       VALUE '4'.
  2916           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2917           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2918           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2919           88  CP-R-AS-MEAN                        VALUE '8'.
  2920           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2921           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2922           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2923           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2924           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2925           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2926         16  FILLER                PIC X(12).
  2927
  2928***************    OUTPUT FROM ELEARN   *************************
  2929
  2930         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2931                                     COMP-3.
  2932         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2933                                     COMP-3.
  2934         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2935                                     COMP-3.
  2936         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2937                                     COMP-3.
  2938         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2939                                     COMP-3.
  2940         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2941                                     COMP-3.
  2942         16  CP-EARNING-TYPE-USED  PIC X.
  2943           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2944           88  CP-E-AS-R78                         VALUE '1'.
  2945           88  CP-E-AS-PRORATA                     VALUE '2'.
  2946           88  CP-E-AS-TEXAS                       VALUE '4'.
  2947           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2948           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2949           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2950           88  CP-E-AS-MEAN                        VALUE '8'.
  2951           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2952         16  FILLER                PIC X(12).
  2953
  2954***************    OUTPUT FROM ELPMNT   *************************
  2955
  2956         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2957                                     COMP-3.
  2958         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2959                                     COMP-3.
  2960         16  FILLER                PIC X(12).
  2961
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  56
* EL131.cbl
  2962***************   MISC WORK AREAS    *****************************
  2963         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2964                                     COMP-3.
  2965         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2966                                     COMP-3.
  2967         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2968                                     COMP-3.
  2969         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2970                                     COMP-3.
  2971         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2972                                     COMP-3.
  2973         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2974                                     COMP-3.
  2975         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2976             88  OPEN-RATE-FILE                   VALUE 'O'.
  2977             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2978             88  IO-ERROR                         VALUE 'E'.
  2979
  2980         16  CP-FIRST-PAY-DATE     PIC XX.
  2981
  2982         16  CP-JOINT-INDICATOR    PIC X.
  2983
  2984         16  CP-RESERVE-REMAINING-TERM
  2985                                   PIC S9(4)V9    VALUE ZERO
  2986                                     COMP-3.
  2987
  2988         16  CP-INSURED-BIRTH-DT   PIC XX.
  2989
  2990         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2991                                     COMP-3.
  2992
  2993         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2994                                     COMP-3.
  2995
  2996         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2997                                     COMP-3.
  2998
  2999         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3000                                     COMP-3.
  3001
  3002         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3003                                     COMP-3.
  3004
  3005         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3006                                     COMP-3.
  3007
  3008         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3009                                     COMP-3.
  3010
  3011         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3012             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3013
  3014         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3015                                     COMP-3.
  3016         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3017                                     COMP-3.
  3018         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3019         16  FILLER                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  57
* EL131.cbl
  3020******************************************************************
  3021
  3022*                                COPY ELCDATE.
  3023******************************************************************
  3024*                                                                *
  3025*                                                                *
  3026*                            ELCDATE.                            *
  3027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3028*                            VMOD=2.003
  3029*                                                                *
  3030*                                                                *
  3031*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3032*                 LENGTH = 200                                   *
  3033******************************************************************
  3034
  3035 01  DATE-CONVERSION-DATA.
  3036     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3037     12  DC-OPTION-CODE                PIC X.
  3038         88  BIN-TO-GREG                VALUE ' '.
  3039         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3040         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3041         88  YMD-GREG-TO-BIN            VALUE '3'.
  3042         88  MDY-GREG-TO-BIN            VALUE '4'.
  3043         88  JULIAN-TO-BIN              VALUE '5'.
  3044         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3045         88  FIND-CENTURY               VALUE '7'.
  3046         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3047         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3048         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3049         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3050         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3051         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3052         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3053         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3054         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3055         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3056         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3057         88  BIN-3-TO-GREG              VALUE 'I'.
  3058         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3059         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3060         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3061         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3062         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3063         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3064         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3065         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3066         88  THREE-CHARACTER-BIN
  3067                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3068         88  GREGORIAN-TO-BIN
  3069                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3070         88  BIN-TO-GREGORIAN
  3071                  VALUES ' ' '1' 'I' '8' 'G'.
  3072         88  JULIAN-TO-BINARY
  3073                  VALUES '5' 'C' 'E' 'F'.
  3074     12  DC-ERROR-CODE                 PIC X.
  3075         88  NO-CONVERSION-ERROR        VALUE ' '.
  3076         88  DATE-CONVERSION-ERROR
  3077                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  58
* EL131.cbl
  3078         88  DATE-IS-ZERO               VALUE '1'.
  3079         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3080         88  DATE-IS-INVALID            VALUE '3'.
  3081         88  DATE1-GREATER-DATE2        VALUE '4'.
  3082         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3083         88  DATE-INVALID-OPTION        VALUE '9'.
  3084         88  INVALID-CENTURY            VALUE 'A'.
  3085         88  ONLY-CENTURY               VALUE 'B'.
  3086         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3087         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3088     12  DC-END-OF-MONTH               PIC X.
  3089         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3090     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3091         88  USE-NORMAL-PROCESS         VALUE ' '.
  3092         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3093         88  ADJUST-UP-100-YRS          VALUE '2'.
  3094     12  FILLER                        PIC X.
  3095     12  DC-CONVERSION-DATES.
  3096         16  DC-BIN-DATE-1             PIC XX.
  3097         16  DC-BIN-DATE-2             PIC XX.
  3098         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3099         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3100                       DC-GREG-DATE-1-EDIT.
  3101             20  DC-EDIT1-MONTH        PIC 99.
  3102             20  SLASH1-1              PIC X.
  3103             20  DC-EDIT1-DAY          PIC 99.
  3104             20  SLASH1-2              PIC X.
  3105             20  DC-EDIT1-YEAR         PIC 99.
  3106         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3107         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3108                     DC-GREG-DATE-2-EDIT.
  3109             20  DC-EDIT2-MONTH        PIC 99.
  3110             20  SLASH2-1              PIC X.
  3111             20  DC-EDIT2-DAY          PIC 99.
  3112             20  SLASH2-2              PIC X.
  3113             20  DC-EDIT2-YEAR         PIC 99.
  3114         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3115         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3116                     DC-GREG-DATE-1-YMD.
  3117             20  DC-YMD-YEAR           PIC 99.
  3118             20  DC-YMD-MONTH          PIC 99.
  3119             20  DC-YMD-DAY            PIC 99.
  3120         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3121         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3122                      DC-GREG-DATE-1-MDY.
  3123             20  DC-MDY-MONTH          PIC 99.
  3124             20  DC-MDY-DAY            PIC 99.
  3125             20  DC-MDY-YEAR           PIC 99.
  3126         16  DC-GREG-DATE-1-ALPHA.
  3127             20  DC-ALPHA-MONTH        PIC X(10).
  3128             20  DC-ALPHA-DAY          PIC 99.
  3129             20  FILLER                PIC XX.
  3130             20  DC-ALPHA-CENTURY.
  3131                 24 DC-ALPHA-CEN-N     PIC 99.
  3132             20  DC-ALPHA-YEAR         PIC 99.
  3133         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3134         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3135         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  59
* EL131.cbl
  3136         16  DC-JULIAN-DATE            PIC 9(05).
  3137         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3138                                       PIC 9(05).
  3139         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3140             20  DC-JULIAN-YEAR        PIC 99.
  3141             20  DC-JULIAN-DAYS        PIC 999.
  3142         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3143         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3144         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3145     12  DATE-CONVERSION-VARIBLES.
  3146         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3147         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3148             20  FILLER                PIC 9(3).
  3149             20  HOLD-CEN-1-CCYY.
  3150                 24  HOLD-CEN-1-CC     PIC 99.
  3151                 24  HOLD-CEN-1-YY     PIC 99.
  3152             20  HOLD-CEN-1-MO         PIC 99.
  3153             20  HOLD-CEN-1-DA         PIC 99.
  3154         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3155             20  HOLD-CEN-1-R-MO       PIC 99.
  3156             20  HOLD-CEN-1-R-DA       PIC 99.
  3157             20  HOLD-CEN-1-R-CCYY.
  3158                 24  HOLD-CEN-1-R-CC   PIC 99.
  3159                 24  HOLD-CEN-1-R-YY   PIC 99.
  3160             20  FILLER                PIC 9(3).
  3161         16  HOLD-CENTURY-1-X.
  3162             20  FILLER                PIC X(3)  VALUE SPACES.
  3163             20  HOLD-CEN-1-X-CCYY.
  3164                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3165                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3166             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3167             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3168         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3169             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3170             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3171             20  HOLD-CEN-1-R-X-CCYY.
  3172                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3173                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3174             20  FILLER                PIC XXX.
  3175         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3176         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3177         16  DC-JULIAN-DATE-1          PIC 9(07).
  3178         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3179             20  DC-JULIAN-1-CCYY.
  3180                 24  DC-JULIAN-1-CC    PIC 99.
  3181                 24  DC-JULIAN-1-YR    PIC 99.
  3182             20  DC-JULIAN-DA-1        PIC 999.
  3183         16  DC-JULIAN-DATE-2          PIC 9(07).
  3184         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3185             20  DC-JULIAN-2-CCYY.
  3186                 24  DC-JULIAN-2-CC    PIC 99.
  3187                 24  DC-JULIAN-2-YR    PIC 99.
  3188             20  DC-JULIAN-DA-2        PIC 999.
  3189         16  DC-GREG-DATE-A-EDIT.
  3190             20  DC-EDITA-MONTH        PIC 99.
  3191             20  SLASHA-1              PIC X VALUE '/'.
  3192             20  DC-EDITA-DAY          PIC 99.
  3193             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  60
* EL131.cbl
  3194             20  DC-EDITA-CCYY.
  3195                 24  DC-EDITA-CENT     PIC 99.
  3196                 24  DC-EDITA-YEAR     PIC 99.
  3197         16  DC-GREG-DATE-B-EDIT.
  3198             20  DC-EDITB-MONTH        PIC 99.
  3199             20  SLASHB-1              PIC X VALUE '/'.
  3200             20  DC-EDITB-DAY          PIC 99.
  3201             20  SLASHB-2              PIC X VALUE '/'.
  3202             20  DC-EDITB-CCYY.
  3203                 24  DC-EDITB-CENT     PIC 99.
  3204                 24  DC-EDITB-YEAR     PIC 99.
  3205         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3206         16  DC-GREG-DATE-CYMD-R REDEFINES
  3207                              DC-GREG-DATE-CYMD.
  3208             20  DC-CYMD-CEN           PIC 99.
  3209             20  DC-CYMD-YEAR          PIC 99.
  3210             20  DC-CYMD-MONTH         PIC 99.
  3211             20  DC-CYMD-DAY           PIC 99.
  3212         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3213         16  DC-GREG-DATE-MDCY-R REDEFINES
  3214                              DC-GREG-DATE-MDCY.
  3215             20  DC-MDCY-MONTH         PIC 99.
  3216             20  DC-MDCY-DAY           PIC 99.
  3217             20  DC-MDCY-CEN           PIC 99.
  3218             20  DC-MDCY-YEAR          PIC 99.
  3219    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3220        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3221    12  DC-EL310-DATE                  PIC X(21).
  3222    12  FILLER                         PIC X(28).
  3223
  3224*                                COPY ELCDMO.
  3225******************************************************************
  3226*                                                                *
  3227*                                                                *
  3228*                            ELCDMO.                             *
  3229*                            VMOD=2.004                          *
  3230*                                                                *
  3231*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3232*        COMMUNICATION AREA                                      *
  3233*   FILE TYPE = NA                                               *
  3234*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3235*                                                                *
  3236******************************************************************
  3237 01  DMO-COMMUNICATION-AREA.
  3238     12  DM-RECORD-TYPE                  PIC  X(02).
  3239             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3240             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3241             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3242     12  DM-DIST-CODE                    PIC  X(04).
  3243     12  DM-MAIL-CODE                    PIC  X(05).
  3244     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3245     12  DM-INSURED-NAME                 PIC  X(30).
  3246     12  DM-CLAIM-NO                     PIC  X(07).
  3247     12  DM-CLAIM-TYPE                   PIC  X.
  3248
  3249     12  DM-STATUS-DATA-AREA.
  3250         16  DM-CLAIM-STATUS             PIC  X.
  3251             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  61
* EL131.cbl
  3252             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3253             88  DM-CLOSED                        VALUE '3'.
  3254             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3255             88  DM-DEFAULT                       VALUE '9'.
  3256         16  DM-STATUS-DATE              PIC  X(08).
  3257******YYYYMMDD
  3258         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3259             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3260             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3261             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3262             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3263             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3264             88  DM-RE-OPENED                     VALUE 'R'.
  3265             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3266             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3267             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3268         16  DM-STAT-CARRIER             PIC X.
  3269
  3270     12  DM-DRAFT-DATA-AREA.
  3271         16  DM-PAYMENT-TYPE             PIC  X.
  3272             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3273         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3274         16  DM-PAYMENT-DATE             PIC  X(08).
  3275******YYYYMMDD
  3276         16  DM-CERT-NO                  PIC  X(11).
  3277         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3278         16  DM-CARRIER                  PIC  X.
  3279
  3280     12  DM-RETURN-CODE                  PIC  XX.
  3281*                                COPY ERCPDEF.
  3282******************************************************************
  3283*                                                                *
  3284*                                                                *
  3285*                            ERCPDEF.                            *
  3286*                                                                *
  3287*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3288*                                                                *
  3289*    FILE TYPE = VSAM,KSDS                                       *
  3290*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3291*                                                                *
  3292*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3293*                                                                *
  3294*    LOG = YES                                                   *
  3295*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3296******************************************************************
  3297*                   C H A N G E   L O G
  3298*
  3299* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3300*-----------------------------------------------------------------
  3301*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3302* EFFECTIVE    NUMBER
  3303*-----------------------------------------------------------------
  3304* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3305******************************************************************
  3306 01  PRODUCT-MASTER.
  3307    12  PD-RECORD-ID                 PIC X(02).
  3308        88  VALID-PD-ID                  VALUE 'PD'.
  3309    12  PD-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  62
* EL131.cbl
  3310        16  PD-COMPANY-CD            PIC X.
  3311        16  PD-STATE                 PIC XX.
  3312        16  PD-PRODUCT-CD            PIC XXX.
  3313        16  PD-FILLER                PIC X(7).
  3314        16  PD-BEN-TYPE              PIC X.
  3315        16  PD-BEN-CODE              PIC XX.
  3316        16  PD-PROD-EXP-DT           PIC XX.
  3317    12  FILLER                       PIC X(50).
  3318    12  PD-PRODUCT-DATA OCCURS 8.
  3319        16  PD-PROD-CODE             PIC X.
  3320            88  PD-PROD-LIFE           VALUE 'L'.
  3321            88  PD-PROD-PROP           VALUE 'P'.
  3322            88  PD-PROD-AH             VALUE 'A'.
  3323            88  PD-PROD-IU             VALUE 'I'.
  3324            88  PD-PROD-GAP            VALUE 'G'.
  3325            88  PD-PROD-FMLA           VALUE 'F'.
  3326        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3327        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3328        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3329        16  PD-MAX-TERM              PIC S999        COMP-3.
  3330        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3331        16  FILLER                   PIC X.
  3332        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3333        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3334        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3335        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3336        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3337        16  PD-REC-CRIT-PERIOD       PIC 99.
  3338        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3339            20  PD-RECURRING-YN      PIC X.
  3340            20  FILLER               PIC X.
  3341        16  PD-RTW-MOS               PIC 99.
  3342        16  PD-MAX-EXTENSION         PIC 99.
  3343        16  FILLER                   PIC XX.
  3344    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3345    12  PD-TERM-LIMITS OCCURS 15.
  3346        16  PD-LOW-TERM              PIC S999        COMP-3.
  3347        16  PD-HI-TERM               PIC S999        COMP-3.
  3348*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3349    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3350        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3351        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3352    12  PD-EARN-FACTORS.
  3353        16  FILLER OCCURS 15.
  3354            20  FILLER OCCURS 15.
  3355                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3356    12  PD-PRODUCT-DESC              PIC X(80).
  3357    12  PD-TRUNCATED                 PIC X.
  3358    12  FILLER                       PIC X(59).
  3359    12  PD-MAINT-INFORMATION.
  3360        16  PD-LAST-MAINT-DT         PIC X(02).
  3361        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3362        16  PD-LAST-MAINT-BY         PIC X(04).
  3363*                                COPY ELCCRTT.
  3364******************************************************************
  3365*                                                                *
  3366*                            ELCCRTT.                            *
  3367*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  63
* EL131.cbl
  3368*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3369*                                                                *
  3370*   FILE TYPE = VSAM,KSDS                                        *
  3371*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3372*                                                                *
  3373*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3374*                                                                *
  3375*   LOG = YES                                                    *
  3376*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3377******************************************************************
  3378*                   C H A N G E   L O G
  3379*
  3380* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3381*-----------------------------------------------------------------
  3382*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3383* EFFECTIVE    NUMBER
  3384*-----------------------------------------------------------------
  3385* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3386* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3387* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3388* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3389* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3390* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3391******************************************************************
  3392
  3393 01  CERTIFICATE-TRAILERS.
  3394     12  CS-RECORD-ID                      PIC XX.
  3395         88  VALID-CS-ID                      VALUE 'CS'.
  3396
  3397     12  CS-CONTROL-PRIMARY.
  3398         16  CS-COMPANY-CD                 PIC X.
  3399         16  CS-CARRIER                    PIC X.
  3400         16  CS-GROUPING                   PIC X(6).
  3401         16  CS-STATE                      PIC XX.
  3402         16  CS-ACCOUNT                    PIC X(10).
  3403         16  CS-CERT-EFF-DT                PIC XX.
  3404         16  CS-CERT-NO.
  3405             20  CS-CERT-PRIME             PIC X(10).
  3406             20  CS-CERT-SFX               PIC X.
  3407         16  CS-TRAILER-TYPE               PIC X.
  3408             88  COMM-TRLR           VALUE 'A'.
  3409             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3410             88  CERT-DATA-TRLR      VALUE 'C'.
  3411
  3412     12  CS-DATA-AREA                      PIC X(516).
  3413
  3414     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3415         16  CS-BANK-COMMISSION-AREA.
  3416             20  CS-BANK-COMMS       OCCURS 10.
  3417                 24  CS-AGT                PIC X(10).
  3418                 24  CS-COM-TYP            PIC X.
  3419                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3420                 24  CS-RECALC-LV-INDIC    PIC X.
  3421                 24  FILLER                PIC X(10).
  3422         16  FILLER                        PIC X(256).
  3423
  3424     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3425****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  64
* EL131.cbl
  3426         16  CS-MB-CLAIM-DATA OCCURS 24.
  3427             20  CS-CLAIM-NO               PIC X(7).
  3428             20  CS-CLAIM-TYPE             PIC X.
  3429                 88  CS-AH-CLM               VALUE 'A'.
  3430                 88  CS-IU-CLM               VALUE 'I'.
  3431                 88  CS-GP-CLM               VALUE 'G'.
  3432                 88  CS-LF-CLM               VALUE 'L'.
  3433                 88  CS-PR-CLM               VALUE 'P'.
  3434             20  CS-INSURED-TYPE           PIC X.
  3435                 88  CS-PRIM-INSURED          VALUE 'P'.
  3436                 88  CS-CO-BORROWER           VALUE 'C'.
  3437             20  CS-BENEFIT-PERIOD         PIC 99.
  3438             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3439             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3440             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3441         16  FILLER                        PIC X(12).
  3442     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3443         16  CS-VIN-NUMBER                 PIC X(17).
  3444         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3445         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3446         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3447         16  FILLER                        PIC X(496).
  3448
  3449****************************************************************
  3450*
  3451* Copyright (c) 2007 by Clerity Solutions, Inc.
  3452* All rights reserved.
  3453*
  3454****************************************************************
  3455 01  DFHEIV.
  3456   02  DFHEIV0               PIC X(35).
  3457   02  DFHEIV1               PIC X(08).
  3458   02  DFHEIV2               PIC X(08).
  3459   02  DFHEIV3               PIC X(08).
  3460   02  DFHEIV4               PIC X(06).
  3461   02  DFHEIV5               PIC X(04).
  3462   02  DFHEIV6               PIC X(04).
  3463   02  DFHEIV7               PIC X(02).
  3464   02  DFHEIV8               PIC X(02).
  3465   02  DFHEIV9               PIC X(01).
  3466   02  DFHEIV10              PIC S9(7) COMP-3.
  3467   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3468   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3469   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3470   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3471   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3472   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3473   02  DFHEIV17              PIC X(04).
  3474   02  DFHEIV18              PIC X(04).
  3475   02  DFHEIV19              PIC X(04).
  3476   02  DFHEIV20              USAGE IS POINTER.
  3477   02  DFHEIV21              USAGE IS POINTER.
  3478   02  DFHEIV22              USAGE IS POINTER.
  3479   02  DFHEIV23              USAGE IS POINTER.
  3480   02  DFHEIV24              USAGE IS POINTER.
  3481   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3482   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3483   02  DFHEIV27              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  65
* EL131.cbl
  3484   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3485   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3486   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3487   02  FILLER                PIC X(02).
  3488   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3489   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3490   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3491   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3492   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3493 LINKAGE  SECTION.
  3494*****************************************************************
  3495*                                                               *
  3496* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3497* All rights reserved.                                          *
  3498*                                                               *
  3499*****************************************************************
  3500 01  dfheiblk.
  3501     02  eibtime          pic s9(7) comp-3.
  3502     02  eibdate          pic s9(7) comp-3.
  3503     02  eibtrnid         pic x(4).
  3504     02  eibtaskn         pic s9(7) comp-3.
  3505     02  eibtrmid         pic x(4).
  3506     02  dfheigdi         pic s9(4) comp.
  3507     02  eibcposn         pic s9(4) comp.
  3508     02  eibcalen         pic s9(4) comp.
  3509     02  eibaid           pic x(1).
  3510     02  eibfiller1       pic x(1).
  3511     02  eibfn            pic x(2).
  3512     02  eibfiller2       pic x(2).
  3513     02  eibrcode         pic x(6).
  3514     02  eibfiller3       pic x(2).
  3515     02  eibds            pic x(8).
  3516     02  eibreqid         pic x(8).
  3517     02  eibrsrce         pic x(8).
  3518     02  eibsync          pic x(1).
  3519     02  eibfree          pic x(1).
  3520     02  eibrecv          pic x(1).
  3521     02  eibsend          pic x(1).
  3522     02  eibatt           pic x(1).
  3523     02  eibeoc           pic x(1).
  3524     02  eibfmh           pic x(1).
  3525     02  eibcompl         pic x(1).
  3526     02  eibsig           pic x(1).
  3527     02  eibconf          pic x(1).
  3528     02  eiberr           pic x(1).
  3529     02  eibrldbk         pic x(1).
  3530     02  eiberrcd         pic x(4).
  3531     02  eibsynrb         pic x(1).
  3532     02  eibnodat         pic x(1).
  3533     02  eibfiller5       pic x(2).
  3534     02  eibresp          pic 9(09) comp.
  3535     02  eibresp2         pic 9(09) comp.
  3536     02  dfheigdj         pic s9(4) comp.
  3537     02  dfheigdk         pic s9(4) comp.
  3538 01  DFHCOMMAREA                 PIC X(1024).
  3539
  3540*                                COPY ELCMSTR.
  3541******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  66
* EL131.cbl
  3542*                                                                *
  3543*                            ELCMSTR.                            *
  3544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3545*                            VMOD=2.012                          *
  3546*                                                                *
  3547*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3548*                                                                *
  3549*   FILE TYPE = VSAM,KSDS                                        *
  3550*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3551*                                                                *
  3552*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3553*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3554*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3555*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3556*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3557*                                                 RKP=75,LEN=21  *
  3558*                                                                *
  3559*   **** NOTE ****                                               *
  3560*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3561*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3562*                                                                *
  3563*   LOG = YES                                                    *
  3564*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3565******************************************************************
  3566*                   C H A N G E   L O G
  3567*
  3568* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3569*-----------------------------------------------------------------
  3570*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3571* EFFECTIVE    NUMBER
  3572*-----------------------------------------------------------------
  3573* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3574* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3575* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3576* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3577******************************************************************
  3578 01  CLAIM-MASTER.
  3579     12  CL-RECORD-ID                PIC XX.
  3580         88  VALID-CL-ID         VALUE 'CL'.
  3581
  3582     12  CL-CONTROL-PRIMARY.
  3583         16  CL-COMPANY-CD           PIC X.
  3584         16  CL-CARRIER              PIC X.
  3585         16  CL-CLAIM-NO             PIC X(7).
  3586         16  CL-CERT-NO.
  3587             20  CL-CERT-PRIME       PIC X(10).
  3588             20  CL-CERT-SFX         PIC X.
  3589
  3590     12  CL-CONTROL-BY-NAME.
  3591         16  CL-COMPANY-CD-A1        PIC X.
  3592         16  CL-INSURED-LAST-NAME    PIC X(15).
  3593         16  CL-INSURED-NAME.
  3594             20  CL-INSURED-1ST-NAME PIC X(12).
  3595             20  CL-INSURED-MID-INIT PIC X.
  3596
  3597     12  CL-CONTROL-BY-SSN.
  3598         16  CL-COMPANY-CD-A2        PIC X.
  3599         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  67
* EL131.cbl
  3600             20  CL-SSN-STATE        PIC XX.
  3601             20  CL-SSN-ACCOUNT      PIC X(6).
  3602             20  CL-SSN-LN3          PIC X(3).
  3603
  3604     12  CL-CONTROL-BY-CERT-NO.
  3605         16  CL-COMPANY-CD-A4        PIC X.
  3606         16  CL-CERT-NO-A4.
  3607             20  CL-CERT-A4-PRIME    PIC X(10).
  3608             20  CL-CERT-A4-SFX      PIC X.
  3609
  3610     12  CL-CONTROL-BY-CCN.
  3611         16  CL-COMPANY-CD-A5        PIC X.
  3612         16  CL-CCN-A5.
  3613             20  CL-CCN.
  3614                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3615                 24  CL-CCN-PRIME-A5 PIC X(12).
  3616             20  CL-CCN-FILLER-A5    PIC X(4).
  3617
  3618     12  CL-INSURED-PROFILE-DATA.
  3619         16  CL-INSURED-BIRTH-DT     PIC XX.
  3620         16  CL-INSURED-SEX-CD       PIC X.
  3621             88  INSURED-IS-MALE        VALUE 'M'.
  3622             88  INSURED-IS-FEMALE      VALUE 'F'.
  3623             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3624         16  CL-INSURED-OCC-CD       PIC X(6).
  3625         16  FILLER                  PIC X(5).
  3626
  3627     12  CL-PROCESSING-INFO.
  3628         16  CL-PROCESSOR-ID         PIC X(4).
  3629         16  CL-CLAIM-STATUS         PIC X.
  3630             88  CLAIM-IS-OPEN          VALUE 'O'.
  3631             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3632         16  CL-CLAIM-TYPE           PIC X.
  3633*            88  AH-CLAIM               VALUE 'A'.
  3634*            88  LIFE-CLAIM             VALUE 'L'.
  3635*            88  PROPERTY-CLAIM         VALUE 'P'.
  3636*            88  IUI-CLAIM              VALUE 'I'.
  3637*            88  GAP-CLAIM              VALUE 'G'.
  3638         16  CL-CLAIM-PREM-TYPE      PIC X.
  3639             88  SINGLE-PREMIUM         VALUE '1'.
  3640             88  O-B-COVERAGE           VALUE '2'.
  3641             88  OPEN-END-COVERAGE      VALUE '3'.
  3642         16  CL-INCURRED-DT          PIC XX.
  3643         16  CL-REPORTED-DT          PIC XX.
  3644         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3645         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3646         16  CL-LAST-PMT-DT          PIC XX.
  3647         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3648         16  CL-PAID-THRU-DT         PIC XX.
  3649         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3650         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3651         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3652         16  CL-PMT-CALC-METHOD      PIC X.
  3653             88  CL-360-DAY-YR          VALUE '1'.
  3654             88  CL-365-DAY-YR          VALUE '2'.
  3655             88  CL-FULL-MONTHS         VALUE '3'.
  3656         16  CL-CAUSE-CD             PIC X(6).
  3657
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  68
* EL131.cbl
  3658         16  CL-PRIME-CERT-NO.
  3659             20  CL-PRIME-CERT-PRIME PIC X(10).
  3660             20  CL-PRIME-CERT-SFX   PIC X.
  3661
  3662         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3663             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3664             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3665
  3666         16  CL-MICROFILM-NO         PIC X(10).
  3667         16  FILLER REDEFINES CL-MICROFILM-NO.
  3668             20  CL-BENEFIT-PERIOD   PIC 99.
  3669             20  FILLER              PIC X(8).
  3670         16  CL-PROG-FORM-TYPE       PIC X.
  3671         16  CL-LAST-ADD-ON-DT       PIC XX.
  3672
  3673         16  CL-LAST-REOPEN-DT       PIC XX.
  3674         16  CL-LAST-CLOSE-DT        PIC XX.
  3675         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3676             88  FINAL-PAID             VALUE '1'.
  3677             88  CLAIM-DENIED           VALUE '2'.
  3678             88  AUTO-CLOSE             VALUE '3'.
  3679             88  MANUAL-CLOSE           VALUE '4'.
  3680             88  BENEFITS-CHANGED       VALUE 'C'.
  3681             88  SETUP-ERRORS           VALUE 'E'.
  3682         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3683         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3684         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3685             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3686         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3687         16  FILLER                  PIC X.
  3688
  3689     12  CL-CERTIFICATE-DATA.
  3690         16  CL-CERT-ORIGIN          PIC X.
  3691             88  CERT-WAS-ONLINE        VALUE '1'.
  3692             88  CERT-WAS-CREATED       VALUE '2'.
  3693             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3694         16  CL-CERT-KEY-DATA.
  3695             20  CL-CERT-CARRIER     PIC X.
  3696             20  CL-CERT-GROUPING    PIC X(6).
  3697             20  CL-CERT-STATE       PIC XX.
  3698             20  CL-CERT-ACCOUNT.
  3699                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3700                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3701             20  CL-CERT-EFF-DT      PIC XX.
  3702
  3703     12  CL-STATUS-CONTROLS.
  3704         16  CL-PRIORITY-CD          PIC X.
  3705             88  CONFIDENTIAL-DATA      VALUE '8'.
  3706             88  HIGHEST-PRIORITY       VALUE '9'.
  3707         16  CL-SUPV-ATTN-CD         PIC X.
  3708             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3709             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3710         16  CL-PURGED-DT            PIC XX.
  3711         16  CL-RESTORED-DT          PIC XX.
  3712         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3713         16  CL-NEXT-RESEND-DT       PIC XX.
  3714         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3715         16  CL-CRITICAL-PERIOD      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  69
* EL131.cbl
  3716*        16  FILLER                  PIC XX.
  3717         16  CL-LAST-MAINT-DT        PIC XX.
  3718         16  CL-LAST-MAINT-USER      PIC X(4).
  3719         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3720         16  CL-LAST-MAINT-TYPE      PIC X.
  3721             88  CLAIM-SET-UP           VALUE ' '.
  3722             88  PAYMENT-MADE           VALUE '1'.
  3723             88  LETTER-SENT            VALUE '2'.
  3724             88  MASTER-WAS-ALTERED     VALUE '3'.
  3725             88  MASTER-WAS-RESTORED    VALUE '4'.
  3726             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3727             88  FILE-CONVERTED         VALUE '6'.
  3728             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3729             88  ERROR-CORRECTION       VALUE 'E'.
  3730         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3731         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3732         16  CL-BENEFICIARY          PIC X(10).
  3733         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3734         16  CL-DENIAL-TYPE          PIC X.
  3735             88  CL-TYPE-DENIAL          VALUE '1'.
  3736             88  CL-TYPE-RESCISSION      VALUE '2'.
  3737             88  CL-TYPE-REFORMATION     VALUE '3'.
  3738             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3739             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3740         16  filler                  pic x(5).
  3741*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3742*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3743*        16  CL-RTW-DT               PIC XX.
  3744
  3745     12  CL-TRAILER-CONTROLS.
  3746         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3747             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3748             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3749             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3750         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3751         16  FILLER                  PIC XX.
  3752         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3753         16  CL-ADDRESS-TRAILER-CNT.
  3754             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3755                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3756             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3757                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3758             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3759                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3760             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3761                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3762             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3763                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3764             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3765                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3766             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3767                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3768
  3769     12  CL-CV-REFERENCE-NO.
  3770         16  CL-CV-REFNO-PRIME       PIC X(18).
  3771         16  CL-CV-REFNO-SFX         PIC XX.
  3772
  3773     12  CL-FILE-LOCATION            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  70
* EL131.cbl
  3774
  3775     12  CL-PROCESS-ERRORS.
  3776         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3777             88  NO-FATAL-ERRORS        VALUE ZERO.
  3778         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3779             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3780
  3781     12  CL-PRODUCT-CD               PIC X.
  3782
  3783     12  CL-CURRENT-KEY-DATA.
  3784         16  CL-CURRENT-CARRIER      PIC X.
  3785         16  CL-CURRENT-GROUPING     PIC X(6).
  3786         16  CL-CURRENT-STATE        PIC XX.
  3787         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3788
  3789     12  CL-ASSOCIATES               PIC X.
  3790         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3791         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3792         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3793         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3794
  3795     12  CL-ACTIVITY-CODE            PIC 99.
  3796     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3797     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3798
  3799     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3800     12  CL-LAG-REPORT-CODE          PIC 9.
  3801     12  CL-LOAN-TYPE                PIC XX.
  3802     12  CL-LEGAL-STATE              PIC XX.
  3803
  3804     12  CL-YESNOSW                  PIC X.
  3805     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3806         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3807         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3808         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3809     12  cl-insured-type             pic x.
  3810         88  cl-claim-on-primary         value 'P'.
  3811         88  cl-claim-on-co-borrower     value 'C'.
  3812     12  cl-benefit-expiration-dt    PIC XX.
  3813
  3814*                                COPY ELCCERT.
  3815******************************************************************
  3816*                                                                *
  3817*                            ELCCERT.                            *
  3818*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3819*                            VMOD=2.013                          *
  3820*                                                                *
  3821*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3822*                                                                *
  3823*   FILE TYPE = VSAM,KSDS                                        *
  3824*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3825*                                                                *
  3826*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3827*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3828*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3829*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3830*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3831*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  71
* EL131.cbl
  3832*   LOG = YES                                                    *
  3833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3834******************************************************************
  3835*                   C H A N G E   L O G
  3836*
  3837* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3838*-----------------------------------------------------------------
  3839*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3840* EFFECTIVE    NUMBER
  3841*-----------------------------------------------------------------
  3842* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3843* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3844* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3845* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3846* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3847* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3848* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3849* 032612  CR2011110200001  PEMA  AHL CHANGES
  3850******************************************************************
  3851
  3852 01  CERTIFICATE-MASTER.
  3853     12  CM-RECORD-ID                      PIC XX.
  3854         88  VALID-CM-ID                      VALUE 'CM'.
  3855
  3856     12  CM-CONTROL-PRIMARY.
  3857         16  CM-COMPANY-CD                 PIC X.
  3858         16  CM-CARRIER                    PIC X.
  3859         16  CM-GROUPING.
  3860             20  CM-GROUPING-PREFIX        PIC X(3).
  3861             20  CM-GROUPING-PRIME         PIC X(3).
  3862         16  CM-STATE                      PIC XX.
  3863         16  CM-ACCOUNT.
  3864             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3865             20  CM-ACCOUNT-PRIME          PIC X(6).
  3866         16  CM-CERT-EFF-DT                PIC XX.
  3867         16  CM-CERT-NO.
  3868             20  CM-CERT-PRIME             PIC X(10).
  3869             20  CM-CERT-SFX               PIC X.
  3870
  3871     12  CM-CONTROL-BY-NAME.
  3872         16  CM-COMPANY-CD-A1              PIC X.
  3873         16  CM-INSURED-LAST-NAME          PIC X(15).
  3874         16  CM-INSURED-INITIALS.
  3875             20  CM-INSURED-INITIAL1       PIC X.
  3876             20  CM-INSURED-INITIAL2       PIC X.
  3877
  3878     12  CM-CONTROL-BY-SSN.
  3879         16  CM-COMPANY-CD-A2              PIC X.
  3880         16  CM-SOC-SEC-NO.
  3881             20  CM-SSN-STATE              PIC XX.
  3882             20  CM-SSN-ACCOUNT            PIC X(6).
  3883             20  CM-SSN-LN3.
  3884                 25  CM-INSURED-INITIALS-A2.
  3885                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3886                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3887                 25 CM-PART-LAST-NAME-A2         PIC X.
  3888
  3889     12  CM-CONTROL-BY-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  72
* EL131.cbl
  3890         16  CM-COMPANY-CD-A4              PIC X.
  3891         16  CM-CERT-NO-A4                 PIC X(11).
  3892
  3893     12  CM-CONTROL-BY-MEMB.
  3894         16  CM-COMPANY-CD-A5              PIC X.
  3895         16  CM-MEMBER-NO.
  3896             20  CM-MEMB-STATE             PIC XX.
  3897             20  CM-MEMB-ACCOUNT           PIC X(6).
  3898             20  CM-MEMB-LN4.
  3899                 25  CM-INSURED-INITIALS-A5.
  3900                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3901                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3902                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3903
  3904     12  CM-INSURED-PROFILE-DATA.
  3905         16  CM-INSURED-FIRST-NAME.
  3906             20  CM-INSURED-1ST-INIT       PIC X.
  3907             20  FILLER                    PIC X(9).
  3908         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3909         16  CM-INSURED-SEX                PIC X.
  3910             88  CM-SEX-MALE                  VALUE 'M'.
  3911             88  CM-SEX-FEMAL                 VALUE 'F'.
  3912         16  CM-INSURED-JOINT-AGE          PIC 99.
  3913         16  CM-JOINT-INSURED-NAME.
  3914             20  CM-JT-LAST-NAME           PIC X(15).
  3915             20  CM-JT-FIRST-NAME.
  3916                 24  CM-JT-1ST-INIT        PIC X.
  3917                 24  FILLER                PIC X(9).
  3918             20  CM-JT-INITIAL             PIC X.
  3919
  3920     12  CM-LIFE-DATA.
  3921         16  CM-LF-BENEFIT-CD              PIC XX.
  3922         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3923         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3924         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3925         16  CM-LF-DEV-CODE                PIC XXX.
  3926         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3927         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3928         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3929         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3930         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3931         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3932         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3933         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3934         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3935         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3936         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3937         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3938         16  FILLER                        PIC XX.
  3939
  3940     12  CM-AH-DATA.
  3941         16  CM-AH-BENEFIT-CD              PIC XX.
  3942         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3943         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3944         16  CM-AH-DEV-CODE                PIC XXX.
  3945         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3946         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3947         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  73
* EL131.cbl
  3948         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3949         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3950         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3951         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3952         16  CM-AH-PAID-THRU-DT            PIC XX.
  3953             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3954         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3955         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3956         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3957         16  FILLER                        PIC X.
  3958
  3959     12  CM-LOAN-INFORMATION.
  3960         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3961         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3962                                           PIC S9(5)V99  COMP-3.
  3963         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3964         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3965         16  CM-PAY-FREQUENCY              PIC S99.
  3966         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3967         16  CM-RATE-CLASS                 PIC XX.
  3968         16  CM-BENEFICIARY                PIC X(25).
  3969         16  CM-POLICY-FORM-NO             PIC X(12).
  3970         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3971         16  CM-LAST-ADD-ON-DT             PIC XX.
  3972         16  CM-DEDUCTIBLE-AMOUNTS.
  3973             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3974             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3975         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3976             20  CM-RESIDENT-STATE         PIC XX.
  3977             20  CM-RATE-CODE              PIC X(4).
  3978             20  FILLER                    PIC XX.
  3979         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3980             20  CM-LOAN-OFFICER           PIC X(5).
  3981             20  FILLER                    PIC XXX.
  3982         16  CM-CSR-CODE                   PIC XXX.
  3983         16  CM-UNDERWRITING-CODE          PIC X.
  3984             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3985         16  CM-POST-CARD-IND              PIC X.
  3986         16  CM-NH-INTERFACE-SW            PIC X.
  3987         16  CM-PREMIUM-TYPE               PIC X.
  3988             88  CM-SING-PRM                  VALUE '1'.
  3989             88  CM-O-B-COVERAGE              VALUE '2'.
  3990             88  CM-OPEN-END                  VALUE '3'.
  3991         16  CM-IND-GRP-TYPE               PIC X.
  3992             88  CM-INDIVIDUAL                VALUE 'I'.
  3993             88  CM-GROUP                     VALUE 'G'.
  3994         16  CM-SKIP-CODE                  PIC X.
  3995             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3996             88  SKIP-JULY                    VALUE '1'.
  3997             88  SKIP-AUGUST                  VALUE '2'.
  3998             88  SKIP-SEPTEMBER               VALUE '3'.
  3999             88  SKIP-JULY-AUG                VALUE '4'.
  4000             88  SKIP-AUG-SEPT                VALUE '5'.
  4001             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4002             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4003             88  SKIP-JUNE                    VALUE '8'.
  4004             88  SKIP-JUNE-JULY               VALUE '9'.
  4005             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  74
* EL131.cbl
  4006             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4007         16  CM-PAYMENT-MODE               PIC X.
  4008             88  PAY-MONTHLY                  VALUE SPACE.
  4009             88  PAY-WEEKLY                   VALUE '1'.
  4010             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4011             88  PAY-BI-WEEKLY                VALUE '3'.
  4012             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4013         16  CM-LOAN-NUMBER                PIC X(8).
  4014         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4015         16  CM-OLD-LOF                    PIC XXX.
  4016*        16  CM-LOAN-OFFICER               PIC XXX.
  4017         16  CM-REIN-TABLE                 PIC XXX.
  4018         16  CM-SPECIAL-REIN-CODE          PIC X.
  4019         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4020         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4021         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4022
  4023     12  CM-STATUS-DATA.
  4024         16  CM-ENTRY-STATUS               PIC X.
  4025         16  CM-ENTRY-DT                   PIC XX.
  4026
  4027         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4028         16  CM-LF-CANCEL-DT               PIC XX.
  4029         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4030
  4031         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4032         16  CM-LF-DEATH-DT                PIC XX.
  4033         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4034
  4035         16  CM-LF-CURRENT-STATUS          PIC X.
  4036             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4037                                                'M' '4' '5' '9'.
  4038             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4039             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4040             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4041             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4042             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4043             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4044             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4045             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4046             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4047             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4048             88  CM-LF-DECLINED               VALUE 'D'.
  4049             88  CM-LF-VOIDED                 VALUE 'V'.
  4050
  4051         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4052         16  CM-AH-CANCEL-DT               PIC XX.
  4053         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4054
  4055         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4056         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4057         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4058
  4059         16  CM-AH-CURRENT-STATUS          PIC X.
  4060             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4061                                                'M' '4' '5' '9'.
  4062             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4063             88  CM-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  75
* EL131.cbl
  4064             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4065             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4066             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4067             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4068             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4069             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4070             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4071             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4072             88  CM-AH-DECLINED               VALUE 'D'.
  4073             88  CM-AH-VOIDED                 VALUE 'V'.
  4074
  4075         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4076             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4077             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4078             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4079         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4080
  4081         16  CM-ENTRY-BATCH                PIC X(6).
  4082         16  CM-LF-EXIT-BATCH              PIC X(6).
  4083         16  CM-AH-EXIT-BATCH              PIC X(6).
  4084         16  CM-LAST-MONTH-END             PIC XX.
  4085
  4086     12  CM-NOTE-SW                        PIC X.
  4087         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4088         88  CERT-NOTES-PRESENT               VALUE '1'.
  4089         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4090         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4091         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4092         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4093         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4094         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4095     12  CM-COMP-EXCP-SW                   PIC X.
  4096         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4097         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4098     12  CM-INSURED-ADDRESS-SW             PIC X.
  4099         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4100         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4101
  4102*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4103     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4104     12  FILLER                            PIC X.
  4105
  4106*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4107     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4108     12  FILLER                            PIC X.
  4109*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4110     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4111
  4112     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4113         88  CERT-ADDED-BATCH                 VALUE ' '.
  4114         88  CERT-ADDED-ONLINE                VALUE '1'.
  4115         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4116         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4117         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4118     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4119         88  CERT-AS-LOADED                   VALUE ' '.
  4120         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4121         88  CERT-CLAIM-ONLINE                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  76
* EL131.cbl
  4122         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4123         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4124         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4125         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4126         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4127
  4128     12  CM-ACCOUNT-COMM-PCTS.
  4129         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4130         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4131
  4132     12  CM-USER-FIELD                     PIC X.
  4133     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4134     12  CM-CLP-STATE                      PIC XX.
  4135     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4136     12  CM-USER-RESERVED                  PIC XXX.
  4137     12  FILLER REDEFINES CM-USER-RESERVED.
  4138         16  CM-AH-CLASS-CD                PIC XX.
  4139         16  F                             PIC X.
  4140******************************************************************
  4141
  4142*                                COPY ELCTRLR.
  4143******************************************************************
  4144*                                                                *
  4145*                            ELCTRLR.                            *
  4146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4147*                            VMOD=2.014                          *
  4148*                                                                *
  4149*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4150*                                                                *
  4151*   FILE TYPE = VSAM,KSDS                                        *
  4152*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4153*                                                                *
  4154*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4155*       ALTERNATE INDEX = NONE                                   *
  4156*                                                                *
  4157*   LOG = YES                                                    *
  4158*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4159******************************************************************
  4160*                   C H A N G E   L O G
  4161*
  4162* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4163*-----------------------------------------------------------------
  4164*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4165* EFFECTIVE    NUMBER
  4166*-----------------------------------------------------------------
  4167* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4168* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4169* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4170* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4171* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4172* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4173* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4174* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4175* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4176* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4177* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4178* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4179* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  77
* EL131.cbl
  4180* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4181* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4182* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4183* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4184* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4185* 040814    2014030500002  AJRA  ADD ICD CODES
  4186******************************************************************
  4187 01  ACTIVITY-TRAILERS.
  4188     12  AT-RECORD-ID                    PIC XX.
  4189         88  VALID-AT-ID                       VALUE 'AT'.
  4190
  4191     12  AT-CONTROL-PRIMARY.
  4192         16  AT-COMPANY-CD               PIC X.
  4193         16  AT-CARRIER                  PIC X.
  4194         16  AT-CLAIM-NO                 PIC X(7).
  4195         16  AT-CERT-NO.
  4196             20  AT-CERT-PRIME           PIC X(10).
  4197             20  AT-CERT-SFX             PIC X.
  4198         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4199             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4200             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4201             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4202             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4203             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4204             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4205             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4206             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4207             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4208             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4209             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4210             88  AT-BENEFICIARY-TRL           VALUE +91.
  4211             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4212             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4213             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4214             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4215
  4216     12  AT-TRAILER-TYPE                 PIC X.
  4217         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4218         88  PAYMENT-TR                       VALUE '2'.
  4219         88  AUTO-PAY-TR                      VALUE '3'.
  4220         88  CORRESPONDENCE-TR                VALUE '4'.
  4221         88  ADDRESS-TR                       VALUE '5'.
  4222         88  GENERAL-INFO-TR                  VALUE '6'.
  4223         88  AUTO-PROMPT-TR                   VALUE '7'.
  4224         88  DENIAL-TR                        VALUE '8'.
  4225         88  INCURRED-CHG-TR                  VALUE '9'.
  4226         88  FORM-CONTROL-TR                  VALUE 'A'.
  4227
  4228     12  AT-RECORDED-DT                  PIC XX.
  4229     12  AT-RECORDED-BY                  PIC X(4).
  4230     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4231
  4232     12  AT-TRAILER-BODY                 PIC X(165).
  4233
  4234     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4235         16  AT-RESERVE-CONTROLS.
  4236             20  AT-MANUAL-SW            PIC X.
  4237                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  78
* EL131.cbl
  4238             20  AT-FUTURE-SW            PIC X.
  4239                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4240             20  AT-PTC-SW               PIC X.
  4241                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4242             20  AT-IBNR-SW              PIC X.
  4243                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4244             20  AT-PTC-LF-SW            PIC X.
  4245                 88  AT-LF-PTC-USED          VALUE '1'.
  4246             20  AT-CDT-ACCESS-METHOD    PIC X.
  4247                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4248                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4249                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4250             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4251         16  AT-LAST-COMPUTED-DT         PIC XX.
  4252         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4253         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4254         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4255         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4256         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4257         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4258         16  AT-EXPENSE-CONTROLS.
  4259             20  AT-EXPENSE-METHOD       PIC X.
  4260                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4261                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4262                 88  PERCENT-OF-PMT           VALUE '3'.
  4263                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4264             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4265             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4266         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4267         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4268
  4269         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4270         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4271
  4272*        16  FILLER                      PIC X(53).
  4273         16  FILLER                      PIC X(47).
  4274
  4275         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4276         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4277
  4278         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4279             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4280             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4281*                    C = CLOSED
  4282*                    O = OPEN
  4283             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4284*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4285
  4286     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4287         16  AT-PAYMENT-TYPE             PIC X.
  4288             88  PARTIAL-PAYMENT                VALUE '1'.
  4289             88  FINAL-PAYMENT                  VALUE '2'.
  4290             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4291             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4292             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4293             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4294             88  VOIDED-PAYMENT                 VALUE '9'.
  4295             88  TRANSFER                       VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  79
* EL131.cbl
  4296             88  LIFE-INTEREST                  VALUE 'I'.
  4297
  4298         16  AT-CLAIM-TYPE               PIC X.
  4299             88  PAID-FOR-AH                    VALUE 'A'.
  4300             88  PAID-FOR-LIFE                  VALUE 'L'.
  4301             88  PAID-FOR-IUI                   VALUE 'I'.
  4302             88  PAID-FOR-GAP                   VALUE 'G'.
  4303         16  AT-CLAIM-PREM-TYPE          PIC X.
  4304             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4305             88  AT-O-B-COVERAGE                VALUE '2'.
  4306             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4307         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4308         16  AT-CHECK-NO                 PIC X(7).
  4309         16  AT-PAID-FROM-DT             PIC XX.
  4310         16  AT-PAID-THRU-DT             PIC XX.
  4311         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4312         16  FILLER                      PIC X.
  4313         16  AT-PAYEES-NAME              PIC X(30).
  4314         16  AT-PAYMENT-ORIGIN           PIC X.
  4315             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4316             88  ONLINE-AUTO-PMT                VALUE '2'.
  4317             88  OFFLINE-PMT                    VALUE '3'.
  4318         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4319         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4320         16  AT-VOID-DATA.
  4321             20  AT-VOID-DT              PIC XX.
  4322*00144       20  AT-VOID-REASON          PIC X(30).
  4323             20  AT-VOID-REASON          PIC X(26).
  4324         16  AT-PMT-APPROVED-BY          PIC X(04).
  4325         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4326         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4327         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4328                                         PIC S99V9(5)  COMP-3.
  4329         16  AT-CREDIT-INTERFACE.
  4330             20  AT-PMT-SELECT-DT        PIC XX.
  4331                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4332             20  AT-PMT-ACCEPT-DT        PIC XX.
  4333                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4334             20  AT-VOID-SELECT-DT       PIC XX.
  4335                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4336             20  AT-VOID-ACCEPT-DT       PIC XX.
  4337                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4338
  4339         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4340                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4341                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4342         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4343
  4344         16  AT-FORCE-CONTROL            PIC X.
  4345             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4346         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4347         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4348         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4349         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4350         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4351         16  AT-BENEFIT-TYPE             PIC X.
  4352
  4353         16  AT-EXPENSE-TYPE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  80
* EL131.cbl
  4354         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4355
  4356         16  AT-PAYEE-TYPE-CD.
  4357             20  AT-PAYEE-TYPE           PIC X.
  4358                 88  INSURED-PAID           VALUE 'I'.
  4359                 88  BENEFICIARY-PAID       VALUE 'B'.
  4360                 88  ACCOUNT-PAID           VALUE 'A'.
  4361                 88  OTHER-1-PAID           VALUE 'O'.
  4362                 88  OTHER-2-PAID           VALUE 'Q'.
  4363                 88  DOCTOR-PAID            VALUE 'P'.
  4364                 88  EMPLOYER-PAID          VALUE 'E'.
  4365             20  AT-PAYEE-SEQ            PIC X.
  4366
  4367         16  AT-CASH-PAYMENT             PIC X.
  4368         16  AT-GROUPED-PAYMENT          PIC X.
  4369         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4370         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4371         16  AT-APPROVED-LEVEL           PIC X.
  4372         16  AT-VOID-TYPE                PIC X.
  4373             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4374             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4375         16  AT-AIG-UNEMP-IND            PIC X.
  4376             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4377         16  AT-ASSOCIATES               PIC X.
  4378             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4379             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4380
  4381         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4382         16  AT-CV-PMT-CODE              PIC X.
  4383             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4384             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4385             88  FULL-ADD-PAYMENT           VALUE '3'.
  4386             88  HALF-ADD-PAYMENT           VALUE '4'.
  4387             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4388             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4389             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4390             88  ADDL-PAYMENT               VALUE '8'.
  4391
  4392         16  AT-EOB-CODE1                PIC XXX.
  4393         16  AT-EOB-CODE2                PIC XXX.
  4394         16  AT-EOB-CODE3                PIC XXX.
  4395         16  FILLER REDEFINES AT-EOB-CODE3.
  4396             20  AT-PRINT-CLM-FORM       PIC X.
  4397             20  AT-PRINT-SURVEY         PIC X.
  4398             20  AT-SPECIAL-RELEASE      PIC X.
  4399         16  AT-EOB-CODE4                PIC XXX.
  4400         16  FILLER REDEFINES AT-EOB-CODE4.
  4401             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4402             20  FILLER                  PIC X.
  4403         16  AT-EOB-CODE5                PIC XXX.
  4404         16  FILLER REDEFINES AT-EOB-CODE5.
  4405             20  AT-PMT-PROOF-DT         PIC XX.
  4406             20  FILLER                  PIC X.
  4407
  4408         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4409             88  AT-PRINT-EOB            VALUE 'Y'.
  4410
  4411         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  81
* EL131.cbl
  4412         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4413
  4414     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4415         16  AT-SCHEDULE-START-DT        PIC XX.
  4416         16  AT-SCHEDULE-END-DT          PIC XX.
  4417         16  AT-TERMINATED-DT            PIC XX.
  4418         16  AT-LAST-PMT-TYPE            PIC X.
  4419             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4420             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4421         16  AT-FIRST-PMT-DATA.
  4422             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4423             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4424             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4425         16  AT-REGULAR-PMT-DATA.
  4426             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4427             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4428             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4429         16  AT-AUTO-PAYEE-CD.
  4430             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4431                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4432                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4433                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4434                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4435                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4436             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4437         16  AT-AUTO-PAY-DAY             PIC 99.
  4438         16  AT-AUTO-CASH                PIC X.
  4439             88  AT-CASH                      VALUE 'Y'.
  4440             88  AT-NON-CASH                  VALUE 'N'.
  4441*        16  FILLER                      PIC X(129).
  4442         16  AT-AUTO-END-LETTER          PIC X(4).
  4443         16  FILLER                      PIC X(125).
  4444
  4445         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4446         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4447
  4448     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4449         16  AT-LETTER-SENT-DT           PIC XX.
  4450         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4451         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4452         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4453         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4454         16  AT-LETTER-ORIGIN            PIC X.
  4455             88  ONLINE-CREATION              VALUE '1' '3'.
  4456             88  OFFLINE-CREATION             VALUE '2' '4'.
  4457             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4458             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4459         16  AT-STD-LETTER-FORM          PIC X(4).
  4460         16  AT-REASON-TEXT              PIC X(70).
  4461         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4462         16  AT-ADDRESEE-TYPE            PIC X.
  4463              88  INSURED-ADDRESEE            VALUE 'I'.
  4464              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4465              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4466              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4467              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4468              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4469              88  OTHER-ADDRESEE-2            VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  82
* EL131.cbl
  4470         16  AT-ADDRESSEE-NAME           PIC X(30).
  4471         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4472         16  AT-RESEND-PRINT-DATE        PIC XX.
  4473         16  AT-CORR-SOL-UNSOL           PIC X.
  4474         16  AT-LETTER-PURGED-DT         PIC XX.
  4475*
  4476*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4477*
  4478         16  AT-CSO-REDEFINITION.
  4479             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4480             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4481             20  AT-LETTER-TO-BENE       PIC X(1).
  4482             20  AT-STOP-LETTER-DT       PIC X(2).
  4483             20  FILLER                  PIC X(19).
  4484*             20  FILLER                  PIC X(27).
  4485             20  AT-CSO-LETTER-STATUS    PIC X.
  4486                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4487                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4488                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4489             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4490             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4491*
  4492*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4493*
  4494*        16  FILLER                      PIC X(26).
  4495*
  4496*        16  AT-DMD-BSR-CODE             PIC X.
  4497*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4498*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4499*
  4500*        16  AT-DMD-LETTER-STATUS        PIC X.
  4501*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4502*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4503*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4504*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4505*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4506
  4507         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4508         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4509
  4510     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4511         16  AT-ADDRESS-TYPE             PIC X.
  4512             88  INSURED-ADDRESS               VALUE 'I'.
  4513             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4514             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4515             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4516             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4517             88  OTHER-ADDRESS-1               VALUE 'O'.
  4518             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4519         16  AT-MAIL-TO-NAME             PIC X(30).
  4520         16  AT-ADDRESS-LINE-1           PIC X(30).
  4521         16  AT-ADDRESS-LINE-2           PIC X(30).
  4522         16  AT-CITY-STATE.
  4523             20  AT-CITY                 PIC X(28).
  4524             20  AT-STATE                PIC XX.
  4525         16  AT-ZIP.
  4526             20  AT-ZIP-CODE.
  4527                 24  AT-ZIP-1ST          PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  83
* EL131.cbl
  4528                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4529                 24  FILLER              PIC X(4).
  4530             20  AT-ZIP-PLUS4            PIC X(4).
  4531         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4532             20  AT-CAN-POSTAL-1         PIC XXX.
  4533             20  AT-CAN-POSTAL-2         PIC XXX.
  4534             20  FILLER                  PIC XXX.
  4535         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4536*         16  FILLER                      PIC X(23).
  4537         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4538         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4539         16  FILLER                      PIC X(13).
  4540         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4541         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4542
  4543     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4544         16  AT-INFO-LINE-1              PIC X(60).
  4545         16  FILLER REDEFINES AT-INFO-LINE-1.
  4546             20  AT-NOTE-ERROR-NO OCCURS 15
  4547                                         PIC X(4).
  4548         16  AT-INFO-LINE-2              PIC X(60).
  4549         16  FILLER REDEFINES AT-INFO-LINE-2.
  4550             20  AT-ICD-CODE-1           PIC X(8).
  4551             20  AT-ICD-CODE-2           PIC X(8).
  4552             20  FILLER                  PIC X(44).
  4553         16  AT-INFO-TRAILER-TYPE        PIC X.
  4554             88  AT-ERRORS-NOTE          VALUE 'E'.
  4555             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4556             88  AT-CALL-NOTE            VALUE 'C'.
  4557             88  AT-MAINT-NOTE           VALUE 'M'.
  4558             88  AT-CERT-CHANGE          VALUE 'X'.
  4559             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4560             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4561             88  AT-CERT-CANCELLED       VALUE 'T'.
  4562         16  AT-CALL-TYPE                PIC X.
  4563             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4564             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4565         16  AT-NOTE-CONTINUATION        PIC X.
  4566             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4567         16  AT-EOB-CODES-EXIST          PIC X.
  4568             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4569         16  FILLER                      PIC X(35).
  4570         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4571         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4572
  4573     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4574         16  AT-PROMPT-LINE-1            PIC X(60).
  4575         16  AT-PROMPT-LINE-2            PIC X(60).
  4576         16  AT-PROMPT-START-DT          PIC XX.
  4577         16  AT-PROMPT-END-DT            PIC XX.
  4578         16  FILLER                      PIC X(35).
  4579         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4580         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4581
  4582     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4583         16  AT-DENIAL-INFO-1            PIC X(60).
  4584         16  AT-DENIAL-INFO-2            PIC X(60).
  4585         16  AT-DENIAL-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  84
* EL131.cbl
  4586         16  AT-RETRACTION-DT            PIC XX.
  4587         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4588*         16  FILLER                      PIC X(31).
  4589         16  AT-DENIAL-PROOF-DT          PIC XX.
  4590         16  FILLER                      PIC X(29).
  4591         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4592         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4593
  4594     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4595         16  AT-OLD-INCURRED-DT          PIC XX.
  4596         16  AT-OLD-REPORTED-DT          PIC XX.
  4597         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4598         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4599         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4600         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4601         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4602         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4603         16  FILLER                      PIC X(26).
  4604         16  AT-OLD-DIAG-CODE            PIC X(6).
  4605         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4606         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4607         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4608         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4609         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4610         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4611         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4612         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4613         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4614         16  FILLER                      PIC X(9).
  4615         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4616
  4617     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4618         16  AT-FORM-SEND-ON-DT          PIC XX.
  4619         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4620         16  AT-FORM-RE-SEND-DT          PIC XX.
  4621         16  AT-FORM-ANSWERED-DT         PIC XX.
  4622         16  AT-FORM-PRINTED-DT          PIC XX.
  4623         16  AT-FORM-REPRINT-DT          PIC XX.
  4624         16  AT-FORM-TYPE                PIC X.
  4625             88  INITIAL-FORM                  VALUE '1'.
  4626             88  PROGRESS-FORM                 VALUE '2'.
  4627         16  AT-INSTRUCT-LN-1            PIC X(28).
  4628         16  AT-INSTRUCT-LN-2            PIC X(28).
  4629         16  AT-INSTRUCT-LN-3            PIC X(28).
  4630         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4631         16  AT-FORM-ADDRESS             PIC X.
  4632             88  FORM-TO-INSURED              VALUE 'I'.
  4633             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4634             88  FORM-TO-OTHER-1              VALUE 'O'.
  4635             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4636         16  AT-RELATED-1.
  4637             20 AT-REL-CARR-1            PIC X.
  4638             20 AT-REL-CLAIM-1           PIC X(7).
  4639             20 AT-REL-CERT-1            PIC X(11).
  4640         16  AT-RELATED-2.
  4641             20 AT-REL-CARR-2            PIC X.
  4642             20 AT-REL-CLAIM-2           PIC X(7).
  4643             20 AT-REL-CERT-2            PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  85
* EL131.cbl
  4644         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4645         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4646         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4647         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4648         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4649         16  AT-STOP-FORM-DT             PIC X(2).
  4650
  4651         16  FILLER                      PIC X(09).
  4652         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4653         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4654******************************************************************
  4655
  4656*                                COPY ELCCNTL.
  4657******************************************************************
  4658*                                                                *
  4659*                                                                *
  4660*                            ELCCNTL.                            *
  4661*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4662*                            VMOD=2.059                          *
  4663*                                                                *
  4664*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4665*                                                                *
  4666*   FILE TYPE = VSAM,KSDS                                        *
  4667*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4668*                                                                *
  4669*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4670*       ALTERNATE INDEX = NONE                                   *
  4671*                                                                *
  4672*   LOG = YES                                                    *
  4673*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4674******************************************************************
  4675*                   C H A N G E   L O G
  4676*
  4677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4678*-----------------------------------------------------------------
  4679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4680* EFFECTIVE    NUMBER
  4681*-----------------------------------------------------------------
  4682* 082503                   PEMA  ADD BENEFIT GROUP
  4683* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4684* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4685* 092705    2005050300006  PEMA  ADD SPP LEASES
  4686* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4687* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4688* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4689* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4690* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4691* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4692* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4693* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4694* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4695* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4696******************************************************************
  4697*
  4698 01  CONTROL-FILE.
  4699     12  CF-RECORD-ID                       PIC XX.
  4700         88  VALID-CF-ID                        VALUE 'CF'.
  4701
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  86
* EL131.cbl
  4702     12  CF-CONTROL-PRIMARY.
  4703         16  CF-COMPANY-ID                  PIC XXX.
  4704         16  CF-RECORD-TYPE                 PIC X.
  4705             88  CF-COMPANY-MASTER              VALUE '1'.
  4706             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4707             88  CF-STATE-MASTER                VALUE '3'.
  4708             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4709             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4710             88  CF-CARRIER-MASTER              VALUE '6'.
  4711             88  CF-MORTALITY-MASTER            VALUE '7'.
  4712             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4713             88  CF-TERMINAL-MASTER             VALUE '9'.
  4714             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4715             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4716             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4717             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4718             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4719             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4720             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4721             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4722             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4723         16  CF-ACCESS-CD-GENL              PIC X(4).
  4724         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4725             20  CF-PROCESSOR               PIC X(4).
  4726         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4727             20  CF-STATE-CODE              PIC XX.
  4728             20  FILLER                     PIC XX.
  4729         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4730             20  FILLER                     PIC XX.
  4731             20  CF-HI-BEN-IN-REC           PIC XX.
  4732         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4733             20  FILLER                     PIC XXX.
  4734             20  CF-CARRIER-CNTL            PIC X.
  4735         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4736             20  FILLER                     PIC XX.
  4737             20  CF-HI-TYPE-IN-REC          PIC 99.
  4738         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4739             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4740                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4741             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4742             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4743         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4744             20  FILLER                     PIC X.
  4745             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4746         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4747             20  FILLER                     PIC XX.
  4748             20  CF-MORTGAGE-PLAN           PIC XX.
  4749         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4750
  4751     12  CF-LAST-MAINT-DT                   PIC XX.
  4752     12  CF-LAST-MAINT-BY                   PIC X(4).
  4753     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4754
  4755     12  CF-RECORD-BODY                     PIC X(728).
  4756
  4757
  4758****************************************************************
  4759*             COMPANY MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  87
* EL131.cbl
  4760****************************************************************
  4761
  4762     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4763         16  CF-COMPANY-ADDRESS.
  4764             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4765             20  CF-CL-IN-CARE-OF           PIC X(30).
  4766             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4767             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4768             20  CF-CL-CITY-STATE           PIC X(30).
  4769             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4770             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4771         16  CF-COMPANY-CD                  PIC X.
  4772         16  CF-COMPANY-PASSWORD            PIC X(8).
  4773         16  CF-SECURITY-OPTION             PIC X.
  4774             88  ALL-SECURITY                   VALUE '1'.
  4775             88  COMPANY-VERIFY                 VALUE '2'.
  4776             88  PROCESSOR-VERIFY               VALUE '3'.
  4777             88  NO-SECURITY                    VALUE '4'.
  4778             88  ALL-BUT-TERM                   VALUE '5'.
  4779         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4780             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4781         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4782             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4783         16  CF-INFORCE-LOCATION            PIC X.
  4784             88  CERTS-ARE-ONLINE               VALUE '1'.
  4785             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4786             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4787         16  CF-LOWER-CASE-LETTERS          PIC X.
  4788         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4789             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4790             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4791             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4792             88  CF-ACCNT-CNTL                  VALUE '3'.
  4793             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4794
  4795         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4796         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4797
  4798         16  CF-LGX-CREDIT-USER             PIC X.
  4799             88  CO-IS-NOT-USER                 VALUE 'N'.
  4800             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4801
  4802         16 CF-CREDIT-CALC-CODES.
  4803             20  CF-CR-REM-TERM-CALC PIC X.
  4804               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4805               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4806               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4807               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4808               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4809               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4810               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4811             20  CF-CR-R78-METHOD           PIC X.
  4812               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4813               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4814
  4815         16  CF-CLAIM-CONTROL-COUNTS.
  4816             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4817                 88  CO-CLM-COUNT-RESET         VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  88
* EL131.cbl
  4818
  4819             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4820                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4821
  4822             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4823                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4824
  4825             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4826                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4827
  4828         16  CF-CURRENT-MONTH-END           PIC XX.
  4829
  4830         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4831             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4832             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4833             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4834             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4835                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4836                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4837             20  CF-CO-PREM-REJECT-SW       PIC X.
  4838                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4839                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4840             20  CF-CO-REF-REJECT-SW        PIC X.
  4841                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4842                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4843
  4844         16  CF-CO-REPORTING-DT             PIC XX.
  4845         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4846         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4847           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4848           88  CF-CO-MONTH-END                  VALUE '1'.
  4849
  4850         16  CF-LGX-CLAIM-USER              PIC X.
  4851             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4852             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4853
  4854         16  CF-CREDIT-EDIT-CONTROLS.
  4855             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4856             20  CF-MIN-AGE                 PIC 99.
  4857             20  CF-DEFAULT-AGE             PIC 99.
  4858             20  CF-MIN-TERM                PIC S999      COMP-3.
  4859             20  CF-MAX-TERM                PIC S999      COMP-3.
  4860             20  CF-DEFAULT-SEX             PIC X.
  4861             20  CF-JOINT-AGE-INPUT         PIC X.
  4862                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4863             20  CF-BIRTH-DATE-INPUT        PIC X.
  4864                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4865             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4866                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4867                 88  CF-ZERO-CARRIER            VALUE '1'.
  4868                 88  CF-ZERO-GROUPING           VALUE '2'.
  4869                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4870             20  CF-EDIT-SW                 PIC X.
  4871                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4872             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4873             20  CF-CR-PR-METHOD            PIC X.
  4874               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4875               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  89
* EL131.cbl
  4876             20  FILLER                     PIC X.
  4877
  4878         16  CF-CREDIT-MISC-CONTROLS.
  4879             20  CF-REIN-TABLE-SW           PIC X.
  4880                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4881             20  CF-COMP-TABLE-SW           PIC X.
  4882                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4883             20  CF-EXPERIENCE-RETENTION-AGE
  4884                                            PIC S9        COMP-3.
  4885             20  CF-CONVERSION-DT           PIC XX.
  4886             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4887             20  CF-RUN-FREQUENCY-SW        PIC X.
  4888                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4889                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4890
  4891             20  CF-CR-CHECK-NO-CONTROL.
  4892                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4893                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4894                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4895                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4896                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4897                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4898
  4899                 24  CF-CR-CHECK-COUNT       REDEFINES
  4900                     CF-CR-CHECK-COUNTER      PIC X(4).
  4901
  4902                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4903                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4904
  4905                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4906                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4907                 24  CF-MAIL-PROCESSING       PIC X.
  4908                     88  MAIL-PROCESSING          VALUE 'Y'.
  4909
  4910         16  CF-MISC-SYSTEM-CONTROL.
  4911             20  CF-SYSTEM-C                 PIC X.
  4912                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4913             20  CF-SYSTEM-D                 PIC X.
  4914                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4915             20  CF-SOC-SEC-NO-SW            PIC X.
  4916                 88  SOC-SEC-NO-USED             VALUE '1'.
  4917             20  CF-MEMBER-NO-SW             PIC X.
  4918                 88  MEMBER-NO-USED              VALUE '1'.
  4919             20  CF-TAX-ID-NUMBER            PIC X(11).
  4920             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4921             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4922                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4923                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4924                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4925                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4926             20  CF-SYSTEM-E                 PIC X.
  4927                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4928
  4929         16  CF-LGX-LIFE-USER               PIC X.
  4930             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4931             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4932
  4933         16  CF-CR-MONTH-END-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  90
* EL131.cbl
  4934
  4935         16  CF-FILE-MAINT-DATES.
  4936             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4937                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4938             20  CF-LAST-BATCH       REDEFINES
  4939                 CF-LAST-BATCH-NO               PIC X(4).
  4940             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4941             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4942             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4943             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4944             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4945             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4946             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4947             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4948             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4949             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4950
  4951         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4952         16  FILLER                         PIC X.
  4953
  4954         16  CF-ALT-MORT-CODE               PIC X(4).
  4955         16  CF-MEMBER-CAPTION              PIC X(10).
  4956
  4957         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4958             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4959             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4960             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4961             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4962             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4963
  4964         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4965
  4966         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4967         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4968         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4969         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4970
  4971         16  CF-AH-OVERRIDE-L1              PIC X.
  4972         16  CF-AH-OVERRIDE-L2              PIC XX.
  4973         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4974         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4975
  4976         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4977         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4978
  4979         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4980         16  CF-AR-LAST-EL860-DT            PIC XX.
  4981         16  CF-MP-MONTH-END-DT             PIC XX.
  4982
  4983         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4984         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4985             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4986
  4987         16  CF-AR-MONTH-END-DT             PIC XX.
  4988
  4989         16  CF-CRDTCRD-USER                PIC X.
  4990             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4991             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  91
* EL131.cbl
  4992
  4993         16  CF-CC-MONTH-END-DT             PIC XX.
  4994
  4995         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4996
  4997         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4998             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4999             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5000             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5001         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5002         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5003         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5004         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5005             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5006             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5007         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5008         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5009         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5010             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5011         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5012
  5013         16  CF-CL-ZIP-CODE.
  5014             20  CF-CL-ZIP-PRIME.
  5015                 24  CF-CL-ZIP-1ST          PIC X.
  5016                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5017                 24  FILLER                 PIC X(4).
  5018             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5019         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5020             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5021             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5022             20  FILLER                     PIC XXX.
  5023
  5024         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5025         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5026         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5027         16  CF-CO-OPTION-START-DATE        PIC XX.
  5028         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5029           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5030                                                      '3' '4'.
  5031           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5032           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5033           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5034           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5035           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5036           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5037
  5038         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5039
  5040         16  CF-PAYMENT-APPROVAL-LEVELS.
  5041             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5042             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5043             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5044             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5045             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5046             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5047
  5048         16  CF-END-USER-REPORTING-USER     PIC X.
  5049             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  92
* EL131.cbl
  5050             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5051
  5052         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5053             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5054             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5055
  5056         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5057
  5058         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5059         16  FILLER                         PIC X.
  5060
  5061         16  CF-CREDIT-ARCHIVE-CNTL.
  5062             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5063             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5064             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5065
  5066         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5067
  5068         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5069             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5070             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5071
  5072         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5073             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5074             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5075
  5076         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5077
  5078         16  CF-CO-ACH-ID-CODE              PIC  X.
  5079             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5080             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5081             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5082         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5083         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5084         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5085         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5086         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5087         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5088         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5089         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5090         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5091                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5092         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5093                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5094
  5095         16  CF-CO-OVER-SHORT.
  5096             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5097             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5098
  5099*         16  FILLER                         PIC X(102).
  5100         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5101             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5102             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5103
  5104         16  CF-AH-APPROVAL-DAYS.
  5105             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5106             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5107             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  93
* EL131.cbl
  5108             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5109
  5110         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5111
  5112         16  CF-APPROV-LEV-5.
  5113             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5114             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5115             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5116
  5117         16  FILLER                         PIC X(68).
  5118****************************************************************
  5119*             PROCESSOR/USER RECORD                            *
  5120****************************************************************
  5121
  5122     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5123         16  CF-PROCESSOR-NAME              PIC X(30).
  5124         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5125         16  CF-PROCESSOR-TITLE             PIC X(26).
  5126         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5127                 88  MESSAGE-YES                VALUE 'Y'.
  5128                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5129
  5130*****************************************************
  5131****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5132****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5133****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5134****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5135*****************************************************
  5136
  5137         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5138             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5139             20  CF-APPLICATION-FORCE       PIC X.
  5140             20  CF-INDIVIDUAL-APP.
  5141                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5142                     28  CF-BROWSE-APP      PIC X.
  5143                     28  CF-UPDATE-APP      PIC X.
  5144
  5145         16  CF-CURRENT-TERM-ON             PIC X(4).
  5146         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5147             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5148             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5149             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5150             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5151             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5152             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5153             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5154         16  CF-PROCESSOR-CARRIER           PIC X.
  5155             88  NO-CARRIER-SECURITY            VALUE ' '.
  5156         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5157             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5158         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5159             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5160         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5161             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5162
  5163         16  CF-PROC-SYS-ACCESS-SW.
  5164             20  CF-PROC-CREDIT-CLAIMS-SW.
  5165                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  94
* EL131.cbl
  5166                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5167                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5168                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5169             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5170                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5171                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5172             20  CF-PROC-LIFE-GNRLDGR-SW.
  5173                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5174                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5175                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5176                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5177             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5178                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5179                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5180         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5181             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5182             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5183         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5184
  5185         16  CF-APPROVAL-LEVEL                  PIC X.
  5186             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5187             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5188             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5189             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5190             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5191
  5192         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5193
  5194         16  CF-LANGUAGE-TYPE                   PIC X.
  5195             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5196             88  CF-LANG-IS-FR                      VALUE 'F'.
  5197
  5198         16  CF-CSR-IND                         PIC X.
  5199         16  FILLER                             PIC X(239).
  5200
  5201****************************************************************
  5202*             PROCESSOR/REMINDERS RECORD                       *
  5203****************************************************************
  5204
  5205     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5206         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5207             20  CF-START-REMIND-DT         PIC XX.
  5208             20  CF-END-REMIND-DT           PIC XX.
  5209             20  CF-REMINDER-TEXT           PIC X(50).
  5210         16  FILLER                         PIC X(296).
  5211
  5212
  5213****************************************************************
  5214*             STATE MASTER RECORD                              *
  5215****************************************************************
  5216
  5217     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5218         16  CF-STATE-ABBREVIATION          PIC XX.
  5219         16  CF-STATE-NAME                  PIC X(25).
  5220         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5221         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5222             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5223             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  95
* EL131.cbl
  5224             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5225             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5226                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5227                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5228             20  CF-ST-PREM-REJECT-SW       PIC X.
  5229                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5230                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5231             20  CF-ST-REF-REJECT-SW        PIC X.
  5232                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5233                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5234         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5235         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5236         16  CF-ST-REFUND-RULES.
  5237             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5238             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5239             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5240         16  CF-ST-FST-PMT-EXTENSION.
  5241             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5242             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5243                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5244                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5245                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5246                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5247         16  CF-ST-STATE-CALL.
  5248             20  CF-ST-CALL-UNEARNED        PIC X.
  5249             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5250             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5251         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5252             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5253             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5254         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5255         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5256         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5257         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5258         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5259         16  FILLER                         PIC X.
  5260         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5261             20  CF-ST-BENEFIT-CD           PIC XX.
  5262             20  CF-ST-BENEFIT-KIND         PIC X.
  5263                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5264                 88  CF-ST-AH-KIND              VALUE 'A'.
  5265             20  CF-ST-REM-TERM-CALC        PIC X.
  5266                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5267                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5268                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5269                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5270                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5271                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5272                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5273                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5274
  5275             20  CF-ST-REFUND-CALC          PIC X.
  5276                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5277                 88  ST-REFD-BY-R78             VALUE '1'.
  5278                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5279                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5280                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5281                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  96
* EL131.cbl
  5282                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5283                 88  ST-REFD-UTAH               VALUE '7'.
  5284                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5285                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5286                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5287
  5288             20  CF-ST-EARNING-CALC         PIC X.
  5289                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5290                 88  ST-EARN-BY-R78             VALUE '1'.
  5291                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5292                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5293                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5294                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5295                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5296                 88  ST-EARN-MEAN               VALUE '8'.
  5297                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5298
  5299             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5300                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5301                 88  ST-OVRD-BY-R78             VALUE '1'.
  5302                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5303                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5304                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5305                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5306                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5307                 88  ST-OVRD-MEAN               VALUE '8'.
  5308                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5309             20  FILLER                     PIC X.
  5310
  5311         16  CF-ST-COMMISSION-CAPS.
  5312             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5313             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5314             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5315             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5316         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5317                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5318
  5319         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5320
  5321         16  CF-ST-STATUTORY-INTEREST.
  5322             20  CF-ST-STAT-DATE-FROM       PIC X.
  5323                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5324                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5325             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5326             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5327             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5328             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5329             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5330
  5331         16  CF-ST-OVER-SHORT.
  5332             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5333             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5334
  5335         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5336
  5337         16  CF-ST-RT-CALC                  PIC X.
  5338
  5339         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  97
* EL131.cbl
  5340         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5341         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5342         16  CF-ST-RF-LR-CALC               PIC X.
  5343         16  CF-ST-RF-LL-CALC               PIC X.
  5344         16  CF-ST-RF-LN-CALC               PIC X.
  5345         16  CF-ST-RF-AH-CALC               PIC X.
  5346         16  CF-ST-RF-CP-CALC               PIC X.
  5347*        16  FILLER                         PIC X(206).
  5348*CIDMOD         16  FILLER                         PIC X(192).
  5349         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5350             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5351         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5352         16  CF-ST-VFY-2ND-BENE             PIC X.
  5353         16  CF-ST-CAUSAL-STATE             PIC X.
  5354         16  FILLER                         PIC X(185).
  5355
  5356****************************************************************
  5357*             BENEFIT MASTER RECORD                            *
  5358****************************************************************
  5359
  5360     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5361         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5362             20  CF-BENEFIT-CODE            PIC XX.
  5363             20  CF-BENEFIT-NUMERIC  REDEFINES
  5364                 CF-BENEFIT-CODE            PIC XX.
  5365             20  CF-BENEFIT-ALPHA           PIC XXX.
  5366             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5367             20  CF-BENEFIT-COMMENT         PIC X(10).
  5368
  5369             20  CF-LF-COVERAGE-TYPE        PIC X.
  5370                 88  CF-REDUCING                VALUE 'R'.
  5371                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5372
  5373             20  CF-SPECIAL-CALC-CD         PIC X.
  5374                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5375                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5376                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5377                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5378                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5379                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5380                 88  CF-FARM-PLAN               VALUE 'F'.
  5381                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5382                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5383                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5384                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5385                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5386                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5387                 88  CF-PRUDENTIAL              VALUE 'P'.
  5388                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5389                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5390                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5391                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5392                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5393                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5394
  5395             20  CF-JOINT-INDICATOR         PIC X.
  5396                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5397
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  98
* EL131.cbl
  5398*            20  FILLER                     PIC X(12).
  5399             20  cf-maximum-benefits        pic s999 comp-3.
  5400             20  FILLER                     PIC X(09).
  5401             20  CF-BENEFIT-CATEGORY        PIC X.
  5402             20  CF-LOAN-TYPE               PIC X(8).
  5403
  5404             20  CF-CO-REM-TERM-CALC        PIC X.
  5405                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5406                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5407                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5408                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5409                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5410
  5411             20  CF-CO-EARNINGS-CALC        PIC X.
  5412                 88  CO-EARN-BY-R78             VALUE '1'.
  5413                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5414                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5415                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5416                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5417                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5418                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5419                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5420
  5421             20  CF-CO-REFUND-CALC          PIC X.
  5422                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5423                 88  CO-REFD-BY-R78             VALUE '1'.
  5424                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5425                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5426                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5427                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5428                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5429                 88  CO-REFD-MEAN               VALUE '8'.
  5430                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5431                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5432                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5433
  5434             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5435                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5436                 88  CO-OVRD-BY-R78             VALUE '1'.
  5437                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5438                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5439                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5440                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5441                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5442                 88  CO-OVRD-MEAN               VALUE '8'.
  5443                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5444
  5445             20  CF-CO-BEN-I-G-CD           PIC X.
  5446                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5447                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5448                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5449
  5450         16  FILLER                         PIC X(304).
  5451
  5452
  5453****************************************************************
  5454*             CARRIER MASTER RECORD                            *
  5455****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page  99
* EL131.cbl
  5456
  5457     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5458         16  CF-ADDRESS-DATA.
  5459             20  CF-MAIL-TO-NAME            PIC X(30).
  5460             20  CF-IN-CARE-OF              PIC X(30).
  5461             20  CF-ADDRESS-LINE-1          PIC X(30).
  5462             20  CF-ADDRESS-LINE-2          PIC X(30).
  5463             20  CF-CITY-STATE              PIC X(30).
  5464             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5465             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5466
  5467         16  CF-CLAIM-NO-CONTROL.
  5468             20  CF-CLAIM-NO-METHOD         PIC X.
  5469                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5470                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5471                 88  CLAIM-NO-SEQ               VALUE '3'.
  5472                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5473             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5474                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5475                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5476                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5477
  5478         16  CF-CHECK-NO-CONTROL.
  5479             20  CF-CHECK-NO-METHOD         PIC X.
  5480                 88  CHECK-NO-MANUAL            VALUE '1'.
  5481                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5482                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5483                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5484             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5485                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5486
  5487         16  CF-DOMICILE-STATE              PIC XX.
  5488
  5489         16  CF-EXPENSE-CONTROLS.
  5490             20  CF-EXPENSE-METHOD          PIC X.
  5491                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5492                 88  DOLLARS-PER-PMT            VALUE '2'.
  5493                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5494                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5495             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5496             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5497
  5498         16  CF-CORRESPONDENCE-CONTROL.
  5499             20  CF-LETTER-RESEND-OPT       PIC X.
  5500                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5501                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5502             20  FILLER                     PIC X(4).
  5503
  5504         16  CF-RESERVE-CONTROLS.
  5505             20  CF-MANUAL-SW               PIC X.
  5506                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5507             20  CF-FUTURE-SW               PIC X.
  5508                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5509             20  CF-PTC-SW                  PIC X.
  5510                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5511             20  CF-IBNR-SW                 PIC X.
  5512                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5513             20  CF-PTC-LF-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 100
* EL131.cbl
  5514                 88  CF-LF-PTC-USED             VALUE '1'.
  5515             20  CF-CDT-ACCESS-METHOD       PIC X.
  5516                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5517                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5518                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5519             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5520
  5521         16  CF-CLAIM-CALC-METHOD           PIC X.
  5522             88  360-PLUS-MONTHS                VALUE '1'.
  5523             88  365-PLUS-MONTHS                VALUE '2'.
  5524             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5525             88  360-DAILY                      VALUE '4'.
  5526             88  365-DAILY                      VALUE '5'.
  5527
  5528         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5529         16  FILLER                         PIC X(11).
  5530
  5531         16  CF-LIMIT-AMOUNTS.
  5532             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5533             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5534             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5535             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5536             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5537             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5538             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5539             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5540             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5541             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5542
  5543         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5544         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5545         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5546
  5547         16  CF-ZIP-CODE.
  5548             20  CF-ZIP-PRIME.
  5549                 24  CF-ZIP-1ST             PIC X.
  5550                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5551                 24  FILLER                 PIC X(4).
  5552             20  CF-ZIP-PLUS4               PIC X(4).
  5553         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5554             20  CF-CAN-POSTAL-1            PIC XXX.
  5555             20  CF-CAN-POSTAL-2            PIC XXX.
  5556             20  FILLER                     PIC XXX.
  5557
  5558         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5559         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5560         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5561
  5562         16  CF-RATING-SWITCH               PIC X.
  5563             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5564             88  CF-NO-RATING                   VALUE 'N'.
  5565
  5566         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5567
  5568         16  CF-CARRIER-OVER-SHORT.
  5569             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5570             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5571
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 101
* EL131.cbl
  5572         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5573         16  CF-SECPAY-SWITCH               PIC X.
  5574             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5575             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5576         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5577         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5578         16  FILLER                         PIC X(444).
  5579*        16  FILLER                         PIC X(452).
  5580
  5581
  5582****************************************************************
  5583*             MORTALITY MASTER RECORD                          *
  5584****************************************************************
  5585
  5586     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5587         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5588                                INDEXED BY CF-MORT-NDX.
  5589             20  CF-MORT-TABLE              PIC X(5).
  5590             20  CF-MORT-TABLE-TYPE         PIC X.
  5591                 88  CF-MORT-JOINT              VALUE 'J'.
  5592                 88  CF-MORT-SINGLE             VALUE 'S'.
  5593                 88  CF-MORT-COMBINED           VALUE 'C'.
  5594                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5595                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5596             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5597             20  CF-MORT-AGE-METHOD         PIC XX.
  5598                 88  CF-AGE-LAST                VALUE 'AL'.
  5599                 88  CF-AGE-NEAR                VALUE 'AN'.
  5600             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5601             20  CF-MORT-ADJUSTMENT-DIRECTION
  5602                                            PIC X.
  5603                 88  CF-MINUS                   VALUE '-'.
  5604                 88  CF-PLUS                    VALUE '+'.
  5605             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5606             20  CF-MORT-JOINT-CODE         PIC X.
  5607                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5608             20  CF-MORT-PC-Q               PIC X.
  5609                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5610             20  CF-MORT-TABLE-CODE         PIC X(4).
  5611             20  CF-MORT-COMMENTS           PIC X(15).
  5612             20  FILLER                     PIC X(14).
  5613
  5614         16  FILLER                         PIC X(251).
  5615
  5616
  5617****************************************************************
  5618*             BUSSINESS TYPE MASTER RECORD                     *
  5619****************************************************************
  5620
  5621     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5622* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5623* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5624* AND RECORD 05 IS TYPES 81-99
  5625         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5626             20  CF-BUSINESS-TITLE          PIC  X(19).
  5627             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5628                                            PIC S9V9(4) COMP-3.
  5629             20  CF-BUS-EXCL-ST-CALL        PIC  X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 102
* EL131.cbl
  5630             20  FILLER                     PIC  X.
  5631         16  FILLER                         PIC  X(248).
  5632
  5633
  5634****************************************************************
  5635*             TERMINAL MASTER RECORD                           *
  5636****************************************************************
  5637
  5638     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5639
  5640         16  CF-COMPANY-TERMINALS.
  5641             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5642                                  PIC X(4).
  5643         16  FILLER               PIC X(248).
  5644
  5645
  5646****************************************************************
  5647*             LIFE EDIT MASTER RECORD                          *
  5648****************************************************************
  5649
  5650     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5651         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5652             20  CF-LIFE-CODE-IN            PIC XX.
  5653             20  CF-LIFE-CODE-OUT           PIC XX.
  5654         16  FILLER                         PIC X(248).
  5655
  5656
  5657****************************************************************
  5658*             AH EDIT MASTER RECORD                            *
  5659****************************************************************
  5660
  5661     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5662         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5663             20  CF-AH-CODE-IN              PIC XXX.
  5664             20  CF-AH-CODE-OUT             PIC XX.
  5665         16  FILLER                         PIC X(248).
  5666
  5667
  5668****************************************************************
  5669*             CREDIBILITY TABLES                               *
  5670****************************************************************
  5671
  5672     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5673         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5674                             INDEXED BY CF-CRDB-NDX.
  5675             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5676             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5677             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5678         16  FILLER                         PIC  X(332).
  5679
  5680
  5681****************************************************************
  5682*             REPORT CUSTOMIZATION RECORD                      *
  5683****************************************************************
  5684
  5685     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5686         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5687             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 103
* EL131.cbl
  5688             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5689             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5690**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5691****       A T-TRANSFER.                                   ****
  5692             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5693
  5694         16  FILLER                         PIC XX.
  5695
  5696         16  CF-CARRIER-CNTL-OPT.
  5697             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5698                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5699                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5700             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5701                                            PIC X.
  5702         16  CF-GROUP-CNTL-OPT.
  5703             20  CF-GROUP-OPT-SEQ           PIC 9.
  5704                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5705                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5706             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5707                                            PIC X(6).
  5708         16  CF-STATE-CNTL-OPT.
  5709             20  CF-STATE-OPT-SEQ           PIC 9.
  5710                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5711                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5712             20  CF-STATE-SELECT OCCURS 3 TIMES
  5713                                            PIC XX.
  5714         16  CF-ACCOUNT-CNTL-OPT.
  5715             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5716                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5717                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5718             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5719                                            PIC X(10).
  5720         16  CF-BUS-TYP-CNTL-OPT.
  5721             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5722                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5723                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5724             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5725                                            PIC XX.
  5726         16  CF-LF-TYP-CNTL-OPT.
  5727             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5728                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5729                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5730             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5731                                            PIC XX.
  5732         16  CF-AH-TYP-CNTL-OPT.
  5733             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5734                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5735                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5736             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5737                                            PIC XX.
  5738         16  CF-REPTCD1-CNTL-OPT.
  5739             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5740                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5741                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5742             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5743                                            PIC X(10).
  5744         16  CF-REPTCD2-CNTL-OPT.
  5745             20  CF-REPTCD2-OPT-SEQ         PIC 9.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 104
* EL131.cbl
  5746                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5747                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5748             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5749                                            PIC X(10).
  5750         16  CF-USER1-CNTL-OPT.
  5751             20  CF-USER1-OPT-SEQ           PIC 9.
  5752                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5753                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5754             20  CF-USER1-SELECT OCCURS 3 TIMES
  5755                                            PIC X(10).
  5756         16  CF-USER2-CNTL-OPT.
  5757             20  CF-USER2-OPT-SEQ           PIC 9.
  5758                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5759                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5760             20  CF-USER2-SELECT OCCURS 3 TIMES
  5761                                            PIC X(10).
  5762         16  CF-USER3-CNTL-OPT.
  5763             20  CF-USER3-OPT-SEQ           PIC 9.
  5764                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5765                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5766             20  CF-USER3-SELECT OCCURS 3 TIMES
  5767                                            PIC X(10).
  5768         16  CF-USER4-CNTL-OPT.
  5769             20  CF-USER4-OPT-SEQ           PIC 9.
  5770                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5771                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5772             20  CF-USER4-SELECT OCCURS 3 TIMES
  5773                                            PIC X(10).
  5774         16  CF-USER5-CNTL-OPT.
  5775             20  CF-USER5-OPT-SEQ           PIC 9.
  5776                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5777                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5778             20  CF-USER5-SELECT OCCURS 3 TIMES
  5779                                            PIC X(10).
  5780         16  CF-REINS-CNTL-OPT.
  5781             20  CF-REINS-OPT-SEQ           PIC 9.
  5782                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5783                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5784             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5785                 24  CF-REINS-PRIME         PIC XXX.
  5786                 24  CF-REINS-SUB           PIC XXX.
  5787
  5788         16  CF-AGENT-CNTL-OPT.
  5789             20  CF-AGENT-OPT-SEQ           PIC 9.
  5790                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5791                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5792             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5793                                            PIC X(10).
  5794
  5795         16  FILLER                         PIC X(43).
  5796
  5797         16  CF-LOSS-RATIO-SELECT.
  5798             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5799             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5800         16  CF-ENTRY-DATE-SELECT.
  5801             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5802             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5803         16  CF-EFFECTIVE-DATE-SELECT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 105
* EL131.cbl
  5804             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5805             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5806
  5807         16  CF-EXCEPTION-LIST-IND          PIC X.
  5808             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5809
  5810         16  FILLER                         PIC X(318).
  5811
  5812****************************************************************
  5813*                  EXCEPTION REPORTING RECORD                  *
  5814****************************************************************
  5815
  5816     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5817         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5818             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5819
  5820         16  CF-COMBINED-LIFE-AH-OPT.
  5821             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5822             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5823             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5824             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5825
  5826         16  CF-LIFE-OPT.
  5827             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5828             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5829             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5830             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5831             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5832             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5833             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5834             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5835             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5836             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5837
  5838         16  CF-AH-OPT.
  5839             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5840             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5841             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5842             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5843             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5844             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5845             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5846             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5847             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5848             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5849
  5850         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5851             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5852             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5853             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5854
  5855         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5856
  5857         16  FILLER                         PIC X(673).
  5858
  5859
  5860****************************************************************
  5861*             MORTGAGE SYSTEM PLAN RECORD                      *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 106
* EL131.cbl
  5862****************************************************************
  5863
  5864     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5865         16  CF-PLAN-TYPE                   PIC X.
  5866             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5867             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5868             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5869         16  CF-PLAN-ABBREV                 PIC XXX.
  5870         16  CF-PLAN-DESCRIPT               PIC X(10).
  5871         16  CF-PLAN-NOTES                  PIC X(20).
  5872         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5873         16  CF-PLAN-UNDERWRITING.
  5874             20  CF-PLAN-TERM-DATA.
  5875                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5876                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5877             20  CF-PLAN-AGE-DATA.
  5878                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5879                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5880                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5881             20  CF-PLAN-BENEFIT-DATA.
  5882                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5883                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5884                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5885                                            PIC S9(7)V99  COMP-3.
  5886         16  CF-PLAN-POLICY-FORMS.
  5887             20  CF-POLICY-FORM             PIC X(12).
  5888             20  CF-MASTER-APPLICATION      PIC X(12).
  5889             20  CF-MASTER-POLICY           PIC X(12).
  5890         16  CF-PLAN-RATING.
  5891             20  CF-RATE-CODE               PIC X(5).
  5892             20  CF-SEX-RATING              PIC X.
  5893                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5894                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5895             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5896             20  CF-SUB-STD-TYPE            PIC X.
  5897                 88  CF-PCT-OF-PREM            VALUE '1'.
  5898                 88  CF-PCT-OF-BENE            VALUE '2'.
  5899         16  CF-PLAN-PREM-TOLERANCES.
  5900             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5901             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5902         16  CF-PLAN-PYMT-TOLERANCES.
  5903             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5904             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5905         16  CF-PLAN-MISC-DATA.
  5906             20  FILLER                     PIC X.
  5907             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5908             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5909         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5910         16  CF-PLAN-IND-GRP                PIC X.
  5911             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5912                                                     '1'.
  5913             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5914                                                     '2'.
  5915         16  CF-MIB-SEARCH-SW               PIC X.
  5916             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5917             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5918             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5919             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 107
* EL131.cbl
  5920         16  CF-ALPHA-SEARCH-SW             PIC X.
  5921             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5922             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5923             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5924             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5925             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5926             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5927             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5928             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5929             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5930             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5931                                                     'A' 'B' 'C'
  5932                                                     'X' 'Y' 'Z'.
  5933         16  CF-EFF-DT-RULE-SW              PIC X.
  5934             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5935             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5936             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5937             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5938             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5939         16  FILLER                         PIC X(4).
  5940         16  CF-HEALTH-QUESTIONS            PIC X.
  5941             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5942         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5943         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5944         16  CF-PLAN-SNGL-JNT               PIC X.
  5945             88  CF-COMBINED-PLAN              VALUE 'C'.
  5946             88  CF-JNT-PLAN                   VALUE 'J'.
  5947             88  CF-SNGL-PLAN                  VALUE 'S'.
  5948         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5949         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5950         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5951         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5952         16  CF-RERATE-CNTL                 PIC  X.
  5953             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5954             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5955             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5956             88  CF-AUTO-RECALC                 VALUE '4'.
  5957         16  CF-BENEFIT-TYPE                PIC  X.
  5958             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5959             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5960         16  CF-POLICY-FEE                  PIC S999V99
  5961                                                    COMP-3.
  5962         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5963         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5964         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5965         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5966         16  FILLER                         PIC  X(32).
  5967         16  CF-TERMINATION-FORM            PIC  X(04).
  5968         16  FILLER                         PIC  X(08).
  5969         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5970                                                       COMP-3.
  5971         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5972         16  CF-ISSUE-LETTER                PIC  X(4).
  5973         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5974         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5975             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5976             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5977         16  CF-MP-REFUND-CALC              PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 108
* EL131.cbl
  5978             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5979             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5980             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5981             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5982             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5983             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5984             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5985             88  CF-MP-REFD-MEAN                VALUE '8'.
  5986         16  CF-ALT-RATE-CODE               PIC  X(5).
  5987
  5988
  5989         16  FILLER                         PIC X(498).
  5990****************************************************************
  5991*             MORTGAGE COMPANY MASTER RECORD                   *
  5992****************************************************************
  5993
  5994     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5995         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5996         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5997             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5998             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5999             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6000             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6001             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6002
  6003         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6004         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6005         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6006         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6007         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6008
  6009         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6010             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6011         16  CF-MP-RECON-USE-IND            PIC X(1).
  6012             88  CF-MP-USE-RECON             VALUE 'Y'.
  6013         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6014             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6015         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6016             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6017             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6018         16  FILLER                         PIC X(1).
  6019         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6020             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6021         16  CF-MORTG-MIB-VERSION           PIC X.
  6022             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6023             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6024             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6025         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6026             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6027                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6028             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6029                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6030             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6031                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6032             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6033                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6034             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6035                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 109
* EL131.cbl
  6036             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6037                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6038         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6039         16  FILLER                         PIC X(7).
  6040         16  CF-MORTG-DESTINATION-SYMBOL.
  6041             20  CF-MORTG-MIB-COMM          PIC X(5).
  6042             20  CF-MORTG-MIB-TERM          PIC X(5).
  6043         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6044             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6045         16  FILLER                         PIC X(03).
  6046         16  CF-MP-CHECK-NO-CONTROL.
  6047             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6048                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6049                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6050                                                ' ' LOW-VALUES.
  6051                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6052                                               VALUE '3'.
  6053         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6054         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6055         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6056             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6057                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6058             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6059                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6060             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6061                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6062             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6063                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6064             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6065                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6066             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6067                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6068         16  CF-MORTG-BILLING-AREA.
  6069             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6070                                            PIC X.
  6071         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6072         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6073         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6074         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6075             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6076             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6077         16  FILLER                         PIC X.
  6078         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6079             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6080             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6081         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6082         16  FILLER                         PIC X(8).
  6083         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6084         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6085         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6086         16  CF-ACH-COMPANY-ID.
  6087             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6088                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6089                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6090                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6091             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6092         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6093             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 110
* EL131.cbl
  6094         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6095             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6096             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6097         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6098         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6099         16  FILLER                         PIC X(536).
  6100
  6101****************************************************************
  6102*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6103****************************************************************
  6104
  6105     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6106         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6107             20  CF-FEMALE-HEIGHT.
  6108                 24  CF-FEMALE-FT           PIC 99.
  6109                 24  CF-FEMALE-IN           PIC 99.
  6110             20  CF-FEMALE-MIN-WT           PIC 999.
  6111             20  CF-FEMALE-MAX-WT           PIC 999.
  6112         16  FILLER                         PIC X(428).
  6113
  6114     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6115         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6116             20  CF-MALE-HEIGHT.
  6117                 24  CF-MALE-FT             PIC 99.
  6118                 24  CF-MALE-IN             PIC 99.
  6119             20  CF-MALE-MIN-WT             PIC 999.
  6120             20  CF-MALE-MAX-WT             PIC 999.
  6121         16  FILLER                         PIC X(428).
  6122******************************************************************
  6123*             AUTOMATIC ACTIVITY RECORD                          *
  6124******************************************************************
  6125     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6126         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6127             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6128             20  CF-SYS-LETTER-ID           PIC X(04).
  6129             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6130             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6131             20  CF-SYS-RESET-SW            PIC X(01).
  6132             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6133             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6134
  6135         16  FILLER                         PIC X(50).
  6136
  6137         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6138             20  CF-USER-ACTIVE-SW          PIC X(01).
  6139             20  CF-USER-LETTER-ID          PIC X(04).
  6140             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6141             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6142             20  CF-USER-RESET-SW           PIC X(01).
  6143             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6144             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6145             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6146
  6147         16  FILLER                         PIC X(246).
  6148
  6149*                                COPY ELCACTQ.
  6150******************************************************************
  6151*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 111
* EL131.cbl
  6152*                            ELCACTQ.                            *
  6153*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6154*                            VMOD=2.004                          *
  6155*                                                                *
  6156*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6157*                                                                *
  6158*   FILE TYPE = VSAM,KSDS                                        *
  6159*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6160*                                                                *
  6161*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6162*       ALTERNATE INDEX = NONE                                   *
  6163*                                                                *
  6164*   LOG = YES                                                    *
  6165*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6166*                                                                *
  6167*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6168******************************************************************
  6169
  6170 01  ACTIVITY-QUE.
  6171     12  AQ-RECORD-ID                PIC XX.
  6172         88  VALID-AQ-ID                VALUE 'AQ'.
  6173
  6174     12  AQ-CONTROL-PRIMARY.
  6175         16  AQ-COMPANY-CD           PIC X.
  6176         16  AQ-CARRIER              PIC X.
  6177         16  AQ-CLAIM-NO             PIC X(7).
  6178         16  AQ-CERT-NO.
  6179             20  AQ-CERT-PRIME       PIC X(10).
  6180             20  AQ-CERT-SFX         PIC X.
  6181
  6182     12  AQ-PENDING-ACTIVITY-FLAGS.
  6183         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6184         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6185             88  PENDING-PAYMENTS       VALUE '1'.
  6186         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6187             88  PENDING-FULL-PRINT     VALUE '1'.
  6188             88  PENDING-PART-PRINT     VALUE '2'.
  6189         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6190             88  PENDING-LETTERS        VALUE '1'.
  6191         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6192             88  PENDING-RESTORE        VALUE 'C'.
  6193             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6194
  6195     12  FILLER                      PIC X(20).
  6196
  6197     12  AQ-RESEND-DATE              PIC XX.
  6198     12  AQ-FOLLOWUP-DATE            PIC XX.
  6199     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6200     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6201     12  AQ-AUTO-LETTER              PIC X(4).
  6202     12  FILLER                      PIC XX.
  6203     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6204*****************************************************************
  6205
  6206*                                COPY ERCACCT.
  6207******************************************************************
  6208*                                                                *
  6209*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 112
* EL131.cbl
  6210*                            ERCACCT                             *
  6211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6212*                            VMOD=2.031                          *
  6213*                                                                *
  6214*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6215*                                                                *
  6216*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6217*   VSAM ACCOUNT MASTER FILES.                                   *
  6218*                                                                *
  6219*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6220*                                                                *
  6221*   FILE TYPE = VSAM,KSDS                                        *
  6222*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6223*                                                                *
  6224*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6225*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6226*                                                                *
  6227*   LOG = NO                                                     *
  6228*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6229*                                                                *
  6230*                                                                *
  6231******************************************************************
  6232*                   C H A N G E   L O G
  6233*
  6234* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6235*-----------------------------------------------------------------
  6236*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6237* EFFECTIVE    NUMBER
  6238*-----------------------------------------------------------------
  6239* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6240* 092705    2005050300006  PEMA  ADD SPP LEASES
  6241* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6242* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6243* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6244* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6245* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6246******************************************************************
  6247
  6248 01  ACCOUNT-MASTER.
  6249     12  AM-RECORD-ID                      PIC XX.
  6250         88  VALID-AM-ID                      VALUE 'AM'.
  6251
  6252     12  AM-CONTROL-PRIMARY.
  6253         16  AM-COMPANY-CD                 PIC X.
  6254         16  AM-MSTR-CNTRL.
  6255             20  AM-CONTROL-A.
  6256                 24  AM-CARRIER            PIC X.
  6257                 24  AM-GROUPING.
  6258                     28 AM-GROUPING-PREFIX PIC XXX.
  6259                     28 AM-GROUPING-PRIME  PIC XXX.
  6260                 24  AM-STATE              PIC XX.
  6261                 24  AM-ACCOUNT.
  6262                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6263                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6264             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6265                                           PIC X(19).
  6266             20  AM-CNTRL-B.
  6267                 24  AM-EXPIRATION-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 113
* EL131.cbl
  6268                 24  FILLER                PIC X(4).
  6269             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6270                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6271
  6272     12  AM-CONTROL-BY-VAR-GRP.
  6273         16  AM-COMPANY-CD-A1              PIC X.
  6274         16  AM-VG-CARRIER                 PIC X.
  6275         16  AM-VG-GROUPING                PIC X(6).
  6276         16  AM-VG-STATE                   PIC XX.
  6277         16  AM-VG-ACCOUNT                 PIC X(10).
  6278         16  AM-VG-DATE.
  6279             20  AM-VG-EXPIRATION-DT       PIC XX.
  6280             20  FILLER                    PIC X(4).
  6281         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6282                                           PIC 9(11)      COMP-3.
  6283     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6284         16  FILLER                        PIC X(10).
  6285         16  AM-VG-KEY3.
  6286             20  AM-VG3-ACCOUNT            PIC X(10).
  6287             20  AM-VG3-EXP-DT             PIC XX.
  6288         16  FILLER                        PIC X(4).
  6289     12  AM-MAINT-INFORMATION.
  6290         16  AM-LAST-MAINT-DT              PIC XX.
  6291         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6292         16  AM-LAST-MAINT-USER            PIC X(4).
  6293         16  FILLER                        PIC XX.
  6294
  6295     12  AM-EFFECTIVE-DT                   PIC XX.
  6296     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6297
  6298     12  AM-PREV-DATES  COMP-3.
  6299         16  AM-PREV-EXP-DT                PIC 9(11).
  6300         16  AM-PREV-EFF-DT                PIC 9(11).
  6301
  6302     12  AM-REPORT-CODE-1                  PIC X(10).
  6303     12  AM-REPORT-CODE-2                  PIC X(10).
  6304
  6305     12  AM-CITY-CODE                      PIC X(4).
  6306     12  AM-COUNTY-PARISH                  PIC X(6).
  6307
  6308     12  AM-NAME                           PIC X(30).
  6309     12  AM-PERSON                         PIC X(30).
  6310     12  AM-ADDRS                          PIC X(30).
  6311     12  AM-CITY.
  6312         16  AM-ADDR-CITY                  PIC X(28).
  6313         16  AM-ADDR-STATE                 PIC XX.
  6314     12  AM-ZIP.
  6315         16  AM-ZIP-PRIME.
  6316             20  AM-ZIP-PRI-1ST            PIC X.
  6317                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6318             20  FILLER                    PIC X(4).
  6319         16  AM-ZIP-PLUS4                  PIC X(4).
  6320     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6321         16  AM-CAN-POSTAL-1               PIC XXX.
  6322         16  AM-CAN-POSTAL-2               PIC XXX.
  6323         16  FILLER                        PIC XXX.
  6324     12  AM-TEL-NO.
  6325         16  AM-AREA-CODE                  PIC 999.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 114
* EL131.cbl
  6326         16  AM-TEL-PRE                    PIC 999.
  6327         16  AM-TEL-NBR                    PIC 9(4).
  6328     12  AM-TEL-LOC                        PIC X.
  6329         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6330         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6331
  6332     12  AM-COMM-STRUCTURE.
  6333         16  AM-DEFN-1.
  6334             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6335                 24  AM-AGT.
  6336                     28  AM-AGT-PREFIX     PIC X(4).
  6337                     28  AM-AGT-PRIME      PIC X(6).
  6338                 24  AM-COM-TYP            PIC X.
  6339                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6340                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6341                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6342                 24  AM-RECALC-LV-INDIC    PIC X.
  6343                 24  AM-RETRO-LV-INDIC     PIC X.
  6344                 24  AM-GL-CODES           PIC X.
  6345                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6346                 24  FILLER                PIC X(01).
  6347         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6348             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6349                 24  FILLER                PIC X(11).
  6350                 24  AM-L-COMA             PIC XXX.
  6351                 24  AM-J-COMA             PIC XXX.
  6352                 24  AM-A-COMA             PIC XXX.
  6353                 24  FILLER                PIC X(6).
  6354
  6355     12  AM-COMM-CHANGE-STATUS             PIC X.
  6356         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6357
  6358     12  AM-CSR-CODE                       PIC X(4).
  6359
  6360     12  AM-BILLING-STATUS                 PIC X.
  6361         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6362         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6363     12  AM-AUTO-REFUND-SW                 PIC X.
  6364         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6365         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6366     12  AM-GPCD                           PIC 99.
  6367     12  AM-IG                             PIC X.
  6368         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6369         88  AM-HAS-GROUP                     VALUE '2'.
  6370     12  AM-STATUS                         PIC X.
  6371         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6372         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6373         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6374         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6375         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6376         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6377     12  AM-REMIT-TO                       PIC 99.
  6378     12  AM-ID-NO                          PIC X(11).
  6379
  6380     12  AM-CAL-TABLE                      PIC XX.
  6381     12  AM-LF-DEVIATION                   PIC XXX.
  6382     12  AM-AH-DEVIATION                   PIC XXX.
  6383     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 115
* EL131.cbl
  6384     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6385     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6386     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6387     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6388     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6389
  6390     12  AM-USER-FIELDS.
  6391         16  AM-FLD-1                      PIC XX.
  6392         16  AM-FLD-2                      PIC XX.
  6393         16  AM-FLD-3                      PIC XX.
  6394         16  AM-FLD-4                      PIC XX.
  6395         16  AM-FLD-5                      PIC XX.
  6396
  6397     12  AM-1ST-PROD-DATE.
  6398         16  AM-1ST-PROD-YR                PIC XX.
  6399         16  AM-1ST-PROD-MO                PIC XX.
  6400         16  AM-1ST-PROD-DA                PIC XX.
  6401     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6402     12  AM-CERTS-PURGED-DATE.
  6403         16  AM-PUR-YR                     PIC XX.
  6404         16  AM-PUR-MO                     PIC XX.
  6405         16  AM-PUR-DA                     PIC XX.
  6406     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6407     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6408     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6409     12  AM-INACTIVE-DATE.
  6410         16  AM-INA-MO                     PIC 99.
  6411         16  AM-INA-DA                     PIC 99.
  6412         16  AM-INA-YR                     PIC 99.
  6413     12  AM-AR-HI-CERT-DATE                PIC XX.
  6414
  6415     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6416     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6417
  6418     12  AM-OB-PAYMENT-MODE                PIC X.
  6419         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6420         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6421         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6422         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6423
  6424     12  AM-AH-ONLY-INDICATOR              PIC X.
  6425         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6426         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6427
  6428     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6429
  6430     12  AM-OVER-SHORT.
  6431         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6432         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6433
  6434     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6435     12  AM-DCC-CLP-STATE                  PIC XX.
  6436
  6437     12  AM-RECALC-COMM                    PIC X.
  6438     12  AM-RECALC-REIN                    PIC X.
  6439
  6440     12  AM-REI-TABLE                      PIC XXX.
  6441     12  AM-REI-ET-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 116
* EL131.cbl
  6442     12  AM-REI-ET-AH                      PIC X.
  6443     12  AM-REI-PE-LF                      PIC X.
  6444     12  AM-REI-PE-AH                      PIC X.
  6445     12  AM-REI-PRT-ST                     PIC X.
  6446     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6447     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6448     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6449     12  AM-REI-GROUP-A                    PIC X(6).
  6450     12  AM-REI-MORT                       PIC X(4).
  6451     12  AM-REI-PRT-OW                     PIC X.
  6452     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6453     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6454     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6455     12  AM-REI-GROUP-B                    PIC X(6).
  6456
  6457     12  AM-TRUST-TYPE                     PIC X(2).
  6458
  6459     12  AM-EMPLOYER-STMT-USED             PIC X.
  6460     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6461
  6462     12  AM-STD-AH-TYPE                    PIC XX.
  6463     12  AM-EARN-METHODS.
  6464         16  AM-EARN-METHOD-R              PIC X.
  6465             88 AM-REF-RL-R78                 VALUE 'R'.
  6466             88 AM-REF-RL-PR                  VALUE 'P'.
  6467             88 AM-REF-RL-MEAN                VALUE 'M'.
  6468             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6469         16  AM-EARN-METHOD-L              PIC X.
  6470             88 AM-REF-LL-R78                 VALUE 'R'.
  6471             88 AM-REF-LL-PR                  VALUE 'P'.
  6472             88 AM-REF-LL-MEAN                VALUE 'M'.
  6473             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6474         16  AM-EARN-METHOD-A              PIC X.
  6475             88 AM-REF-AH-R78                 VALUE 'R'.
  6476             88 AM-REF-AH-PR                  VALUE 'P'.
  6477             88 AM-REF-AH-MEAN                VALUE 'M'.
  6478             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6479             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6480             88 AM-REF-AH-NET                 VALUE 'N'.
  6481
  6482     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6483     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6484     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6485
  6486     12  AM-RET-Y-N                        PIC X.
  6487     12  AM-RET-P-E                        PIC X.
  6488     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6489     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6490     12  AM-RET-GRP                        PIC X(6).
  6491     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6492         16  AM-POOL-PRIME                 PIC XXX.
  6493         16  AM-POOL-SUB                   PIC XXX.
  6494     12  AM-RETRO-EARNINGS.
  6495         16  AM-RET-EARN-R                 PIC X.
  6496         16  AM-RET-EARN-L                 PIC X.
  6497         16  AM-RET-EARN-A                 PIC X.
  6498     12  AM-RET-ST-TAX-USE                 PIC X.
  6499         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 117
* EL131.cbl
  6500         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6501     12  AM-RETRO-BEG-EARNINGS.
  6502         16  AM-RET-BEG-EARN-R             PIC X.
  6503         16  AM-RET-BEG-EARN-L             PIC X.
  6504         16  AM-RET-BEG-EARN-A             PIC X.
  6505     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6506     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6507
  6508     12  AM-USER-SELECT-OPTIONS.
  6509         16  AM-USER-SELECT-1              PIC X(10).
  6510         16  AM-USER-SELECT-2              PIC X(10).
  6511         16  AM-USER-SELECT-3              PIC X(10).
  6512         16  AM-USER-SELECT-4              PIC X(10).
  6513         16  AM-USER-SELECT-5              PIC X(10).
  6514
  6515     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6516
  6517     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6518
  6519     12  AM-RPT045A-SWITCH                 PIC X.
  6520         88  RPT045A-OFF                   VALUE 'N'.
  6521
  6522     12  AM-INSURANCE-LIMITS.
  6523         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6524         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6525
  6526     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6527         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6528
  6529     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6530         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6531         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6532
  6533     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6534
  6535     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6536     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6537     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6538     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6539     12  AM-DCC-UEF-STATE                  PIC XX.
  6540     12  FILLER                            PIC XXX.
  6541     12  AM-REPORT-CODE-3                  PIC X(10).
  6542*    12  FILLER                            PIC X(22).
  6543
  6544     12  AM-RESERVE-DATE.
  6545         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6546         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6547         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6548
  6549     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6550     12  AM-NOTIFICATION-TYPES.
  6551         16  AM-NOTIF-OF-LETTERS           PIC X.
  6552         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6553         16  AM-NOTIF-OF-REPORTS           PIC X.
  6554         16  AM-NOTIF-OF-STATUS            PIC X.
  6555
  6556     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6557         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 118
* EL131.cbl
  6558         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6559         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6560         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6561
  6562     12  AM-BENEFIT-CONTROLS.
  6563         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6564             20  AM-BENEFIT-CODE           PIC XX.
  6565             20  AM-BENEFIT-TYPE           PIC X.
  6566             20  AM-BENEFIT-REVISION       PIC XXX.
  6567             20  AM-BENEFIT-REM-TERM       PIC X.
  6568             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6569             20  FILLER                    PIC XX.
  6570         16  FILLER                        PIC X(80).
  6571
  6572     12  AM-TRANSFER-DATA.
  6573         16  AM-TRANSFERRED-FROM.
  6574             20  AM-TRNFROM-CARRIER        PIC X.
  6575             20  AM-TRNFROM-GROUPING.
  6576                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6577                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6578             20  AM-TRNFROM-STATE          PIC XX.
  6579             20  AM-TRNFROM-ACCOUNT.
  6580                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6581                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6582             20  AM-TRNFROM-DTE            PIC XX.
  6583         16  AM-TRANSFERRED-TO.
  6584             20  AM-TRNTO-CARRIER          PIC X.
  6585             20  AM-TRNTO-GROUPING.
  6586                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6587                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6588             20  AM-TRNTO-STATE            PIC XX.
  6589             20  AM-TRNTO-ACCOUNT.
  6590                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6591                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6592             20  AM-TRNTO-DTE              PIC XX.
  6593         16  FILLER                        PIC X(10).
  6594
  6595     12  AM-SAVED-REMIT-TO                 PIC 99.
  6596
  6597     12  AM-COMM-STRUCTURE-SAVED.
  6598         16  AM-DEFN-1-SAVED.
  6599             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6600                 24  AM-AGT-SV             PIC X(10).
  6601                 24  AM-COM-TYP-SV         PIC X.
  6602                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6603                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6604                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6605                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6606                 24  FILLER                PIC X.
  6607                 24  AM-GL-CODES-SV        PIC X.
  6608                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6609                 24  FILLER                PIC X.
  6610         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6611             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6612                 24  FILLER                PIC X(11).
  6613                 24  AM-L-COMA-SV          PIC XXX.
  6614                 24  AM-J-COMA-SV          PIC XXX.
  6615                 24  AM-A-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 119
* EL131.cbl
  6616                 24  FILLER                PIC X(6).
  6617
  6618     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6619         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6620            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6621            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6622            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6623
  6624     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6625     12  FILLER                            PIC X(120).
  6626
  6627     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6628         16  AM-CONTROL-NAME               PIC X(30).
  6629         16  AM-EXECUTIVE-ONE.
  6630             20  AM-EXEC1-NAME             PIC X(15).
  6631             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6632                                                          COMP-3.
  6633             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6634                                                          COMP-3.
  6635         16  AM-EXECUTIVE-TWO.
  6636             20  AM-EXEC2-NAME             PIC X(15).
  6637             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6638                                                          COMP-3.
  6639             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6640                                                          COMP-3.
  6641
  6642     12  AM-RETRO-ADDITIONAL-DATA.
  6643         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6644         16  AM-RETRO-PREM-P-E             PIC X.
  6645         16  AM-RETRO-CLMS-P-I             PIC X.
  6646         16  AM-RETRO-RET-BRACKET-LF.
  6647             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6648                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6649                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6650             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6651                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6652                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6653             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6654                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6655                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6656         16  AM-RETRO-RET-BRACKET-AH.
  6657             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6658                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6659                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6660                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6661             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6662                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6663                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6664             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6665                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6666                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6667
  6668     12  AM-COMMENTS.
  6669         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6670
  6671     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6672         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6673         16  AM-FLI-BILLING-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 120
* EL131.cbl
  6674         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6675         16  AM-FLI-UNITED-IDENT           PIC X.
  6676         16  AM-FLI-INTEREST-LOST-DATA.
  6677             20  AM-FLI-BANK-NO            PIC X(5).
  6678             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6679             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6680             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6681         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6682             20  AM-FLI-AGT                PIC X(9).
  6683             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6684             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6685         16  FILLER                        PIC X(102).
  6686
  6687     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6688         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6689             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6690             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6691             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6692             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6693             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6694         16  FILLER                          PIC X(10).
  6695******************************************************************
  6696
  6697*                                COPY ELCCHKQ.
  6698******************************************************************
  6699*                                                                *
  6700*                                                                *
  6701*                            ELCCHKQ.                            *
  6702*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6703*                            VMOD=2.007                          *
  6704*                                                                *
  6705*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6706*                                                                *
  6707*   FILE TYPE = VSAM,KSDS                                        *
  6708*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6709*                                                                *
  6710*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6711*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6712*                                                                *
  6713*   LOG = YES                                                    *
  6714*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6715******************************************************************
  6716 01  CHECK-QUE.
  6717     12  CQ-RECORD-ID                PIC XX.
  6718         88  VALID-CQ-ID         VALUE 'CQ'.
  6719
  6720     12  CQ-CONTROL-PRIMARY.
  6721         16  CQ-COMPANY-CD           PIC X.
  6722         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6723         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6724
  6725     12  CQ-CONTROL-BY-PAYEE.
  6726         16  CQ-CONTROL-BY-NUMBER.
  6727             20  CQ-COMPANY-CD-A1     PIC X.
  6728             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6729         16  CQ-PAYEE-CARRIER        PIC X.
  6730         16  CQ-PAYEE-GROUPING       PIC X(6).
  6731         16  CQ-PAYEE-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 121
* EL131.cbl
  6732         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6733         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6734
  6735     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6736         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6737         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6738         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6739         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6740         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6741         16  FILLER                  PIC X(3).
  6742
  6743     12  CQ-ENTRY-TYPE               PIC X.
  6744             88  CHECK-ON-QUE           VALUE 'Q'.
  6745             88  ALIGNMENT-CHECK        VALUE 'A'.
  6746             88  SPOILED-CHECK          VALUE 'S'.
  6747             88  PAYMENT-ABORTED        VALUE 'X'.
  6748
  6749     12  CQ-CLAIM-MAST-CNTL.
  6750         16  CQ-CARRIER              PIC X.
  6751         16  CQ-CLAIM-NO             PIC X(7).
  6752         16  CQ-CERT-NO.
  6753             20  CQ-CERT-PRIME       PIC X(10).
  6754             20  CQ-CERT-SFX         PIC X.
  6755         16  CQ-CLAIM-TYPE           PIC X.
  6756             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6757             88  CQ-AH-CLAIM            VALUE 'A'.
  6758         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6759             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6760             88  CQ-O-B-COVERAGE        VALUE '2'.
  6761             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6762
  6763     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6764     12  CQ-CHECK-NUMBER             PIC X(7).
  6765     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6766     12  CQ-PAYMENT-TYPE             PIC X.
  6767             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6768             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6769             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6770             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6771             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6772             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6773             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6774             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6775     12  CQ-VOID-INDICATOR           PIC X.
  6776             88  CHECK-IS-STOPPED          VALUE 'S'.
  6777             88  CHECK-IS-VOID             VALUE 'V'.
  6778     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6779     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6780     12  CQ-CHECK-BY-USER            PIC X(4).
  6781     12  CQ-PRE-NUMBERING-SW         PIC X.
  6782       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6783       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6784
  6785     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6786     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6787     12  CQ-LEDGER-FLAG              PIC X(01).
  6788     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6789     12  CQ-LAST-UPDATED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 122
* EL131.cbl
  6790     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6791     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6792
  6793     12  FILLER                      PIC X(04).
  6794
  6795******************************************************************
  6796
  6797*                                COPY ELCARCH.
  6798******************************************************************
  6799*                                                                *
  6800*                            ELCARCH.                            *
  6801*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6802*                            VMOD=2.007                          *
  6803*                                                                *
  6804*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6805*                                                                *
  6806*   FILE TYPE = VSAM,KSDS                                        *
  6807*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6808*                                                                *
  6809*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6810*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6811*                                                                *
  6812*   LOG = NO                                                     *
  6813*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6814*                                                                *
  6815*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6816******************************************************************
  6817 01  LETTER-ARCHIVE.
  6818     12  LA-RECORD-ID                PIC XX.
  6819         88  VALID-LA-ID                VALUE 'LA'.
  6820
  6821     12  LA-CONTROL-PRIMARY.
  6822         16  LA-COMPANY-CD           PIC X.
  6823         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6824         16  LA-RECORD-TYPE          PIC X.
  6825             88  LA-HEADER-DATA         VALUE '1'.
  6826             88  LA-ADDRESS-DATA        VALUE '2'.
  6827             88  LA-TEXT-DATA           VALUE '3'.
  6828             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6829         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6830
  6831     12  LA-CONTROL-BY-TYPE.
  6832         16  LA-COMPANY-CD-A1        PIC X.
  6833         16  LA-RECORD-TYPE-A1       PIC X.
  6834         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6835         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6836
  6837     12  LA-TEXT-RECORD.
  6838         16  LA-SKIP-CONTROL         PIC XX.
  6839             88  NO-LINES-SKIPPED       VALUE SPACES.
  6840             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6841         16  LA-TEXT-LINE            PIC X(70).
  6842
  6843     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6844         16  FILLER                  PIC XX.
  6845         16  LA-ADDRESS-LINE         PIC X(30).
  6846         16  FILLER                  PIC X(40).
  6847
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 123
* EL131.cbl
  6848     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6849         16  FILLER                  PIC XX.
  6850         16  LA-CARRIER              PIC X.
  6851         16  LA-CLAIM-NO             PIC X(7).
  6852         16  LA-CERT-NO.
  6853             20  LA-CERT-PRIME       PIC X(10).
  6854             20  LA-CERT-SFX         PIC X.
  6855         16  LA-NO-OF-COPIES         PIC S9.
  6856         16  LA-RESEND-DATE          PIC XX.
  6857         16  LA-PROCESSOR-CD         PIC X(4).
  6858         16  LA-CREATION-DT          PIC XX.
  6859         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6860         16  LA-RESEND-PRINT-DATE    PIC XX.
  6861         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6862         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6863*
  6864* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6865*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6866*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6867*   I        20  LA-DMD-RES-ST           PIC XX.
  6868*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6869*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6870*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6871*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6872*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6873*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6874*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6875*   I        20  LA-DMD-UND-CODE         PIC XX.
  6876*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6877*   V    16  FILLER                  PIC X(15).
  6878* -----
  6879*
  6880* REINSERTED  CSO  MODS
  6881*
  6882         16  FILLER.
  6883             20  FILLER                  PIC X(29).
  6884             20  LA-CSO-LETTER-STATUS    PIC X.
  6885                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6886                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6887                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6888             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6889             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6890*
  6891
  6892     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6893         16  FILLER                  PIC XX.
  6894         16  LA4-CARRIER             PIC X.
  6895         16  LA4-CLAIM-NO            PIC X(7).
  6896         16  LA4-CERT-NO.
  6897             20  LA4-CERT-PRIME      PIC X(10).
  6898             20  LA4-CERT-SFX        PIC X.
  6899         16  LA4-NO-OF-COPIES        PIC S9.
  6900         16  LA4-RESEND-DATE         PIC XX.
  6901         16  LA4-PROCESSOR-CD        PIC X(4).
  6902         16  LA4-CREATION-DT         PIC XX.
  6903         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6904         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6905         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 124
* EL131.cbl
  6906         16  LA4-FORM-TYPE           PIC X.
  6907             88  LA4-INITIAL-FORM    VALUE '1'.
  6908             88  LA4-PROGRESS-FORM   VALUE '2'.
  6909         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6910         16  LA4-STATE               PIC X(02).
  6911         16  FILLER                  PIC X(31).
  6912******************************************************************
  6913
  6914*                                COPY ELCBENE.
  6915******************************************************************
  6916*                                                                *
  6917*                            ELCBENE.                            *
  6918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6919*                            VMOD=2.006                          *
  6920*                                                                *
  6921*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6922*                                                                *
  6923*   FILE TYPE = VSAM,KSDS                                        *
  6924*   RECORD SIZE = 500   RECFORM = FIX                            *
  6925*                                                                *
  6926*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6927*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6928*                                                                *
  6929*   LOG = YES                                                    *
  6930*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6931*                                                                *
  6932*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6933******************************************************************
  6934
  6935 01  BENEFICIARY-MASTER.
  6936     12  BE-RECORD-ID                PIC XX.
  6937         88  VALID-BE-ID                VALUE 'BE'.
  6938
  6939     12  BE-CONTROL-PRIMARY.
  6940         16  BE-COMPANY-CD           PIC X.
  6941         16  BE-RECORD-TYPE          PIC X.
  6942             88  BENEFICIARY-RECORD  VALUE 'B'.
  6943             88  ADJUSTOR-RECORD     VALUE 'A'.
  6944         16  BE-BENEFICIARY          PIC X(10).
  6945     12  BE-CONTROL-BY-NAME.
  6946         16  BE-COMPANY-CD-A1        PIC X.
  6947         16  BE-RECORD-TYPE-A1       PIC X.
  6948         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6949         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6950
  6951     12  BE-LAST-MAINT-DT            PIC XX.
  6952     12  BE-LAST-MAINT-BY            PIC X(4).
  6953     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6954
  6955     12  BE-ADDRESS-DATA.
  6956         16  BE-MAIL-TO-NAME         PIC X(30).
  6957         16  BE-ADDRESS-LINE-1       PIC X(30).
  6958         16  BE-ADDRESS-LINE-2       PIC X(30).
  6959         16  BE-ADDRESS-LINE-3       PIC X(30).
  6960         16  BE-CITY-STATE.
  6961             20  BE-CITY             PIC X(28).
  6962             20  BE-STATE            PIC XX.
  6963         16  BE-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 125
* EL131.cbl
  6964             20  BE-ZIP-PRIME.
  6965                 24  BE-ZIP-1ST      PIC X.
  6966                     88  BE-CANADIAN-POST-CODE
  6967                                         VALUE 'A' THRU 'Z'.
  6968                 24  FILLER          PIC X(4).
  6969             20  BE-ZIP-PLUS4        PIC X(4).
  6970         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6971             20  BE-CAN-POSTAL-1     PIC XXX.
  6972             20  BE-CAN-POSTAL-2     PIC XXX.
  6973             20  FILLER              PIC XXX.
  6974         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6975         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6976
  6977******************************************************************
  6978*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6979*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6980******************************************************************
  6981     12  BE-CARRIER                  PIC X.
  6982
  6983     12  BE-ADDRESS-DATA2.
  6984         16  BE-MAIL-TO-NAME2        PIC X(30).
  6985         16  BE-ADDRESS-LINE-12      PIC X(30).
  6986         16  BE-ADDRESS-LINE-22      PIC X(30).
  6987         16  BE-ADDRESS-LINE-32      PIC X(30).
  6988         16  BE-CITY-STATE2.
  6989             20  BE-CITY2            PIC X(28).
  6990             20  BE-STATE2           PIC XX.
  6991         16  BE-ZIP-CODE2.
  6992             20  BE-ZIP-PRIME2.
  6993                 24  BE-ZIP-1ST2     PIC X.
  6994                     88  BE-CANADIAN-POST-CODE2
  6995                                         VALUE 'A' THRU 'Z'.
  6996                 24  FILLER          PIC X(4).
  6997             20  BE-ZIP-PLUS42       PIC X(4).
  6998         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6999             20  BE-CAN-POSTAL-12    PIC XXX.
  7000             20  BE-CAN-POSTAL-22    PIC XXX.
  7001             20  FILLER              PIC XXX.
  7002         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7003         16  BE-BILLING-STMT-DATA.
  7004             20  BE-BSR              PIC X.
  7005                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7006                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7007             20  BE-BSR-FROM         PIC X(30).
  7008             20  BE-BSR-DEPT         PIC X(30).
  7009             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7010             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7011             20  BE-OUTPUT-TYPE      PIC X.
  7012                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7013                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7014
  7015     12  FILLER                      PIC X(28).
  7016******************************************************************
  7017
  7018*                                COPY ELCDAR.
  7019******************************************************************
  7020*                                                                *
  7021*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 126
* EL131.cbl
  7022*   FILE TYPE = VSAM,KSDS                                        *
  7023*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7024*   BASE CLUSTER = DLYACTV                                       *
  7025*   LOG = YES                                                    *
  7026*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7027*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7028*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7029*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7030*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7031*               BY PROGRAM "LGINFCE".                            *
  7032*                                                                *
  7033******************************************************************
  7034 01  DAILY-ACTIVITY-RECORD.
  7035     05  DA-KEY.
  7036         10  DA-COMP-CD          PIC X.
  7037         10  DA-CARRIER          PIC X.
  7038         10  DA-CLAIM-NO         PIC X(7).
  7039         10  DA-CERT-NO.
  7040             15  DA-CERT-PRIME   PIC X(10).
  7041             15  DA-CERT-SFX     PIC X.
  7042     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7043     05  DA-RECORD-TYPE          PIC X.
  7044     05  FILLER                  PIC X(2).
  7045******************************************************************
  7046
  7047*                                COPY ELCALPH.
  7048******************************************************************
  7049*                                                                *
  7050*                            ELCALPH.                            *
  7051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7052*                            VMOD=2.003                          *
  7053*                                                                *
  7054*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7055*                                                                *
  7056*   FILE TYPE = VSAM,KSDS                                        *
  7057*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7058*                                                                *
  7059*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7060*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7061*                                                                *
  7062*   LOG = YES                                                    *
  7063*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7064*                                                                *
  7065*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7066******************************************************************
  7067
  7068 01  ALPHA-INDEX.
  7069     12  AI-RECORD-ID                         PIC XX.
  7070         88  VALID-AI-ID                  VALUE 'AI'.
  7071     12  AI-CONTROL-PRIMARY.
  7072         16  AI-COMPANY-CD                     PIC X.
  7073         16  AI-SOURCE                         PIC X.
  7074             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7075             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7076         16  AI-NAME.
  7077             20  AI-LAST-NAME                  PIC X(15).
  7078             20  AI-FIRST-NAME.
  7079                 24  AI-FIRST-INITIAL          PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 127
* EL131.cbl
  7080                 24  FILLER                    PIC X(11).
  7081             20  AI-MIDDLE-INIT                PIC X.
  7082         16  AI-DATE                           PIC X(8).
  7083         16  AI-TIME                           PIC S9(07) COMP-3.
  7084
  7085     12  AI-CONTROL-BY-ADMIN-KEY.
  7086         16  AI-CM-COMPANY-CD                  PIC X.
  7087         16  AI-CM-SOURCE                      PIC X.
  7088         16  AI-CM-CARRIER                     PIC X.
  7089         16  AI-CM-GROUPING.
  7090             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7091             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7092         16  AI-CM-STATE                       PIC XX.
  7093         16  AI-CM-PRODUCER.
  7094             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7095             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7096         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7097         16  AI-CM-CERTIFICATE-NUMBER.
  7098             20  AI-CM-CERT-PRIME              PIC X(10).
  7099             20  AI-CM-CERT-SFX                PIC X.
  7100         16  AI-CM-DATE                        PIC X(8).
  7101         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7102         16  FILLER                            PIC X(11).
  7103
  7104     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7105         AI-CONTROL-BY-ADMIN-KEY.
  7106         16  AI-CL-COMPANY-CD                  PIC X.
  7107         16  AI-CL-SOURCE                      PIC X.
  7108         16  AI-CL-CARRIER                     PIC X.
  7109         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7110         16  AI-CL-CERTIFICATE-NUMBER.
  7111             20  AI-CL-CERT-PRIME              PIC X(10).
  7112             20  AI-CL-CERT-SFX                PIC X.
  7113         16  AI-CL-DATE                        PIC X(8).
  7114         16  AI-CL-INCURRED-DATE               PIC XX.
  7115         16  AI-CL-CLOSE-DATE                  PIC XX.
  7116         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7117         16  AI-CREDIT-CARD-NUMBER.
  7118             20  AI-CCN.
  7119                 24  AI-CCN-PREFIX             PIC X(4).
  7120                 24  AI-CCN-PRIME              PIC X(12).
  7121             20  AI-CCN-FILLER                 PIC X(4).
  7122
  7123     12  AI-MAINT-INFO.
  7124         16  AI-LAST-MAINT-BY                  PIC X(4).
  7125         16  AI-LAST-MAINT-DT                  PIC XX.
  7126         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7127
  7128     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7129
  7130     12  FILLER                                PIC X(15).
  7131
  7132
  7133*                                COPY ERCDMDNT.
  7134******************************************************************
  7135*                                                                *
  7136*                            ERCDMDNT                            *
  7137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 128
* EL131.cbl
  7138*                            VMOD=2.005                          *
  7139*                                                                *
  7140*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7141*                                                                *
  7142*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7143*                                                                *
  7144*        FILE TYPE= VSAM,KSDS                                    *
  7145*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7146*                                                                *
  7147*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7148*                                                                *
  7149*        LOG = YES                                               *
  7150*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7151*                                                                *
  7152******************************************************************
  7153
  7154 01  CERTIFICATE-NOTE.
  7155     12  CN-RECORD-ID                     PIC  XX.
  7156         88  VALID-CN-ID                      VALUE 'CN'.
  7157
  7158     12  CN-CONTROL-PRIMARY.
  7159         16  CN-COMPANY-CD                PIC X.
  7160         16  CN-CERT-KEY.
  7161             20  CN-CARRIER               PIC X.
  7162             20  CN-GROUPING.
  7163                 24  CN-GROUPING-PREFIX   PIC XXX.
  7164                 24  CN-GROUPING-PRIME    PIC XXX.
  7165             20  CN-STATE                 PIC XX.
  7166             20  CN-ACCOUNT.
  7167                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7168                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7169             20  CN-CERT-EFF-DT           PIC XX.
  7170             20  CN-CERT-NO.
  7171                 24  CN-CERT-PRIME        PIC X(10).
  7172                 24  CN-CERT-SFX          PIC X.
  7173
  7174     12  CN-BILLING-START-LINE-NO         PIC 99.
  7175     12  CN-BILLING-END-LINE-NO           PIC 99.
  7176
  7177     12  CN-LINES.
  7178         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7179
  7180     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7181         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7182         16  CN-CSI-GENERAL-DATA-AREA.
  7183             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7184
  7185         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7186             CN-CSI-GENERAL-DATA-AREA.
  7187             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7188             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7189             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7190             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7191             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7192             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7193             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7194             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7195             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 129
* EL131.cbl
  7196             20  FILLER                       PIC XX.
  7197             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7198             20  FILLER                       PIC X(38).
  7199
  7200         16  CN-CSI-PRODUCT-DATA-AREA.
  7201             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7202
  7203         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7204             CN-CSI-PRODUCT-DATA-AREA.
  7205             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7206             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7207             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7208             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7209             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7210             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7211             20  FILLER                   PIC XX.
  7212             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7213             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7214             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7215             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7216             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7217             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7218             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7219             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7220             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7221             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7222             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7223             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7224             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7225             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7226             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7227             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7228             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7229             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7230             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7231             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7232             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7233             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7234             20  FILLER                   PIC X(25).
  7235
  7236         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7237             CN-CSI-CREDIT-CARD-DATA.
  7238             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7239             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7240             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7241             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7242             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7243             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7244             20  FILLER                   PIC XX.
  7245             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7246             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7247             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7248             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7249             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7250             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7251             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7252             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7253             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 130
* EL131.cbl
  7254             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7255             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7256             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7257             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7258             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7259             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7260             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7261             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7262             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7263             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7264             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7265             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7266             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7267             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7268             20  FILLER                   PIC X(17).
  7269
  7270         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7271             CN-CSI-FAMILY-LEAVE-DATA.
  7272             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7273             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7274             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7275             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7276             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7277             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7278             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7279             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7280             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7281             20  CN-CSI-SL-INT-ON-PROCEEDS
  7282                                          PIC S9(5)V99  COMP-3.
  7283             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7284             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7285             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7286             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7287             20  CN-CSI-SL-POLICY-BENEFITS
  7288                                          PIC S9(5)V99  COMP-3.
  7289             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7290             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7291             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7292             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7293             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7294             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7295             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7296             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7297             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7298             20  CN-CSI-SL-STATE-NOT      PIC X.
  7299             20  FILLER                   PIC XX.
  7300
  7301         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7302             CN-CSI-SENIOR-LIFE-DATA.
  7303             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7304             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7305             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7306                                          PIC S9(5)V99  COMP-3.
  7307             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7308             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7309             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7310             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7311             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 131
* EL131.cbl
  7312             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7313             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7314             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7315             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7316             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7317             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7318             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7319             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7320             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7321             20  CN-CSI-PP-REPAIR         PIC X.
  7322             20  CN-CSI-PP-REPLACE        PIC X.
  7323             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7324             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7325             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7326             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7327             20  FILLER                   PIC X(5).
  7328
  7329         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7330             CN-CSI-PURCH-PROP-DATA.
  7331             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7332             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7333             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7334             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7335             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7336             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7337             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7338             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7339             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7340             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7341             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7342             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7343             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7344             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7345             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7346             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7347             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7348             20  CN-CSI-EW-REPLACE        PIC X.
  7349             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7350             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7351             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7352             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7353             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7354             20  FILLER                   PIC X(4).
  7355
  7356     12  CN-LAST-MAINT-DT                 PIC XX.
  7357     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7358     12  CN-LAST-MAINT-USER               PIC X(4).
  7359     12  FILLER                           PIC X(6).
  7360
  7361******************************************************************
  7362
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 132
* EL131.cbl
  7364 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7365                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7366                          CONTROL-FILE ACTIVITY-QUE
  7367                          ACCOUNT-MASTER CHECK-QUE
  7368                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7369                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7370                          CERTIFICATE-NOTE.
  7371 0000-DFHEXIT SECTION.
  7372     MOVE '9#                    $   ' TO DFHEIV0.
  7373     MOVE 'EL131' TO DFHEIV1.
  7374     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7375
  7376     IF EIBCALEN = ZERO
  7377         GO TO 8800-UNAUTHORIZED-ACCESS.
  7378
  7379     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7380     MOVE '5'                    TO DC-OPTION-CODE.
  7381     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7382     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7383     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7384     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7385
  7386     IF SAVE-DATE-YY GREATER 70
  7387         MOVE 19                 TO SAVE-DATE-CC
  7388      ELSE
  7389         MOVE 20                 TO SAVE-DATE-CC.
  7390
  7391
  7392* EXEC CICS HANDLE CONDITION
  7393*        PGMIDERR (8820-XCTL-ERROR)
  7394*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7395*        ERROR    (9990-ABEND)
  7396*    END-EXEC.
  7397*    MOVE '"$LI.                 ! " #00007387' TO DFHEIV0
  7398     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7400     MOVE X'2220233030303037333837' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0
  7402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7403
  7404
  7405     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7406     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7407     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7408
  7409     INITIALIZE    EDIT-WORK-AREA.
  7410     MOVE '/'                    TO WORK-SLASH.
  7411     MOVE SPACES                 TO ERROR-SWITCHES.
  7412
  7413     MOVE TRAN-ID                TO TRANS-ID.
  7414     MOVE EIBTRMID               TO PI-TERM.
  7415     MOVE MAP-ID                 TO PI-QUAL.
  7416
  7417     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7418
  7419     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7420         MOVE LOW-VALUES         TO EL131AO
  7421         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 133
* EL131.cbl
  7422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7423         MOVE -1                 TO MAINTL
  7424         GO TO 8110-SEND-DATA.
  7425
  7426     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7427         MOVE LOW-VALUES         TO EL131AO
  7428         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7429         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7430         MOVE 'X'                TO PI-RETURN-CD-1
  7431         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7432         MOVE -1                 TO MAINTL
  7433         IF WS-RETURNED-FROM = XCTL-EL114
  7434             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7435         END-IF
  7436         GO TO 8100-SEND-MAP.
  7437
  7438     IF EIBAID = DFHCLEAR
  7439         GO TO 8200-RETURN-PRIOR.
  7440
  7441     IF PI-PROCESSOR-ID = 'LGXX'
  7442         NEXT SENTENCE
  7443     ELSE
  7444
  7445* EXEC CICS READQ TS
  7446*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7447*            INTO    (SECURITY-CONTROL)
  7448*            LENGTH  (SC-COMM-LENGTH)
  7449*            ITEM    (SC-ITEM)
  7450*        END-EXEC
  7451*    MOVE '*$II   L              ''   #00007432' TO DFHEIV0
  7452     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7453     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7454     MOVE X'2020233030303037343332' TO DFHEIV0(25:11)
  7455     CALL 'kxdfhei1' USING DFHEIV0,
  7456           PI-SECURITY-TEMP-STORE-ID,
  7457           SECURITY-CONTROL,
  7458           SC-COMM-LENGTH,
  7459           SC-ITEM,
  7460           DFHEIV99,
  7461           DFHEIV99
  7462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7463         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7464         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7465         IF NOT DISPLAY-CAP
  7466             MOVE 'READ'               TO  SM-READ
  7467             PERFORM 9995-SECURITY-VIOLATION
  7468             MOVE ER-0070              TO  EMI-ERROR
  7469             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7470             GO TO 8100-SEND-MAP.
  7471
  7472
  7473* EXEC CICS RECEIVE
  7474*        MAP    ('EL131A')
  7475*        MAPSET ('EL131S')
  7476*    END-EXEC.
  7477     MOVE 'EL131A' TO DFHEIV1
  7478     MOVE 'EL131S' TO DFHEIV2
  7479*    MOVE '8"T                   ''   #00007447' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 134
* EL131.cbl
  7480     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7481     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7482     MOVE X'2020233030303037343437' TO DFHEIV0(25:11)
  7483     CALL 'kxdfhei1' USING DFHEIV0,
  7484           DFHEIV1,
  7485           EL131AI,
  7486           DFHEIV99,
  7487           DFHEIV2,
  7488           DFHEIV99,
  7489           DFHEIV99
  7490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7491
  7492
  7493     IF PFKEYL GREATER THAN ZERO
  7494         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7495
  7496     IF SCREEN-ERROR
  7497         MOVE ER-0004 TO EMI-ERROR
  7498         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7499         MOVE -1 TO MAINTL
  7500         GO TO 8110-SEND-DATA.
  7501
  7502     IF EIBAID = DFHPF3
  7503         GO TO 8500-TRLR-MNT.
  7504
  7505     IF EIBAID = DFHPF4
  7506         GO TO 8600-ADDR-MNT.
  7507
  7508     IF EIBAID = DFHPF5
  7509         GO TO 8700-CERT-MNT.
  7510
  7511     IF PI-COMPANY-ID = 'DMD'
  7512       IF EIBAID = DFHPF6
  7513         GO TO 8750-DMD-CLM-FIX.
  7514
  7515     IF EIBAID = DFHPF7
  7516         GO TO 4000-FORCE-ERRORS.
  7517
  7518     IF EIBAID = DFHPF12
  7519         GO TO 8300-GET-HELP.
  7520
  7521     IF EIBAID = DFHPF15
  7522         GO TO 8725-BENEFICIARY-MNT
  7523     END-IF.
  7524
  7525     IF EIBAID = DFHPF23
  7526         GO TO 8810-PF23-ENTERED.
  7527
  7528     IF EIBAID = DFHPF24
  7529         GO TO 8400-RETURN-MASTER.
  7530
  7531     IF EIBAID NOT = DFHENTER
  7532         MOVE ER-0029            TO EMI-ERROR
  7533         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7534         MOVE -1                 TO MAINTL
  7535         GO TO 8110-SEND-DATA.
  7536
  7537     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 135
* EL131.cbl
  7538         MOVE ER-0311            TO EMI-ERROR
  7539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7540         MOVE -1                 TO MAINTL
  7541         GO TO 8110-SEND-DATA.
  7542
  7543     IF MAINTI = 'A'
  7544         GO TO 0500-ADD-ALPHA-ONLY.
  7545
  7546     IF MAINTI = 'N'
  7547         GO TO 0600-CHANGE-NAME.
  7548
  7549     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7550
  7551     IF SCREEN-ERROR
  7552         GO TO 8110-SEND-DATA.
  7553
  7554     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7555         MOVE ER-0276            TO EMI-ERROR
  7556         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7557         MOVE -1                 TO MAINTL
  7558         GO TO 8110-SEND-DATA.
  7559
  7560     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7561
  7562     IF SCREEN-ERROR
  7563         GO TO 8110-SEND-DATA.
  7564
  7565     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7566
  7567     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7568
  7569     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7570         GO TO 8110-SEND-DATA.
  7571
  7572     IF EMI-FATAL-CTR GREATER THAN ZERO
  7573         GO TO 8110-SEND-DATA.
  7574
  7575     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7576
  7577     IF WS-OPEN-CLOSE-SW = 'Y'
  7578         IF PI-LETTER-SW = 'Y'
  7579             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7580             MOVE 'T'            TO  CNTL-REC-TYPE
  7581             MOVE SPACES         TO  CNTL-PROC-ID
  7582             MOVE +0             TO  CNTL-SEQ-NO
  7583
  7584* EXEC CICS READ
  7585*                DATASET   (CNTL-FILE-ID)
  7586*                RIDFLD    (CNTL-KEY)
  7587*                SET       (ADDRESS OF CONTROL-FILE)
  7588*            END-EXEC
  7589*    MOVE '&"S        E          (   #00007542' TO DFHEIV0
  7590     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7592     MOVE X'2020233030303037353432' TO DFHEIV0(25:11)
  7593     CALL 'kxdfhei1' USING DFHEIV0,
  7594           CNTL-FILE-ID,
  7595           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 136
* EL131.cbl
  7596           DFHEIV99,
  7597           CNTL-KEY,
  7598           DFHEIV99,
  7599           DFHEIV99,
  7600           DFHEIV99
  7601     SET ADDRESS OF CONTROL-FILE TO
  7602         DFHEIV20
  7603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7604             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7605
  7606     MOVE ER-0000                TO EMI-ERROR.
  7607     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7608
  7609     MOVE SPACE                  TO MAINTO.
  7610     MOVE -1                     TO MAINTL.
  7611     GO TO 8100-SEND-MAP.
  7612
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 137
* EL131.cbl
  7614 0100-UPDATE-PI.
  7615
  7616     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7617     IF WS-RETURNED-FROM = XCTL-EL114
  7618***sometimes there is crap in positions 7-10 when no code was sele
  7619        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7620          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7621        END-IF
  7622     END-IF.
  7623
  7624     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7625         GO TO 0110-UPDATE-UP.
  7626
  7627     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7628     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7629     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7630     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7631     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7632     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7633     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7634     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7635     GO TO 0120-UPDATE-PI-EXIT.
  7636
  7637 0110-UPDATE-UP.
  7638     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7639     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7640     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7641     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7642     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7643     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7644     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7645     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7646
  7647
  7648* EXEC CICS HANDLE CONDITION
  7649*         QIDERR    (0130-TS-ERROR)
  7650*         ITEMERR   (0130-TS-ERROR)
  7651*    END-EXEC.
  7652*    MOVE '"$N<                  ! # #00007590' TO DFHEIV0
  7653     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7655     MOVE X'2320233030303037353930' TO DFHEIV0(25:11)
  7656     CALL 'kxdfhei1' USING DFHEIV0
  7657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7658
  7659
  7660     IF WS-RETURNED-FROM = XCTL-EL114
  7661
  7662* EXEC CICS READQ TS
  7663*            QUEUE    (PI-KEY)
  7664*            INTO     (EL131AI)
  7665*            LENGTH   (MAP-LENGTH)
  7666*       END-EXEC
  7667*    MOVE '*$I    L              ''   #00007596' TO DFHEIV0
  7668     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7669     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7670     MOVE X'2020233030303037353936' TO DFHEIV0(25:11)
  7671     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 138
* EL131.cbl
  7672           PI-KEY,
  7673           EL131AI,
  7674           MAP-LENGTH,
  7675           DFHEIV99,
  7676           DFHEIV99,
  7677           DFHEIV99
  7678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7679
  7680        IF WS-SAVE-BENEFICIARY > SPACES
  7681            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7682            MOVE +10            TO BENEL
  7683            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7684        END-IF
  7685        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7686     END-IF.
  7687
  7688
  7689* EXEC CICS READQ TS
  7690*         QUEUE    (PI-KEY)
  7691*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7692*         LENGTH   (PI-COMM-LENGTH)
  7693*    END-EXEC.
  7694*    MOVE '*$I    L              ''   #00007610' TO DFHEIV0
  7695     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7696     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7697     MOVE X'2020233030303037363130' TO DFHEIV0(25:11)
  7698     CALL 'kxdfhei1' USING DFHEIV0,
  7699           PI-KEY,
  7700           PROGRAM-INTERFACE-BLOCK,
  7701           PI-COMM-LENGTH,
  7702           DFHEIV99,
  7703           DFHEIV99,
  7704           DFHEIV99
  7705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7706
  7707
  7708
  7709* EXEC CICS DELETEQ TS
  7710*         QUEUE    (PI-KEY)
  7711*    END-EXEC.
  7712*    MOVE '*&                    #   #00007616' TO DFHEIV0
  7713     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7714     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7715     MOVE X'2020233030303037363136' TO DFHEIV0(25:11)
  7716     CALL 'kxdfhei1' USING DFHEIV0,
  7717           PI-KEY,
  7718           DFHEIV99
  7719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7720
  7721
  7722 0120-UPDATE-PI-EXIT.
  7723     EXIT.
  7724
  7725 0130-TS-ERROR.
  7726     MOVE LOW-VALUES             TO EL131AO.
  7727     MOVE ER-0192                TO EMI-ERROR.
  7728
  7729     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 139
* EL131.cbl
  7730
  7731     GO TO 8100-SEND-MAP.
  7732
  7733 0200-TRANS-PF.
  7734     IF EIBAID NOT = DFHENTER
  7735         MOVE 'X'                TO ERROR-SWITCH
  7736         GO TO 0210-EXIT.
  7737
  7738     IF PFKEYI NOT NUMERIC
  7739         MOVE 'X'                TO ERROR-SWITCH
  7740         GO TO 0210-EXIT.
  7741
  7742     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7743
  7744     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7745         MOVE 'X' TO ERROR-SWITCH
  7746         GO TO 0210-EXIT.
  7747
  7748     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7749
  7750 0210-EXIT.
  7751     EXIT.
  7752
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 140
* EL131.cbl
  7754 0500-ADD-ALPHA-ONLY.
  7755******************************************************************
  7756*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7757*    RECORD.                                                     *
  7758******************************************************************
  7759
  7760     IF MLNAMEL = +0 AND
  7761        MFNAMEL = +0 AND
  7762        MMINITL = +0
  7763         MOVE ER-0797                TO  EMI-ERROR
  7764         MOVE -1                     TO  MAINTL
  7765         MOVE AL-UABON               TO  MAINTA
  7766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7767         GO TO 8110-SEND-DATA.
  7768
  7769     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7770     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7771     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7772     MOVE PI-CERT-NO                 TO  CERT-NO.
  7773
  7774
  7775* EXEC CICS READ
  7776*        DATASET   (CLMS-FILE-ID)
  7777*        RIDFLD    (MSTR-KEY)
  7778*        SET       (ADDRESS OF CLAIM-MASTER)
  7779*    END-EXEC.
  7780*    MOVE '&"S        E          (   #00007672' TO DFHEIV0
  7781     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7783     MOVE X'2020233030303037363732' TO DFHEIV0(25:11)
  7784     CALL 'kxdfhei1' USING DFHEIV0,
  7785           CLMS-FILE-ID,
  7786           DFHEIV20,
  7787           DFHEIV99,
  7788           MSTR-KEY,
  7789           DFHEIV99,
  7790           DFHEIV99,
  7791           DFHEIV99
  7792     SET ADDRESS OF CLAIM-MASTER TO
  7793         DFHEIV20
  7794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7795
  7796
  7797
  7798* EXEC CICS GETMAIN
  7799*        SET       (ADDRESS OF ALPHA-INDEX)
  7800*        LENGTH    (ALPH-LENGTH)
  7801*        INITIMG   (GETMAIN-SPACE)
  7802*    END-EXEC.
  7803*    MOVE ',"IL                  $   #00007678' TO DFHEIV0
  7804     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7805     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7806     MOVE X'2020233030303037363738' TO DFHEIV0(25:11)
  7807     CALL 'kxdfhei1' USING DFHEIV0,
  7808           DFHEIV20,
  7809           ALPH-LENGTH,
  7810           GETMAIN-SPACE
  7811     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 141
* EL131.cbl
  7812         DFHEIV20
  7813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7814
  7815
  7816     MOVE 'AI'                       TO  AI-RECORD-ID.
  7817     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7818                                         AI-CL-COMPANY-CD.
  7819     MOVE 'C'                        TO  AI-SOURCE
  7820                                         AI-CL-SOURCE.
  7821
  7822     IF MLNAMEL IS GREATER THAN +0
  7823         MOVE MLNAMEI                TO  AI-LAST-NAME
  7824     ELSE
  7825         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7826
  7827     IF MFNAMEL IS GREATER THAN +0
  7828         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7829     ELSE
  7830         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7831
  7832     IF MMINITL IS GREATER THAN +0
  7833         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7834     ELSE
  7835         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7836
  7837     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7838     MOVE '5'                        TO  DC-OPTION-CODE.
  7839     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7840     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7841     IF BUILD-YEAR IS GREATER THAN 50
  7842         MOVE '19'                   TO  WS-ALPHA-YY-1
  7843         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7844         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7845         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7846     ELSE
  7847         MOVE '20'                   TO  WS-ALPHA-YY-1
  7848         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7849         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7850         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7851
  7852     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7853                                         AI-CL-DATE.
  7854
  7855     MOVE EIBTIME                    TO  AI-TIME
  7856                                         AI-CL-TIME.
  7857
  7858     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7859     MOVE 'C'                        TO  AI-CL-SOURCE.
  7860     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7861     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7862     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7863     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7864     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7865
  7866     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7867     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7868     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7869
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 142
* EL131.cbl
  7870
  7871* EXEC CICS WRITE
  7872*        DATASET   (ALPH-FILE-ID)
  7873*        RIDFLD    (AI-CONTROL-PRIMARY)
  7874*        FROM      (ALPHA-INDEX)
  7875*    END-EXEC.
  7876     MOVE LENGTH OF
  7877      ALPHA-INDEX
  7878       TO DFHEIV11
  7879*    MOVE '&$ L                  ''   #00007738' TO DFHEIV0
  7880     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7881     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7882     MOVE X'2020233030303037373338' TO DFHEIV0(25:11)
  7883     CALL 'kxdfhei1' USING DFHEIV0,
  7884           ALPH-FILE-ID,
  7885           ALPHA-INDEX,
  7886           DFHEIV11,
  7887           AI-CONTROL-PRIMARY,
  7888           DFHEIV99,
  7889           DFHEIV99
  7890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7891
  7892
  7893     MOVE LOW-VALUES                 TO  EL131AO.
  7894     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7895     MOVE ER-0000                    TO  EMI-ERROR.
  7896     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7897     MOVE -1                         TO  MAINTL.
  7898     GO TO 8100-SEND-MAP.
  7899
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 143
* EL131.cbl
  7901 0600-CHANGE-NAME.
  7902******************************************************************
  7903*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7904*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7905******************************************************************
  7906
  7907     IF MLNAMEL = +0 AND
  7908        MFNAMEL = +0 AND
  7909        MMINITL = +0
  7910         MOVE ER-0276                TO  EMI-ERROR
  7911         MOVE -1                     TO  MAINTL
  7912         MOVE AL-UABON               TO  MAINTA
  7913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7914         GO TO 8110-SEND-DATA.
  7915
  7916     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7917     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7918     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7919     MOVE PI-CERT-NO                 TO  CERT-NO.
  7920
  7921
  7922* EXEC CICS READ
  7923*        DATASET   (CLMS-FILE-ID)
  7924*        RIDFLD    (MSTR-KEY)
  7925*        SET       (ADDRESS OF CLAIM-MASTER)
  7926*    END-EXEC.
  7927*    MOVE '&"S        E          (   #00007772' TO DFHEIV0
  7928     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7930     MOVE X'2020233030303037373732' TO DFHEIV0(25:11)
  7931     CALL 'kxdfhei1' USING DFHEIV0,
  7932           CLMS-FILE-ID,
  7933           DFHEIV20,
  7934           DFHEIV99,
  7935           MSTR-KEY,
  7936           DFHEIV99,
  7937           DFHEIV99,
  7938           DFHEIV99
  7939     SET ADDRESS OF CLAIM-MASTER TO
  7940         DFHEIV20
  7941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7942
  7943
  7944
  7945* EXEC CICS GETMAIN
  7946*        SET       (ADDRESS OF ALPHA-INDEX)
  7947*        LENGTH    (ALPH-LENGTH)
  7948*        INITIMG   (GETMAIN-SPACE)
  7949*    END-EXEC.
  7950*    MOVE ',"IL                  $   #00007778' TO DFHEIV0
  7951     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7952     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7953     MOVE X'2020233030303037373738' TO DFHEIV0(25:11)
  7954     CALL 'kxdfhei1' USING DFHEIV0,
  7955           DFHEIV20,
  7956           ALPH-LENGTH,
  7957           GETMAIN-SPACE
  7958     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 144
* EL131.cbl
  7959         DFHEIV20
  7960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7961
  7962
  7963     MOVE 'AI'                       TO  AI-RECORD-ID.
  7964     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7965                                         AI-CL-COMPANY-CD.
  7966     MOVE 'C'                        TO  AI-SOURCE
  7967                                         AI-CL-SOURCE.
  7968
  7969     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7970     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7971     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7972
  7973     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7974     MOVE '5'                        TO  DC-OPTION-CODE.
  7975     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7976     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7977     IF BUILD-YEAR IS GREATER THAN 50
  7978         MOVE '19'                   TO  WS-ALPHA-YY-1
  7979         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7980         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7981         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7982     ELSE
  7983         MOVE '20'                   TO  WS-ALPHA-YY-1
  7984         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7985         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7986         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7987
  7988     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7989                                         AI-CL-DATE.
  7990
  7991     MOVE EIBTIME                    TO  AI-TIME
  7992                                         AI-CL-TIME.
  7993
  7994     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7995     MOVE 'C'                        TO  AI-CL-SOURCE.
  7996     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7997     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7998     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7999     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8000     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8001
  8002     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8003     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8004     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8005
  8006     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8007         MOVE 'Y'                TO CL-YESNOSW
  8008     END-IF.
  8009
  8010
  8011* EXEC CICS WRITE
  8012*        DATASET   (ALPH-FILE-ID)
  8013*        RIDFLD    (AI-CONTROL-PRIMARY)
  8014*        FROM      (ALPHA-INDEX)
  8015*    END-EXEC.
  8016     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 145
* EL131.cbl
  8017      ALPHA-INDEX
  8018       TO DFHEIV11
  8019*    MOVE '&$ L                  ''   #00007831' TO DFHEIV0
  8020     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8022     MOVE X'2020233030303037383331' TO DFHEIV0(25:11)
  8023     CALL 'kxdfhei1' USING DFHEIV0,
  8024           ALPH-FILE-ID,
  8025           ALPHA-INDEX,
  8026           DFHEIV11,
  8027           AI-CONTROL-PRIMARY,
  8028           DFHEIV99,
  8029           DFHEIV99
  8030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8031
  8032
  8033
  8034* EXEC CICS READ
  8035*        DATASET   (CLMS-FILE-ID)
  8036*        RIDFLD    (MSTR-KEY)
  8037*        SET       (ADDRESS OF CLAIM-MASTER)
  8038*        UPDATE
  8039*    END-EXEC.
  8040*    MOVE '&"S        EU         (   #00007837' TO DFHEIV0
  8041     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8042     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8043     MOVE X'2020233030303037383337' TO DFHEIV0(25:11)
  8044     CALL 'kxdfhei1' USING DFHEIV0,
  8045           CLMS-FILE-ID,
  8046           DFHEIV20,
  8047           DFHEIV99,
  8048           MSTR-KEY,
  8049           DFHEIV99,
  8050           DFHEIV99,
  8051           DFHEIV99
  8052     SET ADDRESS OF CLAIM-MASTER TO
  8053         DFHEIV20
  8054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8055
  8056
  8057     if (cl-priority-cd = '8')
  8058        and (pi-processor-id not = 'PEMA'and 'JMS '
  8059             AND 'AMWA' AND 'KMSB')
  8060        MOVE ER-8003             TO EMI-ERROR
  8061        PERFORM 9900-ERROR-FORMAT
  8062                                 THRU 9900-EXIT
  8063        MOVE -1                  TO MAINTL
  8064        GO TO 8110-SEND-DATA
  8065     end-if
  8066
  8067     IF MLNAMEL IS GREATER THAN +0
  8068         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8069
  8070     IF MFNAMEL IS GREATER THAN +0
  8071         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8072
  8073     IF MMINITL IS GREATER THAN +0
  8074         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 146
* EL131.cbl
  8075
  8076     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8077     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8078     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8079     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8080
  8081     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8082         MOVE 'Y'                TO CL-YESNOSW
  8083     END-IF.
  8084
  8085
  8086* EXEC CICS HANDLE CONDITION
  8087*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8088*    END-EXEC.
  8089*    MOVE '"$$                   ! $ #00007872' TO DFHEIV0
  8090     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8092     MOVE X'2420233030303037383732' TO DFHEIV0(25:11)
  8093     CALL 'kxdfhei1' USING DFHEIV0
  8094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8095
  8096
  8097
  8098* EXEC CICS REWRITE
  8099*        DATASET   (CLMS-FILE-ID)
  8100*        FROM      (CLAIM-MASTER)
  8101*    END-EXEC.
  8102     MOVE LENGTH OF
  8103      CLAIM-MASTER
  8104       TO DFHEIV11
  8105*    MOVE '&& L                  %   #00007876' TO DFHEIV0
  8106     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8107     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8108     MOVE X'2020233030303037383736' TO DFHEIV0(25:11)
  8109     CALL 'kxdfhei1' USING DFHEIV0,
  8110           CLMS-FILE-ID,
  8111           CLAIM-MASTER,
  8112           DFHEIV11,
  8113           DFHEIV99
  8114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8115
  8116
  8117 0600-CONTINUE-NAME-UPDATE.
  8118
  8119     MOVE LOW-VALUES                 TO  EL131AO.
  8120     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8121     MOVE ER-0000                    TO  EMI-ERROR.
  8122     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8123     MOVE -1                         TO  MAINTL.
  8124     GO TO 8100-SEND-MAP.
  8125
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 147
* EL131.cbl
  8127 1000-EDIT-SCREEN.
  8128
  8129     MOVE MAINTI                 TO CHECK-MAINT.
  8130
  8131     IF NOT VALID-OPTIONS
  8132         MOVE 'X'                TO ERROR-SWITCH
  8133         MOVE -1                 TO MAINTL
  8134         MOVE AL-UABON           TO MAINTA
  8135         MOVE ER-0023            TO EMI-ERROR
  8136         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8137         GO TO 1010-EXIT.
  8138
  8139     IF NOT MODIFY-CAP
  8140         MOVE 'UPDATE'           TO  SM-READ
  8141         PERFORM 9995-SECURITY-VIOLATION
  8142         MOVE ER-0070               TO  EMI-ERROR
  8143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8144         GO TO 8100-SEND-MAP.
  8145
  8146     IF DELETE-CLAIM
  8147         MOVE AL-UANON TO MAINTA
  8148         GO TO 1010-EXIT.
  8149
  8150     MOVE AL-UANON               TO MAINTA.
  8151
  8152     IF CCNOI GREATER THAN LOW-VALUES
  8153         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8154
  8155     IF PI-COMPANY-ID = 'CSL'
  8156        CONTINUE
  8157     ELSE
  8158        IF TYPEL > ZERO
  8159           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8160              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8161                    PI-LIFE-OVERRIDE-L1))
  8162                       OR
  8163              ((PI-COMPANY-ID = 'DCC')
  8164              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8165                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  8166              MOVE AL-UANON      TO TYPEA
  8167              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8168           ELSE
  8169              MOVE ER-0199       TO EMI-ERROR
  8170              PERFORM 9900-ERROR-FORMAT
  8171                                 THRU 9900-EXIT
  8172              MOVE AL-UABON      TO TYPEA
  8173              MOVE -1            TO TYPEL
  8174              MOVE 'X'           TO ERROR-SWITCH
  8175           END-IF
  8176        ELSE
  8177           MOVE AL-UANOF         TO TYPEA
  8178        END-IF
  8179     END-IF
  8180     IF STATUSI GREATER THAN LOW-VALUES
  8181         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8182             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8183             MOVE AL-UANON       TO STATUSA
  8184             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 148
* EL131.cbl
  8185             MOVE 'Y'            TO DLYACTV-SW
  8186         ELSE
  8187             MOVE ER-0333        TO EMI-ERROR
  8188             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8189             MOVE AL-UABON       TO STATUSA
  8190             MOVE -1             TO STATUSL
  8191             MOVE 'X'            TO ERROR-SWITCH
  8192         END-IF
  8193     ELSE
  8194         MOVE SPACE              TO TRLR-SWITCH
  8195         MOVE 'N'                TO DLYACTV-SW
  8196         MOVE AL-UANOF           TO STATUSA.
  8197
  8198     IF PROCI GREATER THAN LOW-VALUES
  8199         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8200     ELSE
  8201         MOVE AL-UANOF TO PROCA.
  8202
  8203     IF SEXI GREATER THAN LOW-VALUES
  8204         IF SEXI = 'F' OR 'M'
  8205             MOVE AL-UANON       TO SEXA
  8206             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8207           ELSE
  8208             MOVE ER-0219        TO EMI-ERROR
  8209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8210             MOVE AL-UABON       TO SEXA
  8211             MOVE -1             TO SEXL
  8212             MOVE 'X'            TO ERROR-SWITCH
  8213       ELSE
  8214         MOVE AL-UANOF           TO SEXA.
  8215
  8216     IF BIRTHL = +0
  8217         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8218         MOVE AL-UANOF           TO  BIRTHA
  8219         GO TO 1000-CONTINUE-EDITS.
  8220
  8221     IF BIRTHI = SPACES
  8222         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8223         MOVE 'X'                TO  UPDATE-SWITCH
  8224                                     MSTR-SWITCH
  8225         GO TO 1000-CONTINUE-EDITS.
  8226
  8227     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8228     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8229     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8230     MOVE '4'                    TO  DC-OPTION-CODE.
  8231     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8232     IF DATE-CONVERSION-ERROR
  8233         MOVE ER-0220            TO  EMI-ERROR
  8234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8235         MOVE AL-UABON           TO  BIRTHA
  8236         MOVE -1                 TO  BIRTHL
  8237         MOVE 'X'                TO  ERROR-SWITCH
  8238         GO TO 1000-CONTINUE-EDITS.
  8239
  8240******************************************************************
  8241**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8242**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 149
* EL131.cbl
  8243**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8244******************************************************************
  8245     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8246         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8247         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8248         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8249         MOVE '4'                TO  DC-OPTION-CODE
  8250         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8251         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8252                                     DC-ELAPSED-DAYS
  8253         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8254         IF DATE-CONVERSION-ERROR
  8255             MOVE ER-0220        TO  EMI-ERROR
  8256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8257             MOVE AL-UABON       TO  BIRTHA
  8258             MOVE -1             TO  BIRTHL
  8259             MOVE 'X'            TO  ERROR-SWITCH
  8260             GO TO 1000-CONTINUE-EDITS.
  8261
  8262     MOVE AL-UANON               TO  BIRTHA.
  8263     MOVE 'X'                    TO  UPDATE-SWITCH
  8264                                     MSTR-SWITCH.
  8265     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8266     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8267     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8268
  8269 1000-CONTINUE-EDITS.
  8270
  8271     IF SOCIALI GREATER THAN LOW-VALUES
  8272         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8273         IF WS-SOC-SEC-NO NUMERIC AND
  8274           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8275             NEXT SENTENCE
  8276         ELSE
  8277            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8278               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8279               WS-SSN-DASH2 = '-'
  8280                 NEXT SENTENCE
  8281            ELSE
  8282                 MOVE ER-0887        TO  EMI-ERROR
  8283                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8284                 MOVE AL-UABON       TO  SOCIALA
  8285                 MOVE -1             TO  SOCIALL
  8286                 MOVE 'X'            TO  ERROR-SWITCH
  8287            END-IF
  8288        END-IF
  8289     END-IF.
  8290
  8291     IF SOCIALI GREATER THAN LOW-VALUES
  8292         MOVE AL-UANON           TO SOCIALA
  8293         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8294     ELSE
  8295         MOVE AL-UANOF           TO SOCIALA.
  8296
  8297     IF OCCI GREATER THAN LOW-VALUES
  8298         MOVE AL-UANON           TO OCCA
  8299         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8300     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 150
* EL131.cbl
  8301         MOVE AL-UANOF           TO OCCA.
  8302
  8303     IF BENEL NOT GREATER THAN ZERO
  8304            GO TO 1005-CONTINUE-EDITS.
  8305
  8306     IF BENEI = SPACES
  8307        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8308           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8309           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8310           IF AUTO-PAY-TO-BENE = 'Y'
  8311               MOVE ER-1773      TO  EMI-ERROR
  8312               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8313               MOVE 'X'          TO ERROR-SWITCH
  8314               MOVE AL-UABON     TO BENEA
  8315               MOVE -1           TO BENEL
  8316           ELSE
  8317               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8318           END-IF
  8319        ELSE
  8320           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8321        END-IF
  8322        GO TO 1005-CONTINUE-EDITS.
  8323
  8324
  8325* EXEC CICS HANDLE CONDITION
  8326*        NOTFND (1004-BENE-NOT-FOUND)
  8327*    END-EXEC.
  8328*    MOVE '"$I                   ! % #00008088' TO DFHEIV0
  8329     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8331     MOVE X'2520233030303038303838' TO DFHEIV0(25:11)
  8332     CALL 'kxdfhei1' USING DFHEIV0
  8333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8334
  8335
  8336     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8337     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8338     MOVE BENEI                  TO  WS-ELBENE-ID.
  8339
  8340
  8341* EXEC CICS READ
  8342*        DATASET ('ELBENE')
  8343*        RIDFLD  (WS-ELBENE-KEY)
  8344*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8345*    END-EXEC.
  8346     MOVE 'ELBENE' TO DFHEIV1
  8347*    MOVE '&"S        E          (   #00008096' TO DFHEIV0
  8348     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8349     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8350     MOVE X'2020233030303038303936' TO DFHEIV0(25:11)
  8351     CALL 'kxdfhei1' USING DFHEIV0,
  8352           DFHEIV1,
  8353           DFHEIV20,
  8354           DFHEIV99,
  8355           WS-ELBENE-KEY,
  8356           DFHEIV99,
  8357           DFHEIV99,
  8358           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 151
* EL131.cbl
  8359     SET ADDRESS OF BENEFICIARY-MASTER TO
  8360         DFHEIV20
  8361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8362
  8363
  8364     MOVE AL-UANON               TO  BENEA.
  8365     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8366
  8367     GO TO 1005-CONTINUE-EDITS.
  8368
  8369 1004-BENE-NOT-FOUND.
  8370     MOVE ER-0565                TO  EMI-ERROR.
  8371
  8372     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8373     MOVE 'X'                    TO ERROR-SWITCH.
  8374     MOVE AL-UABON               TO BENEA.
  8375     MOVE -1                     TO BENEL.
  8376
  8377 1005-CONTINUE-EDITS.
  8378
  8379     IF DIAGI GREATER THAN LOW-VALUES
  8380         MOVE AL-UANON           TO DIAGA
  8381         MOVE 'X'                TO UPDATE-SWITCH
  8382                                    NINETY-TRLR-SWITCH
  8383     ELSE
  8384         MOVE AL-UANOF           TO DIAGA.
  8385
  8386     IF ICD1I GREATER THAN LOW-VALUES
  8387         IF (ICD1I GREATER THAN SPACES) AND
  8388            (ICD1I(4:1) NOT = '.')
  8389             IF ICD1I(4:1) = ' '
  8390                 MOVE '.' TO ICD1I(4:1)
  8391             ELSE
  8392                 IF ICD1I(8:1) = ' '
  8393                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8394                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8395                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8396                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8397                     MOVE '.'        TO ICD1I(4:1)
  8398                 END-IF
  8399             END-IF
  8400         END-IF
  8401         IF (ICD1I GREATER THAN SPACES) AND
  8402            (ICD1I(1:1) NOT > ' ' OR
  8403             ICD1I(2:1) NOT > ' ' OR
  8404             ICD1I(3:1) NOT > ' ' OR
  8405             ICD1I(4:1) NOT = '.')
  8406              MOVE ER-0992        TO  EMI-ERROR
  8407              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8408              MOVE 'X'            TO ERROR-SWITCH
  8409              MOVE AL-UABON       TO ICD1A
  8410              MOVE -1             TO ICD1L
  8411         ELSE
  8412             MOVE AL-UANON       TO ICD1A
  8413             MOVE 'X'            TO UPDATE-SWITCH
  8414                                    NINETY-TRLR-SWITCH
  8415         END-IF
  8416     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 152
* EL131.cbl
  8417         MOVE AL-UANOF           TO ICD1A
  8418     END-IF.
  8419
  8420     IF ICD2I GREATER THAN LOW-VALUES
  8421         IF (ICD2I GREATER THAN SPACES) AND
  8422            (ICD2I(4:1) NOT = '.')
  8423             IF ICD2I(4:1) = ' '
  8424                 MOVE '.' TO ICD2I(4:1)
  8425             ELSE
  8426                 IF ICD2I(8:1) = ' '
  8427                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8428                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8429                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8430                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8431                     MOVE '.'        TO ICD2I(4:1)
  8432                 END-IF
  8433             END-IF
  8434         END-IF
  8435         IF (ICD2I GREATER THAN SPACES) AND
  8436            (ICD2I(1:1) NOT > ' ' OR
  8437             ICD2I(2:1) NOT > ' ' OR
  8438             ICD2I(3:1) NOT > ' ' OR
  8439             ICD2I(4:1) NOT = '.')
  8440              MOVE ER-0992        TO EMI-ERROR
  8441              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8442              MOVE 'X'            TO ERROR-SWITCH
  8443              MOVE AL-UABON       TO ICD2A
  8444              MOVE -1             TO ICD2L
  8445         ELSE
  8446             MOVE AL-UANON       TO ICD2A
  8447             MOVE 'X'            TO UPDATE-SWITCH
  8448                                    NINETY-TRLR-SWITCH
  8449         END-IF
  8450     ELSE
  8451         MOVE AL-UANOF           TO ICD2A
  8452     END-IF.
  8453
  8454*    IF CAUSEI GREATER THAN LOW-VALUES
  8455*        MOVE AL-UANON           TO CAUSEA
  8456*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8457*    ELSE
  8458*        MOVE AL-UANOF           TO CAUSEA.
  8459
  8460*    IF ENDL GREATER THAN ZERO
  8461*        MOVE LOW-VALUES         TO HOLD-END
  8462*        IF ENDI = SPACES
  8463*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8464*        ELSE
  8465*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8466*            EXEC CICS BIF DEEDIT
  8467*                FIELD    (DEEDIT-DATE-INPUT)
  8468*                LENGTH   (DATE-LENGTH)
  8469*            END-EXEC
  8470*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8471*            MOVE '4'            TO DC-OPTION-CODE
  8472*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8473*            IF NOT DATE-CONVERSION-ERROR
  8474*                MOVE DC-BIN-DATE-1      TO HOLD-END
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 153
* EL131.cbl
  8475*                MOVE AL-UANON   TO ENDA
  8476*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8477*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8478*            ELSE
  8479*                MOVE ER-0224    TO EMI-ERROR
  8480*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8481*                MOVE AL-UABON   TO ENDA
  8482*                MOVE -1         TO ENDL
  8483*                MOVE 'X'        TO ERROR-SWITCH
  8484*      ELSE
  8485*          MOVE AL-UANOF         TO ENDA.
  8486
  8487     IF INCL GREATER THAN ZERO
  8488         MOVE LOW-VALUES         TO HOLD-INCUR
  8489         IF INCI = SPACES
  8490             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8491         ELSE
  8492             MOVE INCI           TO DEEDIT-DATE-INPUT
  8493
  8494* EXEC CICS BIF DEEDIT
  8495*                FIELD    (DEEDIT-DATE-INPUT)
  8496*                LENGTH   (DATE-LENGTH)
  8497*            END-EXEC
  8498*    MOVE '@"L                   #   #00008231' TO DFHEIV0
  8499     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8500     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8501     MOVE X'2020233030303038323331' TO DFHEIV0(25:11)
  8502     CALL 'kxdfhei1' USING DFHEIV0,
  8503           DEEDIT-DATE-INPUT,
  8504           DATE-LENGTH
  8505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8506             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8507             MOVE '4'            TO DC-OPTION-CODE
  8508             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8509             IF NOT DATE-CONVERSION-ERROR
  8510                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8511                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8512                 MOVE AL-UANON           TO INCA
  8513                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8514             ELSE
  8515                 MOVE ER-0222    TO EMI-ERROR
  8516                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8517                 MOVE AL-UABON   TO INCA
  8518                 MOVE -1         TO INCL
  8519                 MOVE 'X'        TO ERROR-SWITCH
  8520       ELSE
  8521           IF PI-NO-PMTS = ZEROS
  8522               MOVE AL-UANOF     TO INCA.
  8523
  8524     IF REPL GREATER THAN ZERO
  8525         MOVE LOW-VALUES         TO HOLD-REPORTED
  8526         IF REPI = SPACES
  8527             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8528         ELSE
  8529             MOVE REPI           TO DEEDIT-DATE-INPUT
  8530
  8531* EXEC CICS BIF DEEDIT
  8532*                FIELD    (DEEDIT-DATE-INPUT)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 154
* EL131.cbl
  8533*                LENGTH   (DATE-LENGTH)
  8534*            END-EXEC
  8535*    MOVE '@"L                   #   #00008259' TO DFHEIV0
  8536     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8537     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8538     MOVE X'2020233030303038323539' TO DFHEIV0(25:11)
  8539     CALL 'kxdfhei1' USING DFHEIV0,
  8540           DEEDIT-DATE-INPUT,
  8541           DATE-LENGTH
  8542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8543             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8544             MOVE '4'            TO DC-OPTION-CODE
  8545             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8546             IF NOT DATE-CONVERSION-ERROR
  8547                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8548                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8549                 MOVE AL-UANON   TO REPA
  8550                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8551             ELSE
  8552                 MOVE ER-0223    TO EMI-ERROR
  8553                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8554                 MOVE AL-UABON   TO REPA
  8555                 MOVE -1         TO REPL
  8556                 MOVE 'X'        TO ERROR-SWITCH
  8557       ELSE
  8558         MOVE AL-UANOF TO REPA.
  8559
  8560     IF PDTHRUI GREATER THAN LOW-VALUES
  8561        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8562        IF PDTHRUI = SPACES
  8563           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8564        ELSE
  8565           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8566
  8567* EXEC CICS BIF DEEDIT
  8568*               FIELD    (DEEDIT-DATE-INPUT)
  8569*               LENGTH   (DATE-LENGTH)
  8570*          END-EXEC
  8571*    MOVE '@"L                   #   #00008286' TO DFHEIV0
  8572     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8573     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8574     MOVE X'2020233030303038323836' TO DFHEIV0(25:11)
  8575     CALL 'kxdfhei1' USING DFHEIV0,
  8576           DEEDIT-DATE-INPUT,
  8577           DATE-LENGTH
  8578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8579           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8580           MOVE '4'            TO DC-OPTION-CODE
  8581           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8582           IF NOT DATE-CONVERSION-ERROR
  8583              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8584              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8585              MOVE AL-UANON   TO PDTHRUA
  8586              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8587              IF PI-USES-PAID-TO
  8588                 MOVE '6'            TO DC-OPTION-CODE
  8589                 MOVE -1             TO DC-ELAPSED-DAYS
  8590                 MOVE +0             TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 155
* EL131.cbl
  8591                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8592                 IF NO-CONVERSION-ERROR
  8593                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8594                 ELSE
  8595                    NEXT SENTENCE
  8596              ELSE
  8597                 NEXT SENTENCE
  8598           ELSE
  8599              MOVE ER-0475    TO EMI-ERROR
  8600              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8601              MOVE AL-UABON   TO PDTHRUA
  8602              MOVE -1         TO PDTHRUL
  8603              MOVE 'X'        TO ERROR-SWITCH
  8604     ELSE
  8605        IF MODIFY-CAP
  8606           MOVE AL-UANOF        TO PDTHRUA.
  8607
  8608     IF PDAMTL GREATER THAN +0
  8609         MOVE ZEROS              TO HOLD-PDAMT
  8610
  8611* EXEC CICS BIF DEEDIT
  8612*            FIELD    (PDAMTI)
  8613*            LENGTH   (9)
  8614*        END-EXEC
  8615     MOVE 9
  8616       TO DFHEIV11
  8617*    MOVE '@"L                   #   #00008321' TO DFHEIV0
  8618     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8619     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8620     MOVE X'2020233030303038333231' TO DFHEIV0(25:11)
  8621     CALL 'kxdfhei1' USING DFHEIV0,
  8622           PDAMTI,
  8623           DFHEIV11
  8624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8625         IF PDAMTI NUMERIC
  8626             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8627             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8628             MOVE AL-UNNON       TO PDAMTA
  8629         ELSE
  8630             MOVE ER-0547        TO EMI-ERROR
  8631             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8632             MOVE AL-UNBON       TO PDAMTA
  8633             MOVE -1             TO PDAMTL
  8634             MOVE 'X'            TO ERROR-SWITCH
  8635     ELSE
  8636         IF MODIFY-CAP
  8637            MOVE AL-UNNOF        TO PDAMTA.
  8638
  8639     IF NODAYSI GREATER THAN LOW-VALUES
  8640         MOVE ZEROS              TO HOLD-NODAYS
  8641
  8642* EXEC CICS BIF DEEDIT
  8643*            FIELD (NODAYSI)
  8644*            LENGTH (5)
  8645*        END-EXEC
  8646     MOVE 5
  8647       TO DFHEIV11
  8648*    MOVE '@"L                   #   #00008341' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 156
* EL131.cbl
  8649     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8650     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8651     MOVE X'2020233030303038333431' TO DFHEIV0(25:11)
  8652     CALL 'kxdfhei1' USING DFHEIV0,
  8653           NODAYSI,
  8654           DFHEIV11
  8655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8656         IF NODAYSI NUMERIC
  8657             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8658             MOVE AL-UNNON       TO NODAYSA
  8659             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8660         ELSE
  8661             MOVE ER-0491        TO EMI-ERROR
  8662             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8663             MOVE AL-UNBON       TO NODAYSA
  8664             MOVE -1             TO NODAYSL
  8665             MOVE 'X'            TO ERROR-SWITCH
  8666     ELSE
  8667         IF MODIFY-CAP
  8668            MOVE AL-UNNOF        TO NODAYSA.
  8669
  8670     IF NOPMTSI GREATER THAN LOW-VALUES
  8671         MOVE ZEROS              TO HOLD-NOPMTS
  8672
  8673* EXEC CICS BIF DEEDIT
  8674*            FIELD (NOPMTSI)
  8675*            LENGTH (4)
  8676*        END-EXEC
  8677     MOVE 4
  8678       TO DFHEIV11
  8679*    MOVE '@"L                   #   #00008361' TO DFHEIV0
  8680     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8681     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8682     MOVE X'2020233030303038333631' TO DFHEIV0(25:11)
  8683     CALL 'kxdfhei1' USING DFHEIV0,
  8684           NOPMTSI,
  8685           DFHEIV11
  8686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8687         IF NOPMTSI NUMERIC
  8688             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8689             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8690             MOVE AL-UNNON       TO NOPMTSA
  8691           ELSE
  8692             MOVE ER-0548        TO EMI-ERROR
  8693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8694             MOVE AL-UNBON       TO NOPMTSA
  8695             MOVE -1             TO NOPMTSL
  8696             MOVE 'X'            TO ERROR-SWITCH
  8697       ELSE
  8698         IF MODIFY-CAP
  8699            MOVE AL-UNNOF        TO NOPMTSA.
  8700
  8701     IF FORMTYPI GREATER THAN LOW-VALUES
  8702         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8703             MOVE AL-UANON       TO FORMTYPA
  8704             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8705           ELSE
  8706             MOVE ER-7650        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 157
* EL131.cbl
  8707             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8708             MOVE AL-UABON       TO FORMTYPA
  8709             MOVE -1             TO FORMTYPL
  8710             MOVE 'X'            TO ERROR-SWITCH
  8711       ELSE
  8712         MOVE AL-UANOF           TO FORMTYPA.
  8713
  8714     IF PRICDL GREATER THAN ZERO
  8715         IF (PRICDI = ' ') OR
  8716            (PRICDI GREATER THAN ZERO   AND
  8717             PRICDI NOT GREATER THAN '9')
  8718             MOVE AL-UANON       TO PRICDA
  8719             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8720         ELSE
  8721             MOVE ER-0274        TO EMI-ERROR
  8722             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8723             MOVE AL-UABON       TO PRICDA
  8724             MOVE -1             TO PRICDL
  8725             MOVE 'X'            TO ERROR-SWITCH
  8726     ELSE
  8727         MOVE AL-UANOF TO PRICDA.
  8728
  8729     IF PI-COMPANY-ID = 'DMD'
  8730     IF PRICDL GREATER THAN ZERO
  8731       IF SYSTEM-MODIFY-CAP  OR
  8732          PI-PROCESSOR-ID = 'LGXX'
  8733             NEXT SENTENCE
  8734           ELSE
  8735            IF CL-PRIORITY-CD = '9'  OR
  8736               PRICDI         = '9'
  8737                  MOVE ER-0938        TO EMI-ERROR
  8738                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8739                  MOVE AL-UABON       TO PRICDA
  8740                  MOVE -1             TO PRICDL
  8741                  MOVE 'X'            TO ERROR-SWITCH.
  8742
  8743     IF FILETOL GREATER THAN ZERO
  8744         MOVE AL-UANON           TO FILETOA
  8745         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8746     ELSE
  8747         MOVE AL-UANOF TO FILETOA.
  8748
  8749     IF SUPVL GREATER THAN ZERO
  8750         IF SUPVI = 'Y' OR 'N' OR SPACE
  8751             MOVE AL-UANON       TO SUPVA
  8752             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8753         ELSE
  8754             MOVE ER-0230        TO EMI-ERROR
  8755             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8756             MOVE AL-UABON       TO SUPVA
  8757             MOVE -1             TO SUPVL
  8758             MOVE 'X'            TO ERROR-SWITCH
  8759     ELSE
  8760         MOVE AL-UANOF           TO SUPVA.
  8761
  8762     IF MLNAMEL GREATER THAN ZERO
  8763         IF MLNAMEI GREATER THAN SPACES
  8764            MOVE AL-UANON        TO MLNAMEA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 158
* EL131.cbl
  8765            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8766                                     MSTR-KEY-SWITCH
  8767         ELSE
  8768            MOVE ER-0236         TO EMI-ERROR
  8769            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8770            MOVE AL-UABON        TO MLNAMEA
  8771            MOVE -1              TO MLNAMEL
  8772            MOVE 'X'             TO ERROR-SWITCH
  8773     ELSE
  8774         MOVE AL-UANOF           TO MLNAMEA.
  8775
  8776     IF MFNAMEI GREATER THAN LOW-VALUES
  8777         MOVE AL-UANON           TO MFNAMEA
  8778         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8779     ELSE
  8780         MOVE AL-UANOF           TO MFNAMEA.
  8781
  8782     IF MMINITI GREATER THAN LOW-VALUES
  8783         MOVE AL-UANON           TO MMINITA
  8784         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8785     ELSE
  8786         MOVE AL-UANOF           TO MMINITA.
  8787
  8788     IF CRTLNMEI GREATER THAN LOW-VALUES
  8789         IF CRTLNMEI NOT = SPACES
  8790            MOVE AL-UANON        TO CRTLNMEA
  8791            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8792                                     CERT-KEY-SWITCH
  8793        ELSE
  8794            MOVE ER-0236         TO EMI-ERROR
  8795            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8796            MOVE AL-UABON        TO CRTLNMEA
  8797            MOVE -1              TO CRTLNMEL
  8798            MOVE 'X'             TO ERROR-SWITCH
  8799     ELSE
  8800         MOVE AL-UANOF           TO CRTLNMEA.
  8801
  8802     IF CRTFNMEI GREATER THAN LOW-VALUES
  8803         MOVE AL-UANON           TO CRTFNMEA
  8804         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8805     ELSE
  8806         MOVE AL-UANOF           TO CRTFNMEA.
  8807
  8808     IF CRTINITI GREATER THAN LOW-VALUES
  8809         MOVE AL-UANON           TO CRTINITA
  8810         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8811     ELSE
  8812         MOVE AL-UANOF           TO CRTINITA.
  8813
  8814     IF ISSAGEL GREATER THAN ZERO
  8815         IF ISSAGEI NUMERIC
  8816            MOVE AL-UANON        TO ISSAGEA
  8817            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8818         ELSE
  8819            MOVE ER-0237         TO EMI-ERROR
  8820            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8821            MOVE AL-UABON        TO ISSAGEA
  8822            MOVE -1              TO ISSAGEL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 159
* EL131.cbl
  8823            MOVE 'X'             TO ERROR-SWITCH
  8824     ELSE
  8825         MOVE AL-UANOF           TO ISSAGEA.
  8826
  8827     IF JNTFNMEI GREATER THAN LOW-VALUES
  8828         MOVE AL-UANON           TO JNTFNMEA
  8829         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8830     ELSE
  8831         MOVE AL-UANOF           TO JNTFNMEA.
  8832
  8833     IF JNTLNMEI GREATER THAN LOW-VALUES
  8834         MOVE AL-UANON           TO JNTLNMEA
  8835         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8836     ELSE
  8837         MOVE AL-UANOF           TO JNTLNMEA.
  8838
  8839     IF JNTINITI GREATER THAN LOW-VALUES
  8840         MOVE AL-UANON           TO JNTINITA
  8841         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8842     ELSE
  8843         MOVE AL-UANOF           TO JNTINITA.
  8844
  8845     IF JNTAGEL GREATER THAN ZERO
  8846         IF JNTAGEI NUMERIC
  8847            MOVE AL-UANON        TO JNTAGEA
  8848            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8849         ELSE
  8850            MOVE ER-0238         TO EMI-ERROR
  8851            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8852            MOVE AL-UABON        TO JNTAGEA
  8853            MOVE -1              TO JNTAGEL
  8854            MOVE 'X'             TO ERROR-SWITCH
  8855     ELSE
  8856         MOVE AL-UANOF           TO JNTAGEA.
  8857
  8858     IF ADDONDTI GREATER THAN LOW-VALUES
  8859         MOVE LOW-VALUES         TO HOLD-ADDON
  8860         IF ADDONDTI = SPACES
  8861             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8862         ELSE
  8863             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8864
  8865* EXEC CICS BIF DEEDIT
  8866*                FIELD    (DEEDIT-DATE-INPUT)
  8867*                LENGTH   (DATE-LENGTH)
  8868*            END-EXEC
  8869*    MOVE '@"L                   #   #00008542' TO DFHEIV0
  8870     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8871     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8872     MOVE X'2020233030303038353432' TO DFHEIV0(25:11)
  8873     CALL 'kxdfhei1' USING DFHEIV0,
  8874           DEEDIT-DATE-INPUT,
  8875           DATE-LENGTH
  8876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8877             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8878             MOVE '4'            TO DC-OPTION-CODE
  8879             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8880             IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 160
* EL131.cbl
  8881                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8882                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8883                                                  CERT-SWITCH
  8884                 MOVE AL-UANON   TO ADDONDTA
  8885                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8886             ELSE
  8887                 MOVE ER-7651    TO EMI-ERROR
  8888                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8889                 MOVE AL-UABON   TO ADDONDTA
  8890                 MOVE -1         TO ADDONDTL
  8891                 MOVE 'X'        TO ERROR-SWITCH
  8892       ELSE
  8893         MOVE AL-UANOF TO ADDONDTA.
  8894
  8895     IF LCVCDI GREATER THAN LOW-VALUES
  8896         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8897         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8898     ELSE
  8899         MOVE AL-UANOF           TO LCVCDA.
  8900
  8901     IF ACVCDI GREATER THAN LOW-VALUES
  8902         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8903         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8904     ELSE
  8905         MOVE AL-UANOF           TO ACVCDA.
  8906
  8907     IF LCVOTRMI GREATER THAN LOW-VALUES
  8908
  8909* EXEC CICS BIF DEEDIT
  8910*            FIELD (LCVOTRMI)
  8911*            LENGTH(3)
  8912*        END-EXEC
  8913     MOVE 3
  8914       TO DFHEIV11
  8915*    MOVE '@"L                   #   #00008577' TO DFHEIV0
  8916     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8917     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8918     MOVE X'2020233030303038353737' TO DFHEIV0(25:11)
  8919     CALL 'kxdfhei1' USING DFHEIV0,
  8920           LCVOTRMI,
  8921           DFHEIV11
  8922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8923         IF LCVOTRMI IS NUMERIC
  8924             MOVE LCVOTRMI       TO LCVOTRMO
  8925             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8926             MOVE AL-UANON       TO LCVOTRMA
  8927         ELSE
  8928             MOVE ER-0241        TO EMI-ERROR
  8929             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8930             MOVE AL-UNBON       TO LCVOTRMA
  8931             MOVE 'X'            TO ERROR-SWITCH
  8932             MOVE -1             TO LCVOTRML
  8933     ELSE
  8934         MOVE AL-UANOF           TO LCVOTRMA.
  8935
  8936     IF ACVOTRMI GREATER THAN LOW-VALUES
  8937
  8938* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 161
* EL131.cbl
  8939*            FIELD (ACVOTRMI)
  8940*            LENGTH(3)
  8941*        END-EXEC
  8942     MOVE 3
  8943       TO DFHEIV11
  8944*    MOVE '@"L                   #   #00008595' TO DFHEIV0
  8945     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8946     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8947     MOVE X'2020233030303038353935' TO DFHEIV0(25:11)
  8948     CALL 'kxdfhei1' USING DFHEIV0,
  8949           ACVOTRMI,
  8950           DFHEIV11
  8951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8952         IF ACVOTRMI IS NUMERIC
  8953             MOVE ACVOTRMI       TO ACVOTRMO
  8954             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8955             MOVE AL-UANON       TO ACVOTRMA
  8956         ELSE
  8957             MOVE ER-0241        TO EMI-ERROR
  8958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8959             MOVE AL-UNBON       TO ACVOTRMA
  8960             MOVE 'X'            TO ERROR-SWITCH
  8961             MOVE -1             TO ACVOTRML
  8962     ELSE
  8963         MOVE AL-UANOF           TO ACVOTRMA.
  8964
  8965     IF LCVRATEL GREATER THAN +0
  8966
  8967* EXEC CICS BIF DEEDIT
  8968*            FIELD (LCVRATEI)
  8969*            LENGTH(6)
  8970*        END-EXEC
  8971     MOVE 6
  8972       TO DFHEIV11
  8973*    MOVE '@"L                   #   #00008613' TO DFHEIV0
  8974     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8975     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8976     MOVE X'2020233030303038363133' TO DFHEIV0(25:11)
  8977     CALL 'kxdfhei1' USING DFHEIV0,
  8978           LCVRATEI,
  8979           DFHEIV11
  8980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8981         IF LCVRATEI IS NUMERIC
  8982             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8983             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8984             MOVE AL-UNNON       TO LCVRATEA
  8985         ELSE
  8986             MOVE ER-2280        TO EMI-ERROR
  8987             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8988             MOVE AL-UNBON       TO LCVRATEA
  8989             MOVE 'X'            TO ERROR-SWITCH
  8990             MOVE -1             TO LCVRATEL
  8991     ELSE
  8992         MOVE AL-UNNOF           TO LCVRATEA.
  8993
  8994     IF ACVRATEL GREATER THAN +0
  8995
  8996* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 162
* EL131.cbl
  8997*            FIELD (ACVRATEI)
  8998*            LENGTH(6)
  8999*        END-EXEC
  9000     MOVE 6
  9001       TO DFHEIV11
  9002*    MOVE '@"L                   #   #00008631' TO DFHEIV0
  9003     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9004     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9005     MOVE X'2020233030303038363331' TO DFHEIV0(25:11)
  9006     CALL 'kxdfhei1' USING DFHEIV0,
  9007           ACVRATEI,
  9008           DFHEIV11
  9009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9010         IF ACVRATEI IS NUMERIC
  9011             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9012             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9013             MOVE AL-UNNON       TO ACVRATEA
  9014         ELSE
  9015             MOVE ER-2280        TO EMI-ERROR
  9016             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9017             MOVE AL-UNBON       TO ACVRATEA
  9018             MOVE 'X'            TO ERROR-SWITCH
  9019             MOVE -1             TO ACVRATEL
  9020     ELSE
  9021         MOVE AL-UNNOF           TO ACVRATEA.
  9022
  9023     IF LCVBENEL GREATER THAN ZERO
  9024
  9025* EXEC CICS BIF DEEDIT
  9026*            FIELD (LCVBENEI)
  9027*            LENGTH (11)
  9028*        END-EXEC
  9029     MOVE 11
  9030       TO DFHEIV11
  9031*    MOVE '@"L                   #   #00008649' TO DFHEIV0
  9032     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9033     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9034     MOVE X'2020233030303038363439' TO DFHEIV0(25:11)
  9035     CALL 'kxdfhei1' USING DFHEIV0,
  9036           LCVBENEI,
  9037           DFHEIV11
  9038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9039         IF LCVBENEI IS NUMERIC
  9040            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9041            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9042            MOVE AL-UNNON        TO LCVBENEA
  9043         ELSE
  9044            MOVE ER-0243         TO EMI-ERROR
  9045            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9046            MOVE AL-UNBON        TO LCVBENEA
  9047            MOVE -1              TO LCVBENEL
  9048            MOVE 'X'             TO ERROR-SWITCH
  9049     ELSE
  9050         MOVE AL-UANOF           TO LCVBENEA.
  9051
  9052     IF ACVBENEL GREATER THAN ZERO
  9053
  9054* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 163
* EL131.cbl
  9055*            FIELD (ACVBENEI)
  9056*            LENGTH (11)
  9057*        END-EXEC
  9058     MOVE 11
  9059       TO DFHEIV11
  9060*    MOVE '@"L                   #   #00008667' TO DFHEIV0
  9061     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9062     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9063     MOVE X'2020233030303038363637' TO DFHEIV0(25:11)
  9064     CALL 'kxdfhei1' USING DFHEIV0,
  9065           ACVBENEI,
  9066           DFHEIV11
  9067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9068         IF ACVBENEI IS NUMERIC
  9069            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9070            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9071            MOVE AL-UNNON        TO ACVBENEA
  9072         ELSE
  9073            MOVE ER-0243         TO EMI-ERROR
  9074            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9075            MOVE AL-UNBON        TO ACVBENEA
  9076            MOVE -1              TO ACVBENEL
  9077            MOVE 'X'             TO ERROR-SWITCH
  9078     ELSE
  9079         MOVE AL-UANOF           TO ACVBENEA.
  9080
  9081     IF LCVFORMI GREATER THAN LOW-VALUES
  9082        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9083        MOVE AL-UANON            TO LCVFORMA
  9084     ELSE
  9085        MOVE AL-UANOF            TO LCVFORMA.
  9086
  9087     IF ACVFORMI GREATER THAN LOW-VALUES
  9088        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9089        MOVE AL-UANON            TO ACVFORMA
  9090     ELSE
  9091        MOVE AL-UANOF            TO ACVFORMA.
  9092
  9093     IF LCVCNDTL GREATER THAN ZERO
  9094         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9095         IF LCVCNDTI = SPACES
  9096             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9097         ELSE
  9098             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9099             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9100             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9101             MOVE '4'            TO DC-OPTION-CODE
  9102             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9103             IF NOT DATE-CONVERSION-ERROR
  9104                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9105                 MOVE AL-UANON   TO LCVCNDTA
  9106                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9107                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9108             ELSE
  9109                 MOVE ER-0246    TO EMI-ERROR
  9110                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111                 MOVE AL-UABON   TO LCVCNDTA
  9112                 MOVE -1         TO LCVCNDTL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 164
* EL131.cbl
  9113                 MOVE 'X'        TO ERROR-SWITCH
  9114     ELSE
  9115         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9116         MOVE AL-UANOF           TO LCVCNDTA.
  9117
  9118     IF ACVCNDTL GREATER THAN ZERO
  9119         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9120         IF ACVCNDTI = SPACES
  9121             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9122         ELSE
  9123             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9124             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9125             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9126             MOVE '4'            TO DC-OPTION-CODE
  9127             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9128             IF NOT DATE-CONVERSION-ERROR
  9129                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9130                 MOVE AL-UANON   TO ACVCNDTA
  9131                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9132                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9133             ELSE
  9134                 MOVE ER-0246    TO EMI-ERROR
  9135                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9136                 MOVE AL-UABON   TO ACVCNDTA
  9137                 MOVE -1         TO ACVCNDTL
  9138                 MOVE 'X'        TO ERROR-SWITCH
  9139     ELSE
  9140         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9141         MOVE AL-UANOF           TO ACVCNDTA.
  9142
  9143     IF APRL GREATER THAN +0
  9144
  9145* EXEC CICS BIF DEEDIT
  9146*            FIELD    (APRI)
  9147*            LENGTH   (8)
  9148*        END-EXEC
  9149     MOVE 8
  9150       TO DFHEIV11
  9151*    MOVE '@"L                   #   #00008747' TO DFHEIV0
  9152     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9153     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9154     MOVE X'2020233030303038373437' TO DFHEIV0(25:11)
  9155     CALL 'kxdfhei1' USING DFHEIV0,
  9156           APRI,
  9157           DFHEIV11
  9158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9159         IF APRI NUMERIC
  9160            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9161            MOVE APRI            TO HOLD-APR APRO
  9162            MOVE AL-UANON        TO APRA
  9163          ELSE
  9164            MOVE ER-0259         TO EMI-ERROR
  9165            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9166            MOVE AL-UABON        TO APRA
  9167            MOVE -1              TO APRL
  9168            MOVE 'X'             TO ERROR-SWITCH
  9169     ELSE
  9170         MOVE AL-UANOF           TO APRA.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 165
* EL131.cbl
  9171
  9172     IF PMTFREQL GREATER THAN ZERO
  9173
  9174* EXEC CICS BIF DEEDIT
  9175*            FIELD    (PMTFREQI)
  9176*            LENGTH   (2)
  9177*        END-EXEC
  9178     MOVE 2
  9179       TO DFHEIV11
  9180*    MOVE '@"L                   #   #00008765' TO DFHEIV0
  9181     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9182     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9183     MOVE X'2020233030303038373635' TO DFHEIV0(25:11)
  9184     CALL 'kxdfhei1' USING DFHEIV0,
  9185           PMTFREQI,
  9186           DFHEIV11
  9187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9188         IF PMTFREQI NUMERIC
  9189            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9190            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9191            MOVE AL-UANON        TO PMTFREQA
  9192          ELSE
  9193            MOVE ER-0427         TO EMI-ERROR
  9194            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9195            MOVE AL-UABON        TO PMTFREQA
  9196            MOVE -1              TO PMTFREQL
  9197            MOVE 'X'             TO ERROR-SWITCH
  9198     ELSE
  9199         MOVE AL-UANOF           TO PMTFREQA.
  9200
  9201     IF INDGRPL GREATER THAN ZERO
  9202         IF INDGRPI = 'I' OR 'G' OR SPACE
  9203             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9204             MOVE AL-UANON       TO INDGRPA
  9205          ELSE
  9206             MOVE ER-0260        TO EMI-ERROR
  9207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9208             MOVE AL-UABON       TO INDGRPA
  9209             MOVE -1             TO INDGRPL
  9210             MOVE 'X'            TO ERROR-SWITCH
  9211     ELSE
  9212         MOVE AL-UANOF           TO INDGRPA.
  9213
  9214     IF PREMTYPL GREATER THAN ZERO
  9215         IF PREMTYPI = '1' OR '2' OR '3'
  9216            MOVE PREMTYPI        TO PI-PREM-TYPE
  9217            MOVE AL-UNNON        TO PREMTYPA
  9218            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9219          ELSE
  9220            MOVE ER-0227         TO EMI-ERROR
  9221            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9222            MOVE AL-UNBON        TO PREMTYPA
  9223            MOVE -1              TO PREMTYPL
  9224            MOVE 'X'             TO ERROR-SWITCH
  9225     ELSE
  9226         MOVE AL-UANOF           TO PREMTYPA.
  9227
  9228     IF LOANBALL GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 166
* EL131.cbl
  9229
  9230* EXEC CICS BIF DEEDIT
  9231*             FIELD    (LOANBALI)
  9232*             LENGTH   (9)
  9233*        END-EXEC
  9234     MOVE 9
  9235       TO DFHEIV11
  9236*    MOVE '@"L                   #   #00008810' TO DFHEIV0
  9237     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9238     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9239     MOVE X'2020233030303038383130' TO DFHEIV0(25:11)
  9240     CALL 'kxdfhei1' USING DFHEIV0,
  9241           LOANBALI,
  9242           DFHEIV11
  9243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9244         IF LOANBALI NUMERIC
  9245             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9246             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9247             MOVE AL-UNNON TO LOANBALA
  9248         ELSE
  9249             MOVE ER-0639        TO EMI-ERROR
  9250             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9251             MOVE AL-UNBON       TO LOANBALA
  9252             MOVE -1             TO LOANBALL
  9253             MOVE 'X'            TO ERROR-SWITCH
  9254     ELSE
  9255         MOVE AL-UNNOF           TO LOANBALA.
  9256
  9257     IF LOANNOL GREATER THAN ZERO
  9258        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9259        MOVE AL-UANON            TO LOANNOA
  9260     ELSE
  9261        MOVE AL-UANOF            TO LOANNOA.
  9262
  9263     IF REINCDI GREATER THAN LOW-VALUES
  9264        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9265        MOVE AL-UANON            TO REINCDA
  9266     ELSE
  9267        MOVE AL-UANOF            TO REINCDA.
  9268
  9269     IF CERTI GREATER THAN LOW-VALUES
  9270         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9271     ELSE
  9272         MOVE AL-UANOF           TO CERTA.
  9273
  9274     IF CERTEFFI GREATER THAN LOW-VALUES
  9275         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9276     ELSE
  9277         MOVE AL-UANOF           TO CERTEFFA.
  9278
  9279     IF CERTACTI GREATER THAN LOW-VALUES
  9280         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9281     ELSE
  9282         MOVE AL-UANOF           TO CERTACTA.
  9283
  9284     IF CERTSTI GREATER THAN LOW-VALUES
  9285         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9286     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 167
* EL131.cbl
  9287         MOVE AL-UANOF           TO CERTSTA.
  9288
  9289     IF CERTCARI GREATER THAN LOW-VALUES
  9290         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9291     ELSE
  9292         MOVE AL-UANOF           TO CERTCARA.
  9293
  9294     IF DLYACTV-RECORD-NEEDED
  9295         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9296                 1150-EXIT
  9297     END-IF.
  9298
  9299     IF CERTEFFI GREATER LOW-VALUES OR
  9300        CERTACTI GREATER LOW-VALUES OR
  9301        CERTSTI  GREATER LOW-VALUES OR
  9302        CERTCARI GREATER LOW-VALUES OR
  9303        CERTGRPI GREATER LOW-VALUES
  9304        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9305
  9306*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9307*      IF PI-PREM-TYPE NOT = '1'  AND
  9308*         PI-NO-PMTS = ZEROS
  9309*          IF LOANBALL GREATER +0 OR
  9310*             ACVBENEL GREATER +0
  9311*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9312     if not acct-found
  9313        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9314     end-if
  9315     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9316     MOVE PI-CARRIER             TO CARRIER-CODE
  9317     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9318     MOVE PI-CERT-NO             TO CERT-NO
  9319
  9320* EXEC CICS READ
  9321*        DATASET   (CLMS-FILE-ID)
  9322*        RIDFLD    (MSTR-KEY)
  9323*        SET       (ADDRESS OF CLAIM-MASTER)
  9324*        RESP      (WS-RESPONSE)
  9325*    END-EXEC
  9326*    MOVE '&"S        E          (  N#00008889' TO DFHEIV0
  9327     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9329     MOVE X'204E233030303038383839' TO DFHEIV0(25:11)
  9330     CALL 'kxdfhei1' USING DFHEIV0,
  9331           CLMS-FILE-ID,
  9332           DFHEIV20,
  9333           DFHEIV99,
  9334           MSTR-KEY,
  9335           DFHEIV99,
  9336           DFHEIV99,
  9337           DFHEIV99
  9338     SET ADDRESS OF CLAIM-MASTER TO
  9339         DFHEIV20
  9340     MOVE EIBRESP  TO WS-RESPONSE
  9341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9342     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9343     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9344     MOVE CL-CERT-GROUPING       TO CERT-GROUP
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 168
* EL131.cbl
  9345     MOVE CL-CERT-STATE          TO CERT-STATE
  9346     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9347     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9348     MOVE CL-CERT-NO             TO CERT-CERT
  9349
  9350* EXEC CICS READ
  9351*       DATASET   (CERT-FILE-ID)
  9352*       RIDFLD    (CERT-KEY)
  9353*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9354*       RESP      (WS-RESPONSE)
  9355*    END-EXEC
  9356*    MOVE '&"S        E          (  N#00008902' TO DFHEIV0
  9357     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9358     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9359     MOVE X'204E233030303038393032' TO DFHEIV0(25:11)
  9360     CALL 'kxdfhei1' USING DFHEIV0,
  9361           CERT-FILE-ID,
  9362           DFHEIV20,
  9363           DFHEIV99,
  9364           CERT-KEY,
  9365           DFHEIV99,
  9366           DFHEIV99,
  9367           DFHEIV99
  9368     SET ADDRESS OF CERTIFICATE-MASTER TO
  9369         DFHEIV20
  9370     MOVE EIBRESP  TO WS-RESPONSE
  9371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9372     if mfnamei > low-values
  9373        move mfnamei to w-name-first
  9374     else
  9375        move cl-insured-1st-name to w-name-first
  9376     end-if
  9377     if mlnamei > low-values
  9378        move mlnamei to w-name-last
  9379     else
  9380        move cl-insured-last-name to w-name-last
  9381     end-if
  9382     if instypel > zeros
  9383        evaluate true
  9384           when cl-no-of-days-paid > zeros
  9385              move er-1668       to emi-error
  9386              perform 9900-error-format
  9387                                 thru 9900-exit
  9388              move al-uabon      to instypea
  9389              move -1            to instypel
  9390              move 'X'           to error-switch
  9391           when instypei = 'C'
  9392              if w-name-first (1:10) = cm-insured-first-name
  9393                 move er-1666    to emi-error
  9394                 PERFORM 9900-ERROR-FORMAT
  9395                                 THRU 9900-EXIT
  9396                 move al-uabon   to instypea
  9397                 move -1         to instypel
  9398                 move 'X'        to error-switch
  9399              end-if
  9400           when instypei = 'P'
  9401              if (w-name-first (1:10) <> cm-insured-first-name)
  9402                 or (w-name-last <> cm-insured-last-name)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 169
* EL131.cbl
  9403                 move er-1676    to emi-error
  9404                 PERFORM 9900-ERROR-FORMAT
  9405                                 THRU 9900-EXIT
  9406                 move al-uabon   to instypea
  9407                 move -1         to instypel
  9408                 move 'X'        to error-switch
  9409              end-if
  9410        end-evaluate
  9411     end-if
  9412*    if (instypel > zeros)
  9413*       and (cl-no-of-days-paid > zero)
  9414*       move er-1668             to emi-error
  9415*       perform 9900-error-format thru 9900-exit
  9416*       move al-uabon            to instypea
  9417*       move -1                  to instypel
  9418*       move 'X'                 to error-switch
  9419*    end-if
  9420*
  9421*    if instypel > zero
  9422*       if instypei = 'C'
  9423*          if w-name-first (1:10) = cm-insured-first-name
  9424*             move er-1666          to emi-error
  9425*             PERFORM 9900-ERROR-FORMAT
  9426*                                   THRU 9900-EXIT
  9427*             move al-uabon         to instypea
  9428*             move -1               to instypel
  9429*             move 'X'              to error-switch
  9430*          end-if
  9431*       end-if
  9432*    end-if
  9433
  9434     if (pi-company-id = 'DCC')
  9435        and (acct-found)
  9436        perform 2120-check-pdef  thru 2120-exit
  9437     end-if
  9438     if benperl > zeros
  9439        move al-uanon            to benpera
  9440     end-if
  9441     if benperl > zeros
  9442        if benperi numeric
  9443           perform 1015-edit-benefit-period
  9444                                 thru 1015-exit
  9445        else
  9446           move er-1669          to emi-error
  9447           PERFORM 9900-ERROR-FORMAT
  9448                                 THRU 9900-EXIT
  9449           move al-uabon         to benpera
  9450           move -1               to benperl
  9451           move 'X'              to error-switch
  9452        end-if
  9453    end-if
  9454     if instypel > zeros
  9455        if instypei = 'P' OR 'C'
  9456           move 'X'              to update-switch
  9457                                    mstr-switch
  9458           move al-uanon         to instypea
  9459        else
  9460            move er-1654          to emi-error
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 170
* EL131.cbl
  9461           PERFORM 9900-ERROR-FORMAT
  9462                                 THRU 9900-EXIT
  9463           move al-uabon         to instypea
  9464           move -1               to instypel
  9465           move 'X'              to error-switch
  9466        end-if
  9467    end-if
  9468     if accswl > zeros
  9469        if accswi = 'Y' OR 'N'
  9470           MOVE 'X'              TO UPDATE-SWITCH
  9471                                    MSTR-SWITCH
  9472           MOVE AL-UANON         TO accswa
  9473*       else
  9474*          move er-1656          to emi-error
  9475*          PERFORM 9900-ERROR-FORMAT
  9476*                                THRU 9900-EXIT
  9477*          move al-uabon         to accswa
  9478*          move -1               to accswl
  9479*          move 'X'              to error-switch
  9480*          move al-uanof         to accswa
  9481        end-if
  9482     end-if
  9483     IF CERTL = ZEROS AND
  9484        SUFXL = ZEROS
  9485          GO TO 1010-EXIT.
  9486
  9487     IF CERTL GREATER THAN ZEROS
  9488         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9489             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9490             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9491             MOVE 'X'            TO ERROR-SWITCH
  9492             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9493
  9494     IF SUFXL GREATER THAN ZEROS
  9495         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9496             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9497             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9498             MOVE 'X'            TO ERROR-SWITCH
  9499             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9500
  9501 1010-EXIT.
  9502     EXIT.
  9503
  9504 1015-edit-benefit-period.
  9505     move ' '                    to ws-benper-sw
  9506     evaluate true
  9507        when not erpdef-found
  9508           set good-benper       to true
  9509        when pd-recurring-yn (a1) = 'Y'
  9510           set good-benper       to true
  9511        when pd-recurring-yn (a1) = 'N'
  9512           if benperi < 02
  9513              set good-benper    to true
  9514           end-if
  9515        when pd-rec-crit-period (a1) numeric
  9516           if benperi <= pd-rec-crit-period (a1)
  9517              set good-benper    to true
  9518           end-if
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 171
* EL131.cbl
  9519     end-evaluate
  9520     MOVE CERT-KEY               TO ELCRTT-KEY
  9521     MOVE 'B'                    TO CTRLR-REC-TYPE
  9522
  9523* EXEC CICS READ
  9524*       DATASET   ('ELCRTT')
  9525*       RIDFLD    (ELCRTT-KEY)
  9526*       INTO      (CERTIFICATE-TRAILERS)
  9527*       RESP      (WS-RESPONSE)
  9528*    END-EXEC
  9529     MOVE LENGTH OF
  9530      CERTIFICATE-TRAILERS
  9531       TO DFHEIV11
  9532     MOVE 'ELCRTT' TO DFHEIV1
  9533*    MOVE '&"IL       E          (  N#00009058' TO DFHEIV0
  9534     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9536     MOVE X'204E233030303039303538' TO DFHEIV0(25:11)
  9537     CALL 'kxdfhei1' USING DFHEIV0,
  9538           DFHEIV1,
  9539           CERTIFICATE-TRAILERS,
  9540           DFHEIV11,
  9541           ELCRTT-KEY,
  9542           DFHEIV99,
  9543           DFHEIV99,
  9544           DFHEIV99
  9545     MOVE EIBRESP  TO WS-RESPONSE
  9546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9547     IF WS-RESP-NORMAL
  9548        perform varying s1 from +1 by +1 until
  9549           (s1 > +24)
  9550           or ((cs-claim-type (s1) = cl-claim-type)
  9551           and (cs-insured-type (s1) = cl-insured-type)
  9552           and (cs-benefit-period (s1) > benperi))
  9553        end-perform
  9554        if s1 < +25
  9555           move er-1665          to emi-error
  9556           PERFORM 9900-ERROR-FORMAT
  9557                                 THRU 9900-EXIT
  9558           move al-uabon         to benpera
  9559           move -1               to benperl
  9560           move 'X'              to error-switch
  9561           go to 1015-exit
  9562*       else
  9563*          set good-benper       to true
  9564        end-if
  9565     end-if
  9566     if good-benper
  9567        move 'X'                 to update-switch
  9568                                    mstr-switch
  9569        move al-uanon            to benpera
  9570     else
  9571        move er-1669             to emi-error
  9572        PERFORM 9900-ERROR-FORMAT
  9573                                 THRU 9900-EXIT
  9574        move al-uabon            to benpera
  9575        move -1                  to benperl
  9576        move 'X'                 to error-switch
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 172
* EL131.cbl
  9577     end-if
  9578     .
  9579 1015-exit.
  9580     exit.
  9581 1120-EDIT-PROC.
  9582     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9583     MOVE '2'                    TO CNTL-REC-TYPE.
  9584     MOVE PROCI                  TO CNTL-PROC-ID.
  9585     MOVE ZERO                   TO CNTL-SEQ-NO.
  9586
  9587
  9588* EXEC CICS HANDLE CONDITION
  9589*         NOTFND    (1120-CNTL-NOTFND)
  9590*    END-EXEC.
  9591*    MOVE '"$I                   ! & #00009104' TO DFHEIV0
  9592     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9593     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9594     MOVE X'2620233030303039313034' TO DFHEIV0(25:11)
  9595     CALL 'kxdfhei1' USING DFHEIV0
  9596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9597
  9598
  9599
  9600* EXEC CICS READ
  9601*         SET      (ADDRESS OF CONTROL-FILE)
  9602*         DATASET  (CNTL-FILE-ID)
  9603*         RIDFLD   (CNTL-KEY)
  9604*    END-EXEC.
  9605*    MOVE '&"S        E          (   #00009108' TO DFHEIV0
  9606     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9607     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9608     MOVE X'2020233030303039313038' TO DFHEIV0(25:11)
  9609     CALL 'kxdfhei1' USING DFHEIV0,
  9610           CNTL-FILE-ID,
  9611           DFHEIV20,
  9612           DFHEIV99,
  9613           CNTL-KEY,
  9614           DFHEIV99,
  9615           DFHEIV99,
  9616           DFHEIV99
  9617     SET ADDRESS OF CONTROL-FILE TO
  9618         DFHEIV20
  9619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9620
  9621
  9622     MOVE AL-UANON               TO PROCA.
  9623     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9624     GO TO 1120-EXIT.
  9625
  9626 1120-CNTL-NOTFND.
  9627     MOVE ER-0273                TO EMI-ERROR.
  9628     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9629     MOVE AL-UABON               TO PROCA.
  9630     MOVE -1                     TO PROCL.
  9631     MOVE 'X'                    TO ERROR-SWITCH.
  9632
  9633 1120-EXIT.
  9634     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 173
* EL131.cbl
  9635
  9636*************************************************************
  9637*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9638*************************************************************
  9639
  9640 1150-OUTPUT-ACTIVITY-RECORD.
  9641
  9642
  9643* EXEC CICS GETMAIN
  9644*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9645*        LENGTH (25)
  9646*        INITIMG (WS-BLANK)
  9647*    END-EXEC.
  9648     MOVE 25
  9649       TO DFHEIV11
  9650*    MOVE ',"IL                  $   #00009134' TO DFHEIV0
  9651     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9652     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9653     MOVE X'2020233030303039313334' TO DFHEIV0(25:11)
  9654     CALL 'kxdfhei1' USING DFHEIV0,
  9655           DFHEIV20,
  9656           DFHEIV11,
  9657           WS-BLANK
  9658     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9659         DFHEIV20
  9660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9661
  9662
  9663     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9664     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9665     MOVE PI-CARRIER             TO DA-CARRIER.
  9666     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9667     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9668     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9669     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9670
  9671
  9672* EXEC CICS HANDLE CONDITION
  9673*        NOTOPEN (1150-NOTOPEN-ERROR)
  9674*        DUPREC (1150-EXIT)
  9675*    END-EXEC.
  9676*    MOVE '"$J%                  ! '' #00009148' TO DFHEIV0
  9677     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9679     MOVE X'2720233030303039313438' TO DFHEIV0(25:11)
  9680     CALL 'kxdfhei1' USING DFHEIV0
  9681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9682
  9683     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9684     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9685     MOVE 'A'                    TO JP-RECORD-TYPE.
  9686     MOVE +48                    TO JOURNAL-LENGTH.
  9687
  9688
  9689* EXEC CICS WRITE
  9690*        DATASET ('DLYACTV')
  9691*        RIDFLD (DA-KEY)
  9692*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 174
* EL131.cbl
  9693*        LENGTH (25)
  9694*    END-EXEC.
  9695     MOVE 'DLYACTV' TO DFHEIV1
  9696     MOVE 25
  9697       TO DFHEIV11
  9698*    MOVE '&$ L                  ''   #00009157' TO DFHEIV0
  9699     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9700     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9701     MOVE X'2020233030303039313537' TO DFHEIV0(25:11)
  9702     CALL 'kxdfhei1' USING DFHEIV0,
  9703           DFHEIV1,
  9704           DAILY-ACTIVITY-RECORD,
  9705           DFHEIV11,
  9706           DA-KEY,
  9707           DFHEIV99,
  9708           DFHEIV99
  9709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9710
  9711
  9712     GO TO 1150-EXIT.
  9713
  9714 1150-NOTOPEN-ERROR.
  9715
  9716     MOVE '2955'                 TO EMI-ERROR.
  9717     MOVE -1                     TO MAINTL.
  9718     MOVE AL-UANON               TO MAINTA.
  9719     MOVE 'X'                    TO ERROR-SWITCH.
  9720     PERFORM 9900-ERROR-FORMAT THRU
  9721             9900-EXIT.
  9722
  9723 1150-EXIT.
  9724     EXIT.
  9725
  9726*************************************************************
  9727*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9728*************************************************************
  9729
  9730 1240-EDIT-LIFE-CODE.
  9731
  9732     IF INVALID-BENEFIT-CODE
  9733         GO TO 1240-SET-ERROR.
  9734
  9735     MOVE SPACES                 TO BENEFIT-KEY.
  9736     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9737     MOVE '4'                    TO BEN-REC-TYPE.
  9738     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9739     MOVE ZERO                   TO BEN-SEQ-NO.
  9740
  9741
  9742* EXEC CICS READ GTEQ
  9743*         DATASET  (CNTL-FILE-ID)
  9744*         RIDFLD   (BENEFIT-KEY)
  9745*         SET      (ADDRESS OF CONTROL-FILE)
  9746*    END-EXEC.
  9747*    MOVE '&"S        G          (   #00009193' TO DFHEIV0
  9748     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9750     MOVE X'2020233030303039313933' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 175
* EL131.cbl
  9751     CALL 'kxdfhei1' USING DFHEIV0,
  9752           CNTL-FILE-ID,
  9753           DFHEIV20,
  9754           DFHEIV99,
  9755           BENEFIT-KEY,
  9756           DFHEIV99,
  9757           DFHEIV99,
  9758           DFHEIV99
  9759     SET ADDRESS OF CONTROL-FILE TO
  9760         DFHEIV20
  9761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9762
  9763
  9764     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9765        CF-RECORD-TYPE NOT = '4'
  9766         GO TO 1240-SET-ERROR.
  9767
  9768     MOVE ZERO                   TO COUNT-2.
  9769     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9770
  9771     IF SCREEN-ERROR
  9772         GO TO 1240-SET-ERROR.
  9773
  9774 1240-SET-CODE-SWITCHES.
  9775     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9776     MOVE AL-UANON               TO LCVCDA.
  9777     GO TO 1240-EXIT.
  9778
  9779 1240-SET-ERROR.
  9780     MOVE ER-0240                TO EMI-ERROR.
  9781     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9782     MOVE 'X'                    TO ERROR-SWITCH.
  9783     MOVE AL-UABON               TO LCVCDA.
  9784     MOVE -1                     TO LCVCDL.
  9785
  9786 1240-EXIT.
  9787     EXIT.
  9788
  9789 1310-EDIT-AH-CODE.
  9790     IF INVALID-BENEFIT-CODE
  9791         GO TO 1310-SET-ERROR.
  9792
  9793     MOVE SPACES                 TO BENEFIT-KEY.
  9794     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9795     MOVE '5'                    TO BEN-REC-TYPE.
  9796     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9797     MOVE ZERO                   TO BEN-SEQ-NO.
  9798
  9799
  9800* EXEC CICS READ GTEQ
  9801*         DATASET  (CNTL-FILE-ID)
  9802*         RIDFLD   (BENEFIT-KEY)
  9803*         SET      (ADDRESS OF CONTROL-FILE)
  9804*    END-EXEC.
  9805*    MOVE '&"S        G          (   #00009234' TO DFHEIV0
  9806     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9808     MOVE X'2020233030303039323334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 176
* EL131.cbl
  9809     CALL 'kxdfhei1' USING DFHEIV0,
  9810           CNTL-FILE-ID,
  9811           DFHEIV20,
  9812           DFHEIV99,
  9813           BENEFIT-KEY,
  9814           DFHEIV99,
  9815           DFHEIV99,
  9816           DFHEIV99
  9817     SET ADDRESS OF CONTROL-FILE TO
  9818         DFHEIV20
  9819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9820
  9821
  9822     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9823        CF-RECORD-TYPE NOT = '5'
  9824         GO TO 1310-SET-ERROR.
  9825
  9826     MOVE ZERO                   TO COUNT-2.
  9827     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9828     IF SCREEN-ERROR
  9829         GO TO 1310-SET-ERROR.
  9830
  9831 1310-SET-CODE-SWITCHES.
  9832     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9833     MOVE AL-UANON               TO ACVCDA.
  9834     GO TO 1310-EXIT.
  9835
  9836 1310-SET-ERROR.
  9837     MOVE ER-0250                TO EMI-ERROR.
  9838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9839     MOVE AL-UABON               TO ACVCDA.
  9840     MOVE 'X'                    TO ERROR-SWITCH.
  9841     MOVE -1                     TO ACVCDL.
  9842
  9843 1310-EXIT.
  9844     EXIT.
  9845
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 177
* EL131.cbl
  9847 1460-EDIT-CERT-NO.
  9848     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9849     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9850
  9851     IF WS-SAVE-CERT-NO = SPACES
  9852         MOVE ER-0203            TO EMI-ERROR
  9853         GO TO 1460-CERT-NO-ERROR.
  9854
  9855     IF WS-CERT-NO-PRIME = SPACES AND
  9856        WS-CERT-NO-SUFX GREATER THAN SPACE
  9857            MOVE ER-0210         TO EMI-ERROR
  9858            GO TO 1460-CERT-NO-ERROR.
  9859
  9860     MOVE 'X'                    TO UPDATE-SWITCH.
  9861     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9862     MOVE AL-UANON               TO CERTA.
  9863
  9864     IF SUFXL IS GREATER THAN 0
  9865         MOVE AL-UANON           TO SUFXA.
  9866
  9867     GO TO 1460-EXIT.
  9868
  9869 1460-CERT-NO-ERROR.
  9870     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9871     MOVE AL-UABON               TO SUFXA.
  9872     MOVE AL-UABON               TO CERTA.
  9873     MOVE -1                     TO CERTL.
  9874     MOVE 'X'                    TO ERROR-SWITCH.
  9875
  9876 1460-EXIT.
  9877     EXIT.
  9878
  9879 1470-EDIT-EFF.
  9880     IF CERTEFFI = SPACES
  9881         GO TO 1470-DATE-ERROR.
  9882
  9883     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9884     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9885     IF DEEDIT-DATE = ZERO
  9886         GO TO 1470-DATE-ERROR.
  9887
  9888     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9889     MOVE '4'                    TO DC-OPTION-CODE.
  9890     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9891     IF NOT DATE-CONVERSION-ERROR
  9892         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9893         MOVE AL-UANON           TO CERTEFFA
  9894         MOVE 'X'                TO UPDATE-SWITCH
  9895         MOVE 'Y'                TO CERT-KEY-SWITCH
  9896         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9897         GO TO 1470-EXIT.
  9898
  9899 1470-DATE-ERROR.
  9900     MOVE ER-0215                TO EMI-ERROR.
  9901     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9902     MOVE AL-UABON               TO CERTEFFA.
  9903     MOVE -1                     TO CERTEFFL.
  9904     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 178
* EL131.cbl
  9905
  9906 1470-EXIT.
  9907     EXIT.
  9908
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 179
* EL131.cbl
  9910 1480-EDIT-ACCT.
  9911     IF CERTACTI = SPACES
  9912         MOVE ER-0232            TO EMI-ERROR
  9913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9914         MOVE AL-UABON           TO CERTACTA
  9915         MOVE -1                 TO CERTACTL
  9916         MOVE 'X'                TO ERROR-SWITCH
  9917     ELSE
  9918         MOVE 'X'                TO UPDATE-SWITCH
  9919         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9920
  9921 1480-EXIT.
  9922     EXIT.
  9923
  9924 1490-EDIT-STATE.
  9925     IF CERTSTI = SPACES
  9926         MOVE ER-0233            TO EMI-ERROR
  9927         GO TO 1490-STATE-ERROR.
  9928
  9929     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9930     MOVE '3'                    TO CNTL-REC-TYPE.
  9931     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9932     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9933     MOVE ZERO                   TO CNTL-SEQ-NO.
  9934
  9935
  9936* EXEC CICS HANDLE CONDITION
  9937*         NOTFND (1490-STATE-NOTFND)
  9938*    END-EXEC.
  9939*    MOVE '"$I                   ! ( #00009353' TO DFHEIV0
  9940     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9941     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9942     MOVE X'2820233030303039333533' TO DFHEIV0(25:11)
  9943     CALL 'kxdfhei1' USING DFHEIV0
  9944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9945
  9946
  9947
  9948* EXEC CICS READ
  9949*         SET        (ADDRESS OF CONTROL-FILE)
  9950*         DATASET    ('ELCNTL')
  9951*         RIDFLD     (CNTL-KEY)
  9952*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9953*         GENERIC
  9954*    END-EXEC.
  9955     MOVE 'ELCNTL' TO DFHEIV1
  9956*    MOVE '&"S  KG    E          (   #00009357' TO DFHEIV0
  9957     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9959     MOVE X'2020233030303039333537' TO DFHEIV0(25:11)
  9960     CALL 'kxdfhei1' USING DFHEIV0,
  9961           DFHEIV1,
  9962           DFHEIV20,
  9963           DFHEIV99,
  9964           CNTL-KEY,
  9965           CNTL-GENERIC-LENGTH,
  9966           DFHEIV99,
  9967           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 180
* EL131.cbl
  9968     SET ADDRESS OF CONTROL-FILE TO
  9969         DFHEIV20
  9970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9971
  9972
  9973     MOVE AL-UANON               TO CERTSTA.
  9974     MOVE 'X'                    TO UPDATE-SWITCH.
  9975     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9976     GO TO 1490-EXIT.
  9977
  9978 1490-STATE-NOTFND.
  9979     MOVE ER-0149                TO EMI-ERROR.
  9980
  9981 1490-STATE-ERROR.
  9982     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9983     MOVE AL-UABON               TO CERTSTA.
  9984     MOVE -1                     TO CERTSTL.
  9985     MOVE 'X'                    TO ERROR-SWITCH.
  9986
  9987 1490-EXIT.
  9988     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 181
* EL131.cbl
  9990 1500-EDIT-CARR.
  9991     IF CERTCARI = SPACES
  9992         GO TO 1500-CARR-NOTFND.
  9993
  9994     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9995     MOVE '6'                    TO CNTL-REC-TYPE.
  9996     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9997     MOVE CERTCARI               TO CNTL-CARRIER.
  9998     MOVE ZERO                   TO CNTL-SEQ-NO.
  9999
 10000
 10001* EXEC CICS HANDLE CONDITION
 10002*         NOTFND   (1500-CARR-NOTFND)
 10003*    END-EXEC.
 10004*    MOVE '"$I                   ! ) #00009392' TO DFHEIV0
 10005     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10007     MOVE X'2920233030303039333932' TO DFHEIV0(25:11)
 10008     CALL 'kxdfhei1' USING DFHEIV0
 10009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10010
 10011
 10012
 10013* EXEC CICS READ
 10014*         SET        (ADDRESS OF CONTROL-FILE)
 10015*         DATASET    ('ELCNTL')
 10016*         RIDFLD     (CNTL-KEY)
 10017*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10018*         GENERIC
 10019*    END-EXEC.
 10020     MOVE 'ELCNTL' TO DFHEIV1
 10021*    MOVE '&"S  KG    E          (   #00009396' TO DFHEIV0
 10022     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10023     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10024     MOVE X'2020233030303039333936' TO DFHEIV0(25:11)
 10025     CALL 'kxdfhei1' USING DFHEIV0,
 10026           DFHEIV1,
 10027           DFHEIV20,
 10028           DFHEIV99,
 10029           CNTL-KEY,
 10030           CNTL-GENERIC-LENGTH,
 10031           DFHEIV99,
 10032           DFHEIV99
 10033     SET ADDRESS OF CONTROL-FILE TO
 10034         DFHEIV20
 10035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10036
 10037
 10038     MOVE AL-UANON               TO CERTCARA.
 10039     MOVE 'X'                    TO UPDATE-SWITCH.
 10040     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10041     GO TO 1500-EXIT.
 10042
 10043 1500-CARR-NOTFND.
 10044     MOVE ER-0360                TO EMI-ERROR.
 10045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10046     MOVE AL-UABON               TO CERTCARA.
 10047     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 182
* EL131.cbl
 10048     MOVE 'X'                    TO ERROR-SWITCH.
 10049
 10050 1500-EXIT.
 10051     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 183
* EL131.cbl
 10053 1510-DEEDIT-DATE.
 10054
 10055* EXEC CICS BIF DEEDIT
 10056*         FIELD    (DEEDIT-DATE-INPUT)
 10057*         LENGTH   (DATE-LENGTH)
 10058*    END-EXEC.
 10059*    MOVE '@"L                   #   #00009420' TO DFHEIV0
 10060     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10061     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10062     MOVE X'2020233030303039343230' TO DFHEIV0(25:11)
 10063     CALL 'kxdfhei1' USING DFHEIV0,
 10064           DEEDIT-DATE-INPUT,
 10065           DATE-LENGTH
 10066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10067
 10068
 10069 1510-EXIT.
 10070     EXIT.
 10071
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 184
* EL131.cbl
 10073 1620-VERIFY-ACCT.
 10074
 10075     move ' '                    to ws-eracct-sw
 10076     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10077     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10078     MOVE PI-GROUPING            TO ACCT-GROUP.
 10079     MOVE PI-STATE               TO ACCT-STATE.
 10080     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10081
 10082     IF CERTEFFI GREATER THAN LOW-VALUES
 10083         MOVE HOLD-EFF           TO ACCT-DATE
 10084     ELSE
 10085         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10086
 10087     IF CERTACTI GREATER THAN LOW-VALUES
 10088         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10089     IF CERTSTI GREATER THAN LOW-VALUES
 10090         MOVE CERTSTI            TO  ACCT-STATE.
 10091     IF CERTCARI GREATER THAN LOW-VALUES
 10092         MOVE CERTCARI           TO  ACCT-CARRIER.
 10093     IF CERTGRPI GREATER THAN LOW-VALUES
 10094         MOVE CERTGRPI           TO ACCT-GROUP.
 10095
 10096     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10097
 10098
 10099* EXEC CICS HANDLE CONDITION
 10100*         NOTFND  (1620-ACCT-NOTFND)
 10101*    END-EXEC.
 10102*    MOVE '"$I                   ! * #00009454' TO DFHEIV0
 10103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10105     MOVE X'2A20233030303039343534' TO DFHEIV0(25:11)
 10106     CALL 'kxdfhei1' USING DFHEIV0
 10107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10108
 10109
 10110
 10111* EXEC CICS STARTBR
 10112*         DATASET   (ACCT-FILE-ID)
 10113*         RIDFLD    (ACCT-KEY)
 10114*    END-EXEC.
 10115     MOVE 0
 10116       TO DFHEIV11
 10117*    MOVE '&,         G          &   #00009458' TO DFHEIV0
 10118     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10119     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10120     MOVE X'2020233030303039343538' TO DFHEIV0(25:11)
 10121     CALL 'kxdfhei1' USING DFHEIV0,
 10122           ACCT-FILE-ID,
 10123           ACCT-KEY,
 10124           DFHEIV99,
 10125           DFHEIV11,
 10126           DFHEIV99
 10127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10128
 10129
 10130 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 185
* EL131.cbl
 10131
 10132
 10133* EXEC CICS READNEXT
 10134*         DATASET  (ACCT-FILE-ID)
 10135*         RIDFLD   (ACCT-KEY)
 10136*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10137*    END-EXEC.
 10138     MOVE 0
 10139       TO DFHEIV11
 10140*    MOVE '&.S                   )   #00009465' TO DFHEIV0
 10141     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10142     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10143     MOVE X'2020233030303039343635' TO DFHEIV0(25:11)
 10144     CALL 'kxdfhei1' USING DFHEIV0,
 10145           ACCT-FILE-ID,
 10146           DFHEIV20,
 10147           DFHEIV99,
 10148           ACCT-KEY,
 10149           DFHEIV99,
 10150           DFHEIV11,
 10151           DFHEIV99,
 10152           DFHEIV99
 10153     SET ADDRESS OF ACCOUNT-MASTER TO
 10154         DFHEIV20
 10155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10156
 10157
 10158     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10159         GO TO 1620-ACCT-NOTFND.
 10160
 10161     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10162        HOLD-EFF     LESS AM-EXPIRATION-DT
 10163         NEXT SENTENCE
 10164     ELSE
 10165         GO TO 1620-ACCT-LOOP.
 10166
 10167     set acct-found to true
 10168     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10169         GO TO 1620-ACCT-END-BROWSE.
 10170
 10171     IF LOANBALL GREATER THAN +0
 10172         IF AM-MAX-TOT-BEN NUMERIC  AND
 10173            AM-MAX-TOT-BEN GREATER THAN ZERO
 10174             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10175                 MOVE AL-UNBON     TO LOANBALA
 10176                 MOVE -1           TO LOANBALL
 10177                 MOVE 'X'          TO ERROR-SWITCH
 10178                 MOVE ER-7641      TO EMI-ERROR
 10179                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10180
 10181     IF ACVBENEL GREATER THAN +0
 10182         IF AM-MAX-MON-BEN NUMERIC  AND
 10183            AM-MAX-MON-BEN GREATER THAN ZERO
 10184             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10185                 MOVE AL-UNBON     TO ACVBENEA
 10186                 MOVE -1           TO ACVBENEL
 10187                 MOVE 'X'          TO ERROR-SWITCH
 10188                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 186
* EL131.cbl
 10189                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10190
 10191 1620-ACCT-END-BROWSE.
 10192
 10193
 10194* EXEC CICS ENDBR
 10195*         DATASET (ACCT-FILE-ID)
 10196*    END-EXEC.
 10197     MOVE 0
 10198       TO DFHEIV11
 10199*    MOVE '&2                    $   #00009506' TO DFHEIV0
 10200     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10201     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10202     MOVE X'2020233030303039353036' TO DFHEIV0(25:11)
 10203     CALL 'kxdfhei1' USING DFHEIV0,
 10204           ACCT-FILE-ID,
 10205           DFHEIV11,
 10206           DFHEIV99
 10207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10208
 10209
 10210     GO TO 1620-EXIT.
 10211
 10212 1620-ACCT-NOTFND.
 10213
 10214     MOVE -1                     TO MAINTL.
 10215     MOVE 'X'                    TO ERROR-SWITCH.
 10216     MOVE ER-0426                TO EMI-ERROR.
 10217     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10218
 10219 1620-EXIT.
 10220     EXIT.
 10221
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 187
* EL131.cbl
 10223 2000-UPDATE-CLAIM.
 10224
 10225     MOVE SPACES                 TO ERROR-SWITCH.
 10226     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10227     MOVE PI-CARRIER             TO CARRIER-CODE.
 10228     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10229     MOVE PI-CERT-NO             TO CERT-NO.
 10230
 10231     IF DELETE-CLAIM
 10232         GO TO 3000-DELETE-CLAIM.
 10233
 10234     IF  NOT MODIFY-CAP
 10235         MOVE ER-0070            TO EMI-ERROR
 10236         MOVE 'X'                TO ERROR-SWITCH
 10237         MOVE -1                 TO MAINTL
 10238         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10239         GO TO 2000-EXIT.
 10240
 10241     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10242     MOVE ZERO                   TO TRLR-SEQ-NO.
 10243
 10244
 10245* EXEC CICS READ UPDATE
 10246*         SET       (ADDRESS OF CLAIM-MASTER)
 10247*         DATASET   (CLMS-FILE-ID)
 10248*         RIDFLD    (MSTR-KEY)
 10249*    END-EXEC.
 10250*    MOVE '&"S        EU         (   #00009544' TO DFHEIV0
 10251     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10252     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10253     MOVE X'2020233030303039353434' TO DFHEIV0(25:11)
 10254     CALL 'kxdfhei1' USING DFHEIV0,
 10255           CLMS-FILE-ID,
 10256           DFHEIV20,
 10257           DFHEIV99,
 10258           MSTR-KEY,
 10259           DFHEIV99,
 10260           DFHEIV99,
 10261           DFHEIV99
 10262     SET ADDRESS OF CLAIM-MASTER TO
 10263         DFHEIV20
 10264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10265
 10266
 10267     if (incl > zeros)
 10268        and (cl-no-of-pmts-made > 0)
 10269        and (hold-incur > low-values)
 10270        and (hold-incur not = cl-incurred-dt)
 10271        if hold-incur > cl-incurred-dt
 10272           move cl-incurred-dt   to dc-bin-date-1
 10273           move hold-incur       to dc-bin-date-2
 10274        else
 10275           move hold-incur       to dc-bin-date-1
 10276           move cl-incurred-dt   to dc-bin-date-2
 10277        end-if
 10278        move '1'                 to dc-option-code
 10279        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10280        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 188
* EL131.cbl
 10281           MOVE ER-1663             TO EMI-ERROR
 10282           PERFORM 9900-ERROR-FORMAT
 10283                                 THRU 9900-EXIT
 10284           MOVE -1                  TO MAINTL
 10285           GO TO 8110-SEND-DATA
 10286        end-if
 10287     end-if
 10288     IF (CL-PRIORITY-CD = '8')
 10289        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10290             AND 'AMWA' AND 'KMSB')
 10291        MOVE ER-8003             TO EMI-ERROR
 10292        PERFORM 9900-ERROR-FORMAT
 10293                                 THRU 9900-EXIT
 10294        MOVE -1                  TO MAINTL
 10295        GO TO 8110-SEND-DATA
 10296     END-IF
 10297
 10298     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10299         MOVE ER-0068            TO EMI-ERROR
 10300         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10301         GO TO 2000-EXIT.
 10302
 10303     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10304         MOVE ER-0068            TO EMI-ERROR
 10305         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10306         GO TO 2000-EXIT.
 10307
 10308     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10309         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10310
 10311     IF CL-PURGED-DT NOT = LOW-VALUES
 10312         MOVE ER-7691            TO EMI-ERROR
 10313         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10314         GO TO 2000-EXIT.
 10315
 10316     IF CERT-KEY-CHANGED
 10317         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10318
 10319     IF SCREEN-ERROR
 10320         MOVE ER-0068            TO EMI-ERROR
 10321         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10322         GO TO 2000-EXIT.
 10323
 10324     IF NINETY-TRLR-UPDATED
 10325         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10326
 10327     IF MSTR-KEY-CHANGED
 10328         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10329        ELSE
 10330         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10331
 10332     IF TRLR-UPDATE-REQUIRED
 10333         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10334
 10335 2000-CHECK-CERT.
 10336     IF NOT CERT-UPDATES
 10337         GO TO 2000-EXIT.
 10338
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 189
* EL131.cbl
 10339     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10340     MOVE PI-CARRIER             TO CERT-CARRIER.
 10341     MOVE PI-GROUPING            TO CERT-GROUP.
 10342     MOVE PI-STATE               TO CERT-STATE.
 10343     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10344     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10345     MOVE PI-CERT-NO             TO CERT-CERT.
 10346
 10347     IF CERT-ALT-KEY-CHANGED
 10348         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10349     ELSE
 10350         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10351
 10352 2000-EXIT.
 10353     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 190
* EL131.cbl
 10355 2010-RELEASE-REC.
 10356
 10357* EXEC CICS UNLOCK
 10358*         DATASET  (CLMS-FILE-ID)
 10359*    END-EXEC
 10360*    MOVE '&*                    #   #00009639' TO DFHEIV0
 10361     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10362     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10363     MOVE X'2020233030303039363339' TO DFHEIV0(25:11)
 10364     CALL 'kxdfhei1' USING DFHEIV0,
 10365           CLMS-FILE-ID,
 10366           DFHEIV99
 10367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10368
 10369     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10370     MOVE 'X'                    TO ERROR-SWITCH.
 10371
 10372 2010-EXIT.
 10373     EXIT.
 10374
 10375 2020-NORMAL-UPDATE.
 10376     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10377
 10378     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10379
 10380     IF WS-OPEN-CLOSE-SW = 'Y'
 10381       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10382       IF PI-REC-FOUND-SW = 'Y'
 10383         IF CL-ACTIVITY-CODE = 09
 10384           NEXT SENTENCE
 10385         ELSE
 10386           IF WS-RESET-SW = 'Y'
 10387             IF CL-CLAIM-STATUS = 'C'
 10388               MOVE 07               TO  CL-ACTIVITY-CODE
 10389               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10390               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10391             ELSE
 10392               MOVE 08               TO  CL-ACTIVITY-CODE
 10393               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10394               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10395
 10396     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10397         MOVE 'Y'                TO CL-YESNOSW
 10398     END-IF.
 10399
 10400     if pi-company-id = 'DCC'
 10401        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10402        perform 2120-check-pdef  thru 2120-exit
 10403     end-if
 10404     if ((benperl <> zeros)
 10405        and (benperi numeric))
 10406                  or
 10407            (instypel <> zeros)
 10408        perform 2140-update-elcrtt thru 2140-exit
 10409     end-if
 10410
 10411* EXEC CICS HANDLE CONDITION
 10412*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 191
* EL131.cbl
 10413*    END-EXEC.
 10414*    MOVE '"$$                   ! + #00009684' TO DFHEIV0
 10415     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10417     MOVE X'2B20233030303039363834' TO DFHEIV0(25:11)
 10418     CALL 'kxdfhei1' USING DFHEIV0
 10419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10420
 10421
 10422
 10423* EXEC CICS REWRITE
 10424*         DATASET   (CLMS-FILE-ID)
 10425*         FROM      (CLAIM-MASTER)
 10426*    END-EXEC.
 10427     MOVE LENGTH OF
 10428      CLAIM-MASTER
 10429       TO DFHEIV11
 10430*    MOVE '&& L                  %   #00009688' TO DFHEIV0
 10431     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10432     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10433     MOVE X'2020233030303039363838' TO DFHEIV0(25:11)
 10434     CALL 'kxdfhei1' USING DFHEIV0,
 10435           CLMS-FILE-ID,
 10436           CLAIM-MASTER,
 10437           DFHEIV11,
 10438           DFHEIV99
 10439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10440
 10441
 10442 2020-EXIT.
 10443     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 192
* EL131.cbl
 10445 2030-KEY-UPDATE.
 10446     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10447
 10448
 10449* EXEC CICS DELETE
 10450*        DATASET  (CLMS-FILE-ID)
 10451*    END-EXEC.
 10452*    MOVE '&(                    &   #00009699' TO DFHEIV0
 10453     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10454     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10455     MOVE X'2020233030303039363939' TO DFHEIV0(25:11)
 10456     CALL 'kxdfhei1' USING DFHEIV0,
 10457           CLMS-FILE-ID,
 10458           DFHEIV99,
 10459           DFHEIV99,
 10460           DFHEIV99,
 10461           DFHEIV99
 10462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10463
 10464
 10465
 10466* EXEC CICS GETMAIN
 10467*         SET      (ADDRESS OF CLAIM-MASTER)
 10468*         LENGTH   (MSTR-LENGTH)
 10469*         INITIMG  (GETMAIN-SPACE)
 10470*    END-EXEC.
 10471*    MOVE ',"IL                  $   #00009703' TO DFHEIV0
 10472     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10473     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10474     MOVE X'2020233030303039373033' TO DFHEIV0(25:11)
 10475     CALL 'kxdfhei1' USING DFHEIV0,
 10476           DFHEIV20,
 10477           MSTR-LENGTH,
 10478           GETMAIN-SPACE
 10479     SET ADDRESS OF CLAIM-MASTER TO
 10480         DFHEIV20
 10481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10482
 10483
 10484     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10485
 10486     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10487
 10488     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10489
 10490     IF WS-OPEN-CLOSE-SW = 'Y'
 10491       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10492         IF PI-REC-FOUND-SW = 'Y'
 10493           IF CL-ACTIVITY-CODE = 09
 10494             NEXT SENTENCE
 10495           ELSE
 10496             IF WS-RESET-SW = 'Y'
 10497               IF CL-CLAIM-STATUS = 'C'
 10498                 MOVE 07             TO  CL-ACTIVITY-CODE
 10499                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10500                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10501               ELSE
 10502                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 193
* EL131.cbl
 10503                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10504                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10505
 10506
 10507* EXEC CICS HANDLE CONDITION
 10508*         DUPKEY    (2030-EXIT)
 10509*    END-EXEC.
 10510*    MOVE '"$$                   ! , #00009731' TO DFHEIV0
 10511     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10513     MOVE X'2C20233030303039373331' TO DFHEIV0(25:11)
 10514     CALL 'kxdfhei1' USING DFHEIV0
 10515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10516
 10517
 10518** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10519*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10520
 10521     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10522         MOVE 'Y'                TO CL-YESNOSW
 10523     END-IF.
 10524
 10525
 10526* EXEC CICS WRITE
 10527*         DATASET   (CLMS-FILE-ID)
 10528*         RIDFLD    (MSTR-KEY)
 10529*         FROM      (CLAIM-MASTER)
 10530*    END-EXEC.
 10531     MOVE LENGTH OF
 10532      CLAIM-MASTER
 10533       TO DFHEIV11
 10534*    MOVE '&$ L                  ''   #00009742' TO DFHEIV0
 10535     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10536     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10537     MOVE X'2020233030303039373432' TO DFHEIV0(25:11)
 10538     CALL 'kxdfhei1' USING DFHEIV0,
 10539           CLMS-FILE-ID,
 10540           CLAIM-MASTER,
 10541           DFHEIV11,
 10542           MSTR-KEY,
 10543           DFHEIV99,
 10544           DFHEIV99
 10545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10546
 10547
 10548 2030-EXIT.
 10549     EXIT.
 10550
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 194
* EL131.cbl
 10552 2040-NORMAL-UPDATE.
 10553
 10554* EXEC CICS READ UPDATE
 10555*         DATASET  (CERT-FILE-ID)
 10556*         RIDFLD   (CERT-KEY)
 10557*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10558*    END-EXEC.
 10559*    MOVE '&"S        EU         (   #00009753' TO DFHEIV0
 10560     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10561     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10562     MOVE X'2020233030303039373533' TO DFHEIV0(25:11)
 10563     CALL 'kxdfhei1' USING DFHEIV0,
 10564           CERT-FILE-ID,
 10565           DFHEIV20,
 10566           DFHEIV99,
 10567           CERT-KEY,
 10568           DFHEIV99,
 10569           DFHEIV99,
 10570           DFHEIV99
 10571     SET ADDRESS OF CERTIFICATE-MASTER TO
 10572         DFHEIV20
 10573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10574
 10575
 10576     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10577
 10578
 10579* EXEC CICS HANDLE CONDITION
 10580*         DUPKEY   (2040-EXIT)
 10581*    END-EXEC.
 10582*    MOVE '"$$                   ! - #00009761' TO DFHEIV0
 10583     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10585     MOVE X'2D20233030303039373631' TO DFHEIV0(25:11)
 10586     CALL 'kxdfhei1' USING DFHEIV0
 10587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10588
 10589
 10590
 10591* EXEC CICS REWRITE
 10592*         DATASET  (CERT-FILE-ID)
 10593*         FROM     (CERTIFICATE-MASTER)
 10594*    END-EXEC.
 10595     MOVE LENGTH OF
 10596      CERTIFICATE-MASTER
 10597       TO DFHEIV11
 10598*    MOVE '&& L                  %   #00009765' TO DFHEIV0
 10599     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10600     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10601     MOVE X'2020233030303039373635' TO DFHEIV0(25:11)
 10602     CALL 'kxdfhei1' USING DFHEIV0,
 10603           CERT-FILE-ID,
 10604           CERTIFICATE-MASTER,
 10605           DFHEIV11,
 10606           DFHEIV99
 10607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10608
 10609
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 195
* EL131.cbl
 10610 2040-EXIT.
 10611     EXIT.
 10612
 10613 2050-KEY-UPDATE.
 10614
 10615* EXEC CICS READ UPDATE
 10616*         DATASET  (CERT-FILE-ID)
 10617*         RIDFLD   (CERT-KEY)
 10618*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10619*    END-EXEC.
 10620*    MOVE '&"S        EU         (   #00009774' TO DFHEIV0
 10621     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10622     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10623     MOVE X'2020233030303039373734' TO DFHEIV0(25:11)
 10624     CALL 'kxdfhei1' USING DFHEIV0,
 10625           CERT-FILE-ID,
 10626           DFHEIV20,
 10627           DFHEIV99,
 10628           CERT-KEY,
 10629           DFHEIV99,
 10630           DFHEIV99,
 10631           DFHEIV99
 10632     SET ADDRESS OF CERTIFICATE-MASTER TO
 10633         DFHEIV20
 10634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10635
 10636
 10637     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10638
 10639
 10640* EXEC CICS DELETE
 10641*         DATASET   (CERT-FILE-ID)
 10642*    END-EXEC.
 10643*    MOVE '&(                    &   #00009782' TO DFHEIV0
 10644     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10645     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10646     MOVE X'2020233030303039373832' TO DFHEIV0(25:11)
 10647     CALL 'kxdfhei1' USING DFHEIV0,
 10648           CERT-FILE-ID,
 10649           DFHEIV99,
 10650           DFHEIV99,
 10651           DFHEIV99,
 10652           DFHEIV99
 10653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10654
 10655
 10656
 10657* EXEC CICS GETMAIN
 10658*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10659*         LENGTH    (CERT-LENGTH)
 10660*         INITIMG   (GETMAIN-SPACE)
 10661*    END-EXEC.
 10662*    MOVE ',"IL                  $   #00009786' TO DFHEIV0
 10663     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10664     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10665     MOVE X'2020233030303039373836' TO DFHEIV0(25:11)
 10666     CALL 'kxdfhei1' USING DFHEIV0,
 10667           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 196
* EL131.cbl
 10668           CERT-LENGTH,
 10669           GETMAIN-SPACE
 10670     SET ADDRESS OF CERTIFICATE-MASTER TO
 10671         DFHEIV20
 10672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10673
 10674
 10675     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10676
 10677     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10678
 10679
 10680* EXEC CICS HANDLE CONDITION
 10681*         DUPKEY (2050-EXIT)
 10682*    END-EXEC.
 10683*    MOVE '"$$                   ! . #00009796' TO DFHEIV0
 10684     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10686     MOVE X'2E20233030303039373936' TO DFHEIV0(25:11)
 10687     CALL 'kxdfhei1' USING DFHEIV0
 10688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10689
 10690
 10691
 10692* EXEC CICS WRITE
 10693*         DATASET  (CERT-FILE-ID)
 10694*         RIDFLD   (CERT-KEY)
 10695*         FROM     (CERTIFICATE-MASTER)
 10696*    END-EXEC.
 10697     MOVE LENGTH OF
 10698      CERTIFICATE-MASTER
 10699       TO DFHEIV11
 10700*    MOVE '&$ L                  ''   #00009800' TO DFHEIV0
 10701     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10703     MOVE X'2020233030303039383030' TO DFHEIV0(25:11)
 10704     CALL 'kxdfhei1' USING DFHEIV0,
 10705           CERT-FILE-ID,
 10706           CERTIFICATE-MASTER,
 10707           DFHEIV11,
 10708           CERT-KEY,
 10709           DFHEIV99,
 10710           DFHEIV99
 10711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10712
 10713
 10714 2050-EXIT.
 10715     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 197
* EL131.cbl
 10717 2060-CHANGE-CERT.
 10718     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10719     MOVE PI-CARRIER             TO CERT-CARRIER.
 10720     MOVE PI-GROUPING            TO CERT-GROUP.
 10721     MOVE PI-STATE               TO CERT-STATE.
 10722     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10723     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10724     MOVE PI-CERT-NO             TO CERT-CERT.
 10725     IF CERTEFFI GREATER THAN LOW-VALUES
 10726         MOVE HOLD-EFF           TO CERT-DATE.
 10727     IF CERTACTI GREATER THAN LOW-VALUES
 10728         MOVE CERTACTI           TO CERT-ACCOUNT.
 10729     IF CERTSTI GREATER THAN LOW-VALUES
 10730         MOVE CERTSTI            TO CERT-STATE.
 10731     IF CERTCARI GREATER THAN LOW-VALUES
 10732         MOVE CERTCARI           TO CERT-CARRIER.
 10733     IF CERTGRPI GREATER THAN LOW-VALUES
 10734         MOVE CERTGRPI           TO CERT-GROUP.
 10735     IF CERTI GREATER THAN LOW-VALUES
 10736         MOVE CERTI              TO CERT-CERT-PRIME.
 10737     IF SUFXI GREATER THAN LOW-VALUES
 10738         MOVE SUFXI              TO CERT-CERT-SUFX.
 10739
 10740
 10741* EXEC CICS HANDLE CONDITION
 10742*         NOTFND   (2060-CERT-NOTFND)
 10743*    END-EXEC.
 10744*    MOVE '"$I                   ! / #00009832' TO DFHEIV0
 10745     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10747     MOVE X'2F20233030303039383332' TO DFHEIV0(25:11)
 10748     CALL 'kxdfhei1' USING DFHEIV0
 10749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10750
 10751
 10752
 10753* EXEC CICS READ UPDATE
 10754*         DATASET  (CERT-FILE-ID)
 10755*         RIDFLD   (CERT-KEY)
 10756*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10757*    END-EXEC.
 10758*    MOVE '&"S        EU         (   #00009836' TO DFHEIV0
 10759     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10760     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10761     MOVE X'2020233030303039383336' TO DFHEIV0(25:11)
 10762     CALL 'kxdfhei1' USING DFHEIV0,
 10763           CERT-FILE-ID,
 10764           DFHEIV20,
 10765           DFHEIV99,
 10766           CERT-KEY,
 10767           DFHEIV99,
 10768           DFHEIV99,
 10769           DFHEIV99
 10770     SET ADDRESS OF CERTIFICATE-MASTER TO
 10771         DFHEIV20
 10772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10773
 10774
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 198
* EL131.cbl
 10775     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10776
 10777     IF CM-CLAIM-INTERFACE-SW = SPACES
 10778        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10779
 10780
 10781* EXEC CICS HANDLE CONDITION
 10782*         DUPKEY   (2060-DUPKEY)
 10783*    END-EXEC.
 10784*    MOVE '"$$                   ! 0 #00009847' TO DFHEIV0
 10785     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10787     MOVE X'3020233030303039383437' TO DFHEIV0(25:11)
 10788     CALL 'kxdfhei1' USING DFHEIV0
 10789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10790
 10791
 10792
 10793* EXEC CICS REWRITE
 10794*         DATASET  (CERT-FILE-ID)
 10795*         FROM     (CERTIFICATE-MASTER)
 10796*    END-EXEC.
 10797     MOVE LENGTH OF
 10798      CERTIFICATE-MASTER
 10799       TO DFHEIV11
 10800*    MOVE '&& L                  %   #00009851' TO DFHEIV0
 10801     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10802     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10803     MOVE X'2020233030303039383531' TO DFHEIV0(25:11)
 10804     CALL 'kxdfhei1' USING DFHEIV0,
 10805           CERT-FILE-ID,
 10806           CERTIFICATE-MASTER,
 10807           DFHEIV11,
 10808           DFHEIV99
 10809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10810
 10811
 10812 2060-DUPKEY.
 10813
 10814     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10815
 10816 2060-CHANGE-TRLR-ACTQ.
 10817     IF SCREEN-ERROR
 10818         GO TO 2060-EXIT.
 10819
 10820     IF CERTI    GREATER LOW-VALUES OR
 10821        SUFXI    GREATER LOW-VALUES OR
 10822        CERTCARI GREATER LOW-VALUES
 10823         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10824         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10825
 10826     MOVE SPACES                 TO CERT-KEY-SWITCH
 10827                                    CERT-SWITCH
 10828                                    TRLR-SWITCH
 10829                                    NINETY-TRLR-SWITCH.
 10830     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10831     GO TO 2060-EXIT.
 10832
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 199
* EL131.cbl
 10833 2060-CERT-NOTFND.
 10834     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10835
 10836     IF WS-REC-FOUND-SW = 'N'
 10837         MOVE ER-0206            TO  EMI-ERROR
 10838         MOVE -1                 TO  MAINTL
 10839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10840
 10841* EXEC CICS UNLOCK
 10842*            DATASET   (CLMS-FILE-ID)
 10843*        END-EXEC
 10844*    MOVE '&*                    #   #00009884' TO DFHEIV0
 10845     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10846     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10847     MOVE X'2020233030303039383834' TO DFHEIV0(25:11)
 10848     CALL 'kxdfhei1' USING DFHEIV0,
 10849           CLMS-FILE-ID,
 10850           DFHEIV99
 10851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10852         GO TO 8110-SEND-DATA.
 10853
 10854     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10855
 10856     GO TO 2060-CHANGE-TRLR-ACTQ.
 10857
 10858 2060-EXIT.
 10859     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 200
* EL131.cbl
 10861 2070-CHECK-OLD.
 10862
 10863
 10864* EXEC CICS HANDLE CONDITION
 10865*        NOTFND   (2070-NOT-FOUND)
 10866*    END-EXEC.
 10867*    MOVE '"$I                   ! 1 #00009898' TO DFHEIV0
 10868     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10870     MOVE X'3120233030303039383938' TO DFHEIV0(25:11)
 10871     CALL 'kxdfhei1' USING DFHEIV0
 10872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10873
 10874
 10875     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10876     MOVE PI-CARRIER             TO CERT-CARRIER.
 10877     MOVE PI-GROUPING            TO CERT-GROUP.
 10878     MOVE PI-STATE               TO CERT-STATE.
 10879     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10880     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10881     MOVE PI-CERT-NO             TO CERT-CERT.
 10882
 10883
 10884* EXEC CICS READ UPDATE
 10885*         DATASET  (CERT-FILE-ID)
 10886*         RIDFLD   (CERT-KEY)
 10887*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10888*    END-EXEC.
 10889*    MOVE '&"S        EU         (   #00009910' TO DFHEIV0
 10890     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10891     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10892     MOVE X'2020233030303039393130' TO DFHEIV0(25:11)
 10893     CALL 'kxdfhei1' USING DFHEIV0,
 10894           CERT-FILE-ID,
 10895           DFHEIV20,
 10896           DFHEIV99,
 10897           CERT-KEY,
 10898           DFHEIV99,
 10899           DFHEIV99,
 10900           DFHEIV99
 10901     SET ADDRESS OF CERTIFICATE-MASTER TO
 10902         DFHEIV20
 10903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10904
 10905
 10906     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10907     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10908     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10909
 10910     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10911         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10912
 10913     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10914       AND
 10915        CERT-WAS-CREATED-FOR-CLAIM
 10916         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10917
 10918* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 201
* EL131.cbl
 10919*             DATASET   (CERT-FILE-ID)
 10920*        END-EXEC
 10921*    MOVE '&(                    &   #00009927' TO DFHEIV0
 10922     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10923     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10924     MOVE X'2020233030303039393237' TO DFHEIV0(25:11)
 10925     CALL 'kxdfhei1' USING DFHEIV0,
 10926           CERT-FILE-ID,
 10927           DFHEIV99,
 10928           DFHEIV99,
 10929           DFHEIV99,
 10930           DFHEIV99
 10931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10932         GO TO 2070-EXIT.
 10933
 10934     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10935         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10936
 10937
 10938* EXEC CICS HANDLE CONDITION
 10939*         DUPKEY   (2070-EXIT)
 10940*    END-EXEC.
 10941*    MOVE '"$$                   ! 2 #00009935' TO DFHEIV0
 10942     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10944     MOVE X'3220233030303039393335' TO DFHEIV0(25:11)
 10945     CALL 'kxdfhei1' USING DFHEIV0
 10946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10947
 10948
 10949
 10950* EXEC CICS REWRITE
 10951*         DATASET  (CERT-FILE-ID)
 10952*         FROM     (CERTIFICATE-MASTER)
 10953*    END-EXEC.
 10954     MOVE LENGTH OF
 10955      CERTIFICATE-MASTER
 10956       TO DFHEIV11
 10957*    MOVE '&& L                  %   #00009939' TO DFHEIV0
 10958     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10959     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10960     MOVE X'2020233030303039393339' TO DFHEIV0(25:11)
 10961     CALL 'kxdfhei1' USING DFHEIV0,
 10962           CERT-FILE-ID,
 10963           CERTIFICATE-MASTER,
 10964           DFHEIV11,
 10965           DFHEIV99
 10966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10967
 10968
 10969     GO TO 2070-EXIT.
 10970
 10971 2070-NOT-FOUND.
 10972     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10973
 10974 2070-EXIT.
 10975     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 202
* EL131.cbl
 10977 2080-CREATE-CERT.
 10978
 10979* EXEC CICS GETMAIN
 10980*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10981*         LENGTH    (CERT-LENGTH)
 10982*         INITIMG   (GETMAIN-SPACE)
 10983*    END-EXEC.
 10984*    MOVE ',"IL                  $   #00009953' TO DFHEIV0
 10985     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10986     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10987     MOVE X'2020233030303039393533' TO DFHEIV0(25:11)
 10988     CALL 'kxdfhei1' USING DFHEIV0,
 10989           DFHEIV20,
 10990           CERT-LENGTH,
 10991           GETMAIN-SPACE
 10992     SET ADDRESS OF CERTIFICATE-MASTER TO
 10993         DFHEIV20
 10994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10995
 10996
 10997     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10998
 10999     IF CERTEFFI GREATER THAN LOW-VALUES
 11000         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11001                                    DC-BIN-DATE-1
 11002         MOVE '6'                TO DC-OPTION-CODE
 11003         MOVE +1                 TO DC-ELAPSED-MONTHS
 11004         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11005         IF NO-CONVERSION-ERROR
 11006             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11007
 11008     IF CERTACTI GREATER THAN LOW-VALUES
 11009         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11010     IF CERTSTI GREATER THAN LOW-VALUES
 11011         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11012     IF CERTCARI GREATER THAN LOW-VALUES
 11013         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11014     IF CERTGRPI GREATER THAN LOW-VALUES
 11015         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11016     IF CERTI GREATER THAN LOW-VALUES
 11017         MOVE CERTI              TO CERT-CERT-PRIME
 11018                                    CM-CERT-PRIME
 11019         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11020
 11021     IF SUFXI GREATER THAN LOW-VALUES
 11022         MOVE SUFXI              TO CERT-CERT-SUFX
 11023                                    CM-CERT-SFX
 11024         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11025
 11026     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11027
 11028     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11029
 11030     MOVE SPACES                 TO CM-ENTRY-BATCH
 11031                                    CM-LF-EXIT-BATCH
 11032                                    CM-AH-EXIT-BATCH
 11033                                    CM-CREDIT-INTERFACE-SW-1
 11034                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 203
* EL131.cbl
 11035
 11036     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11037                               '9' OR 'D' OR 'V'
 11038         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11039
 11040     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11041                               '9' OR 'D' OR 'V'
 11042         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11043
 11044     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11045                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11046     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11047
 11048
 11049* EXEC CICS HANDLE CONDITION
 11050*         DUPKEY (2080-EXIT)
 11051*    END-EXEC.
 11052*    MOVE '"$$                   ! 3 #00010010' TO DFHEIV0
 11053     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11055     MOVE X'3320233030303130303130' TO DFHEIV0(25:11)
 11056     CALL 'kxdfhei1' USING DFHEIV0
 11057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11058
 11059
 11060
 11061* EXEC CICS WRITE
 11062*         DATASET  (CERT-FILE-ID)
 11063*         RIDFLD   (CERT-KEY)
 11064*         FROM     (CERTIFICATE-MASTER)
 11065*    END-EXEC.
 11066     MOVE LENGTH OF
 11067      CERTIFICATE-MASTER
 11068       TO DFHEIV11
 11069*    MOVE '&$ L                  ''   #00010014' TO DFHEIV0
 11070     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11071     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11072     MOVE X'2020233030303130303134' TO DFHEIV0(25:11)
 11073     CALL 'kxdfhei1' USING DFHEIV0,
 11074           CERT-FILE-ID,
 11075           CERTIFICATE-MASTER,
 11076           DFHEIV11,
 11077           CERT-KEY,
 11078           DFHEIV99,
 11079           DFHEIV99
 11080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11081
 11082
 11083 2080-EXIT.
 11084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 204
* EL131.cbl
 11086 2100-MOVE-MSTR.
 11087     IF TYPEI GREATER THAN LOW-VALUES
 11088         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11089
 11090     IF STATUSI = LOW-VALUES
 11091         GO TO 2100-NO-STATUS-CHANGE.
 11092
 11093     IF STATUSI = 'OPEN' OR 'O'
 11094         IF CL-CLAIM-STATUS = 'O'
 11095             MOVE SPACES         TO TRLR-SWITCH
 11096                 GO TO 2100-NO-STATUS-CHANGE.
 11097
 11098     IF STATUSI = 'CLOSED' OR 'C'
 11099         IF CL-CLAIM-STATUS = 'C'
 11100             MOVE SPACES         TO TRLR-SWITCH
 11101                 GO TO 2100-NO-STATUS-CHANGE.
 11102
 11103     IF PI-COMPANY-ID = 'DMD'
 11104        IF STATUSI = 'OPEN' OR 'O'
 11105           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11106              MOVE ZERO       TO STATUSL
 11107              MOVE LOW-VALUES TO STATUSI
 11108              GO TO 2100-NO-STATUS-CHANGE.
 11109
 11110     IF PI-COMPANY-ID = 'DMD'
 11111         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11112
 11113     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11114
 11115 2100-NO-STATUS-CHANGE.
 11116
 11117     IF CCNOI GREATER THAN LOW-VALUES
 11118         MOVE CCNOI              TO CL-CCN.
 11119
 11120     IF PROCI GREATER THAN LOW-VALUES
 11121         MOVE PROCI              TO CL-PROCESSOR-ID.
 11122
 11123     if (accswi > low-values)
 11124        and (accswi = 'Y' OR 'N')
 11125        move accswi              to cl-accident-claim-sw
 11126     end-if
 11127     if benperi > low-values
 11128        and benperi numeric
 11129        move benperi             to cl-benefit-period
 11130     end-if
 11131     if instypei > low-values
 11132        move instypei            to cl-insured-type
 11133     end-if
 11134     IF SEXI GREATER THAN LOW-VALUES
 11135         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11136
 11137     IF BIRTHI GREATER THAN LOW-VALUES
 11138         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11139
 11140     IF SOCIALI GREATER THAN LOW-VALUES
 11141       AND
 11142        SOCIALI = SPACES
 11143         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 205
* EL131.cbl
 11144         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11145         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11146     ELSE
 11147         IF SOCIALI GREATER THAN LOW-VALUES
 11148             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11149
 11150     IF OCCI GREATER THAN LOW-VALUES
 11151         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11152
 11153     IF BENEL GREATER THAN ZERO
 11154         MOVE BENEI              TO CL-BENEFICIARY.
 11155
 11156     IF DIAGI GREATER THAN LOW-VALUES
 11157         MOVE DIAGI              TO WS-DIAGNOSIS.
 11158
 11159     IF ICD1I GREATER THAN LOW-VALUES
 11160         MOVE ICD1I              TO WS-ICD-CODE-1
 11161     END-IF.
 11162
 11163     IF ICD2I GREATER THAN LOW-VALUES
 11164         MOVE ICD2I              TO WS-ICD-CODE-2
 11165     END-IF.
 11166
 11167     IF PREMTYPI GREATER THAN LOW-VALUES
 11168         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11169
 11170*    IF CAUSEI GREATER THAN LOW-VALUES
 11171*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11172
 11173*    IF ENDI GREATER THAN LOW-VALUES
 11174*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11175
 11176     IF PDTHRUI GREATER THAN LOW-VALUES
 11177        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11178
 11179     IF PDAMTL GREATER THAN +0
 11180        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11181
 11182     IF NODAYSI GREATER THAN LOW-VALUES
 11183        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11184
 11185     IF NOPMTSI GREATER THAN LOW-VALUES
 11186        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11187
 11188     IF FORMTYPI GREATER THAN LOW-VALUES
 11189        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11190
 11191     IF INCI GREATER THAN LOW-VALUES
 11192        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11193
 11194     IF REPI GREATER THAN LOW-VALUES
 11195        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11196
 11197     IF ADDONDTI GREATER THAN LOW-VALUES
 11198        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11199
 11200     IF PRICDI GREATER THAN LOW-VALUES
 11201         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 206
* EL131.cbl
 11202
 11203     IF CRITPL  > ZEROS
 11204        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11205     END-IF
 11206
 11207*    IF CRITPTL > ZEROS
 11208*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11209*    END-IF
 11210
 11211*    IF RTWMOSL > ZEROS
 11212*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11213*    END-IF
 11214     IF FILETOI GREATER THAN LOW-VALUES
 11215         MOVE FILETOI            TO CL-FILE-LOCATION.
 11216
 11217     IF SUPVI GREATER THAN LOW-VALUES
 11218         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11219
 11220     IF MLNAMEI GREATER THAN LOW-VALUES
 11221         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11222
 11223     IF MFNAMEI GREATER THAN LOW-VALUES
 11224         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11225
 11226     IF MMINITI GREATER THAN LOW-VALUES
 11227         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11228
 11229     IF CERTEFFI GREATER THAN LOW-VALUES
 11230         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11231
 11232     IF CERTACTI GREATER THAN LOW-VALUES
 11233         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11234
 11235     IF CERTSTI GREATER THAN LOW-VALUES
 11236         MOVE CERTSTI            TO CL-CERT-STATE.
 11237
 11238     IF CERTCARI GREATER THAN LOW-VALUES
 11239         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11240                                    CL-CARRIER.
 11241
 11242     IF CERTGRPI GREATER THAN LOW-VALUES
 11243         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11244
 11245     IF CERTI GREATER THAN LOW-VALUES
 11246         MOVE CERTI              TO CERT-NO-PRIME.
 11247
 11248     IF SUFXI GREATER THAN LOW-VALUES
 11249         MOVE SUFXI              TO CERT-NO-SUFX.
 11250
 11251     MOVE CERT-NO                TO CL-CERT-NO
 11252                                    CL-CERT-NO-A4.
 11253
 11254     IF PI-COMPANY-ID = 'FLA'
 11255          NEXT SENTENCE
 11256     ELSE
 11257         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11258         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11259         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 207
* EL131.cbl
 11260         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11261
 11262     IF TRLR-UPDATE-REQUIRED
 11263        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11264        MOVE ZEROS              TO TRLR-SEQ-NO
 11265
 11266* EXEC CICS READ
 11267*            DATASET   (TRLR-FILE-ID)
 11268*            RIDFLD    (TRLR-KEY)
 11269*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11270*       END-EXEC
 11271*    MOVE '&"S        E          (   #00010202' TO DFHEIV0
 11272     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11273     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11274     MOVE X'2020233030303130323032' TO DFHEIV0(25:11)
 11275     CALL 'kxdfhei1' USING DFHEIV0,
 11276           TRLR-FILE-ID,
 11277           DFHEIV20,
 11278           DFHEIV99,
 11279           TRLR-KEY,
 11280           DFHEIV99,
 11281           DFHEIV99,
 11282           DFHEIV99
 11283     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11284         DFHEIV20
 11285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11286        IF AT-TRAILER-TYPE = '1'
 11287           MOVE +1 TO MISC-SUB
 11288           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11289           MISC-SUB GREATER THAN +6 OR
 11290           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11291           IF MISC-SUB GREATER THAN +1
 11292              SUBTRACT +1 FROM MISC-SUB
 11293              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11294                 GO TO 2100-BYPASS-LAST-UPDATE.
 11295
 11296     IF TRLR-UPDATE-REQUIRED AND
 11297        CLAIM-IS-OPEN
 11298         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11299     ELSE
 11300         IF TRLR-UPDATE-REQUIRED AND
 11301            CLAIM-IS-CLOSED
 11302             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11303             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11304
 11305 2100-BYPASS-LAST-UPDATE.
 11306     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11307     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11308
 11309     GO TO 2100-EXIT.
 11310
 11311 2100-BUMP-OPEN-CLOSE-HIST.
 11312     ADD +1                      TO MISC-SUB.
 11313
 11314 2100-EXIT.
 11315     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 208
* EL131.cbl
 11317 2120-check-pdef.
 11318     move +0                     to s1
 11319     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11320     move spaces                 to ws-dcc-error-line
 11321     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11322     IF ERPDEF-FOUND
 11323        perform 2130-check-trlr  thru 2130-exit
 11324        move +1                  to s1
 11325*       if cl-accident-claim-sw = ' '
 11326*          move er-1655             to ws-error-no (s1)
 11327*          add +1 to s1
 11328*       end-if
 11329        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11330        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11331        if (hold-incur > low-values)
 11332           and (incl > zeros)
 11333           and (hold-incur not = cl-incurred-dt)
 11334           move hold-incur       to dc-bin-date-2
 11335        end-if
 11336        MOVE '1'                 TO DC-OPTION-CODE
 11337        MOVE +0                  TO DC-ELAPSED-MONTHS
 11338                                    DC-ELAPSED-DAYS
 11339        PERFORM 9800-CONVERT-DATE
 11340                                 THRU 9800-EXIT
 11341        IF NO-CONVERSION-ERROR
 11342           MOVE DC-ELAPSED-MONTHS
 11343                                 TO WS-MONTHS-BETWEEN
 11344           IF DC-ELAPSED-DAYS > 1
 11345              ADD 1 TO WS-MONTHS-BETWEEN
 11346           END-IF
 11347        ELSE
 11348           display ' dte conv error ' dc-error-code
 11349           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11350        END-IF
 11351        IF (WS-EXCL-PERIOD = ZEROS)
 11352           OR (WS-MONTHS-BETWEEN = ZEROS)
 11353           CONTINUE
 11354        ELSE
 11355           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11356              MOVE ER-1651       TO ws-error-no (s1)
 11357              add +1             to s1
 11358           END-IF
 11359        END-IF
 11360        IF (WS-COV-ENDS = ZEROS)
 11361           OR (WS-MONTHS-BETWEEN = ZEROS)
 11362           CONTINUE
 11363        ELSE
 11364           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11365              MOVE -1            TO MAINTL
 11366              MOVE ER-1653       TO ws-error-no (s1)
 11367              add +1 to s1
 11368           END-IF
 11369        END-IF
 11370        IF (WS-ACC-PERIOD = ZEROS)
 11371           OR (WS-MONTHS-BETWEEN = ZEROS)
 11372           CONTINUE
 11373        ELSE
 11374           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 209
* EL131.cbl
 11375              and (accswi = spaces or low-values)
 11376*             and (cl-accident-claim-sw = ' ')
 11377              move er-1655       to ws-error-no (s1)
 11378              add +1             to s1
 11379           end-if
 11380           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11381*             if (cl-accident-claim-sw not = 'Y')
 11382              if (accswi not = 'Y')
 11383                 MOVE ER-1652    TO ws-error-no (s1)
 11384              else
 11385                 move er-1662    to ws-error-no (s1)
 11386              end-if
 11387              MOVE -1            TO MAINTL
 11388              add +1             to s1
 11389           END-IF
 11390        END-IF
 11391        if cl-claim-type  = 'I'
 11392           move er-1661          to ws-error-no (s1)
 11393           add +1                to s1
 11394        end-if
 11395        perform 2130-check-trlr  thru 2130-exit
 11396     END-IF
 11397
 11398     .
 11399 2120-exit.
 11400     exit.
 11401
 11402 2130-check-trlr.
 11403
 11404     evaluate true
 11405        when s1 = +0
 11406           move cl-control-primary
 11407                                 to trlr-key
 11408           MOVE +95              TO TRLR-SEQ-NO
 11409
 11410* EXEC CICS READ
 11411*             update
 11412*             DATASET  ('ELTRLR')
 11413*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11414*             RIDFLD   (TRLR-KEY)
 11415*             RESP     (WS-RESPONSE)
 11416*          END-EXEC
 11417     MOVE 'ELTRLR' TO DFHEIV1
 11418*    MOVE '&"S        EU         (  N#00010330' TO DFHEIV0
 11419     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11420     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11421     MOVE X'204E233030303130333330' TO DFHEIV0(25:11)
 11422     CALL 'kxdfhei1' USING DFHEIV0,
 11423           DFHEIV1,
 11424           DFHEIV20,
 11425           DFHEIV99,
 11426           TRLR-KEY,
 11427           DFHEIV99,
 11428           DFHEIV99,
 11429           DFHEIV99
 11430     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11431         DFHEIV20
 11432     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 210
* EL131.cbl
 11433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11434           if ws-resp-normal
 11435              move spaces        to at-info-line-1
 11436           end-if
 11437        when s1 = +1
 11438           if ws-resp-normal
 11439
 11440* exec cics rewrite
 11441*                dataset   ('ELTRLR')
 11442*                from      (activity-trailers)
 11443*             end-exec
 11444     MOVE LENGTH OF
 11445      activity-trailers
 11446       TO DFHEIV11
 11447     MOVE 'ELTRLR' TO DFHEIV1
 11448*    MOVE '&& L                  %   #00010342' TO DFHEIV0
 11449     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11450     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11451     MOVE X'2020233030303130333432' TO DFHEIV0(25:11)
 11452     CALL 'kxdfhei1' USING DFHEIV0,
 11453           DFHEIV1,
 11454           activity-trailers,
 11455           DFHEIV11,
 11456           DFHEIV99
 11457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11458           end-if
 11459        when s1 > +1
 11460           if ws-resp-normal
 11461              move ws-dcc-error-line
 11462                                 to at-info-line-1
 11463
 11464* exec cics rewrite
 11465*                dataset   ('ELTRLR')
 11466*                from      (activity-trailers)
 11467*             end-exec
 11468     MOVE LENGTH OF
 11469      activity-trailers
 11470       TO DFHEIV11
 11471     MOVE 'ELTRLR' TO DFHEIV1
 11472*    MOVE '&& L                  %   #00010351' TO DFHEIV0
 11473     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11474     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11475     MOVE X'2020233030303130333531' TO DFHEIV0(25:11)
 11476     CALL 'kxdfhei1' USING DFHEIV0,
 11477           DFHEIV1,
 11478           activity-trailers,
 11479           DFHEIV11,
 11480           DFHEIV99
 11481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11482           else
 11483
 11484* EXEC CICS GETMAIN
 11485*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11486*                LENGTH   (TRLR-LENGTH)
 11487*                INITIMG  (GETMAIN-SPACE)
 11488*             END-EXEC
 11489*    MOVE ',"IL                  $   #00010356' TO DFHEIV0
 11490     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 211
* EL131.cbl
 11491     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11492     MOVE X'2020233030303130333536' TO DFHEIV0(25:11)
 11493     CALL 'kxdfhei1' USING DFHEIV0,
 11494           DFHEIV20,
 11495           TRLR-LENGTH,
 11496           GETMAIN-SPACE
 11497     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11498         DFHEIV20
 11499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11500              move 'AT'          to at-record-id
 11501              move cl-control-primary
 11502                                 to at-control-primary
 11503              move +95           to at-sequence-no
 11504              move '6'           to at-trailer-type
 11505              move ws-dcc-error-line
 11506                                 to at-info-line-1
 11507              move 'E'           to at-info-trailer-type
 11508              move save-bin-date to at-recorded-dt
 11509                                    at-gen-info-last-maint-dt
 11510              move pi-processor-id
 11511                                 to at-recorded-by
 11512                                    at-gen-info-last-updated-by
 11513              move eibtime       to at-last-maint-hhmmss
 11514
 11515* exec cics write
 11516*                dataset   ('ELTRLR')
 11517*                from      (activity-trailers)
 11518*                ridfld    (trlr-key)
 11519*             end-exec
 11520     MOVE LENGTH OF
 11521      activity-trailers
 11522       TO DFHEIV11
 11523     MOVE 'ELTRLR' TO DFHEIV1
 11524*    MOVE '&$ L                  ''   #00010375' TO DFHEIV0
 11525     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11526     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11527     MOVE X'2020233030303130333735' TO DFHEIV0(25:11)
 11528     CALL 'kxdfhei1' USING DFHEIV0,
 11529           DFHEIV1,
 11530           activity-trailers,
 11531           DFHEIV11,
 11532           trlr-key,
 11533           DFHEIV99,
 11534           DFHEIV99
 11535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11536              perform varying s1 from +1 by +1 until
 11537                 ws-error-no (s1) = spaces
 11538                 move ws-error-no (s1)
 11539                                 to emi-error
 11540                 PERFORM 9900-ERROR-FORMAT
 11541                                 THRU 9900-EXIT
 11542              end-perform
 11543           end-if
 11544     end-evaluate
 11545
 11546     .
 11547 2130-exit.
 11548     exit.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 212
* EL131.cbl
 11549 2140-update-elcrtt.
 11550     move ' '                    to crtt-switch
 11551     MOVE CERT-KEY               TO ELCRTT-KEY
 11552     MOVE 'B'                    TO CTRLR-REC-TYPE
 11553
 11554* EXEC CICS READ
 11555*       UPDATE
 11556*       DATASET   ('ELCRTT')
 11557*       RIDFLD    (ELCRTT-KEY)
 11558*       INTO      (CERTIFICATE-TRAILERS)
 11559*       RESP      (WS-RESPONSE)
 11560*    END-EXEC
 11561     MOVE LENGTH OF
 11562      CERTIFICATE-TRAILERS
 11563       TO DFHEIV11
 11564     MOVE 'ELCRTT' TO DFHEIV1
 11565*    MOVE '&"IL       EU         (  N#00010397' TO DFHEIV0
 11566     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11567     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11568     MOVE X'204E233030303130333937' TO DFHEIV0(25:11)
 11569     CALL 'kxdfhei1' USING DFHEIV0,
 11570           DFHEIV1,
 11571           CERTIFICATE-TRAILERS,
 11572           DFHEIV11,
 11573           ELCRTT-KEY,
 11574           DFHEIV99,
 11575           DFHEIV99,
 11576           DFHEIV99
 11577     MOVE EIBRESP  TO WS-RESPONSE
 11578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11579     IF WS-RESP-NORMAL
 11580        perform varying s1 from +1 by +1 until
 11581           (s1 > +24)
 11582           or (cs-claim-no (s1) = cl-claim-no)
 11583        end-perform
 11584        if (s1 < +25)
 11585           if (benperl <> zeros)
 11586              and (cs-benefit-period (s1) not = benperi)
 11587              move benperi       to cs-benefit-period (s1)
 11588              set crtt-update    to true
 11589          end-if
 11590          if (instypel <> zeros)
 11591             and (instypei not = cs-insured-type (s1))
 11592             move instypei      to cs-insured-type (s1)
 11593             set crtt-update    to true
 11594          end-if
 11595          move cs-claim-type (s1) to ws-claim-type
 11596          move cs-benefit-period (s1) to ws-ben-per
 11597        end-if
 11598        if crtt-update
 11599           perform 2150-accum    thru 2150-exit
 11600
 11601* EXEC CICS REWRITE
 11602*             DATASET   ('ELCRTT')
 11603*             FROM      (CERTIFICATE-TRAILERS)
 11604*          END-EXEC
 11605     MOVE LENGTH OF
 11606      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 213
* EL131.cbl
 11607       TO DFHEIV11
 11608     MOVE 'ELCRTT' TO DFHEIV1
 11609*    MOVE '&& L                  %   #00010425' TO DFHEIV0
 11610     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11611     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11612     MOVE X'2020233030303130343235' TO DFHEIV0(25:11)
 11613     CALL 'kxdfhei1' USING DFHEIV0,
 11614           DFHEIV1,
 11615           CERTIFICATE-TRAILERS,
 11616           DFHEIV11,
 11617           DFHEIV99
 11618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11619        else
 11620
 11621* exec cics unlock
 11622*             dataset   ('ELCRTT')
 11623*          end-exec
 11624     MOVE 'ELCRTT' TO DFHEIV1
 11625*    MOVE '&*                    #   #00010430' TO DFHEIV0
 11626     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11627     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11628     MOVE X'2020233030303130343330' TO DFHEIV0(25:11)
 11629     CALL 'kxdfhei1' USING DFHEIV0,
 11630           DFHEIV1,
 11631           DFHEIV99
 11632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11633        end-if
 11634     end-if
 11635     .
 11636 2140-exit.
 11637     exit.
 11638 2150-accum.
 11639     if not erpdef-found
 11640        perform 3997-get-erpdef  thru 3997-exit
 11641     end-if
 11642     if (erpdef-found)
 11643        and (ws-max-moben not = zeros)
 11644        and (ws-max-moben < cm-ah-benefit-amt)
 11645        continue
 11646     else
 11647        move cm-ah-benefit-amt   to ws-max-moben
 11648     end-if
 11649     move cm-ah-orig-term        to ws-max-bens
 11650     if cl-critical-period not = zeros and spaces
 11651        move cl-critical-period  to ws-max-bens
 11652     end-if
 11653     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11654     perform varying s2 from +1 by +1 until
 11655        (s2 > +24)
 11656        or (cs-claim-no (s2) = spaces)
 11657        if (cs-benefit-period (s2) = ws-ben-per)
 11658           and (cs-claim-type (s2) = ws-claim-type)
 11659           and (cs-insured-type (s2) = cl-insured-type)
 11660*          compute ws-tot-days-paid =
 11661*             ws-tot-days-paid + cs-days-paid (s2)
 11662           compute ws-tot-amt-paid =
 11663              ws-tot-amt-paid + cs-total-paid (s2)
 11664        end-if
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 214
* EL131.cbl
 11665     end-perform
 11666     if s2 < +25
 11667        compute ws-pd-bens rounded =
 11668           ws-tot-amt-paid / ws-max-moben
 11669        compute cs-remaining-bens (s1) =
 11670           ws-max-bens - ws-pd-bens
 11671        if cs-remaining-bens (s1) < zeros
 11672           move zeros            to cs-remaining-bens (s1)
 11673        end-if
 11674     end-if
 11675     .
 11676 2150-exit.
 11677     exit.
 11678 2200-MOVE-CERT.
 11679     IF CRTLNMEI GREATER THAN LOW-VALUES
 11680         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11681
 11682     IF CRTFNMEI GREATER THAN LOW-VALUES
 11683         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11684         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11685
 11686     IF CRTINITI GREATER THAN LOW-VALUES
 11687         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11688
 11689     IF CM-INSURED-INITIALS = SPACES
 11690         MOVE '**'               TO CM-INSURED-INITIALS.
 11691
 11692     IF ISSAGEI GREATER THAN LOW-VALUES
 11693         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11694
 11695     IF JNTFNMEI GREATER THAN LOW-VALUES
 11696         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11697
 11698     IF JNTLNMEI GREATER THAN LOW-VALUES
 11699         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11700
 11701     IF JNTINITI GREATER THAN LOW-VALUES
 11702         MOVE JNTINITI           TO CM-JT-INITIAL.
 11703
 11704     IF JNTAGEI GREATER THAN LOW-VALUES
 11705         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11706
 11707     IF ADDONDTI GREATER THAN LOW-VALUES
 11708        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11709
 11710     IF LCVCDI GREATER THAN LOW-VALUES
 11711        IF LCVCDI = SPACES OR ZEROS
 11712           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11713        ELSE
 11714           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11715
 11716     IF LCVOTRMI GREATER THAN LOW-VALUES
 11717         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11718
 11719     IF LCVRATEL GREATER THAN +0
 11720         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11721
 11722     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 215
* EL131.cbl
 11723         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11724
 11725     IF LCVFORMI GREATER THAN LOW-VALUES
 11726         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11727
 11728     IF LCVCNDTI = LOW-VALUES
 11729        GO TO 2210-SET-STATUS.
 11730
 11731     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11732        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11733        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11734        GO TO 2210-SET-STATUS.
 11735
 11736     IF CM-LF-CURRENT-STATUS = '7'
 11737        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11738        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11739        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11740                                    CM-LF-DEATH-DT
 11741        GO TO 2210-SET-STATUS.
 11742
 11743     IF CM-LF-CURRENT-STATUS = '8'
 11744        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11745        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11746                                    CM-LF-CANCEL-DT.
 11747
 11748 2210-SET-STATUS.
 11749
 11750     IF CM-LF-CURRENT-STATUS = SPACES
 11751         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11752
 11753     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11754         MOVE '6'                TO DC-OPTION-CODE
 11755         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11756         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11757         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11758         IF NO-CONVERSION-ERROR
 11759             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11760         ELSE
 11761             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11762     ELSE
 11763         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11764
 11765 2215-PROCESS-AH-SIDE.
 11766
 11767     IF ACVCDI GREATER THAN LOW-VALUES
 11768        IF ACVCDI = SPACES OR ZEROS
 11769           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11770        ELSE
 11771           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11772
 11773     IF ACVOTRMI GREATER THAN LOW-VALUES
 11774         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11775
 11776     IF ACVRATEL GREATER THAN +0
 11777         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11778
 11779     IF ACVBENEL GREATER THAN +0
 11780         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 216
* EL131.cbl
 11781                                    PI-PAYMENT-AMT.
 11782
 11783     IF ACVFORMI GREATER THAN LOW-VALUES
 11784         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11785
 11786     IF ACVCNDTI = LOW-VALUES
 11787        GO TO 2220-SET-STATUS.
 11788
 11789     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11790        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11791        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11792        GO TO 2220-SET-STATUS.
 11793
 11794     IF CM-AH-CURRENT-STATUS = '6'
 11795        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11796                                 TO CM-AH-CURRENT-STATUS
 11797        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11798        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11799                                    CM-AH-SETTLEMENT-DT
 11800        GO TO 2220-SET-STATUS.
 11801
 11802     IF CM-AH-CURRENT-STATUS = '8'
 11803        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11804        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11805                                    CM-AH-CANCEL-DT.
 11806
 11807 2220-SET-STATUS.
 11808     IF CM-AH-CURRENT-STATUS = SPACES
 11809         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11810
 11811     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11812         MOVE '6'                TO DC-OPTION-CODE
 11813         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11814         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11815         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11816         IF NO-CONVERSION-ERROR
 11817             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11818         ELSE
 11819             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11820     ELSE
 11821         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11822
 11823 2225-FINISH-CERT.
 11824     IF APRL GREATER THAN +0
 11825         MOVE HOLD-APR           TO CM-LOAN-APR.
 11826
 11827     IF PMTFREQI GREATER THAN LOW-VALUES
 11828         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11829
 11830     IF INDGRPI GREATER THAN LOW-VALUES
 11831         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11832
 11833     IF LOANNOI GREATER THAN LOW-VALUES
 11834        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11835
 11836     IF LOANBALL GREATER THAN +0
 11837        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11838
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 217
* EL131.cbl
 11839     IF PREMTYPI GREATER THAN LOW-VALUES
 11840         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11841
 11842     IF REINCDI GREATER THAN LOW-VALUES
 11843         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11844                                    WS-REIN-1
 11845                                    WS-REIN-2
 11846                                    WS-REIN-3
 11847         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11848
 11849     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11850
 11851     MOVE ZEROS                  TO CM-LOAN-TERM
 11852                                    CM-LIFE-COMM-PCT
 11853                                    CM-AH-COMM-PCT.
 11854
 11855*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11856*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11857*         PI-NO-PMTS = ZEROS
 11858*          IF LOANBALL GREATER THAN +0          OR
 11859*             ACVBENEL GREATER THAN +0          OR
 11860*             APRL     GREATER THAN +0          OR
 11861*             LCVRATEL GREATER THAN +0          OR
 11862*             ACVRATEL GREATER THAN +0
 11863*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11864
 11865 2200-EXIT.
 11866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 218
* EL131.cbl
 11868 2300-UPDATE-TRLR.
 11869     MOVE ZERO                   TO TRLR-SEQ-NO.
 11870
 11871* EXEC CICS READ UPDATE
 11872*         DATASET  (TRLR-FILE-ID)
 11873*         RIDFLD   (TRLR-KEY)
 11874*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11875*    END-EXEC.
 11876*    MOVE '&"S        EU         (   #00010670' TO DFHEIV0
 11877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11878     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11879     MOVE X'2020233030303130363730' TO DFHEIV0(25:11)
 11880     CALL 'kxdfhei1' USING DFHEIV0,
 11881           TRLR-FILE-ID,
 11882           DFHEIV20,
 11883           DFHEIV99,
 11884           TRLR-KEY,
 11885           DFHEIV99,
 11886           DFHEIV99,
 11887           DFHEIV99
 11888     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11889         DFHEIV20
 11890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11891
 11892
 11893     MOVE ZERO                   TO COUNT-2.
 11894
 11895     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11896         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11897
 11898     IF NOT UPDATE-MADE
 11899         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11900
 11901
 11902* EXEC CICS REWRITE
 11903*         DATASET  (TRLR-FILE-ID)
 11904*         FROM     (ACTIVITY-TRAILERS)
 11905*    END-EXEC.
 11906     MOVE LENGTH OF
 11907      ACTIVITY-TRAILERS
 11908       TO DFHEIV11
 11909*    MOVE '&& L                  %   #00010684' TO DFHEIV0
 11910     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11911     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11912     MOVE X'2020233030303130363834' TO DFHEIV0(25:11)
 11913     CALL 'kxdfhei1' USING DFHEIV0,
 11914           TRLR-FILE-ID,
 11915           ACTIVITY-TRAILERS,
 11916           DFHEIV11,
 11917           DFHEIV99
 11918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11919
 11920
 11921 2300-EXIT.
 11922     EXIT.
 11923
 11924 2310-INS-STATUS.
 11925     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 219
* EL131.cbl
 11926     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11927         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11928         MOVE 'Y'                TO TRLR-SWITCH.
 11929
 11930 2310-EXIT.
 11931     EXIT.
 11932
 11933 2320-SHIFT-STATUS.
 11934     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11935        MOVE 6                   TO COUNT-2
 11936        GO TO 2320-EXIT.
 11937
 11938     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11939     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11940     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11941     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11942     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11943     MOVE 6       TO COUNT-2.
 11944     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11945
 11946 2320-EXIT.
 11947     EXIT.
 11948
 11949 2330-ADD-UPDATE.
 11950
 11951     IF COUNT-2 GREATER THAN 1
 11952        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11953        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11954           GO TO 2330-EXIT.
 11955
 11956     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11957                                   AT-RESERVES-LAST-MAINT-DT
 11958
 11959     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11960     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11961     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11962     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11963
 11964 2330-EXIT.
 11965     EXIT.
 11966
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 220
* EL131.cbl
 11968 2400-UPDATE-TRLR.
 11969
 11970* EXEC CICS HANDLE CONDITION
 11971*         NOTFND    (2400-TRLR-NOTFND)
 11972*         ENDFILE   (2410-EXIT)
 11973*    END-EXEC.
 11974*    MOVE '"$I''                  ! 4 #00010737' TO DFHEIV0
 11975     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11976     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11977     MOVE X'3420233030303130373337' TO DFHEIV0(25:11)
 11978     CALL 'kxdfhei1' USING DFHEIV0
 11979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11980
 11981
 11982
 11983* EXEC CICS STARTBR
 11984*        DATASET (TRLR-FILE-ID)
 11985*        RIDFLD  (TRLR-KEY)
 11986*    END-EXEC.
 11987     MOVE 0
 11988       TO DFHEIV11
 11989*    MOVE '&,         G          &   #00010742' TO DFHEIV0
 11990     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11991     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11992     MOVE X'2020233030303130373432' TO DFHEIV0(25:11)
 11993     CALL 'kxdfhei1' USING DFHEIV0,
 11994           TRLR-FILE-ID,
 11995           TRLR-KEY,
 11996           DFHEIV99,
 11997           DFHEIV11,
 11998           DFHEIV99
 11999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12000
 12001
 12002
 12003* EXEC CICS GETMAIN
 12004*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12005*         LENGTH    (TRLR-LENGTH)
 12006*         INITIMG   (GETMAIN-SPACE)
 12007*    END-EXEC.
 12008*    MOVE ',"IL                  $   #00010747' TO DFHEIV0
 12009     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12010     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12011     MOVE X'2020233030303130373437' TO DFHEIV0(25:11)
 12012     CALL 'kxdfhei1' USING DFHEIV0,
 12013           DFHEIV20,
 12014           TRLR-LENGTH,
 12015           GETMAIN-SPACE
 12016     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12017         DFHEIV20
 12018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12019
 12020
 12021     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12022
 12023
 12024* EXEC CICS ENDBR
 12025*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 221
* EL131.cbl
 12026*    END-EXEC.
 12027     MOVE 0
 12028       TO DFHEIV11
 12029*    MOVE '&2                    $   #00010755' TO DFHEIV0
 12030     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12031     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12032     MOVE X'2020233030303130373535' TO DFHEIV0(25:11)
 12033     CALL 'kxdfhei1' USING DFHEIV0,
 12034           TRLR-FILE-ID,
 12035           DFHEIV11,
 12036           DFHEIV99
 12037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12038
 12039
 12040     GO TO 2400-EXIT.
 12041
 12042 2400-TRLR-NOTFND.
 12043     MOVE ER-0205                TO EMI-ERROR.
 12044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12045     MOVE 'X'                    TO ERROR-SWITCH.
 12046
 12047 2400-EXIT.
 12048     EXIT.
 12049
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 222
* EL131.cbl
 12051 2410-CHANGE-TRLR.
 12052
 12053* EXEC CICS READNEXT
 12054*        DATASET (TRLR-FILE-ID)
 12055*        RIDFLD  (TRLR-KEY)
 12056*        INTO    (ACTIVITY-TRAILERS)
 12057*    END-EXEC.
 12058     MOVE LENGTH OF
 12059      ACTIVITY-TRAILERS
 12060       TO DFHEIV12
 12061     MOVE 0
 12062       TO DFHEIV11
 12063*    MOVE '&.IL                  )   #00010771' TO DFHEIV0
 12064     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12065     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12066     MOVE X'2020233030303130373731' TO DFHEIV0(25:11)
 12067     CALL 'kxdfhei1' USING DFHEIV0,
 12068           TRLR-FILE-ID,
 12069           ACTIVITY-TRAILERS,
 12070           DFHEIV12,
 12071           TRLR-KEY,
 12072           DFHEIV99,
 12073           DFHEIV11,
 12074           DFHEIV99,
 12075           DFHEIV99
 12076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12077
 12078
 12079     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12080        GO TO 2410-CHANGE-TRLR.
 12081
 12082     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12083                                    CHECK-KEY.
 12084
 12085     IF CHECK-KEY NOT = MSTR-KEY
 12086         GO TO 2410-EXIT.
 12087
 12088
 12089* EXEC CICS ENDBR
 12090*        DATASET (TRLR-FILE-ID)
 12091*    END-EXEC.
 12092     MOVE 0
 12093       TO DFHEIV11
 12094*    MOVE '&2                    $   #00010786' TO DFHEIV0
 12095     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12096     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12097     MOVE X'2020233030303130373836' TO DFHEIV0(25:11)
 12098     CALL 'kxdfhei1' USING DFHEIV0,
 12099           TRLR-FILE-ID,
 12100           DFHEIV11,
 12101           DFHEIV99
 12102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12103
 12104
 12105
 12106* EXEC CICS READ UPDATE
 12107*        DATASET (TRLR-FILE-ID)
 12108*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 223
* EL131.cbl
 12109*        INTO    (ACTIVITY-TRAILERS)
 12110*    END-EXEC.
 12111     MOVE LENGTH OF
 12112      ACTIVITY-TRAILERS
 12113       TO DFHEIV11
 12114*    MOVE '&"IL       EU         (   #00010790' TO DFHEIV0
 12115     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12117     MOVE X'2020233030303130373930' TO DFHEIV0(25:11)
 12118     CALL 'kxdfhei1' USING DFHEIV0,
 12119           TRLR-FILE-ID,
 12120           ACTIVITY-TRAILERS,
 12121           DFHEIV11,
 12122           TRLR-KEY,
 12123           DFHEIV99,
 12124           DFHEIV99,
 12125           DFHEIV99
 12126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12127
 12128
 12129
 12130* EXEC CICS DELETE
 12131*        DATASET (TRLR-FILE-ID)
 12132*    END-EXEC.
 12133*    MOVE '&(                    &   #00010796' TO DFHEIV0
 12134     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12135     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12136     MOVE X'2020233030303130373936' TO DFHEIV0(25:11)
 12137     CALL 'kxdfhei1' USING DFHEIV0,
 12138           TRLR-FILE-ID,
 12139           DFHEIV99,
 12140           DFHEIV99,
 12141           DFHEIV99,
 12142           DFHEIV99
 12143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12144
 12145
 12146     IF AT-SEQUENCE-NO = ZERO AND
 12147        TRLR-UPDATE-REQUIRED
 12148         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12149
 12150     IF CERTI GREATER THAN LOW-VALUES
 12151        MOVE CERTI               TO AT-CERT-PRIME.
 12152
 12153     IF SUFXI GREATER THAN LOW-VALUES
 12154        MOVE SUFXI               TO AT-CERT-SFX.
 12155
 12156     IF CERTCARI GREATER THAN LOW-VALUES
 12157        MOVE CERTCARI            TO AT-CARRIER.
 12158
 12159     IF PAYMENT-TR
 12160        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12161           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12162              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12163
 12164     IF CORRESPONDENCE-TR
 12165        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12166           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 224
* EL131.cbl
 12167
 12168
 12169* EXEC CICS WRITE
 12170*         DATASET  (TRLR-FILE-ID)
 12171*         RIDFLD   (AT-CONTROL-PRIMARY)
 12172*         FROM     (ACTIVITY-TRAILERS)
 12173*    END-EXEC.
 12174     MOVE LENGTH OF
 12175      ACTIVITY-TRAILERS
 12176       TO DFHEIV11
 12177*    MOVE '&$ L                  ''   #00010822' TO DFHEIV0
 12178     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12179     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12180     MOVE X'2020233030303130383232' TO DFHEIV0(25:11)
 12181     CALL 'kxdfhei1' USING DFHEIV0,
 12182           TRLR-FILE-ID,
 12183           ACTIVITY-TRAILERS,
 12184           DFHEIV11,
 12185           AT-CONTROL-PRIMARY,
 12186           DFHEIV99,
 12187           DFHEIV99
 12188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12189
 12190
 12191
 12192* EXEC CICS STARTBR
 12193*         DATASET  (TRLR-FILE-ID)
 12194*         RIDFLD   (TRLR-KEY)
 12195*    END-EXEC.
 12196     MOVE 0
 12197       TO DFHEIV11
 12198*    MOVE '&,         G          &   #00010828' TO DFHEIV0
 12199     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12200     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12201     MOVE X'2020233030303130383238' TO DFHEIV0(25:11)
 12202     CALL 'kxdfhei1' USING DFHEIV0,
 12203           TRLR-FILE-ID,
 12204           TRLR-KEY,
 12205           DFHEIV99,
 12206           DFHEIV11,
 12207           DFHEIV99
 12208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12209
 12210
 12211     GO TO 2410-CHANGE-TRLR.
 12212
 12213 2410-EXIT.
 12214     EXIT.
 12215
 12216 2420-UPDATE-TRLR.
 12217     MOVE ZERO TO COUNT-2.
 12218     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12219         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12220
 12221     IF NOT UPDATE-MADE
 12222         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12223
 12224 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 225
* EL131.cbl
 12225     EXIT.
 12226
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 226
* EL131.cbl
 12228 2425-UPDATE-NINETY-TRLR.
 12229
 12230     MOVE +90                    TO TRLR-SEQ-NO.
 12231
 12232
 12233* EXEC CICS HANDLE CONDITION
 12234*         NOTFND    (2425-NINETY-NOTFND)
 12235*         ENDFILE   (2425-NINETY-NOTFND)
 12236*    END-EXEC.
 12237*    MOVE '"$I''                  ! 5 #00010854' TO DFHEIV0
 12238     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12239     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12240     MOVE X'3520233030303130383534' TO DFHEIV0(25:11)
 12241     CALL 'kxdfhei1' USING DFHEIV0
 12242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12243
 12244
 12245
 12246* EXEC CICS READ UPDATE
 12247*        DATASET (TRLR-FILE-ID)
 12248*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12249*        RIDFLD  (TRLR-KEY)
 12250*    END-EXEC.
 12251*    MOVE '&"S        EU         (   #00010859' TO DFHEIV0
 12252     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12253     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12254     MOVE X'2020233030303130383539' TO DFHEIV0(25:11)
 12255     CALL 'kxdfhei1' USING DFHEIV0,
 12256           TRLR-FILE-ID,
 12257           DFHEIV20,
 12258           DFHEIV99,
 12259           TRLR-KEY,
 12260           DFHEIV99,
 12261           DFHEIV99,
 12262           DFHEIV99
 12263     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12264         DFHEIV20
 12265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12266
 12267
 12268     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 12269     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12270     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12271
 12272     IF DIAGI GREATER THAN LOW-VALUES
 12273         MOVE DIAGI             TO AT-INFO-LINE-1
 12274     END-IF.
 12275
 12276     IF ICD1I GREATER THAN LOW-VALUES
 12277         MOVE ICD1I             TO AT-ICD-CODE-1
 12278     END-IF.
 12279
 12280     IF ICD2I GREATER THAN LOW-VALUES
 12281         MOVE ICD2I             TO AT-ICD-CODE-2
 12282     END-IF.
 12283
 12284
 12285* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 227
* EL131.cbl
 12286*        DATASET (TRLR-FILE-ID)
 12287*        FROM    (ACTIVITY-TRAILERS)
 12288*    END-EXEC.
 12289     MOVE LENGTH OF
 12290      ACTIVITY-TRAILERS
 12291       TO DFHEIV11
 12292*    MOVE '&& L                  %   #00010881' TO DFHEIV0
 12293     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12294     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12295     MOVE X'2020233030303130383831' TO DFHEIV0(25:11)
 12296     CALL 'kxdfhei1' USING DFHEIV0,
 12297           TRLR-FILE-ID,
 12298           ACTIVITY-TRAILERS,
 12299           DFHEIV11,
 12300           DFHEIV99
 12301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12302
 12303
 12304     IF DIAGI GREATER THAN LOW-VALUES
 12305       AND DIAGI NOT = WS-DIAGNOSIS
 12306         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12307         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12308         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12309
 12310     IF ICD1I GREATER THAN LOW-VALUES
 12311       AND ICD1I NOT = WS-ICD-CODE-1
 12312         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12313         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12314         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12315     END-IF.
 12316
 12317     IF ICD2I GREATER THAN LOW-VALUES
 12318       AND ICD2I NOT = WS-ICD-CODE-2
 12319         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12320         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12321         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12322     END-IF.
 12323
 12324     GO TO 2425-EXIT.
 12325
 12326 2425-NINETY-NOTFND.
 12327
 12328
 12329* EXEC CICS GETMAIN
 12330*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12331*         LENGTH    (TRLR-LENGTH)
 12332*         INITIMG   (GETMAIN-SPACE)
 12333*    END-EXEC.
 12334*    MOVE ',"IL                  $   #00010910' TO DFHEIV0
 12335     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12336     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12337     MOVE X'2020233030303130393130' TO DFHEIV0(25:11)
 12338     CALL 'kxdfhei1' USING DFHEIV0,
 12339           DFHEIV20,
 12340           TRLR-LENGTH,
 12341           GETMAIN-SPACE
 12342     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12343         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 228
* EL131.cbl
 12344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12345
 12346
 12347     MOVE +90                  TO TRLR-SEQ-NO.
 12348     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12349
 12350     MOVE 'AT'                 TO AT-RECORD-ID
 12351     MOVE '6'                  TO AT-TRAILER-TYPE
 12352     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12353                                  AT-GEN-INFO-LAST-MAINT-DT
 12354     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12355                                  AT-GEN-INFO-LAST-UPDATED-BY
 12356     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12357     MOVE DIAGI                TO AT-INFO-LINE-1.
 12358     MOVE ICD1I                TO AT-ICD-CODE-1.
 12359     MOVE ICD2I                TO AT-ICD-CODE-2.
 12360
 12361
 12362* EXEC CICS WRITE
 12363*        DATASET (TRLR-FILE-ID)
 12364*        FROM    (ACTIVITY-TRAILERS)
 12365*        RIDFLD  (TRLR-KEY)
 12366*    END-EXEC.
 12367     MOVE LENGTH OF
 12368      ACTIVITY-TRAILERS
 12369       TO DFHEIV11
 12370*    MOVE '&$ L                  ''   #00010930' TO DFHEIV0
 12371     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12373     MOVE X'2020233030303130393330' TO DFHEIV0(25:11)
 12374     CALL 'kxdfhei1' USING DFHEIV0,
 12375           TRLR-FILE-ID,
 12376           ACTIVITY-TRAILERS,
 12377           DFHEIV11,
 12378           TRLR-KEY,
 12379           DFHEIV99,
 12380           DFHEIV99
 12381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12382
 12383
 12384 2425-EXIT.
 12385     EXIT.
 12386
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 229
* EL131.cbl
 12388 2430-UPDATE-ACTQ.
 12389
 12390* EXEC CICS HANDLE CONDITION
 12391*         NOTFND    (2430-EXIT)
 12392*         ENDFILE   (2440-EXIT)
 12393*    END-EXEC.
 12394*    MOVE '"$I''                  ! 6 #00010941' TO DFHEIV0
 12395     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12397     MOVE X'3620233030303130393431' TO DFHEIV0(25:11)
 12398     CALL 'kxdfhei1' USING DFHEIV0
 12399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12400
 12401
 12402
 12403* EXEC CICS STARTBR
 12404*         DATASET  (ACTQ-FILE-ID)
 12405*         RIDFLD   (ACTQ-KEY)
 12406*    END-EXEC.
 12407     MOVE 0
 12408       TO DFHEIV11
 12409*    MOVE '&,         G          &   #00010946' TO DFHEIV0
 12410     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12411     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12412     MOVE X'2020233030303130393436' TO DFHEIV0(25:11)
 12413     CALL 'kxdfhei1' USING DFHEIV0,
 12414           ACTQ-FILE-ID,
 12415           ACTQ-KEY,
 12416           DFHEIV99,
 12417           DFHEIV11,
 12418           DFHEIV99
 12419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12420
 12421
 12422
 12423* EXEC CICS GETMAIN
 12424*         SET      (ADDRESS OF ACTIVITY-QUE)
 12425*         LENGTH   (ACTQ-LENGTH)
 12426*         INITIMG  (GETMAIN-SPACE)
 12427*    END-EXEC.
 12428*    MOVE ',"IL                  $   #00010951' TO DFHEIV0
 12429     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12430     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12431     MOVE X'2020233030303130393531' TO DFHEIV0(25:11)
 12432     CALL 'kxdfhei1' USING DFHEIV0,
 12433           DFHEIV20,
 12434           ACTQ-LENGTH,
 12435           GETMAIN-SPACE
 12436     SET ADDRESS OF ACTIVITY-QUE TO
 12437         DFHEIV20
 12438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12439
 12440
 12441     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12442
 12443 2430-EXIT.
 12444     EXIT.
 12445
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 230
* EL131.cbl
 12446 2440-CHANGE-ACTQ.
 12447
 12448
 12449* EXEC CICS READNEXT
 12450*         DATASET  (ACTQ-FILE-ID)
 12451*         RIDFLD   (ACTQ-KEY)
 12452*         INTO     (ACTIVITY-QUE)
 12453*    END-EXEC.
 12454     MOVE LENGTH OF
 12455      ACTIVITY-QUE
 12456       TO DFHEIV12
 12457     MOVE 0
 12458       TO DFHEIV11
 12459*    MOVE '&.IL                  )   #00010964' TO DFHEIV0
 12460     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12461     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12462     MOVE X'2020233030303130393634' TO DFHEIV0(25:11)
 12463     CALL 'kxdfhei1' USING DFHEIV0,
 12464           ACTQ-FILE-ID,
 12465           ACTIVITY-QUE,
 12466           DFHEIV12,
 12467           ACTQ-KEY,
 12468           DFHEIV99,
 12469           DFHEIV11,
 12470           DFHEIV99,
 12471           DFHEIV99
 12472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12473
 12474
 12475
 12476* EXEC CICS ENDBR
 12477*         DATASET (ACTQ-FILE-ID)
 12478*    END-EXEC.
 12479     MOVE 0
 12480       TO DFHEIV11
 12481*    MOVE '&2                    $   #00010970' TO DFHEIV0
 12482     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12483     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12484     MOVE X'2020233030303130393730' TO DFHEIV0(25:11)
 12485     CALL 'kxdfhei1' USING DFHEIV0,
 12486           ACTQ-FILE-ID,
 12487           DFHEIV11,
 12488           DFHEIV99
 12489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12490
 12491
 12492     IF ACTQ-KEY NOT = MSTR-KEY
 12493         GO TO 2440-EXIT.
 12494
 12495
 12496* EXEC CICS READ UPDATE
 12497*         DATASET  (ACTQ-FILE-ID)
 12498*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12499*         SET      (ADDRESS OF ACTIVITY-QUE)
 12500*    END-EXEC.
 12501*    MOVE '&"S        EU         (   #00010977' TO DFHEIV0
 12502     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12503     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 231
* EL131.cbl
 12504     MOVE X'2020233030303130393737' TO DFHEIV0(25:11)
 12505     CALL 'kxdfhei1' USING DFHEIV0,
 12506           ACTQ-FILE-ID,
 12507           DFHEIV20,
 12508           DFHEIV99,
 12509           AQ-CONTROL-PRIMARY,
 12510           DFHEIV99,
 12511           DFHEIV99,
 12512           DFHEIV99
 12513     SET ADDRESS OF ACTIVITY-QUE TO
 12514         DFHEIV20
 12515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12516
 12517
 12518     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12519
 12520
 12521* EXEC CICS DELETE
 12522*         DATASET (ACTQ-FILE-ID)
 12523*    END-EXEC.
 12524*    MOVE '&(                    &   #00010985' TO DFHEIV0
 12525     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12526     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12527     MOVE X'2020233030303130393835' TO DFHEIV0(25:11)
 12528     CALL 'kxdfhei1' USING DFHEIV0,
 12529           ACTQ-FILE-ID,
 12530           DFHEIV99,
 12531           DFHEIV99,
 12532           DFHEIV99,
 12533           DFHEIV99
 12534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12535
 12536
 12537     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12538     IF CERTI GREATER THAN LOW-VALUES
 12539        MOVE CERTI               TO AQ-CERT-PRIME.
 12540     IF SUFXI GREATER THAN LOW-VALUES
 12541        MOVE SUFXI               TO AQ-CERT-SFX.
 12542     IF CERTCARI GREATER THAN LOW-VALUES
 12543        MOVE CERTCARI            TO AQ-CARRIER.
 12544
 12545
 12546* EXEC CICS HANDLE CONDITION
 12547*         DUPREC   (2440-EXIT)
 12548*    END-EXEC.
 12549*    MOVE '"$%                   ! 7 #00010997' TO DFHEIV0
 12550     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12552     MOVE X'3720233030303130393937' TO DFHEIV0(25:11)
 12553     CALL 'kxdfhei1' USING DFHEIV0
 12554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12555
 12556
 12557
 12558* EXEC CICS WRITE
 12559*         DATASET  (ACTQ-FILE-ID)
 12560*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12561*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 232
* EL131.cbl
 12562*    END-EXEC.
 12563     MOVE LENGTH OF
 12564      ACTIVITY-QUE
 12565       TO DFHEIV11
 12566*    MOVE '&$ L                  ''   #00011001' TO DFHEIV0
 12567     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12568     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12569     MOVE X'2020233030303131303031' TO DFHEIV0(25:11)
 12570     CALL 'kxdfhei1' USING DFHEIV0,
 12571           ACTQ-FILE-ID,
 12572           ACTIVITY-QUE,
 12573           DFHEIV11,
 12574           AQ-CONTROL-PRIMARY,
 12575           DFHEIV99,
 12576           DFHEIV99
 12577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12578
 12579
 12580 2440-EXIT.
 12581     EXIT.
 12582
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 233
* EL131.cbl
 12584 2460-UPDATE-CHECKQ.
 12585
 12586* EXEC CICS HANDLE CONDITION
 12587*         NOTFND   (2460-EXIT)
 12588*    END-EXEC.
 12589*    MOVE '"$I                   ! 8 #00011012' TO DFHEIV0
 12590     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12592     MOVE X'3820233030303131303132' TO DFHEIV0(25:11)
 12593     CALL 'kxdfhei1' USING DFHEIV0
 12594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12595
 12596
 12597     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12598     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12599     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12600
 12601
 12602* EXEC CICS READ UPDATE
 12603*         DATASET   (CHKQ-FILE-ID)
 12604*         RIDFLD    (CHKQ-KEY)
 12605*         SET       (ADDRESS OF CHECK-QUE)
 12606*    END-EXEC.
 12607*    MOVE '&"S        EU         (   #00011020' TO DFHEIV0
 12608     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12609     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12610     MOVE X'2020233030303131303230' TO DFHEIV0(25:11)
 12611     CALL 'kxdfhei1' USING DFHEIV0,
 12612           CHKQ-FILE-ID,
 12613           DFHEIV20,
 12614           DFHEIV99,
 12615           CHKQ-KEY,
 12616           DFHEIV99,
 12617           DFHEIV99,
 12618           DFHEIV99
 12619     SET ADDRESS OF CHECK-QUE TO
 12620         DFHEIV20
 12621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12622
 12623
 12624     IF CERTI GREATER THAN LOW-VALUES
 12625        MOVE CERTI               TO CQ-CERT-PRIME.
 12626     IF SUFXI GREATER THAN LOW-VALUES
 12627        MOVE SUFXI               TO CQ-CERT-SFX.
 12628     IF CERTCARI GREATER THAN LOW-VALUES
 12629        MOVE CERTCARI            TO CQ-CARRIER.
 12630
 12631
 12632* EXEC CICS REWRITE
 12633*         DATASET  (CHKQ-FILE-ID)
 12634*         FROM     (CHECK-QUE)
 12635*    END-EXEC.
 12636     MOVE LENGTH OF
 12637      CHECK-QUE
 12638       TO DFHEIV11
 12639*    MOVE '&& L                  %   #00011033' TO DFHEIV0
 12640     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12641     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 234
* EL131.cbl
 12642     MOVE X'2020233030303131303333' TO DFHEIV0(25:11)
 12643     CALL 'kxdfhei1' USING DFHEIV0,
 12644           CHKQ-FILE-ID,
 12645           CHECK-QUE,
 12646           DFHEIV11,
 12647           DFHEIV99
 12648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12649
 12650
 12651 2460-EXIT.
 12652     EXIT.
 12653
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 235
* EL131.cbl
 12655 2475-UPDATE-LETTER.
 12656
 12657* EXEC CICS HANDLE CONDITION
 12658*         NOTFND   (2475-EXIT)
 12659*    END-EXEC.
 12660*    MOVE '"$I                   ! 9 #00011043' TO DFHEIV0
 12661     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12663     MOVE X'3920233030303131303433' TO DFHEIV0(25:11)
 12664     CALL 'kxdfhei1' USING DFHEIV0
 12665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12666
 12667
 12668     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12669     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12670     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12671     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12672
 12673
 12674* EXEC CICS READ UPDATE
 12675*         DATASET   (ARCH-FILE-ID)
 12676*         RIDFLD    (ARCH-KEY)
 12677*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12678*    END-EXEC.
 12679*    MOVE '&"S        EU         (   #00011052' TO DFHEIV0
 12680     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12681     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12682     MOVE X'2020233030303131303532' TO DFHEIV0(25:11)
 12683     CALL 'kxdfhei1' USING DFHEIV0,
 12684           ARCH-FILE-ID,
 12685           DFHEIV20,
 12686           DFHEIV99,
 12687           ARCH-KEY,
 12688           DFHEIV99,
 12689           DFHEIV99,
 12690           DFHEIV99
 12691     SET ADDRESS OF LETTER-ARCHIVE TO
 12692         DFHEIV20
 12693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12694
 12695
 12696* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12697* TO THIS MASTER-KEY INFORMATION.
 12698
 12699     IF LA-CARRIER  = CARRIER-CODE AND
 12700        LA-CLAIM-NO = CLAIM-NO     AND
 12701        LA-CERT-NO  = CERT-NO
 12702        NEXT SENTENCE
 12703     ELSE
 12704        GO TO 2475-UNLOCK.
 12705
 12706     IF CERTI GREATER THAN LOW-VALUES
 12707        MOVE CERTI               TO LA-CERT-PRIME.
 12708     IF SUFXI GREATER THAN LOW-VALUES
 12709        MOVE SUFXI               TO LA-CERT-SFX.
 12710     IF CERTCARI GREATER THAN LOW-VALUES
 12711        MOVE CERTCARI            TO LA-CARRIER.
 12712
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 236
* EL131.cbl
 12713
 12714* EXEC CICS REWRITE
 12715*         DATASET  (ARCH-FILE-ID)
 12716*         FROM     (LETTER-ARCHIVE)
 12717*    END-EXEC.
 12718     MOVE LENGTH OF
 12719      LETTER-ARCHIVE
 12720       TO DFHEIV11
 12721*    MOVE '&& L                  %   #00011075' TO DFHEIV0
 12722     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12723     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12724     MOVE X'2020233030303131303735' TO DFHEIV0(25:11)
 12725     CALL 'kxdfhei1' USING DFHEIV0,
 12726           ARCH-FILE-ID,
 12727           LETTER-ARCHIVE,
 12728           DFHEIV11,
 12729           DFHEIV99
 12730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12731
 12732
 12733     GO TO 2475-EXIT.
 12734
 12735 2475-UNLOCK.
 12736
 12737* EXEC CICS UNLOCK
 12738*         DATASET  (ARCH-FILE-ID)
 12739*    END-EXEC.
 12740*    MOVE '&*                    #   #00011083' TO DFHEIV0
 12741     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12742     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12743     MOVE X'2020233030303131303833' TO DFHEIV0(25:11)
 12744     CALL 'kxdfhei1' USING DFHEIV0,
 12745           ARCH-FILE-ID,
 12746           DFHEIV99
 12747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12748
 12749
 12750 2475-EXIT.
 12751     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 237
* EL131.cbl
 12753 2600-CREATE-MAINT-NOTE.
 12754     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12755     MOVE '1'                    TO CNTL-REC-TYPE.
 12756     MOVE SPACES                 TO CNTL-PROC-ID.
 12757     MOVE ZERO                   TO CNTL-SEQ-NO.
 12758
 12759
 12760* EXEC CICS READ
 12761*         SET        (ADDRESS OF CONTROL-FILE)
 12762*         DATASET    ('ELCNTL')
 12763*         RIDFLD     (CNTL-KEY)
 12764*    END-EXEC.
 12765     MOVE 'ELCNTL' TO DFHEIV1
 12766*    MOVE '&"S        E          (   #00011096' TO DFHEIV0
 12767     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12769     MOVE X'2020233030303131303936' TO DFHEIV0(25:11)
 12770     CALL 'kxdfhei1' USING DFHEIV0,
 12771           DFHEIV1,
 12772           DFHEIV20,
 12773           DFHEIV99,
 12774           CNTL-KEY,
 12775           DFHEIV99,
 12776           DFHEIV99,
 12777           DFHEIV99
 12778     SET ADDRESS OF CONTROL-FILE TO
 12779         DFHEIV20
 12780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12781
 12782
 12783     IF CO-NO-USE-AUDIT-CHANGES
 12784         GO TO 2600-EXIT.
 12785
 12786     IF PROCL GREATER ZERO
 12787     IF PROCI NOT = LOW-VALUES
 12788     IF PROCI NOT = CL-PROCESSOR-ID
 12789         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12790         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12791         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12792
 12793     IF SEXL GREATER ZERO
 12794     IF SEXI NOT = LOW-VALUES
 12795     IF SEXI NOT = CL-INSURED-SEX-CD
 12796         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12797         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12798         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12799
 12800     IF BIRTHL GREATER ZERO
 12801     IF HOLD-BIRTH NOT = LOW-VALUES
 12802     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12803         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12804         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12805         MOVE SPACES               TO DC-OPTION-CODE
 12806         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12807         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12808         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12809
 12810     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 238
* EL131.cbl
 12811     IF SOCIALI NOT = LOW-VALUES
 12812     IF SOCIALI NOT = CL-SOC-SEC-NO
 12813         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12814         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12815         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12816
 12817     IF OCCL GREATER ZERO
 12818     IF OCCI NOT = LOW-VALUES
 12819     IF OCCI NOT = CL-INSURED-OCC-CD
 12820         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12821         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12822         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12823
 12824     IF BENEL GREATER ZERO
 12825     IF BENEI NOT = LOW-VALUES
 12826     IF BENEI NOT = CL-BENEFICIARY
 12827         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12828         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12829         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12830
 12831     IF PREMTYPL GREATER ZERO
 12832     IF PREMTYPI NOT = LOW-VALUES
 12833     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12834         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12835         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12836         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12837
 12838*    IF CAUSEL GREATER ZERO
 12839*    IF CAUSEI NOT = LOW-VALUES
 12840*    IF CAUSEI NOT = CL-CAUSE-CD
 12841*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12842*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12843*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12844
 12845*    IF ENDL GREATER ZERO
 12846*    IF HOLD-END NOT = LOW-VALUES
 12847*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12848*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 12849*        MOVE CL-EST-END-OF-DISAB-DT
 12850*                                  TO DC-BIN-DATE-1
 12851*        MOVE SPACES               TO DC-OPTION-CODE
 12852*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12853*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12854*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12855
 12856     IF PDTHRUL GREATER ZERO
 12857     IF HOLD-PDTHRU NOT = LOW-VALUES
 12858     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12859         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12860         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12861         MOVE SPACES               TO DC-OPTION-CODE
 12862         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12863         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12864         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12865
 12866     IF PDAMTL GREATER ZERO
 12867     IF HOLD-PDAMT NOT = ZEROS
 12868     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 239
* EL131.cbl
 12869         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12870         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12871         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12872         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12873
 12874     IF NODAYSL GREATER ZERO
 12875     IF HOLD-NODAYS NOT = ZEROS
 12876     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12877         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12878         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12879         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12880         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12881
 12882     IF NOPMTSL GREATER ZERO
 12883     IF HOLD-NOPMTS NOT = ZEROS
 12884     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12885         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12886         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12887         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12888         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12889
 12890     IF FORMTYPL GREATER ZERO
 12891     IF FORMTYPI NOT = LOW-VALUES
 12892     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12893         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12894         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12895         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12896
 12897     IF REPL GREATER ZERO
 12898     IF HOLD-REPORTED NOT = LOW-VALUES
 12899     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12900         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12901         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12902         MOVE SPACES               TO DC-OPTION-CODE
 12903         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12904         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12905         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12906
 12907     IF ADDONDTL GREATER ZERO
 12908     IF HOLD-ADDON NOT = LOW-VALUES
 12909     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12910         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12911         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12912         MOVE SPACES               TO DC-OPTION-CODE
 12913         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12914         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12915         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12916
 12917     IF PRICDL GREATER ZERO
 12918     IF PRICDI NOT = LOW-VALUES
 12919     IF PRICDI NOT = CL-PRIORITY-CD
 12920         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12921         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12922         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12923
 12924     IF FILETOL GREATER ZERO
 12925     IF FILETOI NOT = LOW-VALUES
 12926     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 240
* EL131.cbl
 12927         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12928         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12929         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12930
 12931     IF SUPVL GREATER ZERO
 12932     IF SUPVI NOT = LOW-VALUES
 12933     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12934         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12935         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12936         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12937*    IF (CRITPTL > ZERO)
 12938*       AND (CRITPTI NOT = LOW-VALUES)
 12939*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12940*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12941*       MOVE CL-CRIT-PER-RECURRENT
 12942*                                TO SPLIT-INFO-OLD
 12943*       PERFORM 2650-WRITE-MAINT-NOTE
 12944*                                THRU 2650-EXIT
 12945*    END-IF
 12946
 12947*    IF (RTWMOSL > ZERO)
 12948*       AND (RTWMOSI NOT = LOW-VALUES)
 12949*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12950*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12951*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12952*       PERFORM 2650-WRITE-MAINT-NOTE
 12953*                                THRU 2650-EXIT
 12954*    END-IF
 12955     IF MLNAMEL GREATER ZERO
 12956     IF MLNAMEI NOT = LOW-VALUES
 12957     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12958         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12959         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12960         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12961
 12962     IF MFNAMEL GREATER ZERO
 12963     IF MFNAMEI NOT = LOW-VALUES
 12964     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12965         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12966         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12967         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12968
 12969     IF MMINITL GREATER ZERO
 12970     IF MMINITI NOT = LOW-VALUES
 12971     IF MMINITI NOT = CL-INSURED-MID-INIT
 12972         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12973         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12974         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12975
 12976     IF CERTEFFL GREATER ZERO
 12977     IF HOLD-EFF NOT = LOW-VALUES
 12978     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12979         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12980         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12981         MOVE SPACES               TO DC-OPTION-CODE
 12982         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12983         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12984         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 241
* EL131.cbl
 12985
 12986     IF CERTACTL GREATER ZERO
 12987     IF CERTACTI NOT = LOW-VALUES
 12988     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12989         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12990         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12991         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12992
 12993     IF CERTSTL GREATER ZERO
 12994     IF CERTSTI NOT = LOW-VALUES
 12995     IF CERTSTI NOT = CL-CERT-STATE
 12996         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 12997         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 12998         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12999
 13000     IF CERTCARL GREATER ZERO
 13001     IF CERTCARI NOT = LOW-VALUES
 13002     IF CERTCARI NOT = CL-CERT-CARRIER
 13003         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13004         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13005         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13006
 13007     IF CERTGRPL GREATER ZERO
 13008     IF CERTGRPI NOT = LOW-VALUES
 13009     IF CERTGRPI NOT = CL-CERT-GROUPING
 13010         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13011         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13012         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13013
 13014     IF CERTL GREATER ZERO OR
 13015        SUFXL GREATER ZERO
 13016     IF (CERTI NOT = LOW-VALUES AND
 13017                     CL-CERT-PRIME)
 13018                OR
 13019        (SUFXI NOT = LOW-VALUES AND
 13020                     CL-CERT-SFX)
 13021         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13022         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13023         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13024     IF incl > zeros
 13025        IF (HOLD-INCUR NOT = LOW-VALUES)
 13026           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13027           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13028           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13029           MOVE SPACES           TO DC-OPTION-CODE
 13030           PERFORM 9800-CONVERT-DATE
 13031                                 THRU 9800-EXIT
 13032           MOVE DC-GREG-DATE-1-EDIT
 13033                                 TO SPLIT-INFO-OLD
 13034           PERFORM 2650-WRITE-MAINT-NOTE
 13035                                 THRU 2650-EXIT
 13036        END-IF
 13037     END-IF
 13038     .
 13039 2600-EXIT.
 13040      EXIT.
 13041
 13042 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 242
* EL131.cbl
 13043
 13044* EXEC CICS GETMAIN
 13045*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13046*         LENGTH   (TRLR-LENGTH)
 13047*         INITIMG  (GETMAIN-SPACE)
 13048*    END-EXEC.
 13049*    MOVE ',"IL                  $   #00011362' TO DFHEIV0
 13050     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13051     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13052     MOVE X'2020233030303131333632' TO DFHEIV0(25:11)
 13053     CALL 'kxdfhei1' USING DFHEIV0,
 13054           DFHEIV20,
 13055           TRLR-LENGTH,
 13056           GETMAIN-SPACE
 13057     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13058         DFHEIV20
 13059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13060
 13061
 13062
 13063* EXEC CICS HANDLE CONDITION
 13064*         DUPREC   (2650-EXIT)
 13065*    END-EXEC.
 13066*    MOVE '"$%                   ! : #00011368' TO DFHEIV0
 13067     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13069     MOVE X'3A20233030303131333638' TO DFHEIV0(25:11)
 13070     CALL 'kxdfhei1' USING DFHEIV0
 13071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13072
 13073
 13074     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13075
 13076     IF CERTL GREATER ZERO
 13077         MOVE CERTI          TO CL-CERT-PRIME.
 13078
 13079     IF SUFXL GREATER ZERO
 13080         MOVE SUFXI          TO CL-CERT-SFX.
 13081
 13082     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13083
 13084     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13085     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13086
 13087     MOVE 'AT'               TO AT-RECORD-ID.
 13088
 13089     MOVE '6'                TO AT-TRAILER-TYPE.
 13090     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13091                                AT-GEN-INFO-LAST-MAINT-DT.
 13092     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13093                                AT-GEN-INFO-LAST-UPDATED-BY.
 13094     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13095     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13096     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13097
 13098
 13099* EXEC CICS WRITE
 13100*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 243
* EL131.cbl
 13101*         RIDFLD   (AT-CONTROL-PRIMARY)
 13102*         FROM     (ACTIVITY-TRAILERS)
 13103*    END-EXEC.
 13104     MOVE LENGTH OF
 13105      ACTIVITY-TRAILERS
 13106       TO DFHEIV11
 13107*    MOVE '&$ L                  ''   #00011396' TO DFHEIV0
 13108     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13109     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13110     MOVE X'2020233030303131333936' TO DFHEIV0(25:11)
 13111     CALL 'kxdfhei1' USING DFHEIV0,
 13112           TRLR-FILE-ID,
 13113           ACTIVITY-TRAILERS,
 13114           DFHEIV11,
 13115           AT-CONTROL-PRIMARY,
 13116           DFHEIV99,
 13117           DFHEIV99
 13118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13119
 13120
 13121 2650-EXIT.
 13122      EXIT.
 13123
 13124 2800-CHECK-AUTO-PAY.
 13125
 13126     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13127     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13128     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13129     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13130     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13131
 13132
 13133* EXEC CICS HANDLE CONDITION
 13134*         NOTFND    (2800-EXIT)
 13135*         ENDFILE   (2800-EXIT)
 13136*    END-EXEC.
 13137*    MOVE '"$I''                  ! ; #00011413' TO DFHEIV0
 13138     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13140     MOVE X'3B20233030303131343133' TO DFHEIV0(25:11)
 13141     CALL 'kxdfhei1' USING DFHEIV0
 13142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13143
 13144
 13145
 13146* EXEC CICS READ
 13147*        DATASET (TRLR-FILE-ID)
 13148*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13149*        RIDFLD  (TRLR-KEY)
 13150*    END-EXEC.
 13151*    MOVE '&"S        E          (   #00011418' TO DFHEIV0
 13152     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13154     MOVE X'2020233030303131343138' TO DFHEIV0(25:11)
 13155     CALL 'kxdfhei1' USING DFHEIV0,
 13156           TRLR-FILE-ID,
 13157           DFHEIV20,
 13158           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 244
* EL131.cbl
 13159           TRLR-KEY,
 13160           DFHEIV99,
 13161           DFHEIV99,
 13162           DFHEIV99
 13163     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13164         DFHEIV20
 13165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13166
 13167
 13168     IF BENEFICIARY-PAID-AUTO
 13169         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13170     END-IF.
 13171
 13172 2800-EXIT.
 13173      EXIT.
 13174
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 245
* EL131.cbl
 13176 3000-DELETE-CLAIM.
 13177     IF  NOT MODIFY-CAP
 13178         MOVE ER-0070            TO EMI-ERROR
 13179         MOVE -1                 TO MAINTL
 13180         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13181         GO TO 8110-SEND-DATA.
 13182
 13183
 13184* EXEC CICS READ
 13185*         SET      (ADDRESS OF CLAIM-MASTER)
 13186*         DATASET  (CLMS-FILE-ID)
 13187*         RIDFLD   (MSTR-KEY)
 13188*    END-EXEC.
 13189*    MOVE '&"S        E          (   #00011439' TO DFHEIV0
 13190     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13191     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13192     MOVE X'2020233030303131343339' TO DFHEIV0(25:11)
 13193     CALL 'kxdfhei1' USING DFHEIV0,
 13194           CLMS-FILE-ID,
 13195           DFHEIV20,
 13196           DFHEIV99,
 13197           MSTR-KEY,
 13198           DFHEIV99,
 13199           DFHEIV99,
 13200           DFHEIV99
 13201     SET ADDRESS OF CLAIM-MASTER TO
 13202         DFHEIV20
 13203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13204
 13205
 13206     IF CL-1ST-TRL-AVAIL
 13207         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13208     ELSE
 13209        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13210        MOVE 0                   TO TRLR-SEQ-NO
 13211
 13212* EXEC CICS STARTBR
 13213*            DATASET (TRLR-FILE-ID)
 13214*            RIDFLD  (TRLR-KEY)
 13215*        END-EXEC
 13216     MOVE 0
 13217       TO DFHEIV11
 13218*    MOVE '&,         G          &   #00011450' TO DFHEIV0
 13219     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13220     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13221     MOVE X'2020233030303131343530' TO DFHEIV0(25:11)
 13222     CALL 'kxdfhei1' USING DFHEIV0,
 13223           TRLR-FILE-ID,
 13224           TRLR-KEY,
 13225           DFHEIV99,
 13226           DFHEIV11,
 13227           DFHEIV99
 13228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13229         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13230
 13231* EXEC CICS ENDBR
 13232*            DATASET (TRLR-FILE-ID)
 13233*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 246
* EL131.cbl
 13234     MOVE 0
 13235       TO DFHEIV11
 13236*    MOVE '&2                    $   #00011455' TO DFHEIV0
 13237     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13238     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13239     MOVE X'2020233030303131343535' TO DFHEIV0(25:11)
 13240     CALL 'kxdfhei1' USING DFHEIV0,
 13241           TRLR-FILE-ID,
 13242           DFHEIV11,
 13243           DFHEIV99
 13244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13245        IF SCREEN-ERROR
 13246            MOVE ER-0208         TO EMI-ERROR
 13247            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13248            MOVE -1              TO MAINTL
 13249            GO TO 8110-SEND-DATA
 13250        ELSE
 13251            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13252
 13253     IF SCREEN-ERROR
 13254         MOVE -1                 TO MAINTL
 13255         GO TO 8110-SEND-DATA.
 13256
 13257     MOVE -1                     TO ONE-OR-MIN1.
 13258     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13259
 13260     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13261         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13262                                    WS-SAVE-CLAIM-KEY
 13263         MOVE +1                 TO ONE-OR-MIN1
 13264         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13265
 13266     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13267
 13268     MOVE LOW-VALUES             TO EL131AO.
 13269     MOVE ER-0000                TO EMI-ERROR.
 13270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13271     MOVE 'X'                    TO PI-RETURN-CD-1.
 13272     MOVE -1                     TO MAINTL.
 13273     GO TO 8100-SEND-MAP.
 13274
 13275 3010-DEL-MSTR-TRLR.
 13276
 13277* EXEC CICS READ UPDATE
 13278*         SET       (ADDRESS OF CLAIM-MASTER)
 13279*         DATASET   (CLMS-FILE-ID)
 13280*         RIDFLD    (MSTR-KEY)
 13281*    END-EXEC.
 13282*    MOVE '&"S        EU         (   #00011489' TO DFHEIV0
 13283     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13284     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13285     MOVE X'2020233030303131343839' TO DFHEIV0(25:11)
 13286     CALL 'kxdfhei1' USING DFHEIV0,
 13287           CLMS-FILE-ID,
 13288           DFHEIV20,
 13289           DFHEIV99,
 13290           MSTR-KEY,
 13291           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 247
* EL131.cbl
 13292           DFHEIV99,
 13293           DFHEIV99
 13294     SET ADDRESS OF CLAIM-MASTER TO
 13295         DFHEIV20
 13296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13297
 13298
 13299     if (cl-priority-cd = '8')
 13300        and (pi-processor-id not = 'PEMA' and 'JMS '
 13301             AND 'AMWA')
 13302        MOVE ER-8003             TO EMI-ERROR
 13303        PERFORM 9900-ERROR-FORMAT
 13304                                 THRU 9900-EXIT
 13305        MOVE -1                  TO MAINTL
 13306        GO TO 8110-SEND-DATA
 13307     end-if
 13308
 13309     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13310     MOVE ZERO                   TO TRLR-SEQ-NO.
 13311
 13312
 13313* EXEC CICS HANDLE CONDITION
 13314*         NOTFND    (3010-DEL-ACTQ)
 13315*         ENDFILE   (3040-EXIT)
 13316*    END-EXEC.
 13317*    MOVE '"$I''                  ! < #00011508' TO DFHEIV0
 13318     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13320     MOVE X'3C20233030303131353038' TO DFHEIV0(25:11)
 13321     CALL 'kxdfhei1' USING DFHEIV0
 13322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13323
 13324
 13325     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13326
 13327 3010-DEL-ACTQ.
 13328
 13329
 13330* EXEC CICS HANDLE CONDITION
 13331*         NOTFND    (3010-NO-ACTIVITY)
 13332*         ENDFILE   (3050-EXIT)
 13333*    END-EXEC.
 13334*    MOVE '"$I''                  ! = #00011517' TO DFHEIV0
 13335     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13337     MOVE X'3D20233030303131353137' TO DFHEIV0(25:11)
 13338     CALL 'kxdfhei1' USING DFHEIV0
 13339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13340
 13341
 13342
 13343* EXEC CICS STARTBR
 13344*         DATASET  (ACTQ-FILE-ID)
 13345*         RIDFLD   (ACTQ-KEY)
 13346*    END-EXEC.
 13347     MOVE 0
 13348       TO DFHEIV11
 13349*    MOVE '&,         G          &   #00011522' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 248
* EL131.cbl
 13350     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13351     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13352     MOVE X'2020233030303131353232' TO DFHEIV0(25:11)
 13353     CALL 'kxdfhei1' USING DFHEIV0,
 13354           ACTQ-FILE-ID,
 13355           ACTQ-KEY,
 13356           DFHEIV99,
 13357           DFHEIV11,
 13358           DFHEIV99
 13359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13360
 13361
 13362
 13363* EXEC CICS GETMAIN
 13364*         SET      (ADDRESS OF ACTIVITY-QUE)
 13365*         LENGTH   (ACTQ-LENGTH)
 13366*         INITIMG  (GETMAIN-SPACE)
 13367*    END-EXEC.
 13368*    MOVE ',"IL                  $   #00011527' TO DFHEIV0
 13369     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13370     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13371     MOVE X'2020233030303131353237' TO DFHEIV0(25:11)
 13372     CALL 'kxdfhei1' USING DFHEIV0,
 13373           DFHEIV20,
 13374           ACTQ-LENGTH,
 13375           GETMAIN-SPACE
 13376     SET ADDRESS OF ACTIVITY-QUE TO
 13377         DFHEIV20
 13378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13379
 13380
 13381     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13382
 13383
 13384* EXEC CICS ENDBR
 13385*         DATASET (ACTQ-FILE-ID)
 13386*    END-EXEC.
 13387     MOVE 0
 13388       TO DFHEIV11
 13389*    MOVE '&2                    $   #00011535' TO DFHEIV0
 13390     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13391     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13392     MOVE X'2020233030303131353335' TO DFHEIV0(25:11)
 13393     CALL 'kxdfhei1' USING DFHEIV0,
 13394           ACTQ-FILE-ID,
 13395           DFHEIV11,
 13396           DFHEIV99
 13397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13398
 13399
 13400 3010-NO-ACTIVITY.
 13401
 13402
 13403* EXEC CICS HANDLE CONDITION
 13404*        NOTFND   (3010-CERT-NOT-FOUND)
 13405*    END-EXEC.
 13406*    MOVE '"$I                   ! > #00011541' TO DFHEIV0
 13407     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 249
* EL131.cbl
 13408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13409     MOVE X'3E20233030303131353431' TO DFHEIV0(25:11)
 13410     CALL 'kxdfhei1' USING DFHEIV0
 13411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13412
 13413
 13414     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13415     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13416     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13417     MOVE CL-CERT-STATE          TO CERT-STATE.
 13418     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13419     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13420     MOVE CL-CERT-NO             TO CERT-CERT.
 13421
 13422
 13423* EXEC CICS READ
 13424*        DATASET   (CERT-FILE-ID)
 13425*        RIDFLD    (CERT-KEY)
 13426*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13427*    END-EXEC.
 13428*    MOVE '&"S        E          (   #00011553' TO DFHEIV0
 13429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13431     MOVE X'2020233030303131353533' TO DFHEIV0(25:11)
 13432     CALL 'kxdfhei1' USING DFHEIV0,
 13433           CERT-FILE-ID,
 13434           DFHEIV20,
 13435           DFHEIV99,
 13436           CERT-KEY,
 13437           DFHEIV99,
 13438           DFHEIV99,
 13439           DFHEIV99
 13440     SET ADDRESS OF CERTIFICATE-MASTER TO
 13441         DFHEIV20
 13442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13443
 13444
 13445     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13446       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13447         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13448     ELSE
 13449         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13450
 13451 3010-UPDATE-CERT-TRLR.
 13452
 13453     MOVE CERT-KEY               TO ELCRTT-KEY
 13454     MOVE 'B'                    TO CTRLR-REC-TYPE
 13455
 13456* EXEC CICS READ
 13457*       UPDATE
 13458*       DATASET   ('ELCRTT')
 13459*       RIDFLD    (ELCRTT-KEY)
 13460*       INTO      (CERTIFICATE-TRAILERS)
 13461*       RESP      (WS-RESPONSE)
 13462*    END-EXEC
 13463     MOVE LENGTH OF
 13464      CERTIFICATE-TRAILERS
 13465       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 250
* EL131.cbl
 13466     MOVE 'ELCRTT' TO DFHEIV1
 13467*    MOVE '&"IL       EU         (  N#00011569' TO DFHEIV0
 13468     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13469     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13470     MOVE X'204E233030303131353639' TO DFHEIV0(25:11)
 13471     CALL 'kxdfhei1' USING DFHEIV0,
 13472           DFHEIV1,
 13473           CERTIFICATE-TRAILERS,
 13474           DFHEIV11,
 13475           ELCRTT-KEY,
 13476           DFHEIV99,
 13477           DFHEIV99,
 13478           DFHEIV99
 13479     MOVE EIBRESP  TO WS-RESPONSE
 13480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13481     IF WS-RESP-NORMAL
 13482        perform varying s1 from +1 by +1 until
 13483           (s1 > +24)
 13484           or (cs-claim-no (s1) = cl-claim-no)
 13485        end-perform
 13486        if s1 < +25
 13487           move spaces           to cs-claim-no (s1)
 13488                                    cs-claim-type (s1)
 13489                                    cs-insured-type (s1)
 13490           move zeros            to cs-days-paid (s1)
 13491                                    cs-total-paid (s1)
 13492                                    cs-benefit-period (s1)
 13493           if s1 not = +24
 13494              compute s2 = s1 + +1
 13495              perform 3015-bump  thru 3015-exit
 13496           end-if
 13497
 13498* EXEC CICS REWRITE
 13499*             DATASET   ('ELCRTT')
 13500*             FROM      (CERTIFICATE-TRAILERS)
 13501*          END-EXEC
 13502     MOVE LENGTH OF
 13503      CERTIFICATE-TRAILERS
 13504       TO DFHEIV11
 13505     MOVE 'ELCRTT' TO DFHEIV1
 13506*    MOVE '&& L                  %   #00011592' TO DFHEIV0
 13507     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13508     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13509     MOVE X'2020233030303131353932' TO DFHEIV0(25:11)
 13510     CALL 'kxdfhei1' USING DFHEIV0,
 13511           DFHEIV1,
 13512           CERTIFICATE-TRAILERS,
 13513           DFHEIV11,
 13514           DFHEIV99
 13515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13516        end-if
 13517     end-if
 13518     .
 13519 3010-CERT-NOT-FOUND.
 13520
 13521
 13522* EXEC CICS DELETE
 13523*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 251
* EL131.cbl
 13524*    END-EXEC.
 13525*    MOVE '&(                    &   #00011601' TO DFHEIV0
 13526     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13527     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13528     MOVE X'2020233030303131363031' TO DFHEIV0(25:11)
 13529     CALL 'kxdfhei1' USING DFHEIV0,
 13530           CLMS-FILE-ID,
 13531           DFHEIV99,
 13532           DFHEIV99,
 13533           DFHEIV99,
 13534           DFHEIV99
 13535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13536
 13537
 13538 3010-EXIT.
 13539      EXIT.
 13540
 13541 3015-bump.
 13542     perform varying s2 from s2 by +1 until s2 > +24
 13543        move cs-mb-claim-data (s2)
 13544                                 to cs-mb-claim-data (s1)
 13545        move spaces              to cs-mb-claim-data (s2)
 13546        add +1 to s1
 13547     end-perform
 13548     .
 13549 3015-exit.
 13550     exit.
 13551 3020-UPDATE-CERT.
 13552
 13553* EXEC CICS READ UPDATE
 13554*         DATASET  (CERT-FILE-ID)
 13555*         RIDFLD   (CERT-KEY)
 13556*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13557*    END-EXEC.
 13558*    MOVE '&"S        EU         (   #00011619' TO DFHEIV0
 13559     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13560     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13561     MOVE X'2020233030303131363139' TO DFHEIV0(25:11)
 13562     CALL 'kxdfhei1' USING DFHEIV0,
 13563           CERT-FILE-ID,
 13564           DFHEIV20,
 13565           DFHEIV99,
 13566           CERT-KEY,
 13567           DFHEIV99,
 13568           DFHEIV99,
 13569           DFHEIV99
 13570     SET ADDRESS OF CERTIFICATE-MASTER TO
 13571         DFHEIV20
 13572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13573
 13574
 13575     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13576
 13577
 13578* EXEC CICS HANDLE CONDITION
 13579*         DUPKEY   (3020-EXIT)
 13580*    END-EXEC.
 13581*    MOVE '"$$                   ! ? #00011627' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 252
* EL131.cbl
 13582     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13583     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13584     MOVE X'3F20233030303131363237' TO DFHEIV0(25:11)
 13585     CALL 'kxdfhei1' USING DFHEIV0
 13586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13587
 13588
 13589
 13590* EXEC CICS REWRITE
 13591*         DATASET  (CERT-FILE-ID)
 13592*         FROM     (CERTIFICATE-MASTER)
 13593*    END-EXEC.
 13594     MOVE LENGTH OF
 13595      CERTIFICATE-MASTER
 13596       TO DFHEIV11
 13597*    MOVE '&& L                  %   #00011631' TO DFHEIV0
 13598     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13599     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13600     MOVE X'2020233030303131363331' TO DFHEIV0(25:11)
 13601     CALL 'kxdfhei1' USING DFHEIV0,
 13602           CERT-FILE-ID,
 13603           CERTIFICATE-MASTER,
 13604           DFHEIV11,
 13605           DFHEIV99
 13606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13607
 13608
 13609 3020-EXIT.
 13610     EXIT.
 13611
 13612 3030-DELETE-CERT.
 13613
 13614* EXEC CICS READ UPDATE
 13615*         DATASET  (CERT-FILE-ID)
 13616*         RIDFLD   (CERT-KEY)
 13617*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13618*    END-EXEC.
 13619*    MOVE '&"S        EU         (   #00011640' TO DFHEIV0
 13620     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13621     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13622     MOVE X'2020233030303131363430' TO DFHEIV0(25:11)
 13623     CALL 'kxdfhei1' USING DFHEIV0,
 13624           CERT-FILE-ID,
 13625           DFHEIV20,
 13626           DFHEIV99,
 13627           CERT-KEY,
 13628           DFHEIV99,
 13629           DFHEIV99,
 13630           DFHEIV99
 13631     SET ADDRESS OF CERTIFICATE-MASTER TO
 13632         DFHEIV20
 13633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13634
 13635
 13636
 13637* EXEC CICS DELETE
 13638*         DATASET   (CERT-FILE-ID)
 13639*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 253
* EL131.cbl
 13640*    MOVE '&(                    &   #00011646' TO DFHEIV0
 13641     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13642     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13643     MOVE X'2020233030303131363436' TO DFHEIV0(25:11)
 13644     CALL 'kxdfhei1' USING DFHEIV0,
 13645           CERT-FILE-ID,
 13646           DFHEIV99,
 13647           DFHEIV99,
 13648           DFHEIV99,
 13649           DFHEIV99
 13650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13651
 13652
 13653 3030-EXIT.
 13654     EXIT.
 13655
 13656 3040-DELETE-TRLR.
 13657
 13658* EXEC CICS READ
 13659*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13660*         DATASET  (TRLR-FILE-ID)
 13661*         RIDFLD   (TRLR-KEY)
 13662*         GTEQ
 13663*    END-EXEC.
 13664*    MOVE '&"S        G          (   #00011654' TO DFHEIV0
 13665     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13667     MOVE X'2020233030303131363534' TO DFHEIV0(25:11)
 13668     CALL 'kxdfhei1' USING DFHEIV0,
 13669           TRLR-FILE-ID,
 13670           DFHEIV20,
 13671           DFHEIV99,
 13672           TRLR-KEY,
 13673           DFHEIV99,
 13674           DFHEIV99,
 13675           DFHEIV99
 13676     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13677         DFHEIV20
 13678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13679
 13680
 13681     IF PI-COMPANY-CD = AT-COMPANY-CD
 13682        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13683        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13684           GO TO 3040-EXIT
 13685        ELSE
 13686           NEXT SENTENCE
 13687     ELSE
 13688        GO TO 3040-EXIT.
 13689
 13690
 13691* EXEC CICS DELETE
 13692*         DATASET  (TRLR-FILE-ID)
 13693*         RIDFLD   (TRLR-KEY)
 13694*    END-EXEC.
 13695*    MOVE '&(  R                 &   #00011670' TO DFHEIV0
 13696     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13697     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 254
* EL131.cbl
 13698     MOVE X'2020233030303131363730' TO DFHEIV0(25:11)
 13699     CALL 'kxdfhei1' USING DFHEIV0,
 13700           TRLR-FILE-ID,
 13701           TRLR-KEY,
 13702           DFHEIV99,
 13703           DFHEIV99,
 13704           DFHEIV99
 13705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13706
 13707
 13708     GO TO 3040-DELETE-TRLR.
 13709
 13710 3040-EXIT.
 13711     EXIT.
 13712
 13713 3050-DELETE-ACTQ.
 13714
 13715* EXEC CICS READNEXT
 13716*         DATASET  (ACTQ-FILE-ID)
 13717*         RIDFLD   (ACTQ-KEY)
 13718*         INTO     (ACTIVITY-QUE)
 13719*    END-EXEC.
 13720     MOVE LENGTH OF
 13721      ACTIVITY-QUE
 13722       TO DFHEIV12
 13723     MOVE 0
 13724       TO DFHEIV11
 13725*    MOVE '&.IL                  )   #00011681' TO DFHEIV0
 13726     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13727     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13728     MOVE X'2020233030303131363831' TO DFHEIV0(25:11)
 13729     CALL 'kxdfhei1' USING DFHEIV0,
 13730           ACTQ-FILE-ID,
 13731           ACTIVITY-QUE,
 13732           DFHEIV12,
 13733           ACTQ-KEY,
 13734           DFHEIV99,
 13735           DFHEIV11,
 13736           DFHEIV99,
 13737           DFHEIV99
 13738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13739
 13740
 13741     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13742         GO TO 3050-EXIT.
 13743
 13744
 13745* EXEC CICS ENDBR
 13746*         DATASET  (ACTQ-FILE-ID)
 13747*    END-EXEC.
 13748     MOVE 0
 13749       TO DFHEIV11
 13750*    MOVE '&2                    $   #00011690' TO DFHEIV0
 13751     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13752     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13753     MOVE X'2020233030303131363930' TO DFHEIV0(25:11)
 13754     CALL 'kxdfhei1' USING DFHEIV0,
 13755           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 255
* EL131.cbl
 13756           DFHEIV11,
 13757           DFHEIV99
 13758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13759
 13760
 13761
 13762* EXEC CICS DELETE
 13763*         DATASET   (ACTQ-FILE-ID)
 13764*         RIDFLD    (ACTQ-KEY)
 13765*    END-EXEC.
 13766*    MOVE '&(  R                 &   #00011694' TO DFHEIV0
 13767     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13768     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13769     MOVE X'2020233030303131363934' TO DFHEIV0(25:11)
 13770     CALL 'kxdfhei1' USING DFHEIV0,
 13771           ACTQ-FILE-ID,
 13772           ACTQ-KEY,
 13773           DFHEIV99,
 13774           DFHEIV99,
 13775           DFHEIV99
 13776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13777
 13778
 13779
 13780* EXEC CICS STARTBR
 13781*         DATASET   (ACTQ-FILE-ID)
 13782*         RIDFLD    (ACTQ-KEY)
 13783*    END-EXEC.
 13784     MOVE 0
 13785       TO DFHEIV11
 13786*    MOVE '&,         G          &   #00011699' TO DFHEIV0
 13787     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13788     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13789     MOVE X'2020233030303131363939' TO DFHEIV0(25:11)
 13790     CALL 'kxdfhei1' USING DFHEIV0,
 13791           ACTQ-FILE-ID,
 13792           ACTQ-KEY,
 13793           DFHEIV99,
 13794           DFHEIV11,
 13795           DFHEIV99
 13796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13797
 13798
 13799     GO TO 3050-DELETE-ACTQ.
 13800
 13801 3050-EXIT.
 13802     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 256
* EL131.cbl
 13804 3060-READ-TRLR.
 13805
 13806* EXEC CICS HANDLE CONDITION
 13807*         NOTFND    (3060-EXIT)
 13808*         ENDFILE   (3060-EXIT)
 13809*    END-EXEC.
 13810*    MOVE '"$I''                  ! @ #00011710' TO DFHEIV0
 13811     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13813     MOVE X'4020233030303131373130' TO DFHEIV0(25:11)
 13814     CALL 'kxdfhei1' USING DFHEIV0
 13815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13816
 13817
 13818 3060-LOOP.
 13819
 13820* EXEC CICS READNEXT
 13821*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13822*         DATASET  (TRLR-FILE-ID)
 13823*         RIDFLD   (TRLR-KEY)
 13824*    END-EXEC.
 13825     MOVE 0
 13826       TO DFHEIV11
 13827*    MOVE '&.S                   )   #00011716' TO DFHEIV0
 13828     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13829     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13830     MOVE X'2020233030303131373136' TO DFHEIV0(25:11)
 13831     CALL 'kxdfhei1' USING DFHEIV0,
 13832           TRLR-FILE-ID,
 13833           DFHEIV20,
 13834           DFHEIV99,
 13835           TRLR-KEY,
 13836           DFHEIV99,
 13837           DFHEIV11,
 13838           DFHEIV99,
 13839           DFHEIV99
 13840     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13841         DFHEIV20
 13842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13843
 13844
 13845     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13846         GO TO 3060-EXIT.
 13847
 13848     IF FORM-CONTROL-TR
 13849         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13850             NEXT SENTENCE
 13851         ELSE
 13852             MOVE 'X'            TO ERROR-SWITCH
 13853             GO TO 3060-EXIT
 13854     ELSE
 13855         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13856            MOVE 'X'                 TO ERROR-SWITCH
 13857            GO TO 3060-EXIT.
 13858
 13859     GO TO 3060-LOOP.
 13860
 13861 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 257
* EL131.cbl
 13862     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 258
* EL131.cbl
 13864 3997-GET-ERPDEF.
 13865
 13866     move cl-company-cd          to cert-company-code
 13867     move cl-cert-key-data       to cert-key (2:21)
 13868     move cl-cert-no             to cert-cert
 13869
 13870
 13871* EXEC CICS READ
 13872*        DATASET   (CERT-FILE-ID)
 13873*        RIDFLD    (CERT-KEY)
 13874*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13875*        resp      (ws-response)
 13876*    END-EXEC
 13877*    MOVE '&"S        E          (  N#00011747' TO DFHEIV0
 13878     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13879     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13880     MOVE X'204E233030303131373437' TO DFHEIV0(25:11)
 13881     CALL 'kxdfhei1' USING DFHEIV0,
 13882           CERT-FILE-ID,
 13883           DFHEIV20,
 13884           DFHEIV99,
 13885           CERT-KEY,
 13886           DFHEIV99,
 13887           DFHEIV99,
 13888           DFHEIV99
 13889     SET ADDRESS OF CERTIFICATE-MASTER TO
 13890         DFHEIV20
 13891     MOVE EIBRESP  TO ws-response
 13892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13893
 13894     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 13895                                    WS-ERPDEF-SW
 13896     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13897                                    WS-CRIT-PER-RTW-MOS
 13898
 13899     if cm-clp-state = spaces or low-values or zeros
 13900        move cm-state            to cm-clp-state
 13901     end-if
 13902     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13903     MOVE CM-clp-state           TO ERPDEF-STATE
 13904     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13905     if (cl-claim-type = 'L' or 'P')
 13906        and (cm-lf-benefit-cd not = '00' and '  ' and 'DD')
 13907        move 'L'                 to erpdef-ben-type
 13908        move cm-lf-benefit-cd    to erpdef-ben-code
 13909     else
 13910        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 13911        MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 13912     end-if
 13913     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13914     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13915
 13916
 13917* EXEC CICS STARTBR
 13918*        DATASET  ('ERPDEF')
 13919*        RIDFLD   (ERPDEF-KEY)
 13920*        GTEQ
 13921*        RESP     (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 259
* EL131.cbl
 13922*    END-EXEC
 13923     MOVE 'ERPDEF' TO DFHEIV1
 13924     MOVE 0
 13925       TO DFHEIV11
 13926*    MOVE '&,         G          &  N#00011776' TO DFHEIV0
 13927     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13928     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13929     MOVE X'204E233030303131373736' TO DFHEIV0(25:11)
 13930     CALL 'kxdfhei1' USING DFHEIV0,
 13931           DFHEIV1,
 13932           ERPDEF-KEY,
 13933           DFHEIV99,
 13934           DFHEIV11,
 13935           DFHEIV99
 13936     MOVE EIBRESP  TO WS-RESPONSE
 13937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13938
 13939     IF WS-RESP-NORMAL
 13940
 13941* EXEC CICS READNEXT
 13942*          DATASET  ('ERPDEF')
 13943*          INTO     (PRODUCT-MASTER)
 13944*          RIDFLD   (ERPDEF-KEY)
 13945*          RESP     (WS-RESPONSE)
 13946*       END-EXEC
 13947     MOVE LENGTH OF
 13948      PRODUCT-MASTER
 13949       TO DFHEIV12
 13950     MOVE 'ERPDEF' TO DFHEIV1
 13951     MOVE 0
 13952       TO DFHEIV11
 13953*    MOVE '&.IL                  )  N#00011784' TO DFHEIV0
 13954     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13955     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13956     MOVE X'204E233030303131373834' TO DFHEIV0(25:11)
 13957     CALL 'kxdfhei1' USING DFHEIV0,
 13958           DFHEIV1,
 13959           PRODUCT-MASTER,
 13960           DFHEIV12,
 13961           ERPDEF-KEY,
 13962           DFHEIV99,
 13963           DFHEIV11,
 13964           DFHEIV99,
 13965           DFHEIV99
 13966     MOVE EIBRESP  TO WS-RESPONSE
 13967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13968        IF WS-RESP-NORMAL
 13969           IF (ERPDEF-KEY-SAVE (1:16) =
 13970              PD-CONTROL-PRIMARY (1:16))
 13971              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13972              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13973                 (A1 > +8)
 13974                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13975              END-PERFORM
 13976              IF A1 < +9
 13977                 SET ERPDEF-FOUND TO TRUE
 13978                 MOVE PD-CRIT-PERIOD (A1)
 13979                              TO WS-CRITICAL-PERIOD
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 260
* EL131.cbl
 13980                 MOVE PD-REC-CRIT-PERIOD (A1)
 13981                              TO WS-CRIT-PER-RECURRENT
 13982                 IF PD-RTW-MOS (A1) NUMERIC
 13983                    MOVE PD-RTW-MOS (A1)
 13984                              TO WS-CRIT-PER-RTW-MOS
 13985                 ELSE
 13986                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13987                 END-IF
 13988                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 13989                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13990                                 TO WS-EXCL-PERIOD
 13991                 END-IF
 13992                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 13993                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 13994                                 TO WS-COV-ENDS
 13995                 END-IF
 13996                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 13997                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 13998                                 TO WS-ACC-PERIOD
 13999                 END-IF
 14000                 if pd-max-extension (a1) numeric
 14001                    move pd-max-extension (a1)
 14002                                 to ws-max-extension
 14003                 end-if
 14004                 if pd-max-amt (a1) numeric
 14005                    move pd-max-amt (a1)
 14006                                 to ws-max-moben
 14007                 end-if
 14008              END-IF
 14009           END-IF
 14010        END-IF
 14011     END-IF
 14012
 14013     .
 14014 3997-EXIT.
 14015     EXIT.
 14016 4000-FORCE-ERRORS.
 14017     IF PI-RETURN-CD-1 = 'X'
 14018         MOVE ER-0311            TO EMI-ERROR
 14019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14020         MOVE -1                 TO MAINTL
 14021         GO TO 8110-SEND-DATA.
 14022
 14023     IF NOT FORCE-CAP
 14024         MOVE ER-0416            TO EMI-ERROR
 14025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14026         MOVE -1                 TO MAINTL
 14027         GO TO 8110-SEND-DATA.
 14028
 14029     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14030     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14031     IF EMI-FATAL-CTR GREATER THAN ZERO
 14032         GO TO 4000-FATAL-ERRORS.
 14033
 14034     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14035
 14036     IF EMI-FATAL-CTR GREATER THAN ZERO
 14037         GO TO 4000-FATAL-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 261
* EL131.cbl
 14038
 14039     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14040
 14041     IF EMI-FATAL-CTR GREATER THAN ZERO
 14042         GO TO 4000-FATAL-ERRORS.
 14043
 14044     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14045     MOVE AL-UANOF               TO CERTA.
 14046     MOVE ER-0000 TO EMI-ERROR.
 14047     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14048
 14049 4000-FATAL-ERRORS.
 14050     MOVE -1                     TO MAINTL.
 14051     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 262
* EL131.cbl
 14053
 14054 4100-SAVE-CHANGES.
 14055     IF MAINTL > 0
 14056         MOVE MAINTI  TO WS-SAVE-MAINTI
 14057         MOVE MAINTL  TO WS-SAVE-MAINTL
 14058     END-IF
 14059     IF STATUSL > 0
 14060         MOVE STATUSI  TO WS-SAVE-STATUSI
 14061         MOVE STATUSL  TO WS-SAVE-STATUSL
 14062     END-IF
 14063     IF REPL > 0
 14064         MOVE REPI  TO WS-SAVE-REPI
 14065         MOVE REPL  TO WS-SAVE-REPL
 14066     END-IF
 14067*    IF CAUSEL > 0
 14068*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14069*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14070*    END-IF
 14071*    IF ENDL > 0
 14072*        MOVE ENDI  TO WS-SAVE-ENDI
 14073*        MOVE ENDL  TO WS-SAVE-ENDL
 14074*    END-IF
 14075     IF DIAGL > 0
 14076         MOVE DIAGI  TO WS-SAVE-DIAGI
 14077         MOVE DIAGL  TO WS-SAVE-DIAGL
 14078     END-IF
 14079     IF ICD1L > 0
 14080         MOVE ICD1I  TO WS-SAVE-ICD1I
 14081         MOVE ICD1L  TO WS-SAVE-ICD1L
 14082     END-IF
 14083     IF ICD2L > 0
 14084         MOVE ICD2I  TO WS-SAVE-ICD2I
 14085         MOVE ICD2L  TO WS-SAVE-ICD2L
 14086     END-IF
 14087     IF BENEL > 0
 14088         MOVE BENEI  TO WS-SAVE-BENEI
 14089         MOVE BENEL  TO WS-SAVE-BENEL
 14090     END-IF
 14091     IF BIRTHL > 0
 14092         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14093         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14094     END-IF
 14095     IF SOCIALL > 0
 14096         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14097         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14098     END-IF
 14099     IF SEXL > 0
 14100         MOVE SEXI  TO WS-SAVE-SEXI
 14101         MOVE SEXL  TO WS-SAVE-SEXL
 14102     END-IF
 14103     IF MLNAMEL > 0
 14104         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14105         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14106     END-IF
 14107     IF MFNAMEL > 0
 14108         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14109         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14110     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 263
* EL131.cbl
 14111     IF MMINITL > 0
 14112         MOVE MMINITI  TO WS-SAVE-MMINITI
 14113         MOVE MMINITL  TO WS-SAVE-MMINITL
 14114     END-IF
 14115     IF LOANNOL > 0
 14116         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14117         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14118     END-IF
 14119     IF LOANBALL > 0
 14120         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14121         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14122     END-IF
 14123     IF PROCL > 0
 14124         MOVE PROCI  TO WS-SAVE-PROCI
 14125         MOVE PROCL  TO WS-SAVE-PROCL
 14126     END-IF
 14127     IF SUPVL > 0
 14128         MOVE SUPVI  TO WS-SAVE-SUPVI
 14129         MOVE SUPVL  TO WS-SAVE-SUPVL
 14130     END-IF
 14131     IF PRICDL > 0
 14132         MOVE PRICDI  TO WS-SAVE-PRICDI
 14133         MOVE PRICDL  TO WS-SAVE-PRICDL
 14134     END-IF
 14135     IF FILETOL > 0
 14136         MOVE FILETOI  TO WS-SAVE-FILETOI
 14137         MOVE FILETOL  TO WS-SAVE-FILETOL
 14138     END-IF
 14139     IF PDTHRUL > 0
 14140         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14141         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14142     END-IF
 14143     IF PDAMTL > 0
 14144         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14145         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14146     END-IF
 14147     IF NODAYSL > 0
 14148         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14149         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14150     END-IF
 14151     IF NOPMTSL > 0
 14152         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14153         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14154     END-IF
 14155     IF FORMTYPL > 0
 14156         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14157         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14158     END-IF
 14159     IF OCCL > 0
 14160         MOVE OCCI  TO WS-SAVE-OCCI
 14161         MOVE OCCL  TO WS-SAVE-OCCL
 14162     END-IF.
 14163 4100-EXIT.
 14164      EXIT.
 14165
 14166 4200-LOAD-CHANGES.
 14167     IF WS-SAVE-MAINTL > 0
 14168         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 264
* EL131.cbl
 14169         MOVE WS-SAVE-MAINTL  TO MAINTL
 14170         MOVE AL-UANON        TO MAINTA
 14171     END-IF
 14172     IF WS-SAVE-STATUSL > 0
 14173         MOVE WS-SAVE-STATUSI  TO STATUSI
 14174         MOVE WS-SAVE-STATUSL  TO STATUSL
 14175         MOVE AL-UANON         TO STATUSA
 14176     END-IF
 14177     IF WS-SAVE-REPL > 0
 14178         MOVE WS-SAVE-REPI  TO REPI
 14179         MOVE WS-SAVE-REPL  TO REPL
 14180         MOVE AL-UANON      TO REPA
 14181     END-IF
 14182*    IF WS-SAVE-CAUSEL > 0
 14183*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14184*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14185*        MOVE AL-UANON        TO CAUSEA
 14186*    END-IF
 14187*    IF WS-SAVE-ENDL > 0
 14188*        MOVE WS-SAVE-ENDI  TO ENDI
 14189*        MOVE WS-SAVE-ENDL  TO ENDL
 14190*        MOVE AL-UANON      TO ENDA
 14191*    END-IF
 14192     IF WS-SAVE-DIAGL > 0
 14193         MOVE WS-SAVE-DIAGI  TO DIAGI
 14194         MOVE WS-SAVE-DIAGL  TO DIAGL
 14195         MOVE AL-UANON       TO DIAGA
 14196     END-IF
 14197     IF WS-SAVE-ICD1L > 0
 14198         MOVE WS-SAVE-ICD1I  TO ICD1I
 14199         MOVE WS-SAVE-ICD1L  TO ICD1L
 14200         MOVE AL-UANON       TO ICD1A
 14201     END-IF
 14202     IF WS-SAVE-ICD2L > 0
 14203         MOVE WS-SAVE-ICD2I  TO ICD2I
 14204         MOVE WS-SAVE-ICD2L  TO ICD2L
 14205         MOVE AL-UANON       TO ICD2A
 14206     END-IF
 14207     IF WS-SAVE-BENEL > 0
 14208         MOVE WS-SAVE-BENEI  TO BENEI
 14209         MOVE WS-SAVE-BENEL  TO BENEL
 14210         MOVE AL-UANON       TO BENEA
 14211     END-IF
 14212     IF WS-SAVE-BIRTHL > 0
 14213         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14214         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14215         MOVE AL-UANON        TO BIRTHA
 14216     END-IF
 14217     IF WS-SAVE-SOCIALL > 0
 14218         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14219         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14220         MOVE AL-UANON         TO SOCIALA
 14221     END-IF
 14222     IF WS-SAVE-SEXL > 0
 14223         MOVE WS-SAVE-SEXI  TO SEXI
 14224         MOVE WS-SAVE-SEXL  TO SEXL
 14225         MOVE AL-UANON      TO SEXA
 14226     END-IF
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 265
* EL131.cbl
 14227     IF WS-SAVE-MLNAMEL > 0
 14228         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14229         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14230         MOVE AL-UANON         TO MLNAMEA
 14231     END-IF
 14232     IF WS-SAVE-MFNAMEL > 0
 14233         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14234         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14235         MOVE AL-UANON         TO MFNAMEA
 14236     END-IF
 14237     IF WS-SAVE-MMINITL > 0
 14238         MOVE WS-SAVE-MMINITI  TO MMINITI
 14239         MOVE WS-SAVE-MMINITL  TO MMINITL
 14240         MOVE AL-UANON         TO MMINITA
 14241     END-IF
 14242     IF WS-SAVE-LOANNOL > 0
 14243         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14244         MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14245         MOVE AL-UANON         TO LOANNOA
 14246     END-IF
 14247     IF WS-SAVE-LOANBALL > 0
 14248         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14249         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14250         MOVE AL-UANON          TO LOANBALA
 14251     END-IF
 14252     IF WS-SAVE-PROCL > 0
 14253         MOVE WS-SAVE-PROCI  TO PROCI
 14254         MOVE WS-SAVE-PROCL  TO PROCL
 14255         MOVE AL-UANON       TO PROCA
 14256     END-IF
 14257     IF WS-SAVE-SUPVL > 0
 14258         MOVE WS-SAVE-SUPVI  TO SUPVI
 14259         MOVE WS-SAVE-SUPVL  TO SUPVL
 14260         MOVE AL-UANON       TO SUPVA
 14261     END-IF
 14262     IF WS-SAVE-PRICDL > 0
 14263         MOVE WS-SAVE-PRICDI  TO PRICDI
 14264         MOVE WS-SAVE-PRICDL  TO PRICDL
 14265         MOVE AL-UANON        TO PRICDA
 14266     END-IF
 14267     IF WS-SAVE-FILETOL > 0
 14268         MOVE WS-SAVE-FILETOI  TO FILETOI
 14269         MOVE WS-SAVE-FILETOL  TO FILETOL
 14270         MOVE AL-UANON         TO FILETOA
 14271     END-IF
 14272     IF WS-SAVE-PDTHRUL > 0
 14273         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14274         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14275         MOVE AL-UANON         TO PDTHRUA
 14276     END-IF
 14277     IF WS-SAVE-PDAMTL > 0
 14278         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14279         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14280         MOVE AL-UANON        TO PDAMTA
 14281     END-IF
 14282     IF WS-SAVE-NODAYSL > 0
 14283         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14284         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 266
* EL131.cbl
 14285         MOVE AL-UANON         TO NODAYSA
 14286     END-IF
 14287     IF WS-SAVE-NOPMTSL > 0
 14288         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14289         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14290         MOVE AL-UANON         TO NOPMTSA
 14291     END-IF
 14292     IF WS-SAVE-FORMTYPL > 0
 14293         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14294         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14295         MOVE AL-UANON          TO FORMTYPA
 14296     END-IF
 14297     IF WS-SAVE-OCCL > 0
 14298         MOVE WS-SAVE-OCCI  TO OCCI
 14299         MOVE WS-SAVE-OCCL  TO OCCL
 14300         MOVE AL-UANON      TO OCCA
 14301     END-IF.
 14302 4200-EXIT.
 14303      EXIT.
 14304
 14305 5000-BUILD-MAP.
 14306     IF PI-RETURN-CD-1 = SPACE
 14307         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14308
 14309     MOVE SPACE                  TO PI-RETURN-CD-1.
 14310
 14311     MOVE LOW-VALUES             TO EL131AI.
 14312
 14313     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14314     MOVE PI-CARRIER             TO CARRIER-CODE.
 14315     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14316     MOVE PI-CERT-NO             TO CERT-NO.
 14317
 14318 5000-READ-CLAIM-MASTER.
 14319
 14320
 14321* EXEC CICS READ
 14322*         SET      (ADDRESS OF CLAIM-MASTER)
 14323*         DATASET  (CLMS-FILE-ID)
 14324*         RIDFLD   (MSTR-KEY)
 14325*    END-EXEC.
 14326*    MOVE '&"S        E          (   #00012142' TO DFHEIV0
 14327     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14329     MOVE X'2020233030303132313432' TO DFHEIV0(25:11)
 14330     CALL 'kxdfhei1' USING DFHEIV0,
 14331           CLMS-FILE-ID,
 14332           DFHEIV20,
 14333           DFHEIV99,
 14334           MSTR-KEY,
 14335           DFHEIV99,
 14336           DFHEIV99,
 14337           DFHEIV99
 14338     SET ADDRESS OF CLAIM-MASTER TO
 14339         DFHEIV20
 14340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14341
 14342
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 267
* EL131.cbl
 14343     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14344
 14345 5000-READ-DIAGNOSIS-TRAILER.
 14346
 14347
 14348* EXEC CICS HANDLE CONDITION
 14349*         NOTFND (5000-TRLR-NOT-FOUND)
 14350*    END-EXEC.
 14351*    MOVE '"$I                   ! A #00012152' TO DFHEIV0
 14352     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14354     MOVE X'4120233030303132313532' TO DFHEIV0(25:11)
 14355     CALL 'kxdfhei1' USING DFHEIV0
 14356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14357
 14358
 14359     MOVE MSTR-KEY               TO TRLR-KEY.
 14360     MOVE NINETY                 TO TRLR-SEQ-NO.
 14361
 14362
 14363* EXEC CICS READ
 14364*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14365*         DATASET  (TRLR-FILE-ID)
 14366*         RIDFLD   (TRLR-KEY)
 14367*    END-EXEC.
 14368*    MOVE '&"S        E          (   #00012159' TO DFHEIV0
 14369     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14371     MOVE X'2020233030303132313539' TO DFHEIV0(25:11)
 14372     CALL 'kxdfhei1' USING DFHEIV0,
 14373           TRLR-FILE-ID,
 14374           DFHEIV20,
 14375           DFHEIV99,
 14376           TRLR-KEY,
 14377           DFHEIV99,
 14378           DFHEIV99,
 14379           DFHEIV99
 14380     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14381         DFHEIV20
 14382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14383
 14384
 14385     MOVE AT-INFO-LINE-1         TO DIAGO.
 14386     MOVE AT-ICD-CODE-1          TO ICD1O.
 14387     MOVE AT-ICD-CODE-2          TO ICD2O.
 14388
 14389 5000-READ-CERTIFICATE-MASTER.
 14390
 14391     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14392     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14393     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14394     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14395     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14396     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14397     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14398
 14399
 14400* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 268
* EL131.cbl
 14401*         NOTFND (5000-CERT-NOT-FOUND)
 14402*    END-EXEC.
 14403*    MOVE '"$I                   ! B #00012179' TO DFHEIV0
 14404     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14406     MOVE X'4220233030303132313739' TO DFHEIV0(25:11)
 14407     CALL 'kxdfhei1' USING DFHEIV0
 14408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14409
 14410
 14411
 14412* EXEC CICS READ
 14413*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14414*         DATASET  (CERT-FILE-ID)
 14415*         RIDFLD   (CERT-KEY)
 14416*    END-EXEC.
 14417*    MOVE '&"S        E          (   #00012183' TO DFHEIV0
 14418     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14419     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14420     MOVE X'2020233030303132313833' TO DFHEIV0(25:11)
 14421     CALL 'kxdfhei1' USING DFHEIV0,
 14422           CERT-FILE-ID,
 14423           DFHEIV20,
 14424           DFHEIV99,
 14425           CERT-KEY,
 14426           DFHEIV99,
 14427           DFHEIV99,
 14428           DFHEIV99
 14429     SET ADDRESS OF CERTIFICATE-MASTER TO
 14430         DFHEIV20
 14431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14432
 14433
 14434     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14435     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14436
 14437     GO TO 5000-EXIT.
 14438
 14439 5000-TRLR-NOT-FOUND.
 14440     MOVE ER-7687                TO EMI-ERROR.
 14441     MOVE -1                     TO DIAGL.
 14442     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14443     GO TO 5000-EXIT.
 14444
 14445 5000-CERT-NOT-FOUND.
 14446     MOVE ER-0206                TO EMI-ERROR.
 14447     MOVE -1                     TO CERTL.
 14448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14449
 14450 5000-EXIT.
 14451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 269
* EL131.cbl
 14453 5010-RESET-PI-AREA.
 14454     IF CERTI GREATER THAN LOW-VALUES
 14455         MOVE CERTI              TO PI-CERT-PRIME.
 14456
 14457     IF SUFXI GREATER THAN LOW-VALUES
 14458         MOVE SUFXI              TO PI-CERT-SFX.
 14459
 14460     IF CERTEFFI GREATER THAN LOW-VALUES
 14461         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14462
 14463     IF CERTACTI GREATER THAN LOW-VALUES
 14464         MOVE CERTACTI           TO PI-ACCOUNT.
 14465
 14466     IF CERTSTI GREATER THAN LOW-VALUES
 14467         MOVE CERTSTI            TO PI-STATE.
 14468
 14469     IF CERTCARI GREATER THAN LOW-VALUES
 14470         MOVE CERTCARI           TO PI-CARRIER.
 14471
 14472     IF CERTGRPI GREATER THAN LOW-VALUES
 14473         MOVE CERTGRPI           TO PI-GROUPING.
 14474
 14475 5010-EXIT.
 14476     EXIT.
 14477
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 270
* EL131.cbl
 14479 5020-MOVE-MSTR.
 14480
 14481     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14482     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14483     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14484     MOVE AL-SABON               TO SEQUA.
 14485     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14486     MOVE CL-CLAIM-TYPE          TO TYPEO
 14487                                    pi-claim-type
 14488
 14489     IF CL-TOTAL-PAID-AMT  = +0 AND
 14490        CL-LAST-PMT-AMT    = +0 AND
 14491        CL-NO-OF-PMTS-MADE = +0
 14492          MOVE AL-UANON          TO TYPEA.
 14493
 14494     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14495     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14496     MOVE CL-CERT-PRIME          TO CERTO.
 14497     MOVE CL-CERT-SFX            TO SUFXO.
 14498     MOVE CL-CERT-CARRIER        TO CARRO.
 14499
 14500     IF CL-CLAIM-STATUS = 'C'
 14501         MOVE 'CLOSED'           TO STATUSO
 14502     ELSE
 14503         MOVE 'OPEN  '           TO STATUSO.
 14504
 14505     move cl-accident-claim-sw   to accswo
 14506     if cl-benefit-period not numeric
 14507        move zeros               to cl-benefit-period
 14508     end-if
 14509     move cl-benefit-period      to benpero
 14510     move cl-insured-type        to instypeo
 14511     MOVE CL-PROCESSOR-ID        TO PROCO.
 14512
 14513     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14514     MOVE CL-CCN                 TO CCNOO.
 14515
 14516     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14517     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14518     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14519     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14520
 14521     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14522         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14523         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14524         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14525         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14526     ELSE
 14527         MOVE SPACES             TO BIRTHO.
 14528
 14529     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14530        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14531         NEXT SENTENCE
 14532       ELSE
 14533         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14534
 14535     IF PI-COMPANY-ID = 'DMD'
 14536       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 271
* EL131.cbl
 14537          IF SOCIALO = SPACES OR LOW-VALUES
 14538            MOVE ER-0885         TO EMI-ERROR
 14539            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14540
 14541     MOVE CL-INSURED-OCC-CD      TO OCCO.
 14542*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14543
 14544*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14545*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14546*        MOVE SPACES                 TO DC-OPTION-CODE
 14547*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14548*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14549*    ELSE
 14550*        MOVE SPACES             TO ENDO.
 14551
 14552     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14553        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14554        MOVE SPACES             TO DC-OPTION-CODE
 14555        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14556        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14557        IF PI-USES-PAID-TO
 14558           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14559           MOVE '6'                TO DC-OPTION-CODE
 14560           MOVE +1                 TO DC-ELAPSED-DAYS
 14561           MOVE +0                 TO DC-ELAPSED-MONTHS
 14562           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14563           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14564        ELSE
 14565           NEXT SENTENCE
 14566     ELSE
 14567        MOVE SPACES             TO PDTHRUO.
 14568
 14569     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14570     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14571     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14572     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14573
 14574     IF MODIFY-CAP
 14575        MOVE AL-UNNOF            TO PDAMTA
 14576                                    NODAYSA
 14577                                    NOPMTSA
 14578        MOVE AL-UANOF            TO PDTHRUA.
 14579     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14580     MOVE '2'                    TO CNTL-REC-TYPE
 14581     MOVE +0                     TO CNTL-SEQ-NO
 14582     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14583
 14584
 14585* EXEC CICS READ
 14586*         DATASET  (CNTL-FILE-ID)
 14587*         SET      (ADDRESS OF CONTROL-FILE)
 14588*         RIDFLD   (CNTL-KEY)
 14589*         RESP     (WS-RESPONSE)
 14590*    END-EXEC
 14591*    MOVE '&"S        E          (  N#00012339' TO DFHEIV0
 14592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14593     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14594     MOVE X'204E233030303132333339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 272
* EL131.cbl
 14595     CALL 'kxdfhei1' USING DFHEIV0,
 14596           CNTL-FILE-ID,
 14597           DFHEIV20,
 14598           DFHEIV99,
 14599           CNTL-KEY,
 14600           DFHEIV99,
 14601           DFHEIV99,
 14602           DFHEIV99
 14603     SET ADDRESS OF CONTROL-FILE TO
 14604         DFHEIV20
 14605     MOVE EIBRESP  TO WS-RESPONSE
 14606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14607
 14608     IF WS-RESP-NORMAL
 14609        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14610     end-if
 14611     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14612         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14613         MOVE SPACES             TO DC-OPTION-CODE
 14614         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14615         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14616     ELSE
 14617         MOVE SPACES             TO INCO.
 14618
 14619     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14620        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14621        MOVE AL-UANOF            TO INCA
 14622     end-if
 14623     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14624
 14625     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14626         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14627         MOVE SPACES             TO DC-OPTION-CODE
 14628         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14629         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14630     ELSE
 14631         MOVE SPACES             TO REPO.
 14632
 14633     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14634         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14635         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14636         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14637         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14638     ELSE
 14639         MOVE SPACES             TO ESTO.
 14640
 14641     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14642         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14643         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14644         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14645         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14646     ELSE
 14647         MOVE SPACES             TO MNTDTO.
 14648
 14649
 14650     IF CL-LAST-MAINT-TYPE = SPACE
 14651         MOVE 'SET-UP'           TO MNTTYPEO
 14652     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 273
* EL131.cbl
 14653     IF CL-LAST-MAINT-TYPE = '1'
 14654         MOVE 'PAYMNT'           TO MNTTYPEO
 14655     ELSE
 14656     IF CL-LAST-MAINT-TYPE = '2'
 14657         MOVE 'LETTER'           TO MNTTYPEO
 14658     ELSE
 14659     IF CL-LAST-MAINT-TYPE = '3'
 14660         MOVE 'UPDATE'           TO MNTTYPEO
 14661     ELSE
 14662     IF CL-LAST-MAINT-TYPE = '4'
 14663         MOVE 'RESTOR'           TO MNTTYPEO
 14664     ELSE
 14665     IF CL-LAST-MAINT-TYPE = '5'
 14666         MOVE 'INC DT'           TO MNTTYPEO
 14667     ELSE
 14668     IF CL-LAST-MAINT-TYPE = '6'
 14669         MOVE ' CONV'            TO MNTTYPEO
 14670     ELSE
 14671     IF CL-LAST-MAINT-TYPE = 'C'
 14672         MOVE 'CHGBEN'           TO MNTTYPEO
 14673     ELSE
 14674     IF CL-LAST-MAINT-TYPE = 'E'
 14675         MOVE 'ERRCOR'           TO MNTTYPEO
 14676     ELSE
 14677         MOVE SPACES             TO MNTTYPEO.
 14678
 14679     MOVE CL-BENEFICIARY         TO BENEO.
 14680     MOVE CL-FILE-LOCATION       TO FILETOO.
 14681     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14682        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14683     END-IF
 14684     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14685*    MOVE CL-CRIT-PER-RECURRENT
 14686*                                TO CRITPTO
 14687*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14688*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14689*    END-IF
 14690*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14691     MOVE CL-PRIORITY-CD         TO PRICDO.
 14692     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14693     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14694     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14695     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14696
 14697 5020-EXIT.
 14698     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 274
* EL131.cbl
 14700 5030-MOVE-CERT.
 14701
 14702     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14703         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14704         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14705         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14706         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14707       ELSE
 14708         MOVE SPACES             TO CERTEFFO
 14709         MOVE ZERO               TO HOLD-DATE.
 14710
 14711     MOVE CM-ACCOUNT             TO CERTACTO.
 14712     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14713     MOVE CM-GROUPING            TO CERTGRPO.
 14714     MOVE CM-CARRIER             TO CERTCARO.
 14715     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14716     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14717     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14718     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14719     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14720     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14721     MOVE CM-JT-INITIAL          TO JNTINITO.
 14722     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14723
 14724*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14725     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14726     MOVE '3'                    TO CNTL-REC-TYPE.
 14727     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14728     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14729     MOVE ZERO                   TO CNTL-SEQ-NO.
 14730
 14731
 14732* EXEC CICS READ
 14733*         SET        (ADDRESS OF CONTROL-FILE)
 14734*         DATASET    ('ELCNTL')
 14735*         RIDFLD     (CNTL-KEY)
 14736*         RESP       (WS-RESPONSE)
 14737*    END-EXEC.
 14738     MOVE 'ELCNTL' TO DFHEIV1
 14739*    MOVE '&"S        E          (  N#00012469' TO DFHEIV0
 14740     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14742     MOVE X'204E233030303132343639' TO DFHEIV0(25:11)
 14743     CALL 'kxdfhei1' USING DFHEIV0,
 14744           DFHEIV1,
 14745           DFHEIV20,
 14746           DFHEIV99,
 14747           CNTL-KEY,
 14748           DFHEIV99,
 14749           DFHEIV99,
 14750           DFHEIV99
 14751     SET ADDRESS OF CONTROL-FILE TO
 14752         DFHEIV20
 14753     MOVE EIBRESP  TO WS-RESPONSE
 14754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14755
 14756
 14757     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 275
* EL131.cbl
 14758        MOVE ZERO                TO CP-FREE-LOOK
 14759     ELSE
 14760        MOVE CF-ST-FREE-LOOK-PERIOD
 14761                                 TO CP-FREE-LOOK.
 14762
 14763     IF CM-LF-BENEFIT-CD = '00'
 14764        GO TO 5030-MOVE-CERT-AH.
 14765
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 276
* EL131.cbl
 14767     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14768     MOVE '5'                    TO DC-OPTION-CODE
 14769     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14770     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14771     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14772     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14773     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 14774     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14775     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14776     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 14777     MOVE '4'                    TO CP-REM-TERM-METHOD
 14778     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 14779     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14780     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14781
 14782     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14783     IF CM-LF-PREMIUM-RATE NUMERIC
 14784         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14785     ELSE
 14786         MOVE ZEROS              TO LCVRATEO.
 14787
 14788     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14789         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 14790
 14791     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 14792
 14793     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 14794
 14795     IF CM-LF-CURRENT-STATUS = '8'
 14796        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14797            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14798            MOVE ' '             TO DC-OPTION-CODE
 14799            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14800            IF NOT DATE-CONVERSION-ERROR
 14801                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14802
 14803     IF CM-LF-CURRENT-STATUS = '7'
 14804        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14805            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 14806            MOVE ' '             TO DC-OPTION-CODE
 14807            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14808            IF NOT DATE-CONVERSION-ERROR
 14809                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14810
 14811     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14812         MOVE ' '                TO DC-OPTION-CODE
 14813         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 14814         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14815         IF NOT DATE-CONVERSION-ERROR
 14816             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 14817             MOVE HOLD-MONTH     TO WORK-MONTH
 14818             MOVE HOLD-YEAR      TO WORK-YEAR
 14819             MOVE WORK-DATE-MY   TO LCVEXITO.
 14820
 14821     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14822        IF CP-REMAINING-TERM-3 = ZEROS
 14823           MOVE 'EXPIRED'        TO LCVSTATO
 14824        ELSE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 277
* EL131.cbl
 14825           MOVE 'ACTIVE'         TO LCVSTATO.
 14826
 14827     IF CM-LF-CURRENT-STATUS = '2'
 14828        MOVE 'PEND   '           TO LCVSTATO.
 14829     IF CM-LF-CURRENT-STATUS = '3'
 14830        MOVE 'RESTORE'           TO LCVSTATO.
 14831     IF CM-LF-CURRENT-STATUS = '5'
 14832        MOVE 'REISSUE'           TO LCVSTATO.
 14833     IF CM-LF-CURRENT-STATUS = '6'
 14834        MOVE 'LMP DIS'           TO LCVSTATO.
 14835     IF CM-LF-CURRENT-STATUS = '7'
 14836        MOVE 'DEATH  '           TO LCVSTATO.
 14837     IF CM-LF-CURRENT-STATUS = '8'
 14838        MOVE 'CANCEL '           TO LCVSTATO.
 14839     IF CM-LF-CURRENT-STATUS = '9'
 14840        MOVE 'RE-ONLY'           TO LCVSTATO.
 14841     IF CM-LF-CURRENT-STATUS = 'V'
 14842        MOVE 'VOID   '           TO LCVSTATO.
 14843     IF CM-LF-CURRENT-STATUS = 'D'
 14844        MOVE 'DECLINE'           TO LCVSTATO.
 14845
 14846     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14847     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14848     MOVE '4'                    TO BEN-REC-TYPE.
 14849     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 14850     MOVE ZERO                   TO BEN-SEQ-NO.
 14851
 14852
 14853* EXEC CICS READ GTEQ
 14854*         DATASET  (CNTL-FILE-ID)
 14855*         RIDFLD   (BENEFIT-KEY)
 14856*         SET      (ADDRESS OF CONTROL-FILE)
 14857*    END-EXEC.
 14858*    MOVE '&"S        G          (   #00012571' TO DFHEIV0
 14859     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14860     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14861     MOVE X'2020233030303132353731' TO DFHEIV0(25:11)
 14862     CALL 'kxdfhei1' USING DFHEIV0,
 14863           CNTL-FILE-ID,
 14864           DFHEIV20,
 14865           DFHEIV99,
 14866           BENEFIT-KEY,
 14867           DFHEIV99,
 14868           DFHEIV99,
 14869           DFHEIV99
 14870     SET ADDRESS OF CONTROL-FILE TO
 14871         DFHEIV20
 14872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14873
 14874
 14875     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14876        CF-RECORD-TYPE NOT = '4'
 14877         MOVE ER-0240            TO EMI-ERROR
 14878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14879         GO TO 5030-MOVE-CERT-FINISH.
 14880
 14881     MOVE ZERO                   TO COUNT-2.
 14882     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 278
* EL131.cbl
 14883
 14884     IF SCREEN-ERROR
 14885         MOVE ER-0282            TO EMI-ERROR
 14886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14887        ELSE
 14888         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 14889
 14890 5030-MOVE-CERT-AH.
 14891
 14892     IF CM-LF-BENEFIT-CD = '00'
 14893         IF CM-AH-BENEFIT-CD = '00'
 14894             GO TO 5030-MOVE-CERT-FINISH.
 14895
 14896     IF CM-AH-BENEFIT-CD = '00'
 14897        MOVE SPACES             TO ACVKINDO
 14898        COMPUTE PI-PAYMENT-AMT =
 14899                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 14900        GO TO 5030-MOVE-CERT-FINISH.
 14901
 14902     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14903     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 14904     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 14905     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 14906     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14907     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14908     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14909     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 14910
 14911**DMD **********************************************
 14912     IF PI-COMPANY-ID = 'DMD'
 14913         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 14914                                   CM-PMT-EXTENSION-DAYS
 14915         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 14916                                      CL-NO-OF-DAYS-PAID
 14917         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 14918             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 14919         MOVE WS-REM-MOS         TO ACVRTRMO
 14920                                    CP-REMAINING-TERM-3
 14921*        MOVE WS-REM-DAYS        TO DAYSPO
 14922         GO TO 5030-SKIP-RTRM.
 14923**DMD **********************************************
 14924
 14925     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14926     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14927     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14928     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14929
 14930 5030-SKIP-RTRM.
 14931     IF CM-AH-PREMIUM-RATE NUMERIC
 14932         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14933     ELSE
 14934         MOVE ZEROS              TO ACVRATEO.
 14935
 14936     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 14937     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 14938
 14939     IF CM-AH-CURRENT-STATUS = '8'
 14940        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 279
* EL131.cbl
 14941            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14942            MOVE ' '             TO DC-OPTION-CODE
 14943            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14944            IF NOT DATE-CONVERSION-ERROR
 14945                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14946
 14947     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14948        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14949            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 14950            MOVE ' '             TO DC-OPTION-CODE
 14951            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14952            IF NOT DATE-CONVERSION-ERROR
 14953                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14954
 14955     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14956        IF CP-REMAINING-TERM-3 = ZEROS
 14957           MOVE 'EXPIRED'        TO ACVSTATO
 14958        ELSE
 14959           MOVE 'ACTIVE'         TO ACVSTATO.
 14960
 14961     IF CM-AH-CURRENT-STATUS = '2'
 14962        MOVE 'PEND   '           TO ACVSTATO.
 14963     IF CM-AH-CURRENT-STATUS = '3'
 14964        MOVE 'RESTORE'           TO ACVSTATO.
 14965     IF CM-AH-CURRENT-STATUS = '5'
 14966        MOVE 'REISSUE'           TO ACVSTATO.
 14967     IF CM-AH-CURRENT-STATUS = '6'
 14968        MOVE 'LMP DIS'           TO ACVSTATO.
 14969     IF CM-AH-CURRENT-STATUS = '7'
 14970        MOVE 'DEATH  '           TO ACVSTATO.
 14971     IF CM-AH-CURRENT-STATUS = '8'
 14972        MOVE 'CANCEL '           TO ACVSTATO.
 14973     IF CM-AH-CURRENT-STATUS = '9'
 14974        MOVE 'RE-ONLY'           TO ACVSTATO.
 14975     IF CM-AH-CURRENT-STATUS = 'V'
 14976        MOVE 'VOID   '           TO ACVSTATO.
 14977     IF CM-AH-CURRENT-STATUS = '9'
 14978        MOVE 'DECLINE'           TO ACVSTATO.
 14979
 14980     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14981         MOVE ' '                TO DC-OPTION-CODE
 14982         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14983         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14984         IF NOT DATE-CONVERSION-ERROR
 14985             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 14986             MOVE HOLD-MONTH     TO WORK-MONTH
 14987             MOVE HOLD-YEAR      TO WORK-YEAR
 14988             MOVE WORK-DATE-MY   TO ACVEXITO.
 14989
 14990     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14991
 14992     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14993     MOVE '5'                    TO BEN-REC-TYPE.
 14994     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 14995     MOVE ZERO                   TO BEN-SEQ-NO.
 14996
 14997
 14998* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 280
* EL131.cbl
 14999*         DATASET  (CNTL-FILE-ID)
 15000*         RIDFLD   (BENEFIT-KEY)
 15001*         SET      (ADDRESS OF CONTROL-FILE)
 15002*    END-EXEC.
 15003*    MOVE '&"S        G          (   #00012699' TO DFHEIV0
 15004     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15006     MOVE X'2020233030303132363939' TO DFHEIV0(25:11)
 15007     CALL 'kxdfhei1' USING DFHEIV0,
 15008           CNTL-FILE-ID,
 15009           DFHEIV20,
 15010           DFHEIV99,
 15011           BENEFIT-KEY,
 15012           DFHEIV99,
 15013           DFHEIV99,
 15014           DFHEIV99
 15015     SET ADDRESS OF CONTROL-FILE TO
 15016         DFHEIV20
 15017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15018
 15019
 15020     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15021        CF-RECORD-TYPE NOT = '5'
 15022         MOVE ER-0250            TO EMI-ERROR
 15023         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15024         GO TO 5030-MOVE-CERT-FINISH.
 15025
 15026     MOVE ZERO                   TO COUNT-2.
 15027     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15028
 15029     IF SCREEN-ERROR
 15030         MOVE ER-0283            TO EMI-ERROR
 15031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15032       ELSE
 15033         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15034
 15035 5030-MOVE-CERT-FINISH.
 15036
 15037     MOVE CM-LOAN-APR            TO APRO.
 15038     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15039     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15040     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15041     MOVE CM-LOAN-NUMBER         TO LOANNOO
 15042     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15043     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15044
 15045     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15046         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15047         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15048         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15049         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15050     ELSE
 15051         MOVE SPACES               TO ADDONDTO.
 15052
 15053     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15054
 15055 5030-EXIT.
 15056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 281
* EL131.cbl
 15058 5040-FIND-BENEFIT.
 15059     ADD 1                       TO COUNT-2.
 15060     IF COUNT-2 GREATER THAN 8
 15061         GO TO 5050-BENEFIT-NOTFND.
 15062
 15063     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15064         GO TO 5060-EXIT.
 15065
 15066     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15067         GO TO 5050-BENEFIT-NOTFND.
 15068
 15069     GO TO 5040-FIND-BENEFIT.
 15070
 15071 5050-BENEFIT-NOTFND.
 15072     MOVE 'X'                    TO ERROR-SWITCH.
 15073
 15074 5060-EXIT.
 15075     EXIT.
 15076
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 282
* EL131.cbl
 15078 6000-CALCULATE-CERT-TERM.
 15079
 15080     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15081         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15082     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15083         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15084     IF CM-LOAN-APR NOT NUMERIC
 15085         MOVE ZEROS              TO CM-LOAN-APR.
 15086
 15087*    IF WS-CALC-METHOD  = 'G'
 15088         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15089*     ELSE
 15090*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15091
 15092     IF N GREATER 120
 15093         MOVE 120                TO N.
 15094
 15095     MOVE '6'                    TO DC-OPTION-CODE.
 15096     MOVE N                      TO DC-ELAPSED-MONTHS.
 15097     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15098     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15099
 15100     IF CM-LF-BENEFIT-CD NOT = ZERO
 15101         MOVE N                  TO CM-LF-ORIG-TERM
 15102         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15103         IF NO-CONVERSION-ERROR
 15104             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15105
 15106     IF CM-AH-BENEFIT-CD NOT = ZERO
 15107         MOVE N                  TO CM-AH-ORIG-TERM
 15108         IF NO-CONVERSION-ERROR
 15109             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15110
 15111 6000-EXIT.
 15112      EXIT.
 15113
 15114 6100-CALC-GROSS-TERM.
 15115     MOVE CM-LOAN-BALANCE         TO L.
 15116     MOVE PI-PAYMENT-AMT          TO M.
 15117
 15118     COMPUTE N = L / M.
 15119     IF N LESS 1
 15120         MOVE 1  TO N.
 15121
 15122     IF CM-LF-BENEFIT-CD NOT = ZERO
 15123         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15124     ELSE
 15125         MOVE ZEROS               TO WS-LF-RATE.
 15126
 15127     IF CM-AH-BENEFIT-CD NOT = ZERO
 15128         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15129     ELSE
 15130         MOVE ZEROS               TO WS-AH-RATE.
 15131
 15132     COMPUTE I = CM-LOAN-APR / +1200.
 15133
 15134 6105-LOOP.
 15135     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 283
* EL131.cbl
 15136         GO TO 6200-EXIT.
 15137     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15138     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15139         ADD 1 TO N
 15140         GO TO 6105-LOOP.
 15141
 15142 6200-EXIT.
 15143      EXIT.
 15144
 15145 6210-CALC-LEFT-RIGHTONE.
 15146      MOVE L         TO LEFT-TOT-1.
 15147      SUBTRACT 1 FROM N.
 15148      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15149      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15150      ADD 1 TO N.
 15151 6211-CALC-TERM1.
 15152      MOVE N         TO TERM1.
 15153      MULTIPLY M BY TERM1.
 15154 6212-LOOP.
 15155      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15156      ADD 1 TO A-N.
 15157      MULTIPLY A-N BY TERM1.
 15158      SUBTRACT 1 FROM A-N.
 15159      ADD TERM1 TO LEFT-TOT-1.
 15160 6213-CALC-TERM2.
 15161      MOVE M         TO TERM2.
 15162      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15163      MULTIPLY IA-N BY TERM2.
 15164      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15165 6215-CALC-RIGHTONE.
 15166      MOVE M         TO RIGHT-TOT-1.
 15167      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15168      MULTIPLY A-N BY RIGHT-TOT-1.
 15169 6220-EXIT.
 15170      EXIT.
 15171
 15172 6300-CALC-A-N.
 15173     IF N LESS 1
 15174         MOVE 0     TO A-N
 15175         GO TO 6300-EXIT.
 15176     IF I = 0
 15177         MOVE .00001 TO I.
 15178     ADD 1 TO I.
 15179     DIVIDE I INTO 1 GIVING V.
 15180     SUBTRACT 1 FROM I.
 15181     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15182     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15183     DIVIDE I INTO TERM3 GIVING A-N.
 15184 6300-EXIT.
 15185      EXIT.
 15186
 15187 6350-CALC-IA-N.
 15188     IF N LESS 1
 15189         MOVE 0      TO IA-N
 15190         GO TO 6400-EXIT.
 15191     ADD 1 TO N.
 15192     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15193     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 284
* EL131.cbl
 15194     MULTIPLY N BY V-EX-N GIVING TERM3.
 15195     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15196     SUBTRACT V FROM 1 GIVING TERM4.
 15197     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15198 6400-EXIT.
 15199      EXIT.
 15200
 15201 6450-CALC-V-EX-N.
 15202     IF N LESS 1
 15203         MOVE 1    TO V-EX-N
 15204         GO TO 6490-EXIT.
 15205     MOVE N        TO NV-STORE.
 15206     IF V-EX-ONETIME = 1  OR
 15207        V NOT = V-EXPONENT (1)
 15208          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15209 6460-LOOP.
 15210     IF N GREATER 248
 15211         MOVE 248 TO N.
 15212     IF N = 1
 15213         MOVE V               TO V-EX-N
 15214      ELSE
 15215         MOVE V-EXPONENT (N)  TO V-EX-N.
 15216     GO TO 6490-EXIT.
 15217
 15218 6470-BUILD-V-EX-TABLE.
 15219     MOVE 2      TO N.
 15220     MOVE V      TO V-EXPONENT (1)
 15221                    V-EX-N.
 15222 6471-LOOP.
 15223     MULTIPLY V BY V-EX-N.
 15224     MOVE V-EX-N   TO V-EXPONENT (N).
 15225     ADD 1 TO N.
 15226     IF N LESS 248
 15227         GO TO 6471-LOOP.
 15228     MOVE NV-STORE     TO N.
 15229     MOVE 0            TO V-EX-ONETIME.
 15230 6480-EXIT.
 15231      EXIT.
 15232
 15233 6490-EXIT.
 15234      EXIT.
 15235
 15236 6500-CALC-NET-TERM.
 15237     MOVE CM-LOAN-BALANCE         TO L.
 15238     MOVE PI-PAYMENT-AMT          TO M.
 15239
 15240     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15241     IF WS-REMAIN GREATER ZERO
 15242         ADD 1 TO N.
 15243     IF N = 0
 15244         MOVE 1 TO N.
 15245
 15246 6700-EXIT.
 15247      EXIT.
 15248
 15249 6999-CALC-TERM-EXIT.
 15250     EXIT.
 15251
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 285
* EL131.cbl
 15253 7000-RESET-ATTRIBUTE.
 15254
 15255     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15256                                    CERTSTA   CERTCARA
 15257                                    CERTGRPA.
 15258     MOVE -1                     TO CERTCARL.
 15259
 15260 7000-EXIT.
 15261     EXIT.
 15262
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 286
* EL131.cbl
 15264 7600-BROWSE-CLAIM.
 15265
 15266
 15267* EXEC CICS READ
 15268*        DATASET(CLMS-FILE-ID)
 15269*        SET    (ADDRESS OF CLAIM-MASTER)
 15270*        RIDFLD (MSTR-KEY)
 15271*        GENERIC
 15272*        EQUAL
 15273*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15274*    END-EXEC.
 15275*    MOVE '&"S  KG    E          (   #00012951' TO DFHEIV0
 15276     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15278     MOVE X'2020233030303132393531' TO DFHEIV0(25:11)
 15279     CALL 'kxdfhei1' USING DFHEIV0,
 15280           CLMS-FILE-ID,
 15281           DFHEIV20,
 15282           DFHEIV99,
 15283           MSTR-KEY,
 15284           ELMSTR-GENERIC-LENGTH,
 15285           DFHEIV99,
 15286           DFHEIV99
 15287     SET ADDRESS OF CLAIM-MASTER TO
 15288         DFHEIV20
 15289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15290
 15291
 15292     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15293
 15294     if cl-assoc-cert-total = 0
 15295        move 1 to cl-assoc-cert-total
 15296     end-if
 15297     IF CL-ASSOC-CERT-SEQU = 0
 15298        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15299     END-IF
 15300
 15301     IF CL-ASSOC-CERT-TOTAL = 1
 15302         MOVE AL-SADOF           TO BCERT1A
 15303                                    BSUFX1A
 15304                                    BCERT2A
 15305                                    BSUFX2A
 15306                                    BCERT3A
 15307                                    BSUFX3A
 15308                                    BCERT4A
 15309                                    BSUFX4A
 15310                                    BCERT5A
 15311                                    BSUFX5A
 15312                                    PCERTNOA
 15313                                    PSUFXA
 15314                                    LABEL1A
 15315                                    LABEL2A
 15316         GO TO 7699-EXIT.
 15317
 15318 7610-BROWSE-CLAIM-LOOP.
 15319
 15320     MOVE LOW-VALUES             TO BCERT1O
 15321                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 287
* EL131.cbl
 15322                                    BCERT2O
 15323                                    BSUFX2O
 15324                                    BCERT3O
 15325                                    BSUFX3O
 15326                                    BCERT4O
 15327                                    BSUFX4O
 15328                                    BCERT5O
 15329                                    BSUFX5O.
 15330
 15331
 15332* EXEC CICS HANDLE CONDITION
 15333*        ENDFILE  (7630-END-BROWSE)
 15334*    END-EXEC.
 15335*    MOVE '"$''                   ! C #00012999' TO DFHEIV0
 15336     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15337     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15338     MOVE X'4320233030303132393939' TO DFHEIV0(25:11)
 15339     CALL 'kxdfhei1' USING DFHEIV0
 15340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15341
 15342
 15343
 15344* EXEC CICS STARTBR
 15345*        DATASET    (CLMS-FILE-ID)
 15346*        RIDFLD     (MSTR-KEY)
 15347*    END-EXEC.
 15348     MOVE 0
 15349       TO DFHEIV11
 15350*    MOVE '&,         G          &   #00013003' TO DFHEIV0
 15351     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15352     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15353     MOVE X'2020233030303133303033' TO DFHEIV0(25:11)
 15354     CALL 'kxdfhei1' USING DFHEIV0,
 15355           CLMS-FILE-ID,
 15356           MSTR-KEY,
 15357           DFHEIV99,
 15358           DFHEIV11,
 15359           DFHEIV99
 15360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15361
 15362
 15363     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15364
 15365 7620-READ-CLAIM-LOOP.
 15366
 15367
 15368* EXEC CICS READNEXT
 15369*        DATASET   (CLMS-FILE-ID)
 15370*        SET       (ADDRESS OF CLAIM-MASTER)
 15371*        RIDFLD    (MSTR-KEY)
 15372*    END-EXEC.
 15373     MOVE 0
 15374       TO DFHEIV11
 15375*    MOVE '&.S                   )   #00013012' TO DFHEIV0
 15376     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15377     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15378     MOVE X'2020233030303133303132' TO DFHEIV0(25:11)
 15379     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 288
* EL131.cbl
 15380           CLMS-FILE-ID,
 15381           DFHEIV20,
 15382           DFHEIV99,
 15383           MSTR-KEY,
 15384           DFHEIV99,
 15385           DFHEIV11,
 15386           DFHEIV99,
 15387           DFHEIV99
 15388     SET ADDRESS OF CLAIM-MASTER TO
 15389         DFHEIV20
 15390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15391
 15392
 15393     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15394        CL-CARRIER     NOT = CARRI           OR
 15395        CL-CLAIM-NO    NOT = CLAIMI
 15396        GO TO 7630-END-BROWSE.
 15397
 15398     IF WS-ASSOCIATED-CERTS = 1
 15399         MOVE CL-CERT-PRIME      TO BCERT1O
 15400         MOVE CL-CERT-SFX        TO BSUFX1O.
 15401
 15402     IF WS-ASSOCIATED-CERTS = 2
 15403         MOVE CL-CERT-PRIME      TO BCERT2O
 15404         MOVE CL-CERT-SFX        TO BSUFX2O.
 15405
 15406     IF WS-ASSOCIATED-CERTS = 3
 15407         MOVE CL-CERT-PRIME      TO BCERT3O
 15408         MOVE CL-CERT-SFX        TO BSUFX3O.
 15409
 15410     IF WS-ASSOCIATED-CERTS = 4
 15411         MOVE CL-CERT-PRIME      TO BCERT4O
 15412         MOVE CL-CERT-SFX        TO BSUFX4O.
 15413
 15414     IF WS-ASSOCIATED-CERTS = 5
 15415         MOVE CL-CERT-PRIME      TO BCERT5O
 15416         MOVE CL-CERT-SFX        TO BSUFX5O
 15417     ELSE
 15418         ADD +1                  TO WS-ASSOCIATED-CERTS
 15419         GO TO 7620-READ-CLAIM-LOOP.
 15420
 15421 7630-END-BROWSE.
 15422
 15423
 15424* EXEC CICS ENDBR
 15425*        DATASET   (CLMS-FILE-ID)
 15426*    END-EXEC.
 15427     MOVE 0
 15428       TO DFHEIV11
 15429*    MOVE '&2                    $   #00013048' TO DFHEIV0
 15430     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15431     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15432     MOVE X'2020233030303133303438' TO DFHEIV0(25:11)
 15433     CALL 'kxdfhei1' USING DFHEIV0,
 15434           CLMS-FILE-ID,
 15435           DFHEIV11,
 15436           DFHEIV99
 15437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 289
* EL131.cbl
 15438
 15439
 15440 7640-HIGHLIGHT-CERT-DISPLAYED.
 15441
 15442     MOVE AL-SANON               TO BCERT1A
 15443                                    BSUFX1A
 15444                                    BCERT2A
 15445                                    BSUFX2A
 15446                                    BCERT3A
 15447                                    BSUFX3A
 15448                                    BCERT4A
 15449                                    BSUFX4A
 15450                                    BCERT5A
 15451                                    BSUFX5A.
 15452
 15453     IF BCERT1O = CERTI AND
 15454        BSUFX1O = SUFXI
 15455            MOVE AL-SABON        TO BCERT1A
 15456                                    BSUFX1A.
 15457
 15458     IF BCERT2O = CERTI AND
 15459        BSUFX2O = SUFXI
 15460            MOVE AL-SABON        TO BCERT2A
 15461                                    BSUFX2A.
 15462
 15463     IF BCERT3O = CERTI AND
 15464        BSUFX3O = SUFXI
 15465            MOVE AL-SABON        TO BCERT3A
 15466                                    BSUFX3A.
 15467
 15468     IF BCERT4O = CERTI AND
 15469        BSUFX4O = SUFXI
 15470            MOVE AL-SABON        TO BCERT4A
 15471                                    BSUFX4A.
 15472
 15473     IF BCERT5O = CERTI AND
 15474        BSUFX5O = SUFXI
 15475            MOVE AL-SABON        TO BCERT5A
 15476                                    BSUFX5A.
 15477
 15478 7699-EXIT.
 15479     EXIT.
 15480
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 290
* EL131.cbl
 15482 7700-CHECK-SEQUENCE.
 15483
 15484
 15485* EXEC CICS HANDLE CONDITION
 15486*        ENDFILE  (7799-EXIT)
 15487*        NOTFND   (7799-EXIT)
 15488*    END-EXEC.
 15489*    MOVE '"$''I                  ! D #00013096' TO DFHEIV0
 15490     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15492     MOVE X'4420233030303133303936' TO DFHEIV0(25:11)
 15493     CALL 'kxdfhei1' USING DFHEIV0
 15494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15495
 15496
 15497
 15498* EXEC CICS READ
 15499*        DATASET(CLMS-FILE-ID)
 15500*        SET    (ADDRESS OF CLAIM-MASTER)
 15501*        RIDFLD (MSTR-KEY)
 15502*        GENERIC
 15503*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15504*    END-EXEC.
 15505*    MOVE '&"S  KG    E          (   #00013101' TO DFHEIV0
 15506     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15508     MOVE X'2020233030303133313031' TO DFHEIV0(25:11)
 15509     CALL 'kxdfhei1' USING DFHEIV0,
 15510           CLMS-FILE-ID,
 15511           DFHEIV20,
 15512           DFHEIV99,
 15513           MSTR-KEY,
 15514           ELMSTR-GENERIC-LENGTH,
 15515           DFHEIV99,
 15516           DFHEIV99
 15517     SET ADDRESS OF CLAIM-MASTER TO
 15518         DFHEIV20
 15519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15520
 15521
 15522     COMPUTE WS-ASSOC-CERT-TOTAL =
 15523             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15524
 15525     GO TO 7799-EXIT.
 15526
 15527 7710-RESEQUENCE-CLAIMS.
 15528
 15529
 15530* EXEC CICS HANDLE CONDITION
 15531*        ENDFILE  (7799-EXIT)
 15532*    END-EXEC.
 15533*    MOVE '"$''                   ! E #00013116' TO DFHEIV0
 15534     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15536     MOVE X'4520233030303133313136' TO DFHEIV0(25:11)
 15537     CALL 'kxdfhei1' USING DFHEIV0
 15538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15539
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 291
* EL131.cbl
 15540
 15541
 15542* EXEC CICS STARTBR
 15543*        DATASET(CLMS-FILE-ID)
 15544*        RIDFLD (MSTR-KEY)
 15545*    END-EXEC.
 15546     MOVE 0
 15547       TO DFHEIV11
 15548*    MOVE '&,         G          &   #00013120' TO DFHEIV0
 15549     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15550     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15551     MOVE X'2020233030303133313230' TO DFHEIV0(25:11)
 15552     CALL 'kxdfhei1' USING DFHEIV0,
 15553           CLMS-FILE-ID,
 15554           MSTR-KEY,
 15555           DFHEIV99,
 15556           DFHEIV11,
 15557           DFHEIV99
 15558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15559
 15560
 15561     COMPUTE WS-ASSOC-CERT-SEQU =
 15562             WS-ASSOC-CERT-SEQU + 1.
 15563
 15564     COMPUTE WS-READNEXT-SWITCH =
 15565             WS-READNEXT-SWITCH + 1.
 15566
 15567 7720-READ-CLAIM-LOOP.
 15568
 15569
 15570* EXEC CICS READNEXT
 15571*        DATASET(CLMS-FILE-ID)
 15572*        SET    (ADDRESS OF CLAIM-MASTER)
 15573*        RIDFLD (MSTR-KEY)
 15574*    END-EXEC.
 15575     MOVE 0
 15576       TO DFHEIV11
 15577*    MOVE '&.S                   )   #00013133' TO DFHEIV0
 15578     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15579     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15580     MOVE X'2020233030303133313333' TO DFHEIV0(25:11)
 15581     CALL 'kxdfhei1' USING DFHEIV0,
 15582           CLMS-FILE-ID,
 15583           DFHEIV20,
 15584           DFHEIV99,
 15585           MSTR-KEY,
 15586           DFHEIV99,
 15587           DFHEIV11,
 15588           DFHEIV99,
 15589           DFHEIV99
 15590     SET ADDRESS OF CLAIM-MASTER TO
 15591         DFHEIV20
 15592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15593
 15594
 15595     IF WS-READNEXT-SWITCH = 1
 15596         ADD 1                   TO WS-READNEXT-SWITCH
 15597         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 292
* EL131.cbl
 15598
 15599 7730-END-BROWSE.
 15600
 15601
 15602* EXEC CICS ENDBR
 15603*        DATASET(CLMS-FILE-ID)
 15604*    END-EXEC.
 15605     MOVE 0
 15606       TO DFHEIV11
 15607*    MOVE '&2                    $   #00013145' TO DFHEIV0
 15608     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15609     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15610     MOVE X'2020233030303133313435' TO DFHEIV0(25:11)
 15611     CALL 'kxdfhei1' USING DFHEIV0,
 15612           CLMS-FILE-ID,
 15613           DFHEIV11,
 15614           DFHEIV99
 15615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15616
 15617
 15618 7740-READ-CLAIM-UPDATE.
 15619
 15620     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15621        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15622        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15623        GO TO 7799-EXIT
 15624     ELSE
 15625        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15626
 15627
 15628* EXEC CICS READ
 15629*        DATASET(CLMS-FILE-ID)
 15630*        SET    (ADDRESS OF CLAIM-MASTER)
 15631*        RIDFLD (MSTR-KEY)
 15632*        UPDATE
 15633*    END-EXEC.
 15634*    MOVE '&"S        EU         (   #00013158' TO DFHEIV0
 15635     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15636     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15637     MOVE X'2020233030303133313538' TO DFHEIV0(25:11)
 15638     CALL 'kxdfhei1' USING DFHEIV0,
 15639           CLMS-FILE-ID,
 15640           DFHEIV20,
 15641           DFHEIV99,
 15642           MSTR-KEY,
 15643           DFHEIV99,
 15644           DFHEIV99,
 15645           DFHEIV99
 15646     SET ADDRESS OF CLAIM-MASTER TO
 15647         DFHEIV20
 15648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15649
 15650
 15651     if (cl-priority-cd = '8')
 15652        and (pi-processor-id not = 'PEMA' and 'JMS '
 15653             AND 'AMWA')
 15654        MOVE ER-8003             TO EMI-ERROR
 15655        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 293
* EL131.cbl
 15656                                 THRU 9900-EXIT
 15657        MOVE -1                  TO MAINTL
 15658        GO TO 8110-SEND-DATA
 15659     end-if
 15660
 15661     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15662         MOVE 'Y'                TO CL-YESNOSW
 15663     END-IF.
 15664
 15665     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15666     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15667
 15668
 15669* EXEC CICS REWRITE
 15670*         DATASET(CLMS-FILE-ID)
 15671*         FROM   (CLAIM-MASTER)
 15672*    END-EXEC.
 15673     MOVE LENGTH OF
 15674      CLAIM-MASTER
 15675       TO DFHEIV11
 15676*    MOVE '&& L                  %   #00013182' TO DFHEIV0
 15677     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15678     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15679     MOVE X'2020233030303133313832' TO DFHEIV0(25:11)
 15680     CALL 'kxdfhei1' USING DFHEIV0,
 15681           CLMS-FILE-ID,
 15682           CLAIM-MASTER,
 15683           DFHEIV11,
 15684           DFHEIV99
 15685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15686
 15687
 15688     GO TO 7710-RESEQUENCE-CLAIMS.
 15689
 15690 7799-EXIT.
 15691     EXIT.
 15692
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 294
* EL131.cbl
 15694 7800-CHECK-AUTO-ACTIVITY.
 15695
 15696
 15697* EXEC CICS HANDLE CONDITION
 15698*        NOTFND   (7800-NOT-FOUND)
 15699*    END-EXEC.
 15700*    MOVE '"$I                   ! F #00013195' TO DFHEIV0
 15701     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15703     MOVE X'4620233030303133313935' TO DFHEIV0(25:11)
 15704     CALL 'kxdfhei1' USING DFHEIV0
 15705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15706
 15707
 15708     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15709     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15710     MOVE SPACES                     TO  CNTL-PROC-ID.
 15711     MOVE +0                         TO  CNTL-SEQ-NO.
 15712
 15713
 15714* EXEC CICS READ
 15715*        DATASET   (CNTL-FILE-ID)
 15716*        RIDFLD    (CNTL-KEY)
 15717*        SET       (ADDRESS OF CONTROL-FILE)
 15718*    END-EXEC.
 15719*    MOVE '&"S        E          (   #00013204' TO DFHEIV0
 15720     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15721     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15722     MOVE X'2020233030303133323034' TO DFHEIV0(25:11)
 15723     CALL 'kxdfhei1' USING DFHEIV0,
 15724           CNTL-FILE-ID,
 15725           DFHEIV20,
 15726           DFHEIV99,
 15727           CNTL-KEY,
 15728           DFHEIV99,
 15729           DFHEIV99,
 15730           DFHEIV99
 15731     SET ADDRESS OF CONTROL-FILE TO
 15732         DFHEIV20
 15733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15734
 15735
 15736     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15737         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15738
 15739     IF CL-ACTIVITY-CODE NOT = ZEROS
 15740         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15741         IF MISC-SUB IS GREATER THAN +9
 15742             SUBTRACT +9 FROM MISC-SUB
 15743             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15744         ELSE
 15745             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15746     ELSE
 15747         MOVE 'Y'                              TO  WS-RESET-SW.
 15748
 15749     IF STATUSI = 'C' OR 'CLOSED'
 15750         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15751             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 295
* EL131.cbl
 15752                                         PI-LETTER-SW
 15753             GO TO 7800-EXIT.
 15754
 15755     IF STATUSI = 'C' OR 'CLOSED'
 15756         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15757             MOVE 'N'                TO  PI-LETTER-SW
 15758         ELSE
 15759             MOVE 'Y'                TO  PI-LETTER-SW.
 15760
 15761     IF STATUSI = 'O' OR 'OPEN'
 15762         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15763             MOVE 'N'                TO  PI-REC-FOUND-SW
 15764                                         PI-LETTER-SW
 15765             GO TO 7800-EXIT.
 15766
 15767     IF STATUSI = 'O' OR 'OPEN'
 15768         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15769             MOVE 'N'                TO  PI-LETTER-SW
 15770         ELSE
 15771             MOVE 'Y'                TO  PI-LETTER-SW.
 15772
 15773     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 15774     GO TO 7800-EXIT.
 15775
 15776 7800-NOT-FOUND.
 15777
 15778     MOVE 'N'                        TO  PI-REC-FOUND-SW
 15779                                         PI-LETTER-SW.
 15780
 15781 7800-EXIT.
 15782     EXIT.
 15783
 15784 7850-AUTO-LETTER-WRITER.
 15785
 15786     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 15787     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 15788
 15789     IF STATUSI = 'C' OR 'CLOSED'
 15790         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 15791     ELSE
 15792         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 15793
 15794     IF STATUSI = 'C' OR 'CLOSED'
 15795         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 15796             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15797             MOVE '6'                TO  DC-OPTION-CODE
 15798             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 15799             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15800             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15801             IF NO-CONVERSION-ERROR
 15802                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15803             ELSE
 15804                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15805
 15806     IF STATUSI = 'C' OR 'CLOSED'
 15807         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 15808             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15809             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 296
* EL131.cbl
 15810             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 15811             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15812             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15813             IF NO-CONVERSION-ERROR
 15814                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15815             ELSE
 15816                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15817
 15818     IF STATUSI = 'O' OR 'OPEN'
 15819         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 15820             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15821             MOVE '6'                TO  DC-OPTION-CODE
 15822             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 15823             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15824             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15825             IF NO-CONVERSION-ERROR
 15826                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15827             ELSE
 15828                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15829
 15830     IF STATUSI = 'O' OR 'OPEN'
 15831         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 15832             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15833             MOVE '6'                TO  DC-OPTION-CODE
 15834             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 15835             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15836             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15837             IF NO-CONVERSION-ERROR
 15838                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15839             ELSE
 15840                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15841
 15842
 15843* EXEC CICS LINK
 15844*        PROGRAM    (LINK-1523)
 15845*        COMMAREA   (W-1523-LINKDATA)
 15846*        LENGTH     (W-1523-COMM-LENGTH)
 15847*    END-EXEC.
 15848*    MOVE '."C                   (   #00013316' TO DFHEIV0
 15849     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15851     MOVE X'2020233030303133333136' TO DFHEIV0(25:11)
 15852     CALL 'kxdfhei1' USING DFHEIV0,
 15853           LINK-1523,
 15854           W-1523-LINKDATA,
 15855           W-1523-COMM-LENGTH,
 15856           DFHEIV99,
 15857           DFHEIV99,
 15858           DFHEIV99,
 15859           DFHEIV99
 15860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15861
 15862
 15863     IF W-1523-ERROR-CODE = ZEROS
 15864         GO TO 7850-EXIT.
 15865
 15866     IF W-1523-FATAL-ERROR
 15867         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 297
* EL131.cbl
 15868         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15869
 15870     IF W-1523-ERROR-CODE = 0191
 15871         MOVE ER-0803                TO  EMI-ERROR
 15872         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15873
 15874 7850-EXIT.
 15875     EXIT.
 15876
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 298
* EL131.cbl
 15878 8000-CREATE-DMO-REC.
 15879     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 15880     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 15881     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 15882
 15883
 15884* EXEC CICS HANDLE CONDITION
 15885*         NOTFND   (8000-NOTE-NOT-FOUND)
 15886*    END-EXEC.
 15887*    MOVE '"$I                   ! G #00013342' TO DFHEIV0
 15888     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15890     MOVE X'4720233030303133333432' TO DFHEIV0(25:11)
 15891     CALL 'kxdfhei1' USING DFHEIV0
 15892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15893
 15894
 15895
 15896* EXEC CICS READ
 15897*         DATASET(NOTE-FILE-ID)
 15898*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 15899*         RIDFLD (NOTE-KEY)
 15900*    END-EXEC.
 15901*    MOVE '&"S        E          (   #00013346' TO DFHEIV0
 15902     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15904     MOVE X'2020233030303133333436' TO DFHEIV0(25:11)
 15905     CALL 'kxdfhei1' USING DFHEIV0,
 15906           NOTE-FILE-ID,
 15907           DFHEIV20,
 15908           DFHEIV99,
 15909           NOTE-KEY,
 15910           DFHEIV99,
 15911           DFHEIV99,
 15912           DFHEIV99
 15913     SET ADDRESS OF CERTIFICATE-NOTE TO
 15914         DFHEIV20
 15915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15916
 15917
 15918     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 15919     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 15920     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 15921
 15922     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 15923         MOVE 'CC'               TO DCT-PRODUCT-CODE
 15924     ELSE
 15925         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 15926
 15927     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 15928     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 15929
 15930
 15931* EXEC CICS LINK
 15932*        PROGRAM    ('DLO006')
 15933*        COMMAREA   (DCT-COMMUNICATION-AREA)
 15934*        LENGTH     (WS-DCT-LENGTH)
 15935*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 299
* EL131.cbl
 15936     MOVE 'DLO006' TO DFHEIV1
 15937*    MOVE '."C                   (   #00013364' TO DFHEIV0
 15938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15940     MOVE X'2020233030303133333634' TO DFHEIV0(25:11)
 15941     CALL 'kxdfhei1' USING DFHEIV0,
 15942           DFHEIV1,
 15943           DCT-COMMUNICATION-AREA,
 15944           WS-DCT-LENGTH,
 15945           DFHEIV99,
 15946           DFHEIV99,
 15947           DFHEIV99,
 15948           DFHEIV99
 15949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15950
 15951
 15952     IF  DCT-RETURN-CODE = 'OK'
 15953         GO TO 8000-CONT.
 15954
 15955     IF DCT-RETURN-CODE = '01' OR '02'
 15956         GO TO 8000-EXIT.
 15957
 15958     IF DCT-RETURN-CODE = '03'
 15959         MOVE ER-0951            TO EMI-ERROR
 15960         MOVE -1                 TO MAINTL
 15961         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15962         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15963         GO TO 8110-SEND-DATA.
 15964
 15965     IF DCT-RETURN-CODE = '04'
 15966         MOVE ER-0946            TO EMI-ERROR
 15967         MOVE -1                 TO MAINTL
 15968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15969         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15970         GO TO 8110-SEND-DATA.
 15971
 15972     IF DCT-RETURN-CODE = '05'
 15973         MOVE ER-0947            TO EMI-ERROR
 15974         MOVE -1                 TO MAINTL
 15975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15976         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15977         GO TO 8110-SEND-DATA.
 15978
 15979     IF DCT-RETURN-CODE = '06'
 15980         MOVE ER-0921            TO EMI-ERROR
 15981         MOVE -1                 TO MAINTL
 15982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15983         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15984         GO TO 8110-SEND-DATA.
 15985
 15986     IF DCT-RETURN-CODE = '07'
 15987         MOVE ER-0919            TO EMI-ERROR
 15988         MOVE -1                 TO MAINTL
 15989         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15990         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15991         GO TO 8110-SEND-DATA.
 15992
 15993     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 300
* EL131.cbl
 15994         MOVE ER-0948            TO EMI-ERROR
 15995         MOVE -1                 TO MAINTL
 15996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15997         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15998         GO TO 8110-SEND-DATA.
 15999
 16000     IF DCT-RETURN-CODE = 'N1'
 16001         MOVE ER-0950            TO EMI-ERROR
 16002         MOVE -1                 TO MAINTL
 16003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16004         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16005         GO TO 8110-SEND-DATA.
 16006
 16007     IF DCT-RETURN-CODE = 'E1'
 16008         MOVE ER-0974            TO EMI-ERROR
 16009         MOVE -1                 TO MAINTL
 16010         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16011         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16012         GO TO 8110-SEND-DATA.
 16013
 16014     IF DCT-RETURN-CODE = 'E2'
 16015         MOVE ER-0975            TO EMI-ERROR
 16016         MOVE -1                 TO MAINTL
 16017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16018         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16019         GO TO 8110-SEND-DATA.
 16020
 16021     IF DCT-RETURN-CODE NOT = 'OK'
 16022         MOVE ER-0949            TO EMI-ERROR
 16023         MOVE -1                 TO MAINTL
 16024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16025         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16026         GO TO 8110-SEND-DATA.
 16027
 16028 8000-CONT.
 16029
 16030     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16031     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16032     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16033     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16034     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16035     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16036     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16037     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16038
 16039     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16040     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16041     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16042     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16043     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16044
 16045     IF STATUSI = 'OPEN' OR 'O'
 16046         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16047      ELSE
 16048         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16049
 16050     IF STATUSI = 'OPEN' OR 'O'
 16051        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 301
* EL131.cbl
 16052         MOVE '1'                TO DM-CLAIM-STATUS
 16053      ELSE
 16054         MOVE '2'                TO DM-CLAIM-STATUS.
 16055
 16056     IF STATUSI = 'CLOSED' OR 'C'
 16057        IF NOT FINAL-PAID
 16058         MOVE '3'                TO DM-CLAIM-STATUS
 16059      ELSE
 16060         MOVE '4'                TO DM-CLAIM-STATUS.
 16061
 16062     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16063
 16064
 16065* EXEC CICS LINK
 16066*        PROGRAM    ('DLO025')
 16067*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16068*        LENGTH     (WS-DMO-LENGTH)
 16069*    END-EXEC.
 16070     MOVE 'DLO025' TO DFHEIV1
 16071*    MOVE '."C                   (   #00013482' TO DFHEIV0
 16072     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16073     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16074     MOVE X'2020233030303133343832' TO DFHEIV0(25:11)
 16075     CALL 'kxdfhei1' USING DFHEIV0,
 16076           DFHEIV1,
 16077           DMO-COMMUNICATION-AREA,
 16078           WS-DMO-LENGTH,
 16079           DFHEIV99,
 16080           DFHEIV99,
 16081           DFHEIV99,
 16082           DFHEIV99
 16083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16084
 16085
 16086     IF  DM-RETURN-CODE = 'OK'
 16087         GO TO 8000-EXIT.
 16088
 16089     IF DM-RETURN-CODE = '01'
 16090         MOVE ER-8051            TO EMI-ERROR
 16091         MOVE -1                 TO MAINTL
 16092         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16093         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16094         GO TO 8110-SEND-DATA.
 16095
 16096     IF DM-RETURN-CODE = '02'
 16097         MOVE ER-8052            TO EMI-ERROR
 16098         MOVE -1                 TO MAINTL
 16099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16100         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16101         GO TO 8110-SEND-DATA.
 16102
 16103     IF DM-RETURN-CODE = '03'
 16104         MOVE ER-8053            TO EMI-ERROR
 16105         MOVE -1                 TO MAINTL
 16106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16107         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16108         GO TO 8110-SEND-DATA.
 16109
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 302
* EL131.cbl
 16110     IF DM-RETURN-CODE = '04'
 16111         MOVE ER-8054            TO EMI-ERROR
 16112         MOVE -1                 TO MAINTL
 16113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16114         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16115         GO TO 8110-SEND-DATA.
 16116
 16117     IF DM-RETURN-CODE = '05'
 16118         MOVE ER-8055            TO EMI-ERROR
 16119         MOVE -1                 TO MAINTL
 16120         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16121         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16122         GO TO 8110-SEND-DATA.
 16123
 16124     IF DM-RETURN-CODE = '06'
 16125         MOVE ER-8056            TO EMI-ERROR
 16126         MOVE -1                 TO MAINTL
 16127         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16128         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16129         GO TO 8110-SEND-DATA.
 16130
 16131     IF DM-RETURN-CODE = '07'
 16132         MOVE ER-8057            TO EMI-ERROR
 16133         MOVE -1                 TO MAINTL
 16134         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16135         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16136         GO TO 8110-SEND-DATA.
 16137
 16138     IF DM-RETURN-CODE = '08'
 16139         MOVE ER-8058            TO EMI-ERROR
 16140         MOVE -1                 TO MAINTL
 16141         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16142         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16143         GO TO 8110-SEND-DATA.
 16144
 16145     IF DM-RETURN-CODE = '09'
 16146         MOVE ER-8059            TO EMI-ERROR
 16147         MOVE -1                 TO MAINTL
 16148         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16149         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16150         GO TO 8110-SEND-DATA.
 16151
 16152     IF DM-RETURN-CODE = '10'
 16153         MOVE ER-8060            TO EMI-ERROR
 16154         MOVE -1                 TO MAINTL
 16155         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16156         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16157         GO TO 8110-SEND-DATA.
 16158
 16159     IF DM-RETURN-CODE = '11'
 16160         MOVE ER-8061            TO EMI-ERROR
 16161         MOVE -1                 TO MAINTL
 16162         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16163         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16164         GO TO 8110-SEND-DATA.
 16165
 16166     IF DM-RETURN-CODE = '12'
 16167         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 303
* EL131.cbl
 16168         MOVE -1                 TO MAINTL
 16169         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16170         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16171         GO TO 8110-SEND-DATA.
 16172
 16173     IF DM-RETURN-CODE = '13'
 16174         MOVE ER-8063            TO EMI-ERROR
 16175         MOVE -1                 TO MAINTL
 16176         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16177         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16178         GO TO 8110-SEND-DATA.
 16179
 16180     IF DM-RETURN-CODE = '14'
 16181         MOVE ER-8064            TO EMI-ERROR
 16182         MOVE -1                 TO MAINTL
 16183         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16184         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16185         GO TO 8110-SEND-DATA.
 16186
 16187     IF DM-RETURN-CODE = '15'
 16188         MOVE ER-8065            TO EMI-ERROR
 16189         MOVE -1                 TO MAINTL
 16190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16191         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16192         GO TO 8110-SEND-DATA.
 16193
 16194     IF DM-RETURN-CODE = '16'
 16195         MOVE ER-8154            TO EMI-ERROR
 16196         MOVE -1                 TO MAINTL
 16197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16198         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16199         GO TO 8110-SEND-DATA.
 16200
 16201     IF DM-RETURN-CODE = '17'
 16202         MOVE ER-8155            TO EMI-ERROR
 16203         MOVE -1                 TO MAINTL
 16204         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16205         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16206         GO TO 8110-SEND-DATA.
 16207
 16208     IF DM-RETURN-CODE = 'N1'
 16209         MOVE ER-8152            TO EMI-ERROR
 16210         MOVE -1                 TO MAINTL
 16211         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16212         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16213         GO TO 8110-SEND-DATA.
 16214
 16215     IF DM-RETURN-CODE = 'E1'
 16216         MOVE ER-8153            TO EMI-ERROR
 16217         MOVE -1                 TO MAINTL
 16218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16219         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16220         GO TO 8110-SEND-DATA.
 16221
 16222     MOVE ER-8066                TO EMI-ERROR.
 16223     MOVE -1                     TO MAINTL.
 16224     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16225     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 304
* EL131.cbl
 16226     GO TO 8110-SEND-DATA.
 16227
 16228 8000-NOTE-NOT-FOUND.
 16229
 16230* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16231*    MOVE '6"R                   !   #00013631' TO DFHEIV0
 16232     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16234     MOVE X'2020233030303133363331' TO DFHEIV0(25:11)
 16235     CALL 'kxdfhei1' USING DFHEIV0
 16236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16237
 16238     MOVE ER-0954                TO EMI-ERROR.
 16239     MOVE -1                     TO MAINTL.
 16240     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16241     GO TO 8110-SEND-DATA.
 16242
 16243 8000-EXIT.
 16244     EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 305
* EL131.cbl
 16246 8050-FORMAT-LAST-NAME-1ST.
 16247*****************************************************************
 16248*             M O V E   N A M E   R O U T I N E                 *
 16249*                                                               *
 16250*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16251*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16252*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16253*                                                               *
 16254*                  FIELD               VALUE                    *
 16255*                  -----               -----                    *
 16256*           W-NAME-LAST    (CL15)      SMITH                    *
 16257*           W-NAME-FIRST   (CL15)      JOHN                     *
 16258*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16259*                                                               *
 16260*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16261*                SMITH, JOHN ALLEN                              *
 16262*                     OR                                        *
 16263*                SMITH, JOHN A.                                 *
 16264*                                                               *
 16265*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16266*     COPYBOOK, ELCNWA.                                         *
 16267*****************************************************************.
 16268
 16269     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16270     MOVE ZERO                   TO WS-NAME-SW.
 16271     SET NWA-INDEX               TO +1.
 16272
 16273     IF W-NAME-LAST   = SPACES  AND
 16274        W-NAME-MIDDLE = SPACES
 16275          MOVE +1                TO WS-NAME-SW.
 16276
 16277     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16278     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16279
 16280     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16281     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16282
 16283     SET NWA-INDEX UP BY +1.
 16284
 16285     IF W-NAME-MIDDLE NOT = SPACES
 16286         IF W-NAME-MIDDLE-2 = SPACES
 16287             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16288             SET NWA-INDEX UP BY +1
 16289             MOVE '.'            TO WS-NW (NWA-INDEX)
 16290             SET NWA-INDEX UP BY +2
 16291         ELSE
 16292             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16293             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16294
 16295 8050-EXIT.
 16296     EXIT.
 16297
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 306
* EL131.cbl
 16299 8060-MOVE-NAME.
 16300     IF WS-NAME-SW GREATER THAN +1
 16301         GO TO 8060-EXIT.
 16302
 16303     IF WS-NAME-WORK2 = SPACES
 16304         GO TO 8060-EXIT.
 16305
 16306     SET NWA-INDEX2            TO +1.
 16307     SET NWA-INDEX3            TO +2.
 16308
 16309 8060-MOVE-NAME-CYCLE.
 16310     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16311
 16312     IF NWA-INDEX LESS THAN +30
 16313         SET NWA-INDEX UP BY +1
 16314     ELSE
 16315         ADD +2 TO  WS-NAME-SW
 16316         GO TO 8060-EXIT.
 16317
 16318     IF NWA-INDEX2 LESS THAN +20
 16319         SET NWA-INDEX3 UP BY +1
 16320         SET NWA-INDEX2 UP BY +1.
 16321
 16322     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16323        WS-NW2 (NWA-INDEX3) = SPACES
 16324         IF WS-NAME-SW = ZERO
 16325             MOVE ','            TO WS-NW (NWA-INDEX)
 16326             SET NWA-INDEX UP BY +2
 16327             MOVE +1             TO WS-NAME-SW
 16328             GO TO 8060-EXIT
 16329         ELSE
 16330             GO TO 8060-EXIT.
 16331
 16332     GO TO 8060-MOVE-NAME-CYCLE.
 16333
 16334 8060-EXIT.
 16335     EXIT.
 16336
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 307
* EL131.cbl
 16338
 16339 8070-UNLOCK-CLAIM-MSTR.
 16340
 16341* EXEC CICS UNLOCK
 16342*        DATASET   (CLMS-FILE-ID)
 16343*    END-EXEC.
 16344*    MOVE '&*                    #   #00013734' TO DFHEIV0
 16345     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16346     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16347     MOVE X'2020233030303133373334' TO DFHEIV0(25:11)
 16348     CALL 'kxdfhei1' USING DFHEIV0,
 16349           CLMS-FILE-ID,
 16350           DFHEIV99
 16351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16352
 16353
 16354 8070-EXIT.
 16355      EXIT.
 16356
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 308
* EL131.cbl
 16358 8100-SEND-MAP.
 16359     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16360
 16361     move al-uanon               to accswa
 16362     IF NOT PI-NO-CARRIER-SECURITY
 16363        MOVE AL-SANOF            TO CERTCARA.
 16364     IF NOT PI-NO-ACCOUNT-SECURITY
 16365        MOVE AL-SANOF            TO CERTACTA.
 16366
 16367     IF PI-PROCESSOR-ID = 'LGXX'
 16368        MOVE AL-UANON            TO CCNOA.
 16369
 16370     IF PI-COMPANY-ID = 'DMD'
 16371        NEXT SENTENCE
 16372     ELSE
 16373        MOVE AL-SADOF            TO PFKEY6A.
 16374
 16375     IF PI-USES-PAID-TO
 16376        MOVE 'PAID TO  :' TO PTHRHDGO.
 16377
 16378
 16379* EXEC CICS SEND
 16380*         MAP     ('EL131A')
 16381*         MAPSET  ('EL131S')
 16382*         ERASE
 16383*         FREEKB
 16384*         CURSOR
 16385*    END-EXEC.
 16386     MOVE 'EL131A' TO DFHEIV1
 16387     MOVE -1
 16388       TO DFHEIV11
 16389     MOVE 'EL131S' TO DFHEIV2
 16390*    MOVE '8$     CT  E F  H     ,   #00013762' TO DFHEIV0
 16391     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16392     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16393     MOVE X'2020233030303133373632' TO DFHEIV0(25:11)
 16394     CALL 'kxdfhei1' USING DFHEIV0,
 16395           DFHEIV1,
 16396           EL131AO,
 16397           DFHEIV99,
 16398           DFHEIV2,
 16399           DFHEIV99,
 16400           DFHEIV99,
 16401           DFHEIV99,
 16402           DFHEIV11,
 16403           DFHEIV99,
 16404           DFHEIV99,
 16405           DFHEIV99
 16406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16407
 16408
 16409     GO TO 9000-RETURN-TRANS.
 16410
 16411 8110-SEND-DATA.
 16412     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16413
 16414     IF PI-USES-PAID-TO
 16415        MOVE 'PAID TO  :' TO PTHRHDGO.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 309
* EL131.cbl
 16416
 16417     IF PI-PROCESSOR-ID = 'LGXX'
 16418        MOVE AL-UANON            TO CCNOA.
 16419
 16420     IF PI-COMPANY-ID = 'DMD'
 16421        NEXT SENTENCE
 16422     ELSE
 16423        MOVE AL-SADOF            TO PFKEY6A.
 16424
 16425
 16426* EXEC CICS SEND
 16427*         MAP      ('EL131A')
 16428*         MAPSET   ('EL131S')
 16429*         DATAONLY
 16430*         FREEKB
 16431*         CURSOR
 16432*    END-EXEC.
 16433     MOVE 'EL131A' TO DFHEIV1
 16434     MOVE -1
 16435       TO DFHEIV11
 16436     MOVE 'EL131S' TO DFHEIV2
 16437*    MOVE '8$D    CT    F  H     ,   #00013786' TO DFHEIV0
 16438     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16439     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16440     MOVE X'2020233030303133373836' TO DFHEIV0(25:11)
 16441     CALL 'kxdfhei1' USING DFHEIV0,
 16442           DFHEIV1,
 16443           EL131AO,
 16444           DFHEIV99,
 16445           DFHEIV2,
 16446           DFHEIV99,
 16447           DFHEIV99,
 16448           DFHEIV99,
 16449           DFHEIV11,
 16450           DFHEIV99,
 16451           DFHEIV99,
 16452           DFHEIV99
 16453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16454
 16455
 16456     GO TO 9000-RETURN-TRANS.
 16457
 16458 8120-FORMAT-TIME-DATE.
 16459     perform 8140-check-for-prev-errors
 16460                                 thru 8140-exit
 16461     IF SKIP-ATTRIBUTE = 'Y'
 16462        MOVE SPACES              TO SKIP-ATTRIBUTE
 16463        MOVE ER-0598             TO EMI-ERROR
 16464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16465        GO TO 8125-SKIP-ATTRIBUTE.
 16466
 16467*     IF PI-COMPANY-ID = 'DMD'
 16468      IF PI-PROCESSOR-ID <> 'EMER'
 16469         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 16470                                    CERTCARA  CERTGRPA CERTA SUFXA
 16471
 16472     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16473                                    ISSAGEA   JNTLNMEA  JNTFNMEA
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 310
* EL131.cbl
 16474                                    JNTINITA  JNTAGEA   APRA
 16475                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16476                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16477                                    LCVEXITA  LCVSTATA  LCVKINDA
 16478                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16479                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16480                                    ACVEXITA  ACVSTATA  ACVKINDA
 16481                                    PMTFREQA  INDGRPA   PREMTYPA
 16482                                    REINCDA   LCVRATEA  ACVRATEA
 16483                                    ADDONDTA.
 16484
 16485*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16486*       IF PI-COMPANY-ID = 'DMD'
 16487*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16488*                                   SUFXA
 16489*                                   PDAMTA    NODAYSA   NOPMTSA
 16490*                                   INCA      OCCA
 16491*          IF NOT SYSTEM-MODIFY-CAP
 16492*              MOVE AL-SANOF         TO PDTHRUA.
 16493
 16494     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16495         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16496
 16497 8125-SKIP-ATTRIBUTE.
 16498
 16499     MOVE SAVE-DATE              TO DATEO.
 16500
 16501* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16502*    END-EXEC
 16503*    MOVE '0"A                   "   #00013838' TO DFHEIV0
 16504     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16505     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16506     MOVE X'2020233030303133383338' TO DFHEIV0(25:11)
 16507     CALL 'kxdfhei1' USING DFHEIV0,
 16508           LCP-CICS-TIME
 16509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16510
 16511* EXEC CICS FORMATTIME
 16512*              ABSTIME(LCP-CICS-TIME)
 16513*              TIME(LCP-TIME-OF-DAY-XX)
 16514*    END-EXEC
 16515*    MOVE 'j$(     (             #   #00013840' TO DFHEIV0
 16516     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16517     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16518     MOVE X'2020233030303133383430' TO DFHEIV0(25:11)
 16519     CALL 'kxdfhei1' USING DFHEIV0,
 16520           LCP-CICS-TIME,
 16521           LCP-TIME-OF-DAY-XX
 16522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16523     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16524     MOVE UN-HOURS               TO FOR-HOURS.
 16525     MOVE UN-MINUTES             TO FOR-MINUTES.
 16526     MOVE TIME-OUT               TO TIMEO.
 16527     MOVE PI-COMPANY-ID          TO COMPO.
 16528     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16529     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16530     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16531     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 311
* EL131.cbl
 16532     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 16533
 16534 8130-EXIT.
 16535     EXIT.
 16536
 16537 8140-check-for-prev-errors.
 16538
 16539     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16540     MOVE PI-CARRIER             TO trlr-carrier
 16541     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16542     MOVE PI-CERT-NO             TO trlr-cert-no
 16543     MOVE +95                    TO TRLR-SEQ-NO
 16544
 16545
 16546* EXEC CICS READ
 16547*       DATASET  ('ELTRLR')
 16548*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16549*       RIDFLD   (TRLR-KEY)
 16550*       RESP     (WS-RESPONSE)
 16551*    END-EXEC
 16552     MOVE 'ELTRLR' TO DFHEIV1
 16553*    MOVE '&"S        E          (  N#00013866' TO DFHEIV0
 16554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16555     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16556     MOVE X'204E233030303133383636' TO DFHEIV0(25:11)
 16557     CALL 'kxdfhei1' USING DFHEIV0,
 16558           DFHEIV1,
 16559           DFHEIV20,
 16560           DFHEIV99,
 16561           TRLR-KEY,
 16562           DFHEIV99,
 16563           DFHEIV99,
 16564           DFHEIV99
 16565     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16566         DFHEIV20
 16567     MOVE EIBRESP  TO WS-RESPONSE
 16568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16569
 16570     if ws-resp-normal
 16571        perform varying s1 from +1 by +1 until
 16572           at-note-error-no (s1) = spaces
 16573           if at-note-error-no (s1) = '1652'
 16574              continue
 16575           else
 16576              move at-note-error-no (s1)
 16577                                 to emi-error
 16578              move -1 to maintl
 16579              if at-note-error-no (s1) = '1653'
 16580                 evaluate true
 16581                    when pi-claim-type = 'L'
 16582                       move '  LF  '
 16583                        to emi-claim-type
 16584                    when pi-claim-type = 'I'
 16585                       move '  IU  '
 16586                        to emi-claim-type
 16587                    when other
 16588                       move '  AH  '
 16589                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 312
* EL131.cbl
 16590                 end-evaluate
 16591              end-if
 16592              PERFORM 9900-ERROR-FORMAT
 16593                                 THRU 9900-EXIT
 16594           end-if
 16595*          if at-note-error-no (s1) = '1653'
 16596*             perform varying emi-sub from 1 by 1 until
 16597*                emi-sub > 3
 16598*                if emi-error-number (emi-sub) = '1653'
 16599*                   evaluate true
 16600*                      when pi-claim-type = 'L'
 16601*                         move '  LF  '
 16602*                          to emi-claim-type
 16603*                      when pi-claim-type = 'I'
 16604*                         move '  IU  '
 16605*                          to emi-claim-type
 16606*                      when other
 16607*                         move '  AH  '
 16608*                          to emi-claim-type
 16609*                   end-evaluate
 16610*                end-if
 16611*             end-perform
 16612*          end-if
 16613        end-perform
 16614     else
 16615        display ' resp not normal ' ws-response ' '
 16616        trlr-key (2:19)
 16617     end-if
 16618
 16619     .
 16620 8140-exit.
 16621     exit.
 16622 8150-ENTERED-CLAIM-NOTFOUND.
 16623
 16624     MOVE ER-0204                TO EMI-ERROR.
 16625     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16626     MOVE -1                     TO MAINTL.
 16627     GO TO 8100-SEND-MAP.
 16628
 16629 8200-RETURN-PRIOR.
 16630     MOVE SPACE                  TO PI-RETURN-CD-1.
 16631     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16632     GO TO 9200-XCTL.
 16633
 16634 8300-GET-HELP.
 16635     MOVE XCTL-EL010             TO CALL-PGM.
 16636     GO TO 9200-XCTL.
 16637
 16638 8400-RETURN-MASTER.
 16639     MOVE SPACE                  TO PI-RETURN-CD-1.
 16640     MOVE XCTL-EL126             TO CALL-PGM.
 16641     GO TO 9200-XCTL.
 16642
 16643 8500-TRLR-MNT.
 16644     IF PI-RETURN-CD-1 = 'X'
 16645         MOVE ER-0311            TO EMI-ERROR
 16646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16647         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 313
* EL131.cbl
 16648         GO TO 8110-SEND-DATA.
 16649
 16650
 16651* EXEC CICS WRITEQ TS
 16652*         QUEUE     (PI-KEY)
 16653*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16654*         LENGTH    (PI-COMM-LENGTH)
 16655*    END-EXEC.
 16656*    MOVE '*"                    ''   #00013953' TO DFHEIV0
 16657     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16658     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16659     MOVE X'2020233030303133393533' TO DFHEIV0(25:11)
 16660     CALL 'kxdfhei1' USING DFHEIV0,
 16661           PI-KEY,
 16662           PROGRAM-INTERFACE-BLOCK,
 16663           PI-COMM-LENGTH,
 16664           DFHEIV99,
 16665           DFHEIV99,
 16666           DFHEIV99
 16667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16668
 16669
 16670     MOVE XCTL-EL142             TO CALL-PGM.
 16671     GO TO 9200-XCTL.
 16672
 16673 8600-ADDR-MNT.
 16674     IF PI-RETURN-CD-1 = 'X'
 16675         MOVE ER-0311            TO EMI-ERROR
 16676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16677         MOVE -1                 TO MAINTL
 16678         GO TO 8110-SEND-DATA.
 16679
 16680
 16681* EXEC CICS WRITEQ TS
 16682*         QUEUE     (PI-KEY)
 16683*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16684*         LENGTH    (PI-COMM-LENGTH)
 16685*    END-EXEC.
 16686*    MOVE '*"                    ''   #00013969' TO DFHEIV0
 16687     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16688     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16689     MOVE X'2020233030303133393639' TO DFHEIV0(25:11)
 16690     CALL 'kxdfhei1' USING DFHEIV0,
 16691           PI-KEY,
 16692           PROGRAM-INTERFACE-BLOCK,
 16693           PI-COMM-LENGTH,
 16694           DFHEIV99,
 16695           DFHEIV99,
 16696           DFHEIV99
 16697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16698
 16699
 16700     MOVE XCTL-EL141             TO CALL-PGM.
 16701     GO TO 9200-XCTL.
 16702
 16703 8700-CERT-MNT.
 16704     IF PI-RETURN-CD-1 = 'X'
 16705         MOVE ER-7690            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 314
* EL131.cbl
 16706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16707         MOVE -1                 TO MAINTL
 16708         GO TO 8110-SEND-DATA.
 16709
 16710
 16711* EXEC CICS WRITEQ TS
 16712*         QUEUE     (PI-KEY)
 16713*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16714*         LENGTH    (PI-COMM-LENGTH)
 16715*    END-EXEC.
 16716*    MOVE '*"                    ''   #00013985' TO DFHEIV0
 16717     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16719     MOVE X'2020233030303133393835' TO DFHEIV0(25:11)
 16720     CALL 'kxdfhei1' USING DFHEIV0,
 16721           PI-KEY,
 16722           PROGRAM-INTERFACE-BLOCK,
 16723           PI-COMM-LENGTH,
 16724           DFHEIV99,
 16725           DFHEIV99,
 16726           DFHEIV99
 16727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16728
 16729
 16730     MOVE XCTL-EL1273            TO CALL-PGM.
 16731     GO TO 9200-XCTL.
 16732
 16733 8725-BENEFICIARY-MNT.
 16734     IF PI-RETURN-CD-1 = 'X'
 16735         MOVE ER-0311            TO EMI-ERROR
 16736         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16737         MOVE -1                 TO MAINTL
 16738         GO TO 8110-SEND-DATA.
 16739
 16740
 16741* EXEC CICS WRITEQ TS
 16742*         QUEUE     (PI-KEY)
 16743*         FROM      (EL131AI)
 16744*         LENGTH    (MAP-LENGTH)
 16745*    END-EXEC.
 16746*    MOVE '*"                    ''   #00014001' TO DFHEIV0
 16747     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16748     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16749     MOVE X'2020233030303134303031' TO DFHEIV0(25:11)
 16750     CALL 'kxdfhei1' USING DFHEIV0,
 16751           PI-KEY,
 16752           EL131AI,
 16753           MAP-LENGTH,
 16754           DFHEIV99,
 16755           DFHEIV99,
 16756           DFHEIV99
 16757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16758
 16759
 16760
 16761* EXEC CICS WRITEQ TS
 16762*         QUEUE     (PI-KEY)
 16763*         FROM      (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 315
* EL131.cbl
 16764*         LENGTH    (PI-COMM-LENGTH)
 16765*    END-EXEC.
 16766*    MOVE '*"                    ''   #00014007' TO DFHEIV0
 16767     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16768     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16769     MOVE X'2020233030303134303037' TO DFHEIV0(25:11)
 16770     CALL 'kxdfhei1' USING DFHEIV0,
 16771           PI-KEY,
 16772           PROGRAM-INTERFACE-BLOCK,
 16773           PI-COMM-LENGTH,
 16774           DFHEIV99,
 16775           DFHEIV99,
 16776           DFHEIV99
 16777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16778
 16779
 16780     MOVE XCTL-EL114             TO CALL-PGM.
 16781     GO TO 9200-XCTL.
 16782
 16783 8750-DMD-CLM-FIX.
 16784
 16785* EXEC CICS WRITEQ TS
 16786*         QUEUE     (PI-KEY)
 16787*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16788*         LENGTH    (PI-COMM-LENGTH)
 16789*    END-EXEC.
 16790*    MOVE '*"                    ''   #00014017' TO DFHEIV0
 16791     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16792     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16793     MOVE X'2020233030303134303137' TO DFHEIV0(25:11)
 16794     CALL 'kxdfhei1' USING DFHEIV0,
 16795           PI-KEY,
 16796           PROGRAM-INTERFACE-BLOCK,
 16797           PI-COMM-LENGTH,
 16798           DFHEIV99,
 16799           DFHEIV99,
 16800           DFHEIV99
 16801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16802
 16803
 16804     MOVE XCTL-EL400DMD          TO CALL-PGM.
 16805     GO TO 9200-XCTL.
 16806
 16807 8800-UNAUTHORIZED-ACCESS.
 16808     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16809     GO TO 8990-SEND-TEXT.
 16810
 16811 8810-PF23-ENTERED.
 16812     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 16813     MOVE XCTL-EL005             TO CALL-PGM.
 16814     GO TO 9200-XCTL.
 16815
 16816 8820-XCTL-ERROR.
 16817
 16818* EXEC CICS HANDLE CONDITION
 16819*        PGMIDERR (8990-SEND-TEXT)
 16820*    END-EXEC.
 16821*    MOVE '"$L                   ! H #00014036' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 316
* EL131.cbl
 16822     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16823     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16824     MOVE X'4820233030303134303336' TO DFHEIV0(25:11)
 16825     CALL 'kxdfhei1' USING DFHEIV0
 16826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16827
 16828
 16829     MOVE SPACE                 TO PI-ENTRY-CD-1.
 16830     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 16831     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 16832     MOVE XCTL-EL005            TO CALL-PGM.
 16833     GO TO 9200-XCTL.
 16834
 16835 8990-SEND-TEXT.
 16836
 16837* EXEC CICS SEND TEXT
 16838*         FROM      (LOGOFF-TEXT)
 16839*         LENGTH    (LOGOFF-LENGTH)
 16840*         ERASE
 16841*         FREEKB
 16842*    END-EXEC.
 16843*    MOVE '8&      T  E F  H   F -   #00014047' TO DFHEIV0
 16844     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16845     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16846     MOVE X'2020233030303134303437' TO DFHEIV0(25:11)
 16847     CALL 'kxdfhei1' USING DFHEIV0,
 16848           LOGOFF-TEXT,
 16849           LOGOFF-LENGTH,
 16850           DFHEIV99,
 16851           DFHEIV99,
 16852           DFHEIV99,
 16853           DFHEIV99,
 16854           DFHEIV99,
 16855           DFHEIV99,
 16856           DFHEIV99,
 16857           DFHEIV99,
 16858           DFHEIV99,
 16859           DFHEIV99
 16860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16861
 16862
 16863     GO TO 9100-RETURN-CICS.
 16864
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 317
* EL131.cbl
 16866 9000-RETURN-TRANS.
 16867
 16868* EXEC CICS RETURN
 16869*         TRANSID   (TRANS-ID)
 16870*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16871*         LENGTH    (PI-COMM-LENGTH)
 16872*    END-EXEC.
 16873*    MOVE '.(CT                  ''   #00014058' TO DFHEIV0
 16874     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16875     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16876     MOVE X'2020233030303134303538' TO DFHEIV0(25:11)
 16877     CALL 'kxdfhei1' USING DFHEIV0,
 16878           TRANS-ID,
 16879           PROGRAM-INTERFACE-BLOCK,
 16880           PI-COMM-LENGTH,
 16881           DFHEIV99,
 16882           DFHEIV99,
 16883           DFHEIV99
 16884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16885
 16886
 16887
 16888* GOBACK.
 16889     MOVE '9%                    "   ' TO DFHEIV0
 16890     MOVE 'EL131' TO DFHEIV1
 16891     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16892     GOBACK.
 16893
 16894 9100-RETURN-CICS.
 16895
 16896* EXEC CICS RETURN
 16897*    END-EXEC.
 16898*    MOVE '.(                    ''   #00014067' TO DFHEIV0
 16899     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16900     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16901     MOVE X'2020233030303134303637' TO DFHEIV0(25:11)
 16902     CALL 'kxdfhei1' USING DFHEIV0,
 16903           DFHEIV99,
 16904           DFHEIV99,
 16905           DFHEIV99,
 16906           DFHEIV99,
 16907           DFHEIV99,
 16908           DFHEIV99
 16909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16910
 16911
 16912
 16913* GOBACK.
 16914     MOVE '9%                    "   ' TO DFHEIV0
 16915     MOVE 'EL131' TO DFHEIV1
 16916     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16917     GOBACK.
 16918
 16919 9200-XCTL.
 16920
 16921* EXEC CICS XCTL
 16922*         PROGRAM    (CALL-PGM)
 16923*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 318
* EL131.cbl
 16924*         LENGTH     (PI-COMM-LENGTH)
 16925*    END-EXEC.
 16926*    MOVE '.$C                   %   #00014073' TO DFHEIV0
 16927     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16928     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16929     MOVE X'2020233030303134303733' TO DFHEIV0(25:11)
 16930     CALL 'kxdfhei1' USING DFHEIV0,
 16931           CALL-PGM,
 16932           PROGRAM-INTERFACE-BLOCK,
 16933           PI-COMM-LENGTH,
 16934           DFHEIV99
 16935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16936
 16937
 16938 9700-LINK-RTRM-FILE-ID.
 16939
 16940* EXEC CICS LINK
 16941*        PROGRAM  (RTRM-FILE-ID)
 16942*        COMMAREA (CALCULATION-PASS-AREA)
 16943*        LENGTH   (CP-COMM-LENGTH)
 16944*    END-EXEC.
 16945*    MOVE '."C                   (   #00014080' TO DFHEIV0
 16946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16948     MOVE X'2020233030303134303830' TO DFHEIV0(25:11)
 16949     CALL 'kxdfhei1' USING DFHEIV0,
 16950           RTRM-FILE-ID,
 16951           CALCULATION-PASS-AREA,
 16952           CP-COMM-LENGTH,
 16953           DFHEIV99,
 16954           DFHEIV99,
 16955           DFHEIV99,
 16956           DFHEIV99
 16957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16958
 16959
 16960 9700-EXIT.
 16961      EXIT.
 16962
 16963 9800-CONVERT-DATE.
 16964     MOVE SPACES TO DC-ERROR-CODE.
 16965
 16966* EXEC CICS LINK
 16967*         PROGRAM    (DATE-CONV)
 16968*         COMMAREA   (DATE-CONVERSION-DATA)
 16969*         LENGTH     (DC-COMM-LENGTH)
 16970*    END-EXEC.
 16971*    MOVE '."C                   (   #00014091' TO DFHEIV0
 16972     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16974     MOVE X'2020233030303134303931' TO DFHEIV0(25:11)
 16975     CALL 'kxdfhei1' USING DFHEIV0,
 16976           DATE-CONV,
 16977           DATE-CONVERSION-DATA,
 16978           DC-COMM-LENGTH,
 16979           DFHEIV99,
 16980           DFHEIV99,
 16981           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 319
* EL131.cbl
 16982           DFHEIV99
 16983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16984
 16985
 16986 9800-EXIT.
 16987     EXIT.
 16988
 16989 9900-ERROR-FORMAT.
 16990
 16991* EXEC CICS LINK
 16992*         PROGRAM    (XCTL-EL001)
 16993*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 16994*         LENGTH     (EMI-COMM-LENGTH)
 16995*    END-EXEC.
 16996*    MOVE '."C                   (   #00014101' TO DFHEIV0
 16997     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16999     MOVE X'2020233030303134313031' TO DFHEIV0(25:11)
 17000     CALL 'kxdfhei1' USING DFHEIV0,
 17001           XCTL-EL001,
 17002           ERROR-MESSAGE-INTERFACE-BLOCK,
 17003           EMI-COMM-LENGTH,
 17004           DFHEIV99,
 17005           DFHEIV99,
 17006           DFHEIV99,
 17007           DFHEIV99
 17008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17009
 17010
 17011 9900-EXIT.
 17012     EXIT.
 17013
 17014 9990-ABEND.
 17015     MOVE DFHEIBLK               TO EMI-LINE1.
 17016
 17017* EXEC CICS LINK
 17018*         PROGRAM   (XCTL-EL004)
 17019*         COMMAREA  (EMI-LINE1)
 17020*         LENGTH    (72)
 17021*     END-EXEC.
 17022     MOVE 72
 17023       TO DFHEIV11
 17024*    MOVE '."C                   (   #00014112' TO DFHEIV0
 17025     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17027     MOVE X'2020233030303134313132' TO DFHEIV0(25:11)
 17028     CALL 'kxdfhei1' USING DFHEIV0,
 17029           XCTL-EL004,
 17030           EMI-LINE1,
 17031           DFHEIV11,
 17032           DFHEIV99,
 17033           DFHEIV99,
 17034           DFHEIV99,
 17035           DFHEIV99
 17036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17037
 17038
 17039     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 320
* EL131.cbl
 17040
 17041     GO TO 8110-SEND-DATA.
 17042
 17043 9995-SECURITY-VIOLATION.
 17044*           COPY ELCSCTP.
 17045******************************************************************
 17046*                                                                *
 17047*                            ELCSCTP                             *
 17048*                            VMOD=2.001                          *
 17049*                                                                *
 17050*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17051******************************************************************
 17052
 17053
 17054     MOVE EIBDATE          TO SM-JUL-DATE.
 17055     MOVE EIBTRMID         TO SM-TERMID.
 17056     MOVE THIS-PGM         TO SM-PGM.
 17057     MOVE EIBTIME          TO TIME-IN.
 17058     MOVE TIME-OUT         TO SM-TIME.
 17059     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17060
 17061
 17062* EXEC CICS LINK
 17063*         PROGRAM  ('EL003')
 17064*         COMMAREA (SECURITY-MESSAGE)
 17065*         LENGTH   (80)
 17066*    END-EXEC.
 17067     MOVE 'EL003' TO DFHEIV1
 17068     MOVE 80
 17069       TO DFHEIV11
 17070*    MOVE '."C                   (   #00014140' TO DFHEIV0
 17071     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17073     MOVE X'2020233030303134313430' TO DFHEIV0(25:11)
 17074     CALL 'kxdfhei1' USING DFHEIV0,
 17075           DFHEIV1,
 17076           SECURITY-MESSAGE,
 17077           DFHEIV11,
 17078           DFHEIV99,
 17079           DFHEIV99,
 17080           DFHEIV99,
 17081           DFHEIV99
 17082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17083
 17084
 17085******************************************************************
 17086
 17087
 17088
 17089 9999-DFHBACK SECTION.
 17090     MOVE '9%                    "   ' TO DFHEIV0
 17091     MOVE 'EL131' TO DFHEIV1
 17092     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17093     GOBACK.
 17094 9999-DFHEXIT.
 17095     IF DFHEIGDJ EQUAL 0001
 17096         NEXT SENTENCE
 17097     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 321
* EL131.cbl
 17098         GO TO 8820-XCTL-ERROR,
 17099               8150-ENTERED-CLAIM-NOTFOUND,
 17100               9990-ABEND
 17101         DEPENDING ON DFHEIGDI
 17102     ELSE IF DFHEIGDJ EQUAL 3
 17103         GO TO 0130-TS-ERROR,
 17104               0130-TS-ERROR
 17105         DEPENDING ON DFHEIGDI
 17106     ELSE IF DFHEIGDJ EQUAL 4
 17107         GO TO 0600-CONTINUE-NAME-UPDATE
 17108         DEPENDING ON DFHEIGDI
 17109     ELSE IF DFHEIGDJ EQUAL 5
 17110         GO TO 1004-BENE-NOT-FOUND
 17111         DEPENDING ON DFHEIGDI
 17112     ELSE IF DFHEIGDJ EQUAL 6
 17113         GO TO 1120-CNTL-NOTFND
 17114         DEPENDING ON DFHEIGDI
 17115     ELSE IF DFHEIGDJ EQUAL 7
 17116         GO TO 1150-NOTOPEN-ERROR,
 17117               1150-EXIT
 17118         DEPENDING ON DFHEIGDI
 17119     ELSE IF DFHEIGDJ EQUAL 8
 17120         GO TO 1490-STATE-NOTFND
 17121         DEPENDING ON DFHEIGDI
 17122     ELSE IF DFHEIGDJ EQUAL 9
 17123         GO TO 1500-CARR-NOTFND
 17124         DEPENDING ON DFHEIGDI
 17125     ELSE IF DFHEIGDJ EQUAL 10
 17126         GO TO 1620-ACCT-NOTFND
 17127         DEPENDING ON DFHEIGDI
 17128     ELSE IF DFHEIGDJ EQUAL 11
 17129         GO TO 2020-EXIT
 17130         DEPENDING ON DFHEIGDI
 17131     ELSE IF DFHEIGDJ EQUAL 12
 17132         GO TO 2030-EXIT
 17133         DEPENDING ON DFHEIGDI
 17134     ELSE IF DFHEIGDJ EQUAL 13
 17135         GO TO 2040-EXIT
 17136         DEPENDING ON DFHEIGDI
 17137     ELSE IF DFHEIGDJ EQUAL 14
 17138         GO TO 2050-EXIT
 17139         DEPENDING ON DFHEIGDI
 17140     ELSE IF DFHEIGDJ EQUAL 15
 17141         GO TO 2060-CERT-NOTFND
 17142         DEPENDING ON DFHEIGDI
 17143     ELSE IF DFHEIGDJ EQUAL 16
 17144         GO TO 2060-DUPKEY
 17145         DEPENDING ON DFHEIGDI
 17146     ELSE IF DFHEIGDJ EQUAL 17
 17147         GO TO 2070-NOT-FOUND
 17148         DEPENDING ON DFHEIGDI
 17149     ELSE IF DFHEIGDJ EQUAL 18
 17150         GO TO 2070-EXIT
 17151         DEPENDING ON DFHEIGDI
 17152     ELSE IF DFHEIGDJ EQUAL 19
 17153         GO TO 2080-EXIT
 17154         DEPENDING ON DFHEIGDI
 17155     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 322
* EL131.cbl
 17156         GO TO 2400-TRLR-NOTFND,
 17157               2410-EXIT
 17158         DEPENDING ON DFHEIGDI
 17159     ELSE IF DFHEIGDJ EQUAL 21
 17160         GO TO 2425-NINETY-NOTFND,
 17161               2425-NINETY-NOTFND
 17162         DEPENDING ON DFHEIGDI
 17163     ELSE IF DFHEIGDJ EQUAL 22
 17164         GO TO 2430-EXIT,
 17165               2440-EXIT
 17166         DEPENDING ON DFHEIGDI
 17167     ELSE IF DFHEIGDJ EQUAL 23
 17168         GO TO 2440-EXIT
 17169         DEPENDING ON DFHEIGDI
 17170     ELSE IF DFHEIGDJ EQUAL 24
 17171         GO TO 2460-EXIT
 17172         DEPENDING ON DFHEIGDI
 17173     ELSE IF DFHEIGDJ EQUAL 25
 17174         GO TO 2475-EXIT
 17175         DEPENDING ON DFHEIGDI
 17176     ELSE IF DFHEIGDJ EQUAL 26
 17177         GO TO 2650-EXIT
 17178         DEPENDING ON DFHEIGDI
 17179     ELSE IF DFHEIGDJ EQUAL 27
 17180         GO TO 2800-EXIT,
 17181               2800-EXIT
 17182         DEPENDING ON DFHEIGDI
 17183     ELSE IF DFHEIGDJ EQUAL 28
 17184         GO TO 3010-DEL-ACTQ,
 17185               3040-EXIT
 17186         DEPENDING ON DFHEIGDI
 17187     ELSE IF DFHEIGDJ EQUAL 29
 17188         GO TO 3010-NO-ACTIVITY,
 17189               3050-EXIT
 17190         DEPENDING ON DFHEIGDI
 17191     ELSE IF DFHEIGDJ EQUAL 30
 17192         GO TO 3010-CERT-NOT-FOUND
 17193         DEPENDING ON DFHEIGDI
 17194     ELSE IF DFHEIGDJ EQUAL 31
 17195         GO TO 3020-EXIT
 17196         DEPENDING ON DFHEIGDI
 17197     ELSE IF DFHEIGDJ EQUAL 32
 17198         GO TO 3060-EXIT,
 17199               3060-EXIT
 17200         DEPENDING ON DFHEIGDI
 17201     ELSE IF DFHEIGDJ EQUAL 33
 17202         GO TO 5000-TRLR-NOT-FOUND
 17203         DEPENDING ON DFHEIGDI
 17204     ELSE IF DFHEIGDJ EQUAL 34
 17205         GO TO 5000-CERT-NOT-FOUND
 17206         DEPENDING ON DFHEIGDI
 17207     ELSE IF DFHEIGDJ EQUAL 35
 17208         GO TO 7630-END-BROWSE
 17209         DEPENDING ON DFHEIGDI
 17210     ELSE IF DFHEIGDJ EQUAL 36
 17211         GO TO 7799-EXIT,
 17212               7799-EXIT
 17213         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 19-May-14 13:28 Page 323
* EL131.cbl
 17214     ELSE IF DFHEIGDJ EQUAL 37
 17215         GO TO 7799-EXIT
 17216         DEPENDING ON DFHEIGDI
 17217     ELSE IF DFHEIGDJ EQUAL 38
 17218         GO TO 7800-NOT-FOUND
 17219         DEPENDING ON DFHEIGDI
 17220     ELSE IF DFHEIGDJ EQUAL 39
 17221         GO TO 8000-NOTE-NOT-FOUND
 17222         DEPENDING ON DFHEIGDI
 17223     ELSE IF DFHEIGDJ EQUAL 40
 17224         GO TO 8990-SEND-TEXT
 17225         DEPENDING ON DFHEIGDI.
 17226     MOVE '9%                    "   ' TO DFHEIV0
 17227     MOVE 'EL131' TO DFHEIV1
 17228     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17229     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13572     Code:       59521
