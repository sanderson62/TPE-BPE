* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   1
* EL6317.cbl
* Options: int("EL6317.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6317.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6317.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6317.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6317.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   2
* EL6317.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 071712 CR2011022800001  AJRA  NAPERSOFT CANCELS
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 100412   2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34*-----------------------------------------------------------------
    35*REMARKS.
    36*        TRANSACTION - EXBD - CERTIFICATE VERIFICATION
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   3
* EL6317.cbl
    38 ENVIRONMENT DIVISION.
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*    EL6317 WORKING STORAGE    *'.
    44 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    45 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    46 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    47 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    48 77  s1                          pic s999 comp-3 value +0.
    49 77  s2                          pic s999 comp-3 value +0.
    50 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    51 77  WS-REASON-SW                PIC X  VALUE ' '.
    52     88  REASONS-FOUND                  VALUE 'Y'.
    53     88  REASONS-NOT-FOUND              VALUE 'N'.
    54 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    55     88  NO-CERT-RW                 VALUE 'N'.
    56     88  CERT-RW                    VALUE 'Y'.
    57 01  P pointer.
    58 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    59 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    60 01  var-ptr pointer.
    61 01  env-var-len                 pic 9(4)  binary.
    62 01  rc                          pic 9(9)  binary.
    63 01  WS-KIXHOST                  PIC X(10).
    64 01  WS-KIXSYS.
    65     05  WS-KIX-FIL1             PIC X(10).
    66     05  WS-KIX-APPS             PIC X(10).
    67     05  WS-KIX-ENV              PIC X(10).
    68     05  WS-KIX-MYENV            PIC X(10).
    69     05  WS-KIX-SYS              PIC X(10).
    70*                                COPY ELCSCTM.
    71******************************************************************
    72*                                                                *
    73*                                                                *
    74*                            ELCSCTM                             *
    75*                            VMOD=2.001                          *
    76*                                                                *
    77*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    78*                                                                *
    79******************************************************************
    80 01  SECURITY-MESSAGE.
    81     12  FILLER                          PIC X(30)
    82            VALUE '** LOGIC SECURITY VIOLATION -'.
    83     12  SM-READ                         PIC X(6).
    84     12  FILLER                          PIC X(5)
    85            VALUE ' PGM='.
    86     12  SM-PGM                          PIC X(6).
    87     12  FILLER                          PIC X(5)
    88            VALUE ' OPR='.
    89     12  SM-PROCESSOR-ID                 PIC X(4).
    90     12  FILLER                          PIC X(6)
    91            VALUE ' TERM='.
    92     12  SM-TERMID                       PIC X(4).
    93     12  FILLER                          PIC XX   VALUE SPACE.
    94     12  SM-JUL-DATE                     PIC 9(5).
    95     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   4
* EL6317.cbl
    96     12  SM-TIME                         PIC 99.99.
    97
    98*                                COPY ELCSCRTY.
    99******************************************************************
   100*                                                                *
   101*                                                                *
   102*                            ELCSCRTY                            *
   103*                            VMOD=2.001                          *
   104*                                                                *
   105*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   106*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   107*        SAVED IN PI-SECURITY-ADDRESS.                           *
   108*                                                                *
   109******************************************************************
   110 01  SECURITY-CONTROL.
   111     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   112     12  FILLER                       PIC XX    VALUE 'SC'.
   113     12  SC-CREDIT-CODES.
   114         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   115             20  SC-CREDIT-DISPLAY    PIC X.
   116             20  SC-CREDIT-UPDATE     PIC X.
   117     12  SC-CLAIMS-CODES.
   118         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   119             20  SC-CLAIMS-DISPLAY    PIC X.
   120             20  SC-CLAIMS-UPDATE     PIC X.
   121 01 srch-commarea.
   122*                                copy ELCADLTRSPI.
   123******************************************************************
   124*                   C H A N G E   L O G
   125*
   126* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   127*-----------------------------------------------------------------
   128*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   129* EFFECTIVE    NUMBER
   130*-----------------------------------------------------------------
   131* 060611    2011022800001  PEMA  NEW COPYBOOK
   132* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   133* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   134******************************************************************
   135****************************************
   136*  commarea for NaperSoft On Demand Admin services letters
   137*  (business logic input & output)
   138****************************************
   139     03  BL-INPUT.
   140         05  BL-DATA-SRCE        PIC X.
   141         05  BL-LETTER-ID        PIC XXXX.
   142         05  BL-CARRIER          PIC X.
   143         05  BL-GROUP            PIC X(6).
   144         05  BL-STATE            PIC XX.
   145         05  BL-ACCOUNT          PIC X(10).
   146         05  BL-EFF-DT           PIC X(10).
   147         05  BL-CERT-NO          PIC X(11).
   148         05  BL-BATCH-NO         PIC X(6).
   149         05  BL-BATCH-SEQ        PIC 9(8).
   150         05  BL-RESP-NO          PIC X(10).
   151         05  BL-NO-OF-COPIES     PIC 99.
   152         05  BL-PROC-ID          PIC XXXX.
   153         05  BL-COMP-ID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   5
* EL6317.cbl
   154         05  BL-PRINT-NOW-SW     PIC X.
   155         05  BL-ENC-CD           PIC XXX.
   156         05  BL-RESEND-DT        PIC X(10).
   157         05  BL-FOLLOW-UP-DT     PIC X(10).
   158         05  BL-ARCHIVE-NO       PIC 9(8).
   159         05  BL-FUNC             PIC X(8).
   160         05  BL-COMMENTS         PIC X(100).
   161         05  FILLER REDEFINES BL-COMMENTS.
   162             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   163             10  BL-LETTER-TO-ACCT PIC X.
   164             10  BL-LETTER-TO-BENE PIC X.
   165             10  BL-WRITE-ERARCH   PIC X.
   166                 88  ERARCH-QWS      VALUE 'Q'.
   167                 88  ERARCH-BATCH    VALUE 'B'.
   168                 88  ERARCH-TEMP     VALUE 'T'.
   169             10  BL-PROCESS-TYPE PIC X(07).
   170             10  BL-CERT-FORM-ID PIC X(05).
   171             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   172             10  BL-SOURCE-SCREEN PIC X(8).
   173             10  FILLER          PIC X(25).
   174     03  BL-OUTPUT.
   175         05  BL-STATUS                   PIC X.
   176             88  BL-OK                      VALUE "P".
   177             88  BL-FAIL                  VALUE "F".
   178         05  BL-MESSAGE          PIC X(50).
   179     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   180     03  FILLER                  PIC X(31).
   181
   182*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   183*                                COPY ELCZREC.
   184******************************************************************
   185*                                                                *
   186*                                                                *
   187*                            ELCZREC.                            *
   188*                                                                *
   189*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   190*                                                                *
   191******************************************************************
   192*-----------------------------------------------------------------
   193*                   C H A N G E   L O G
   194*
   195* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   196*-----------------------------------------------------------------
   197*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   198* EFFECTIVE    NUMBER
   199*-----------------------------------------------------------------
   200* 122011    2011022800001  AJRA  NEW FILE
   201* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   202*-----------------------------------------------------------------
   203 01  W-Z-CONTROL-DATA.
   204     05  W-NUMBER-OF-COPIES      PIC  9.
   205     05  FILLER                  PIC  X.
   206     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   207     05  FILLER                  PIC  X.
   208     05  W-DAYS-TO-RESEND        PIC  999.
   209     05  FILLER                  PIC  X.
   210     05  W-FORM-TO-RESEND        PIC  X(4).
   211     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   6
* EL6317.cbl
   212     05  W-PROMPT-LETTER         PIC  X.
   213     05  FILLER                  PIC  X.
   214     05  W-ENCLOSURE-CD          PIC  XXX.
   215     05  FILLER                  PIC  X.
   216     05  W-AUTO-CLOSE-IND        PIC  X.
   217     05  FILLER                  PIC  X.
   218     05  W-LETTER-TO-BENE        PIC  X.
   219     05  FILLER                  PIC  X.
   220     05  W-LETTER-TO-ACCT        PIC  X.
   221     05  FILLER                  PIC  X.
   222     05  W-LETTER-TYPE           PIC  X.
   223     05  FILLER                  PIC  X.
   224     05  W-PRINT-CERTIFICATE     PIC  X.
   225     05  FILLER                  PIC  X.
   226     05  W-REFUND-REQUIRED       PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-ONBASE-CODE           PIC  XX.
   229     05  FILLER                  PIC  X.
   230     05  W-ACCT-SUMM             PIC  X.
   231     05  FILLER                  PIC  X.
   232     05  W-CSO-SUMM              PIC  X.
   233     05  FILLER                  PIC  X(31).
   234 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   235 01  STANDARD-AREAS.
   236     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   237     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   238                                 PIC  X(08).
   239     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   240     12  QID.
   241         16  QID-TERM        PIC X(4)    VALUE SPACES.
   242         16  FILLER          PIC X(4)    VALUE '631J'.
   243     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   244     12  TIME-MT                 PIC S9(7).
   245     12  TIME-MT-R  REDEFINES TIME-MT.
   246         16  FILLER              PIC X.
   247         16  TIME-LMT            PIC 99V99.
   248         16  FILLER              PIC X(2).
   249     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   250     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   251     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   252     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   253     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   254     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   255     12  W-CNTL-KEY.
   256         16  W-CNTL-COMPANY-ID   PIC  X(03).
   257         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   258         16  W-CNTL-GENL.
   259             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   260             20  W-CNTL-GEN2.
   261                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   262                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   263         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   264     12  WS-ELCERT-KEY.
   265         16  W-CERT-COMPANY-CD   PIC X.
   266         16  W-CERT-CARRIER      PIC X.
   267         16  W-CERT-GROUPING     PIC X(6).
   268         16  W-CERT-STATE        PIC XX.
   269         16  W-CERT-ACCOUNT      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   7
* EL6317.cbl
   270         16  W-CERT-CERT-EFF-DT  PIC XX.
   271         16  W-CERT-CERT-PRIME   PIC X(10).
   272         16  W-CERT-CERT-SFX     PIC X.
   273     12  WS-ELEOBC-KEY.
   274         16  WS-EOBC-COMPANY-CD  PIC X.
   275         16  WS-EOBC-REC-TYPE    PIC X.
   276         16  WS-EOBC-CODE        PIC X(4).
   277         16  FILLER              PIC X(9).
   278     12  WS-ERNOTE-KEY.
   279         16  W-NOTE-COMPANY-CD   PIC X.
   280         16  W-NOTE-CARRIER      PIC X.
   281         16  W-NOTE-GROUPING     PIC X(6).
   282         16  W-NOTE-STATE        PIC XX.
   283         16  W-NOTE-ACCOUNT      PIC X(10).
   284         16  W-NOTE-CERT-EFF-DT  PIC XX.
   285         16  W-NOTE-CERT-PRIME   PIC X(10).
   286         16  W-NOTE-CERT-SFX     PIC X.
   287     12  ELLETR-KEY.
   288         16  LETR-PART-KEY.
   289             20  LETR-COMPANY-CD PIC X.
   290             20  LETR-LETTER-ID  PIC X(4).
   291         16  LETR-FILLER         PIC X(8).
   292         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   293     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   294     12  ERPNDB2-KEY.
   295         16  PNDB2-COMPANY-CD    PIC X.
   296         16  PNDB2-CARRIER       PIC X.
   297         16  PNDB2-GROUPING      PIC X(6).
   298         16  PNDB2-STATE         PIC XX.
   299         16  PNDB2-ACCOUNT       PIC X(10).
   300         16  PNDB2-CERT-EFF-DT   PIC XX.
   301         16  PNDB2-CERT-PRIME    PIC X(10).
   302         16  PNDB2-CERT-SFX      PIC X.
   303         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   304         16  PNDB2-RECORD-TYPE   PIC X.
   305     12  ERPNDB-KEY.
   306         16  PNDB-COMPANY-CD     PIC X.
   307         16  PNDB-BATCH-NO       PIC X(6).
   308         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   309         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   310     12  ERENDT-KEY.
   311         16  ENDT-COMPANY-CD       PIC X.
   312         16  ENDT-CARRIER          PIC X.
   313         16  ENDT-GROUPING         PIC X(6).
   314         16  ENDT-STATE            PIC XX.
   315         16  ENDT-ACCOUNT          PIC X(10).
   316         16  ENDT-CERT-EFF-DT      PIC XX.
   317         16  ENDT-CERT-PRIME       PIC X(10).
   318         16  ENDT-CERT-SFX         PIC X.
   319         16  ENDT-RECORD-TYPE      PIC X.
   320         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   321     12  ELCRTO-KEY.
   322         16  CRTO-COMPANY-CD     PIC X.
   323         16  CRTO-CARRIER        PIC X.
   324         16  CRTO-GROUPING       PIC X(6).
   325         16  CRTO-STATE          PIC XX.
   326         16  CRTO-ACCOUNT        PIC X(10).
   327         16  CRTO-CERT-EFF-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   8
* EL6317.cbl
   328         16  CRTO-CERT-PRIME     PIC X(10).
   329         16  CRTO-CERT-SFX       PIC X.
   330         16  CRTO-RECORD-TYPE    PIC X.
   331         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   332     12  WS-ERMAIL-KEY.
   333         16  MAIL-COMPANY-CD     PIC X.
   334         16  MAIL-CARRIER        PIC X.
   335         16  MAIL-GROUPING       PIC X(6).
   336         16  MAIL-STATE          PIC XX.
   337         16  MAIL-ACCOUNT        PIC X(10).
   338         16  MAIL-CERT-EFF-DT    PIC XX.
   339         16  MAIL-CERT-PRIME     PIC X(10).
   340         16  MAIL-CERT-SFX       PIC X.
   341     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   342     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   343     12  WS-CURRENT-DT.
   344         16  FILLER              PIC X(6)    VALUE SPACES.
   345         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   346     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   347     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   348         88  CANCEL-REC            VALUE 'C'.
   349         88  ISSUE-REC             VALUE 'I'.
   350     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   351     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   352     12  ELCNTL-KEY.
   353         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   354         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   355         16  CNTL-ACCESS.
   356             20  CNTL-STATE      PIC XX    VALUE SPACES.
   357             20  FILLER          PIC X     VALUE SPACES.
   358             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   359         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   360     12  ERACCT-KEY.
   361         16  ERACCT-COMP-KEY.
   362             20  ACCT-CO         PIC X     VALUE SPACES.
   363             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   364             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   365             20  ACCT-STATE      PIC XX    VALUE SPACES.
   366             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   367         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   368         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   369     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   370     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   371     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   372     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   373     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   374     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   375     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   376     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   377     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   378     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   379     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   380     12  WS-RESPONSE             PIC S9(8)   COMP.
   381         88  RESP-NORMAL                  VALUE +00.
   382         88  RESP-NOTFND                  VALUE +13.
   383         88  RESP-DUPREC                  VALUE +14.
   384         88  RESP-DUPKEY                  VALUE +15.
   385         88  RESP-NOTOPEN                 VALUE +19.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page   9
* EL6317.cbl
   386         88  RESP-ENDFILE                 VALUE +20.
   387     12  MAP-NAME            PIC X(8)    VALUE 'EL631J'.
   388     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6317S'.
   389     12  SCREEN-NUMBER       PIC X(4)    VALUE '631J'.
   390     12  TRANS-ID            PIC X(4)    VALUE 'EXBD'.
   391     12  THIS-PGM            PIC X(8)    VALUE 'EL6317'.
   392     12  PGM-NAME            PIC X(8).
   393     12  TIME-IN             PIC S9(7).
   394     12  TIME-OUT-R  REDEFINES TIME-IN.
   395         16  FILLER          PIC X.
   396         16  TIME-OUT        PIC 99V99.
   397         16  FILLER          PIC X(2).
   398     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   399     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   400     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   401     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   402     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   403     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   404     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   405     12  WS-PHONE.
   406         16  WS-PH1              PIC XXX.
   407         16  WS-PH2              PIC XXX.
   408         16  WS-PH3              PIC XXXX.
   409     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   410     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   411
   412     12  WS-BILLING-NOTE.
   413         16  WS-BN-NOTE          PIC X(25).
   414         16  WS-BN-LTRID         PIC X(4).
   415         16  FILLER              PIC X(3).
   416         16  WS-BN-DATE          PIC X(8).
   417         16  FILLER              PIC X(3).
   418         16  WS-BN-USERID        PIC X(4).
   419         16  FILLER              PIC X(30).
   420
   421 01  NEW-ELCRTO-REC.
   422     12  NEW-ELCRTO-KEY.
   423         16  NCRTO-COMPANY-CD      PIC X.
   424         16  NCRTO-CARRIER         PIC X.
   425         16  NCRTO-GROUPING        PIC X(6).
   426         16  NCRTO-STATE           PIC XX.
   427         16  NCRTO-ACCOUNT         PIC X(10).
   428         16  NCRTO-CERT-EFF-DT     PIC XX.
   429         16  NCRTO-CERT-PRIME      PIC X(10).
   430         16  NCRTO-CERT-SFX        PIC X.
   431         16  NCRTO-RECORD-TYPE     PIC X.
   432         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   433     12  NEW-ORIG-REC.
   434         16  NCRTO-INS-LAST-NAME   PIC X(15).
   435         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   436         16  NCRTO-INS-MIDDLE-INIT PIC X.
   437         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   438         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   439         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   440         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   441         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   442         16  NCRTO-LF-BENCD        PIC XX.
   443         16  NCRTO-LF-TERM         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  10
* EL6317.cbl
   444         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   445         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   446         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   447         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   448         16  NCRTO-LF-EXP-DT       PIC XX.
   449         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   450         16  NCRTO-LF-CANCEL-DT    PIC XX.
   451         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   452         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   453         16  NCRTO-AH-BENCD        PIC XX.
   454         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   455         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   456         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   457         16  NCRTO-AH-EXP-DT       PIC XX.
   458         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   459         16  NCRTO-AH-CP           PIC 99.
   460         16  NCRTO-AH-CANCEL-DT    PIC XX.
   461         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   462         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   463         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   464         16  NCRTO-1ST-PMT-DT      PIC XX.
   465         16  FILLER                PIC X(239).
   466
   467 01  CERT-NOTE-ENTRIES.
   468     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   469         16  CERT-NT-TEXT                PIC X(63).
   470         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   471         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   472         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   473
   474 01  ERCNOT-AREA.
   475     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   476     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   477     12  ERCNOT-KEY.
   478         16  ERCNOT-PARTIAL-KEY.
   479             20 ERCNOT-COMPANY-CD    PIC X.
   480             20 ERCNOT-CARRIER       PIC X.
   481             20 ERCNOT-GROUPING      PIC X(06).
   482             20 ERCNOT-STATE         PIC XX.
   483             20 ERCNOT-ACCOUNT       PIC X(10).
   484             20 ERCNOT-EFF-DT        PIC XX.
   485             20 ERCNOT-CERT-NO.
   486                25 ERCNOT-CERT-PRIME PIC X(10).
   487                25 ERCNOT-CERT-SFX   PIC X.
   488             20 ERCNOT-REC-TYP       PIC X.
   489         16 ERCNOT-SEQ           PIC S9(4) COMP.
   490     12  SV-PARTIAL-KEY.
   491         20 SV-COMPANY-CD            PIC X.
   492         20 SV-CARRIER               PIC X.
   493         20 SV-GROUPING              PIC X(06).
   494         20 SV-STATE                 PIC XX.
   495         20 SV-ACCOUNT               PIC X(10).
   496         20 SV-EFF-DT                PIC XX.
   497         20 SV-CERT-NO.
   498            25 SV-CERT-PRIME         PIC X(10).
   499            25 SV-CERT-SFX           PIC X(1).
   500         20 SV-REC-TYP               PIC X.
   501 01  ERROR-MESSAGES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  11
* EL6317.cbl
   502     12  ER-0000                 PIC X(4)  VALUE '0000'.
   503     12  ER-0004                 PIC X(4)  VALUE '0004'.
   504     12  ER-0008                 PIC X(4)  VALUE '0008'.
   505     12  ER-0023                 PIC X(4)  VALUE '0023'.
   506     12  ER-0029                 PIC X(4)  VALUE '0029'.
   507     12  ER-0068                 PIC X(4)  VALUE '0068'.
   508     12  ER-0132                 PIC X(4)  VALUE '0132'.
   509     12  ER-0142                 PIC X(4)  VALUE '0142'.
   510     12  ER-0148                 PIC X(4)  VALUE '0148'.
   511     12  ER-0215                 PIC X(4)  VALUE '0215'.
   512     12  ER-0280                 PIC X(4)  VALUE '0280'.
   513     12  ER-0348                 PIC X(4)  VALUE '0348'.
   514     12  ER-0419                 PIC X(4)  VALUE '0419'.
   515     12  ER-0894                 PIC X(4)  VALUE '0894'.
   516     12  ER-1101                 PIC X(4)  VALUE '1101'.
   517     12  ER-1236                 PIC X(4)  VALUE '1236'.
   518     12  ER-1818                 PIC X(4)  VALUE '1818'.
   519     12  ER-1820                 PIC X(4)  VALUE '1820'.
   520     12  ER-2056                 PIC X(4)  VALUE '2056'.
   521     12  ER-2079                 PIC X(4)  VALUE '2079'.
   522     12  ER-2208                 PIC X(4)  VALUE '2208'.
   523     12  ER-2209                 PIC X(4)  VALUE '2209'.
   524     12  ER-2237                 PIC X(4)  VALUE '2237'.
   525     12  ER-2238                 PIC X(4)  VALUE '2238'.
   526     12  ER-2253                 PIC X(4)  VALUE '2253'.
   527     12  ER-2619                 PIC X(4)  VALUE '2619'.
   528     12  ER-2651                 PIC X(4)  VALUE '2651'.
   529     12  ER-2784                 PIC X(4)  VALUE '2784'.
   530     12  ER-2785                 PIC X(4)  VALUE '2785'.
   531     12  ER-2786                 PIC X(4)  VALUE '2786'.
   532     12  ER-2791                 PIC X(4)  VALUE '2791'.
   533     12  ER-2845                 PIC X(4)  VALUE '2845'.
   534     12  ER-2848                 PIC X(4)  VALUE '2848'.
   535     12  ER-2851                 PIC X(4)  VALUE '2851'.
   536     12  ER-3830                 PIC X(4)  VALUE '3830'.
   537     12  ER-3832                 PIC X(4)  VALUE '3832'.
   538     12  ER-7345                 PIC X(4)  VALUE '7345'.
   539     12  ER-7638                 PIC X(4)  VALUE '7638'.
   540     12  ER-8888                 PIC X(4)  VALUE '8888'.
   541     12  ER-9999                 PIC X(4)  VALUE '9999'.
   542*    COPY ELCDATE.
   543******************************************************************
   544*                                                                *
   545*                                                                *
   546*                            ELCDATE.                            *
   547*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   548*                            VMOD=2.003
   549*                                                                *
   550*                                                                *
   551*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   552*                 LENGTH = 200                                   *
   553******************************************************************
   554
   555 01  DATE-CONVERSION-DATA.
   556     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   557     12  DC-OPTION-CODE                PIC X.
   558         88  BIN-TO-GREG                VALUE ' '.
   559         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  12
* EL6317.cbl
   560         88  EDIT-GREG-TO-BIN           VALUE '2'.
   561         88  YMD-GREG-TO-BIN            VALUE '3'.
   562         88  MDY-GREG-TO-BIN            VALUE '4'.
   563         88  JULIAN-TO-BIN              VALUE '5'.
   564         88  BIN-PLUS-ELAPSED           VALUE '6'.
   565         88  FIND-CENTURY               VALUE '7'.
   566         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   567         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   568         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   569         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   570         88  JULIAN-TO-BIN-3            VALUE 'C'.
   571         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   572         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   573         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   574         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   575         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   576         88  CHECK-LEAP-YEAR            VALUE 'H'.
   577         88  BIN-3-TO-GREG              VALUE 'I'.
   578         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   579         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   580         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   581         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   582         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   583         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   584         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   585         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   586         88  THREE-CHARACTER-BIN
   587                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   588         88  GREGORIAN-TO-BIN
   589                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   590         88  BIN-TO-GREGORIAN
   591                  VALUES ' ' '1' 'I' '8' 'G'.
   592         88  JULIAN-TO-BINARY
   593                  VALUES '5' 'C' 'E' 'F'.
   594     12  DC-ERROR-CODE                 PIC X.
   595         88  NO-CONVERSION-ERROR        VALUE ' '.
   596         88  DATE-CONVERSION-ERROR
   597                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   598         88  DATE-IS-ZERO               VALUE '1'.
   599         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   600         88  DATE-IS-INVALID            VALUE '3'.
   601         88  DATE1-GREATER-DATE2        VALUE '4'.
   602         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   603         88  DATE-INVALID-OPTION        VALUE '9'.
   604         88  INVALID-CENTURY            VALUE 'A'.
   605         88  ONLY-CENTURY               VALUE 'B'.
   606         88  ONLY-LEAP-YEAR             VALUE 'C'.
   607         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   608     12  DC-END-OF-MONTH               PIC X.
   609         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   610     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   611         88  USE-NORMAL-PROCESS         VALUE ' '.
   612         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   613         88  ADJUST-UP-100-YRS          VALUE '2'.
   614     12  FILLER                        PIC X.
   615     12  DC-CONVERSION-DATES.
   616         16  DC-BIN-DATE-1             PIC XX.
   617         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  13
* EL6317.cbl
   618         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   619         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   620                       DC-GREG-DATE-1-EDIT.
   621             20  DC-EDIT1-MONTH        PIC 99.
   622             20  SLASH1-1              PIC X.
   623             20  DC-EDIT1-DAY          PIC 99.
   624             20  SLASH1-2              PIC X.
   625             20  DC-EDIT1-YEAR         PIC 99.
   626         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   627         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   628                     DC-GREG-DATE-2-EDIT.
   629             20  DC-EDIT2-MONTH        PIC 99.
   630             20  SLASH2-1              PIC X.
   631             20  DC-EDIT2-DAY          PIC 99.
   632             20  SLASH2-2              PIC X.
   633             20  DC-EDIT2-YEAR         PIC 99.
   634         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   635         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   636                     DC-GREG-DATE-1-YMD.
   637             20  DC-YMD-YEAR           PIC 99.
   638             20  DC-YMD-MONTH          PIC 99.
   639             20  DC-YMD-DAY            PIC 99.
   640         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   641         16  DC-GREG-DATE-1-MDY-R REDEFINES
   642                      DC-GREG-DATE-1-MDY.
   643             20  DC-MDY-MONTH          PIC 99.
   644             20  DC-MDY-DAY            PIC 99.
   645             20  DC-MDY-YEAR           PIC 99.
   646         16  DC-GREG-DATE-1-ALPHA.
   647             20  DC-ALPHA-MONTH        PIC X(10).
   648             20  DC-ALPHA-DAY          PIC 99.
   649             20  FILLER                PIC XX.
   650             20  DC-ALPHA-CENTURY.
   651                 24 DC-ALPHA-CEN-N     PIC 99.
   652             20  DC-ALPHA-YEAR         PIC 99.
   653         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   654         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   655         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   656         16  DC-JULIAN-DATE            PIC 9(05).
   657         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   658                                       PIC 9(05).
   659         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   660             20  DC-JULIAN-YEAR        PIC 99.
   661             20  DC-JULIAN-DAYS        PIC 999.
   662         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   663         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   664         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   665     12  DATE-CONVERSION-VARIBLES.
   666         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   667         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   668             20  FILLER                PIC 9(3).
   669             20  HOLD-CEN-1-CCYY.
   670                 24  HOLD-CEN-1-CC     PIC 99.
   671                 24  HOLD-CEN-1-YY     PIC 99.
   672             20  HOLD-CEN-1-MO         PIC 99.
   673             20  HOLD-CEN-1-DA         PIC 99.
   674         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   675             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  14
* EL6317.cbl
   676             20  HOLD-CEN-1-R-DA       PIC 99.
   677             20  HOLD-CEN-1-R-CCYY.
   678                 24  HOLD-CEN-1-R-CC   PIC 99.
   679                 24  HOLD-CEN-1-R-YY   PIC 99.
   680             20  FILLER                PIC 9(3).
   681         16  HOLD-CENTURY-1-X.
   682             20  FILLER                PIC X(3)  VALUE SPACES.
   683             20  HOLD-CEN-1-X-CCYY.
   684                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   685                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   686             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   687             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   688         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   689             20  HOLD-CEN-1-R-X-MO     PIC XX.
   690             20  HOLD-CEN-1-R-X-DA     PIC XX.
   691             20  HOLD-CEN-1-R-X-CCYY.
   692                 24  HOLD-CEN-1-R-X-CC PIC XX.
   693                 24  HOLD-CEN-1-R-X-YY PIC XX.
   694             20  FILLER                PIC XXX.
   695         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   696         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   697         16  DC-JULIAN-DATE-1          PIC 9(07).
   698         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   699             20  DC-JULIAN-1-CCYY.
   700                 24  DC-JULIAN-1-CC    PIC 99.
   701                 24  DC-JULIAN-1-YR    PIC 99.
   702             20  DC-JULIAN-DA-1        PIC 999.
   703         16  DC-JULIAN-DATE-2          PIC 9(07).
   704         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   705             20  DC-JULIAN-2-CCYY.
   706                 24  DC-JULIAN-2-CC    PIC 99.
   707                 24  DC-JULIAN-2-YR    PIC 99.
   708             20  DC-JULIAN-DA-2        PIC 999.
   709         16  DC-GREG-DATE-A-EDIT.
   710             20  DC-EDITA-MONTH        PIC 99.
   711             20  SLASHA-1              PIC X VALUE '/'.
   712             20  DC-EDITA-DAY          PIC 99.
   713             20  SLASHA-2              PIC X VALUE '/'.
   714             20  DC-EDITA-CCYY.
   715                 24  DC-EDITA-CENT     PIC 99.
   716                 24  DC-EDITA-YEAR     PIC 99.
   717         16  DC-GREG-DATE-B-EDIT.
   718             20  DC-EDITB-MONTH        PIC 99.
   719             20  SLASHB-1              PIC X VALUE '/'.
   720             20  DC-EDITB-DAY          PIC 99.
   721             20  SLASHB-2              PIC X VALUE '/'.
   722             20  DC-EDITB-CCYY.
   723                 24  DC-EDITB-CENT     PIC 99.
   724                 24  DC-EDITB-YEAR     PIC 99.
   725         16  DC-GREG-DATE-CYMD         PIC 9(08).
   726         16  DC-GREG-DATE-CYMD-R REDEFINES
   727                              DC-GREG-DATE-CYMD.
   728             20  DC-CYMD-CEN           PIC 99.
   729             20  DC-CYMD-YEAR          PIC 99.
   730             20  DC-CYMD-MONTH         PIC 99.
   731             20  DC-CYMD-DAY           PIC 99.
   732         16  DC-GREG-DATE-MDCY         PIC 9(08).
   733         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  15
* EL6317.cbl
   734                              DC-GREG-DATE-MDCY.
   735             20  DC-MDCY-MONTH         PIC 99.
   736             20  DC-MDCY-DAY           PIC 99.
   737             20  DC-MDCY-CEN           PIC 99.
   738             20  DC-MDCY-YEAR          PIC 99.
   739    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   740        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   741    12  DC-EL310-DATE                  PIC X(21).
   742    12  FILLER                         PIC X(28).
   743*    COPY ELCTEXT.
   744******************************************************************
   745*                                                                *
   746*                                                                *
   747*                            ELCTEXT.                            *
   748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   749*                            VMOD=2.008                          *
   750*                                                                *
   751*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   752*                                     FORM LETTERS,              *
   753*                                     CERT FORM DISPLAY.
   754*                                                                *
   755*   FILE TYPE = VSAM,KSDS                                        *
   756*   RECORD SIZE = 100   RECFORM = FIXED                          *
   757*                                                                *
   758*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   759*       ALTERNATE INDEX = NONE                                   *
   760*                                                                *
   761*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   762*       ALTERNATE INDEX = NONE                                   *
   763*                                                                *
   764*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   765*       ALTERNATE INDEX = NONE                                   *
   766*                                                                *
   767*   LOG = NO                                                     *
   768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   769******************************************************************
   770 01  TEXT-FILES.
   771     12  TEXT-FILE-ID                PIC XX.
   772         88  FORMS-FILE-TEXT            VALUE 'TF'.
   773         88  LETTER-FILE-TEXT           VALUE 'TL'.
   774         88  HELP-FILE-TEXT             VALUE 'TH'.
   775
   776     12  TX-CONTROL-PRIMARY.
   777         16  TX-COMPANY-CD           PIC X.
   778             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   779         16  TX-ACCESS-CD-GENL       PIC X(12).
   780
   781         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   782             20  TX-LETTER-NO        PIC X(4).
   783             20  FILLER              PIC X(8).
   784
   785         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   786             20  TX-FORM-NO          PIC X(12).
   787
   788         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   789             20  TX-HELP-TYPE        PIC X.
   790                 88  HELP-FOR-GENERAL   VALUE ' '.
   791                 88  HELP-BY-SCREEN     VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  16
* EL6317.cbl
   792                 88  HELP-BY-ERROR      VALUE 'E'.
   793             20  TX-SCREEN-OR-ERROR  PIC X(4).
   794                 88  GENERAL-INFO-HELP  VALUE '0000'.
   795             20  TX-HELP-FOR-COMPANY  PIC XXX.
   796                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   797             20  FILLER              PIC X(4).
   798
   799         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   800
   801     12  TX-PROCESS-CONTROL          PIC XX.
   802         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   803
   804     12  TX-TEXT-LINE                PIC X(70).
   805
   806     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   807         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   808         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   809         88  TX-VALID-FORM-SQUEEZE-VALUE
   810                                        VALUE 'Y' ' '.
   811
   812     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   813         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   814         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   815         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   816         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   817         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   818         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   819         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   820                                              'K' 'N' ' '
   821                                              'Z'.
   822
   823     12  TX-ARCHIVE-SW               PIC X.
   824         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   825         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   826         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   827
   828     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   829     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   830
   831     12  TX-BSR-CODE                 PIC X.
   832         88  TX-BSR-LETTER              VALUE 'B'.
   833         88  TX-NON-BSR-LETTER          VALUE ' '.
   834
   835     12  FILLER                      PIC X.
   836*****************************************************************
   837*    COPY ELCLOGOF.
   838******************************************************************
   839*                                                                *
   840*                                                                *
   841*                            ELCLOGOF.                           *
   842*                            VMOD=2.001                          *
   843*                                                                *
   844*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   845*                                                                *
   846******************************************************************
   847 01  CLASIC-LOGOFF.
   848     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   849     12  LOGOFF-TEXT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  17
* EL6317.cbl
   850         16  FILLER          PIC X(5)    VALUE SPACES.
   851         16  LOGOFF-MSG.
   852             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   853             20  FILLER      PIC X       VALUE SPACES.
   854             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   855         16  FILLER          PIC X(80)
   856           VALUE '* YOU ARE NOW LOGGED OFF'.
   857         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   858         16  FILLER          PIC X       VALUE QUOTE.
   859         16  LOGOFF-SYS-MSG  PIC X(17)
   860           VALUE 'S CLAS-IC SYSTEM '.
   861     12  TEXT-MESSAGES.
   862         16  UNACCESS-MSG    PIC X(29)
   863             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   864         16  PGMIDERR-MSG    PIC X(17)
   865             VALUE 'PROGRAM NOT FOUND'.
   866*    COPY ELCATTR.
   867******************************************************************
   868*                                                                *
   869*                            ELCATTR.                            *
   870*                            VMOD=2.001                          *
   871*                                                                *
   872*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   873*                                                                *
   874*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   875*                                                                *
   876*                   POS 1   P=PROTECTED                          *
   877*                           U=UNPROTECTED                        *
   878*                           S=ASKIP                              *
   879*                   POS 2   A=ALPHA/NUMERIC                      *
   880*                           N=NUMERIC                            *
   881*                   POS 3   N=NORMAL                             *
   882*                           B=BRIGHT                             *
   883*                           D=DARK                               *
   884*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   885*                           OF=MODIFIED DATA TAG OFF             *
   886*                                                                *
   887*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   888******************************************************************
   889 01  ATTRIBUTE-LIST.
   890     12  AL-PABOF            PIC X       VALUE 'Y'.
   891     12  AL-PABON            PIC X       VALUE 'Z'.
   892     12  AL-PADOF            PIC X       VALUE '%'.
   893     12  AL-PADON            PIC X       VALUE '_'.
   894     12  AL-PANOF            PIC X       VALUE '-'.
   895     12  AL-PANON            PIC X       VALUE '/'.
   896     12  AL-SABOF            PIC X       VALUE '8'.
   897     12  AL-SABON            PIC X       VALUE '9'.
   898     12  AL-SADOF            PIC X       VALUE '@'.
   899     12  AL-SADON            PIC X       VALUE QUOTE.
   900     12  AL-SANOF            PIC X       VALUE '0'.
   901     12  AL-SANON            PIC X       VALUE '1'.
   902     12  AL-UABOF            PIC X       VALUE 'H'.
   903     12  AL-UABON            PIC X       VALUE 'I'.
   904     12  AL-UADOF            PIC X       VALUE '<'.
   905     12  AL-UADON            PIC X       VALUE '('.
   906     12  AL-UANOF            PIC X       VALUE ' '.
   907     12  AL-UANON            PIC X       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  18
* EL6317.cbl
   908     12  AL-UNBOF            PIC X       VALUE 'Q'.
   909     12  AL-UNBON            PIC X       VALUE 'R'.
   910     12  AL-UNDOF            PIC X       VALUE '*'.
   911     12  AL-UNDON            PIC X       VALUE ')'.
   912     12  AL-UNNOF            PIC X       VALUE '&'.
   913     12  AL-UNNON            PIC X       VALUE 'J'.
   914*    COPY ELCEMIB.
   915******************************************************************
   916*                                                                *
   917*                                                                *
   918*                            ELCEMIB.                            *
   919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   920*                            VMOD=2.005                          *
   921*                                                                *
   922*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   923*                                                                *
   924******************************************************************
   925 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   926     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   927     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   928     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   929     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   930     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   931     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   932     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   933     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   934     12  EMI-SWITCH1             PIC X        VALUE '1'.
   935         88  EMI-NO-ERRORS                    VALUE '1'.
   936         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   937         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   938     12  EMI-SWITCH2             PIC X        VALUE '1'.
   939         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   940     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   941         88  EMI-AREA1-EMPTY                  VALUE '1'.
   942         88  EMI-AREA1-FULL                   VALUE '2'.
   943     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   944         88  EMI-AREA2-EMPTY                  VALUE '1'.
   945         88  EMI-AREA2-FULL                   VALUE '2'.
   946     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   947         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   948         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   949         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   950         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   951         88  EMI-BYPASS-FATALS                VALUE 'X'.
   952     12  EMI-ERROR-LINES.
   953         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   954         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   955         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   956         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   957             20  EMI-ERR-CODES OCCURS 10 TIMES.
   958                 24  EMI-ERR-NUM         PIC X(4).
   959                 24  EMI-FILLER          PIC X.
   960                 24  EMI-SEV             PIC X.
   961                 24  FILLER              PIC X.
   962             20  FILLER                  PIC X(02).
   963     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   964         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   965             20  EMI-ERROR-NUMBER    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  19
* EL6317.cbl
   966             20  EMI-FILL            PIC X.
   967             20  EMI-SEVERITY        PIC X.
   968             20  FILLER              PIC X.
   969             20  EMI-ERROR-TEXT.
   970                 24  EMI-TEXT-VARIABLE   PIC X(10).
   971                 24  FILLER          PIC X(55).
   972     12  EMI-SEVERITY-SAVE           PIC X.
   973         88  EMI-NOTE                    VALUE 'N'.
   974         88  EMI-WARNING                 VALUE 'W'.
   975         88  EMI-FORCABLE                VALUE 'F'.
   976         88  EMI-FATAL                   VALUE 'X'.
   977     12  EMI-MESSAGE-FLAG            PIC X.
   978         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   979         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   980     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   981     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   982         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   983         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   984         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   985     12  FILLER                      PIC X(137)  VALUE SPACES.
   986     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   987     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   988     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   989     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   990*    COPY ELCINTF.
   991******************************************************************
   992*                                                                *
   993*                                                                *
   994*                            ELCINTF.                            *
   995*                            VMOD=2.017                          *
   996*                                                                *
   997*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   998*                                                                *
   999*       LENGTH = 1024                                            *
  1000*                                                                *
  1001******************************************************************
  1002*                   C H A N G E   L O G
  1003*
  1004* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1005*-----------------------------------------------------------------
  1006*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1007* EFFECTIVE    NUMBER
  1008*-----------------------------------------------------------------
  1009* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1010******************************************************************
  1011 01  PROGRAM-INTERFACE-BLOCK.
  1012     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1013     12  PI-CALLING-PROGRAM              PIC X(8).
  1014     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1015     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1016     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1017     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1018     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1019     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1020     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1021     12  PI-COMPANY-ID                   PIC XXX.
  1022     12  PI-COMPANY-CD                   PIC X.
  1023
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  20
* EL6317.cbl
  1024     12  PI-COMPANY-PASSWORD             PIC X(8).
  1025
  1026     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1027
  1028     12  PI-CONTROL-IN-PROGRESS.
  1029         16  PI-CARRIER                  PIC X.
  1030         16  PI-GROUPING                 PIC X(6).
  1031         16  PI-STATE                    PIC XX.
  1032         16  PI-ACCOUNT                  PIC X(10).
  1033         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1034                                         PIC X(10).
  1035         16  PI-CLAIM-CERT-GRP.
  1036             20  PI-CLAIM-NO             PIC X(7).
  1037             20  PI-CERT-NO.
  1038                 25  PI-CERT-PRIME       PIC X(10).
  1039                 25  PI-CERT-SFX         PIC X.
  1040             20  PI-CERT-EFF-DT          PIC XX.
  1041         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1042             20  PI-PLAN-CODE            PIC X(2).
  1043             20  PI-REVISION-NUMBER      PIC X(3).
  1044             20  PI-PLAN-EFF-DT          PIC X(2).
  1045             20  PI-PLAN-EXP-DT          PIC X(2).
  1046             20  FILLER                  PIC X(11).
  1047         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1048             20  PI-OE-REFERENCE-1.
  1049                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1050                 25  PI-OE-REF-1-SUFF    PIC XX.
  1051
  1052     12  PI-SESSION-IN-PROGRESS          PIC X.
  1053         88  CLAIM-SESSION                   VALUE '1'.
  1054         88  CREDIT-SESSION                  VALUE '2'.
  1055         88  WARRANTY-SESSION                VALUE '3'.
  1056         88  MORTGAGE-SESSION                VALUE '4'.
  1057         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1058
  1059
  1060*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1061
  1062     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1063     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1064
  1065     12  PI-CREDIT-USER                  PIC X.
  1066         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1067         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1068
  1069     12  PI-CLAIM-USER                   PIC X.
  1070         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1071         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1072
  1073     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1074         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1075         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1076         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1077         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1078         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1079
  1080     12  PI-PROCESSOR-ID                 PIC X(4).
  1081
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  21
* EL6317.cbl
  1082     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1083
  1084     12  PI-MEMBER-CAPTION               PIC X(10).
  1085
  1086     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1087         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1088
  1089     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1090     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1091     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1092     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1093
  1094     12  PI-AH-OVERRIDE-L1               PIC X.
  1095     12  PI-AH-OVERRIDE-L2               PIC XX.
  1096     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1097     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1098
  1099     12  PI-NEW-SYSTEM                   PIC X(2).
  1100
  1101     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1102     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1103         88  PI-USES-PAID-TO                 VALUE '1'.
  1104     12  PI-CRDTCRD-SYSTEM.
  1105         16  PI-CRDTCRD-USER             PIC X.
  1106             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1107             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1108         16  PI-CC-MONTH-END-DT          PIC XX.
  1109     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1110
  1111     12  PI-OE-REFERENCE-2.
  1112         16  PI-OE-REF-2-PRIME           PIC X(10).
  1113         16  PI-OE-REF-2-SUFF            PIC X.
  1114
  1115     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1116
  1117     12  PI-LANGUAGE-TYPE                PIC X.
  1118             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1119             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1120             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1121
  1122     12  PI-POLICY-LINKAGE-IND           PIC X.
  1123         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1124         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1125                                                   LOW-VALUES.
  1126
  1127     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1128     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1129         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1130         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1131
  1132     12  PI-PROCESSOR-CSR-IND            PIC X.
  1133         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1134         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1135
  1136     12  FILLER                          PIC X(3).
  1137
  1138     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1139
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  22
* EL6317.cbl
  1140     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1141         PI-SYSTEM-LEVEL.
  1142
  1143         16  PI-ENTRY-CODES.
  1144             20  PI-ENTRY-CD-1           PIC X.
  1145             20  PI-ENTRY-CD-2           PIC X.
  1146
  1147         16  PI-RETURN-CODES.
  1148             20  PI-RETURN-CD-1          PIC X.
  1149             20  PI-RETURN-CD-2          PIC X.
  1150
  1151         16  PI-UPDATE-STATUS-SAVE.
  1152             20  PI-UPDATE-BY            PIC X(4).
  1153             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1154
  1155         16  PI-LOWER-CASE-LETTERS       PIC X.
  1156             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1157
  1158*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1159*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1160*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1161
  1162         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1163             88  ST-ACCNT-CNTL               VALUE ' '.
  1164             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1165             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1166             88  ACCNT-CNTL                  VALUE '3'.
  1167             88  CARR-ACCNT-CNTL             VALUE '4'.
  1168
  1169         16  PI-PROCESSOR-CAP-LIST.
  1170             20  PI-SYSTEM-CONTROLS.
  1171                24 PI-SYSTEM-DISPLAY     PIC X.
  1172                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1173                24 PI-SYSTEM-MODIFY      PIC X.
  1174                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1175             20  FILLER                  PIC XX.
  1176             20  PI-DISPLAY-CAP          PIC X.
  1177                 88  DISPLAY-CAP             VALUE 'Y'.
  1178             20  PI-MODIFY-CAP           PIC X.
  1179                 88  MODIFY-CAP              VALUE 'Y'.
  1180             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1181                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1182             20  PI-FORCE-CAP            PIC X.
  1183                 88  FORCE-CAP               VALUE 'Y'.
  1184
  1185         16  PI-PROGRAM-CONTROLS.
  1186             20  PI-PGM-PRINT-OPT        PIC X.
  1187             20  PI-PGM-FORMAT-OPT       PIC X.
  1188             20  PI-PGM-PROCESS-OPT      PIC X.
  1189             20  PI-PGM-TOTALS-OPT       PIC X.
  1190
  1191         16  PI-HELP-INTERFACE.
  1192             20  PI-LAST-ERROR-NO        PIC X(4).
  1193             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1194
  1195         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1196             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1197
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  23
* EL6317.cbl
  1198         16  PI-CR-CONTROL-IN-PROGRESS.
  1199             20  PI-CR-CARRIER           PIC X.
  1200             20  PI-CR-GROUPING          PIC X(6).
  1201             20  PI-CR-STATE             PIC XX.
  1202             20  PI-CR-ACCOUNT           PIC X(10).
  1203             20  PI-CR-FIN-RESP          PIC X(10).
  1204             20  PI-CR-TYPE              PIC X.
  1205
  1206         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1207
  1208         16  PI-CR-MONTH-END-DT          PIC XX.
  1209
  1210         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1211             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1212             88  PI-ZERO-CARRIER             VALUE '1'.
  1213             88  PI-ZERO-GROUPING            VALUE '2'.
  1214             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1215
  1216         16  PI-CARRIER-SECURITY         PIC X.
  1217             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1218
  1219         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1220             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1221             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1222
  1223         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1224             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1225                                         INDEXED BY PI-ACCESS-NDX
  1226                                         PIC X.
  1227
  1228         16  PI-GA-BILLING-CONTROL       PIC X.
  1229             88  PI-GA-BILLING               VALUE '1'.
  1230
  1231         16  PI-MAIL-PROCESSING          PIC X.
  1232             88  PI-MAIL-YES                 VALUE 'Y'.
  1233
  1234         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1235
  1236         16  PI-AR-SYSTEM.
  1237             20  PI-AR-PROCESSING-CNTL   PIC X.
  1238                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1239             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1240             20  PI-AR-MONTH-END-DT      PIC XX.
  1241
  1242         16  PI-MP-SYSTEM.
  1243             20  PI-MORTGAGE-USER            PIC X.
  1244                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1245                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1246             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1247                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1248                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1249                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1250                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1251                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1252             20  PI-MP-MONTH-END-DT          PIC XX.
  1253             20  PI-MP-REFERENCE-NO.
  1254                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1255                 24  PI-MP-REFERENCE-SFX     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  24
* EL6317.cbl
  1256
  1257         16  PI-LABEL-CONTROL            PIC X(01).
  1258             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1259             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1260
  1261         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1262             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1263
  1264         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1265             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1266             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1267
  1268         16  FILLER                      PIC X(14).
  1269
  1270     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1271******************************************************************
  1272     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1273        16  PI-ISS-CAN-SW           PIC X.
  1274        16  PI-ERENDT-KEY.
  1275            20  PI-ENDT-COMPANY-CD  PIC X.
  1276            20  PI-ENDT-CARRIER     PIC X.
  1277            20  PI-ENDT-GROUPING    PIC X(6).
  1278            20  PI-ENDT-STATE       PIC XX.
  1279            20  PI-ENDT-ACCOUNT     PIC X(10).
  1280            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1281            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1282            20  PI-ENDT-CERT-SFX    PIC X.
  1283            20  PI-ENDT-RECORD-TYPE PIC X.
  1284            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1285        16  PI-ELCRTO-KEY.
  1286            20  PI-CRTO-COMPANY-CD  PIC X.
  1287            20  PI-CRTO-CARRIER     PIC X.
  1288            20  PI-CRTO-GROUPING    PIC X(6).
  1289            20  PI-CRTO-STATE       PIC XX.
  1290            20  PI-CRTO-ACCOUNT     PIC X(10).
  1291            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1292            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1293            20  PI-CRTO-CERT-SFX    PIC X.
  1294            20  PI-CRTO-RECORD-TYPE PIC X.
  1295            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1296        16  PI-ERPNDB-KEY           PIC X(11).
  1297        16  PI-DOCUMENT-PROCESSED   PIC X.
  1298            88  PI-VERI-PROCESSED      VALUE 'V'.
  1299            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1300        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1301        16  PI-RES-REF-CLM-TYPE     PIC X.
  1302        16  PI-CLM-REFORM-IND       PIC X.
  1303        16  PI-CLEAR-ERROR-SW       PIC X.
  1304            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1305        16  PI-PRINT-CERTIFICATE    PIC X.
  1306        16  PI-ENTERED.
  1307            20  PI-PRTSW-ENTERED    PIC X.
  1308            20  PI-SIGREQ-ENTERED   PIC X.
  1309            20  PI-MONEY-ENTERED    PIC X.
  1310            20  PI-LTRID-ENTERED    PIC X(4).
  1311            20  PI-REASONS-ENTERED  PIC X(84).
  1312            20  PI-CERTNT1-ENTERED  PIC X(63).
  1313            20  PI-CERTNT2-ENTERED  PIC X(63).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  25
* EL6317.cbl
  1314        16  FILLER                  PIC X(17).
  1315        16  PI-FINALIZED-IND        PIC X.
  1316        16  FILLER                  PIC X(280).
  1317    12  FILLER                      PIC X(276).
  1318*    COPY ELCAID.
  1319******************************************************************
  1320*                                                                *
  1321*                            ELCAID.                             *
  1322*                            VMOD=2.001                          *
  1323*                                                                *
  1324*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1325*                                                                *
  1326*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1327*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1328******************************************************************
  1329
  1330 01  DFHAID.
  1331   02  DFHNULL   PIC  X  VALUE  ' '.
  1332   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1333   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1334   02  DFHPEN    PIC  X  VALUE  '='.
  1335   02  DFHOPID   PIC  X  VALUE  'W'.
  1336   02  DFHPA1    PIC  X  VALUE  '%'.
  1337   02  DFHPA2    PIC  X  VALUE  '>'.
  1338   02  DFHPA3    PIC  X  VALUE  ','.
  1339   02  DFHPF1    PIC  X  VALUE  '1'.
  1340   02  DFHPF2    PIC  X  VALUE  '2'.
  1341   02  DFHPF3    PIC  X  VALUE  '3'.
  1342   02  DFHPF4    PIC  X  VALUE  '4'.
  1343   02  DFHPF5    PIC  X  VALUE  '5'.
  1344   02  DFHPF6    PIC  X  VALUE  '6'.
  1345   02  DFHPF7    PIC  X  VALUE  '7'.
  1346   02  DFHPF8    PIC  X  VALUE  '8'.
  1347   02  DFHPF9    PIC  X  VALUE  '9'.
  1348   02  DFHPF10   PIC  X  VALUE  ':'.
  1349   02  DFHPF11   PIC  X  VALUE  '#'.
  1350   02  DFHPF12   PIC  X  VALUE  '@'.
  1351   02  DFHPF13   PIC  X  VALUE  'A'.
  1352   02  DFHPF14   PIC  X  VALUE  'B'.
  1353   02  DFHPF15   PIC  X  VALUE  'C'.
  1354   02  DFHPF16   PIC  X  VALUE  'D'.
  1355   02  DFHPF17   PIC  X  VALUE  'E'.
  1356   02  DFHPF18   PIC  X  VALUE  'F'.
  1357   02  DFHPF19   PIC  X  VALUE  'G'.
  1358   02  DFHPF20   PIC  X  VALUE  'H'.
  1359   02  DFHPF21   PIC  X  VALUE  'I'.
  1360*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1361   02  DFHPF22   PIC  X  VALUE  '['.
  1362   02  DFHPF23   PIC  X  VALUE  '.'.
  1363   02  DFHPF24   PIC  X  VALUE  '<'.
  1364   02  DFHMSRE   PIC  X  VALUE  'X'.
  1365   02  DFHSTRF   PIC  X  VALUE  'h'.
  1366   02  DFHTRIG   PIC  X  VALUE  '"'.
  1367 01  FILLER    REDEFINES DFHAID.
  1368     12  FILLER              PIC X(8).
  1369     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1370*   COPY EL6317S.
  1371 01  EL631JI.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  26
* EL6317.cbl
  1372     05  FILLER            PIC  X(0012).
  1373*    -------------------------------
  1374     05  DATEL PIC S9(0004) COMP.
  1375     05  DATEF PIC  X(0001).
  1376     05  FILLER REDEFINES DATEF.
  1377         10  DATEA PIC  X(0001).
  1378     05  DATEI PIC  X(0008).
  1379*    -------------------------------
  1380     05  TIMEL PIC S9(0004) COMP.
  1381     05  TIMEF PIC  X(0001).
  1382     05  FILLER REDEFINES TIMEF.
  1383         10  TIMEA PIC  X(0001).
  1384     05  TIMEI PIC  X(0005).
  1385*    -------------------------------
  1386     05  PROCIDL PIC S9(0004) COMP.
  1387     05  PROCIDF PIC  X(0001).
  1388     05  FILLER REDEFINES PROCIDF.
  1389         10  PROCIDA PIC  X(0001).
  1390     05  PROCIDI PIC  X(0004).
  1391*    -------------------------------
  1392     05  HOSTL PIC S9(0004) COMP.
  1393     05  HOSTF PIC  X(0001).
  1394     05  FILLER REDEFINES HOSTF.
  1395         10  HOSTA PIC  X(0001).
  1396     05  HOSTI PIC  X(0009).
  1397*    -------------------------------
  1398     05  SYSL PIC S9(0004) COMP.
  1399     05  SYSF PIC  X(0001).
  1400     05  FILLER REDEFINES SYSF.
  1401         10  SYSA PIC  X(0001).
  1402     05  SYSI PIC  X(0005).
  1403*    -------------------------------
  1404     05  COMPANYL PIC S9(0004) COMP.
  1405     05  COMPANYF PIC  X(0001).
  1406     05  FILLER REDEFINES COMPANYF.
  1407         10  COMPANYA PIC  X(0001).
  1408     05  COMPANYI PIC  X(0003).
  1409*    -------------------------------
  1410     05  DATASORL PIC S9(0004) COMP.
  1411     05  DATASORF PIC  X(0001).
  1412     05  FILLER REDEFINES DATASORF.
  1413         10  DATASORA PIC  X(0001).
  1414     05  DATASORI PIC  X(0001).
  1415*    -------------------------------
  1416     05  BATCHNOL PIC S9(0004) COMP.
  1417     05  BATCHNOF PIC  X(0001).
  1418     05  FILLER REDEFINES BATCHNOF.
  1419         10  BATCHNOA PIC  X(0001).
  1420     05  BATCHNOI PIC  X(0006).
  1421*    -------------------------------
  1422     05  BSEQNOL PIC S9(0004) COMP.
  1423     05  BSEQNOF PIC  X(0001).
  1424     05  FILLER REDEFINES BSEQNOF.
  1425         10  BSEQNOA PIC  X(0001).
  1426     05  BSEQNOI PIC  X(0008).
  1427*    -------------------------------
  1428     05  ARCHNOL PIC S9(0004) COMP.
  1429     05  ARCHNOF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  27
* EL6317.cbl
  1430     05  FILLER REDEFINES ARCHNOF.
  1431         10  ARCHNOA PIC  X(0001).
  1432     05  ARCHNOI PIC  X(0008).
  1433*    -------------------------------
  1434     05  PRTSWL PIC S9(0004) COMP.
  1435     05  PRTSWF PIC  X(0001).
  1436     05  FILLER REDEFINES PRTSWF.
  1437         10  PRTSWA PIC  X(0001).
  1438     05  PRTSWI PIC  X(0001).
  1439*    -------------------------------
  1440     05  CARRL PIC S9(0004) COMP.
  1441     05  CARRF PIC  X(0001).
  1442     05  FILLER REDEFINES CARRF.
  1443         10  CARRA PIC  X(0001).
  1444     05  CARRI PIC  X(0001).
  1445*    -------------------------------
  1446     05  GROUPL PIC S9(0004) COMP.
  1447     05  GROUPF PIC  X(0001).
  1448     05  FILLER REDEFINES GROUPF.
  1449         10  GROUPA PIC  X(0001).
  1450     05  GROUPI PIC  X(0006).
  1451*    -------------------------------
  1452     05  STATEL PIC S9(0004) COMP.
  1453     05  STATEF PIC  X(0001).
  1454     05  FILLER REDEFINES STATEF.
  1455         10  STATEA PIC  X(0001).
  1456     05  STATEI PIC  X(0002).
  1457*    -------------------------------
  1458     05  ACCTL PIC S9(0004) COMP.
  1459     05  ACCTF PIC  X(0001).
  1460     05  FILLER REDEFINES ACCTF.
  1461         10  ACCTA PIC  X(0001).
  1462     05  ACCTI PIC  X(0010).
  1463*    -------------------------------
  1464     05  EFFDTL PIC S9(0004) COMP.
  1465     05  EFFDTF PIC  X(0001).
  1466     05  FILLER REDEFINES EFFDTF.
  1467         10  EFFDTA PIC  X(0001).
  1468     05  EFFDTI PIC  X(0008).
  1469*    -------------------------------
  1470     05  CERTNOL PIC S9(0004) COMP.
  1471     05  CERTNOF PIC  X(0001).
  1472     05  FILLER REDEFINES CERTNOF.
  1473         10  CERTNOA PIC  X(0001).
  1474     05  CERTNOI PIC  X(0010).
  1475*    -------------------------------
  1476     05  CRTSFXL PIC S9(0004) COMP.
  1477     05  CRTSFXF PIC  X(0001).
  1478     05  FILLER REDEFINES CRTSFXF.
  1479         10  CRTSFXA PIC  X(0001).
  1480     05  CRTSFXI PIC  X(0001).
  1481*    -------------------------------
  1482     05  SEQNOL PIC S9(0004) COMP.
  1483     05  SEQNOF PIC  X(0001).
  1484     05  FILLER REDEFINES SEQNOF.
  1485         10  SEQNOA PIC  X(0001).
  1486     05  SEQNOI PIC  X(0006).
  1487*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  28
* EL6317.cbl
  1488     05  SIGREQL PIC S9(0004) COMP.
  1489     05  SIGREQF PIC  X(0001).
  1490     05  FILLER REDEFINES SIGREQF.
  1491         10  SIGREQA PIC  X(0001).
  1492     05  SIGREQI PIC  X(0001).
  1493*    -------------------------------
  1494     05  LTRIDL PIC S9(0004) COMP.
  1495     05  LTRIDF PIC  X(0001).
  1496     05  FILLER REDEFINES LTRIDF.
  1497         10  LTRIDA PIC  X(0001).
  1498     05  LTRIDI PIC  X(0004).
  1499*    -------------------------------
  1500     05  RCD01L PIC S9(0004) COMP.
  1501     05  RCD01F PIC  X(0001).
  1502     05  FILLER REDEFINES RCD01F.
  1503         10  RCD01A PIC  X(0001).
  1504     05  RCD01I PIC  X(0004).
  1505*    -------------------------------
  1506     05  RCD02L PIC S9(0004) COMP.
  1507     05  RCD02F PIC  X(0001).
  1508     05  FILLER REDEFINES RCD02F.
  1509         10  RCD02A PIC  X(0001).
  1510     05  RCD02I PIC  X(0004).
  1511*    -------------------------------
  1512     05  RCD03L PIC S9(0004) COMP.
  1513     05  RCD03F PIC  X(0001).
  1514     05  FILLER REDEFINES RCD03F.
  1515         10  RCD03A PIC  X(0001).
  1516     05  RCD03I PIC  X(0004).
  1517*    -------------------------------
  1518     05  RCD04L PIC S9(0004) COMP.
  1519     05  RCD04F PIC  X(0001).
  1520     05  FILLER REDEFINES RCD04F.
  1521         10  RCD04A PIC  X(0001).
  1522     05  RCD04I PIC  X(0004).
  1523*    -------------------------------
  1524     05  RCD05L PIC S9(0004) COMP.
  1525     05  RCD05F PIC  X(0001).
  1526     05  FILLER REDEFINES RCD05F.
  1527         10  RCD05A PIC  X(0001).
  1528     05  RCD05I PIC  X(0004).
  1529*    -------------------------------
  1530     05  RCD06L PIC S9(0004) COMP.
  1531     05  RCD06F PIC  X(0001).
  1532     05  FILLER REDEFINES RCD06F.
  1533         10  RCD06A PIC  X(0001).
  1534     05  RCD06I PIC  X(0004).
  1535*    -------------------------------
  1536     05  RCD07L PIC S9(0004) COMP.
  1537     05  RCD07F PIC  X(0001).
  1538     05  FILLER REDEFINES RCD07F.
  1539         10  RCD07A PIC  X(0001).
  1540     05  RCD07I PIC  X(0004).
  1541*    -------------------------------
  1542     05  RCD08L PIC S9(0004) COMP.
  1543     05  RCD08F PIC  X(0001).
  1544     05  FILLER REDEFINES RCD08F.
  1545         10  RCD08A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  29
* EL6317.cbl
  1546     05  RCD08I PIC  X(0004).
  1547*    -------------------------------
  1548     05  RCD09L PIC S9(0004) COMP.
  1549     05  RCD09F PIC  X(0001).
  1550     05  FILLER REDEFINES RCD09F.
  1551         10  RCD09A PIC  X(0001).
  1552     05  RCD09I PIC  X(0004).
  1553*    -------------------------------
  1554     05  RCD10L PIC S9(0004) COMP.
  1555     05  RCD10F PIC  X(0001).
  1556     05  FILLER REDEFINES RCD10F.
  1557         10  RCD10A PIC  X(0001).
  1558     05  RCD10I PIC  X(0004).
  1559*    -------------------------------
  1560     05  RCD11L PIC S9(0004) COMP.
  1561     05  RCD11F PIC  X(0001).
  1562     05  FILLER REDEFINES RCD11F.
  1563         10  RCD11A PIC  X(0001).
  1564     05  RCD11I PIC  X(0004).
  1565*    -------------------------------
  1566     05  RCD12L PIC S9(0004) COMP.
  1567     05  RCD12F PIC  X(0001).
  1568     05  FILLER REDEFINES RCD12F.
  1569         10  RCD12A PIC  X(0001).
  1570     05  RCD12I PIC  X(0004).
  1571*    -------------------------------
  1572     05  CRTNT1L PIC S9(0004) COMP.
  1573     05  CRTNT1F PIC  X(0001).
  1574     05  FILLER REDEFINES CRTNT1F.
  1575         10  CRTNT1A PIC  X(0001).
  1576     05  CRTNT1I PIC  X(0063).
  1577*    -------------------------------
  1578     05  CRTNT2L PIC S9(0004) COMP.
  1579     05  CRTNT2F PIC  X(0001).
  1580     05  FILLER REDEFINES CRTNT2F.
  1581         10  CRTNT2A PIC  X(0001).
  1582     05  CRTNT2I PIC  X(0063).
  1583*    -------------------------------
  1584     05  ERRMSG1L PIC S9(0004) COMP.
  1585     05  ERRMSG1F PIC  X(0001).
  1586     05  FILLER REDEFINES ERRMSG1F.
  1587         10  ERRMSG1A PIC  X(0001).
  1588     05  ERRMSG1I PIC  X(0075).
  1589*    -------------------------------
  1590     05  ERRMSG2L PIC S9(0004) COMP.
  1591     05  ERRMSG2F PIC  X(0001).
  1592     05  FILLER REDEFINES ERRMSG2F.
  1593         10  ERRMSG2A PIC  X(0001).
  1594     05  ERRMSG2I PIC  X(0075).
  1595*    -------------------------------
  1596     05  PFENTRL PIC S9(0004) COMP.
  1597     05  PFENTRF PIC  X(0001).
  1598     05  FILLER REDEFINES PFENTRF.
  1599         10  PFENTRA PIC  X(0001).
  1600     05  PFENTRI PIC  9(2).
  1601 01  EL631JO REDEFINES EL631JI.
  1602     05  FILLER            PIC  X(0012).
  1603*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  30
* EL6317.cbl
  1604     05  FILLER            PIC  X(0003).
  1605     05  DATEO PIC  X(0008).
  1606*    -------------------------------
  1607     05  FILLER            PIC  X(0003).
  1608     05  TIMEO PIC  99.99.
  1609*    -------------------------------
  1610     05  FILLER            PIC  X(0003).
  1611     05  PROCIDO PIC  X(0004).
  1612*    -------------------------------
  1613     05  FILLER            PIC  X(0003).
  1614     05  HOSTO PIC  X(0009).
  1615*    -------------------------------
  1616     05  FILLER            PIC  X(0003).
  1617     05  SYSO PIC  X(0005).
  1618*    -------------------------------
  1619     05  FILLER            PIC  X(0003).
  1620     05  COMPANYO PIC  X(0003).
  1621*    -------------------------------
  1622     05  FILLER            PIC  X(0003).
  1623     05  DATASORO PIC  X(0001).
  1624*    -------------------------------
  1625     05  FILLER            PIC  X(0003).
  1626     05  BATCHNOO PIC  X(0006).
  1627*    -------------------------------
  1628     05  FILLER            PIC  X(0003).
  1629     05  BSEQNOO PIC  X(0008).
  1630*    -------------------------------
  1631     05  FILLER            PIC  X(0003).
  1632     05  ARCHNOO PIC  X(0008).
  1633*    -------------------------------
  1634     05  FILLER            PIC  X(0003).
  1635     05  PRTSWO PIC  X(0001).
  1636*    -------------------------------
  1637     05  FILLER            PIC  X(0003).
  1638     05  CARRO PIC  X(0001).
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  GROUPO PIC  X(0006).
  1642*    -------------------------------
  1643     05  FILLER            PIC  X(0003).
  1644     05  STATEO PIC  X(0002).
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  ACCTO PIC  X(0010).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  EFFDTO PIC  X(0008).
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  CERTNOO PIC  X(0010).
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  CRTSFXO PIC  X(0001).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  SEQNOO PIC  999999.
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  31
* EL6317.cbl
  1662     05  SIGREQO PIC  X(0001).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  LTRIDO PIC  X(0004).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  RCD01O PIC  X(0004).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  RCD02O PIC  X(0004).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  RCD03O PIC  X(0004).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  RCD04O PIC  X(0004).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  RCD05O PIC  X(0004).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  RCD06O PIC  X(0004).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  RCD07O PIC  X(0004).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  RCD08O PIC  X(0004).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  RCD09O PIC  X(0004).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  RCD10O PIC  X(0004).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  RCD11O PIC  X(0004).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  RCD12O PIC  X(0004).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  CRTNT1O PIC  X(0063).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  CRTNT2O PIC  X(0063).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  ERRMSG1O PIC  X(0075).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  ERRMSG2O PIC  X(0075).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  PFENTRO PIC  X(0002).
  1717*    -------------------------------
  1718 01  filler redefines el631ji.
  1719     12  filler                   pic x(182).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  32
* EL6317.cbl
  1720     12  REASONCDS.
  1721         16  filler occurs 12.
  1722             20  reacdl       pic s9(4) comp.
  1723             20  reacda       pic x.
  1724             20  reacd-in     pic x(4).
  1725    12  FILLER                   PIC X(293).
  1726****************************************************************
  1727*
  1728* Copyright (c) 2007 by Clerity Solutions, Inc.
  1729* All rights reserved.
  1730*
  1731****************************************************************
  1732 01  DFHEIV.
  1733   02  DFHEIV0               PIC X(35).
  1734   02  DFHEIV1               PIC X(08).
  1735   02  DFHEIV2               PIC X(08).
  1736   02  DFHEIV3               PIC X(08).
  1737   02  DFHEIV4               PIC X(06).
  1738   02  DFHEIV5               PIC X(04).
  1739   02  DFHEIV6               PIC X(04).
  1740   02  DFHEIV7               PIC X(02).
  1741   02  DFHEIV8               PIC X(02).
  1742   02  DFHEIV9               PIC X(01).
  1743   02  DFHEIV10              PIC S9(7) COMP-3.
  1744   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1745   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1746   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1747   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1748   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1749   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1750   02  DFHEIV17              PIC X(04).
  1751   02  DFHEIV18              PIC X(04).
  1752   02  DFHEIV19              PIC X(04).
  1753   02  DFHEIV20              USAGE IS POINTER.
  1754   02  DFHEIV21              USAGE IS POINTER.
  1755   02  DFHEIV22              USAGE IS POINTER.
  1756   02  DFHEIV23              USAGE IS POINTER.
  1757   02  DFHEIV24              USAGE IS POINTER.
  1758   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1759   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1760   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1761   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1762   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1763   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1764   02  FILLER                PIC X(02).
  1765   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1766   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1767   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1768   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1769   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1770 LINKAGE  SECTION.
  1771*****************************************************************
  1772*                                                               *
  1773* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1774* All rights reserved.                                          *
  1775*                                                               *
  1776*****************************************************************
  1777 01  dfheiblk.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  33
* EL6317.cbl
  1778     02  eibtime          pic s9(7) comp-3.
  1779     02  eibdate          pic s9(7) comp-3.
  1780     02  eibtrnid         pic x(4).
  1781     02  eibtaskn         pic s9(7) comp-3.
  1782     02  eibtrmid         pic x(4).
  1783     02  dfheigdi         pic s9(4) comp.
  1784     02  eibcposn         pic s9(4) comp.
  1785     02  eibcalen         pic s9(4) comp.
  1786     02  eibaid           pic x(1).
  1787     02  eibfiller1       pic x(1).
  1788     02  eibfn            pic x(2).
  1789     02  eibfiller2       pic x(2).
  1790     02  eibrcode         pic x(6).
  1791     02  eibfiller3       pic x(2).
  1792     02  eibds            pic x(8).
  1793     02  eibreqid         pic x(8).
  1794     02  eibrsrce         pic x(8).
  1795     02  eibsync          pic x(1).
  1796     02  eibfree          pic x(1).
  1797     02  eibrecv          pic x(1).
  1798     02  eibsend          pic x(1).
  1799     02  eibatt           pic x(1).
  1800     02  eibeoc           pic x(1).
  1801     02  eibfmh           pic x(1).
  1802     02  eibcompl         pic x(1).
  1803     02  eibsig           pic x(1).
  1804     02  eibconf          pic x(1).
  1805     02  eiberr           pic x(1).
  1806     02  eibrldbk         pic x(1).
  1807     02  eiberrcd         pic x(4).
  1808     02  eibsynrb         pic x(1).
  1809     02  eibnodat         pic x(1).
  1810     02  eibfiller5       pic x(2).
  1811     02  eibresp          pic 9(09) comp.
  1812     02  eibresp2         pic 9(09) comp.
  1813     02  dfheigdj         pic s9(4) comp.
  1814     02  dfheigdk         pic s9(4) comp.
  1815 01  DFHCOMMAREA                 PIC X(1300).
  1816 01  var  pic x(30).
  1817*                                COPY ERCACCT.
  1818******************************************************************
  1819*                                                                *
  1820*                                                                *
  1821*                            ERCACCT                             *
  1822*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1823*                            VMOD=2.031                          *
  1824*                                                                *
  1825*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1826*                                                                *
  1827*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1828*   VSAM ACCOUNT MASTER FILES.                                   *
  1829*                                                                *
  1830*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1831*                                                                *
  1832*   FILE TYPE = VSAM,KSDS                                        *
  1833*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1834*                                                                *
  1835*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  34
* EL6317.cbl
  1836*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1837*                                                                *
  1838*   LOG = NO                                                     *
  1839*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1840*                                                                *
  1841*                                                                *
  1842******************************************************************
  1843*                   C H A N G E   L O G
  1844*
  1845* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1846*-----------------------------------------------------------------
  1847*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1848* EFFECTIVE    NUMBER
  1849*-----------------------------------------------------------------
  1850* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1851* 092705    2005050300006  PEMA  ADD SPP LEASES
  1852* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1853* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1854* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1855* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1856* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1857******************************************************************
  1858
  1859 01  ACCOUNT-MASTER.
  1860     12  AM-RECORD-ID                      PIC XX.
  1861         88  VALID-AM-ID                      VALUE 'AM'.
  1862
  1863     12  AM-CONTROL-PRIMARY.
  1864         16  AM-COMPANY-CD                 PIC X.
  1865         16  AM-MSTR-CNTRL.
  1866             20  AM-CONTROL-A.
  1867                 24  AM-CARRIER            PIC X.
  1868                 24  AM-GROUPING.
  1869                     28 AM-GROUPING-PREFIX PIC XXX.
  1870                     28 AM-GROUPING-PRIME  PIC XXX.
  1871                 24  AM-STATE              PIC XX.
  1872                 24  AM-ACCOUNT.
  1873                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1874                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1875             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1876                                           PIC X(19).
  1877             20  AM-CNTRL-B.
  1878                 24  AM-EXPIRATION-DT      PIC XX.
  1879                 24  FILLER                PIC X(4).
  1880             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1881                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1882
  1883     12  AM-CONTROL-BY-VAR-GRP.
  1884         16  AM-COMPANY-CD-A1              PIC X.
  1885         16  AM-VG-CARRIER                 PIC X.
  1886         16  AM-VG-GROUPING                PIC X(6).
  1887         16  AM-VG-STATE                   PIC XX.
  1888         16  AM-VG-ACCOUNT                 PIC X(10).
  1889         16  AM-VG-DATE.
  1890             20  AM-VG-EXPIRATION-DT       PIC XX.
  1891             20  FILLER                    PIC X(4).
  1892         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1893                                           PIC 9(11)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  35
* EL6317.cbl
  1894     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1895         16  FILLER                        PIC X(10).
  1896         16  AM-VG-KEY3.
  1897             20  AM-VG3-ACCOUNT            PIC X(10).
  1898             20  AM-VG3-EXP-DT             PIC XX.
  1899         16  FILLER                        PIC X(4).
  1900     12  AM-MAINT-INFORMATION.
  1901         16  AM-LAST-MAINT-DT              PIC XX.
  1902         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1903         16  AM-LAST-MAINT-USER            PIC X(4).
  1904         16  FILLER                        PIC XX.
  1905
  1906     12  AM-EFFECTIVE-DT                   PIC XX.
  1907     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1908
  1909     12  AM-PREV-DATES  COMP-3.
  1910         16  AM-PREV-EXP-DT                PIC 9(11).
  1911         16  AM-PREV-EFF-DT                PIC 9(11).
  1912
  1913     12  AM-REPORT-CODE-1                  PIC X(10).
  1914     12  AM-REPORT-CODE-2                  PIC X(10).
  1915
  1916     12  AM-CITY-CODE                      PIC X(4).
  1917     12  AM-COUNTY-PARISH                  PIC X(6).
  1918
  1919     12  AM-NAME                           PIC X(30).
  1920     12  AM-PERSON                         PIC X(30).
  1921     12  AM-ADDRS                          PIC X(30).
  1922     12  AM-CITY.
  1923         16  AM-ADDR-CITY                  PIC X(28).
  1924         16  AM-ADDR-STATE                 PIC XX.
  1925     12  AM-ZIP.
  1926         16  AM-ZIP-PRIME.
  1927             20  AM-ZIP-PRI-1ST            PIC X.
  1928                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1929             20  FILLER                    PIC X(4).
  1930         16  AM-ZIP-PLUS4                  PIC X(4).
  1931     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1932         16  AM-CAN-POSTAL-1               PIC XXX.
  1933         16  AM-CAN-POSTAL-2               PIC XXX.
  1934         16  FILLER                        PIC XXX.
  1935     12  AM-TEL-NO.
  1936         16  AM-AREA-CODE                  PIC 999.
  1937         16  AM-TEL-PRE                    PIC 999.
  1938         16  AM-TEL-NBR                    PIC 9(4).
  1939     12  AM-TEL-LOC                        PIC X.
  1940         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1941         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1942
  1943     12  AM-COMM-STRUCTURE.
  1944         16  AM-DEFN-1.
  1945             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1946                 24  AM-AGT.
  1947                     28  AM-AGT-PREFIX     PIC X(4).
  1948                     28  AM-AGT-PRIME      PIC X(6).
  1949                 24  AM-COM-TYP            PIC X.
  1950                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1951                 24  AM-J-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  36
* EL6317.cbl
  1952                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1953                 24  AM-RECALC-LV-INDIC    PIC X.
  1954                 24  AM-RETRO-LV-INDIC     PIC X.
  1955                 24  AM-GL-CODES           PIC X.
  1956                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1957                 24  FILLER                PIC X(01).
  1958         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1959             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1960                 24  FILLER                PIC X(11).
  1961                 24  AM-L-COMA             PIC XXX.
  1962                 24  AM-J-COMA             PIC XXX.
  1963                 24  AM-A-COMA             PIC XXX.
  1964                 24  FILLER                PIC X(6).
  1965
  1966     12  AM-COMM-CHANGE-STATUS             PIC X.
  1967         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1968
  1969     12  AM-CSR-CODE                       PIC X(4).
  1970
  1971     12  AM-BILLING-STATUS                 PIC X.
  1972         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1973         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1974     12  AM-AUTO-REFUND-SW                 PIC X.
  1975         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1976         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1977     12  AM-GPCD                           PIC 99.
  1978     12  AM-IG                             PIC X.
  1979         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1980         88  AM-HAS-GROUP                     VALUE '2'.
  1981     12  AM-STATUS                         PIC X.
  1982         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1983         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1984         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1985         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1986         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1987         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1988     12  AM-REMIT-TO                       PIC 99.
  1989     12  AM-ID-NO                          PIC X(11).
  1990
  1991     12  AM-CAL-TABLE                      PIC XX.
  1992     12  AM-LF-DEVIATION                   PIC XXX.
  1993     12  AM-AH-DEVIATION                   PIC XXX.
  1994     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1995     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1996     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1997     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1998     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1999     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2000
  2001     12  AM-USER-FIELDS.
  2002         16  AM-FLD-1                      PIC XX.
  2003         16  AM-FLD-2                      PIC XX.
  2004         16  AM-FLD-3                      PIC XX.
  2005         16  AM-FLD-4                      PIC XX.
  2006         16  AM-FLD-5                      PIC XX.
  2007
  2008     12  AM-1ST-PROD-DATE.
  2009         16  AM-1ST-PROD-YR                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  37
* EL6317.cbl
  2010         16  AM-1ST-PROD-MO                PIC XX.
  2011         16  AM-1ST-PROD-DA                PIC XX.
  2012     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2013     12  AM-CERTS-PURGED-DATE.
  2014         16  AM-PUR-YR                     PIC XX.
  2015         16  AM-PUR-MO                     PIC XX.
  2016         16  AM-PUR-DA                     PIC XX.
  2017     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2018     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2019     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2020     12  AM-INACTIVE-DATE.
  2021         16  AM-INA-MO                     PIC 99.
  2022         16  AM-INA-DA                     PIC 99.
  2023         16  AM-INA-YR                     PIC 99.
  2024     12  AM-AR-HI-CERT-DATE                PIC XX.
  2025
  2026     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2027     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2028
  2029     12  AM-OB-PAYMENT-MODE                PIC X.
  2030         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2031         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2032         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2033         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2034
  2035     12  AM-AH-ONLY-INDICATOR              PIC X.
  2036         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2037         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2038
  2039     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2040
  2041     12  AM-OVER-SHORT.
  2042         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2043         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2044
  2045     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2046     12  AM-DCC-CLP-STATE                  PIC XX.
  2047
  2048     12  AM-RECALC-COMM                    PIC X.
  2049     12  AM-RECALC-REIN                    PIC X.
  2050
  2051     12  AM-REI-TABLE                      PIC XXX.
  2052     12  AM-REI-ET-LF                      PIC X.
  2053     12  AM-REI-ET-AH                      PIC X.
  2054     12  AM-REI-PE-LF                      PIC X.
  2055     12  AM-REI-PE-AH                      PIC X.
  2056     12  AM-REI-PRT-ST                     PIC X.
  2057     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2058     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2059     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2060     12  AM-REI-GROUP-A                    PIC X(6).
  2061     12  AM-REI-MORT                       PIC X(4).
  2062     12  AM-REI-PRT-OW                     PIC X.
  2063     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2064     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2065     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2066     12  AM-REI-GROUP-B                    PIC X(6).
  2067
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  38
* EL6317.cbl
  2068     12  AM-TRUST-TYPE                     PIC X(2).
  2069
  2070     12  AM-EMPLOYER-STMT-USED             PIC X.
  2071     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2072
  2073     12  AM-STD-AH-TYPE                    PIC XX.
  2074     12  AM-EARN-METHODS.
  2075         16  AM-EARN-METHOD-R              PIC X.
  2076             88 AM-REF-RL-R78                 VALUE 'R'.
  2077             88 AM-REF-RL-PR                  VALUE 'P'.
  2078             88 AM-REF-RL-MEAN                VALUE 'M'.
  2079             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2080         16  AM-EARN-METHOD-L              PIC X.
  2081             88 AM-REF-LL-R78                 VALUE 'R'.
  2082             88 AM-REF-LL-PR                  VALUE 'P'.
  2083             88 AM-REF-LL-MEAN                VALUE 'M'.
  2084             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2085         16  AM-EARN-METHOD-A              PIC X.
  2086             88 AM-REF-AH-R78                 VALUE 'R'.
  2087             88 AM-REF-AH-PR                  VALUE 'P'.
  2088             88 AM-REF-AH-MEAN                VALUE 'M'.
  2089             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2090             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2091             88 AM-REF-AH-NET                 VALUE 'N'.
  2092
  2093     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2094     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2095     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2096
  2097     12  AM-RET-Y-N                        PIC X.
  2098     12  AM-RET-P-E                        PIC X.
  2099     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2100     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2101     12  AM-RET-GRP                        PIC X(6).
  2102     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2103         16  AM-POOL-PRIME                 PIC XXX.
  2104         16  AM-POOL-SUB                   PIC XXX.
  2105     12  AM-RETRO-EARNINGS.
  2106         16  AM-RET-EARN-R                 PIC X.
  2107         16  AM-RET-EARN-L                 PIC X.
  2108         16  AM-RET-EARN-A                 PIC X.
  2109     12  AM-RET-ST-TAX-USE                 PIC X.
  2110         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2111         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2112     12  AM-RETRO-BEG-EARNINGS.
  2113         16  AM-RET-BEG-EARN-R             PIC X.
  2114         16  AM-RET-BEG-EARN-L             PIC X.
  2115         16  AM-RET-BEG-EARN-A             PIC X.
  2116     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2117     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2118
  2119     12  AM-USER-SELECT-OPTIONS.
  2120         16  AM-USER-SELECT-1              PIC X(10).
  2121         16  AM-USER-SELECT-2              PIC X(10).
  2122         16  AM-USER-SELECT-3              PIC X(10).
  2123         16  AM-USER-SELECT-4              PIC X(10).
  2124         16  AM-USER-SELECT-5              PIC X(10).
  2125
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  39
* EL6317.cbl
  2126     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2127
  2128     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2129
  2130     12  AM-RPT045A-SWITCH                 PIC X.
  2131         88  RPT045A-OFF                   VALUE 'N'.
  2132
  2133     12  AM-INSURANCE-LIMITS.
  2134         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2135         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2136
  2137     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2138         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2139
  2140     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2141         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2142         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2143
  2144     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2145
  2146     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2147     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2148     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2149     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2150     12  AM-DCC-UEF-STATE                  PIC XX.
  2151     12  FILLER                            PIC XXX.
  2152     12  AM-REPORT-CODE-3                  PIC X(10).
  2153*    12  FILLER                            PIC X(22).
  2154
  2155     12  AM-RESERVE-DATE.
  2156         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2157         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2158         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2159
  2160     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2161     12  AM-NOTIFICATION-TYPES.
  2162         16  AM-NOTIF-OF-LETTERS           PIC X.
  2163         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2164         16  AM-NOTIF-OF-REPORTS           PIC X.
  2165         16  AM-NOTIF-OF-STATUS            PIC X.
  2166
  2167     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2168         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2169         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2170         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2171         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2172
  2173     12  AM-BENEFIT-CONTROLS.
  2174         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2175             20  AM-BENEFIT-CODE           PIC XX.
  2176             20  AM-BENEFIT-TYPE           PIC X.
  2177             20  AM-BENEFIT-REVISION       PIC XXX.
  2178             20  AM-BENEFIT-REM-TERM       PIC X.
  2179             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2180             20  FILLER                    PIC XX.
  2181         16  FILLER                        PIC X(80).
  2182
  2183     12  AM-TRANSFER-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  40
* EL6317.cbl
  2184         16  AM-TRANSFERRED-FROM.
  2185             20  AM-TRNFROM-CARRIER        PIC X.
  2186             20  AM-TRNFROM-GROUPING.
  2187                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2188                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2189             20  AM-TRNFROM-STATE          PIC XX.
  2190             20  AM-TRNFROM-ACCOUNT.
  2191                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2192                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2193             20  AM-TRNFROM-DTE            PIC XX.
  2194         16  AM-TRANSFERRED-TO.
  2195             20  AM-TRNTO-CARRIER          PIC X.
  2196             20  AM-TRNTO-GROUPING.
  2197                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2198                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2199             20  AM-TRNTO-STATE            PIC XX.
  2200             20  AM-TRNTO-ACCOUNT.
  2201                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2202                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2203             20  AM-TRNTO-DTE              PIC XX.
  2204         16  FILLER                        PIC X(10).
  2205
  2206     12  AM-SAVED-REMIT-TO                 PIC 99.
  2207
  2208     12  AM-COMM-STRUCTURE-SAVED.
  2209         16  AM-DEFN-1-SAVED.
  2210             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2211                 24  AM-AGT-SV             PIC X(10).
  2212                 24  AM-COM-TYP-SV         PIC X.
  2213                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2214                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2215                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2216                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2217                 24  FILLER                PIC X.
  2218                 24  AM-GL-CODES-SV        PIC X.
  2219                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2220                 24  FILLER                PIC X.
  2221         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2222             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2223                 24  FILLER                PIC X(11).
  2224                 24  AM-L-COMA-SV          PIC XXX.
  2225                 24  AM-J-COMA-SV          PIC XXX.
  2226                 24  AM-A-COMA-SV          PIC XXX.
  2227                 24  FILLER                PIC X(6).
  2228
  2229     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2230         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2231            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2232            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2233            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2234
  2235     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2236     12  FILLER                            PIC X(120).
  2237
  2238     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2239         16  AM-CONTROL-NAME               PIC X(30).
  2240         16  AM-EXECUTIVE-ONE.
  2241             20  AM-EXEC1-NAME             PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  41
* EL6317.cbl
  2242             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2243                                                          COMP-3.
  2244             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2245                                                          COMP-3.
  2246         16  AM-EXECUTIVE-TWO.
  2247             20  AM-EXEC2-NAME             PIC X(15).
  2248             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2249                                                          COMP-3.
  2250             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2251                                                          COMP-3.
  2252
  2253     12  AM-RETRO-ADDITIONAL-DATA.
  2254         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2255         16  AM-RETRO-PREM-P-E             PIC X.
  2256         16  AM-RETRO-CLMS-P-I             PIC X.
  2257         16  AM-RETRO-RET-BRACKET-LF.
  2258             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2259                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2260                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2261             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2262                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2263                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2264             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2265                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2266                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2267         16  AM-RETRO-RET-BRACKET-AH.
  2268             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2269                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2270                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2271                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2272             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2273                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2274                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2275             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2276                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2277                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2278
  2279     12  AM-COMMENTS.
  2280         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2281
  2282     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2283         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2284         16  AM-FLI-BILLING-CODE           PIC X.
  2285         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2286         16  AM-FLI-UNITED-IDENT           PIC X.
  2287         16  AM-FLI-INTEREST-LOST-DATA.
  2288             20  AM-FLI-BANK-NO            PIC X(5).
  2289             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2290             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2291             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2292         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2293             20  AM-FLI-AGT                PIC X(9).
  2294             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2295             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2296         16  FILLER                        PIC X(102).
  2297
  2298     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2299         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  42
* EL6317.cbl
  2300             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2301             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2302             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2303             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2304             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2305         16  FILLER                          PIC X(10).
  2306******************************************************************
  2307*                                COPY ELCCNTL.
  2308******************************************************************
  2309*                                                                *
  2310*                                                                *
  2311*                            ELCCNTL.                            *
  2312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2313*                            VMOD=2.059                          *
  2314*                                                                *
  2315*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2316*                                                                *
  2317*   FILE TYPE = VSAM,KSDS                                        *
  2318*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2319*                                                                *
  2320*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2321*       ALTERNATE INDEX = NONE                                   *
  2322*                                                                *
  2323*   LOG = YES                                                    *
  2324*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2325******************************************************************
  2326*                   C H A N G E   L O G
  2327*
  2328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2329*-----------------------------------------------------------------
  2330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2331* EFFECTIVE    NUMBER
  2332*-----------------------------------------------------------------
  2333* 082503                   PEMA  ADD BENEFIT GROUP
  2334* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2335* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2336* 092705    2005050300006  PEMA  ADD SPP LEASES
  2337* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2338* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2339* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2340* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2341* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2342* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2343******************************************************************
  2344*
  2345 01  CONTROL-FILE.
  2346     12  CF-RECORD-ID                       PIC XX.
  2347         88  VALID-CF-ID                        VALUE 'CF'.
  2348
  2349     12  CF-CONTROL-PRIMARY.
  2350         16  CF-COMPANY-ID                  PIC XXX.
  2351         16  CF-RECORD-TYPE                 PIC X.
  2352             88  CF-COMPANY-MASTER              VALUE '1'.
  2353             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2354             88  CF-STATE-MASTER                VALUE '3'.
  2355             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2356             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2357             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  43
* EL6317.cbl
  2358             88  CF-MORTALITY-MASTER            VALUE '7'.
  2359             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2360             88  CF-TERMINAL-MASTER             VALUE '9'.
  2361             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2362             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2363             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2364             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2365             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2366             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2367             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2368             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2369             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2370         16  CF-ACCESS-CD-GENL              PIC X(4).
  2371         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2372             20  CF-PROCESSOR               PIC X(4).
  2373         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2374             20  CF-STATE-CODE              PIC XX.
  2375             20  FILLER                     PIC XX.
  2376         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2377             20  FILLER                     PIC XX.
  2378             20  CF-HI-BEN-IN-REC           PIC XX.
  2379         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2380             20  FILLER                     PIC XXX.
  2381             20  CF-CARRIER-CNTL            PIC X.
  2382         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2383             20  FILLER                     PIC XX.
  2384             20  CF-HI-TYPE-IN-REC          PIC 99.
  2385         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2386             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2387                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2388             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2389             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2390         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2391             20  FILLER                     PIC X.
  2392             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2393         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2394             20  FILLER                     PIC XX.
  2395             20  CF-MORTGAGE-PLAN           PIC XX.
  2396         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2397
  2398     12  CF-LAST-MAINT-DT                   PIC XX.
  2399     12  CF-LAST-MAINT-BY                   PIC X(4).
  2400     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2401
  2402     12  CF-RECORD-BODY                     PIC X(728).
  2403
  2404
  2405****************************************************************
  2406*             COMPANY MASTER RECORD                            *
  2407****************************************************************
  2408
  2409     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2410         16  CF-COMPANY-ADDRESS.
  2411             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2412             20  CF-CL-IN-CARE-OF           PIC X(30).
  2413             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2414             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2415             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  44
* EL6317.cbl
  2416             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2417             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2418         16  CF-COMPANY-CD                  PIC X.
  2419         16  CF-COMPANY-PASSWORD            PIC X(8).
  2420         16  CF-SECURITY-OPTION             PIC X.
  2421             88  ALL-SECURITY                   VALUE '1'.
  2422             88  COMPANY-VERIFY                 VALUE '2'.
  2423             88  PROCESSOR-VERIFY               VALUE '3'.
  2424             88  NO-SECURITY                    VALUE '4'.
  2425             88  ALL-BUT-TERM                   VALUE '5'.
  2426         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2427             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2428         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2429             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2430         16  CF-INFORCE-LOCATION            PIC X.
  2431             88  CERTS-ARE-ONLINE               VALUE '1'.
  2432             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2433             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2434         16  CF-LOWER-CASE-LETTERS          PIC X.
  2435         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2436             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2437             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2438             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2439             88  CF-ACCNT-CNTL                  VALUE '3'.
  2440             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2441
  2442         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2443         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2444
  2445         16  CF-LGX-CREDIT-USER             PIC X.
  2446             88  CO-IS-NOT-USER                 VALUE 'N'.
  2447             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2448
  2449         16 CF-CREDIT-CALC-CODES.
  2450             20  CF-CR-REM-TERM-CALC PIC X.
  2451               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2452               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2453               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2454               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2455               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2456               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2457               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2458             20  CF-CR-R78-METHOD           PIC X.
  2459               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2460               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2461
  2462         16  CF-CLAIM-CONTROL-COUNTS.
  2463             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2464                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2465
  2466             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2467                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2468
  2469             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2470                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2471
  2472             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2473                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  45
* EL6317.cbl
  2474
  2475         16  CF-CURRENT-MONTH-END           PIC XX.
  2476
  2477         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2478             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2479             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2480             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2481             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2482                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2483                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2484             20  CF-CO-PREM-REJECT-SW       PIC X.
  2485                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2486                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2487             20  CF-CO-REF-REJECT-SW        PIC X.
  2488                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2489                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2490
  2491         16  CF-CO-REPORTING-DT             PIC XX.
  2492         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2493         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2494           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2495           88  CF-CO-MONTH-END                  VALUE '1'.
  2496
  2497         16  CF-LGX-CLAIM-USER              PIC X.
  2498             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2499             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2500
  2501         16  CF-CREDIT-EDIT-CONTROLS.
  2502             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2503             20  CF-MIN-AGE                 PIC 99.
  2504             20  CF-DEFAULT-AGE             PIC 99.
  2505             20  CF-MIN-TERM                PIC S999      COMP-3.
  2506             20  CF-MAX-TERM                PIC S999      COMP-3.
  2507             20  CF-DEFAULT-SEX             PIC X.
  2508             20  CF-JOINT-AGE-INPUT         PIC X.
  2509                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2510             20  CF-BIRTH-DATE-INPUT        PIC X.
  2511                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2512             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2513                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2514                 88  CF-ZERO-CARRIER            VALUE '1'.
  2515                 88  CF-ZERO-GROUPING           VALUE '2'.
  2516                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2517             20  CF-EDIT-SW                 PIC X.
  2518                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2519             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2520             20  CF-CR-PR-METHOD            PIC X.
  2521               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2522               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2523             20  FILLER                     PIC X.
  2524
  2525         16  CF-CREDIT-MISC-CONTROLS.
  2526             20  CF-REIN-TABLE-SW           PIC X.
  2527                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2528             20  CF-COMP-TABLE-SW           PIC X.
  2529                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2530             20  CF-EXPERIENCE-RETENTION-AGE
  2531                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  46
* EL6317.cbl
  2532             20  CF-CONVERSION-DT           PIC XX.
  2533             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2534             20  CF-RUN-FREQUENCY-SW        PIC X.
  2535                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2536                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2537
  2538             20  CF-CR-CHECK-NO-CONTROL.
  2539                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2540                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2541                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2542                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2543                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2544                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2545
  2546                 24  CF-CR-CHECK-COUNT       REDEFINES
  2547                     CF-CR-CHECK-COUNTER      PIC X(4).
  2548
  2549                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2550                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2551
  2552                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2553                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2554                 24  CF-MAIL-PROCESSING       PIC X.
  2555                     88  MAIL-PROCESSING          VALUE 'Y'.
  2556
  2557         16  CF-MISC-SYSTEM-CONTROL.
  2558             20  CF-SYSTEM-C                 PIC X.
  2559                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2560             20  CF-SYSTEM-D                 PIC X.
  2561                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2562             20  CF-SOC-SEC-NO-SW            PIC X.
  2563                 88  SOC-SEC-NO-USED             VALUE '1'.
  2564             20  CF-MEMBER-NO-SW             PIC X.
  2565                 88  MEMBER-NO-USED              VALUE '1'.
  2566             20  CF-TAX-ID-NUMBER            PIC X(11).
  2567             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2568             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2569                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2570                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2571                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2572                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2573             20  CF-SYSTEM-E                 PIC X.
  2574                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2575
  2576         16  CF-LGX-LIFE-USER               PIC X.
  2577             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2578             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2579
  2580         16  CF-CR-MONTH-END-DT             PIC XX.
  2581
  2582         16  CF-FILE-MAINT-DATES.
  2583             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2584                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2585             20  CF-LAST-BATCH       REDEFINES
  2586                 CF-LAST-BATCH-NO               PIC X(4).
  2587             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2588             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2589             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  47
* EL6317.cbl
  2590             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2591             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2592             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2593             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2594             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2595             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2596             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2597
  2598         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2599         16  FILLER                         PIC X.
  2600
  2601         16  CF-ALT-MORT-CODE               PIC X(4).
  2602         16  CF-MEMBER-CAPTION              PIC X(10).
  2603
  2604         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2605             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2606             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2607             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2608             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2609             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2610
  2611         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2612
  2613         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2614         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2615         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2616         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2617
  2618         16  CF-AH-OVERRIDE-L1              PIC X.
  2619         16  CF-AH-OVERRIDE-L2              PIC XX.
  2620         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2621         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2622
  2623         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2624         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2625
  2626         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2627         16  CF-AR-LAST-EL860-DT            PIC XX.
  2628         16  CF-MP-MONTH-END-DT             PIC XX.
  2629
  2630         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2631         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2632             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2633
  2634         16  CF-AR-MONTH-END-DT             PIC XX.
  2635
  2636         16  CF-CRDTCRD-USER                PIC X.
  2637             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2638             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2639
  2640         16  CF-CC-MONTH-END-DT             PIC XX.
  2641
  2642         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2643
  2644         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2645             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2646             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2647             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  48
* EL6317.cbl
  2648         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2649         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2650         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2651         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2652             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2653             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2654         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2655         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2656         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2657             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2658         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2659
  2660         16  CF-CL-ZIP-CODE.
  2661             20  CF-CL-ZIP-PRIME.
  2662                 24  CF-CL-ZIP-1ST          PIC X.
  2663                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2664                 24  FILLER                 PIC X(4).
  2665             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2666         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2667             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2668             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2669             20  FILLER                     PIC XXX.
  2670
  2671         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2672         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2673         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2674         16  CF-CO-OPTION-START-DATE        PIC XX.
  2675         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2676           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2677                                                      '3' '4'.
  2678           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2679           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2680           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2681           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2682           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2683           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2684
  2685         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2686
  2687         16  CF-PAYMENT-APPROVAL-LEVELS.
  2688             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2689             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2690             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2691             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2692             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2693             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2694
  2695         16  CF-END-USER-REPORTING-USER     PIC X.
  2696             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2697             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2698
  2699         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2700             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2701             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2702
  2703         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2704
  2705         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  49
* EL6317.cbl
  2706         16  FILLER                         PIC X.
  2707
  2708         16  CF-CREDIT-ARCHIVE-CNTL.
  2709             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2710             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2711             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2712
  2713         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2714
  2715         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2716             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2717             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2718
  2719         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2720             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2721             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2722
  2723         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2724
  2725         16  CF-CO-ACH-ID-CODE              PIC  X.
  2726             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2727             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2728             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2729         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2730         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2731         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2732         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2733         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2734         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2735         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2736         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2737         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2738                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2739         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2740                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2741
  2742         16  CF-CO-OVER-SHORT.
  2743             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2744             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2745
  2746*         16  FILLER                         PIC X(102).
  2747         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2748             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2749             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2750
  2751         16  CF-AH-APPROVAL-DAYS.
  2752             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2753             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2754             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2755             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2756
  2757         16  FILLER                         PIC X(82).
  2758****************************************************************
  2759*             PROCESSOR/USER RECORD                            *
  2760****************************************************************
  2761
  2762     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2763         16  CF-PROCESSOR-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  50
* EL6317.cbl
  2764         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2765         16  CF-PROCESSOR-TITLE             PIC X(26).
  2766         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2767                 88  MESSAGE-YES                VALUE 'Y'.
  2768                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2769
  2770*****************************************************
  2771****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2772****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2773****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2774****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2775*****************************************************
  2776
  2777         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2778             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2779             20  CF-APPLICATION-FORCE       PIC X.
  2780             20  CF-INDIVIDUAL-APP.
  2781                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2782                     28  CF-BROWSE-APP      PIC X.
  2783                     28  CF-UPDATE-APP      PIC X.
  2784
  2785         16  CF-CURRENT-TERM-ON             PIC X(4).
  2786         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2787             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2788             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2789             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2790             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2791             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2792             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2793             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2794         16  CF-PROCESSOR-CARRIER           PIC X.
  2795             88  NO-CARRIER-SECURITY            VALUE ' '.
  2796         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2797             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2798         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2799             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2800         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2801             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2802
  2803         16  CF-PROC-SYS-ACCESS-SW.
  2804             20  CF-PROC-CREDIT-CLAIMS-SW.
  2805                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2806                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2807                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2808                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2809             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2810                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2811                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2812             20  CF-PROC-LIFE-GNRLDGR-SW.
  2813                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2814                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2815                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2816                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2817             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2818                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2819                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2820         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2821             CF-PROC-SYS-ACCESS-SW              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  51
* EL6317.cbl
  2822             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2823         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2824
  2825         16  CF-APPROVAL-LEVEL                  PIC X.
  2826             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2827             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2828             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2829             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2830
  2831         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2832
  2833         16  CF-LANGUAGE-TYPE                   PIC X.
  2834             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2835             88  CF-LANG-IS-FR                      VALUE 'F'.
  2836
  2837         16  CF-CSR-IND                         PIC X.
  2838         16  FILLER                             PIC X(239).
  2839
  2840****************************************************************
  2841*             PROCESSOR/REMINDERS RECORD                       *
  2842****************************************************************
  2843
  2844     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2845         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2846             20  CF-START-REMIND-DT         PIC XX.
  2847             20  CF-END-REMIND-DT           PIC XX.
  2848             20  CF-REMINDER-TEXT           PIC X(50).
  2849         16  FILLER                         PIC X(296).
  2850
  2851
  2852****************************************************************
  2853*             STATE MASTER RECORD                              *
  2854****************************************************************
  2855
  2856     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2857         16  CF-STATE-ABBREVIATION          PIC XX.
  2858         16  CF-STATE-NAME                  PIC X(25).
  2859         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2860         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2861             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2862             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2863             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2864             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2865                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2866                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2867             20  CF-ST-PREM-REJECT-SW       PIC X.
  2868                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2869                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2870             20  CF-ST-REF-REJECT-SW        PIC X.
  2871                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2872                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2873         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2874         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2875         16  CF-ST-REFUND-RULES.
  2876             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2877             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2878             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2879         16  CF-ST-FST-PMT-EXTENSION.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  52
* EL6317.cbl
  2880             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2881             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2882                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2883                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2884                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2885                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2886         16  CF-ST-STATE-CALL.
  2887             20  CF-ST-CALL-UNEARNED        PIC X.
  2888             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2889             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2890         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2891             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2892             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2893         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2894         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2895         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2896         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2897         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2898         16  FILLER                         PIC X.
  2899         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2900             20  CF-ST-BENEFIT-CD           PIC XX.
  2901             20  CF-ST-BENEFIT-KIND         PIC X.
  2902                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2903                 88  CF-ST-AH-KIND              VALUE 'A'.
  2904             20  CF-ST-REM-TERM-CALC        PIC X.
  2905                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2906                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2907                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2908                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2909                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2910                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2911                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2912                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2913
  2914             20  CF-ST-REFUND-CALC          PIC X.
  2915                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2916                 88  ST-REFD-BY-R78             VALUE '1'.
  2917                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2918                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2919                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2920                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2921                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2922                 88  ST-REFD-UTAH               VALUE '7'.
  2923                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2924                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2925                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2926
  2927             20  CF-ST-EARNING-CALC         PIC X.
  2928                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2929                 88  ST-EARN-BY-R78             VALUE '1'.
  2930                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2931                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2932                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2933                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2934                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2935                 88  ST-EARN-MEAN               VALUE '8'.
  2936                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2937
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  53
* EL6317.cbl
  2938             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2939                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2940                 88  ST-OVRD-BY-R78             VALUE '1'.
  2941                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2942                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2943                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2944                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2945                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2946                 88  ST-OVRD-MEAN               VALUE '8'.
  2947                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2948             20  FILLER                     PIC X.
  2949
  2950         16  CF-ST-COMMISSION-CAPS.
  2951             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2952             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2953             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2954             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2955         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2956                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2957
  2958         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2959
  2960         16  CF-ST-STATUTORY-INTEREST.
  2961             20  CF-ST-STAT-DATE-FROM       PIC X.
  2962                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2963                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2964             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2965             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2966             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2967             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2968             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2969
  2970         16  CF-ST-OVER-SHORT.
  2971             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2972             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2973
  2974         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2975
  2976         16  CF-ST-RT-CALC                  PIC X.
  2977
  2978         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2979         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2980         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2981         16  CF-ST-RF-LR-CALC               PIC X.
  2982         16  CF-ST-RF-LL-CALC               PIC X.
  2983         16  CF-ST-RF-LN-CALC               PIC X.
  2984         16  CF-ST-RF-AH-CALC               PIC X.
  2985         16  CF-ST-RF-CP-CALC               PIC X.
  2986*        16  FILLER                         PIC X(206).
  2987*CIDMOD         16  FILLER                         PIC X(192).
  2988         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2989             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2990         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2991         16  CF-ST-VFY-2ND-BENE             PIC X.
  2992         16  FILLER                         PIC X(186).
  2993
  2994****************************************************************
  2995*             BENEFIT MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  54
* EL6317.cbl
  2996****************************************************************
  2997
  2998     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2999         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3000             20  CF-BENEFIT-CODE            PIC XX.
  3001             20  CF-BENEFIT-NUMERIC  REDEFINES
  3002                 CF-BENEFIT-CODE            PIC XX.
  3003             20  CF-BENEFIT-ALPHA           PIC XXX.
  3004             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3005             20  CF-BENEFIT-COMMENT         PIC X(10).
  3006
  3007             20  CF-LF-COVERAGE-TYPE        PIC X.
  3008                 88  CF-REDUCING                VALUE 'R'.
  3009                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3010
  3011             20  CF-SPECIAL-CALC-CD         PIC X.
  3012                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3013                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3014                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3015                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3016                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3017                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3018                 88  CF-FARM-PLAN               VALUE 'F'.
  3019                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3020                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3021                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3022                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3023                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3024                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3025                 88  CF-PRUDENTIAL              VALUE 'P'.
  3026                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3027                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3028                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3029                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3030                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3031                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3032
  3033             20  CF-JOINT-INDICATOR         PIC X.
  3034                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3035
  3036*            20  FILLER                     PIC X(12).
  3037             20  FILLER                     PIC X(11).
  3038             20  CF-BENEFIT-CATEGORY        PIC X.
  3039             20  CF-LOAN-TYPE               PIC X(8).
  3040
  3041             20  CF-CO-REM-TERM-CALC        PIC X.
  3042                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3043                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3044                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3045                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3046                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3047
  3048             20  CF-CO-EARNINGS-CALC        PIC X.
  3049                 88  CO-EARN-BY-R78             VALUE '1'.
  3050                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3051                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3052                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3053                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  55
* EL6317.cbl
  3054                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3055                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3056                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3057
  3058             20  CF-CO-REFUND-CALC          PIC X.
  3059                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3060                 88  CO-REFD-BY-R78             VALUE '1'.
  3061                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3062                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3063                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3064                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3065                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3066                 88  CO-REFD-MEAN               VALUE '8'.
  3067                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3068                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3069                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3070
  3071             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3072                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3073                 88  CO-OVRD-BY-R78             VALUE '1'.
  3074                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3075                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3076                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3077                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3078                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3079                 88  CO-OVRD-MEAN               VALUE '8'.
  3080                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3081
  3082             20  CF-CO-BEN-I-G-CD           PIC X.
  3083                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3084                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3085                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3086
  3087         16  FILLER                         PIC X(304).
  3088
  3089
  3090****************************************************************
  3091*             CARRIER MASTER RECORD                            *
  3092****************************************************************
  3093
  3094     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3095         16  CF-ADDRESS-DATA.
  3096             20  CF-MAIL-TO-NAME            PIC X(30).
  3097             20  CF-IN-CARE-OF              PIC X(30).
  3098             20  CF-ADDRESS-LINE-1          PIC X(30).
  3099             20  CF-ADDRESS-LINE-2          PIC X(30).
  3100             20  CF-CITY-STATE              PIC X(30).
  3101             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3102             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3103
  3104         16  CF-CLAIM-NO-CONTROL.
  3105             20  CF-CLAIM-NO-METHOD         PIC X.
  3106                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3107                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3108                 88  CLAIM-NO-SEQ               VALUE '3'.
  3109                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3110             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3111                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  56
* EL6317.cbl
  3112                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3113                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3114
  3115         16  CF-CHECK-NO-CONTROL.
  3116             20  CF-CHECK-NO-METHOD         PIC X.
  3117                 88  CHECK-NO-MANUAL            VALUE '1'.
  3118                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3119                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3120                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3121             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3122                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3123
  3124         16  CF-DOMICILE-STATE              PIC XX.
  3125
  3126         16  CF-EXPENSE-CONTROLS.
  3127             20  CF-EXPENSE-METHOD          PIC X.
  3128                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3129                 88  DOLLARS-PER-PMT            VALUE '2'.
  3130                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3131                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3132             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3133             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3134
  3135         16  CF-CORRESPONDENCE-CONTROL.
  3136             20  CF-LETTER-RESEND-OPT       PIC X.
  3137                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3138                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3139             20  FILLER                     PIC X(4).
  3140
  3141         16  CF-RESERVE-CONTROLS.
  3142             20  CF-MANUAL-SW               PIC X.
  3143                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3144             20  CF-FUTURE-SW               PIC X.
  3145                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3146             20  CF-PTC-SW                  PIC X.
  3147                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3148             20  CF-IBNR-SW                 PIC X.
  3149                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3150             20  CF-PTC-LF-SW               PIC X.
  3151                 88  CF-LF-PTC-USED             VALUE '1'.
  3152             20  CF-CDT-ACCESS-METHOD       PIC X.
  3153                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3154                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3155                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3156             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3157
  3158         16  CF-CLAIM-CALC-METHOD           PIC X.
  3159             88  360-PLUS-MONTHS                VALUE '1'.
  3160             88  365-PLUS-MONTHS                VALUE '2'.
  3161             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3162             88  360-DAILY                      VALUE '4'.
  3163             88  365-DAILY                      VALUE '5'.
  3164
  3165         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3166         16  FILLER                         PIC X(11).
  3167
  3168         16  CF-LIMIT-AMOUNTS.
  3169             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  57
* EL6317.cbl
  3170             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3171             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3172             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3173             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3174             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3175             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3176             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3177             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3178             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3179
  3180         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3181         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3182         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3183
  3184         16  CF-ZIP-CODE.
  3185             20  CF-ZIP-PRIME.
  3186                 24  CF-ZIP-1ST             PIC X.
  3187                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3188                 24  FILLER                 PIC X(4).
  3189             20  CF-ZIP-PLUS4               PIC X(4).
  3190         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3191             20  CF-CAN-POSTAL-1            PIC XXX.
  3192             20  CF-CAN-POSTAL-2            PIC XXX.
  3193             20  FILLER                     PIC XXX.
  3194
  3195         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3196         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3197         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3198
  3199         16  CF-RATING-SWITCH               PIC X.
  3200             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3201             88  CF-NO-RATING                   VALUE 'N'.
  3202
  3203         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3204
  3205         16  CF-CARRIER-OVER-SHORT.
  3206             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3207             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3208
  3209         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3210         16  CF-SECPAY-SWITCH               PIC X.
  3211             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3212             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3213         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3214         16  FILLER                         PIC X(448).
  3215*        16  FILLER                         PIC X(452).
  3216
  3217
  3218****************************************************************
  3219*             MORTALITY MASTER RECORD                          *
  3220****************************************************************
  3221
  3222     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3223         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3224                                INDEXED BY CF-MORT-NDX.
  3225             20  CF-MORT-TABLE              PIC X(5).
  3226             20  CF-MORT-TABLE-TYPE         PIC X.
  3227                 88  CF-MORT-JOINT              VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  58
* EL6317.cbl
  3228                 88  CF-MORT-SINGLE             VALUE 'S'.
  3229                 88  CF-MORT-COMBINED           VALUE 'C'.
  3230                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3231                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3232             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3233             20  CF-MORT-AGE-METHOD         PIC XX.
  3234                 88  CF-AGE-LAST                VALUE 'AL'.
  3235                 88  CF-AGE-NEAR                VALUE 'AN'.
  3236             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3237             20  CF-MORT-ADJUSTMENT-DIRECTION
  3238                                            PIC X.
  3239                 88  CF-MINUS                   VALUE '-'.
  3240                 88  CF-PLUS                    VALUE '+'.
  3241             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3242             20  CF-MORT-JOINT-CODE         PIC X.
  3243                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3244             20  CF-MORT-PC-Q               PIC X.
  3245                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3246             20  CF-MORT-TABLE-CODE         PIC X(4).
  3247             20  CF-MORT-COMMENTS           PIC X(15).
  3248             20  FILLER                     PIC X(14).
  3249
  3250         16  FILLER                         PIC X(251).
  3251
  3252
  3253****************************************************************
  3254*             BUSSINESS TYPE MASTER RECORD                     *
  3255****************************************************************
  3256
  3257     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3258* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3259* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3260* AND RECORD 05 IS TYPES 81-99
  3261         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3262             20  CF-BUSINESS-TITLE          PIC  X(19).
  3263             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3264                                            PIC S9V9(4) COMP-3.
  3265             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3266             20  FILLER                     PIC  X.
  3267         16  FILLER                         PIC  X(248).
  3268
  3269
  3270****************************************************************
  3271*             TERMINAL MASTER RECORD                           *
  3272****************************************************************
  3273
  3274     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3275
  3276         16  CF-COMPANY-TERMINALS.
  3277             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3278                                  PIC X(4).
  3279         16  FILLER               PIC X(248).
  3280
  3281
  3282****************************************************************
  3283*             LIFE EDIT MASTER RECORD                          *
  3284****************************************************************
  3285
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  59
* EL6317.cbl
  3286     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3287         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3288             20  CF-LIFE-CODE-IN            PIC XX.
  3289             20  CF-LIFE-CODE-OUT           PIC XX.
  3290         16  FILLER                         PIC X(248).
  3291
  3292
  3293****************************************************************
  3294*             AH EDIT MASTER RECORD                            *
  3295****************************************************************
  3296
  3297     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3298         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3299             20  CF-AH-CODE-IN              PIC XXX.
  3300             20  CF-AH-CODE-OUT             PIC XX.
  3301         16  FILLER                         PIC X(248).
  3302
  3303
  3304****************************************************************
  3305*             CREDIBILITY TABLES                               *
  3306****************************************************************
  3307
  3308     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3309         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3310                             INDEXED BY CF-CRDB-NDX.
  3311             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3312             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3313             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3314         16  FILLER                         PIC  X(332).
  3315
  3316
  3317****************************************************************
  3318*             REPORT CUSTOMIZATION RECORD                      *
  3319****************************************************************
  3320
  3321     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3322         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3323             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3324             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3325             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3326**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3327****       A T-TRANSFER.                                   ****
  3328             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3329
  3330         16  FILLER                         PIC XX.
  3331
  3332         16  CF-CARRIER-CNTL-OPT.
  3333             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3334                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3335                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3336             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3337                                            PIC X.
  3338         16  CF-GROUP-CNTL-OPT.
  3339             20  CF-GROUP-OPT-SEQ           PIC 9.
  3340                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3341                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3342             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3343                                            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  60
* EL6317.cbl
  3344         16  CF-STATE-CNTL-OPT.
  3345             20  CF-STATE-OPT-SEQ           PIC 9.
  3346                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3347                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3348             20  CF-STATE-SELECT OCCURS 3 TIMES
  3349                                            PIC XX.
  3350         16  CF-ACCOUNT-CNTL-OPT.
  3351             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3352                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3353                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3354             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3355                                            PIC X(10).
  3356         16  CF-BUS-TYP-CNTL-OPT.
  3357             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3358                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3359                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3360             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3361                                            PIC XX.
  3362         16  CF-LF-TYP-CNTL-OPT.
  3363             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3364                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3365                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3366             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3367                                            PIC XX.
  3368         16  CF-AH-TYP-CNTL-OPT.
  3369             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3370                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3371                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3372             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3373                                            PIC XX.
  3374         16  CF-REPTCD1-CNTL-OPT.
  3375             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3376                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3377                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3378             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3379                                            PIC X(10).
  3380         16  CF-REPTCD2-CNTL-OPT.
  3381             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3382                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3383                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3384             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3385                                            PIC X(10).
  3386         16  CF-USER1-CNTL-OPT.
  3387             20  CF-USER1-OPT-SEQ           PIC 9.
  3388                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3389                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3390             20  CF-USER1-SELECT OCCURS 3 TIMES
  3391                                            PIC X(10).
  3392         16  CF-USER2-CNTL-OPT.
  3393             20  CF-USER2-OPT-SEQ           PIC 9.
  3394                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3395                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3396             20  CF-USER2-SELECT OCCURS 3 TIMES
  3397                                            PIC X(10).
  3398         16  CF-USER3-CNTL-OPT.
  3399             20  CF-USER3-OPT-SEQ           PIC 9.
  3400                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3401                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  61
* EL6317.cbl
  3402             20  CF-USER3-SELECT OCCURS 3 TIMES
  3403                                            PIC X(10).
  3404         16  CF-USER4-CNTL-OPT.
  3405             20  CF-USER4-OPT-SEQ           PIC 9.
  3406                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3407                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3408             20  CF-USER4-SELECT OCCURS 3 TIMES
  3409                                            PIC X(10).
  3410         16  CF-USER5-CNTL-OPT.
  3411             20  CF-USER5-OPT-SEQ           PIC 9.
  3412                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3413                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3414             20  CF-USER5-SELECT OCCURS 3 TIMES
  3415                                            PIC X(10).
  3416         16  CF-REINS-CNTL-OPT.
  3417             20  CF-REINS-OPT-SEQ           PIC 9.
  3418                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3419                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3420             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3421                 24  CF-REINS-PRIME         PIC XXX.
  3422                 24  CF-REINS-SUB           PIC XXX.
  3423
  3424         16  CF-AGENT-CNTL-OPT.
  3425             20  CF-AGENT-OPT-SEQ           PIC 9.
  3426                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3427                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3428             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3429                                            PIC X(10).
  3430
  3431         16  FILLER                         PIC X(43).
  3432
  3433         16  CF-LOSS-RATIO-SELECT.
  3434             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3435             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3436         16  CF-ENTRY-DATE-SELECT.
  3437             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3438             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3439         16  CF-EFFECTIVE-DATE-SELECT.
  3440             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3441             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3442
  3443         16  CF-EXCEPTION-LIST-IND          PIC X.
  3444             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3445
  3446         16  FILLER                         PIC X(318).
  3447
  3448****************************************************************
  3449*                  EXCEPTION REPORTING RECORD                  *
  3450****************************************************************
  3451
  3452     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3453         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3454             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3455
  3456         16  CF-COMBINED-LIFE-AH-OPT.
  3457             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3458             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3459             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  62
* EL6317.cbl
  3460             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3461
  3462         16  CF-LIFE-OPT.
  3463             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3464             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3465             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3466             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3467             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3468             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3469             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3470             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3471             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3472             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3473
  3474         16  CF-AH-OPT.
  3475             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3476             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3477             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3478             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3479             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3480             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3481             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3482             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3483             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3484             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3485
  3486         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3487             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3488             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3489             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3490
  3491         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3492
  3493         16  FILLER                         PIC X(673).
  3494
  3495
  3496****************************************************************
  3497*             MORTGAGE SYSTEM PLAN RECORD                      *
  3498****************************************************************
  3499
  3500     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3501         16  CF-PLAN-TYPE                   PIC X.
  3502             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3503             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3504             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3505         16  CF-PLAN-ABBREV                 PIC XXX.
  3506         16  CF-PLAN-DESCRIPT               PIC X(10).
  3507         16  CF-PLAN-NOTES                  PIC X(20).
  3508         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3509         16  CF-PLAN-UNDERWRITING.
  3510             20  CF-PLAN-TERM-DATA.
  3511                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3512                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3513             20  CF-PLAN-AGE-DATA.
  3514                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3515                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3516                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3517             20  CF-PLAN-BENEFIT-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  63
* EL6317.cbl
  3518                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3519                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3520                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3521                                            PIC S9(7)V99  COMP-3.
  3522         16  CF-PLAN-POLICY-FORMS.
  3523             20  CF-POLICY-FORM             PIC X(12).
  3524             20  CF-MASTER-APPLICATION      PIC X(12).
  3525             20  CF-MASTER-POLICY           PIC X(12).
  3526         16  CF-PLAN-RATING.
  3527             20  CF-RATE-CODE               PIC X(5).
  3528             20  CF-SEX-RATING              PIC X.
  3529                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3530                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3531             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3532             20  CF-SUB-STD-TYPE            PIC X.
  3533                 88  CF-PCT-OF-PREM            VALUE '1'.
  3534                 88  CF-PCT-OF-BENE            VALUE '2'.
  3535         16  CF-PLAN-PREM-TOLERANCES.
  3536             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3537             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3538         16  CF-PLAN-PYMT-TOLERANCES.
  3539             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3540             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3541         16  CF-PLAN-MISC-DATA.
  3542             20  FILLER                     PIC X.
  3543             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3544             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3545         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3546         16  CF-PLAN-IND-GRP                PIC X.
  3547             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3548                                                     '1'.
  3549             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3550                                                     '2'.
  3551         16  CF-MIB-SEARCH-SW               PIC X.
  3552             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3553             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3554             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3555             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3556         16  CF-ALPHA-SEARCH-SW             PIC X.
  3557             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3558             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3559             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3560             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3561             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3562             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3563             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3564             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3565             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3566             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3567                                                     'A' 'B' 'C'
  3568                                                     'X' 'Y' 'Z'.
  3569         16  CF-EFF-DT-RULE-SW              PIC X.
  3570             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3571             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3572             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3573             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3574             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3575         16  FILLER                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  64
* EL6317.cbl
  3576         16  CF-HEALTH-QUESTIONS            PIC X.
  3577             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3578         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3579         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3580         16  CF-PLAN-SNGL-JNT               PIC X.
  3581             88  CF-COMBINED-PLAN              VALUE 'C'.
  3582             88  CF-JNT-PLAN                   VALUE 'J'.
  3583             88  CF-SNGL-PLAN                  VALUE 'S'.
  3584         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3585         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3586         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3587         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3588         16  CF-RERATE-CNTL                 PIC  X.
  3589             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3590             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3591             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3592             88  CF-AUTO-RECALC                 VALUE '4'.
  3593         16  CF-BENEFIT-TYPE                PIC  X.
  3594             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3595             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3596         16  CF-POLICY-FEE                  PIC S999V99
  3597                                                    COMP-3.
  3598         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3599         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3600         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3601         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3602         16  FILLER                         PIC  X(32).
  3603         16  CF-TERMINATION-FORM            PIC  X(04).
  3604         16  FILLER                         PIC  X(08).
  3605         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3606                                                       COMP-3.
  3607         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3608         16  CF-ISSUE-LETTER                PIC  X(4).
  3609         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3610         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3611             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3612             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3613         16  CF-MP-REFUND-CALC              PIC X.
  3614             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3615             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3616             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3617             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3618             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3619             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3620             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3621             88  CF-MP-REFD-MEAN                VALUE '8'.
  3622         16  CF-ALT-RATE-CODE               PIC  X(5).
  3623
  3624
  3625         16  FILLER                         PIC X(498).
  3626****************************************************************
  3627*             MORTGAGE COMPANY MASTER RECORD                   *
  3628****************************************************************
  3629
  3630     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3631         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3632         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3633             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  65
* EL6317.cbl
  3634             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3635             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3636             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3637             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3638
  3639         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3640         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3641         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3642         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3643         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3644
  3645         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3646             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3647         16  CF-MP-RECON-USE-IND            PIC X(1).
  3648             88  CF-MP-USE-RECON             VALUE 'Y'.
  3649         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3650             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3651         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3652             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3653             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3654         16  FILLER                         PIC X(1).
  3655         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3656             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3657         16  CF-MORTG-MIB-VERSION           PIC X.
  3658             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3659             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3660             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3661         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3662             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3663                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3664             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3665                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3666             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3667                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3668             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3669                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3670             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3671                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3672             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3673                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3674         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3675         16  FILLER                         PIC X(7).
  3676         16  CF-MORTG-DESTINATION-SYMBOL.
  3677             20  CF-MORTG-MIB-COMM          PIC X(5).
  3678             20  CF-MORTG-MIB-TERM          PIC X(5).
  3679         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3680             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3681         16  FILLER                         PIC X(03).
  3682         16  CF-MP-CHECK-NO-CONTROL.
  3683             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3684                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3685                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3686                                                ' ' LOW-VALUES.
  3687                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3688                                               VALUE '3'.
  3689         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3690         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3691         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  66
* EL6317.cbl
  3692             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3693                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3694             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3695                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3696             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3697                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3698             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3699                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3700             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3701                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3702             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3703                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3704         16  CF-MORTG-BILLING-AREA.
  3705             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3706                                            PIC X.
  3707         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3708         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3709         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3710         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3711             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3712             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3713         16  FILLER                         PIC X.
  3714         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3715             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3716             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3717         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3718         16  FILLER                         PIC X(8).
  3719         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3720         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3721         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3722         16  CF-ACH-COMPANY-ID.
  3723             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3724                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3725                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3726                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3727             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3728         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3729             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3730         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3731             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3732             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3733         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3734         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3735         16  FILLER                         PIC X(536).
  3736
  3737****************************************************************
  3738*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3739****************************************************************
  3740
  3741     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3742         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3743             20  CF-FEMALE-HEIGHT.
  3744                 24  CF-FEMALE-FT           PIC 99.
  3745                 24  CF-FEMALE-IN           PIC 99.
  3746             20  CF-FEMALE-MIN-WT           PIC 999.
  3747             20  CF-FEMALE-MAX-WT           PIC 999.
  3748         16  FILLER                         PIC X(428).
  3749
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  67
* EL6317.cbl
  3750     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3751         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3752             20  CF-MALE-HEIGHT.
  3753                 24  CF-MALE-FT             PIC 99.
  3754                 24  CF-MALE-IN             PIC 99.
  3755             20  CF-MALE-MIN-WT             PIC 999.
  3756             20  CF-MALE-MAX-WT             PIC 999.
  3757         16  FILLER                         PIC X(428).
  3758******************************************************************
  3759*             AUTOMATIC ACTIVITY RECORD                          *
  3760******************************************************************
  3761     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3762         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3763             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3764             20  CF-SYS-LETTER-ID           PIC X(04).
  3765             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3766             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3767             20  CF-SYS-RESET-SW            PIC X(01).
  3768             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3769             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3770
  3771         16  FILLER                         PIC X(50).
  3772
  3773         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3774             20  CF-USER-ACTIVE-SW          PIC X(01).
  3775             20  CF-USER-LETTER-ID          PIC X(04).
  3776             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3777             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3778             20  CF-USER-RESET-SW           PIC X(01).
  3779             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3780             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3781             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3782
  3783         16  FILLER                         PIC X(246).
  3784*                                COPY ERCPNDB.
  3785******************************************************************
  3786*                                                                *
  3787*                                                                *
  3788*                            ERCPNDB.                            *
  3789*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3790*                            VMOD=2.025                          *
  3791*                                                                *
  3792*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3793*                                                                *
  3794******************************************************************
  3795*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3796*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3797******************************************************************
  3798*                                                                *
  3799*                                                                *
  3800*   FILE TYPE = VSAM,KSDS                                        *
  3801*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3802*                                                                *
  3803*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3804*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3805*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3806*                                                 RKP=13,LEN=36  *
  3807*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  68
* EL6317.cbl
  3808*                                      AND CHG-SEQ.)             *
  3809*                                                RKP=49,LEN=11   *
  3810*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3811*                                      AND CHG-SEQ.)             *
  3812*                                                RKP=60,LEN=15   *
  3813*                                                                *
  3814*   LOG = NO                                                     *
  3815*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3816******************************************************************
  3817******************************************************************
  3818*                   C H A N G E   L O G
  3819*
  3820* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3821*-----------------------------------------------------------------
  3822*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3823* EFFECTIVE    NUMBER
  3824*-----------------------------------------------------------------
  3825* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3826* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3827* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3828* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3829* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3830* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3831* 032306                   PEMA  ADD BOW LOAN NUMBER
  3832* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3833* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3834* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3835* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3836* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3837* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3838* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3839* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3840******************************************************************
  3841
  3842 01  PENDING-BUSINESS.
  3843     12  PB-RECORD-ID                     PIC XX.
  3844         88  VALID-PB-ID                        VALUE 'PB'.
  3845
  3846     12  PB-CONTROL-PRIMARY.
  3847         16  PB-COMPANY-CD                PIC X.
  3848         16  PB-ENTRY-BATCH               PIC X(6).
  3849         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3850         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3851
  3852     12  PB-CONTROL-BY-ACCOUNT.
  3853         16  PB-COMPANY-CD-A1             PIC X.
  3854         16  PB-CARRIER                   PIC X.
  3855         16  PB-GROUPING.
  3856             20  PB-GROUPING-PREFIX       PIC XXX.
  3857             20  PB-GROUPING-PRIME        PIC XXX.
  3858         16  PB-STATE                     PIC XX.
  3859         16  PB-ACCOUNT.
  3860             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3861             20  PB-ACCOUNT-PRIME         PIC X(6).
  3862         16  PB-CERT-EFF-DT               PIC XX.
  3863         16  PB-CERT-NO.
  3864             20  PB-CERT-PRIME            PIC X(10).
  3865             20  PB-CERT-SFX              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  69
* EL6317.cbl
  3866         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3867
  3868         16  PB-RECORD-TYPE               PIC X.
  3869             88  PB-MAILING-DATA                VALUE '0'.
  3870             88  PB-ISSUE                       VALUE '1'.
  3871             88  PB-CANCELLATION                VALUE '2'.
  3872             88  PB-BATCH-TRAILER               VALUE '9'.
  3873
  3874     12  PB-CONTROL-BY-ORIG-BATCH.
  3875         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3876         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3877         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3878         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3879
  3880     12  PB-CONTROL-BY-CSR.
  3881         16  PB-CSR-COMPANY-CD            PIC X.
  3882         16  PB-CSR-ID                    PIC X(4).
  3883         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3884         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3885         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3886******************************************************************
  3887*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3888******************************************************************
  3889
  3890     12  PB-LAST-MAINT-DT                 PIC XX.
  3891     12  PB-LAST-MAINT-BY                 PIC X(4).
  3892     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3893
  3894     12  PB-RECORD-BODY                   PIC X(375).
  3895
  3896     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3897         16  PB-CERT-ORIGIN               PIC X.
  3898             88  CLASIC-CREATED-CERT         VALUE '1'.
  3899         16  PB-I-NAME.
  3900             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3901             20  PB-I-INSURED-FIRST-NAME.
  3902                 24  PB-I-INSURED-1ST-INIT PIC X.
  3903                 24  FILLER                PIC X(9).
  3904             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3905         16  PB-I-AGE                     PIC S99   COMP-3.
  3906         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3907         16  PB-I-BIRTHDAY                PIC XX.
  3908         16  PB-I-INSURED-SEX             PIC X.
  3909             88  PB-SEX-MALE     VALUE 'M'.
  3910             88  PB-SEX-FEMALE   VALUE 'F'.
  3911
  3912         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3913         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3914         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3915         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3916         16  PB-I-SKIP-CODE               PIC X.
  3917             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3918             88  PB-SKIP-JULY              VALUE '1'.
  3919             88  PB-SKIP-AUGUST            VALUE '2'.
  3920             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3921             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3922             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3923             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  70
* EL6317.cbl
  3924             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3925             88  PB-SKIP-JUNE              VALUE '8'.
  3926             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3927             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3928             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3929         16  PB-I-TERM-TYPE               PIC X.
  3930             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3931             88  PB-PAID-WEEKLY            VALUE 'W'.
  3932             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3933             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3934             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3935         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3936         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3937         16  PB-I-DATA-ENTRY-SW           PIC X.
  3938             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3939             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3940             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3941             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3942         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3943         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3944*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3945         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3946         16  FILLER                       PIC X.
  3947
  3948         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3949             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3950             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3951                                                   '90' THRU '99'.
  3952         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3953                                          PIC XX.
  3954         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3955         16  PB-I-AMOUNT-FINANCED REDEFINES
  3956                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3957         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3958         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3959                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3960         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3961         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3962         16  PB-I-CLP-AMOUNT REDEFINES
  3963                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3964         16  PB-I-LF-CALC-FLAG            PIC X.
  3965             88 PB-COMP-LF-PREM               VALUE '?'.
  3966         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3967         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3968         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3969         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3970         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3971         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3972         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3973         16  PB-I-LF-ABBR                 PIC XXX.
  3974         16  PB-I-LF-INPUT-CD             PIC XX.
  3975
  3976         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3977             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3978             88  PB-INVALID-AH               VALUE '  ' '00'
  3979                                                   '90' THRU '99'.
  3980         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3981         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  71
* EL6317.cbl
  3982         16  PB-I-AH-CALC-FLAG            PIC X.
  3983             88 PB-COMP-AH-PREM                  VALUE '?'.
  3984         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3985         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3986         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3987         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3988         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3989         16  PB-I-AH-ABBR                 PIC XXX.
  3990         16  PB-I-AH-INPUT-CD             PIC XXX.
  3991
  3992         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3993         16  PB-I-REIN-TABLE              PIC XXX.
  3994         16  PB-I-BUSINESS-TYPE           PIC 99.
  3995         16  PB-I-INDV-GRP-CD             PIC X.
  3996         16  PB-I-MORT-CODE.
  3997             20  PB-I-TABLE               PIC X.
  3998             20  PB-I-INTEREST            PIC XX.
  3999             20  PB-I-MORT-TYP            PIC X.
  4000         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4001         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4002         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4003         16  PB-I-INDV-GRP-OVRD           PIC X.
  4004         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4005         16  PB-I-SIG-SW                  PIC X.
  4006             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4007         16  PB-I-RATE-CLASS              PIC XX.
  4008         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4009         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4010         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4011         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4012         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4013         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4014         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4015         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4016         16  PB-I-OB-FLAG                 PIC X.
  4017             88  PB-I-OB                      VALUE 'B'.
  4018             88  PB-I-SUMMARY                 VALUE 'Z'.
  4019         16  PB-I-ENTRY-STATUS            PIC X.
  4020             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4021                                              'M' '5' '9' '2'.
  4022             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4023             88  PB-I-POLICY-PENDING          VALUE '2'.
  4024             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4025             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4026             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4027             88  PB-I-REIN-ONLY               VALUE '9'.
  4028             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4029             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4030             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4031             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4032         16  PB-I-INT-CODE                PIC X.
  4033             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4034             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4035         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4036         16  PB-I-SOC-SEC-NO              PIC X(11).
  4037         16  PB-I-MEMBER-NO               PIC X(12).
  4038         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4039*        16  PB-I-LOAN-OFFICER            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  72
* EL6317.cbl
  4040         16  PB-I-OLD-LOF                 PIC XXX.
  4041         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4042         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4043         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4044         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4045         16  PB-I-LIFE-INDICATOR          PIC X.
  4046             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4047         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4048         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4049                                          PIC S9(5)V99    COMP-3.
  4050         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4051             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4052             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4053         16  PB-I-1ST-PMT-DT              PIC XX.
  4054         16  PB-I-JOINT-INSURED.
  4055             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4056             20 PB-I-JOINT-FIRST-NAME.
  4057                24  PB-I-JOINT-FIRST-INIT PIC X.
  4058                24  FILLER                PIC X(9).
  4059             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4060*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4061         16  PB-I-BENEFICIARY-NAME.
  4062             20  PB-I-BANK-NUMBER         PIC X(10).
  4063             20  FILLER                   PIC X(15).
  4064         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4065         16  PB-I-REFERENCE               PIC X(12).
  4066         16  FILLER REDEFINES PB-I-REFERENCE.
  4067             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4068             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4069             20  PB-I-CLP-STATE           PIC XX.
  4070         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4071             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4072             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4073             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4074         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4075         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4076         16  PB-I-RESIDENT-STATE          PIC XX.
  4077         16  PB-I-RATE-CODE               PIC X(4).
  4078         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4079         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4080         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4081         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4082         16  PB-I-BANK-NOCHRGB            PIC 99.
  4083         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4084         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4085
  4086     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4087         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4088             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4089         16  PB-C-CANCEL-ORIGIN           PIC X.
  4090             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4091         16  PB-C-LF-CANCEL-DT            PIC XX.
  4092         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4093         16  PB-C-LF-CALC-REQ             PIC X.
  4094             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4095         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4096         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4097         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  73
* EL6317.cbl
  4098             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4099         16  PB-C-AH-CANCEL-DT            PIC XX.
  4100         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4101         16  PB-C-AH-CALC-REQ             PIC X.
  4102             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4103         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4104         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4105         16  PB-C-LAST-NAME               PIC X(15).
  4106         16  PB-C-REFUND-SW               PIC X.
  4107             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4108             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4109         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4110         16  PB-C-PAYEE-CODE              PIC X(6).
  4111         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4112         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4113         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4114         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4115         16  PB-C-REFERENCE               PIC X(12).
  4116         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4117         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4118         16  PB-C-POST-CARD-IND           PIC X.
  4119         16  PB-C-CANCEL-REASON           PIC X.
  4120         16  PB-C-REF-INTERFACE-SW        PIC X.
  4121         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4122         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4123         16  FILLER                       PIC X(01).
  4124*        16  FILLER                       PIC X(18).
  4125         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4126*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4127         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4128         16  PB-CANCELED-CERT-DATA.
  4129             20  PB-CI-INSURED-NAME.
  4130                 24  PB-CI-LAST-NAME      PIC X(15).
  4131                 24  PB-CI-INITIALS       PIC XX.
  4132             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4133             20  PB-CI-INSURED-SEX        PIC X.
  4134             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4135             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4136             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4137             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4138             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4139             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4140             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4141             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4142             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4143             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4144             20  PB-CI-RATE-CLASS         PIC XX.
  4145             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4146             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4147             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4148             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4149             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4150             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4151             20  PB-CI-LF-ABBR            PIC X(3).
  4152             20  PB-CI-AH-ABBR            PIC X(3).
  4153             20  PB-CI-OB-FLAG            PIC X.
  4154                 88  PB-CI-OB                VALUE 'B'.
  4155             20  PB-CI-LF-POLICY-STATUS   PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  74
* EL6317.cbl
  4156                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4157                                           'M' '4' '5' '9' '2'.
  4158                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4159                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4160                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4161                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4162                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4163                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4164                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4165                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4166                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4167                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4168                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4169                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4170             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4171                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4172                                           'M' '4' '5' '9' '2'.
  4173                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4174                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4175                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4176                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4177                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4178                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4179                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4180                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4181                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4182                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4183                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4184                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4185             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4186             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4187             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4188             20  PB-CI-MEMBER-NO          PIC X(12).
  4189             20  PB-CI-INT-CODE           PIC X.
  4190                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4191                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4192             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4193             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4194             20  PB-CI-COMP-EXCP-SW       PIC X.
  4195                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4196                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4197             20  PB-CI-ENTRY-STATUS       PIC X.
  4198             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4199             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4200             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4201             20  PB-CI-DEATH-DT           PIC XX.
  4202             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4203             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4204             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4205             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4206             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4207             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4208             20  PB-CI-ENTRY-DT              PIC XX.
  4209             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4210             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4211             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4212             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4213             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  75
* EL6317.cbl
  4214             20  PB-CI-OLD-LOF               PIC XXX.
  4215*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4216             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4217             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4218             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4219             20  PB-CI-INDV-GRP-CD           PIC X.
  4220             20  PB-CI-BENEFICIARY-NAME.
  4221                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4222                 24  FILLER                  PIC X(15).
  4223             20  PB-CI-NOTE-SW               PIC X.
  4224             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4225             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4226             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4227             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4228             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4229             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4230             20  PB-CI-FIRST-NAME            PIC X(10).
  4231             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4232
  4233         16  FILLER                       PIC X(13).
  4234*032306  16  FILLER                       PIC X(27).
  4235*        16  FILLER                       PIC X(46).
  4236
  4237     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4238         16  FILLER                       PIC X(10).
  4239         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4240         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4241         16  PB-M-INSURED-MID-INIT        PIC X.
  4242         16  PB-M-INSURED-AGE             PIC 99.
  4243         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4244         16  PB-M-INSURED-SEX             PIC X.
  4245         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4246         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4247         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4248         16  PB-M-INSURED-CITY-STATE.
  4249             20  PB-M-INSURED-CITY        PIC X(28).
  4250             20  PB-M-INSURED-STATE       PIC XX.
  4251         16  PB-M-INSURED-ZIP-CODE.
  4252             20  PB-M-INSURED-ZIP-PRIME.
  4253                 24  PB-M-INSURED-ZIP-1   PIC X.
  4254                     88  PB-M-CANADIAN-POST-CODE
  4255                                             VALUE 'A' THRU 'Z'.
  4256                 24  FILLER               PIC X(4).
  4257             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4258         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4259                                        PB-M-INSURED-ZIP-CODE.
  4260             20  PM-M-INS-CAN-POST1       PIC XXX.
  4261             20  PM-M-INS-CAN-POST2       PIC XXX.
  4262             20  FILLER                   PIC XXX.
  4263         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4264         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4265         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4266         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4267         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4268         16  PB-M-CRED-BENE-CITYST.
  4269             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4270             20  PB-M-CRED-BENE-STATE     PIC XX.
  4271         16  FILLER                       PIC X(92).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  76
* EL6317.cbl
  4272
  4273     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4274         16  FILLER                       PIC X(10).
  4275         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4276         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4277         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4278         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4279         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4280         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4281         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4282         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4283         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4284         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4285         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4286         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4287         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4288         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4289         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4290         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4291         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4292         16  PB-ACCOUNT-NAME              PIC X(30).
  4293         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4294         16  PB-REFERENCE                 PIC X(12).
  4295         16  PB-B-RECEIVED-DT             PIC XX.
  4296         16  FILLER                       PIC X(234).
  4297
  4298     12  PB-RECORD-STATUS.
  4299         16  PB-CREDIT-SELECT-DT          PIC XX.
  4300         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4301         16  PB-BILLED-DT                 PIC XX.
  4302         16  PB-BILLING-STATUS            PIC X.
  4303             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4304             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4305             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4306         16  PB-RECORD-BILL               PIC X.
  4307             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4308             88  PB-RECORD-RETURNED           VALUE 'R'.
  4309             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4310             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4311             88  PB-OVERRIDE-AH               VALUE 'A'.
  4312             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4313         16  PB-BATCH-ENTRY               PIC X.
  4314             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4315             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4316             88  PB-REISSUED-CERT             VALUE 'E'.
  4317             88  PB-MONTHLY-CERT              VALUE 'M'.
  4318             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4319             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4320             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4321         16  PB-FORCE-CODE                PIC X.
  4322             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4323             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4324             88  PB-CANCEL-FORCE              VALUE '8'.
  4325             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4326             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4327             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4328             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4329             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  77
* EL6317.cbl
  4330             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4331             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4332         16  PB-FATAL-FLAG                PIC X.
  4333             88  PB-FATAL-ERRORS              VALUE 'X'.
  4334         16  PB-FORCE-ER-CD               PIC X.
  4335             88  PB-FORCE-ERRORS              VALUE 'F'.
  4336             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4337         16  PB-WARN-ER-CD                PIC X.
  4338             88  PB-WARNING-ERRORS            VALUE 'W'.
  4339         16  FILLER                       PIC X.
  4340         16  PB-OUT-BAL-CD                PIC X.
  4341             88  PB-OUT-OF-BAL                VALUE 'O'.
  4342         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4343         16  PB-AH-OVERRIDE-L1            PIC X.
  4344         16  PB-INPUT-DT                  PIC XX.
  4345         16  PB-INPUT-BY                  PIC X(4).
  4346         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4347         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4348         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4349         16  PB-LF-EARNING-METHOD         PIC X.
  4350         16  PB-AH-EARNING-METHOD         PIC X.
  4351         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4352         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4353         16  PB-REIN-CD                   PIC XXX.
  4354         16  PB-LF-REFUND-TYPE            PIC X.
  4355         16  PB-AH-REFUND-TYPE            PIC X.
  4356         16  PB-ACCT-EFF-DT               PIC XX.
  4357         16  PB-ACCT-EXP-DT               PIC XX.
  4358         16  PB-COMPANY-ID                PIC X(3).
  4359         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4360         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4361         16  PB-SV-CARRIER                PIC X.
  4362         16  PB-SV-GROUPING               PIC X(6).
  4363         16  PB-SV-STATE                  PIC XX.
  4364         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4365         16  PB-GA-BILLING-INFO.
  4366             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4367                                          PIC XX.
  4368         16  PB-SV-REMIT-TO  REDEFINES
  4369             PB-GA-BILLING-INFO           PIC X(10).
  4370         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4371         16  PB-I-LOAN-OFFICER            PIC X(5).
  4372         16  PB-I-VIN                     PIC X(17).
  4373
  4374         16  FILLER                       PIC X(04).
  4375         16  IMNET-BYPASS-SW              PIC X.
  4376
  4377******************************************************************
  4378*                COMMON EDIT ERRORS                              *
  4379******************************************************************
  4380
  4381     12  PB-COMMON-ERRORS.
  4382         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4383                                           PIC S9(4)     COMP.
  4384
  4385******************************************************************
  4386*                                COPY ELCCERT.
  4387******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  78
* EL6317.cbl
  4388*                                                                *
  4389*                            ELCCERT.                            *
  4390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4391*                            VMOD=2.013                          *
  4392*                                                                *
  4393*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4394*                                                                *
  4395*   FILE TYPE = VSAM,KSDS                                        *
  4396*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4397*                                                                *
  4398*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4399*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4400*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4401*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4402*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4403*                                                                *
  4404*   LOG = YES                                                    *
  4405*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4406******************************************************************
  4407*                   C H A N G E   L O G
  4408*
  4409* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4410*-----------------------------------------------------------------
  4411*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4412* EFFECTIVE    NUMBER
  4413*-----------------------------------------------------------------
  4414* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4415* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4416* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4417* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4418* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4419* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4420* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4421* 032612  CR2011110200001  PEMA  AHL CHANGES
  4422******************************************************************
  4423
  4424 01  CERTIFICATE-MASTER.
  4425     12  CM-RECORD-ID                      PIC XX.
  4426         88  VALID-CM-ID                      VALUE 'CM'.
  4427
  4428     12  CM-CONTROL-PRIMARY.
  4429         16  CM-COMPANY-CD                 PIC X.
  4430         16  CM-CARRIER                    PIC X.
  4431         16  CM-GROUPING.
  4432             20  CM-GROUPING-PREFIX        PIC X(3).
  4433             20  CM-GROUPING-PRIME         PIC X(3).
  4434         16  CM-STATE                      PIC XX.
  4435         16  CM-ACCOUNT.
  4436             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4437             20  CM-ACCOUNT-PRIME          PIC X(6).
  4438         16  CM-CERT-EFF-DT                PIC XX.
  4439         16  CM-CERT-NO.
  4440             20  CM-CERT-PRIME             PIC X(10).
  4441             20  CM-CERT-SFX               PIC X.
  4442
  4443     12  CM-CONTROL-BY-NAME.
  4444         16  CM-COMPANY-CD-A1              PIC X.
  4445         16  CM-INSURED-LAST-NAME          PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  79
* EL6317.cbl
  4446         16  CM-INSURED-INITIALS.
  4447             20  CM-INSURED-INITIAL1       PIC X.
  4448             20  CM-INSURED-INITIAL2       PIC X.
  4449
  4450     12  CM-CONTROL-BY-SSN.
  4451         16  CM-COMPANY-CD-A2              PIC X.
  4452         16  CM-SOC-SEC-NO.
  4453             20  CM-SSN-STATE              PIC XX.
  4454             20  CM-SSN-ACCOUNT            PIC X(6).
  4455             20  CM-SSN-LN3.
  4456                 25  CM-INSURED-INITIALS-A2.
  4457                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4458                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4459                 25 CM-PART-LAST-NAME-A2         PIC X.
  4460
  4461     12  CM-CONTROL-BY-CERT-NO.
  4462         16  CM-COMPANY-CD-A4              PIC X.
  4463         16  CM-CERT-NO-A4                 PIC X(11).
  4464
  4465     12  CM-CONTROL-BY-MEMB.
  4466         16  CM-COMPANY-CD-A5              PIC X.
  4467         16  CM-MEMBER-NO.
  4468             20  CM-MEMB-STATE             PIC XX.
  4469             20  CM-MEMB-ACCOUNT           PIC X(6).
  4470             20  CM-MEMB-LN4.
  4471                 25  CM-INSURED-INITIALS-A5.
  4472                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4473                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4474                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4475
  4476     12  CM-INSURED-PROFILE-DATA.
  4477         16  CM-INSURED-FIRST-NAME.
  4478             20  CM-INSURED-1ST-INIT       PIC X.
  4479             20  FILLER                    PIC X(9).
  4480         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4481         16  CM-INSURED-SEX                PIC X.
  4482             88  CM-SEX-MALE                  VALUE 'M'.
  4483             88  CM-SEX-FEMAL                 VALUE 'F'.
  4484         16  CM-INSURED-JOINT-AGE          PIC 99.
  4485         16  CM-JOINT-INSURED-NAME.
  4486             20  CM-JT-LAST-NAME           PIC X(15).
  4487             20  CM-JT-FIRST-NAME.
  4488                 24  CM-JT-1ST-INIT        PIC X.
  4489                 24  FILLER                PIC X(9).
  4490             20  CM-JT-INITIAL             PIC X.
  4491
  4492     12  CM-LIFE-DATA.
  4493         16  CM-LF-BENEFIT-CD              PIC XX.
  4494         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4495         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4496         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4497         16  CM-LF-DEV-CODE                PIC XXX.
  4498         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4499         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4500         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4501         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4502         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4503         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  80
* EL6317.cbl
  4504         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4505         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4506         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4507         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4508         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4509         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4510         16  FILLER                        PIC XX.
  4511
  4512     12  CM-AH-DATA.
  4513         16  CM-AH-BENEFIT-CD              PIC XX.
  4514         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4515         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4516         16  CM-AH-DEV-CODE                PIC XXX.
  4517         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4518         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4519         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4520         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4521         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4522         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4523         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4524         16  CM-AH-PAID-THRU-DT            PIC XX.
  4525             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4526         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4527         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4528         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4529         16  FILLER                        PIC X.
  4530
  4531     12  CM-LOAN-INFORMATION.
  4532         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4533         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4534                                           PIC S9(5)V99  COMP-3.
  4535         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4536         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4537         16  CM-PAY-FREQUENCY              PIC S99.
  4538         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4539         16  CM-RATE-CLASS                 PIC XX.
  4540         16  CM-BENEFICIARY                PIC X(25).
  4541         16  CM-POLICY-FORM-NO             PIC X(12).
  4542         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4543         16  CM-LAST-ADD-ON-DT             PIC XX.
  4544         16  CM-DEDUCTIBLE-AMOUNTS.
  4545             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4546             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4547         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4548             20  CM-RESIDENT-STATE         PIC XX.
  4549             20  CM-RATE-CODE              PIC X(4).
  4550             20  FILLER                    PIC XX.
  4551         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4552             20  CM-LOAN-OFFICER           PIC X(5).
  4553             20  FILLER                    PIC XXX.
  4554         16  CM-CSR-CODE                   PIC XXX.
  4555         16  CM-UNDERWRITING-CODE          PIC X.
  4556             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4557         16  CM-POST-CARD-IND              PIC X.
  4558         16  CM-NH-INTERFACE-SW            PIC X.
  4559         16  CM-PREMIUM-TYPE               PIC X.
  4560             88  CM-SING-PRM                  VALUE '1'.
  4561             88  CM-O-B-COVERAGE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  81
* EL6317.cbl
  4562             88  CM-OPEN-END                  VALUE '3'.
  4563         16  CM-IND-GRP-TYPE               PIC X.
  4564             88  CM-INDIVIDUAL                VALUE 'I'.
  4565             88  CM-GROUP                     VALUE 'G'.
  4566         16  CM-SKIP-CODE                  PIC X.
  4567             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4568             88  SKIP-JULY                    VALUE '1'.
  4569             88  SKIP-AUGUST                  VALUE '2'.
  4570             88  SKIP-SEPTEMBER               VALUE '3'.
  4571             88  SKIP-JULY-AUG                VALUE '4'.
  4572             88  SKIP-AUG-SEPT                VALUE '5'.
  4573             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4574             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4575             88  SKIP-JUNE                    VALUE '8'.
  4576             88  SKIP-JUNE-JULY               VALUE '9'.
  4577             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4578             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4579         16  CM-PAYMENT-MODE               PIC X.
  4580             88  PAY-MONTHLY                  VALUE SPACE.
  4581             88  PAY-WEEKLY                   VALUE '1'.
  4582             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4583             88  PAY-BI-WEEKLY                VALUE '3'.
  4584             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4585         16  CM-LOAN-NUMBER                PIC X(8).
  4586         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4587         16  CM-OLD-LOF                    PIC XXX.
  4588*        16  CM-LOAN-OFFICER               PIC XXX.
  4589         16  CM-REIN-TABLE                 PIC XXX.
  4590         16  CM-SPECIAL-REIN-CODE          PIC X.
  4591         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4592         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4593         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4594
  4595     12  CM-STATUS-DATA.
  4596         16  CM-ENTRY-STATUS               PIC X.
  4597         16  CM-ENTRY-DT                   PIC XX.
  4598
  4599         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4600         16  CM-LF-CANCEL-DT               PIC XX.
  4601         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4602
  4603         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4604         16  CM-LF-DEATH-DT                PIC XX.
  4605         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4606
  4607         16  CM-LF-CURRENT-STATUS          PIC X.
  4608             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4609                                                'M' '4' '5' '9'.
  4610             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4611             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4612             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4613             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4614             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4615             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4616             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4617             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4618             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4619             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  82
* EL6317.cbl
  4620             88  CM-LF-DECLINED               VALUE 'D'.
  4621             88  CM-LF-VOIDED                 VALUE 'V'.
  4622
  4623         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4624         16  CM-AH-CANCEL-DT               PIC XX.
  4625         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4626
  4627         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4628         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4629         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4630
  4631         16  CM-AH-CURRENT-STATUS          PIC X.
  4632             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4633                                                'M' '4' '5' '9'.
  4634             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4635             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4636             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4637             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4638             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4639             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4640             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4641             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4642             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4643             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4644             88  CM-AH-DECLINED               VALUE 'D'.
  4645             88  CM-AH-VOIDED                 VALUE 'V'.
  4646
  4647         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4648             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4649             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4650             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4651         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4652
  4653         16  CM-ENTRY-BATCH                PIC X(6).
  4654         16  CM-LF-EXIT-BATCH              PIC X(6).
  4655         16  CM-AH-EXIT-BATCH              PIC X(6).
  4656         16  CM-LAST-MONTH-END             PIC XX.
  4657
  4658     12  CM-NOTE-SW                        PIC X.
  4659         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4660         88  CERT-NOTES-PRESENT               VALUE '1'.
  4661         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4662         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4663         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4664         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4665         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4666         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4667     12  CM-COMP-EXCP-SW                   PIC X.
  4668         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4669         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4670     12  CM-INSURED-ADDRESS-SW             PIC X.
  4671         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4672         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4673
  4674*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4675     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4676     12  FILLER                            PIC X.
  4677
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  83
* EL6317.cbl
  4678*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4679     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4680     12  FILLER                            PIC X.
  4681*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4682     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4683
  4684     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4685         88  CERT-ADDED-BATCH                 VALUE ' '.
  4686         88  CERT-ADDED-ONLINE                VALUE '1'.
  4687         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4688         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4689         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4690     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4691         88  CERT-AS-LOADED                   VALUE ' '.
  4692         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4693         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4694         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4695         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4696         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4697         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4698         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4699
  4700     12  CM-ACCOUNT-COMM-PCTS.
  4701         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4702         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4703
  4704     12  CM-USER-FIELD                     PIC X.
  4705     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4706     12  CM-CLP-STATE                      PIC XX.
  4707     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4708     12  CM-USER-RESERVED                  PIC XXX.
  4709     12  FILLER REDEFINES CM-USER-RESERVED.
  4710         16  CM-AH-CLASS-CD                PIC XX.
  4711         16  F                             PIC X.
  4712******************************************************************
  4713*                                COPY ELCCRTO.
  4714******************************************************************
  4715*                                                                *
  4716*                            ELCCRTO.                            *
  4717*                                                                *
  4718*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4719*                                                                *
  4720*   FILE TYPE = VSAM,KSDS                                        *
  4721*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4722*                                                                *
  4723*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4724*                                                                *
  4725*   LOG = YES                                                    *
  4726*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4727******************************************************************
  4728*                   C H A N G E   L O G
  4729*
  4730* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4731*-----------------------------------------------------------------
  4732*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4733* EFFECTIVE    NUMBER
  4734*-----------------------------------------------------------------
  4735* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  84
* EL6317.cbl
  4736* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4737* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4738******************************************************************
  4739 01  ORIGINAL-CERTIFICATE.
  4740     12  OC-RECORD-ID                      PIC XX.
  4741         88  VALID-OC-ID                      VALUE 'OC'.
  4742     12  OC-CONTROL-PRIMARY.
  4743         16  OC-COMPANY-CD                 PIC X.
  4744         16  OC-CARRIER                    PIC X.
  4745         16  OC-GROUPING                   PIC X(6).
  4746         16  OC-STATE                      PIC XX.
  4747         16  OC-ACCOUNT                    PIC X(10).
  4748         16  OC-CERT-EFF-DT                PIC XX.
  4749         16  OC-CERT-NO.
  4750             20  OC-CERT-PRIME             PIC X(10).
  4751             20  OC-CERT-SFX               PIC X.
  4752         16  OC-RECORD-TYPE                PIC X.
  4753         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4754     12  OC-LAST-MAINT-DT                  PIC XX.
  4755     12  OC-LAST-MAINT-BY                  PIC X(4).
  4756     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4757     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4758     12  FILLER                            PIC X(49).
  4759     12  OC-ORIG-REC.
  4760         16  OC-INS-LAST-NAME              PIC X(15).
  4761         16  OC-INS-FIRST-NAME             PIC X(10).
  4762         16  OC-INS-MIDDLE-INIT            PIC X.
  4763         16  OC-INS-AGE                    PIC S999     COMP-3.
  4764         16  OC-JNT-LAST-NAME              PIC X(15).
  4765         16  OC-JNT-FIRST-NAME             PIC X(10).
  4766         16  OC-JNT-MIDDLE-INIT            PIC X.
  4767         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4768         16  OC-LF-BENCD                   PIC XX.
  4769         16  OC-LF-TERM                    PIC S999      COMP-3.
  4770         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4771         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4772         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4773         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4774         16  OC-LF-EXP-DT                  PIC XX.
  4775         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4776         16  OC-LF-CANCEL-DT               PIC XX.
  4777         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4778         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4779         16  OC-AH-BENCD                   PIC XX.
  4780         16  OC-AH-TERM                    PIC S999      COMP-3.
  4781         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4782         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4783         16  OC-AH-EXP-DT                  PIC XX.
  4784         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4785         16  OC-AH-CP                      PIC 99.
  4786         16  OC-AH-CANCEL-DT               PIC XX.
  4787         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4788         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4789         16  OC-CRED-BENE-NAME             PIC X(25).
  4790         16  OC-1ST-PMT-DT                 PIC XX.
  4791         16  FILLER                        PIC X(215).
  4792
  4793     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  85
* EL6317.cbl
  4794******************************************************************
  4795*                                COPY ERCENDT.
  4796******************************************************************
  4797*                                                                *
  4798*                                                                *
  4799*                            ERCENDT.                            *
  4800*                            VMOD=2.001                          *
  4801*                                                                *
  4802*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4803*                                                                *
  4804*   FILE TYPE = VSAM,KSDS                                        *
  4805*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4806*                                                                *
  4807*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4808*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4809*                                                                *
  4810*   LOG = NO                                                     *
  4811*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4812******************************************************************
  4813*-----------------------------------------------------------------
  4814*                   C H A N G E   L O G
  4815*
  4816* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4817*-----------------------------------------------------------------
  4818*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4819* EFFECTIVE    NUMBER
  4820*-----------------------------------------------------------------
  4821* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4822*                                WITH OPEN CLAIMS
  4823* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4824* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4825*-----------------------------------------------------------------
  4826 01  ENDORSEMENT-RECORD.
  4827     12  EN-RECORD-ID                PIC XX.
  4828         88  VALID-EN-ID                VALUE 'EN'.
  4829     12  EN-CONTROL-PRIMARY.
  4830         16  EN-COMPANY-CD           PIC X.
  4831         16  EN-CARRIER              PIC X.
  4832         16  EN-GROUPING             PIC X(6).
  4833         16  EN-STATE                PIC XX.
  4834         16  EN-ACCOUNT              PIC X(10).
  4835         16  EN-CERT-EFF-DT          PIC XX.
  4836         16  EN-CERT-NO.
  4837             20  EN-CERT-PRIME       PIC X(10).
  4838             20  EN-CERT-SFX         PIC X.
  4839         16  EN-REC-TYPE             PIC X.
  4840             88  EN-ISSUE               VALUE 'I'.
  4841             88  EN-CANCELLATION        VALUE 'C'.
  4842         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4843     12  EN-CONTROL-BY-ARCH-NO.
  4844         16  EN-COMPANY-CD-A1              PIC X.
  4845         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4846     12  EN-LAST-MAINT-DT            PIC XX.
  4847     12  EN-LAST-MAINT-BY            PIC X(4).
  4848     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4849     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4850     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4851         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  86
* EL6317.cbl
  4852         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4853         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4854         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4855         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4856         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4857         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4858         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4859         16  EN-LF-ORIG-BENCD        PIC XX.
  4860         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4861         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4862         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4863         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4864         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4865         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4866*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4867         16  EN-ORIG-CRED-BENE       PIC X(25).
  4868         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4869         16  FILLER                  PIC X.
  4870         16  EN-AH-ORIG-BENCD        PIC XX.
  4871         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4872         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4873         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4874         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4875*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4876*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4877         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4878         16  F                       PIC X(09).
  4879         16  EN-AH-ORIG-CP           PIC 99.
  4880         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4881         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4882         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4883         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4884         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4885         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4886         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4887         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4888         16  EN-LF-NEW-BENCD         PIC XX.
  4889         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4890         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4891         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4892         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4893         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4894         16  EN-LF-NEW-EXP-DT        PIC XX.
  4895         16  EN-NEW-CRED-BENE        PIC X(25).
  4896         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4897         16  FILLER                  PIC X.
  4898         16  EN-AH-NEW-BENCD         PIC XX.
  4899         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4900         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4901         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4902         16  EN-AH-NEW-EXP-DT        PIC XX.
  4903*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  4904*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  4905*        16  F                       PIC X(12).
  4906         16  EN-AH-NEW-CP            PIC 99.
  4907         16  EN-SIG-SW               PIC X.
  4908         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4909         16  FILLER                  PIC X(37).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  87
* EL6317.cbl
  4910     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4911         16  EN-LF-ORIG-REF-DT       PIC XX.
  4912         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4913         16  EN-AH-ORIG-REF-DT       PIC XX.
  4914         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4915         16  EN-LF-NEW-REF-DT        PIC XX.
  4916         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4917         16  EN-AH-NEW-REF-DT        PIC XX.
  4918         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4919         16  EN-FLAG-CERT            PIC X.
  4920         16  EN-INS-LAST-NAME        PIC X(15).
  4921         16  EN-INS-FIRST-NAME       PIC X(10).
  4922         16  EN-INS-MIDDLE-INIT      PIC X.
  4923         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  4924         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  4925         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  4926         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  4927         16  FILLER                  PIC X(262).
  4928     12  EN-MONEY-SW             PIC X.
  4929     12  EN-HEALTH-APP           PIC X.
  4930     12  EN-VOUCHER-SW           PIC X.
  4931     12  EN-PAYEE                PIC X(14).
  4932     12  EN-INPUT-DT             PIC XX.
  4933     12  EN-PROCESS-DT           PIC XX.
  4934     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  4935     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  4936     12  EN-REASON-CODES.
  4937         16  F OCCURS 12.
  4938             20  EN-REASON-CODE  PIC X(4).
  4939     12  EN-TEMPLATE-USED        PIC X(8).
  4940     12  EN-DOCU-TYPE            PIC X.
  4941         88  EN-VERI-DOCU          VALUE 'V'.
  4942         88  EN-GCE-DOCU           VALUE 'G'.
  4943         88  EN-CANC-DOCU          VALUE 'C'.
  4944     12  EN-COMMENTS1            PIC X(13).
  4945     12  EN-COMMENTS2            PIC X(70).
  4946     12  EN-COMM-CHGBK           PIC X.
  4947         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  4948         88  EN-CHG-ACCT           VALUE 'Y'.
  4949     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  4950     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  4951     12  EN-BATCH-NUMBER         PIC X(6).
  4952     12  EN-ACCT-SUMM            PIC X.
  4953     12  EN-CSO-SUMM             PIC X.
  4954     12  FILLER                  PIC X(13).
  4955******************************************************************
  4956*                                COPY ERCNOTE.
  4957******************************************************************
  4958*                                                                *
  4959*                                                                *
  4960*                            ERCNOTE                             *
  4961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4962*                            VMOD=2.003                          *
  4963*                                                                *
  4964*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  4965*                                                                *
  4966*        FILE TYPE= VSAM,KSDS                                    *
  4967*        RECORD SIZE = 825    RECFORM = FIXED                    *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  88
* EL6317.cbl
  4968*                                                                *
  4969*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  4970*                                                                *
  4971*        LOG = YES                                               *
  4972*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4973*                                                                *
  4974******************************************************************
  4975*                   C H A N G E   L O G
  4976*
  4977* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4978*-----------------------------------------------------------------
  4979*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4980* EFFECTIVE    NUMBER
  4981*-----------------------------------------------------------------
  4982* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  4983*                                FILE WILL CONTAIN BILLING NOTES O
  4984******************************************************************
  4985
  4986 01  CERTIFICATE-NOTE.
  4987     12  CN-RECORD-ID                PIC  XX.
  4988         88  VALID-CN-ID                  VALUE 'CN'.
  4989
  4990     12  CN-CONTROL-PRIMARY.
  4991         16  CN-COMPANY-CD           PIC X.
  4992         16  CN-CARRIER              PIC X.
  4993         16  CN-GROUPING.
  4994             20 CN-GROUPING-PREFIX   PIC XXX.
  4995             20 CN-GROUPING-PRIME    PIC XXX.
  4996         16  CN-STATE                PIC XX.
  4997         16  CN-ACCOUNT.
  4998             20 CN-ACCOUNT-PREFIX    PIC X(4).
  4999             20 CN-ACCOUNT-PRIME     PIC X(6).
  5000         16  CN-CERT-EFF-DT          PIC XX.
  5001         16  CN-CERT-NO.
  5002             20  CN-CERT-PRIME       PIC X(10).
  5003             20  CN-CERT-SFX         PIC X.
  5004
  5005     12  CN-BILLING-START-LINE-NO    PIC 99.
  5006     12  CN-BILLING-END-LINE-NO      PIC 99.
  5007
  5008     12  CN-LINES.
  5009         16  CN-LINE OCCURS 10       PIC X(77).
  5010
  5011     12  CN-LAST-MAINT-DT            PIC XX.
  5012     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5013     12  CN-LAST-MAINT-USER          PIC X(4).
  5014     12  FILLER                      PIC X(6).
  5015******************************************************************
  5016*                                COPY ERCMAIL.
  5017******************************************************************
  5018*                                                                *
  5019*                                                                *
  5020*                            ERCMAIL                             *
  5021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5022*                            VMOD=2.003                          *
  5023*                                                                *
  5024*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5025*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  89
* EL6317.cbl
  5026*   FILE TYPE = VSAM,KSDS                                        *
  5027*   RECORD SIZE = 374   RECFORM = FIX                            *
  5028*                                                                *
  5029*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5030*   ALTERNATE PATH    = NOT USED                                 *
  5031*                                                                *
  5032*   LOG = YES                                                    *
  5033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5034******************************************************************
  5035*                   C H A N G E   L O G
  5036*
  5037* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5038*-----------------------------------------------------------------
  5039*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5040* EFFECTIVE    NUMBER
  5041*-----------------------------------------------------------------
  5042* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5043* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5044* 111108                   PEMA  ADD CRED BENE ADDR2
  5045******************************************************************
  5046
  5047 01  MAILING-DATA.
  5048     12  MA-RECORD-ID                      PIC XX.
  5049         88  VALID-MA-ID                       VALUE 'MA'.
  5050
  5051     12  MA-CONTROL-PRIMARY.
  5052         16  MA-COMPANY-CD                 PIC X.
  5053         16  MA-CARRIER                    PIC X.
  5054         16  MA-GROUPING.
  5055             20  MA-GROUPING-PREFIX        PIC XXX.
  5056             20  MA-GROUPING-PRIME         PIC XXX.
  5057         16  MA-STATE                      PIC XX.
  5058         16  MA-ACCOUNT.
  5059             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5060             20  MA-ACCOUNT-PRIME          PIC X(6).
  5061         16  MA-CERT-EFF-DT                PIC XX.
  5062         16  MA-CERT-NO.
  5063             20  MA-CERT-PRIME             PIC X(10).
  5064             20  MA-CERT-SFX               PIC X.
  5065
  5066     12  FILLER                            PIC XX.
  5067
  5068     12  MA-ACCESS-CONTROL.
  5069         16  MA-SOURCE-SYSTEM              PIC XX.
  5070             88  MA-FROM-CREDIT                VALUE 'CR'.
  5071             88  MA-FROM-VSI                   VALUE 'VS'.
  5072             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5073             88  MA-FROM-OTHER                 VALUE 'OT'.
  5074         16  MA-RECORD-ADD-DT              PIC XX.
  5075         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5076         16  MA-LAST-MAINT-DT              PIC XX.
  5077         16  MA-LAST-MAINT-BY              PIC XXXX.
  5078         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5079
  5080     12  MA-PROFILE-INFO.
  5081         16  MA-QUALIFY-CODE-1             PIC XX.
  5082         16  MA-QUALIFY-CODE-2             PIC XX.
  5083         16  MA-QUALIFY-CODE-3             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  90
* EL6317.cbl
  5084         16  MA-QUALIFY-CODE-4             PIC XX.
  5085         16  MA-QUALIFY-CODE-5             PIC XX.
  5086
  5087         16  MA-INSURED-LAST-NAME          PIC X(15).
  5088         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5089         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5090         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5091         16  MA-INSURED-BIRTH-DT           PIC XX.
  5092         16  MA-INSURED-SEX                PIC X.
  5093             88  MA-SEX-MALE                   VALUE 'M'.
  5094             88  MA-SEX-FEMALE                 VALUE 'F'.
  5095         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5096
  5097         16  MA-ADDRESS-CORRECTED          PIC X.
  5098         16  MA-JOINT-BIRTH-DT             PIC XX.
  5099*        16  FILLER                        PIC X(12).
  5100
  5101         16  MA-ADDRESS-LINE-1             PIC X(30).
  5102         16  MA-ADDRESS-LINE-2             PIC X(30).
  5103         16  MA-CITY-STATE.
  5104             20  MA-CITY                   PIC X(28).
  5105             20  MA-ADDR-STATE             PIC XX.
  5106         16  MA-ZIP.
  5107             20  MA-ZIP-CODE.
  5108                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5109                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5110                 24  FILLER                PIC X(4).
  5111             20  MA-ZIP-PLUS4              PIC X(4).
  5112         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5113             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5114             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5115             20  FILLER                    PIC X(3).
  5116
  5117         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5118
  5119         16  FILLER                        PIC XXX.
  5120*        16  FILLER                        PIC X(10).
  5121
  5122     12  MA-CRED-BENE-INFO.
  5123         16  MA-CRED-BENE-NAME                 PIC X(25).
  5124         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5125         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5126         16  MA-CRED-BENE-CTYST.
  5127             20  MA-CRED-BENE-CITY             PIC X(28).
  5128             20  MA-CRED-BENE-STATE            PIC XX.
  5129         16  MA-CRED-BENE-ZIP.
  5130             20  MA-CB-ZIP-CODE.
  5131                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5132                     88  MA-CB-CANADIAN-POST-CODE
  5133                                           VALUE 'A' THRU 'Z'.
  5134                 24  FILLER                    PIC X(4).
  5135             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5136         16  MA-CB-CANADIAN-POSTAL-CODE
  5137                            REDEFINES MA-CRED-BENE-ZIP.
  5138             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5139             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5140             20  FILLER                        PIC X(3).
  5141     12  MA-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  91
* EL6317.cbl
  5142         16  MA-MAIL-DATA OCCURS 7.
  5143             20  MA-MAIL-TYPE              PIC X.
  5144                 88  MA-12MO-MAILING           VALUE '1'.
  5145                 88  MA-EXP-MAILING            VALUE '2'.
  5146             20  MA-MAIL-STATUS            PIC X.
  5147                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5148                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5149                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5150             20  MA-MAIL-DATE              PIC XX.
  5151     12  FILLER                            PIC XX.
  5152     12  FILLER                            PIC XX.
  5153*    12  FILLER                            PIC X(30).
  5154******************************************************************
  5155*                                COPY ERCARCH.
  5156******************************************************************
  5157*                                                                *
  5158*                            ERCARCH.                            *
  5159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5160*                            VMOD=2.002                          *
  5161*                                                                *
  5162*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5163*                                                                *
  5164*   FILE TYPE = VSAM,KSDS                                        *
  5165*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5166*                                                                *
  5167*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5168*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5169*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5170*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5171*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5172*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5173*                                                                *
  5174*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5175******************************************************************
  5176*                   C H A N G E   L O G
  5177*
  5178* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5179*-----------------------------------------------------------------
  5180*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5181* EFFECTIVE    NUMBER
  5182*-----------------------------------------------------------------
  5183* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5184* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5185* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5186******************************************************************
  5187 01  LETTER-ARCHIVE.
  5188     12  LA-RECORD-ID                PIC  X(02).
  5189         88  LA-VALID-ID                VALUE 'LA'.
  5190
  5191     12  LA-CONTROL-PRIMARY.
  5192         16  LA-COMPANY-CD           PIC  X(01).
  5193         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5194
  5195     12  LA-CONTROL-BY-CERT-RESP.
  5196         16  LA-COMPANY-CD-A2        PIC  X(01).
  5197         16  LA-CERT-NO-A2.
  5198             20  LA-CERT-PRIME-A2    PIC  X(10).
  5199             20  LA-CERT-SUFFIX-A2   PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  92
* EL6317.cbl
  5200         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5201             20  LA-RESP-PERSON-A2   PIC  X(10).
  5202             20  LA-TYPE-A2          PIC  X(01).
  5203         16  LA-CARRIER-A2           PIC  X(01).
  5204         16  LA-GROUPING-A2          PIC  X(06).
  5205         16  LA-STATE-A2             PIC  X(02).
  5206         16  LA-ACCOUNT-A2           PIC  X(10).
  5207         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5208         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5209
  5210     12  LA-CONTROL-BY-FORM.
  5211         16  LA-COMPANY-CD-A3        PIC  X(01).
  5212         16  LA-FORM-A3              PIC  X(04).
  5213         16  LA-CARRIER-A3           PIC  X(01).
  5214         16  LA-GROUPING-A3          PIC  X(06).
  5215         16  LA-STATE-A3             PIC  X(02).
  5216         16  LA-ACCOUNT-A3           PIC  X(10).
  5217         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5218
  5219     12  LA-CONTROL-BY-PROCESSOR.
  5220         16  LA-COMPANY-CD-A4        PIC  X(01).
  5221         16  LA-PROCESSOR-CD         PIC  X(04).
  5222         16  LA-CARRIER-A4           PIC  X(01).
  5223         16  LA-GROUPING-A4          PIC  X(06).
  5224         16  LA-STATE-A4             PIC  X(02).
  5225         16  LA-ACCOUNT-A4           PIC  X(10).
  5226         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5227
  5228     12  LA-CONTROL-BY-KEY-FIELDS.
  5229         16  LA-COMPANY-CD-A5        PIC  X(01).
  5230         16  LA-CARRIER-A5           PIC  X(01).
  5231         16  LA-GROUPING-A5          PIC  X(06).
  5232         16  LA-STATE-A5             PIC  X(02).
  5233         16  LA-ACCOUNT-A5           PIC  X(10).
  5234         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5235
  5236     12  LA-CONTROL-BY-GROUP-CODE.
  5237         16  LA-COMPANY-CD-A6        PIC  X(01).
  5238         16  LA-ENTRY-A6.
  5239             20  LA-FILLER           PIC  X(02).
  5240             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5241         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5242
  5243     12  FILLER                      PIC  X(09).
  5244
  5245     12  LA-HEADER-RECORD.
  5246         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5247         16  LA-CREATION-DATE        PIC  X(02).
  5248         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5249         16  LA-FINAL-ACT-DATE       REDEFINES
  5250               LA-FOLLOW-UP-DATE     PIC  X(02).
  5251         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5252         16  LA-NO-OF-COPIES         PIC S9(01).
  5253         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5254         16  LA-REPLY-DATE           PIC  X(02).
  5255         16  LA-RESEND-DATES.
  5256             20  LA-RESEND-DATE      PIC  X(02).
  5257             20  LA-SENT-DATE        PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  93
* EL6317.cbl
  5258             20  FILLER              PIC  X(08).
  5259         16  LA-SOURCE-INFORMATION.
  5260             20  LA-DATA-SOURCE      PIC  X(01).
  5261             20  LA-ADDR-SOURCE      PIC  X(01).
  5262         16  LA-STATUS               PIC  X(01).
  5263             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5264             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5265             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5266             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5267             88  LA-STATUS-PURGED         VALUE 'P'.
  5268             88  LA-STATUS-VOIDED         VALUE 'V'.
  5269         16  LA-LAST-RESENT-PRINT-DATE
  5270                                     PIC  X(02).
  5271         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5272             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5273                                          VALUE 'C'.
  5274             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5275                                          VALUE 'F'.
  5276             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5277                                          VALUE 'P'.
  5278         16  LA-PURGED-DATE          PIC  X(02).
  5279         16  LA-VOIDED-DATE          PIC  X(02).
  5280         16  LA-RESEND-LETR          PIC  X(4).
  5281         16  FILLER                  PIC  X(08).
  5282*        16  LA-RESEND-LETR-2        PIC  X(4).
  5283*        16  LA-RESEND-LETR-3        PIC  X(4).
  5284*        16  FILLER                  PIC  X(59).
  5285         16  LA-ARCHIVE-STATUS       PIC  X.
  5286             88  LA-TEMP                VALUE 'T'.
  5287             88  LA-QWS                 VALUE 'Q'.
  5288             88  LA-BATCH               VALUE 'B'.
  5289         16  LA-FINAL-ACT-IND        PIC  X(1).
  5290         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5291         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5292         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5293                                     PIC X(4).
  5294         16  FILLER                  PIC  X(42).
  5295*        16  FILLER                  PIC  X(71).
  5296         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5297         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5298         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5299                                     PIC  X(4).
  5300         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5301
  5302******************************************************************
  5303*                                COPY ERCCNOT.
  5304******************************************************************
  5305*                                                                *
  5306*                            ERCCNOT                             *
  5307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5308*                            VMOD=2.003                          *
  5309*                                                                *
  5310*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5311*                                                                *
  5312*        FILE TYPE= VSAM,KSDS                                    *
  5313*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5314*                                                                *
  5315*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  94
* EL6317.cbl
  5316*                                                                *
  5317*        LOG = YES                                               *
  5318*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5319*                                                                *
  5320******************************************************************
  5321*                   C H A N G E   L O G
  5322*
  5323* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5324*-----------------------------------------------------------------
  5325*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5326* EFFECTIVE    NUMBER
  5327*-----------------------------------------------------------------
  5328* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5329******************************************************************
  5330
  5331 01  CERT-NOTE-FILE.
  5332     12  CZ-RECORD-ID                PIC  XX.
  5333         88  VALID-CZ-ID                  VALUE 'CZ'.
  5334
  5335     12  CZ-CONTROL-PRIMARY.
  5336         16  CZ-COMPANY-CD           PIC X.
  5337         16  CZ-CARRIER              PIC X.
  5338         16  CZ-GROUPING.
  5339             20 CZ-GROUPING-PREFIX   PIC XXX.
  5340             20 CZ-GROUPING-PRIME    PIC XXX.
  5341         16  CZ-STATE                PIC XX.
  5342         16  CZ-ACCOUNT.
  5343             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5344             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5345         16  CZ-CERT-EFF-DT          PIC XX.
  5346         16  CZ-CERT-NO.
  5347             20  CZ-CERT-PRIME       PIC X(10).
  5348             20  CZ-CERT-SFX         PIC X.
  5349         16  CZ-RECORD-TYPE          PIC X.
  5350             88  CERT-NOTE           VALUE '1'.
  5351             88  CLAIM-CERT-NOTE     VALUE '2'.
  5352         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5353
  5354     12  CZ-LAST-MAINT-DT            PIC XX.
  5355     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5356     12  CZ-LAST-MAINT-USER          PIC X(4).
  5357
  5358     12  CZ-NOTE-INFORMATION.
  5359         16  CZ-NOTE                 PIC X(63).
  5360         16  FILLER                  PIC X(39).
  5361******************************************************************
  5362*                                COPY ELCEOBC.
  5363******************************************************************
  5364*                                                                *
  5365*                                                                *
  5366*                            ELCEOBC                             *
  5367*                            VMOD=2.001                          *
  5368*                                                                *
  5369*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5370*                                                                *
  5371*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5372*   VSAM EOB CODE TABLE                                          *
  5373*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  95
* EL6317.cbl
  5374*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5375*                                                                *
  5376*   FILE TYPE = VSAM,KSDS                                        *
  5377*   RECORD SIZE = 350   RECFORM = FIX                            *
  5378*                                                                *
  5379*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5380*                                                                *
  5381*   LOG = NO                                                     *
  5382*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5383*                                                                *
  5384*                                                                *
  5385******************************************************************
  5386*                   C H A N G E   L O G
  5387*
  5388* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5389*-----------------------------------------------------------------
  5390*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5391* EFFECTIVE    NUMBER
  5392*-----------------------------------------------------------------
  5393* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5394* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5395******************************************************************
  5396 01  EOB-CODES.
  5397     12  EO-RECORD-ID                      PIC XX.
  5398         88  VALID-DN-ID                      VALUE 'EO'.
  5399     12  EO-CONTROL-PRIMARY.
  5400         16  EO-COMPANY-CD                 PIC X.
  5401         16  EO-RECORD-TYPE                PIC X.
  5402             88  EO-EOB-RECS                  VALUE '1'.
  5403             88  EO-VERIF-RECS                VALUE '2'.
  5404             88  EO-GCE-RECS                  VALUE '3'.
  5405         16  EO-EOB-CODE                   PIC X(4).
  5406         16  FILLER                        PIC X(9).
  5407     12  EO-MAINT-INFORMATION.
  5408         16  EO-LAST-MAINT-DT              PIC XX.
  5409         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5410         16  EO-LAST-MAINT-USER            PIC X(4).
  5411         16  FILLER                        PIC XX.
  5412     12  EO-DESCRIPTION                    PIC X(275).
  5413     12  FILLER                            PIC X(46).
  5414******************************************************************
  5415 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5416                          ACCOUNT-MASTER CONTROL-FILE
  5417                          PENDING-BUSINESS CERTIFICATE-MASTER
  5418                          ORIGINAL-CERTIFICATE
  5419                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5420                          MAILING-DATA LETTER-ARCHIVE
  5421                          CERT-NOTE-FILE EOB-CODES.
  5422 0000-DFHEXIT SECTION.
  5423     MOVE '9#                    $   ' TO DFHEIV0.
  5424     MOVE 'EL6317' TO DFHEIV1.
  5425     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5426     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5427     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5428     MOVE '5'                    TO DC-OPTION-CODE
  5429     PERFORM 9700-DATE-LINK
  5430     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5431     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  96
* EL6317.cbl
  5432     MOVE EIBTRMID               TO QID-TERM
  5433     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5434     IF EIBCALEN = 0
  5435        GO TO 8800-UNAUTHORIZED-ACCESS
  5436     END-IF
  5437     MOVE FUNCTION LENGTH(EL631JI) TO MAP-LENGTH
  5438     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5439        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5440           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5441           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5442           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5443           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5444           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5445           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5446           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5447           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5448           MOVE LOW-VALUES           TO EL631JI
  5449           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5450           GO TO 0350-BUILD-INIT-MAP
  5451        END-IF
  5452     END-IF
  5453     IF PI-CALLING-PROGRAM = 'EL614'
  5454        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5455                                 TO WS-PASSED-REASON-CODES
  5456        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5457        IF WS-PASSED-REASON-CODES NOT = SPACES
  5458           MOVE 'Y'              TO WS-SET-CODES-MDT
  5459        ELSE
  5460           MOVE 'N'              TO WS-SET-CODES-MDT
  5461        END-IF
  5462        PERFORM 0600-RECOVER-TEMP-STORAGE
  5463                                 THRU 0600-EXIT
  5464        GO TO 0350-BUILD-INIT-MAP
  5465     END-IF
  5466     IF EIBAID = DFHCLEAR
  5467        IF PI-CLEAR-ERROR
  5468           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5469           MOVE ER-3832           TO EMI-ERROR
  5470           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5471           GO TO 0350-BUILD-INIT-MAP
  5472        ELSE
  5473           GO TO 9400-CLEAR
  5474        END-IF
  5475     END-IF
  5476     .
  5477 0200-RECEIVE.
  5478     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5479        MOVE ER-0008             TO EMI-ERROR
  5480        PERFORM 9900-ERROR-FORMAT
  5481                                 THRU 9900-EXIT
  5482        MOVE -1                  TO PFENTRL
  5483        GO TO 8100-SEND-INITIAL-MAP
  5484     END-IF
  5485
  5486* EXEC CICS RECEIVE
  5487*        MAP      (MAP-NAME)
  5488*        MAPSET   (MAPSET-NAME)
  5489*        INTO     (EL631JI)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  97
* EL6317.cbl
  5490*    END-EXEC
  5491     MOVE LENGTH OF
  5492      EL631JI
  5493       TO DFHEIV11
  5494*    MOVE '8"T I  L              ''   #00005481' TO DFHEIV0
  5495     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5496     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5497     MOVE X'2020233030303035343831' TO DFHEIV0(25:11)
  5498     CALL 'kxdfhei1' USING DFHEIV0,
  5499           MAP-NAME,
  5500           EL631JI,
  5501           DFHEIV11,
  5502           MAPSET-NAME,
  5503           DFHEIV99,
  5504           DFHEIV99
  5505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5506     IF PFENTRL = 0
  5507         GO TO 0300-CHECK-PFKEYS
  5508     END-IF
  5509     IF EIBAID NOT = DFHENTER
  5510         MOVE ER-0004            TO EMI-ERROR
  5511         GO TO 0320-INPUT-ERROR
  5512     END-IF
  5513     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5514        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5515     ELSE
  5516        MOVE ER-0029            TO EMI-ERROR
  5517        GO TO 0320-INPUT-ERROR
  5518     END-IF
  5519     .
  5520 0300-CHECK-PFKEYS.
  5521     IF EIBAID = DFHPF1
  5522        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5523        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5524        MOVE 'EL614'             TO PGM-NAME
  5525        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5526        move +1                  to s2
  5527        perform varying s1 from +1 by +1 until s1 > +12
  5528           if reacd-in (s1) not = spaces and low-values
  5529              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5530              add +5 to s2
  5531           end-if
  5532        END-perform
  5533        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5534        GO TO 9300-XCTL
  5535     END-IF
  5536     IF EIBAID = DFHPF2 OR DFHPF8
  5537        GO TO 0360-FINALIZE
  5538     END-IF
  5539     IF EIBAID = DFHPF23
  5540        IF PI-CLEAR-ERROR
  5541           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5542           MOVE ER-3832           TO EMI-ERROR
  5543           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5544           GO TO 0350-BUILD-INIT-MAP
  5545        ELSE
  5546           GO TO 8810-PF23
  5547        END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  98
* EL6317.cbl
  5548     END-IF
  5549     IF EIBAID = DFHPF24
  5550        IF PI-CLEAR-ERROR
  5551           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5552           MOVE ER-3832           TO EMI-ERROR
  5553           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5554           GO TO 0350-BUILD-INIT-MAP
  5555        ELSE
  5556           GO TO 9200-RETURN-MAIN-MENU
  5557        END-IF
  5558     END-IF
  5559     IF EIBAID = DFHPF12
  5560        GO TO 9500-PF12
  5561     END-IF
  5562     IF EIBAID = DFHENTER
  5563        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5564        GO TO 0325-EDIT-SCREEN
  5565     END-IF
  5566     MOVE ER-0029                TO EMI-ERROR
  5567     .
  5568 0320-INPUT-ERROR.
  5569     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5570     MOVE AL-UNBON               TO PFENTRA
  5571     MOVE -1                     TO PFENTRL
  5572     GO TO 8200-SEND-DATAONLY
  5573     .
  5574 0325-EDIT-SCREEN.
  5575     if prtswl > zeros
  5576        if prtswi = 'Y' OR 'N' OR 'P' OR ' '
  5577*          MOVE AL-UANON       TO PRTSWA
  5578*          IF PRTSWI = ' '
  5579              MOVE 'P'         TO PRTSWI
  5580*          END-IF
  5581*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5582        END-IF
  5583     END-IF
  5584     IF (SIGREQL > ZEROS)
  5585        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5586        MOVE AL-UANON         TO SIGREQA
  5587        IF SIGREQI = ' '
  5588           MOVE 'N'           TO SIGREQI
  5589        END-IF
  5590        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5591     ELSE
  5592        MOVE ER-2651          TO EMI-ERROR
  5593        MOVE -1               TO SIGREQL
  5594        MOVE AL-UABON         TO SIGREQA
  5595        PERFORM 9900-ERROR-FORMAT
  5596                                 THRU 9900-EXIT
  5597     END-IF
  5598     IF LTRIDL > ZEROS
  5599        AND LTRIDI > SPACES
  5600        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5601        MOVE LTRIDI              TO LETR-LETTER-ID
  5602                                    PI-LTRID-ENTERED
  5603        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5604        MOVE SPACES              TO LETR-FILLER
  5605        MOVE 0                   TO LETR-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page  99
* EL6317.cbl
  5606        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5607     ELSE
  5608        MOVE ER-1236          TO EMI-ERROR
  5609        MOVE -1               TO LTRIDL
  5610        MOVE AL-UABON         TO LTRIDA
  5611        PERFORM 9900-ERROR-FORMAT
  5612                                 THRU 9900-EXIT
  5613     END-IF
  5614
  5615     IF W-PROMPT-LETTER EQUAL 'Y'
  5616         MOVE ER-0894            TO EMI-ERROR
  5617         MOVE -1                 TO LTRIDL
  5618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5619     END-IF
  5620     SET REASONS-NOT-FOUND TO TRUE
  5621     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5622        IF REACDL (S1) = +4 OR
  5623          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5624              MOVE AL-SANON     TO REACDA (S1)
  5625              SET REASONS-FOUND TO TRUE
  5626        END-IF
  5627     END-PERFORM
  5628
  5629     IF REASONS-NOT-FOUND
  5630        MOVE ER-1820             TO EMI-ERROR
  5631        MOVE -1                  TO PFENTRL
  5632        PERFORM 9900-ERROR-FORMAT
  5633                                 THRU 9900-EXIT
  5634     ELSE
  5635        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5636     END-IF
  5637
  5638     IF CRTNT1L > ZEROS
  5639        IF CRTNT1I > SPACES
  5640           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5641        END-IF
  5642     END-IF
  5643
  5644     IF CRTNT2L > ZEROS
  5645        IF CRTNT2I > SPACES
  5646           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5647        END-IF
  5648     END-IF
  5649
  5650     .
  5651 0325-EXIT.
  5652     EXIT.
  5653
  5654 0326-GET-Z-RECORD.
  5655
  5656     MOVE SPACES  TO W-Z-CONTROL-DATA
  5657
  5658
  5659* EXEC CICS STARTBR
  5660*         DATASET    ('ELLETR')
  5661*         RIDFLD     (ELLETR-KEY)
  5662*         GTEQ
  5663*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 100
* EL6317.cbl
  5664*    END-EXEC.
  5665     MOVE 'ELLETR' TO DFHEIV1
  5666     MOVE 0
  5667       TO DFHEIV11
  5668*    MOVE '&,         G          &  N#00005638' TO DFHEIV0
  5669     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5670     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5671     MOVE X'204E233030303035363338' TO DFHEIV0(25:11)
  5672     CALL 'kxdfhei1' USING DFHEIV0,
  5673           DFHEIV1,
  5674           ELLETR-KEY,
  5675           DFHEIV99,
  5676           DFHEIV11,
  5677           DFHEIV99
  5678     MOVE EIBRESP  TO WS-RESPONSE
  5679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5680
  5681     IF NOT RESP-NORMAL
  5682         MOVE ER-1236          TO EMI-ERROR
  5683         MOVE -1               TO LTRIDL
  5684         MOVE AL-UABON         TO LTRIDA
  5685         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5686         GO TO 0326-ENDBR
  5687     END-IF.
  5688
  5689 0326-READNEXT.
  5690
  5691
  5692* EXEC CICS READNEXT
  5693*        DATASET   ('ELLETR')
  5694*        INTO      (TEXT-FILES)
  5695*        RIDFLD    (ELLETR-KEY)
  5696*        RESP      (WS-RESPONSE)
  5697*    END-EXEC
  5698     MOVE LENGTH OF
  5699      TEXT-FILES
  5700       TO DFHEIV12
  5701     MOVE 'ELLETR' TO DFHEIV1
  5702     MOVE 0
  5703       TO DFHEIV11
  5704*    MOVE '&.IL                  )  N#00005654' TO DFHEIV0
  5705     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5706     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5707     MOVE X'204E233030303035363534' TO DFHEIV0(25:11)
  5708     CALL 'kxdfhei1' USING DFHEIV0,
  5709           DFHEIV1,
  5710           TEXT-FILES,
  5711           DFHEIV12,
  5712           ELLETR-KEY,
  5713           DFHEIV99,
  5714           DFHEIV11,
  5715           DFHEIV99,
  5716           DFHEIV99
  5717     MOVE EIBRESP  TO WS-RESPONSE
  5718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5719     IF RESP-NORMAL
  5720        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5721           MOVE ER-1236          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 101
* EL6317.cbl
  5722           MOVE -1               TO LTRIDL
  5723           MOVE AL-UABON         TO LTRIDA
  5724           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5725           GO TO 0326-ENDBR
  5726        END-IF
  5727
  5728        MOVE AL-UANON         TO LTRIDA
  5729        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5730           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5731        ELSE
  5732           GO TO 0326-READNEXT
  5733        END-IF
  5734     ELSE
  5735        MOVE ER-1236          TO EMI-ERROR
  5736        MOVE -1               TO LTRIDL
  5737        MOVE AL-UABON         TO LTRIDA
  5738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5739        GO TO 0326-ENDBR
  5740     END-IF.
  5741
  5742 0326-ENDBR.
  5743
  5744
  5745* EXEC CICS ENDBR
  5746*        DATASET     ('ELLETR')
  5747*    END-EXEC.
  5748     MOVE 'ELLETR' TO DFHEIV1
  5749     MOVE 0
  5750       TO DFHEIV11
  5751*    MOVE '&2                    $   #00005685' TO DFHEIV0
  5752     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5753     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5754     MOVE X'2020233030303035363835' TO DFHEIV0(25:11)
  5755     CALL 'kxdfhei1' USING DFHEIV0,
  5756           DFHEIV1,
  5757           DFHEIV11,
  5758           DFHEIV99
  5759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5760
  5761
  5762 0326-EXIT.
  5763      EXIT.
  5764 0330-CHECK-ERRORS.
  5765     IF EMI-NO-ERRORS
  5766        GO TO 0350-BUILD-INIT-MAP
  5767     ELSE
  5768        GO TO 8200-SEND-DATAONLY
  5769     END-IF
  5770     .
  5771 0330-EXIT.
  5772     EXIT.
  5773 0350-BUILD-INIT-MAP.
  5774
  5775     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  5776        display 'coming from el1273 '
  5777        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5778        MOVE PI-CARRIER             TO CRTO-CARRIER
  5779        MOVE PI-GROUPING            TO CRTO-GROUPING
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 102
* EL6317.cbl
  5780        MOVE PI-STATE               TO CRTO-STATE
  5781        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5782        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5783        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5784        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5785        MOVE 'I'                    TO CRTO-RECORD-TYPE
  5786        MOVE ZEROS                  TO CRTO-SEQ-NO
  5787        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5788                                       PI-ERENDT-KEY
  5789     END-IF
  5790     MOVE PI-CRTO-CARRIER        TO CARRO
  5791     MOVE PI-CRTO-GROUPING       TO GROUPO
  5792     MOVE PI-CRTO-STATE          TO STATEO
  5793     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  5794     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  5795     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  5796     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  5797     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  5798     MOVE ' '                    TO DC-OPTION-CODE
  5799     PERFORM 9700-DATE-LINK
  5800     IF NO-CONVERSION-ERROR
  5801        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5802     END-IF
  5803
  5804*    IF PI-PRTSW-ENTERED > SPACES
  5805*       MOVE PI-PRTSW-ENTERED    TO PRTSWI
  5806*       MOVE AL-UANON            TO PRTSWA
  5807*       MOVE +1                  TO PRTSWL
  5808*    END-IF
  5809
  5810     IF PI-SIGREQ-ENTERED > SPACES
  5811        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  5812        MOVE AL-UANON            TO SIGREQA
  5813        MOVE +1                  TO SIGREQL
  5814     END-IF
  5815
  5816     IF PI-LTRID-ENTERED > SPACES
  5817        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5818        MOVE AL-UANON            TO LTRIDA
  5819        MOVE +4                  TO LTRIDL
  5820     END-IF
  5821
  5822     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5823     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5824        IF REACDL (S1) = +4 OR
  5825          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5826              MOVE AL-SANON      TO REACDA (S1)
  5827              MOVE +4            TO REACDL (S1)
  5828              SET REASONS-FOUND  TO TRUE
  5829        END-IF
  5830     END-PERFORM
  5831
  5832     GO TO 8100-SEND-INITIAL-MAP
  5833     .
  5834 0360-FINALIZE.
  5835     display ' made it to 0360 '
  5836     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  5837     IF NOT EMI-NO-ERRORS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 103
* EL6317.cbl
  5838       AND EIBAID = DFHPF2
  5839        GO TO 8200-SEND-DATAONLY
  5840     END-IF
  5841     set P to address of KIXSYS
  5842     CALL "getenv" using by value P returning var-ptr
  5843     if var-ptr = null then
  5844        display ' kixsys not set '
  5845     else
  5846        set address of var to var-ptr
  5847        move 0 to env-var-len
  5848        inspect var tallying env-var-len
  5849          for characters before X'00'
  5850*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  5851        unstring var (1:env-var-len) delimited by '/'
  5852           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5853              WS-KIX-SYS
  5854        end-unstring
  5855*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  5856*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  5857     end-if
  5858     set P to address of KIXHOST
  5859     CALL "getenv" using by value P returning var-ptr
  5860     if var-ptr = null then
  5861        display ' kixhost not set '
  5862     else
  5863        set address of var to var-ptr
  5864        move 0 to env-var-len
  5865        inspect var tallying env-var-len
  5866          for characters before X'00'
  5867*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  5868        MOVE var(1:env-var-len)  to ws-kixhost
  5869        DISPLAY ' WS KIX HOST ' WS-KIXhost
  5870     end-if
  5871     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  5872     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  5873     IF RESP-NORMAL
  5874        AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  5875        DISPLAY ' RESP NORMAL AND = '
  5876        MOVE OC-KEY-SEQ-NO  TO CRTO-SEQ-NO
  5877                               PI-CRTO-SEQ-NO
  5878        MOVE LOW-VALUES     TO NEW-ELCRTO-REC
  5879        MOVE PI-ELCRTO-KEY  TO NEW-ELCRTO-KEY
  5880        SUBTRACT +1         FROM NCRTO-SEQ-NO
  5881        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  5882*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  5883        PERFORM 1100-CALL-NS-BUS-LOGIC
  5884                                 THRU 1100-EXIT
  5885        IF BL-OK
  5886           CONTINUE
  5887        ELSE
  5888           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  5889           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  5890           MOVE -1               TO CARRL
  5891        END-IF
  5892     ELSE
  5893        MOVE ER-9999             TO EMI-ERROR
  5894        PERFORM 9900-ERROR-FORMAT
  5895                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 104
* EL6317.cbl
  5896        MOVE -1                  TO CARRL
  5897        GO TO 8100-SEND-INITIAL-MAP
  5898     END-IF
  5899     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  5900                                 TO SYSO
  5901     MOVE WS-KIXHOST             TO HOSTO
  5902     MOVE PI-COMPANY-ID          TO COMPANYO
  5903     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  5904         MOVE '2'                TO DATASORO
  5905     ELSE
  5906         MOVE '4'                TO DATASORO
  5907     END-IF
  5908     MOVE BL-BATCH-NO            TO BATCHNOO
  5909     MOVE BL-BATCH-SEQ           TO BSEQNOO
  5910     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  5911     MOVE PI-PROCESSOR-ID        TO PROCIDO
  5912*    MOVE -1                     TO PRTSWL
  5913*    MOVE AL-UANON               TO PRTSWA
  5914     MOVE -1                     TO SIGREQL
  5915     MOVE AL-UANON               TO SIGREQA
  5916     if eibaid = dfhpf2
  5917        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  5918        MOVE ER-0280             TO EMI-ERROR
  5919        PERFORM 9900-ERROR-FORMAT
  5920                                 THRU 9900-EXIT
  5921        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  5922        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  5923        MOVE 'Y'                 TO PI-FINALIZED-IND
  5924        GO TO 9400-CLEAR
  5925     ELSE
  5926        MOVE ER-1818             TO EMI-ERROR
  5927        PERFORM 9900-ERROR-FORMAT
  5928                                 THRU 9900-EXIT
  5929     END-IF
  5930     GO TO 0350-BUILD-INIT-MAP
  5931     .
  5932 0360-EXIT.
  5933     EXIT.
  5934 0362-READ-ELCRTO.
  5935     display ' made it to 0362 '
  5936
  5937* EXEC CICS READ
  5938*        DATASET   (WS-ELCRTO-FILE-ID)
  5939*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5940*        RIDFLD    (ELCRTO-KEY)
  5941*        GTEQ
  5942*        RESP      (WS-RESPONSE)
  5943*    END-EXEC
  5944*    MOVE '&"S        G          (  N#00005863' TO DFHEIV0
  5945     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5947     MOVE X'204E233030303035383633' TO DFHEIV0(25:11)
  5948     CALL 'kxdfhei1' USING DFHEIV0,
  5949           WS-ELCRTO-FILE-ID,
  5950           DFHEIV20,
  5951           DFHEIV99,
  5952           ELCRTO-KEY,
  5953           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 105
* EL6317.cbl
  5954           DFHEIV99,
  5955           DFHEIV99
  5956     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5957         DFHEIV20
  5958     MOVE EIBRESP  TO WS-RESPONSE
  5959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5960     .
  5961 0362-EXIT.
  5962     EXIT.
  5963 0363-READ-ELCRTO-UPD.
  5964     display ' made it to 0363 '
  5965
  5966* EXEC CICS READ
  5967*        DATASET   (WS-ELCRTO-FILE-ID)
  5968*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  5969*        RIDFLD    (ELCRTO-KEY)
  5970*        UPDATE
  5971*        RESP      (WS-RESPONSE)
  5972*    END-EXEC
  5973*    MOVE '&"S        EU         (  N#00005875' TO DFHEIV0
  5974     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5975     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5976     MOVE X'204E233030303035383735' TO DFHEIV0(25:11)
  5977     CALL 'kxdfhei1' USING DFHEIV0,
  5978           WS-ELCRTO-FILE-ID,
  5979           DFHEIV20,
  5980           DFHEIV99,
  5981           ELCRTO-KEY,
  5982           DFHEIV99,
  5983           DFHEIV99,
  5984           DFHEIV99
  5985     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  5986         DFHEIV20
  5987     MOVE EIBRESP  TO WS-RESPONSE
  5988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5989     .
  5990 0363-EXIT.
  5991     EXIT.
  5992 0365-READ-ERENDT.
  5993
  5994* EXEC CICS READ
  5995*        DATASET   (WS-ERENDT-FILE-ID)
  5996*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  5997*        RIDFLD    (ERENDT-KEY)
  5998*        RESP      (WS-RESPONSE)
  5999*    END-EXEC
  6000*    MOVE '&"S        E          (  N#00005886' TO DFHEIV0
  6001     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6003     MOVE X'204E233030303035383836' TO DFHEIV0(25:11)
  6004     CALL 'kxdfhei1' USING DFHEIV0,
  6005           WS-ERENDT-FILE-ID,
  6006           DFHEIV20,
  6007           DFHEIV99,
  6008           ERENDT-KEY,
  6009           DFHEIV99,
  6010           DFHEIV99,
  6011           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 106
* EL6317.cbl
  6012     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6013         DFHEIV20
  6014     MOVE EIBRESP  TO WS-RESPONSE
  6015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6016     .
  6017 0365-EXIT.
  6018     EXIT.
  6019 0400-ADD-ERENDT.
  6020     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6021     display ' made it to 0400 '
  6022
  6023* EXEC CICS GETMAIN
  6024*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6025*         LENGTH   (ERENDT-LENGTH)
  6026*         INITIMG  (GETMAIN-SPACE)
  6027*    END-EXEC
  6028*    MOVE ',"IL                  $   #00005898' TO DFHEIV0
  6029     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6030     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6031     MOVE X'2020233030303035383938' TO DFHEIV0(25:11)
  6032     CALL 'kxdfhei1' USING DFHEIV0,
  6033           DFHEIV20,
  6034           ERENDT-LENGTH,
  6035           GETMAIN-SPACE
  6036     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6037         DFHEIV20
  6038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6039     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6040     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6041     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6042     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6043                                    EN-INPUT-DT
  6044                                    EN-PROCESS-DT
  6045
  6046     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6047     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6048     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6049     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6050     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6051     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6052     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6053     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6054     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6055     IF OC-LF-BENCD NOT = '00' AND '  '
  6056        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6057        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6058        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6059        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6060        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6061        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6062        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6063     END-IF
  6064     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6065     IF OC-AH-BENCD NOT = '00' AND '  '
  6066        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6067        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6068        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6069        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 107
* EL6317.cbl
  6070        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6071        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6072     END-IF
  6073     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6074
  6075     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6076         display 'from el1273, using crto for new crto'
  6077
  6078        MOVE OC-INS-FIRST-NAME    TO EN-INS-NEW-FIRST-NAME
  6079                                     NCRTO-INS-FIRST-NAME
  6080        MOVE OC-INS-MIDDLE-INIT   TO EN-INS-NEW-MIDDLE-INIT
  6081                                     NCRTO-INS-MIDDLE-INIT
  6082        MOVE OC-INS-LAST-NAME     TO EN-INS-NEW-LAST-NAME
  6083                                     NCRTO-INS-LAST-NAME
  6084        MOVE OC-INS-AGE           TO EN-INS-NEW-AGE
  6085                                     NCRTO-INS-AGE
  6086        MOVE OC-JNT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6087                                     NCRTO-JNT-FIRST-NAME
  6088        MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6089                                     NCRTO-JNT-MIDDLE-INIT
  6090        MOVE OC-JNT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6091                                     NCRTO-JNT-LAST-NAME
  6092        MOVE OC-JNT-AGE           TO EN-JNT-NEW-AGE
  6093                                     NCRTO-JNT-AGE
  6094        MOVE OC-LF-BENCD          TO EN-LF-NEW-BENCD
  6095                                     NCRTO-LF-BENCD
  6096        IF OC-LF-BENCD NOT = '00' AND '  '
  6097           MOVE OC-LF-BEN-AMT       TO EN-LF-NEW-BEN-AMT
  6098                                       NCRTO-LF-BEN-AMT
  6099           MOVE OC-LF-PRM-AMT       TO EN-LF-NEW-PRM-AMT
  6100                                       NCRTO-LF-PRM-AMT
  6101           MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-NEW-ALT-BEN-AMT
  6102                                       NCRTO-LF-ALT-BEN-AMT
  6103           MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-NEW-ALT-PRM-AMT
  6104                                       NCRTO-LF-ALT-PRM-AMT
  6105           MOVE OC-LF-TERM          TO EN-LF-NEW-TERM
  6106                                       NCRTO-LF-TERM
  6107           MOVE OC-LF-EXP-DT        TO EN-LF-NEW-EXP-DT
  6108                                       NCRTO-LF-EXP-DT
  6109           MOVE OC-LF-COMM-PCT      TO EN-LF-NEW-COMM-PCT
  6110                                       NCRTO-LF-COMM-PCT
  6111           MOVE OC-LF-CANCEL-DT     TO NCRTO-LF-CANCEL-DT
  6112           MOVE OC-LF-CANCEL-AMT    TO NCRTO-LF-CANCEL-AMT
  6113           MOVE OC-LF-ITD-CANCEL-AMT TO NCRTO-LF-ITD-CANCEL-AMT
  6114        END-IF
  6115        MOVE OC-AH-BENCD          TO EN-AH-NEW-BENCD
  6116                                     NCRTO-AH-BENCD
  6117        IF OC-AH-BENCD NOT = '00' AND '  '
  6118           MOVE OC-AH-BEN-AMT       TO EN-AH-NEW-BEN-AMT
  6119                                       NCRTO-AH-BEN-AMT
  6120           MOVE OC-AH-PRM-AMT       TO EN-AH-NEW-PRM-AMT
  6121                                       NCRTO-AH-PRM-AMT
  6122           MOVE OC-AH-TERM          TO EN-AH-NEW-TERM
  6123                                       NCRTO-AH-TERM
  6124           MOVE OC-AH-EXP-DT        TO EN-AH-NEW-EXP-DT
  6125                                       NCRTO-AH-EXP-DT
  6126           MOVE OC-AH-CP            TO EN-AH-NEW-CP
  6127                                       NCRTO-AH-CP
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 108
* EL6317.cbl
  6128           MOVE OC-AH-COMM-PCT      TO EN-AH-NEW-COMM-PCT
  6129                                       NCRTO-AH-COMM-PCT
  6130           MOVE OC-AH-CANCEL-DT     TO NCRTO-AH-CANCEL-DT
  6131           MOVE OC-AH-CANCEL-AMT    TO NCRTO-AH-CANCEL-AMT
  6132           MOVE OC-AH-ITD-CANCEL-AMT TO NCRTO-AH-ITD-CANCEL-AMT
  6133        END-IF
  6134        MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6135                                       NCRTO-CRED-BENE-NAME
  6136
  6137        GO TO 0400-WRITE-ENDT
  6138     END-IF
  6139
  6140* EXEC CICS GETMAIN
  6141*         SET      (ADDRESS OF PENDING-BUSINESS)
  6142*         LENGTH   (ERPNDB-LENGTH)
  6143*         INITIMG  (GETMAIN-SPACE)
  6144*    END-EXEC
  6145*    MOVE ',"IL                  $   #00006003' TO DFHEIV0
  6146     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6147     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6148     MOVE X'2020233030303036303033' TO DFHEIV0(25:11)
  6149     CALL 'kxdfhei1' USING DFHEIV0,
  6150           DFHEIV20,
  6151           ERPNDB-LENGTH,
  6152           GETMAIN-SPACE
  6153     SET ADDRESS OF PENDING-BUSINESS TO
  6154         DFHEIV20
  6155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6156     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6157     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6158
  6159* EXEC CICS READ
  6160*        DATASET   (WS-ERPNDB-FILE-ID)
  6161*        INTO      (PENDING-BUSINESS)
  6162*        RIDFLD    (ERPNDB-KEY)
  6163*        RESP      (WS-RESPONSE)
  6164*    END-EXEC
  6165     MOVE LENGTH OF
  6166      PENDING-BUSINESS
  6167       TO DFHEIV11
  6168*    MOVE '&"IL       E          (  N#00006010' TO DFHEIV0
  6169     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6170     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6171     MOVE X'204E233030303036303130' TO DFHEIV0(25:11)
  6172     CALL 'kxdfhei1' USING DFHEIV0,
  6173           WS-ERPNDB-FILE-ID,
  6174           PENDING-BUSINESS,
  6175           DFHEIV11,
  6176           ERPNDB-KEY,
  6177           DFHEIV99,
  6178           DFHEIV99,
  6179           DFHEIV99
  6180     MOVE EIBRESP  TO WS-RESPONSE
  6181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6182     IF NOT RESP-NORMAL
  6183        GO TO 0400-EXIT
  6184     END-IF
  6185*    set found-pndb to true
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 109
* EL6317.cbl
  6186     display ' good read on erpndb '
  6187     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6188                                      NCRTO-INS-FIRST-NAME
  6189     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6190                                      NCRTO-INS-MIDDLE-INIT
  6191     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6192                                      NCRTO-INS-LAST-NAME
  6193     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6194                                      NCRTO-INS-AGE
  6195     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6196                                      NCRTO-JNT-FIRST-NAME
  6197     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6198                                      NCRTO-JNT-MIDDLE-INIT
  6199     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6200                                      NCRTO-JNT-LAST-NAME
  6201     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6202                                      NCRTO-JNT-AGE
  6203     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6204                                      NCRTO-LF-BENCD
  6205     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  6206        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6207                                      NCRTO-LF-BEN-AMT
  6208        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6209                                      NCRTO-LF-PRM-AMT
  6210        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6211                                      NCRTO-LF-ALT-BEN-AMT
  6212        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6213                                      NCRTO-LF-ALT-PRM-AMT
  6214        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6215                                      NCRTO-LF-TERM
  6216        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6217                                      NCRTO-LF-EXP-DT
  6218        IF PB-I-JOINT-COMMISSION > +0
  6219           MOVE PB-I-JOINT-COMMISSION
  6220                                   TO EN-LF-NEW-COMM-PCT
  6221                                      NCRTO-LF-COMM-PCT
  6222        ELSE
  6223           MOVE PB-I-LIFE-COMMISSION
  6224                                   TO EN-LF-NEW-COMM-PCT
  6225                                      NCRTO-LF-COMM-PCT
  6226        MOVE LOW-VALUES            TO NCRTO-LF-CANCEL-DT
  6227        MOVE +0                    TO NCRTO-LF-CANCEL-AMT
  6228                                      NCRTO-LF-ITD-CANCEL-AMT
  6229        END-IF
  6230     END-IF
  6231     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6232                                      NCRTO-AH-BENCD
  6233     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6234        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6235                                      NCRTO-AH-BEN-AMT
  6236        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6237                                      NCRTO-AH-PRM-AMT
  6238        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6239                                      NCRTO-AH-TERM
  6240        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6241                                      NCRTO-AH-EXP-DT
  6242        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6243                                      NCRTO-AH-CP
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 110
* EL6317.cbl
  6244        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6245                                      NCRTO-AH-COMM-PCT
  6246        MOVE LOW-VALUES            TO NCRTO-AH-CANCEL-DT
  6247        MOVE +0                    TO NCRTO-AH-CANCEL-AMT
  6248                                      NCRTO-AH-ITD-CANCEL-AMT
  6249     END-IF
  6250     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6251     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6252     move pb-control-by-account (1:33)
  6253                                 to ws-ermail-key
  6254
  6255* EXEC CICS READ
  6256*        DATASET   ('ERMAIL')
  6257*        SET       (ADDRESS OF MAILING-DATA)
  6258*        RIDFLD    (WS-ERMAIL-KEY)
  6259*        RESP      (WS-RESPONSE)
  6260*    END-EXEC
  6261     MOVE 'ERMAIL' TO DFHEIV1
  6262*    MOVE '&"S        E          (  N#00006088' TO DFHEIV0
  6263     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6265     MOVE X'204E233030303036303838' TO DFHEIV0(25:11)
  6266     CALL 'kxdfhei1' USING DFHEIV0,
  6267           DFHEIV1,
  6268           DFHEIV20,
  6269           DFHEIV99,
  6270           WS-ERMAIL-KEY,
  6271           DFHEIV99,
  6272           DFHEIV99,
  6273           DFHEIV99
  6274     SET ADDRESS OF MAILING-DATA TO
  6275         DFHEIV20
  6276     MOVE EIBRESP  TO WS-RESPONSE
  6277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6278     IF RESP-NORMAL
  6279        DISPLAY ' FOUND ERMAIL '
  6280        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6281                                    NCRTO-CRED-BENE-NAME
  6282     ELSE
  6283        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6284     END-IF
  6285      .
  6286 0400-WRITE-ENDT.
  6287
  6288     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6289        IF REACD-IN (S1) NOT = LOW-VALUES
  6290           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6291        END-IF
  6292     END-PERFORM
  6293     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6294     MOVE 'V'                    TO EN-DOCU-TYPE
  6295     MOVE ' '                    TO EN-MONEY-SW
  6296     MOVE SIGREQI                TO EN-SIG-SW
  6297     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6298     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6299     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6300*    IF NOT EMI-NO-ERRORS
  6301*       DISPLAY ' GOING TO 8200 FROM 0400 '
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 111
* EL6317.cbl
  6302*       GO TO 8200-SEND-DATAONLY
  6303*    END-IF
  6304     DISPLAY ' 0400 EXIT '
  6305     .
  6306 0400-EXIT.
  6307     EXIT.
  6308 0410-INIT-ERENDT.
  6309     display ' made it to 0410 '
  6310     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6311     MOVE ZEROS                  TO ENDT-SEQ-NO
  6312
  6313* EXEC CICS READ
  6314*        DATASET    (WS-ERENDT-FILE-ID)
  6315*        RIDFLD     (ERENDT-KEY)
  6316*        INTO       (ENDORSEMENT-RECORD)
  6317*        RESP       (WS-RESPONSE)
  6318*        GTEQ
  6319*    END-EXEC
  6320     MOVE LENGTH OF
  6321      ENDORSEMENT-RECORD
  6322       TO DFHEIV11
  6323*    MOVE '&"IL       G          (  N#00006128' TO DFHEIV0
  6324     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6326     MOVE X'204E233030303036313238' TO DFHEIV0(25:11)
  6327     CALL 'kxdfhei1' USING DFHEIV0,
  6328           WS-ERENDT-FILE-ID,
  6329           ENDORSEMENT-RECORD,
  6330           DFHEIV11,
  6331           ERENDT-KEY,
  6332           DFHEIV99,
  6333           DFHEIV99,
  6334           DFHEIV99
  6335     MOVE EIBRESP  TO WS-RESPONSE
  6336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6337     IF RESP-NORMAL
  6338        AND (EN-CONTROL-PRIMARY (1:34) =
  6339           OC-CONTROL-PRIMARY (1:34))
  6340        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6341     ELSE
  6342        MOVE +4096               TO WS-SEQ-NO
  6343     END-IF
  6344     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6345     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6346     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6347     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6348     INITIALIZE EN-ISSUE-RECORD
  6349     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6350                                    EN-AH-ORIG-EXP-DT
  6351                                    EN-LF-NEW-EXP-DT
  6352                                    EN-AH-NEW-EXP-DT
  6353                                    EN-PROCESS-DT
  6354     .
  6355 0410-EXIT.
  6356     EXIT.
  6357 0420-UPDATE-ELCRTO.
  6358     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6359     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 112
* EL6317.cbl
  6360        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6361                                    OC-LAST-MAINT-DT
  6362        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6363        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6364
  6365* EXEC CICS REWRITE
  6366*          FROM     (ORIGINAL-CERTIFICATE)
  6367*          DATASET  ('ELCRTO')
  6368*       END-EXEC
  6369     MOVE LENGTH OF
  6370      ORIGINAL-CERTIFICATE
  6371       TO DFHEIV11
  6372     MOVE 'ELCRTO' TO DFHEIV1
  6373*    MOVE '&& L                  %   #00006162' TO DFHEIV0
  6374     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6375     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6376     MOVE X'2020233030303036313632' TO DFHEIV0(25:11)
  6377     CALL 'kxdfhei1' USING DFHEIV0,
  6378           DFHEIV1,
  6379           ORIGINAL-CERTIFICATE,
  6380           DFHEIV11,
  6381           DFHEIV99
  6382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6383     END-IF
  6384     .
  6385 0420-EXIT.
  6386     EXIT.
  6387
  6388 0425-ADD-NEW-ELCRTO.
  6389     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6390     MOVE 'OC'                   TO OC-RECORD-ID
  6391     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6392     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6393     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6394     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6395     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6396     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6397     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6398     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6399     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6400     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6401     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6402     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  6403     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6404     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6405     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6406     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6407     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6408     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6409     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6410     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6411     MOVE NCRTO-LF-CANCEL-DT     TO OC-LF-CANCEL-DT
  6412     MOVE NCRTO-LF-CANCEL-AMT    TO OC-LF-CANCEL-AMT
  6413     MOVE NCRTO-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
  6414     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6415     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6416     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6417     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 113
* EL6317.cbl
  6418     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6419     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6420     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6421     MOVE NCRTO-AH-CANCEL-DT     TO OC-AH-CANCEL-DT
  6422     MOVE NCRTO-AH-CANCEL-AMT    TO OC-AH-CANCEL-AMT
  6423     MOVE NCRTO-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
  6424     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6425     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6426     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6427     .
  6428 0425-WRITE-ELCRTO.
  6429
  6430
  6431* EXEC CICS WRITE
  6432*       DATASET   ('ELCRTO')
  6433*       FROM      (ORIGINAL-CERTIFICATE)
  6434*       RIDFLD    (OC-CONTROL-PRIMARY)
  6435*       RESP      (WS-RESPONSE)
  6436*    END-EXEC
  6437     MOVE LENGTH OF
  6438      ORIGINAL-CERTIFICATE
  6439       TO DFHEIV11
  6440     MOVE 'ELCRTO' TO DFHEIV1
  6441*    MOVE '&$ L                  ''  N#00006213' TO DFHEIV0
  6442     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6443     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6444     MOVE X'204E233030303036323133' TO DFHEIV0(25:11)
  6445     CALL 'kxdfhei1' USING DFHEIV0,
  6446           DFHEIV1,
  6447           ORIGINAL-CERTIFICATE,
  6448           DFHEIV11,
  6449           OC-CONTROL-PRIMARY,
  6450           DFHEIV99,
  6451           DFHEIV99
  6452     MOVE EIBRESP  TO WS-RESPONSE
  6453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6454
  6455     display ' just wrote new crto ' ws-response
  6456                           ' ' oc-key-seq-no
  6457     IF RESP-DUPKEY
  6458        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6459        GO TO 0425-WRITE-ELCRTO
  6460     ELSE
  6461        IF NOT RESP-NORMAL
  6462           MOVE -1               TO SIGREQL
  6463           MOVE ER-3830          TO EMI-ERROR
  6464           PERFORM 9900-ERROR-FORMAT
  6465                                 THRU 9900-EXIT
  6466        ELSE
  6467           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6468        END-IF
  6469     END-IF
  6470
  6471     .
  6472 0425-EXIT.
  6473     EXIT.
  6474
  6475 0426-ADD-CERT-NOTES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 114
* EL6317.cbl
  6476
  6477     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6478     SET TB-INDX TO 1
  6479
  6480     IF PI-CERTNT1-ENTERED > SPACES
  6481         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6482         MOVE PI-PROCESSOR-ID    TO
  6483                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6484         MOVE EIBTIME            TO
  6485                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6486         MOVE WS-CURRENT-BIN-DT  TO
  6487                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6488         SET TB-INDX UP BY +1
  6489     END-IF
  6490
  6491     IF PI-CERTNT2-ENTERED > SPACES
  6492         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6493         MOVE PI-PROCESSOR-ID    TO
  6494                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6495         MOVE EIBTIME            TO
  6496                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6497         MOVE WS-CURRENT-BIN-DT  TO
  6498                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6499         SET TB-INDX UP BY +1
  6500     END-IF
  6501
  6502     IF CERT-NOTE-ENTRIES > SPACES
  6503         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6504         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6505     END-IF
  6506
  6507     .
  6508 0426-EXIT.
  6509     EXIT.
  6510
  6511 0427-LOAD-CURRENT-CERT-NOTES.
  6512
  6513     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6514     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6515     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6516     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6517     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6518     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6519     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6520     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6521     MOVE '1'                 TO ERCNOT-REC-TYP
  6522     MOVE +0                  TO ERCNOT-SEQ
  6523     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6524
  6525
  6526* EXEC CICS STARTBR
  6527*         DATASET(WS-ERCNOT-FILE-ID)
  6528*         RIDFLD(ERCNOT-KEY)
  6529*         KEYLENGTH(ERCNOT-START-LENGTH)
  6530*         RESP      (WS-RESPONSE)
  6531*         GENERIC
  6532*         GTEQ
  6533*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 115
* EL6317.cbl
  6534     MOVE 0
  6535       TO DFHEIV11
  6536*    MOVE '&,   KG    G          &  N#00006290' TO DFHEIV0
  6537     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6538     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6539     MOVE X'204E233030303036323930' TO DFHEIV0(25:11)
  6540     CALL 'kxdfhei1' USING DFHEIV0,
  6541           WS-ERCNOT-FILE-ID,
  6542           ERCNOT-KEY,
  6543           ERCNOT-START-LENGTH,
  6544           DFHEIV11,
  6545           DFHEIV99
  6546     MOVE EIBRESP  TO WS-RESPONSE
  6547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6548
  6549
  6550     IF NOT RESP-NORMAL
  6551        GO TO 0427-ENDBR
  6552     END-IF.
  6553
  6554 0427-LOOP.
  6555
  6556* EXEC CICS READNEXT
  6557*         SET(ADDRESS OF CERT-NOTE-FILE)
  6558*         DATASET(WS-ERCNOT-FILE-ID)
  6559*         RIDFLD(ERCNOT-KEY)
  6560*    END-EXEC.
  6561     MOVE 0
  6562       TO DFHEIV11
  6563*    MOVE '&.S                   )   #00006304' TO DFHEIV0
  6564     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6565     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6566     MOVE X'2020233030303036333034' TO DFHEIV0(25:11)
  6567     CALL 'kxdfhei1' USING DFHEIV0,
  6568           WS-ERCNOT-FILE-ID,
  6569           DFHEIV20,
  6570           DFHEIV99,
  6571           ERCNOT-KEY,
  6572           DFHEIV99,
  6573           DFHEIV11,
  6574           DFHEIV99,
  6575           DFHEIV99
  6576     SET ADDRESS OF CERT-NOTE-FILE TO
  6577         DFHEIV20
  6578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6579
  6580
  6581     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6582         GO TO 0427-ENDBR
  6583     END-IF.
  6584
  6585     IF (CZ-CARRIER = SV-CARRIER)
  6586        AND (CZ-GROUPING = SV-GROUPING)
  6587        AND (CZ-STATE = SV-STATE)
  6588        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6589        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6590        AND (CZ-CERT-NO = SV-CERT-NO)
  6591        AND (CZ-RECORD-TYPE = '1')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 116
* EL6317.cbl
  6592          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6593          MOVE CZ-LAST-MAINT-USER TO
  6594                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6595          MOVE CZ-LAST-MAINT-DT TO
  6596                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6597          MOVE CZ-LAST-MAINT-HHMMSS TO
  6598                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6599          SET TB-INDX UP BY 1
  6600          GO TO 0427-LOOP
  6601     END-IF.
  6602
  6603 0427-ENDBR.
  6604
  6605
  6606* EXEC CICS ENDBR
  6607*         DATASET(WS-ERCNOT-FILE-ID)
  6608*    END-EXEC.
  6609     MOVE 0
  6610       TO DFHEIV11
  6611*    MOVE '&2                    $   #00006334' TO DFHEIV0
  6612     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6613     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6614     MOVE X'2020233030303036333334' TO DFHEIV0(25:11)
  6615     CALL 'kxdfhei1' USING DFHEIV0,
  6616           WS-ERCNOT-FILE-ID,
  6617           DFHEIV11,
  6618           DFHEIV99
  6619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6620
  6621
  6622     .
  6623 0427-EXIT.
  6624     EXIT.
  6625
  6626 0430-WRITE-ERENDT.
  6627     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6628     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6629     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6630
  6631* EXEC CICS WRITE
  6632*         DATASET   (WS-ERENDT-FILE-ID)
  6633*         FROM      (ENDORSEMENT-RECORD)
  6634*         RIDFLD    (EN-CONTROL-PRIMARY)
  6635*         RESP      (WS-RESPONSE)
  6636*    END-EXEC
  6637     MOVE LENGTH OF
  6638      ENDORSEMENT-RECORD
  6639       TO DFHEIV11
  6640*    MOVE '&$ L                  ''  N#00006346' TO DFHEIV0
  6641     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6642     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6643     MOVE X'204E233030303036333436' TO DFHEIV0(25:11)
  6644     CALL 'kxdfhei1' USING DFHEIV0,
  6645           WS-ERENDT-FILE-ID,
  6646           ENDORSEMENT-RECORD,
  6647           DFHEIV11,
  6648           EN-CONTROL-PRIMARY,
  6649           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 117
* EL6317.cbl
  6650           DFHEIV99
  6651     MOVE EIBRESP  TO WS-RESPONSE
  6652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6653     IF RESP-NORMAL
  6654        MOVE 'V'                 TO PI-DOCUMENT-PROCESSED
  6655        display ' good write erendt '
  6656        IF EIBAID = DFHPF2
  6657           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6658           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6659           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6660           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6661        END-IF
  6662     ELSE
  6663        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6664        MOVE -1                  TO CARRL
  6665        MOVE ER-0132             TO EMI-ERROR
  6666        MOVE AL-UABON            TO CARRA
  6667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6668     END-IF
  6669     .
  6670 0430-EXIT.
  6671     EXIT.
  6672 0440-ADD-BILLING-NOTE.
  6673     DISPLAY 'ADD BILLING NOTE'
  6674
  6675* EXEC CICS GETMAIN
  6676*         SET      (ADDRESS OF EOB-CODES)
  6677*         LENGTH   (ELEOBC-LENGTH)
  6678*         INITIMG  (GETMAIN-SPACE)
  6679*    END-EXEC
  6680*    MOVE ',"IL                  $   #00006373' TO DFHEIV0
  6681     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6682     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6683     MOVE X'2020233030303036333733' TO DFHEIV0(25:11)
  6684     CALL 'kxdfhei1' USING DFHEIV0,
  6685           DFHEIV20,
  6686           ELEOBC-LENGTH,
  6687           GETMAIN-SPACE
  6688     SET ADDRESS OF EOB-CODES TO
  6689         DFHEIV20
  6690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6691
  6692     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6693     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6694     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6695
  6696
  6697* EXEC CICS STARTBR
  6698*        DATASET   ('ELEOBC')
  6699*        RIDFLD    (WS-ELEOBC-KEY)
  6700*        GTEQ
  6701*        RESP      (WS-RESPONSE)
  6702*    END-EXEC
  6703     MOVE 'ELEOBC' TO DFHEIV1
  6704     MOVE 0
  6705       TO DFHEIV11
  6706*    MOVE '&,         G          &  N#00006383' TO DFHEIV0
  6707     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 118
* EL6317.cbl
  6708     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6709     MOVE X'204E233030303036333833' TO DFHEIV0(25:11)
  6710     CALL 'kxdfhei1' USING DFHEIV0,
  6711           DFHEIV1,
  6712           WS-ELEOBC-KEY,
  6713           DFHEIV99,
  6714           DFHEIV11,
  6715           DFHEIV99
  6716     MOVE EIBRESP  TO WS-RESPONSE
  6717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6718
  6719     IF NOT RESP-NORMAL
  6720        GO TO 0440-EXIT
  6721     END-IF
  6722      .
  6723 0440-READNEXT-ELEOBC.
  6724
  6725
  6726* EXEC CICS READNEXT
  6727*       INTO    (EOB-CODES)
  6728*       DATASET ('ELEOBC')
  6729*       RIDFLD  (WS-ELEOBC-KEY)
  6730*       RESP    (WS-RESPONSE)
  6731*    END-EXEC
  6732     MOVE LENGTH OF
  6733      EOB-CODES
  6734       TO DFHEIV12
  6735     MOVE 'ELEOBC' TO DFHEIV1
  6736     MOVE 0
  6737       TO DFHEIV11
  6738*    MOVE '&.IL                  )  N#00006396' TO DFHEIV0
  6739     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6740     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6741     MOVE X'204E233030303036333936' TO DFHEIV0(25:11)
  6742     CALL 'kxdfhei1' USING DFHEIV0,
  6743           DFHEIV1,
  6744           EOB-CODES,
  6745           DFHEIV12,
  6746           WS-ELEOBC-KEY,
  6747           DFHEIV99,
  6748           DFHEIV11,
  6749           DFHEIV99,
  6750           DFHEIV99
  6751     MOVE EIBRESP  TO WS-RESPONSE
  6752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6753
  6754     IF RESP-NORMAL
  6755         IF EO-RECORD-TYPE NOT = '5'
  6756             GO TO 0440-EXIT
  6757         END-IF
  6758     ELSE
  6759         GO TO 0440-EXIT
  6760     END-IF
  6761
  6762     IF EO-RECORD-TYPE = '5' AND
  6763        EO-EOB-CODE = PI-LTRID-ENTERED
  6764           CONTINUE
  6765     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 119
* EL6317.cbl
  6766         GO TO 0440-READNEXT-ELEOBC
  6767     END-IF
  6768
  6769     DISPLAY 'FOUND BILL NOTE ' EOB-CODES
  6770     MOVE SPACES TO WS-BILLING-NOTE
  6771     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6772     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6773     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6774     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6775
  6776
  6777* EXEC CICS GETMAIN
  6778*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6779*         LENGTH   (ERNOTE-LENGTH)
  6780*         INITIMG  (GETMAIN-SPACE)
  6781*    END-EXEC
  6782*    MOVE ',"IL                  $   #00006425' TO DFHEIV0
  6783     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6784     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6785     MOVE X'2020233030303036343235' TO DFHEIV0(25:11)
  6786     CALL 'kxdfhei1' USING DFHEIV0,
  6787           DFHEIV20,
  6788           ERNOTE-LENGTH,
  6789           GETMAIN-SPACE
  6790     SET ADDRESS OF CERTIFICATE-NOTE TO
  6791         DFHEIV20
  6792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6793
  6794     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  6795
  6796
  6797* EXEC CICS READ
  6798*       DATASET    (WS-ERNOTE-FILE-ID)
  6799*       RIDFLD     (WS-ERNOTE-KEY)
  6800*       INTO       (CERTIFICATE-NOTE)
  6801*       RESP       (WS-RESPONSE)
  6802*       UPDATE
  6803*    END-EXEC
  6804     MOVE LENGTH OF
  6805      CERTIFICATE-NOTE
  6806       TO DFHEIV11
  6807*    MOVE '&"IL       EU         (  N#00006433' TO DFHEIV0
  6808     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6809     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6810     MOVE X'204E233030303036343333' TO DFHEIV0(25:11)
  6811     CALL 'kxdfhei1' USING DFHEIV0,
  6812           WS-ERNOTE-FILE-ID,
  6813           CERTIFICATE-NOTE,
  6814           DFHEIV11,
  6815           WS-ERNOTE-KEY,
  6816           DFHEIV99,
  6817           DFHEIV99,
  6818           DFHEIV99
  6819     MOVE EIBRESP  TO WS-RESPONSE
  6820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6821
  6822     IF RESP-NORMAL
  6823       IF CN-BILLING-START-LINE-NO NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 120
* EL6317.cbl
  6824          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  6825       END-IF
  6826       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  6827          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  6828       END-IF
  6829       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6830           (NOTE-SUB > +10) OR
  6831           (CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE)
  6832       END-PERFORM
  6833       IF CN-LINE (NOTE-SUB) (1:20) = WS-BN-NOTE
  6834
  6835* EXEC CICS UNLOCK
  6836*           DATASET    (WS-ERNOTE-FILE-ID)
  6837*        END-EXEC
  6838*    MOVE '&*                    #   #00006453' TO DFHEIV0
  6839     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  6840     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6841     MOVE X'2020233030303036343533' TO DFHEIV0(25:11)
  6842     CALL 'kxdfhei1' USING DFHEIV0,
  6843           WS-ERNOTE-FILE-ID,
  6844           DFHEIV99
  6845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6846       ELSE
  6847         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  6848           (NOTE-SUB > +10) OR
  6849           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  6850         END-PERFORM
  6851         IF (NOTE-SUB < +11)
  6852           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  6853              NOTE-SUB <= CN-BILLING-END-LINE-NO
  6854                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6855           ELSE
  6856             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  6857              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  6858                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  6859                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  6860             ELSE
  6861               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  6862                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  6863                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  6864                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  6865               ELSE
  6866                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  6867                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  6868                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  6869                                       CN-BILLING-START-LINE-NO
  6870                 ELSE
  6871                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  6872                 END-IF
  6873               END-IF
  6874             END-IF
  6875           END-IF
  6876           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6877           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6878           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6879
  6880* EXEC CICS REWRITE
  6881*             DATASET    (WS-ERNOTE-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 121
* EL6317.cbl
  6882*             FROM       (CERTIFICATE-NOTE)
  6883*             RESP       (WS-RESPONSE)
  6884*          END-EXEC
  6885     MOVE LENGTH OF
  6886      CERTIFICATE-NOTE
  6887       TO DFHEIV11
  6888*    MOVE '&& L                  %  N#00006489' TO DFHEIV0
  6889     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6890     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6891     MOVE X'204E233030303036343839' TO DFHEIV0(25:11)
  6892     CALL 'kxdfhei1' USING DFHEIV0,
  6893           WS-ERNOTE-FILE-ID,
  6894           CERTIFICATE-NOTE,
  6895           DFHEIV11,
  6896           DFHEIV99
  6897     MOVE EIBRESP  TO WS-RESPONSE
  6898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6899           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6900         END-IF
  6901       END-IF
  6902     ELSE
  6903        MOVE SPACES              TO CERTIFICATE-NOTE
  6904        MOVE 'CN'                TO CN-RECORD-ID
  6905        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  6906                                     WS-ERNOTE-KEY
  6907        MOVE 01                  TO CN-BILLING-START-LINE-NO
  6908                                    CN-BILLING-END-LINE-NO
  6909        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  6910        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  6911        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  6912        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  6913
  6914* EXEC CICS WRITE
  6915*          DATASET    (WS-ERNOTE-FILE-ID)
  6916*          FROM       (CERTIFICATE-NOTE)
  6917*          RIDFLD     (WS-ERNOTE-KEY)
  6918*          RESP       (WS-RESPONSE)
  6919*       END-EXEC
  6920     MOVE LENGTH OF
  6921      CERTIFICATE-NOTE
  6922       TO DFHEIV11
  6923*    MOVE '&$ L                  ''  N#00006508' TO DFHEIV0
  6924     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6926     MOVE X'204E233030303036353038' TO DFHEIV0(25:11)
  6927     CALL 'kxdfhei1' USING DFHEIV0,
  6928           WS-ERNOTE-FILE-ID,
  6929           CERTIFICATE-NOTE,
  6930           DFHEIV11,
  6931           WS-ERNOTE-KEY,
  6932           DFHEIV99,
  6933           DFHEIV99
  6934     MOVE EIBRESP  TO WS-RESPONSE
  6935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6936
  6937        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  6938     END-IF
  6939
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 122
* EL6317.cbl
  6940     .
  6941 0440-EXIT.
  6942     EXIT.
  6943
  6944
  6945 0442-SQUEEZE-IT-IN.
  6946
  6947     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  6948        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  6949           NOTE-SUB = +10
  6950           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  6951           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  6952             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  6953             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  6954             MOVE +9 TO NOTE-SUB
  6955           END-IF
  6956        END-PERFORM
  6957     ELSE
  6958        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  6959           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  6960             UNTIL NOTE-SUB = +1
  6961             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  6962             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  6963                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  6964                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  6965                MOVE +2          TO NOTE-SUB
  6966             END-IF
  6967           END-PERFORM
  6968        END-IF
  6969     END-IF
  6970
  6971     .
  6972 0442-EXIT.
  6973     EXIT.
  6974
  6975 0445-CERTIFICATE-UPDATE.
  6976    display 'billing note written, updating cert'
  6977     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  6978     IF RESP-NORMAL
  6979        EVALUATE CM-NOTE-SW
  6980           WHEN '2'
  6981           WHEN '3'
  6982           WHEN '6'
  6983           WHEN '7'
  6984              SET NO-CERT-RW     TO TRUE
  6985           WHEN ' '
  6986              MOVE '2'           TO CM-NOTE-SW
  6987           WHEN '1'
  6988              MOVE '3'           TO CM-NOTE-SW
  6989           WHEN '4'
  6990              MOVE '6'           TO CM-NOTE-SW
  6991           WHEN '5'
  6992              MOVE '7'           TO CM-NOTE-SW
  6993        END-EVALUATE
  6994     END-IF
  6995     IF NOT NO-CERT-RW
  6996        PERFORM 1810-REWRITE-ELCERT
  6997                                 THRU 1810-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 123
* EL6317.cbl
  6998     ELSE
  6999
  7000* EXEC CICS UNLOCK
  7001*          DATASET    (WS-ELCERT-FILE-ID)
  7002*       END-EXEC
  7003*    MOVE '&*                    #   #00006577' TO DFHEIV0
  7004     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7005     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7006     MOVE X'2020233030303036353737' TO DFHEIV0(25:11)
  7007     CALL 'kxdfhei1' USING DFHEIV0,
  7008           WS-ELCERT-FILE-ID,
  7009           DFHEIV99
  7010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7011     END-IF
  7012
  7013     .
  7014 0445-EXIT.
  7015     EXIT.
  7016
  7017 0500-CREATE-TEMP-STORAGE.
  7018     display ' about to write pi ' program-interface-block
  7019
  7020* EXEC CICS WRITEQ TS
  7021*        QUEUE (QID)
  7022*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7023*        LENGTH(PI-COMM-LENGTH)
  7024*    END-EXEC
  7025*    MOVE '*"                    ''   #00006588' TO DFHEIV0
  7026     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7027     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7028     MOVE X'2020233030303036353838' TO DFHEIV0(25:11)
  7029     CALL 'kxdfhei1' USING DFHEIV0,
  7030           QID,
  7031           PROGRAM-INTERFACE-BLOCK,
  7032           PI-COMM-LENGTH,
  7033           DFHEIV99,
  7034           DFHEIV99,
  7035           DFHEIV99
  7036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7037     display ' about to write map ' el631ji
  7038
  7039* EXEC CICS WRITEQ TS
  7040*        QUEUE (QID)
  7041*        FROM  (EL631JI)
  7042*        LENGTH(MAP-LENGTH)
  7043*    END-EXEC.
  7044*    MOVE '*"                    ''   #00006594' TO DFHEIV0
  7045     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7046     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7047     MOVE X'2020233030303036353934' TO DFHEIV0(25:11)
  7048     CALL 'kxdfhei1' USING DFHEIV0,
  7049           QID,
  7050           EL631JI,
  7051           MAP-LENGTH,
  7052           DFHEIV99,
  7053           DFHEIV99,
  7054           DFHEIV99
  7055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 124
* EL6317.cbl
  7056
  7057 0500-EXIT.
  7058      EXIT.
  7059 0600-RECOVER-TEMP-STORAGE.
  7060     display ' about to recover pi '
  7061
  7062* EXEC CICS READQ TS
  7063*        QUEUE (QID)
  7064*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7065*        LENGTH(PI-COMM-LENGTH)
  7066*    END-EXEC
  7067*    MOVE '*$I    L              ''   #00006603' TO DFHEIV0
  7068     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7069     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7070     MOVE X'2020233030303036363033' TO DFHEIV0(25:11)
  7071     CALL 'kxdfhei1' USING DFHEIV0,
  7072           QID,
  7073           PROGRAM-INTERFACE-BLOCK,
  7074           PI-COMM-LENGTH,
  7075           DFHEIV99,
  7076           DFHEIV99,
  7077           DFHEIV99
  7078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7079     display ' pi ' pi-program-work-area
  7080     display ' about to recover map '
  7081
  7082* EXEC CICS READQ TS
  7083*        QUEUE (QID)
  7084*        INTO  (EL631JI)
  7085*        LENGTH(MAP-LENGTH)
  7086*    END-EXEC
  7087*    MOVE '*$I    L              ''   #00006610' TO DFHEIV0
  7088     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7089     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7090     MOVE X'2020233030303036363130' TO DFHEIV0(25:11)
  7091     CALL 'kxdfhei1' USING DFHEIV0,
  7092           QID,
  7093           EL631JI,
  7094           MAP-LENGTH,
  7095           DFHEIV99,
  7096           DFHEIV99,
  7097           DFHEIV99
  7098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7099     display ' map ' el631ji
  7100     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7101     MOVE AL-UANON            TO SIGREQA
  7102     MOVE AL-UANON            TO LTRIDA
  7103     IF WS-SET-CODES-MDT = 'Y'
  7104        move +1                  to s2
  7105        perform varying s1 from +1 by +5 until s1 > +60
  7106           MOVE WS-PASSED-REASON-CODES (s1:4)
  7107                                 TO reacd-in (s2)
  7108           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7109               MOVE AL-SANON     TO REACDA (S2)
  7110               MOVE +4           TO REACDL (S2)
  7111           END-IF
  7112           add +1                to s2
  7113        end-perform
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 125
* EL6317.cbl
  7114        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7115     END-IF
  7116
  7117     IF CRTNT1I > SPACES
  7118         MOVE AL-UANON       TO CRTNT1A
  7119     END-IF
  7120
  7121     IF CRTNT2I > SPACES
  7122         MOVE AL-UANON       TO CRTNT2A
  7123     END-IF
  7124     .
  7125 0600-EXIT.
  7126      EXIT.
  7127 0800-DELETE-TS.
  7128
  7129* EXEC CICS DELETEQ TS
  7130*        QUEUE(QID)
  7131*    END-EXEC
  7132*    MOVE '*&                    #   #00006644' TO DFHEIV0
  7133     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7134     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7135     MOVE X'2020233030303036363434' TO DFHEIV0(25:11)
  7136     CALL 'kxdfhei1' USING DFHEIV0,
  7137           QID,
  7138           DFHEIV99
  7139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7140     .
  7141 0800-EXIT.
  7142      EXIT.
  7143 1000-BUILD-ERARCH.
  7144     display ' made it to 1000 '
  7145     MOVE SPACES                 TO W-CNTL-KEY
  7146     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7147     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7148     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7149
  7150* EXEC CICS READ
  7151*         DATASET    (WS-ELCNTL-FILE-ID)
  7152*         SET        (ADDRESS OF CONTROL-FILE)
  7153*         RIDFLD     (W-CNTL-KEY)
  7154*         UPDATE
  7155*         RESP       (WS-RESPONSE)
  7156*    END-EXEC
  7157*    MOVE '&"S        EU         (  N#00006656' TO DFHEIV0
  7158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7159     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7160     MOVE X'204E233030303036363536' TO DFHEIV0(25:11)
  7161     CALL 'kxdfhei1' USING DFHEIV0,
  7162           WS-ELCNTL-FILE-ID,
  7163           DFHEIV20,
  7164           DFHEIV99,
  7165           W-CNTL-KEY,
  7166           DFHEIV99,
  7167           DFHEIV99,
  7168           DFHEIV99
  7169     SET ADDRESS OF CONTROL-FILE TO
  7170         DFHEIV20
  7171     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 126
* EL6317.cbl
  7172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7173     IF RESP-NORMAL
  7174        display ' good read elcntl '
  7175        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7176           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7177        END-IF
  7178        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7179        MOVE CF-CREDIT-LAST-ARCH-NUM
  7180                                 TO W-ARCH-NUMBER
  7181
  7182* EXEC CICS REWRITE
  7183*          FROM      (CONTROL-FILE)
  7184*          DATASET   (WS-ELCNTL-FILE-ID)
  7185*       END-EXEC
  7186     MOVE LENGTH OF
  7187      CONTROL-FILE
  7188       TO DFHEIV11
  7189*    MOVE '&& L                  %   #00006671' TO DFHEIV0
  7190     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7191     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7192     MOVE X'2020233030303036363731' TO DFHEIV0(25:11)
  7193     CALL 'kxdfhei1' USING DFHEIV0,
  7194           WS-ELCNTL-FILE-ID,
  7195           CONTROL-FILE,
  7196           DFHEIV11,
  7197           DFHEIV99
  7198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7199     END-IF
  7200
  7201* EXEC CICS GETMAIN
  7202*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7203*       LENGTH   (W-ARCH-LENGTH)
  7204*    END-EXEC
  7205*    MOVE '," L                  $   #00006676' TO DFHEIV0
  7206     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7207     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7208     MOVE X'2020233030303036363736' TO DFHEIV0(25:11)
  7209     CALL 'kxdfhei1' USING DFHEIV0,
  7210           DFHEIV20,
  7211           W-ARCH-LENGTH,
  7212           DFHEIV99
  7213     SET ADDRESS OF LETTER-ARCHIVE TO
  7214         DFHEIV20
  7215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7216     MOVE 'LA'                   TO LETTER-ARCHIVE
  7217     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7218                                    LA-ARCHIVE-NO-A2
  7219                                    LA-ARCHIVE-NO-A3
  7220                                    LA-ARCHIVE-NO-A4
  7221                                    LA-ARCHIVE-NO-A5
  7222                                    LA-ARCHIVE-NO-A6
  7223     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7224                                    LA-COMPANY-CD-A2
  7225                                    LA-COMPANY-CD-A3
  7226                                    LA-COMPANY-CD-A4
  7227                                    LA-COMPANY-CD-A5
  7228                                    LA-COMPANY-CD-A6
  7229     MOVE PB-CARRIER             TO LA-CARRIER-A2
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 127
* EL6317.cbl
  7230                                    LA-CARRIER-A3
  7231                                    LA-CARRIER-A4
  7232                                    LA-CARRIER-A5
  7233     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7234     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7235                                    LA-GROUPING-A3
  7236                                    LA-GROUPING-A4
  7237                                    LA-GROUPING-A5
  7238     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7239                                    LA-ACCOUNT-A3
  7240                                    LA-ACCOUNT-A4
  7241                                    LA-ACCOUNT-A5
  7242     MOVE PB-STATE               TO LA-STATE-A2
  7243                                    LA-STATE-A3
  7244                                    LA-STATE-A4
  7245                                    LA-STATE-A5
  7246     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7247     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7248     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7249     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7250     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7251                                    LA-INITIAL-PRINT-DATE
  7252                                    LA-SENT-DATE
  7253                                    LA-REPLY-DATE
  7254                                    LA-RESEND-DATE
  7255                                    LA-FOLLOW-UP-DATE
  7256     MOVE 'A'                    TO LA-STATUS
  7257     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7258     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7259     MOVE LTRIDI                 TO LA-FORM-A3
  7260     MOVE '4'                    TO LA-DATA-SOURCE
  7261     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7262     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7263                                    LA-NO-OF-TEXT-RECORDS
  7264
  7265* EXEC CICS WRITE
  7266*         DATASET   ('ERARCH')
  7267*         FROM      (LETTER-ARCHIVE)
  7268*         RIDFLD    (LA-CONTROL-PRIMARY)
  7269*         RESP      (WS-RESPONSE)
  7270*    END-EXEC
  7271     MOVE LENGTH OF
  7272      LETTER-ARCHIVE
  7273       TO DFHEIV11
  7274     MOVE 'ERARCH' TO DFHEIV1
  7275*    MOVE '&$ L                  ''  N#00006728' TO DFHEIV0
  7276     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7277     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7278     MOVE X'204E233030303036373238' TO DFHEIV0(25:11)
  7279     CALL 'kxdfhei1' USING DFHEIV0,
  7280           DFHEIV1,
  7281           LETTER-ARCHIVE,
  7282           DFHEIV11,
  7283           LA-CONTROL-PRIMARY,
  7284           DFHEIV99,
  7285           DFHEIV99
  7286     MOVE EIBRESP  TO WS-RESPONSE
  7287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 128
* EL6317.cbl
  7288     IF RESP-NORMAL
  7289        display ' good write erarch '
  7290        MOVE ER-0280             TO EMI-ERROR
  7291        MOVE -1                  TO SIGREQL
  7292        PERFORM 9900-ERROR-FORMAT
  7293                                 THRU 9900-EXIT
  7294        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7295        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7296     ELSE
  7297        MOVE ER-7345             TO EMI-ERROR
  7298        MOVE -1                  TO SIGREQL
  7299        PERFORM 9900-ERROR-FORMAT
  7300                                 THRU 9900-EXIT
  7301     END-IF
  7302     .
  7303 1000-EXIT.
  7304     EXIT.
  7305 1100-CALL-NS-BUS-LOGIC.
  7306     DISPLAY ' MADE IT TO 1100 '
  7307     MOVE SPACES                 TO BL-INPUT
  7308     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7309     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  7310         MOVE '2'                TO BL-DATA-SRCE
  7311         MOVE SPACES             TO BL-BATCH-NO
  7312         MOVE ZEROS              TO BL-BATCH-SEQ
  7313     ELSE
  7314         MOVE '4'                TO BL-DATA-SRCE
  7315         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  7316         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  7317     END-IF
  7318     MOVE PI-CARRIER             TO BL-CARRIER
  7319     MOVE PI-GROUPING            TO BL-GROUP
  7320     MOVE PI-STATE               TO BL-STATE
  7321     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  7322     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  7323        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  7324        MOVE ' '                 TO DC-OPTION-CODE
  7325        PERFORM 9700-date-link
  7326        IF NO-CONVERSION-ERROR
  7327           MOVE DC-GREG-DATE-1-EDIT
  7328                                 TO BL-EFF-DT
  7329        END-IF
  7330     END-IF
  7331     MOVE PI-CERT-NO             TO BL-CERT-NO
  7332     MOVE SPACES                 TO BL-RESP-NO
  7333     MOVE LTRIDI                 TO BL-LETTER-ID
  7334     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7335     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7336     MOVE 'CrtVerif'               TO BL-FUNC
  7337*    MOVE 'ALWA'                 TO BL-PROC-ID
  7338     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7339*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7340*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7341     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7342     MOVE 'VERIFY  '             TO BL-SOURCE-SCREEN
  7343     IF EIBAID = DFHPF2
  7344        MOVE 'B'                 TO BL-WRITE-ERARCH
  7345     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 129
* EL6317.cbl
  7346        MOVE 'T'                 TO BL-WRITE-ERARCH
  7347     END-IF
  7348     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7349        MOVE REACD-IN (S1)       TO BL-REASON-CODE (S1)
  7350     END-PERFORM
  7351    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7352*****************************************
  7353* Invoke the LETTER business logic
  7354*****************************************
  7355
  7356* exec cics link
  7357*       program('NSRASBL')
  7358*       commarea(srch-commarea)
  7359*    end-exec.
  7360     MOVE LENGTH OF
  7361      srch-commarea
  7362       TO DFHEIV11
  7363     MOVE 'NSRASBL' TO DFHEIV1
  7364*    MOVE '."C                   (   #00006801' TO DFHEIV0
  7365     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7367     MOVE X'2020233030303036383031' TO DFHEIV0(25:11)
  7368     CALL 'kxdfhei1' USING DFHEIV0,
  7369           DFHEIV1,
  7370           srch-commarea,
  7371           DFHEIV11,
  7372           DFHEIV99,
  7373           DFHEIV99,
  7374           DFHEIV99,
  7375           DFHEIV99
  7376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7377
  7378     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7379        BL-MESSAGE
  7380     .
  7381 1100-EXIT.
  7382     EXIT.
  7383 1500-GET-ARCH-NO.
  7384     display ' made it to 1500 '
  7385     MOVE SPACES                 TO ELCNTL-KEY
  7386     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7387     MOVE '1'                    TO CNTL-REC-TYPE
  7388     MOVE ZEROS                  TO CNTL-SEQ
  7389
  7390* EXEC CICS READ
  7391*         DATASET    (WS-ELCNTL-FILE-ID)
  7392*         SET        (ADDRESS OF CONTROL-FILE)
  7393*         RIDFLD     (ELCNTL-KEY)
  7394*         UPDATE
  7395*         RESP       (WS-RESPONSE)
  7396*    END-EXEC
  7397*    MOVE '&"S        EU         (  N#00006816' TO DFHEIV0
  7398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7399     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7400     MOVE X'204E233030303036383136' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0,
  7402           WS-ELCNTL-FILE-ID,
  7403           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 130
* EL6317.cbl
  7404           DFHEIV99,
  7405           ELCNTL-KEY,
  7406           DFHEIV99,
  7407           DFHEIV99,
  7408           DFHEIV99
  7409     SET ADDRESS OF CONTROL-FILE TO
  7410         DFHEIV20
  7411     MOVE EIBRESP  TO WS-RESPONSE
  7412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7413     IF RESP-NORMAL
  7414        display ' good read elcntl '
  7415        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7416           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7417        END-IF
  7418        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7419        MOVE CF-CREDIT-LAST-ARCH-NUM
  7420                                 TO W-ARCH-NUMBER
  7421        display ' new arch number ' w-arch-number
  7422
  7423* EXEC CICS REWRITE
  7424*          FROM      (CONTROL-FILE)
  7425*          DATASET   (WS-ELCNTL-FILE-ID)
  7426*       END-EXEC
  7427     MOVE LENGTH OF
  7428      CONTROL-FILE
  7429       TO DFHEIV11
  7430*    MOVE '&& L                  %   #00006832' TO DFHEIV0
  7431     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7432     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7433     MOVE X'2020233030303036383332' TO DFHEIV0(25:11)
  7434     CALL 'kxdfhei1' USING DFHEIV0,
  7435           WS-ELCNTL-FILE-ID,
  7436           CONTROL-FILE,
  7437           DFHEIV11,
  7438           DFHEIV99
  7439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7440     END-IF
  7441     .
  7442 1500-EXIT.
  7443     EXIT.
  7444
  7445
  7446 1700-WRITE-CERT-NOTE      SECTION.
  7447
  7448
  7449     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7450     MOVE ZERO           TO ERCNOT-SEQ.
  7451     SET TB-INDX         DOWN BY 1.
  7452     SET TB-INDX1        TO TB-INDX.
  7453
  7454****DELETE CURRENT CERT NOTES
  7455 1700-LOOP.
  7456
  7457* EXEC CICS READ
  7458*        DATASET (WS-ERCNOT-FILE-ID)
  7459*        RIDFLD  (ERCNOT-KEY)
  7460*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7461*        RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 131
* EL6317.cbl
  7462*        GTEQ
  7463*    END-EXEC.
  7464*    MOVE '&"S        G          (  N#00006852' TO DFHEIV0
  7465     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7467     MOVE X'204E233030303036383532' TO DFHEIV0(25:11)
  7468     CALL 'kxdfhei1' USING DFHEIV0,
  7469           WS-ERCNOT-FILE-ID,
  7470           DFHEIV20,
  7471           DFHEIV99,
  7472           ERCNOT-KEY,
  7473           DFHEIV99,
  7474           DFHEIV99,
  7475           DFHEIV99
  7476     SET ADDRESS OF CERT-NOTE-FILE TO
  7477         DFHEIV20
  7478     MOVE EIBRESP  TO WS-RESPONSE
  7479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7480
  7481
  7482     IF NOT RESP-NORMAL
  7483        GO TO 1700-ENDDEL
  7484     END-IF
  7485
  7486     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7487
  7488     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7489         GO TO 1700-ENDDEL
  7490     END-IF.
  7491
  7492
  7493* EXEC CICS DELETE
  7494*        DATASET (WS-ERCNOT-FILE-ID)
  7495*        RIDFLD  (ERCNOT-KEY)
  7496*    END-EXEC.
  7497*    MOVE '&(  R                 &   #00006870' TO DFHEIV0
  7498     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7499     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7500     MOVE X'2020233030303036383730' TO DFHEIV0(25:11)
  7501     CALL 'kxdfhei1' USING DFHEIV0,
  7502           WS-ERCNOT-FILE-ID,
  7503           ERCNOT-KEY,
  7504           DFHEIV99,
  7505           DFHEIV99,
  7506           DFHEIV99
  7507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7508
  7509
  7510     GO TO 1700-LOOP.
  7511
  7512 1700-ENDDEL.
  7513
  7514
  7515* EXEC CICS GETMAIN
  7516*         LENGTH(ERCNOT-LENGTH)
  7517*         SET(ADDRESS OF CERT-NOTE-FILE)
  7518*         INITIMG(GETMAIN-SPACE)
  7519*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 132
* EL6317.cbl
  7520*    MOVE ',"IL                  $   #00006879' TO DFHEIV0
  7521     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7522     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7523     MOVE X'2020233030303036383739' TO DFHEIV0(25:11)
  7524     CALL 'kxdfhei1' USING DFHEIV0,
  7525           DFHEIV20,
  7526           ERCNOT-LENGTH,
  7527           GETMAIN-SPACE
  7528     SET ADDRESS OF CERT-NOTE-FILE TO
  7529         DFHEIV20
  7530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7531
  7532
  7533     SET TB-INDX TO 1.
  7534     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7535     MOVE +0             TO ERCNOT-SEQ
  7536
  7537     PERFORM VARYING TB-INDX FROM 1 BY 1
  7538             UNTIL TB-INDX > TB-INDX1
  7539        MOVE SPACES                 TO  CERT-NOTE-FILE
  7540        ADD 1                       TO  ERCNOT-SEQ
  7541        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7542        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7543        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7544        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7545                                    TO  CZ-LAST-MAINT-USER
  7546        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7547                                    TO  CZ-LAST-MAINT-HHMMSS
  7548        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7549                                    TO  CZ-LAST-MAINT-DT
  7550
  7551
  7552* EXEC CICS WRITE
  7553*            DATASET(WS-ERCNOT-FILE-ID)
  7554*            FROM(CERT-NOTE-FILE)
  7555*            RIDFLD(ERCNOT-KEY)
  7556*       END-EXEC
  7557     MOVE LENGTH OF
  7558      CERT-NOTE-FILE
  7559       TO DFHEIV11
  7560*    MOVE '&$ L                  ''   #00006903' TO DFHEIV0
  7561     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7563     MOVE X'2020233030303036393033' TO DFHEIV0(25:11)
  7564     CALL 'kxdfhei1' USING DFHEIV0,
  7565           WS-ERCNOT-FILE-ID,
  7566           CERT-NOTE-FILE,
  7567           DFHEIV11,
  7568           ERCNOT-KEY,
  7569           DFHEIV99,
  7570           DFHEIV99
  7571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7572     END-PERFORM
  7573
  7574     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7575     IF RESP-NORMAL
  7576        EVALUATE CM-NOTE-SW
  7577           WHEN '1'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 133
* EL6317.cbl
  7578           WHEN '3'
  7579           WHEN '5'
  7580           WHEN '7'
  7581              SET NO-CERT-RW     TO TRUE
  7582           WHEN ' '
  7583              MOVE '1'           TO CM-NOTE-SW
  7584           WHEN '2'
  7585              MOVE '3'           TO CM-NOTE-SW
  7586           WHEN '4'
  7587              MOVE '5'           TO CM-NOTE-SW
  7588           WHEN '6'
  7589              MOVE '7'           TO CM-NOTE-SW
  7590        END-EVALUATE
  7591     END-IF
  7592     IF NOT NO-CERT-RW
  7593        PERFORM 1810-REWRITE-ELCERT
  7594                                 THRU 1810-EXIT
  7595     ELSE
  7596
  7597* EXEC CICS UNLOCK
  7598*          DATASET    (WS-ELCERT-FILE-ID)
  7599*       END-EXEC
  7600*    MOVE '&*                    #   #00006932' TO DFHEIV0
  7601     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7602     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7603     MOVE X'2020233030303036393332' TO DFHEIV0(25:11)
  7604     CALL 'kxdfhei1' USING DFHEIV0,
  7605           WS-ELCERT-FILE-ID,
  7606           DFHEIV99
  7607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7608     END-IF
  7609
  7610     .
  7611 1799-EXIT.
  7612     EXIT.
  7613
  7614 1800-READ-ELCERT-UPDATE.
  7615
  7616     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7617     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7618     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7619     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7620     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7621     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7622     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7623     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7624
  7625
  7626* EXEC CICS READ
  7627*        UPDATE
  7628*        DATASET  (WS-ELCERT-FILE-ID)
  7629*        RIDFLD   (WS-ELCERT-KEY)
  7630*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7631*        RESP     (WS-RESPONSE)
  7632*    END-EXEC
  7633*    MOVE '&"S        EU         (  N#00006952' TO DFHEIV0
  7634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7635     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 134
* EL6317.cbl
  7636     MOVE X'204E233030303036393532' TO DFHEIV0(25:11)
  7637     CALL 'kxdfhei1' USING DFHEIV0,
  7638           WS-ELCERT-FILE-ID,
  7639           DFHEIV20,
  7640           DFHEIV99,
  7641           WS-ELCERT-KEY,
  7642           DFHEIV99,
  7643           DFHEIV99,
  7644           DFHEIV99
  7645     SET ADDRESS OF CERTIFICATE-MASTER TO
  7646         DFHEIV20
  7647     MOVE EIBRESP  TO WS-RESPONSE
  7648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7649
  7650     .
  7651 1800-EXIT.
  7652     EXIT.
  7653
  7654 1810-REWRITE-ELCERT.
  7655
  7656
  7657* EXEC CICS REWRITE
  7658*        FROM     (CERTIFICATE-MASTER)
  7659*        DATASET  (WS-ELCERT-FILE-ID)
  7660*        RESP     (WS-RESPONSE)
  7661*    END-EXEC.
  7662     MOVE LENGTH OF
  7663      CERTIFICATE-MASTER
  7664       TO DFHEIV11
  7665*    MOVE '&& L                  %  N#00006966' TO DFHEIV0
  7666     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7667     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7668     MOVE X'204E233030303036393636' TO DFHEIV0(25:11)
  7669     CALL 'kxdfhei1' USING DFHEIV0,
  7670           WS-ELCERT-FILE-ID,
  7671           CERTIFICATE-MASTER,
  7672           DFHEIV11,
  7673           DFHEIV99
  7674     MOVE EIBRESP  TO WS-RESPONSE
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678     .
  7679 1810-EXIT.
  7680     EXIT.
  7681
  7682 8100-SEND-INITIAL-MAP.
  7683     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7684     MOVE '5'                    TO DC-OPTION-CODE.
  7685     PERFORM 9700-DATE-LINK.
  7686     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7687     MOVE EIBTIME                TO TIME-IN.
  7688     MOVE TIME-OUT               TO TIMEO.
  7689     MOVE -1                     TO SIGREQL.
  7690     IF PI-PROCESSOR-IS-CSR-SUPER
  7691        perform varying s1 from +1 by +1 until
  7692           s1 > +12
  7693           MOVE AL-UANON            TO reacda (s1)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 135
* EL6317.cbl
  7694        end-perform
  7695     END-IF
  7696     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  7697     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  7698
  7699* EXEC CICS SEND
  7700*        MAP      (MAP-NAME)
  7701*        MAPSET   (MAPSET-NAME)
  7702*        FROM     (EL631JO)
  7703*        ERASE
  7704*        CURSOR
  7705*    END-EXEC.
  7706     MOVE LENGTH OF
  7707      EL631JO
  7708       TO DFHEIV12
  7709     MOVE -1
  7710       TO DFHEIV11
  7711*    MOVE '8$     CT  E    H L F ,   #00006992' TO DFHEIV0
  7712     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7713     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7714     MOVE X'2020233030303036393932' TO DFHEIV0(25:11)
  7715     CALL 'kxdfhei1' USING DFHEIV0,
  7716           MAP-NAME,
  7717           EL631JO,
  7718           DFHEIV12,
  7719           MAPSET-NAME,
  7720           DFHEIV99,
  7721           DFHEIV99,
  7722           DFHEIV99,
  7723           DFHEIV11,
  7724           DFHEIV99,
  7725           DFHEIV99,
  7726           DFHEIV99
  7727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7728
  7729     GO TO 9100-RETURN-TRAN.
  7730 8200-SEND-DATAONLY.
  7731     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7732     MOVE '5'                    TO DC-OPTION-CODE.
  7733     PERFORM 9700-DATE-LINK.
  7734     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7735     MOVE EIBTIME                TO TIME-IN.
  7736     MOVE TIME-OUT               TO TIMEO.
  7737     MOVE -1                     TO PFENTRL
  7738     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  7739     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  7740
  7741* EXEC CICS SEND
  7742*        MAP      (MAP-NAME)
  7743*        MAPSET   (MAPSET-NAME)
  7744*        FROM     (EL631JO)
  7745*        DATAONLY
  7746*        ERASEAUP
  7747*        CURSOR
  7748*    END-EXEC.
  7749     MOVE LENGTH OF
  7750      EL631JO
  7751       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 136
* EL6317.cbl
  7752     MOVE -1
  7753       TO DFHEIV11
  7754*    MOVE '8$D    CT  A    H L F ,   #00007010' TO DFHEIV0
  7755     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  7756     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7757     MOVE X'2020233030303037303130' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0,
  7759           MAP-NAME,
  7760           EL631JO,
  7761           DFHEIV12,
  7762           MAPSET-NAME,
  7763           DFHEIV99,
  7764           DFHEIV99,
  7765           DFHEIV99,
  7766           DFHEIV11,
  7767           DFHEIV99,
  7768           DFHEIV99,
  7769           DFHEIV99
  7770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7771
  7772     GO TO 9100-RETURN-TRAN.
  7773 8300-SEND-TEXT.
  7774
  7775* EXEC CICS SEND TEXT
  7776*        FROM     (LOGOFF-TEXT)
  7777*        LENGTH   (LOGOFF-LENGTH)
  7778*        ERASE
  7779*        FREEKB
  7780*    END-EXEC.
  7781*    MOVE '8&      T  E F  H   F -   #00007020' TO DFHEIV0
  7782     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  7783     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  7784     MOVE X'2020233030303037303230' TO DFHEIV0(25:11)
  7785     CALL 'kxdfhei1' USING DFHEIV0,
  7786           LOGOFF-TEXT,
  7787           LOGOFF-LENGTH,
  7788           DFHEIV99,
  7789           DFHEIV99,
  7790           DFHEIV99,
  7791           DFHEIV99,
  7792           DFHEIV99,
  7793           DFHEIV99,
  7794           DFHEIV99,
  7795           DFHEIV99,
  7796           DFHEIV99,
  7797           DFHEIV99
  7798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7799
  7800
  7801* EXEC CICS RETURN
  7802*    END-EXEC.
  7803*    MOVE '.(                    ''   #00007026' TO DFHEIV0
  7804     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7805     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7806     MOVE X'2020233030303037303236' TO DFHEIV0(25:11)
  7807     CALL 'kxdfhei1' USING DFHEIV0,
  7808           DFHEIV99,
  7809           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 137
* EL6317.cbl
  7810           DFHEIV99,
  7811           DFHEIV99,
  7812           DFHEIV99,
  7813           DFHEIV99
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7815
  7816 8800-UNAUTHORIZED-ACCESS.
  7817     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  7818     GO TO 8300-SEND-TEXT.
  7819 8810-PF23.
  7820     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  7821     MOVE XCTL-005               TO PGM-NAME.
  7822     GO TO 9300-XCTL.
  7823 9000-RETURN-CICS.
  7824
  7825* EXEC CICS RETURN
  7826*    END-EXEC.
  7827*    MOVE '.(                    ''   #00007036' TO DFHEIV0
  7828     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7830     MOVE X'2020233030303037303336' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0,
  7832           DFHEIV99,
  7833           DFHEIV99,
  7834           DFHEIV99,
  7835           DFHEIV99,
  7836           DFHEIV99,
  7837           DFHEIV99
  7838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7839
  7840 9100-RETURN-TRAN.
  7841     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  7842     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  7843
  7844* EXEC CICS RETURN
  7845*        TRANSID    (TRANS-ID)
  7846*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7847*        LENGTH     (PI-COMM-LENGTH)
  7848*    END-EXEC.
  7849*    MOVE '.(CT                  ''   #00007041' TO DFHEIV0
  7850     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  7851     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7852     MOVE X'2020233030303037303431' TO DFHEIV0(25:11)
  7853     CALL 'kxdfhei1' USING DFHEIV0,
  7854           TRANS-ID,
  7855           PROGRAM-INTERFACE-BLOCK,
  7856           PI-COMM-LENGTH,
  7857           DFHEIV99,
  7858           DFHEIV99,
  7859           DFHEIV99
  7860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7861
  7862 9200-RETURN-MAIN-MENU.
  7863     MOVE XCTL-626               TO PGM-NAME.
  7864     GO TO 9300-XCTL.
  7865 9300-XCTL.
  7866
  7867* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 138
* EL6317.cbl
  7868*        PROGRAM    (PGM-NAME)
  7869*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7870*        LENGTH     (PI-COMM-LENGTH)
  7871*    END-EXEC.
  7872*    MOVE '.$C                   %   #00007050' TO DFHEIV0
  7873     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7874     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7875     MOVE X'2020233030303037303530' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0,
  7877           PGM-NAME,
  7878           PROGRAM-INTERFACE-BLOCK,
  7879           PI-COMM-LENGTH,
  7880           DFHEIV99
  7881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7882
  7883 9400-CLEAR.
  7884     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  7885
  7886* EXEC CICS XCTL
  7887*        PROGRAM    (PGM-NAME)
  7888*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  7889*        LENGTH     (PI-COMM-LENGTH)
  7890*    END-EXEC.
  7891*    MOVE '.$C                   %   #00007057' TO DFHEIV0
  7892     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  7893     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7894     MOVE X'2020233030303037303537' TO DFHEIV0(25:11)
  7895     CALL 'kxdfhei1' USING DFHEIV0,
  7896           PGM-NAME,
  7897           PROGRAM-INTERFACE-BLOCK,
  7898           PI-COMM-LENGTH,
  7899           DFHEIV99
  7900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7901
  7902 9500-PF12.
  7903     MOVE XCTL-010               TO PGM-NAME.
  7904     GO TO 9300-XCTL.
  7905 9600-PGMID-ERROR.
  7906
  7907* EXEC CICS HANDLE CONDITION
  7908*        PGMIDERR    (8300-SEND-TEXT)
  7909*    END-EXEC.
  7910*    MOVE '"$L                   ! " #00007066' TO DFHEIV0
  7911     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  7912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7913     MOVE X'2220233030303037303636' TO DFHEIV0(25:11)
  7914     CALL 'kxdfhei1' USING DFHEIV0
  7915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7916
  7917     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  7918     MOVE ' '                    TO PI-ENTRY-CD-1.
  7919     MOVE XCTL-005               TO PGM-NAME.
  7920     MOVE PGM-NAME               TO LOGOFF-PGM.
  7921     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  7922     GO TO 9300-XCTL.
  7923 9700-DATE-LINK.
  7924     MOVE LINK-ELDATCV           TO PGM-NAME.
  7925
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 139
* EL6317.cbl
  7926* EXEC CICS LINK
  7927*        PROGRAM    (PGM-NAME)
  7928*        COMMAREA   (DATE-CONVERSION-DATA)
  7929*        LENGTH     (DC-COMM-LENGTH)
  7930*    END-EXEC.
  7931*    MOVE '."C                   (   #00007077' TO DFHEIV0
  7932     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7934     MOVE X'2020233030303037303737' TO DFHEIV0(25:11)
  7935     CALL 'kxdfhei1' USING DFHEIV0,
  7936           PGM-NAME,
  7937           DATE-CONVERSION-DATA,
  7938           DC-COMM-LENGTH,
  7939           DFHEIV99,
  7940           DFHEIV99,
  7941           DFHEIV99,
  7942           DFHEIV99
  7943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7944
  7945 9900-ERROR-FORMAT.
  7946     IF NOT EMI-ERRORS-COMPLETE
  7947        MOVE LINK-001            TO PGM-NAME
  7948
  7949* EXEC CICS LINK
  7950*           PROGRAM    (PGM-NAME)
  7951*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  7952*           LENGTH     (EMI-COMM-LENGTH)
  7953*       END-EXEC
  7954*    MOVE '."C                   (   #00007085' TO DFHEIV0
  7955     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7957     MOVE X'2020233030303037303835' TO DFHEIV0(25:11)
  7958     CALL 'kxdfhei1' USING DFHEIV0,
  7959           PGM-NAME,
  7960           ERROR-MESSAGE-INTERFACE-BLOCK,
  7961           EMI-COMM-LENGTH,
  7962           DFHEIV99,
  7963           DFHEIV99,
  7964           DFHEIV99,
  7965           DFHEIV99
  7966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7967     END-IF
  7968     .
  7969 9900-EXIT.
  7970     EXIT.
  7971 9990-ABEND.
  7972     MOVE LINK-004               TO PGM-NAME.
  7973     MOVE DFHEIBLK               TO EMI-LINE1.
  7974
  7975* EXEC CICS LINK
  7976*        PROGRAM   (PGM-NAME)
  7977*        COMMAREA  (EMI-LINE1)
  7978*        LENGTH    (72)
  7979*    END-EXEC.
  7980     MOVE 72
  7981       TO DFHEIV11
  7982*    MOVE '."C                   (   #00007097' TO DFHEIV0
  7983     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 140
* EL6317.cbl
  7984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7985     MOVE X'2020233030303037303937' TO DFHEIV0(25:11)
  7986     CALL 'kxdfhei1' USING DFHEIV0,
  7987           PGM-NAME,
  7988           EMI-LINE1,
  7989           DFHEIV11,
  7990           DFHEIV99,
  7991           DFHEIV99,
  7992           DFHEIV99,
  7993           DFHEIV99
  7994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7995
  7996     GO TO 8200-SEND-DATAONLY.
  7997
  7998* GOBACK.
  7999     MOVE '9%                    "   ' TO DFHEIV0
  8000     MOVE 'EL6317' TO DFHEIV1
  8001     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8002     GOBACK.
  8003 9995-SECURITY-VIOLATION.
  8004*                            COPY ELCSCTP.
  8005******************************************************************
  8006*                                                                *
  8007*                            ELCSCTP                             *
  8008*                            VMOD=2.001                          *
  8009*                                                                *
  8010*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8011******************************************************************
  8012
  8013
  8014     MOVE EIBDATE          TO SM-JUL-DATE.
  8015     MOVE EIBTRMID         TO SM-TERMID.
  8016     MOVE THIS-PGM         TO SM-PGM.
  8017     MOVE EIBTIME          TO TIME-IN.
  8018     MOVE TIME-OUT         TO SM-TIME.
  8019     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8020
  8021
  8022* EXEC CICS LINK
  8023*         PROGRAM  ('EL003')
  8024*         COMMAREA (SECURITY-MESSAGE)
  8025*         LENGTH   (80)
  8026*    END-EXEC.
  8027     MOVE 'EL003' TO DFHEIV1
  8028     MOVE 80
  8029       TO DFHEIV11
  8030*    MOVE '."C                   (   #00007122' TO DFHEIV0
  8031     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8033     MOVE X'2020233030303037313232' TO DFHEIV0(25:11)
  8034     CALL 'kxdfhei1' USING DFHEIV0,
  8035           DFHEIV1,
  8036           SECURITY-MESSAGE,
  8037           DFHEIV11,
  8038           DFHEIV99,
  8039           DFHEIV99,
  8040           DFHEIV99,
  8041           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:04 Page 141
* EL6317.cbl
  8042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8043
  8044
  8045******************************************************************
  8046
  8047 9995-EXIT.
  8048     EXIT.
  8049
  8050 9999-DFHBACK SECTION.
  8051     MOVE '9%                    "   ' TO DFHEIV0
  8052     MOVE 'EL6317' TO DFHEIV1
  8053     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8054     GOBACK.
  8055 9999-DFHEXIT.
  8056     IF DFHEIGDJ EQUAL 0001
  8057         NEXT SENTENCE
  8058     ELSE IF DFHEIGDJ EQUAL 2
  8059         GO TO 8300-SEND-TEXT
  8060         DEPENDING ON DFHEIGDI.
  8061     MOVE '9%                    "   ' TO DFHEIV0
  8062     MOVE 'EL6317' TO DFHEIV1
  8063     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8064     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34348     Code:       17877
