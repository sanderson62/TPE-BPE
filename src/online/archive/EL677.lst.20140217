* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32******************************************************************
    33 ENVIRONMENT DIVISION.
    34
    35 DATA DIVISION.
    36 WORKING-STORAGE SECTION.
    37 01  DFH-START PIC X(04).
    38 77  FILLER  PIC X(32)  VALUE '********************************'.
    39 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    40 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    41 77  s1                          pic s999 comp-3 value +0.
    42 77  s2                          pic s999 comp-3 value +0.
    43 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    44 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    45 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    46 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    47 77  ws-browse-sw                pic x value spaces.
    48     88  i-say-when                 value 'Y'.
    49 77  ws-delete-sw                pic x value ' '.
    50     88  row-deleted                 value 'Y'.
    51 77  ws-sql-code                 pic s9(7) value zeros.
    52 77  ws-dis-sql-code             pic -9999999 value zeros.
    53 77  ws-match-sw                 pic x  value ' '.
    54     88  found-a-match             value 'Y'.
    55 77  ws-commit-sw                pic x value ' '.
    56     88  tbl-commited                value 'Y'.
*   57 EXEC SQL
*   58    INCLUDE SQLDA
*   59 END-EXEC
    60 01 SQLDA sync.
    61    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    62    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    63    05 SQLN                  PIC S9(4) COMP-5 value 0.
    64    05 SQLD                  PIC S9(4) COMP-5 value 0.
    65    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    66       10 SQLTYPE            PIC S9(4) COMP-5.
    67       10 SQLLEN             PIC S9(4) COMP-5.
    68$IF P64 SET
    69X      *> For 64-bit environments, ensure that SQLDATA is
    70X      *> aligned on an 8-byte boundary.
    71X      10 FILLER             PIC S9(9) COMP-5.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   3
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
    72$END
    73       10 SQLDATA            USAGE POINTER.
    74       10 SQLIND             USAGE POINTER.
    75       10 SQLNAME.
    76          15 SQLNAMEL        PIC S9(4) COMP-5.
    77          15 SQLNAMEC        PIC X(30).
    78
    79* Values for SQLTYPE
    80
    81 78  ESQL-DATE-CHAR              VALUE 384.
    82 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    83 78  ESQL-DATE-REC               VALUE 386.
    84 78  ESQL-DATE-REC-NULL          VALUE 387.
    85 78  ESQL-TIME-CHAR              VALUE 388.
    86 78  ESQL-TIME-CHAR-NULL         VALUE 389.
    87 78  ESQL-TIME-REC               VALUE 390.
    88 78  ESQL-TIME-REC-NULL          VALUE 391.
    89 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
    90 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
    91 78  ESQL-TIMESTAMP-REC          VALUE 394.
    92 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
    93 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
    94 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
    95 78  ESQL-TS-OFFSET-REC          VALUE 398.
    96 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
    97 78  ESQL-LONGVARBINARY          VALUE 404.
    98 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
    99 78  ESQL-LONGVARCHAR            VALUE 408.
   100 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   101 78  ESQL-BINARY                 VALUE 444.
   102 78  ESQL-BINARY-NULL            VALUE 445.
   103 78  ESQL-VARBINARY              VALUE 446.
   104 78  ESQL-VARBINARY-NULL         VALUE 447.
   105 78  ESQL-VARCHAR                VALUE 448.
   106 78  ESQL-VARCHAR-NULL           VALUE 449.
   107
   108 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   109 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   110
   111 78  ESQL-CHAR                   VALUE 452.
   112 78  ESQL-CHAR-NULL              VALUE 453.
   113
   114 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   115 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   116
   117 78  ESQL-DOUBLE                 VALUE 480.
   118 78  ESQL-DOUBLE-NULL            VALUE 481.
   119 78  ESQL-REAL                   VALUE 482.
   120 78  ESQL-REAL-NULL              VALUE 483.
   121 78  ESQL-DECIMAL                VALUE 484.
   122 78  ESQL-DECIMAL-NULL           VALUE 485.
   123 78  ESQL-INTEGER                VALUE 496.
   124 78  ESQL-INTEGER-NULL           VALUE 497.
   125 78  ESQL-SMALLINT               VALUE 500.
   126 78  ESQL-SMALLINT-NULL          VALUE 501.
   127 78  ESQL-TINYINT                VALUE 502.
   128 78  ESQL-TINYINT-NULL           VALUE 503.
*  129 EXEC SQL
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   4
* EL677.cbl
*  130    INCLUDE SQLCA
*  131 END-EXEC
   132 01 SQLCA.
   133     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   134     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   135     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   136     05  SQLERRM.
   137         49  SQLERRML    PIC S9(4) COMP-5.
   138         49  SQLERRMC    PIC X(70).
   139     05  SQLERRP         PIC X(8).
   140     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   141     05  SQLWARN.
   142         10  SQLWARN0    PIC X.
   143         10  SQLWARN1    PIC X.
   144         10  SQLWARN2    PIC X.
   145         10  SQLWARN3    PIC X.
   146         10  SQLWARN4    PIC X.
   147         10  SQLWARN5    PIC X.
   148         10  SQLWARN6    PIC X.
   149         10  SQLWARN7    PIC X.
   150     05  SQLEXT.
   151         10  SQLWARN8    PIC X.
   152         10  SQLWARN9    PIC X.
   153         10  SQLWARN10   PIC X.
   154         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   155     05  SQLSTATE    PIC X(5).
   156 EXEC SQL
   157    BEGIN DECLARE SECTION
   158 END-EXEC
   159 01  ws-paid-bank-work-area.
   160     05  ws-pb-compid            pic x(9).
   161     05  ws-pb-check-no          pic x(10).
   162     05  ws-pb-bad-check-no      pic x(10).
   163 01  Paid-Bank-Info.
   164     05  pb-check-no             pic 9(10).
   165     05  pb-tran-type            pic x.
   166     05  pb-bank-acct-desc       pic x(50).
   167     05  pb-amount               pic x(12).
   168     05  pb-paid-date            pic x(25).
   169 01  ws-key-stuff.
   170     05  ws-compid               pic xxx.
   171     05  ws-carrier              pic x.
   172     05  ws-grouping             pic x(6).
   173     05  ws-state                pic xx.
   174     05  ws-account              pic x(10).
   175     05  ws-eff-date             pic x(10).
   176     05  ws-certificate          pic x(10).
   177     05  ws-cert-sfx             pic x.
   178     05  ws-seq-no               pic 999.
   179     05  ws-type                 pic x.
   180 01  sqlcmd                      pic x(1024).
   181 01  WS-MOE-DATE                 pic x(10).
   182 01  svr                         pic x(32).
   183 01  usr                         pic x(32).
   184 01  pass                        pic x(32).
   185 01  usr-pass                    pic x(64).
   186 01  ws-disp-code                pic s9(11).
   187***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   5
* EL677.cbl
   188***                                                            ***
   189***  These indicators are used to determine if a variable      ***
   190***  is passed nulls from sql. The indicator will be -1        ***
   191***  if the value on sql is nulls and +0 if the value is       ***
   192***  something other than nulls. Here is an example on how     ***
   193***  to use the indicator variables.                           ***
   194***                                                            ***
   195***     EXEC SQL                                               ***
   196***        fetch checkapp into                                 ***
   197***           :db-app-status :nu-app-status,                   ***
   198***           :db-app-by     :nu-app-by,                       ***
   199***           :db-app-date   :nu-app-date,                     ***
   200***           :db-app-batch  :nu-app-batch                     ***
   201***     END-EXEC                                               ***
   202***                                                            ***
   203***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   204 01  indicator-vaiables-for-nulls.
   205     05  nu-app-status           pic s9(4) comp value +0.
   206     05  nu-app-by               pic s9(4) comp value +0.
   207     05  nu-app-date             pic s9(4) comp value +0.
   208     05  nu-app-batch            pic s9(4) comp value +0.
   209     05  nu-fincar               pic s9(4) comp value +0.
   210 01  daily-check-request-rec.
   211     05  db-compid               pic xxx.
   212     05  db-carrier              pic x.
   213     05  db-grouping             pic x(6).
   214     05  db-state                pic xx.
   215     05  db-account              pic x(10).
   216     05  db-effdate              pic x(10).
   217     05  db-certificate          pic x(10).
   218     05  db-cert-sfx             pic x.
   219     05  db-seq-no               pic 999.
   220     05  db-type                 pic x.
   221     05  db-amount-n             pic 9(7).99.
   222     05  db-amount redefines db-amount-n
   223                                 pic x(10).
   224     05  db-checkno              pic x(15).
   225     05  db-checkdate            pic x(10).
   226     05  db-checkstatus          pic 9(5).
   227     05  db-releasebatch         pic 9(5).
   228     05  db-releasedt            pic x(10).
   229     05  db-releaseby            pic x(4).
   230     05  db-payeename1           pic x(30).
   231     05  db-payeename2           pic x(30).
   232     05  db-payeeaddr1           pic x(30).
   233     05  db-payeeaddr2           pic x(30).
   234     05  db-payeecity            pic x(30).
   235     05  db-payeest              pic xx.
   236     05  db-payeezip             pic x(10).
   237     05  db-fincar               pic x.
   238     05  db-fingrp               pic x(6).
   239     05  db-finresp              pic x(10).
   240     05  db-finacct              pic x(10).
   241     05  db-preparer             pic x(4).
   242     05  db-app-status           pic x(9).
   243     05  dp-app-status-n redefines db-app-status
   244                                 pic 9(9).
   245     05  db-app-by               pic x(20).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   6
* EL677.cbl
   246     05  db-app-date             pic x(30).
   247     05  db-app-batch            pic x(10).
   248     05  db-return-to            pic x(30).
   249     05  db-insured-name         pic x(30).
   250 EXEC SQL
   251    END DECLARE SECTION
   252 END-EXEC
   253*                            COPY ELCSCTM.
   254******************************************************************
   255*                                                                *
   256*                                                                *
   257*                            ELCSCTM                             *
   258*                            VMOD=2.001                          *
   259*                                                                *
   260*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   261*                                                                *
   262******************************************************************
   263 01  SECURITY-MESSAGE.
   264     12  FILLER                          PIC X(30)
   265            VALUE '** LOGIC SECURITY VIOLATION -'.
   266     12  SM-READ                         PIC X(6).
   267     12  FILLER                          PIC X(5)
   268            VALUE ' PGM='.
   269     12  SM-PGM                          PIC X(6).
   270     12  FILLER                          PIC X(5)
   271            VALUE ' OPR='.
   272     12  SM-PROCESSOR-ID                 PIC X(4).
   273     12  FILLER                          PIC X(6)
   274            VALUE ' TERM='.
   275     12  SM-TERMID                       PIC X(4).
   276     12  FILLER                          PIC XX   VALUE SPACE.
   277     12  SM-JUL-DATE                     PIC 9(5).
   278     12  FILLER                          PIC X    VALUE SPACE.
   279     12  SM-TIME                         PIC 99.99.
   280
   281*                            COPY ELCSCRTY.
   282******************************************************************
   283*                                                                *
   284*                                                                *
   285*                            ELCSCRTY                            *
   286*                            VMOD=2.001                          *
   287*                                                                *
   288*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   289*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   290*        SAVED IN PI-SECURITY-ADDRESS.                           *
   291*                                                                *
   292******************************************************************
   293 01  SECURITY-CONTROL.
   294     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   295     12  FILLER                       PIC XX    VALUE 'SC'.
   296     12  SC-CREDIT-CODES.
   297         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   298             20  SC-CREDIT-DISPLAY    PIC X.
   299             20  SC-CREDIT-UPDATE     PIC X.
   300     12  SC-CLAIMS-CODES.
   301         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   302             20  SC-CLAIMS-DISPLAY    PIC X.
   303             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   7
* EL677.cbl
   304 01  ws-dummy-erchek                pic x(600).
   305 01  filler.
   306     05  ws-ind                     pic s9(4) comp value +0.
   307     05  ws-ind-red redefines ws-ind pic xx.
   308     05  ws-display-ind             pic s9(7) value zeros.
   309 01  ws-compare-erchek-key          pic x(33) value low-values.
   310 01  ws-eracct-sw                   pic x value ' '.
   311     88  eracct-found                 value 'Y'.
   312 01  ws-eracct-start-sw             pic x value ' '.
   313     88  eracct-start                 value 'Y'.
   314 01  WS-DATE-AREA.
   315     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   316     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   317     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   318
   319 01  ws-work-amt-alpha           pic x(10).
   320 01  ws-work-amt-num redefines ws-work-amt-alpha
   321                                 pic 9(8)v99.
   322 01  ws-user-defined.
   323     05  ws-user-reason         pic xxx.
   324     05  ws-user-cert-no        pic x(11).
   325     05  ws-user-name           pic x(28).
   326 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   327 01  STANDARD-AREAS.
   328     12  ws-connect-sw               pic x  value ' '.
   329         88  connected-to-db             value 'Y'.
   330     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   331     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   332     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   333     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   334     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   335     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   336     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   337     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   338     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   339     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   340     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   341     12  TIME-OUT-R  REDEFINES TIME-IN.
   342         16  FILLER                  PIC X.
   343         16  TIME-OUT                PIC 99V99.
   344         16  FILLER                  PIC XX.
   345     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   346     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   347     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   348     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   349     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   350     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   351     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   352     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   353     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   354     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   355     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   356     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   357     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   358     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   359     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   360     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   361     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   8
* EL677.cbl
   362     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   363     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   364     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   365     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   366     12  QID.
   367         16  QID-TERM                PIC X(4)    VALUE SPACES.
   368         16  FILLER                  PIC X(4)    VALUE '677A'.
   369
   370 01  WORK-AREAS.
   371     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   372     12  WS-AM-WK REDEFINES WS-AM-WORK.
   373         16  WS-AM-NUM               PIC S9(7)V99.
   374         16  WS-AM-SIGN              PIC X.
   375     12  WS-CHECK-WORK.
   376         16  FILLER                  PIC X        VALUE SPACE.
   377         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   378     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   379     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   380     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   381     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   382     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   383     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   384     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   385     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   386     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   387     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   388     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   389         WS-DT-DEEDIT-FIELD.
   390         16  FILLER                  PIC X(4).
   391         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   392     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   393     12  WS-DEEDIT-FIELD-V0          REDEFINES
   394         WS-DEEDIT-FIELD-A           PIC S9(15).
   395
   396     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   397     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   398         88 WS-CERT-FOUND                        VALUE 'Y'.
   399         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   400     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   401         88 WS-PNDB-FOUND                        VALUE 'Y'.
   402         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   403     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   404         88  WS-PROCESS-CERT                     VALUE 'Y'.
   405     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   406         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   407     12  WS-PY-ENTRY-COMMENT.
   408         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   409         16  FILLER                  PIC X(13)   VALUE
   410            ' MISC. CHECK '.
   411         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   412         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   413     12  WS-PY-REF-COMMENT.
   414         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   415         16  FILLER                  PIC X(13)   VALUE
   416            ' REFUND PYMT '.
   417         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   418         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   419     12  WS-PY-END-COMMENT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page   9
* EL677.cbl
   420         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   421         16  FILLER                  PIC X(13)   VALUE
   422            ' ENDORSEMENT '.
   423         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   424         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   425     12  WS-PY-DED-COMMENT.
   426         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   427         16  FILLER                  PIC X(13)   VALUE
   428            ' STAT DEDUCT '.
   429         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   430         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   431     12  WS-PY-ADDL-COMMENT.
   432         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   433         16  FILLER                  PIC X(13)   VALUE
   434            ' ADDL CHARGE '.
   435         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   436         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   437     12  WS-PY-REVERSAL-COMMENT.
   438         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   439         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   440            ' VOID REFUND '.
   441         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   442         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   443     12  WS-TMS-ENTRY-COMMENT.
   444         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   445         16  FILLER                  PIC XX      VALUE SPACES.
   446         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   447     12  WS-ZIP-CODE.
   448         16  WS-ZIP-PRIME.
   449             20  WS-ZIP-PRI-1ST      PIC X.
   450                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   451             20  FILLER              PIC X(4).
   452         16  WS-ZIP-PLUS4            PIC X(4).
   453     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   454         16  WS-CAN-POST1-1          PIC XXX.
   455         16  WS-CAN-POST1-2.
   456             20  WS-CAN-POST-4TH     PIC X.
   457             20  FILLER              PIC XX.
   458         16  FILLER                  PIC XXX.
   459     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   460         16  WS-CAN-POST2-1          PIC XXX.
   461         16  FILLER                  PIC X.
   462         16  WS-CAN-POST2-2          PIC XXX.
   463         16  FILLER                  PIC XX.
   464
   465*                                    COPY ELCNWA.
   466*****************************************************************
   467*                                                               *
   468*                                                               *
   469*                            ELCNWA.                            *
   470*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   471*                            VMOD=2.003                         *
   472*                                                               *
   473*            M O V E   N A M E   W O R K   A R E A.             *
   474*                                                               *
   475*****************************************************************.
   476
   477 01  WS-NAME-WORK-AREA.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  10
* EL677.cbl
   478     05  WS-INSURED-LAST-NAME        PIC X(15).
   479     05  WS-INSURED-1ST-NAME         PIC X(12).
   480     05  WS-INSURED-MID-INIT         PIC X.
   481
   482     05  WS-NAME-WORK.
   483         10  WS-NW                   PIC X
   484             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   485
   486     05  WS-NAME-WORK2.
   487         10  WS-NW2                  PIC X
   488             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   489                                        NWA-INDEX0.
   490
   491     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   492                                     COMP-3.
   493
   494 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   495     88  RESP-NORMAL                    VALUE +0.
   496     88  resp-file-notfnd               value +12.
   497     88  RESP-NOTFND                    VALUE +13.
   498     88  resp-duprec                    value +14.
   499     88  resp-dupkey                    value +15.
   500     88  resp-invreq                    value +16.
   501     88  RESP-NOTOPEN                   VALUE +19.
   502     88  RESP-ENDFILE                   VALUE +20.
   503     88  resp-lengtherr                 value +22.
   504 01  ACCESS-KEYS.
   505     12  ELCNTL-KEY.
   506         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   507         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   508         16 ELCNTL-ACCESS.
   509             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   510             20  FILLER              PIC X       VALUE SPACES.
   511             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   512         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   513
   514     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   515
   516     12  ERACCT-KEY.
   517         16  ERACCT-CO               PIC X       VALUE SPACES.
   518         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   519         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   520         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   521         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   522         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   523         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   524
   525     12  SAVE-ERACCT-KEY.
   526         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   527         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   528         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   529         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   530         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   531         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   532         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   533
   534     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   535
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  11
* EL677.cbl
   536     12  ERCOMP-KEY.
   537         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   538         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   539         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   540         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   541         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   542         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   543
   544     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   545
   546     12  ELCERT-KEY.
   547         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   548         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   549         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   550         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   551         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   552         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   553         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   554         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   555
   556     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   557
   558     12  ERPNDB-PRIMARY-KEY.
   559         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   560         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   561         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   562         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   563
   564     12  ERPNDB-ALT-KEY.
   565         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   566         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   567         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   568         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   569         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   570         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   571         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   572         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   573         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   574         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   575
   576     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   577
   578     12  ERPNDM-PRIMARY-KEY.
   579         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   580         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   581         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   582         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   583
   584     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   585
   586     12  ERCHEK-KEY.
   587         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   588         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   589         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   590         16  CHEK-STATE              PIC XX      VALUE SPACES.
   591         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   592         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   593         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  12
* EL677.cbl
   594         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   595         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   596
   597     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   598     12  ERPYAJ-KEY.
   599         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   600         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   601         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   602         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   603         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   604         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   605         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   606
   607     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   608
   609 01  ERROR-NUMBERS.
   610     12  ER-0000                     PIC X(4)    VALUE '0000'.
   611     12  ER-0004                     PIC X(4)    VALUE '0004'.
   612     12  ER-0008                     PIC X(4)    VALUE '0008'.
   613     12  ER-0013                     PIC X(4)    VALUE '0013'.
   614     12  ER-0022                     PIC X(4)    VALUE '0022'.
   615     12  ER-0023                     PIC X(4)    VALUE '0023'.
   616     12  ER-0026                     PIC X(4)    VALUE '0026'.
   617     12  ER-0029                     PIC X(4)    VALUE '0029'.
   618     12  ER-0070                     PIC X(4)    VALUE '0070'.
   619     12  ER-0194                     PIC X(4)    VALUE '0194'.
   620     12  ER-0195                     PIC X(4)    VALUE '0195'.
   621     12  ER-0196                     PIC X(4)    VALUE '0196'.
   622     12  ER-0197                     PIC X(4)    VALUE '0197'.
   623     12  ER-0203                     PIC X(4)    VALUE '0203'.
   624     12  ER-0215                     PIC X(4)    VALUE '0215'.
   625     12  ER-0216                     PIC X(4)    VALUE '0216'.
   626     12  ER-0433                     PIC X(4)    VALUE '0433'.
   627     12  ER-0565                     PIC X(4)    VALUE '0565'.
   628     12  ER-1159                     PIC X(4)    VALUE '1159'.
   629     12  ER-1162                     PIC X(4)    VALUE '1162'.
   630     12  ER-2056                     PIC X(4)    VALUE '2056'.
   631     12  ER-2208                     PIC X(4)    VALUE '2208'.
   632     12  ER-2209                     PIC X(4)    VALUE '2209'.
   633     12  ER-2210                     PIC X(4)    VALUE '2210'.
   634     12  ER-2230                     PIC X(4)    VALUE '2230'.
   635     12  ER-2237                     PIC X(4)    VALUE '2237'.
   636     12  ER-2238                     PIC X(4)    VALUE '2238'.
   637     12  ER-2294                     PIC X(4)    VALUE '2294'.
   638     12  ER-2394                     PIC X(4)    VALUE '2394'.
   639     12  ER-2438                     PIC X(4)    VALUE '2438'.
   640     12  ER-2439                     PIC X(4)    VALUE '2439'.
   641     12  ER-2583                     PIC X(4)    VALUE '2583'.
   642     12  ER-2600                     PIC X(4)    VALUE '2600'.
   643     12  ER-2726                     PIC X(4)    VALUE '2726'.
   644     12  ER-2905                     PIC X(4)    VALUE '2905'.
   645     12  ER-2906                     PIC X(4)    VALUE '2906'.
   646     12  ER-2907                     PIC X(4)    VALUE '2907'.
   647     12  ER-2908                     PIC X(4)    VALUE '2908'.
   648     12  ER-2909                     PIC X(4)    VALUE '2909'.
   649     12  ER-3044                     PIC X(4)    VALUE '3044'.
   650     12  ER-3046                     PIC X(4)    VALUE '3046'.
   651     12  ER-3047                     PIC X(4)    VALUE '3047'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  13
* EL677.cbl
   652     12  ER-3445                     PIC X(4)    VALUE '3445'.
   653     12  er-3450                     pic x(4)    value '3450'.
   654     12  er-3451                     pic x(4)    value '3451'.
   655     12  er-3452                     pic x(4)    value '3452'.
   656     12  er-3453                     pic x(4)    value '3453'.
   657     12  er-3454                     pic x(4)    value '3454'.
   658     12  er-3455                     pic x(4)    value '3455'.
   659     12  ER-7389                     PIC X(4)    VALUE '7389'.
   660*                                    COPY ELCLOGOF.
   661******************************************************************
   662*                                                                *
   663*                                                                *
   664*                            ELCLOGOF.                           *
   665*                            VMOD=2.001                          *
   666*                                                                *
   667*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   668*                                                                *
   669******************************************************************
   670 01  CLASIC-LOGOFF.
   671     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   672     12  LOGOFF-TEXT.
   673         16  FILLER          PIC X(5)    VALUE SPACES.
   674         16  LOGOFF-MSG.
   675             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   676             20  FILLER      PIC X       VALUE SPACES.
   677             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   678         16  FILLER          PIC X(80)
   679           VALUE '* YOU ARE NOW LOGGED OFF'.
   680         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   681         16  FILLER          PIC X       VALUE QUOTE.
   682         16  LOGOFF-SYS-MSG  PIC X(17)
   683           VALUE 'S CLAS-IC SYSTEM '.
   684     12  TEXT-MESSAGES.
   685         16  UNACCESS-MSG    PIC X(29)
   686             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   687         16  PGMIDERR-MSG    PIC X(17)
   688             VALUE 'PROGRAM NOT FOUND'.
   689*                                    COPY ELCDATE.
   690******************************************************************
   691*                                                                *
   692*                                                                *
   693*                            ELCDATE.                            *
   694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   695*                            VMOD=2.003
   696*                                                                *
   697*                                                                *
   698*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   699*                 LENGTH = 200                                   *
   700******************************************************************
   701
   702 01  DATE-CONVERSION-DATA.
   703     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   704     12  DC-OPTION-CODE                PIC X.
   705         88  BIN-TO-GREG                VALUE ' '.
   706         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   707         88  EDIT-GREG-TO-BIN           VALUE '2'.
   708         88  YMD-GREG-TO-BIN            VALUE '3'.
   709         88  MDY-GREG-TO-BIN            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  14
* EL677.cbl
   710         88  JULIAN-TO-BIN              VALUE '5'.
   711         88  BIN-PLUS-ELAPSED           VALUE '6'.
   712         88  FIND-CENTURY               VALUE '7'.
   713         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   714         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   715         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   716         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   717         88  JULIAN-TO-BIN-3            VALUE 'C'.
   718         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   719         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   720         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   721         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   722         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   723         88  CHECK-LEAP-YEAR            VALUE 'H'.
   724         88  BIN-3-TO-GREG              VALUE 'I'.
   725         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   726         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   727         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   728         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   729         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   730         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   731         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   732         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   733         88  THREE-CHARACTER-BIN
   734                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   735         88  GREGORIAN-TO-BIN
   736                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   737         88  BIN-TO-GREGORIAN
   738                  VALUES ' ' '1' 'I' '8' 'G'.
   739         88  JULIAN-TO-BINARY
   740                  VALUES '5' 'C' 'E' 'F'.
   741     12  DC-ERROR-CODE                 PIC X.
   742         88  NO-CONVERSION-ERROR        VALUE ' '.
   743         88  DATE-CONVERSION-ERROR
   744                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   745         88  DATE-IS-ZERO               VALUE '1'.
   746         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   747         88  DATE-IS-INVALID            VALUE '3'.
   748         88  DATE1-GREATER-DATE2        VALUE '4'.
   749         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   750         88  DATE-INVALID-OPTION        VALUE '9'.
   751         88  INVALID-CENTURY            VALUE 'A'.
   752         88  ONLY-CENTURY               VALUE 'B'.
   753         88  ONLY-LEAP-YEAR             VALUE 'C'.
   754         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   755     12  DC-END-OF-MONTH               PIC X.
   756         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   757     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   758         88  USE-NORMAL-PROCESS         VALUE ' '.
   759         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   760         88  ADJUST-UP-100-YRS          VALUE '2'.
   761     12  FILLER                        PIC X.
   762     12  DC-CONVERSION-DATES.
   763         16  DC-BIN-DATE-1             PIC XX.
   764         16  DC-BIN-DATE-2             PIC XX.
   765         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   766         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   767                       DC-GREG-DATE-1-EDIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  15
* EL677.cbl
   768             20  DC-EDIT1-MONTH        PIC 99.
   769             20  SLASH1-1              PIC X.
   770             20  DC-EDIT1-DAY          PIC 99.
   771             20  SLASH1-2              PIC X.
   772             20  DC-EDIT1-YEAR         PIC 99.
   773         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   774         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   775                     DC-GREG-DATE-2-EDIT.
   776             20  DC-EDIT2-MONTH        PIC 99.
   777             20  SLASH2-1              PIC X.
   778             20  DC-EDIT2-DAY          PIC 99.
   779             20  SLASH2-2              PIC X.
   780             20  DC-EDIT2-YEAR         PIC 99.
   781         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   782         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   783                     DC-GREG-DATE-1-YMD.
   784             20  DC-YMD-YEAR           PIC 99.
   785             20  DC-YMD-MONTH          PIC 99.
   786             20  DC-YMD-DAY            PIC 99.
   787         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   788         16  DC-GREG-DATE-1-MDY-R REDEFINES
   789                      DC-GREG-DATE-1-MDY.
   790             20  DC-MDY-MONTH          PIC 99.
   791             20  DC-MDY-DAY            PIC 99.
   792             20  DC-MDY-YEAR           PIC 99.
   793         16  DC-GREG-DATE-1-ALPHA.
   794             20  DC-ALPHA-MONTH        PIC X(10).
   795             20  DC-ALPHA-DAY          PIC 99.
   796             20  FILLER                PIC XX.
   797             20  DC-ALPHA-CENTURY.
   798                 24 DC-ALPHA-CEN-N     PIC 99.
   799             20  DC-ALPHA-YEAR         PIC 99.
   800         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   801         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   802         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   803         16  DC-JULIAN-DATE            PIC 9(05).
   804         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   805                                       PIC 9(05).
   806         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   807             20  DC-JULIAN-YEAR        PIC 99.
   808             20  DC-JULIAN-DAYS        PIC 999.
   809         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   810         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   811         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   812     12  DATE-CONVERSION-VARIBLES.
   813         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   814         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   815             20  FILLER                PIC 9(3).
   816             20  HOLD-CEN-1-CCYY.
   817                 24  HOLD-CEN-1-CC     PIC 99.
   818                 24  HOLD-CEN-1-YY     PIC 99.
   819             20  HOLD-CEN-1-MO         PIC 99.
   820             20  HOLD-CEN-1-DA         PIC 99.
   821         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   822             20  HOLD-CEN-1-R-MO       PIC 99.
   823             20  HOLD-CEN-1-R-DA       PIC 99.
   824             20  HOLD-CEN-1-R-CCYY.
   825                 24  HOLD-CEN-1-R-CC   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  16
* EL677.cbl
   826                 24  HOLD-CEN-1-R-YY   PIC 99.
   827             20  FILLER                PIC 9(3).
   828         16  HOLD-CENTURY-1-X.
   829             20  FILLER                PIC X(3)  VALUE SPACES.
   830             20  HOLD-CEN-1-X-CCYY.
   831                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   832                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   833             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   834             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   835         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   836             20  HOLD-CEN-1-R-X-MO     PIC XX.
   837             20  HOLD-CEN-1-R-X-DA     PIC XX.
   838             20  HOLD-CEN-1-R-X-CCYY.
   839                 24  HOLD-CEN-1-R-X-CC PIC XX.
   840                 24  HOLD-CEN-1-R-X-YY PIC XX.
   841             20  FILLER                PIC XXX.
   842         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   843         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   844         16  DC-JULIAN-DATE-1          PIC 9(07).
   845         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   846             20  DC-JULIAN-1-CCYY.
   847                 24  DC-JULIAN-1-CC    PIC 99.
   848                 24  DC-JULIAN-1-YR    PIC 99.
   849             20  DC-JULIAN-DA-1        PIC 999.
   850         16  DC-JULIAN-DATE-2          PIC 9(07).
   851         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   852             20  DC-JULIAN-2-CCYY.
   853                 24  DC-JULIAN-2-CC    PIC 99.
   854                 24  DC-JULIAN-2-YR    PIC 99.
   855             20  DC-JULIAN-DA-2        PIC 999.
   856         16  DC-GREG-DATE-A-EDIT.
   857             20  DC-EDITA-MONTH        PIC 99.
   858             20  SLASHA-1              PIC X VALUE '/'.
   859             20  DC-EDITA-DAY          PIC 99.
   860             20  SLASHA-2              PIC X VALUE '/'.
   861             20  DC-EDITA-CCYY.
   862                 24  DC-EDITA-CENT     PIC 99.
   863                 24  DC-EDITA-YEAR     PIC 99.
   864         16  DC-GREG-DATE-B-EDIT.
   865             20  DC-EDITB-MONTH        PIC 99.
   866             20  SLASHB-1              PIC X VALUE '/'.
   867             20  DC-EDITB-DAY          PIC 99.
   868             20  SLASHB-2              PIC X VALUE '/'.
   869             20  DC-EDITB-CCYY.
   870                 24  DC-EDITB-CENT     PIC 99.
   871                 24  DC-EDITB-YEAR     PIC 99.
   872         16  DC-GREG-DATE-CYMD         PIC 9(08).
   873         16  DC-GREG-DATE-CYMD-R REDEFINES
   874                              DC-GREG-DATE-CYMD.
   875             20  DC-CYMD-CEN           PIC 99.
   876             20  DC-CYMD-YEAR          PIC 99.
   877             20  DC-CYMD-MONTH         PIC 99.
   878             20  DC-CYMD-DAY           PIC 99.
   879         16  DC-GREG-DATE-MDCY         PIC 9(08).
   880         16  DC-GREG-DATE-MDCY-R REDEFINES
   881                              DC-GREG-DATE-MDCY.
   882             20  DC-MDCY-MONTH         PIC 99.
   883             20  DC-MDCY-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  17
* EL677.cbl
   884             20  DC-MDCY-CEN           PIC 99.
   885             20  DC-MDCY-YEAR          PIC 99.
   886    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   887        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   888    12  DC-EL310-DATE                  PIC X(21).
   889    12  FILLER                         PIC X(28).
   890*                                    COPY ELCATTR.
   891******************************************************************
   892*                                                                *
   893*                            ELCATTR.                            *
   894*                            VMOD=2.001                          *
   895*                                                                *
   896*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   897*                                                                *
   898*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   899*                                                                *
   900*                   POS 1   P=PROTECTED                          *
   901*                           U=UNPROTECTED                        *
   902*                           S=ASKIP                              *
   903*                   POS 2   A=ALPHA/NUMERIC                      *
   904*                           N=NUMERIC                            *
   905*                   POS 3   N=NORMAL                             *
   906*                           B=BRIGHT                             *
   907*                           D=DARK                               *
   908*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   909*                           OF=MODIFIED DATA TAG OFF             *
   910*                                                                *
   911*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   912******************************************************************
   913 01  ATTRIBUTE-LIST.
   914     12  AL-PABOF            PIC X       VALUE 'Y'.
   915     12  AL-PABON            PIC X       VALUE 'Z'.
   916     12  AL-PADOF            PIC X       VALUE '%'.
   917     12  AL-PADON            PIC X       VALUE '_'.
   918     12  AL-PANOF            PIC X       VALUE '-'.
   919     12  AL-PANON            PIC X       VALUE '/'.
   920     12  AL-SABOF            PIC X       VALUE '8'.
   921     12  AL-SABON            PIC X       VALUE '9'.
   922     12  AL-SADOF            PIC X       VALUE '@'.
   923     12  AL-SADON            PIC X       VALUE QUOTE.
   924     12  AL-SANOF            PIC X       VALUE '0'.
   925     12  AL-SANON            PIC X       VALUE '1'.
   926     12  AL-UABOF            PIC X       VALUE 'H'.
   927     12  AL-UABON            PIC X       VALUE 'I'.
   928     12  AL-UADOF            PIC X       VALUE '<'.
   929     12  AL-UADON            PIC X       VALUE '('.
   930     12  AL-UANOF            PIC X       VALUE ' '.
   931     12  AL-UANON            PIC X       VALUE 'A'.
   932     12  AL-UNBOF            PIC X       VALUE 'Q'.
   933     12  AL-UNBON            PIC X       VALUE 'R'.
   934     12  AL-UNDOF            PIC X       VALUE '*'.
   935     12  AL-UNDON            PIC X       VALUE ')'.
   936     12  AL-UNNOF            PIC X       VALUE '&'.
   937     12  AL-UNNON            PIC X       VALUE 'J'.
   938*                                    COPY ELCEMIB.
   939******************************************************************
   940*                                                                *
   941*                                                                *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  18
* EL677.cbl
   942*                            ELCEMIB.                            *
   943*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   944*                            VMOD=2.005                          *
   945*                                                                *
   946*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   947*                                                                *
   948******************************************************************
   949 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   950     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   951     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   952     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   953     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   954     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   955     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   956     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   957     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   958     12  EMI-SWITCH1             PIC X        VALUE '1'.
   959         88  EMI-NO-ERRORS                    VALUE '1'.
   960         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   961         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   962     12  EMI-SWITCH2             PIC X        VALUE '1'.
   963         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   964     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   965         88  EMI-AREA1-EMPTY                  VALUE '1'.
   966         88  EMI-AREA1-FULL                   VALUE '2'.
   967     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   968         88  EMI-AREA2-EMPTY                  VALUE '1'.
   969         88  EMI-AREA2-FULL                   VALUE '2'.
   970     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   971         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   972         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   973         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   974         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   975         88  EMI-BYPASS-FATALS                VALUE 'X'.
   976     12  EMI-ERROR-LINES.
   977         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   978         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   979         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   980         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   981             20  EMI-ERR-CODES OCCURS 10 TIMES.
   982                 24  EMI-ERR-NUM         PIC X(4).
   983                 24  EMI-FILLER          PIC X.
   984                 24  EMI-SEV             PIC X.
   985                 24  FILLER              PIC X.
   986             20  FILLER                  PIC X(02).
   987     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   988         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   989             20  EMI-ERROR-NUMBER    PIC X(4).
   990             20  EMI-FILL            PIC X.
   991             20  EMI-SEVERITY        PIC X.
   992             20  FILLER              PIC X.
   993             20  EMI-ERROR-TEXT.
   994                 24  EMI-TEXT-VARIABLE   PIC X(10).
   995                 24  FILLER          PIC X(55).
   996     12  EMI-SEVERITY-SAVE           PIC X.
   997         88  EMI-NOTE                    VALUE 'N'.
   998         88  EMI-WARNING                 VALUE 'W'.
   999         88  EMI-FORCABLE                VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  19
* EL677.cbl
  1000         88  EMI-FATAL                   VALUE 'X'.
  1001     12  EMI-MESSAGE-FLAG            PIC X.
  1002         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1003         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1004     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1005     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1006         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1007         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1008         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1009     12  emi-claim-no                pic x(7).
  1010     12  emi-claim-type              pic x(6).
  1011     12  FILLER                      PIC X(124)  VALUE SPACES.
  1012     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1013     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1014     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1015     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1016*                                    COPY ELCINTF.
  1017******************************************************************
  1018*                                                                *
  1019*                                                                *
  1020*                            ELCINTF.                            *
  1021*                            VMOD=2.017                          *
  1022*                                                                *
  1023*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1024*                                                                *
  1025*       LENGTH = 1024                                            *
  1026*                                                                *
  1027******************************************************************
  1028*                   C H A N G E   L O G
  1029*
  1030* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1031*-----------------------------------------------------------------
  1032*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1033* EFFECTIVE    NUMBER
  1034*-----------------------------------------------------------------
  1035* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1036******************************************************************
  1037 01  PROGRAM-INTERFACE-BLOCK.
  1038     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1039     12  PI-CALLING-PROGRAM              PIC X(8).
  1040     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1041     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1042     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1043     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1044     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1045     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1046     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1047     12  PI-COMPANY-ID                   PIC XXX.
  1048     12  PI-COMPANY-CD                   PIC X.
  1049
  1050     12  PI-COMPANY-PASSWORD             PIC X(8).
  1051
  1052     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1053
  1054     12  PI-CONTROL-IN-PROGRESS.
  1055         16  PI-CARRIER                  PIC X.
  1056         16  PI-GROUPING                 PIC X(6).
  1057         16  PI-STATE                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  20
* EL677.cbl
  1058         16  PI-ACCOUNT                  PIC X(10).
  1059         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1060                                         PIC X(10).
  1061         16  PI-CLAIM-CERT-GRP.
  1062             20  PI-CLAIM-NO             PIC X(7).
  1063             20  PI-CERT-NO.
  1064                 25  PI-CERT-PRIME       PIC X(10).
  1065                 25  PI-CERT-SFX         PIC X.
  1066             20  PI-CERT-EFF-DT          PIC XX.
  1067         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1068             20  PI-PLAN-CODE            PIC X(2).
  1069             20  PI-REVISION-NUMBER      PIC X(3).
  1070             20  PI-PLAN-EFF-DT          PIC X(2).
  1071             20  PI-PLAN-EXP-DT          PIC X(2).
  1072             20  FILLER                  PIC X(11).
  1073         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1074             20  PI-OE-REFERENCE-1.
  1075                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1076                 25  PI-OE-REF-1-SUFF    PIC XX.
  1077
  1078     12  PI-SESSION-IN-PROGRESS          PIC X.
  1079         88  CLAIM-SESSION                   VALUE '1'.
  1080         88  CREDIT-SESSION                  VALUE '2'.
  1081         88  WARRANTY-SESSION                VALUE '3'.
  1082         88  MORTGAGE-SESSION                VALUE '4'.
  1083         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1084
  1085
  1086*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1087
  1088     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1089     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1090
  1091     12  PI-CREDIT-USER                  PIC X.
  1092         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1093         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1094
  1095     12  PI-CLAIM-USER                   PIC X.
  1096         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1097         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1098
  1099     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1100         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1101         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1102         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1103         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1104         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1105
  1106     12  PI-PROCESSOR-ID                 PIC X(4).
  1107
  1108     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1109
  1110     12  PI-MEMBER-CAPTION               PIC X(10).
  1111
  1112     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1113         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1114
  1115     12  PI-LIFE-OVERRIDE-L1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  21
* EL677.cbl
  1116     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1117     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1118     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1119
  1120     12  PI-AH-OVERRIDE-L1               PIC X.
  1121     12  PI-AH-OVERRIDE-L2               PIC XX.
  1122     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1123     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1124
  1125     12  PI-NEW-SYSTEM                   PIC X(2).
  1126
  1127     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1128     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1129         88  PI-USES-PAID-TO                 VALUE '1'.
  1130     12  PI-CRDTCRD-SYSTEM.
  1131         16  PI-CRDTCRD-USER             PIC X.
  1132             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1133             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1134         16  PI-CC-MONTH-END-DT          PIC XX.
  1135     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1136
  1137     12  PI-OE-REFERENCE-2.
  1138         16  PI-OE-REF-2-PRIME           PIC X(10).
  1139         16  PI-OE-REF-2-SUFF            PIC X.
  1140
  1141     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1142
  1143     12  PI-LANGUAGE-TYPE                PIC X.
  1144             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1145             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1146             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1147
  1148     12  PI-POLICY-LINKAGE-IND           PIC X.
  1149         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1150         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1151                                                   LOW-VALUES.
  1152
  1153     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1154     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1155         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1156         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1157
  1158     12  PI-PROCESSOR-CSR-IND            PIC X.
  1159         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1160         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1161
  1162     12  FILLER                          PIC X(3).
  1163
  1164     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1165
  1166     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1167         PI-SYSTEM-LEVEL.
  1168
  1169         16  PI-ENTRY-CODES.
  1170             20  PI-ENTRY-CD-1           PIC X.
  1171             20  PI-ENTRY-CD-2           PIC X.
  1172
  1173         16  PI-RETURN-CODES.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  22
* EL677.cbl
  1174             20  PI-RETURN-CD-1          PIC X.
  1175             20  PI-RETURN-CD-2          PIC X.
  1176
  1177         16  PI-UPDATE-STATUS-SAVE.
  1178             20  PI-UPDATE-BY            PIC X(4).
  1179             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1180
  1181         16  PI-LOWER-CASE-LETTERS       PIC X.
  1182             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1183
  1184*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1185*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1186*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1187
  1188         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1189             88  ST-ACCNT-CNTL               VALUE ' '.
  1190             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1191             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1192             88  ACCNT-CNTL                  VALUE '3'.
  1193             88  CARR-ACCNT-CNTL             VALUE '4'.
  1194
  1195         16  PI-PROCESSOR-CAP-LIST.
  1196             20  PI-SYSTEM-CONTROLS.
  1197                24 PI-SYSTEM-DISPLAY     PIC X.
  1198                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1199                24 PI-SYSTEM-MODIFY      PIC X.
  1200                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1201             20  FILLER                  PIC XX.
  1202             20  PI-DISPLAY-CAP          PIC X.
  1203                 88  DISPLAY-CAP             VALUE 'Y'.
  1204             20  PI-MODIFY-CAP           PIC X.
  1205                 88  MODIFY-CAP              VALUE 'Y'.
  1206             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1207                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1208             20  PI-FORCE-CAP            PIC X.
  1209                 88  FORCE-CAP               VALUE 'Y'.
  1210
  1211         16  PI-PROGRAM-CONTROLS.
  1212             20  PI-PGM-PRINT-OPT        PIC X.
  1213             20  PI-PGM-FORMAT-OPT       PIC X.
  1214             20  PI-PGM-PROCESS-OPT      PIC X.
  1215             20  PI-PGM-TOTALS-OPT       PIC X.
  1216
  1217         16  PI-HELP-INTERFACE.
  1218             20  PI-LAST-ERROR-NO        PIC X(4).
  1219             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1220
  1221         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1222             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1223
  1224         16  PI-CR-CONTROL-IN-PROGRESS.
  1225             20  PI-CR-CARRIER           PIC X.
  1226             20  PI-CR-GROUPING          PIC X(6).
  1227             20  PI-CR-STATE             PIC XX.
  1228             20  PI-CR-ACCOUNT           PIC X(10).
  1229             20  PI-CR-FIN-RESP          PIC X(10).
  1230             20  PI-CR-TYPE              PIC X.
  1231
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  23
* EL677.cbl
  1232         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1233
  1234         16  PI-CR-MONTH-END-DT          PIC XX.
  1235
  1236         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1237             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1238             88  PI-ZERO-CARRIER             VALUE '1'.
  1239             88  PI-ZERO-GROUPING            VALUE '2'.
  1240             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1241
  1242         16  PI-CARRIER-SECURITY         PIC X.
  1243             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1244
  1245         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1246             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1247             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1248
  1249         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1250             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1251                                         INDEXED BY PI-ACCESS-NDX
  1252                                         PIC X.
  1253
  1254         16  PI-GA-BILLING-CONTROL       PIC X.
  1255             88  PI-GA-BILLING               VALUE '1'.
  1256
  1257         16  PI-MAIL-PROCESSING          PIC X.
  1258             88  PI-MAIL-YES                 VALUE 'Y'.
  1259
  1260         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1261
  1262         16  PI-AR-SYSTEM.
  1263             20  PI-AR-PROCESSING-CNTL   PIC X.
  1264                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1265             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1266             20  PI-AR-MONTH-END-DT      PIC XX.
  1267
  1268         16  PI-MP-SYSTEM.
  1269             20  PI-MORTGAGE-USER            PIC X.
  1270                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1271                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1272             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1273                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1274                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1275                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1276                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1277                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1278             20  PI-MP-MONTH-END-DT          PIC XX.
  1279             20  PI-MP-REFERENCE-NO.
  1280                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1281                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1282
  1283         16  PI-LABEL-CONTROL            PIC X(01).
  1284             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1285             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1286
  1287         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1288             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1289
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  24
* EL677.cbl
  1290         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1291             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1292             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1293
  1294         16  FILLER                      PIC X(14).
  1295
  1296     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1297******************************************************************
  1298     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1299         16  PI-EOF-SW               PIC X.
  1300             88  PI-FILE-EOF                     VALUE 'Y'.
  1301         16  PI-PREV-MAINT           PIC X.
  1302         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1303         16  PI-ERCHEK-KEY.
  1304             20  PI-CHEK-COMP-CD     PIC X.
  1305             20  PI-CHEK-CARRIER     PIC X.
  1306             20  PI-CHEK-GROUPING    PIC X(6).
  1307             20  PI-CHEK-STATE       PIC XX.
  1308             20  PI-CHEK-ACCOUNT     PIC X(10).
  1309             20  PI-CHEK-EFF-DT      PIC XX.
  1310             20  PI-CHEK-CERT-NO     PIC X(10).
  1311             20  PI-CHEK-SUF-NO      PIC X.
  1312             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1313         16  PI-ACCOUNT-ADDRESS.
  1314             20  PI-AM-NAME          PIC X(30).
  1315             20  PI-AM-ADDRS         PIC X(30).
  1316             20  PI-AM-CITY-st.
  1317                 24  pi-am-city      PIC X(28).
  1318                 24  pi-am-st        pic xx.
  1319             20  PI-AM-ZIP-CODE.
  1320                 24  PI-AM-ZIP-PRIME PIC X(5).
  1321                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1322         16  PI-PROCESS-CERT-SW          PIC X.
  1323             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1324         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1325             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1326         16  PI-PAYTO1                   PIC X(30).
  1327         16  PI-REFERENCE                PIC X(12).
  1328         16  PI-CANC-DT                  PIC XX.
  1329         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1330         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1331         16  PI-INSURED-NAME             PIC X(28).
  1332         16  PI-PFKEY                    PIC XXX.
  1333             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1334             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1335         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1336         16  PI-TYPE                     PIC X.
  1337         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1338         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1339         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1340         16  pi-chek-rec-cnt             pic s999 comp-3.
  1341         16  pi-am-csr                   pic x(4).
  1342         16  pi-return-to                pic x(30).
  1343         16  pi-prev-ded-comm            pic x.
  1344         16  pi-table-name               pic x(30).
  1345         16  FILLER                      PIC X(354).
  1346*                                    COPY ELCAID.
  1347******************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  25
* EL677.cbl
  1348*                                                                *
  1349*                            ELCAID.                             *
  1350*                            VMOD=2.001                          *
  1351*                                                                *
  1352*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1353*                                                                *
  1354*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1355*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1356******************************************************************
  1357
  1358 01  DFHAID.
  1359   02  DFHNULL   PIC  X  VALUE  ' '.
  1360   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1361   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1362   02  DFHPEN    PIC  X  VALUE  '='.
  1363   02  DFHOPID   PIC  X  VALUE  'W'.
  1364   02  DFHPA1    PIC  X  VALUE  '%'.
  1365   02  DFHPA2    PIC  X  VALUE  '>'.
  1366   02  DFHPA3    PIC  X  VALUE  ','.
  1367   02  DFHPF1    PIC  X  VALUE  '1'.
  1368   02  DFHPF2    PIC  X  VALUE  '2'.
  1369   02  DFHPF3    PIC  X  VALUE  '3'.
  1370   02  DFHPF4    PIC  X  VALUE  '4'.
  1371   02  DFHPF5    PIC  X  VALUE  '5'.
  1372   02  DFHPF6    PIC  X  VALUE  '6'.
  1373   02  DFHPF7    PIC  X  VALUE  '7'.
  1374   02  DFHPF8    PIC  X  VALUE  '8'.
  1375   02  DFHPF9    PIC  X  VALUE  '9'.
  1376   02  DFHPF10   PIC  X  VALUE  ':'.
  1377   02  DFHPF11   PIC  X  VALUE  '#'.
  1378   02  DFHPF12   PIC  X  VALUE  '@'.
  1379   02  DFHPF13   PIC  X  VALUE  'A'.
  1380   02  DFHPF14   PIC  X  VALUE  'B'.
  1381   02  DFHPF15   PIC  X  VALUE  'C'.
  1382   02  DFHPF16   PIC  X  VALUE  'D'.
  1383   02  DFHPF17   PIC  X  VALUE  'E'.
  1384   02  DFHPF18   PIC  X  VALUE  'F'.
  1385   02  DFHPF19   PIC  X  VALUE  'G'.
  1386   02  DFHPF20   PIC  X  VALUE  'H'.
  1387   02  DFHPF21   PIC  X  VALUE  'I'.
  1388*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1389   02  DFHPF22   PIC  X  VALUE  '['.
  1390   02  DFHPF23   PIC  X  VALUE  '.'.
  1391   02  DFHPF24   PIC  X  VALUE  '<'.
  1392   02  DFHMSRE   PIC  X  VALUE  'X'.
  1393   02  DFHSTRF   PIC  X  VALUE  'h'.
  1394   02  DFHTRIG   PIC  X  VALUE  '"'.
  1395 01  FILLER    REDEFINES DFHAID.
  1396     12  FILLER                      PIC X(8).
  1397     12  PF-VALUES                   PIC X       OCCURS 24.
  1398     12  FILLER                      PIC X(3).
  1399*                                    COPY EL677S.
  1400 01  EL677AI.
  1401     05  FILLER            PIC  X(0012).
  1402*    -------------------------------
  1403     05  DATEL PIC S9(0004) COMP.
  1404     05  DATEF PIC  X(0001).
  1405     05  FILLER REDEFINES DATEF.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  26
* EL677.cbl
  1406         10  DATEA PIC  X(0001).
  1407     05  DATEI PIC  X(0008).
  1408*    -------------------------------
  1409     05  TIMEL PIC S9(0004) COMP.
  1410     05  TIMEF PIC  X(0001).
  1411     05  FILLER REDEFINES TIMEF.
  1412         10  TIMEA PIC  X(0001).
  1413     05  TIMEI PIC  X(0005).
  1414*    -------------------------------
  1415     05  MAINTL PIC S9(0004) COMP.
  1416     05  MAINTF PIC  X(0001).
  1417     05  FILLER REDEFINES MAINTF.
  1418         10  MAINTA PIC  X(0001).
  1419     05  MAINTI PIC  X(0001).
  1420*    -------------------------------
  1421     05  DMAINT1L PIC S9(0004) COMP.
  1422     05  DMAINT1F PIC  X(0001).
  1423     05  FILLER REDEFINES DMAINT1F.
  1424         10  DMAINT1A PIC  X(0001).
  1425     05  DMAINT1I PIC  X(0009).
  1426*    -------------------------------
  1427     05  DMAINT2L PIC S9(0004) COMP.
  1428     05  DMAINT2F PIC  X(0001).
  1429     05  FILLER REDEFINES DMAINT2F.
  1430         10  DMAINT2A PIC  X(0001).
  1431     05  DMAINT2I PIC  X(0029).
  1432*    -------------------------------
  1433     05  CARRIERL PIC S9(0004) COMP.
  1434     05  CARRIERF PIC  X(0001).
  1435     05  FILLER REDEFINES CARRIERF.
  1436         10  CARRIERA PIC  X(0001).
  1437     05  CARRIERI PIC  X(0001).
  1438*    -------------------------------
  1439     05  GROUPL PIC S9(0004) COMP.
  1440     05  GROUPF PIC  X(0001).
  1441     05  FILLER REDEFINES GROUPF.
  1442         10  GROUPA PIC  X(0001).
  1443     05  GROUPI PIC  X(0006).
  1444*    -------------------------------
  1445     05  STATEL PIC S9(0004) COMP.
  1446     05  STATEF PIC  X(0001).
  1447     05  FILLER REDEFINES STATEF.
  1448         10  STATEA PIC  X(0001).
  1449     05  STATEI PIC  X(0002).
  1450*    -------------------------------
  1451     05  ACCTL PIC S9(0004) COMP.
  1452     05  ACCTF PIC  X(0001).
  1453     05  FILLER REDEFINES ACCTF.
  1454         10  ACCTA PIC  X(0001).
  1455     05  ACCTI PIC  X(0010).
  1456*    -------------------------------
  1457     05  EFFDTL PIC S9(0004) COMP.
  1458     05  EFFDTF PIC  X(0001).
  1459     05  FILLER REDEFINES EFFDTF.
  1460         10  EFFDTA PIC  X(0001).
  1461     05  EFFDTI PIC  X(0008).
  1462*    -------------------------------
  1463     05  CERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  27
* EL677.cbl
  1464     05  CERTNOF PIC  X(0001).
  1465     05  FILLER REDEFINES CERTNOF.
  1466         10  CERTNOA PIC  X(0001).
  1467     05  CERTNOI PIC  X(0010).
  1468*    -------------------------------
  1469     05  SFXL PIC S9(0004) COMP.
  1470     05  SFXF PIC  X(0001).
  1471     05  FILLER REDEFINES SFXF.
  1472         10  SFXA PIC  X(0001).
  1473     05  SFXI PIC  X(0001).
  1474*    -------------------------------
  1475     05  SEQL PIC S9(0004) COMP.
  1476     05  SEQF PIC  X(0001).
  1477     05  FILLER REDEFINES SEQF.
  1478         10  SEQA PIC  X(0001).
  1479     05  SEQI PIC  99.
  1480*    -------------------------------
  1481     05  PAYTO1L PIC S9(0004) COMP.
  1482     05  PAYTO1F PIC  X(0001).
  1483     05  FILLER REDEFINES PAYTO1F.
  1484         10  PAYTO1A PIC  X(0001).
  1485     05  PAYTO1I PIC  X(0030).
  1486*    -------------------------------
  1487     05  CREATEDL PIC S9(0004) COMP.
  1488     05  CREATEDF PIC  X(0001).
  1489     05  FILLER REDEFINES CREATEDF.
  1490         10  CREATEDA PIC  X(0001).
  1491     05  CREATEDI PIC  X(0008).
  1492*    -------------------------------
  1493     05  CBYL PIC S9(0004) COMP.
  1494     05  CBYF PIC  X(0001).
  1495     05  FILLER REDEFINES CBYF.
  1496         10  CBYA PIC  X(0001).
  1497     05  CBYI PIC  X(0004).
  1498*    -------------------------------
  1499     05  PAYTO2L PIC S9(0004) COMP.
  1500     05  PAYTO2F PIC  X(0001).
  1501     05  FILLER REDEFINES PAYTO2F.
  1502         10  PAYTO2A PIC  X(0001).
  1503     05  PAYTO2I PIC  X(0030).
  1504*    -------------------------------
  1505     05  PAYEEL PIC S9(0004) COMP.
  1506     05  PAYEEF PIC  X(0001).
  1507     05  FILLER REDEFINES PAYEEF.
  1508         10  PAYEEA PIC  X(0001).
  1509     05  PAYEEI PIC  X(0006).
  1510*    -------------------------------
  1511     05  APVSTATL PIC S9(0004) COMP.
  1512     05  APVSTATF PIC  X(0001).
  1513     05  FILLER REDEFINES APVSTATF.
  1514         10  APVSTATA PIC  X(0001).
  1515     05  APVSTATI PIC  X(0009).
  1516*    -------------------------------
  1517     05  PAYAD1L PIC S9(0004) COMP.
  1518     05  PAYAD1F PIC  X(0001).
  1519     05  FILLER REDEFINES PAYAD1F.
  1520         10  PAYAD1A PIC  X(0001).
  1521     05  PAYAD1I PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  28
* EL677.cbl
  1522*    -------------------------------
  1523     05  APVDTL PIC S9(0004) COMP.
  1524     05  APVDTF PIC  X(0001).
  1525     05  FILLER REDEFINES APVDTF.
  1526         10  APVDTA PIC  X(0001).
  1527     05  APVDTI PIC  X(0008).
  1528*    -------------------------------
  1529     05  APVBYL PIC S9(0004) COMP.
  1530     05  APVBYF PIC  X(0001).
  1531     05  FILLER REDEFINES APVBYF.
  1532         10  APVBYA PIC  X(0001).
  1533     05  APVBYI PIC  X(0004).
  1534*    -------------------------------
  1535     05  PAYAD2L PIC S9(0004) COMP.
  1536     05  PAYAD2F PIC  X(0001).
  1537     05  FILLER REDEFINES PAYAD2F.
  1538         10  PAYAD2A PIC  X(0001).
  1539     05  PAYAD2I PIC  X(0030).
  1540*    -------------------------------
  1541     05  VOIDEDL PIC S9(0004) COMP.
  1542     05  VOIDEDF PIC  X(0001).
  1543     05  FILLER REDEFINES VOIDEDF.
  1544         10  VOIDEDA PIC  X(0001).
  1545     05  VOIDEDI PIC  X(0008).
  1546*    -------------------------------
  1547     05  VBYL PIC S9(0004) COMP.
  1548     05  VBYF PIC  X(0001).
  1549     05  FILLER REDEFINES VBYF.
  1550         10  VBYA PIC  X(0001).
  1551     05  VBYI PIC  X(0004).
  1552*    -------------------------------
  1553     05  PAYCTYL PIC S9(0004) COMP.
  1554     05  PAYCTYF PIC  X(0001).
  1555     05  FILLER REDEFINES PAYCTYF.
  1556         10  PAYCTYA PIC  X(0001).
  1557     05  PAYCTYI PIC  X(0028).
  1558*    -------------------------------
  1559     05  PAYSTL PIC S9(0004) COMP.
  1560     05  PAYSTF PIC  X(0001).
  1561     05  FILLER REDEFINES PAYSTF.
  1562         10  PAYSTA PIC  X(0001).
  1563     05  PAYSTI PIC  X(0002).
  1564*    -------------------------------
  1565     05  PRINTEDL PIC S9(0004) COMP.
  1566     05  PRINTEDF PIC  X(0001).
  1567     05  FILLER REDEFINES PRINTEDF.
  1568         10  PRINTEDA PIC  X(0001).
  1569     05  PRINTEDI PIC  X(0008).
  1570*    -------------------------------
  1571     05  PTOZIPL PIC S9(0004) COMP.
  1572     05  PTOZIPF PIC  X(0001).
  1573     05  FILLER REDEFINES PTOZIPF.
  1574         10  PTOZIPA PIC  X(0001).
  1575     05  PTOZIPI PIC  X(0009).
  1576*    -------------------------------
  1577     05  DEDCYNL PIC S9(0004) COMP.
  1578     05  DEDCYNF PIC  X(0001).
  1579     05  FILLER REDEFINES DEDCYNF.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  29
* EL677.cbl
  1580         10  DEDCYNA PIC  X(0001).
  1581     05  DEDCYNI PIC  X(0001).
  1582*    -------------------------------
  1583     05  CASHEDL PIC S9(0004) COMP.
  1584     05  CASHEDF PIC  X(0001).
  1585     05  FILLER REDEFINES CASHEDF.
  1586         10  CASHEDA PIC  X(0001).
  1587     05  CASHEDI PIC  X(0008).
  1588*    -------------------------------
  1589     05  RETTOL PIC S9(0004) COMP.
  1590     05  RETTOF PIC  X(0001).
  1591     05  FILLER REDEFINES RETTOF.
  1592         10  RETTOA PIC  X(0001).
  1593     05  RETTOI PIC  X(0030).
  1594*    -------------------------------
  1595     05  DPREML PIC S9(0004) COMP.
  1596     05  DPREMF PIC  X(0001).
  1597     05  FILLER REDEFINES DPREMF.
  1598         10  DPREMA PIC  X(0001).
  1599     05  DPREMI PIC  X(0005).
  1600*    -------------------------------
  1601     05  PREML PIC S9(0004) COMP.
  1602     05  PREMF PIC  X(0001).
  1603     05  FILLER REDEFINES PREMF.
  1604         10  PREMA PIC  X(0001).
  1605     05  PREMI PIC  X(0008).
  1606*    -------------------------------
  1607     05  DCOMML PIC S9(0004) COMP.
  1608     05  DCOMMF PIC  X(0001).
  1609     05  FILLER REDEFINES DCOMMF.
  1610         10  DCOMMA PIC  X(0001).
  1611     05  DCOMMI PIC  X(0005).
  1612*    -------------------------------
  1613     05  ISSCOMML PIC S9(0004) COMP.
  1614     05  ISSCOMMF PIC  X(0001).
  1615     05  FILLER REDEFINES ISSCOMMF.
  1616         10  ISSCOMMA PIC  X(0001).
  1617     05  ISSCOMMI PIC  X(0008).
  1618*    -------------------------------
  1619     05  DREFL PIC S9(0004) COMP.
  1620     05  DREFF PIC  X(0001).
  1621     05  FILLER REDEFINES DREFF.
  1622         10  DREFA PIC  X(0001).
  1623     05  DREFI PIC  X(0004).
  1624*    -------------------------------
  1625     05  REFL PIC S9(0004) COMP.
  1626     05  REFF PIC  X(0001).
  1627     05  FILLER REDEFINES REFF.
  1628         10  REFA PIC  X(0001).
  1629     05  REFI PIC  X(0008).
  1630*    -------------------------------
  1631     05  DUECOMML PIC S9(0004) COMP.
  1632     05  DUECOMMF PIC  X(0001).
  1633     05  FILLER REDEFINES DUECOMMF.
  1634         10  DUECOMMA PIC  X(0001).
  1635     05  DUECOMMI PIC  X(0007).
  1636*    -------------------------------
  1637     05  UECOMML PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  30
* EL677.cbl
  1638     05  UECOMMF PIC  X(0001).
  1639     05  FILLER REDEFINES UECOMMF.
  1640         10  UECOMMA PIC  X(0001).
  1641     05  UECOMMI PIC  X(0008).
  1642*    -------------------------------
  1643     05  DPREPDL PIC S9(0004) COMP.
  1644     05  DPREPDF PIC  X(0001).
  1645     05  FILLER REDEFINES DPREPDF.
  1646         10  DPREPDA PIC  X(0001).
  1647     05  DPREPDI PIC  X(0006).
  1648*    -------------------------------
  1649     05  PREPDL PIC S9(0004) COMP.
  1650     05  PREPDF PIC  X(0001).
  1651     05  FILLER REDEFINES PREPDF.
  1652         10  PREPDA PIC  X(0001).
  1653     05  PREPDI PIC  X(0008).
  1654*    -------------------------------
  1655     05  AMOUNTL PIC S9(0004) COMP.
  1656     05  AMOUNTF PIC  X(0001).
  1657     05  FILLER REDEFINES AMOUNTF.
  1658         10  AMOUNTA PIC  X(0001).
  1659     05  AMOUNTI PIC  S9(9)V99.
  1660*    -------------------------------
  1661     05  CHECKL PIC S9(0004) COMP.
  1662     05  CHECKF PIC  X(0001).
  1663     05  FILLER REDEFINES CHECKF.
  1664         10  CHECKA PIC  X(0001).
  1665     05  CHECKI PIC  X(0007).
  1666*    -------------------------------
  1667     05  TYPEL PIC S9(0004) COMP.
  1668     05  TYPEF PIC  X(0001).
  1669     05  FILLER REDEFINES TYPEF.
  1670         10  TYPEA PIC  X(0001).
  1671     05  TYPEI PIC  X(0001).
  1672*    -------------------------------
  1673     05  REASONL PIC S9(0004) COMP.
  1674     05  REASONF PIC  X(0001).
  1675     05  FILLER REDEFINES REASONF.
  1676         10  REASONA PIC  X(0001).
  1677     05  REASONI PIC  X(0025).
  1678*    -------------------------------
  1679     05  VREASONL PIC S9(0004) COMP.
  1680     05  VREASONF PIC  X(0001).
  1681     05  FILLER REDEFINES VREASONF.
  1682         10  VREASONA PIC  X(0001).
  1683     05  VREASONI PIC  X(0024).
  1684*    -------------------------------
  1685     05  STUBL PIC S9(0004) COMP.
  1686     05  STUBF PIC  X(0001).
  1687     05  FILLER REDEFINES STUBF.
  1688         10  STUBA PIC  X(0001).
  1689     05  STUBI PIC  X(0030).
  1690*    -------------------------------
  1691     05  TEXT1L PIC S9(0004) COMP.
  1692     05  TEXT1F PIC  X(0001).
  1693     05  FILLER REDEFINES TEXT1F.
  1694         10  TEXT1A PIC  X(0001).
  1695     05  TEXT1I PIC  X(0050).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  31
* EL677.cbl
  1696*    -------------------------------
  1697     05  TEXT2L PIC S9(0004) COMP.
  1698     05  TEXT2F PIC  X(0001).
  1699     05  FILLER REDEFINES TEXT2F.
  1700         10  TEXT2A PIC  X(0001).
  1701     05  TEXT2I PIC  X(0050).
  1702*    -------------------------------
  1703     05  TEXT3L PIC S9(0004) COMP.
  1704     05  TEXT3F PIC  X(0001).
  1705     05  FILLER REDEFINES TEXT3F.
  1706         10  TEXT3A PIC  X(0001).
  1707     05  TEXT3I PIC  X(0040).
  1708*    -------------------------------
  1709     05  ERRMSG1L PIC S9(0004) COMP.
  1710     05  ERRMSG1F PIC  X(0001).
  1711     05  FILLER REDEFINES ERRMSG1F.
  1712         10  ERRMSG1A PIC  X(0001).
  1713     05  ERRMSG1I PIC  X(0079).
  1714*    -------------------------------
  1715     05  ERRMSG2L PIC S9(0004) COMP.
  1716     05  ERRMSG2F PIC  X(0001).
  1717     05  FILLER REDEFINES ERRMSG2F.
  1718         10  ERRMSG2A PIC  X(0001).
  1719     05  ERRMSG2I PIC  X(0079).
  1720*    -------------------------------
  1721     05  PFENTERL PIC S9(0004) COMP.
  1722     05  PFENTERF PIC  X(0001).
  1723     05  FILLER REDEFINES PFENTERF.
  1724         10  PFENTERA PIC  X(0001).
  1725     05  PFENTERI PIC  9(2).
  1726*    -------------------------------
  1727     05  PF357L PIC S9(0004) COMP.
  1728     05  PF357F PIC  X(0001).
  1729     05  FILLER REDEFINES PF357F.
  1730         10  PF357A PIC  X(0001).
  1731     05  PF357I PIC  X(0050).
  1732*    -------------------------------
  1733     05  PF46L PIC S9(0004) COMP.
  1734     05  PF46F PIC  X(0001).
  1735     05  FILLER REDEFINES PF46F.
  1736         10  PF46A PIC  X(0001).
  1737     05  PF46I PIC  X(0033).
  1738 01  EL677AO REDEFINES EL677AI.
  1739     05  FILLER            PIC  X(0012).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  DATEO PIC  X(0008).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  TIMEO PIC  99.99.
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  MAINTO PIC  X(0001).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  DMAINT1O PIC  X(0009).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  32
* EL677.cbl
  1754     05  DMAINT2O PIC  X(0029).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  CARRIERO PIC  X(0001).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  GROUPO PIC  X(0006).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  STATEO PIC  X(0002).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  ACCTO PIC  X(0010).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  EFFDTO PIC  99B99B99.
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  CERTNOO PIC  X(0010).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  SFXO PIC  X(0001).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  SEQO PIC  99.
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  PAYTO1O PIC  X(0030).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  CREATEDO PIC  X(0008).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  CBYO PIC  X(0004).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  PAYTO2O PIC  X(0030).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  PAYEEO PIC  X(0006).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  APVSTATO PIC  X(0009).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  PAYAD1O PIC  X(0030).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  APVDTO PIC  X(0008).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  APVBYO PIC  X(0004).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  PAYAD2O PIC  X(0030).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  VOIDEDO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  33
* EL677.cbl
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  VBYO PIC  X(0004).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  PAYCTYO PIC  X(0028).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  PAYSTO PIC  X(0002).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  PRINTEDO PIC  99B99B99.
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  PTOZIPO PIC  X(0009).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  DEDCYNO PIC  X(0001).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  CASHEDO PIC  X(0008).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  RETTOO PIC  X(0030).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  DPREMO PIC  X(0005).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  PREMO PIC  Z(5).99.
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  DCOMMO PIC  X(0005).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  ISSCOMMO PIC  Z(5).99.
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  DREFO PIC  X(0004).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  REFO PIC  Z(5).99.
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  DUECOMMO PIC  X(0007).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  UECOMMO PIC  Z(5).99.
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  DPREPDO PIC  X(0006).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  PREPDO PIC  Z(5).99.
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  AMOUNTO PIC  Z(7).ZZ-.
  1869*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  34
* EL677.cbl
  1870     05  FILLER            PIC  X(0003).
  1871     05  CHECKO PIC  X(0007).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  TYPEO PIC  X(0001).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  REASONO PIC  X(0025).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  VREASONO PIC  X(0024).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  STUBO PIC  X(0030).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  TEXT1O PIC  X(0050).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  TEXT2O PIC  X(0050).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  TEXT3O PIC  X(0040).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  ERRMSG1O PIC  X(0079).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  ERRMSG2O PIC  X(0079).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  PFENTERO PIC  99.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  PF357O PIC  X(0050).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  PF46O PIC  X(0033).
  1908*    -------------------------------
  1909****************************************************************
  1910*
  1911* Copyright (c) 2007 by Clerity Solutions, Inc.
  1912* All rights reserved.
  1913*
  1914****************************************************************
  1915 01  DFHEIV.
  1916   02  DFHEIV0               PIC X(35).
  1917   02  DFHEIV1               PIC X(08).
  1918   02  DFHEIV2               PIC X(08).
  1919   02  DFHEIV3               PIC X(08).
  1920   02  DFHEIV4               PIC X(06).
  1921   02  DFHEIV5               PIC X(04).
  1922   02  DFHEIV6               PIC X(04).
  1923   02  DFHEIV7               PIC X(02).
  1924   02  DFHEIV8               PIC X(02).
  1925   02  DFHEIV9               PIC X(01).
  1926   02  DFHEIV10              PIC S9(7) COMP-3.
  1927   02  DFHEIV11              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  35
* EL677.cbl
  1928   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1929   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1930   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1931   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1932   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1933   02  DFHEIV17              PIC X(04).
  1934   02  DFHEIV18              PIC X(04).
  1935   02  DFHEIV19              PIC X(04).
  1936   02  DFHEIV20              USAGE IS POINTER.
  1937   02  DFHEIV21              USAGE IS POINTER.
  1938   02  DFHEIV22              USAGE IS POINTER.
  1939   02  DFHEIV23              USAGE IS POINTER.
  1940   02  DFHEIV24              USAGE IS POINTER.
  1941   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1942   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1943   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1944   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1945   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1946   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1947   02  FILLER                PIC X(02).
  1948   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1949   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1950   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1951   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1952   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1953 LINKAGE  SECTION.
  1954*****************************************************************
  1955*                                                               *
  1956* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1957* All rights reserved.                                          *
  1958*                                                               *
  1959*****************************************************************
  1960 01  dfheiblk.
  1961     02  eibtime          pic s9(7) comp-3.
  1962     02  eibdate          pic s9(7) comp-3.
  1963     02  eibtrnid         pic x(4).
  1964     02  eibtaskn         pic s9(7) comp-3.
  1965     02  eibtrmid         pic x(4).
  1966     02  dfheigdi         pic s9(4) comp.
  1967     02  eibcposn         pic s9(4) comp.
  1968     02  eibcalen         pic s9(4) comp.
  1969     02  eibaid           pic x(1).
  1970     02  eibfiller1       pic x(1).
  1971     02  eibfn            pic x(2).
  1972     02  eibfiller2       pic x(2).
  1973     02  eibrcode         pic x(6).
  1974     02  eibfiller3       pic x(2).
  1975     02  eibds            pic x(8).
  1976     02  eibreqid         pic x(8).
  1977     02  eibrsrce         pic x(8).
  1978     02  eibsync          pic x(1).
  1979     02  eibfree          pic x(1).
  1980     02  eibrecv          pic x(1).
  1981     02  eibsend          pic x(1).
  1982     02  eibatt           pic x(1).
  1983     02  eibeoc           pic x(1).
  1984     02  eibfmh           pic x(1).
  1985     02  eibcompl         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  36
* EL677.cbl
  1986     02  eibsig           pic x(1).
  1987     02  eibconf          pic x(1).
  1988     02  eiberr           pic x(1).
  1989     02  eibrldbk         pic x(1).
  1990     02  eiberrcd         pic x(4).
  1991     02  eibsynrb         pic x(1).
  1992     02  eibnodat         pic x(1).
  1993     02  eibfiller5       pic x(2).
  1994     02  eibresp          pic 9(09) comp.
  1995     02  eibresp2         pic 9(09) comp.
  1996     02  dfheigdj         pic s9(4) comp.
  1997     02  dfheigdk         pic s9(4) comp.
  1998 01  DFHCOMMAREA                     PIC X(1024).
  1999*                                    COPY ELCCNTL.
  2000******************************************************************
  2001*                                                                *
  2002*                                                                *
  2003*                            ELCCNTL.                            *
  2004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2005*                            VMOD=2.059                          *
  2006*                                                                *
  2007*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2008*                                                                *
  2009*   FILE TYPE = VSAM,KSDS                                        *
  2010*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2011*                                                                *
  2012*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2013*       ALTERNATE INDEX = NONE                                   *
  2014*                                                                *
  2015*   LOG = YES                                                    *
  2016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2017******************************************************************
  2018*                   C H A N G E   L O G
  2019*
  2020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2021*-----------------------------------------------------------------
  2022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2023* EFFECTIVE    NUMBER
  2024*-----------------------------------------------------------------
  2025* 082503                   PEMA  ADD BENEFIT GROUP
  2026* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2027* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2028* 092705    2005050300006  PEMA  ADD SPP LEASES
  2029* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2030* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2031* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2032* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2033* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2034* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2035* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2036* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2037* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2038******************************************************************
  2039*
  2040 01  CONTROL-FILE.
  2041     12  CF-RECORD-ID                       PIC XX.
  2042         88  VALID-CF-ID                        VALUE 'CF'.
  2043
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  37
* EL677.cbl
  2044     12  CF-CONTROL-PRIMARY.
  2045         16  CF-COMPANY-ID                  PIC XXX.
  2046         16  CF-RECORD-TYPE                 PIC X.
  2047             88  CF-COMPANY-MASTER              VALUE '1'.
  2048             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2049             88  CF-STATE-MASTER                VALUE '3'.
  2050             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2051             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2052             88  CF-CARRIER-MASTER              VALUE '6'.
  2053             88  CF-MORTALITY-MASTER            VALUE '7'.
  2054             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2055             88  CF-TERMINAL-MASTER             VALUE '9'.
  2056             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2057             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2058             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2059             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2060             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2061             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2062             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2063             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2064             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2065         16  CF-ACCESS-CD-GENL              PIC X(4).
  2066         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2067             20  CF-PROCESSOR               PIC X(4).
  2068         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2069             20  CF-STATE-CODE              PIC XX.
  2070             20  FILLER                     PIC XX.
  2071         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2072             20  FILLER                     PIC XX.
  2073             20  CF-HI-BEN-IN-REC           PIC XX.
  2074         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2075             20  FILLER                     PIC XXX.
  2076             20  CF-CARRIER-CNTL            PIC X.
  2077         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2078             20  FILLER                     PIC XX.
  2079             20  CF-HI-TYPE-IN-REC          PIC 99.
  2080         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2081             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2082                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2083             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2084             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2085         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2086             20  FILLER                     PIC X.
  2087             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2088         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2089             20  FILLER                     PIC XX.
  2090             20  CF-MORTGAGE-PLAN           PIC XX.
  2091         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2092
  2093     12  CF-LAST-MAINT-DT                   PIC XX.
  2094     12  CF-LAST-MAINT-BY                   PIC X(4).
  2095     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2096
  2097     12  CF-RECORD-BODY                     PIC X(728).
  2098
  2099
  2100****************************************************************
  2101*             COMPANY MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  38
* EL677.cbl
  2102****************************************************************
  2103
  2104     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2105         16  CF-COMPANY-ADDRESS.
  2106             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2107             20  CF-CL-IN-CARE-OF           PIC X(30).
  2108             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2109             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2110             20  CF-CL-CITY-STATE           PIC X(30).
  2111             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2112             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2113         16  CF-COMPANY-CD                  PIC X.
  2114         16  CF-COMPANY-PASSWORD            PIC X(8).
  2115         16  CF-SECURITY-OPTION             PIC X.
  2116             88  ALL-SECURITY                   VALUE '1'.
  2117             88  COMPANY-VERIFY                 VALUE '2'.
  2118             88  PROCESSOR-VERIFY               VALUE '3'.
  2119             88  NO-SECURITY                    VALUE '4'.
  2120             88  ALL-BUT-TERM                   VALUE '5'.
  2121         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2122             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2123         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2124             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2125         16  CF-INFORCE-LOCATION            PIC X.
  2126             88  CERTS-ARE-ONLINE               VALUE '1'.
  2127             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2128             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2129         16  CF-LOWER-CASE-LETTERS          PIC X.
  2130         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2131             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2132             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2133             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2134             88  CF-ACCNT-CNTL                  VALUE '3'.
  2135             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2136
  2137         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2138         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2139
  2140         16  CF-LGX-CREDIT-USER             PIC X.
  2141             88  CO-IS-NOT-USER                 VALUE 'N'.
  2142             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2143
  2144         16 CF-CREDIT-CALC-CODES.
  2145             20  CF-CR-REM-TERM-CALC PIC X.
  2146               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2147               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2148               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2149               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2150               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2151               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2152               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2153             20  CF-CR-R78-METHOD           PIC X.
  2154               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2155               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2156
  2157         16  CF-CLAIM-CONTROL-COUNTS.
  2158             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2159                 88  CO-CLM-COUNT-RESET         VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  39
* EL677.cbl
  2160
  2161             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2162                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2163
  2164             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2165                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2166
  2167             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2168                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2169
  2170         16  CF-CURRENT-MONTH-END           PIC XX.
  2171
  2172         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2173             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2174             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2175             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2176             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2177                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2178                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2179             20  CF-CO-PREM-REJECT-SW       PIC X.
  2180                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2181                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2182             20  CF-CO-REF-REJECT-SW        PIC X.
  2183                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2184                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2185
  2186         16  CF-CO-REPORTING-DT             PIC XX.
  2187         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2188         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2189           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2190           88  CF-CO-MONTH-END                  VALUE '1'.
  2191
  2192         16  CF-LGX-CLAIM-USER              PIC X.
  2193             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2194             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2195
  2196         16  CF-CREDIT-EDIT-CONTROLS.
  2197             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2198             20  CF-MIN-AGE                 PIC 99.
  2199             20  CF-DEFAULT-AGE             PIC 99.
  2200             20  CF-MIN-TERM                PIC S999      COMP-3.
  2201             20  CF-MAX-TERM                PIC S999      COMP-3.
  2202             20  CF-DEFAULT-SEX             PIC X.
  2203             20  CF-JOINT-AGE-INPUT         PIC X.
  2204                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2205             20  CF-BIRTH-DATE-INPUT        PIC X.
  2206                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2207             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2208                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2209                 88  CF-ZERO-CARRIER            VALUE '1'.
  2210                 88  CF-ZERO-GROUPING           VALUE '2'.
  2211                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2212             20  CF-EDIT-SW                 PIC X.
  2213                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2214             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2215             20  CF-CR-PR-METHOD            PIC X.
  2216               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2217               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  40
* EL677.cbl
  2218             20  FILLER                     PIC X.
  2219
  2220         16  CF-CREDIT-MISC-CONTROLS.
  2221             20  CF-REIN-TABLE-SW           PIC X.
  2222                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2223             20  CF-COMP-TABLE-SW           PIC X.
  2224                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2225             20  CF-EXPERIENCE-RETENTION-AGE
  2226                                            PIC S9        COMP-3.
  2227             20  CF-CONVERSION-DT           PIC XX.
  2228             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2229             20  CF-RUN-FREQUENCY-SW        PIC X.
  2230                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2231                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2232
  2233             20  CF-CR-CHECK-NO-CONTROL.
  2234                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2235                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2236                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2237                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2238                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2239                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2240
  2241                 24  CF-CR-CHECK-COUNT       REDEFINES
  2242                     CF-CR-CHECK-COUNTER      PIC X(4).
  2243
  2244                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2245                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2246
  2247                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2248                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2249                 24  CF-MAIL-PROCESSING       PIC X.
  2250                     88  MAIL-PROCESSING          VALUE 'Y'.
  2251
  2252         16  CF-MISC-SYSTEM-CONTROL.
  2253             20  CF-SYSTEM-C                 PIC X.
  2254                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2255             20  CF-SYSTEM-D                 PIC X.
  2256                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2257             20  CF-SOC-SEC-NO-SW            PIC X.
  2258                 88  SOC-SEC-NO-USED             VALUE '1'.
  2259             20  CF-MEMBER-NO-SW             PIC X.
  2260                 88  MEMBER-NO-USED              VALUE '1'.
  2261             20  CF-TAX-ID-NUMBER            PIC X(11).
  2262             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2263             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2264                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2265                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2266                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2267                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2268             20  CF-SYSTEM-E                 PIC X.
  2269                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2270
  2271         16  CF-LGX-LIFE-USER               PIC X.
  2272             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2273             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2274
  2275         16  CF-CR-MONTH-END-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  41
* EL677.cbl
  2276
  2277         16  CF-FILE-MAINT-DATES.
  2278             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2279                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2280             20  CF-LAST-BATCH       REDEFINES
  2281                 CF-LAST-BATCH-NO               PIC X(4).
  2282             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2283             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2284             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2285             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2286             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2287             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2288             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2289             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2290             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2291             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2292
  2293         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2294         16  FILLER                         PIC X.
  2295
  2296         16  CF-ALT-MORT-CODE               PIC X(4).
  2297         16  CF-MEMBER-CAPTION              PIC X(10).
  2298
  2299         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2300             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2301             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2302             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2303             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2304             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2305
  2306         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2307
  2308         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2309         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2310         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2311         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2312
  2313         16  CF-AH-OVERRIDE-L1              PIC X.
  2314         16  CF-AH-OVERRIDE-L2              PIC XX.
  2315         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2316         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2317
  2318         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2319         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2320
  2321         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2322         16  CF-AR-LAST-EL860-DT            PIC XX.
  2323         16  CF-MP-MONTH-END-DT             PIC XX.
  2324
  2325         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2326         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2327             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2328
  2329         16  CF-AR-MONTH-END-DT             PIC XX.
  2330
  2331         16  CF-CRDTCRD-USER                PIC X.
  2332             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2333             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  42
* EL677.cbl
  2334
  2335         16  CF-CC-MONTH-END-DT             PIC XX.
  2336
  2337         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2338
  2339         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2340             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2341             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2342             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2343         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2344         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2345         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2346         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2347             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2348             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2349         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2350         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2351         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2352             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2353         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2354
  2355         16  CF-CL-ZIP-CODE.
  2356             20  CF-CL-ZIP-PRIME.
  2357                 24  CF-CL-ZIP-1ST          PIC X.
  2358                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2359                 24  FILLER                 PIC X(4).
  2360             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2361         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2362             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2363             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2364             20  FILLER                     PIC XXX.
  2365
  2366         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2367         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2368         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2369         16  CF-CO-OPTION-START-DATE        PIC XX.
  2370         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2371           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2372                                                      '3' '4'.
  2373           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2374           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2375           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2376           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2377           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2378           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2379
  2380         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2381
  2382         16  CF-PAYMENT-APPROVAL-LEVELS.
  2383             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2384             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2385             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2386             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2387             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2388             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2389
  2390         16  CF-END-USER-REPORTING-USER     PIC X.
  2391             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  43
* EL677.cbl
  2392             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2393
  2394         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2395             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2396             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2397
  2398         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2399
  2400         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2401         16  FILLER                         PIC X.
  2402
  2403         16  CF-CREDIT-ARCHIVE-CNTL.
  2404             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2405             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2406             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2407
  2408         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2409
  2410         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2411             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2412             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2413
  2414         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2415             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2416             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2417
  2418         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2419
  2420         16  CF-CO-ACH-ID-CODE              PIC  X.
  2421             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2422             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2423             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2424         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2425         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2426         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2427         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2428         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2429         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2430         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2431         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2432         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2433                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2434         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2435                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2436
  2437         16  CF-CO-OVER-SHORT.
  2438             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2439             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2440
  2441*         16  FILLER                         PIC X(102).
  2442         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2443             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2444             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2445
  2446         16  CF-AH-APPROVAL-DAYS.
  2447             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2448             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2449             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  44
* EL677.cbl
  2450             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2451
  2452         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2453
  2454         16  CF-APPROV-LEV-5.
  2455             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2456             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2457             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2458
  2459         16  FILLER                         PIC X(68).
  2460****************************************************************
  2461*             PROCESSOR/USER RECORD                            *
  2462****************************************************************
  2463
  2464     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2465         16  CF-PROCESSOR-NAME              PIC X(30).
  2466         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2467         16  CF-PROCESSOR-TITLE             PIC X(26).
  2468         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2469                 88  MESSAGE-YES                VALUE 'Y'.
  2470                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2471
  2472*****************************************************
  2473****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2474****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2475****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2476****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2477*****************************************************
  2478
  2479         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2480             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2481             20  CF-APPLICATION-FORCE       PIC X.
  2482             20  CF-INDIVIDUAL-APP.
  2483                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2484                     28  CF-BROWSE-APP      PIC X.
  2485                     28  CF-UPDATE-APP      PIC X.
  2486
  2487         16  CF-CURRENT-TERM-ON             PIC X(4).
  2488         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2489             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2490             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2491             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2492             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2493             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2494             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2495             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2496         16  CF-PROCESSOR-CARRIER           PIC X.
  2497             88  NO-CARRIER-SECURITY            VALUE ' '.
  2498         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2499             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2500         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2501             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2502         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2503             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2504
  2505         16  CF-PROC-SYS-ACCESS-SW.
  2506             20  CF-PROC-CREDIT-CLAIMS-SW.
  2507                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  45
* EL677.cbl
  2508                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2509                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2510                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2511             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2512                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2513                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2514             20  CF-PROC-LIFE-GNRLDGR-SW.
  2515                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2516                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2517                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2518                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2519             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2520                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2521                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2522         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2523             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2524             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2525         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2526
  2527         16  CF-APPROVAL-LEVEL                  PIC X.
  2528             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2529             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2530             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2531             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2532             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2533
  2534         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2535
  2536         16  CF-LANGUAGE-TYPE                   PIC X.
  2537             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2538             88  CF-LANG-IS-FR                      VALUE 'F'.
  2539
  2540         16  CF-CSR-IND                         PIC X.
  2541         16  FILLER                             PIC X(239).
  2542
  2543****************************************************************
  2544*             PROCESSOR/REMINDERS RECORD                       *
  2545****************************************************************
  2546
  2547     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2548         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2549             20  CF-START-REMIND-DT         PIC XX.
  2550             20  CF-END-REMIND-DT           PIC XX.
  2551             20  CF-REMINDER-TEXT           PIC X(50).
  2552         16  FILLER                         PIC X(296).
  2553
  2554
  2555****************************************************************
  2556*             STATE MASTER RECORD                              *
  2557****************************************************************
  2558
  2559     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2560         16  CF-STATE-ABBREVIATION          PIC XX.
  2561         16  CF-STATE-NAME                  PIC X(25).
  2562         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2563         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2564             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2565             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  46
* EL677.cbl
  2566             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2567             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2568                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2569                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2570             20  CF-ST-PREM-REJECT-SW       PIC X.
  2571                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2572                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2573             20  CF-ST-REF-REJECT-SW        PIC X.
  2574                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2575                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2576         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2577         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2578         16  CF-ST-REFUND-RULES.
  2579             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2580             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2581             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2582         16  CF-ST-FST-PMT-EXTENSION.
  2583             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2584             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2585                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2586                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2587                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2588                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2589         16  CF-ST-STATE-CALL.
  2590             20  CF-ST-CALL-UNEARNED        PIC X.
  2591             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2592             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2593         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2594             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2595             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2596         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2597         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2598         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2599         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2600         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2601         16  FILLER                         PIC X.
  2602         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2603             20  CF-ST-BENEFIT-CD           PIC XX.
  2604             20  CF-ST-BENEFIT-KIND         PIC X.
  2605                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2606                 88  CF-ST-AH-KIND              VALUE 'A'.
  2607             20  CF-ST-REM-TERM-CALC        PIC X.
  2608                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2609                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2610                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2611                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2612                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2613                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2614                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2615                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2616
  2617             20  CF-ST-REFUND-CALC          PIC X.
  2618                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2619                 88  ST-REFD-BY-R78             VALUE '1'.
  2620                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2621                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2622                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2623                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  47
* EL677.cbl
  2624                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2625                 88  ST-REFD-UTAH               VALUE '7'.
  2626                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2627                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2628                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2629
  2630             20  CF-ST-EARNING-CALC         PIC X.
  2631                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2632                 88  ST-EARN-BY-R78             VALUE '1'.
  2633                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2634                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2635                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2636                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2637                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2638                 88  ST-EARN-MEAN               VALUE '8'.
  2639                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2640
  2641             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2642                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2643                 88  ST-OVRD-BY-R78             VALUE '1'.
  2644                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2645                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2646                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2647                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2648                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2649                 88  ST-OVRD-MEAN               VALUE '8'.
  2650                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2651             20  FILLER                     PIC X.
  2652
  2653         16  CF-ST-COMMISSION-CAPS.
  2654             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2655             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2656             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2657             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2658         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2659                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2660
  2661         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2662
  2663         16  CF-ST-STATUTORY-INTEREST.
  2664             20  CF-ST-STAT-DATE-FROM       PIC X.
  2665                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2666                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2667             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2668             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2669             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2670             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2671             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2672
  2673         16  CF-ST-OVER-SHORT.
  2674             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2675             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2676
  2677         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2678
  2679         16  CF-ST-RT-CALC                  PIC X.
  2680
  2681         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  48
* EL677.cbl
  2682         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2683         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2684         16  CF-ST-RF-LR-CALC               PIC X.
  2685         16  CF-ST-RF-LL-CALC               PIC X.
  2686         16  CF-ST-RF-LN-CALC               PIC X.
  2687         16  CF-ST-RF-AH-CALC               PIC X.
  2688         16  CF-ST-RF-CP-CALC               PIC X.
  2689*        16  FILLER                         PIC X(206).
  2690*CIDMOD         16  FILLER                         PIC X(192).
  2691         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2692             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2693         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2694         16  CF-ST-VFY-2ND-BENE             PIC X.
  2695         16  CF-ST-CAUSAL-STATE             PIC X.
  2696         16  FILLER                         PIC X(185).
  2697
  2698****************************************************************
  2699*             BENEFIT MASTER RECORD                            *
  2700****************************************************************
  2701
  2702     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2703         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2704             20  CF-BENEFIT-CODE            PIC XX.
  2705             20  CF-BENEFIT-NUMERIC  REDEFINES
  2706                 CF-BENEFIT-CODE            PIC XX.
  2707             20  CF-BENEFIT-ALPHA           PIC XXX.
  2708             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2709             20  CF-BENEFIT-COMMENT         PIC X(10).
  2710
  2711             20  CF-LF-COVERAGE-TYPE        PIC X.
  2712                 88  CF-REDUCING                VALUE 'R'.
  2713                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2714
  2715             20  CF-SPECIAL-CALC-CD         PIC X.
  2716                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2717                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2718                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2719                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2720                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2721                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2722                 88  CF-FARM-PLAN               VALUE 'F'.
  2723                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2724                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2725                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2726                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2727                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2728                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2729                 88  CF-PRUDENTIAL              VALUE 'P'.
  2730                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2731                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2732                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2733                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2734                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2735                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2736
  2737             20  CF-JOINT-INDICATOR         PIC X.
  2738                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2739
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  49
* EL677.cbl
  2740*            20  FILLER                     PIC X(12).
  2741             20  FILLER                     PIC X(11).
  2742             20  CF-BENEFIT-CATEGORY        PIC X.
  2743             20  CF-LOAN-TYPE               PIC X(8).
  2744
  2745             20  CF-CO-REM-TERM-CALC        PIC X.
  2746                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2747                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2748                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2749                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2750                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2751
  2752             20  CF-CO-EARNINGS-CALC        PIC X.
  2753                 88  CO-EARN-BY-R78             VALUE '1'.
  2754                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2755                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2756                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2757                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2758                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2759                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2760                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2761
  2762             20  CF-CO-REFUND-CALC          PIC X.
  2763                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2764                 88  CO-REFD-BY-R78             VALUE '1'.
  2765                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2766                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2767                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2768                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2769                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2770                 88  CO-REFD-MEAN               VALUE '8'.
  2771                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2772                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2773                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2774
  2775             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2776                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2777                 88  CO-OVRD-BY-R78             VALUE '1'.
  2778                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2779                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2780                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2781                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2782                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2783                 88  CO-OVRD-MEAN               VALUE '8'.
  2784                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2785
  2786             20  CF-CO-BEN-I-G-CD           PIC X.
  2787                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2788                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2789                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2790
  2791         16  FILLER                         PIC X(304).
  2792
  2793
  2794****************************************************************
  2795*             CARRIER MASTER RECORD                            *
  2796****************************************************************
  2797
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  50
* EL677.cbl
  2798     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2799         16  CF-ADDRESS-DATA.
  2800             20  CF-MAIL-TO-NAME            PIC X(30).
  2801             20  CF-IN-CARE-OF              PIC X(30).
  2802             20  CF-ADDRESS-LINE-1          PIC X(30).
  2803             20  CF-ADDRESS-LINE-2          PIC X(30).
  2804             20  CF-CITY-STATE              PIC X(30).
  2805             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2806             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2807
  2808         16  CF-CLAIM-NO-CONTROL.
  2809             20  CF-CLAIM-NO-METHOD         PIC X.
  2810                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2811                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2812                 88  CLAIM-NO-SEQ               VALUE '3'.
  2813                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2814             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2815                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2816                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2817                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2818
  2819         16  CF-CHECK-NO-CONTROL.
  2820             20  CF-CHECK-NO-METHOD         PIC X.
  2821                 88  CHECK-NO-MANUAL            VALUE '1'.
  2822                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2823                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2824                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2825             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2826                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2827
  2828         16  CF-DOMICILE-STATE              PIC XX.
  2829
  2830         16  CF-EXPENSE-CONTROLS.
  2831             20  CF-EXPENSE-METHOD          PIC X.
  2832                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2833                 88  DOLLARS-PER-PMT            VALUE '2'.
  2834                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2835                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2836             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2837             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2838
  2839         16  CF-CORRESPONDENCE-CONTROL.
  2840             20  CF-LETTER-RESEND-OPT       PIC X.
  2841                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2842                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2843             20  FILLER                     PIC X(4).
  2844
  2845         16  CF-RESERVE-CONTROLS.
  2846             20  CF-MANUAL-SW               PIC X.
  2847                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2848             20  CF-FUTURE-SW               PIC X.
  2849                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2850             20  CF-PTC-SW                  PIC X.
  2851                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2852             20  CF-IBNR-SW                 PIC X.
  2853                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2854             20  CF-PTC-LF-SW               PIC X.
  2855                 88  CF-LF-PTC-USED             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  51
* EL677.cbl
  2856             20  CF-CDT-ACCESS-METHOD       PIC X.
  2857                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2858                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2859                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2860             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2861
  2862         16  CF-CLAIM-CALC-METHOD           PIC X.
  2863             88  360-PLUS-MONTHS                VALUE '1'.
  2864             88  365-PLUS-MONTHS                VALUE '2'.
  2865             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2866             88  360-DAILY                      VALUE '4'.
  2867             88  365-DAILY                      VALUE '5'.
  2868
  2869         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2870         16  FILLER                         PIC X(11).
  2871
  2872         16  CF-LIMIT-AMOUNTS.
  2873             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2874             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2875             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2876             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2877             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2878             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2879             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2880             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2881             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2882             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2883
  2884         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2885         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2886         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2887
  2888         16  CF-ZIP-CODE.
  2889             20  CF-ZIP-PRIME.
  2890                 24  CF-ZIP-1ST             PIC X.
  2891                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2892                 24  FILLER                 PIC X(4).
  2893             20  CF-ZIP-PLUS4               PIC X(4).
  2894         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2895             20  CF-CAN-POSTAL-1            PIC XXX.
  2896             20  CF-CAN-POSTAL-2            PIC XXX.
  2897             20  FILLER                     PIC XXX.
  2898
  2899         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2900         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2901         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2902
  2903         16  CF-RATING-SWITCH               PIC X.
  2904             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2905             88  CF-NO-RATING                   VALUE 'N'.
  2906
  2907         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2908
  2909         16  CF-CARRIER-OVER-SHORT.
  2910             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2911             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2912
  2913         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  52
* EL677.cbl
  2914         16  CF-SECPAY-SWITCH               PIC X.
  2915             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2916             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2917         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2918         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2919         16  FILLER                         PIC X(444).
  2920*        16  FILLER                         PIC X(452).
  2921
  2922
  2923****************************************************************
  2924*             MORTALITY MASTER RECORD                          *
  2925****************************************************************
  2926
  2927     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2928         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2929                                INDEXED BY CF-MORT-NDX.
  2930             20  CF-MORT-TABLE              PIC X(5).
  2931             20  CF-MORT-TABLE-TYPE         PIC X.
  2932                 88  CF-MORT-JOINT              VALUE 'J'.
  2933                 88  CF-MORT-SINGLE             VALUE 'S'.
  2934                 88  CF-MORT-COMBINED           VALUE 'C'.
  2935                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2936                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2937             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2938             20  CF-MORT-AGE-METHOD         PIC XX.
  2939                 88  CF-AGE-LAST                VALUE 'AL'.
  2940                 88  CF-AGE-NEAR                VALUE 'AN'.
  2941             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2942             20  CF-MORT-ADJUSTMENT-DIRECTION
  2943                                            PIC X.
  2944                 88  CF-MINUS                   VALUE '-'.
  2945                 88  CF-PLUS                    VALUE '+'.
  2946             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2947             20  CF-MORT-JOINT-CODE         PIC X.
  2948                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2949             20  CF-MORT-PC-Q               PIC X.
  2950                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2951             20  CF-MORT-TABLE-CODE         PIC X(4).
  2952             20  CF-MORT-COMMENTS           PIC X(15).
  2953             20  FILLER                     PIC X(14).
  2954
  2955         16  FILLER                         PIC X(251).
  2956
  2957
  2958****************************************************************
  2959*             BUSSINESS TYPE MASTER RECORD                     *
  2960****************************************************************
  2961
  2962     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2963* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2964* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2965* AND RECORD 05 IS TYPES 81-99
  2966         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2967             20  CF-BUSINESS-TITLE          PIC  X(19).
  2968             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2969                                            PIC S9V9(4) COMP-3.
  2970             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2971             20  FILLER                     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  53
* EL677.cbl
  2972         16  FILLER                         PIC  X(248).
  2973
  2974
  2975****************************************************************
  2976*             TERMINAL MASTER RECORD                           *
  2977****************************************************************
  2978
  2979     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2980
  2981         16  CF-COMPANY-TERMINALS.
  2982             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2983                                  PIC X(4).
  2984         16  FILLER               PIC X(248).
  2985
  2986
  2987****************************************************************
  2988*             LIFE EDIT MASTER RECORD                          *
  2989****************************************************************
  2990
  2991     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2992         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2993             20  CF-LIFE-CODE-IN            PIC XX.
  2994             20  CF-LIFE-CODE-OUT           PIC XX.
  2995         16  FILLER                         PIC X(248).
  2996
  2997
  2998****************************************************************
  2999*             AH EDIT MASTER RECORD                            *
  3000****************************************************************
  3001
  3002     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3003         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3004             20  CF-AH-CODE-IN              PIC XXX.
  3005             20  CF-AH-CODE-OUT             PIC XX.
  3006         16  FILLER                         PIC X(248).
  3007
  3008
  3009****************************************************************
  3010*             CREDIBILITY TABLES                               *
  3011****************************************************************
  3012
  3013     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3014         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3015                             INDEXED BY CF-CRDB-NDX.
  3016             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3017             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3018             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3019         16  FILLER                         PIC  X(332).
  3020
  3021
  3022****************************************************************
  3023*             REPORT CUSTOMIZATION RECORD                      *
  3024****************************************************************
  3025
  3026     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3027         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3028             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3029             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  54
* EL677.cbl
  3030             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3031**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3032****       A T-TRANSFER.                                   ****
  3033             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3034
  3035         16  FILLER                         PIC XX.
  3036
  3037         16  CF-CARRIER-CNTL-OPT.
  3038             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3039                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3040                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3041             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3042                                            PIC X.
  3043         16  CF-GROUP-CNTL-OPT.
  3044             20  CF-GROUP-OPT-SEQ           PIC 9.
  3045                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3046                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3047             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3048                                            PIC X(6).
  3049         16  CF-STATE-CNTL-OPT.
  3050             20  CF-STATE-OPT-SEQ           PIC 9.
  3051                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3052                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3053             20  CF-STATE-SELECT OCCURS 3 TIMES
  3054                                            PIC XX.
  3055         16  CF-ACCOUNT-CNTL-OPT.
  3056             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3057                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3058                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3059             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3060                                            PIC X(10).
  3061         16  CF-BUS-TYP-CNTL-OPT.
  3062             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3063                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3064                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3065             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3066                                            PIC XX.
  3067         16  CF-LF-TYP-CNTL-OPT.
  3068             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3069                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3070                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3071             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3072                                            PIC XX.
  3073         16  CF-AH-TYP-CNTL-OPT.
  3074             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3075                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3076                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3077             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3078                                            PIC XX.
  3079         16  CF-REPTCD1-CNTL-OPT.
  3080             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3081                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3082                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3083             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3084                                            PIC X(10).
  3085         16  CF-REPTCD2-CNTL-OPT.
  3086             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3087                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  55
* EL677.cbl
  3088                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3089             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3090                                            PIC X(10).
  3091         16  CF-USER1-CNTL-OPT.
  3092             20  CF-USER1-OPT-SEQ           PIC 9.
  3093                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3094                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3095             20  CF-USER1-SELECT OCCURS 3 TIMES
  3096                                            PIC X(10).
  3097         16  CF-USER2-CNTL-OPT.
  3098             20  CF-USER2-OPT-SEQ           PIC 9.
  3099                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3100                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3101             20  CF-USER2-SELECT OCCURS 3 TIMES
  3102                                            PIC X(10).
  3103         16  CF-USER3-CNTL-OPT.
  3104             20  CF-USER3-OPT-SEQ           PIC 9.
  3105                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3106                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3107             20  CF-USER3-SELECT OCCURS 3 TIMES
  3108                                            PIC X(10).
  3109         16  CF-USER4-CNTL-OPT.
  3110             20  CF-USER4-OPT-SEQ           PIC 9.
  3111                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3112                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3113             20  CF-USER4-SELECT OCCURS 3 TIMES
  3114                                            PIC X(10).
  3115         16  CF-USER5-CNTL-OPT.
  3116             20  CF-USER5-OPT-SEQ           PIC 9.
  3117                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3118                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3119             20  CF-USER5-SELECT OCCURS 3 TIMES
  3120                                            PIC X(10).
  3121         16  CF-REINS-CNTL-OPT.
  3122             20  CF-REINS-OPT-SEQ           PIC 9.
  3123                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3124                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3125             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3126                 24  CF-REINS-PRIME         PIC XXX.
  3127                 24  CF-REINS-SUB           PIC XXX.
  3128
  3129         16  CF-AGENT-CNTL-OPT.
  3130             20  CF-AGENT-OPT-SEQ           PIC 9.
  3131                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3132                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3133             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3134                                            PIC X(10).
  3135
  3136         16  FILLER                         PIC X(43).
  3137
  3138         16  CF-LOSS-RATIO-SELECT.
  3139             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3140             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3141         16  CF-ENTRY-DATE-SELECT.
  3142             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3143             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3144         16  CF-EFFECTIVE-DATE-SELECT.
  3145             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  56
* EL677.cbl
  3146             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3147
  3148         16  CF-EXCEPTION-LIST-IND          PIC X.
  3149             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3150
  3151         16  FILLER                         PIC X(318).
  3152
  3153****************************************************************
  3154*                  EXCEPTION REPORTING RECORD                  *
  3155****************************************************************
  3156
  3157     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3158         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3159             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3160
  3161         16  CF-COMBINED-LIFE-AH-OPT.
  3162             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3163             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3164             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3165             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3166
  3167         16  CF-LIFE-OPT.
  3168             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3169             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3170             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3171             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3172             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3173             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3174             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3175             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3176             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3177             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3178
  3179         16  CF-AH-OPT.
  3180             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3181             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3182             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3183             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3184             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3185             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3186             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3187             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3188             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3189             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3190
  3191         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3192             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3193             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3194             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3195
  3196         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3197
  3198         16  FILLER                         PIC X(673).
  3199
  3200
  3201****************************************************************
  3202*             MORTGAGE SYSTEM PLAN RECORD                      *
  3203****************************************************************
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  57
* EL677.cbl
  3204
  3205     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3206         16  CF-PLAN-TYPE                   PIC X.
  3207             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3208             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3209             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3210         16  CF-PLAN-ABBREV                 PIC XXX.
  3211         16  CF-PLAN-DESCRIPT               PIC X(10).
  3212         16  CF-PLAN-NOTES                  PIC X(20).
  3213         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3214         16  CF-PLAN-UNDERWRITING.
  3215             20  CF-PLAN-TERM-DATA.
  3216                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3217                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3218             20  CF-PLAN-AGE-DATA.
  3219                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3220                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3221                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3222             20  CF-PLAN-BENEFIT-DATA.
  3223                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3224                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3225                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3226                                            PIC S9(7)V99  COMP-3.
  3227         16  CF-PLAN-POLICY-FORMS.
  3228             20  CF-POLICY-FORM             PIC X(12).
  3229             20  CF-MASTER-APPLICATION      PIC X(12).
  3230             20  CF-MASTER-POLICY           PIC X(12).
  3231         16  CF-PLAN-RATING.
  3232             20  CF-RATE-CODE               PIC X(5).
  3233             20  CF-SEX-RATING              PIC X.
  3234                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3235                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3236             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3237             20  CF-SUB-STD-TYPE            PIC X.
  3238                 88  CF-PCT-OF-PREM            VALUE '1'.
  3239                 88  CF-PCT-OF-BENE            VALUE '2'.
  3240         16  CF-PLAN-PREM-TOLERANCES.
  3241             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3242             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3243         16  CF-PLAN-PYMT-TOLERANCES.
  3244             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3245             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3246         16  CF-PLAN-MISC-DATA.
  3247             20  FILLER                     PIC X.
  3248             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3249             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3250         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3251         16  CF-PLAN-IND-GRP                PIC X.
  3252             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3253                                                     '1'.
  3254             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3255                                                     '2'.
  3256         16  CF-MIB-SEARCH-SW               PIC X.
  3257             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3258             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3259             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3260             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3261         16  CF-ALPHA-SEARCH-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  58
* EL677.cbl
  3262             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3263             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3264             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3265             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3266             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3267             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3268             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3269             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3270             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3271             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3272                                                     'A' 'B' 'C'
  3273                                                     'X' 'Y' 'Z'.
  3274         16  CF-EFF-DT-RULE-SW              PIC X.
  3275             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3276             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3277             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3278             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3279             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3280         16  FILLER                         PIC X(4).
  3281         16  CF-HEALTH-QUESTIONS            PIC X.
  3282             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3283         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3284         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3285         16  CF-PLAN-SNGL-JNT               PIC X.
  3286             88  CF-COMBINED-PLAN              VALUE 'C'.
  3287             88  CF-JNT-PLAN                   VALUE 'J'.
  3288             88  CF-SNGL-PLAN                  VALUE 'S'.
  3289         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3290         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3291         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3292         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3293         16  CF-RERATE-CNTL                 PIC  X.
  3294             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3295             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3296             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3297             88  CF-AUTO-RECALC                 VALUE '4'.
  3298         16  CF-BENEFIT-TYPE                PIC  X.
  3299             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3300             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3301         16  CF-POLICY-FEE                  PIC S999V99
  3302                                                    COMP-3.
  3303         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3304         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3305         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3306         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3307         16  FILLER                         PIC  X(32).
  3308         16  CF-TERMINATION-FORM            PIC  X(04).
  3309         16  FILLER                         PIC  X(08).
  3310         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3311                                                       COMP-3.
  3312         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3313         16  CF-ISSUE-LETTER                PIC  X(4).
  3314         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3315         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3316             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3317             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3318         16  CF-MP-REFUND-CALC              PIC X.
  3319             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  59
* EL677.cbl
  3320             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3321             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3322             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3323             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3324             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3325             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3326             88  CF-MP-REFD-MEAN                VALUE '8'.
  3327         16  CF-ALT-RATE-CODE               PIC  X(5).
  3328
  3329
  3330         16  FILLER                         PIC X(498).
  3331****************************************************************
  3332*             MORTGAGE COMPANY MASTER RECORD                   *
  3333****************************************************************
  3334
  3335     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3336         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3337         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3338             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3339             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3340             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3341             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3342             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3343
  3344         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3345         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3346         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3347         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3348         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3349
  3350         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3351             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3352         16  CF-MP-RECON-USE-IND            PIC X(1).
  3353             88  CF-MP-USE-RECON             VALUE 'Y'.
  3354         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3355             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3356         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3357             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3358             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3359         16  FILLER                         PIC X(1).
  3360         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3361             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3362         16  CF-MORTG-MIB-VERSION           PIC X.
  3363             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3364             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3365             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3366         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3367             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3368                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3369             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3370                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3371             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3372                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3373             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3374                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3375             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3376                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3377             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  60
* EL677.cbl
  3378                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3379         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3380         16  FILLER                         PIC X(7).
  3381         16  CF-MORTG-DESTINATION-SYMBOL.
  3382             20  CF-MORTG-MIB-COMM          PIC X(5).
  3383             20  CF-MORTG-MIB-TERM          PIC X(5).
  3384         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3385             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3386         16  FILLER                         PIC X(03).
  3387         16  CF-MP-CHECK-NO-CONTROL.
  3388             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3389                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3390                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3391                                                ' ' LOW-VALUES.
  3392                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3393                                               VALUE '3'.
  3394         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3395         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3396         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3397             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3398                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3399             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3400                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3401             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3402                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3403             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3404                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3405             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3406                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3407             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3408                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3409         16  CF-MORTG-BILLING-AREA.
  3410             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3411                                            PIC X.
  3412         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3413         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3414         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3415         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3416             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3417             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3418         16  FILLER                         PIC X.
  3419         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3420             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3421             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3422         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3423         16  FILLER                         PIC X(8).
  3424         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3425         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3426         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3427         16  CF-ACH-COMPANY-ID.
  3428             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3429                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3430                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3431                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3432             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3433         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3434             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3435         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  61
* EL677.cbl
  3436             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3437             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3438         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3439         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3440         16  FILLER                         PIC X(536).
  3441
  3442****************************************************************
  3443*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3444****************************************************************
  3445
  3446     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3447         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3448             20  CF-FEMALE-HEIGHT.
  3449                 24  CF-FEMALE-FT           PIC 99.
  3450                 24  CF-FEMALE-IN           PIC 99.
  3451             20  CF-FEMALE-MIN-WT           PIC 999.
  3452             20  CF-FEMALE-MAX-WT           PIC 999.
  3453         16  FILLER                         PIC X(428).
  3454
  3455     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3456         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3457             20  CF-MALE-HEIGHT.
  3458                 24  CF-MALE-FT             PIC 99.
  3459                 24  CF-MALE-IN             PIC 99.
  3460             20  CF-MALE-MIN-WT             PIC 999.
  3461             20  CF-MALE-MAX-WT             PIC 999.
  3462         16  FILLER                         PIC X(428).
  3463******************************************************************
  3464*             AUTOMATIC ACTIVITY RECORD                          *
  3465******************************************************************
  3466     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3467         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3468             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3469             20  CF-SYS-LETTER-ID           PIC X(04).
  3470             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3471             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3472             20  CF-SYS-RESET-SW            PIC X(01).
  3473             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3474             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3475
  3476         16  FILLER                         PIC X(50).
  3477
  3478         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3479             20  CF-USER-ACTIVE-SW          PIC X(01).
  3480             20  CF-USER-LETTER-ID          PIC X(04).
  3481             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3482             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3483             20  CF-USER-RESET-SW           PIC X(01).
  3484             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3485             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3486             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3487
  3488         16  FILLER                         PIC X(246).
  3489*                                    COPY ERCCHEK.
  3490******************************************************************
  3491*                                                                *
  3492*                                                                *
  3493*                            ERCCHEK                             *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  62
* EL677.cbl
  3494*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3495*                            VMOD=2.008                          *
  3496*                                                                *
  3497*   FILE DESCRIPTION = CHECK RECORDS                             *
  3498*                                                                *
  3499*   FILE TYPE = VSAM,KSDS                                        *
  3500*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3501*                                                                *
  3502*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3503*       ALTERNATE INDEX = NONE                                   *
  3504*                                                                *
  3505*   LOG = YES                                                    *
  3506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3507******************************************************************
  3508*                   C H A N G E   L O G
  3509*
  3510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3511*-----------------------------------------------------------------
  3512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3513* EFFECTIVE    NUMBER
  3514*-----------------------------------------------------------------
  3515* 021414    2003053000001  PEMA  changes for auto chk request
  3516******************************************************************
  3517 01  CHECK-RECORDS.
  3518     12  CH-RECORD-ID                      PIC XX.
  3519         88  VALID-CH-ID                      VALUE 'CH'.
  3520
  3521     12  CH-CONTROL-PRIMARY.
  3522         16  CH-COMPANY-CD                 PIC X.
  3523         16  CH-CARRIER                    PIC X.
  3524         16  CH-GROUPING                   PIC X(6).
  3525         16  CH-STATE                      PIC XX.
  3526         16  CH-ACCOUNT                    PIC X(10).
  3527         16  CH-CERT-EFF-DT                PIC XX.
  3528         16  CH-CERT-NO.
  3529             20  CH-CERT-PRIME             PIC X(10).
  3530             20  CH-CERT-SFX               PIC X.
  3531         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3532
  3533     12  CH-RECORDED-DT                    PIC XX.
  3534     12  CH-RECORDED-BY                    PIC X(4).
  3535     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3536
  3537     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3538     12  CH-CHECK-NO                       PIC X(7).
  3539     12  CH-REASON-FOR-CHECK               PIC X(25).
  3540     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3541     12  FILLER                            PIC X.
  3542
  3543     12  CH-PAYEE-INFO.
  3544         16  CH-PAYEE-NAME-1               PIC X(30).
  3545         16  CH-PAYEE-NAME-2               PIC X(30).
  3546         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3547         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3548         16  CH-PAYEE-CITY-ST.
  3549             20  CH-PAYEE-CITY             PIC X(28).
  3550             20  CH-PAYEE-STATE            PIC XX.
  3551         16  CH-PAYEE-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  63
* EL677.cbl
  3552             20  CH-PAYEE-ZIP.
  3553                 24  CH-ZIP-PRI-1ST        PIC X.
  3554                     88  CH-CANADIAN-POST-CODE
  3555                                           VALUES 'A' THRU 'Z'.
  3556                 24  FILLER                PIC X(4).
  3557             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3558         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3559             20  CH-CAN-POSTAL-1           PIC XXX.
  3560             20  CH-CAN-POSTAL-2           PIC XXX.
  3561             20  FILLER                    PIC XXX.
  3562
  3563     12  CH-CHECK-STUB-TEXT.
  3564         16  CH-STUB-LINE-1                PIC X(30).
  3565         16  CH-TEXT-LINE-1                PIC X(50).
  3566         16  CH-TEXT-LINE-2                PIC X(50).
  3567         16  CH-TEXT-LINE-3                PIC X(40).
  3568     12  CH-RETURN-TO                      PIC X(30).
  3569
  3570     12  CH-COMPENSATION-CONTROL.
  3571         16  CH-COMP-CARRIER               PIC X.
  3572         16  CH-COMP-GROUPING              PIC X(6).
  3573         16  CH-COMP-FIN-RESP              PIC X(10).
  3574         16  CH-COMP-ACCOUNT               PIC X(10).
  3575
  3576     12  CH-CREDIT-SELECT-DT               PIC XX.
  3577     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3578     12  CH-PAYEE-CODE                     PIC X(6).
  3579
  3580     12  CH-VOID-DATA.
  3581         20  CH-VOID-DT                    PIC XX.
  3582         20  CH-VOID-BY                    PIC X(4).
  3583         20  CH-VOID-REASON                PIC X(25).
  3584
  3585     12  CH-APPROVAL-DATA.
  3586         20  CH-APPROVAL-DT                PIC XX.
  3587         20  CH-APPROVAL-STATUS            PIC X.
  3588             88  CH-IN-LIMBO                  VALUE ' '.
  3589             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3590             88  CH-APPROVED                  VALUE 'A'.
  3591             88  CH-DENIED                    VALUE 'D'.
  3592         20  CH-APPROVED-BY                PIC XXXX.
  3593     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3594             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3595     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3596
  3597     12  ch-released-dt                    pic xx.
  3598     12  ch-check-cashed-dt                pic xx.
  3599     12  FILLER                            PIC X.
  3600*    12  CH-CHECK-REFERENCE                PIC X(12).
  3601     12  CH-CHECK-ORIGIN-SW                PIC X.
  3602             88  CH-REFUND-CHECK              VALUE 'R'.
  3603             88  CH-MAINT-CHECK               VALUE 'M'.
  3604
  3605     12  CH-CANC-DT                        PIC XX.
  3606     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3607     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3608
  3609     12  CH-INSURED-NAME                   PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  64
* EL677.cbl
  3610
  3611     12  ch-released-by                    pic x(4).
  3612     12  ch-csr                            pic x(4).
  3613     12  ch-deduct-commission              pic x.
  3614         88  ch-deduct-comm                  value 'Y'.
  3615         88  ch-do-not-deduct-comm           value 'N'.
  3616
  3617     12  FILLER                            PIC X(11).
  3618*    12  CH-LETTER-TABLE.
  3619*        16  CH-LETTERS OCCURS 3 TIMES
  3620*                       INDEXED BY CH-LT-NDX
  3621*                                          PIC X(04).
  3622
  3623     12  FILLER                            PIC X(07).
  3624
  3625*                                    COPY ERCACCT.
  3626******************************************************************
  3627*                                                                *
  3628*                                                                *
  3629*                            ERCACCT                             *
  3630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3631*                            VMOD=2.031                          *
  3632*                                                                *
  3633*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3634*                                                                *
  3635*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3636*   VSAM ACCOUNT MASTER FILES.                                   *
  3637*                                                                *
  3638*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3639*                                                                *
  3640*   FILE TYPE = VSAM,KSDS                                        *
  3641*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3642*                                                                *
  3643*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3644*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3645*                                                                *
  3646*   LOG = NO                                                     *
  3647*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3648*                                                                *
  3649*                                                                *
  3650******************************************************************
  3651*                   C H A N G E   L O G
  3652*
  3653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3654*-----------------------------------------------------------------
  3655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3656* EFFECTIVE    NUMBER
  3657*-----------------------------------------------------------------
  3658* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3659* 092705    2005050300006  PEMA  ADD SPP LEASES
  3660* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3661* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3662* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3663* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3664* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3665******************************************************************
  3666
  3667 01  ACCOUNT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  65
* EL677.cbl
  3668     12  AM-RECORD-ID                      PIC XX.
  3669         88  VALID-AM-ID                      VALUE 'AM'.
  3670
  3671     12  AM-CONTROL-PRIMARY.
  3672         16  AM-COMPANY-CD                 PIC X.
  3673         16  AM-MSTR-CNTRL.
  3674             20  AM-CONTROL-A.
  3675                 24  AM-CARRIER            PIC X.
  3676                 24  AM-GROUPING.
  3677                     28 AM-GROUPING-PREFIX PIC XXX.
  3678                     28 AM-GROUPING-PRIME  PIC XXX.
  3679                 24  AM-STATE              PIC XX.
  3680                 24  AM-ACCOUNT.
  3681                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3682                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3683             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3684                                           PIC X(19).
  3685             20  AM-CNTRL-B.
  3686                 24  AM-EXPIRATION-DT      PIC XX.
  3687                 24  FILLER                PIC X(4).
  3688             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3689                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3690
  3691     12  AM-CONTROL-BY-VAR-GRP.
  3692         16  AM-COMPANY-CD-A1              PIC X.
  3693         16  AM-VG-CARRIER                 PIC X.
  3694         16  AM-VG-GROUPING                PIC X(6).
  3695         16  AM-VG-STATE                   PIC XX.
  3696         16  AM-VG-ACCOUNT                 PIC X(10).
  3697         16  AM-VG-DATE.
  3698             20  AM-VG-EXPIRATION-DT       PIC XX.
  3699             20  FILLER                    PIC X(4).
  3700         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3701                                           PIC 9(11)      COMP-3.
  3702     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3703         16  FILLER                        PIC X(10).
  3704         16  AM-VG-KEY3.
  3705             20  AM-VG3-ACCOUNT            PIC X(10).
  3706             20  AM-VG3-EXP-DT             PIC XX.
  3707         16  FILLER                        PIC X(4).
  3708     12  AM-MAINT-INFORMATION.
  3709         16  AM-LAST-MAINT-DT              PIC XX.
  3710         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3711         16  AM-LAST-MAINT-USER            PIC X(4).
  3712         16  FILLER                        PIC XX.
  3713
  3714     12  AM-EFFECTIVE-DT                   PIC XX.
  3715     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3716
  3717     12  AM-PREV-DATES  COMP-3.
  3718         16  AM-PREV-EXP-DT                PIC 9(11).
  3719         16  AM-PREV-EFF-DT                PIC 9(11).
  3720
  3721     12  AM-REPORT-CODE-1                  PIC X(10).
  3722     12  AM-REPORT-CODE-2                  PIC X(10).
  3723
  3724     12  AM-CITY-CODE                      PIC X(4).
  3725     12  AM-COUNTY-PARISH                  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  66
* EL677.cbl
  3726
  3727     12  AM-NAME                           PIC X(30).
  3728     12  AM-PERSON                         PIC X(30).
  3729     12  AM-ADDRS                          PIC X(30).
  3730     12  AM-CITY.
  3731         16  AM-ADDR-CITY                  PIC X(28).
  3732         16  AM-ADDR-STATE                 PIC XX.
  3733     12  AM-ZIP.
  3734         16  AM-ZIP-PRIME.
  3735             20  AM-ZIP-PRI-1ST            PIC X.
  3736                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3737             20  FILLER                    PIC X(4).
  3738         16  AM-ZIP-PLUS4                  PIC X(4).
  3739     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3740         16  AM-CAN-POSTAL-1               PIC XXX.
  3741         16  AM-CAN-POSTAL-2               PIC XXX.
  3742         16  FILLER                        PIC XXX.
  3743     12  AM-TEL-NO.
  3744         16  AM-AREA-CODE                  PIC 999.
  3745         16  AM-TEL-PRE                    PIC 999.
  3746         16  AM-TEL-NBR                    PIC 9(4).
  3747     12  AM-TEL-LOC                        PIC X.
  3748         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3749         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3750
  3751     12  AM-COMM-STRUCTURE.
  3752         16  AM-DEFN-1.
  3753             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3754                 24  AM-AGT.
  3755                     28  AM-AGT-PREFIX     PIC X(4).
  3756                     28  AM-AGT-PRIME      PIC X(6).
  3757                 24  AM-COM-TYP            PIC X.
  3758                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3759                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3760                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3761                 24  AM-RECALC-LV-INDIC    PIC X.
  3762                 24  AM-RETRO-LV-INDIC     PIC X.
  3763                 24  AM-GL-CODES           PIC X.
  3764                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3765                 24  FILLER                PIC X(01).
  3766         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3767             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3768                 24  FILLER                PIC X(11).
  3769                 24  AM-L-COMA             PIC XXX.
  3770                 24  AM-J-COMA             PIC XXX.
  3771                 24  AM-A-COMA             PIC XXX.
  3772                 24  FILLER                PIC X(6).
  3773
  3774     12  AM-COMM-CHANGE-STATUS             PIC X.
  3775         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3776
  3777     12  AM-CSR-CODE                       PIC X(4).
  3778
  3779     12  AM-BILLING-STATUS                 PIC X.
  3780         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3781         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3782     12  AM-AUTO-REFUND-SW                 PIC X.
  3783         88  AUTO-REFUNDS-USED                VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  67
* EL677.cbl
  3784         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3785     12  AM-GPCD                           PIC 99.
  3786     12  AM-IG                             PIC X.
  3787         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3788         88  AM-HAS-GROUP                     VALUE '2'.
  3789     12  AM-STATUS                         PIC X.
  3790         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3791         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3792         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3793         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3794         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3795         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3796     12  AM-REMIT-TO                       PIC 99.
  3797     12  AM-ID-NO                          PIC X(11).
  3798
  3799     12  AM-CAL-TABLE                      PIC XX.
  3800     12  AM-LF-DEVIATION                   PIC XXX.
  3801     12  AM-AH-DEVIATION                   PIC XXX.
  3802     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3803     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3804     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3805     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3806     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3807     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3808
  3809     12  AM-USER-FIELDS.
  3810         16  AM-FLD-1                      PIC XX.
  3811         16  AM-FLD-2                      PIC XX.
  3812         16  AM-FLD-3                      PIC XX.
  3813         16  AM-FLD-4                      PIC XX.
  3814         16  AM-FLD-5                      PIC XX.
  3815
  3816     12  AM-1ST-PROD-DATE.
  3817         16  AM-1ST-PROD-YR                PIC XX.
  3818         16  AM-1ST-PROD-MO                PIC XX.
  3819         16  AM-1ST-PROD-DA                PIC XX.
  3820     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3821     12  AM-CERTS-PURGED-DATE.
  3822         16  AM-PUR-YR                     PIC XX.
  3823         16  AM-PUR-MO                     PIC XX.
  3824         16  AM-PUR-DA                     PIC XX.
  3825     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3826     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3827     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3828     12  AM-INACTIVE-DATE.
  3829         16  AM-INA-MO                     PIC 99.
  3830         16  AM-INA-DA                     PIC 99.
  3831         16  AM-INA-YR                     PIC 99.
  3832     12  AM-AR-HI-CERT-DATE                PIC XX.
  3833
  3834     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3835     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3836
  3837     12  AM-OB-PAYMENT-MODE                PIC X.
  3838         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3839         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3840         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3841         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  68
* EL677.cbl
  3842
  3843     12  AM-AH-ONLY-INDICATOR              PIC X.
  3844         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3845         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3846
  3847     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3848
  3849     12  AM-OVER-SHORT.
  3850         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3851         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3852
  3853     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3854     12  AM-DCC-CLP-STATE                  PIC XX.
  3855
  3856     12  AM-RECALC-COMM                    PIC X.
  3857     12  AM-RECALC-REIN                    PIC X.
  3858
  3859     12  AM-REI-TABLE                      PIC XXX.
  3860     12  AM-REI-ET-LF                      PIC X.
  3861     12  AM-REI-ET-AH                      PIC X.
  3862     12  AM-REI-PE-LF                      PIC X.
  3863     12  AM-REI-PE-AH                      PIC X.
  3864     12  AM-REI-PRT-ST                     PIC X.
  3865     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3866     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3867     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3868     12  AM-REI-GROUP-A                    PIC X(6).
  3869     12  AM-REI-MORT                       PIC X(4).
  3870     12  AM-REI-PRT-OW                     PIC X.
  3871     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3872     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3873     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3874     12  AM-REI-GROUP-B                    PIC X(6).
  3875
  3876     12  AM-TRUST-TYPE                     PIC X(2).
  3877
  3878     12  AM-EMPLOYER-STMT-USED             PIC X.
  3879     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3880
  3881     12  AM-STD-AH-TYPE                    PIC XX.
  3882     12  AM-EARN-METHODS.
  3883         16  AM-EARN-METHOD-R              PIC X.
  3884             88 AM-REF-RL-R78                 VALUE 'R'.
  3885             88 AM-REF-RL-PR                  VALUE 'P'.
  3886             88 AM-REF-RL-MEAN                VALUE 'M'.
  3887             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3888         16  AM-EARN-METHOD-L              PIC X.
  3889             88 AM-REF-LL-R78                 VALUE 'R'.
  3890             88 AM-REF-LL-PR                  VALUE 'P'.
  3891             88 AM-REF-LL-MEAN                VALUE 'M'.
  3892             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3893         16  AM-EARN-METHOD-A              PIC X.
  3894             88 AM-REF-AH-R78                 VALUE 'R'.
  3895             88 AM-REF-AH-PR                  VALUE 'P'.
  3896             88 AM-REF-AH-MEAN                VALUE 'M'.
  3897             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3898             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3899             88 AM-REF-AH-NET                 VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  69
* EL677.cbl
  3900
  3901     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3902     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3903     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3904
  3905     12  AM-RET-Y-N                        PIC X.
  3906     12  AM-RET-P-E                        PIC X.
  3907     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3908     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3909     12  AM-RET-GRP                        PIC X(6).
  3910     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3911         16  AM-POOL-PRIME                 PIC XXX.
  3912         16  AM-POOL-SUB                   PIC XXX.
  3913     12  AM-RETRO-EARNINGS.
  3914         16  AM-RET-EARN-R                 PIC X.
  3915         16  AM-RET-EARN-L                 PIC X.
  3916         16  AM-RET-EARN-A                 PIC X.
  3917     12  AM-RET-ST-TAX-USE                 PIC X.
  3918         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3919         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3920     12  AM-RETRO-BEG-EARNINGS.
  3921         16  AM-RET-BEG-EARN-R             PIC X.
  3922         16  AM-RET-BEG-EARN-L             PIC X.
  3923         16  AM-RET-BEG-EARN-A             PIC X.
  3924     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3925     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3926
  3927     12  AM-USER-SELECT-OPTIONS.
  3928         16  AM-USER-SELECT-1              PIC X(10).
  3929         16  AM-USER-SELECT-2              PIC X(10).
  3930         16  AM-USER-SELECT-3              PIC X(10).
  3931         16  AM-USER-SELECT-4              PIC X(10).
  3932         16  AM-USER-SELECT-5              PIC X(10).
  3933
  3934     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3935
  3936     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3937
  3938     12  AM-RPT045A-SWITCH                 PIC X.
  3939         88  RPT045A-OFF                   VALUE 'N'.
  3940
  3941     12  AM-INSURANCE-LIMITS.
  3942         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3943         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3944
  3945     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3946         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3947
  3948     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3949         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3950         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3951
  3952     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3953
  3954     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3955     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3956     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3957     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  70
* EL677.cbl
  3958     12  AM-DCC-UEF-STATE                  PIC XX.
  3959     12  FILLER                            PIC XXX.
  3960     12  AM-REPORT-CODE-3                  PIC X(10).
  3961*    12  FILLER                            PIC X(22).
  3962
  3963     12  AM-RESERVE-DATE.
  3964         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3965         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3966         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3967
  3968     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3969     12  AM-NOTIFICATION-TYPES.
  3970         16  AM-NOTIF-OF-LETTERS           PIC X.
  3971         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3972         16  AM-NOTIF-OF-REPORTS           PIC X.
  3973         16  AM-NOTIF-OF-STATUS            PIC X.
  3974
  3975     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3976         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3977         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3978         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3979         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3980
  3981     12  AM-BENEFIT-CONTROLS.
  3982         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3983             20  AM-BENEFIT-CODE           PIC XX.
  3984             20  AM-BENEFIT-TYPE           PIC X.
  3985             20  AM-BENEFIT-REVISION       PIC XXX.
  3986             20  AM-BENEFIT-REM-TERM       PIC X.
  3987             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3988             20  FILLER                    PIC XX.
  3989         16  FILLER                        PIC X(80).
  3990
  3991     12  AM-TRANSFER-DATA.
  3992         16  AM-TRANSFERRED-FROM.
  3993             20  AM-TRNFROM-CARRIER        PIC X.
  3994             20  AM-TRNFROM-GROUPING.
  3995                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3996                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3997             20  AM-TRNFROM-STATE          PIC XX.
  3998             20  AM-TRNFROM-ACCOUNT.
  3999                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4000                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4001             20  AM-TRNFROM-DTE            PIC XX.
  4002         16  AM-TRANSFERRED-TO.
  4003             20  AM-TRNTO-CARRIER          PIC X.
  4004             20  AM-TRNTO-GROUPING.
  4005                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4006                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4007             20  AM-TRNTO-STATE            PIC XX.
  4008             20  AM-TRNTO-ACCOUNT.
  4009                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4010                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4011             20  AM-TRNTO-DTE              PIC XX.
  4012         16  FILLER                        PIC X(10).
  4013
  4014     12  AM-SAVED-REMIT-TO                 PIC 99.
  4015
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  71
* EL677.cbl
  4016     12  AM-COMM-STRUCTURE-SAVED.
  4017         16  AM-DEFN-1-SAVED.
  4018             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4019                 24  AM-AGT-SV             PIC X(10).
  4020                 24  AM-COM-TYP-SV         PIC X.
  4021                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4022                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4023                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4024                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4025                 24  FILLER                PIC X.
  4026                 24  AM-GL-CODES-SV        PIC X.
  4027                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4028                 24  FILLER                PIC X.
  4029         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4030             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4031                 24  FILLER                PIC X(11).
  4032                 24  AM-L-COMA-SV          PIC XXX.
  4033                 24  AM-J-COMA-SV          PIC XXX.
  4034                 24  AM-A-COMA-SV          PIC XXX.
  4035                 24  FILLER                PIC X(6).
  4036
  4037     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4038         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4039            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4040            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4041            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4042
  4043     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4044     12  FILLER                            PIC X(120).
  4045
  4046     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4047         16  AM-CONTROL-NAME               PIC X(30).
  4048         16  AM-EXECUTIVE-ONE.
  4049             20  AM-EXEC1-NAME             PIC X(15).
  4050             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4051                                                          COMP-3.
  4052             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4053                                                          COMP-3.
  4054         16  AM-EXECUTIVE-TWO.
  4055             20  AM-EXEC2-NAME             PIC X(15).
  4056             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4057                                                          COMP-3.
  4058             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4059                                                          COMP-3.
  4060
  4061     12  AM-RETRO-ADDITIONAL-DATA.
  4062         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4063         16  AM-RETRO-PREM-P-E             PIC X.
  4064         16  AM-RETRO-CLMS-P-I             PIC X.
  4065         16  AM-RETRO-RET-BRACKET-LF.
  4066             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4067                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4068                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4069             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4070                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4071                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4072             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4073                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  72
* EL677.cbl
  4074                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4075         16  AM-RETRO-RET-BRACKET-AH.
  4076             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4077                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4078                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4079                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4080             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4081                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4082                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4083             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4084                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4085                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4086
  4087     12  AM-COMMENTS.
  4088         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4089
  4090     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4091         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4092         16  AM-FLI-BILLING-CODE           PIC X.
  4093         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4094         16  AM-FLI-UNITED-IDENT           PIC X.
  4095         16  AM-FLI-INTEREST-LOST-DATA.
  4096             20  AM-FLI-BANK-NO            PIC X(5).
  4097             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4098             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4099             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4100         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4101             20  AM-FLI-AGT                PIC X(9).
  4102             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4103             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4104         16  FILLER                        PIC X(102).
  4105
  4106     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4107         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4108             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4109             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4110             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4111             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4112             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4113         16  FILLER                          PIC X(10).
  4114******************************************************************
  4115*                                    COPY ERCCOMP.
  4116******************************************************************
  4117*                                                                *
  4118*                                                                *
  4119*                            ERCCOMP                             *
  4120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4121*                            VMOD=2.019                          *
  4122*                                                                *
  4123*   ONLINE CREDIT SYSTEM                                         *
  4124*                                                                *
  4125*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4126*                                                                *
  4127*   FILE TYPE = VSAM,KSDS                                        *
  4128*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4129*                                                                *
  4130*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4131*       ALTERNATE PATH = NONE                                    *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  73
* EL677.cbl
  4132*                                                                *
  4133*   LOG = NO                                                     *
  4134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4135*                                                                *
  4136******************************************************************
  4137*                   C H A N G E   L O G
  4138*
  4139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4140*-----------------------------------------------------------------
  4141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4142* EFFECTIVE    NUMBER
  4143*-----------------------------------------------------------------
  4144* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4145* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4146* 092205    2005050300006  PEMA  ADD LEASE FEE
  4147* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4148* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4149* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4150* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4151* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4152* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4153******************************************************************
  4154
  4155 01  COMPENSATION-MASTER.
  4156     12  CO-RECORD-ID                          PIC XX.
  4157         88  VALID-CO-ID                          VALUE 'CO'.
  4158
  4159     12  CO-CONTROL-PRIMARY.
  4160         16  CO-COMPANY-CD                     PIC X.
  4161         16  CO-CONTROL.
  4162             20  CO-CTL-1.
  4163                 24  CO-CARR-GROUP.
  4164                     28  CO-CARRIER            PIC X.
  4165                     28  CO-GROUPING.
  4166                         32  CO-GROUP-PREFIX   PIC XXX.
  4167                         32  CO-GROUP-PRIME    PIC XXX.
  4168                 24  CO-RESP-NO.
  4169                     28  CO-RESP-PREFIX        PIC X(4).
  4170                     28  CO-RESP-PRIME         PIC X(6).
  4171             20  CO-CTL-2.
  4172                 24  CO-ACCOUNT.
  4173                     28  CO-ACCT-PREFIX        PIC X(4).
  4174                     28  CO-ACCT-PRIME         PIC X(6).
  4175         16  CO-TYPE                           PIC X.
  4176             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4177             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4178             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4179
  4180     12  CO-MAINT-INFORMATION.
  4181         16  CO-LAST-MAINT-DT                  PIC XX.
  4182         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4183         16  CO-LAST-MAINT-USER                PIC X(4).
  4184     12  FILLER                                PIC XX.
  4185     12  CO-STMT-TYPE                          PIC XXX.
  4186     12  CO-COMP-TYPE                          PIC X.
  4187         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4188     12  CO-STMT-OWNER                         PIC X(4).
  4189     12  CO-BALANCE-CONTROL                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  74
* EL677.cbl
  4190         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4191         88  CO-NO-BALANCE                        VALUE 'N'.
  4192
  4193     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4194         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4195         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4196         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4197
  4198     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4199         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4200         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4201
  4202     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4203     12  CO-GA-DIRECT-DEP                      PIC X.
  4204     12  CO-FUTURE-SPACE                       PIC X.
  4205         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4206
  4207     12  CO-ACCT-NAME                          PIC X(30).
  4208     12  CO-MAIL-NAME                          PIC X(30).
  4209     12  CO-ADDR-1                             PIC X(30).
  4210     12  CO-ADDR-2                             PIC X(30).
  4211     12  CO-ADDR-3.
  4212         16  CO-ADDR-CITY                      PIC X(27).
  4213         16  CO-ADDR-STATE                     PIC XX.
  4214     12  CO-CSO-1099                           PIC X.
  4215     12  CO-ZIP.
  4216         16  CO-ZIP-PRIME.
  4217             20  CO-ZIP-PRI-1ST                PIC X.
  4218                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4219             20  FILLER                        PIC X(4).
  4220         16  CO-ZIP-PLUS4                      PIC X(4).
  4221     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4222         16  CO-CAN-POSTAL-1                   PIC XXX.
  4223         16  CO-CAN-POSTAL-2                   PIC XXX.
  4224         16  FILLER                            PIC XXX.
  4225     12  CO-SOC-SEC                            PIC X(13).
  4226     12  CO-TELEPHONE.
  4227         16  CO-AREA-CODE                      PIC XXX.
  4228         16  CO-PREFIX                         PIC XXX.
  4229         16  CO-PHONE                          PIC X(4).
  4230
  4231     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4232
  4233     12  CO-AR-BAL-LEVEL                       PIC X.
  4234         88  CO-AR-REF-LVL                        VALUE '1'.
  4235         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4236         88  CO-AR-BILL-LVL                       VALUE '2'.
  4237         88  CO-AR-AGT-LVL                        VALUE '3'.
  4238         88  CO-AR-FR-LVL                         VALUE '4'.
  4239
  4240     12  CO-AR-NORMAL-PRINT                    PIC X.
  4241         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4242         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4243
  4244     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4245
  4246     12  CO-AR-REPORTING                       PIC X.
  4247         88  CO-AR-NET-REPORT                     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  75
* EL677.cbl
  4248         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4249
  4250     12  CO-AR-PULL-CHECK                      PIC X.
  4251         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4252         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4253
  4254     12  CO-AR-BALANCE-PRINT                   PIC X.
  4255         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4256
  4257     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4258         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4259         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4260         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4261
  4262     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4263
  4264     12  CO-USER-CODE                          PIC X.
  4265     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4266
  4267******************************************************************
  4268*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4269*    THE LAST MONTH END RUN.
  4270******************************************************************
  4271
  4272     12  CO-LAST-ACTIVITY-DATE.
  4273         16  CO-ACT-YEAR                       PIC 99.
  4274         16  CO-ACT-MONTH                      PIC 99.
  4275         16  CO-ACT-DAY                        PIC 99.
  4276
  4277     12  CO-LAST-STMT-DT.
  4278         16  CO-LAST-STMT-YEAR                 PIC 99.
  4279         16  CO-LAST-STMT-MONTH                PIC 99.
  4280         16  CO-LAST-STMT-DAY                  PIC 99.
  4281
  4282     12  CO-MO-END-TOTALS.
  4283         16  CO-MONTHLY-TOTALS.
  4284             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4285             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4286             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4287             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4288             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4289
  4290         16  CO-AGING-TOTALS.
  4291             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4292             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4293             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4294             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4295
  4296         16  CO-YTD-TOTALS.
  4297             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4298             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4299
  4300         16  CO-OVER-UNDER-TOTALS.
  4301             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4302             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4303
  4304     12  CO-MISCELLANEOUS-TOTALS.
  4305         16  CO-FICA-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  76
* EL677.cbl
  4306             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4307             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4308
  4309         16  CO-CLAIM-TOTALS.
  4310             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4311             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4312
  4313******************************************************************
  4314*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4315*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4316******************************************************************
  4317
  4318     12  CO-CURRENT-TOTALS.
  4319         16  CO-CURRENT-LAST-STMT-DT.
  4320             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4321             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4322             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4323
  4324         16  CO-CURRENT-MONTHLY-TOTALS.
  4325             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4326             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4327             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4328             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4329             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4330
  4331         16  CO-CURRENT-AGING-TOTALS.
  4332             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4333             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4334             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4335             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4336
  4337         16  CO-CURRENT-YTD-TOTALS.
  4338             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4339             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4340
  4341     12  CO-PAID-COMM-TOTALS.
  4342         16  CO-YTD-PAID-COMMS.
  4343             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4344             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4345
  4346     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4347         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4348         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4349
  4350     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4351         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4352         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4353         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4354         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4355         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4356         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4357         88  CO-FINAL-LETTER                  VALUE 'F'.
  4358         88  CO-RECONCILING                   VALUE 'R'.
  4359         88  CO-PHONE-CALL                    VALUE 'P'.
  4360         88  CO-LEGAL                         VALUE 'L'.
  4361         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4362         88  CO-WRITE-OFF                     VALUE 'W'.
  4363         88  CO-NO-ACTION                     VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  77
* EL677.cbl
  4364
  4365     12  CO-CSR-CODE                       PIC X(4).
  4366
  4367     12  CO-GA-STATUS-INFO.
  4368         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4369         16  CO-GA-TERMINATION-DT          PIC XX.
  4370         16  CO-GA-STATUS-CODE             PIC X.
  4371             88  CO-GA-ACTIVE                 VALUE 'A'.
  4372             88  CO-GA-INACTIVE               VALUE 'I'.
  4373             88  CO-GA-PENDING                VALUE 'P'.
  4374         16  CO-GA-COMMENTS.
  4375             20  CO-GA-COMMENT-1           PIC X(40).
  4376             20  CO-GA-COMMENT-2           PIC X(40).
  4377             20  CO-GA-COMMENT-3           PIC X(40).
  4378             20  CO-GA-COMMENT-4           PIC X(40).
  4379
  4380     12  CO-RPTCD2                         PIC X(10).
  4381     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4382         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4383         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4384
  4385     12  CO-TYPE-AGENT                     PIC X(01).
  4386         88  CO-CORPORATION                   VALUE 'C'.
  4387         88  CO-PARTNERSHIP                   VALUE 'P'.
  4388         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4389         88  CO-TRUST                         VALUE 'T'.
  4390         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4391
  4392     12  CO-FAXNO.
  4393         16  CO-FAX-AREA-CODE                  PIC XXX.
  4394         16  CO-FAX-PREFIX                     PIC XXX.
  4395         16  CO-FAX-PHONE                      PIC X(4).
  4396
  4397     12  CO-BANK-INFORMATION.
  4398         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4399         16  CO-BANK-TRANSIT-NON REDEFINES
  4400             CO-BANK-TRANSIT-NO                PIC 9(8).
  4401
  4402         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4403     12  CO-MISC-DEDUCT-INFO REDEFINES
  4404                  CO-BANK-INFORMATION.
  4405         16  CO-MD-GL-ACCT                     PIC X(10).
  4406         16  CO-MD-DIV                         PIC XX.
  4407         16  CO-MD-CENTER                      PIC X(4).
  4408         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4409         16  CO-CREATE-AP-CHECK                PIC X.
  4410         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4411         16  FILLER                            PIC XXX.
  4412     12  CO-ACH-STATUS                         PIC X.
  4413         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4414         88  CO-ACH-PENDING                        VALUE 'P'.
  4415
  4416     12  CO-BILL-SW                            PIC X.
  4417     12  CO-CONTROL-NAME                       PIC X(30).
  4418     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4419     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4420     12  CO-CLP-STATE                          PIC XX.
  4421     12  CO-FIRST-WRITTEN-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  78
* EL677.cbl
  4422     12  CO-SPP-REFUND-EDIT                    PIC X.
  4423
  4424******************************************************************
  4425*                                    COPY ELCCERT.
  4426******************************************************************
  4427*                                                                *
  4428*                            ELCCERT.                            *
  4429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4430*                            VMOD=2.013                          *
  4431*                                                                *
  4432*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4433*                                                                *
  4434*   FILE TYPE = VSAM,KSDS                                        *
  4435*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4436*                                                                *
  4437*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4438*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4439*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4440*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4441*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4442*                                                                *
  4443*   LOG = YES                                                    *
  4444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4445******************************************************************
  4446*                   C H A N G E   L O G
  4447*
  4448* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4449*-----------------------------------------------------------------
  4450*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4451* EFFECTIVE    NUMBER
  4452*-----------------------------------------------------------------
  4453* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4454* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4455* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4456* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4457* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4458* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4459* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4460* 032612  CR2011110200001  PEMA  AHL CHANGES
  4461******************************************************************
  4462
  4463 01  CERTIFICATE-MASTER.
  4464     12  CM-RECORD-ID                      PIC XX.
  4465         88  VALID-CM-ID                      VALUE 'CM'.
  4466
  4467     12  CM-CONTROL-PRIMARY.
  4468         16  CM-COMPANY-CD                 PIC X.
  4469         16  CM-CARRIER                    PIC X.
  4470         16  CM-GROUPING.
  4471             20  CM-GROUPING-PREFIX        PIC X(3).
  4472             20  CM-GROUPING-PRIME         PIC X(3).
  4473         16  CM-STATE                      PIC XX.
  4474         16  CM-ACCOUNT.
  4475             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4476             20  CM-ACCOUNT-PRIME          PIC X(6).
  4477         16  CM-CERT-EFF-DT                PIC XX.
  4478         16  CM-CERT-NO.
  4479             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  79
* EL677.cbl
  4480             20  CM-CERT-SFX               PIC X.
  4481
  4482     12  CM-CONTROL-BY-NAME.
  4483         16  CM-COMPANY-CD-A1              PIC X.
  4484         16  CM-INSURED-LAST-NAME          PIC X(15).
  4485         16  CM-INSURED-INITIALS.
  4486             20  CM-INSURED-INITIAL1       PIC X.
  4487             20  CM-INSURED-INITIAL2       PIC X.
  4488
  4489     12  CM-CONTROL-BY-SSN.
  4490         16  CM-COMPANY-CD-A2              PIC X.
  4491         16  CM-SOC-SEC-NO.
  4492             20  CM-SSN-STATE              PIC XX.
  4493             20  CM-SSN-ACCOUNT            PIC X(6).
  4494             20  CM-SSN-LN3.
  4495                 25  CM-INSURED-INITIALS-A2.
  4496                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4497                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4498                 25 CM-PART-LAST-NAME-A2         PIC X.
  4499
  4500     12  CM-CONTROL-BY-CERT-NO.
  4501         16  CM-COMPANY-CD-A4              PIC X.
  4502         16  CM-CERT-NO-A4                 PIC X(11).
  4503
  4504     12  CM-CONTROL-BY-MEMB.
  4505         16  CM-COMPANY-CD-A5              PIC X.
  4506         16  CM-MEMBER-NO.
  4507             20  CM-MEMB-STATE             PIC XX.
  4508             20  CM-MEMB-ACCOUNT           PIC X(6).
  4509             20  CM-MEMB-LN4.
  4510                 25  CM-INSURED-INITIALS-A5.
  4511                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4512                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4513                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4514
  4515     12  CM-INSURED-PROFILE-DATA.
  4516         16  CM-INSURED-FIRST-NAME.
  4517             20  CM-INSURED-1ST-INIT       PIC X.
  4518             20  FILLER                    PIC X(9).
  4519         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4520         16  CM-INSURED-SEX                PIC X.
  4521             88  CM-SEX-MALE                  VALUE 'M'.
  4522             88  CM-SEX-FEMAL                 VALUE 'F'.
  4523         16  CM-INSURED-JOINT-AGE          PIC 99.
  4524         16  CM-JOINT-INSURED-NAME.
  4525             20  CM-JT-LAST-NAME           PIC X(15).
  4526             20  CM-JT-FIRST-NAME.
  4527                 24  CM-JT-1ST-INIT        PIC X.
  4528                 24  FILLER                PIC X(9).
  4529             20  CM-JT-INITIAL             PIC X.
  4530
  4531     12  CM-LIFE-DATA.
  4532         16  CM-LF-BENEFIT-CD              PIC XX.
  4533         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4534         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4535         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4536         16  CM-LF-DEV-CODE                PIC XXX.
  4537         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  80
* EL677.cbl
  4538         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4539         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4540         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4541         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4542         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4543         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4544         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4545         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4546         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4547         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4548         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4549         16  FILLER                        PIC XX.
  4550
  4551     12  CM-AH-DATA.
  4552         16  CM-AH-BENEFIT-CD              PIC XX.
  4553         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4554         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4555         16  CM-AH-DEV-CODE                PIC XXX.
  4556         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4557         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4558         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4559         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4560         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4561         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4562         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4563         16  CM-AH-PAID-THRU-DT            PIC XX.
  4564             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4565         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4566         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4567         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4568         16  FILLER                        PIC X.
  4569
  4570     12  CM-LOAN-INFORMATION.
  4571         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4572         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4573                                           PIC S9(5)V99  COMP-3.
  4574         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4575         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4576         16  CM-PAY-FREQUENCY              PIC S99.
  4577         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4578         16  CM-RATE-CLASS                 PIC XX.
  4579         16  CM-BENEFICIARY                PIC X(25).
  4580         16  CM-POLICY-FORM-NO             PIC X(12).
  4581         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4582         16  CM-LAST-ADD-ON-DT             PIC XX.
  4583         16  CM-DEDUCTIBLE-AMOUNTS.
  4584             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4585             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4586         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4587             20  CM-RESIDENT-STATE         PIC XX.
  4588             20  CM-RATE-CODE              PIC X(4).
  4589             20  FILLER                    PIC XX.
  4590         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4591             20  CM-LOAN-OFFICER           PIC X(5).
  4592             20  FILLER                    PIC XXX.
  4593         16  CM-CSR-CODE                   PIC XXX.
  4594         16  CM-UNDERWRITING-CODE          PIC X.
  4595             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  81
* EL677.cbl
  4596         16  CM-POST-CARD-IND              PIC X.
  4597         16  CM-NH-INTERFACE-SW            PIC X.
  4598         16  CM-PREMIUM-TYPE               PIC X.
  4599             88  CM-SING-PRM                  VALUE '1'.
  4600             88  CM-O-B-COVERAGE              VALUE '2'.
  4601             88  CM-OPEN-END                  VALUE '3'.
  4602         16  CM-IND-GRP-TYPE               PIC X.
  4603             88  CM-INDIVIDUAL                VALUE 'I'.
  4604             88  CM-GROUP                     VALUE 'G'.
  4605         16  CM-SKIP-CODE                  PIC X.
  4606             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4607             88  SKIP-JULY                    VALUE '1'.
  4608             88  SKIP-AUGUST                  VALUE '2'.
  4609             88  SKIP-SEPTEMBER               VALUE '3'.
  4610             88  SKIP-JULY-AUG                VALUE '4'.
  4611             88  SKIP-AUG-SEPT                VALUE '5'.
  4612             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4613             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4614             88  SKIP-JUNE                    VALUE '8'.
  4615             88  SKIP-JUNE-JULY               VALUE '9'.
  4616             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4617             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4618         16  CM-PAYMENT-MODE               PIC X.
  4619             88  PAY-MONTHLY                  VALUE SPACE.
  4620             88  PAY-WEEKLY                   VALUE '1'.
  4621             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4622             88  PAY-BI-WEEKLY                VALUE '3'.
  4623             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4624         16  CM-LOAN-NUMBER                PIC X(8).
  4625         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4626         16  CM-OLD-LOF                    PIC XXX.
  4627*        16  CM-LOAN-OFFICER               PIC XXX.
  4628         16  CM-REIN-TABLE                 PIC XXX.
  4629         16  CM-SPECIAL-REIN-CODE          PIC X.
  4630         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4631         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4632         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4633
  4634     12  CM-STATUS-DATA.
  4635         16  CM-ENTRY-STATUS               PIC X.
  4636         16  CM-ENTRY-DT                   PIC XX.
  4637
  4638         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4639         16  CM-LF-CANCEL-DT               PIC XX.
  4640         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4641
  4642         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4643         16  CM-LF-DEATH-DT                PIC XX.
  4644         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4645
  4646         16  CM-LF-CURRENT-STATUS          PIC X.
  4647             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4648                                                'M' '4' '5' '9'.
  4649             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4650             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4651             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4652             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4653             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  82
* EL677.cbl
  4654             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4655             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4656             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4657             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4658             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4659             88  CM-LF-DECLINED               VALUE 'D'.
  4660             88  CM-LF-VOIDED                 VALUE 'V'.
  4661
  4662         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4663         16  CM-AH-CANCEL-DT               PIC XX.
  4664         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4665
  4666         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4667         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4668         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4669
  4670         16  CM-AH-CURRENT-STATUS          PIC X.
  4671             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4672                                                'M' '4' '5' '9'.
  4673             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4674             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4675             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4676             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4677             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4678             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4679             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4680             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4681             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4682             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4683             88  CM-AH-DECLINED               VALUE 'D'.
  4684             88  CM-AH-VOIDED                 VALUE 'V'.
  4685
  4686         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4687             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4688             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4689             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4690         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4691
  4692         16  CM-ENTRY-BATCH                PIC X(6).
  4693         16  CM-LF-EXIT-BATCH              PIC X(6).
  4694         16  CM-AH-EXIT-BATCH              PIC X(6).
  4695         16  CM-LAST-MONTH-END             PIC XX.
  4696
  4697     12  CM-NOTE-SW                        PIC X.
  4698         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4699         88  CERT-NOTES-PRESENT               VALUE '1'.
  4700         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4701         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4702         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4703         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4704         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4705         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4706     12  CM-COMP-EXCP-SW                   PIC X.
  4707         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4708         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4709     12  CM-INSURED-ADDRESS-SW             PIC X.
  4710         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4711         88  INSURED-ADDR-PRESENT             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  83
* EL677.cbl
  4712
  4713*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4714     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4715     12  FILLER                            PIC X.
  4716
  4717*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4718     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4719     12  FILLER                            PIC X.
  4720*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4721     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4722
  4723     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4724         88  CERT-ADDED-BATCH                 VALUE ' '.
  4725         88  CERT-ADDED-ONLINE                VALUE '1'.
  4726         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4727         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4728         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4729     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4730         88  CERT-AS-LOADED                   VALUE ' '.
  4731         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4732         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4733         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4734         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4735         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4736         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4737         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4738
  4739     12  CM-ACCOUNT-COMM-PCTS.
  4740         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4741         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4742
  4743     12  CM-USER-FIELD                     PIC X.
  4744     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4745     12  CM-CLP-STATE                      PIC XX.
  4746     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4747     12  CM-USER-RESERVED                  PIC XXX.
  4748     12  FILLER REDEFINES CM-USER-RESERVED.
  4749         16  CM-AH-CLASS-CD                PIC XX.
  4750         16  F                             PIC X.
  4751******************************************************************
  4752*                                    COPY ERCPNDB.
  4753******************************************************************
  4754*                                                                *
  4755*                                                                *
  4756*                            ERCPNDB.                            *
  4757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4758*                            VMOD=2.025                          *
  4759*                                                                *
  4760*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4761*                                                                *
  4762******************************************************************
  4763*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4764*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4765******************************************************************
  4766*                                                                *
  4767*                                                                *
  4768*   FILE TYPE = VSAM,KSDS                                        *
  4769*   RECORD SIZE = 585  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  84
* EL677.cbl
  4770*                                                                *
  4771*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4772*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4773*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4774*                                                 RKP=13,LEN=36  *
  4775*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4776*                                      AND CHG-SEQ.)             *
  4777*                                                RKP=49,LEN=11   *
  4778*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4779*                                      AND CHG-SEQ.)             *
  4780*                                                RKP=60,LEN=15   *
  4781*                                                                *
  4782*   LOG = NO                                                     *
  4783*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4784******************************************************************
  4785******************************************************************
  4786*                   C H A N G E   L O G
  4787*
  4788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4789*-----------------------------------------------------------------
  4790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4791* EFFECTIVE    NUMBER
  4792*-----------------------------------------------------------------
  4793* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4794* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4795* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4796* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4797* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4798* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4799* 032306                   PEMA  ADD BOW LOAN NUMBER
  4800* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4801* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4802* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4803* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4804* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4805* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4806* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4807* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4808******************************************************************
  4809
  4810 01  PENDING-BUSINESS.
  4811     12  PB-RECORD-ID                     PIC XX.
  4812         88  VALID-PB-ID                        VALUE 'PB'.
  4813
  4814     12  PB-CONTROL-PRIMARY.
  4815         16  PB-COMPANY-CD                PIC X.
  4816         16  PB-ENTRY-BATCH               PIC X(6).
  4817         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4818         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4819
  4820     12  PB-CONTROL-BY-ACCOUNT.
  4821         16  PB-COMPANY-CD-A1             PIC X.
  4822         16  PB-CARRIER                   PIC X.
  4823         16  PB-GROUPING.
  4824             20  PB-GROUPING-PREFIX       PIC XXX.
  4825             20  PB-GROUPING-PRIME        PIC XXX.
  4826         16  PB-STATE                     PIC XX.
  4827         16  PB-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  85
* EL677.cbl
  4828             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4829             20  PB-ACCOUNT-PRIME         PIC X(6).
  4830         16  PB-CERT-EFF-DT               PIC XX.
  4831         16  PB-CERT-NO.
  4832             20  PB-CERT-PRIME            PIC X(10).
  4833             20  PB-CERT-SFX              PIC X.
  4834         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4835
  4836         16  PB-RECORD-TYPE               PIC X.
  4837             88  PB-MAILING-DATA                VALUE '0'.
  4838             88  PB-ISSUE                       VALUE '1'.
  4839             88  PB-CANCELLATION                VALUE '2'.
  4840             88  PB-BATCH-TRAILER               VALUE '9'.
  4841
  4842     12  PB-CONTROL-BY-ORIG-BATCH.
  4843         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4844         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4845         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4846         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4847
  4848     12  PB-CONTROL-BY-CSR.
  4849         16  PB-CSR-COMPANY-CD            PIC X.
  4850         16  PB-CSR-ID                    PIC X(4).
  4851         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4852         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4853         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4854******************************************************************
  4855*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4856******************************************************************
  4857
  4858     12  PB-LAST-MAINT-DT                 PIC XX.
  4859     12  PB-LAST-MAINT-BY                 PIC X(4).
  4860     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4861
  4862     12  PB-RECORD-BODY                   PIC X(375).
  4863
  4864     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4865         16  PB-CERT-ORIGIN               PIC X.
  4866             88  CLASIC-CREATED-CERT         VALUE '1'.
  4867         16  PB-I-NAME.
  4868             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4869             20  PB-I-INSURED-FIRST-NAME.
  4870                 24  PB-I-INSURED-1ST-INIT PIC X.
  4871                 24  FILLER                PIC X(9).
  4872             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4873         16  PB-I-AGE                     PIC S99   COMP-3.
  4874         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4875         16  PB-I-BIRTHDAY                PIC XX.
  4876         16  PB-I-INSURED-SEX             PIC X.
  4877             88  PB-SEX-MALE     VALUE 'M'.
  4878             88  PB-SEX-FEMALE   VALUE 'F'.
  4879
  4880         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4881         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4882         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4883         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4884         16  PB-I-SKIP-CODE               PIC X.
  4885             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  86
* EL677.cbl
  4886             88  PB-SKIP-JULY              VALUE '1'.
  4887             88  PB-SKIP-AUGUST            VALUE '2'.
  4888             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4889             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4890             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4891             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4892             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4893             88  PB-SKIP-JUNE              VALUE '8'.
  4894             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4895             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4896             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4897         16  PB-I-TERM-TYPE               PIC X.
  4898             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4899             88  PB-PAID-WEEKLY            VALUE 'W'.
  4900             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4901             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4902             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4903         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4904         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4905         16  PB-I-DATA-ENTRY-SW           PIC X.
  4906             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4907             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4908             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4909             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4910         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4911         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4912*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4913         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4914         16  FILLER                       PIC X.
  4915
  4916         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4917             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4918             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4919                                                   '90' THRU '99'.
  4920         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4921                                          PIC XX.
  4922         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4923         16  PB-I-AMOUNT-FINANCED REDEFINES
  4924                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4925         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4926         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4927                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4928         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4929         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4930         16  PB-I-CLP-AMOUNT REDEFINES
  4931                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4932         16  PB-I-LF-CALC-FLAG            PIC X.
  4933             88 PB-COMP-LF-PREM               VALUE '?'.
  4934         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4935         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4936         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4937         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4938         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4939         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4940         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4941         16  PB-I-LF-ABBR                 PIC XXX.
  4942         16  PB-I-LF-INPUT-CD             PIC XX.
  4943
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  87
* EL677.cbl
  4944         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4945             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4946             88  PB-INVALID-AH               VALUE '  ' '00'
  4947                                                   '90' THRU '99'.
  4948         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4949         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4950         16  PB-I-AH-CALC-FLAG            PIC X.
  4951             88 PB-COMP-AH-PREM                  VALUE '?'.
  4952         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4953         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4954         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4955         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4956         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4957         16  PB-I-AH-ABBR                 PIC XXX.
  4958         16  PB-I-AH-INPUT-CD             PIC XXX.
  4959
  4960         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4961         16  PB-I-REIN-TABLE              PIC XXX.
  4962         16  PB-I-BUSINESS-TYPE           PIC 99.
  4963         16  PB-I-INDV-GRP-CD             PIC X.
  4964         16  PB-I-MORT-CODE.
  4965             20  PB-I-TABLE               PIC X.
  4966             20  PB-I-INTEREST            PIC XX.
  4967             20  PB-I-MORT-TYP            PIC X.
  4968         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4969         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4970         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4971         16  PB-I-INDV-GRP-OVRD           PIC X.
  4972         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4973         16  PB-I-SIG-SW                  PIC X.
  4974             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4975         16  PB-I-RATE-CLASS              PIC XX.
  4976         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4977         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4978         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4979         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4980         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4981         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4982         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4983         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4984         16  PB-I-OB-FLAG                 PIC X.
  4985             88  PB-I-OB                      VALUE 'B'.
  4986             88  PB-I-SUMMARY                 VALUE 'Z'.
  4987         16  PB-I-ENTRY-STATUS            PIC X.
  4988             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4989                                              'M' '5' '9' '2'.
  4990             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4991             88  PB-I-POLICY-PENDING          VALUE '2'.
  4992             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4993             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4994             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4995             88  PB-I-REIN-ONLY               VALUE '9'.
  4996             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4997             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4998             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4999             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5000         16  PB-I-INT-CODE                PIC X.
  5001             88  PB-ADD-ON-INTEREST           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  88
* EL677.cbl
  5002             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5003         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5004         16  PB-I-SOC-SEC-NO              PIC X(11).
  5005         16  PB-I-MEMBER-NO               PIC X(12).
  5006         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5007*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5008         16  PB-I-OLD-LOF                 PIC XXX.
  5009         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5010         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5011         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5012         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5013         16  PB-I-LIFE-INDICATOR          PIC X.
  5014             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5015         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5016         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5017                                          PIC S9(5)V99    COMP-3.
  5018         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5019             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5020             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5021         16  PB-I-1ST-PMT-DT              PIC XX.
  5022         16  PB-I-JOINT-INSURED.
  5023             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5024             20 PB-I-JOINT-FIRST-NAME.
  5025                24  PB-I-JOINT-FIRST-INIT PIC X.
  5026                24  FILLER                PIC X(9).
  5027             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5028*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5029         16  PB-I-BENEFICIARY-NAME.
  5030             20  PB-I-BANK-NUMBER         PIC X(10).
  5031             20  FILLER                   PIC X(15).
  5032         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5033         16  PB-I-REFERENCE               PIC X(12).
  5034         16  FILLER REDEFINES PB-I-REFERENCE.
  5035             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5036             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5037             20  PB-I-CLP-STATE           PIC XX.
  5038         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5039             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5040             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5041             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5042         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5043         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5044         16  PB-I-RESIDENT-STATE          PIC XX.
  5045         16  PB-I-RATE-CODE               PIC X(4).
  5046         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5047         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5048         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5049         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5050         16  PB-I-BANK-NOCHRGB            PIC 99.
  5051         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5052         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5053
  5054     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5055         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5056             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5057         16  PB-C-CANCEL-ORIGIN           PIC X.
  5058             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5059         16  PB-C-LF-CANCEL-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  89
* EL677.cbl
  5060         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5061         16  PB-C-LF-CALC-REQ             PIC X.
  5062             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5063         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5064         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5065         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5066             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5067         16  PB-C-AH-CANCEL-DT            PIC XX.
  5068         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5069         16  PB-C-AH-CALC-REQ             PIC X.
  5070             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5071         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5072         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5073         16  PB-C-LAST-NAME               PIC X(15).
  5074         16  PB-C-REFUND-SW               PIC X.
  5075             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5076             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5077         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5078         16  PB-C-PAYEE-CODE              PIC X(6).
  5079         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5080         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5081         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5082         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5083         16  PB-C-REFERENCE               PIC X(12).
  5084         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5085         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5086         16  PB-C-POST-CARD-IND           PIC X.
  5087         16  PB-C-CANCEL-REASON           PIC X.
  5088         16  PB-C-REF-INTERFACE-SW        PIC X.
  5089         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5090         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5091         16  FILLER                       PIC X(01).
  5092*        16  FILLER                       PIC X(18).
  5093         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5094*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5095         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5096         16  PB-CANCELED-CERT-DATA.
  5097             20  PB-CI-INSURED-NAME.
  5098                 24  PB-CI-LAST-NAME      PIC X(15).
  5099                 24  PB-CI-INITIALS       PIC XX.
  5100             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5101             20  PB-CI-INSURED-SEX        PIC X.
  5102             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5103             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5104             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5105             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5106             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5107             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5108             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5109             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5110             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5111             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5112             20  PB-CI-RATE-CLASS         PIC XX.
  5113             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5114             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5115             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5116             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5117             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  90
* EL677.cbl
  5118             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5119             20  PB-CI-LF-ABBR            PIC X(3).
  5120             20  PB-CI-AH-ABBR            PIC X(3).
  5121             20  PB-CI-OB-FLAG            PIC X.
  5122                 88  PB-CI-OB                VALUE 'B'.
  5123             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5124                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5125                                           'M' '4' '5' '9' '2'.
  5126                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5127                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5128                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5129                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5130                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5131                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5132                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5133                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5134                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5135                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5136                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5137                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5138             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5139                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5140                                           'M' '4' '5' '9' '2'.
  5141                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5142                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5143                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5144                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5145                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5146                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5147                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5148                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5149                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5150                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5151                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5152                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5153             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5154             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5155             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5156             20  PB-CI-MEMBER-NO          PIC X(12).
  5157             20  PB-CI-INT-CODE           PIC X.
  5158                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5159                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5160             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5161             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5162             20  PB-CI-COMP-EXCP-SW       PIC X.
  5163                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5164                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5165             20  PB-CI-ENTRY-STATUS       PIC X.
  5166             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5167             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5168             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5169             20  PB-CI-DEATH-DT           PIC XX.
  5170             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5171             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5172             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5173             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5174             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5175             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  91
* EL677.cbl
  5176             20  PB-CI-ENTRY-DT              PIC XX.
  5177             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5178             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5179             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5180             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5181             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5182             20  PB-CI-OLD-LOF               PIC XXX.
  5183*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5184             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5185             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5186             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5187             20  PB-CI-INDV-GRP-CD           PIC X.
  5188             20  PB-CI-BENEFICIARY-NAME.
  5189                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5190                 24  FILLER                  PIC X(15).
  5191             20  PB-CI-NOTE-SW               PIC X.
  5192             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5193             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5194             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5195             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5196             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5197             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5198             20  PB-CI-FIRST-NAME            PIC X(10).
  5199             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5200
  5201         16  FILLER                       PIC X(13).
  5202*032306  16  FILLER                       PIC X(27).
  5203*        16  FILLER                       PIC X(46).
  5204
  5205     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5206         16  FILLER                       PIC X(10).
  5207         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5208         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5209         16  PB-M-INSURED-MID-INIT        PIC X.
  5210         16  PB-M-INSURED-AGE             PIC 99.
  5211         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5212         16  PB-M-INSURED-SEX             PIC X.
  5213         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5214         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5215         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5216         16  PB-M-INSURED-CITY-STATE.
  5217             20  PB-M-INSURED-CITY        PIC X(28).
  5218             20  PB-M-INSURED-STATE       PIC XX.
  5219         16  PB-M-INSURED-ZIP-CODE.
  5220             20  PB-M-INSURED-ZIP-PRIME.
  5221                 24  PB-M-INSURED-ZIP-1   PIC X.
  5222                     88  PB-M-CANADIAN-POST-CODE
  5223                                             VALUE 'A' THRU 'Z'.
  5224                 24  FILLER               PIC X(4).
  5225             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5226         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5227                                        PB-M-INSURED-ZIP-CODE.
  5228             20  PM-M-INS-CAN-POST1       PIC XXX.
  5229             20  PM-M-INS-CAN-POST2       PIC XXX.
  5230             20  FILLER                   PIC XXX.
  5231         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5232         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5233         16  PB-M-CRED-BENE-NAME          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  92
* EL677.cbl
  5234         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5235         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5236         16  PB-M-CRED-BENE-CITYST.
  5237             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5238             20  PB-M-CRED-BENE-STATE     PIC XX.
  5239         16  FILLER                       PIC X(92).
  5240
  5241     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5242         16  FILLER                       PIC X(10).
  5243         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5244         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5245         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5246         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5247         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5248         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5249         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5250         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5251         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5252         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5253         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5254         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5255         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5256         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5257         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5258         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5259         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5260         16  PB-ACCOUNT-NAME              PIC X(30).
  5261         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5262         16  PB-REFERENCE                 PIC X(12).
  5263         16  PB-B-RECEIVED-DT             PIC XX.
  5264         16  FILLER                       PIC X(234).
  5265
  5266     12  PB-RECORD-STATUS.
  5267         16  PB-CREDIT-SELECT-DT          PIC XX.
  5268         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5269         16  PB-BILLED-DT                 PIC XX.
  5270         16  PB-BILLING-STATUS            PIC X.
  5271             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5272             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5273             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5274         16  PB-RECORD-BILL               PIC X.
  5275             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5276             88  PB-RECORD-RETURNED           VALUE 'R'.
  5277             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5278             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5279             88  PB-OVERRIDE-AH               VALUE 'A'.
  5280             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5281         16  PB-BATCH-ENTRY               PIC X.
  5282             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5283             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5284             88  PB-REISSUED-CERT             VALUE 'E'.
  5285             88  PB-MONTHLY-CERT              VALUE 'M'.
  5286             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5287             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5288             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5289         16  PB-FORCE-CODE                PIC X.
  5290             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5291             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  93
* EL677.cbl
  5292             88  PB-CANCEL-FORCE              VALUE '8'.
  5293             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5294             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5295             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5296             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5297             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5298             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5299             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5300         16  PB-FATAL-FLAG                PIC X.
  5301             88  PB-FATAL-ERRORS              VALUE 'X'.
  5302         16  PB-FORCE-ER-CD               PIC X.
  5303             88  PB-FORCE-ERRORS              VALUE 'F'.
  5304             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5305         16  PB-WARN-ER-CD                PIC X.
  5306             88  PB-WARNING-ERRORS            VALUE 'W'.
  5307         16  FILLER                       PIC X.
  5308         16  PB-OUT-BAL-CD                PIC X.
  5309             88  PB-OUT-OF-BAL                VALUE 'O'.
  5310         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5311         16  PB-AH-OVERRIDE-L1            PIC X.
  5312         16  PB-INPUT-DT                  PIC XX.
  5313         16  PB-INPUT-BY                  PIC X(4).
  5314         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5315         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5316         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5317         16  PB-LF-EARNING-METHOD         PIC X.
  5318         16  PB-AH-EARNING-METHOD         PIC X.
  5319         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5320         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5321         16  PB-REIN-CD                   PIC XXX.
  5322         16  PB-LF-REFUND-TYPE            PIC X.
  5323         16  PB-AH-REFUND-TYPE            PIC X.
  5324         16  PB-ACCT-EFF-DT               PIC XX.
  5325         16  PB-ACCT-EXP-DT               PIC XX.
  5326         16  PB-COMPANY-ID                PIC X(3).
  5327         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5328         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5329         16  PB-SV-CARRIER                PIC X.
  5330         16  PB-SV-GROUPING               PIC X(6).
  5331         16  PB-SV-STATE                  PIC XX.
  5332         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5333         16  PB-GA-BILLING-INFO.
  5334             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5335                                          PIC XX.
  5336         16  PB-SV-REMIT-TO  REDEFINES
  5337             PB-GA-BILLING-INFO           PIC X(10).
  5338         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5339         16  PB-I-LOAN-OFFICER            PIC X(5).
  5340         16  PB-I-VIN                     PIC X(17).
  5341
  5342         16  FILLER                       PIC X(04).
  5343         16  IMNET-BYPASS-SW              PIC X.
  5344
  5345******************************************************************
  5346*                COMMON EDIT ERRORS                              *
  5347******************************************************************
  5348
  5349     12  PB-COMMON-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  94
* EL677.cbl
  5350         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5351                                           PIC S9(4)     COMP.
  5352
  5353******************************************************************
  5354*                                    COPY ERCPNDM.
  5355******************************************************************
  5356*                                                                *
  5357*                                                                *
  5358*                            ERCPNDM                             *
  5359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5360*                            VMOD=2.003                          *
  5361*                                                                *
  5362*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5363*                                                                *
  5364*   FILE TYPE = VSAM,KSDS                                        *
  5365*   RECORD SIZE = 374   RECFORM = FIX                            *
  5366*                                                                *
  5367*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5368*   ALTERNATE PATH    = NOT USED                                 *
  5369*                                                                *
  5370*   LOG = YES                                                    *
  5371*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5372******************************************************************
  5373*                   C H A N G E   L O G
  5374*
  5375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5376*-----------------------------------------------------------------
  5377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5378* EFFECTIVE    NUMBER
  5379*-----------------------------------------------------------------
  5380* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5381* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5382* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5383******************************************************************
  5384
  5385 01  PENDING-MAILING-DATA.
  5386     12  PM-RECORD-ID                      PIC XX.
  5387         88  VALID-MA-ID                       VALUE 'PM'.
  5388
  5389     12  PM-CONTROL-PRIMARY.
  5390         16  PM-COMPANY-CD                 PIC X.
  5391         16  PM-ENTRY-BATCH                PIC X(6).
  5392         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5393         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5394
  5395     12  FILLER                            PIC X(14).
  5396
  5397     12  PM-ACCESS-CONTROL.
  5398         16  PM-SOURCE-SYSTEM              PIC XX.
  5399             88  PM-FROM-CREDIT                VALUE 'CR'.
  5400             88  PM-FROM-VSI                   VALUE 'VS'.
  5401             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5402             88  PM-FROM-OTHER                 VALUE 'OT'.
  5403         16  PM-RECORD-ADD-DT              PIC XX.
  5404         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5405         16  PM-LAST-MAINT-DT              PIC XX.
  5406         16  PM-LAST-MAINT-BY              PIC XXXX.
  5407         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  95
* EL677.cbl
  5408
  5409     12  PM-PROFILE-INFO.
  5410         16  PM-QUALIFY-CODE-1             PIC XX.
  5411         16  PM-QUALIFY-CODE-2             PIC XX.
  5412         16  PM-QUALIFY-CODE-3             PIC XX.
  5413         16  PM-QUALIFY-CODE-4             PIC XX.
  5414         16  PM-QUALIFY-CODE-5             PIC XX.
  5415
  5416         16  PM-INSURED-LAST-NAME          PIC X(15).
  5417         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5418         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5419         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5420         16  PM-INSURED-BIRTH-DT           PIC XX.
  5421         16  PM-INSURED-SEX                PIC X.
  5422             88  PM-SEX-MALE                   VALUE 'M'.
  5423             88  PM-SEX-FEMALE                 VALUE 'F'.
  5424         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5425
  5426         16  PM-ADDRESS-CORRECTED          PIC X.
  5427         16  PM-JOINT-BIRTH-DT             PIC XX.
  5428*        16  FILLER                        PIC X(12).
  5429
  5430         16  PM-ADDRESS-LINE-1             PIC X(30).
  5431         16  PM-ADDRESS-LINE-2             PIC X(30).
  5432         16  PM-CITY-STATE.
  5433             20  PM-CITY                   PIC X(28).
  5434             20  PM-STATE                  PIC XX.
  5435         16  PM-ZIP.
  5436             20  PM-ZIP-CODE.
  5437                 24  PM-ZIP-1              PIC X.
  5438                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5439                 24  FILLER                PIC X(4).
  5440             20  PM-ZIP-PLUS4              PIC X(4).
  5441         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5442             20  PM-CAN-POST1              PIC XXX.
  5443             20  PM-CAN-POST2              PIC XXX.
  5444             20  FILLER                    PIC XXX.
  5445
  5446         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5447
  5448         16  FILLER                        PIC X(03).
  5449
  5450     12  PM-CRED-BENE-INFO.
  5451         16  PM-CRED-BENE-NAME             PIC X(25).
  5452         16  PM-CRED-BENE-ADDR             PIC X(30).
  5453         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5454         16  PM-CRED-BENE-CTYST.
  5455             20  PM-CRED-BENE-CITY         PIC X(28).
  5456             20  PM-CRED-BENE-STATE        PIC XX.
  5457         16  PM-CRED-BENE-ZIP.
  5458             20  PM-CB-ZIP-CODE.
  5459                 24  PM-CB-ZIP-1           PIC X.
  5460                     88  PM-CB-CANADIAN-POST-CODE
  5461                                  VALUE 'A' THRU 'Z'.
  5462                 24  FILLER                PIC X(4).
  5463             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5464         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5465             20  PM-CB-CAN-POST1           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  96
* EL677.cbl
  5466             20  PM-CB-CAN-POST2           PIC XXX.
  5467             20  FILLER                    PIC XXX.
  5468     12  PM-POST-CARD-MAIL-DATA.
  5469         16  PM-MAIL-DATA OCCURS 7.
  5470             20  PM-MAIL-TYPE              PIC X.
  5471                 88  PM-12MO-MAILING           VALUE '1'.
  5472                 88  PM-EXP-MAILING            VALUE '2'.
  5473             20  PM-MAIL-STATUS            PIC X.
  5474                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5475                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5476                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5477             20  PM-MAIL-DATE              PIC XX.
  5478     12  FILLER                            PIC XX.
  5479     12  FILLER                            PIC X(12).
  5480*    12  FILLER                            PIC X(30).
  5481
  5482******************************************************************
  5483*                                    COPY ERCMAIL.
  5484******************************************************************
  5485*                                                                *
  5486*                                                                *
  5487*                            ERCMAIL                             *
  5488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5489*                            VMOD=2.003                          *
  5490*                                                                *
  5491*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5492*                                                                *
  5493*   FILE TYPE = VSAM,KSDS                                        *
  5494*   RECORD SIZE = 374   RECFORM = FIX                            *
  5495*                                                                *
  5496*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5497*   ALTERNATE PATH    = NOT USED                                 *
  5498*                                                                *
  5499*   LOG = YES                                                    *
  5500*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5501******************************************************************
  5502*                   C H A N G E   L O G
  5503*
  5504* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5505*-----------------------------------------------------------------
  5506*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5507* EFFECTIVE    NUMBER
  5508*-----------------------------------------------------------------
  5509* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5510* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5511* 111108                   PEMA  ADD CRED BENE ADDR2
  5512******************************************************************
  5513
  5514 01  MAILING-DATA.
  5515     12  MA-RECORD-ID                      PIC XX.
  5516         88  VALID-MA-ID                       VALUE 'MA'.
  5517
  5518     12  MA-CONTROL-PRIMARY.
  5519         16  MA-COMPANY-CD                 PIC X.
  5520         16  MA-CARRIER                    PIC X.
  5521         16  MA-GROUPING.
  5522             20  MA-GROUPING-PREFIX        PIC XXX.
  5523             20  MA-GROUPING-PRIME         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  97
* EL677.cbl
  5524         16  MA-STATE                      PIC XX.
  5525         16  MA-ACCOUNT.
  5526             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5527             20  MA-ACCOUNT-PRIME          PIC X(6).
  5528         16  MA-CERT-EFF-DT                PIC XX.
  5529         16  MA-CERT-NO.
  5530             20  MA-CERT-PRIME             PIC X(10).
  5531             20  MA-CERT-SFX               PIC X.
  5532
  5533     12  FILLER                            PIC XX.
  5534
  5535     12  MA-ACCESS-CONTROL.
  5536         16  MA-SOURCE-SYSTEM              PIC XX.
  5537             88  MA-FROM-CREDIT                VALUE 'CR'.
  5538             88  MA-FROM-VSI                   VALUE 'VS'.
  5539             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5540             88  MA-FROM-OTHER                 VALUE 'OT'.
  5541         16  MA-RECORD-ADD-DT              PIC XX.
  5542         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5543         16  MA-LAST-MAINT-DT              PIC XX.
  5544         16  MA-LAST-MAINT-BY              PIC XXXX.
  5545         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5546
  5547     12  MA-PROFILE-INFO.
  5548         16  MA-QUALIFY-CODE-1             PIC XX.
  5549         16  MA-QUALIFY-CODE-2             PIC XX.
  5550         16  MA-QUALIFY-CODE-3             PIC XX.
  5551         16  MA-QUALIFY-CODE-4             PIC XX.
  5552         16  MA-QUALIFY-CODE-5             PIC XX.
  5553
  5554         16  MA-INSURED-LAST-NAME          PIC X(15).
  5555         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5556         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5557         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5558         16  MA-INSURED-BIRTH-DT           PIC XX.
  5559         16  MA-INSURED-SEX                PIC X.
  5560             88  MA-SEX-MALE                   VALUE 'M'.
  5561             88  MA-SEX-FEMALE                 VALUE 'F'.
  5562         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5563
  5564         16  MA-ADDRESS-CORRECTED          PIC X.
  5565         16  MA-JOINT-BIRTH-DT             PIC XX.
  5566*        16  FILLER                        PIC X(12).
  5567
  5568         16  MA-ADDRESS-LINE-1             PIC X(30).
  5569         16  MA-ADDRESS-LINE-2             PIC X(30).
  5570         16  MA-CITY-STATE.
  5571             20  MA-CITY                   PIC X(28).
  5572             20  MA-ADDR-STATE             PIC XX.
  5573         16  MA-ZIP.
  5574             20  MA-ZIP-CODE.
  5575                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5576                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5577                 24  FILLER                PIC X(4).
  5578             20  MA-ZIP-PLUS4              PIC X(4).
  5579         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5580             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5581             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  98
* EL677.cbl
  5582             20  FILLER                    PIC X(3).
  5583
  5584         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5585
  5586         16  FILLER                        PIC XXX.
  5587*        16  FILLER                        PIC X(10).
  5588
  5589     12  MA-CRED-BENE-INFO.
  5590         16  MA-CRED-BENE-NAME                 PIC X(25).
  5591         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5592         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5593         16  MA-CRED-BENE-CTYST.
  5594             20  MA-CRED-BENE-CITY             PIC X(28).
  5595             20  MA-CRED-BENE-STATE            PIC XX.
  5596         16  MA-CRED-BENE-ZIP.
  5597             20  MA-CB-ZIP-CODE.
  5598                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5599                     88  MA-CB-CANADIAN-POST-CODE
  5600                                           VALUE 'A' THRU 'Z'.
  5601                 24  FILLER                    PIC X(4).
  5602             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5603         16  MA-CB-CANADIAN-POSTAL-CODE
  5604                            REDEFINES MA-CRED-BENE-ZIP.
  5605             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5606             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5607             20  FILLER                        PIC X(3).
  5608     12  MA-POST-CARD-MAIL-DATA.
  5609         16  MA-MAIL-DATA OCCURS 7.
  5610             20  MA-MAIL-TYPE              PIC X.
  5611                 88  MA-12MO-MAILING           VALUE '1'.
  5612                 88  MA-EXP-MAILING            VALUE '2'.
  5613             20  MA-MAIL-STATUS            PIC X.
  5614                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5615                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5616                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5617             20  MA-MAIL-DATE              PIC XX.
  5618     12  FILLER                            PIC XX.
  5619     12  FILLER                            PIC XX.
  5620*    12  FILLER                            PIC X(30).
  5621******************************************************************
  5622*                                    COPY ERCPYAJ.
  5623******************************************************************
  5624*                                                                *
  5625*                            ERCPYAJ                             *
  5626*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5627*                            VMOD=2.015                          *
  5628*                                                                *
  5629*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5630*                                                                *
  5631*                                                                *
  5632*   FILE TYPE = VSAM,KSDS                                        *
  5633*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5634*                                                                *
  5635*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5636*       ALTERNATE PATHS = NONE                                   *
  5637*                                                                *
  5638*   LOG = YES                                                    *
  5639*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page  99
* EL677.cbl
  5640******************************************************************
  5641******************************************************************
  5642*                   C H A N G E   L O G
  5643*
  5644* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5645*-----------------------------------------------------------------
  5646*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5647* EFFECTIVE    NUMBER
  5648*-----------------------------------------------------------------
  5649* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5650* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5651******************************************************************
  5652
  5653 01  PENDING-PAY-ADJ.
  5654     12  PY-RECORD-ID                     PIC XX.
  5655         88  VALID-PY-ID                        VALUE 'PY'.
  5656
  5657     12  PY-CONTROL-PRIMARY.
  5658         16  PY-COMPANY-CD                PIC X.
  5659         16  PY-CARRIER                   PIC X.
  5660         16  PY-GROUPING                  PIC X(6).
  5661         16  PY-FIN-RESP                  PIC X(10).
  5662         16  PY-ACCOUNT                   PIC X(10).
  5663         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5664                                          PIC X(10).
  5665         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5666         16  PY-RECORD-TYPE               PIC X.
  5667             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5668             88  PY-DEPOSIT                   VALUE 'D'.
  5669             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5670             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5671             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5672             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5673             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5674             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5675             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5676             88  PY-FICA-ENTRY                VALUE 'F'.
  5677             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5678             88  PY-POLICY-FEE                VALUE 'W'.
  5679             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5680
  5681     12  PY-PYMT-TYPE                     PIC X.
  5682             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5683             88  PY-REINS-PYMT                VALUE 'R'.
  5684             88  PY-EXP-PYMT                  VALUE 'E'.
  5685
  5686     12  PY-BIL-INV                       PIC X(6).
  5687     12  PY-REF-NO                        PIC X(12).
  5688
  5689     12  PY-LAST-MAINT-DT                 PIC XX.
  5690     12  PY-LAST-MAINT-BY                 PIC X(4).
  5691     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5692
  5693     12  PY-PYADJ-RECORD.
  5694         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5695         16  PY-ENTRY-COMMENT             PIC X(30).
  5696         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5697             20  PY-GL-ACCOUNT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 100
* EL677.cbl
  5698             20  PY-GL-STATE              PIC X(02).
  5699             20  PY-GL-CANC-SW            PIC X(01).
  5700                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5701                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5702             20  PY-GL-COMMENT            PIC X(10).
  5703             20  FILLER      REDEFINES PY-GL-COMMENT.
  5704                 24  PY-GL-CHECK-NO       PIC 9(06).
  5705                 24  FILLER               PIC X(04).
  5706             20  FILLER                   PIC X(07).
  5707         16  PY-SAVE-ACCOUNT              PIC X(10).
  5708         16  PY-SAVE-TYPE                 PIC X(01).
  5709
  5710         16  PY-LETTERS.
  5711             20  PY-LETTER OCCURS 3 TIMES
  5712                           INDEXED BY PY-LET-NDX
  5713                                          PIC X(04).
  5714
  5715         16  PY-ERCOMP-TYPE               PIC X.
  5716             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5717             88  PY-GA-TYPE                   VALUE 'G'.
  5718             88  PY-BANK-TYPE                 VALUE 'B'.
  5719         16  FILLER                       PIC X(05).
  5720
  5721     12  PY-RECORD-STATUS.
  5722         16  PY-CREDIT-SELECT-DT          PIC XX.
  5723         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5724         16  PY-BILLED-DATE               PIC XX.
  5725         16  PY-REPORTED-DT               PIC XX.
  5726         16  PY-PMT-APPLIED               PIC X.
  5727             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5728             88  PY-GA-PMT                    VALUE 'G'.
  5729             88  PY-OVWRITE-PMT               VALUE 'O'.
  5730             88  PY-NON-AR-PMT                VALUE 'N'.
  5731         16  FILLER                       PIC X(5).
  5732         16  PY-INPUT-DT                  PIC XX.
  5733         16  PY-CHECK-NUMBER              PIC X(6).
  5734         16  PY-VOID-SW                   PIC X.
  5735             88  PY-CHECK-VOIDED              VALUE 'V'.
  5736         16  PY-CHECK-ORIGIN-SW           PIC X.
  5737             88  PY-BILLING-CHECK             VALUE 'B'.
  5738             88  PY-REFUND-CHECK              VALUE 'R'.
  5739             88  PY-GA-CHECK                  VALUE 'G'.
  5740             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5741             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5742         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5743         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5744         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5745         16  PY-BILL-FLAG                 PIC X.
  5746             88  PY-BILLED                    VALUE 'B'.
  5747         16  PY-AR-FLAG                   PIC X.
  5748             88  PY-AR-CYCLE                  VALUE 'C'.
  5749             88  PY-AR-MONTH-END              VALUE 'M'.
  5750         16  PY-AR-DATE                   PIC XX.
  5751
  5752     12  PY-GL-CODES.
  5753         16  PY-GL-DB                     PIC X(14).
  5754         16  PY-GL-CR                     PIC X(14).
  5755         16  PY-GL-FLAG                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 101
* EL677.cbl
  5756         16  PY-GL-DATE                   PIC XX.
  5757
  5758     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5759     12  FILLER                           PIC X(3).
  5760******************************************************************
  5761 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5762                          CHECK-RECORDS ACCOUNT-MASTER
  5763                          COMPENSATION-MASTER
  5764                          CERTIFICATE-MASTER PENDING-BUSINESS
  5765                          PENDING-MAILING-DATA MAILING-DATA
  5766                          PENDING-PAY-ADJ.
  5767 0000-DFHEXIT SECTION.
  5768     MOVE '9#                    $   ' TO DFHEIV0.
  5769     MOVE 'EL677' TO DFHEIV1.
  5770     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5771
  5772     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5773     MOVE '5'                    TO  DC-OPTION-CODE.
  5774     PERFORM 8500-DATE-CONVERT.
  5775     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5776     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5777     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5778
  5779     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5780
  5781     IF PI-AMOUNT NOT NUMERIC
  5782         MOVE ZEROS              TO  PI-AMOUNT.
  5783
  5784     IF EIBCALEN = 0
  5785         GO TO 8800-UNAUTHORIZED-ACCESS.
  5786
  5787     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5788     MOVE 2                      TO  EMI-SWITCH2.
  5789     MOVE EIBTRMID               TO  QID-TERM.
  5790
  5791     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5792         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5793
  5794     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5795         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5796             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5797             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5798             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5799             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5800             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5801             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5802             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5803             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5804         ELSE
  5805             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5806             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5807             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5808             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5809             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5810             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5811             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5812             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5813
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 102
* EL677.cbl
  5814     MOVE LOW-VALUES             TO  EL677AI.
  5815
  5816     IF EIBTRNID NOT = TRANS-ID
  5817         move pi-processor-id    to pi-return-to
  5818         move 'N'                to dedcyno
  5819         move al-uanon           to dedcyna
  5820         perform 6800-browse-previous-chek-recs
  5821                                 thru 6800-exit
  5822         perform 5600-get-erpndb thru 5600-exit
  5823         IF PI-TO-EL677-FROM-EL1273
  5824             MOVE 'S'            TO MAINTI
  5825             MOVE 1              TO MAINTL
  5826             MOVE AL-UABON       TO MAINTA
  5827             MOVE DFHENTER       TO EIBAID
  5828             GO TO 5000-BROWSE-FILE.
  5829
  5830     IF EIBTRNID NOT = TRANS-ID
  5831        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5832           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5833           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5834           IF PI-PROCESS-BENEFICIARY
  5835              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5836           ELSE
  5837              GO TO 6300-BUILD-CERT-SCREEN
  5838           end-if
  5839        ELSE
  5840           IF EIBTRNID NOT = EL6311-TRANS-ID
  5841              GO TO 8100-SEND-INITIAL-MAP
  5842           ELSE
  5843              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5844              IF PI-PROCESS-BENEFICIARY
  5845                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5846              ELSE
  5847                 GO TO 6300-BUILD-CERT-SCREEN
  5848              end-if
  5849           end-if
  5850        end-if
  5851      end-if
  5852
  5853     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5854                                     PI-CHEK-COMP-CD.
  5855
  5856
  5857* EXEC CICS HANDLE CONDITION
  5858*        PGMIDERR  (9600-PGMID-ERROR)
  5859*        ERROR     (9990-ABEND)
  5860*    END-EXEC.
  5861*    MOVE '"$L.                  ! " #00005759' TO DFHEIV0
  5862     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5864     MOVE X'2220233030303035373539' TO DFHEIV0(25:11)
  5865     CALL 'kxdfhei1' USING DFHEIV0
  5866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5867
  5868
  5869     IF EIBAID = DFHCLEAR
  5870         GO TO 9400-CLEAR.
  5871
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 103
* EL677.cbl
  5872     IF PI-PROCESSOR-ID = 'LGXX'
  5873         GO TO 0200-RECEIVE.
  5874
  5875
  5876* EXEC CICS READQ TS
  5877*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5878*        INTO   (SECURITY-CONTROL)
  5879*        LENGTH (SC-COMM-LENGTH)
  5880*        ITEM   (SC-ITEM)
  5881*    END-EXEC.
  5882*    MOVE '*$II   L              ''   #00005770' TO DFHEIV0
  5883     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5885     MOVE X'2020233030303035373730' TO DFHEIV0(25:11)
  5886     CALL 'kxdfhei1' USING DFHEIV0,
  5887           PI-SECURITY-TEMP-STORE-ID,
  5888           SECURITY-CONTROL,
  5889           SC-COMM-LENGTH,
  5890           SC-ITEM,
  5891           DFHEIV99,
  5892           DFHEIV99
  5893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5894
  5895
  5896     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5897     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5898
  5899     IF NOT DISPLAY-CAP
  5900         MOVE 'READ'          TO SM-READ
  5901         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5902         MOVE ER-0070         TO  EMI-ERROR
  5903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5904         GO TO 8100-SEND-INITIAL-MAP.
  5905
  5906 0200-RECEIVE.
  5907     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5908         MOVE ER-1159            TO  EMI-ERROR
  5909         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5910         MOVE -1                 TO  PFENTERL
  5911         GO TO 8200-SEND-DATAONLY.
  5912
  5913
  5914* EXEC CICS HANDLE CONDITION
  5915*        MAPFAIL (8100-SEND-INITIAL-MAP)
  5916*    END-EXEC.
  5917*    MOVE '"$?                   ! # #00005794' TO DFHEIV0
  5918     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  5919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5920     MOVE X'2320233030303035373934' TO DFHEIV0(25:11)
  5921     CALL 'kxdfhei1' USING DFHEIV0
  5922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5923
  5924
  5925
  5926* EXEC CICS RECEIVE
  5927*        MAP      (EL677A)
  5928*        MAPSET   (MAPSET-NAME)
  5929*        INTO     (EL677AI)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 104
* EL677.cbl
  5930*    END-EXEC.
  5931     MOVE LENGTH OF
  5932      EL677AI
  5933       TO DFHEIV11
  5934*    MOVE '8"T I  L              ''   #00005798' TO DFHEIV0
  5935     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5936     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5937     MOVE X'2020233030303035373938' TO DFHEIV0(25:11)
  5938     CALL 'kxdfhei1' USING DFHEIV0,
  5939           EL677A,
  5940           EL677AI,
  5941           DFHEIV11,
  5942           MAPSET-NAME,
  5943           DFHEIV99,
  5944           DFHEIV99
  5945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5946
  5947
  5948     IF PFENTERL GREATER ZERO
  5949         IF EIBAID NOT = DFHENTER
  5950             MOVE ER-0004        TO  EMI-ERROR
  5951             MOVE AL-UNBOF       TO  PFENTERA
  5952             MOVE -1             TO  PFENTERL
  5953             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5954             GO TO 8200-SEND-DATAONLY
  5955         ELSE
  5956             IF (PFENTERI NUMERIC) AND
  5957                (PFENTERI GREATER 0 AND LESS 25)
  5958                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  5959             ELSE
  5960                 MOVE ER-0029    TO  EMI-ERROR
  5961                 MOVE AL-UNBOF   TO  PFENTERA
  5962                 MOVE -1         TO  PFENTERL
  5963                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5964                 GO TO 8200-SEND-DATAONLY.
  5965 0300-CHECK-PFKEYS.
  5966     IF EIBAID = DFHPF23
  5967         GO TO 8810-PF23.
  5968
  5969     IF EIBAID = DFHPF24
  5970         GO TO 9200-RETURN-MAIN-MENU.
  5971
  5972     IF EIBAID = DFHPF12
  5973         GO TO 9500-PF12.
  5974
  5975     IF EIBAID = DFHPF1 OR DFHPF2
  5976         GO TO 5000-BROWSE-FILE.
  5977
  5978     if PI-TO-EL677-FROM-EL1273
  5979        and (eibaid not = dfhenter)
  5980        go to 0320-input-error
  5981     end-if
  5982     IF EIBAID = DFHPF3
  5983         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  5984         MOVE 'PF3'              TO  PI-PFKEY
  5985         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  5986         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  5987             GO TO 9400-CLEAR
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 105
* EL677.cbl
  5988         ELSE
  5989             MOVE XCTL-1273      TO  PGM-NAME
  5990             GO TO 9300-XCTL.
  5991
  5992     IF EIBAID = DFHPF4
  5993         IF NOT FORCE-CAP
  5994             MOVE ER-0433        TO EMI-ERROR
  5995             MOVE -1             TO PFENTERL
  5996             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5997             GO TO 8200-SEND-DATAONLY.
  5998
  5999     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6000                             DFHPF5 OR DFHPF6 or dfhpf7
  6001         GO TO 1000-EDIT-DATA.
  6002
  6003*    IF EIBAID = DFHPF7
  6004*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6005*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6006*        MOVE XCTL-114           TO  PGM-NAME
  6007*        GO TO 9300-XCTL.
  6008
  6009 0320-INPUT-ERROR.
  6010     MOVE ER-0029                TO  EMI-ERROR.
  6011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6012     MOVE -1                     TO  PFENTERL.
  6013     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 106
* EL677.cbl
  6015
  6016 1000-EDIT-DATA.
  6017     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6018         MOVE AL-UANON           TO MAINTA
  6019         IF MAINTI = 'C' OR 'V'
  6020             IF PI-PREV-MAINT = 'S'  OR  'C'
  6021                 NEXT SENTENCE
  6022             ELSE
  6023                 MOVE ER-2056    TO  EMI-ERROR
  6024                 MOVE -1         TO  MAINTL
  6025                 MOVE AL-UABON   TO  MAINTA
  6026                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6027                 GO TO 1100-EDIT-COMPLETE
  6028         ELSE
  6029             NEXT SENTENCE
  6030     ELSE
  6031         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6032            NEXT SENTENCE
  6033         ELSE
  6034            MOVE ER-0023            TO  EMI-ERROR
  6035            MOVE -1                 TO  MAINTL
  6036            MOVE AL-UABON           TO  MAINTA
  6037            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6038
  6039     IF MODIFY-CAP
  6040         NEXT SENTENCE
  6041       ELSE
  6042         IF MAINTI NOT = 'S'
  6043            MOVE 'UPDATE'       TO SM-READ
  6044            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6045            MOVE ER-0070        TO EMI-ERROR
  6046            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6047            GO TO 8100-SEND-INITIAL-MAP.
  6048
  6049     if (pi-return-to-program = 'EL1273')
  6050        and (MAINTI not = 'S' and 'V')
  6051        move 'S'                 to mainti
  6052        move +1                  to maintl
  6053        move al-uanon            to mainta
  6054     end-if
  6055     IF CARRIERI NOT = LOW-VALUES
  6056         MOVE AL-UANON           TO  CARRIERA
  6057         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6058         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6059                                     PI-CARRIER
  6060     ELSE
  6061         MOVE -1                 TO  CARRIERL
  6062         MOVE AL-UABON           TO  CARRIERA
  6063         MOVE ER-0194            TO  EMI-ERROR
  6064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6065
  6066     IF GROUPI NOT = LOW-VALUES
  6067         MOVE AL-UANON           TO  GROUPA
  6068         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6069                                     PI-GROUPING
  6070     ELSE
  6071         MOVE -1                 TO  GROUPL
  6072         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 107
* EL677.cbl
  6073         MOVE ER-0195            TO  EMI-ERROR
  6074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6075
  6076     IF STATEI NOT = LOW-VALUES
  6077         MOVE AL-UANON           TO  STATEA
  6078         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6079         MOVE STATEI             TO  PI-CHEK-STATE
  6080                                     PI-STATE
  6081     ELSE
  6082         MOVE -1                 TO  STATEL
  6083         MOVE AL-UABON           TO  STATEA
  6084         MOVE ER-0196            TO  EMI-ERROR
  6085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6086
  6087     IF EFFDTL GREATER ZERO
  6088         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6089         PERFORM 8700-DEEDIT
  6090         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6091             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6092             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6093             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6094             MOVE '4'                TO  DC-OPTION-CODE
  6095             PERFORM 8500-DATE-CONVERT
  6096             IF DC-ERROR-CODE NOT = SPACES
  6097                 MOVE ER-0215        TO  EMI-ERROR
  6098                 PERFORM 9900-ERROR-FORMAT
  6099                 MOVE -1             TO  EFFDTL
  6100                 MOVE AL-UABON       TO  EFFDTA
  6101               ELSE
  6102                 MOVE AL-UANON       TO  EFFDTA
  6103                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6104                                         PI-CERT-EFF-DT
  6105           ELSE
  6106             MOVE ER-0215        TO  EMI-ERROR
  6107             PERFORM 9900-ERROR-FORMAT
  6108             MOVE -1             TO  EFFDTL
  6109             MOVE AL-UABON       TO  EFFDTA
  6110       ELSE
  6111         MOVE ER-0216            TO  EMI-ERROR
  6112         PERFORM 9900-ERROR-FORMAT
  6113         MOVE -1                 TO  EFFDTL
  6114         MOVE AL-UABOF           TO  EFFDTA.
  6115
  6116     IF ACCTI NOT = LOW-VALUES
  6117         MOVE AL-UANON           TO  ACCTA
  6118         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6119         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6120                                     PI-ACCOUNT
  6121     ELSE
  6122         MOVE -1                 TO  ACCTL
  6123         MOVE AL-UABON           TO  ACCTA
  6124         MOVE ER-0197            TO  EMI-ERROR
  6125         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6126
  6127     IF CERTNOI NOT = LOW-VALUES
  6128         MOVE AL-UANON           TO  CERTNOA
  6129         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6130                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 108
* EL677.cbl
  6131     ELSE
  6132         MOVE -1                 TO  CERTNOL
  6133         MOVE AL-UABON           TO  CERTNOA
  6134         MOVE ER-0203            TO  EMI-ERROR
  6135         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6136
  6137     IF SFXI  = LOW-VALUES
  6138         MOVE SPACE              TO  SFXI.
  6139
  6140     MOVE AL-UANON               TO  SFXA.
  6141
  6142     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6143                                     PI-CERT-SFX.
  6144     IF SEQI = LOW-VALUES
  6145         MOVE +1                 TO  SEQI.
  6146
  6147     MOVE AL-UNNON               TO  SEQA.
  6148     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6149
  6150     IF PAYTO1L > 0
  6151         MOVE PAYTO1I            TO  PI-PAYTO1
  6152     ELSE
  6153         MOVE SPACES             TO  PI-PAYTO1.
  6154
  6155     IF AMOUNTL > 0
  6156
  6157* EXEC CICS BIF DEEDIT
  6158*            FIELD   (AMOUNTI)
  6159*            LENGTH  (11)
  6160*        END-EXEC
  6161     MOVE 11
  6162       TO DFHEIV11
  6163*    MOVE '@"L                   #   #00006012' TO DFHEIV0
  6164     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6165     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6166     MOVE X'2020233030303036303132' TO DFHEIV0(25:11)
  6167     CALL 'kxdfhei1' USING DFHEIV0,
  6168           AMOUNTI,
  6169           DFHEIV11
  6170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6171         MOVE AMOUNTI            TO  PI-AMOUNT
  6172     ELSE
  6173         MOVE ZEROS              TO  PI-AMOUNT.
  6174
  6175     IF TYPEL > 0
  6176         MOVE TYPEI              TO  PI-TYPE
  6177     ELSE
  6178         MOVE SPACE              TO  PI-TYPE.
  6179
  6180*    IF REFL > 0
  6181*        MOVE REFI               TO  PI-REFERENCE
  6182*    ELSE
  6183*        MOVE SPACES             TO  PI-REFERENCE.
  6184     if rettol not = zeros
  6185        move rettoi              to pi-return-to
  6186        MOVE AL-UANON            TO  RETTOA
  6187     end-if
  6188     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 109
* EL677.cbl
  6189        if dedcyni = 'Y' OR 'N'
  6190           continue
  6191        else
  6192           move er-3451          to emi-error
  6193           move -1               to dedcynl
  6194           move al-uabon         to dedcyna
  6195           perform 9900-error-format
  6196                                 thru 9900-exit
  6197        end-if
  6198     end-if
  6199
  6200     if mainti = 'V'
  6201        if (vreasonl > zeros)
  6202           and (vreasoni (1:2) not = spaces)
  6203           continue
  6204        else
  6205           move er-3454          to emi-error
  6206           move -1               to vreasonl
  6207           move al-uabon         to vreasona
  6208           perform 9900-error-format
  6209                                 thru 9900-exit
  6210        end-if
  6211     end-if
  6212     if mainti = 'A'
  6213        continue
  6214     else
  6215        IF MAINTI = 'S'
  6216           or pi-prev-maint = 'S'
  6217           GO TO 1100-EDIT-COMPLETE
  6218        end-if
  6219     end-if
  6220     IF EIBAID = DFHPF5
  6221        IF EMI-ERROR = ZEROS
  6222          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6223        ELSE
  6224          GO TO 1100-EDIT-COMPLETE.
  6225
  6226     IF EIBAID = DFHPF6
  6227        IF EMI-ERROR = ZEROS
  6228           GO TO 6300-BUILD-CERT-SCREEN
  6229         ELSE
  6230           GO TO 1100-EDIT-COMPLETE.
  6231
  6232     IF EIBAID = DFHPF7
  6233        IF EMI-ERROR = ZEROS
  6234           GO TO 6600-build-beneficiary-screen
  6235         ELSE
  6236           GO TO 1100-EDIT-COMPLETE.
  6237
  6238*    if mainti = 'V'
  6239*       if (vreasonl > zeros)
  6240*          and (vreasoni (1:2) not = spaces)
  6241*          continue
  6242*       else
  6243*          move er-3454          to emi-error
  6244*          move -1               to vreasonl
  6245*          move al-uabon         to vreasona
  6246*          perform 9900-error-format
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 110
* EL677.cbl
  6247*                                thru 9900-exit
  6248*       end-if
  6249*    end-if
  6250     IF MAINTI = 'A'
  6251        if (payto1i not = spaces and low-values)
  6252           and (payad1i not = spaces and low-values)
  6253           and (payctyi not = spaces and low-values)
  6254           and (paysti not = spaces and low-values)
  6255           and (ptozipi not = spaces and low-values)
  6256           continue
  6257        else
  6258           MOVE -1               TO PAYTO1L
  6259           MOVE ER-2907          TO EMI-ERROR
  6260           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6261        end-if
  6262     end-if
  6263
  6264     IF MAINTI = 'A'
  6265         IF EIBAID NOT = DFHPF4
  6266             MOVE DFHENTER       TO  EIBAID
  6267             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6268
  6269     IF MAINTI = 'S' OR 'V'
  6270         GO TO 1100-EDIT-COMPLETE.
  6271
  6272     IF PRINTEDL GREATER THAN +0
  6273         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6274         PERFORM 8700-DEEDIT
  6275         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6276             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6277             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6278             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6279             MOVE '4'                TO  DC-OPTION-CODE
  6280             PERFORM 8500-DATE-CONVERT
  6281             IF DC-ERROR-CODE NOT = SPACES
  6282                 MOVE ER-3046        TO  EMI-ERROR
  6283                 PERFORM 9900-ERROR-FORMAT
  6284                 MOVE -1             TO  PRINTEDL
  6285                 MOVE AL-UABON       TO  PRINTEDA
  6286                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6287             ELSE
  6288                 MOVE AL-UANON       TO  PRINTEDA
  6289                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6290         ELSE
  6291             MOVE ER-3046        TO  EMI-ERROR
  6292             PERFORM 9900-ERROR-FORMAT
  6293             MOVE -1             TO  PRINTEDL
  6294             MOVE AL-UABON       TO  PRINTEDA
  6295             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6296
  6297     IF AMOUNTL = ZEROS
  6298         GO TO 1050-CK-AMT.
  6299
  6300
  6301* EXEC CICS BIF DEEDIT
  6302*        FIELD   (AMOUNTI)
  6303*        LENGTH  (11)
  6304*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 111
* EL677.cbl
  6305     MOVE 11
  6306       TO DFHEIV11
  6307*    MOVE '@"L                   #   #00006145' TO DFHEIV0
  6308     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6309     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6310     MOVE X'2020233030303036313435' TO DFHEIV0(25:11)
  6311     CALL 'kxdfhei1' USING DFHEIV0,
  6312           AMOUNTI,
  6313           DFHEIV11
  6314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6315
  6316
  6317     IF AMOUNTI NOT NUMERIC     OR
  6318        AMOUNTI LESS THAN ZERO  OR
  6319       (AMOUNTI = ZEROS  AND
  6320               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6321          MOVE ER-1159            TO  EMI-ERROR
  6322          MOVE -1                 TO  AMOUNTL
  6323          MOVE AL-UNBON           TO  AMOUNTA
  6324          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6325          GO TO 1100-EDIT-COMPLETE.
  6326
  6327     MOVE AMOUNTI                TO  WS-AM-WORK.
  6328
  6329     IF WS-AM-SIGN = SPACES
  6330         MOVE WS-AM-NUM          TO  WS-AMT
  6331         ADD 0                   TO  WS-AMT
  6332       ELSE
  6333         MOVE AMOUNTI            TO  WS-AMT
  6334         ADD 0                   TO  WS-AMT.
  6335
  6336      MOVE WS-AMT                TO  AMOUNTO.
  6337      MOVE AL-UNNON              TO  AMOUNTA.
  6338
  6339 1050-CK-AMT.
  6340     IF AMOUNTL = ZEROS AND
  6341        MAINTI  = 'A'
  6342         MOVE ER-1159            TO  EMI-ERROR
  6343         MOVE -1                 TO  AMOUNTL
  6344         MOVE AL-UNBON           TO  AMOUNTA
  6345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6346
  6347     MOVE AL-UANON              TO  TYPEA.
  6348
  6349     IF TYPEL GREATER THAN ZEROS
  6350         IF TYPEI = 'R' OR 'M' OR 'E'
  6351             NEXT SENTENCE
  6352         ELSE
  6353             MOVE ER-3044    TO  EMI-ERROR
  6354             MOVE -1         TO  TYPEL
  6355             MOVE AL-UABON   TO  TYPEA
  6356             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6357     ELSE
  6358         IF MAINTI  = 'A'
  6359             MOVE ER-3044    TO  EMI-ERROR
  6360             MOVE -1         TO  TYPEL
  6361             MOVE AL-UABON   TO  TYPEA
  6362             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 112
* EL677.cbl
  6363
  6364
  6365 1100-EDIT-COMPLETE.
  6366
  6367     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6368       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6369        EIBAID NOT = DFHPF4)
  6370         GO TO 8200-SEND-DATAONLY.
  6371
  6372     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6373
  6374     IF MAINTI = 'A'
  6375         GO TO 2000-ADD-RECORD.
  6376
  6377*    IF MAINTI = 'C' OR 'V'
  6378     IF MAINTI = 'V'
  6379         GO TO 3000-CHANGE-RECORD.
  6380
  6381     IF MAINTI = 'S' or 'C'
  6382         GO TO 5000-BROWSE-FILE.
  6383
  6384     if mainti = 'D'
  6385        go to 3400-delete-record
  6386     end-if
  6387     .
  6388 1200-VERIFY-CARRIER-ID.
  6389     MOVE SPACES                 TO ELCNTL-KEY.
  6390     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6391     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6392     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6393     MOVE +0                     TO ELCNTL-SEQ.
  6394
  6395
  6396* EXEC CICS HANDLE CONDITION
  6397*        NOTFND   (1290-NO-CARRIER)
  6398*    END-EXEC.
  6399*    MOVE '"$I                   ! $ #00006228' TO DFHEIV0
  6400     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6401     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6402     MOVE X'2420233030303036323238' TO DFHEIV0(25:11)
  6403     CALL 'kxdfhei1' USING DFHEIV0
  6404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6405
  6406
  6407
  6408* EXEC CICS READ
  6409*        DATASET   (ELCNTL-FILE-ID)
  6410*        SET       (ADDRESS OF CONTROL-FILE)
  6411*        RIDFLD    (ELCNTL-KEY)
  6412*    END-EXEC.
  6413*    MOVE '&"S        E          (   #00006232' TO DFHEIV0
  6414     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6416     MOVE X'2020233030303036323332' TO DFHEIV0(25:11)
  6417     CALL 'kxdfhei1' USING DFHEIV0,
  6418           ELCNTL-FILE-ID,
  6419           DFHEIV20,
  6420           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 113
* EL677.cbl
  6421           ELCNTL-KEY,
  6422           DFHEIV99,
  6423           DFHEIV99,
  6424           DFHEIV99
  6425     SET ADDRESS OF CONTROL-FILE TO
  6426         DFHEIV20
  6427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6428
  6429
  6430     GO TO 1200-EXIT.
  6431
  6432 1290-NO-CARRIER.
  6433     MOVE ER-2208                TO EMI-ERROR.
  6434     MOVE -1                     TO CARRIERL.
  6435     MOVE AL-UABON               TO CARRIERA.
  6436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6437
  6438 1200-EXIT.
  6439      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 114
* EL677.cbl
  6441 1300-VERIFY-STATE-ID.
  6442     MOVE SPACES                 TO ELCNTL-KEY.
  6443     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6444     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6445     MOVE STATEI                 TO ELCNTL-STATE.
  6446     MOVE +0                     TO ELCNTL-SEQ.
  6447
  6448
  6449* EXEC CICS HANDLE CONDITION
  6450*        NOTFND   (1380-NO-STATE)
  6451*    END-EXEC.
  6452*    MOVE '"$I                   ! % #00006256' TO DFHEIV0
  6453     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6455     MOVE X'2520233030303036323536' TO DFHEIV0(25:11)
  6456     CALL 'kxdfhei1' USING DFHEIV0
  6457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6458
  6459
  6460
  6461* EXEC CICS READ
  6462*        DATASET   (ELCNTL-FILE-ID)
  6463*        SET       (ADDRESS OF CONTROL-FILE)
  6464*        RIDFLD    (ELCNTL-KEY)
  6465*    END-EXEC.
  6466*    MOVE '&"S        E          (   #00006260' TO DFHEIV0
  6467     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6469     MOVE X'2020233030303036323630' TO DFHEIV0(25:11)
  6470     CALL 'kxdfhei1' USING DFHEIV0,
  6471           ELCNTL-FILE-ID,
  6472           DFHEIV20,
  6473           DFHEIV99,
  6474           ELCNTL-KEY,
  6475           DFHEIV99,
  6476           DFHEIV99,
  6477           DFHEIV99
  6478     SET ADDRESS OF CONTROL-FILE TO
  6479         DFHEIV20
  6480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6481
  6482
  6483     GO TO 1390-EXIT.
  6484
  6485 1380-NO-STATE.
  6486     MOVE ER-2209                TO EMI-ERROR.
  6487     MOVE -1                     TO STATEL.
  6488     MOVE AL-UABON               TO STATEA.
  6489     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6490
  6491 1390-EXIT.
  6492      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 115
* EL677.cbl
  6494
  6495 1400-VERIFY-ACCOUNT.
  6496     IF EIBAID = DFHPF5
  6497         GO TO 1410-BUILD-ACCOUNT-KEY.
  6498
  6499     IF MAINTL GREATER +0
  6500         NEXT SENTENCE
  6501       ELSE
  6502         GO TO 1490-EXIT.
  6503
  6504*    IF MAINTI = 'A' OR 'C' OR 'V'
  6505     IF MAINTI = 'A' OR 'V'
  6506         NEXT SENTENCE
  6507       ELSE
  6508         GO TO 1490-EXIT.
  6509
  6510 1410-BUILD-ACCOUNT-KEY.
  6511     MOVE CARRIERI               TO ERACCT-CARRIER.
  6512     MOVE GROUPI                 TO ERACCT-GROUPING
  6513     MOVE STATEI                 TO ERACCT-STATE.
  6514     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6515     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6516
  6517     MOVE '2'                    TO DC-OPTION-CODE.
  6518     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6519
  6520     PERFORM 8500-DATE-CONVERT.
  6521     IF DATE-CONVERSION-ERROR
  6522        GO TO 1480-ACCOUNT-INVALID.
  6523
  6524     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6525    .
  6526 1420-get-eracct.
  6527     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6528
  6529
  6530* EXEC CICS HANDLE CONDITION
  6531*        NOTFND   (1480-ACCOUNT-INVALID)
  6532*        ENDFILE  (1480-ACCOUNT-INVALID)
  6533*    END-EXEC.
  6534*    MOVE '"$I''                  ! & #00006312' TO DFHEIV0
  6535     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6537     MOVE X'2620233030303036333132' TO DFHEIV0(25:11)
  6538     CALL 'kxdfhei1' USING DFHEIV0
  6539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6540
  6541
  6542
  6543* EXEC CICS STARTBR
  6544*        DATASET   (ERACCT-FILE-ID)
  6545*        RIDFLD    (ERACCT-KEY)
  6546*    END-EXEC.
  6547     MOVE 0
  6548       TO DFHEIV11
  6549*    MOVE '&,         G          &   #00006317' TO DFHEIV0
  6550     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6551     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 116
* EL677.cbl
  6552     MOVE X'2020233030303036333137' TO DFHEIV0(25:11)
  6553     CALL 'kxdfhei1' USING DFHEIV0,
  6554           ERACCT-FILE-ID,
  6555           ERACCT-KEY,
  6556           DFHEIV99,
  6557           DFHEIV11,
  6558           DFHEIV99
  6559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6560
  6561
  6562     set eracct-start to true
  6563     .
  6564 1420-READNEXT-ACCOUNT-MASTER.
  6565
  6566* EXEC CICS READNEXT
  6567*        DATASET   (ERACCT-FILE-ID)
  6568*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6569*        RIDFLD    (ERACCT-KEY)
  6570*    END-EXEC.
  6571     MOVE 0
  6572       TO DFHEIV11
  6573*    MOVE '&.S                   )   #00006325' TO DFHEIV0
  6574     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6575     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6576     MOVE X'2020233030303036333235' TO DFHEIV0(25:11)
  6577     CALL 'kxdfhei1' USING DFHEIV0,
  6578           ERACCT-FILE-ID,
  6579           DFHEIV20,
  6580           DFHEIV99,
  6581           ERACCT-KEY,
  6582           DFHEIV99,
  6583           DFHEIV11,
  6584           DFHEIV99,
  6585           DFHEIV99
  6586     SET ADDRESS OF ACCOUNT-MASTER TO
  6587         DFHEIV20
  6588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6589
  6590
  6591*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6592*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6593*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6594*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6595*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6596*         GO TO 1480-ACCOUNT-INVALID.
  6597*
  6598*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6599*        GO TO 1480-ACCOUNT-INVALID.
  6600*
  6601*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6602*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6603
  6604     evaluate true
  6605        when (save-eracct-key (1:20) not =
  6606           am-control-primary (1:20))
  6607           and (not eracct-found)
  6608           go to 1480-account-invalid
  6609        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 117
* EL677.cbl
  6610           am-control-primary (1:20))
  6611           and (eracct-found)
  6612           move ws-hold-eracct-record
  6613                                 to account-master
  6614        when (sv-acct-exp-date < am-effective-dt)
  6615           and (not eracct-found)
  6616           go to 1480-account-invalid
  6617        when sv-acct-exp-date >= am-expiration-dt
  6618           go to 1420-readnext-account-master
  6619        when am-expiration-dt = high-values
  6620           continue
  6621        when other
  6622           set eracct-found to true
  6623           move account-master   to ws-hold-eracct-record
  6624           go to 1420-readnext-account-master
  6625     end-evaluate
  6626     if eracct-start
  6627
  6628* exec cics endbr
  6629*          dataset  (eracct-file-id)
  6630*       end-exec
  6631     MOVE 0
  6632       TO DFHEIV11
  6633*    MOVE '&2                    $   #00006367' TO DFHEIV0
  6634     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6635     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6636     MOVE X'2020233030303036333637' TO DFHEIV0(25:11)
  6637     CALL 'kxdfhei1' USING DFHEIV0,
  6638           eracct-file-id,
  6639           DFHEIV11,
  6640           DFHEIV99
  6641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6642     end-if
  6643*    if am-expiration-dt = high-values
  6644*       continue
  6645*    else
  6646*       move account-master      to ws-hold-eracct-record
  6647*       go to 1420-readnext-account-master
  6648*    end-if
  6649     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6650     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6651     MOVE AM-STATE               TO PI-CR-STATE.
  6652     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6653
  6654     MOVE AM-NAME                TO PI-AM-NAME.
  6655     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6656     MOVE AM-CITY                TO PI-AM-CITY-st
  6657     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6658     move am-csr-code            to pi-am-csr
  6659
  6660     MOVE +0                     TO WS-SUB.
  6661
  6662 1430-FIND-ACC-AGT.
  6663     ADD +1                      TO WS-SUB.
  6664
  6665     IF  WS-SUB GREATER +10
  6666         GO TO 1480-ACCOUNT-INVALID.
  6667
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 118
* EL677.cbl
  6668     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F' OR 'S')
  6669         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6670       ELSE
  6671         GO TO 1430-FIND-ACC-AGT.
  6672
  6673     MOVE AL-UANON               TO CARRIERA
  6674                                    GROUPA
  6675                                    STATEA.
  6676
  6677     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6678
  6679     GO TO 1490-EXIT.
  6680
  6681 1480-ACCOUNT-INVALID.
  6682     MOVE -1                     TO CARRIERL
  6683     MOVE AL-UANON               TO CARRIERA
  6684                                    GROUPA
  6685                                    STATEA
  6686                                    ACCTA.
  6687     MOVE ER-2210                TO EMI-ERROR.
  6688     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6689     GO TO 8200-SEND-DATAONLY.
  6690
  6691 1490-EXIT.
  6692      EXIT.
  6693
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 119
* EL677.cbl
  6695 1500-VERIFY-PENDING-BUS-REC.
  6696
  6697* EXEC CICS HANDLE CONDITION
  6698*        NOTFND   (1590-EXIT)
  6699*    END-EXEC.
  6700*    MOVE '"$I                   ! '' #00006424' TO DFHEIV0
  6701     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6703     MOVE X'2720233030303036343234' TO DFHEIV0(25:11)
  6704     CALL 'kxdfhei1' USING DFHEIV0
  6705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6706
  6707
  6708     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6709
  6710     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6711     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6712     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6713     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6714     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6715     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6716     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6717     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6718     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6719     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6720
  6721     IF ST-ACCNT-CNTL  OR
  6722        ACCNT-CNTL
  6723          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6724
  6725     IF ST-ACCNT-CNTL      OR
  6726        CARR-ST-ACCNT-CNTL OR
  6727        ACCNT-CNTL         OR
  6728        CARR-ACCNT-CNTL
  6729          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6730
  6731     IF ACCNT-CNTL OR
  6732        CARR-ACCNT-CNTL
  6733          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6734
  6735
  6736* EXEC CICS READ
  6737*         DATASET   (ERPNDB-ALT-FILE-ID)
  6738*         SET       (ADDRESS OF PENDING-BUSINESS)
  6739*         RIDFLD    (ERPNDB-ALT-KEY)
  6740*     END-EXEC.
  6741*    MOVE '&"S        E          (   #00006455' TO DFHEIV0
  6742     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6744     MOVE X'2020233030303036343535' TO DFHEIV0(25:11)
  6745     CALL 'kxdfhei1' USING DFHEIV0,
  6746           ERPNDB-ALT-FILE-ID,
  6747           DFHEIV20,
  6748           DFHEIV99,
  6749           ERPNDB-ALT-KEY,
  6750           DFHEIV99,
  6751           DFHEIV99,
  6752           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 120
* EL677.cbl
  6753     SET ADDRESS OF PENDING-BUSINESS TO
  6754         DFHEIV20
  6755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6756
  6757
  6758     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6759
  6760     IF PB-C-PAYEE-CODE GREATER SPACES
  6761        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6762
  6763     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6764*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6765
  6766     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6767     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6768
  6769     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6770         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6771     ELSE
  6772         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6773
  6774     IF MAINTI = 'A' OR 'C'
  6775       IF PB-C-REFUND-CREATED
  6776           MOVE -1               TO  MAINTL
  6777           MOVE ER-3445          TO  EMI-ERROR
  6778           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6779
  6780 1590-EXIT.
  6781      EXIT.
  6782
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 121
* EL677.cbl
  6784 2000-ADD-RECORD.
  6785
  6786* EXEC CICS GETMAIN
  6787*        SET      (ADDRESS OF CHECK-RECORDS)
  6788*        LENGTH   (600)
  6789*        INITIMG  (GETMAIN-SPACE)
  6790*    END-EXEC.
  6791     MOVE 600
  6792       TO DFHEIV11
  6793*    MOVE ',"IL                  $   #00006488' TO DFHEIV0
  6794     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6795     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6796     MOVE X'2020233030303036343838' TO DFHEIV0(25:11)
  6797     CALL 'kxdfhei1' USING DFHEIV0,
  6798           DFHEIV20,
  6799           DFHEIV11,
  6800           GETMAIN-SPACE
  6801     SET ADDRESS OF CHECK-RECORDS TO
  6802         DFHEIV20
  6803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6804
  6805
  6806     MOVE 'CH'                   TO CH-RECORD-ID.
  6807     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6808     MOVE CARRIERI               TO CH-CARRIER.
  6809     MOVE GROUPI                 TO CH-GROUPING.
  6810     MOVE STATEI                 TO CH-STATE.
  6811     MOVE ACCTI                  TO CH-ACCOUNT.
  6812
  6813     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6814     MOVE '2'                    TO DC-OPTION-CODE.
  6815     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6816     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6817
  6818     MOVE CERTNOI                TO CH-CERT-PRIME.
  6819     MOVE SFXI                   TO CH-CERT-SFX.
  6820
  6821     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6822
  6823     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6824                                    ch-released-by
  6825     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6826
  6827     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6828     MOVE '5'                    TO DC-OPTION-CODE.
  6829     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6830     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6831                                    ch-released-dt
  6832
  6833     move 'P'                    to ch-approval-status
  6834
  6835     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6836                                    CH-VOID-DT
  6837                                    CH-CREDIT-ACCEPT-DT
  6838                                    CH-CANC-DT
  6839                                    ch-approval-dt
  6840                                    ch-check-cashed-dt
  6841     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 122
* EL677.cbl
  6842                                    CH-AH-REFUND
  6843*                                   CH-DEDUCT-WITHHELD
  6844*                                   CH-ADDITIONAL-CHARGE.
  6845
  6846     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6847
  6848     if pi-prev-paid not numeric
  6849        move zeros               to pi-prev-paid
  6850     end-if
  6851     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6852       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6853        EIBAID NOT = DFHPF4)
  6854         GO TO 8200-SEND-DATAONLY.
  6855
  6856     add ch-amount-paid to pi-prev-paid
  6857     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6858     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6859     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6860     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6861     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6862     move pi-am-csr              to ch-csr
  6863     .
  6864 2100-WRITE-RECORD.
  6865
  6866* exec cics read
  6867*       dataset    (erchek-file-id)
  6868*       into       (ws-dummy-erchek)
  6869*       ridfld     (ch-control-primary)
  6870*       resp       (ws-response)
  6871*    end-exec
  6872     MOVE LENGTH OF
  6873      ws-dummy-erchek
  6874       TO DFHEIV11
  6875*    MOVE '&"IL       E          (  N#00006553' TO DFHEIV0
  6876     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6878     MOVE X'204E233030303036353533' TO DFHEIV0(25:11)
  6879     CALL 'kxdfhei1' USING DFHEIV0,
  6880           erchek-file-id,
  6881           ws-dummy-erchek,
  6882           DFHEIV11,
  6883           ch-control-primary,
  6884           DFHEIV99,
  6885           DFHEIV99,
  6886           DFHEIV99
  6887     MOVE EIBRESP  TO ws-response
  6888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6889     if RESP-NOTFND
  6890        continue
  6891     else
  6892        add +1 to ch-sequence-no
  6893        add 1 to seqi
  6894        go to 2100-write-record
  6895     end-if
  6896     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
  6897
  6898* EXEC CICS HANDLE CONDITION
  6899*        DUPREC (2200-DUPREC)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 123
* EL677.cbl
  6900*    END-EXEC.
  6901*    MOVE '"$%                   ! ( #00006567' TO DFHEIV0
  6902     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6904     MOVE X'2820233030303036353637' TO DFHEIV0(25:11)
  6905     CALL 'kxdfhei1' USING DFHEIV0
  6906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6907
  6908
  6909     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  6910     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  6911                                    CH-CHECK-QUE-SEQUENCE
  6912
  6913
  6914* EXEC CICS WRITE
  6915*        DATASET  (ERCHEK-FILE-ID)
  6916*        FROM     (CHECK-RECORDS)
  6917*        RIDFLD   (CH-CONTROL-PRIMARY)
  6918*    END-EXEC.
  6919     MOVE LENGTH OF
  6920      CHECK-RECORDS
  6921       TO DFHEIV11
  6922*    MOVE '&$ L                  ''   #00006575' TO DFHEIV0
  6923     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6924     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6925     MOVE X'2020233030303036353735' TO DFHEIV0(25:11)
  6926     CALL 'kxdfhei1' USING DFHEIV0,
  6927           ERCHEK-FILE-ID,
  6928           CHECK-RECORDS,
  6929           DFHEIV11,
  6930           CH-CONTROL-PRIMARY,
  6931           DFHEIV99,
  6932           DFHEIV99
  6933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6934
  6935
  6936     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  6937             ERCHEK-RECORD-LENGTH + 23.
  6938
  6939     PERFORM 6200-UPDATE-PENDING-BUS-REC THRU 6200-EXIT.
  6940     if resp-normal
  6941        MOVE 'Y'                 TO PB-C-REFUND-SW
  6942        add +1 to pi-chek-rec-cnt
  6943        perform 6210-rewrite-pndb thru 6210-exit
  6944*       PERFORM 2700-WRITE-SQL   THRU 2700-EXIT
  6945     end-if
  6946*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
  6947
  6948     IF EMI-NO-ERRORS
  6949         MOVE ER-0000            TO EMI-ERROR
  6950     ELSE
  6951         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  6952            EIBAID = DFHPF4
  6953             MOVE ER-2600        TO EMI-ERROR.
  6954
  6955     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6956
  6957     MOVE LOW-VALUES             TO EL677AI.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 124
* EL677.cbl
  6958
  6959     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  6960     MOVE PI-CHEK-GROUPING       TO GROUPO.
  6961     MOVE PI-CHEK-STATE          TO STATEO.
  6962     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  6963
  6964     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  6965     MOVE SPACE                  TO DC-OPTION-CODE.
  6966     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6967     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  6968
  6969     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  6970     MOVE PI-CHEK-SUF-NO         TO SFXO.
  6971     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  6972
  6973     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  6974                                    ACCTA     EFFDTA  CERTNOA
  6975                                    SFXA.
  6976     MOVE AL-UNNON               TO SEQA.
  6977     go to 5000-browse-file
  6978     GO TO 8100-SEND-INITIAL-MAP.
  6979
  6980 2200-DUPREC.
  6981     ADD +1 TO CH-SEQUENCE-NO.
  6982     MOVE CH-SEQUENCE-NO         TO SEQO
  6983                                    PI-CHEK-SEQUENCE
  6984                                    CHEK-RECORD-SEQ.
  6985     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 125
* EL677.cbl
  6987
  6988 2500-WRITE-PAY-ADJ.
  6989
  6990     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  6991
  6992     IF CH-AMOUNT-PAID = ZEROS
  6993         GO TO 2510-CONTINUE.
  6994     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  6995     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  6996
  6997 2510-CONTINUE.
  6998
  6999     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7000         GO TO 2580-HANDLE-ELCNTL-FILE.
  7001
  7002 2550-BUILD-ERPYAJ-RECORD.
  7003
  7004
  7005* EXEC CICS GETMAIN
  7006*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7007*        LENGTH  (200)
  7008*        INITIMG (GETMAIN-SPACE)
  7009*    END-EXEC.
  7010     MOVE 200
  7011       TO DFHEIV11
  7012*    MOVE ',"IL                  $   #00006649' TO DFHEIV0
  7013     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7014     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7015     MOVE X'2020233030303036363439' TO DFHEIV0(25:11)
  7016     CALL 'kxdfhei1' USING DFHEIV0,
  7017           DFHEIV20,
  7018           DFHEIV11,
  7019           GETMAIN-SPACE
  7020     SET ADDRESS OF PENDING-PAY-ADJ TO
  7021         DFHEIV20
  7022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7023
  7024
  7025     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7026     MOVE 'PY'                   TO PY-RECORD-ID.
  7027     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7028
  7029     MOVE CARRIERI               TO PY-CARRIER.
  7030     IF PI-ZERO-CARRIER  OR
  7031        PI-ZERO-CAR-GROUP
  7032         MOVE ZERO               TO PY-CARRIER.
  7033
  7034     MOVE GROUPI                 TO PY-GROUPING.
  7035     IF PI-ZERO-GROUPING  OR
  7036        PI-ZERO-CAR-GROUP
  7037         MOVE ZERO               TO PY-GROUPING.
  7038
  7039     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7040     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7041     MOVE 'C'                    TO PY-RECORD-TYPE.
  7042     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7043
  7044     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 126
* EL677.cbl
  7045                                    WS-PY-REF-DATE
  7046                                    WS-PY-END-DATE
  7047                                    WS-PY-DED-DATE
  7048                                    WS-PY-ADDL-DATE.
  7049     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7050     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7051                                    WS-PY-REF-CERT
  7052                                    WS-PY-END-CERT
  7053                                    WS-PY-DED-CERT
  7054                                    WS-PY-ADDL-CERT
  7055                                    WS-TMS-PY-CERT.
  7056     IF SFXI NOT = LOW-VALUES
  7057         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7058                                    WS-PY-REF-SUFFIX
  7059                                    WS-PY-END-SUFFIX
  7060                                    WS-PY-DED-SUFFIX
  7061                                    WS-PY-ADDL-SUFFIX
  7062     ELSE
  7063         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7064                                    WS-PY-REF-SUFFIX
  7065                                    WS-PY-END-SUFFIX
  7066                                    WS-PY-DED-SUFFIX
  7067                                    WS-PY-ADDL-SUFFIX.
  7068
  7069     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7070         MOVE WS-TMS-ENTRY-COMMENT
  7071                                 TO PY-ENTRY-COMMENT
  7072     ELSE
  7073         IF TYPEI EQUAL 'R'
  7074             MOVE WS-PY-REF-COMMENT
  7075                                 TO PY-ENTRY-COMMENT
  7076         ELSE
  7077             IF TYPEI EQUAL 'E'
  7078                 MOVE WS-PY-END-COMMENT
  7079                                 TO PY-ENTRY-COMMENT
  7080             ELSE
  7081                 MOVE WS-PY-ENTRY-COMMENT
  7082                                 TO PY-ENTRY-COMMENT.
  7083
  7084     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7085
  7086     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7087     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7088     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7089                                    PY-INPUT-DT.
  7090*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7091*                                   PY-CHECK-QUE-SEQUENCE.
  7092     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7093                                    PY-REPORTED-DT
  7094                                    PY-CHECK-WRITTEN-DT
  7095                                    PY-BILLED-DATE
  7096                                    PY-AR-DATE
  7097                                    PY-GL-DATE.
  7098     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7099     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7100*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7101
  7102     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 127
* EL677.cbl
  7103         MOVE 'B'                TO PY-PYMT-TYPE
  7104         MOVE 'A'                TO PY-PMT-APPLIED.
  7105
  7106 2559-BUILD-EXIT.
  7107     EXIT.
  7108
  7109 2570-WRITE-ERPYAJ-RECORD.
  7110
  7111
  7112* EXEC CICS HANDLE CONDITION
  7113*        DUPREC (2577-DUPREC)
  7114*    END-EXEC.
  7115*    MOVE '"$%                   ! ) #00006741' TO DFHEIV0
  7116     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7117     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7118     MOVE X'2920233030303036373431' TO DFHEIV0(25:11)
  7119     CALL 'kxdfhei1' USING DFHEIV0
  7120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7121
  7122
  7123
  7124* EXEC CICS WRITE
  7125*        DATASET (ERPYAJ-FILE-ID)
  7126*        FROM    (PENDING-PAY-ADJ)
  7127*        RIDFLD  (PY-CONTROL-PRIMARY)
  7128*    END-EXEC.
  7129     MOVE LENGTH OF
  7130      PENDING-PAY-ADJ
  7131       TO DFHEIV11
  7132*    MOVE '&$ L                  ''   #00006745' TO DFHEIV0
  7133     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7134     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7135     MOVE X'2020233030303036373435' TO DFHEIV0(25:11)
  7136     CALL 'kxdfhei1' USING DFHEIV0,
  7137           ERPYAJ-FILE-ID,
  7138           PENDING-PAY-ADJ,
  7139           DFHEIV11,
  7140           PY-CONTROL-PRIMARY,
  7141           DFHEIV99,
  7142           DFHEIV99
  7143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7144
  7145
  7146     GO TO 2579-WRITE-EXIT.
  7147
  7148 2577-DUPREC.
  7149     ADD +1 TO PY-FILE-SEQ-NO.
  7150
  7151     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7152
  7153 2579-WRITE-EXIT.
  7154     EXIT.
  7155
  7156 2580-HANDLE-ELCNTL-FILE.
  7157
  7158     IF CR-CHECK-NO-AUTO-SEQ
  7159         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7160     ELSE
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 128
* EL677.cbl
  7161
  7162* EXEC CICS UNLOCK
  7163*            DATASET (ELCNTL-FILE-ID)
  7164*        END-EXEC.
  7165*    MOVE '&*                    #   #00006766' TO DFHEIV0
  7166     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7167     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7168     MOVE X'2020233030303036373636' TO DFHEIV0(25:11)
  7169     CALL 'kxdfhei1' USING DFHEIV0,
  7170           ELCNTL-FILE-ID,
  7171           DFHEIV99
  7172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7173
  7174
  7175 2590-EXIT.
  7176      EXIT.
  7177
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 129
* EL677.cbl
  7179
  7180 2600-READ-CONTROL-FILE.
  7181     MOVE SPACES                 TO ELCNTL-KEY.
  7182     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7183     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7184     MOVE +0                     TO ELCNTL-SEQ.
  7185
  7186
  7187* EXEC CICS HANDLE CONDITION
  7188*        NOTFND   (2600-NO-CO-MASTER)
  7189*    END-EXEC.
  7190*    MOVE '"$I                   ! * #00006781' TO DFHEIV0
  7191     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7193     MOVE X'2A20233030303036373831' TO DFHEIV0(25:11)
  7194     CALL 'kxdfhei1' USING DFHEIV0
  7195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7196
  7197
  7198
  7199* EXEC CICS READ
  7200*        DATASET   (ELCNTL-FILE-ID)
  7201*        SET       (ADDRESS OF CONTROL-FILE)
  7202*        RIDFLD    (ELCNTL-KEY)
  7203*    END-EXEC.
  7204*    MOVE '&"S        E          (   #00006785' TO DFHEIV0
  7205     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7207     MOVE X'2020233030303036373835' TO DFHEIV0(25:11)
  7208     CALL 'kxdfhei1' USING DFHEIV0,
  7209           ELCNTL-FILE-ID,
  7210           DFHEIV20,
  7211           DFHEIV99,
  7212           ELCNTL-KEY,
  7213           DFHEIV99,
  7214           DFHEIV99,
  7215           DFHEIV99
  7216     SET ADDRESS OF CONTROL-FILE TO
  7217         DFHEIV20
  7218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7219
  7220
  7221     GO TO 2600-EXIT
  7222
  7223     .
  7224 2600-NO-CO-MASTER.
  7225     MOVE ER-0022                TO  EMI-ERROR.
  7226     MOVE -1                     TO  CARRIERL.
  7227     MOVE AL-UABON               TO  CARRIERA.
  7228     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7229
  7230 2600-EXIT.
  7231      EXIT.
  7232
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 130
* EL677.cbl
  7234 2650-REWRITE-CONTROL-FILE.
  7235
  7236* EXEC CICS READ
  7237*        DATASET   (ELCNTL-FILE-ID)
  7238*        SET       (ADDRESS OF CONTROL-FILE)
  7239*        RIDFLD    (ELCNTL-KEY)
  7240*        UPDATE
  7241*    END-EXEC.
  7242*    MOVE '&"S        EU         (   #00006805' TO DFHEIV0
  7243     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7244     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7245     MOVE X'2020233030303036383035' TO DFHEIV0(25:11)
  7246     CALL 'kxdfhei1' USING DFHEIV0,
  7247           ELCNTL-FILE-ID,
  7248           DFHEIV20,
  7249           DFHEIV99,
  7250           ELCNTL-KEY,
  7251           DFHEIV99,
  7252           DFHEIV99,
  7253           DFHEIV99
  7254     SET ADDRESS OF CONTROL-FILE TO
  7255         DFHEIV20
  7256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7257
  7258
  7259
  7260* EXEC CICS REWRITE
  7261*         DATASET (ELCNTL-FILE-ID)
  7262*         FROM    (CONTROL-FILE)
  7263*     END-EXEC.
  7264     MOVE LENGTH OF
  7265      CONTROL-FILE
  7266       TO DFHEIV11
  7267*    MOVE '&& L                  %   #00006812' TO DFHEIV0
  7268     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7269     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7270     MOVE X'2020233030303036383132' TO DFHEIV0(25:11)
  7271     CALL 'kxdfhei1' USING DFHEIV0,
  7272           ELCNTL-FILE-ID,
  7273           CONTROL-FILE,
  7274           DFHEIV11,
  7275           DFHEIV99
  7276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7277
  7278
  7279 2650-EXIT.
  7280      EXIT.
  7281 2700-WRITE-SQL.
  7282     perform 2710-build-rec      thru 2710-exit
  7283     perform 2720-insert-row     thru 2720-exit
  7284     perform 4300-FINISH-UP-DB   thru 4300-exit
  7285     .
  7286 2700-EXIT.
  7287     EXIT.
  7288 2710-BUILD-REC.
  7289     move spaces                 to daily-check-request-rec
  7290     move pi-company-id          to db-compid
  7291     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 131
* EL677.cbl
  7292                                    db-fincar
  7293     move ch-grouping            to db-grouping
  7294                                    db-fingrp
  7295     move ch-state               to db-state
  7296     move ch-account             to db-account
  7297     move ch-cert-eff-dt         to dc-bin-date-1
  7298     move ' '                    to dc-option-code
  7299     perform 8500-date-convert   thru 8500-exit
  7300     if no-conversion-error
  7301        move dc-greg-date-a-edit to db-effdate
  7302     else
  7303        move spaces              to db-effdate
  7304     end-if
  7305     move ch-cert-prime          to db-certificate
  7306     move ch-cert-sfx            to db-cert-sfx
  7307     move ch-sequence-no         to db-seq-no
  7308     move '1'                    to db-type
  7309     move ch-amount-paid         to db-amount-n
  7310     move zeros                  to db-checkstatus
  7311     move ch-check-que-control   to db-releasebatch
  7312     move save-bin-date          to dc-bin-date-1
  7313     move ' '                    to dc-option-code
  7314     perform 8500-date-convert   thru 8500-exit
  7315     if no-conversion-error
  7316        move dc-greg-date-a-edit to db-releasedt
  7317     else
  7318        move spaces              to db-releasedt
  7319     end-if
  7320     move pi-processor-id        to db-releaseby
  7321     move ch-payee-name-1        to db-payeename1
  7322     move ch-payee-name-2        to db-payeename2
  7323     move ch-payee-address-1     to db-payeeaddr1
  7324     move ch-payee-address-2     to db-payeeaddr2
  7325     move ch-payee-city          to db-payeecity
  7326     move ch-payee-state         to db-payeest
  7327     move ch-payee-zip-code      to db-payeezip
  7328     move ch-comp-fin-resp       to db-finresp
  7329     move ch-comp-account        to db-finacct
  7330     move ch-recorded-by         to db-preparer
  7331     move ch-return-to           to db-return-to
  7332     move pi-table-name          to db-insured-name
  7333     .
  7334 2710-EXIT.
  7335     EXIT.
  7336 2720-INSERT-ROW.
  7337     if not connected-to-db
  7338        perform 4100-CONNECT-TO-DB
  7339                                 thru 4100-exit
  7340     end-if
  7341     EXEC SQL
  7342        INSERT into ChkApp_Check (
  7343           Company,
  7344           CertCarrier,
  7345           CertGroup,
  7346           CertState,
  7347           CertAccount,
  7348           CertEffDate,
  7349           CertNumber,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 132
* EL677.cbl
  7350           CertNumberSuf,
  7351           CheckSeqNbr,
  7352           CheckType,
  7353           CheckAmount,
  7354           ReleaseBatchNbr,
  7355           ReleaseDate,
  7356           ReleasedBy,
  7357           PayeeName1,
  7358           PayeeName2,
  7359           PayeeAddress1,
  7360           PayeeAddress2,
  7361           PayeeCity,
  7362           PayeeState,
  7363           PayeeZip,
  7364           CompCarrier,
  7365           CompGroup,
  7366           CompFinResp,
  7367           CompAccount,
  7368           Preparer,
  7369           ReturnTo,
  7370           InsuredName)
  7371         VALUES (
  7372           :DB-CompId,
  7373           :DB-Carrier,
  7374           :DB-Grouping,
  7375           :DB-State,
  7376           :DB-Account,
  7377           :DB-EffDate,
  7378           :DB-Certificate,
  7379           :db-cert-sfx,
  7380           :DB-Seq-No,
  7381           :DB-Type,
  7382           :db-amount,
  7383           :db-releasebatch,
  7384           :db-releasedt,
  7385           :db-releaseby,
  7386           :db-payeename1,
  7387           :db-payeename2,
  7388           :db-payeeaddr1,
  7389           :db-payeeaddr2,
  7390           :db-payeecity,
  7391           :db-payeest,
  7392           :db-payeezip,
  7393           :db-fincar,
  7394           :db-fingrp,
  7395           :db-finresp,
  7396           :db-finacct,
  7397           :db-preparer,
  7398           :db-return-to,
  7399           :db-insured-name)
  7400     END-EXEC
  7401     if sqlcode = -2601
  7402        add +1                   to ch-sequence-no
  7403        move ch-sequence-no      to DB-Seq-No
  7404        go to 2720-insert-row
  7405     end-if
  7406     if sqlcode not = 0
  7407        display "Error: cannot insert row "
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 133
* EL677.cbl
  7408        display ' sql return code ' sqlcode
  7409        move sqlcode to ws-sql-code
  7410        move ws-sql-code to ws-dis-sql-code
  7411        display ' dis sql code ' ws-dis-sql-code
  7412        display ' sql err mess    ' sqlerrmc
  7413        move sqlcode to ws-sql-code
  7414        move ws-sql-code to ws-dis-sql-code
  7415        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7416           into EMI-MESSAGE-AREA (1)
  7417        end-string
  7418        display ' msga1 ' emi-message-area (1)
  7419        perform 4300-FINISH-UP-DB thru 4300-exit
  7420        go to 8200-send-dataonly
  7421*       goback
  7422     end-if
  7423     .
  7424 2720-EXIT.
  7425     EXIT.
  7426 3000-CHANGE-RECORD.
  7427
  7428* EXEC CICS HANDLE CONDITION
  7429*        NOTFND (3900-RECORD-NOTFND)
  7430*    END-EXEC.
  7431*    MOVE '"$I                   ! + #00006965' TO DFHEIV0
  7432     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7434     MOVE X'2B20233030303036393635' TO DFHEIV0(25:11)
  7435     CALL 'kxdfhei1' USING DFHEIV0
  7436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7437
  7438
  7439
  7440* EXEC CICS READ
  7441*        DATASET  (ERCHEK-FILE-ID)
  7442*        SET      (ADDRESS OF CHECK-RECORDS)
  7443*        RIDFLD   (PI-ERCHEK-KEY)
  7444*        UPDATE
  7445*    END-EXEC.
  7446*    MOVE '&"S        EU         (   #00006969' TO DFHEIV0
  7447     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7448     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7449     MOVE X'2020233030303036393639' TO DFHEIV0(25:11)
  7450     CALL 'kxdfhei1' USING DFHEIV0,
  7451           ERCHEK-FILE-ID,
  7452           DFHEIV20,
  7453           DFHEIV99,
  7454           PI-ERCHEK-KEY,
  7455           DFHEIV99,
  7456           DFHEIV99,
  7457           DFHEIV99
  7458     SET ADDRESS OF CHECK-RECORDS TO
  7459         DFHEIV20
  7460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7461
  7462
  7463     IF CH-LF-REFUND NOT NUMERIC
  7464         MOVE ZEROS              TO CH-LF-REFUND.
  7465     IF CH-AH-REFUND NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 134
* EL677.cbl
  7466         MOVE ZEROS              TO CH-AH-REFUND.
  7467*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7468*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7469*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7470*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7471
  7472     IF VREASONL NOT = ZEROS
  7473         MOVE VREASONI           TO  CH-VOID-REASON.
  7474
  7475     IF MAINTI = 'V'
  7476        GO TO 3050-void-processing
  7477     end-if
  7478
  7479     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7480
  7481     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7482
  7483     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7484       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7485        EIBAID NOT = DFHPF4)
  7486         GO TO 8200-SEND-DATAONLY.
  7487     go to 3100-rewrite-record
  7488     .
  7489 3050-void-processing.
  7490     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7491     if sqlcode = 0
  7492        perform 4200-get-tbl-row thru 4200-exit
  7493        if sqlcode = 0
  7494           if nu-app-date = -1
  7495              move -1            to maintl
  7496              move er-3453       to emi-error
  7497              move al-uabon      to mainta
  7498              perform 9900-error-format
  7499                                 thru 9900-exit
  7500              perform 4300-FINISH-UP-DB thru 4300-exit
  7501              go to 8200-send-dataonly
  7502           end-if
  7503        end-if
  7504        if connected-to-db
  7505           perform 4300-FINISH-UP-DB thru 4300-exit
  7506        end-if
  7507     end-if
  7508     if (ch-check-written-dt = low-values)
  7509        or (ch-check-no = spaces)
  7510        move -1                  to maintl
  7511        move er-3455             to emi-error
  7512        move al-uabon            to mainta
  7513        perform 9900-error-format
  7514                                 thru 9900-exit
  7515        perform 4300-FINISH-UP-DB thru 4300-exit
  7516        go to 8200-send-dataonly
  7517     .
  7518 3100-REWRITE-RECORD.
  7519     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7520
  7521     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7522     MOVE '5'                    TO DC-OPTION-CODE.
  7523     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 135
* EL677.cbl
  7524
  7525     IF MAINTI = 'C'
  7526       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7527     end-if
  7528*      IF MANUAL-CHECK-WRITTEN
  7529*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7530
  7531     IF MAINTI = 'V'
  7532        IF CH-VOID-DT = LOW-VALUES
  7533           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7534           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7535*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7536           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7537           if pi-chek-rec-cnt = +1
  7538              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7539                                 THRU 6200-EXIT
  7540              if resp-normal
  7541                 MOVE ' '        TO PB-C-REFUND-SW
  7542                 perform 6210-rewrite-pndb
  7543                                 thru 6210-exit
  7544              end-if
  7545           end-if
  7546        ELSE
  7547           MOVE -1               TO MAINTL
  7548           MOVE ER-2583          TO EMI-ERROR
  7549           MOVE AL-UABON         TO MAINTA
  7550           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7551           GO TO 8200-SEND-DATAONLY
  7552        end-if
  7553     end-if
  7554
  7555     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7556
  7557
  7558* EXEC CICS REWRITE
  7559*        DATASET  (ERCHEK-FILE-ID)
  7560*        FROM     (CHECK-RECORDS)
  7561*    END-EXEC.
  7562     MOVE LENGTH OF
  7563      CHECK-RECORDS
  7564       TO DFHEIV11
  7565*    MOVE '&& L                  %   #00007070' TO DFHEIV0
  7566     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7567     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7568     MOVE X'2020233030303037303730' TO DFHEIV0(25:11)
  7569     CALL 'kxdfhei1' USING DFHEIV0,
  7570           ERCHEK-FILE-ID,
  7571           CHECK-RECORDS,
  7572           DFHEIV11,
  7573           DFHEIV99
  7574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7575
  7576
  7577     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7578        (MAINTI EQUAL 'C')          AND
  7579        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7580            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7581
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 136
* EL677.cbl
  7582     IF EMI-NO-ERRORS
  7583         MOVE ER-0000            TO EMI-ERROR
  7584     ELSE
  7585         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7586            EIBAID = DFHPF4
  7587             MOVE ER-2600        TO EMI-ERROR.
  7588
  7589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7590
  7591     MOVE LOW-VALUES             TO EL677AI.
  7592
  7593     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7594     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7595     MOVE PI-CHEK-STATE          TO STATEO.
  7596     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7597
  7598     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7599     MOVE SPACE                  TO DC-OPTION-CODE.
  7600     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7601     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7602
  7603     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7604     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7605     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7606
  7607     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7608                                     ACCTA   EFFDTA
  7609                                    CERTNOA   SFXA.
  7610
  7611     MOVE AL-UNNON               TO SEQA.
  7612     go to 5000-browse-file
  7613*    GO TO 8100-SEND-INITIAL-MAP.
  7614
  7615     .
  7616 3200-PAY-ADJS-REVERSAL.
  7617
  7618     IF CH-AMOUNT-PAID NOT = ZEROS
  7619         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7620         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7621
  7622     GO TO 3290-EXIT
  7623     .
  7624 3250-BUILD-ERPYAJ-REVERSAL.
  7625
  7626
  7627* EXEC CICS GETMAIN
  7628*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7629*        LENGTH  (200)
  7630*        INITIMG (GETMAIN-SPACE)
  7631*    END-EXEC.
  7632     MOVE 200
  7633       TO DFHEIV11
  7634*    MOVE ',"IL                  $   #00007124' TO DFHEIV0
  7635     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7636     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7637     MOVE X'2020233030303037313234' TO DFHEIV0(25:11)
  7638     CALL 'kxdfhei1' USING DFHEIV0,
  7639           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 137
* EL677.cbl
  7640           DFHEIV11,
  7641           GETMAIN-SPACE
  7642     SET ADDRESS OF PENDING-PAY-ADJ TO
  7643         DFHEIV20
  7644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7645
  7646
  7647     MOVE 'PY'                   TO PY-RECORD-ID.
  7648     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7649
  7650     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7651     IF PI-ZERO-CARRIER  OR
  7652        PI-ZERO-CAR-GROUP
  7653         MOVE ZERO               TO PY-CARRIER.
  7654
  7655     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7656     IF PI-ZERO-GROUPING  OR
  7657        PI-ZERO-CAR-GROUP
  7658         MOVE ZERO               TO PY-GROUPING.
  7659
  7660     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7661     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7662     MOVE 'C'                    TO PY-RECORD-TYPE.
  7663     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7664     move '1825011300'           to py-gl-account
  7665     move 'VOID REFCK'           TO py-gl-comment
  7666     COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7667
  7668     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7669     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7670
  7671     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7672     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7673     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7674                                    PY-INPUT-DT.
  7675*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7676*                                   PY-CHECK-QUE-SEQUENCE.
  7677     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7678                                    PY-BILLED-DATE
  7679                                    PY-REPORTED-DT
  7680                                    PY-CHECK-WRITTEN-DT
  7681                                    PY-AR-DATE
  7682                                    PY-GL-DATE.
  7683     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7684     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7685     MOVE 'V'                    TO PY-VOID-SW.
  7686*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7687
  7688     IF PI-AR-PROCESSING
  7689         MOVE 'B'                TO PY-PYMT-TYPE
  7690         MOVE 'A'                TO PY-PMT-APPLIED.
  7691
  7692 3259-BUILD-EXIT.
  7693     EXIT.
  7694
  7695 3280-WRITE-ERPYAJ-REVERSAL.
  7696
  7697
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 138
* EL677.cbl
  7698* EXEC CICS HANDLE CONDITION
  7699*        DUPREC (3287-DUPREC)
  7700*    END-EXEC.
  7701*    MOVE '"$%                   ! , #00007180' TO DFHEIV0
  7702     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7704     MOVE X'2C20233030303037313830' TO DFHEIV0(25:11)
  7705     CALL 'kxdfhei1' USING DFHEIV0
  7706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7707
  7708
  7709
  7710* EXEC CICS WRITE
  7711*        DATASET (ERPYAJ-FILE-ID)
  7712*        FROM    (PENDING-PAY-ADJ)
  7713*        RIDFLD  (PY-CONTROL-PRIMARY)
  7714*    END-EXEC.
  7715     MOVE LENGTH OF
  7716      PENDING-PAY-ADJ
  7717       TO DFHEIV11
  7718*    MOVE '&$ L                  ''   #00007184' TO DFHEIV0
  7719     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7721     MOVE X'2020233030303037313834' TO DFHEIV0(25:11)
  7722     CALL 'kxdfhei1' USING DFHEIV0,
  7723           ERPYAJ-FILE-ID,
  7724           PENDING-PAY-ADJ,
  7725           DFHEIV11,
  7726           PY-CONTROL-PRIMARY,
  7727           DFHEIV99,
  7728           DFHEIV99
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732     GO TO 3289-WRITE-EXIT.
  7733
  7734 3287-DUPREC.
  7735     ADD +1 TO PY-FILE-SEQ-NO.
  7736
  7737     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7738
  7739 3289-WRITE-EXIT.
  7740     EXIT.
  7741
  7742 3290-EXIT.
  7743      EXIT.
  7744
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 139
* EL677.cbl
  7746 3300-UPDATE-ERPYAJ.
  7747
  7748
  7749* EXEC CICS GETMAIN
  7750*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7751*        LENGTH  (200)
  7752*        INITIMG (GETMAIN-SPACE)
  7753*    END-EXEC.
  7754     MOVE 200
  7755       TO DFHEIV11
  7756*    MOVE ',"IL                  $   #00007206' TO DFHEIV0
  7757     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7758     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7759     MOVE X'2020233030303037323036' TO DFHEIV0(25:11)
  7760     CALL 'kxdfhei1' USING DFHEIV0,
  7761           DFHEIV20,
  7762           DFHEIV11,
  7763           GETMAIN-SPACE
  7764     SET ADDRESS OF PENDING-PAY-ADJ TO
  7765         DFHEIV20
  7766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7767
  7768
  7769     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7770     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7771     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7772     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7773     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7774     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7775     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7776
  7777
  7778* EXEC CICS HANDLE CONDITION
  7779*        NOTFND   (3390-EXIT)
  7780*        ENDFILE  (3390-EXIT)
  7781*    END-EXEC.
  7782*    MOVE '"$I''                  ! - #00007220' TO DFHEIV0
  7783     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7785     MOVE X'2D20233030303037323230' TO DFHEIV0(25:11)
  7786     CALL 'kxdfhei1' USING DFHEIV0
  7787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7788
  7789
  7790 3320-READNEXT-ERPYAJ.
  7791
  7792
  7793* EXEC CICS READ
  7794*        DATASET  (ERPYAJ-FILE-ID)
  7795*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7796*        RIDFLD   (ERPYAJ-KEY)
  7797*        GTEQ
  7798*    END-EXEC.
  7799*    MOVE '&"S        G          (   #00007227' TO DFHEIV0
  7800     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7802     MOVE X'2020233030303037323237' TO DFHEIV0(25:11)
  7803     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 140
* EL677.cbl
  7804           ERPYAJ-FILE-ID,
  7805           DFHEIV20,
  7806           DFHEIV99,
  7807           ERPYAJ-KEY,
  7808           DFHEIV99,
  7809           DFHEIV99,
  7810           DFHEIV99
  7811     SET ADDRESS OF PENDING-PAY-ADJ TO
  7812         DFHEIV20
  7813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7814
  7815
  7816     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7817
  7818     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7819        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7820        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7821        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7822        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7823        (PY-RECORD-TYPE   NOT = 'C')
  7824          GO TO 3390-EXIT.
  7825
  7826     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7827         ADD +1 TO PYAJ-FILE-SEQ-NO
  7828         GO TO 3320-READNEXT-ERPYAJ.
  7829
  7830
  7831* EXEC CICS READ UPDATE
  7832*        DATASET   (ERPYAJ-FILE-ID)
  7833*        RIDFLD    (ERPYAJ-KEY)
  7834*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7835*    END-EXEC.
  7836*    MOVE '&"S        EU         (   #00007248' TO DFHEIV0
  7837     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7838     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7839     MOVE X'2020233030303037323438' TO DFHEIV0(25:11)
  7840     CALL 'kxdfhei1' USING DFHEIV0,
  7841           ERPYAJ-FILE-ID,
  7842           DFHEIV20,
  7843           DFHEIV99,
  7844           ERPYAJ-KEY,
  7845           DFHEIV99,
  7846           DFHEIV99,
  7847           DFHEIV99
  7848     SET ADDRESS OF PENDING-PAY-ADJ TO
  7849         DFHEIV20
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7851
  7852
  7853     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7854     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7855
  7856     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7857
  7858     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7859     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7860     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7861
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 141
* EL677.cbl
  7862
  7863* EXEC CICS REWRITE
  7864*        DATASET  (ERPYAJ-FILE-ID)
  7865*        FROM     (PENDING-PAY-ADJ)
  7866*    END-EXEC.
  7867     MOVE LENGTH OF
  7868      PENDING-PAY-ADJ
  7869       TO DFHEIV11
  7870*    MOVE '&& L                  %   #00007263' TO DFHEIV0
  7871     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7872     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7873     MOVE X'2020233030303037323633' TO DFHEIV0(25:11)
  7874     CALL 'kxdfhei1' USING DFHEIV0,
  7875           ERPYAJ-FILE-ID,
  7876           PENDING-PAY-ADJ,
  7877           DFHEIV11,
  7878           DFHEIV99
  7879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7880
  7881
  7882 3390-EXIT.
  7883      EXIT.
  7884
  7885 3400-delete-record.
  7886
  7887* EXEC CICS READ
  7888*        DATASET  (ERCHEK-FILE-ID)
  7889*        SET      (ADDRESS OF CHECK-RECORDS)
  7890*        RIDFLD   (PI-ERCHEK-KEY)
  7891*        UPDATE
  7892*        resp     (ws-response)
  7893*    END-EXEC
  7894*    MOVE '&"S        EU         (  N#00007272' TO DFHEIV0
  7895     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7896     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7897     MOVE X'204E233030303037323732' TO DFHEIV0(25:11)
  7898     CALL 'kxdfhei1' USING DFHEIV0,
  7899           ERCHEK-FILE-ID,
  7900           DFHEIV20,
  7901           DFHEIV99,
  7902           PI-ERCHEK-KEY,
  7903           DFHEIV99,
  7904           DFHEIV99,
  7905           DFHEIV99
  7906     SET ADDRESS OF CHECK-RECORDS TO
  7907         DFHEIV20
  7908     MOVE EIBRESP  TO ws-response
  7909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7910     if (ch-in-limbo or ch-approv-pending)
  7911        and (ch-void-dt = low-values)
  7912        and (ch-check-written-dt = low-values)
  7913        and (ch-credit-accept-dt = low-values)
  7914        perform 3500-check-tbl   thru 3500-exit
  7915        if (row-deleted and tbl-commited)
  7916           or (emi-error = er-3450)
  7917
  7918* exec cics delete
  7919*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 142
* EL677.cbl
  7920*          end-exec
  7921*    MOVE '&(                    &   #00007286' TO DFHEIV0
  7922     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7923     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7924     MOVE X'2020233030303037323836' TO DFHEIV0(25:11)
  7925     CALL 'kxdfhei1' USING DFHEIV0,
  7926           erchek-file-id,
  7927           DFHEIV99,
  7928           DFHEIV99,
  7929           DFHEIV99,
  7930           DFHEIV99
  7931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7932        end-if
  7933     else
  7934        move -1               to maintl
  7935        move er-3452          to emi-error
  7936        move al-uabon         to mainta
  7937        perform 9900-error-format
  7938                                 thru 9900-exit
  7939        go to 8200-send-dataonly
  7940     end-if
  7941     if pi-chek-rec-cnt = +1
  7942        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7943                                 THRU 6200-EXIT
  7944        if resp-normal
  7945           MOVE ' '              TO PB-C-REFUND-SW
  7946           perform 6210-rewrite-pndb
  7947                                 thru 6210-exit
  7948        end-if
  7949     end-if
  7950     MOVE ER-0000            TO EMI-ERROR
  7951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7952     MOVE LOW-VALUES             TO EL677AI.
  7953     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7954     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7955     MOVE PI-CHEK-STATE          TO STATEO.
  7956     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7957     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7958     MOVE SPACE                  TO DC-OPTION-CODE.
  7959     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7960     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7961     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7962     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7963     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7964     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7965                                    ACCTA   EFFDTA
  7966                                    CERTNOA   SFXA.
  7967     MOVE AL-UNNON               TO SEQA.
  7968     GO TO 8100-SEND-INITIAL-MAP
  7969     .
  7970 3400-exit.
  7971     exit.
  7972 3500-check-tbl.
  7973     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7974*    if sqlcode = 0
  7975*       perform 4150-open-cursor    thru 4150-exit
  7976*    end-if
  7977     if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 143
* EL677.cbl
  7978        perform 4200-get-tbl-row thru 4200-exit
  7979     end-if
  7980      if sqlcode = 0
  7981         if (nu-app-date = -1)
  7982            or (db-app-status = '2')
  7983            perform 4250-delete-row thru 4250-exit
  7984         else
  7985           MOVE ER-3452            TO  EMI-ERROR
  7986           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7987           MOVE -1                 TO  PFENTERL
  7988           GO TO 8200-SEND-DATAONLY
  7989        end-if
  7990      else
  7991         MOVE ER-3450            TO  EMI-ERROR
  7992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7993         MOVE -1                 TO  PFENTERL
  7994*        GO TO 8200-SEND-DATAONLY
  7995      end-if
  7996     if connected-to-db
  7997        perform 4300-FINISH-UP-DB thru 4300-exit
  7998     end-if
  7999     .
  8000 3500-exit.
  8001     exit.
  8002 3700-UPDATE-ERCHKQ.
  8003*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8004*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8005*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8006*
  8007*    EXEC CICS HANDLE CONDITION
  8008*        NOTFND (3780-CHECK-NOTFND)
  8009*    END-EXEC.
  8010*
  8011*    EXEC CICS READ
  8012*        DATASET  (ERCHKQ-FILE-ID)
  8013*        SET      (ADDRESS OF CHECK-QUE)
  8014*        RIDFLD   (ERCHKQ-KEY)
  8015*        UPDATE
  8016*    END-EXEC.
  8017*
  8018*    IF MAINTI = 'C'
  8019*        IF MANUAL-CHECK-WRITTEN
  8020*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8021*            MOVE +1                  TO CQ-TIMES-PRINTED
  8022*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8023*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8024*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8025*
  8026*    IF MAINTI = 'V'
  8027*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8028*                                   CQ-VOID-INDICATOR
  8029*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8030*
  8031*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8032*
  8033*    EXEC CICS REWRITE
  8034*        DATASET  (ERCHKQ-FILE-ID)
  8035*        FROM     (CHECK-QUE)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 144
* EL677.cbl
  8036*    END-EXEC.
  8037*
  8038*    GO TO 3790-EXIT.
  8039*
  8040*3780-CHECK-NOTFND.
  8041*    MOVE ER-2905                TO EMI-ERROR.
  8042*    MOVE -1                     TO CARRIERL
  8043*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8044*                                   ACCTA     EFFDTA  CERTNOA
  8045*                                   SFXA      SEQA.
  8046*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8047     .
  8048 3790-EXIT.
  8049      EXIT.
  8050
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 145
* EL677.cbl
  8052
  8053 3900-RECORD-NOTFND.
  8054     MOVE ER-2908                TO EMI-ERROR.
  8055     MOVE -1                     TO CARRIERL
  8056     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8057                                    ACCTA     EFFDTA  CERTNOA
  8058                                    SFXA      SEQA.
  8059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8060     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 146
* EL677.cbl
  8062 4000-ADD-CHANGE.
  8063     IF PAYTO1L NOT = ZEROS
  8064        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8065     END-IF
  8066
  8067     IF PAYTO2L NOT = ZEROS
  8068         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8069
  8070     IF PAYAD1L NOT = ZEROS
  8071         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8072
  8073     IF PAYAD2L NOT = ZEROS
  8074         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8075
  8076     IF PAYctyL NOT = ZEROS
  8077         MOVE payctyi            TO CH-PAYEE-CITY.
  8078
  8079     IF PAYstL NOT = ZEROS
  8080         MOVE paysti            TO CH-PAYEE-state.
  8081
  8082     IF PAYEEI GREATER SPACES
  8083        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8084
  8085     IF PTOZIPL  =  ZEROS
  8086         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8087         GO TO 4000-CK-REST.
  8088
  8089     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8090
  8091     IF NOT WS-CANADIAN-POST-CODE
  8092         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8093         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8094         GO TO 4000-CK-REST.
  8095
  8096     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8097     IF WS-CAN-POST-4TH = SPACE OR '-'
  8098         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8099         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8100     ELSE
  8101         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8102         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8103
  8104 4000-CK-REST.
  8105
  8106     IF RETTOL NOT = ZEROS
  8107        MOVE RETTOI TO CH-RETURN-TO.
  8108     if dedcynl not = zeros
  8109        move dedcyni             to ch-deduct-commission
  8110     end-if
  8111     if dedcynl not = zeros
  8112        if (dedcyni = 'Y')
  8113           or (pi-prev-ded-comm = 'Y')
  8114           compute ws-amt =
  8115              pi-refund-on-pending-rec -
  8116                 pi-prev-paid - pi-ue-comm
  8117        else
  8118           if dedcyni = 'N'
  8119              compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 147
* EL677.cbl
  8120                 pi-refund-on-pending-rec -
  8121                    pi-prev-paid
  8122           end-if
  8123        end-if
  8124     end-if
  8125     IF AMOUNTL NOT = ZEROS
  8126         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8127         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8128
  8129     IF CHECKL NOT = ZEROS
  8130         MOVE CHECKI             TO CH-CHECK-NO.
  8131
  8132     IF REASONL NOT = ZEROS
  8133         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8134
  8135*    IF DEDAMTL NOT = ZEROS
  8136*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8137*                                   DEDAMTO.
  8138
  8139*    IF ADDLCHGL NOT = ZEROS
  8140*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8141*                                   ADDLCHGO.
  8142
  8143     IF STUBL NOT = ZEROS
  8144         MOVE STUBI              TO CH-STUB-LINE-1.
  8145
  8146     IF TEXT1L NOT = ZEROS
  8147         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8148
  8149     IF TEXT2L NOT = ZEROS
  8150         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8151
  8152     IF TEXT3L NOT = ZEROS
  8153         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8154
  8155     IF TYPEL NOT = ZEROS
  8156         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8157
  8158*    MOVE LETTER1I               TO CH-LETTERS (1).
  8159*    MOVE LETTER2I               TO CH-LETTERS (2).
  8160*    MOVE LETTER3I               TO CH-LETTERS (3).
  8161
  8162*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8163     IF CH-CHECK-ORIGIN-SW = 'R'
  8164         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8165*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
  8166         MOVE PI-CANC-DT             TO CH-CANC-DT
  8167         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8168         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8169         MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8170
  8171*    IF PI-AR-PROCESSING AND
  8172*       REFL NOT = ZERO
  8173*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8174
  8175 4000-EXIT.
  8176      EXIT.
  8177 4100-CONNECT-TO-DB.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 148
* EL677.cbl
  8178     move 'NTCSO2_ChkApprv'      to svr
  8179     move 'sa'                   to usr
  8180     move 'ntcso2'               to pass
  8181     string
  8182         usr delimited space
  8183         "." delimited size
  8184         pass delimited space into usr-pass
  8185     end-string
  8186     EXEC SQL
  8187        CONNECT TO :svr USER :usr-pass
  8188     END-EXEC
  8189     if sqlcode not = 0
  8190        display "Error: cannot connect "
  8191        display sqlcode
  8192        display sqlerrmc
  8193     end-if
  8194     set connected-to-db to true
  8195     .
  8196 4100-EXIT.
  8197     EXIT.
  8198 4150-open-cursor.
  8199     move pi-company-id          to ws-compid
  8200     move ch-carrier             to ws-carrier
  8201     move ch-grouping            to ws-grouping
  8202     move ch-state               to ws-state
  8203     move ch-account             to ws-account
  8204     move ch-cert-eff-dt         to dc-bin-date-1
  8205     move ' '                    to dc-option-code
  8206     perform 8500-date-convert   thru 8500-exit
  8207     if no-conversion-error
  8208        move dc-greg-date-a-edit to ws-eff-date
  8209     end-if
  8210     move ch-cert-prime          to ws-certificate
  8211     move ch-cert-sfx            to ws-cert-sfx
  8212     move ch-sequence-no         to ws-seq-no
  8213     move '1'                    to ws-type
  8214     EXEC SQL
  8215        DECLARE
  8216           checkapp cursor for
  8217        SELECT
  8218           ApprovalStatus,
  8219           MaintainedBy,
  8220           MaintainedDate,
  8221           ApprovalBatch
  8222        FROM
  8223           ChkApp_Check
  8224        WHERE
  8225           Company           = :ws-compid
  8226           and CertCarrier   = :ws-carrier
  8227           and CertGroup     = :ws-grouping
  8228           and CertState     = :ws-state
  8229           and CertAccount   = :ws-account
  8230           and CertEffDate   = :ws-eff-date
  8231           and CertNumber    = :ws-certificate
  8232           and CertNumberSuf = :ws-cert-sfx
  8233           and CheckSeqNbr   = :ws-seq-no
  8234           and CheckType     = :ws-type
  8235     END-EXEC
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 149
* EL677.cbl
  8236     if sqlcode not = 0
  8237        display "Error: cannot declare cursor "
  8238        display ' sql retrun code ' sqlcode
  8239        display ' sql err mess    ' sqlerrmc
  8240        go to 4150-exit
  8241     end-if
  8242     EXEC SQL
  8243        open checkapp
  8244     END-EXEC
  8245     if sqlcode not = 0
  8246        display "Error: cannot open cursor "
  8247        display ' sql retrun code ' sqlcode
  8248        display ' sql err mess    ' sqlerrmc
  8249     end-if
  8250     .
  8251 4150-exit.
  8252     exit.
  8253 4200-get-tbl-row.
  8254***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8255***                                                            ***
  8256***  I'm only expecting one row so no cursor is declared       ***
  8257***                                                            ***
  8258***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8259     move pi-company-id          to ws-compid
  8260     move ch-carrier             to ws-carrier
  8261     move ch-grouping            to ws-grouping
  8262     move ch-state               to ws-state
  8263     move ch-account             to ws-account
  8264     move ch-cert-eff-dt         to dc-bin-date-1
  8265     move ' '                    to dc-option-code
  8266     perform 8500-date-convert   thru 8500-exit
  8267     if no-conversion-error
  8268        move dc-greg-date-a-edit to ws-eff-date
  8269     end-if
  8270     move ch-cert-prime          to ws-certificate
  8271     move ch-cert-sfx            to ws-cert-sfx
  8272     move ch-sequence-no         to ws-seq-no
  8273     move '1'                    to ws-type
  8274     exec sql
  8275        SELECT
  8276           ApprovalStatus,
  8277           MaintainedBy,
  8278           MaintainedDate,
  8279           ApprovalBatch
  8280        INTO
  8281           :db-app-status :nu-app-status,
  8282           :db-app-by :nu-app-by,
  8283           :db-app-date :nu-app-date,
  8284           :db-app-batch :nu-app-batch
  8285        FROM
  8286           ChkApp_Check
  8287        WHERE
  8288           Company           = :ws-compid
  8289           and CertCarrier   = :ws-carrier
  8290           and CertGroup     = :ws-grouping
  8291           and CertState     = :ws-state
  8292           and CertAccount   = :ws-account
  8293           and CertEffDate   = :ws-eff-date
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 150
* EL677.cbl
  8294           and CertNumber    = :ws-certificate
  8295           and CertNumberSuf = :ws-cert-sfx
  8296           and CheckSeqNbr   = :ws-seq-no
  8297           and CheckType     = :ws-type
  8298     end-exec
  8299     if sqlcode not = 0
  8300        display "Error: cannot read row "
  8301        display ' sql return code ' sqlcode
  8302        display ' sql err mess    ' sqlerrmc
  8303        go to 4200-exit
  8304     end-if
  8305*    display ' status ' db-app-status
  8306*    display ' by     ' db-app-by
  8307*    display ' date   ' db-app-date
  8308*    display ' batch  ' db-app-batch
  8309*    if nu-app-date = -1
  8310*       display ' approval date is low-values '
  8311*    else
  8312*       display ' approval date is NOT low values '
  8313*    end-if
  8314     .
  8315 4200-exit.
  8316     exit.
  8317 4250-delete-row.
  8318     EXEC SQL
  8319        DELETE
  8320           from ChkApp_Check
  8321        WHERE
  8322           Company           = :ws-compid
  8323           and CertCarrier   = :ws-carrier
  8324           and CertGroup     = :ws-grouping
  8325           and CertState     = :ws-state
  8326           and CertAccount   = :ws-account
  8327           and CertEffDate   = :ws-eff-date
  8328           and CertNumber    = :ws-certificate
  8329           and CertNumberSuf = :ws-cert-sfx
  8330           and CheckSeqNbr   = :ws-seq-no
  8331           and CheckType     = :ws-type
  8332     END-EXEC
  8333     if sqlcode not = 0
  8334        display "Error: cannot delete row  "
  8335        display ' sql retrun code ' sqlcode
  8336        display ' sql err mess    ' sqlerrmc
  8337        go to 4250-exit
  8338     end-if
  8339     set row-deleted         to true
  8340     EXEC SQL
  8341         commit transaction
  8342     END-EXEC
  8343     if sqlcode not = 0
  8344        display "Error: commit "
  8345        display ' sql return code ' sqlcode
  8346        display ' sql err mess    ' sqlerrmc
  8347        go to 4250-exit
  8348     end-if
  8349     set tbl-commited to true
  8350     .
  8351 4250-exit.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 151
* EL677.cbl
  8352     exit.
  8353 4300-FINISH-UP-DB.
  8354     EXEC SQL
  8355         commit work release
  8356     END-EXEC
  8357     if sqlcode not = 0
  8358        display "Error: commit release "
  8359        display ' sql return code ' sqlcode
  8360        display ' sql err mess    ' sqlerrmc
  8361     end-if
  8362     .
  8363 4300-EXIT.
  8364     EXIT.
  8365 5000-BROWSE-FILE.
  8366
  8367* EXEC CICS HANDLE CONDITION
  8368*        NOTFND   (5560-END-OF-FILE)
  8369*        ENDFILE  (5560-END-OF-FILE)
  8370*    END-EXEC.
  8371*    MOVE '"$I''                  ! . #00007723' TO DFHEIV0
  8372     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8374     MOVE X'2E20233030303037373233' TO DFHEIV0(25:11)
  8375     CALL 'kxdfhei1' USING DFHEIV0
  8376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8377
  8378
  8379     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8380
  8381     IF SEQI = LOW-VALUES
  8382         MOVE +1                 TO CHEK-RECORD-SEQ.
  8383
  8384     IF EIBAID = DFHPF2
  8385         GO TO 5100-BROWSE-BKWD.
  8386
  8387 5010-READ-LOOP.
  8388     IF EIBAID = DFHPF1
  8389         ADD +1                  TO CHEK-RECORD-SEQ.
  8390
  8391
  8392* EXEC CICS READ
  8393*        DATASET  (ERCHEK-FILE-ID)
  8394*        SET      (ADDRESS OF CHECK-RECORDS)
  8395*        RIDFLD   (ERCHEK-KEY)
  8396*        GTEQ
  8397*    END-EXEC.
  8398*    MOVE '&"S        G          (   #00007740' TO DFHEIV0
  8399     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8400     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8401     MOVE X'2020233030303037373430' TO DFHEIV0(25:11)
  8402     CALL 'kxdfhei1' USING DFHEIV0,
  8403           ERCHEK-FILE-ID,
  8404           DFHEIV20,
  8405           DFHEIV99,
  8406           ERCHEK-KEY,
  8407           DFHEIV99,
  8408           DFHEIV99,
  8409           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 152
* EL677.cbl
  8410     SET ADDRESS OF CHECK-RECORDS TO
  8411         DFHEIV20
  8412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8413
  8414
  8415     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8416         IF EIBAID = DFHENTER
  8417             GO TO 5550-NO-RECORD
  8418         ELSE
  8419             GO TO 5560-END-OF-FILE.
  8420
  8421        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8422           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8423           PI-CHEK-STATE      = CH-STATE       AND
  8424           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8425           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8426           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8427           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8428              GO TO 5500-FORMAT-SCREEN
  8429            ELSE
  8430              IF EIBAID = DFHPF1
  8431                  GO TO 5560-END-OF-FILE
  8432                ELSE
  8433                  GO TO 5550-NO-RECORD.
  8434
  8435     IF EIBAID = DFHENTER
  8436        IF CHEK-CARRIER    = CH-CARRIER     AND
  8437           CHEK-GROUPING   = CH-GROUPING    AND
  8438           CHEK-STATE      = CH-STATE       AND
  8439           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8440           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8441           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8442           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8443           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8444              GO TO 5500-FORMAT-SCREEN
  8445        ELSE
  8446              GO TO 5550-NO-RECORD.
  8447
  8448     GO TO 5500-FORMAT-SCREEN.
  8449
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 153
* EL677.cbl
  8451
  8452 5100-BROWSE-BKWD.
  8453
  8454* EXEC CICS STARTBR
  8455*        DATASET  (ERCHEK-FILE-ID)
  8456*        RIDFLD   (ERCHEK-KEY)
  8457*    END-EXEC.
  8458     MOVE 0
  8459       TO DFHEIV11
  8460*    MOVE '&,         G          &   #00007785' TO DFHEIV0
  8461     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8462     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8463     MOVE X'2020233030303037373835' TO DFHEIV0(25:11)
  8464     CALL 'kxdfhei1' USING DFHEIV0,
  8465           ERCHEK-FILE-ID,
  8466           ERCHEK-KEY,
  8467           DFHEIV99,
  8468           DFHEIV11,
  8469           DFHEIV99
  8470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8471
  8472
  8473
  8474* EXEC CICS READPREV
  8475*        DATASET  (ERCHEK-FILE-ID)
  8476*        SET      (ADDRESS OF CHECK-RECORDS)
  8477*        RIDFLD   (ERCHEK-KEY)
  8478*    END-EXEC.
  8479     MOVE 0
  8480       TO DFHEIV11
  8481*    MOVE '&0S                   )   #00007790' TO DFHEIV0
  8482     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8483     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8484     MOVE X'2020233030303037373930' TO DFHEIV0(25:11)
  8485     CALL 'kxdfhei1' USING DFHEIV0,
  8486           ERCHEK-FILE-ID,
  8487           DFHEIV20,
  8488           DFHEIV99,
  8489           ERCHEK-KEY,
  8490           DFHEIV99,
  8491           DFHEIV11,
  8492           DFHEIV99,
  8493           DFHEIV99
  8494     SET ADDRESS OF CHECK-RECORDS TO
  8495         DFHEIV20
  8496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8497
  8498
  8499 5110-READ-LOOP.
  8500     IF PI-FILE-EOF
  8501         MOVE SPACE              TO PI-EOF-SW
  8502     ELSE
  8503
  8504* EXEC CICS READPREV
  8505*            DATASET  (ERCHEK-FILE-ID)
  8506*            SET      (ADDRESS OF CHECK-RECORDS)
  8507*            RIDFLD   (ERCHEK-KEY)
  8508*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 154
* EL677.cbl
  8509     MOVE 0
  8510       TO DFHEIV11
  8511*    MOVE '&0S                   )   #00007800' TO DFHEIV0
  8512     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8513     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8514     MOVE X'2020233030303037383030' TO DFHEIV0(25:11)
  8515     CALL 'kxdfhei1' USING DFHEIV0,
  8516           ERCHEK-FILE-ID,
  8517           DFHEIV20,
  8518           DFHEIV99,
  8519           ERCHEK-KEY,
  8520           DFHEIV99,
  8521           DFHEIV11,
  8522           DFHEIV99,
  8523           DFHEIV99
  8524     SET ADDRESS OF CHECK-RECORDS TO
  8525         DFHEIV20
  8526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8527
  8528
  8529     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8530         GO TO 5560-END-OF-FILE.
  8531
  8532        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8533           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8534           PI-CHEK-STATE      = CH-STATE       AND
  8535           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8536           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8537           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8538           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8539              GO TO 5500-FORMAT-SCREEN
  8540            ELSE
  8541              GO TO 5560-END-OF-FILE.
  8542
  8543     GO TO 5500-FORMAT-SCREEN.
  8544
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 155
* EL677.cbl
  8546*                          COPY ELCNPD.
  8547*****************************************************************
  8548*                                                               *
  8549*                                                               *
  8550*                            ELCNPD                             *
  8551*                            VMOD=2.001                         *
  8552*****************************************************************
  8553
  8554 5200-MOVE-NAME.
  8555*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8556*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8557*            BLANKS.                                            *
  8558*                                                               *
  8559*                  FIELD               VALUE                    *
  8560*                                                               *
  8561*                LAST NAME (CL15)      SMITH                    *
  8562*                1ST NAME  (CL12)      JOHN                     *
  8563*                MID NAME  (CL1)       A                        *
  8564*                                                               *
  8565*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8566*         *                                                     *
  8567*         *              JOHN A. SMITH                          *
  8568*         *                                                     *
  8569*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8570*         *  STORAGE COPYBOOK:                                  *
  8571*         *                                                     *
  8572*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8573*         *******************************************************.
  8574
  8575     MOVE SPACES                 TO  WS-NAME-WORK
  8576                                     WS-NAME-WORK2.
  8577     MOVE ZERO                   TO  WS-NAME-SW.
  8578     SET NWA-INDEX TO +1.
  8579
  8580     IF WS-INSURED-1ST-NAME = SPACES  AND
  8581        WS-INSURED-MID-INIT = SPACES
  8582         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8583         GO TO 5200-EXIT.
  8584
  8585     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8586     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8587
  8588     SET NWA-INDEX UP BY +1
  8589     IF WS-INSURED-MID-INIT NOT = SPACES
  8590        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8591        SET NWA-INDEX UP BY +1
  8592        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8593        SET NWA-INDEX UP BY +2.
  8594
  8595     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8596     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8597
  8598
  8599 5200-EXIT.
  8600     EXIT.
  8601
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 156
* EL677.cbl
  8603 5300-MOVE-NAME SECTION.
  8604     IF WS-NAME-SW GREATER THAN +1
  8605         GO TO 5390-EXIT.
  8606
  8607     IF WS-NAME-WORK2 = SPACES
  8608         GO TO 5390-EXIT.
  8609
  8610     SET NWA-INDEX2 TO +1.
  8611     SET NWA-INDEX3 TO +2.
  8612
  8613 5310-MOVE-NAME.
  8614     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8615
  8616     IF NWA-INDEX LESS THAN +30
  8617        SET NWA-INDEX UP BY +1
  8618     ELSE
  8619        ADD +2  TO  WS-NAME-SW
  8620        GO TO 5390-EXIT.
  8621
  8622     IF NWA-INDEX2 LESS THAN +20
  8623         SET NWA-INDEX2 UP BY +1
  8624         SET NWA-INDEX3 UP BY +1.
  8625
  8626     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8627        WS-NW2 (NWA-INDEX3) = SPACES
  8628        GO TO 5390-EXIT.
  8629
  8630     GO TO 5310-MOVE-NAME.
  8631
  8632 5390-EXIT.
  8633     EXIT.
  8634
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 157
* EL677.cbl
  8637 5500-FORMAT-SCREEN.
  8638     MOVE LOW-VALUES             TO  EL677AI.
  8639     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8640     MOVE +1                     TO  MAINTL.
  8641     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8642     MOVE CH-CARRIER             TO  CARRIERO.
  8643     MOVE CH-GROUPING            TO  GROUPO.
  8644     MOVE CH-STATE               TO  STATEO.
  8645     MOVE CH-ACCOUNT             TO  ACCTO.
  8646
  8647     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8648     MOVE SPACE                  TO  DC-OPTION-CODE.
  8649     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8650     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8651
  8652     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8653     MOVE CH-CERT-SFX            TO  SFXO.
  8654     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8655
  8656     MOVE AL-UANON               TO  CARRIERA
  8657                                     GROUPA
  8658                                     STATEA
  8659                                     ACCTA
  8660                                     EFFDTA
  8661                                     CERTNOA
  8662                                     SFXA.
  8663     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8664
  8665     if ch-approval-dt not = low-values
  8666        move ch-approval-dt      to dc-bin-date-1
  8667        move ' '                 to dc-option-code
  8668        perform 8500-date-convert thru 8500-exit
  8669        move dc-greg-date-1-edit to apvdto
  8670     end-if
  8671     evaluate ch-approval-status
  8672        when '2'
  8673           move 'PENDING '       TO APVSTATO
  8674        when 'P'
  8675           move 'PENDING '       TO APVSTATO
  8676        when 'A'
  8677           move 'APPROVED'       to apvstato
  8678        when 'D'
  8679           move 'DENIED'         to apvstato
  8680     end-evaluate
  8681     move ch-approved-by         to apvbyo
  8682*    IF PI-COMPANY-ID = 'TMS'
  8683*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8684*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8685*    ELSE
  8686         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8687         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8688
  8689     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8690     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8691     move ch-payee-city          to payctyo
  8692     move ch-payee-state         to paysto
  8693     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8694
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 158
* EL677.cbl
  8695     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8696         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8697         MOVE AL-UANON           TO  PTOZIPA.
  8698
  8699     MOVE CH-RETURN-TO           TO  RETTOO
  8700*    if ch-check-cashed-dt not = spaces and low-values
  8701*       move ch-check-cashed-dt  to dc-bin-date-1
  8702*       MOVE SPACE               TO  DC-OPTION-CODE
  8703*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8704*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8705*    end-if
  8706     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8707     MOVE SPACE                  TO  DC-OPTION-CODE.
  8708     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8709     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8710
  8711     MOVE CH-RECORDED-BY         TO  CBYO.
  8712
  8713     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8714         NEXT SENTENCE
  8715     ELSE
  8716         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8717         MOVE SPACE                  TO  DC-OPTION-CODE
  8718         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8719         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8720         MOVE CH-VOID-BY             TO  VBYO.
  8721
  8722     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8723         NEXT SENTENCE
  8724     ELSE
  8725         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8726         MOVE SPACE                  TO  DC-OPTION-CODE
  8727         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8728         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8729
  8730     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8731     MOVE AL-SANOF               TO  AMOUNTA.
  8732     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8733     MOVE AL-SANOF               TO  TYPEA.
  8734     MOVE CH-CHECK-NO            TO  CHECKO.
  8735     move ch-deduct-commission   to dedcyno
  8736     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8737     MOVE CH-VOID-REASON         TO  VREASONO.
  8738
  8739     MOVE CH-STUB-LINE-1         TO  STUBO.
  8740     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8741     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8742     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8743     IF CH-LF-REFUND NOT NUMERIC
  8744         MOVE ZEROS              TO CH-LF-REFUND.
  8745     IF CH-AH-REFUND NOT NUMERIC
  8746         MOVE ZEROS              TO CH-AH-REFUND.
  8747     if (ch-check-no not = spaces and low-values)
  8748        and (ch-check-written-dt not = low-values)
  8749        perform 5800-fetch-check-cashed-dt
  8750                                 thru 5800-exit
  8751     end-if
  8752     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 159
* EL677.cbl
  8753        CH-VOID-DT          GREATER LOW-VALUES
  8754        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8755                                     STUBA     TEXT1A   TEXT2A
  8756                                     TEXT3A    PAYTO1A  SFXA
  8757                                     PAYTO2A   PAYAD1A  PAYctyA
  8758                                     paysta    RETTOA   PAYAD2A
  8759                                     PTOZIPA
  8760                                     PRINTEDA
  8761     ELSE
  8762        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8763                                     ACCTA     EFFDTA   CERTNOA
  8764                                     CHECKA    REASONA  VREASONA
  8765                                     STUBA     TEXT1A   TEXT2A
  8766                                     TEXT3A    PAYTO1A  SFXA
  8767                                     PAYTO2A   PAYAD1A  PAYctyA
  8768                                     paysta    RETTOA   PAYAD2A
  8769                                     PRINTEDA.
  8770
  8771     MOVE AL-UNNON               TO SEQA.
  8772     perform 5600-get-erpndb     thru 5600-exit
  8773     perform 5700-get-elcert     thru 5700-exit
  8774     move pi-prev-paid           to prepdo
  8775     if WS-PNDB-FOUND
  8776        compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8777     end-if
  8778     if WS-CERT-FOUND
  8779        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8780           cm-lf-alt-premium-amt
  8781        compute ws-tot-iss-prem  =
  8782           cm-ah-premium-amt + ws-tot-lf-prem
  8783        compute ws-tot-iss-comm =
  8784           (ws-tot-lf-prem * cm-life-comm-pct) +
  8785           (cm-ah-premium-amt * cm-ah-comm-pct)
  8786        compute ws-tot-ref-comm =
  8787           (pi-lf-refund * cm-life-comm-pct) +
  8788           (pi-ah-refund * cm-ah-comm-pct)
  8789        move ws-tot-iss-prem     to premo
  8790        move ws-tot-iss-comm     to isscommo
  8791        move ws-tot-ref-comm     to uecommo
  8792     end-if
  8793     if PI-TO-EL677-FROM-EL1273
  8794        move zeros               to premo
  8795                                    isscommo
  8796                                    uecommo
  8797                                    prepdo
  8798                                    refo
  8799     end-if
  8800     GO TO 8100-SEND-INITIAL-MAP
  8801     .
  8802 5550-NO-RECORD.
  8803     MOVE ER-1162                TO  EMI-ERROR.
  8804     MOVE -1                     TO  CARRIERL.
  8805     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8806                                     ACCTA     EFFDTA  CERTNOA
  8807                                     SFXA      SEQA.
  8808     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8809
  8810     IF NOT PI-TO-EL677-FROM-EL1273
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 160
* EL677.cbl
  8811         GO TO 8200-SEND-DATAONLY.
  8812
  8813     MOVE CHEK-CARRIER           TO  CARRIERO.
  8814     MOVE CHEK-GROUPING          TO  GROUPO.
  8815     MOVE CHEK-STATE             TO  STATEO.
  8816     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8817
  8818     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8819     MOVE SPACE                  TO  DC-OPTION-CODE.
  8820     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8821     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8822
  8823     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8824     MOVE CHEK-SUF-NO            TO  SFXO.
  8825     GO TO 8100-SEND-INITIAL-MAP.
  8826
  8827 5560-END-OF-FILE.
  8828     IF EIBAID = DFHPF1
  8829         MOVE 'Y'                TO  PI-EOF-SW
  8830         MOVE ER-2237            TO  EMI-ERROR
  8831     ELSE
  8832     IF EIBAID = DFHENTER
  8833        GO TO 5550-NO-RECORD
  8834     ELSE
  8835*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8836         MOVE ER-2238            TO  EMI-ERROR.
  8837
  8838     MOVE -1                     TO  MAINTL.
  8839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8840     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 161
* EL677.cbl
  8842 5600-get-erpndb.
  8843     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8844     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8845     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8846     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  8847     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  8848     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  8849     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  8850     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  8851     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  8852     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  8853     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  8854     IF ST-ACCNT-CNTL  OR
  8855        ACCNT-CNTL
  8856          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  8857     IF ST-ACCNT-CNTL      OR
  8858        CARR-ST-ACCNT-CNTL OR
  8859        ACCNT-CNTL         OR
  8860        CARR-ACCNT-CNTL
  8861          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  8862     IF ACCNT-CNTL OR
  8863        CARR-ACCNT-CNTL
  8864          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  8865
  8866* EXEC CICS READ
  8867*         DATASET   (ERPNDB-ALT-FILE-ID)
  8868*         SET       (ADDRESS OF PENDING-BUSINESS)
  8869*         RIDFLD    (ERPNDB-ALT-KEY)
  8870*         resp      (ws-response)
  8871*    END-EXEC
  8872*    MOVE '&"S        E          (  N#00008142' TO DFHEIV0
  8873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8875     MOVE X'204E233030303038313432' TO DFHEIV0(25:11)
  8876     CALL 'kxdfhei1' USING DFHEIV0,
  8877           ERPNDB-ALT-FILE-ID,
  8878           DFHEIV20,
  8879           DFHEIV99,
  8880           ERPNDB-ALT-KEY,
  8881           DFHEIV99,
  8882           DFHEIV99,
  8883           DFHEIV99
  8884     SET ADDRESS OF PENDING-BUSINESS TO
  8885         DFHEIV20
  8886     MOVE EIBRESP  TO ws-response
  8887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8888     if resp-normal
  8889        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  8890        compute pi-refund-on-pending-rec =
  8891           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8892     end-if
  8893     .
  8894 5600-exit.
  8895     exit.
  8896 5700-get-elcert.
  8897     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  8898     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  8899     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 162
* EL677.cbl
  8900     MOVE PI-STATE               TO  ELCERT-STATE.
  8901     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  8902     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  8903     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  8904     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  8905     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  8906
  8907* EXEC CICS READ
  8908*         DATASET   (ELCERT-FILE-ID)
  8909*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  8910*         RIDFLD    (ELCERT-KEY)
  8911*         resp      (ws-response)
  8912*    END-EXEC
  8913*    MOVE '&"S        E          (  N#00008166' TO DFHEIV0
  8914     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8916     MOVE X'204E233030303038313636' TO DFHEIV0(25:11)
  8917     CALL 'kxdfhei1' USING DFHEIV0,
  8918           ELCERT-FILE-ID,
  8919           DFHEIV20,
  8920           DFHEIV99,
  8921           ELCERT-KEY,
  8922           DFHEIV99,
  8923           DFHEIV99,
  8924           DFHEIV99
  8925     SET ADDRESS OF CERTIFICATE-MASTER TO
  8926         DFHEIV20
  8927     MOVE EIBRESP  TO ws-response
  8928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8929     if resp-normal
  8930        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  8931     end-if
  8932     .
  8933 5700-exit.
  8934     exit.
  8935 5800-fetch-check-cashed-dt.
  8936     move ' '                    to ws-connect-sw
  8937                                    ws-match-sw
  8938     move 'NTCSO2_PdBnkInfo'     to svr
  8939     move 'sa'                   to usr
  8940     move 'ntcso2'               to pass
  8941     string
  8942         usr delimited space
  8943         "." delimited size
  8944         pass delimited space into usr-pass
  8945     end-string
  8946     EXEC SQL
  8947        CONNECT TO :svr USER :usr-pass
  8948     END-EXEC
  8949     if sqlcode not = 0
  8950        display "Error: cannot connect to pdbnkinfo "
  8951        display sqlcode
  8952        display sqlerrmc
  8953        go to 5800-exit
  8954     end-if
  8955     set connected-to-db to true
  8956     if pi-company-id = 'CID'
  8957        move 'CSO - AP%'         to ws-pb-compid
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 163
* EL677.cbl
  8958     else
  8959        move 'AHL - AP%'         to ws-pb-compid
  8960     end-if
  8961     move '000'                  to ws-pb-check-no (1:3)
  8962     move ch-check-no            to ws-pb-check-no (4:7)
  8963     move spaces                 to ws-pb-bad-check-no
  8964     perform varying s1 from +1 by +1 until
  8965        (s1 > +10)
  8966        or (ws-pb-check-no (s1:1) not = '0')
  8967     end-perform
  8968     if s1 < +11
  8969        move ws-pb-check-no (s1:11 - s1)
  8970                            to ws-pb-bad-check-no (1: 11 - s1)
  8971     end-if
  8972*    display ' compid **' ws-pb-compid '**'
  8973*    display ' ckno  **' ws-pb-check-no '**'
  8974     if pi-company-id = 'CID'
  8975        EXEC SQL
  8976           DECLARE
  8977              paidbank cursor for
  8978           SELECT
  8979              TransactionNbr,
  8980              TransactionType,
  8981              Amount,
  8982              PaidDate
  8983           FROM
  8984              dbo.cso_pbi_TransactionLookup
  8985           WHERE
  8986              (BankAcctDescr like :ws-pb-compid)
  8987              and (TransactionNbr  = :ws-pb-check-no)
  8988        END-EXEC
  8989     else
  8990        EXEC SQL
  8991           DECLARE
  8992              ahlpaidbank cursor for
  8993           SELECT
  8994              TransactionNbr,
  8995              TransactionType,
  8996              Amount,
  8997              PaidDate
  8998           FROM
  8999              dbo.cso_pbi_TransactionLookup
  9000           WHERE
  9001              (BankAcctDescr like :ws-pb-compid)
  9002              and ((transactionNbr = :ws-pb-check-no)
  9003                     or
  9004                  (transactionnbr = :ws-pb-bad-check-no))
  9005*             and (CAST(TransactionNbr AS INT) =
  9006*                :ws-pb-check-no-num)
  9007*             and (right('00000' + rtrim(TransactionNbr),10)
  9008*                = :ws-pb-check-no)
  9009*             and (TransactionNbr  = :ws-pb-check-no)
  9010        END-EXEC
  9011     end-if
  9012     if sqlcode not = 0
  9013        display "Error: cannot read row  "
  9014        move sqlcode            to ws-sql-code
  9015        move ws-sql-code to ws-dis-sql-code
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 164
* EL677.cbl
  9016        display ' dis sql code ' ws-dis-sql-code
  9017        display ' sql return code ' sqlcode
  9018        display ' sql err mess    ' sqlerrmc
  9019        go to 5800-disconnect
  9020     end-if
  9021     if pi-company-id = 'CID'
  9022        EXEC SQL
  9023           open paidbank
  9024        END-EXEC
  9025     else
  9026        EXEC SQL
  9027           open ahlpaidbank
  9028        END-EXEC
  9029     end-if
  9030     if sqlcode not = 0
  9031        display "Error: cannot open paidbank cursor "
  9032        display ' sql retrun code ' sqlcode
  9033        display ' sql err mess    ' sqlerrmc
  9034     end-if
  9035     perform until
  9036        (sqlcode not = 0)
  9037        or (found-a-match)
  9038        if pi-company-id = 'CID'
  9039           EXEC SQL
  9040              fetch paidbank
  9041           INTO
  9042              :pb-check-no,
  9043              :pb-tran-type,
  9044              :pb-amount,
  9045              :pb-paid-date
  9046           end-exec
  9047        else
  9048           EXEC SQL
  9049              fetch ahlpaidbank
  9050           INTO
  9051              :pb-check-no,
  9052              :pb-tran-type,
  9053              :pb-amount,
  9054              :pb-paid-date
  9055           end-exec
  9056        end-if
  9057        move +12                 to s2
  9058        move zeros               to ws-work-amt-alpha
  9059        perform varying s1 from +12 by -1 until s1 < +1
  9060           if pb-amount (s1:1) numeric
  9061              move pb-amount (s1:1)
  9062                                 to ws-work-amt-alpha (s2:1)
  9063              subtract +1 from s2
  9064           end-if
  9065        end-perform
  9066        if ch-amount-paid = ws-work-amt-num
  9067           set found-a-match to true
  9068        end-if
  9069     end-perform
  9070     if sqlcode not = 0 and 100
  9071        display "Error: cannot fetch paidbank cursor "
  9072        display ' sql retrun code ' sqlcode
  9073        display ' sql err mess    ' sqlerrmc
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 165
* EL677.cbl
  9074        go to 5800-disconnect
  9075     end-if
  9076*    display ' chkno  ' pb-check-no
  9077*    display ' desc   ' pb-bank-acct-desc
  9078*    display ' trn typ' pb-tran-type
  9079*    display ' amt   *' pb-amount '**'
  9080*    display ' pd dte ' pb-paid-date
  9081     string pb-paid-date (7:4)
  9082            pb-paid-date (1:2)
  9083            pb-paid-date (4:2)
  9084        delimited by size into dc-greg-date-cymd-r
  9085     end-string
  9086     move 'L'                    to dc-option-code
  9087     perform 8500-date-convert   thru 8500-exit
  9088     if no-conversion-error
  9089*       move dc-bin-date-1       to ws-bin-cashed-dt
  9090        move dc-greg-date-1-edit to cashedo
  9091     else
  9092        display ' error cvtdte cash dt ' pb-paid-date ' '
  9093           dc-error-code
  9094     end-if
  9095     .
  9096 5800-disconnect.
  9097     EXEC SQL
  9098        DISCONNECT ALL
  9099     END-EXEC
  9100     if sqlcode not = 0
  9101        display "Error: cannot disconnect pdbnk "
  9102        display ' sql return code ' sqlcode
  9103        display ' sql err mess    ' sqlerrmc
  9104     end-if
  9105     .
  9106 5800-exit.
  9107     exit.
  9108 6000-VERIFY-COMP-MASTER.
  9109
  9110* EXEC CICS HANDLE CONDITION
  9111*        NOTFND   (6070-NO-COMP-MSTR)
  9112*    END-EXEC.
  9113*    MOVE '"$I                   ! / #00008352' TO DFHEIV0
  9114     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9116     MOVE X'2F20233030303038333532' TO DFHEIV0(25:11)
  9117     CALL 'kxdfhei1' USING DFHEIV0
  9118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9119
  9120
  9121     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9122
  9123     IF NOT PI-ZERO-CARRIER AND
  9124        NOT PI-ZERO-CAR-GROUP
  9125         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9126     ELSE
  9127         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9128
  9129     IF NOT PI-ZERO-GROUPING  AND
  9130        NOT PI-ZERO-CAR-GROUP
  9131         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 166
* EL677.cbl
  9132     ELSE
  9133         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9134
  9135     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9136     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9137     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9138
  9139
  9140* EXEC CICS READ
  9141*         DATASET   (ERCOMP-FILE-ID)
  9142*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9143*         RIDFLD    (ERCOMP-KEY)
  9144*     END-EXEC.
  9145*    MOVE '&"S        E          (   #00008374' TO DFHEIV0
  9146     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9148     MOVE X'2020233030303038333734' TO DFHEIV0(25:11)
  9149     CALL 'kxdfhei1' USING DFHEIV0,
  9150           ERCOMP-FILE-ID,
  9151           DFHEIV20,
  9152           DFHEIV99,
  9153           ERCOMP-KEY,
  9154           DFHEIV99,
  9155           DFHEIV99,
  9156           DFHEIV99
  9157     SET ADDRESS OF COMPENSATION-MASTER TO
  9158         DFHEIV20
  9159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9160
  9161
  9162     GO TO 6090-EXIT.
  9163
  9164 6070-NO-COMP-MSTR.
  9165     MOVE -1                     TO  CARRIERL.
  9166     MOVE ER-2230                TO  EMI-ERROR.
  9167     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9168     GO TO 8200-SEND-DATAONLY.
  9169
  9170 6090-EXIT.
  9171      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 167
* EL677.cbl
  9173 6100-VERIFY-CERTIFICATE.
  9174
  9175* EXEC CICS HANDLE CONDITION
  9176*        NOTFND   (6170-NO-CERTIFICATE)
  9177*    END-EXEC.
  9178*    MOVE '"$I                   ! 0 #00008392' TO DFHEIV0
  9179     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9181     MOVE X'3020233030303038333932' TO DFHEIV0(25:11)
  9182     CALL 'kxdfhei1' USING DFHEIV0
  9183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9184
  9185
  9186     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9187     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9188     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9189     MOVE PI-STATE               TO  ELCERT-STATE.
  9190     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9191     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9192     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9193     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9194
  9195     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9196
  9197     MOVE SPACES                 TO  PI-REFERENCE
  9198*                                    PI-INSURED-NAME.
  9199     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9200     MOVE ZEROS                  TO  PI-LF-REFUND
  9201                                     PI-AH-REFUND.
  9202
  9203
  9204* EXEC CICS READ
  9205*         DATASET   (ELCERT-FILE-ID)
  9206*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9207*         RIDFLD    (ELCERT-KEY)
  9208*     END-EXEC.
  9209*    MOVE '&"S        E          (   #00008413' TO DFHEIV0
  9210     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9212     MOVE X'2020233030303038343133' TO DFHEIV0(25:11)
  9213     CALL 'kxdfhei1' USING DFHEIV0,
  9214           ELCERT-FILE-ID,
  9215           DFHEIV20,
  9216           DFHEIV99,
  9217           ELCERT-KEY,
  9218           DFHEIV99,
  9219           DFHEIV99,
  9220           DFHEIV99
  9221     SET ADDRESS OF CERTIFICATE-MASTER TO
  9222         DFHEIV20
  9223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9224
  9225
  9226     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9227
  9228     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9229     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9230     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 168
* EL677.cbl
  9231         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9232     ELSE
  9233         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9234             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9235*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9236
  9237     GO TO 6190-EXIT.
  9238
  9239 6170-NO-CERTIFICATE.
  9240     MOVE -1                     TO  CARRIERL.
  9241     MOVE ER-2726                TO  EMI-ERROR.
  9242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9243
  9244 6190-EXIT.
  9245      EXIT.
  9246
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 169
* EL677.cbl
  9248 6200-UPDATE-PENDING-BUS-REC.
  9249     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9250     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9251     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9252     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9253     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9254     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9255     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9256     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9257     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9258     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9259
  9260     IF ST-ACCNT-CNTL  OR
  9261        ACCNT-CNTL
  9262          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9263
  9264     IF ST-ACCNT-CNTL      OR
  9265        CARR-ST-ACCNT-CNTL OR
  9266        ACCNT-CNTL         OR
  9267        CARR-ACCNT-CNTL
  9268          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9269
  9270     IF ACCNT-CNTL OR
  9271        CARR-ACCNT-CNTL
  9272          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9273
  9274
  9275* EXEC CICS READ
  9276*         DATASET   (ERPNDB-ALT-FILE-ID)
  9277*         SET       (ADDRESS OF PENDING-BUSINESS)
  9278*         RIDFLD    (ERPNDB-ALT-KEY)
  9279*         resp      (ws-response)
  9280*     END-EXEC.
  9281*    MOVE '&"S        E          (  N#00008467' TO DFHEIV0
  9282     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9284     MOVE X'204E233030303038343637' TO DFHEIV0(25:11)
  9285     CALL 'kxdfhei1' USING DFHEIV0,
  9286           ERPNDB-ALT-FILE-ID,
  9287           DFHEIV20,
  9288           DFHEIV99,
  9289           ERPNDB-ALT-KEY,
  9290           DFHEIV99,
  9291           DFHEIV99,
  9292           DFHEIV99
  9293     SET ADDRESS OF PENDING-BUSINESS TO
  9294         DFHEIV20
  9295     MOVE EIBRESP  TO ws-response
  9296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9297
  9298
  9299     if not resp-normal
  9300        go to 6200-exit
  9301     end-if
  9302     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9303
  9304
  9305* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 170
* EL677.cbl
  9306*         DATASET   (ERPNDB-FILE-ID)
  9307*         SET       (ADDRESS OF PENDING-BUSINESS)
  9308*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9309*         UPDATE
  9310*         resp      (ws-response)
  9311*     END-EXEC.
  9312*    MOVE '&"S        EU         (  N#00008479' TO DFHEIV0
  9313     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9314     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9315     MOVE X'204E233030303038343739' TO DFHEIV0(25:11)
  9316     CALL 'kxdfhei1' USING DFHEIV0,
  9317           ERPNDB-FILE-ID,
  9318           DFHEIV20,
  9319           DFHEIV99,
  9320           ERPNDB-PRIMARY-KEY,
  9321           DFHEIV99,
  9322           DFHEIV99,
  9323           DFHEIV99
  9324     SET ADDRESS OF PENDING-BUSINESS TO
  9325         DFHEIV20
  9326     MOVE EIBRESP  TO ws-response
  9327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9328
  9329
  9330 6200-EXIT.
  9331      EXIT.
  9332 6210-rewrite-pndb.
  9333
  9334* EXEC CICS REWRITE
  9335*        DATASET  (ERPNDB-FILE-ID)
  9336*        FROM     (PENDING-BUSINESS)
  9337*    END-EXEC
  9338     MOVE LENGTH OF
  9339      PENDING-BUSINESS
  9340       TO DFHEIV11
  9341*    MOVE '&& L                  %   #00008490' TO DFHEIV0
  9342     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9343     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9344     MOVE X'2020233030303038343930' TO DFHEIV0(25:11)
  9345     CALL 'kxdfhei1' USING DFHEIV0,
  9346           ERPNDB-FILE-ID,
  9347           PENDING-BUSINESS,
  9348           DFHEIV11,
  9349           DFHEIV99
  9350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9351     .
  9352 6210-exit.
  9353     exit.
  9354 6300-BUILD-CERT-SCREEN.
  9355     perform 6700-build-common   thru 6700-exit
  9356     if ws-refund-amount = zeros
  9357        move pi-company-cd       to pi-chek-comp-cd
  9358        move pi-carrier          to pi-chek-carrier
  9359        move pi-grouping         to pi-chek-grouping
  9360        move pi-state            to pi-chek-state
  9361        move pi-account          to pi-chek-account
  9362        move pi-cert-eff-dt      to pi-chek-eff-dt
  9363        move pi-cert-prime       to pi-chek-cert-no
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 171
* EL677.cbl
  9364        move pi-cert-sfx         to pi-chek-suf-no
  9365        move +1                  to pi-chek-sequence
  9366             MOVE 'S'            TO MAINTI
  9367             MOVE 1              TO MAINTL
  9368             MOVE AL-UABON       TO MAINTA
  9369             MOVE DFHENTER       TO EIBAID
  9370        go to 5000-browse-file
  9371     end-if
  9372     IF WS-CERT-NOT-FOUND
  9373         GO TO 8100-SEND-INITIAL-MAP.
  9374
  9375*    IF WS-PNDB-FOUND
  9376*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9377*                                   PB-C-AH-CANCEL-AMT
  9378*        MOVE 'R'                TO  TYPEO
  9379*        IF PI-AR-PROCESSING
  9380*            MOVE AL-UANON       TO  REFA
  9381*            MOVE PB-C-REFERENCE TO  REFO
  9382*        END-IF
  9383*    ELSE
  9384*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9385*                                   CM-AH-ITD-CANCEL-AMT.
  9386     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9387     MOVE 'R'                     TO TYPEO
  9388
  9389     IF PI-COMPANY-ID = 'TMS'
  9390         MOVE WS-NAME-WORK         TO PAYTO1I
  9391                                      PI-PAYTO1
  9392         MOVE AL-UANON             TO PAYTO1A
  9393     ELSE
  9394         MOVE WS-NAME-WORK         TO PAYTO1I
  9395                                      PI-PAYTO1
  9396         MOVE AL-UANON             TO PAYTO1A.
  9397
  9398*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9399*    MOVE AL-UANON                 TO PAYTO1AA.
  9400     move 'N'                    to dedcyni
  9401     move al-uanon               to dedcyna
  9402     move 'INS'                  to payeeo
  9403     move al-panon               to payeea
  9404     IF PI-MAIL-YES
  9405         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9406
  9407     GO TO 8100-SEND-INITIAL-MAP.
  9408
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 172
* EL677.cbl
  9410
  9411 6400-MAILING-ADDRESS.
  9412
  9413* EXEC CICS HANDLE CONDITION
  9414*        NOTFND   (6470-NO-ADDRESS)
  9415*    END-EXEC.
  9416*    MOVE '"$I                   ! 1 #00008555' TO DFHEIV0
  9417     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9419     MOVE X'3120233030303038353535' TO DFHEIV0(25:11)
  9420     CALL 'kxdfhei1' USING DFHEIV0
  9421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9422
  9423
  9424
  9425* EXEC CICS READ
  9426*        DATASET   (ERMAIL-FILE-ID)
  9427*        SET       (ADDRESS OF MAILING-DATA)
  9428*        RIDFLD    (ELCERT-KEY)
  9429*    END-EXEC.
  9430*    MOVE '&"S        E          (   #00008559' TO DFHEIV0
  9431     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9433     MOVE X'2020233030303038353539' TO DFHEIV0(25:11)
  9434     CALL 'kxdfhei1' USING DFHEIV0,
  9435           ERMAIL-FILE-ID,
  9436           DFHEIV20,
  9437           DFHEIV99,
  9438           ELCERT-KEY,
  9439           DFHEIV99,
  9440           DFHEIV99,
  9441           DFHEIV99
  9442     SET ADDRESS OF MAILING-DATA TO
  9443         DFHEIV20
  9444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9445
  9446
  9447     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9448     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9449     move ma-city                to payctyi
  9450     move ma-addr-state          to paysti
  9451     MOVE MA-ZIP                 TO PTOZIPI.
  9452     MOVE AL-UANON               TO PAYAD1A
  9453                                    PAYAD2A
  9454                                    PAYctyA
  9455                                    paysta
  9456                                    PTOZIPA.
  9457
  9458     GO TO 6490-EXIT.
  9459
  9460 6470-NO-ADDRESS.
  9461     MOVE -1                     TO  PAYAD1L.
  9462     MOVE ER-2394                TO  EMI-ERROR.
  9463     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9464
  9465 6490-EXIT.
  9466      EXIT.
  9467
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 173
* EL677.cbl
  9469
  9470 6500-BUILD-ACCOUNT-SCREEN.
  9471     perform 6700-build-common   thru 6700-exit
  9472     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9473     MOVE PI-AM-NAME             TO PAYTO1I
  9474     MOVE SPACES                 TO PAYTO2I
  9475     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9476     MOVE PI-AM-CITY             TO PAYCTYI
  9477     move pi-am-st               to paysti
  9478     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9479     move 'ACCT'                 to payeeo
  9480     move al-panon               to payeea
  9481     MOVE AL-UANON               TO PAYTO1A
  9482                                    PAYTO2A
  9483                                    PAYAD1A
  9484                                    PAYCTYA
  9485                                    paysta
  9486                                    PTOZIPA.
  9487     GO TO 8100-SEND-INITIAL-MAP
  9488     .
  9489 6600-BUILD-BENEFICIARY-SCREEN.
  9490     perform 6700-build-common   thru 6700-exit
  9491     IF WS-CERT-NOT-FOUND
  9492         GO TO 8100-SEND-INITIAL-MAP.
  9493
  9494*    IF WS-PNDB-FOUND
  9495*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9496*                                   PB-C-AH-CANCEL-AMT
  9497*        MOVE 'R'                TO  TYPEO
  9498*        IF PI-AR-PROCESSING
  9499*            MOVE AL-UANON       TO  REFA
  9500*            MOVE PB-C-REFERENCE TO  REFO
  9501*        END-IF
  9502*    ELSE
  9503*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9504*                                   CM-AH-ITD-CANCEL-AMT.
  9505
  9506     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9507     MOVE 'R'                     TO  TYPEO.
  9508
  9509     IF PI-COMPANY-ID = 'TMS'
  9510         MOVE WS-NAME-WORK         TO PAYTO1I
  9511                                      PI-PAYTO1
  9512         MOVE AL-UANON             TO PAYTO1A
  9513     ELSE
  9514         MOVE WS-NAME-WORK         TO PAYTO1I
  9515                                      PI-PAYTO1
  9516         MOVE AL-UANON             TO PAYTO1A.
  9517
  9518*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9519*    MOVE AL-UANON                 TO PAYTO1AA.
  9520
  9521     move 'N'                    to dedcyni
  9522     move al-uanon               to dedcyna
  9523     move 'BENE'                 to payeeo
  9524     move al-panon               to payeea
  9525     IF PI-MAIL-YES
  9526         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 174
* EL677.cbl
  9527
  9528     GO TO 8100-SEND-INITIAL-MAP.
  9529
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 175
* EL677.cbl
  9531
  9532 6620-MAILING-ADDRESS.
  9533
  9534* EXEC CICS HANDLE CONDITION
  9535*        NOTFND   (6670-NO-beneficiary)
  9536*    END-EXEC.
  9537*    MOVE '"$I                   ! 2 #00008651' TO DFHEIV0
  9538     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9540     MOVE X'3220233030303038363531' TO DFHEIV0(25:11)
  9541     CALL 'kxdfhei1' USING DFHEIV0
  9542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9543
  9544
  9545
  9546* EXEC CICS READ
  9547*        DATASET   (ERMAIL-FILE-ID)
  9548*        SET       (ADDRESS OF MAILING-DATA)
  9549*        RIDFLD    (ELCERT-KEY)
  9550*    END-EXEC.
  9551*    MOVE '&"S        E          (   #00008655' TO DFHEIV0
  9552     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9554     MOVE X'2020233030303038363535' TO DFHEIV0(25:11)
  9555     CALL 'kxdfhei1' USING DFHEIV0,
  9556           ERMAIL-FILE-ID,
  9557           DFHEIV20,
  9558           DFHEIV99,
  9559           ELCERT-KEY,
  9560           DFHEIV99,
  9561           DFHEIV99,
  9562           DFHEIV99
  9563     SET ADDRESS OF MAILING-DATA TO
  9564         DFHEIV20
  9565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9566
  9567
  9568     move spaces                 to payto2i
  9569     move ma-cred-bene-name      to payto1i
  9570     MOVE MA-cred-bene-addr      TO PAYad1I.
  9571     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9572     move ma-cred-bene-city      to payctyi
  9573     move ma-cred-bene-state     to paysti
  9574     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9575     MOVE AL-UANON               TO payto1a
  9576                                    PAYTO2A
  9577                                    PAYad1A
  9578                                    payad2a
  9579                                    PAYctyA
  9580                                    paysta
  9581                                    PTOZIPA.
  9582
  9583     GO TO 6690-EXIT.
  9584
  9585 6670-NO-BENEFICIARY.
  9586     MOVE -1                     TO  PAYTO1L.
  9587     MOVE ER-2394                TO  EMI-ERROR.
  9588     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 176
* EL677.cbl
  9589
  9590 6690-EXIT.
  9591      EXIT.
  9592 6700-build-common.
  9593     if not eracct-found
  9594        move pi-company-cd       to eracct-co
  9595        move pi-carrier          to eracct-carrier
  9596        move pi-grouping         to eracct-grouping
  9597        move pi-state            to eracct-state
  9598        move pi-account          to eracct-account
  9599        move pi-cert-eff-dt      to eracct-exp-date
  9600        if not eracct-found
  9601           perform 1420-get-eracct  thru 1490-exit
  9602        end-if
  9603     end-if
  9604*    if WS-PNDB-NOT-FOUND
  9605*       perform 5600-get-erpndb thru 5600-exit
  9606*    end-if
  9607     MOVE LOW-VALUES             TO  EL677AI.
  9608     MOVE 'A'                    TO  MAINTI.
  9609     MOVE AL-UANON               TO  MAINTA.
  9610     MOVE +1                     TO  MAINTL.
  9611     MOVE PI-CARRIER             TO  CARRIERO.
  9612     MOVE PI-GROUPING            TO  GROUPO.
  9613     MOVE PI-STATE               TO  STATEO.
  9614     MOVE PI-ACCOUNT             TO  ACCTO.
  9615     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9616     MOVE PI-CERT-SFX            TO  SFXO.
  9617     MOVE PI-AMOUNT              TO  AMOUNTO.
  9618     MOVE PI-TYPE                TO  TYPEO.
  9619     move pi-return-to           to  rettoo
  9620*    MOVE PI-REFERENCE           TO  REFO.
  9621     MOVE PI-PAYTO1              TO  PAYTO1O.
  9622     MOVE AL-UANON               TO  CARRIERA
  9623                                     GROUPA
  9624                                     STATEA
  9625                                     ACCTA
  9626                                     CERTNOA
  9627                                     SFXA
  9628                                     PAYTO1A
  9629                                     PAYTO2A
  9630*                                    AMOUNTA
  9631                                     TYPEA
  9632                                     rettoa.
  9633     move al-panon               to amounta
  9634     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9635     MOVE ' '                    TO  DC-OPTION-CODE.
  9636     PERFORM 8500-DATE-CONVERT.
  9637     IF NO-CONVERSION-ERROR
  9638         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9639         MOVE AL-UANON            TO  EFFDTA
  9640         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9641         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9642     ELSE
  9643         GO TO 8200-SEND-DATAONLY.
  9644     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9645         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9646         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 177
* EL677.cbl
  9647     ELSE
  9648         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9649         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9650     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9651     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9652     move spaces to pi-insured-name
  9653     string cm-insured-last-name ' '
  9654            cm-insured-first-name delimited by '  '
  9655        into pi-insured-name
  9656     end-string
  9657     move spaces                 to pi-table-name
  9658     string cm-insured-last-name ', '
  9659            cm-insured-first-name ' '
  9660            cm-insured-initial2
  9661        delimited by '  '
  9662        into
  9663           pi-table-name
  9664     end-string
  9665*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9666     if eibaid = dfhpf5
  9667        move 'Y'                 to dedcyni
  9668        move al-uanon            to dedcyna
  9669     end-if
  9670    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9671       cm-lf-alt-premium-amt
  9672    compute ws-tot-iss-prem  =
  9673       cm-ah-premium-amt + ws-tot-lf-prem
  9674    compute ws-tot-iss-comm =
  9675       (ws-tot-lf-prem * cm-life-comm-pct) +
  9676       (cm-ah-premium-amt * cm-ah-comm-pct)
  9677    compute ws-tot-ref-comm =
  9678       (pi-lf-refund * cm-life-comm-pct) +
  9679       (pi-ah-refund * cm-ah-comm-pct)
  9680     move ws-tot-iss-prem         to premo
  9681     move ws-tot-iss-comm         to isscommo
  9682     compute refo = pi-lf-refund + pi-ah-refund
  9683     move ws-tot-ref-comm         to uecommo
  9684                                     pi-ue-comm
  9685     move pi-prev-paid            to prepdo
  9686     compute ws-refund-amount = pi-refund-on-pending-rec -
  9687        pi-prev-paid
  9688     if (dedcyni = 'Y')
  9689        or (pi-prev-ded-comm = 'Y')
  9690        compute ws-refund-amount = ws-refund-amount -
  9691           ws-tot-ref-comm
  9692     end-if
  9693     if not WS-CERT-NOT-FOUND
  9694        string
  9695           pi-cert-prime         ' : '
  9696           cm-insured-last-name  ', '
  9697           cm-insured-first-name ' : '
  9698           pi-account            ' : '
  9699           pi-am-csr delimited by '  ' into text1o
  9700        end-string
  9701        move al-uanon            to text1a
  9702        MOVE 'REF'               TO WS-USER-REASON
  9703        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9704        inspect ws-user-cert-no replacing leading zeros
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 178
* EL677.cbl
  9705           by spaces
  9706        move pi-insured-name     to ws-user-name
  9707        perform varying s1 from +1 by +1 until
  9708           (s1 > +11)
  9709           or (ws-user-cert-no (s1:1)) <> ' '
  9710        end-perform
  9711        string ws-user-reason  ' ' delimited by size
  9712               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9713                  delimited by size
  9714               cm-insured-last-name ' '
  9715               cm-insured-first-name delimited by '  '
  9716           into stubo
  9717        end-string
  9718        move al-uanon            to stuba
  9719     end-if
  9720     .
  9721 6700-exit.
  9722     exit.
  9723 6800-browse-previous-chek-recs.
  9724***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9725***                                                            ***
  9726**** this should be the first time through, we need to gather  ***
  9727**** all the erchek records for this pending record, add the   ***
  9728**** amounts and make sure this check request will not exceed  ***
  9729**** the collected premium                                     ***
  9730***                                                            ***
  9731***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9732     move zeros                  to pi-prev-paid
  9733                                    ws-browse-sw
  9734                                    pi-chek-rec-cnt
  9735     move spaces                 to pi-prev-ded-comm
  9736     move pi-company-cd          to chek-company-cd
  9737     move pi-carrier             to chek-carrier
  9738     move pi-grouping            to chek-grouping
  9739     move pi-state               to chek-state
  9740     move pi-account             to chek-account
  9741     move pi-cert-prime          to chek-cert-no
  9742     move pi-cert-sfx            to chek-suf-no
  9743     move pi-cert-eff-dt         to chek-eff-dt
  9744     move +0                     to chek-record-seq
  9745     move erchek-key             to ws-compare-erchek-key
  9746
  9747* EXEC CICS STARTBR
  9748*       DATASET  (ERCHEK-FILE-ID)
  9749*       RIDFLD   (ERCHEK-KEY)
  9750*       resp     (ws-response)
  9751*    END-EXEC
  9752     MOVE 0
  9753       TO DFHEIV11
  9754*    MOVE '&,         G          &  N#00008839' TO DFHEIV0
  9755     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9756     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9757     MOVE X'204E233030303038383339' TO DFHEIV0(25:11)
  9758     CALL 'kxdfhei1' USING DFHEIV0,
  9759           ERCHEK-FILE-ID,
  9760           ERCHEK-KEY,
  9761           DFHEIV99,
  9762           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 179
* EL677.cbl
  9763           DFHEIV99
  9764     MOVE EIBRESP  TO ws-response
  9765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9766     if not resp-normal
  9767        go to 6800-exit
  9768     end-if
  9769     perform until i-say-when
  9770
  9771* EXEC CICS READNEXT
  9772*          DATASET   (ERCHEK-FILE-ID)
  9773*          SET       (ADDRESS OF CHECK-RECORDS)
  9774*          RIDFLD    (ERCHEK-KEY)
  9775*          resp      (ws-response)
  9776*       END-EXEC
  9777     MOVE 0
  9778       TO DFHEIV11
  9779*    MOVE '&.S                   )  N#00008848' TO DFHEIV0
  9780     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9781     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9782     MOVE X'204E233030303038383438' TO DFHEIV0(25:11)
  9783     CALL 'kxdfhei1' USING DFHEIV0,
  9784           ERCHEK-FILE-ID,
  9785           DFHEIV20,
  9786           DFHEIV99,
  9787           ERCHEK-KEY,
  9788           DFHEIV99,
  9789           DFHEIV11,
  9790           DFHEIV99,
  9791           DFHEIV99
  9792     SET ADDRESS OF CHECK-RECORDS TO
  9793         DFHEIV20
  9794     MOVE EIBRESP  TO ws-response
  9795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9796        if resp-normal
  9797           and erchek-key (1:33) = ws-compare-erchek-key
  9798           if ch-void-dt = low-values
  9799              and not ch-denied
  9800              compute pi-prev-paid = pi-prev-paid +
  9801                 ch-amount-paid
  9802              add +1 to pi-chek-rec-cnt
  9803              move ch-deduct-commission
  9804                                 to pi-prev-ded-comm
  9805           end-if
  9806        else
  9807           set i-say-when to true
  9808        end-if
  9809     end-perform
  9810     .
  9811 6800-exit.
  9812     exit.
  9813 7000-SET-PI-AREA.
  9814     MOVE CARRIERI               TO  PI-CARRIER
  9815                                     PI-CHEK-CARRIER.
  9816     MOVE GROUPI                 TO  PI-GROUPING
  9817                                     PI-CHEK-GROUPING.
  9818     MOVE STATEI                 TO  PI-STATE
  9819                                     PI-CHEK-STATE.
  9820     MOVE ACCTI                  TO  PI-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 180
* EL677.cbl
  9821                                     PI-CHEK-ACCOUNT.
  9822     MOVE CERTNOI                TO  PI-CERT-PRIME
  9823                                     PI-CHEK-CERT-NO.
  9824     IF SFXI NOT = LOW-VALUES
  9825         MOVE SFXI               TO  PI-CERT-SFX
  9826                                     PI-CHEK-SUF-NO
  9827     ELSE
  9828         MOVE SPACE              TO  PI-CERT-SFX
  9829                                     PI-CHEK-SUF-NO.
  9830
  9831     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9832     MOVE '2'                    TO  DC-OPTION-CODE.
  9833     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9834     IF DATE-CONVERSION-ERROR
  9835         MOVE ER-0215            TO  EMI-ERROR
  9836         MOVE -1                 TO  EFFDTL
  9837         MOVE AL-UNBON           TO  EFFDTA
  9838         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9839         GO TO 8200-SEND-DATAONLY
  9840     ELSE
  9841         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9842                                     PI-CHEK-EFF-DT.
  9843
  9844 7090-EXIT.
  9845      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 181
* EL677.cbl
  9847 7100-CREATE-TEMP-STORAGE.
  9848     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9849
  9850
  9851* EXEC CICS WRITEQ TS
  9852*        QUEUE   (QID)
  9853*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9854*        LENGTH  (PI-COMM-LENGTH)
  9855*    END-EXEC.
  9856*    MOVE '*"                    ''   #00008908' TO DFHEIV0
  9857     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  9858     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9859     MOVE X'2020233030303038393038' TO DFHEIV0(25:11)
  9860     CALL 'kxdfhei1' USING DFHEIV0,
  9861           QID,
  9862           PROGRAM-INTERFACE-BLOCK,
  9863           PI-COMM-LENGTH,
  9864           DFHEIV99,
  9865           DFHEIV99,
  9866           DFHEIV99
  9867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9868
  9869
  9870 7100-EXIT.
  9871      EXIT.
  9872
  9873 7200-RECOVER-TEMP-STORAGE.
  9874
  9875* EXEC CICS READQ TS
  9876*        QUEUE   (QID)
  9877*        INTO    (PROGRAM-INTERFACE-BLOCK)
  9878*        LENGTH  (PI-COMM-LENGTH)
  9879*    END-EXEC.
  9880*    MOVE '*$I    L              ''   #00008918' TO DFHEIV0
  9881     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9882     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9883     MOVE X'2020233030303038393138' TO DFHEIV0(25:11)
  9884     CALL 'kxdfhei1' USING DFHEIV0,
  9885           QID,
  9886           PROGRAM-INTERFACE-BLOCK,
  9887           PI-COMM-LENGTH,
  9888           DFHEIV99,
  9889           DFHEIV99,
  9890           DFHEIV99
  9891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9892
  9893
  9894     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9895
  9896 7200-EXIT.
  9897      EXIT.
  9898
  9899 7300-DELETE-TEMP-STORAGE.
  9900
  9901* EXEC CICS HANDLE CONDITION
  9902*        QIDERR  (7300-EXIT)
  9903*    END-EXEC.
  9904*    MOVE '"$N                   ! 3 #00008930' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 182
* EL677.cbl
  9905     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9907     MOVE X'3320233030303038393330' TO DFHEIV0(25:11)
  9908     CALL 'kxdfhei1' USING DFHEIV0
  9909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9910
  9911
  9912
  9913* EXEC CICS DELETEQ TS
  9914*        QUEUE  (QID)
  9915*    END-EXEC.
  9916*    MOVE '*&                    #   #00008934' TO DFHEIV0
  9917     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9918     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9919     MOVE X'2020233030303038393334' TO DFHEIV0(25:11)
  9920     CALL 'kxdfhei1' USING DFHEIV0,
  9921           QID,
  9922           DFHEIV99
  9923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9924
  9925
  9926 7300-EXIT.
  9927      EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 183
* EL677.cbl
  9929 8035-LETR-NOT-OPEN.
  9930
  9931     MOVE ER-0013                TO EMI-ERROR.
  9932*    MOVE -1                     TO LETTER1L
  9933     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9934     GO TO 8200-SEND-DATAONLY.
  9935
  9936 8035-EXIT.
  9937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 184
* EL677.cbl
  9939 8100-SEND-INITIAL-MAP.
  9940     MOVE SAVE-DATE              TO  DATEO.
  9941     MOVE EIBTIME                TO  TIME-IN.
  9942     MOVE TIME-OUT               TO  TIMEO.
  9943     MOVE -1                     TO  MAINTL
  9944     move al-uanon               to mainta
  9945     if PI-TO-EL677-FROM-EL1273
  9946        move al-sadof            to pf357a
  9947                                    pf46a
  9948                                    dprema
  9949                                    dcomma
  9950                                    drefa
  9951                                    duecomma
  9952                                    dprepda
  9953                                    prema
  9954                                    isscomma
  9955                                    refa
  9956                                    uecomma
  9957                                    prepda
  9958                                    dmaint2a
  9959        move ', VOID(V)'         to dmaint1o
  9960     end-if
  9961     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9962     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9963
  9964
  9965* EXEC CICS SEND
  9966*        MAP      (EL677A)
  9967*        MAPSET   (MAPSET-NAME)
  9968*        FROM     (EL677AO)
  9969*        ERASE
  9970*        CURSOR
  9971*    END-EXEC.
  9972     MOVE LENGTH OF
  9973      EL677AO
  9974       TO DFHEIV12
  9975     MOVE -1
  9976       TO DFHEIV11
  9977*    MOVE '8$     CT  E    H L F ,   #00008976' TO DFHEIV0
  9978     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9979     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9980     MOVE X'2020233030303038393736' TO DFHEIV0(25:11)
  9981     CALL 'kxdfhei1' USING DFHEIV0,
  9982           EL677A,
  9983           EL677AO,
  9984           DFHEIV12,
  9985           MAPSET-NAME,
  9986           DFHEIV99,
  9987           DFHEIV99,
  9988           DFHEIV99,
  9989           DFHEIV11,
  9990           DFHEIV99,
  9991           DFHEIV99,
  9992           DFHEIV99
  9993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9994
  9995
  9996     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 185
* EL677.cbl
  9998 8200-SEND-DATAONLY.
  9999     if connected-to-db
 10000        perform 4300-FINISH-UP-DB thru 4300-exit
 10001     end-if
 10002     MOVE SAVE-DATE              TO  DATEO.
 10003     MOVE EIBTIME                TO  TIME-IN.
 10004     MOVE TIME-OUT               TO  TIMEO.
 10005     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10006     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10007
 10008
 10009* EXEC CICS SEND
 10010*        MAP     (EL677A)
 10011*        MAPSET  (MAPSET-NAME)
 10012*        FROM    (EL677AO)
 10013*        DATAONLY
 10014*        CURSOR
 10015*    END-EXEC.
 10016     MOVE LENGTH OF
 10017      EL677AO
 10018       TO DFHEIV12
 10019     MOVE -1
 10020       TO DFHEIV11
 10021*    MOVE '8$D    CT       H L F ,   #00008996' TO DFHEIV0
 10022     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10023     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10024     MOVE X'2020233030303038393936' TO DFHEIV0(25:11)
 10025     CALL 'kxdfhei1' USING DFHEIV0,
 10026           EL677A,
 10027           EL677AO,
 10028           DFHEIV12,
 10029           MAPSET-NAME,
 10030           DFHEIV99,
 10031           DFHEIV99,
 10032           DFHEIV99,
 10033           DFHEIV11,
 10034           DFHEIV99,
 10035           DFHEIV99,
 10036           DFHEIV99
 10037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10038
 10039
 10040     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 186
* EL677.cbl
 10042 8300-SEND-TEXT.
 10043
 10044* EXEC CICS SEND TEXT
 10045*        FROM     (LOGOFF-TEXT)
 10046*        LENGTH   (LOGOFF-LENGTH)
 10047*        ERASE
 10048*        FREEKB
 10049*    END-EXEC.
 10050*    MOVE '8&      T  E F  H   F -   #00009007' TO DFHEIV0
 10051     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10052     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10053     MOVE X'2020233030303039303037' TO DFHEIV0(25:11)
 10054     CALL 'kxdfhei1' USING DFHEIV0,
 10055           LOGOFF-TEXT,
 10056           LOGOFF-LENGTH,
 10057           DFHEIV99,
 10058           DFHEIV99,
 10059           DFHEIV99,
 10060           DFHEIV99,
 10061           DFHEIV99,
 10062           DFHEIV99,
 10063           DFHEIV99,
 10064           DFHEIV99,
 10065           DFHEIV99,
 10066           DFHEIV99
 10067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10068
 10069
 10070
 10071* EXEC CICS RETURN
 10072*    END-EXEC.
 10073*    MOVE '.(                    ''   #00009014' TO DFHEIV0
 10074     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10075     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10076     MOVE X'2020233030303039303134' TO DFHEIV0(25:11)
 10077     CALL 'kxdfhei1' USING DFHEIV0,
 10078           DFHEIV99,
 10079           DFHEIV99,
 10080           DFHEIV99,
 10081           DFHEIV99,
 10082           DFHEIV99,
 10083           DFHEIV99
 10084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10085
 10086
 10087 8500-DATE-CONVERT.
 10088     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10089
 10090
 10091* EXEC CICS LINK
 10092*        PROGRAM    (PGM-NAME)
 10093*        COMMAREA   (DATE-CONVERSION-DATA)
 10094*        LENGTH     (DC-COMM-LENGTH)
 10095*    END-EXEC.
 10096*    MOVE '."C                   (   #00009020' TO DFHEIV0
 10097     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10099     MOVE X'2020233030303039303230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 187
* EL677.cbl
 10100     CALL 'kxdfhei1' USING DFHEIV0,
 10101           PGM-NAME,
 10102           DATE-CONVERSION-DATA,
 10103           DC-COMM-LENGTH,
 10104           DFHEIV99,
 10105           DFHEIV99,
 10106           DFHEIV99,
 10107           DFHEIV99
 10108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10109
 10110
 10111 8500-EXIT.
 10112      EXIT.
 10113
 10114 8600-DEEDIT.
 10115
 10116* EXEC CICS BIF DEEDIT
 10117*        FIELD   (WS-DEEDIT-FIELD)
 10118*        LENGTH  (10)
 10119*    END-EXEC.
 10120     MOVE 10
 10121       TO DFHEIV11
 10122*    MOVE '@"L                   #   #00009030' TO DFHEIV0
 10123     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10124     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10125     MOVE X'2020233030303039303330' TO DFHEIV0(25:11)
 10126     CALL 'kxdfhei1' USING DFHEIV0,
 10127           WS-DEEDIT-FIELD,
 10128           DFHEIV11
 10129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10130
 10131
 10132 8600-EXIT.
 10133      EXIT.
 10134
 10135 8700-DEEDIT.
 10136
 10137* EXEC CICS BIF DEEDIT
 10138*        FIELD   (WS-DT-DEEDIT-FIELD)
 10139*        LENGTH  (10)
 10140*    END-EXEC.
 10141     MOVE 10
 10142       TO DFHEIV11
 10143*    MOVE '@"L                   #   #00009039' TO DFHEIV0
 10144     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10145     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10146     MOVE X'2020233030303039303339' TO DFHEIV0(25:11)
 10147     CALL 'kxdfhei1' USING DFHEIV0,
 10148           WS-DT-DEEDIT-FIELD,
 10149           DFHEIV11
 10150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10151
 10152
 10153 8700-EXIT.
 10154      EXIT.
 10155
 10156 8800-UNAUTHORIZED-ACCESS.
 10157     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 188
* EL677.cbl
 10158     GO TO 8300-SEND-TEXT.
 10159
 10160 8810-PF23.
 10161     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10162     MOVE XCTL-005               TO  PGM-NAME.
 10163     GO TO 9300-XCTL.
 10164
 10165
 10166 9100-RETURN-TRAN.
 10167     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10168     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10169
 10170* EXEC CICS RETURN
 10171*        TRANSID  (TRANS-ID)
 10172*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10173*        LENGTH   (PI-COMM-LENGTH)
 10174*    END-EXEC.
 10175*    MOVE '.(CT                  ''   #00009060' TO DFHEIV0
 10176     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10177     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10178     MOVE X'2020233030303039303630' TO DFHEIV0(25:11)
 10179     CALL 'kxdfhei1' USING DFHEIV0,
 10180           TRANS-ID,
 10181           PROGRAM-INTERFACE-BLOCK,
 10182           PI-COMM-LENGTH,
 10183           DFHEIV99,
 10184           DFHEIV99,
 10185           DFHEIV99
 10186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10187
 10188
 10189
 10190* GOBACK.
 10191     MOVE '9%                    "   ' TO DFHEIV0
 10192     MOVE 'EL677' TO DFHEIV1
 10193     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10194     GOBACK.
 10195
 10196 9200-RETURN-MAIN-MENU.
 10197     MOVE XCTL-626               TO  PGM-NAME.
 10198     GO TO 9300-XCTL.
 10199
 10200 9300-XCTL.
 10201
 10202* EXEC CICS XCTL
 10203*        PROGRAM    (PGM-NAME)
 10204*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10205*        LENGTH     (PI-COMM-LENGTH)
 10206*    END-EXEC.
 10207*    MOVE '.$C                   %   #00009073' TO DFHEIV0
 10208     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10209     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10210     MOVE X'2020233030303039303733' TO DFHEIV0(25:11)
 10211     CALL 'kxdfhei1' USING DFHEIV0,
 10212           PGM-NAME,
 10213           PROGRAM-INTERFACE-BLOCK,
 10214           PI-COMM-LENGTH,
 10215           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 189
* EL677.cbl
 10216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10217
 10218
 10219 9400-CLEAR.
 10220     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10221     MOVE SPACES                 TO  PI-PFKEY.
 10222     GO TO 9300-XCTL.
 10223
 10224 9500-PF12.
 10225     MOVE XCTL-010               TO  PGM-NAME.
 10226     GO TO 9300-XCTL.
 10227
 10228 9600-PGMID-ERROR.
 10229
 10230* EXEC CICS HANDLE CONDITION
 10231*        PGMIDERR    (8300-SEND-TEXT)
 10232*    END-EXEC.
 10233*    MOVE '"$L                   ! 4 #00009089' TO DFHEIV0
 10234     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10236     MOVE X'3420233030303039303839' TO DFHEIV0(25:11)
 10237     CALL 'kxdfhei1' USING DFHEIV0
 10238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10239
 10240
 10241     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10242     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10243     MOVE XCTL-005               TO  PGM-NAME.
 10244     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10245     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10246
 10247     GO TO 9300-XCTL.
 10248
 10249 9900-ERROR-FORMAT.
 10250     IF NOT EMI-ERRORS-COMPLETE
 10251         MOVE LINK-001           TO  PGM-NAME
 10252
 10253* EXEC CICS LINK
 10254*            PROGRAM    (PGM-NAME)
 10255*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10256*            LENGTH     (EMI-COMM-LENGTH)
 10257*        END-EXEC.
 10258*    MOVE '."C                   (   #00009104' TO DFHEIV0
 10259     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10260     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10261     MOVE X'2020233030303039313034' TO DFHEIV0(25:11)
 10262     CALL 'kxdfhei1' USING DFHEIV0,
 10263           PGM-NAME,
 10264           ERROR-MESSAGE-INTERFACE-BLOCK,
 10265           EMI-COMM-LENGTH,
 10266           DFHEIV99,
 10267           DFHEIV99,
 10268           DFHEIV99,
 10269           DFHEIV99
 10270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10271
 10272
 10273 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 190
* EL677.cbl
 10274      EXIT.
 10275
 10276 9990-ABEND.
 10277     MOVE LINK-004               TO  PGM-NAME.
 10278     MOVE DFHEIBLK               TO  EMI-LINE1.
 10279
 10280* EXEC CICS LINK
 10281*        PROGRAM   (PGM-NAME)
 10282*        COMMAREA  (EMI-LINE1)
 10283*        LENGTH    (72)
 10284*    END-EXEC.
 10285     MOVE 72
 10286       TO DFHEIV11
 10287*    MOVE '."C                   (   #00009116' TO DFHEIV0
 10288     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10289     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10290     MOVE X'2020233030303039313136' TO DFHEIV0(25:11)
 10291     CALL 'kxdfhei1' USING DFHEIV0,
 10292           PGM-NAME,
 10293           EMI-LINE1,
 10294           DFHEIV11,
 10295           DFHEIV99,
 10296           DFHEIV99,
 10297           DFHEIV99,
 10298           DFHEIV99
 10299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10300
 10301
 10302     GO TO 8200-SEND-DATAONLY.
 10303
 10304 9995-SECURITY-VIOLATION.
 10305*                            COPY ELCSCTP.
 10306******************************************************************
 10307*                                                                *
 10308*                            ELCSCTP                             *
 10309*                            VMOD=2.001                          *
 10310*                                                                *
 10311*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10312******************************************************************
 10313
 10314
 10315     MOVE EIBDATE          TO SM-JUL-DATE.
 10316     MOVE EIBTRMID         TO SM-TERMID.
 10317     MOVE THIS-PGM         TO SM-PGM.
 10318     MOVE EIBTIME          TO TIME-IN.
 10319     MOVE TIME-OUT         TO SM-TIME.
 10320     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10321
 10322
 10323* EXEC CICS LINK
 10324*         PROGRAM  ('EL003')
 10325*         COMMAREA (SECURITY-MESSAGE)
 10326*         LENGTH   (80)
 10327*    END-EXEC.
 10328     MOVE 'EL003' TO DFHEIV1
 10329     MOVE 80
 10330       TO DFHEIV11
 10331*    MOVE '."C                   (   #00009142' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 191
* EL677.cbl
 10332     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10333     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10334     MOVE X'2020233030303039313432' TO DFHEIV0(25:11)
 10335     CALL 'kxdfhei1' USING DFHEIV0,
 10336           DFHEIV1,
 10337           SECURITY-MESSAGE,
 10338           DFHEIV11,
 10339           DFHEIV99,
 10340           DFHEIV99,
 10341           DFHEIV99,
 10342           DFHEIV99
 10343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10344
 10345
 10346******************************************************************
 10347
 10348
 10349 9995-EXIT.
 10350     EXIT.
 10351
 10352
 10353 9999-DFHBACK SECTION.
 10354     MOVE '9%                    "   ' TO DFHEIV0
 10355     MOVE 'EL677' TO DFHEIV1
 10356     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10357     GOBACK.
 10358 9999-DFHEXIT.
 10359     IF DFHEIGDJ EQUAL 0001
 10360         NEXT SENTENCE
 10361     ELSE IF DFHEIGDJ EQUAL 2
 10362         GO TO 9600-PGMID-ERROR,
 10363               9990-ABEND
 10364         DEPENDING ON DFHEIGDI
 10365     ELSE IF DFHEIGDJ EQUAL 3
 10366         GO TO 8100-SEND-INITIAL-MAP
 10367         DEPENDING ON DFHEIGDI
 10368     ELSE IF DFHEIGDJ EQUAL 4
 10369         GO TO 1290-NO-CARRIER
 10370         DEPENDING ON DFHEIGDI
 10371     ELSE IF DFHEIGDJ EQUAL 5
 10372         GO TO 1380-NO-STATE
 10373         DEPENDING ON DFHEIGDI
 10374     ELSE IF DFHEIGDJ EQUAL 6
 10375         GO TO 1480-ACCOUNT-INVALID,
 10376               1480-ACCOUNT-INVALID
 10377         DEPENDING ON DFHEIGDI
 10378     ELSE IF DFHEIGDJ EQUAL 7
 10379         GO TO 1590-EXIT
 10380         DEPENDING ON DFHEIGDI
 10381     ELSE IF DFHEIGDJ EQUAL 8
 10382         GO TO 2200-DUPREC
 10383         DEPENDING ON DFHEIGDI
 10384     ELSE IF DFHEIGDJ EQUAL 9
 10385         GO TO 2577-DUPREC
 10386         DEPENDING ON DFHEIGDI
 10387     ELSE IF DFHEIGDJ EQUAL 10
 10388         GO TO 2600-NO-CO-MASTER
 10389         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 17-Feb-14 09:35 Page 192
* EL677.cbl
 10390     ELSE IF DFHEIGDJ EQUAL 11
 10391         GO TO 3900-RECORD-NOTFND
 10392         DEPENDING ON DFHEIGDI
 10393     ELSE IF DFHEIGDJ EQUAL 12
 10394         GO TO 3287-DUPREC
 10395         DEPENDING ON DFHEIGDI
 10396     ELSE IF DFHEIGDJ EQUAL 13
 10397         GO TO 3390-EXIT,
 10398               3390-EXIT
 10399         DEPENDING ON DFHEIGDI
 10400     ELSE IF DFHEIGDJ EQUAL 14
 10401         GO TO 5560-END-OF-FILE,
 10402               5560-END-OF-FILE
 10403         DEPENDING ON DFHEIGDI
 10404     ELSE IF DFHEIGDJ EQUAL 15
 10405         GO TO 6070-NO-COMP-MSTR
 10406         DEPENDING ON DFHEIGDI
 10407     ELSE IF DFHEIGDJ EQUAL 16
 10408         GO TO 6170-NO-CERTIFICATE
 10409         DEPENDING ON DFHEIGDI
 10410     ELSE IF DFHEIGDJ EQUAL 17
 10411         GO TO 6470-NO-ADDRESS
 10412         DEPENDING ON DFHEIGDI
 10413     ELSE IF DFHEIGDJ EQUAL 18
 10414         GO TO 6670-NO-beneficiary
 10415         DEPENDING ON DFHEIGDI
 10416     ELSE IF DFHEIGDJ EQUAL 19
 10417         GO TO 7300-EXIT
 10418         DEPENDING ON DFHEIGDI
 10419     ELSE IF DFHEIGDJ EQUAL 20
 10420         GO TO 8300-SEND-TEXT
 10421         DEPENDING ON DFHEIGDI.
 10422     MOVE '9%                    "   ' TO DFHEIV0
 10423     MOVE 'EL677' TO DFHEIV1
 10424     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10425     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142224     Code:       40352
