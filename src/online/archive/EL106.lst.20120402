* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   1
* EL106.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL106.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL106.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL106.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:41:00.
     7*                            VMOD=2.026.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   2
* EL106.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION- EX10 - STATE MAINTENANCE
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* Changes are marked by the Change Effective date.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 100108    2008022800002  AJRA  ADD CHECK NUMBER TO STATE FOR AK
    34* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
    35* 011211    2010030900001  AJRA  ADD OPTION 4 AND 5 TO REFUND IND
    36* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
    37******************************************************************
    38
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   3
* EL106.cbl
    40 ENVIRONMENT DIVISION.
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL106 WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.026 ***********'.
    47
    48*                                COPY ELCSCTM.
    49******************************************************************
    50*                                                                *
    51*                                                                *
    52*                            ELCSCTM                             *
    53*                            VMOD=2.001                          *
    54*                                                                *
    55*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    56*                                                                *
    57******************************************************************
    58 01  SECURITY-MESSAGE.
    59     12  FILLER                          PIC X(30)
    60            VALUE '** LOGIC SECURITY VIOLATION -'.
    61     12  SM-READ                         PIC X(6).
    62     12  FILLER                          PIC X(5)
    63            VALUE ' PGM='.
    64     12  SM-PGM                          PIC X(6).
    65     12  FILLER                          PIC X(5)
    66            VALUE ' OPR='.
    67     12  SM-PROCESSOR-ID                 PIC X(4).
    68     12  FILLER                          PIC X(6)
    69            VALUE ' TERM='.
    70     12  SM-TERMID                       PIC X(4).
    71     12  FILLER                          PIC XX   VALUE SPACE.
    72     12  SM-JUL-DATE                     PIC 9(5).
    73     12  FILLER                          PIC X    VALUE SPACE.
    74     12  SM-TIME                         PIC 99.99.
    75
    76*                                COPY ELCSCRTY.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCRTY                            *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    84*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    85*        SAVED IN PI-SECURITY-ADDRESS.                           *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-CONTROL.
    89     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    90     12  FILLER                       PIC XX    VALUE 'SC'.
    91     12  SC-CREDIT-CODES.
    92         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    93             20  SC-CREDIT-DISPLAY    PIC X.
    94             20  SC-CREDIT-UPDATE     PIC X.
    95     12  SC-CLAIMS-CODES.
    96         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    97             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   4
* EL106.cbl
    98             20  SC-CLAIMS-UPDATE     PIC X.
    99*                                COPY MPCSCRT.
   100******************************************************************
   101*                                                                *
   102*                            MPCSCRT                             *
   103*                            VMOD=1.001                          *
   104*                                                                *
   105*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   106*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   107*                                      (MP MORTGAGE PROTECTION)  *
   108*                                                                *
   109******************************************************************
   110*
   111 01  SECURITY-CONTROL-E.
   112     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   113     12  FILLER                       PIC  X(02) VALUE 'SC'.
   114     12  SC-QUID-KEY.
   115         16  SC-QUID-TERMINAL         PIC  X(04).
   116         16  SC-QUID-SYSTEM           PIC  X(04).
   117     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   118     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   119     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   120         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   121         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   122     12  SC-MP-CODES.
   123         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   124             20  SC-MP-DISPLAY        PIC  X(01).
   125             20  SC-MP-UPDATE         PIC  X(01).
   126     12  FILLER                       PIC  X(40).
   127
   128 01  WS-DATE-AREA.
   129     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   130     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   131
   132 01  WS.
   133     05  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +29.
   134     05  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   135     05  WS-COMM-LENGTH      PIC S9(4) COMP VALUE +1500.
   136     05  WS-MAP-LENGTH       PIC S9(4) COMP VALUE +500.
   137     05  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   138     05  QID.
   139         16  QID-TERM        PIC X(4).
   140         16  FILLER          PIC X(4)    VALUE '106A'.
   141
   142     05  WS-ST-TOL-PREM-PCT  PIC S9V9(4)    VALUE +0.
   143     05  WS-ST-TOL-REF-PCT   PIC S9V9(4)    VALUE +0.
   144     05  WS-ST-OVR-SHT-PCT   PIC S9V9(4)    VALUE +0.
   145     05  WS-ST-LF-PREM-TAX   PIC S9V9(4)    VALUE +0.
   146     05  WS-ST-AH-PREM-TAX-I PIC S9V9(4)    VALUE +0.
   147     05  WS-ST-AH-PREM-TAX-G PIC S9V9(4)    VALUE +0.
   148     05  WS-ST-LF-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   149     05  WS-ST-AH-EXP-PCT    PIC S9(3)V9(4) VALUE +0.
   150     05  WS-ST-TARGET-LOSS-RATIO
   151                             PIC S9V9(4)    VALUE +0.
   152     05  WS-ST-CALC-INTEREST PIC S9V9(4)    VALUE +0.
   153     05  WS-COMSL            PIC S9V9(4)    VALUE +0.
   154     05  WS-COMJL            PIC S9V9(4)    VALUE +0.
   155     05  WS-COMSA            PIC S9V9(4)    VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   5
* EL106.cbl
   156     05  WS-COMJA            PIC S9V9(4)    VALUE +0.
   157     05  WS-RESIDENT-TAX     PIC S9V9(4)    VALUE +0.
   158     05  WS-IRATE            PIC S9V9(4)    VALUE +0.
   159     05  WS-IRATE1           PIC S9V9(4)    VALUE +0.
   160     05  WS-IRATE2           PIC S9V9(4)    VALUE +0.
   161     05  WS-IRATE3           PIC S9V9(4)    VALUE +0.
   162     05  WS-FREE-LOOK-DAYS   PIC S9(3)      VALUE +0.
   163
   164 01  STANDARD-AREAS.
   165     12  MAP-NAME            PIC X(8)    VALUE 'EL106A'.
   166     12  MAPSET-NAME         PIC X(8)    VALUE 'EL106S'.
   167     12  TRANS-ID            PIC X(4)    VALUE 'EX10'.
   168     12  PGM-NAME            PIC X(8).
   169     12  TIME-IN             PIC S9(7).
   170     12  TIME-OUT-R  REDEFINES TIME-IN.
   171         16  FILLER          PIC X.
   172         16  TIME-OUT        PIC 99V99.
   173         16  FILLER          PIC XX.
   174     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
   175     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
   176     12  XCTL-EL126          PIC X(8)    VALUE 'EL126'.
   177     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   178     12  XCTL-EL6565         PIC X(8)    VALUE 'EL6565'.
   179     12  XCTL-EL6507         PIC X(8)    VALUE 'EL6507'.
   180     12  XCTL-EL1061         PIC X(8)    VALUE 'EL1061'.
   181     12  XCTL-EM626          PIC X(8)    VALUE 'EM626'.
   182     12  XCTL-GL800          PIC X(8)    VALUE 'GL800'.
   183     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
   184     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
   185     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   186     12  THIS-PGM            PIC X(8)    VALUE 'EL106'.
   187     12  ELCNTL-ID           PIC X(8)    VALUE 'ELCNTL'.
   188     12  ELLETR-ID           PIC X(8)    VALUE 'ELLETR'.
   189     12  SUB                 PIC S9(4)   COMP.
   190     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   191     12  WS-FIRST-TIME-SW    PIC X       VALUE 'Y'.
   192         88  FIRST-TIME                  VALUE 'Y'.
   193     12  WS-DISPLAY-SW       PIC X       VALUE 'N'.
   194         88  RETURN-DISPLAY              VALUE 'Y'.
   195
   196 01  ACCESS-KEYS.
   197     12  ELCNTL-KEY.
   198         16  CK-COMP-ID      PIC X(3).
   199         16  FILLER          PIC X       VALUE '3'.
   200         16  CK-STATE-CD     PIC X(4)    VALUE SPACES.
   201         16  CK-SEQ          PIC S9(4)   VALUE +0    COMP.
   202     12  W-WORKING-TEXT-KEY.
   203         16  W-TEXT-COMPANY-CD
   204                             PIC X.
   205         16  W-TEXT-FORM-NO  PIC X(12).
   206         16  W-TEXT-LINE-SEQ PIC S9(4)   COMP.
   207
   208 01  ERROR-MESSAGES.
   209     12  ER-0000                 PIC X(4)  VALUE '0000'.
   210     12  ER-0004                 PIC X(4)  VALUE '0004'.
   211     12  ER-0013                 PIC X(4)  VALUE '0013'.
   212     12  ER-0023                 PIC X(4)  VALUE '0023'.
   213     12  ER-0029                 PIC X(4)  VALUE '0029'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   6
* EL106.cbl
   214     12  ER-0042                 PIC X(4)  VALUE '0042'.
   215     12  ER-0050                 PIC X(4)  VALUE '0050'.
   216     12  ER-0068                 PIC X(4)  VALUE '0068'.
   217     12  ER-0070                 PIC X(4)  VALUE '0070'.
   218     12  ER-0141                 PIC X(4)  VALUE '0141'.
   219     12  ER-0144                 PIC X(4)  VALUE '0144'.
   220     12  ER-0145                 PIC X(4)  VALUE '0145'.
   221     12  ER-0146                 PIC X(4)  VALUE '0146'.
   222     12  ER-0147                 PIC X(4)  VALUE '0147'.
   223     12  ER-0148                 PIC X(4)  VALUE '0148'.
   224     12  ER-0149                 PIC X(4)  VALUE '0149'.
   225     12  ER-0150                 PIC X(4)  VALUE '0150'.
   226     12  ER-0151                 PIC X(4)  VALUE '0151'.
   227     12  ER-0152                 PIC X(4)  VALUE '0152'.
   228     12  ER-0153                 PIC X(4)  VALUE '0153'.
   229     12  ER-0159                 PIC X(4)  VALUE '0159'.
   230     12  ER-0160                 PIC X(4)  VALUE '0160'.
   231     12  ER-0161                 PIC X(4)  VALUE '0161'.
   232     12  ER-0582                 PIC X(4)  VALUE '0582'.
   233     12  ER-0805                 PIC X(4)  VALUE '0805'.
   234     12  ER-1614                 PIC X(4)  VALUE '1614'.
   235     12  ER-2009                 PIC X(4)  VALUE '2009'.
   236     12  ER-2010                 PIC X(4)  VALUE '2010'.
   237     12  ER-2012                 PIC X(4)  VALUE '2012'.
   238     12  ER-2014                 PIC X(4)  VALUE '2014'.
   239     12  ER-2024                 PIC X(4)  VALUE '2024'.
   240     12  ER-2028                 PIC X(4)  VALUE '2028'.
   241     12  ER-2032                 PIC X(4)  VALUE '2032'.
   242     12  ER-2033                 PIC X(4)  VALUE '2033'.
   243     12  ER-2082                 PIC X(4)  VALUE '2082'.
   244     12  ER-2084                 PIC X(4)  VALUE '2084'.
   245     12  ER-2137                 PIC X(4)  VALUE '2137'.
   246     12  ER-2298                 PIC X(4)  VALUE '2298'.
   247     12  ER-2299                 PIC X(4)  VALUE '2299'.
   248     12  ER-3030                 PIC X(4)  VALUE '3030'.
   249     12  ER-3031                 PIC X(4)  VALUE '3031'.
   250     12  ER-3032                 PIC X(4)  VALUE '3032'.
   251     12  ER-3033                 PIC X(4)  VALUE '3033'.
   252     12  ER-3034                 PIC X(4)  VALUE '3034'.
   253     12  ER-3035                 PIC X(4)  VALUE '3035'.
   254     12  ER-3036                 PIC X(4)  VALUE '3036'.
   255     12  ER-3040                 PIC X(4)  VALUE '3040'.
   256     12  ER-7008                 PIC X(4)  VALUE '7008'.
   257     12  ER-7346                 PIC X(4)  VALUE '7346'.
   258     12  ER-7531                 PIC X(4)  VALUE '7531'.
   259     12  ER-7532                 PIC X(4)  VALUE '7532'.
   260     12  ER-7536                 PIC X(4)  VALUE '7536'.
   261     12  ER-7717                 PIC X(4)  VALUE '7717'.
   262     12  ER-7735                 PIC X(4)  VALUE '7735'.
   263     12  ER-8159                 PIC X(4)  VALUE '8159'.
   264     12  ER-9074                 PIC X(4)  VALUE '9074'.
   265     12  ER-9097                 PIC X(4)  VALUE '9097'.
   266     12  ER-9447                 PIC X(4)  VALUE '9447'.
   267     12  ER-9448                 PIC X(4)  VALUE '9448'.
   268     12  ER-9478                 PIC X(4)  VALUE '9478'.
   269     12  ER-9999                 PIC X(4)  VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   7
* EL106.cbl
   271*    COPY ELCDATE.
   272******************************************************************
   273*                                                                *
   274*                                                                *
   275*                            ELCDATE.                            *
   276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   277*                            VMOD=2.003
   278*                                                                *
   279*                                                                *
   280*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   281*                 LENGTH = 200                                   *
   282******************************************************************
   283
   284 01  DATE-CONVERSION-DATA.
   285     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   286     12  DC-OPTION-CODE                PIC X.
   287         88  BIN-TO-GREG                VALUE ' '.
   288         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   289         88  EDIT-GREG-TO-BIN           VALUE '2'.
   290         88  YMD-GREG-TO-BIN            VALUE '3'.
   291         88  MDY-GREG-TO-BIN            VALUE '4'.
   292         88  JULIAN-TO-BIN              VALUE '5'.
   293         88  BIN-PLUS-ELAPSED           VALUE '6'.
   294         88  FIND-CENTURY               VALUE '7'.
   295         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   296         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   297         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   298         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   299         88  JULIAN-TO-BIN-3            VALUE 'C'.
   300         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   301         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   302         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   303         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   304         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   305         88  CHECK-LEAP-YEAR            VALUE 'H'.
   306         88  BIN-3-TO-GREG              VALUE 'I'.
   307         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   308         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   309         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   310         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   311         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   312         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   313         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   314         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   315         88  THREE-CHARACTER-BIN
   316                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   317         88  GREGORIAN-TO-BIN
   318                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   319         88  BIN-TO-GREGORIAN
   320                  VALUES ' ' '1' 'I' '8' 'G'.
   321         88  JULIAN-TO-BINARY
   322                  VALUES '5' 'C' 'E' 'F'.
   323     12  DC-ERROR-CODE                 PIC X.
   324         88  NO-CONVERSION-ERROR        VALUE ' '.
   325         88  DATE-CONVERSION-ERROR
   326                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   327         88  DATE-IS-ZERO               VALUE '1'.
   328         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   8
* EL106.cbl
   329         88  DATE-IS-INVALID            VALUE '3'.
   330         88  DATE1-GREATER-DATE2        VALUE '4'.
   331         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   332         88  DATE-INVALID-OPTION        VALUE '9'.
   333         88  INVALID-CENTURY            VALUE 'A'.
   334         88  ONLY-CENTURY               VALUE 'B'.
   335         88  ONLY-LEAP-YEAR             VALUE 'C'.
   336         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   337     12  DC-END-OF-MONTH               PIC X.
   338         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   339     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   340         88  USE-NORMAL-PROCESS         VALUE ' '.
   341         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   342         88  ADJUST-UP-100-YRS          VALUE '2'.
   343     12  FILLER                        PIC X.
   344     12  DC-CONVERSION-DATES.
   345         16  DC-BIN-DATE-1             PIC XX.
   346         16  DC-BIN-DATE-2             PIC XX.
   347         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   348         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   349                       DC-GREG-DATE-1-EDIT.
   350             20  DC-EDIT1-MONTH        PIC 99.
   351             20  SLASH1-1              PIC X.
   352             20  DC-EDIT1-DAY          PIC 99.
   353             20  SLASH1-2              PIC X.
   354             20  DC-EDIT1-YEAR         PIC 99.
   355         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   356         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   357                     DC-GREG-DATE-2-EDIT.
   358             20  DC-EDIT2-MONTH        PIC 99.
   359             20  SLASH2-1              PIC X.
   360             20  DC-EDIT2-DAY          PIC 99.
   361             20  SLASH2-2              PIC X.
   362             20  DC-EDIT2-YEAR         PIC 99.
   363         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   364         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   365                     DC-GREG-DATE-1-YMD.
   366             20  DC-YMD-YEAR           PIC 99.
   367             20  DC-YMD-MONTH          PIC 99.
   368             20  DC-YMD-DAY            PIC 99.
   369         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   370         16  DC-GREG-DATE-1-MDY-R REDEFINES
   371                      DC-GREG-DATE-1-MDY.
   372             20  DC-MDY-MONTH          PIC 99.
   373             20  DC-MDY-DAY            PIC 99.
   374             20  DC-MDY-YEAR           PIC 99.
   375         16  DC-GREG-DATE-1-ALPHA.
   376             20  DC-ALPHA-MONTH        PIC X(10).
   377             20  DC-ALPHA-DAY          PIC 99.
   378             20  FILLER                PIC XX.
   379             20  DC-ALPHA-CENTURY.
   380                 24 DC-ALPHA-CEN-N     PIC 99.
   381             20  DC-ALPHA-YEAR         PIC 99.
   382         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   383         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   384         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   385         16  DC-JULIAN-DATE            PIC 9(05).
   386         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page   9
* EL106.cbl
   387                                       PIC 9(05).
   388         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   389             20  DC-JULIAN-YEAR        PIC 99.
   390             20  DC-JULIAN-DAYS        PIC 999.
   391         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   392         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   393         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   394     12  DATE-CONVERSION-VARIBLES.
   395         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   396         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   397             20  FILLER                PIC 9(3).
   398             20  HOLD-CEN-1-CCYY.
   399                 24  HOLD-CEN-1-CC     PIC 99.
   400                 24  HOLD-CEN-1-YY     PIC 99.
   401             20  HOLD-CEN-1-MO         PIC 99.
   402             20  HOLD-CEN-1-DA         PIC 99.
   403         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   404             20  HOLD-CEN-1-R-MO       PIC 99.
   405             20  HOLD-CEN-1-R-DA       PIC 99.
   406             20  HOLD-CEN-1-R-CCYY.
   407                 24  HOLD-CEN-1-R-CC   PIC 99.
   408                 24  HOLD-CEN-1-R-YY   PIC 99.
   409             20  FILLER                PIC 9(3).
   410         16  HOLD-CENTURY-1-X.
   411             20  FILLER                PIC X(3)  VALUE SPACES.
   412             20  HOLD-CEN-1-X-CCYY.
   413                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   414                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   415             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   416             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   417         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   418             20  HOLD-CEN-1-R-X-MO     PIC XX.
   419             20  HOLD-CEN-1-R-X-DA     PIC XX.
   420             20  HOLD-CEN-1-R-X-CCYY.
   421                 24  HOLD-CEN-1-R-X-CC PIC XX.
   422                 24  HOLD-CEN-1-R-X-YY PIC XX.
   423             20  FILLER                PIC XXX.
   424         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   425         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   426         16  DC-JULIAN-DATE-1          PIC 9(07).
   427         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   428             20  DC-JULIAN-1-CCYY.
   429                 24  DC-JULIAN-1-CC    PIC 99.
   430                 24  DC-JULIAN-1-YR    PIC 99.
   431             20  DC-JULIAN-DA-1        PIC 999.
   432         16  DC-JULIAN-DATE-2          PIC 9(07).
   433         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   434             20  DC-JULIAN-2-CCYY.
   435                 24  DC-JULIAN-2-CC    PIC 99.
   436                 24  DC-JULIAN-2-YR    PIC 99.
   437             20  DC-JULIAN-DA-2        PIC 999.
   438         16  DC-GREG-DATE-A-EDIT.
   439             20  DC-EDITA-MONTH        PIC 99.
   440             20  SLASHA-1              PIC X VALUE '/'.
   441             20  DC-EDITA-DAY          PIC 99.
   442             20  SLASHA-2              PIC X VALUE '/'.
   443             20  DC-EDITA-CCYY.
   444                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  10
* EL106.cbl
   445                 24  DC-EDITA-YEAR     PIC 99.
   446         16  DC-GREG-DATE-B-EDIT.
   447             20  DC-EDITB-MONTH        PIC 99.
   448             20  SLASHB-1              PIC X VALUE '/'.
   449             20  DC-EDITB-DAY          PIC 99.
   450             20  SLASHB-2              PIC X VALUE '/'.
   451             20  DC-EDITB-CCYY.
   452                 24  DC-EDITB-CENT     PIC 99.
   453                 24  DC-EDITB-YEAR     PIC 99.
   454         16  DC-GREG-DATE-CYMD         PIC 9(08).
   455         16  DC-GREG-DATE-CYMD-R REDEFINES
   456                              DC-GREG-DATE-CYMD.
   457             20  DC-CYMD-CEN           PIC 99.
   458             20  DC-CYMD-YEAR          PIC 99.
   459             20  DC-CYMD-MONTH         PIC 99.
   460             20  DC-CYMD-DAY           PIC 99.
   461         16  DC-GREG-DATE-MDCY         PIC 9(08).
   462         16  DC-GREG-DATE-MDCY-R REDEFINES
   463                              DC-GREG-DATE-MDCY.
   464             20  DC-MDCY-MONTH         PIC 99.
   465             20  DC-MDCY-DAY           PIC 99.
   466             20  DC-MDCY-CEN           PIC 99.
   467             20  DC-MDCY-YEAR          PIC 99.
   468    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   469        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   470    12  DC-EL310-DATE                  PIC X(21).
   471    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  11
* EL106.cbl
   473*    COPY ELCLOGOF.
   474******************************************************************
   475*                                                                *
   476*                                                                *
   477*                            ELCLOGOF.                           *
   478*                            VMOD=2.001                          *
   479*                                                                *
   480*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   481*                                                                *
   482******************************************************************
   483 01  CLASIC-LOGOFF.
   484     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   485     12  LOGOFF-TEXT.
   486         16  FILLER          PIC X(5)    VALUE SPACES.
   487         16  LOGOFF-MSG.
   488             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   489             20  FILLER      PIC X       VALUE SPACES.
   490             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   491         16  FILLER          PIC X(80)
   492           VALUE '* YOU ARE NOW LOGGED OFF'.
   493         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   494         16  FILLER          PIC X       VALUE QUOTE.
   495         16  LOGOFF-SYS-MSG  PIC X(17)
   496           VALUE 'S CLAS-IC SYSTEM '.
   497     12  TEXT-MESSAGES.
   498         16  UNACCESS-MSG    PIC X(29)
   499             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   500         16  PGMIDERR-MSG    PIC X(17)
   501             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  12
* EL106.cbl
   503*    COPY ELCATTR.
   504******************************************************************
   505*                                                                *
   506*                            ELCATTR.                            *
   507*                            VMOD=2.001                          *
   508*                                                                *
   509*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   510*                                                                *
   511*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   512*                                                                *
   513*                   POS 1   P=PROTECTED                          *
   514*                           U=UNPROTECTED                        *
   515*                           S=ASKIP                              *
   516*                   POS 2   A=ALPHA/NUMERIC                      *
   517*                           N=NUMERIC                            *
   518*                   POS 3   N=NORMAL                             *
   519*                           B=BRIGHT                             *
   520*                           D=DARK                               *
   521*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   522*                           OF=MODIFIED DATA TAG OFF             *
   523*                                                                *
   524*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   525******************************************************************
   526 01  ATTRIBUTE-LIST.
   527     12  AL-PABOF            PIC X       VALUE 'Y'.
   528     12  AL-PABON            PIC X       VALUE 'Z'.
   529     12  AL-PADOF            PIC X       VALUE '%'.
   530     12  AL-PADON            PIC X       VALUE '_'.
   531     12  AL-PANOF            PIC X       VALUE '-'.
   532     12  AL-PANON            PIC X       VALUE '/'.
   533     12  AL-SABOF            PIC X       VALUE '8'.
   534     12  AL-SABON            PIC X       VALUE '9'.
   535     12  AL-SADOF            PIC X       VALUE '@'.
   536     12  AL-SADON            PIC X       VALUE QUOTE.
   537     12  AL-SANOF            PIC X       VALUE '0'.
   538     12  AL-SANON            PIC X       VALUE '1'.
   539     12  AL-UABOF            PIC X       VALUE 'H'.
   540     12  AL-UABON            PIC X       VALUE 'I'.
   541     12  AL-UADOF            PIC X       VALUE '<'.
   542     12  AL-UADON            PIC X       VALUE '('.
   543     12  AL-UANOF            PIC X       VALUE ' '.
   544     12  AL-UANON            PIC X       VALUE 'A'.
   545     12  AL-UNBOF            PIC X       VALUE 'Q'.
   546     12  AL-UNBON            PIC X       VALUE 'R'.
   547     12  AL-UNDOF            PIC X       VALUE '*'.
   548     12  AL-UNDON            PIC X       VALUE ')'.
   549     12  AL-UNNOF            PIC X       VALUE '&'.
   550     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  13
* EL106.cbl
   552*    COPY ELCEMIB.
   553******************************************************************
   554*                                                                *
   555*                                                                *
   556*                            ELCEMIB.                            *
   557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   558*                            VMOD=2.005                          *
   559*                                                                *
   560*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   561*                                                                *
   562******************************************************************
   563 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   564     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   565     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   566     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   567     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   568     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   569     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   570     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   571     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   572     12  EMI-SWITCH1             PIC X        VALUE '1'.
   573         88  EMI-NO-ERRORS                    VALUE '1'.
   574         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   575         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   576     12  EMI-SWITCH2             PIC X        VALUE '1'.
   577         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   578     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   579         88  EMI-AREA1-EMPTY                  VALUE '1'.
   580         88  EMI-AREA1-FULL                   VALUE '2'.
   581     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   582         88  EMI-AREA2-EMPTY                  VALUE '1'.
   583         88  EMI-AREA2-FULL                   VALUE '2'.
   584     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   585         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   586         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   587         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   588         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   589         88  EMI-BYPASS-FATALS                VALUE 'X'.
   590     12  EMI-ERROR-LINES.
   591         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   592         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   593         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   594         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   595             20  EMI-ERR-CODES OCCURS 10 TIMES.
   596                 24  EMI-ERR-NUM         PIC X(4).
   597                 24  EMI-FILLER          PIC X.
   598                 24  EMI-SEV             PIC X.
   599                 24  FILLER              PIC X.
   600             20  FILLER                  PIC X(02).
   601     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   602         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   603             20  EMI-ERROR-NUMBER    PIC X(4).
   604             20  EMI-FILL            PIC X.
   605             20  EMI-SEVERITY        PIC X.
   606             20  FILLER              PIC X.
   607             20  EMI-ERROR-TEXT.
   608                 24  EMI-TEXT-VARIABLE   PIC X(10).
   609                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  14
* EL106.cbl
   610     12  EMI-SEVERITY-SAVE           PIC X.
   611         88  EMI-NOTE                    VALUE 'N'.
   612         88  EMI-WARNING                 VALUE 'W'.
   613         88  EMI-FORCABLE                VALUE 'F'.
   614         88  EMI-FATAL                   VALUE 'X'.
   615     12  EMI-MESSAGE-FLAG            PIC X.
   616         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   617         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   618     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   619     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   620         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   621         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   622         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   623     12  FILLER                      PIC X(137)  VALUE SPACES.
   624     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   625     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   626     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   627     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  15
* EL106.cbl
   629*    COPY ELCJPFX.
   630******************************************************************
   631*                                                                *
   632*                                                                *
   633*                            ELCJPFX.                            *
   634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   635*                            VMOD=2.002                          *
   636*                                                                *
   637*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   638*                                                                *
   639*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   640*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   641*        ELCNTL - CONTROL FILE                                   *
   642*        ELMSTR - CLAIM MASTERS                                  *
   643*        ELTRLR - ACTIVITY TRAILERS                              *
   644*        ELCHKQ - CHECK QUE                                      *
   645******************************************************************
   646 01  JOURNAL-RECORD.
   647     12  JP-USER-ID                  PIC X(4).
   648     12  JP-FILE-ID                  PIC X(8).
   649     12  JP-PROGRAM-ID               PIC X(8).
   650     12  JP-RECORD-TYPE              PIC X.
   651         88 JP-ADD              VALUE 'A'.
   652         88 JP-BEFORE-CHANGE    VALUE 'B'.
   653         88 JP-AFTER-CHANGE     VALUE 'C'.
   654         88 JP-DELETE           VALUE 'D'.
   655         88 JP-GENERIC-DELETE   VALUE 'G'.
   656         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   657         88 JP-KEY-CHG-ADD      VALUE 'N'.
   658     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   659     12  JP-RECORD-AREA
   660
   661
   662             PIC X(530).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  16
* EL106.cbl
   664*    COPY ELCINTF.
   665******************************************************************
   666*                                                                *
   667*                                                                *
   668*                            ELCINTF.                            *
   669*                            VMOD=2.017                          *
   670*                                                                *
   671*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   672*                                                                *
   673*       LENGTH = 1024                                            *
   674*                                                                *
   675******************************************************************
   676 01  PROGRAM-INTERFACE-BLOCK.
   677     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   678     12  PI-CALLING-PROGRAM              PIC X(8).
   679     12  PI-SAVED-PROGRAM-1              PIC X(8).
   680     12  PI-SAVED-PROGRAM-2              PIC X(8).
   681     12  PI-SAVED-PROGRAM-3              PIC X(8).
   682     12  PI-SAVED-PROGRAM-4              PIC X(8).
   683     12  PI-SAVED-PROGRAM-5              PIC X(8).
   684     12  PI-SAVED-PROGRAM-6              PIC X(8).
   685     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   686     12  PI-COMPANY-ID                   PIC XXX.
   687     12  PI-COMPANY-CD                   PIC X.
   688
   689     12  PI-COMPANY-PASSWORD             PIC X(8).
   690
   691     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   692
   693     12  PI-CONTROL-IN-PROGRESS.
   694         16  PI-CARRIER                  PIC X.
   695         16  PI-GROUPING                 PIC X(6).
   696         16  PI-STATE                    PIC XX.
   697         16  PI-ACCOUNT                  PIC X(10).
   698         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   699                                         PIC X(10).
   700         16  PI-CLAIM-CERT-GRP.
   701             20  PI-CLAIM-NO             PIC X(7).
   702             20  PI-CERT-NO.
   703                 25  PI-CERT-PRIME       PIC X(10).
   704                 25  PI-CERT-SFX         PIC X.
   705             20  PI-CERT-EFF-DT          PIC XX.
   706         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   707             20  PI-PLAN-CODE            PIC X(2).
   708             20  PI-REVISION-NUMBER      PIC X(3).
   709             20  PI-PLAN-EFF-DT          PIC X(2).
   710             20  PI-PLAN-EXP-DT          PIC X(2).
   711             20  FILLER                  PIC X(11).
   712         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   713             20  PI-OE-REFERENCE-1.
   714                 25  PI-OE-REF-1-PRIME   PIC X(18).
   715                 25  PI-OE-REF-1-SUFF    PIC XX.
   716
   717     12  PI-SESSION-IN-PROGRESS          PIC X.
   718         88  CLAIM-SESSION                   VALUE '1'.
   719         88  CREDIT-SESSION                  VALUE '2'.
   720         88  WARRANTY-SESSION                VALUE '3'.
   721         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  17
* EL106.cbl
   722         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   723
   724
   725*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   726
   727     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   728     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   729
   730     12  PI-CREDIT-USER                  PIC X.
   731         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   732         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   733
   734     12  PI-CLAIM-USER                   PIC X.
   735         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   736         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   737
   738     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   739         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   740         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   741         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   742         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   743         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   744
   745     12  PI-PROCESSOR-ID                 PIC X(4).
   746
   747     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   748
   749     12  PI-MEMBER-CAPTION               PIC X(10).
   750
   751     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   752         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   753
   754     12  PI-LIFE-OVERRIDE-L1             PIC X.
   755     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   756     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   757     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   758
   759     12  PI-AH-OVERRIDE-L1               PIC X.
   760     12  PI-AH-OVERRIDE-L2               PIC XX.
   761     12  PI-AH-OVERRIDE-L6               PIC X(6).
   762     12  PI-AH-OVERRIDE-L12              PIC X(12).
   763
   764     12  PI-NEW-SYSTEM                   PIC X(2).
   765
   766     12  PI-PRIMARY-CERT-NO              PIC X(11).
   767     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   768         88  PI-USES-PAID-TO                 VALUE '1'.
   769     12  PI-CRDTCRD-SYSTEM.
   770         16  PI-CRDTCRD-USER             PIC X.
   771             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   772             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   773         16  PI-CC-MONTH-END-DT          PIC XX.
   774     12  PI-PROCESSOR-PRINTER            PIC X(4).
   775
   776     12  PI-OE-REFERENCE-2.
   777         16  PI-OE-REF-2-PRIME           PIC X(10).
   778         16  PI-OE-REF-2-SUFF            PIC X.
   779
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  18
* EL106.cbl
   780     12  PI-REM-TRM-CALC-OPTION          PIC X.
   781
   782     12  PI-LANGUAGE-TYPE                PIC X.
   783             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   784             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   785             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   786
   787     12  PI-POLICY-LINKAGE-IND           PIC X.
   788         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   789         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   790                                                   LOW-VALUES.
   791
   792     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   793     12  PI-CLAIM-PW-SESSION             PIC X(1).
   794         88  PI-CLAIM-CREDIT                 VALUE '1'.
   795         88  PI-CLAIM-CONVEN                 VALUE '2'.
   796     12  FILLER                          PIC X(4).
   797
   798     12  PI-SYSTEM-LEVEL                 PIC X(145).
   799
   800     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   801         PI-SYSTEM-LEVEL.
   802
   803         16  PI-ENTRY-CODES.
   804             20  PI-ENTRY-CD-1           PIC X.
   805             20  PI-ENTRY-CD-2           PIC X.
   806
   807         16  PI-RETURN-CODES.
   808             20  PI-RETURN-CD-1          PIC X.
   809             20  PI-RETURN-CD-2          PIC X.
   810
   811         16  PI-UPDATE-STATUS-SAVE.
   812             20  PI-UPDATE-BY            PIC X(4).
   813             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   814
   815         16  PI-LOWER-CASE-LETTERS       PIC X.
   816             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   817
   818*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   819*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   820*            88  CARRIER-CLM-CNTL            VALUE '2'.
   821
   822         16  PI-CERT-ACCESS-CONTROL      PIC X.
   823             88  ST-ACCNT-CNTL               VALUE ' '.
   824             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   825             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   826             88  ACCNT-CNTL                  VALUE '3'.
   827             88  CARR-ACCNT-CNTL             VALUE '4'.
   828
   829         16  PI-PROCESSOR-CAP-LIST.
   830             20  PI-SYSTEM-CONTROLS.
   831                24 PI-SYSTEM-DISPLAY     PIC X.
   832                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   833                24 PI-SYSTEM-MODIFY      PIC X.
   834                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   835             20  FILLER                  PIC XX.
   836             20  PI-DISPLAY-CAP          PIC X.
   837                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  19
* EL106.cbl
   838             20  PI-MODIFY-CAP           PIC X.
   839                 88  MODIFY-CAP              VALUE 'Y'.
   840             20  PI-MSG-AT-LOGON-CAP     PIC X.
   841                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   842             20  PI-FORCE-CAP            PIC X.
   843                 88  FORCE-CAP               VALUE 'Y'.
   844
   845         16  PI-PROGRAM-CONTROLS.
   846             20  PI-PGM-PRINT-OPT        PIC X.
   847             20  PI-PGM-FORMAT-OPT       PIC X.
   848             20  PI-PGM-PROCESS-OPT      PIC X.
   849             20  PI-PGM-TOTALS-OPT       PIC X.
   850
   851         16  PI-HELP-INTERFACE.
   852             20  PI-LAST-ERROR-NO        PIC X(4).
   853             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   854
   855         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   856             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   857
   858         16  PI-CR-CONTROL-IN-PROGRESS.
   859             20  PI-CR-CARRIER           PIC X.
   860             20  PI-CR-GROUPING          PIC X(6).
   861             20  PI-CR-STATE             PIC XX.
   862             20  PI-CR-ACCOUNT           PIC X(10).
   863             20  PI-CR-FIN-RESP          PIC X(10).
   864             20  PI-CR-TYPE              PIC X.
   865
   866         16  PI-CR-BATCH-NUMBER          PIC X(6).
   867
   868         16  PI-CR-MONTH-END-DT          PIC XX.
   869
   870         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   871             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   872             88  PI-ZERO-CARRIER             VALUE '1'.
   873             88  PI-ZERO-GROUPING            VALUE '2'.
   874             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   875
   876         16  PI-CARRIER-SECURITY         PIC X.
   877             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   878
   879         16  PI-ACCOUNT-SECURITY         PIC X(10).
   880             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   881             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   882
   883         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   884             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   885                                         INDEXED BY PI-ACCESS-NDX
   886                                         PIC X.
   887
   888         16  PI-GA-BILLING-CONTROL       PIC X.
   889             88  PI-GA-BILLING               VALUE '1'.
   890
   891         16  PI-MAIL-PROCESSING          PIC X.
   892             88  PI-MAIL-YES                 VALUE 'Y'.
   893
   894         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   895
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  20
* EL106.cbl
   896         16  PI-AR-SYSTEM.
   897             20  PI-AR-PROCESSING-CNTL   PIC X.
   898                 88  PI-AR-PROCESSING        VALUE 'Y'.
   899             20  PI-AR-SUMMARY-CODE      PIC X(6).
   900             20  PI-AR-MONTH-END-DT      PIC XX.
   901
   902         16  PI-MP-SYSTEM.
   903             20  PI-MORTGAGE-USER            PIC X.
   904                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   905                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   906             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   907                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   908                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   909                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   910                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   911                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   912             20  PI-MP-MONTH-END-DT          PIC XX.
   913             20  PI-MP-REFERENCE-NO.
   914                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   915                 24  PI-MP-REFERENCE-SFX     PIC XX.
   916
   917         16  PI-LABEL-CONTROL            PIC X(01).
   918             88  PI-CREATE-LABELS                    VALUE 'Y'.
   919             88  PI-BYPASS-LABELS                    VALUE 'N'.
   920
   921         16  PI-BILL-GROUPING-CODE       PIC X(01).
   922             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   923
   924         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   925             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   926             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   927
   928         16  FILLER                      PIC X(14).
   929
   930     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   931******************************************************************
   932     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   933         16  FILLER              PIC X(101).
   934         16  PI-WS-STATE         PIC XX.
   935         16  PI-WS-CLASS         PIC XX.
   936         16  PI-WS-DEV           PIC XXX.
   937         16  PI-WS-TYPE          PIC X.
   938         16  PI-WS-PLAN          PIC XX.
   939         16  PI-PREV-STATE       PIC X(4).
   940         16  FILLER              PIC X(525).
   941
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  21
* EL106.cbl
   943*    COPY ELCAID.
   944******************************************************************
   945*                                                                *
   946*                            ELCAID.                             *
   947*                            VMOD=2.001                          *
   948*                                                                *
   949*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   950*                                                                *
   951*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   952*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   953******************************************************************
   954
   955 01  DFHAID.
   956   02  DFHNULL   PIC  X  VALUE  ' '.
   957   02  DFHENTER  PIC  X  VALUE  QUOTE.
   958   02  DFHCLEAR  PIC  X  VALUE  '_'.
   959   02  DFHPEN    PIC  X  VALUE  '='.
   960   02  DFHOPID   PIC  X  VALUE  'W'.
   961   02  DFHPA1    PIC  X  VALUE  '%'.
   962   02  DFHPA2    PIC  X  VALUE  '>'.
   963   02  DFHPA3    PIC  X  VALUE  ','.
   964   02  DFHPF1    PIC  X  VALUE  '1'.
   965   02  DFHPF2    PIC  X  VALUE  '2'.
   966   02  DFHPF3    PIC  X  VALUE  '3'.
   967   02  DFHPF4    PIC  X  VALUE  '4'.
   968   02  DFHPF5    PIC  X  VALUE  '5'.
   969   02  DFHPF6    PIC  X  VALUE  '6'.
   970   02  DFHPF7    PIC  X  VALUE  '7'.
   971   02  DFHPF8    PIC  X  VALUE  '8'.
   972   02  DFHPF9    PIC  X  VALUE  '9'.
   973   02  DFHPF10   PIC  X  VALUE  ':'.
   974   02  DFHPF11   PIC  X  VALUE  '#'.
   975   02  DFHPF12   PIC  X  VALUE  '@'.
   976   02  DFHPF13   PIC  X  VALUE  'A'.
   977   02  DFHPF14   PIC  X  VALUE  'B'.
   978   02  DFHPF15   PIC  X  VALUE  'C'.
   979   02  DFHPF16   PIC  X  VALUE  'D'.
   980   02  DFHPF17   PIC  X  VALUE  'E'.
   981   02  DFHPF18   PIC  X  VALUE  'F'.
   982   02  DFHPF19   PIC  X  VALUE  'G'.
   983   02  DFHPF20   PIC  X  VALUE  'H'.
   984   02  DFHPF21   PIC  X  VALUE  'I'.
   985*00039    02  DFHPF22   PIC  X  VALUE  ''.
   986   02  DFHPF22   PIC  X  VALUE  '['.
   987   02  DFHPF23   PIC  X  VALUE  '.'.
   988   02  DFHPF24   PIC  X  VALUE  '<'.
   989   02  DFHMSRE   PIC  X  VALUE  'X'.
   990   02  DFHSTRF   PIC  X  VALUE  'h'.
   991   02  DFHTRIG   PIC  X  VALUE  '"'.
   992 01  FILLER REDEFINES DFHAID.
   993     12  FILLER              PIC X(8).
   994     12  PF-VALUES           PIC X       OCCURS 2.
   995
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  22
* EL106.cbl
   997*    COPY EL106S.
   998 01  EL106AI.
   999     05  FILLER            PIC  X(0012).
  1000*    -------------------------------
  1001     05  RUNDTEL PIC S9(0004) COMP.
  1002     05  RUNDTEF PIC  X(0001).
  1003     05  FILLER REDEFINES RUNDTEF.
  1004         10  RUNDTEA PIC  X(0001).
  1005     05  RUNDTEI PIC  X(0008).
  1006*    -------------------------------
  1007     05  RUNTIMEL PIC S9(0004) COMP.
  1008     05  RUNTIMEF PIC  X(0001).
  1009     05  FILLER REDEFINES RUNTIMEF.
  1010         10  RUNTIMEA PIC  X(0001).
  1011     05  RUNTIMEI PIC  X(0005).
  1012*    -------------------------------
  1013     05  MAINTL PIC S9(0004) COMP.
  1014     05  MAINTF PIC  X(0001).
  1015     05  FILLER REDEFINES MAINTF.
  1016         10  MAINTA PIC  X(0001).
  1017     05  MAINTI PIC  X(0001).
  1018*    -------------------------------
  1019     05  LSTUSRL PIC S9(0004) COMP.
  1020     05  LSTUSRF PIC  X(0001).
  1021     05  FILLER REDEFINES LSTUSRF.
  1022         10  LSTUSRA PIC  X(0001).
  1023     05  LSTUSRI PIC  X(0004).
  1024*    -------------------------------
  1025     05  LSTDTEL PIC S9(0004) COMP.
  1026     05  LSTDTEF PIC  X(0001).
  1027     05  FILLER REDEFINES LSTDTEF.
  1028         10  LSTDTEA PIC  X(0001).
  1029     05  LSTDTEI PIC  X(0008).
  1030*    -------------------------------
  1031     05  LSTTIMEL PIC S9(0004) COMP.
  1032     05  LSTTIMEF PIC  X(0001).
  1033     05  FILLER REDEFINES LSTTIMEF.
  1034         10  LSTTIMEA PIC  X(0001).
  1035     05  LSTTIMEI PIC  X(0005).
  1036*    -------------------------------
  1037     05  STCDL PIC S9(0004) COMP.
  1038     05  STCDF PIC  X(0001).
  1039     05  FILLER REDEFINES STCDF.
  1040         10  STCDA PIC  X(0001).
  1041     05  STCDI PIC  X(0002).
  1042*    -------------------------------
  1043     05  STABRL PIC S9(0004) COMP.
  1044     05  STABRF PIC  X(0001).
  1045     05  FILLER REDEFINES STABRF.
  1046         10  STABRA PIC  X(0001).
  1047     05  STABRI PIC  X(0002).
  1048*    -------------------------------
  1049     05  STNAMEL PIC S9(0004) COMP.
  1050     05  STNAMEF PIC  X(0001).
  1051     05  FILLER REDEFINES STNAMEF.
  1052         10  STNAMEA PIC  X(0001).
  1053     05  STNAMEI PIC  X(0025).
  1054*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  23
* EL106.cbl
  1055     05  LEXPLBLL PIC S9(0004) COMP.
  1056     05  LEXPLBLF PIC  X(0001).
  1057     05  FILLER REDEFINES LEXPLBLF.
  1058         10  LEXPLBLA PIC  X(0001).
  1059     05  LEXPLBLI PIC  X(0006).
  1060*    -------------------------------
  1061     05  LFEXPL PIC S9(0004) COMP.
  1062     05  LFEXPF PIC  X(0001).
  1063     05  FILLER REDEFINES LFEXPF.
  1064         10  LFEXPA PIC  X(0001).
  1065     05  LFEXPI PIC  S9(3)V9999.
  1066*    -------------------------------
  1067     05  AEXPLBLL PIC S9(0004) COMP.
  1068     05  AEXPLBLF PIC  X(0001).
  1069     05  FILLER REDEFINES AEXPLBLF.
  1070         10  AEXPLBLA PIC  X(0001).
  1071     05  AEXPLBLI PIC  X(0006).
  1072*    -------------------------------
  1073     05  AHEXPL PIC S9(0004) COMP.
  1074     05  AHEXPF PIC  X(0001).
  1075     05  FILLER REDEFINES AHEXPF.
  1076         10  AHEXPA PIC  X(0001).
  1077     05  AHEXPI PIC  S9(3)V9999.
  1078*    -------------------------------
  1079     05  REMTERML PIC S9(0004) COMP.
  1080     05  REMTERMF PIC  X(0001).
  1081     05  FILLER REDEFINES REMTERMF.
  1082         10  REMTERMA PIC  X(0001).
  1083     05  REMTERMI PIC  X(0001).
  1084*    -------------------------------
  1085     05  QUOTCALL PIC S9(0004) COMP.
  1086     05  QUOTCALF PIC  X(0001).
  1087     05  FILLER REDEFINES QUOTCALF.
  1088         10  QUOTCALA PIC  X(0001).
  1089     05  QUOTCALI PIC  S9(4)V99.
  1090*    -------------------------------
  1091     05  PREMTOLL PIC S9(0004) COMP.
  1092     05  PREMTOLF PIC  X(0001).
  1093     05  FILLER REDEFINES PREMTOLF.
  1094         10  PREMTOLA PIC  X(0001).
  1095     05  PREMTOLI PIC  S9(4)V99.
  1096*    -------------------------------
  1097     05  REFTOLL PIC S9(0004) COMP.
  1098     05  REFTOLF PIC  X(0001).
  1099     05  FILLER REDEFINES REFTOLF.
  1100         10  REFTOLA PIC  X(0001).
  1101     05  REFTOLI PIC  S9(4)V99.
  1102*    -------------------------------
  1103     05  PRMPCTL PIC S9(0004) COMP.
  1104     05  PRMPCTF PIC  X(0001).
  1105     05  FILLER REDEFINES PRMPCTF.
  1106         10  PRMPCTA PIC  X(0001).
  1107     05  PRMPCTI PIC  S9(1)V9(4).
  1108*    -------------------------------
  1109     05  REFPCTL PIC S9(0004) COMP.
  1110     05  REFPCTF PIC  X(0001).
  1111     05  FILLER REDEFINES REFPCTF.
  1112         10  REFPCTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  24
* EL106.cbl
  1113     05  REFPCTI PIC  S9(1)V9(4).
  1114*    -------------------------------
  1115     05  OVSAMTL PIC S9(0004) COMP.
  1116     05  OVSAMTF PIC  X(0001).
  1117     05  FILLER REDEFINES OVSAMTF.
  1118         10  OVSAMTA PIC  X(0001).
  1119     05  OVSAMTI PIC  S9(4)V99.
  1120*    -------------------------------
  1121     05  OVSPCTL PIC S9(0004) COMP.
  1122     05  OVSPCTF PIC  X(0001).
  1123     05  FILLER REDEFINES OVSPCTF.
  1124         10  OVSPCTA PIC  X(0001).
  1125     05  OVSPCTI PIC  S9(1)V9(4).
  1126*    -------------------------------
  1127     05  CLREJECL PIC S9(0004) COMP.
  1128     05  CLREJECF PIC  X(0001).
  1129     05  FILLER REDEFINES CLREJECF.
  1130         10  CLREJECA PIC  X(0001).
  1131     05  CLREJECI PIC  X(0001).
  1132*    -------------------------------
  1133     05  ISSREJL PIC S9(0004) COMP.
  1134     05  ISSREJF PIC  X(0001).
  1135     05  FILLER REDEFINES ISSREJF.
  1136         10  ISSREJA PIC  X(0001).
  1137     05  ISSREJI PIC  X(0001).
  1138*    -------------------------------
  1139     05  REFREJL PIC S9(0004) COMP.
  1140     05  REFREJF PIC  X(0001).
  1141     05  FILLER REDEFINES REFREJF.
  1142         10  REFREJA PIC  X(0001).
  1143     05  REFREJI PIC  X(0001).
  1144*    -------------------------------
  1145     05  REFMINL PIC S9(0004) COMP.
  1146     05  REFMINF PIC  X(0001).
  1147     05  FILLER REDEFINES REFMINF.
  1148         10  REFMINA PIC  X(0001).
  1149     05  REFMINI PIC  S9(4)V99.
  1150*    -------------------------------
  1151     05  REFDAY1L PIC S9(0004) COMP.
  1152     05  REFDAY1F PIC  X(0001).
  1153     05  FILLER REDEFINES REFDAY1F.
  1154         10  REFDAY1A PIC  X(0001).
  1155     05  REFDAY1I PIC  X(0002).
  1156*    -------------------------------
  1157     05  REFDAYSL PIC S9(0004) COMP.
  1158     05  REFDAYSF PIC  X(0001).
  1159     05  FILLER REDEFINES REFDAYSF.
  1160         10  REFDAYSA PIC  X(0001).
  1161     05  REFDAYSI PIC  X(0002).
  1162*    -------------------------------
  1163     05  SPLPMTL PIC S9(0004) COMP.
  1164     05  SPLPMTF PIC  X(0001).
  1165     05  FILLER REDEFINES SPLPMTF.
  1166         10  SPLPMTA PIC  X(0001).
  1167     05  SPLPMTI PIC  X(0001).
  1168*    -------------------------------
  1169     05  STUEL PIC S9(0004) COMP.
  1170     05  STUEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  25
* EL106.cbl
  1171     05  FILLER REDEFINES STUEF.
  1172         10  STUEA PIC  X(0001).
  1173     05  STUEI PIC  X(0001).
  1174*    -------------------------------
  1175     05  STCNTLL PIC S9(0004) COMP.
  1176     05  STCNTLF PIC  X(0001).
  1177     05  FILLER REDEFINES STCNTLF.
  1178         10  STCNTLA PIC  X(0001).
  1179     05  STCNTLI PIC  X(0001).
  1180*    -------------------------------
  1181     05  STDEVL PIC S9(0004) COMP.
  1182     05  STDEVF PIC  X(0001).
  1183     05  FILLER REDEFINES STDEVF.
  1184         10  STDEVA PIC  X(0001).
  1185     05  STDEVI PIC  X(0003).
  1186*    -------------------------------
  1187     05  EXTDAYSL PIC S9(0004) COMP.
  1188     05  EXTDAYSF PIC  X(0001).
  1189     05  FILLER REDEFINES EXTDAYSF.
  1190         10  EXTDAYSA PIC  X(0001).
  1191     05  EXTDAYSI PIC  X(0003).
  1192*    -------------------------------
  1193     05  EXTCHGL PIC S9(0004) COMP.
  1194     05  EXTCHGF PIC  X(0001).
  1195     05  FILLER REDEFINES EXTCHGF.
  1196         10  EXTCHGA PIC  X(0001).
  1197     05  EXTCHGI PIC  X(0001).
  1198*    -------------------------------
  1199     05  LFTAXL PIC S9(0004) COMP.
  1200     05  LFTAXF PIC  X(0001).
  1201     05  FILLER REDEFINES LFTAXF.
  1202         10  LFTAXA PIC  X(0001).
  1203     05  LFTAXI PIC  S9(1)V9(4).
  1204*    -------------------------------
  1205     05  REPLAWL PIC S9(0004) COMP.
  1206     05  REPLAWF PIC  X(0001).
  1207     05  FILLER REDEFINES REPLAWF.
  1208         10  REPLAWA PIC  X(0001).
  1209     05  REPLAWI PIC  X(0001).
  1210*    -------------------------------
  1211     05  REPLETRL PIC S9(0004) COMP.
  1212     05  REPLETRF PIC  X(0001).
  1213     05  FILLER REDEFINES REPLETRF.
  1214         10  REPLETRA PIC  X(0001).
  1215     05  REPLETRI PIC  X(0004).
  1216*    -------------------------------
  1217     05  AHITAXL PIC S9(0004) COMP.
  1218     05  AHITAXF PIC  X(0001).
  1219     05  FILLER REDEFINES AHITAXF.
  1220         10  AHITAXA PIC  X(0001).
  1221     05  AHITAXI PIC  S9(1)V9(4).
  1222*    -------------------------------
  1223     05  TARRATL PIC S9(0004) COMP.
  1224     05  TARRATF PIC  X(0001).
  1225     05  FILLER REDEFINES TARRATF.
  1226         10  TARRATA PIC  X(0001).
  1227     05  TARRATI PIC  S9(2)V9(4).
  1228*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  26
* EL106.cbl
  1229     05  CALCINTL PIC S9(0004) COMP.
  1230     05  CALCINTF PIC  X(0001).
  1231     05  FILLER REDEFINES CALCINTF.
  1232         10  CALCINTA PIC  X(0001).
  1233     05  CALCINTI PIC  S9(2)V9(4).
  1234*    -------------------------------
  1235     05  AHGTAXL PIC S9(0004) COMP.
  1236     05  AHGTAXF PIC  X(0001).
  1237     05  FILLER REDEFINES AHGTAXF.
  1238         10  AHGTAXA PIC  X(0001).
  1239     05  AHGTAXI PIC  S9(1)V9(4).
  1240*    -------------------------------
  1241     05  COMSLL PIC S9(0004) COMP.
  1242     05  COMSLF PIC  X(0001).
  1243     05  FILLER REDEFINES COMSLF.
  1244         10  COMSLA PIC  X(0001).
  1245     05  COMSLI PIC  S99V9(4).
  1246*    -------------------------------
  1247     05  LIMITL PIC S9(0004) COMP.
  1248     05  LIMITF PIC  X(0001).
  1249     05  FILLER REDEFINES LIMITF.
  1250         10  LIMITA PIC  X(0001).
  1251     05  LIMITI PIC  X(0001).
  1252*    -------------------------------
  1253     05  COMJLL PIC S9(0004) COMP.
  1254     05  COMJLF PIC  X(0001).
  1255     05  FILLER REDEFINES COMJLF.
  1256         10  COMJLA PIC  X(0001).
  1257     05  COMJLI PIC  S99V9(4).
  1258*    -------------------------------
  1259     05  LFREDL PIC S9(0004) COMP.
  1260     05  LFREDF PIC  X(0001).
  1261     05  FILLER REDEFINES LFREDF.
  1262         10  LFREDA PIC  X(0001).
  1263     05  LFREDI PIC  X(0001).
  1264*    -------------------------------
  1265     05  LFLEVL PIC S9(0004) COMP.
  1266     05  LFLEVF PIC  X(0001).
  1267     05  FILLER REDEFINES LFLEVF.
  1268         10  LFLEVA PIC  X(0001).
  1269     05  LFLEVI PIC  X(0001).
  1270*    -------------------------------
  1271     05  LFNETL PIC S9(0004) COMP.
  1272     05  LFNETF PIC  X(0001).
  1273     05  FILLER REDEFINES LFNETF.
  1274         10  LFNETA PIC  X(0001).
  1275     05  LFNETI PIC  X(0001).
  1276*    -------------------------------
  1277     05  COMSAL PIC S9(0004) COMP.
  1278     05  COMSAF PIC  X(0001).
  1279     05  FILLER REDEFINES COMSAF.
  1280         10  COMSAA PIC  X(0001).
  1281     05  COMSAI PIC  S99V9(4).
  1282*    -------------------------------
  1283     05  AHAHL PIC S9(0004) COMP.
  1284     05  AHAHF PIC  X(0001).
  1285     05  FILLER REDEFINES AHAHF.
  1286         10  AHAHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  27
* EL106.cbl
  1287     05  AHAHI PIC  X(0001).
  1288*    -------------------------------
  1289     05  AHCPL PIC S9(0004) COMP.
  1290     05  AHCPF PIC  X(0001).
  1291     05  FILLER REDEFINES AHCPF.
  1292         10  AHCPA PIC  X(0001).
  1293     05  AHCPI PIC  X(0001).
  1294*    -------------------------------
  1295     05  COMJAL PIC S9(0004) COMP.
  1296     05  COMJAF PIC  X(0001).
  1297     05  FILLER REDEFINES COMJAF.
  1298         10  COMJAA PIC  X(0001).
  1299     05  COMJAI PIC  S99V9(4).
  1300*    -------------------------------
  1301     05  STCHKHDL PIC S9(0004) COMP.
  1302     05  STCHKHDF PIC  X(0001).
  1303     05  FILLER REDEFINES STCHKHDF.
  1304         10  STCHKHDA PIC  X(0001).
  1305     05  STCHKHDI PIC  X(0013).
  1306*    -------------------------------
  1307     05  STCHKNOL PIC S9(0004) COMP.
  1308     05  STCHKNOF PIC  X(0001).
  1309     05  FILLER REDEFINES STCHKNOF.
  1310         10  STCHKNOA PIC  X(0001).
  1311     05  STCHKNOI PIC  9(8).
  1312*    -------------------------------
  1313     05  RESTAXL PIC S9(0004) COMP.
  1314     05  RESTAXF PIC  X(0001).
  1315     05  FILLER REDEFINES RESTAXF.
  1316         10  RESTAXA PIC  X(0001).
  1317     05  RESTAXI PIC  S99V9(4).
  1318*    -------------------------------
  1319     05  FREELKL PIC S9(0004) COMP.
  1320     05  FREELKF PIC  X(0001).
  1321     05  FILLER REDEFINES FREELKF.
  1322         10  FREELKA PIC  X(0001).
  1323     05  FREELKI PIC  X(0003).
  1324*    -------------------------------
  1325     05  REFCLML PIC S9(0004) COMP.
  1326     05  REFCLMF PIC  X(0001).
  1327     05  FILLER REDEFINES REFCLMF.
  1328         10  REFCLMA PIC  X(0001).
  1329     05  REFCLMI PIC  X(0001).
  1330*    -------------------------------
  1331     05  VFYBENEL PIC S9(0004) COMP.
  1332     05  VFYBENEF PIC  X(0001).
  1333     05  FILLER REDEFINES VFYBENEF.
  1334         10  VFYBENEA PIC  X(0001).
  1335     05  VFYBENEI PIC  X(0001).
  1336*    -------------------------------
  1337     05  ERRMSG1L PIC S9(0004) COMP.
  1338     05  ERRMSG1F PIC  X(0001).
  1339     05  FILLER REDEFINES ERRMSG1F.
  1340         10  ERRMSG1A PIC  X(0001).
  1341     05  ERRMSG1I PIC  X(0076).
  1342*    -------------------------------
  1343     05  ERRMSG2L PIC S9(0004) COMP.
  1344     05  ERRMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  28
* EL106.cbl
  1345     05  FILLER REDEFINES ERRMSG2F.
  1346         10  ERRMSG2A PIC  X(0001).
  1347     05  ERRMSG2I PIC  X(0076).
  1348*    -------------------------------
  1349     05  ENTERPFL PIC S9(0004) COMP.
  1350     05  ENTERPFF PIC  X(0001).
  1351     05  FILLER REDEFINES ENTERPFF.
  1352         10  ENTERPFA PIC  X(0001).
  1353     05  ENTERPFI PIC  9(2).
  1354 01  EL106AO REDEFINES EL106AI.
  1355     05  FILLER            PIC  X(0012).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(0003).
  1358     05  RUNDTEO PIC  X(0008).
  1359*    -------------------------------
  1360     05  FILLER            PIC  X(0003).
  1361     05  RUNTIMEO PIC  99.99.
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  MAINTO PIC  X(0001).
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  LSTUSRO PIC  X(0004).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  LSTDTEO PIC  X(0008).
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  LSTTIMEO PIC  99.99.
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  STCDO PIC  X(0002).
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(0003).
  1379     05  STABRO PIC  X(0002).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(0003).
  1382     05  STNAMEO PIC  X(0025).
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(0003).
  1385     05  LEXPLBLO PIC  X(0006).
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(0003).
  1388     05  LFEXPO PIC  99.9999.
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(0003).
  1391     05  AEXPLBLO PIC  X(0006).
  1392*    -------------------------------
  1393     05  FILLER            PIC  X(0003).
  1394     05  AHEXPO PIC  99.9999.
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(0003).
  1397     05  REMTERMO PIC  X(0001).
  1398*    -------------------------------
  1399     05  FILLER            PIC  X(0003).
  1400     05  QUOTCALO PIC  ZZ9.99.
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  29
* EL106.cbl
  1403     05  PREMTOLO PIC  ZZ9.99.
  1404*    -------------------------------
  1405     05  FILLER            PIC  X(0003).
  1406     05  REFTOLO PIC  ZZ9.99.
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(0003).
  1409     05  PRMPCTO PIC  .9999.
  1410*    -------------------------------
  1411     05  FILLER            PIC  X(0003).
  1412     05  REFPCTO PIC  .9999.
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(0003).
  1415     05  OVSAMTO PIC  ZZ9.99.
  1416*    -------------------------------
  1417     05  FILLER            PIC  X(0003).
  1418     05  OVSPCTO PIC  .9999.
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(0003).
  1421     05  CLREJECO PIC  X(0001).
  1422*    -------------------------------
  1423     05  FILLER            PIC  X(0003).
  1424     05  ISSREJO PIC  X(0001).
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(0003).
  1427     05  REFREJO PIC  X(0001).
  1428*    -------------------------------
  1429     05  FILLER            PIC  X(0003).
  1430     05  REFMINO PIC  ZZ9.99.
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  REFDAY1O PIC  99.
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  REFDAYSO PIC  99.
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  SPLPMTO PIC  X(0001).
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  STUEO PIC  X(0001).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  STCNTLO PIC  X(0001).
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
  1448     05  STDEVO PIC  X(0003).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  EXTDAYSO PIC  999.
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  EXTCHGO PIC  X(0001).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  LFTAXO PIC  .9999.
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  REPLAWO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  30
* EL106.cbl
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  REPLETRO PIC  X(0004).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  AHITAXO PIC  .9999.
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  TARRATO PIC  9.9999.
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  CALCINTO PIC  9.9999.
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  AHGTAXO PIC  .9999.
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  COMSLO PIC  9.9999.
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  LIMITO PIC  X(0001).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  COMJLO PIC  9.9999.
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  LFREDO PIC  X(0001).
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  LFLEVO PIC  X(0001).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  LFNETO PIC  X(0001).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  COMSAO PIC  9.9999.
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  AHAHO PIC  X(0001).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  AHCPO PIC  X(0001).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  COMJAO PIC  9.9999.
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  STCHKHDO PIC  X(0013).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  STCHKNOO PIC  9(8).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  RESTAXO PIC  9.9999.
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  FREELKO PIC  999.
  1518*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  31
* EL106.cbl
  1519     05  FILLER            PIC  X(0003).
  1520     05  REFCLMO PIC  X(0001).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  VFYBENEO PIC  X(0001).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  ERRMSG1O PIC  X(0076).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  ERRMSG2O PIC  X(0076).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  ENTERPFO PIC  X(0002).
  1533*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  32
* EL106.cbl
  1535****************************************************************
  1536*
  1537* Copyright (c) 2007 by Clerity Solutions, Inc.
  1538* All rights reserved.
  1539*
  1540****************************************************************
  1541 01  DFHEIV.
  1542   02  DFHEIV0               PIC X(35).
  1543   02  DFHEIV1               PIC X(08).
  1544   02  DFHEIV2               PIC X(08).
  1545   02  DFHEIV3               PIC X(08).
  1546   02  DFHEIV4               PIC X(06).
  1547   02  DFHEIV5               PIC X(04).
  1548   02  DFHEIV6               PIC X(04).
  1549   02  DFHEIV7               PIC X(02).
  1550   02  DFHEIV8               PIC X(02).
  1551   02  DFHEIV9               PIC X(01).
  1552   02  DFHEIV10              PIC S9(7) COMP-3.
  1553   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1554   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1555   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1556   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1557   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1558   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1559   02  DFHEIV17              PIC X(04).
  1560   02  DFHEIV18              PIC X(04).
  1561   02  DFHEIV19              PIC X(04).
  1562   02  DFHEIV20              USAGE IS POINTER.
  1563   02  DFHEIV21              USAGE IS POINTER.
  1564   02  DFHEIV22              USAGE IS POINTER.
  1565   02  DFHEIV23              USAGE IS POINTER.
  1566   02  DFHEIV24              USAGE IS POINTER.
  1567   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1568   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1569   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1570   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1571   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1572   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1573   02  FILLER                PIC X(02).
  1574   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1575   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1576   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1577   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1578   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1579 LINKAGE  SECTION.
  1580*****************************************************************
  1581*                                                               *
  1582* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1583* All rights reserved.                                          *
  1584*                                                               *
  1585*****************************************************************
  1586 01  dfheiblk.
  1587     02  eibtime          pic s9(7) comp-3.
  1588     02  eibdate          pic s9(7) comp-3.
  1589     02  eibtrnid         pic x(4).
  1590     02  eibtaskn         pic s9(7) comp-3.
  1591     02  eibtrmid         pic x(4).
  1592     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  33
* EL106.cbl
  1593     02  eibcposn         pic s9(4) comp.
  1594     02  eibcalen         pic s9(4) comp.
  1595     02  eibaid           pic x(1).
  1596     02  eibfiller1       pic x(1).
  1597     02  eibfn            pic x(2).
  1598     02  eibfiller2       pic x(2).
  1599     02  eibrcode         pic x(6).
  1600     02  eibfiller3       pic x(2).
  1601     02  eibds            pic x(8).
  1602     02  eibreqid         pic x(8).
  1603     02  eibrsrce         pic x(8).
  1604     02  eibsync          pic x(1).
  1605     02  eibfree          pic x(1).
  1606     02  eibrecv          pic x(1).
  1607     02  eibsend          pic x(1).
  1608     02  eibatt           pic x(1).
  1609     02  eibeoc           pic x(1).
  1610     02  eibfmh           pic x(1).
  1611     02  eibcompl         pic x(1).
  1612     02  eibsig           pic x(1).
  1613     02  eibconf          pic x(1).
  1614     02  eiberr           pic x(1).
  1615     02  eibrldbk         pic x(1).
  1616     02  eiberrcd         pic x(4).
  1617     02  eibsynrb         pic x(1).
  1618     02  eibnodat         pic x(1).
  1619     02  eibfiller5       pic x(2).
  1620     02  eibresp          pic 9(09) comp.
  1621     02  eibresp2         pic 9(09) comp.
  1622     02  dfheigdj         pic s9(4) comp.
  1623     02  dfheigdk         pic s9(4) comp.
  1624 01  DFHCOMMAREA             PIC X(1500).
  1625*01 PARMLIST .
  1626*    02  FILLER              PIC S9(8)   COMP.
  1627*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  1628*    02  ELLETR-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  34
* EL106.cbl
  1630*    COPY ELCCNTL.
  1631******************************************************************
  1632*                                                                *
  1633*                                                                *
  1634*                            ELCCNTL.                            *
  1635*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1636*                            VMOD=2.059                          *
  1637*                                                                *
  1638*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1639*                                                                *
  1640*   FILE TYPE = VSAM,KSDS                                        *
  1641*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1642*                                                                *
  1643*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1644*       ALTERNATE INDEX = NONE                                   *
  1645*                                                                *
  1646*   LOG = YES                                                    *
  1647*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1648******************************************************************
  1649*                   C H A N G E   L O G
  1650*
  1651* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1652*-----------------------------------------------------------------
  1653*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1654* EFFECTIVE    NUMBER
  1655*-----------------------------------------------------------------
  1656* 082503                   PEMA  ADD BENEFIT GROUP
  1657* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1658* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1659* 092705    2005050300006  PEMA  ADD SPP LEASES
  1660* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1661* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1662* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1663* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1664* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1665******************************************************************
  1666*
  1667 01  CONTROL-FILE.
  1668     12  CF-RECORD-ID                       PIC XX.
  1669         88  VALID-CF-ID                        VALUE 'CF'.
  1670
  1671     12  CF-CONTROL-PRIMARY.
  1672         16  CF-COMPANY-ID                  PIC XXX.
  1673         16  CF-RECORD-TYPE                 PIC X.
  1674             88  CF-COMPANY-MASTER              VALUE '1'.
  1675             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1676             88  CF-STATE-MASTER                VALUE '3'.
  1677             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1678             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1679             88  CF-CARRIER-MASTER              VALUE '6'.
  1680             88  CF-MORTALITY-MASTER            VALUE '7'.
  1681             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1682             88  CF-TERMINAL-MASTER             VALUE '9'.
  1683             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1684             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1685             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1686             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1687             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  35
* EL106.cbl
  1688             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1689             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1690             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1691             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1692         16  CF-ACCESS-CD-GENL              PIC X(4).
  1693         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1694             20  CF-PROCESSOR               PIC X(4).
  1695         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1696             20  CF-STATE-CODE              PIC XX.
  1697             20  FILLER                     PIC XX.
  1698         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1699             20  FILLER                     PIC XX.
  1700             20  CF-HI-BEN-IN-REC           PIC XX.
  1701         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1702             20  FILLER                     PIC XXX.
  1703             20  CF-CARRIER-CNTL            PIC X.
  1704         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1705             20  FILLER                     PIC XX.
  1706             20  CF-HI-TYPE-IN-REC          PIC 99.
  1707         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1708             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1709                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1710             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1711             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1712         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1713             20  FILLER                     PIC X.
  1714             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1715         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1716             20  FILLER                     PIC XX.
  1717             20  CF-MORTGAGE-PLAN           PIC XX.
  1718         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1719
  1720     12  CF-LAST-MAINT-DT                   PIC XX.
  1721     12  CF-LAST-MAINT-BY                   PIC X(4).
  1722     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1723
  1724     12  CF-RECORD-BODY                     PIC X(728).
  1725
  1726
  1727****************************************************************
  1728*             COMPANY MASTER RECORD                            *
  1729****************************************************************
  1730
  1731     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1732         16  CF-COMPANY-ADDRESS.
  1733             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1734             20  CF-CL-IN-CARE-OF           PIC X(30).
  1735             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1736             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1737             20  CF-CL-CITY-STATE           PIC X(30).
  1738             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1739             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1740         16  CF-COMPANY-CD                  PIC X.
  1741         16  CF-COMPANY-PASSWORD            PIC X(8).
  1742         16  CF-SECURITY-OPTION             PIC X.
  1743             88  ALL-SECURITY                   VALUE '1'.
  1744             88  COMPANY-VERIFY                 VALUE '2'.
  1745             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  36
* EL106.cbl
  1746             88  NO-SECURITY                    VALUE '4'.
  1747             88  ALL-BUT-TERM                   VALUE '5'.
  1748         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1749             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1750         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1751             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1752         16  CF-INFORCE-LOCATION            PIC X.
  1753             88  CERTS-ARE-ONLINE               VALUE '1'.
  1754             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1755             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1756         16  CF-LOWER-CASE-LETTERS          PIC X.
  1757         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1758             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1759             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1760             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1761             88  CF-ACCNT-CNTL                  VALUE '3'.
  1762             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1763
  1764         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1765         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1766
  1767         16  CF-LGX-CREDIT-USER             PIC X.
  1768             88  CO-IS-NOT-USER                 VALUE 'N'.
  1769             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1770
  1771         16 CF-CREDIT-CALC-CODES.
  1772             20  CF-CR-REM-TERM-CALC PIC X.
  1773               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1774               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1775               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1776               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1777               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1778               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1779               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1780             20  CF-CR-R78-METHOD           PIC X.
  1781               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1782               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1783
  1784         16  CF-CLAIM-CONTROL-COUNTS.
  1785             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1786                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1787
  1788             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1789                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1790
  1791             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1792                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1793
  1794             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1795                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1796
  1797         16  CF-CURRENT-MONTH-END           PIC XX.
  1798
  1799         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1800             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1801             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1802             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1803             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  37
* EL106.cbl
  1804                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1805                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1806             20  CF-CO-PREM-REJECT-SW       PIC X.
  1807                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1808                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1809             20  CF-CO-REF-REJECT-SW        PIC X.
  1810                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1811                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1812
  1813         16  CF-CO-REPORTING-DT             PIC XX.
  1814         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1815         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1816           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1817           88  CF-CO-MONTH-END                  VALUE '1'.
  1818
  1819         16  CF-LGX-CLAIM-USER              PIC X.
  1820             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1821             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1822
  1823         16  CF-CREDIT-EDIT-CONTROLS.
  1824             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1825             20  CF-MIN-AGE                 PIC 99.
  1826             20  CF-DEFAULT-AGE             PIC 99.
  1827             20  CF-MIN-TERM                PIC S999      COMP-3.
  1828             20  CF-MAX-TERM                PIC S999      COMP-3.
  1829             20  CF-DEFAULT-SEX             PIC X.
  1830             20  CF-JOINT-AGE-INPUT         PIC X.
  1831                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1832             20  CF-BIRTH-DATE-INPUT        PIC X.
  1833                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1834             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1835                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1836                 88  CF-ZERO-CARRIER            VALUE '1'.
  1837                 88  CF-ZERO-GROUPING           VALUE '2'.
  1838                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1839             20  CF-EDIT-SW                 PIC X.
  1840                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1841             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1842             20  CF-CR-PR-METHOD            PIC X.
  1843               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1844               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1845             20  FILLER                     PIC X.
  1846
  1847         16  CF-CREDIT-MISC-CONTROLS.
  1848             20  CF-REIN-TABLE-SW           PIC X.
  1849                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1850             20  CF-COMP-TABLE-SW           PIC X.
  1851                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1852             20  CF-EXPERIENCE-RETENTION-AGE
  1853                                            PIC S9        COMP-3.
  1854             20  CF-CONVERSION-DT           PIC XX.
  1855             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1856             20  CF-RUN-FREQUENCY-SW        PIC X.
  1857                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1858                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1859
  1860             20  CF-CR-CHECK-NO-CONTROL.
  1861                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  38
* EL106.cbl
  1862                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1863                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1864                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1865                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1866                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1867
  1868                 24  CF-CR-CHECK-COUNT       REDEFINES
  1869                     CF-CR-CHECK-COUNTER      PIC X(4).
  1870
  1871                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1872                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1873
  1874                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1875                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1876                 24  CF-MAIL-PROCESSING       PIC X.
  1877                     88  MAIL-PROCESSING          VALUE 'Y'.
  1878
  1879         16  CF-MISC-SYSTEM-CONTROL.
  1880             20  CF-SYSTEM-C                 PIC X.
  1881                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1882             20  CF-SYSTEM-D                 PIC X.
  1883                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1884             20  CF-SOC-SEC-NO-SW            PIC X.
  1885                 88  SOC-SEC-NO-USED             VALUE '1'.
  1886             20  CF-MEMBER-NO-SW             PIC X.
  1887                 88  MEMBER-NO-USED              VALUE '1'.
  1888             20  CF-TAX-ID-NUMBER            PIC X(11).
  1889             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1890             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1891                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1892                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1893                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1894                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1895             20  CF-SYSTEM-E                 PIC X.
  1896                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1897
  1898         16  CF-LGX-LIFE-USER               PIC X.
  1899             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1900             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1901
  1902         16  CF-CR-MONTH-END-DT             PIC XX.
  1903
  1904         16  CF-FILE-MAINT-DATES.
  1905             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1906                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1907             20  CF-LAST-BATCH       REDEFINES
  1908                 CF-LAST-BATCH-NO               PIC X(4).
  1909             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1910             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1911             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1912             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1913             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1914             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1915             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1916             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1917             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1918             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1919
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  39
* EL106.cbl
  1920         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1921         16  FILLER                         PIC X.
  1922
  1923         16  CF-ALT-MORT-CODE               PIC X(4).
  1924         16  CF-MEMBER-CAPTION              PIC X(10).
  1925
  1926         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1927             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1928             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1929             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1930             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1931             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1932
  1933         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1934
  1935         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1936         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1937         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1938         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1939
  1940         16  CF-AH-OVERRIDE-L1              PIC X.
  1941         16  CF-AH-OVERRIDE-L2              PIC XX.
  1942         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1943         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1944
  1945         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1946         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1947
  1948         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1949         16  CF-AR-LAST-EL860-DT            PIC XX.
  1950         16  CF-MP-MONTH-END-DT             PIC XX.
  1951
  1952         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1953         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1954             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1955
  1956         16  CF-AR-MONTH-END-DT             PIC XX.
  1957
  1958         16  CF-CRDTCRD-USER                PIC X.
  1959             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1960             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1961
  1962         16  CF-CC-MONTH-END-DT             PIC XX.
  1963
  1964         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1965
  1966         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1967             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1968             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1969             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1970         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1971         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1972         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1973         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1974             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1975             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1976         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1977         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  40
* EL106.cbl
  1978         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1979             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1980         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1981
  1982         16  CF-CL-ZIP-CODE.
  1983             20  CF-CL-ZIP-PRIME.
  1984                 24  CF-CL-ZIP-1ST          PIC X.
  1985                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1986                 24  FILLER                 PIC X(4).
  1987             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1988         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1989             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1990             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1991             20  FILLER                     PIC XXX.
  1992
  1993         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1994         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1995         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1996         16  CF-CO-OPTION-START-DATE        PIC XX.
  1997         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1998           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1999                                                      '3' '4'.
  2000           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2001           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2002           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2003           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2004           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2005           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2006
  2007         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2008
  2009         16  CF-PAYMENT-APPROVAL-LEVELS.
  2010             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2011             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2012             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2013             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2014             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2015             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2016
  2017         16  CF-END-USER-REPORTING-USER     PIC X.
  2018             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2019             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2020
  2021         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2022             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2023             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2024
  2025         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2026
  2027         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2028         16  FILLER                         PIC X.
  2029
  2030         16  CF-CREDIT-ARCHIVE-CNTL.
  2031             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2032             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2033             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2034
  2035         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  41
* EL106.cbl
  2036
  2037         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2038             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2039             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2040
  2041         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2042             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2043             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2044
  2045         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2046
  2047         16  CF-CO-ACH-ID-CODE              PIC  X.
  2048             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2049             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2050             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2051         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2052         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2053         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2054         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2055         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2056         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2057         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2058         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2059         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2060                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2061         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2062                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2063
  2064         16  CF-CO-OVER-SHORT.
  2065             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2066             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2067
  2068*         16  FILLER                         PIC X(102).
  2069         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2070             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2071             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2072
  2073         16  CF-AH-APPROVAL-DAYS.
  2074             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2075             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2076             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2077             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2078
  2079         16  FILLER                         PIC X(82).
  2080****************************************************************
  2081*             PROCESSOR/USER RECORD                            *
  2082****************************************************************
  2083
  2084     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2085         16  CF-PROCESSOR-NAME              PIC X(30).
  2086         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2087         16  CF-PROCESSOR-TITLE             PIC X(26).
  2088         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2089                 88  MESSAGE-YES                VALUE 'Y'.
  2090                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2091
  2092*****************************************************
  2093****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  42
* EL106.cbl
  2094****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2095****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2096****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2097*****************************************************
  2098
  2099         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2100             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2101             20  CF-APPLICATION-FORCE       PIC X.
  2102             20  CF-INDIVIDUAL-APP.
  2103                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2104                     28  CF-BROWSE-APP      PIC X.
  2105                     28  CF-UPDATE-APP      PIC X.
  2106
  2107         16  CF-CURRENT-TERM-ON             PIC X(4).
  2108         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2109             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2110             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2111             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2112             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2113             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2114             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2115             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2116         16  CF-PROCESSOR-CARRIER           PIC X.
  2117             88  NO-CARRIER-SECURITY            VALUE ' '.
  2118         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2119             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2120         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2121             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2122         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2123             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2124
  2125         16  CF-PROC-SYS-ACCESS-SW.
  2126             20  CF-PROC-CREDIT-CLAIMS-SW.
  2127                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2128                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2129                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2130                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2131             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2132                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2133                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2134             20  CF-PROC-LIFE-GNRLDGR-SW.
  2135                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2136                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2137                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2138                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2139             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2140                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2141                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2142         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2143             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2144             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2145         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2146
  2147         16  CF-APPROVAL-LEVEL                  PIC X.
  2148             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2149             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2150             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2151             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  43
* EL106.cbl
  2152
  2153         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2154
  2155         16  CF-LANGUAGE-TYPE                   PIC X.
  2156             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2157             88  CF-LANG-IS-FR                      VALUE 'F'.
  2158         16  FILLER                             PIC  X(240).
  2159
  2160****************************************************************
  2161*             PROCESSOR/REMINDERS RECORD                       *
  2162****************************************************************
  2163
  2164     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2165         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2166             20  CF-START-REMIND-DT         PIC XX.
  2167             20  CF-END-REMIND-DT           PIC XX.
  2168             20  CF-REMINDER-TEXT           PIC X(50).
  2169         16  FILLER                         PIC X(296).
  2170
  2171
  2172****************************************************************
  2173*             STATE MASTER RECORD                              *
  2174****************************************************************
  2175
  2176     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2177         16  CF-STATE-ABBREVIATION          PIC XX.
  2178         16  CF-STATE-NAME                  PIC X(25).
  2179         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2180         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2181             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2182             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2183             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2184             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2185                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2186                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2187             20  CF-ST-PREM-REJECT-SW       PIC X.
  2188                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2189                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2190             20  CF-ST-REF-REJECT-SW        PIC X.
  2191                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2192                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2193         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2194         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2195         16  CF-ST-REFUND-RULES.
  2196             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2197             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2198             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2199         16  CF-ST-FST-PMT-EXTENSION.
  2200             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2201             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2202                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2203                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2204                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2205                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2206         16  CF-ST-STATE-CALL.
  2207             20  CF-ST-CALL-UNEARNED        PIC X.
  2208             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2209             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  44
* EL106.cbl
  2210         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2211             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2212             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2213         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2214         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2215         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2216         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2217         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2218         16  FILLER                         PIC X.
  2219         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2220             20  CF-ST-BENEFIT-CD           PIC XX.
  2221             20  CF-ST-BENEFIT-KIND         PIC X.
  2222                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2223                 88  CF-ST-AH-KIND              VALUE 'A'.
  2224             20  CF-ST-REM-TERM-CALC        PIC X.
  2225                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2226                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2227                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2228                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2229                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2230                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2231                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2232                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2233
  2234             20  CF-ST-REFUND-CALC          PIC X.
  2235                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2236                 88  ST-REFD-BY-R78             VALUE '1'.
  2237                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2238                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2239                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2240                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2241                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2242                 88  ST-REFD-UTAH               VALUE '7'.
  2243                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2244                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2245                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2246
  2247             20  CF-ST-EARNING-CALC         PIC X.
  2248                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2249                 88  ST-EARN-BY-R78             VALUE '1'.
  2250                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2251                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2252                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2253                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2254                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2255                 88  ST-EARN-MEAN               VALUE '8'.
  2256                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2257
  2258             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2259                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2260                 88  ST-OVRD-BY-R78             VALUE '1'.
  2261                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2262                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2263                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2264                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2265                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2266                 88  ST-OVRD-MEAN               VALUE '8'.
  2267                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  45
* EL106.cbl
  2268             20  FILLER                     PIC X.
  2269
  2270         16  CF-ST-COMMISSION-CAPS.
  2271             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2272             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2273             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2274             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2275         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2276                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2277
  2278         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2279
  2280         16  CF-ST-STATUTORY-INTEREST.
  2281             20  CF-ST-STAT-DATE-FROM       PIC X.
  2282                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2283                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2284             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2285             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2286             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2287             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2288             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2289
  2290         16  CF-ST-OVER-SHORT.
  2291             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2292             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2293
  2294         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2295
  2296         16  CF-ST-RT-CALC                  PIC X.
  2297
  2298         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2299         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2300         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2301         16  CF-ST-RF-LR-CALC               PIC X.
  2302         16  CF-ST-RF-LL-CALC               PIC X.
  2303         16  CF-ST-RF-LN-CALC               PIC X.
  2304         16  CF-ST-RF-AH-CALC               PIC X.
  2305         16  CF-ST-RF-CP-CALC               PIC X.
  2306*        16  FILLER                         PIC X(206).
  2307*CIDMOD         16  FILLER                         PIC X(192).
  2308         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2309             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2310         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2311         16  CF-ST-VFY-2ND-BENE             PIC X.
  2312         16  FILLER                         PIC X(186).
  2313
  2314****************************************************************
  2315*             BENEFIT MASTER RECORD                            *
  2316****************************************************************
  2317
  2318     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2319         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2320             20  CF-BENEFIT-CODE            PIC XX.
  2321             20  CF-BENEFIT-NUMERIC  REDEFINES
  2322                 CF-BENEFIT-CODE            PIC XX.
  2323             20  CF-BENEFIT-ALPHA           PIC XXX.
  2324             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2325             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  46
* EL106.cbl
  2326
  2327             20  CF-LF-COVERAGE-TYPE        PIC X.
  2328                 88  CF-REDUCING                VALUE 'R'.
  2329                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2330
  2331             20  CF-SPECIAL-CALC-CD         PIC X.
  2332                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2333                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2334                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2335                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2336                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2337                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2338                 88  CF-FARM-PLAN               VALUE 'F'.
  2339                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2340                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2341                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2342                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2343                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2344                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2345                 88  CF-PRUDENTIAL              VALUE 'P'.
  2346                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2347                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2348                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2349                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2350                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2351                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2352
  2353             20  CF-JOINT-INDICATOR         PIC X.
  2354                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2355
  2356*            20  FILLER                     PIC X(12).
  2357             20  FILLER                     PIC X(11).
  2358             20  CF-BENEFIT-CATEGORY        PIC X.
  2359             20  CF-LOAN-TYPE               PIC X(8).
  2360
  2361             20  CF-CO-REM-TERM-CALC        PIC X.
  2362                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2363                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2364                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2365                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2366                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2367
  2368             20  CF-CO-EARNINGS-CALC        PIC X.
  2369                 88  CO-EARN-BY-R78             VALUE '1'.
  2370                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2371                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2372                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2373                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2374                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2375                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2376                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2377
  2378             20  CF-CO-REFUND-CALC          PIC X.
  2379                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2380                 88  CO-REFD-BY-R78             VALUE '1'.
  2381                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2382                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2383                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  47
* EL106.cbl
  2384                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2385                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2386                 88  CO-REFD-MEAN               VALUE '8'.
  2387                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2388                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2389                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2390
  2391             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2392                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2393                 88  CO-OVRD-BY-R78             VALUE '1'.
  2394                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2395                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2396                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2397                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2398                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2399                 88  CO-OVRD-MEAN               VALUE '8'.
  2400                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2401
  2402             20  CF-CO-BEN-I-G-CD           PIC X.
  2403                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2404                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2405                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2406
  2407         16  FILLER                         PIC X(304).
  2408
  2409
  2410****************************************************************
  2411*             CARRIER MASTER RECORD                            *
  2412****************************************************************
  2413
  2414     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2415         16  CF-ADDRESS-DATA.
  2416             20  CF-MAIL-TO-NAME            PIC X(30).
  2417             20  CF-IN-CARE-OF              PIC X(30).
  2418             20  CF-ADDRESS-LINE-1          PIC X(30).
  2419             20  CF-ADDRESS-LINE-2          PIC X(30).
  2420             20  CF-CITY-STATE              PIC X(30).
  2421             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2422             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2423
  2424         16  CF-CLAIM-NO-CONTROL.
  2425             20  CF-CLAIM-NO-METHOD         PIC X.
  2426                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2427                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2428                 88  CLAIM-NO-SEQ               VALUE '3'.
  2429                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2430             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2431                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2432                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2433                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2434
  2435         16  CF-CHECK-NO-CONTROL.
  2436             20  CF-CHECK-NO-METHOD         PIC X.
  2437                 88  CHECK-NO-MANUAL            VALUE '1'.
  2438                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2439                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2440                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2441             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  48
* EL106.cbl
  2442                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2443
  2444         16  CF-DOMICILE-STATE              PIC XX.
  2445
  2446         16  CF-EXPENSE-CONTROLS.
  2447             20  CF-EXPENSE-METHOD          PIC X.
  2448                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2449                 88  DOLLARS-PER-PMT            VALUE '2'.
  2450                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2451                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2452             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2453             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2454
  2455         16  CF-CORRESPONDENCE-CONTROL.
  2456             20  CF-LETTER-RESEND-OPT       PIC X.
  2457                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2458                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2459             20  FILLER                     PIC X(4).
  2460
  2461         16  CF-RESERVE-CONTROLS.
  2462             20  CF-MANUAL-SW               PIC X.
  2463                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2464             20  CF-FUTURE-SW               PIC X.
  2465                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2466             20  CF-PTC-SW                  PIC X.
  2467                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2468             20  CF-IBNR-SW                 PIC X.
  2469                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2470             20  CF-PTC-LF-SW               PIC X.
  2471                 88  CF-LF-PTC-USED             VALUE '1'.
  2472             20  CF-CDT-ACCESS-METHOD       PIC X.
  2473                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2474                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2475                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2476             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2477
  2478         16  CF-CLAIM-CALC-METHOD           PIC X.
  2479             88  360-PLUS-MONTHS                VALUE '1'.
  2480             88  365-PLUS-MONTHS                VALUE '2'.
  2481             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2482             88  360-DAILY                      VALUE '4'.
  2483             88  365-DAILY                      VALUE '5'.
  2484
  2485         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2486         16  FILLER                         PIC X(11).
  2487
  2488         16  CF-LIMIT-AMOUNTS.
  2489             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2490             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2491             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2492             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2493             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2494             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2495             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2496             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2497             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2498             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2499
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  49
* EL106.cbl
  2500         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2501         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2502         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2503
  2504         16  CF-ZIP-CODE.
  2505             20  CF-ZIP-PRIME.
  2506                 24  CF-ZIP-1ST             PIC X.
  2507                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2508                 24  FILLER                 PIC X(4).
  2509             20  CF-ZIP-PLUS4               PIC X(4).
  2510         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2511             20  CF-CAN-POSTAL-1            PIC XXX.
  2512             20  CF-CAN-POSTAL-2            PIC XXX.
  2513             20  FILLER                     PIC XXX.
  2514
  2515         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2516         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2517         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2518
  2519         16  CF-RATING-SWITCH               PIC X.
  2520             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2521             88  CF-NO-RATING                   VALUE 'N'.
  2522
  2523         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2524
  2525         16  CF-CARRIER-OVER-SHORT.
  2526             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2527             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2528
  2529         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2530         16  CF-SECPAY-SWITCH               PIC X.
  2531             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2532             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2533         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2534         16  FILLER                         PIC X(448).
  2535*        16  FILLER                         PIC X(452).
  2536
  2537
  2538****************************************************************
  2539*             MORTALITY MASTER RECORD                          *
  2540****************************************************************
  2541
  2542     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2543         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2544                                INDEXED BY CF-MORT-NDX.
  2545             20  CF-MORT-TABLE              PIC X(5).
  2546             20  CF-MORT-TABLE-TYPE         PIC X.
  2547                 88  CF-MORT-JOINT              VALUE 'J'.
  2548                 88  CF-MORT-SINGLE             VALUE 'S'.
  2549                 88  CF-MORT-COMBINED           VALUE 'C'.
  2550                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2551                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2552             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2553             20  CF-MORT-AGE-METHOD         PIC XX.
  2554                 88  CF-AGE-LAST                VALUE 'AL'.
  2555                 88  CF-AGE-NEAR                VALUE 'AN'.
  2556             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2557             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  50
* EL106.cbl
  2558                                            PIC X.
  2559                 88  CF-MINUS                   VALUE '-'.
  2560                 88  CF-PLUS                    VALUE '+'.
  2561             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2562             20  CF-MORT-JOINT-CODE         PIC X.
  2563                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2564             20  CF-MORT-PC-Q               PIC X.
  2565                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2566             20  CF-MORT-TABLE-CODE         PIC X(4).
  2567             20  CF-MORT-COMMENTS           PIC X(15).
  2568             20  FILLER                     PIC X(14).
  2569
  2570         16  FILLER                         PIC X(251).
  2571
  2572
  2573****************************************************************
  2574*             BUSSINESS TYPE MASTER RECORD                     *
  2575****************************************************************
  2576
  2577     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2578* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2579* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2580* AND RECORD 05 IS TYPES 81-99
  2581         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2582             20  CF-BUSINESS-TITLE          PIC  X(19).
  2583             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2584                                            PIC S9V9(4) COMP-3.
  2585             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2586             20  FILLER                     PIC  X.
  2587         16  FILLER                         PIC  X(248).
  2588
  2589
  2590****************************************************************
  2591*             TERMINAL MASTER RECORD                           *
  2592****************************************************************
  2593
  2594     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2595
  2596         16  CF-COMPANY-TERMINALS.
  2597             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2598                                  PIC X(4).
  2599         16  FILLER               PIC X(248).
  2600
  2601
  2602****************************************************************
  2603*             LIFE EDIT MASTER RECORD                          *
  2604****************************************************************
  2605
  2606     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2607         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2608             20  CF-LIFE-CODE-IN            PIC XX.
  2609             20  CF-LIFE-CODE-OUT           PIC XX.
  2610         16  FILLER                         PIC X(248).
  2611
  2612
  2613****************************************************************
  2614*             AH EDIT MASTER RECORD                            *
  2615****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  51
* EL106.cbl
  2616
  2617     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2618         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2619             20  CF-AH-CODE-IN              PIC XXX.
  2620             20  CF-AH-CODE-OUT             PIC XX.
  2621         16  FILLER                         PIC X(248).
  2622
  2623
  2624****************************************************************
  2625*             CREDIBILITY TABLES                               *
  2626****************************************************************
  2627
  2628     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2629         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2630                             INDEXED BY CF-CRDB-NDX.
  2631             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2632             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2633             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2634         16  FILLER                         PIC  X(332).
  2635
  2636
  2637****************************************************************
  2638*             REPORT CUSTOMIZATION RECORD                      *
  2639****************************************************************
  2640
  2641     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2642         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2643             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2644             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2645             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2646**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2647****       A T-TRANSFER.                                   ****
  2648             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2649
  2650         16  FILLER                         PIC XX.
  2651
  2652         16  CF-CARRIER-CNTL-OPT.
  2653             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2654                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2655                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2656             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2657                                            PIC X.
  2658         16  CF-GROUP-CNTL-OPT.
  2659             20  CF-GROUP-OPT-SEQ           PIC 9.
  2660                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2661                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2662             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2663                                            PIC X(6).
  2664         16  CF-STATE-CNTL-OPT.
  2665             20  CF-STATE-OPT-SEQ           PIC 9.
  2666                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2667                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2668             20  CF-STATE-SELECT OCCURS 3 TIMES
  2669                                            PIC XX.
  2670         16  CF-ACCOUNT-CNTL-OPT.
  2671             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2672                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2673                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  52
* EL106.cbl
  2674             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2675                                            PIC X(10).
  2676         16  CF-BUS-TYP-CNTL-OPT.
  2677             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2678                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2679                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2680             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2681                                            PIC XX.
  2682         16  CF-LF-TYP-CNTL-OPT.
  2683             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2684                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2685                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2686             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2687                                            PIC XX.
  2688         16  CF-AH-TYP-CNTL-OPT.
  2689             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2690                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2691                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2692             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2693                                            PIC XX.
  2694         16  CF-REPTCD1-CNTL-OPT.
  2695             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2696                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2697                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2698             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2699                                            PIC X(10).
  2700         16  CF-REPTCD2-CNTL-OPT.
  2701             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2702                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2703                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2704             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2705                                            PIC X(10).
  2706         16  CF-USER1-CNTL-OPT.
  2707             20  CF-USER1-OPT-SEQ           PIC 9.
  2708                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2709                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2710             20  CF-USER1-SELECT OCCURS 3 TIMES
  2711                                            PIC X(10).
  2712         16  CF-USER2-CNTL-OPT.
  2713             20  CF-USER2-OPT-SEQ           PIC 9.
  2714                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2715                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2716             20  CF-USER2-SELECT OCCURS 3 TIMES
  2717                                            PIC X(10).
  2718         16  CF-USER3-CNTL-OPT.
  2719             20  CF-USER3-OPT-SEQ           PIC 9.
  2720                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2721                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2722             20  CF-USER3-SELECT OCCURS 3 TIMES
  2723                                            PIC X(10).
  2724         16  CF-USER4-CNTL-OPT.
  2725             20  CF-USER4-OPT-SEQ           PIC 9.
  2726                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2727                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2728             20  CF-USER4-SELECT OCCURS 3 TIMES
  2729                                            PIC X(10).
  2730         16  CF-USER5-CNTL-OPT.
  2731             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  53
* EL106.cbl
  2732                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2733                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2734             20  CF-USER5-SELECT OCCURS 3 TIMES
  2735                                            PIC X(10).
  2736         16  CF-REINS-CNTL-OPT.
  2737             20  CF-REINS-OPT-SEQ           PIC 9.
  2738                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2739                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2740             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2741                 24  CF-REINS-PRIME         PIC XXX.
  2742                 24  CF-REINS-SUB           PIC XXX.
  2743
  2744         16  CF-AGENT-CNTL-OPT.
  2745             20  CF-AGENT-OPT-SEQ           PIC 9.
  2746                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2747                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2748             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2749                                            PIC X(10).
  2750
  2751         16  FILLER                         PIC X(43).
  2752
  2753         16  CF-LOSS-RATIO-SELECT.
  2754             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2755             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2756         16  CF-ENTRY-DATE-SELECT.
  2757             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2758             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2759         16  CF-EFFECTIVE-DATE-SELECT.
  2760             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2761             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2762
  2763         16  CF-EXCEPTION-LIST-IND          PIC X.
  2764             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2765
  2766         16  FILLER                         PIC X(318).
  2767
  2768****************************************************************
  2769*                  EXCEPTION REPORTING RECORD                  *
  2770****************************************************************
  2771
  2772     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2773         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2774             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2775
  2776         16  CF-COMBINED-LIFE-AH-OPT.
  2777             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2778             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2779             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2780             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2781
  2782         16  CF-LIFE-OPT.
  2783             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2784             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2785             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2786             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2787             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2788             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2789             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  54
* EL106.cbl
  2790             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2791             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2792             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2793
  2794         16  CF-AH-OPT.
  2795             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2796             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2797             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2798             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2799             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2800             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2801             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2802             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2803             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2804             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2805
  2806         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2807             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2808             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2809             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2810
  2811         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2812
  2813         16  FILLER                         PIC X(673).
  2814
  2815
  2816****************************************************************
  2817*             MORTGAGE SYSTEM PLAN RECORD                      *
  2818****************************************************************
  2819
  2820     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2821         16  CF-PLAN-TYPE                   PIC X.
  2822             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2823             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2824             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2825         16  CF-PLAN-ABBREV                 PIC XXX.
  2826         16  CF-PLAN-DESCRIPT               PIC X(10).
  2827         16  CF-PLAN-NOTES                  PIC X(20).
  2828         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2829         16  CF-PLAN-UNDERWRITING.
  2830             20  CF-PLAN-TERM-DATA.
  2831                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2832                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2833             20  CF-PLAN-AGE-DATA.
  2834                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2835                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2836                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2837             20  CF-PLAN-BENEFIT-DATA.
  2838                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2839                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2840                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2841                                            PIC S9(7)V99  COMP-3.
  2842         16  CF-PLAN-POLICY-FORMS.
  2843             20  CF-POLICY-FORM             PIC X(12).
  2844             20  CF-MASTER-APPLICATION      PIC X(12).
  2845             20  CF-MASTER-POLICY           PIC X(12).
  2846         16  CF-PLAN-RATING.
  2847             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  55
* EL106.cbl
  2848             20  CF-SEX-RATING              PIC X.
  2849                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2850                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2851             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2852             20  CF-SUB-STD-TYPE            PIC X.
  2853                 88  CF-PCT-OF-PREM            VALUE '1'.
  2854                 88  CF-PCT-OF-BENE            VALUE '2'.
  2855         16  CF-PLAN-PREM-TOLERANCES.
  2856             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2857             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2858         16  CF-PLAN-PYMT-TOLERANCES.
  2859             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2860             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2861         16  CF-PLAN-MISC-DATA.
  2862             20  FILLER                     PIC X.
  2863             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2864             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2865         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2866         16  CF-PLAN-IND-GRP                PIC X.
  2867             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2868                                                     '1'.
  2869             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2870                                                     '2'.
  2871         16  CF-MIB-SEARCH-SW               PIC X.
  2872             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2873             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2874             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2875             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2876         16  CF-ALPHA-SEARCH-SW             PIC X.
  2877             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2878             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2879             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2880             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2881             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2882             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2883             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2884             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2885             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2886             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2887                                                     'A' 'B' 'C'
  2888                                                     'X' 'Y' 'Z'.
  2889         16  CF-EFF-DT-RULE-SW              PIC X.
  2890             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2891             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2892             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2893             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2894             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2895         16  FILLER                         PIC X(4).
  2896         16  CF-HEALTH-QUESTIONS            PIC X.
  2897             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2898         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2899         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2900         16  CF-PLAN-SNGL-JNT               PIC X.
  2901             88  CF-COMBINED-PLAN              VALUE 'C'.
  2902             88  CF-JNT-PLAN                   VALUE 'J'.
  2903             88  CF-SNGL-PLAN                  VALUE 'S'.
  2904         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2905         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  56
* EL106.cbl
  2906         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2907         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2908         16  CF-RERATE-CNTL                 PIC  X.
  2909             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2910             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2911             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2912             88  CF-AUTO-RECALC                 VALUE '4'.
  2913         16  CF-BENEFIT-TYPE                PIC  X.
  2914             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2915             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2916         16  CF-POLICY-FEE                  PIC S999V99
  2917                                                    COMP-3.
  2918         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2919         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2920         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2921         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2922         16  FILLER                         PIC  X(32).
  2923         16  CF-TERMINATION-FORM            PIC  X(04).
  2924         16  FILLER                         PIC  X(08).
  2925         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2926                                                       COMP-3.
  2927         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2928         16  CF-ISSUE-LETTER                PIC  X(4).
  2929         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2930         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2931             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2932             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2933         16  CF-MP-REFUND-CALC              PIC X.
  2934             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2935             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2936             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2937             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2938             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2939             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2940             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2941             88  CF-MP-REFD-MEAN                VALUE '8'.
  2942         16  CF-ALT-RATE-CODE               PIC  X(5).
  2943
  2944
  2945         16  FILLER                         PIC X(498).
  2946****************************************************************
  2947*             MORTGAGE COMPANY MASTER RECORD                   *
  2948****************************************************************
  2949
  2950     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2951         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2952         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2953             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2954             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2955             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2956             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2957             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2958
  2959         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2960         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2961         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2962         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2963         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  57
* EL106.cbl
  2964
  2965         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2966             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2967         16  CF-MP-RECON-USE-IND            PIC X(1).
  2968             88  CF-MP-USE-RECON             VALUE 'Y'.
  2969         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2970             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2971         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2972             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2973             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2974         16  FILLER                         PIC X(1).
  2975         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2976             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2977         16  CF-MORTG-MIB-VERSION           PIC X.
  2978             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2979             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2980             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2981         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2982             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2983                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2984             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2985                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2986             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2987                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2988             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2989                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2990             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2991                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2992             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2993                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2994         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2995         16  FILLER                         PIC X(7).
  2996         16  CF-MORTG-DESTINATION-SYMBOL.
  2997             20  CF-MORTG-MIB-COMM          PIC X(5).
  2998             20  CF-MORTG-MIB-TERM          PIC X(5).
  2999         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3000             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3001         16  FILLER                         PIC X(03).
  3002         16  CF-MP-CHECK-NO-CONTROL.
  3003             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3004                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3005                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3006                                                ' ' LOW-VALUES.
  3007                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3008                                               VALUE '3'.
  3009         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3010         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3011         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3012             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3013                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3014             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3015                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3016             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3017                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3018             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3019                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3020             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3021                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  58
* EL106.cbl
  3022             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3023                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3024         16  CF-MORTG-BILLING-AREA.
  3025             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3026                                            PIC X.
  3027         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3028         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3029         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3030         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3031             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3032             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3033         16  FILLER                         PIC X.
  3034         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3035             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3036             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3037         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3038         16  FILLER                         PIC X(8).
  3039         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3040         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3041         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3042         16  CF-ACH-COMPANY-ID.
  3043             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3044                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3045                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3046                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3047             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3048         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3049             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3050         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3051             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3052             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3053         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3054         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3055         16  FILLER                         PIC X(536).
  3056
  3057****************************************************************
  3058*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3059****************************************************************
  3060
  3061     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3062         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3063             20  CF-FEMALE-HEIGHT.
  3064                 24  CF-FEMALE-FT           PIC 99.
  3065                 24  CF-FEMALE-IN           PIC 99.
  3066             20  CF-FEMALE-MIN-WT           PIC 999.
  3067             20  CF-FEMALE-MAX-WT           PIC 999.
  3068         16  FILLER                         PIC X(428).
  3069
  3070     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3071         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3072             20  CF-MALE-HEIGHT.
  3073                 24  CF-MALE-FT             PIC 99.
  3074                 24  CF-MALE-IN             PIC 99.
  3075             20  CF-MALE-MIN-WT             PIC 999.
  3076             20  CF-MALE-MAX-WT             PIC 999.
  3077         16  FILLER                         PIC X(428).
  3078******************************************************************
  3079*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  59
* EL106.cbl
  3080******************************************************************
  3081     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3082         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3083             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3084             20  CF-SYS-LETTER-ID           PIC X(04).
  3085             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3086             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3087             20  CF-SYS-RESET-SW            PIC X(01).
  3088             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3089             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3090
  3091         16  FILLER                         PIC X(50).
  3092
  3093         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3094             20  CF-USER-ACTIVE-SW          PIC X(01).
  3095             20  CF-USER-LETTER-ID          PIC X(04).
  3096             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3097             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3098             20  CF-USER-RESET-SW           PIC X(01).
  3099             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3100             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3101             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3102
  3103         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  60
* EL106.cbl
  3105*    COPY ELCTEXT.
  3106******************************************************************
  3107*                                                                *
  3108*                                                                *
  3109*                            ELCTEXT.                            *
  3110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3111*                            VMOD=2.008                          *
  3112*                                                                *
  3113*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  3114*                                     FORM LETTERS,              *
  3115*                                     CERT FORM DISPLAY.
  3116*                                                                *
  3117*   FILE TYPE = VSAM,KSDS                                        *
  3118*   RECORD SIZE = 100   RECFORM = FIXED                          *
  3119*                                                                *
  3120*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  3121*       ALTERNATE INDEX = NONE                                   *
  3122*                                                                *
  3123*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  3124*       ALTERNATE INDEX = NONE                                   *
  3125*                                                                *
  3126*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  3127*       ALTERNATE INDEX = NONE                                   *
  3128*                                                                *
  3129*   LOG = NO                                                     *
  3130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3131******************************************************************
  3132 01  TEXT-FILES.
  3133     12  TEXT-FILE-ID                PIC XX.
  3134         88  FORMS-FILE-TEXT            VALUE 'TF'.
  3135         88  LETTER-FILE-TEXT           VALUE 'TL'.
  3136         88  HELP-FILE-TEXT             VALUE 'TH'.
  3137
  3138     12  TX-CONTROL-PRIMARY.
  3139         16  TX-COMPANY-CD           PIC X.
  3140             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  3141         16  TX-ACCESS-CD-GENL       PIC X(12).
  3142
  3143         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3144             20  TX-LETTER-NO        PIC X(4).
  3145             20  FILLER              PIC X(8).
  3146
  3147         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3148             20  TX-FORM-NO          PIC X(12).
  3149
  3150         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  3151             20  TX-HELP-TYPE        PIC X.
  3152                 88  HELP-FOR-GENERAL   VALUE ' '.
  3153                 88  HELP-BY-SCREEN     VALUE 'S'.
  3154                 88  HELP-BY-ERROR      VALUE 'E'.
  3155             20  TX-SCREEN-OR-ERROR  PIC X(4).
  3156                 88  GENERAL-INFO-HELP  VALUE '0000'.
  3157             20  TX-HELP-FOR-COMPANY  PIC XXX.
  3158                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  3159             20  FILLER              PIC X(4).
  3160
  3161         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  3162
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  61
* EL106.cbl
  3163     12  TX-PROCESS-CONTROL          PIC XX.
  3164         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  3165
  3166     12  TX-TEXT-LINE                PIC X(70).
  3167
  3168     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  3169         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  3170         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  3171         88  TX-VALID-FORM-SQUEEZE-VALUE
  3172                                        VALUE 'Y' ' '.
  3173
  3174     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  3175         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  3176         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  3177         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  3178         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  3179         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  3180         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  3181         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  3182                                              'K' 'N' ' '
  3183                                              'Z'.
  3184
  3185     12  TX-ARCHIVE-SW               PIC X.
  3186         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  3187         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  3188         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  3189
  3190     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  3191     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  3192
  3193     12  TX-BSR-CODE                 PIC X.
  3194         88  TX-BSR-LETTER              VALUE 'B'.
  3195         88  TX-NON-BSR-LETTER          VALUE ' '.
  3196
  3197     12  FILLER                      PIC X.
  3198*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  62
* EL106.cbl
  3200 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  3201                          TEXT-FILES.
  3202 0000-DFHEXIT SECTION.
  3203     MOVE '9#                    $   ' TO DFHEIV0.
  3204     MOVE 'EL106' TO DFHEIV1.
  3205     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3206
  3207     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3208     MOVE '5'                   TO DC-OPTION-CODE.
  3209     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3210     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3211     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  3212
  3213     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  3214     MOVE 2                     TO EMI-NUMBER-OF-LINES
  3215                                   EMI-SWITCH2.
  3216
  3217     MOVE EIBTRMID              TO QID-TERM.
  3218
  3219     IF EIBCALEN = 0
  3220         GO TO 8800-UNAUTHORIZED-ACCESS.
  3221
  3222     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3223         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  3224       ELSE
  3225         MOVE SPACES             TO RETURNED-FROM.
  3226
  3227     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3228         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3229             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3230             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3231             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3232             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3233             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3234             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3235             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3236             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3237             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  3238         ELSE
  3239             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3240             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3241             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3242             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3243             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3244             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3245             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3246             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  3247
  3248     MOVE 'N' TO WS-DISPLAY-SW.
  3249
  3250
  3251* EXEC CICS HANDLE CONDITION
  3252*        DUPREC  (8850-DUPREC)
  3253*        NOTOPEN (8870-NOTOPEN)
  3254*        NOTFND  (8880-NOT-FOUND)
  3255*        PGMIDERR(9600-PGMID-ERROR)
  3256*        ERROR   (9990-ABEND)
  3257*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  63
* EL106.cbl
  3258*    MOVE '"$%JIL.               ! " #00003246' TO DFHEIV0
  3259     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  3260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3261     MOVE X'2220233030303033323436' TO DFHEIV0(25:11)
  3262     CALL 'kxdfhei1' USING DFHEIV0
  3263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3264
  3265
  3266     IF EIBTRNID NOT = TRANS-ID
  3267       IF RETURNED-FROM = XCTL-EL6565
  3268           MOVE LOW-VALUES           TO EL106AO
  3269           PERFORM 6500-RECOVER-TEMP-STORAGE THRU 6500-EXIT
  3270           GO TO 8100-SEND-INITIAL-MAP
  3271        ELSE
  3272       IF RETURNED-FROM = XCTL-EL1061
  3273           MOVE LOW-VALUES           TO EL106AO
  3274           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3275               GO TO 8100-SEND-INITIAL-MAP
  3276           ELSE
  3277               MOVE PI-WS-STATE TO STCDI
  3278               MOVE 'Y' TO WS-DISPLAY-SW
  3279               GO TO 1000-SHOW-STATE
  3280        ELSE
  3281       IF PI-RETURN-TO-PROGRAM = XCTL-EL6507
  3282           MOVE LOW-VALUES           TO EL106AO
  3283           IF PI-WS-STATE EQUAL LOW-VALUES OR SPACES
  3284               GO TO 8100-SEND-INITIAL-MAP
  3285           ELSE
  3286               MOVE PI-WS-STATE TO STCDI
  3287               MOVE 'Y' TO WS-DISPLAY-SW
  3288               GO TO 1000-SHOW-STATE
  3289        ELSE
  3290         MOVE LOW-VALUES           TO EL106AO
  3291         GO TO 8100-SEND-INITIAL-MAP.
  3292
  3293     IF EIBAID = DFHCLEAR
  3294         GO TO 9400-CLEAR.
  3295
  3296     IF NOT DISPLAY-CAP
  3297         MOVE 'READ'         TO SM-READ
  3298         PERFORM 9995-SECURITY-VIOLATION
  3299         MOVE ER-0070        TO EMI-ERROR
  3300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3301         GO TO 8100-SEND-INITIAL-MAP.
  3302
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  64
* EL106.cbl
  3304 0200-RECEIVE.
  3305     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3306         MOVE LOW-VALUES TO EL106AI
  3307         MOVE ER-7008    TO EMI-ERROR
  3308         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3309         MOVE -1 TO MAINTL
  3310         GO TO 8200-SEND-DATAONLY.
  3311
  3312
  3313* EXEC CICS RECEIVE
  3314*        MAP   (MAP-NAME)
  3315*        MAPSET(MAPSET-NAME)
  3316*        INTO  (EL106AI)
  3317*    END-EXEC.
  3318     MOVE LENGTH OF
  3319      EL106AI
  3320       TO DFHEIV11
  3321*    MOVE '8"T I  L              ''   #00003300' TO DFHEIV0
  3322     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3323     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3324     MOVE X'2020233030303033333030' TO DFHEIV0(25:11)
  3325     CALL 'kxdfhei1' USING DFHEIV0,
  3326           MAP-NAME,
  3327           EL106AI,
  3328           DFHEIV11,
  3329           MAPSET-NAME,
  3330           DFHEIV99,
  3331           DFHEIV99
  3332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3333
  3334
  3335     IF ENTERPFL = 0
  3336         GO TO 0300-CHECK-PFKEYS.
  3337
  3338     IF EIBAID NOT = DFHENTER
  3339         MOVE ER-0004 TO EMI-ERROR
  3340         GO TO 0320-INPUT-ERROR.
  3341
  3342     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3343         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3344     ELSE
  3345         MOVE ER-0029 TO EMI-ERROR
  3346         GO TO 0320-INPUT-ERROR.
  3347
  3348 0300-CHECK-PFKEYS.
  3349     IF EIBAID = DFHPF23
  3350         GO TO 8810-PF23.
  3351
  3352     IF EIBAID = DFHPF24
  3353         GO TO 9200-RETURN-MAIN-MENU.
  3354
  3355     IF EIBAID = DFHPF12
  3356         GO TO 9500-PF12.
  3357
  3358     IF MAINTL NOT = 0  AND
  3359        EIBAID NOT = DFHENTER
  3360          MOVE ER-0050 TO EMI-ERROR
  3361          GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  65
* EL106.cbl
  3362
  3363     IF EIBAID = DFHPF1
  3364         GO TO 5000-FIND-NEXT-STATE.
  3365
  3366     IF EIBAID = DFHPF2
  3367         GO TO 5500-FIND-PREV-STATE.
  3368
  3369     IF EIBAID = DFHPF3
  3370         IF NOT MORTGAGE-SESSION
  3371             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3372                 MOVE ER-0029        TO  EMI-ERROR
  3373                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3374                 MOVE -1             TO  ENTERPFL
  3375                 MOVE AL-UNBON       TO  ENTERPFA
  3376                 GO TO 8200-SEND-DATAONLY
  3377             ELSE
  3378                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3379                 MOVE SPACES         TO  PI-WS-CLASS
  3380                                         PI-WS-DEV
  3381                                         PI-WS-TYPE
  3382                                         PI-WS-PLAN
  3383                 PERFORM 6400-CREATE-TEMP-STORAGE THRU 6400-EXIT
  3384                 MOVE XCTL-EL6565    TO  PGM-NAME
  3385                 GO TO 9300-XCTL
  3386         ELSE
  3387             MOVE ER-7536 TO EMI-ERROR
  3388             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3389             MOVE AL-UNBON TO ENTERPFA
  3390             IF ENTERPFL = 0
  3391                 MOVE -1 TO MAINTL
  3392                 GO TO 8200-SEND-DATAONLY
  3393             ELSE
  3394                 MOVE -1 TO ENTERPFL
  3395                 GO TO 8200-SEND-DATAONLY.
  3396
  3397     IF EIBAID = DFHPF4
  3398         IF NOT MORTGAGE-SESSION
  3399             IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  3400                 MOVE ER-0029        TO  EMI-ERROR
  3401                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3402                 MOVE -1             TO  ENTERPFL
  3403                 MOVE AL-UNBON       TO  ENTERPFA
  3404                 GO TO 8200-SEND-DATAONLY
  3405             ELSE
  3406                 MOVE PI-PREV-STATE  TO  PI-WS-STATE
  3407                 MOVE SPACES         TO  PI-WS-CLASS
  3408                                         PI-WS-DEV
  3409                                         PI-WS-TYPE
  3410                                         PI-WS-PLAN
  3411                 MOVE XCTL-EL1061    TO  PGM-NAME
  3412                 GO TO 9300-XCTL
  3413         ELSE
  3414             MOVE ER-7536 TO EMI-ERROR
  3415             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3416             MOVE AL-UNBON TO ENTERPFA
  3417             IF ENTERPFL = 0
  3418                 MOVE -1 TO MAINTL
  3419                 GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  66
* EL106.cbl
  3420             ELSE
  3421                 MOVE -1 TO ENTERPFL
  3422                 GO TO 8200-SEND-DATAONLY.
  3423
  3424     IF EIBAID = DFHENTER
  3425         GO TO 0330-EDIT-DATA.
  3426
  3427     MOVE ER-0029 TO EMI-ERROR.
  3428 0320-INPUT-ERROR.
  3429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3430     MOVE AL-UNBON TO ENTERPFA.
  3431
  3432     IF ENTERPFL = 0
  3433         MOVE -1 TO MAINTL
  3434     ELSE
  3435         MOVE -1 TO ENTERPFL.
  3436
  3437     GO TO 8200-SEND-DATAONLY.
  3438
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  67
* EL106.cbl
  3440 0330-EDIT-DATA.
  3441     IF STCDL = ZERO AND
  3442        STABRL = ZERO
  3443         MOVE ER-0144       TO EMI-ERROR
  3444         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3445         MOVE -1            TO STCDL
  3446         MOVE AL-UABON      TO STCDA
  3447         GO TO 8200-SEND-DATAONLY.
  3448
  3449     IF STCDL = ZERO AND
  3450        STABRL NOT = ZERO
  3451         PERFORM 0500-GET-STATE-CD THRU 0600-EXIT.
  3452
  3453     IF MAINTI = 'S'
  3454         GO TO 1000-SHOW-STATE.
  3455
  3456     IF MODIFY-CAP
  3457        NEXT SENTENCE
  3458       ELSE
  3459        IF MAINTI = 'A' OR 'C' OR 'D'
  3460         MOVE 'UPDATE'       TO SM-READ
  3461         PERFORM 9995-SECURITY-VIOLATION
  3462         MOVE ER-0070        TO EMI-ERROR
  3463         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3464         MOVE LOW-VALUES     TO EL106AO
  3465         GO TO 8100-SEND-INITIAL-MAP.
  3466
  3467     IF MAINTI = 'C'
  3468         GO TO 2000-CHANGE-STATE.
  3469
  3470     IF MAINTI = 'A'
  3471         GO TO 3000-ADD-STATE.
  3472
  3473     IF MAINTI = 'D'
  3474         GO TO 4000-DELETE-STATE.
  3475
  3476     MOVE ER-0023 TO EMI-ERROR.
  3477     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3478     MOVE -1       TO MAINTL.
  3479     MOVE AL-UABON TO MAINTA.
  3480     GO TO 8200-SEND-DATAONLY.
  3481
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  68
* EL106.cbl
  3483 0500-GET-STATE-CD.
  3484     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  3485     MOVE LOW-VALUES     TO CK-STATE-CD.
  3486     MOVE +0             TO CK-SEQ.
  3487
  3488
  3489* EXEC CICS HANDLE CONDITION
  3490*        ENDFILE(8880-NOT-FOUND)
  3491*        NOTFND (8880-NOT-FOUND)
  3492*    END-EXEC.
  3493*    MOVE '"$''I                  ! # #00003459' TO DFHEIV0
  3494     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  3495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3496     MOVE X'2320233030303033343539' TO DFHEIV0(25:11)
  3497     CALL 'kxdfhei1' USING DFHEIV0
  3498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3499
  3500
  3501
  3502* EXEC CICS STARTBR
  3503*        DATASET  (ELCNTL-ID)
  3504*        RIDFLD   (ELCNTL-KEY)
  3505*    END-EXEC.
  3506     MOVE 0
  3507       TO DFHEIV11
  3508*    MOVE '&,         G          &   #00003464' TO DFHEIV0
  3509     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3510     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3511     MOVE X'2020233030303033343634' TO DFHEIV0(25:11)
  3512     CALL 'kxdfhei1' USING DFHEIV0,
  3513           ELCNTL-ID,
  3514           ELCNTL-KEY,
  3515           DFHEIV99,
  3516           DFHEIV11,
  3517           DFHEIV99
  3518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3519
  3520
  3521 0510-GET-NEXT-CD.
  3522
  3523* EXEC CICS READNEXT
  3524*        DATASET(ELCNTL-ID)
  3525*        SET    (ADDRESS OF CONTROL-FILE)
  3526*        RIDFLD (ELCNTL-KEY)
  3527*    END-EXEC.
  3528     MOVE 0
  3529       TO DFHEIV11
  3530*    MOVE '&.S                   )   #00003470' TO DFHEIV0
  3531     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3532     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3533     MOVE X'2020233030303033343730' TO DFHEIV0(25:11)
  3534     CALL 'kxdfhei1' USING DFHEIV0,
  3535           ELCNTL-ID,
  3536           DFHEIV20,
  3537           DFHEIV99,
  3538           ELCNTL-KEY,
  3539           DFHEIV99,
  3540           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  69
* EL106.cbl
  3541           DFHEIV99,
  3542           DFHEIV99
  3543     SET ADDRESS OF CONTROL-FILE TO
  3544         DFHEIV20
  3545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3546
  3547
  3548     IF CF-COMPANY-ID NOT = PI-COMPANY-ID
  3549
  3550* EXEC CICS ENDBR
  3551*            DATASET  (ELCNTL-ID)
  3552*        END-EXEC
  3553     MOVE 0
  3554       TO DFHEIV11
  3555*    MOVE '&2                    $   #00003477' TO DFHEIV0
  3556     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3557     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3558     MOVE X'2020233030303033343737' TO DFHEIV0(25:11)
  3559     CALL 'kxdfhei1' USING DFHEIV0,
  3560           ELCNTL-ID,
  3561           DFHEIV11,
  3562           DFHEIV99
  3563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3564         GO TO 8880-NOT-FOUND.
  3565
  3566     IF CF-RECORD-TYPE NOT = '3'
  3567         GO TO 0510-GET-NEXT-CD.
  3568
  3569     IF CF-STATE-ABBREVIATION = STABRI
  3570         NEXT SENTENCE
  3571       ELSE
  3572         GO TO 0510-GET-NEXT-CD.
  3573
  3574     MOVE CF-STATE-CODE      TO STCDI.
  3575     MOVE AL-UANON           TO STCDA.
  3576     MOVE +2                 TO STCDL.
  3577
  3578
  3579* EXEC CICS ENDBR
  3580*        DATASET  (ELCNTL-ID)
  3581*    END-EXEC.
  3582     MOVE 0
  3583       TO DFHEIV11
  3584*    MOVE '&2                    $   #00003494' TO DFHEIV0
  3585     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3587     MOVE X'2020233030303033343934' TO DFHEIV0(25:11)
  3588     CALL 'kxdfhei1' USING DFHEIV0,
  3589           ELCNTL-ID,
  3590           DFHEIV11,
  3591           DFHEIV99
  3592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3593
  3594
  3595 0600-EXIT.
  3596      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  70
* EL106.cbl
  3598 1000-SHOW-STATE.
  3599     IF RETURN-DISPLAY
  3600
  3601* EXEC CICS HANDLE CONDITION
  3602*            NOTFND  (8100-SEND-INITIAL-MAP)
  3603*        END-EXEC.
  3604*    MOVE '"$I                   ! $ #00003503' TO DFHEIV0
  3605     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3607     MOVE X'2420233030303033353033' TO DFHEIV0(25:11)
  3608     CALL 'kxdfhei1' USING DFHEIV0
  3609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3610
  3611
  3612     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3613     MOVE STCDI         TO CK-STATE-CD
  3614                           PI-WS-STATE.
  3615
  3616
  3617* EXEC CICS READ
  3618*        DATASET(ELCNTL-ID)
  3619*        SET    (ADDRESS OF CONTROL-FILE)
  3620*        RIDFLD (ELCNTL-KEY)
  3621*    END-EXEC.
  3622*    MOVE '&"S        E          (   #00003511' TO DFHEIV0
  3623     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3625     MOVE X'2020233030303033353131' TO DFHEIV0(25:11)
  3626     CALL 'kxdfhei1' USING DFHEIV0,
  3627           ELCNTL-ID,
  3628           DFHEIV20,
  3629           DFHEIV99,
  3630           ELCNTL-KEY,
  3631           DFHEIV99,
  3632           DFHEIV99,
  3633           DFHEIV99
  3634     SET ADDRESS OF CONTROL-FILE TO
  3635         DFHEIV20
  3636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3637
  3638
  3639     GO TO 7000-BUILD-OUTPUT-MAP.
  3640
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  71
* EL106.cbl
  3642 2000-CHANGE-STATE.
  3643     IF STCDI NOT = PI-PREV-STATE
  3644         MOVE ER-0145 TO EMI-ERROR
  3645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3646         MOVE -1       TO STCDL
  3647         MOVE AL-UABON TO STCDA
  3648         GO TO 8200-SEND-DATAONLY.
  3649
  3650     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  3651
  3652     IF NOT EMI-NO-ERRORS
  3653         GO TO 8200-SEND-DATAONLY.
  3654
  3655     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  3656     MOVE STCDI         TO CK-STATE-CD
  3657                           PI-WS-STATE.
  3658
  3659
  3660* EXEC CICS READ
  3661*        UPDATE
  3662*        DATASET(ELCNTL-ID)
  3663*        SET    (ADDRESS OF CONTROL-FILE)
  3664*        RIDFLD (ELCNTL-KEY)
  3665*    END-EXEC.
  3666*    MOVE '&"S        EU         (   #00003537' TO DFHEIV0
  3667     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3668     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3669     MOVE X'2020233030303033353337' TO DFHEIV0(25:11)
  3670     CALL 'kxdfhei1' USING DFHEIV0,
  3671           ELCNTL-ID,
  3672           DFHEIV20,
  3673           DFHEIV99,
  3674           ELCNTL-KEY,
  3675           DFHEIV99,
  3676           DFHEIV99,
  3677           DFHEIV99
  3678     SET ADDRESS OF CONTROL-FILE TO
  3679         DFHEIV20
  3680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3681
  3682
  3683     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  3684        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  3685
  3686* EXEC CICS UNLOCK
  3687*            DATASET(ELCNTL-ID)
  3688*        END-EXEC
  3689*    MOVE '&*                    #   #00003546' TO DFHEIV0
  3690     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  3691     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3692     MOVE X'2020233030303033353436' TO DFHEIV0(25:11)
  3693     CALL 'kxdfhei1' USING DFHEIV0,
  3694           ELCNTL-ID,
  3695           DFHEIV99
  3696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3697         MOVE ER-0068 TO EMI-ERROR
  3698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3699         GO TO 1000-SHOW-STATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  72
* EL106.cbl
  3700
  3701     MOVE 'B'                    TO JP-RECORD-TYPE.
  3702     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3703     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3704
  3705     MOVE PI-PROCESSOR-ID TO CF-LAST-MAINT-BY.
  3706     MOVE EIBTIME         TO CF-LAST-MAINT-HHMMSS.
  3707     MOVE EIBDATE         TO DC-JULIAN-YYDDD.
  3708     MOVE '5'             TO DC-OPTION-CODE.
  3709     MOVE LINK-ELDATCV    TO PGM-NAME.
  3710
  3711
  3712* EXEC CICS LINK
  3713*        PROGRAM (PGM-NAME)
  3714*        COMMAREA(DATE-CONVERSION-DATA)
  3715*        LENGTH  (DC-COMM-LENGTH)
  3716*    END-EXEC.
  3717*    MOVE '."C                   ''   #00003563' TO DFHEIV0
  3718     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3719     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3720     MOVE X'2020233030303033353633' TO DFHEIV0(25:11)
  3721     CALL 'kxdfhei1' USING DFHEIV0,
  3722           PGM-NAME,
  3723           DATE-CONVERSION-DATA,
  3724           DC-COMM-LENGTH,
  3725           DFHEIV99,
  3726           DFHEIV99,
  3727           DFHEIV99
  3728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3729
  3730
  3731     IF DATE-CONVERSION-ERROR
  3732         MOVE LOW-VALUES          TO CF-LAST-MAINT-DT
  3733     ELSE
  3734         MOVE DC-BIN-DATE-1       TO CF-LAST-MAINT-DT.
  3735
  3736     IF STABRL NOT = ZEROS
  3737         MOVE STABRI              TO CF-STATE-ABBREVIATION.
  3738
  3739     IF STNAMEL NOT = ZEROS
  3740         MOVE STNAMEI             TO CF-STATE-NAME.
  3741
  3742     IF LFEXPL NOT = ZEROS
  3743         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  3744
  3745     IF AHEXPL NOT = ZEROS
  3746         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  3747
  3748     IF QUOTCALL NOT = ZEROS
  3749         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  3750
  3751     IF PREMTOLL NOT = ZEROS
  3752         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  3753
  3754     IF REFTOLL NOT = ZEROS
  3755         MOVE REFTOLI             TO CF-ST-TOL-REFUND.
  3756
  3757     IF OVSAMTL > 0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  73
* EL106.cbl
  3758         MOVE OVSAMTI TO CF-ST-OVR-SHT-AMT
  3759     END-IF.
  3760
  3761     IF PRMPCTL NOT = ZEROS
  3762         MOVE WS-ST-TOL-PREM-PCT  TO CF-ST-TOL-PREM-PCT.
  3763
  3764     IF REFPCTL NOT = ZEROS
  3765         MOVE  WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  3766
  3767     IF OVSPCTL > +0
  3768         MOVE WS-ST-OVR-SHT-PCT TO CF-ST-OVR-SHT-PCT
  3769     END-IF.
  3770
  3771     IF CLREJECL NOT = ZEROS
  3772         MOVE CLREJECI            TO CF-ST-CLAIM-REJECT-SW.
  3773
  3774     IF ISSREJL NOT = ZEROS
  3775         MOVE ISSREJI             TO CF-ST-PREM-REJECT-SW.
  3776
  3777     IF REFREJL NOT = ZEROS
  3778         MOVE REFREJI             TO CF-ST-REF-REJECT-SW.
  3779
  3780     IF REFMINL NOT = ZEROS
  3781         MOVE REFMINI             TO CF-ST-REFUND-MIN.
  3782
  3783     IF REFDAY1L NOT = ZEROS
  3784         MOVE REFDAY1I            TO CF-ST-REFUND-DAYS-FIRST.
  3785
  3786     IF REFDAYSL NOT = ZEROS
  3787         MOVE REFDAYSI            TO CF-ST-REFUND-DAYS-SUBSEQ.
  3788
  3789     IF SPLPMTL NOT = ZEROS
  3790         MOVE SPLPMTI             TO CF-ST-SPLIT-PAYMENT.
  3791
  3792     IF EXTDAYSL NOT = ZEROS
  3793         MOVE EXTDAYSI            TO CF-ST-FST-PMT-DAYS-MAX.
  3794
  3795*    IF INTDAYSL NOT = ZEROS
  3796*        MOVE INTDAYSI            TO CF-ST-NO-DAYS-ELAPSED.
  3797
  3798     IF EXTCHGL NOT = ZEROS
  3799         MOVE EXTCHGI             TO CF-ST-FST-PMT-DAYS-CHG.
  3800
  3801     IF REMTERML NOT = ZEROS
  3802        MOVE REMTERMI             TO CF-ST-RT-CALC
  3803     END-IF
  3804
  3805     IF LFREDL NOT = ZEROS
  3806        MOVE LFREDI               TO CF-ST-RF-LR-CALC
  3807     END-IF
  3808
  3809     IF LFLEVL NOT = ZEROS
  3810        MOVE LFLEVI               TO CF-ST-RF-LL-CALC
  3811     END-IF
  3812
  3813     IF LFNETL NOT = ZEROS
  3814        MOVE LFNETI               TO CF-ST-RF-LN-CALC
  3815     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  74
* EL106.cbl
  3816
  3817     IF AHAHL NOT = ZEROS
  3818        MOVE AHAHI                TO CF-ST-RF-AH-CALC
  3819     END-IF
  3820
  3821     IF AHCPL NOT = ZEROS
  3822        MOVE AHCPI                TO CF-ST-RF-CP-CALC
  3823     END-IF
  3824
  3825     IF LFTAXL > +0
  3826        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  3827     END-IF
  3828
  3829     IF AHITAXL > +0
  3830        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  3831     END-IF
  3832
  3833     IF AHGTAXL > +0
  3834        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  3835     END-IF
  3836
  3837     IF REFCLML NOT = ZEROS
  3838         MOVE REFCLMI             TO CF-ST-REF-AH-DEATH-IND
  3839     END-IF.
  3840
  3841     IF VFYBENEL NOT = ZEROS
  3842         MOVE VFYBENEI            TO CF-ST-VFY-2ND-BENE
  3843     END-IF.
  3844
  3845     IF STUEL NOT = ZEROS
  3846         MOVE STUEI               TO CF-ST-CALL-UNEARNED.
  3847
  3848     IF STCNTLL NOT = ZEROS
  3849         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  3850
  3851     IF STDEVL NOT = ZEROS
  3852         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  3853
  3854     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  3855     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  3856
  3857     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  3858
  3859*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  3860
  3861     IF WS-COMSL NUMERIC AND
  3862        WS-COMSL NOT = ZEROS
  3863         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL
  3864      ELSE
  3865         MOVE ZEROS              TO CF-ST-COMM-CAP-SL.
  3866
  3867     IF WS-COMJL NUMERIC AND
  3868        WS-COMJL NOT = ZEROS
  3869         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL
  3870      ELSE
  3871         MOVE ZEROS              TO CF-ST-COMM-CAP-JL.
  3872
  3873     IF WS-COMSA NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  75
* EL106.cbl
  3874        WS-COMSA NOT = ZEROS
  3875         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA
  3876      ELSE
  3877         MOVE ZEROS              TO CF-ST-COMM-CAP-SA.
  3878
  3879     IF WS-COMJA NUMERIC AND
  3880        WS-COMJA NOT = ZEROS
  3881         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA
  3882      ELSE
  3883         MOVE ZEROS              TO CF-ST-COMM-CAP-JA.
  3884
  3885     IF WS-IRATE NUMERIC AND
  3886        WS-IRATE NOT = ZEROS
  3887         MOVE WS-IRATE           TO CF-ST-STAT-INTEREST
  3888      ELSE
  3889         MOVE ZEROS              TO CF-ST-STAT-INTEREST.
  3890
  3891     IF WS-IRATE1 NUMERIC AND
  3892        WS-IRATE1 NOT = ZEROS
  3893         MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1
  3894      ELSE
  3895         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1.
  3896
  3897     IF WS-IRATE2 NUMERIC AND
  3898        WS-IRATE2 NOT = ZEROS
  3899         MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2
  3900      ELSE
  3901         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2.
  3902
  3903     IF WS-IRATE3 NUMERIC AND
  3904        WS-IRATE3 NOT = ZEROS
  3905         MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3
  3906      ELSE
  3907         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3.
  3908
  3909     IF WS-RESIDENT-TAX NUMERIC AND
  3910        WS-RESIDENT-TAX NOT = ZEROS
  3911         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT
  3912      ELSE
  3913         MOVE ZEROS              TO CF-ST-RES-TAX-PCT.
  3914
  3915     IF WS-FREE-LOOK-DAYS NUMERIC
  3916             AND
  3917        WS-FREE-LOOK-DAYS NOT EQUAL ZEROS
  3918         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD
  3919      ELSE
  3920         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD.
  3921
  3922     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  3923             AND
  3924         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  3925         MOVE WS-ST-TARGET-LOSS-RATIO
  3926                                 TO CF-ST-TARGET-LOSS-RATIO
  3927     ELSE
  3928         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  3929
  3930     IF  WS-ST-CALC-INTEREST NUMERIC
  3931             AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  76
* EL106.cbl
  3932         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  3933         MOVE WS-ST-CALC-INTEREST
  3934                                 TO CF-ST-CALC-INTEREST
  3935     ELSE
  3936         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  3937
  3938     MOVE 'C'                    TO JP-RECORD-TYPE.
  3939     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  3940
  3941* EXEC CICS REWRITE
  3942*        DATASET(ELCNTL-ID)
  3943*        FROM   (CONTROL-FILE)
  3944*    END-EXEC.
  3945     MOVE LENGTH OF
  3946      CONTROL-FILE
  3947       TO DFHEIV11
  3948*    MOVE '&& L                  %   #00003778' TO DFHEIV0
  3949     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3950     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3951     MOVE X'2020233030303033373738' TO DFHEIV0(25:11)
  3952     CALL 'kxdfhei1' USING DFHEIV0,
  3953           ELCNTL-ID,
  3954           CONTROL-FILE,
  3955           DFHEIV11,
  3956           DFHEIV99
  3957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3958
  3959
  3960     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  3961     MOVE ER-0000 TO EMI-ERROR.
  3962     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3963     MOVE LOW-VALUES  TO EL106AO.
  3964     MOVE -1          TO MAINTL.
  3965     MOVE SPACES      TO PI-PREV-STATE.
  3966     MOVE CK-STATE-CD TO STCDO.
  3967     MOVE AL-UANON    TO STCDA.
  3968     GO TO 1000-SHOW-STATE.
  3969
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  77
* EL106.cbl
  3971 3000-ADD-STATE.
  3972     PERFORM 6000-EDIT-INPUT-DATA THRU 6099-EXIT.
  3973
  3974     IF NOT EMI-NO-ERRORS
  3975         GO TO 8200-SEND-DATAONLY.
  3976
  3977
  3978* EXEC CICS GETMAIN
  3979*        SET    (ADDRESS OF CONTROL-FILE)
  3980*        LENGTH (750)
  3981*        INITIMG(GETMAIN-SPACE)
  3982*    END-EXEC.
  3983     MOVE 750
  3984       TO DFHEIV11
  3985*    MOVE ',"IL                  $   #00003800' TO DFHEIV0
  3986     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3987     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3988     MOVE X'2020233030303033383030' TO DFHEIV0(25:11)
  3989     CALL 'kxdfhei1' USING DFHEIV0,
  3990           DFHEIV20,
  3991           DFHEIV11,
  3992           GETMAIN-SPACE
  3993     SET ADDRESS OF CONTROL-FILE TO
  3994         DFHEIV20
  3995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3996
  3997
  3998     MOVE 'CF'          TO CF-RECORD-ID.
  3999     MOVE PI-COMPANY-ID TO CF-COMPANY-ID.
  4000     MOVE '3'           TO CF-RECORD-TYPE.
  4001     MOVE STCDI         TO CF-ACCESS-OF-STATE.
  4002     MOVE +0            TO CF-SEQUENCE-NO.
  4003
  4004     MOVE EIBDATE       TO DC-JULIAN-YYDDD.
  4005     MOVE '5'           TO DC-OPTION-CODE.
  4006     MOVE LINK-ELDATCV  TO PGM-NAME.
  4007
  4008* EXEC CICS LINK
  4009*        PROGRAM (PGM-NAME)
  4010*        COMMAREA(DATE-CONVERSION-DATA)
  4011*        LENGTH  (DC-COMM-LENGTH)
  4012*    END-EXEC.
  4013*    MOVE '."C                   ''   #00003815' TO DFHEIV0
  4014     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4015     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4016     MOVE X'2020233030303033383135' TO DFHEIV0(25:11)
  4017     CALL 'kxdfhei1' USING DFHEIV0,
  4018           PGM-NAME,
  4019           DATE-CONVERSION-DATA,
  4020           DC-COMM-LENGTH,
  4021           DFHEIV99,
  4022           DFHEIV99,
  4023           DFHEIV99
  4024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4025
  4026
  4027     IF DATE-CONVERSION-ERROR
  4028         MOVE LOW-VALUES    TO CF-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  78
* EL106.cbl
  4029       ELSE
  4030         MOVE DC-BIN-DATE-1 TO CF-LAST-MAINT-DT.
  4031
  4032     MOVE PI-PROCESSOR-ID   TO CF-LAST-MAINT-BY.
  4033     MOVE EIBTIME           TO CF-LAST-MAINT-HHMMSS.
  4034
  4035     MOVE STNAMEI           TO CF-STATE-NAME.
  4036     MOVE STABRI            TO CF-STATE-ABBREVIATION.
  4037
  4038     IF LFEXPL = ZEROS
  4039         MOVE ZEROS               TO CF-ST-LF-EXP-PCT
  4040       ELSE
  4041         MOVE WS-ST-LF-EXP-PCT    TO CF-ST-LF-EXP-PCT.
  4042
  4043     IF AHEXPL = ZEROS
  4044         MOVE ZEROS               TO CF-ST-AH-EXP-PCT
  4045       ELSE
  4046         MOVE WS-ST-AH-EXP-PCT    TO CF-ST-AH-EXP-PCT.
  4047
  4048     IF QUOTCALL = ZEROS
  4049         MOVE ZEROS               TO CF-ST-TOL-CLAIM
  4050       ELSE
  4051         MOVE QUOTCALI            TO CF-ST-TOL-CLAIM.
  4052
  4053     IF PREMTOLL = ZEROS
  4054         MOVE ZEROS               TO CF-ST-TOL-PREM
  4055       ELSE
  4056         MOVE PREMTOLI            TO CF-ST-TOL-PREM.
  4057
  4058     IF OVSAMTL = ZEROS
  4059         MOVE ZEROS              TO CF-ST-OVR-SHT-AMT
  4060       ELSE
  4061         MOVE OVSAMTI            TO CF-ST-OVR-SHT-AMT.
  4062
  4063     IF REFTOLL = ZEROS
  4064         MOVE ZEROS              TO CF-ST-TOL-REFUND
  4065       ELSE
  4066         MOVE REFTOLI            TO CF-ST-TOL-REFUND.
  4067
  4068     IF PRMPCTL = ZEROS
  4069         MOVE ZEROS              TO CF-ST-TOL-PREM-PCT
  4070       ELSE
  4071         MOVE WS-ST-TOL-PREM-PCT TO CF-ST-TOL-PREM-PCT.
  4072
  4073     IF OVSPCTL = ZEROS
  4074         MOVE ZEROS              TO CF-ST-OVR-SHT-PCT
  4075       ELSE
  4076         MOVE WS-ST-OVR-SHT-PCT  TO CF-ST-OVR-SHT-PCT.
  4077
  4078     IF REFPCTL = ZEROS
  4079         MOVE ZEROS              TO CF-ST-TOL-REF-PCT
  4080       ELSE
  4081         MOVE WS-ST-TOL-REF-PCT  TO CF-ST-TOL-REF-PCT.
  4082
  4083     IF CLREJECL = ZEROS
  4084         MOVE SPACE              TO CF-ST-CLAIM-REJECT-SW
  4085       ELSE
  4086         MOVE CLREJECI           TO CF-ST-CLAIM-REJECT-SW.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  79
* EL106.cbl
  4087
  4088     IF ISSREJL = ZEROS
  4089         MOVE SPACE              TO CF-ST-PREM-REJECT-SW
  4090       ELSE
  4091         MOVE ISSREJI            TO CF-ST-PREM-REJECT-SW.
  4092
  4093     IF REFREJL = ZEROS
  4094         MOVE SPACE              TO CF-ST-REF-REJECT-SW
  4095       ELSE
  4096         MOVE REFREJI            TO CF-ST-REF-REJECT-SW.
  4097
  4098     IF REFMINL = ZEROS
  4099         MOVE ZEROS              TO CF-ST-REFUND-MIN
  4100       ELSE
  4101         MOVE REFMINI            TO CF-ST-REFUND-MIN.
  4102
  4103     IF REFDAY1L  = ZERO
  4104         MOVE ZEROS              TO CF-ST-REFUND-DAYS-FIRST
  4105       ELSE
  4106         MOVE REFDAY1I           TO CF-ST-REFUND-DAYS-FIRST.
  4107
  4108     IF REFDAYSL = ZERO
  4109         MOVE ZEROS              TO CF-ST-REFUND-DAYS-SUBSEQ
  4110       ELSE
  4111         MOVE REFDAYSI           TO CF-ST-REFUND-DAYS-SUBSEQ.
  4112
  4113     IF SPLPMTL = ZERO
  4114         MOVE 'N'                TO CF-ST-SPLIT-PAYMENT
  4115     ELSE
  4116         MOVE SPLPMTI            TO CF-ST-SPLIT-PAYMENT.
  4117
  4118     IF EXTDAYSL = ZERO
  4119         MOVE ZEROS              TO CF-ST-FST-PMT-DAYS-MAX
  4120       ELSE
  4121         MOVE EXTDAYSI           TO CF-ST-FST-PMT-DAYS-MAX.
  4122
  4123*    IF INTDAYSL = ZERO
  4124*        MOVE ZEROS              TO CF-ST-NO-DAYS-ELAPSED
  4125*      ELSE
  4126*        MOVE INTDAYSI           TO CF-ST-NO-DAYS-ELAPSED.
  4127
  4128     IF EXTCHGL = ZEROS
  4129         MOVE SPACES             TO CF-ST-FST-PMT-DAYS-CHG
  4130       ELSE
  4131         MOVE EXTCHGI            TO CF-ST-FST-PMT-DAYS-CHG.
  4132
  4133     IF REMTERML = ZEROS
  4134        MOVE SPACES              TO CF-ST-RT-CALC
  4135     ELSE
  4136        MOVE REMTERMI            TO CF-ST-RT-CALC
  4137     END-IF
  4138
  4139     IF LFTAXL = ZEROS
  4140        MOVE ZEROS               TO CF-ST-LF-PREM-TAX
  4141     ELSE
  4142        MOVE WS-ST-LF-PREM-TAX   TO CF-ST-LF-PREM-TAX
  4143     END-IF
  4144
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  80
* EL106.cbl
  4145     IF AHITAXL = ZEROS
  4146        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-I
  4147     ELSE
  4148        MOVE WS-ST-AH-PREM-TAX-I TO CF-ST-AH-PREM-TAX-I
  4149     END-IF
  4150
  4151     IF AHGTAXL = ZEROS
  4152        MOVE ZEROS               TO CF-ST-AH-PREM-TAX-G
  4153     ELSE
  4154        MOVE WS-ST-AH-PREM-TAX-G TO CF-ST-AH-PREM-TAX-G
  4155     END-IF
  4156
  4157     IF STUEL = ZEROS
  4158         MOVE SPACES             TO CF-ST-CALL-UNEARNED
  4159       ELSE
  4160         MOVE STUEI              TO CF-ST-CALL-UNEARNED.
  4161
  4162     IF STCNTLL = ZEROS
  4163         MOVE SPACES             TO CF-ST-CALL-RPT-CNTL
  4164       ELSE
  4165         MOVE STCNTLI            TO CF-ST-CALL-RPT-CNTL.
  4166
  4167     IF STDEVL = ZEROS
  4168         MOVE SPACES             TO CF-ST-CALL-RATE-DEV
  4169       ELSE
  4170         MOVE STDEVI             TO CF-ST-CALL-RATE-DEV.
  4171
  4172     IF  WS-ST-TARGET-LOSS-RATIO NUMERIC
  4173             AND
  4174         WS-ST-TARGET-LOSS-RATIO NOT EQUAL ZEROS
  4175         MOVE WS-ST-TARGET-LOSS-RATIO
  4176                                 TO CF-ST-TARGET-LOSS-RATIO
  4177     ELSE
  4178         MOVE ZEROS              TO CF-ST-TARGET-LOSS-RATIO.
  4179
  4180     IF  WS-ST-CALC-INTEREST NUMERIC
  4181             AND
  4182         WS-ST-CALC-INTEREST NOT EQUAL ZEROS
  4183         MOVE WS-ST-CALC-INTEREST
  4184                                 TO CF-ST-CALC-INTEREST
  4185     ELSE
  4186         MOVE ZEROS              TO CF-ST-CALC-INTEREST.
  4187
  4188     MOVE REPLAWI                TO CF-REPLACEMENT-LAW-SW.
  4189     MOVE REPLETRI               TO CF-REPLACEMENT-LETTER.
  4190
  4191     MOVE LIMITI                 TO CF-COMM-CAP-LIMIT-TO.
  4192
  4193*    MOVE STATII                 TO CF-ST-STAT-DATE-FROM.
  4194
  4195     IF COMSLL = ZEROS
  4196         MOVE ZEROS              TO CF-ST-COMM-CAP-SL
  4197       ELSE
  4198         MOVE WS-COMSL           TO CF-ST-COMM-CAP-SL.
  4199
  4200     IF COMJLL = ZEROS
  4201         MOVE ZEROS              TO CF-ST-COMM-CAP-JL
  4202       ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  81
* EL106.cbl
  4203         MOVE WS-COMJL           TO CF-ST-COMM-CAP-JL.
  4204
  4205     IF COMSAL = ZEROS
  4206         MOVE ZEROS              TO CF-ST-COMM-CAP-SA
  4207       ELSE
  4208         MOVE WS-COMSA           TO CF-ST-COMM-CAP-SA.
  4209
  4210     IF COMJAL = ZEROS
  4211         MOVE ZEROS              TO CF-ST-COMM-CAP-JA
  4212       ELSE
  4213         MOVE WS-COMJA           TO CF-ST-COMM-CAP-JA.
  4214
  4215     IF RESTAXL = ZEROS
  4216         MOVE ZEROS              TO CF-ST-RES-TAX-PCT
  4217       ELSE
  4218         MOVE WS-RESIDENT-TAX    TO CF-ST-RES-TAX-PCT.
  4219
  4220     IF FREELKL = ZEROS
  4221         MOVE ZEROS              TO CF-ST-FREE-LOOK-PERIOD
  4222       ELSE
  4223         MOVE WS-FREE-LOOK-DAYS  TO CF-ST-FREE-LOOK-PERIOD.
  4224
  4225*    IF STATRL = ZEROS
  4226         MOVE ZEROS              TO CF-ST-STAT-INTEREST
  4227*      ELSE
  4228*        MOVE WS-IRATE           TO CF-ST-STAT-INTEREST.
  4229
  4230*    IF STATR1L = ZEROS
  4231         MOVE ZEROS              TO CF-ST-STAT-INTEREST-1
  4232*      ELSE
  4233*        MOVE WS-IRATE1          TO CF-ST-STAT-INTEREST-1.
  4234
  4235*    IF STATR2L = ZEROS
  4236         MOVE ZEROS              TO CF-ST-STAT-INTEREST-2
  4237*      ELSE
  4238*        MOVE WS-IRATE2          TO CF-ST-STAT-INTEREST-2.
  4239
  4240*    IF STATR3L = ZEROS
  4241         MOVE ZEROS              TO CF-ST-STAT-INTEREST-3
  4242*      ELSE
  4243*        MOVE WS-IRATE3          TO CF-ST-STAT-INTEREST-3.
  4244
  4245     PERFORM 6100-INITIALIZE-BENEFIT-CNTL THRU 6199-EXIT
  4246             VARYING SUB FROM +1 BY +1
  4247             UNTIL SUB GREATER THAN +50.
  4248
  4249     MOVE 'A'                    TO JP-RECORD-TYPE.
  4250     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4251
  4252
  4253* EXEC CICS WRITE
  4254*        FROM   (CONTROL-FILE)
  4255*        DATASET(ELCNTL-ID)
  4256*        RIDFLD (CF-CONTROL-PRIMARY)
  4257*    END-EXEC.
  4258     MOVE LENGTH OF
  4259      CONTROL-FILE
  4260       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  82
* EL106.cbl
  4261*    MOVE '&$ L                  ''   #00004046' TO DFHEIV0
  4262     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4263     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4264     MOVE X'2020233030303034303436' TO DFHEIV0(25:11)
  4265     CALL 'kxdfhei1' USING DFHEIV0,
  4266           ELCNTL-ID,
  4267           CONTROL-FILE,
  4268           DFHEIV11,
  4269           CF-CONTROL-PRIMARY,
  4270           DFHEIV99,
  4271           DFHEIV99
  4272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4273
  4274
  4275     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT.
  4276     MOVE ER-0000 TO EMI-ERROR.
  4277     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4278     MOVE LOW-VALUES  TO EL106AO.
  4279     MOVE -1          TO MAINTL.
  4280     MOVE SPACES      TO PI-PREV-STATE.
  4281     MOVE CK-STATE-CD TO STCDO.
  4282     MOVE AL-UANON    TO STCDA.
  4283     GO TO 8100-SEND-INITIAL-MAP.
  4284
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  83
* EL106.cbl
  4286 4000-DELETE-STATE.
  4287     IF STCDI NOT = PI-PREV-STATE
  4288         MOVE ER-0145  TO EMI-ERROR
  4289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4290         MOVE -1       TO STCDL
  4291         MOVE AL-UABON TO STCDA
  4292         GO TO 8200-SEND-DATAONLY.
  4293
  4294     MOVE PI-COMPANY-ID TO CK-COMP-ID.
  4295     MOVE STCDI         TO CK-STATE-CD.
  4296
  4297* EXEC CICS READ
  4298*        UPDATE
  4299*        DATASET(ELCNTL-ID)
  4300*        SET    (ADDRESS OF CONTROL-FILE)
  4301*        RIDFLD (ELCNTL-KEY)
  4302*    END-EXEC.
  4303*    MOVE '&"S        EU         (   #00004073' TO DFHEIV0
  4304     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4305     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4306     MOVE X'2020233030303034303733' TO DFHEIV0(25:11)
  4307     CALL 'kxdfhei1' USING DFHEIV0,
  4308           ELCNTL-ID,
  4309           DFHEIV20,
  4310           DFHEIV99,
  4311           ELCNTL-KEY,
  4312           DFHEIV99,
  4313           DFHEIV99,
  4314           DFHEIV99
  4315     SET ADDRESS OF CONTROL-FILE TO
  4316         DFHEIV20
  4317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4318
  4319
  4320     IF CF-LAST-MAINT-BY     NOT = PI-UPDATE-BY    OR
  4321        CF-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS
  4322
  4323* EXEC CICS UNLOCK
  4324*            DATASET(ELCNTL-ID)
  4325*        END-EXEC
  4326*    MOVE '&*                    #   #00004082' TO DFHEIV0
  4327     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4328     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4329     MOVE X'2020233030303034303832' TO DFHEIV0(25:11)
  4330     CALL 'kxdfhei1' USING DFHEIV0,
  4331           ELCNTL-ID,
  4332           DFHEIV99
  4333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4334         MOVE ER-0068 TO EMI-ERROR
  4335         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4336         GO TO 1000-SHOW-STATE.
  4337
  4338     MOVE 'D'                    TO JP-RECORD-TYPE.
  4339     MOVE CONTROL-FILE           TO JP-RECORD-AREA.
  4340
  4341* EXEC CICS DELETE
  4342*        DATASET(ELCNTL-ID)
  4343*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  84
* EL106.cbl
  4344*    MOVE '&(                    &   #00004091' TO DFHEIV0
  4345     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4346     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4347     MOVE X'2020233030303034303931' TO DFHEIV0(25:11)
  4348     CALL 'kxdfhei1' USING DFHEIV0,
  4349           ELCNTL-ID,
  4350           DFHEIV99,
  4351           DFHEIV99,
  4352           DFHEIV99,
  4353           DFHEIV99
  4354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4355
  4356
  4357     PERFORM 8400-LOG-JOURNAL-RECORD THRU 8400-EXIT
  4358     MOVE ER-0000 TO EMI-ERROR.
  4359     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4360     MOVE LOW-VALUES  TO EL106AO.
  4361     MOVE -1          TO MAINTL.
  4362     MOVE SPACES      TO PI-PREV-STATE
  4363     MOVE CK-STATE-CD TO STCDO.
  4364     MOVE AL-UANON    TO STCDA.
  4365     GO TO 8100-SEND-INITIAL-MAP.
  4366
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  85
* EL106.cbl
  4368 5000-FIND-NEXT-STATE.
  4369     MOVE PI-COMPANY-ID  TO CK-COMP-ID.
  4370
  4371     IF STCDL = 0
  4372         MOVE LOW-VALUES TO CK-STATE-CD
  4373         MOVE +0         TO CK-SEQ
  4374     ELSE
  4375         MOVE STCDI      TO CK-STATE-CD
  4376         MOVE +1         TO CK-SEQ.
  4377
  4378     MOVE SPACES TO PI-PREV-STATE.
  4379
  4380
  4381* EXEC CICS HANDLE CONDITION
  4382*        NOTFND (8860-ENDFILE)
  4383*    END-EXEC.
  4384*    MOVE '"$I                   ! % #00004118' TO DFHEIV0
  4385     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4387     MOVE X'2520233030303034313138' TO DFHEIV0(25:11)
  4388     CALL 'kxdfhei1' USING DFHEIV0
  4389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4390
  4391
  4392
  4393* EXEC CICS READ
  4394*        DATASET(ELCNTL-ID)
  4395*        SET    (ADDRESS OF CONTROL-FILE)
  4396*        RIDFLD (ELCNTL-KEY)
  4397*        GTEQ
  4398*    END-EXEC.
  4399*    MOVE '&"S        G          (   #00004122' TO DFHEIV0
  4400     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4401     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4402     MOVE X'2020233030303034313232' TO DFHEIV0(25:11)
  4403     CALL 'kxdfhei1' USING DFHEIV0,
  4404           ELCNTL-ID,
  4405           DFHEIV20,
  4406           DFHEIV99,
  4407           ELCNTL-KEY,
  4408           DFHEIV99,
  4409           DFHEIV99,
  4410           DFHEIV99
  4411     SET ADDRESS OF CONTROL-FILE TO
  4412         DFHEIV20
  4413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4414
  4415
  4416     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4417        CF-RECORD-TYPE NOT = '3'
  4418         GO TO 8860-ENDFILE.
  4419
  4420     IF STCDL = 0
  4421         MOVE ER-0146 TO EMI-ERROR
  4422         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4423
  4424     GO TO 7000-BUILD-OUTPUT-MAP.
  4425
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  86
* EL106.cbl
  4427 5500-FIND-PREV-STATE.
  4428     MOVE PI-COMPANY-ID          TO  CK-COMP-ID.
  4429     MOVE PI-PREV-STATE          TO  CK-STATE-CD.
  4430
  4431     IF STCDL GREATER +0
  4432         MOVE STCDI              TO  CK-STATE-CD.
  4433
  4434     MOVE SPACES                 TO  PI-PREV-STATE.
  4435
  4436
  4437* EXEC CICS HANDLE CONDITION
  4438*        NOTFND(8860-ENDFILE)
  4439*    END-EXEC.
  4440*    MOVE '"$I                   ! & #00004149' TO DFHEIV0
  4441     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4443     MOVE X'2620233030303034313439' TO DFHEIV0(25:11)
  4444     CALL 'kxdfhei1' USING DFHEIV0
  4445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4446
  4447
  4448
  4449* EXEC CICS STARTBR
  4450*        DATASET  (ELCNTL-ID)
  4451*        RIDFLD   (ELCNTL-KEY)
  4452*    END-EXEC.
  4453     MOVE 0
  4454       TO DFHEIV11
  4455*    MOVE '&,         G          &   #00004153' TO DFHEIV0
  4456     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4458     MOVE X'2020233030303034313533' TO DFHEIV0(25:11)
  4459     CALL 'kxdfhei1' USING DFHEIV0,
  4460           ELCNTL-ID,
  4461           ELCNTL-KEY,
  4462           DFHEIV99,
  4463           DFHEIV11,
  4464           DFHEIV99
  4465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4466
  4467
  4468 5600-READ-PREV-STATE-RECORD.
  4469
  4470* EXEC CICS READPREV
  4471*        DATASET  (ELCNTL-ID)
  4472*        SET      (ADDRESS OF CONTROL-FILE)
  4473*        RIDFLD   (ELCNTL-KEY)
  4474*    END-EXEC.
  4475     MOVE 0
  4476       TO DFHEIV11
  4477*    MOVE '&0S                   )   #00004159' TO DFHEIV0
  4478     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4479     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4480     MOVE X'2020233030303034313539' TO DFHEIV0(25:11)
  4481     CALL 'kxdfhei1' USING DFHEIV0,
  4482           ELCNTL-ID,
  4483           DFHEIV20,
  4484           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  87
* EL106.cbl
  4485           ELCNTL-KEY,
  4486           DFHEIV99,
  4487           DFHEIV11,
  4488           DFHEIV99,
  4489           DFHEIV99
  4490     SET ADDRESS OF CONTROL-FILE TO
  4491         DFHEIV20
  4492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4493
  4494
  4495     IF FIRST-TIME
  4496         MOVE 'N'                TO  WS-FIRST-TIME-SW
  4497         GO TO 5600-READ-PREV-STATE-RECORD.
  4498
  4499     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID  OR
  4500        CF-RECORD-TYPE NOT = '3'
  4501         GO TO 8860-ENDFILE.
  4502
  4503     IF STCDL = 0
  4504         MOVE ER-0146 TO EMI-ERROR
  4505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4506
  4507     GO TO 7000-BUILD-OUTPUT-MAP.
  4508
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  88
* EL106.cbl
  4510 6000-EDIT-INPUT-DATA.
  4511     IF STABRL = ZEROS AND MAINTI = 'A'
  4512        MOVE -1  TO STABRL
  4513        MOVE ER-0152 TO EMI-ERROR
  4514        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4515
  4516     IF STNAMEL = ZEROS AND MAINTI = 'A'
  4517        MOVE -1   TO STNAMEL
  4518        MOVE ER-0153 TO EMI-ERROR
  4519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4520
  4521     IF LFEXPL NOT = ZEROS
  4522
  4523* EXEC CICS BIF
  4524*            DEEDIT
  4525*            FIELD (LFEXPI)
  4526*            LENGTH(7)
  4527*       END-EXEC
  4528     MOVE 7
  4529       TO DFHEIV11
  4530*    MOVE '@"L                   #   #00004192' TO DFHEIV0
  4531     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4532     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4533     MOVE X'2020233030303034313932' TO DFHEIV0(25:11)
  4534     CALL 'kxdfhei1' USING DFHEIV0,
  4535           LFEXPI,
  4536           DFHEIV11
  4537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4538      IF LFEXPI NUMERIC
  4539            MOVE AL-UNNON        TO LFEXPA
  4540            MOVE LFEXPI          TO WS-ST-LF-EXP-PCT
  4541        ELSE
  4542            MOVE ER-7531         TO EMI-ERROR
  4543            MOVE -1              TO LFEXPL
  4544            MOVE AL-UNBON        TO LFEXPA
  4545            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4546
  4547     IF AHEXPL NOT = ZEROS
  4548
  4549* EXEC CICS BIF
  4550*            DEEDIT
  4551*            FIELD (AHEXPI)
  4552*            LENGTH(7)
  4553*       END-EXEC
  4554     MOVE 7
  4555       TO DFHEIV11
  4556*    MOVE '@"L                   #   #00004207' TO DFHEIV0
  4557     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4558     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4559     MOVE X'2020233030303034323037' TO DFHEIV0(25:11)
  4560     CALL 'kxdfhei1' USING DFHEIV0,
  4561           AHEXPI,
  4562           DFHEIV11
  4563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4564      IF AHEXPI NUMERIC
  4565            MOVE AL-UNNON        TO AHEXPA
  4566            MOVE AHEXPI          TO WS-ST-AH-EXP-PCT
  4567        ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  89
* EL106.cbl
  4568            MOVE ER-7531         TO EMI-ERROR
  4569            MOVE -1              TO AHEXPL
  4570            MOVE AL-UNBON        TO AHEXPA
  4571            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4572
  4573     IF QUOTCALL NOT = ZEROS
  4574
  4575* EXEC CICS BIF
  4576*            DEEDIT
  4577*            FIELD (QUOTCALI)
  4578*            LENGTH(6)
  4579*       END-EXEC
  4580     MOVE 6
  4581       TO DFHEIV11
  4582*    MOVE '@"L                   #   #00004222' TO DFHEIV0
  4583     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4584     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4585     MOVE X'2020233030303034323232' TO DFHEIV0(25:11)
  4586     CALL 'kxdfhei1' USING DFHEIV0,
  4587           QUOTCALI,
  4588           DFHEIV11
  4589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4590        IF QUOTCALI NOT NUMERIC
  4591           MOVE -1               TO QUOTCALL
  4592           MOVE AL-UNBON         TO QUOTCALA
  4593           MOVE ER-2009          TO EMI-ERROR
  4594           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4595        ELSE
  4596        IF QUOTCALI GREATER THAN 9999
  4597           MOVE -1               TO QUOTCALL
  4598           MOVE AL-UNBON         TO QUOTCALA
  4599           MOVE ER-2009          TO EMI-ERROR
  4600           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4601
  4602     IF OVSAMTL NOT = ZEROS
  4603
  4604* EXEC CICS BIF
  4605*            DEEDIT
  4606*            FIELD (OVSAMTI)
  4607*            LENGTH(6)
  4608*       END-EXEC
  4609     MOVE 6
  4610       TO DFHEIV11
  4611*    MOVE '@"L                   #   #00004240' TO DFHEIV0
  4612     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4613     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4614     MOVE X'2020233030303034323430' TO DFHEIV0(25:11)
  4615     CALL 'kxdfhei1' USING DFHEIV0,
  4616           OVSAMTI,
  4617           DFHEIV11
  4618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4619        IF OVSAMTI  NOT NUMERIC
  4620           MOVE -1               TO OVSAMTL
  4621           MOVE AL-UNBON         TO OVSAMTA
  4622           MOVE ER-2010          TO EMI-ERROR
  4623           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4624        ELSE
  4625        IF OVSAMTI  GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  90
* EL106.cbl
  4626           MOVE -1               TO OVSAMTL
  4627           MOVE AL-UNBON         TO OVSAMTA
  4628           MOVE ER-2010          TO EMI-ERROR
  4629           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4630
  4631     IF PREMTOLL NOT = ZEROS
  4632
  4633* EXEC CICS BIF
  4634*            DEEDIT
  4635*            FIELD (PREMTOLI)
  4636*            LENGTH(6)
  4637*       END-EXEC
  4638     MOVE 6
  4639       TO DFHEIV11
  4640*    MOVE '@"L                   #   #00004258' TO DFHEIV0
  4641     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4642     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4643     MOVE X'2020233030303034323538' TO DFHEIV0(25:11)
  4644     CALL 'kxdfhei1' USING DFHEIV0,
  4645           PREMTOLI,
  4646           DFHEIV11
  4647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4648        IF PREMTOLI NOT NUMERIC
  4649           MOVE -1               TO PREMTOLL
  4650           MOVE AL-UNBON         TO PREMTOLA
  4651           MOVE ER-2010          TO EMI-ERROR
  4652           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4653        ELSE
  4654        IF PREMTOLI GREATER THAN 9999
  4655           MOVE -1               TO PREMTOLL
  4656           MOVE AL-UNBON         TO PREMTOLA
  4657           MOVE ER-2010          TO EMI-ERROR
  4658           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4659
  4660     IF REFTOLL NOT = ZEROS
  4661
  4662* EXEC CICS BIF
  4663*            DEEDIT
  4664*            FIELD(REFTOLI)
  4665*            LENGTH(6)
  4666*       END-EXEC
  4667     MOVE 6
  4668       TO DFHEIV11
  4669*    MOVE '@"L                   #   #00004276' TO DFHEIV0
  4670     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4671     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4672     MOVE X'2020233030303034323736' TO DFHEIV0(25:11)
  4673     CALL 'kxdfhei1' USING DFHEIV0,
  4674           REFTOLI,
  4675           DFHEIV11
  4676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4677        IF REFTOLI NOT NUMERIC
  4678           MOVE -1               TO REFTOLL
  4679           MOVE AL-UNBON         TO REFTOLA
  4680           MOVE ER-2014          TO EMI-ERROR
  4681           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4682        ELSE
  4683        IF REFTOLI GREATER THAN 9999
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  91
* EL106.cbl
  4684           MOVE -1               TO REFTOLL
  4685           MOVE AL-UNBON         TO REFTOLA
  4686           MOVE ER-2014          TO EMI-ERROR
  4687           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4688
  4689     IF CLREJECL NOT = ZEROS
  4690        IF CLREJECI = SPACES OR '1'
  4691           NEXT SENTENCE
  4692          ELSE
  4693           MOVE -1               TO CLREJECL
  4694           MOVE AL-UABON         TO CLREJECA
  4695           MOVE ER-2024          TO EMI-ERROR
  4696           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4697
  4698     IF ISSREJL NOT = ZEROS
  4699        IF ISSREJI = SPACES OR '1'
  4700           NEXT SENTENCE
  4701          ELSE
  4702           MOVE -1               TO ISSREJL
  4703           MOVE AL-UABON         TO ISSREJA
  4704           MOVE ER-2012          TO EMI-ERROR
  4705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4706
  4707     IF REFREJL NOT = ZEROS
  4708        IF REFREJI = SPACES OR '1'
  4709           NEXT SENTENCE
  4710          ELSE
  4711           MOVE -1               TO REFREJL
  4712           MOVE AL-UABON         TO REFREJA
  4713           MOVE ER-2028          TO EMI-ERROR
  4714           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4715
  4716     IF REFMINL NOT = ZEROS
  4717
  4718* EXEC CICS BIF
  4719*            DEEDIT
  4720*            FIELD (REFMINI)
  4721*            LENGTH(6)
  4722*       END-EXEC
  4723     MOVE 6
  4724       TO DFHEIV11
  4725*    MOVE '@"L                   #   #00004321' TO DFHEIV0
  4726     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4727     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4728     MOVE X'2020233030303034333231' TO DFHEIV0(25:11)
  4729     CALL 'kxdfhei1' USING DFHEIV0,
  4730           REFMINI,
  4731           DFHEIV11
  4732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4733        IF REFMINI NOT NUMERIC
  4734           MOVE -1               TO REFMINL
  4735           MOVE AL-UNBON         TO REFMINA
  4736           MOVE ER-3030          TO EMI-ERROR
  4737           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4738
  4739     IF REFDAY1L NOT = ZERO
  4740        IF REFDAY1I LESS '00' OR GREATER '31'
  4741            MOVE -1               TO REFDAY1L
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  92
* EL106.cbl
  4742            MOVE AL-UNBON         TO REFDAY1A
  4743            MOVE ER-3031          TO EMI-ERROR
  4744            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4745
  4746     IF REFDAYSL NOT = ZERO
  4747        IF REFDAYSI LESS '00' OR GREATER '31'
  4748            MOVE -1               TO REFDAYSL
  4749            MOVE AL-UNBON         TO REFDAYSA
  4750            MOVE ER-3031          TO EMI-ERROR
  4751            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4752
  4753     IF SPLPMTL NOT = ZERO
  4754        IF (SPLPMTI IS EQUAL TO 'Y' OR 'N' OR ' ')
  4755            NEXT SENTENCE
  4756        ELSE
  4757            MOVE -1               TO SPLPMTL
  4758            MOVE AL-UABON         TO SPLPMTA
  4759            MOVE ER-0805          TO EMI-ERROR
  4760            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4761
  4762     IF EXTDAYSL NOT = ZERO
  4763        IF EXTDAYSI NOT NUMERIC
  4764            MOVE -1               TO EXTDAYSL
  4765            MOVE AL-UNBON         TO EXTDAYSA
  4766            MOVE ER-3032          TO EMI-ERROR
  4767            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4768
  4769*    IF INTDAYSL NOT = ZERO
  4770*       IF INTDAYSI NOT NUMERIC
  4771*           MOVE -1               TO INTDAYSL
  4772*           MOVE AL-UNBON         TO INTDAYSA
  4773*           MOVE ER-0141          TO EMI-ERROR
  4774*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4775
  4776     IF EXTCHGL NOT = ZEROS
  4777        IF EXTCHGI = SPACES OR '1' OR '2' OR '3'
  4778           NEXT SENTENCE
  4779          ELSE
  4780           MOVE -1               TO EXTCHGL
  4781           MOVE AL-UABON         TO EXTCHGA
  4782           MOVE ER-3033          TO EMI-ERROR
  4783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4784
  4785     IF REMTERML NOT = ZEROS
  4786        IF (REMTERMI = ' ') OR
  4787           (REMTERMI > '0' AND < '8')
  4788           CONTINUE
  4789        ELSE
  4790           MOVE -1               TO REMTERML
  4791           MOVE AL-UABON         TO REMTERMA
  4792           MOVE ER-2298          TO EMI-ERROR
  4793           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4794        END-IF
  4795     END-IF
  4796
  4797     IF LFREDL NOT = ZEROS
  4798        IF LFREDI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4799                 OR '6' OR '8' OR '9'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  93
* EL106.cbl
  4800           CONTINUE
  4801        ELSE
  4802           MOVE -1               TO LFREDL
  4803           MOVE AL-UABON         TO LFREDA
  4804           MOVE ER-0582          TO EMI-ERROR
  4805           PERFORM 9900-ERROR-FORMAT
  4806                                 THRU 9900-EXIT
  4807        END-IF
  4808     END-IF
  4809
  4810     IF LFLEVL NOT = ZEROS
  4811        IF LFLEVI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4812                 OR '6' OR '8' OR '9'
  4813           CONTINUE
  4814        ELSE
  4815           MOVE -1               TO LFLEVL
  4816           MOVE AL-UABON         TO LFLEVA
  4817           MOVE ER-0582          TO EMI-ERROR
  4818           PERFORM 9900-ERROR-FORMAT
  4819                                 THRU 9900-EXIT
  4820        END-IF
  4821     END-IF
  4822
  4823     IF LFNETL NOT = ZEROS
  4824        IF LFNETI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4825                 OR '6' OR '8' OR '9'
  4826           CONTINUE
  4827        ELSE
  4828           MOVE -1               TO LFNETL
  4829           MOVE AL-UABON         TO LFNETA
  4830           MOVE ER-0582          TO EMI-ERROR
  4831           PERFORM 9900-ERROR-FORMAT
  4832                                 THRU 9900-EXIT
  4833        END-IF
  4834     END-IF
  4835
  4836     IF AHAHL  NOT = ZEROS
  4837        IF AHAHI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4838                 OR '6' OR '8' OR '9'
  4839           CONTINUE
  4840        ELSE
  4841           MOVE -1               TO AHAHL
  4842           MOVE AL-UABON         TO AHAHA
  4843           MOVE ER-0582          TO EMI-ERROR
  4844           PERFORM 9900-ERROR-FORMAT
  4845                                 THRU 9900-EXIT
  4846        END-IF
  4847     END-IF
  4848
  4849     IF AHCPL  NOT = ZEROS
  4850        IF AHCPI  = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4851                 OR '6' OR '8' OR '9'
  4852           CONTINUE
  4853        ELSE
  4854           MOVE -1               TO AHCPL
  4855           MOVE AL-UABON         TO AHCPA
  4856           MOVE ER-0582          TO EMI-ERROR
  4857           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  94
* EL106.cbl
  4858                                 THRU 9900-EXIT
  4859        END-IF
  4860     END-IF
  4861
  4862     IF STUEL NOT = ZEROS
  4863        IF STUEI = ' ' OR '1' OR '2' OR '3' OR '4' OR '5'
  4864           NEXT SENTENCE
  4865          ELSE
  4866           MOVE -1               TO STUEL
  4867           MOVE AL-UABON         TO STUEA
  4868           MOVE ER-3034          TO EMI-ERROR
  4869           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4870
  4871     IF STCNTLL NOT = ZEROS
  4872        IF STCNTLI = SPACES
  4873           NEXT SENTENCE
  4874        ELSE
  4875           IF STCNTLI = '1' OR '2' OR '3' OR '4' OR
  4876                        '5' OR '6' OR '7' OR '8' OR
  4877                        '9' OR 'A' OR 'B' OR 'X'
  4878              NEXT SENTENCE
  4879           ELSE
  4880              MOVE -1               TO STCNTLL
  4881              MOVE AL-UABON         TO STCNTLA
  4882              MOVE ER-3035          TO EMI-ERROR
  4883              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4884
  4885     IF  REPLAWL GREATER THAN ZEROS
  4886         IF  REPLAWI = 'Y'
  4887             MOVE REPLAWI        TO REPLAWO
  4888             MOVE AL-UANON       TO REPLAWA
  4889         ELSE
  4890             IF  REPLAWI = 'N' OR SPACES OR LOW-VALUES
  4891                 MOVE 'N'        TO REPLAWO
  4892                 MOVE AL-UANON   TO REPLAWA
  4893             ELSE
  4894                 MOVE ER-9074    TO EMI-ERROR
  4895                 MOVE -1         TO REPLAWL
  4896                 MOVE AL-UABON   TO REPLAWA
  4897                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4898
  4899     IF  REPLETRL GREATER THAN +0
  4900         IF  REPLAWI = 'Y'
  4901             IF  REPLETRI GREATER THAN SPACES
  4902                 MOVE SPACES     TO W-WORKING-TEXT-KEY
  4903                 MOVE PI-COMPANY-CD
  4904                                 TO W-TEXT-COMPANY-CD
  4905                 MOVE REPLETRI   TO W-TEXT-FORM-NO
  4906                 MOVE +1         TO W-TEXT-LINE-SEQ
  4907
  4908* EXEC CICS HANDLE CONDITION
  4909*                    NOTFND   (6010-LETR-NOT-FOUND)
  4910*                    ENDFILE  (6010-LETR-NOT-FOUND)
  4911*                    NOTOPEN  (8890-LETR-NOT-OPEN)
  4912*                END-EXEC
  4913*    MOVE '"$I''J                 ! '' #00004500' TO DFHEIV0
  4914     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  4915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  95
* EL106.cbl
  4916     MOVE X'2720233030303034353030' TO DFHEIV0(25:11)
  4917     CALL 'kxdfhei1' USING DFHEIV0
  4918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4919
  4920* EXEC CICS READ
  4921*                    SET     (ADDRESS OF TEXT-FILES)
  4922*                    DATASET (ELLETR-ID)
  4923*                    RIDFLD  (W-WORKING-TEXT-KEY)
  4924*                END-EXEC
  4925*    MOVE '&"S        E          (   #00004505' TO DFHEIV0
  4926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4927     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4928     MOVE X'2020233030303034353035' TO DFHEIV0(25:11)
  4929     CALL 'kxdfhei1' USING DFHEIV0,
  4930           ELLETR-ID,
  4931           DFHEIV20,
  4932           DFHEIV99,
  4933           W-WORKING-TEXT-KEY,
  4934           DFHEIV99,
  4935           DFHEIV99,
  4936           DFHEIV99
  4937     SET ADDRESS OF TEXT-FILES TO
  4938         DFHEIV20
  4939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4940                 MOVE AL-UANON   TO REPLETRA
  4941             ELSE
  4942                 MOVE ER-9448    TO EMI-ERROR
  4943                 MOVE -1         TO REPLETRL
  4944                 MOVE AL-UABON   TO REPLETRA
  4945                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4946         ELSE
  4947             IF  REPLETRI EQUAL SPACES OR LOW-VALUES
  4948                 MOVE LOW-VALUES TO REPLETRO
  4949                 MOVE AL-UANON   TO REPLETRA
  4950             ELSE
  4951                 MOVE ER-9478    TO EMI-ERROR
  4952                 MOVE -1         TO REPLAWL
  4953                 MOVE AL-UABON   TO REPLAWA
  4954                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4955     ELSE
  4956         IF  REPLAWI = 'Y'
  4957             MOVE ER-9448        TO EMI-ERROR
  4958             MOVE -1             TO REPLETRL
  4959             MOVE AL-UABON       TO REPLETRA
  4960             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4961
  4962     IF LIMITL GREATER ZEROS
  4963         IF LIMITI = 'A'
  4964             MOVE LIMITI         TO LIMITO
  4965             MOVE AL-UANON       TO LIMITA
  4966          ELSE
  4967             IF LIMITI = SPACES OR LOW-VALUES
  4968                 MOVE ' '        TO LIMITO
  4969                 MOVE AL-UANON   TO LIMITA
  4970         ELSE
  4971             MOVE ER-2137    TO EMI-ERROR
  4972             MOVE -1         TO LIMITL
  4973             MOVE AL-UABON   TO LIMITA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  96
* EL106.cbl
  4974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4975
  4976*    IF STATIL GREATER ZEROS
  4977*        IF STATII = 'I' OR 'R'
  4978*            MOVE STATII         TO STATIO
  4979*            MOVE AL-UANON       TO STATIA
  4980*         ELSE
  4981*            IF STATII = SPACES OR LOW-VALUES
  4982*                MOVE ' '        TO STATIO
  4983*                MOVE AL-UANON   TO STATIA
  4984*        ELSE
  4985*            MOVE ER-7346    TO EMI-ERROR
  4986*            MOVE -1         TO STATIL
  4987*            MOVE AL-UABON   TO STATIA
  4988*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4989
  4990     IF COMSLL GREATER ZEROS
  4991
  4992* EXEC CICS BIF
  4993*            DEEDIT
  4994*            FIELD (COMSLI)
  4995*            LENGTH(6)
  4996*       END-EXEC
  4997     MOVE 6
  4998       TO DFHEIV11
  4999*    MOVE '@"L                   #   #00004561' TO DFHEIV0
  5000     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5001     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5002     MOVE X'2020233030303034353631' TO DFHEIV0(25:11)
  5003     CALL 'kxdfhei1' USING DFHEIV0,
  5004           COMSLI,
  5005           DFHEIV11
  5006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5007      IF COMSLI NUMERIC
  5008            MOVE AL-UNNON        TO COMSLA
  5009            MOVE COMSLI          TO WS-COMSL
  5010                                    COMSLO
  5011        ELSE
  5012            MOVE ER-1614         TO EMI-ERROR
  5013            MOVE -1              TO COMSLL
  5014            MOVE AL-UNBON        TO COMSLA
  5015            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5016
  5017     IF COMJLL GREATER ZEROS
  5018
  5019* EXEC CICS BIF
  5020*            DEEDIT
  5021*            FIELD (COMJLI)
  5022*            LENGTH(6)
  5023*       END-EXEC
  5024     MOVE 6
  5025       TO DFHEIV11
  5026*    MOVE '@"L                   #   #00004577' TO DFHEIV0
  5027     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5028     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5029     MOVE X'2020233030303034353737' TO DFHEIV0(25:11)
  5030     CALL 'kxdfhei1' USING DFHEIV0,
  5031           COMJLI,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  97
* EL106.cbl
  5032           DFHEIV11
  5033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5034      IF COMJLI NUMERIC
  5035            MOVE AL-UNNON        TO COMJLA
  5036            MOVE COMJLI          TO WS-COMJL
  5037                                    COMJLO
  5038        ELSE
  5039            MOVE ER-1614         TO EMI-ERROR
  5040            MOVE -1              TO COMJLL
  5041            MOVE AL-UNBON        TO COMJLA
  5042            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5043
  5044     IF COMSAL GREATER ZEROS
  5045
  5046* EXEC CICS BIF
  5047*            DEEDIT
  5048*            FIELD (COMSAI)
  5049*            LENGTH(6)
  5050*       END-EXEC
  5051     MOVE 6
  5052       TO DFHEIV11
  5053*    MOVE '@"L                   #   #00004593' TO DFHEIV0
  5054     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5056     MOVE X'2020233030303034353933' TO DFHEIV0(25:11)
  5057     CALL 'kxdfhei1' USING DFHEIV0,
  5058           COMSAI,
  5059           DFHEIV11
  5060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5061      IF COMSAI NUMERIC
  5062            MOVE AL-UNNON        TO COMSAA
  5063            MOVE COMSAI          TO WS-COMSA
  5064                                    COMSAO
  5065        ELSE
  5066            MOVE ER-1614         TO EMI-ERROR
  5067            MOVE -1              TO COMSAL
  5068            MOVE AL-UNBON        TO COMSAA
  5069            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5070
  5071     IF COMJAL GREATER ZEROS
  5072
  5073* EXEC CICS BIF
  5074*            DEEDIT
  5075*            FIELD (COMJAI)
  5076*            LENGTH(6)
  5077*       END-EXEC
  5078     MOVE 6
  5079       TO DFHEIV11
  5080*    MOVE '@"L                   #   #00004609' TO DFHEIV0
  5081     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5082     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5083     MOVE X'2020233030303034363039' TO DFHEIV0(25:11)
  5084     CALL 'kxdfhei1' USING DFHEIV0,
  5085           COMJAI,
  5086           DFHEIV11
  5087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5088      IF COMJAI NUMERIC
  5089            MOVE AL-UNNON        TO COMJAA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  98
* EL106.cbl
  5090            MOVE COMJAI          TO WS-COMJA
  5091                                    COMJAO
  5092        ELSE
  5093            MOVE ER-1614         TO EMI-ERROR
  5094            MOVE -1              TO COMJAL
  5095            MOVE AL-UNBON        TO COMJAA
  5096            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5097
  5098     IF RESTAXL GREATER ZEROS
  5099
  5100* EXEC CICS BIF
  5101*            DEEDIT
  5102*            FIELD (RESTAXI)
  5103*            LENGTH(6)
  5104*       END-EXEC
  5105     MOVE 6
  5106       TO DFHEIV11
  5107*    MOVE '@"L                   #   #00004625' TO DFHEIV0
  5108     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5109     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5110     MOVE X'2020233030303034363235' TO DFHEIV0(25:11)
  5111     CALL 'kxdfhei1' USING DFHEIV0,
  5112           RESTAXI,
  5113           DFHEIV11
  5114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5115      IF RESTAXI NUMERIC
  5116            MOVE AL-UNNON        TO RESTAXA
  5117            MOVE RESTAXI         TO WS-RESIDENT-TAX
  5118                                    RESTAXO
  5119        ELSE
  5120            MOVE ER-1614         TO EMI-ERROR
  5121            MOVE -1              TO RESTAXL
  5122            MOVE AL-UNBON        TO RESTAXA
  5123            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5124
  5125     IF FREELKI  NUMERIC
  5126            MOVE AL-UNNON        TO FREELKA
  5127            MOVE FREELKI         TO WS-FREE-LOOK-DAYS
  5128                                    FREELKO
  5129        ELSE
  5130            MOVE -1               TO FREELKL
  5131            MOVE AL-UNBON         TO FREELKA
  5132            MOVE ER-8159          TO EMI-ERROR
  5133            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5134
  5135*    IF STATRL GREATER ZEROS
  5136*       EXEC CICS BIF
  5137*            DEEDIT
  5138*            FIELD (STATRI)
  5139*            LENGTH(6)
  5140*       END-EXEC
  5141*     IF STATRI NUMERIC
  5142*           MOVE AL-UNNON        TO STATRA
  5143*           MOVE STATRI          TO WS-IRATE
  5144*                                   STATRO
  5145*       ELSE
  5146*           MOVE ER-1614         TO EMI-ERROR
  5147*           MOVE -1              TO STATRL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page  99
* EL106.cbl
  5148*           MOVE AL-UNBON        TO STATRA
  5149*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5150
  5151*    IF STATR1L GREATER ZEROS
  5152*       EXEC CICS BIF
  5153*            DEEDIT
  5154*            FIELD (STATR1I)
  5155*            LENGTH(6)
  5156*       END-EXEC
  5157*     IF STATR1I NUMERIC
  5158*           MOVE AL-UNNON        TO STATR1A
  5159*           MOVE STATR1I         TO WS-IRATE1
  5160*                                   STATR1O
  5161*       ELSE
  5162*           MOVE ER-1614         TO EMI-ERROR
  5163*           MOVE -1              TO STATR1L
  5164*           MOVE AL-UNBON        TO STATR1A
  5165*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5166*
  5167*    IF STATR2L GREATER ZEROS
  5168*       EXEC CICS BIF
  5169*            DEEDIT
  5170*            FIELD (STATR2I)
  5171*            LENGTH(6)
  5172*       END-EXEC
  5173*     IF STATR2I NUMERIC
  5174*           MOVE AL-UNNON        TO STATR2A
  5175*           MOVE STATR2I         TO WS-IRATE2
  5176*                                   STATR2O
  5177*       ELSE
  5178*           MOVE ER-1614         TO EMI-ERROR
  5179*           MOVE -1              TO STATR2L
  5180*           MOVE AL-UNBON        TO STATR2A
  5181*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5182*
  5183*    IF STATR3L GREATER ZEROS
  5184*       EXEC CICS BIF
  5185*            DEEDIT
  5186*            FIELD (STATR3I)
  5187*            LENGTH(6)
  5188*       END-EXEC
  5189*     IF STATR3I NUMERIC
  5190*           MOVE AL-UNNON        TO STATR3A
  5191*           MOVE STATR3I         TO WS-IRATE3
  5192*                                   STATR3O
  5193*       ELSE
  5194*           MOVE ER-1614         TO EMI-ERROR
  5195*           MOVE -1              TO STATR3L
  5196*           MOVE AL-UNBON        TO STATR3A
  5197*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5198
  5199     GO TO 6020-CONTINUE.
  5200
  5201 6010-LETR-NOT-FOUND.
  5202     MOVE ER-9447                TO EMI-ERROR.
  5203     MOVE -1                     TO REPLETRL.
  5204     MOVE AL-UABON               TO REPLETRA.
  5205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 100
* EL106.cbl
  5206
  5207 6020-CONTINUE.
  5208
  5209     IF  TARRATL NOT = ZEROS
  5210
  5211* EXEC CICS BIF
  5212*             DEEDIT
  5213*             FIELD (TARRATI)
  5214*             LENGTH (6)
  5215*        END-EXEC
  5216     MOVE 6
  5217       TO DFHEIV11
  5218*    MOVE '@"L                   #   #00004725' TO DFHEIV0
  5219     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5220     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5221     MOVE X'2020233030303034373235' TO DFHEIV0(25:11)
  5222     CALL 'kxdfhei1' USING DFHEIV0,
  5223           TARRATI,
  5224           DFHEIV11
  5225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5226
  5227         IF  TARRATI NUMERIC
  5228             MOVE AL-UNNON       TO TARRATA
  5229             MOVE TARRATI        TO WS-ST-TARGET-LOSS-RATIO
  5230                                    TARRATO
  5231         ELSE
  5232             MOVE ER-7717        TO EMI-ERROR
  5233             MOVE -1             TO TARRATL
  5234             MOVE AL-UNBON       TO TARRATA
  5235             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5236
  5237     IF  CALCINTL NOT = ZEROS
  5238
  5239* EXEC CICS BIF
  5240*             DEEDIT
  5241*             FIELD (CALCINTI)
  5242*             LENGTH (6)
  5243*        END-EXEC
  5244     MOVE 6
  5245       TO DFHEIV11
  5246*    MOVE '@"L                   #   #00004742' TO DFHEIV0
  5247     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5248     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5249     MOVE X'2020233030303034373432' TO DFHEIV0(25:11)
  5250     CALL 'kxdfhei1' USING DFHEIV0,
  5251           CALCINTI,
  5252           DFHEIV11
  5253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5254
  5255         IF  CALCINTI NUMERIC
  5256             MOVE AL-UNNON       TO CALCINTA
  5257             MOVE CALCINTI       TO WS-ST-CALC-INTEREST
  5258                                    CALCINTO
  5259         ELSE
  5260             MOVE ER-7735        TO EMI-ERROR
  5261             MOVE -1             TO CALCINTL
  5262             MOVE AL-UNBON       TO CALCINTA
  5263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 101
* EL106.cbl
  5264
  5265     IF PRMPCTL NOT = ZEROS
  5266
  5267* EXEC CICS BIF
  5268*            DEEDIT
  5269*            FIELD (PRMPCTI)
  5270*            LENGTH(5)
  5271*       END-EXEC
  5272     MOVE 5
  5273       TO DFHEIV11
  5274*    MOVE '@"L                   #   #00004759' TO DFHEIV0
  5275     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5276     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5277     MOVE X'2020233030303034373539' TO DFHEIV0(25:11)
  5278     CALL 'kxdfhei1' USING DFHEIV0,
  5279           PRMPCTI,
  5280           DFHEIV11
  5281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5282      IF PRMPCTI NUMERIC
  5283            MOVE AL-UNNON        TO PRMPCTA
  5284            MOVE PRMPCTI         TO WS-ST-TOL-PREM-PCT
  5285        ELSE
  5286            MOVE ER-7532         TO EMI-ERROR
  5287            MOVE -1              TO PRMPCTL
  5288            MOVE AL-UNBON        TO PRMPCTA
  5289            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5290
  5291     IF OVSPCTL NOT = ZEROS
  5292
  5293* EXEC CICS BIF
  5294*            DEEDIT
  5295*            FIELD (OVSPCTI)
  5296*            LENGTH(5)
  5297*       END-EXEC
  5298     MOVE 5
  5299       TO DFHEIV11
  5300*    MOVE '@"L                   #   #00004774' TO DFHEIV0
  5301     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5302     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5303     MOVE X'2020233030303034373734' TO DFHEIV0(25:11)
  5304     CALL 'kxdfhei1' USING DFHEIV0,
  5305           OVSPCTI,
  5306           DFHEIV11
  5307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5308      IF OVSPCTI NUMERIC
  5309            MOVE AL-UNNON        TO OVSPCTA
  5310            MOVE OVSPCTI         TO WS-ST-OVR-SHT-PCT
  5311        ELSE
  5312            MOVE ER-7532         TO EMI-ERROR
  5313            MOVE -1              TO OVSPCTL
  5314            MOVE AL-UNBON        TO OVSPCTA
  5315            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5316
  5317     IF REFPCTL NOT = ZEROS
  5318
  5319* EXEC CICS BIF
  5320*            DEEDIT
  5321*            FIELD (REFPCTI)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 102
* EL106.cbl
  5322*            LENGTH(5)
  5323*       END-EXEC
  5324     MOVE 5
  5325       TO DFHEIV11
  5326*    MOVE '@"L                   #   #00004789' TO DFHEIV0
  5327     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5328     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5329     MOVE X'2020233030303034373839' TO DFHEIV0(25:11)
  5330     CALL 'kxdfhei1' USING DFHEIV0,
  5331           REFPCTI,
  5332           DFHEIV11
  5333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5334      IF REFPCTI NUMERIC
  5335            MOVE AL-UNNON        TO REFPCTA
  5336            MOVE REFPCTI         TO WS-ST-TOL-REF-PCT
  5337        ELSE
  5338            MOVE ER-7532         TO EMI-ERROR
  5339            MOVE -1              TO REFPCTL
  5340            MOVE AL-UNBON        TO REFPCTA
  5341            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5342
  5343     IF LFTAXL NOT = ZEROS
  5344
  5345* EXEC CICS BIF
  5346*            DEEDIT
  5347*            FIELD (LFTAXI)
  5348*            LENGTH(5)
  5349*       END-EXEC
  5350     MOVE 5
  5351       TO DFHEIV11
  5352*    MOVE '@"L                   #   #00004804' TO DFHEIV0
  5353     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5354     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5355     MOVE X'2020233030303034383034' TO DFHEIV0(25:11)
  5356     CALL 'kxdfhei1' USING DFHEIV0,
  5357           LFTAXI,
  5358           DFHEIV11
  5359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5360        IF LFTAXI NUMERIC
  5361           MOVE AL-UNNON         TO LFTAXA
  5362           MOVE LFTAXI           TO WS-ST-LF-PREM-TAX
  5363        ELSE
  5364           MOVE ER-2082          TO EMI-ERROR
  5365           MOVE -1               TO LFTAXL
  5366           MOVE AL-UNBON         TO LFTAXA
  5367           PERFORM 9900-ERROR-FORMAT
  5368                                 THRU 9900-EXIT
  5369        END-IF
  5370     END-IF
  5371
  5372     IF AHITAXL NOT = ZEROS
  5373
  5374* EXEC CICS BIF
  5375*            DEEDIT
  5376*            FIELD (AHITAXI)
  5377*            LENGTH(5)
  5378*       END-EXEC
  5379     MOVE 5
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 103
* EL106.cbl
  5380       TO DFHEIV11
  5381*    MOVE '@"L                   #   #00004822' TO DFHEIV0
  5382     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5383     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5384     MOVE X'2020233030303034383232' TO DFHEIV0(25:11)
  5385     CALL 'kxdfhei1' USING DFHEIV0,
  5386           AHITAXI,
  5387           DFHEIV11
  5388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5389        IF AHITAXI NUMERIC
  5390           MOVE AL-UNNON         TO AHITAXA
  5391           MOVE AHITAXI          TO WS-ST-AH-PREM-TAX-I
  5392        ELSE
  5393           MOVE ER-2084          TO EMI-ERROR
  5394           MOVE -1               TO AHITAXL
  5395           MOVE AL-UNBON         TO AHITAXA
  5396           PERFORM 9900-ERROR-FORMAT
  5397                                 THRU 9900-EXIT
  5398        END-IF
  5399     END-IF
  5400
  5401     IF AHGTAXL NOT = ZEROS
  5402
  5403* EXEC CICS BIF
  5404*            DEEDIT
  5405*            FIELD (AHGTAXI)
  5406*            LENGTH(5)
  5407*       END-EXEC
  5408     MOVE 5
  5409       TO DFHEIV11
  5410*    MOVE '@"L                   #   #00004840' TO DFHEIV0
  5411     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5412     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5413     MOVE X'2020233030303034383430' TO DFHEIV0(25:11)
  5414     CALL 'kxdfhei1' USING DFHEIV0,
  5415           AHGTAXI,
  5416           DFHEIV11
  5417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5418        IF AHGTAXI NUMERIC
  5419           MOVE AL-UNNON         TO AHGTAXA
  5420           MOVE AHGTAXI          TO WS-ST-AH-PREM-TAX-G
  5421        ELSE
  5422           MOVE ER-2084          TO EMI-ERROR
  5423           MOVE -1               TO AHGTAXL
  5424           MOVE AL-UNBON         TO AHGTAXA
  5425           PERFORM 9900-ERROR-FORMAT
  5426                                 THRU 9900-EXIT
  5427        END-IF
  5428     END-IF
  5429
  5430     IF REFCLML NOT = ZEROS
  5431        IF REFCLMI = SPACES OR '1' OR '2' OR '3' OR '4' OR '5'
  5432           NEXT SENTENCE
  5433        ELSE
  5434           MOVE -1               TO REFCLML
  5435           MOVE AL-UABON         TO REFCLMA
  5436           MOVE ER-3036          TO EMI-ERROR
  5437           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 104
* EL106.cbl
  5438        END-IF
  5439     END-IF.
  5440
  5441     IF VFYBENEL NOT = ZEROS
  5442        IF VFYBENEI = SPACES OR 'Y' OR 'N'
  5443           NEXT SENTENCE
  5444        ELSE
  5445           MOVE -1               TO VFYBENEL
  5446           MOVE AL-UABON         TO VFYBENEA
  5447           MOVE ER-3040          TO EMI-ERROR
  5448           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5449        END-IF
  5450     END-IF.
  5451
  5452     .
  5453 6099-EXIT.
  5454     EXIT.
  5455
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 105
* EL106.cbl
  5457 6100-INITIALIZE-BENEFIT-CNTL.
  5458
  5459     MOVE SPACES   TO   CF-ST-BENEFIT-CD         (SUB)
  5460                        CF-ST-BENEFIT-KIND       (SUB)
  5461                        CF-ST-REM-TERM-CALC      (SUB)
  5462                        CF-ST-REFUND-CALC        (SUB)
  5463                        CF-ST-EARNING-CALC       (SUB)
  5464                        CF-ST-OVRD-EARNINGS-CALC (SUB).
  5465
  5466 6199-EXIT.
  5467     EXIT.
  5468
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 106
* EL106.cbl
  5470 6400-CREATE-TEMP-STORAGE.
  5471     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5472
  5473
  5474* EXEC CICS WRITEQ TS
  5475*        QUEUE   (QID)
  5476*        FROM    (EL106AO)
  5477*        LENGTH  (WS-MAP-LENGTH)
  5478*    END-EXEC.
  5479*    MOVE '*"                    ''   #00004900' TO DFHEIV0
  5480     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  5481     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5482     MOVE X'2020233030303034393030' TO DFHEIV0(25:11)
  5483     CALL 'kxdfhei1' USING DFHEIV0,
  5484           QID,
  5485           EL106AO,
  5486           WS-MAP-LENGTH,
  5487           DFHEIV99,
  5488           DFHEIV99,
  5489           DFHEIV99
  5490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5491
  5492
  5493 6400-EXIT.
  5494      EXIT.
  5495
  5496 6500-RECOVER-TEMP-STORAGE.
  5497
  5498* EXEC CICS READQ TS
  5499*        QUEUE   (QID)
  5500*        INTO    (EL106AO)
  5501*        LENGTH  (WS-MAP-LENGTH)
  5502*    END-EXEC.
  5503*    MOVE '*$I    L              ''   #00004910' TO DFHEIV0
  5504     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  5505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5506     MOVE X'2020233030303034393130' TO DFHEIV0(25:11)
  5507     CALL 'kxdfhei1' USING DFHEIV0,
  5508           QID,
  5509           EL106AO,
  5510           WS-MAP-LENGTH,
  5511           DFHEIV99,
  5512           DFHEIV99,
  5513           DFHEIV99
  5514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5515
  5516
  5517     PERFORM 6600-DELETE-TEMP-STORAGE THRU 6600-EXIT.
  5518
  5519 6500-EXIT.
  5520      EXIT.
  5521
  5522 6600-DELETE-TEMP-STORAGE.
  5523
  5524* EXEC CICS HANDLE CONDITION
  5525*        QIDERR  (6600-EXIT)
  5526*    END-EXEC.
  5527*    MOVE '"$N                   ! ( #00004922' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 107
* EL106.cbl
  5528     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  5529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5530     MOVE X'2820233030303034393232' TO DFHEIV0(25:11)
  5531     CALL 'kxdfhei1' USING DFHEIV0
  5532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5533
  5534
  5535
  5536* EXEC CICS DELETEQ TS
  5537*        QUEUE  (QID)
  5538*    END-EXEC.
  5539*    MOVE '*&                    #   #00004926' TO DFHEIV0
  5540     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  5541     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5542     MOVE X'2020233030303034393236' TO DFHEIV0(25:11)
  5543     CALL 'kxdfhei1' USING DFHEIV0,
  5544           QID,
  5545           DFHEIV99
  5546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5547
  5548
  5549 6600-EXIT.
  5550      EXIT.
  5551
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 108
* EL106.cbl
  5553***************************************************************
  5554*                                                             *
  5555*     BUILD THE OUTPUT SCREEN TO BE DISPLAYED                 *
  5556*                                                             *
  5557***************************************************************
  5558 7000-BUILD-OUTPUT-MAP.
  5559     MOVE LOW-VALUES            TO EL106AO.
  5560     MOVE CF-STATE-CODE         TO STCDO
  5561                                   PI-WS-STATE.
  5562     MOVE CF-ST-TOL-CLAIM       TO QUOTCALO.
  5563     MOVE CF-ST-TOL-PREM        TO PREMTOLO.
  5564     MOVE CF-ST-TOL-REFUND      TO REFTOLO.
  5565     MOVE CF-ST-CLAIM-REJECT-SW TO CLREJECO.
  5566     MOVE CF-ST-PREM-REJECT-SW  TO ISSREJO.
  5567     MOVE CF-ST-REF-REJECT-SW   TO REFREJO.
  5568     MOVE CF-ST-FST-PMT-DAYS-CHG
  5569                                TO EXTCHGO.
  5570     MOVE CF-ST-RT-CALC         TO REMTERMO
  5571     MOVE CF-ST-RF-LR-CALC      TO LFREDO
  5572     MOVE CF-ST-RF-LL-CALC      TO LFLEVO
  5573     MOVE CF-ST-RF-LN-CALC      TO LFNETO
  5574     MOVE CF-ST-RF-AH-CALC      TO AHAHO
  5575     MOVE CF-ST-RF-CP-CALC      TO AHCPO
  5576     MOVE CF-ST-CALL-UNEARNED   TO STUEO.
  5577     MOVE CF-ST-CALL-RPT-CNTL   TO STCNTLO.
  5578     MOVE CF-ST-CALL-RATE-DEV   TO STDEVO.
  5579     MOVE CF-STATE-ABBREVIATION TO STABRO.
  5580     MOVE CF-STATE-NAME         TO STNAMEO.
  5581     MOVE CF-ST-REF-AH-DEATH-IND TO REFCLMO.
  5582     MOVE CF-ST-VFY-2ND-BENE    TO VFYBENEO.
  5583     IF  CF-ST-CHECK-COUNTER NUMERIC
  5584        MOVE CF-ST-CHECK-COUNTER TO STCHKNOO
  5585     ELSE
  5586        MOVE ZEROS             TO STCHKNOO
  5587     END-IF.
  5588
  5589     IF CF-ST-LF-EXP-PCT      NUMERIC
  5590         IF CF-ST-LF-EXP-PCT NOT = ZEROS
  5591             MOVE CF-ST-LF-EXP-PCT  TO LFEXPO.
  5592
  5593     IF CF-ST-AH-EXP-PCT      NUMERIC
  5594         IF CF-ST-AH-EXP-PCT NOT = ZEROS
  5595             MOVE CF-ST-AH-EXP-PCT  TO AHEXPO.
  5596
  5597     IF CF-ST-TOL-PREM-PCT    NUMERIC
  5598         IF CF-ST-TOL-PREM-PCT NOT = ZEROS
  5599             MOVE CF-ST-TOL-PREM-PCT TO PRMPCTO.
  5600
  5601     IF CF-ST-OVR-SHT-AMT NUMERIC
  5602        IF CF-ST-OVR-SHT-AMT > ZEROS
  5603           MOVE CF-ST-OVR-SHT-AMT TO OVSAMTO
  5604        END-IF
  5605     END-IF.
  5606
  5607     IF CF-ST-OVR-SHT-PCT NUMERIC
  5608         IF CF-ST-OVR-SHT-PCT > ZEROS
  5609             MOVE CF-ST-OVR-SHT-PCT TO OVSPCTO
  5610         END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 109
* EL106.cbl
  5611     END-IF.
  5612
  5613     IF CF-ST-TOL-REF-PCT     NUMERIC
  5614         IF CF-ST-TOL-REF-PCT NOT = ZEROS
  5615             MOVE CF-ST-TOL-REF-PCT TO REFPCTO.
  5616
  5617     IF CF-ST-REFUND-MIN      NUMERIC
  5618         IF CF-ST-REFUND-MIN NOT = ZEROS
  5619             MOVE CF-ST-REFUND-MIN  TO REFMINO.
  5620
  5621     IF CF-ST-REFUND-DAYS-FIRST NUMERIC
  5622       IF CF-ST-REFUND-DAYS-FIRST NOT = ZEROS
  5623         MOVE CF-ST-REFUND-DAYS-FIRST
  5624                                TO REFDAY1O.
  5625
  5626     IF CF-ST-REFUND-DAYS-SUBSEQ NUMERIC
  5627       IF CF-ST-REFUND-DAYS-SUBSEQ NOT = ZEROS
  5628         MOVE CF-ST-REFUND-DAYS-SUBSEQ
  5629                                TO REFDAYSO.
  5630
  5631     IF CF-ST-SPLIT-PAYMENT IS EQUAL TO ' '
  5632         MOVE 'N'               TO SPLPMTO
  5633     ELSE
  5634         MOVE CF-ST-SPLIT-PAYMENT
  5635                                TO SPLPMTO.
  5636
  5637     IF CF-ST-FST-PMT-DAYS-MAX NUMERIC
  5638       IF CF-ST-FST-PMT-DAYS-MAX NOT = ZEROS
  5639         MOVE CF-ST-FST-PMT-DAYS-MAX
  5640                                TO EXTDAYSO.
  5641
  5642     IF CF-ST-LF-PREM-TAX NUMERIC
  5643        IF CF-ST-LF-PREM-TAX > ZEROS
  5644           MOVE CF-ST-LF-PREM-TAX
  5645                                 TO LFTAXO
  5646        END-IF
  5647     END-IF
  5648
  5649     IF CF-ST-AH-PREM-TAX-I NUMERIC
  5650        IF CF-ST-AH-PREM-TAX-I > ZEROS
  5651           MOVE CF-ST-AH-PREM-TAX-I
  5652                                 TO AHITAXO
  5653        END-IF
  5654     END-IF
  5655
  5656     IF CF-ST-AH-PREM-TAX-G NUMERIC
  5657        IF CF-ST-AH-PREM-TAX-G > ZEROS
  5658           MOVE CF-ST-AH-PREM-TAX-G
  5659                                 TO AHGTAXO
  5660        END-IF
  5661     END-IF
  5662
  5663*    IF PI-COMPANY-ID = 'NCL'
  5664*    IF CF-ST-NO-DAYS-ELAPSED NUMERIC
  5665*      IF CF-ST-NO-DAYS-ELAPSED NOT = ZEROS
  5666*        MOVE CF-ST-NO-DAYS-ELAPSED
  5667*                               TO INTDAYSO.
  5668
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 110
* EL106.cbl
  5669     IF  CF-REPLACEMENT-LAW-SW NOT EQUAL 'Y'
  5670             AND
  5671         CF-REPLACEMENT-LAW-SW NOT EQUAL 'N'
  5672         MOVE 'N'               TO REPLAWO
  5673         MOVE LOW-VALUES        TO REPLETRO
  5674     ELSE
  5675         MOVE CF-REPLACEMENT-LAW-SW
  5676                                TO REPLAWO
  5677
  5678         IF  CF-REPLACEMENT-LETTER GREATER THAN SPACES
  5679             MOVE CF-REPLACEMENT-LETTER
  5680                                TO REPLETRO
  5681         ELSE
  5682             MOVE LOW-VALUES    TO REPLETRO.
  5683
  5684     IF  CF-ST-TARGET-LOSS-RATIO NUMERIC
  5685         IF  CF-ST-TARGET-LOSS-RATIO NOT = ZEROS
  5686             MOVE CF-ST-TARGET-LOSS-RATIO
  5687                                TO TARRATO
  5688         ELSE
  5689             MOVE ZEROS         TO TARRATO
  5690     ELSE
  5691         MOVE ZEROS             TO TARRATO.
  5692
  5693     IF  CF-ST-CALC-INTEREST NUMERIC
  5694         IF  CF-ST-CALC-INTEREST NOT = ZEROS
  5695             MOVE CF-ST-CALC-INTEREST
  5696                                TO CALCINTO
  5697         ELSE
  5698             MOVE ZEROS         TO CALCINTO
  5699     ELSE
  5700         MOVE ZEROS             TO CALCINTO.
  5701
  5702     IF  CF-ST-COMM-CAP-SL NUMERIC
  5703         IF  CF-ST-COMM-CAP-SL NOT = ZEROS
  5704             MOVE CF-ST-COMM-CAP-SL
  5705                                TO COMSLO
  5706         ELSE
  5707             MOVE ZEROS         TO COMSLO
  5708     ELSE
  5709         MOVE ZEROS             TO COMSLO.
  5710
  5711     IF  CF-ST-COMM-CAP-JL NUMERIC
  5712         IF  CF-ST-COMM-CAP-JL NOT = ZEROS
  5713             MOVE CF-ST-COMM-CAP-JL
  5714                                TO COMJLO
  5715         ELSE
  5716             MOVE ZEROS         TO COMJLO
  5717     ELSE
  5718         MOVE ZEROS             TO COMJLO.
  5719
  5720     IF  CF-ST-COMM-CAP-SA NUMERIC
  5721         IF  CF-ST-COMM-CAP-SA NOT = ZEROS
  5722             MOVE CF-ST-COMM-CAP-SA
  5723                                TO COMSAO
  5724         ELSE
  5725             MOVE ZEROS         TO COMSAO
  5726     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 111
* EL106.cbl
  5727         MOVE ZEROS             TO COMSAO.
  5728
  5729     IF  CF-ST-COMM-CAP-JA NUMERIC
  5730         IF  CF-ST-COMM-CAP-JA NOT = ZEROS
  5731             MOVE CF-ST-COMM-CAP-JA
  5732                                TO COMJAO
  5733         ELSE
  5734             MOVE ZEROS         TO COMJAO
  5735     ELSE
  5736         MOVE ZEROS             TO COMJAO.
  5737
  5738     IF  CF-ST-RES-TAX-PCT NUMERIC
  5739         IF  CF-ST-RES-TAX-PCT NOT = ZEROS
  5740             MOVE CF-ST-RES-TAX-PCT
  5741                                TO RESTAXO
  5742         ELSE
  5743             MOVE ZEROS         TO RESTAXO
  5744     ELSE
  5745         MOVE ZEROS             TO RESTAXO.
  5746
  5747     IF CF-ST-FREE-LOOK-PERIOD NUMERIC
  5748        IF CF-ST-FREE-LOOK-PERIOD NOT = ZEROS
  5749             MOVE CF-ST-FREE-LOOK-PERIOD
  5750                                TO FREELKO
  5751        ELSE
  5752             MOVE ZEROS         TO FREELKO
  5753     ELSE
  5754         MOVE ZEROS             TO FREELKO.
  5755
  5756*    IF PI-COMPANY-ID = 'NCL'
  5757*    IF  CF-ST-STAT-INTEREST NUMERIC
  5758*        IF  CF-ST-STAT-INTEREST NOT = ZEROS
  5759*            MOVE CF-ST-STAT-INTEREST
  5760*                               TO STATRO
  5761*        ELSE
  5762*            MOVE ZEROS         TO STATRO
  5763*    ELSE
  5764*        MOVE ZEROS             TO STATRO.
  5765
  5766*    IF PI-COMPANY-ID = 'NCL'
  5767*    IF  CF-ST-STAT-INTEREST-1 NUMERIC
  5768*        IF  CF-ST-STAT-INTEREST-1 NOT = ZEROS
  5769*            MOVE CF-ST-STAT-INTEREST-1
  5770*                               TO STATR1O
  5771*        ELSE
  5772*            MOVE ZEROS         TO STATR1O
  5773*    ELSE
  5774*        MOVE ZEROS             TO STATR1O.
  5775
  5776*    IF PI-COMPANY-ID = 'NCL'
  5777*    IF  CF-ST-STAT-INTEREST-2 NUMERIC
  5778*        IF  CF-ST-STAT-INTEREST-2 NOT = ZEROS
  5779*            MOVE CF-ST-STAT-INTEREST-2
  5780*                               TO STATR2O
  5781*        ELSE
  5782*            MOVE ZEROS         TO STATR2O
  5783*    ELSE
  5784*        MOVE ZEROS             TO STATR2O.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 112
* EL106.cbl
  5785
  5786*    IF PI-COMPANY-ID = 'NCL'
  5787*    IF  CF-ST-STAT-INTEREST-3 NUMERIC
  5788*        IF  CF-ST-STAT-INTEREST-3 NOT = ZEROS
  5789*            MOVE CF-ST-STAT-INTEREST-3
  5790*                               TO STATR3O
  5791*        ELSE
  5792*            MOVE ZEROS         TO STATR3O
  5793*    ELSE
  5794*        MOVE ZEROS             TO STATR3O.
  5795
  5796     MOVE CF-COMM-CAP-LIMIT-TO  TO LIMITO.
  5797*    MOVE CF-ST-STAT-DATE-FROM  TO STATIO.
  5798
  5799     MOVE CF-LAST-MAINT-BY      TO LSTUSRO.
  5800     MOVE ' '                   TO DC-OPTION-CODE.
  5801     MOVE CF-LAST-MAINT-DT      TO DC-BIN-DATE-1.
  5802     MOVE LINK-ELDATCV          TO PGM-NAME.
  5803
  5804* EXEC CICS LINK
  5805*        PROGRAM (PGM-NAME)
  5806*        COMMAREA(DATE-CONVERSION-DATA)
  5807*        LENGTH  (DC-COMM-LENGTH)
  5808*    END-EXEC.
  5809*    MOVE '."C                   ''   #00005184' TO DFHEIV0
  5810     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5812     MOVE X'2020233030303035313834' TO DFHEIV0(25:11)
  5813     CALL 'kxdfhei1' USING DFHEIV0,
  5814           PGM-NAME,
  5815           DATE-CONVERSION-DATA,
  5816           DC-COMM-LENGTH,
  5817           DFHEIV99,
  5818           DFHEIV99,
  5819           DFHEIV99
  5820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5821
  5822
  5823     IF DATE-CONVERSION-ERROR
  5824         MOVE ZEROS              TO LSTDTEO
  5825     ELSE
  5826         MOVE DC-GREG-DATE-1-EDIT
  5827                                 TO LSTDTEO.
  5828
  5829     MOVE CF-LAST-MAINT-HHMMSS   TO TIME-IN.
  5830     MOVE TIME-OUT               TO LSTTIMEO.
  5831     MOVE -1                     TO MAINTL.
  5832     MOVE CF-LAST-MAINT-BY       TO PI-UPDATE-BY.
  5833     MOVE CF-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  5834     MOVE CF-STATE-CODE          TO PI-PREV-STATE.
  5835     MOVE AL-UANOF               TO MAINTA.
  5836     MOVE AL-UANON               TO STCDA
  5837                                  STNAMEA
  5838                                  STABRA
  5839                                  CLREJECA ISSREJA REFREJA
  5840                                  EXTCHGA STUEA STCNTLA STDEVA
  5841                                  REMTERMA
  5842                                  LFREDA LFLEVA LFNETA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 113
* EL106.cbl
  5843                                  AHAHA  AHCPA
  5844                                  REPLAWA REPLETRA SPLPMTA
  5845                                  LIMITA.
  5846*    IF PI-COMPANY-ID = 'NCL'
  5847*        MOVE AL-UANON           TO STATIA.
  5848
  5849     MOVE AL-UNNON               TO LFEXPA AHEXPA
  5850                                  QUOTCALA PREMTOLA REFTOLA
  5851                                  OVSAMTA  OVSPCTA
  5852                                  LFTAXA   AHITAXA  AHGTAXA
  5853                                  PRMPCTA  REFPCTA
  5854                                  REFDAY1A REFDAYSA
  5855                                  REFMINA EXTDAYSA
  5856                                  TARRATA
  5857                                  CALCINTA
  5858                                  RESTAXA FREELKA
  5859                                  COMSLA COMJLA COMSAA COMJAA.
  5860
  5861*    IF PI-COMPANY-ID = 'NCL'
  5862*        MOVE AL-UNNON           TO STATRA STATR1A STATR2A
  5863*                                                  STATR3A
  5864*                                                  INTDAYSA.
  5865
  5866     IF RETURN-DISPLAY
  5867         GO TO 8100-SEND-INITIAL-MAP
  5868     ELSE
  5869         GO TO 8200-SEND-DATAONLY.
  5870
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 114
* EL106.cbl
  5872 8100-SEND-INITIAL-MAP.
  5873     IF  PI-COMPANY-ID = 'CID' AND PI-WS-STATE = 'AK'
  5874        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5875     ELSE
  5876        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5877     END-IF.
  5878     MOVE SAVE-DATE              TO RUNDTEO.
  5879     MOVE EIBTIME                TO TIME-IN.
  5880     MOVE TIME-OUT               TO RUNTIMEO.
  5881     MOVE -1                     TO MAINTL.
  5882     MOVE PI-LIFE-OVERRIDE-L6    TO LEXPLBLO.
  5883     MOVE PI-AH-OVERRIDE-L6      TO AEXPLBLO.
  5884     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  5885     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  5886
  5887*    IF PI-COMPANY-ID = 'NCL'
  5888*       MOVE AL-SANON            TO STATZA
  5889*                                   INTDAYZA
  5890*                                   STATRZA
  5891*                                   RNG1A
  5892*                                   RNG2A
  5893*                                   RNG3A
  5894*       MOVE AL-UANON            TO STATIA
  5895*                                   STATRA
  5896*                                   STATR1A
  5897*                                   STATR2A
  5898*                                   STATR3A
  5899*       MOVE AL-UNNON            TO INTDAYSA.
  5900
  5901
  5902* EXEC CICS SEND
  5903*        MAP   (MAP-NAME)
  5904*        MAPSET(MAPSET-NAME)
  5905*        FROM  (EL106AO)
  5906*        ERASE
  5907*        CURSOR
  5908*    END-EXEC.
  5909     MOVE LENGTH OF
  5910      EL106AO
  5911       TO DFHEIV12
  5912     MOVE -1
  5913       TO DFHEIV11
  5914*    MOVE '8$     CT  E    H L F ,   #00005268' TO DFHEIV0
  5915     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5916     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5917     MOVE X'2020233030303035323638' TO DFHEIV0(25:11)
  5918     CALL 'kxdfhei1' USING DFHEIV0,
  5919           MAP-NAME,
  5920           EL106AO,
  5921           DFHEIV12,
  5922           MAPSET-NAME,
  5923           DFHEIV99,
  5924           DFHEIV99,
  5925           DFHEIV99,
  5926           DFHEIV11,
  5927           DFHEIV99,
  5928           DFHEIV99,
  5929           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 115
* EL106.cbl
  5930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5931
  5932
  5933     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 116
* EL106.cbl
  5935 8200-SEND-DATAONLY.
  5936
  5937     IF  PI-COMPANY-ID = 'CID' AND PI-WS-STATE = 'AK'
  5938        MOVE AL-SANON TO STCHKHDA STCHKNOA
  5939     ELSE
  5940        MOVE AL-SADOF TO STCHKHDA STCHKNOA
  5941     END-IF.
  5942
  5943     MOVE SAVE-DATE      TO RUNDTEO.
  5944     MOVE EIBTIME        TO TIME-IN.
  5945     MOVE TIME-OUT       TO RUNTIMEO.
  5946
  5947     IF QUOTCALL NOT = ZEROS
  5948        IF QUOTCALI NUMERIC
  5949           MOVE QUOTCALI TO QUOTCALO.
  5950
  5951     IF PREMTOLL NOT = ZEROS
  5952        IF PREMTOLI NUMERIC
  5953           MOVE PREMTOLI TO PREMTOLO.
  5954
  5955     IF OVSAMTL NOT = ZEROS
  5956        IF OVSAMTI NUMERIC
  5957           MOVE OVSAMTI TO OVSAMTO.
  5958
  5959     IF REFTOLL NOT = ZEROS
  5960        IF REFTOLI NUMERIC
  5961           MOVE REFTOLI TO REFTOLO.
  5962
  5963     IF PRMPCTL NOT = ZEROS
  5964        IF PRMPCTI NUMERIC
  5965           MOVE PRMPCTI TO PRMPCTO.
  5966
  5967     IF OVSPCTL NOT = ZEROS
  5968        IF OVSPCTI NUMERIC
  5969           MOVE OVSPCTI TO OVSPCTO.
  5970
  5971     IF LFTAXL NOT = ZEROS
  5972        IF LFTAXI NUMERIC
  5973           MOVE LFTAXI           TO LFTAXO
  5974        END-IF
  5975     END-IF
  5976
  5977     IF AHITAXL NOT = ZEROS
  5978        IF AHITAXI NUMERIC
  5979           MOVE AHITAXI          TO AHITAXO
  5980        END-IF
  5981     END-IF
  5982
  5983     IF AHGTAXL NOT = ZEROS
  5984        IF AHGTAXI NUMERIC
  5985           MOVE AHGTAXI          TO AHGTAXO
  5986        END-IF
  5987     END-IF
  5988
  5989     IF REFPCTL NOT = ZEROS
  5990        IF REFPCTI NUMERIC
  5991           MOVE REFPCTI TO REFPCTO.
  5992
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 117
* EL106.cbl
  5993     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  5994     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  5995
  5996
  5997* EXEC CICS SEND
  5998*        MAP   (MAP-NAME)
  5999*        MAPSET(MAPSET-NAME)
  6000*        FROM  (EL106AO)
  6001*        DATAONLY
  6002*        ERASEAUP
  6003*        CURSOR
  6004*    END-EXEC.
  6005     MOVE LENGTH OF
  6006      EL106AO
  6007       TO DFHEIV12
  6008     MOVE -1
  6009       TO DFHEIV11
  6010*    MOVE '8$D    CT  A    H L F ,   #00005339' TO DFHEIV0
  6011     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  6012     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6013     MOVE X'2020233030303035333339' TO DFHEIV0(25:11)
  6014     CALL 'kxdfhei1' USING DFHEIV0,
  6015           MAP-NAME,
  6016           EL106AO,
  6017           DFHEIV12,
  6018           MAPSET-NAME,
  6019           DFHEIV99,
  6020           DFHEIV99,
  6021           DFHEIV99,
  6022           DFHEIV11,
  6023           DFHEIV99,
  6024           DFHEIV99,
  6025           DFHEIV99
  6026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6027
  6028
  6029     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 118
* EL106.cbl
  6031 8300-SEND-TEXT.
  6032
  6033* EXEC CICS SEND TEXT
  6034*        FROM  (LOGOFF-TEXT)
  6035*        LENGTH(LOGOFF-LENGTH)
  6036*        ERASE
  6037*        FREEKB
  6038*    END-EXEC.
  6039*    MOVE '8&      T  E F  H   F -   #00005351' TO DFHEIV0
  6040     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6041     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6042     MOVE X'2020233030303035333531' TO DFHEIV0(25:11)
  6043     CALL 'kxdfhei1' USING DFHEIV0,
  6044           LOGOFF-TEXT,
  6045           LOGOFF-LENGTH,
  6046           DFHEIV99,
  6047           DFHEIV99,
  6048           DFHEIV99,
  6049           DFHEIV99,
  6050           DFHEIV99,
  6051           DFHEIV99,
  6052           DFHEIV99,
  6053           DFHEIV99,
  6054           DFHEIV99,
  6055           DFHEIV99
  6056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6057
  6058
  6059
  6060* EXEC CICS RETURN
  6061*    END-EXEC.
  6062*    MOVE '.(                    &   #00005358' TO DFHEIV0
  6063     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6064     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6065     MOVE X'2020233030303035333538' TO DFHEIV0(25:11)
  6066     CALL 'kxdfhei1' USING DFHEIV0,
  6067           DFHEIV99,
  6068           DFHEIV99,
  6069           DFHEIV99,
  6070           DFHEIV99,
  6071           DFHEIV99
  6072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6073
  6074
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 119
* EL106.cbl
  6076 8400-LOG-JOURNAL-RECORD.
  6077     IF PI-JOURNAL-FILE-ID = 0
  6078         GO TO 8400-EXIT.
  6079
  6080     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  6081     MOVE ELCNTL-ID              TO JP-FILE-ID.
  6082     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  6083*    EXEC CICS JOURNAL
  6084*         JFILEID(PI-JOURNAL-FILE-ID)
  6085*         JTYPEID('EL')
  6086*         FROM   (JOURNAL-RECORD)
  6087*         LENGTH (773)
  6088*    END-EXEC.
  6089
  6090 8400-EXIT.
  6091     EXIT.
  6092
  6093 8800-UNAUTHORIZED-ACCESS.
  6094     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  6095     GO TO 8300-SEND-TEXT.
  6096
  6097 8810-PF23.
  6098     MOVE EIBAID   TO PI-ENTRY-CD-1.
  6099     MOVE XCTL-EL005 TO PGM-NAME.
  6100     GO TO 9300-XCTL.
  6101
  6102 8850-DUPREC.
  6103     MOVE ER-0147 TO EMI-ERROR.
  6104     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6105     MOVE -1       TO STCDL.
  6106     MOVE AL-UABON TO STCDA.
  6107     GO TO 8200-SEND-DATAONLY.
  6108
  6109 8860-ENDFILE.
  6110     MOVE LOW-VALUES TO EL106AO.
  6111     MOVE ER-0148    TO EMI-ERROR.
  6112     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6113     MOVE -1 TO MAINTL.
  6114     MOVE SPACES TO PI-WS-STATE.
  6115     GO TO 8100-SEND-INITIAL-MAP.
  6116
  6117 8870-NOTOPEN.
  6118     MOVE ER-0042 TO EMI-ERROR.
  6119     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6120     MOVE -1 TO MAINTL.
  6121     GO TO 8200-SEND-DATAONLY.
  6122
  6123 8880-NOT-FOUND.
  6124     MOVE ER-0149 TO EMI-ERROR.
  6125     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6126     MOVE -1       TO STCDL.
  6127     MOVE AL-UABON TO STCDA.
  6128     GO TO 8200-SEND-DATAONLY.
  6129
  6130 8890-LETR-NOT-OPEN.
  6131     MOVE ER-0013                TO EMI-ERROR.
  6132     MOVE -1                     TO REPLETRL.
  6133     MOVE AL-UABON               TO REPLETRA.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 120
* EL106.cbl
  6134     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6135     GO TO 8200-SEND-DATAONLY.
  6136
  6137 9000-RETURN-CICS.
  6138
  6139* EXEC CICS RETURN
  6140*    END-EXEC.
  6141*    MOVE '.(                    &   #00005424' TO DFHEIV0
  6142     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6143     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6144     MOVE X'2020233030303035343234' TO DFHEIV0(25:11)
  6145     CALL 'kxdfhei1' USING DFHEIV0,
  6146           DFHEIV99,
  6147           DFHEIV99,
  6148           DFHEIV99,
  6149           DFHEIV99,
  6150           DFHEIV99
  6151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6152
  6153
  6154 9100-RETURN-TRAN.
  6155     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  6156     MOVE '106A'                 TO PI-CURRENT-SCREEN-NO.
  6157
  6158
  6159* EXEC CICS RETURN
  6160*        TRANSID (TRANS-ID)
  6161*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6162*        LENGTH  (WS-COMM-LENGTH)
  6163*    END-EXEC.
  6164*    MOVE '.(CT                  &   #00005431' TO DFHEIV0
  6165     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6166     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6167     MOVE X'2020233030303035343331' TO DFHEIV0(25:11)
  6168     CALL 'kxdfhei1' USING DFHEIV0,
  6169           TRANS-ID,
  6170           PROGRAM-INTERFACE-BLOCK,
  6171           WS-COMM-LENGTH,
  6172           DFHEIV99,
  6173           DFHEIV99
  6174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6175
  6176
  6177 9200-RETURN-MAIN-MENU.
  6178     IF  CREDIT-SESSION
  6179         MOVE XCTL-EL626           TO PGM-NAME
  6180     ELSE
  6181     IF  CLAIM-SESSION
  6182         MOVE XCTL-EL126           TO PGM-NAME
  6183     ELSE
  6184     IF  MORTGAGE-SESSION
  6185         MOVE XCTL-EM626           TO PGM-NAME
  6186     ELSE
  6187     IF  GENERAL-LEDGER-SESSION
  6188         MOVE XCTL-GL800           TO PGM-NAME.
  6189
  6190     GO TO 9300-XCTL.
  6191
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 121
* EL106.cbl
  6192 9300-XCTL.
  6193
  6194* EXEC CICS XCTL
  6195*        PROGRAM (PGM-NAME)
  6196*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  6197*        LENGTH  (WS-COMM-LENGTH)
  6198*    END-EXEC.
  6199*    MOVE '.$C                   $   #00005453' TO DFHEIV0
  6200     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6201     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6202     MOVE X'2020233030303035343533' TO DFHEIV0(25:11)
  6203     CALL 'kxdfhei1' USING DFHEIV0,
  6204           PGM-NAME,
  6205           PROGRAM-INTERFACE-BLOCK,
  6206           WS-COMM-LENGTH
  6207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6208
  6209
  6210 9400-CLEAR.
  6211     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  6212     GO TO 9300-XCTL.
  6213
  6214 9500-PF12.
  6215     MOVE XCTL-EL010 TO PGM-NAME.
  6216     GO TO 9300-XCTL.
  6217
  6218 9600-PGMID-ERROR.
  6219
  6220* EXEC CICS HANDLE CONDITION
  6221*        PGMIDERR(8300-SEND-TEXT)
  6222*    END-EXEC.
  6223*    MOVE '"$L                   ! ) #00005468' TO DFHEIV0
  6224     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6226     MOVE X'2920233030303035343638' TO DFHEIV0(25:11)
  6227     CALL 'kxdfhei1' USING DFHEIV0
  6228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6229
  6230
  6231     MOVE PGM-NAME      TO PI-CALLING-PROGRAM.
  6232     MOVE ' '           TO PI-ENTRY-CD-1.
  6233     MOVE XCTL-EL005    TO PGM-NAME.
  6234     MOVE PGM-NAME      TO LOGOFF-PGM.
  6235     MOVE PGMIDERR-MSG  TO LOGOFF-FILL.
  6236     GO TO 9300-XCTL.
  6237
  6238 9700-LINK-DATE-CONVERT.
  6239
  6240* EXEC CICS LINK
  6241*        PROGRAM    ('ELDATCV')
  6242*        COMMAREA   (DATE-CONVERSION-DATA)
  6243*        LENGTH     (DC-COMM-LENGTH)
  6244*    END-EXEC.
  6245     MOVE 'ELDATCV' TO DFHEIV1
  6246*    MOVE '."C                   ''   #00005480' TO DFHEIV0
  6247     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6248     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6249     MOVE X'2020233030303035343830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 122
* EL106.cbl
  6250     CALL 'kxdfhei1' USING DFHEIV0,
  6251           DFHEIV1,
  6252           DATE-CONVERSION-DATA,
  6253           DC-COMM-LENGTH,
  6254           DFHEIV99,
  6255           DFHEIV99,
  6256           DFHEIV99
  6257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6258
  6259
  6260 9700-EXIT.
  6261     EXIT.
  6262
  6263 9900-ERROR-FORMAT.
  6264     IF NOT EMI-ERRORS-COMPLETE
  6265         MOVE LINK-EL001 TO PGM-NAME
  6266
  6267* EXEC CICS LINK
  6268*            PROGRAM (PGM-NAME)
  6269*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  6270*            LENGTH  (EMI-COMM-LENGTH)
  6271*        END-EXEC.
  6272*    MOVE '."C                   ''   #00005492' TO DFHEIV0
  6273     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6275     MOVE X'2020233030303035343932' TO DFHEIV0(25:11)
  6276     CALL 'kxdfhei1' USING DFHEIV0,
  6277           PGM-NAME,
  6278           ERROR-MESSAGE-INTERFACE-BLOCK,
  6279           EMI-COMM-LENGTH,
  6280           DFHEIV99,
  6281           DFHEIV99,
  6282           DFHEIV99
  6283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6284
  6285
  6286 9900-EXIT.
  6287     EXIT.
  6288
  6289 9910-INITIALIZE-SECURITY.
  6290******************************************************************
  6291*                                                                *
  6292*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  6293*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  6294*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  6295*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  6296*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  6297*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  6298*                                                                *
  6299******************************************************************
  6300     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  6301         IF  MORTGAGE-SESSION
  6302             MOVE '125E'             TO SC-QUID-SYSTEM
  6303             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  6304
  6305* EXEC CICS READQ TS
  6306*                QUEUE  (SC-QUID-KEY)
  6307*                INTO   (SECURITY-CONTROL-E)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 123
* EL106.cbl
  6308*                LENGTH (SC-COMM-LENGTH-E)
  6309*                ITEM   (SC-ITEM)
  6310*            END-EXEC
  6311*    MOVE '*$II   L              ''   #00005516' TO DFHEIV0
  6312     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6313     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6314     MOVE X'2020233030303035353136' TO DFHEIV0(25:11)
  6315     CALL 'kxdfhei1' USING DFHEIV0,
  6316           SC-QUID-KEY,
  6317           SECURITY-CONTROL-E,
  6318           SC-COMM-LENGTH-E,
  6319           SC-ITEM,
  6320           DFHEIV99,
  6321           DFHEIV99
  6322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6323             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  6324                                     TO PI-DISPLAY-CAP
  6325             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  6326                                     TO PI-MODIFY-CAP
  6327             IF  NOT DISPLAY-CAP
  6328                 MOVE 'READ'         TO SM-READ
  6329                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6330                 MOVE ER-9097        TO EMI-ERROR
  6331                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6332                 GO TO 8100-SEND-INITIAL-MAP
  6333             ELSE
  6334                 GO TO 9910-EXIT
  6335         ELSE
  6336
  6337* EXEC CICS  READQ TS
  6338*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6339*                INTO    (SECURITY-CONTROL)
  6340*                LENGTH  (SC-COMM-LENGTH)
  6341*                ITEM    (SC-ITEM-CL-CR)
  6342*                END-EXEC
  6343*    MOVE '*$II   L              ''   #00005535' TO DFHEIV0
  6344     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6345     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6346     MOVE X'2020233030303035353335' TO DFHEIV0(25:11)
  6347     CALL 'kxdfhei1' USING DFHEIV0,
  6348           PI-SECURITY-TEMP-STORE-ID,
  6349           SECURITY-CONTROL,
  6350           SC-COMM-LENGTH,
  6351           SC-ITEM-CL-CR,
  6352           DFHEIV99,
  6353           DFHEIV99
  6354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6355             MOVE SC-CREDIT-DISPLAY (29)
  6356                                 TO PI-DISPLAY-CAP
  6357             MOVE SC-CREDIT-UPDATE  (29)
  6358                                 TO PI-MODIFY-CAP
  6359             IF  NOT DISPLAY-CAP
  6360                 MOVE 'READ'     TO SM-READ
  6361                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6362                 MOVE ER-0070    TO  EMI-ERROR
  6363                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6364                 GO TO 8100-SEND-INITIAL-MAP.
  6365 9910-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 124
* EL106.cbl
  6366     EXIT.
  6367 9990-ABEND.
  6368     MOVE LINK-EL004             TO PGM-NAME.
  6369     MOVE DFHEIBLK               TO EMI-LINE1.
  6370
  6371* EXEC CICS LINK
  6372*        PROGRAM   (PGM-NAME)
  6373*        COMMAREA  (EMI-LINE1)
  6374*        LENGTH    (72)
  6375*    END-EXEC.
  6376     MOVE 72
  6377       TO DFHEIV11
  6378*    MOVE '."C                   ''   #00005556' TO DFHEIV0
  6379     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6380     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6381     MOVE X'2020233030303035353536' TO DFHEIV0(25:11)
  6382     CALL 'kxdfhei1' USING DFHEIV0,
  6383           PGM-NAME,
  6384           EMI-LINE1,
  6385           DFHEIV11,
  6386           DFHEIV99,
  6387           DFHEIV99,
  6388           DFHEIV99
  6389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6390
  6391
  6392     GO TO 8200-SEND-DATAONLY.
  6393
  6394 9995-SECURITY-VIOLATION.
  6395*           COPY ELCSCTP.
  6396******************************************************************
  6397*                                                                *
  6398*                            ELCSCTP                             *
  6399*                            VMOD=2.001                          *
  6400*                                                                *
  6401*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6402******************************************************************
  6403
  6404
  6405     MOVE EIBDATE          TO SM-JUL-DATE.
  6406     MOVE EIBTRMID         TO SM-TERMID.
  6407     MOVE THIS-PGM         TO SM-PGM.
  6408     MOVE EIBTIME          TO TIME-IN.
  6409     MOVE TIME-OUT         TO SM-TIME.
  6410     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6411
  6412
  6413* EXEC CICS LINK
  6414*         PROGRAM  ('EL003')
  6415*         COMMAREA (SECURITY-MESSAGE)
  6416*         LENGTH   (80)
  6417*    END-EXEC.
  6418     MOVE 'EL003' TO DFHEIV1
  6419     MOVE 80
  6420       TO DFHEIV11
  6421*    MOVE '."C                   ''   #00005582' TO DFHEIV0
  6422     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6423     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 125
* EL106.cbl
  6424     MOVE X'2020233030303035353832' TO DFHEIV0(25:11)
  6425     CALL 'kxdfhei1' USING DFHEIV0,
  6426           DFHEIV1,
  6427           SECURITY-MESSAGE,
  6428           DFHEIV11,
  6429           DFHEIV99,
  6430           DFHEIV99,
  6431           DFHEIV99
  6432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6433
  6434
  6435******************************************************************
  6436
  6437
  6438 9995-EXIT.
  6439      EXIT.
  6440
  6441
  6442 9999-DFHBACK SECTION.
  6443     MOVE '9%                    "   ' TO DFHEIV0
  6444     MOVE 'EL106' TO DFHEIV1
  6445     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6446     GOBACK.
  6447 9999-DFHEXIT.
  6448     IF DFHEIGDJ EQUAL 0001
  6449         NEXT SENTENCE
  6450     ELSE IF DFHEIGDJ EQUAL 2
  6451         GO TO 8850-DUPREC,
  6452               8870-NOTOPEN,
  6453               8880-NOT-FOUND,
  6454               9600-PGMID-ERROR,
  6455               9990-ABEND
  6456         DEPENDING ON DFHEIGDI
  6457     ELSE IF DFHEIGDJ EQUAL 3
  6458         GO TO 8880-NOT-FOUND,
  6459               8880-NOT-FOUND
  6460         DEPENDING ON DFHEIGDI
  6461     ELSE IF DFHEIGDJ EQUAL 4
  6462         GO TO 8100-SEND-INITIAL-MAP
  6463         DEPENDING ON DFHEIGDI
  6464     ELSE IF DFHEIGDJ EQUAL 5
  6465         GO TO 8860-ENDFILE
  6466         DEPENDING ON DFHEIGDI
  6467     ELSE IF DFHEIGDJ EQUAL 6
  6468         GO TO 8860-ENDFILE
  6469         DEPENDING ON DFHEIGDI
  6470     ELSE IF DFHEIGDJ EQUAL 7
  6471         GO TO 6010-LETR-NOT-FOUND,
  6472               6010-LETR-NOT-FOUND,
  6473               8890-LETR-NOT-OPEN
  6474         DEPENDING ON DFHEIGDI
  6475     ELSE IF DFHEIGDJ EQUAL 8
  6476         GO TO 6600-EXIT
  6477         DEPENDING ON DFHEIGDI
  6478     ELSE IF DFHEIGDJ EQUAL 9
  6479         GO TO 8300-SEND-TEXT
  6480         DEPENDING ON DFHEIGDI.
  6481     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:20 Page 126
* EL106.cbl
  6482     MOVE 'EL106' TO DFHEIV1
  6483     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6484     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        5108     Code:       19665
