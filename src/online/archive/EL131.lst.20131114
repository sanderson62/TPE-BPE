* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36******************************************************************
    37
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   3
* EL131.cbl
    39 ENVIRONMENT DIVISION.
    40
    41 DATA DIVISION.
    42
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    49 77  s1                          pic s999 comp-3 value+0.
    50 77  s2                          pic s999 comp-3 value+0.
    51 77  a1                          pic s999 comp-3 value+0.
    52 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    53 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    54 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    55 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    56 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    57 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    58 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    59 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    60     88  ERPDEF-FOUND                 VALUE 'Y'.
    61
    62 01  LCP-TIME-OF-DAY-XX.
    63     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    64     05  FILLER                    PIC 99.
    65 01  LCP-CICS-TIME                 PIC 9(15).
    66*                            COPY ELCSCTM.
    67******************************************************************
    68*                                                                *
    69*                                                                *
    70*                            ELCSCTM                             *
    71*                            VMOD=2.001                          *
    72*                                                                *
    73*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-MESSAGE.
    77     12  FILLER                          PIC X(30)
    78            VALUE '** LOGIC SECURITY VIOLATION -'.
    79     12  SM-READ                         PIC X(6).
    80     12  FILLER                          PIC X(5)
    81            VALUE ' PGM='.
    82     12  SM-PGM                          PIC X(6).
    83     12  FILLER                          PIC X(5)
    84            VALUE ' OPR='.
    85     12  SM-PROCESSOR-ID                 PIC X(4).
    86     12  FILLER                          PIC X(6)
    87            VALUE ' TERM='.
    88     12  SM-TERMID                       PIC X(4).
    89     12  FILLER                          PIC XX   VALUE SPACE.
    90     12  SM-JUL-DATE                     PIC 9(5).
    91     12  FILLER                          PIC X    VALUE SPACE.
    92     12  SM-TIME                         PIC 99.99.
    93
    94
    95*                            COPY ELCSCRTY.
    96******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   4
* EL131.cbl
    97*                                                                *
    98*                                                                *
    99*                            ELCSCRTY                            *
   100*                            VMOD=2.001                          *
   101*                                                                *
   102*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   103*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   104*        SAVED IN PI-SECURITY-ADDRESS.                           *
   105*                                                                *
   106******************************************************************
   107 01  SECURITY-CONTROL.
   108     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   109     12  FILLER                       PIC XX    VALUE 'SC'.
   110     12  SC-CREDIT-CODES.
   111         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   112             20  SC-CREDIT-DISPLAY    PIC X.
   113             20  SC-CREDIT-UPDATE     PIC X.
   114     12  SC-CLAIMS-CODES.
   115         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   116             20  SC-CLAIMS-DISPLAY    PIC X.
   117             20  SC-CLAIMS-UPDATE     PIC X.
   118
   119*                            COPY ELCNWA.
   120*****************************************************************
   121*                                                               *
   122*                                                               *
   123*                            ELCNWA.                            *
   124*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   125*                            VMOD=2.003                         *
   126*                                                               *
   127*            M O V E   N A M E   W O R K   A R E A.             *
   128*                                                               *
   129*****************************************************************.
   130
   131 01  WS-NAME-WORK-AREA.
   132     05  WS-INSURED-LAST-NAME        PIC X(15).
   133     05  WS-INSURED-1ST-NAME         PIC X(12).
   134     05  WS-INSURED-MID-INIT         PIC X.
   135
   136     05  WS-NAME-WORK.
   137         10  WS-NW                   PIC X
   138             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   139
   140     05  WS-NAME-WORK2.
   141         10  WS-NW2                  PIC X
   142             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   143                                        NWA-INDEX0.
   144
   145     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   146                                     COMP-3.
   147
   148
   149 01  ws-dcc-error-line.
   150     05  filler occurs 15.
   151         10  ws-error-no        pic x(4).
   152 01  WS-DATE-AREA.
   153     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   154     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   5
* EL131.cbl
   155     12  SAVE-DATE-CCYYMMDD.
   156         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   157         16  SAVE-DATE-YMD.
   158             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   159             20  FILLER         PIC X(4)    VALUE SPACES.
   160
   161 01  WS-BLANK                   PIC X       VALUE ' '.
   162
   163 01  CSO-WORK-FIELDS.
   164     05  WS-HOLD-CLAIM-STATUS    PIC X.
   165
   166 01  LITERALS-NUMBERS.
   167     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   168     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   169     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   170     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   171     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   172     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   173     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   174     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   175
   176     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   177     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   178     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   179     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   180     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   181     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   182     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   183     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   184     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   185     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   186
   187     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   188
   189     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   190
   191     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   192     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   193     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   194     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   195     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   196     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   197     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   198     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   199     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   200     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   201     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   202
   203     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   204     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   205     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   206     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   207         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   208     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   209     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   210     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   211     12  WS-CLAIM-SEQU.
   212         16  FILLER              PIC X VALUE '('.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   6
* EL131.cbl
   213         16  WS-CURRENT-SEQU     PIC Z9.
   214         16  FILLER              PIC X(04) VALUE ' OF '.
   215         16  WS-OF-SEQU          PIC Z9.
   216         16  FILLER              PIC X VALUE ')'.
   217     12  WS-EDIT-BEN-CODE        PIC XX.
   218         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   219                                          '90' THRU '99'.
   220
   221     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   222     12  WS-EDIT-NUMBER          PIC ZZZ9.
   223
   224     12  WS-RESPONSE             PIC S9(8)   COMP.
   225         88  WS-RESP-NORMAL              VALUE +00.
   226         88  WS-RESP-ERROR               VALUE +01.
   227         88  WS-RESP-NOTFND              VALUE +13.
   228         88  WS-RESP-DUPKEY              VALUE +15.
   229         88  WS-RESP-NOTOPEN             VALUE +19.
   230         88  WS-RESP-ENDFILE             VALUE +20.
   231
   232     12  WS-MOS-PAID             PIC 999.
   233     12  WS-ODD-DAYS             PIC 99.
   234     12  WS-REM-MOS              PIC 999.
   235     12  WS-REM-DAYS             PIC 99.
   236     12  WS-TERM-IN-DAYS         PIC 9(4).
   237     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   238
   239     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   240     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   241     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   242     12  WS-RESET-SW             PIC X       VALUE 'N'.
   243     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   244     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   245     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   246
   247 01  DMD-DATE-YYYYMMDD.
   248     12  DMD-DECADE          PIC XX      VALUE SPACES.
   249     12  DMD-YYMMDD.
   250         16  DMD-YY          PIC XX      VALUE SPACES.
   251         16  DMD-MM          PIC XX      VALUE SPACES.
   252         16  DMD-DD          PIC XX      VALUE SPACES.
   253
   254 01  DMD-DATE-MMDDYYYY.
   255     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   256     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   257     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   258     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   259     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   260     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   261
   262 01  WS-MAIL-CODE.
   263     12  FILLER              PIC X.
   264     12  DMD-MAIL-CODE.
   265         16  WS-MAIL-4       PIC X(4).
   266         16  WS-MAIL-5       PIC X.
   267     12  FILLER              PIC X(4).
   268
   269     12  W-NAME-LAST             PIC  X(15).
   270     12  W-NAME-FIRST            PIC  X(15).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   7
* EL131.cbl
   271     12  W-NAME-MIDDLE.
   272         16  FILLER              PIC  X.
   273         16  W-NAME-MIDDLE-2     PIC  X.
   274         16  FILLER              PIC  X(13).
   275
   276*    COPY ELCDCTB.
   277******************************************************************
   278*                                                                *
   279*                                                                *
   280*                            ELCDCTB.                            *
   281*                            VMOD=2.002                          *
   282*                                                                *
   283*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   284*       COMMUNICATIONS AREA                                      *
   285*                                                                *
   286******************************************************************
   287 01  DCT-COMMUNICATION-AREA.
   288     12  DCT-BILLING-BANK-ID      PIC  X(05).
   289     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   290     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   291     12  DCT-PRODUCT-CODE         PIC  X(02).
   292     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   293     12  DCT-RETURN-CODE          PIC  X(02).
   294     12  DCT-MAIL-CODE            PIC  X(05).
   295     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   296     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   8
* EL131.cbl
   298 01  ERROR-SWITCHES.
   299     12  ERROR-SWITCH            PIC X.
   300         88  SCREEN-ERROR                    VALUE 'X'.
   301     12  MSTR-KEY-SWITCH         PIC X.
   302         88  MSTR-KEY-CHANGED                VALUE 'X'.
   303     12  CERT-KEY-SWITCH         PIC X.
   304*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   305         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   306*********SET TO Y IF PRIMARY KEY WILL CHANGE
   307         88  CERT-KEY-CHANGED                VALUE 'Y'.
   308     12  MSTR-SWITCH             PIC X.
   309         88  MSTR-UPDATES                    VALUE 'X'.
   310     12  CERT-SWITCH             PIC X.
   311         88  CERT-UPDATES                    VALUE 'X'.
   312     12  UPDATE-SWITCH           PIC X.
   313         88  UPDATES-PRESENT                 VALUE 'X'.
   314     12  TRLR-SWITCH             PIC X.
   315         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   316         88  UPDATE-MADE                     VALUE 'Y'.
   317     12  NINETY-TRLR-SWITCH      PIC X.
   318         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   319     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   320         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   321     12  EARNINGS-CALC-SWITCH    PIC X.
   322         88  TEX-REG                         VALUE '4'.
   323         88  NET-PAY                         VALUE '5'.
   324     12  DLYACTV-SW              PIC X       VALUE 'N'.
   325         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page   9
* EL131.cbl
   327 01  EDIT-WORK-AREA.
   328     12  COUNT-2                 PIC 9.
   329     12  CALL-PGM                PIC X(8).
   330     12  TRANS-ID                PIC X(4).
   331     12  CHECK-PFKEYS            PIC 99.
   332     12  CHECK-MAINT             PIC X.
   333         88  ADD-ALPHA-RECORD                VALUE 'A'.
   334         88  CHANGE-CLAIM                    VALUE 'C'.
   335         88  DELETE-CLAIM                    VALUE 'D'.
   336         88  CHANGE-NAME                     VALUE 'N'.
   337         88  VALID-OPTIONS                   VALUE 'A' 'C'
   338                                                   'D' 'N'.
   339
   340     12  HOLD-BENEFIT            PIC XX.
   341     12  HOLD-FREQ               PIC XX.
   342     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   343     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   344     12  HOLD-PDTHRU             PIC XX.
   345     12  HOLD-ADDON              PIC XX.
   346     12  HOLD-NODAYS             PIC 9(4).
   347     12  HOLD-NOPMTS             PIC 9(3).
   348     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   349     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   350     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   351     12  HOLD-BIRTH              PIC XX.
   352     12  HOLD-END                PIC XX.
   353     12  HOLD-EFF                PIC XX.
   354     12  HOLD-ENTRY              PIC XX.
   355     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   356     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   357     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   358     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   359     12  HOLD-LF-CV-CAN          PIC XX.
   360     12  HOLD-AH-CV-CAN          PIC XX.
   361     12  DIVIDE-QUOT             PIC 9(3).
   362     12  DIVIDE-REM              PIC 9(3).
   363
   364     12  WS-ALPHA-DATE.
   365         16  WS-ALPHA-YEAR.
   366             20  WS-ALPHA-YY-1   PIC 99.
   367             20  WS-ALPHA-YY-2   PIC 99.
   368         16  WS-ALPHA-MM         PIC 99.
   369         16  WS-ALPHA-DD         PIC 99.
   370
   371     12  BUILD-VALID-DATE.
   372         16  BUILD-MONTH         PIC 99.
   373         16  BUILD-DAY           PIC 99.
   374         16  BUILD-YEAR          PIC 99.
   375     12  DEEDIT-MMYY-INPUT.
   376         16  FILLER              PIC X.
   377         16  DEEDIT-MONTH        PIC XX.
   378         16  DEEDIT-YEAR         PIC XX.
   379     12  DEEDIT-BEN              PIC 9(9)V99.
   380     12  DEEDIT-DATE-INPUT.
   381         16  FILLER              PIC XX.
   382         16  DEEDIT-DATE         PIC X(6).
   383     12  WORK-DATE-MDY.
   384         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  10
* EL131.cbl
   385         16  FILLER              PIC X(4).
   386         16  YEAR-WORK           PIC XX.
   387     12  WORK-DATE-MY.
   388         16  WORK-MONTH          PIC XX.
   389         16  WORK-SLASH          PIC X       VALUE '/'.
   390         16  WORK-YEAR           PIC XX.
   391     12  HOLD-DATE.
   392         16  HOLD-MONTH          PIC 99.
   393         16  FILLER              PIC X(4).
   394         16  HOLD-YEAR           PIC 99.
   395     12  SPLIT-INFO-LINE-1.
   396         16  SPLIT-INFO-DESC     PIC X(15).
   397         16  FILLER              PIC X(5)    VALUE ' OLD='.
   398         16  SPLIT-INFO-OLD      PIC X(40).
   399     12  EFF-TERM-MO             PIC 9(4).
   400     12  CURR-MO                 PIC 9(4).
   401     12  WS-BIN-CURRENT-DT       PIC XX.
   402     12  WS-CALC-METHOD          PIC X.
   403     12  WS-INITIALS.
   404         16  WS-INIT-1           PIC X.
   405         16  WS-INIT-2           PIC X.
   406     12  WS-REIN-TABLE.
   407         16  WS-REIN-1           PIC X.
   408         16  WS-REIN-2           PIC X.
   409         16  WS-REIN-3           PIC X.
   410     12  PI-KEY.
   411         16  PI-TERM             PIC X(4).
   412         16  PI-QUAL             PIC X(4).
   413     12  CHECK-KEY               PIC X(20).
   414     12  SAVE-ACCT-KEY           PIC X(20).
   415     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   416     12  WS-SOC-SEC-NUMBER.
   417         16  WS-SOC-SEC-NO       PIC 9(9).
   418         16  WS-SOC-SEC-BLANK    PIC X(2).
   419     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   420         16  WS-SSN-1-3          PIC 9(3).
   421         16  WS-SSN-DASH1        PIC X(1).
   422         16  WS-SSN-4-5          PIC 9(2).
   423         16  WS-SSN-DASH2        PIC X(1).
   424         16  WS-SSN-6-9          PIC 9(4).
   425     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   426     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   427
   428 01  WS-SAVE-FIELDS.
   429     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   430     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   431     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   432     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   433     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   434     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   435     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   436     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   437     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   438     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   439     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   440     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   441     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   442     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  11
* EL131.cbl
   443     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   444     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   445     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   446     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   447     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   448     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   449     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   450     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   451     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   452     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   453     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   454     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   455     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   456     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   457     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   458     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   459     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   460     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   461     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   462     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   463     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   464     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   465     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   466     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   467     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   468     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   469     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   470     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   471     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   472     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   473     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   474     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   475     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   477     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   479     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   480
   481 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   482     12  M                   PIC S9(7)V99           VALUE ZEROS.
   483     12  L                   PIC S9(7)V99           VALUE ZEROS.
   484     12  N                   PIC S9(3)              VALUE ZEROS.
   485     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   486     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   487     12  I                   PIC S99V9(5)           VALUE ZEROS.
   488     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   489     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   490     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   491     12  R                   PIC S9(3)              VALUE ZEROS.
   492     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   493     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   494     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   495     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   496     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   497     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   498     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   499     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   500     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  12
* EL131.cbl
   501
   502 01  TERM-CALC-WORK-AREA.
   503     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   504     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   505     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   506     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   507     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   508     12  V-EXPONENTS.
   509        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   510     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   511
   512 01  TIME-IN.
   513     12  UN-HOURS                PIC XX.
   514     12  UN-MINUTES              PIC XX.
   515     12  FILLER                  PIC XX.
   516
   517 01  TIME-OUT.
   518     12  FOR-HOURS               PIC XX.
   519     12  FILLER                  PIC X       VALUE '.'.
   520     12  FOR-MINUTES             PIC XX.
   521
   522 01  ERROR-NUMBERS.
   523     12  ER-0000                 PIC X(4)    VALUE '0000'.
   524     12  ER-0004                 PIC X(4)    VALUE '0004'.
   525     12  ER-0008                 PIC X(4)    VALUE '0008'.
   526     12  ER-0023                 PIC X(4)    VALUE '0023'.
   527     12  ER-0029                 PIC X(4)    VALUE '0029'.
   528     12  ER-0068                 PIC X(4)    VALUE '0068'.
   529     12  ER-0070                 PIC X(4)    VALUE '0070'.
   530     12  ER-0149                 PIC X(4)    VALUE '0149'.
   531     12  ER-0154                 PIC X(4)    VALUE '0154'.
   532     12  ER-0169                 PIC X(4)    VALUE '0169'.
   533     12  ER-0192                 PIC X(4)    VALUE '0192'.
   534     12  ER-0199                 PIC X(4)    VALUE '0199'.
   535     12  ER-0203                 PIC X(4)    VALUE '0203'.
   536     12  ER-0204                 PIC X(4)    VALUE '0204'.
   537     12  ER-0205                 PIC X(4)    VALUE '0205'.
   538     12  ER-0206                 PIC X(4)    VALUE '0206'.
   539     12  ER-0208                 PIC X(4)    VALUE '0208'.
   540     12  ER-0210                 PIC X(4)    VALUE '0210'.
   541     12  ER-0215                 PIC X(4)    VALUE '0215'.
   542     12  ER-0219                 PIC X(4)    VALUE '0219'.
   543     12  ER-0220                 PIC X(4)    VALUE '0220'.
   544     12  ER-0222                 PIC X(4)    VALUE '0222'.
   545     12  ER-0223                 PIC X(4)    VALUE '0223'.
   546     12  ER-0224                 PIC X(4)    VALUE '0224'.
   547     12  ER-0227                 PIC X(4)    VALUE '0227'.
   548     12  ER-0230                 PIC X(4)    VALUE '0230'.
   549     12  ER-0232                 PIC X(4)    VALUE '0232'.
   550     12  ER-0233                 PIC X(4)    VALUE '0233'.
   551     12  ER-0236                 PIC X(4)    VALUE '0236'.
   552     12  ER-0237                 PIC X(4)    VALUE '0237'.
   553     12  ER-0238                 PIC X(4)    VALUE '0238'.
   554     12  ER-0240                 PIC X(4)    VALUE '0240'.
   555     12  ER-0241                 PIC X(4)    VALUE '0241'.
   556     12  ER-0243                 PIC X(4)    VALUE '0243'.
   557     12  ER-0244                 PIC X(4)    VALUE '0244'.
   558     12  ER-0246                 PIC X(4)    VALUE '0246'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  13
* EL131.cbl
   559     12  ER-0247                 PIC X(4)    VALUE '0247'.
   560     12  ER-0248                 PIC X(4)    VALUE '0248'.
   561     12  ER-0250                 PIC X(4)    VALUE '0250'.
   562     12  ER-0251                 PIC X(4)    VALUE '0251'.
   563     12  ER-0253                 PIC X(4)    VALUE '0253'.
   564     12  ER-0256                 PIC X(4)    VALUE '0256'.
   565     12  ER-0257                 PIC X(4)    VALUE '0257'.
   566     12  ER-0258                 PIC X(4)    VALUE '0258'.
   567     12  ER-0259                 PIC X(4)    VALUE '0259'.
   568     12  ER-0260                 PIC X(4)    VALUE '0260'.
   569     12  ER-0261                 PIC X(4)    VALUE '0261'.
   570     12  ER-0262                 PIC X(4)    VALUE '0262'.
   571     12  ER-0263                 PIC X(4)    VALUE '0263'.
   572     12  ER-0273                 PIC X(4)    VALUE '0273'.
   573     12  ER-0274                 PIC X(4)    VALUE '0274'.
   574     12  ER-0276                 PIC X(4)    VALUE '0276'.
   575     12  ER-0282                 PIC X(4)    VALUE '0282'.
   576     12  ER-0283                 PIC X(4)    VALUE '0283'.
   577     12  ER-0309                 PIC X(4)    VALUE '0309'.
   578     12  ER-0310                 PIC X(4)    VALUE '0310'.
   579     12  ER-0311                 PIC X(4)    VALUE '0311'.
   580     12  ER-0333                 PIC X(4)    VALUE '0333'.
   581     12  ER-0360                 PIC X(4)    VALUE '0360'.
   582     12  ER-0377                 PIC X(4)    VALUE '0377'.
   583     12  ER-0402                 PIC X(4)    VALUE '0402'.
   584     12  ER-0416                 PIC X(4)    VALUE '0416'.
   585     12  ER-0426                 PIC X(4)    VALUE '0426'.
   586     12  ER-0427                 PIC X(4)    VALUE '0427'.
   587     12  ER-0428                 PIC X(4)    VALUE '0428'.
   588     12  ER-0429                 PIC X(4)    VALUE '0429'.
   589     12  ER-0430                 PIC X(4)    VALUE '0430'.
   590     12  ER-0458                 PIC X(4)    VALUE '0458'.
   591     12  ER-0475                 PIC X(4)    VALUE '0475'.
   592     12  ER-0491                 PIC X(4)    VALUE '0491'.
   593     12  ER-0509                 PIC X(4)    VALUE '0509'.
   594     12  ER-0510                 PIC X(4)    VALUE '0510'.
   595     12  ER-0511                 PIC X(4)    VALUE '0511'.
   596     12  ER-0512                 PIC X(4)    VALUE '0512'.
   597     12  ER-0519                 PIC X(4)    VALUE '0519'.
   598     12  ER-0520                 PIC X(4)    VALUE '0520'.
   599     12  ER-0521                 PIC X(4)    VALUE '0521'.
   600     12  ER-0547                 PIC X(4)    VALUE '0547'.
   601     12  ER-0548                 PIC X(4)    VALUE '0548'.
   602     12  ER-0549                 PIC X(4)    VALUE '0549'.
   603     12  ER-0565                 PIC X(4)    VALUE '0565'.
   604     12  ER-0598                 PIC X(4)    VALUE '0598'.
   605     12  ER-0639                 PIC X(4)    VALUE '0639'.
   606     12  ER-0797                 PIC X(4)    VALUE '0797'.
   607     12  ER-0802                 PIC X(4)    VALUE '0802'.
   608     12  ER-0803                 PIC X(4)    VALUE '0803'.
   609     12  ER-0849                 PIC X(4)    VALUE '0849'.
   610     12  ER-0885                 PIC X(4)    VALUE '0885'.
   611     12  ER-0887                 PIC X(4)    VALUE '0887'.
   612     12  ER-0919                 PIC X(4)    VALUE '0919'.
   613     12  ER-0921                 PIC X(4)    VALUE '0921'.
   614     12  ER-0938                 PIC X(4)    VALUE '0938'.
   615     12  ER-0946                 PIC X(4)    VALUE '0946'.
   616     12  ER-0947                 PIC X(4)    VALUE '0947'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  14
* EL131.cbl
   617     12  ER-0948                 PIC X(4)    VALUE '0948'.
   618     12  ER-0949                 PIC X(4)    VALUE '0949'.
   619     12  ER-0950                 PIC X(4)    VALUE '0950'.
   620     12  ER-0951                 PIC X(4)    VALUE '0951'.
   621     12  ER-0954                 PIC X(4)    VALUE '0954'.
   622     12  ER-0974                 PIC X(4)    VALUE '0974'.
   623     12  ER-0975                 PIC X(4)    VALUE '0975'.
   624     12  ER-1651                 PIC X(4)    VALUE '1651'.
   625     12  ER-1652                 PIC X(4)    VALUE '1652'.
   626     12  ER-1653                 PIC X(4)    VALUE '1653'.
   627     12  ER-1654                 PIC X(4)    VALUE '1654'.
   628     12  ER-1655                 PIC X(4)    VALUE '1655'.
   629     12  er-1656                 pic x(4)    value '1656'.
   630     12  ER-1661                 PIC X(4)    VALUE '1661'.
   631     12  ER-1662                 PIC X(4)    VALUE '1662'.
   632     12  ER-1663                 PIC X(4)    VALUE '1663'.
   633     12  ER-1773                 PIC X(4)    VALUE '1773'.
   634     12  ER-2280                 PIC X(4)    VALUE '2280'.
   635     12  ER-2878                 PIC X(4)    VALUE '2878'.
   636     12  ER-7641                 PIC X(4)    VALUE '7641'.
   637     12  ER-7642                 PIC X(4)    VALUE '7642'.
   638     12  ER-7650                 PIC X(4)    VALUE '7650'.
   639     12  ER-7651                 PIC X(4)    VALUE '7651'.
   640     12  ER-7687                 PIC X(4)    VALUE '7687'.
   641     12  ER-7689                 PIC X(4)    VALUE '7689'.
   642     12  ER-7690                 PIC X(4)    VALUE '7690'.
   643     12  ER-7691                 PIC X(4)    VALUE '7691'.
   644     12  ER-8003                 PIC X(4)    VALUE '8003'.
   645     12  ER-8051                 PIC X(4)    VALUE '8051'.
   646     12  ER-8052                 PIC X(4)    VALUE '8052'.
   647     12  ER-8053                 PIC X(4)    VALUE '8053'.
   648     12  ER-8054                 PIC X(4)    VALUE '8054'.
   649     12  ER-8055                 PIC X(4)    VALUE '8055'.
   650     12  ER-8056                 PIC X(4)    VALUE '8056'.
   651     12  ER-8057                 PIC X(4)    VALUE '8057'.
   652     12  ER-8058                 PIC X(4)    VALUE '8058'.
   653     12  ER-8059                 PIC X(4)    VALUE '8059'.
   654     12  ER-8060                 PIC X(4)    VALUE '8060'.
   655     12  ER-8061                 PIC X(4)    VALUE '8061'.
   656     12  ER-8062                 PIC X(4)    VALUE '8062'.
   657     12  ER-8063                 PIC X(4)    VALUE '8063'.
   658     12  ER-8064                 PIC X(4)    VALUE '8064'.
   659     12  ER-8065                 PIC X(4)    VALUE '8065'.
   660     12  ER-8066                 PIC X(4)    VALUE '8066'.
   661     12  ER-8152                 PIC X(4)    VALUE '8152'.
   662     12  ER-8153                 PIC X(4)    VALUE '8153'.
   663     12  ER-8154                 PIC X(4)    VALUE '8154'.
   664     12  ER-8155                 PIC X(4)    VALUE '8155'.
   665 01  ERPDEF-KEY-SAVE             PIC X(18).
   666 01  ERPDEF-KEY.
   667     12  ERPDEF-COMPANY-CD       PIC X.
   668     12  ERPDEF-STATE            PIC XX.
   669     12  ERPDEF-PROD-CD          PIC XXX.
   670     12  F                       PIC X(7).
   671     12  ERPDEF-BEN-TYPE         PIC X.
   672     12  ERPDEF-BEN-CODE         PIC XX.
   673     12  ERPDEF-EXP-DT           PIC XX.
   674 01  MSTR-KEY.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  15
* EL131.cbl
   675     12  COMPANY-CODE            PIC X.
   676     12  CARRIER-CODE            PIC X.
   677     12  CLAIM-NO                PIC X(7).
   678     12  CERT-NO.
   679         16  CERT-NO-PRIME       PIC X(10).
   680         16  CERT-NO-SUFX        PIC X.
   681
   682 01  WS-SAVE-CLAIM-KEY.
   683     12  WS-SAVE-COMPANY-CD      PIC X.
   684     12  WS-SAVE-CARRIER         PIC X.
   685     12  WS-SAVE-CLAIM-NO        PIC X(7).
   686     12  WS-SAVE-CERT-NO.
   687         16  WS-CERT-NO-PRIME    PIC X(10).
   688         16  WS-CERT-NO-SUFX     PIC X.
   689
   690 01  CERT-KEY.
   691     12  CERT-COMPANY-CODE       PIC X.
   692     12  CERT-CARRIER            PIC X.
   693     12  CERT-GROUP              PIC X(6).
   694     12  CERT-STATE              PIC XX.
   695     12  CERT-ACCOUNT            PIC X(10).
   696     12  CERT-DATE               PIC XX.
   697     12  CERT-CERT.
   698         16  CERT-CERT-PRIME     PIC X(10).
   699         16  CERT-CERT-SUFX      PIC X.
   700
   701 01  ELCRTT-KEY.
   702     05  CTRLR-COMP-CD       PIC X.
   703     05  CTRLR-CARRIER       PIC X.
   704     05  CTRLR-GROUPING      PIC X(6).
   705     05  CTRLR-STATE         PIC X(2).
   706     05  CTRLR-ACCOUNT       PIC X(10).
   707     05  CTRLR-EFF-DT        PIC XX.
   708     05  CTRLR-CERT-NO       PIC X(11).
   709     05  CTRLR-REC-TYPE      PIC X.
   710 01  NOTE-KEY.
   711     12  NOTE-COMP-CD            PIC X.
   712     12  NOTE-CERT-KEY.
   713         16  NOTE-CARRIER        PIC X.
   714         16  NOTE-GROUP          PIC X(6).
   715         16  NOTE-STATE          PIC XX.
   716         16  NOTE-ACCOUNT        PIC X(10).
   717         16  NOTE-DATE           PIC XX.
   718         16  NOTE-CERT-NO        PIC X(11).
   719
   720 01  TRLR-KEY.
   721     12  TRLR-MAIN-KEY.
   722         16  TRLR-COMPANY-CD     PIC X.
   723         16  TRLR-CARRIER        PIC X.
   724         16  TRLR-CLAIM-NO       PIC X(07).
   725         16  TRLR-CERT-NO        PIC X(11).
   726     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   727
   728 01  BENEFIT-KEY.
   729     12  BEN-CO-ID               PIC X(3).
   730     12  BEN-REC-TYPE            PIC X.
   731     12  FILLER                  PIC XX.
   732     12  BEN-ACC-CD              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  16
* EL131.cbl
   733     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   734
   735 01  CNTL-KEY.
   736     12  CNTL-CO-ID              PIC X(3).
   737     12  CNTL-REC-TYPE           PIC X.
   738     12  CNTL-PROC-ID            PIC X(4).
   739     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   740         16  CNTL-STATE-NUMBER   PIC XX.
   741         16  FILLER              PIC XX.
   742     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   743         16  FILLER              PIC X(3).
   744         16  CNTL-CARRIER        PIC X.
   745     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   746
   747 01  ACTQ-KEY                    PIC X(20).
   748
   749 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   750
   751 01  CHKQ-KEY.
   752     12  CHKQ-COMPANY-CODE       PIC X.
   753     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   754     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   755
   756 01  ARCH-KEY.
   757     12  ARCH-COMPANY-CODE       PIC X.
   758     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   759     12  ARCH-RECORD-TYPE        PIC X.
   760     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   761
   762 01  ACCT-KEY.
   763     05  ACCT-PARTIAL-KEY.
   764         12  ACCT-COMPANY-CODE   PIC X.
   765         12  ACCT-CARRIER        PIC X.
   766         12  ACCT-GROUP          PIC X(6).
   767         12  ACCT-STATE          PIC XX.
   768         12  ACCT-ACCOUNT        PIC X(10).
   769     05  ACCT-DATE               PIC XX.
   770
   771 01  WS-ELBENE-KEY.
   772     12  WS-ELBENE-COMPANY-CD    PIC X.
   773     12  WS-ELBENE-RECORD-TYPE   PIC X.
   774     12  WS-ELBENE-ID            PIC X(10).
   775
   776 01  ELALPH-KEY.
   777     12  ELALPH-COMPANY-CD       PIC X.
   778     12  ELALPH-SOURCE           PIC X.
   779     12  ELALPH-NAME.
   780         16  ELALPH-LAST-NAME    PIC X(15).
   781         16  ELALPH-FIRST-NAME.
   782             20  ELALPH-FIRST-INIT   PIC X.
   783             20  FILLER              PIC X(11).
   784         16  ELALPH-MIDDLE-INIT  PIC X.
   785     12  ELALPH-DATE             PIC X(08).
   786     12  ELALPH-TIME             PIC S9(04)    COMP.
   787
   788 01  COMP-LENGTHS.
   789     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   790     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  17
* EL131.cbl
   791     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   792     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   793     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   794     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   795     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   796     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   797     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   798     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   799     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   800     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   801     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   802     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  18
* EL131.cbl
   804*                                COPY ELCLNKLT.
   805******************************************************************
   806*                                                                *
   807*                                                                *
   808*                           ELCLNKLT                             *
   809*                            VMOD=2.003                          *
   810*                                                                *
   811*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   812*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   813*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   814*                                                                *
   815*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   816*   COMPLETING THE REQUIRED FIELDS.                              *
   817*                                                                *
   818*   THE CALLING PROGRAM SHOULD CHECK:                            *
   819*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   820*                              9999 INDICATES AN UNKNOWN ABEND   *
   821*                                   WAS DETECTED.                *
   822*                              ALL OTHER VALUES ARE NORMAL ERROR *
   823*                              CODES FOUND IN THE ERROR FILE.    *
   824******************************************************************
   825 01  W-1523-LINKDATA.
   826     12  W-1523-COMMON-PI-DATA.
   827         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   828         16  FILLER              PIC  X(67).
   829         16  W-1523-COMPANY-CD   PIC  X(01).
   830         16  FILLER              PIC  X(10).
   831         16  W-1523-CONTROL-IN-PROGRESS.
   832             20  W-1523-CARRIER  PIC  X(01).
   833             20  W-1523-GROUPING PIC  X(06).
   834             20  W-1523-STATE    PIC  X(02).
   835             20  W-1523-ACCOUNT  PIC  X(10).
   836             20  W-1523-CLAIM-CERT-GRP.
   837                 24  W-1523-CLAIM-NO
   838                                 PIC  X(07).
   839                 24  W-1523-CERT-NO.
   840                     28  W-1523-CERT-PRIME
   841                                 PIC  X(10).
   842                     28  W-1523-CERT-SFX
   843                                 PIC  X(01).
   844                 24  W-1523-CERT-EFF-DT
   845                                 PIC  X(02).
   846         16  FILLER              PIC X(265).
   847
   848     12  W-1523-WORK-AREA.
   849         16  W-1523-FORM-NUMBER  PIC  X(04).
   850         16  W-1523-NUMBER-COPIES
   851                                 PIC  9(01).
   852         16  W-1523-ADDR-TYPE    PIC  X(02).
   853         16  W-1523-FOLLOW-UP-DATE
   854                                 PIC  X(02).
   855         16  W-1523-RESEND-DATE  PIC  X(02).
   856         16  W-1523-ERROR-CODE   PIC  9(04).
   857             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   858             88  W-1523-FATAL-ERROR
   859                                    VALUES  0006 0013 0042
   860                                            0154 0168 0169
   861                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  19
* EL131.cbl
   862                                            0179 0186 0281
   863                                            0332 2055 3697
   864                                            3698 3699 3770
   865                                            3771 3772 7675
   866                                            9106 9808 9883
   867                                            9887.
   868             88  W-1523-STOP-ERRORS
   869                                    VALUES  0013 0042 0154
   870                                            0168 0169 0172
   871                                            0281 0332 2055
   872                                            3698 3699 7675
   873                                            9106 9808 9883
   874                                            9999.
   875         16  W-1523-REASON       PIC  X(70).
   876         16  W-1523-ARCHIVE-NUMBER
   877                                 PIC  9(08).
   878     12  W-1523-POINTER-AREA.
   879         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   880         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   881         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   882         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   883         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  20
* EL131.cbl
   885*                                COPY ELCINTF.
   886******************************************************************
   887*                                                                *
   888*                                                                *
   889*                            ELCINTF.                            *
   890*                            VMOD=2.017                          *
   891*                                                                *
   892*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   893*                                                                *
   894*       LENGTH = 1024                                            *
   895*                                                                *
   896******************************************************************
   897*                   C H A N G E   L O G
   898*
   899* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   900*-----------------------------------------------------------------
   901*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   902* EFFECTIVE    NUMBER
   903*-----------------------------------------------------------------
   904* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   905******************************************************************
   906 01  PROGRAM-INTERFACE-BLOCK.
   907     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   908     12  PI-CALLING-PROGRAM              PIC X(8).
   909     12  PI-SAVED-PROGRAM-1              PIC X(8).
   910     12  PI-SAVED-PROGRAM-2              PIC X(8).
   911     12  PI-SAVED-PROGRAM-3              PIC X(8).
   912     12  PI-SAVED-PROGRAM-4              PIC X(8).
   913     12  PI-SAVED-PROGRAM-5              PIC X(8).
   914     12  PI-SAVED-PROGRAM-6              PIC X(8).
   915     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   916     12  PI-COMPANY-ID                   PIC XXX.
   917     12  PI-COMPANY-CD                   PIC X.
   918
   919     12  PI-COMPANY-PASSWORD             PIC X(8).
   920
   921     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   922
   923     12  PI-CONTROL-IN-PROGRESS.
   924         16  PI-CARRIER                  PIC X.
   925         16  PI-GROUPING                 PIC X(6).
   926         16  PI-STATE                    PIC XX.
   927         16  PI-ACCOUNT                  PIC X(10).
   928         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   929                                         PIC X(10).
   930         16  PI-CLAIM-CERT-GRP.
   931             20  PI-CLAIM-NO             PIC X(7).
   932             20  PI-CERT-NO.
   933                 25  PI-CERT-PRIME       PIC X(10).
   934                 25  PI-CERT-SFX         PIC X.
   935             20  PI-CERT-EFF-DT          PIC XX.
   936         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   937             20  PI-PLAN-CODE            PIC X(2).
   938             20  PI-REVISION-NUMBER      PIC X(3).
   939             20  PI-PLAN-EFF-DT          PIC X(2).
   940             20  PI-PLAN-EXP-DT          PIC X(2).
   941             20  FILLER                  PIC X(11).
   942         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  21
* EL131.cbl
   943             20  PI-OE-REFERENCE-1.
   944                 25  PI-OE-REF-1-PRIME   PIC X(18).
   945                 25  PI-OE-REF-1-SUFF    PIC XX.
   946
   947     12  PI-SESSION-IN-PROGRESS          PIC X.
   948         88  CLAIM-SESSION                   VALUE '1'.
   949         88  CREDIT-SESSION                  VALUE '2'.
   950         88  WARRANTY-SESSION                VALUE '3'.
   951         88  MORTGAGE-SESSION                VALUE '4'.
   952         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   953
   954
   955*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   956
   957     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   958     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   959
   960     12  PI-CREDIT-USER                  PIC X.
   961         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   962         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   963
   964     12  PI-CLAIM-USER                   PIC X.
   965         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   966         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   967
   968     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   969         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   970         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   971         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   972         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   973         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   974
   975     12  PI-PROCESSOR-ID                 PIC X(4).
   976
   977     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   978
   979     12  PI-MEMBER-CAPTION               PIC X(10).
   980
   981     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   982         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   983
   984     12  PI-LIFE-OVERRIDE-L1             PIC X.
   985     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   986     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   987     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   988
   989     12  PI-AH-OVERRIDE-L1               PIC X.
   990     12  PI-AH-OVERRIDE-L2               PIC XX.
   991     12  PI-AH-OVERRIDE-L6               PIC X(6).
   992     12  PI-AH-OVERRIDE-L12              PIC X(12).
   993
   994     12  PI-NEW-SYSTEM                   PIC X(2).
   995
   996     12  PI-PRIMARY-CERT-NO              PIC X(11).
   997     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   998         88  PI-USES-PAID-TO                 VALUE '1'.
   999     12  PI-CRDTCRD-SYSTEM.
  1000         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  22
* EL131.cbl
  1001             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1002             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1003         16  PI-CC-MONTH-END-DT          PIC XX.
  1004     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1005
  1006     12  PI-OE-REFERENCE-2.
  1007         16  PI-OE-REF-2-PRIME           PIC X(10).
  1008         16  PI-OE-REF-2-SUFF            PIC X.
  1009
  1010     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1011
  1012     12  PI-LANGUAGE-TYPE                PIC X.
  1013             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1014             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1015             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1016
  1017     12  PI-POLICY-LINKAGE-IND           PIC X.
  1018         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1019         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1020                                                   LOW-VALUES.
  1021
  1022     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1023     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1024         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1025         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1026
  1027     12  PI-PROCESSOR-CSR-IND            PIC X.
  1028         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1029         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1030
  1031     12  FILLER                          PIC X(3).
  1032
  1033     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1034
  1035     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1036         PI-SYSTEM-LEVEL.
  1037
  1038         16  PI-ENTRY-CODES.
  1039             20  PI-ENTRY-CD-1           PIC X.
  1040             20  PI-ENTRY-CD-2           PIC X.
  1041
  1042         16  PI-RETURN-CODES.
  1043             20  PI-RETURN-CD-1          PIC X.
  1044             20  PI-RETURN-CD-2          PIC X.
  1045
  1046         16  PI-UPDATE-STATUS-SAVE.
  1047             20  PI-UPDATE-BY            PIC X(4).
  1048             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1049
  1050         16  PI-LOWER-CASE-LETTERS       PIC X.
  1051             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1052
  1053*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1054*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1055*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1056
  1057         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1058             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  23
* EL131.cbl
  1059             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1060             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1061             88  ACCNT-CNTL                  VALUE '3'.
  1062             88  CARR-ACCNT-CNTL             VALUE '4'.
  1063
  1064         16  PI-PROCESSOR-CAP-LIST.
  1065             20  PI-SYSTEM-CONTROLS.
  1066                24 PI-SYSTEM-DISPLAY     PIC X.
  1067                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1068                24 PI-SYSTEM-MODIFY      PIC X.
  1069                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1070             20  FILLER                  PIC XX.
  1071             20  PI-DISPLAY-CAP          PIC X.
  1072                 88  DISPLAY-CAP             VALUE 'Y'.
  1073             20  PI-MODIFY-CAP           PIC X.
  1074                 88  MODIFY-CAP              VALUE 'Y'.
  1075             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1076                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1077             20  PI-FORCE-CAP            PIC X.
  1078                 88  FORCE-CAP               VALUE 'Y'.
  1079
  1080         16  PI-PROGRAM-CONTROLS.
  1081             20  PI-PGM-PRINT-OPT        PIC X.
  1082             20  PI-PGM-FORMAT-OPT       PIC X.
  1083             20  PI-PGM-PROCESS-OPT      PIC X.
  1084             20  PI-PGM-TOTALS-OPT       PIC X.
  1085
  1086         16  PI-HELP-INTERFACE.
  1087             20  PI-LAST-ERROR-NO        PIC X(4).
  1088             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1089
  1090         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1091             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1092
  1093         16  PI-CR-CONTROL-IN-PROGRESS.
  1094             20  PI-CR-CARRIER           PIC X.
  1095             20  PI-CR-GROUPING          PIC X(6).
  1096             20  PI-CR-STATE             PIC XX.
  1097             20  PI-CR-ACCOUNT           PIC X(10).
  1098             20  PI-CR-FIN-RESP          PIC X(10).
  1099             20  PI-CR-TYPE              PIC X.
  1100
  1101         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1102
  1103         16  PI-CR-MONTH-END-DT          PIC XX.
  1104
  1105         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1106             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1107             88  PI-ZERO-CARRIER             VALUE '1'.
  1108             88  PI-ZERO-GROUPING            VALUE '2'.
  1109             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1110
  1111         16  PI-CARRIER-SECURITY         PIC X.
  1112             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1113
  1114         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1115             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1116             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  24
* EL131.cbl
  1117
  1118         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1119             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1120                                         INDEXED BY PI-ACCESS-NDX
  1121                                         PIC X.
  1122
  1123         16  PI-GA-BILLING-CONTROL       PIC X.
  1124             88  PI-GA-BILLING               VALUE '1'.
  1125
  1126         16  PI-MAIL-PROCESSING          PIC X.
  1127             88  PI-MAIL-YES                 VALUE 'Y'.
  1128
  1129         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1130
  1131         16  PI-AR-SYSTEM.
  1132             20  PI-AR-PROCESSING-CNTL   PIC X.
  1133                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1134             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1135             20  PI-AR-MONTH-END-DT      PIC XX.
  1136
  1137         16  PI-MP-SYSTEM.
  1138             20  PI-MORTGAGE-USER            PIC X.
  1139                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1140                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1141             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1142                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1143                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1144                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1145                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1146                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1147             20  PI-MP-MONTH-END-DT          PIC XX.
  1148             20  PI-MP-REFERENCE-NO.
  1149                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1150                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1151
  1152         16  PI-LABEL-CONTROL            PIC X(01).
  1153             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1154             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1155
  1156         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1157             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1158
  1159         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1160             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1161             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1162
  1163         16  FILLER                      PIC X(14).
  1164
  1165     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1166******************************************************************
  1167     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1168         16  PI-NO-PMTS                    PIC 9(4).
  1169         16  PI-CERT-SWITCH                PIC X.
  1170             88  CREATED-CERT              VALUE '2'.
  1171         16  PI-PREM-TYPE                  PIC X.
  1172         16  PI-SAVE-CERT-NO.
  1173             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1174             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  25
* EL131.cbl
  1175         16  FILLER                        PIC X(46).
  1176         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1177         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1178         16  PI-REC-FOUND-SW               PIC X.
  1179         16  PI-LETTER-SW                  PIC X.
  1180         16  PI-PREV-TRLR-KEY              PIC X(22).
  1181         16  pi-claim-type                 pic x.
  1182         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1183         16  pi-approval-level             pic x.
  1184         16  FILLER                        PIC X(543).
  1185
  1186 01  SAVE-RECORD                 PIC X(450).
  1187
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  26
* EL131.cbl
  1189*                                COPY ELCLOGOF SUPPRESS.
  1190******************************************************************
  1191*                                                                *
  1192*                                                                *
  1193*                            ELCLOGOF.                           *
  1194*                            VMOD=2.001                          *
  1195*                                                                *
  1196*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1197*                                                                *
  1198******************************************************************
  1199 01  CLASIC-LOGOFF.
  1200     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1201     12  LOGOFF-TEXT.
  1202         16  FILLER          PIC X(5)    VALUE SPACES.
  1203         16  LOGOFF-MSG.
  1204             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1205             20  FILLER      PIC X       VALUE SPACES.
  1206             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1207         16  FILLER          PIC X(80)
  1208           VALUE '* YOU ARE NOW LOGGED OFF'.
  1209         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1210         16  FILLER          PIC X       VALUE QUOTE.
  1211         16  LOGOFF-SYS-MSG  PIC X(17)
  1212           VALUE 'S CLAS-IC SYSTEM '.
  1213     12  TEXT-MESSAGES.
  1214         16  UNACCESS-MSG    PIC X(29)
  1215             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1216         16  PGMIDERR-MSG    PIC X(17)
  1217             VALUE 'PROGRAM NOT FOUND'.
  1218
  1219*                                COPY ELCATTR SUPPRESS.
  1220******************************************************************
  1221*                                                                *
  1222*                            ELCATTR.                            *
  1223*                            VMOD=2.001                          *
  1224*                                                                *
  1225*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1226*                                                                *
  1227*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1228*                                                                *
  1229*                   POS 1   P=PROTECTED                          *
  1230*                           U=UNPROTECTED                        *
  1231*                           S=ASKIP                              *
  1232*                   POS 2   A=ALPHA/NUMERIC                      *
  1233*                           N=NUMERIC                            *
  1234*                   POS 3   N=NORMAL                             *
  1235*                           B=BRIGHT                             *
  1236*                           D=DARK                               *
  1237*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1238*                           OF=MODIFIED DATA TAG OFF             *
  1239*                                                                *
  1240*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1241******************************************************************
  1242 01  ATTRIBUTE-LIST.
  1243     12  AL-PABOF            PIC X       VALUE 'Y'.
  1244     12  AL-PABON            PIC X       VALUE 'Z'.
  1245     12  AL-PADOF            PIC X       VALUE '%'.
  1246     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  27
* EL131.cbl
  1247     12  AL-PANOF            PIC X       VALUE '-'.
  1248     12  AL-PANON            PIC X       VALUE '/'.
  1249     12  AL-SABOF            PIC X       VALUE '8'.
  1250     12  AL-SABON            PIC X       VALUE '9'.
  1251     12  AL-SADOF            PIC X       VALUE '@'.
  1252     12  AL-SADON            PIC X       VALUE QUOTE.
  1253     12  AL-SANOF            PIC X       VALUE '0'.
  1254     12  AL-SANON            PIC X       VALUE '1'.
  1255     12  AL-UABOF            PIC X       VALUE 'H'.
  1256     12  AL-UABON            PIC X       VALUE 'I'.
  1257     12  AL-UADOF            PIC X       VALUE '<'.
  1258     12  AL-UADON            PIC X       VALUE '('.
  1259     12  AL-UANOF            PIC X       VALUE ' '.
  1260     12  AL-UANON            PIC X       VALUE 'A'.
  1261     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1262     12  AL-UNBON            PIC X       VALUE 'R'.
  1263     12  AL-UNDOF            PIC X       VALUE '*'.
  1264     12  AL-UNDON            PIC X       VALUE ')'.
  1265     12  AL-UNNOF            PIC X       VALUE '&'.
  1266     12  AL-UNNON            PIC X       VALUE 'J'.
  1267
  1268*                                COPY ELCAID SUPPRESS.
  1269******************************************************************
  1270*                                                                *
  1271*                            ELCAID.                             *
  1272*                            VMOD=2.001                          *
  1273*                                                                *
  1274*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1275*                                                                *
  1276*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1277*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1278******************************************************************
  1279
  1280 01  DFHAID.
  1281   02  DFHNULL   PIC  X  VALUE  ' '.
  1282   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1283   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1284   02  DFHPEN    PIC  X  VALUE  '='.
  1285   02  DFHOPID   PIC  X  VALUE  'W'.
  1286   02  DFHPA1    PIC  X  VALUE  '%'.
  1287   02  DFHPA2    PIC  X  VALUE  '>'.
  1288   02  DFHPA3    PIC  X  VALUE  ','.
  1289   02  DFHPF1    PIC  X  VALUE  '1'.
  1290   02  DFHPF2    PIC  X  VALUE  '2'.
  1291   02  DFHPF3    PIC  X  VALUE  '3'.
  1292   02  DFHPF4    PIC  X  VALUE  '4'.
  1293   02  DFHPF5    PIC  X  VALUE  '5'.
  1294   02  DFHPF6    PIC  X  VALUE  '6'.
  1295   02  DFHPF7    PIC  X  VALUE  '7'.
  1296   02  DFHPF8    PIC  X  VALUE  '8'.
  1297   02  DFHPF9    PIC  X  VALUE  '9'.
  1298   02  DFHPF10   PIC  X  VALUE  ':'.
  1299   02  DFHPF11   PIC  X  VALUE  '#'.
  1300   02  DFHPF12   PIC  X  VALUE  '@'.
  1301   02  DFHPF13   PIC  X  VALUE  'A'.
  1302   02  DFHPF14   PIC  X  VALUE  'B'.
  1303   02  DFHPF15   PIC  X  VALUE  'C'.
  1304   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  28
* EL131.cbl
  1305   02  DFHPF17   PIC  X  VALUE  'E'.
  1306   02  DFHPF18   PIC  X  VALUE  'F'.
  1307   02  DFHPF19   PIC  X  VALUE  'G'.
  1308   02  DFHPF20   PIC  X  VALUE  'H'.
  1309   02  DFHPF21   PIC  X  VALUE  'I'.
  1310*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1311   02  DFHPF22   PIC  X  VALUE  '['.
  1312   02  DFHPF23   PIC  X  VALUE  '.'.
  1313   02  DFHPF24   PIC  X  VALUE  '<'.
  1314   02  DFHMSRE   PIC  X  VALUE  'X'.
  1315   02  DFHSTRF   PIC  X  VALUE  'h'.
  1316   02  DFHTRIG   PIC  X  VALUE  '"'.
  1317 01  FILLER REDEFINES DFHAID.
  1318     12  FILLER                  PIC X(8).
  1319     12  AID-KEYS OCCURS 24 TIMES.
  1320         16  FILLER              PIC X.
  1321
  1322*                                COPY EL131S.
  1323 01  EL131AI.
  1324     05  FILLER            PIC  X(0012).
  1325*    -------------------------------
  1326     05  DATEL PIC S9(0004) COMP.
  1327     05  DATEF PIC  X(0001).
  1328     05  FILLER REDEFINES DATEF.
  1329         10  DATEA PIC  X(0001).
  1330     05  DATEI PIC  X(0008).
  1331*    -------------------------------
  1332     05  TIMEL PIC S9(0004) COMP.
  1333     05  TIMEF PIC  X(0001).
  1334     05  FILLER REDEFINES TIMEF.
  1335         10  TIMEA PIC  X(0001).
  1336     05  TIMEI PIC  X(0005).
  1337*    -------------------------------
  1338     05  SEQUL PIC S9(0004) COMP.
  1339     05  SEQUF PIC  X(0001).
  1340     05  FILLER REDEFINES SEQUF.
  1341         10  SEQUA PIC  X(0001).
  1342     05  SEQUI PIC  X(0010).
  1343*    -------------------------------
  1344     05  COMPL PIC S9(0004) COMP.
  1345     05  COMPF PIC  X(0001).
  1346     05  FILLER REDEFINES COMPF.
  1347         10  COMPA PIC  X(0001).
  1348     05  COMPI PIC  X(0003).
  1349*    -------------------------------
  1350     05  USERIDL PIC S9(0004) COMP.
  1351     05  USERIDF PIC  X(0001).
  1352     05  FILLER REDEFINES USERIDF.
  1353         10  USERIDA PIC  X(0001).
  1354     05  USERIDI PIC  X(0004).
  1355*    -------------------------------
  1356     05  CCNOL PIC S9(0004) COMP.
  1357     05  CCNOF PIC  X(0001).
  1358     05  FILLER REDEFINES CCNOF.
  1359         10  CCNOA PIC  X(0001).
  1360     05  CCNOI PIC  X(0016).
  1361*    -------------------------------
  1362     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  29
* EL131.cbl
  1363     05  MAINTF PIC  X(0001).
  1364     05  FILLER REDEFINES MAINTF.
  1365         10  MAINTA PIC  X(0001).
  1366     05  MAINTI PIC  X(0001).
  1367*    -------------------------------
  1368     05  CLAIML PIC S9(0004) COMP.
  1369     05  CLAIMF PIC  X(0001).
  1370     05  FILLER REDEFINES CLAIMF.
  1371         10  CLAIMA PIC  X(0001).
  1372     05  CLAIMI PIC  X(0007).
  1373*    -------------------------------
  1374     05  CARRL PIC S9(0004) COMP.
  1375     05  CARRF PIC  X(0001).
  1376     05  FILLER REDEFINES CARRF.
  1377         10  CARRA PIC  X(0001).
  1378     05  CARRI PIC  X(0001).
  1379*    -------------------------------
  1380     05  CERTL PIC S9(0004) COMP.
  1381     05  CERTF PIC  X(0001).
  1382     05  FILLER REDEFINES CERTF.
  1383         10  CERTA PIC  X(0001).
  1384     05  CERTI PIC  X(0010).
  1385*    -------------------------------
  1386     05  SUFXL PIC S9(0004) COMP.
  1387     05  SUFXF PIC  X(0001).
  1388     05  FILLER REDEFINES SUFXF.
  1389         10  SUFXA PIC  X(0001).
  1390     05  SUFXI PIC  X(0001).
  1391*    -------------------------------
  1392     05  TYPEL PIC S9(0004) COMP.
  1393     05  TYPEF PIC  X(0001).
  1394     05  FILLER REDEFINES TYPEF.
  1395         10  TYPEA PIC  X(0001).
  1396     05  TYPEI PIC  X(0001).
  1397*    -------------------------------
  1398     05  LABEL1L PIC S9(0004) COMP.
  1399     05  LABEL1F PIC  X(0001).
  1400     05  FILLER REDEFINES LABEL1F.
  1401         10  LABEL1A PIC  X(0001).
  1402     05  LABEL1I PIC  X(0011).
  1403*    -------------------------------
  1404     05  PCERTNOL PIC S9(0004) COMP.
  1405     05  PCERTNOF PIC  X(0001).
  1406     05  FILLER REDEFINES PCERTNOF.
  1407         10  PCERTNOA PIC  X(0001).
  1408     05  PCERTNOI PIC  X(0010).
  1409*    -------------------------------
  1410     05  PSUFXL PIC S9(0004) COMP.
  1411     05  PSUFXF PIC  X(0001).
  1412     05  FILLER REDEFINES PSUFXF.
  1413         10  PSUFXA PIC  X(0001).
  1414     05  PSUFXI PIC  X(0001).
  1415*    -------------------------------
  1416     05  STATUSL PIC S9(0004) COMP.
  1417     05  STATUSF PIC  X(0001).
  1418     05  FILLER REDEFINES STATUSF.
  1419         10  STATUSA PIC  X(0001).
  1420     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  30
* EL131.cbl
  1421*    -------------------------------
  1422     05  INCL PIC S9(0004) COMP.
  1423     05  INCF PIC  X(0001).
  1424     05  FILLER REDEFINES INCF.
  1425         10  INCA PIC  X(0001).
  1426     05  INCI PIC  X(0008).
  1427*    -------------------------------
  1428     05  REPL PIC S9(0004) COMP.
  1429     05  REPF PIC  X(0001).
  1430     05  FILLER REDEFINES REPF.
  1431         10  REPA PIC  X(0001).
  1432     05  REPI PIC  X(0008).
  1433*    -------------------------------
  1434     05  CAUSEL PIC S9(0004) COMP.
  1435     05  CAUSEF PIC  X(0001).
  1436     05  FILLER REDEFINES CAUSEF.
  1437         10  CAUSEA PIC  X(0001).
  1438     05  CAUSEI PIC  X(0006).
  1439*    -------------------------------
  1440     05  ENDL PIC S9(0004) COMP.
  1441     05  ENDF PIC  X(0001).
  1442     05  FILLER REDEFINES ENDF.
  1443         10  ENDA PIC  X(0001).
  1444     05  ENDI PIC  X(0008).
  1445*    -------------------------------
  1446     05  DIAGL PIC S9(0004) COMP.
  1447     05  DIAGF PIC  X(0001).
  1448     05  FILLER REDEFINES DIAGF.
  1449         10  DIAGA PIC  X(0001).
  1450     05  DIAGI PIC  X(0060).
  1451*    -------------------------------
  1452     05  ACCSWL PIC S9(0004) COMP.
  1453     05  ACCSWF PIC  X(0001).
  1454     05  FILLER REDEFINES ACCSWF.
  1455         10  ACCSWA PIC  X(0001).
  1456     05  ACCSWI PIC  X(0001).
  1457*    -------------------------------
  1458     05  BENEL PIC S9(0004) COMP.
  1459     05  BENEF PIC  X(0001).
  1460     05  FILLER REDEFINES BENEF.
  1461         10  BENEA PIC  X(0001).
  1462     05  BENEI PIC  X(0010).
  1463*    -------------------------------
  1464     05  BIRTHL PIC S9(0004) COMP.
  1465     05  BIRTHF PIC  X(0001).
  1466     05  FILLER REDEFINES BIRTHF.
  1467         10  BIRTHA PIC  X(0001).
  1468     05  BIRTHI PIC  X(0008).
  1469*    -------------------------------
  1470     05  SOCIALL PIC S9(0004) COMP.
  1471     05  SOCIALF PIC  X(0001).
  1472     05  FILLER REDEFINES SOCIALF.
  1473         10  SOCIALA PIC  X(0001).
  1474     05  SOCIALI PIC  X(0011).
  1475*    -------------------------------
  1476     05  SEXL PIC S9(0004) COMP.
  1477     05  SEXF PIC  X(0001).
  1478     05  FILLER REDEFINES SEXF.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  31
* EL131.cbl
  1479         10  SEXA PIC  X(0001).
  1480     05  SEXI PIC  X(0001).
  1481*    -------------------------------
  1482     05  MLNAMEL PIC S9(0004) COMP.
  1483     05  MLNAMEF PIC  X(0001).
  1484     05  FILLER REDEFINES MLNAMEF.
  1485         10  MLNAMEA PIC  X(0001).
  1486     05  MLNAMEI PIC  X(0015).
  1487*    -------------------------------
  1488     05  MFNAMEL PIC S9(0004) COMP.
  1489     05  MFNAMEF PIC  X(0001).
  1490     05  FILLER REDEFINES MFNAMEF.
  1491         10  MFNAMEA PIC  X(0001).
  1492     05  MFNAMEI PIC  X(0012).
  1493*    -------------------------------
  1494     05  MMINITL PIC S9(0004) COMP.
  1495     05  MMINITF PIC  X(0001).
  1496     05  FILLER REDEFINES MMINITF.
  1497         10  MMINITA PIC  X(0001).
  1498     05  MMINITI PIC  X(0001).
  1499*    -------------------------------
  1500     05  LOANNOL PIC S9(0004) COMP.
  1501     05  LOANNOF PIC  X(0001).
  1502     05  FILLER REDEFINES LOANNOF.
  1503         10  LOANNOA PIC  X(0001).
  1504     05  LOANNOI PIC  X(0008).
  1505*    -------------------------------
  1506     05  CRTLNMEL PIC S9(0004) COMP.
  1507     05  CRTLNMEF PIC  X(0001).
  1508     05  FILLER REDEFINES CRTLNMEF.
  1509         10  CRTLNMEA PIC  X(0001).
  1510     05  CRTLNMEI PIC  X(0015).
  1511*    -------------------------------
  1512     05  CRTFNMEL PIC S9(0004) COMP.
  1513     05  CRTFNMEF PIC  X(0001).
  1514     05  FILLER REDEFINES CRTFNMEF.
  1515         10  CRTFNMEA PIC  X(0001).
  1516     05  CRTFNMEI PIC  X(0012).
  1517*    -------------------------------
  1518     05  CRTINITL PIC S9(0004) COMP.
  1519     05  CRTINITF PIC  X(0001).
  1520     05  FILLER REDEFINES CRTINITF.
  1521         10  CRTINITA PIC  X(0001).
  1522     05  CRTINITI PIC  X(0001).
  1523*    -------------------------------
  1524     05  LOANBALL PIC S9(0004) COMP.
  1525     05  LOANBALF PIC  X(0001).
  1526     05  FILLER REDEFINES LOANBALF.
  1527         10  LOANBALA PIC  X(0001).
  1528     05  LOANBALI PIC  9(7)V99.
  1529*    -------------------------------
  1530     05  PROCL PIC S9(0004) COMP.
  1531     05  PROCF PIC  X(0001).
  1532     05  FILLER REDEFINES PROCF.
  1533         10  PROCA PIC  X(0001).
  1534     05  PROCI PIC  X(0004).
  1535*    -------------------------------
  1536     05  SUPVL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  32
* EL131.cbl
  1537     05  SUPVF PIC  X(0001).
  1538     05  FILLER REDEFINES SUPVF.
  1539         10  SUPVA PIC  X(0001).
  1540     05  SUPVI PIC  X(0001).
  1541*    -------------------------------
  1542     05  PRICDL PIC S9(0004) COMP.
  1543     05  PRICDF PIC  X(0001).
  1544     05  FILLER REDEFINES PRICDF.
  1545         10  PRICDA PIC  X(0001).
  1546     05  PRICDI PIC  X(0001).
  1547*    -------------------------------
  1548     05  CRITPL PIC S9(0004) COMP.
  1549     05  CRITPF PIC  X(0001).
  1550     05  FILLER REDEFINES CRITPF.
  1551         10  CRITPA PIC  X(0001).
  1552     05  CRITPI PIC  X(0002).
  1553*    -------------------------------
  1554     05  CRITPTL PIC S9(0004) COMP.
  1555     05  CRITPTF PIC  X(0001).
  1556     05  FILLER REDEFINES CRITPTF.
  1557         10  CRITPTA PIC  X(0001).
  1558     05  CRITPTI PIC  X(0001).
  1559*    -------------------------------
  1560     05  RTWMOSL PIC S9(0004) COMP.
  1561     05  RTWMOSF PIC  X(0001).
  1562     05  FILLER REDEFINES RTWMOSF.
  1563         10  RTWMOSA PIC  X(0001).
  1564     05  RTWMOSI PIC  X(0002).
  1565*    -------------------------------
  1566     05  FILETOL PIC S9(0004) COMP.
  1567     05  FILETOF PIC  X(0001).
  1568     05  FILLER REDEFINES FILETOF.
  1569         10  FILETOA PIC  X(0001).
  1570     05  FILETOI PIC  X(0004).
  1571*    -------------------------------
  1572     05  PTHRHDGL PIC S9(0004) COMP.
  1573     05  PTHRHDGF PIC  X(0001).
  1574     05  FILLER REDEFINES PTHRHDGF.
  1575         10  PTHRHDGA PIC  X(0001).
  1576     05  PTHRHDGI PIC  X(0010).
  1577*    -------------------------------
  1578     05  PDTHRUL PIC S9(0004) COMP.
  1579     05  PDTHRUF PIC  X(0001).
  1580     05  FILLER REDEFINES PDTHRUF.
  1581         10  PDTHRUA PIC  X(0001).
  1582     05  PDTHRUI PIC  X(0008).
  1583*    -------------------------------
  1584     05  PDAMTL PIC S9(0004) COMP.
  1585     05  PDAMTF PIC  X(0001).
  1586     05  FILLER REDEFINES PDAMTF.
  1587         10  PDAMTA PIC  X(0001).
  1588     05  PDAMTI PIC  9(7)V99.
  1589*    -------------------------------
  1590     05  NODAYSL PIC S9(0004) COMP.
  1591     05  NODAYSF PIC  X(0001).
  1592     05  FILLER REDEFINES NODAYSF.
  1593         10  NODAYSA PIC  X(0001).
  1594     05  NODAYSI PIC  9(5).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  33
* EL131.cbl
  1595*    -------------------------------
  1596     05  NOPMTSL PIC S9(0004) COMP.
  1597     05  NOPMTSF PIC  X(0001).
  1598     05  FILLER REDEFINES NOPMTSF.
  1599         10  NOPMTSA PIC  X(0001).
  1600     05  NOPMTSI PIC  9(4).
  1601*    -------------------------------
  1602     05  FORMTYPL PIC S9(0004) COMP.
  1603     05  FORMTYPF PIC  X(0001).
  1604     05  FILLER REDEFINES FORMTYPF.
  1605         10  FORMTYPA PIC  X(0001).
  1606     05  FORMTYPI PIC  X(0001).
  1607*    -------------------------------
  1608     05  ESTL PIC S9(0004) COMP.
  1609     05  ESTF PIC  X(0001).
  1610     05  FILLER REDEFINES ESTF.
  1611         10  ESTA PIC  X(0001).
  1612     05  ESTI PIC  X(0008).
  1613*    -------------------------------
  1614     05  AUIDL PIC S9(0004) COMP.
  1615     05  AUIDF PIC  X(0001).
  1616     05  FILLER REDEFINES AUIDF.
  1617         10  AUIDA PIC  X(0001).
  1618     05  AUIDI PIC  X(0004).
  1619*    -------------------------------
  1620     05  OCCL PIC S9(0004) COMP.
  1621     05  OCCF PIC  X(0001).
  1622     05  FILLER REDEFINES OCCF.
  1623         10  OCCA PIC  X(0001).
  1624     05  OCCI PIC  X(0006).
  1625*    -------------------------------
  1626     05  MNTDTL PIC S9(0004) COMP.
  1627     05  MNTDTF PIC  X(0001).
  1628     05  FILLER REDEFINES MNTDTF.
  1629         10  MNTDTA PIC  X(0001).
  1630     05  MNTDTI PIC  X(0008).
  1631*    -------------------------------
  1632     05  MNTTYPEL PIC S9(0004) COMP.
  1633     05  MNTTYPEF PIC  X(0001).
  1634     05  FILLER REDEFINES MNTTYPEF.
  1635         10  MNTTYPEA PIC  X(0001).
  1636     05  MNTTYPEI PIC  X(0006).
  1637*    -------------------------------
  1638     05  CERTCARL PIC S9(0004) COMP.
  1639     05  CERTCARF PIC  X(0001).
  1640     05  FILLER REDEFINES CERTCARF.
  1641         10  CERTCARA PIC  X(0001).
  1642     05  CERTCARI PIC  X(0001).
  1643*    -------------------------------
  1644     05  CERTGRPL PIC S9(0004) COMP.
  1645     05  CERTGRPF PIC  X(0001).
  1646     05  FILLER REDEFINES CERTGRPF.
  1647         10  CERTGRPA PIC  X(0001).
  1648     05  CERTGRPI PIC  X(0006).
  1649*    -------------------------------
  1650     05  CERTSTL PIC S9(0004) COMP.
  1651     05  CERTSTF PIC  X(0001).
  1652     05  FILLER REDEFINES CERTSTF.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  34
* EL131.cbl
  1653         10  CERTSTA PIC  X(0001).
  1654     05  CERTSTI PIC  X(0002).
  1655*    -------------------------------
  1656     05  CERTACTL PIC S9(0004) COMP.
  1657     05  CERTACTF PIC  X(0001).
  1658     05  FILLER REDEFINES CERTACTF.
  1659         10  CERTACTA PIC  X(0001).
  1660     05  CERTACTI PIC  X(0010).
  1661*    -------------------------------
  1662     05  CERTEFFL PIC S9(0004) COMP.
  1663     05  CERTEFFF PIC  X(0001).
  1664     05  FILLER REDEFINES CERTEFFF.
  1665         10  CERTEFFA PIC  X(0001).
  1666     05  CERTEFFI PIC  X(0008).
  1667*    -------------------------------
  1668     05  ISSAGEL PIC S9(0004) COMP.
  1669     05  ISSAGEF PIC  X(0001).
  1670     05  FILLER REDEFINES ISSAGEF.
  1671         10  ISSAGEA PIC  X(0001).
  1672     05  ISSAGEI PIC  X(0002).
  1673*    -------------------------------
  1674     05  APRL PIC S9(0004) COMP.
  1675     05  APRF PIC  X(0001).
  1676     05  FILLER REDEFINES APRF.
  1677         10  APRA PIC  X(0001).
  1678     05  APRI PIC  9(4)V9(4).
  1679*    -------------------------------
  1680     05  PMTFREQL PIC S9(0004) COMP.
  1681     05  PMTFREQF PIC  X(0001).
  1682     05  FILLER REDEFINES PMTFREQF.
  1683         10  PMTFREQA PIC  X(0001).
  1684     05  PMTFREQI PIC  99.
  1685*    -------------------------------
  1686     05  INDGRPL PIC S9(0004) COMP.
  1687     05  INDGRPF PIC  X(0001).
  1688     05  FILLER REDEFINES INDGRPF.
  1689         10  INDGRPA PIC  X(0001).
  1690     05  INDGRPI PIC  X(0001).
  1691*    -------------------------------
  1692     05  PREMTYPL PIC S9(0004) COMP.
  1693     05  PREMTYPF PIC  X(0001).
  1694     05  FILLER REDEFINES PREMTYPF.
  1695         10  PREMTYPA PIC  X(0001).
  1696     05  PREMTYPI PIC  X(0001).
  1697*    -------------------------------
  1698     05  REINCDL PIC S9(0004) COMP.
  1699     05  REINCDF PIC  X(0001).
  1700     05  FILLER REDEFINES REINCDF.
  1701         10  REINCDA PIC  X(0001).
  1702     05  REINCDI PIC  X(0001).
  1703*    -------------------------------
  1704     05  JNTLNMEL PIC S9(0004) COMP.
  1705     05  JNTLNMEF PIC  X(0001).
  1706     05  FILLER REDEFINES JNTLNMEF.
  1707         10  JNTLNMEA PIC  X(0001).
  1708     05  JNTLNMEI PIC  X(0015).
  1709*    -------------------------------
  1710     05  JNTFNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  35
* EL131.cbl
  1711     05  JNTFNMEF PIC  X(0001).
  1712     05  FILLER REDEFINES JNTFNMEF.
  1713         10  JNTFNMEA PIC  X(0001).
  1714     05  JNTFNMEI PIC  X(0012).
  1715*    -------------------------------
  1716     05  JNTINITL PIC S9(0004) COMP.
  1717     05  JNTINITF PIC  X(0001).
  1718     05  FILLER REDEFINES JNTINITF.
  1719         10  JNTINITA PIC  X(0001).
  1720     05  JNTINITI PIC  X(0001).
  1721*    -------------------------------
  1722     05  JNTAGEL PIC S9(0004) COMP.
  1723     05  JNTAGEF PIC  X(0001).
  1724     05  FILLER REDEFINES JNTAGEF.
  1725         10  JNTAGEA PIC  X(0001).
  1726     05  JNTAGEI PIC  X(0002).
  1727*    -------------------------------
  1728     05  ADDONDTL PIC S9(0004) COMP.
  1729     05  ADDONDTF PIC  X(0001).
  1730     05  FILLER REDEFINES ADDONDTF.
  1731         10  ADDONDTA PIC  X(0001).
  1732     05  ADDONDTI PIC  X(0008).
  1733*    -------------------------------
  1734     05  LCVDSCRL PIC S9(0004) COMP.
  1735     05  LCVDSCRF PIC  X(0001).
  1736     05  FILLER REDEFINES LCVDSCRF.
  1737         10  LCVDSCRA PIC  X(0001).
  1738     05  LCVDSCRI PIC  X(0006).
  1739*    -------------------------------
  1740     05  LCVKINDL PIC S9(0004) COMP.
  1741     05  LCVKINDF PIC  X(0001).
  1742     05  FILLER REDEFINES LCVKINDF.
  1743         10  LCVKINDA PIC  X(0001).
  1744     05  LCVKINDI PIC  X(0003).
  1745*    -------------------------------
  1746     05  LCVCDL PIC S9(0004) COMP.
  1747     05  LCVCDF PIC  X(0001).
  1748     05  FILLER REDEFINES LCVCDF.
  1749         10  LCVCDA PIC  X(0001).
  1750     05  LCVCDI PIC  X(0002).
  1751*    -------------------------------
  1752     05  LCVOTRML PIC S9(0004) COMP.
  1753     05  LCVOTRMF PIC  X(0001).
  1754     05  FILLER REDEFINES LCVOTRMF.
  1755         10  LCVOTRMA PIC  X(0001).
  1756     05  LCVOTRMI PIC  999.
  1757*    -------------------------------
  1758     05  LCVRTRML PIC S9(0004) COMP.
  1759     05  LCVRTRMF PIC  X(0001).
  1760     05  FILLER REDEFINES LCVRTRMF.
  1761         10  LCVRTRMA PIC  X(0001).
  1762     05  LCVRTRMI PIC  X(0003).
  1763*    -------------------------------
  1764     05  LCVRATEL PIC S9(0004) COMP.
  1765     05  LCVRATEF PIC  X(0001).
  1766     05  FILLER REDEFINES LCVRATEF.
  1767         10  LCVRATEA PIC  X(0001).
  1768     05  LCVRATEI PIC  9999V99.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  36
* EL131.cbl
  1769*    -------------------------------
  1770     05  LCVBENEL PIC S9(0004) COMP.
  1771     05  LCVBENEF PIC  X(0001).
  1772     05  FILLER REDEFINES LCVBENEF.
  1773         10  LCVBENEA PIC  X(0001).
  1774     05  LCVBENEI PIC  9(9)V99.
  1775*    -------------------------------
  1776     05  LCVFORML PIC S9(0004) COMP.
  1777     05  LCVFORMF PIC  X(0001).
  1778     05  FILLER REDEFINES LCVFORMF.
  1779         10  LCVFORMA PIC  X(0001).
  1780     05  LCVFORMI PIC  X(0012).
  1781*    -------------------------------
  1782     05  LCVCNDTL PIC S9(0004) COMP.
  1783     05  LCVCNDTF PIC  X(0001).
  1784     05  FILLER REDEFINES LCVCNDTF.
  1785         10  LCVCNDTA PIC  X(0001).
  1786     05  LCVCNDTI PIC  X(0008).
  1787*    -------------------------------
  1788     05  LCVEXITL PIC S9(0004) COMP.
  1789     05  LCVEXITF PIC  X(0001).
  1790     05  FILLER REDEFINES LCVEXITF.
  1791         10  LCVEXITA PIC  X(0001).
  1792     05  LCVEXITI PIC  X(0008).
  1793*    -------------------------------
  1794     05  LCVSTATL PIC S9(0004) COMP.
  1795     05  LCVSTATF PIC  X(0001).
  1796     05  FILLER REDEFINES LCVSTATF.
  1797         10  LCVSTATA PIC  X(0001).
  1798     05  LCVSTATI PIC  X(0006).
  1799*    -------------------------------
  1800     05  ACVDSCRL PIC S9(0004) COMP.
  1801     05  ACVDSCRF PIC  X(0001).
  1802     05  FILLER REDEFINES ACVDSCRF.
  1803         10  ACVDSCRA PIC  X(0001).
  1804     05  ACVDSCRI PIC  X(0006).
  1805*    -------------------------------
  1806     05  ACVKINDL PIC S9(0004) COMP.
  1807     05  ACVKINDF PIC  X(0001).
  1808     05  FILLER REDEFINES ACVKINDF.
  1809         10  ACVKINDA PIC  X(0001).
  1810     05  ACVKINDI PIC  X(0003).
  1811*    -------------------------------
  1812     05  ACVCDL PIC S9(0004) COMP.
  1813     05  ACVCDF PIC  X(0001).
  1814     05  FILLER REDEFINES ACVCDF.
  1815         10  ACVCDA PIC  X(0001).
  1816     05  ACVCDI PIC  X(0002).
  1817*    -------------------------------
  1818     05  ACVOTRML PIC S9(0004) COMP.
  1819     05  ACVOTRMF PIC  X(0001).
  1820     05  FILLER REDEFINES ACVOTRMF.
  1821         10  ACVOTRMA PIC  X(0001).
  1822     05  ACVOTRMI PIC  999.
  1823*    -------------------------------
  1824     05  ACVRTRML PIC S9(0004) COMP.
  1825     05  ACVRTRMF PIC  X(0001).
  1826     05  FILLER REDEFINES ACVRTRMF.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  37
* EL131.cbl
  1827         10  ACVRTRMA PIC  X(0001).
  1828     05  ACVRTRMI PIC  X(0003).
  1829*    -------------------------------
  1830     05  ACVRATEL PIC S9(0004) COMP.
  1831     05  ACVRATEF PIC  X(0001).
  1832     05  FILLER REDEFINES ACVRATEF.
  1833         10  ACVRATEA PIC  X(0001).
  1834     05  ACVRATEI PIC  9999V99.
  1835*    -------------------------------
  1836     05  ACVBENEL PIC S9(0004) COMP.
  1837     05  ACVBENEF PIC  X(0001).
  1838     05  FILLER REDEFINES ACVBENEF.
  1839         10  ACVBENEA PIC  X(0001).
  1840     05  ACVBENEI PIC  9(9)V99.
  1841*    -------------------------------
  1842     05  ACVFORML PIC S9(0004) COMP.
  1843     05  ACVFORMF PIC  X(0001).
  1844     05  FILLER REDEFINES ACVFORMF.
  1845         10  ACVFORMA PIC  X(0001).
  1846     05  ACVFORMI PIC  X(0012).
  1847*    -------------------------------
  1848     05  ACVCNDTL PIC S9(0004) COMP.
  1849     05  ACVCNDTF PIC  X(0001).
  1850     05  FILLER REDEFINES ACVCNDTF.
  1851         10  ACVCNDTA PIC  X(0001).
  1852     05  ACVCNDTI PIC  X(0008).
  1853*    -------------------------------
  1854     05  ACVEXITL PIC S9(0004) COMP.
  1855     05  ACVEXITF PIC  X(0001).
  1856     05  FILLER REDEFINES ACVEXITF.
  1857         10  ACVEXITA PIC  X(0001).
  1858     05  ACVEXITI PIC  X(0008).
  1859*    -------------------------------
  1860     05  ACVSTATL PIC S9(0004) COMP.
  1861     05  ACVSTATF PIC  X(0001).
  1862     05  FILLER REDEFINES ACVSTATF.
  1863         10  ACVSTATA PIC  X(0001).
  1864     05  ACVSTATI PIC  X(0006).
  1865*    -------------------------------
  1866     05  LABEL2L PIC S9(0004) COMP.
  1867     05  LABEL2F PIC  X(0001).
  1868     05  FILLER REDEFINES LABEL2F.
  1869         10  LABEL2A PIC  X(0001).
  1870     05  LABEL2I PIC  X(0014).
  1871*    -------------------------------
  1872     05  BCERT1L PIC S9(0004) COMP.
  1873     05  BCERT1F PIC  X(0001).
  1874     05  FILLER REDEFINES BCERT1F.
  1875         10  BCERT1A PIC  X(0001).
  1876     05  BCERT1I PIC  X(0010).
  1877*    -------------------------------
  1878     05  BSUFX1L PIC S9(0004) COMP.
  1879     05  BSUFX1F PIC  X(0001).
  1880     05  FILLER REDEFINES BSUFX1F.
  1881         10  BSUFX1A PIC  X(0001).
  1882     05  BSUFX1I PIC  X(0001).
  1883*    -------------------------------
  1884     05  BCERT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  38
* EL131.cbl
  1885     05  BCERT2F PIC  X(0001).
  1886     05  FILLER REDEFINES BCERT2F.
  1887         10  BCERT2A PIC  X(0001).
  1888     05  BCERT2I PIC  X(0010).
  1889*    -------------------------------
  1890     05  BSUFX2L PIC S9(0004) COMP.
  1891     05  BSUFX2F PIC  X(0001).
  1892     05  FILLER REDEFINES BSUFX2F.
  1893         10  BSUFX2A PIC  X(0001).
  1894     05  BSUFX2I PIC  X(0001).
  1895*    -------------------------------
  1896     05  BCERT3L PIC S9(0004) COMP.
  1897     05  BCERT3F PIC  X(0001).
  1898     05  FILLER REDEFINES BCERT3F.
  1899         10  BCERT3A PIC  X(0001).
  1900     05  BCERT3I PIC  X(0010).
  1901*    -------------------------------
  1902     05  BSUFX3L PIC S9(0004) COMP.
  1903     05  BSUFX3F PIC  X(0001).
  1904     05  FILLER REDEFINES BSUFX3F.
  1905         10  BSUFX3A PIC  X(0001).
  1906     05  BSUFX3I PIC  X(0001).
  1907*    -------------------------------
  1908     05  BCERT4L PIC S9(0004) COMP.
  1909     05  BCERT4F PIC  X(0001).
  1910     05  FILLER REDEFINES BCERT4F.
  1911         10  BCERT4A PIC  X(0001).
  1912     05  BCERT4I PIC  X(0010).
  1913*    -------------------------------
  1914     05  BSUFX4L PIC S9(0004) COMP.
  1915     05  BSUFX4F PIC  X(0001).
  1916     05  FILLER REDEFINES BSUFX4F.
  1917         10  BSUFX4A PIC  X(0001).
  1918     05  BSUFX4I PIC  X(0001).
  1919*    -------------------------------
  1920     05  BCERT5L PIC S9(0004) COMP.
  1921     05  BCERT5F PIC  X(0001).
  1922     05  FILLER REDEFINES BCERT5F.
  1923         10  BCERT5A PIC  X(0001).
  1924     05  BCERT5I PIC  X(0010).
  1925*    -------------------------------
  1926     05  BSUFX5L PIC S9(0004) COMP.
  1927     05  BSUFX5F PIC  X(0001).
  1928     05  FILLER REDEFINES BSUFX5F.
  1929         10  BSUFX5A PIC  X(0001).
  1930     05  BSUFX5I PIC  X(0001).
  1931*    -------------------------------
  1932     05  MSG1L PIC S9(0004) COMP.
  1933     05  MSG1F PIC  X(0001).
  1934     05  FILLER REDEFINES MSG1F.
  1935         10  MSG1A PIC  X(0001).
  1936     05  MSG1I PIC  X(0072).
  1937*    -------------------------------
  1938     05  MSG2L PIC S9(0004) COMP.
  1939     05  MSG2F PIC  X(0001).
  1940     05  FILLER REDEFINES MSG2F.
  1941         10  MSG2A PIC  X(0001).
  1942     05  MSG2I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  39
* EL131.cbl
  1943*    -------------------------------
  1944     05  PFKEYL PIC S9(0004) COMP.
  1945     05  PFKEYF PIC  X(0001).
  1946     05  FILLER REDEFINES PFKEYF.
  1947         10  PFKEYA PIC  X(0001).
  1948     05  PFKEYI PIC  99.
  1949*    -------------------------------
  1950     05  PFKEY6L PIC S9(0004) COMP.
  1951     05  PFKEY6F PIC  X(0001).
  1952     05  FILLER REDEFINES PFKEY6F.
  1953         10  PFKEY6A PIC  X(0001).
  1954     05  PFKEY6I PIC  X(0016).
  1955 01  EL131AO REDEFINES EL131AI.
  1956     05  FILLER            PIC  X(0012).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  DATEO PIC  X(0008).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  TIMEO PIC  99.99.
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  SEQUO PIC  X(0010).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  COMPO PIC  X(0003).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  USERIDO PIC  X(0004).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  CCNOO PIC  X(0016).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  MAINTO PIC  X(0001).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  CLAIMO PIC  X(0007).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  CARRO PIC  X(0001).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  CERTO PIC  X(0010).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  SUFXO PIC  X(0001).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  TYPEO PIC  X(0001).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  LABEL1O PIC  X(0011).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  PCERTNOO PIC  X(0010).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  40
* EL131.cbl
  2001     05  PSUFXO PIC  X(0001).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  STATUSO PIC  X(0006).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  INCO PIC  X(0008).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  REPO PIC  X(0008).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  CAUSEO PIC  X(0006).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  ENDO PIC  X(0008).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  DIAGO PIC  X(0060).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  ACCSWO PIC  X(0001).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  BENEO PIC  X(0010).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  BIRTHO PIC  X(0008).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  SOCIALO PIC  X(0011).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  SEXO PIC  X(0001).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  MLNAMEO PIC  X(0015).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  MFNAMEO PIC  X(0012).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  MMINITO PIC  X(0001).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  LOANNOO PIC  X(0008).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  CRTLNMEO PIC  X(0015).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  CRTFNMEO PIC  X(0012).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  CRTINITO PIC  X(0001).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  LOANBALO PIC  ZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  41
* EL131.cbl
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  PROCO PIC  X(0004).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  SUPVO PIC  X(0001).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  PRICDO PIC  X(0001).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  CRITPO PIC  X(0002).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  CRITPTO PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  RTWMOSO PIC  X(0002).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  FILETOO PIC  X(0004).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  PTHRHDGO PIC  X(0010).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  PDTHRUO PIC  X(0008).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  PDAMTO PIC  Z(06).99.
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  NODAYSO PIC  ZZZ99.
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  NOPMTSO PIC  ZZ99.
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  FORMTYPO PIC  X(0001).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  ESTO PIC  X(0008).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  AUIDO PIC  X(0004).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  OCCO PIC  X(0006).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  MNTDTO PIC  X(0008).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  MNTTYPEO PIC  X(0006).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  CERTCARO PIC  X(0001).
  2116*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  42
* EL131.cbl
  2117     05  FILLER            PIC  X(0003).
  2118     05  CERTGRPO PIC  X(0006).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  CERTSTO PIC  X(0002).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  CERTACTO PIC  X(0010).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  CERTEFFO PIC  X(0008).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  ISSAGEO PIC  X(0002).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  APRO PIC  9(3).9(4).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  PMTFREQO PIC  99.
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  INDGRPO PIC  X(0001).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  PREMTYPO PIC  X(0001).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  REINCDO PIC  X(0001).
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  JNTLNMEO PIC  X(0015).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  JNTFNMEO PIC  X(0012).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  JNTINITO PIC  X(0001).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  JNTAGEO PIC  X(0002).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  ADDONDTO PIC  X(0008).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  LCVDSCRO PIC  X(0006).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  LCVKINDO PIC  X(0003).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  LCVCDO PIC  X(0002).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  LCVOTRMO PIC  999.
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  43
* EL131.cbl
  2175     05  LCVRTRMO PIC  999.
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  LCVRATEO PIC  ZZZ.ZZ.
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  LCVFORMO PIC  X(0012).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  LCVCNDTO PIC  X(0008).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  LCVEXITO PIC  X(0008).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  LCVSTATO PIC  X(0006).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  ACVDSCRO PIC  X(0006).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  ACVKINDO PIC  X(0003).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  ACVCDO PIC  X(0002).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  ACVOTRMO PIC  999.
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  ACVRTRMO PIC  999.
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  ACVRATEO PIC  ZZZ.ZZ.
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  ACVFORMO PIC  X(0012).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  ACVCNDTO PIC  X(0008).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  ACVEXITO PIC  X(0008).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  ACVSTATO PIC  X(0006).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  LABEL2O PIC  X(0014).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  BCERT1O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  44
* EL131.cbl
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  BSUFX1O PIC  X(0001).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  BCERT2O PIC  X(0010).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  BSUFX2O PIC  X(0001).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  BCERT3O PIC  X(0010).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  BSUFX3O PIC  X(0001).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  BCERT4O PIC  X(0010).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  BSUFX4O PIC  X(0001).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  BCERT5O PIC  X(0010).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  BSUFX5O PIC  X(0001).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  MSG1O PIC  X(0072).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  MSG2O PIC  X(0072).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  PFKEYO PIC  X(0002).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  PFKEY6O PIC  X(0016).
  2272*    -------------------------------
  2273
  2274*                                COPY ELCEMIB SUPPRESS.
  2275******************************************************************
  2276*                                                                *
  2277*                                                                *
  2278*                            ELCEMIB.                            *
  2279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2280*                            VMOD=2.005                          *
  2281*                                                                *
  2282*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2283*                                                                *
  2284******************************************************************
  2285 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2286     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2287     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2288     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2289     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2290     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  45
* EL131.cbl
  2291     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2292     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2293     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2294     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2295         88  EMI-NO-ERRORS                    VALUE '1'.
  2296         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2297         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2298     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2299         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2300     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2301         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2302         88  EMI-AREA1-FULL                   VALUE '2'.
  2303     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2304         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2305         88  EMI-AREA2-FULL                   VALUE '2'.
  2306     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2307         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2308         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2309         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2310         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2311         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2312     12  EMI-ERROR-LINES.
  2313         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2314         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2315         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2316         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2317             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2318                 24  EMI-ERR-NUM         PIC X(4).
  2319                 24  EMI-FILLER          PIC X.
  2320                 24  EMI-SEV             PIC X.
  2321                 24  FILLER              PIC X.
  2322             20  FILLER                  PIC X(02).
  2323     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2324         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2325             20  EMI-ERROR-NUMBER    PIC X(4).
  2326             20  EMI-FILL            PIC X.
  2327             20  EMI-SEVERITY        PIC X.
  2328             20  FILLER              PIC X.
  2329             20  EMI-ERROR-TEXT.
  2330                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2331                 24  FILLER          PIC X(55).
  2332     12  EMI-SEVERITY-SAVE           PIC X.
  2333         88  EMI-NOTE                    VALUE 'N'.
  2334         88  EMI-WARNING                 VALUE 'W'.
  2335         88  EMI-FORCABLE                VALUE 'F'.
  2336         88  EMI-FATAL                   VALUE 'X'.
  2337     12  EMI-MESSAGE-FLAG            PIC X.
  2338         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2339         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2340     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2341     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2342         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2343         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2344         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2345     12  emi-claim-no                pic x(7).
  2346     12  emi-claim-type              pic x(6).
  2347     12  FILLER                      PIC X(124)  VALUE SPACES.
  2348     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  46
* EL131.cbl
  2349     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2350     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2351     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2352
  2353*                                COPY ELCJPFX SUPPRESS.
  2354******************************************************************
  2355*                                                                *
  2356*                                                                *
  2357*                            ELCJPFX.                            *
  2358*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2359*                            VMOD=2.002                          *
  2360*                                                                *
  2361*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2362*                                                                *
  2363*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2364*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2365*        ELCNTL - CONTROL FILE                                   *
  2366*        ELMSTR - CLAIM MASTERS                                  *
  2367*        ELTRLR - ACTIVITY TRAILERS                              *
  2368*        ELCHKQ - CHECK QUE                                      *
  2369******************************************************************
  2370 01  JOURNAL-RECORD.
  2371     12  jp-date                     pic s9(5) comp-3.
  2372     12  jp-time                     pic s9(7) comp-3.
  2373     12  JP-USER-ID                  PIC X(4).
  2374     12  JP-FILE-ID                  PIC X(8).
  2375     12  JP-PROGRAM-ID               PIC X(8).
  2376     12  JP-RECORD-TYPE              PIC X.
  2377         88 JP-ADD              VALUE 'A'.
  2378         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2379         88 JP-AFTER-CHANGE     VALUE 'C'.
  2380         88 JP-DELETE           VALUE 'D'.
  2381         88 JP-GENERIC-DELETE   VALUE 'G'.
  2382         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2383         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2384     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2385     12  JP-RECORD-AREA
  2386
  2387
  2388                                 PIC X(750).
  2389
  2390*                                COPY ELCCALC.
  2391******************************************************************
  2392*                                                                *
  2393*                           ELCCALC.                            *
  2394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2395*                            VMOD=2.025                          *
  2396*                                                                *
  2397*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2398*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2399*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2400*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2401*                                                                *
  2402*  PASSED TO ELRTRM                                              *
  2403*  -----------------                                             *
  2404*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2405*  ORIGINAL TERM                                                 *
  2406*  BEGINNING DATE                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  47
* EL131.cbl
  2407*  ENDING DATE                                                   *
  2408*  COMPANY I.D.                                                  *
  2409*  ACCOUNT MASTER USER FIELD                                     *
  2410*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2411*  FREE LOOK DAYS                                                *
  2412*                                                                *
  2413*  RETURNED FROM ELRTRM                                          *
  2414*  ---------------------                                         *
  2415*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2416*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2417*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2418*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2419*----------------------------------------------------------------*
  2420*  PASSED TO ELRAMT                                              *
  2421*  ----------------                                              *
  2422*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2423*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2424*  ORIGINAL AMOUNT                                               *
  2425*  ALTERNATE BENEFIT (BALLON)                                    *
  2426*  A.P.R. - NET PAY ONLY                                         *
  2427*  METHOD
  2428*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2429*  COMPANY I.D.                                                  *
  2430*  BENEFIT TYPE                                                  *
  2431*                                                                *
  2432*  RETURNED FROM ELRAMT                                          *
  2433*  --------------------                                          *
  2434*  REMAINING AMOUNT 1 - CURRENT                                  *
  2435*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2436*  REMAINING AMOUNT FACTOR
  2437*----------------------------------------------------------------*
  2438*  PASSED TO ELRESV                                              *
  2439*  -----------------                                             *
  2440*  CERTIFICATE EFFECTIVE DATE                                    *
  2441*  VALUATION DATE                                                *
  2442*  PAID THRU DATE                                                *
  2443*  BENEFIT                                                       *
  2444*  INCURRED DATE                                                 *
  2445*  REPORTED DATE                                                 *
  2446*  ISSUE AGE                                                     *
  2447*  TERM                                                          *
  2448*  CDT PERCENT                                                   *
  2449*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2450* *CLAIM TYPE (LIFE, A/H)                                        *
  2451* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2452* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2453*                                                                *
  2454*  RETURNED FROM ELRESV                                          *
  2455*  --------------------                                          *
  2456*  CDT TABLE USED                                                *
  2457*  CDT FACTOR USED                                               *
  2458*  PAY TO CURRENT RESERVE                                        *
  2459*  I.B.N.R. - A/H ONLY                                           *
  2460*  FUTURE (ACCRUED) AH ONLY                                      *
  2461*----------------------------------------------------------------*
  2462*  PASSED TO ELRATE                                              *
  2463*  ----------------                                              *
  2464*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  48
* EL131.cbl
  2465*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2466*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2467*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2468*  STATE CODE (CLIENT DEFINED)                                   *
  2469*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2470*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2471*  DEVIATION CODE                                                *
  2472*  ISSUE AGE                                                     *
  2473*  ORIGINAL BENEFIT AMOUNT                                       *
  2474*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2475*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2476*  BENEFIT KIND (LIFE OR A/H)                                    *
  2477*  A.P.R.                                                        *
  2478*  METHOD
  2479*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2480*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2481*  COMPANY I.D. (3 CHARACTER)                                    *
  2482*  BENEFIT CODE                                                  *
  2483*  BENEFIT OVERRIDE CODE                                         *
  2484*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2485*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2486*  JOINT INDICATOR (CSL ONLY)                                    *
  2487*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2488*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2489*                                                                *
  2490*  RETURNED FROM ELRATE                                          *
  2491*  --------------------                                          *
  2492*  CALCULATED PREMIUM                                            *
  2493*  PREMIUM RATE                                                  *
  2494*  MORTALITY CODE                                                *
  2495*  MAX ATTAINED AGE                                              *
  2496*  MAX AGE                                                       *
  2497*  MAX TERM                                                      *
  2498*  MAX MONTHLY BENEFIT                                           *
  2499*  MAX TOTAL BENIFIT                                             *
  2500*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2501*----------------------------------------------------------------*
  2502*  PASSED TO ELRFND                                              *
  2503*  ----------------                                              *
  2504*  CERT ISSUE DATE                                               *
  2505*  REFUND DATE                                                   *
  2506*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2507*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2508*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2509*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2510*  STATE CODE (CLIENT DEFINED)                                   *
  2511*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2512*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2513*  DEVIATION CODE                                                *
  2514*  ISSUE AGE                                                     *
  2515*  ORIGINAL BENEFIT AMOUNT                                       *
  2516*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2517*  PROCESS TYPE (CANCEL)                                         *
  2518*  BENEFIT KIND (LIFE OR A/H)                                    *
  2519*  A.P.R.                                                        *
  2520*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2521*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2522*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  49
* EL131.cbl
  2523*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2524*  COMPANY I.D. (3 CHARACTER)                                    *
  2525*  BENEFIT CODE                                                  *
  2526*  BENEFIT OVERRIDE CODE                                         *
  2527*                                                                *
  2528*  RETURNED FROM ELRFND                                          *
  2529*  --------------------                                          *
  2530*  CALCULATED REFUND                                             *
  2531*----------------------------------------------------------------*
  2532*  PASSED TO ELEARN                                              *
  2533*  ----------------                                              *
  2534*  CERT ISSUE DATE                                               *
  2535*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2536*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2537*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2538*  STATE CODE (CLIENT DEFINED)                                   *
  2539*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2540*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2541*  DEVIATION CODE                                                *
  2542*  ISSUE AGE                                                     *
  2543*  ORIGINAL BENEFIT AMOUNT                                       *
  2544*  BENEFIT KIND (LIFE OR A/H)                                    *
  2545*  A.P.R.                                                        *
  2546*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2547*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2548*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2549*  COMPANY I.D. (3 CHARACTER)                                    *
  2550*  BENEFIT CODE                                                  *
  2551*  BENEFIT OVERRIDE CODE                                         *
  2552*                                                                *
  2553*  RETURNED FROM ELEARN                                          *
  2554*  --------------------                                          *
  2555*  INDICATED  EARNINGS                                           *
  2556*----------------------------------------------------------------*
  2557*                 LENGTH = 450                                   *
  2558*                                                                *
  2559******************************************************************
  2560******************************************************************
  2561*                   C H A N G E   L O G
  2562*
  2563* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2564*-----------------------------------------------------------------
  2565*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2566* EFFECTIVE    NUMBER
  2567*-----------------------------------------------------------------
  2568* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2569* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2570* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2571* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2572* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2573* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2574* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2575* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2576* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2577******************************************************************
  2578
  2579 01  CALCULATION-PASS-AREA.
  2580     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  50
* EL131.cbl
  2581                                     COMP.
  2582
  2583     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2584       88  NO-CP-ERROR                             VALUE ZERO.
  2585       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2586                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2587       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2588       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2589       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2590       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2591       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2592       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2593       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2594       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2595       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2596       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2597       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2598       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2599       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2600       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2601       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2602       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2603       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2604
  2605     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2606       88  NO-CP-ERROR-2                           VALUE ZERO.
  2607***********************  INPUT AREAS ****************************
  2608
  2609     12  CP-CALCULATION-AREA.
  2610         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2611         16  CP-CERT-EFF-DT        PIC XX.
  2612         16  CP-VALUATION-DT       PIC XX.
  2613         16  CP-PAID-THRU-DT       PIC XX.
  2614         16  CP-BENEFIT-TYPE       PIC X.
  2615           88  CP-AH                               VALUE 'A' 'D'
  2616                                                   'I' 'U'.
  2617           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2618           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2619         16  CP-INCURRED-DT        PIC XX.
  2620         16  CP-REPORTED-DT        PIC XX.
  2621         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2622         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2623         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2624                                     COMP-3.
  2625         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2626                                     COMP-3.
  2627         16  CP-CDT-METHOD         PIC X.
  2628           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2629           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2630           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2631         16  CP-CLAIM-TYPE         PIC X.
  2632           88  CP-AH-CLAIM                         VALUE 'A'.
  2633           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2634         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2635                                     COMP-3.
  2636         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2637                                     COMP-3.
  2638         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  51
* EL131.cbl
  2639                                     COMP-3.
  2640         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2641                                     COMP-3.
  2642         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2643                                     COMP-3.
  2644         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2645                                     COMP-3.
  2646         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2647                                     COMP-3.
  2648         16  CP-REM-TERM-METHOD    PIC X.
  2649           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2650           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2651           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2652           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2653           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2654           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2655           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2656         16  CP-EARNING-METHOD     PIC X.
  2657           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2658           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2659           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2660           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2661           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2662           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2663           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2664           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2665           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2666           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2667           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2668           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2669           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2670           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2671         16  CP-PROCESS-TYPE       PIC X.
  2672           88  CP-CLAIM                            VALUE '1'.
  2673           88  CP-CANCEL                           VALUE '2'.
  2674           88  CP-ISSUE                            VALUE '3'.
  2675         16  CP-SPECIAL-CALC-CD    PIC X.
  2676           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2677           88  CP-1-MTH-INTEREST               VALUE ' '.
  2678           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2679           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2680           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2681           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2682           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2683           88  CP-FARM-PLAN                    VALUE 'F'.
  2684           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2685           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2686           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2687           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2688           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2689           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2690           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2691           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2692           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2693           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2694                                                     'W' 'X'.
  2695           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2696           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  52
* EL131.cbl
  2697           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2698           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2699           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2700           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2701           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2702           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2703           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2704           88  CP-CSL-METH-1                   VALUE '5'.
  2705           88  CP-CSL-METH-2                   VALUE '6'.
  2706           88  CP-CSL-METH-3                   VALUE '7'.
  2707           88  CP-CSL-METH-4                   VALUE '8'.
  2708
  2709         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2710                                     COMP-3.
  2711         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2712         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2713         16  CP-STATE              PIC XX          VALUE SPACE.
  2714         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2715         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2716           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2717               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2718         16  CP-R78-OPTION         PIC X.
  2719           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2720           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2721
  2722         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2723         16  CP-IBNR-RESERVE-SW    PIC X.
  2724         16  CP-CLAIM-STATUS       PIC X.
  2725         16  CP-RATE-FILE          PIC X.
  2726         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2727                                     COMP-3.
  2728
  2729         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2730         16  CP-AH-OVERRIDE-CODE   PIC X.
  2731
  2732         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2733                                     COMP-3.
  2734         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2735                                   PIC S9(5)V99 COMP-3.
  2736         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2737                                     COMP-3.
  2738         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2739                                     COMP-3.
  2740         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2741                                     COMP-3.
  2742         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2743                                  PIC S9(7)V99 COMP-3.
  2744
  2745         16  CP-PAID-FROM-DATE     PIC X(02).
  2746         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2747         16  CP-EXT-DAYS-CALC      PIC X.
  2748           88  CP-EXT-NO-CHG                   VALUE ' '.
  2749           88  CP-EXT-CHG-LF                   VALUE '1'.
  2750           88  CP-EXT-CHG-AH                   VALUE '2'.
  2751           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2752         16  CP-DOMICILE-STATE     PIC XX.
  2753         16  CP-CARRIER            PIC X.
  2754         16  CP-REIN-FLAG          PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  53
* EL131.cbl
  2755         16  CP-REM-TRM-CALC-OPTION PIC X.
  2756           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2757                      '2' '3' '4' '5'.
  2758           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2759           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2760           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2761           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2762           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2763           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2764           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2765           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2766         16  CP-SIG-SWITCH         PIC X.
  2767         16  CP-RATING-METHOD      PIC X.
  2768           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2769           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2770           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2771           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2772           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2773           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2774           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2775           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2776           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2777         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2778                                     COMP-3.
  2779         16  CP-BEN-CATEGORY       PIC X.
  2780         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2781         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2782                                   PIC S99V9(5) COMP-3.
  2783         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2784         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2785                                   PIC S99V9(5) COMP-3.
  2786         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2787         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2788         16  CP-EXPIRE-DT          PIC XX.
  2789         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2790         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2791         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2792         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2793         16  CP-DDF-SPEC-CALC      PIC X.
  2794             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2795             88  CP-CALC-CLP              VALUE 'C'.
  2796         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2797         16  CP-CANCEL-REASON      PIC X.
  2798         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2799         16  CP-PMT-MODE           PIC X.
  2800         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2801         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2802         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2803         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2804         16  FILLER                PIC X.
  2805
  2806***************    OUTPUT FROM ELRESV   ************************
  2807
  2808         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2809
  2810         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2811                                     COMP-3.
  2812         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  54
* EL131.cbl
  2813                                     COMP-3.
  2814         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2815                                     COMP-3.
  2816         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2817                                     COMP-3.
  2818         16  FILLER                PIC X(09).
  2819***************    OUTPUT FROM ELRTRM   *************************
  2820
  2821         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2822                                     COMP-3.
  2823         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2824                                     COMP-3.
  2825         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2826                                     COMP-3.
  2827         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2828                                     COMP-3.
  2829         16  FILLER                PIC X(12).
  2830
  2831***************    OUTPUT FROM ELRAMT   *************************
  2832
  2833         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2834                                     COMP-3.
  2835         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2836                                     COMP-3.
  2837         16  FILLER                PIC X(12).
  2838
  2839***************    OUTPUT FROM ELRATE   *************************
  2840
  2841         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2842                                     COMP-3.
  2843         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2844                                     COMP-3.
  2845         16  CP-MORTALITY-CODE     PIC X(4).
  2846         16  CP-RATE-EDIT-FLAG     PIC X.
  2847             88  CP-RATES-NEED-APR                  VALUE '1'.
  2848         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2849                                     COMP-3.
  2850         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2851         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2852         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2853                                   PIC S9(7)V99 COMP-3.
  2854         16  FILLER                PIC X(07).
  2855
  2856***************    OUTPUT FROM ELRFND   *************************
  2857
  2858         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2859                                     COMP-3.
  2860         16  CP-REFUND-TYPE-USED   PIC X.
  2861           88  CP-R-AS-R78                         VALUE '1'.
  2862           88  CP-R-AS-PRORATA                     VALUE '2'.
  2863           88  CP-R-AS-CALIF                       VALUE '3'.
  2864           88  CP-R-AS-TEXAS                       VALUE '4'.
  2865           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2866           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2867           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2868           88  CP-R-AS-MEAN                        VALUE '8'.
  2869           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2870           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  55
* EL131.cbl
  2871           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2872           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2873           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2874           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2875         16  FILLER                PIC X(12).
  2876
  2877***************    OUTPUT FROM ELEARN   *************************
  2878
  2879         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2880                                     COMP-3.
  2881         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2882                                     COMP-3.
  2883         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2884                                     COMP-3.
  2885         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2886                                     COMP-3.
  2887         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2888                                     COMP-3.
  2889         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2890                                     COMP-3.
  2891         16  CP-EARNING-TYPE-USED  PIC X.
  2892           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2893           88  CP-E-AS-R78                         VALUE '1'.
  2894           88  CP-E-AS-PRORATA                     VALUE '2'.
  2895           88  CP-E-AS-TEXAS                       VALUE '4'.
  2896           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2897           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2898           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2899           88  CP-E-AS-MEAN                        VALUE '8'.
  2900           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2901         16  FILLER                PIC X(12).
  2902
  2903***************    OUTPUT FROM ELPMNT   *************************
  2904
  2905         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2906                                     COMP-3.
  2907         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2908                                     COMP-3.
  2909         16  FILLER                PIC X(12).
  2910
  2911***************   MISC WORK AREAS    *****************************
  2912         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2913                                     COMP-3.
  2914         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2915                                     COMP-3.
  2916         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2917                                     COMP-3.
  2918         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2919                                     COMP-3.
  2920         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2921                                     COMP-3.
  2922         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2923                                     COMP-3.
  2924         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2925             88  OPEN-RATE-FILE                   VALUE 'O'.
  2926             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2927             88  IO-ERROR                         VALUE 'E'.
  2928
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  56
* EL131.cbl
  2929         16  CP-FIRST-PAY-DATE     PIC XX.
  2930
  2931         16  CP-JOINT-INDICATOR    PIC X.
  2932
  2933         16  CP-RESERVE-REMAINING-TERM
  2934                                   PIC S9(4)V9    VALUE ZERO
  2935                                     COMP-3.
  2936
  2937         16  CP-INSURED-BIRTH-DT   PIC XX.
  2938
  2939         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2940                                     COMP-3.
  2941
  2942         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2943                                     COMP-3.
  2944
  2945         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2946                                     COMP-3.
  2947
  2948         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2949                                     COMP-3.
  2950
  2951         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2952                                     COMP-3.
  2953
  2954         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2955                                     COMP-3.
  2956
  2957         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2958                                     COMP-3.
  2959
  2960         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2961             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2962
  2963         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2964                                     COMP-3.
  2965         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2966                                     COMP-3.
  2967         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2968         16  FILLER                PIC X(15).
  2969******************************************************************
  2970
  2971*                                COPY ELCDATE.
  2972******************************************************************
  2973*                                                                *
  2974*                                                                *
  2975*                            ELCDATE.                            *
  2976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2977*                            VMOD=2.003
  2978*                                                                *
  2979*                                                                *
  2980*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2981*                 LENGTH = 200                                   *
  2982******************************************************************
  2983
  2984 01  DATE-CONVERSION-DATA.
  2985     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2986     12  DC-OPTION-CODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  57
* EL131.cbl
  2987         88  BIN-TO-GREG                VALUE ' '.
  2988         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2989         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2990         88  YMD-GREG-TO-BIN            VALUE '3'.
  2991         88  MDY-GREG-TO-BIN            VALUE '4'.
  2992         88  JULIAN-TO-BIN              VALUE '5'.
  2993         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2994         88  FIND-CENTURY               VALUE '7'.
  2995         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2996         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2997         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2998         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2999         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3000         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3001         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3002         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3003         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3004         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3005         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3006         88  BIN-3-TO-GREG              VALUE 'I'.
  3007         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3008         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3009         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3010         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3011         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3012         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3013         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3014         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3015         88  THREE-CHARACTER-BIN
  3016                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3017         88  GREGORIAN-TO-BIN
  3018                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3019         88  BIN-TO-GREGORIAN
  3020                  VALUES ' ' '1' 'I' '8' 'G'.
  3021         88  JULIAN-TO-BINARY
  3022                  VALUES '5' 'C' 'E' 'F'.
  3023     12  DC-ERROR-CODE                 PIC X.
  3024         88  NO-CONVERSION-ERROR        VALUE ' '.
  3025         88  DATE-CONVERSION-ERROR
  3026                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3027         88  DATE-IS-ZERO               VALUE '1'.
  3028         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3029         88  DATE-IS-INVALID            VALUE '3'.
  3030         88  DATE1-GREATER-DATE2        VALUE '4'.
  3031         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3032         88  DATE-INVALID-OPTION        VALUE '9'.
  3033         88  INVALID-CENTURY            VALUE 'A'.
  3034         88  ONLY-CENTURY               VALUE 'B'.
  3035         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3036         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3037     12  DC-END-OF-MONTH               PIC X.
  3038         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3039     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3040         88  USE-NORMAL-PROCESS         VALUE ' '.
  3041         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3042         88  ADJUST-UP-100-YRS          VALUE '2'.
  3043     12  FILLER                        PIC X.
  3044     12  DC-CONVERSION-DATES.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  58
* EL131.cbl
  3045         16  DC-BIN-DATE-1             PIC XX.
  3046         16  DC-BIN-DATE-2             PIC XX.
  3047         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3048         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3049                       DC-GREG-DATE-1-EDIT.
  3050             20  DC-EDIT1-MONTH        PIC 99.
  3051             20  SLASH1-1              PIC X.
  3052             20  DC-EDIT1-DAY          PIC 99.
  3053             20  SLASH1-2              PIC X.
  3054             20  DC-EDIT1-YEAR         PIC 99.
  3055         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3056         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3057                     DC-GREG-DATE-2-EDIT.
  3058             20  DC-EDIT2-MONTH        PIC 99.
  3059             20  SLASH2-1              PIC X.
  3060             20  DC-EDIT2-DAY          PIC 99.
  3061             20  SLASH2-2              PIC X.
  3062             20  DC-EDIT2-YEAR         PIC 99.
  3063         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3064         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3065                     DC-GREG-DATE-1-YMD.
  3066             20  DC-YMD-YEAR           PIC 99.
  3067             20  DC-YMD-MONTH          PIC 99.
  3068             20  DC-YMD-DAY            PIC 99.
  3069         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3070         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3071                      DC-GREG-DATE-1-MDY.
  3072             20  DC-MDY-MONTH          PIC 99.
  3073             20  DC-MDY-DAY            PIC 99.
  3074             20  DC-MDY-YEAR           PIC 99.
  3075         16  DC-GREG-DATE-1-ALPHA.
  3076             20  DC-ALPHA-MONTH        PIC X(10).
  3077             20  DC-ALPHA-DAY          PIC 99.
  3078             20  FILLER                PIC XX.
  3079             20  DC-ALPHA-CENTURY.
  3080                 24 DC-ALPHA-CEN-N     PIC 99.
  3081             20  DC-ALPHA-YEAR         PIC 99.
  3082         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3083         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3084         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3085         16  DC-JULIAN-DATE            PIC 9(05).
  3086         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3087                                       PIC 9(05).
  3088         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3089             20  DC-JULIAN-YEAR        PIC 99.
  3090             20  DC-JULIAN-DAYS        PIC 999.
  3091         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3092         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3093         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3094     12  DATE-CONVERSION-VARIBLES.
  3095         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3096         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3097             20  FILLER                PIC 9(3).
  3098             20  HOLD-CEN-1-CCYY.
  3099                 24  HOLD-CEN-1-CC     PIC 99.
  3100                 24  HOLD-CEN-1-YY     PIC 99.
  3101             20  HOLD-CEN-1-MO         PIC 99.
  3102             20  HOLD-CEN-1-DA         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  59
* EL131.cbl
  3103         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3104             20  HOLD-CEN-1-R-MO       PIC 99.
  3105             20  HOLD-CEN-1-R-DA       PIC 99.
  3106             20  HOLD-CEN-1-R-CCYY.
  3107                 24  HOLD-CEN-1-R-CC   PIC 99.
  3108                 24  HOLD-CEN-1-R-YY   PIC 99.
  3109             20  FILLER                PIC 9(3).
  3110         16  HOLD-CENTURY-1-X.
  3111             20  FILLER                PIC X(3)  VALUE SPACES.
  3112             20  HOLD-CEN-1-X-CCYY.
  3113                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3114                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3115             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3116             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3117         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3118             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3119             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3120             20  HOLD-CEN-1-R-X-CCYY.
  3121                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3122                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3123             20  FILLER                PIC XXX.
  3124         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3125         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3126         16  DC-JULIAN-DATE-1          PIC 9(07).
  3127         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3128             20  DC-JULIAN-1-CCYY.
  3129                 24  DC-JULIAN-1-CC    PIC 99.
  3130                 24  DC-JULIAN-1-YR    PIC 99.
  3131             20  DC-JULIAN-DA-1        PIC 999.
  3132         16  DC-JULIAN-DATE-2          PIC 9(07).
  3133         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3134             20  DC-JULIAN-2-CCYY.
  3135                 24  DC-JULIAN-2-CC    PIC 99.
  3136                 24  DC-JULIAN-2-YR    PIC 99.
  3137             20  DC-JULIAN-DA-2        PIC 999.
  3138         16  DC-GREG-DATE-A-EDIT.
  3139             20  DC-EDITA-MONTH        PIC 99.
  3140             20  SLASHA-1              PIC X VALUE '/'.
  3141             20  DC-EDITA-DAY          PIC 99.
  3142             20  SLASHA-2              PIC X VALUE '/'.
  3143             20  DC-EDITA-CCYY.
  3144                 24  DC-EDITA-CENT     PIC 99.
  3145                 24  DC-EDITA-YEAR     PIC 99.
  3146         16  DC-GREG-DATE-B-EDIT.
  3147             20  DC-EDITB-MONTH        PIC 99.
  3148             20  SLASHB-1              PIC X VALUE '/'.
  3149             20  DC-EDITB-DAY          PIC 99.
  3150             20  SLASHB-2              PIC X VALUE '/'.
  3151             20  DC-EDITB-CCYY.
  3152                 24  DC-EDITB-CENT     PIC 99.
  3153                 24  DC-EDITB-YEAR     PIC 99.
  3154         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3155         16  DC-GREG-DATE-CYMD-R REDEFINES
  3156                              DC-GREG-DATE-CYMD.
  3157             20  DC-CYMD-CEN           PIC 99.
  3158             20  DC-CYMD-YEAR          PIC 99.
  3159             20  DC-CYMD-MONTH         PIC 99.
  3160             20  DC-CYMD-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  60
* EL131.cbl
  3161         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3162         16  DC-GREG-DATE-MDCY-R REDEFINES
  3163                              DC-GREG-DATE-MDCY.
  3164             20  DC-MDCY-MONTH         PIC 99.
  3165             20  DC-MDCY-DAY           PIC 99.
  3166             20  DC-MDCY-CEN           PIC 99.
  3167             20  DC-MDCY-YEAR          PIC 99.
  3168    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3169        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3170    12  DC-EL310-DATE                  PIC X(21).
  3171    12  FILLER                         PIC X(28).
  3172
  3173*                                COPY ELCDMO.
  3174******************************************************************
  3175*                                                                *
  3176*                                                                *
  3177*                            ELCDMO.                             *
  3178*                            VMOD=2.004                          *
  3179*                                                                *
  3180*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3181*        COMMUNICATION AREA                                      *
  3182*   FILE TYPE = NA                                               *
  3183*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3184*                                                                *
  3185******************************************************************
  3186 01  DMO-COMMUNICATION-AREA.
  3187     12  DM-RECORD-TYPE                  PIC  X(02).
  3188             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3189             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3190             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3191     12  DM-DIST-CODE                    PIC  X(04).
  3192     12  DM-MAIL-CODE                    PIC  X(05).
  3193     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3194     12  DM-INSURED-NAME                 PIC  X(30).
  3195     12  DM-CLAIM-NO                     PIC  X(07).
  3196     12  DM-CLAIM-TYPE                   PIC  X.
  3197
  3198     12  DM-STATUS-DATA-AREA.
  3199         16  DM-CLAIM-STATUS             PIC  X.
  3200             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3201             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3202             88  DM-CLOSED                        VALUE '3'.
  3203             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3204             88  DM-DEFAULT                       VALUE '9'.
  3205         16  DM-STATUS-DATE              PIC  X(08).
  3206******YYYYMMDD
  3207         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3208             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3209             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3210             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3211             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3212             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3213             88  DM-RE-OPENED                     VALUE 'R'.
  3214             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3215             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3216             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3217         16  DM-STAT-CARRIER             PIC X.
  3218
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  61
* EL131.cbl
  3219     12  DM-DRAFT-DATA-AREA.
  3220         16  DM-PAYMENT-TYPE             PIC  X.
  3221             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3222         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3223         16  DM-PAYMENT-DATE             PIC  X(08).
  3224******YYYYMMDD
  3225         16  DM-CERT-NO                  PIC  X(11).
  3226         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3227         16  DM-CARRIER                  PIC  X.
  3228
  3229     12  DM-RETURN-CODE                  PIC  XX.
  3230*                                COPY ERCPDEF.
  3231******************************************************************
  3232*                                                                *
  3233*                                                                *
  3234*                            ERCPDEF.                            *
  3235*                                                                *
  3236*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3237*                                                                *
  3238*    FILE TYPE = VSAM,KSDS                                       *
  3239*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3240*                                                                *
  3241*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3242*                                                                *
  3243*    LOG = YES                                                   *
  3244*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3245******************************************************************
  3246 01  PRODUCT-MASTER.
  3247    12  PD-RECORD-ID                 PIC X(02).
  3248        88  VALID-PD-ID                  VALUE 'PD'.
  3249    12  PD-CONTROL-PRIMARY.
  3250        16  PD-COMPANY-CD            PIC X.
  3251        16  PD-STATE                 PIC XX.
  3252        16  PD-PRODUCT-CD            PIC XXX.
  3253        16  PD-FILLER                PIC X(7).
  3254        16  PD-BEN-TYPE              PIC X.
  3255        16  PD-BEN-CODE              PIC XX.
  3256        16  PD-PROD-EXP-DT           PIC XX.
  3257    12  FILLER                       PIC X(50).
  3258    12  PD-PRODUCT-DATA OCCURS 8.
  3259        16  PD-PROD-CODE             PIC X.
  3260            88  PD-PROD-LIFE           VALUE 'L'.
  3261            88  PD-PROD-PROP           VALUE 'P'.
  3262            88  PD-PROD-AH             VALUE 'A'.
  3263            88  PD-PROD-IU             VALUE 'I'.
  3264            88  PD-PROD-GAP            VALUE 'G'.
  3265        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3266        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3267        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3268        16  PD-MAX-TERM              PIC S999        COMP-3.
  3269        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3270        16  FILLER                   PIC X.
  3271        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3272        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3273        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3274        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3275        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3276        16  PD-REC-CRIT-PERIOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  62
* EL131.cbl
  3277        16  PD-RTW-MOS               PIC 99.
  3278        16  FILLER                   PIC X(5).
  3279    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3280    12  PD-TERM-LIMITS OCCURS 15.
  3281        16  PD-LOW-TERM              PIC S999        COMP-3.
  3282        16  PD-HI-TERM               PIC S999        COMP-3.
  3283*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3284    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3285        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3286        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3287    12  PD-EARN-FACTORS.
  3288        16  FILLER OCCURS 15.
  3289            20  FILLER OCCURS 15.
  3290                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3291    12  PD-PRODUCT-DESC              PIC X(80).
  3292    12  PD-TRUNCATED                 PIC X.
  3293    12  FILLER                       PIC X(59).
  3294    12  PD-MAINT-INFORMATION.
  3295        16  PD-LAST-MAINT-DT         PIC X(02).
  3296        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3297        16  PD-LAST-MAINT-BY         PIC X(04).
  3298*                                COPY ELCCRTT.
  3299******************************************************************
  3300*                                                                *
  3301*                            ELCCRTT.                            *
  3302*                                                                *
  3303*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3304*                                                                *
  3305*   FILE TYPE = VSAM,KSDS                                        *
  3306*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3307*                                                                *
  3308*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3309*                                                                *
  3310*   LOG = YES                                                    *
  3311*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3312******************************************************************
  3313*                   C H A N G E   L O G
  3314*
  3315* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3316*-----------------------------------------------------------------
  3317*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3318* EFFECTIVE    NUMBER
  3319*-----------------------------------------------------------------
  3320* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3321* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3322* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3323* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3324* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3325******************************************************************
  3326
  3327 01  CERTIFICATE-TRAILERS.
  3328     12  CS-RECORD-ID                      PIC XX.
  3329         88  VALID-CS-ID                      VALUE 'CS'.
  3330
  3331     12  CS-CONTROL-PRIMARY.
  3332         16  CS-COMPANY-CD                 PIC X.
  3333         16  CS-CARRIER                    PIC X.
  3334         16  CS-GROUPING                   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  63
* EL131.cbl
  3335         16  CS-STATE                      PIC XX.
  3336         16  CS-ACCOUNT                    PIC X(10).
  3337         16  CS-CERT-EFF-DT                PIC XX.
  3338         16  CS-CERT-NO.
  3339             20  CS-CERT-PRIME             PIC X(10).
  3340             20  CS-CERT-SFX               PIC X.
  3341         16  CS-TRAILER-TYPE               PIC X.
  3342             88  COMM-TRLR           VALUE 'A'.
  3343             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3344             88  CERT-DATA-TRLR      VALUE 'C'.
  3345
  3346     12  CS-DATA-AREA                      PIC X(516).
  3347
  3348     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3349         16  CS-BANK-COMMISSION-AREA.
  3350             20  CS-BANK-COMMS       OCCURS 10.
  3351                 24  CS-AGT                PIC X(10).
  3352                 24  CS-COM-TYP            PIC X.
  3353                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3354                 24  CS-RECALC-LV-INDIC    PIC X.
  3355                 24  FILLER                PIC X(10).
  3356         16  FILLER                        PIC X(256).
  3357
  3358     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3359****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3360****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  3361         16  CS-MB-CLAIM-DATA OCCURS 2.
  3362             20  FILLER OCCURS 10.
  3363                 24  CS-CLAIM-TYPE         PIC X.
  3364                     88  CS-AH-CLM           VALUE 'A'.
  3365                     88  CS-IU-CLM           VALUE 'I'.
  3366                     88  CS-GP-CLM           VALUE 'G'.
  3367                     88  CS-LF-CLM           VALUE 'L'.
  3368                     88  CS-PR-CLM           VALUE 'P'.
  3369                 24  CS-BANK               PIC S999 COMP-3.
  3370                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  3371                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  3372                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  3373         16  FILLER                        PIC X(216).
  3374     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3375         16  CS-VIN-NUMBER                 PIC X(17).
  3376         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3377         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3378         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3379         16  FILLER                        PIC X(496).
  3380******************************************************************
  3381
  3382****************************************************************
  3383*
  3384* Copyright (c) 2007 by Clerity Solutions, Inc.
  3385* All rights reserved.
  3386*
  3387****************************************************************
  3388 01  DFHEIV.
  3389   02  DFHEIV0               PIC X(35).
  3390   02  DFHEIV1               PIC X(08).
  3391   02  DFHEIV2               PIC X(08).
  3392   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  64
* EL131.cbl
  3393   02  DFHEIV4               PIC X(06).
  3394   02  DFHEIV5               PIC X(04).
  3395   02  DFHEIV6               PIC X(04).
  3396   02  DFHEIV7               PIC X(02).
  3397   02  DFHEIV8               PIC X(02).
  3398   02  DFHEIV9               PIC X(01).
  3399   02  DFHEIV10              PIC S9(7) COMP-3.
  3400   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3401   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3402   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3403   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3404   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3405   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3406   02  DFHEIV17              PIC X(04).
  3407   02  DFHEIV18              PIC X(04).
  3408   02  DFHEIV19              PIC X(04).
  3409   02  DFHEIV20              USAGE IS POINTER.
  3410   02  DFHEIV21              USAGE IS POINTER.
  3411   02  DFHEIV22              USAGE IS POINTER.
  3412   02  DFHEIV23              USAGE IS POINTER.
  3413   02  DFHEIV24              USAGE IS POINTER.
  3414   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3415   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3416   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3417   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3418   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3419   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3420   02  FILLER                PIC X(02).
  3421   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3422   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3423   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3424   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3425   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3426 LINKAGE  SECTION.
  3427*****************************************************************
  3428*                                                               *
  3429* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3430* All rights reserved.                                          *
  3431*                                                               *
  3432*****************************************************************
  3433 01  dfheiblk.
  3434     02  eibtime          pic s9(7) comp-3.
  3435     02  eibdate          pic s9(7) comp-3.
  3436     02  eibtrnid         pic x(4).
  3437     02  eibtaskn         pic s9(7) comp-3.
  3438     02  eibtrmid         pic x(4).
  3439     02  dfheigdi         pic s9(4) comp.
  3440     02  eibcposn         pic s9(4) comp.
  3441     02  eibcalen         pic s9(4) comp.
  3442     02  eibaid           pic x(1).
  3443     02  eibfiller1       pic x(1).
  3444     02  eibfn            pic x(2).
  3445     02  eibfiller2       pic x(2).
  3446     02  eibrcode         pic x(6).
  3447     02  eibfiller3       pic x(2).
  3448     02  eibds            pic x(8).
  3449     02  eibreqid         pic x(8).
  3450     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  65
* EL131.cbl
  3451     02  eibsync          pic x(1).
  3452     02  eibfree          pic x(1).
  3453     02  eibrecv          pic x(1).
  3454     02  eibsend          pic x(1).
  3455     02  eibatt           pic x(1).
  3456     02  eibeoc           pic x(1).
  3457     02  eibfmh           pic x(1).
  3458     02  eibcompl         pic x(1).
  3459     02  eibsig           pic x(1).
  3460     02  eibconf          pic x(1).
  3461     02  eiberr           pic x(1).
  3462     02  eibrldbk         pic x(1).
  3463     02  eiberrcd         pic x(4).
  3464     02  eibsynrb         pic x(1).
  3465     02  eibnodat         pic x(1).
  3466     02  eibfiller5       pic x(2).
  3467     02  eibresp          pic 9(09) comp.
  3468     02  eibresp2         pic 9(09) comp.
  3469     02  dfheigdj         pic s9(4) comp.
  3470     02  dfheigdk         pic s9(4) comp.
  3471 01  DFHCOMMAREA                 PIC X(1024).
  3472
  3473*                                COPY ELCMSTR.
  3474******************************************************************
  3475*                                                                *
  3476*                            ELCMSTR.                            *
  3477*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3478*                            VMOD=2.012                          *
  3479*                                                                *
  3480*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3481*                                                                *
  3482*   FILE TYPE = VSAM,KSDS                                        *
  3483*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3484*                                                                *
  3485*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3486*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3487*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3488*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3489*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3490*                                                 RKP=75,LEN=21  *
  3491*                                                                *
  3492*   **** NOTE ****                                               *
  3493*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3494*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3495*                                                                *
  3496*   LOG = YES                                                    *
  3497*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3498******************************************************************
  3499*                   C H A N G E   L O G
  3500*
  3501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3502*-----------------------------------------------------------------
  3503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3504* EFFECTIVE    NUMBER
  3505*-----------------------------------------------------------------
  3506* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3507* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3508* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  66
* EL131.cbl
  3509******************************************************************
  3510 01  CLAIM-MASTER.
  3511     12  CL-RECORD-ID                PIC XX.
  3512         88  VALID-CL-ID         VALUE 'CL'.
  3513
  3514     12  CL-CONTROL-PRIMARY.
  3515         16  CL-COMPANY-CD           PIC X.
  3516         16  CL-CARRIER              PIC X.
  3517         16  CL-CLAIM-NO             PIC X(7).
  3518         16  CL-CERT-NO.
  3519             20  CL-CERT-PRIME       PIC X(10).
  3520             20  CL-CERT-SFX         PIC X.
  3521
  3522     12  CL-CONTROL-BY-NAME.
  3523         16  CL-COMPANY-CD-A1        PIC X.
  3524         16  CL-INSURED-LAST-NAME    PIC X(15).
  3525         16  CL-INSURED-NAME.
  3526             20  CL-INSURED-1ST-NAME PIC X(12).
  3527             20  CL-INSURED-MID-INIT PIC X.
  3528
  3529     12  CL-CONTROL-BY-SSN.
  3530         16  CL-COMPANY-CD-A2        PIC X.
  3531         16  CL-SOC-SEC-NO.
  3532             20  CL-SSN-STATE        PIC XX.
  3533             20  CL-SSN-ACCOUNT      PIC X(6).
  3534             20  CL-SSN-LN3          PIC X(3).
  3535
  3536     12  CL-CONTROL-BY-CERT-NO.
  3537         16  CL-COMPANY-CD-A4        PIC X.
  3538         16  CL-CERT-NO-A4.
  3539             20  CL-CERT-A4-PRIME    PIC X(10).
  3540             20  CL-CERT-A4-SFX      PIC X.
  3541
  3542     12  CL-CONTROL-BY-CCN.
  3543         16  CL-COMPANY-CD-A5        PIC X.
  3544         16  CL-CCN-A5.
  3545             20  CL-CCN.
  3546                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3547                 24  CL-CCN-PRIME-A5 PIC X(12).
  3548             20  CL-CCN-FILLER-A5    PIC X(4).
  3549
  3550     12  CL-INSURED-PROFILE-DATA.
  3551         16  CL-INSURED-BIRTH-DT     PIC XX.
  3552         16  CL-INSURED-SEX-CD       PIC X.
  3553             88  INSURED-IS-MALE        VALUE 'M'.
  3554             88  INSURED-IS-FEMALE      VALUE 'F'.
  3555             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3556         16  CL-INSURED-OCC-CD       PIC X(6).
  3557         16  FILLER                  PIC X(5).
  3558
  3559     12  CL-PROCESSING-INFO.
  3560         16  CL-PROCESSOR-ID         PIC X(4).
  3561         16  CL-CLAIM-STATUS         PIC X.
  3562             88  CLAIM-IS-OPEN          VALUE 'O'.
  3563             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3564         16  CL-CLAIM-TYPE           PIC X.
  3565*            88  AH-CLAIM               VALUE 'A'.
  3566*            88  LIFE-CLAIM             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  67
* EL131.cbl
  3567*            88  PROPERTY-CLAIM         VALUE 'P'.
  3568*            88  IUI-CLAIM              VALUE 'I'.
  3569*            88  GAP-CLAIM              VALUE 'G'.
  3570         16  CL-CLAIM-PREM-TYPE      PIC X.
  3571             88  SINGLE-PREMIUM         VALUE '1'.
  3572             88  O-B-COVERAGE           VALUE '2'.
  3573             88  OPEN-END-COVERAGE      VALUE '3'.
  3574         16  CL-INCURRED-DT          PIC XX.
  3575         16  CL-REPORTED-DT          PIC XX.
  3576         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3577         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3578         16  CL-LAST-PMT-DT          PIC XX.
  3579         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3580         16  CL-PAID-THRU-DT         PIC XX.
  3581         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3582         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3583         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3584         16  CL-PMT-CALC-METHOD      PIC X.
  3585             88  CL-360-DAY-YR          VALUE '1'.
  3586             88  CL-365-DAY-YR          VALUE '2'.
  3587             88  CL-FULL-MONTHS         VALUE '3'.
  3588         16  CL-CAUSE-CD             PIC X(6).
  3589
  3590         16  CL-PRIME-CERT-NO.
  3591             20  CL-PRIME-CERT-PRIME PIC X(10).
  3592             20  CL-PRIME-CERT-SFX   PIC X.
  3593
  3594         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3595             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3596             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3597
  3598         16  CL-MICROFILM-NO         PIC X(10).
  3599         16  CL-PROG-FORM-TYPE       PIC X.
  3600         16  CL-LAST-ADD-ON-DT       PIC XX.
  3601
  3602         16  CL-LAST-REOPEN-DT       PIC XX.
  3603         16  CL-LAST-CLOSE-DT        PIC XX.
  3604         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3605             88  FINAL-PAID             VALUE '1'.
  3606             88  CLAIM-DENIED           VALUE '2'.
  3607             88  AUTO-CLOSE             VALUE '3'.
  3608             88  MANUAL-CLOSE           VALUE '4'.
  3609             88  BENEFITS-CHANGED       VALUE 'C'.
  3610             88  SETUP-ERRORS           VALUE 'E'.
  3611         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3612         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3613         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3614             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3615         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3616         16  FILLER                  PIC X.
  3617
  3618     12  CL-CERTIFICATE-DATA.
  3619         16  CL-CERT-ORIGIN          PIC X.
  3620             88  CERT-WAS-ONLINE        VALUE '1'.
  3621             88  CERT-WAS-CREATED       VALUE '2'.
  3622             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3623         16  CL-CERT-KEY-DATA.
  3624             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  68
* EL131.cbl
  3625             20  CL-CERT-GROUPING    PIC X(6).
  3626             20  CL-CERT-STATE       PIC XX.
  3627             20  CL-CERT-ACCOUNT.
  3628                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3629                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3630             20  CL-CERT-EFF-DT      PIC XX.
  3631
  3632     12  CL-STATUS-CONTROLS.
  3633         16  CL-PRIORITY-CD          PIC X.
  3634             88  CONFIDENTIAL-DATA      VALUE '8'.
  3635             88  HIGHEST-PRIORITY       VALUE '9'.
  3636         16  CL-SUPV-ATTN-CD         PIC X.
  3637             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3638             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3639         16  CL-PURGED-DT            PIC XX.
  3640         16  CL-RESTORED-DT          PIC XX.
  3641         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3642         16  CL-NEXT-RESEND-DT       PIC XX.
  3643         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3644         16  CL-CRITICAL-PERIOD      PIC 99.
  3645*        16  FILLER                  PIC XX.
  3646         16  CL-LAST-MAINT-DT        PIC XX.
  3647         16  CL-LAST-MAINT-USER      PIC X(4).
  3648         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3649         16  CL-LAST-MAINT-TYPE      PIC X.
  3650             88  CLAIM-SET-UP           VALUE ' '.
  3651             88  PAYMENT-MADE           VALUE '1'.
  3652             88  LETTER-SENT            VALUE '2'.
  3653             88  MASTER-WAS-ALTERED     VALUE '3'.
  3654             88  MASTER-WAS-RESTORED    VALUE '4'.
  3655             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3656             88  FILE-CONVERTED         VALUE '6'.
  3657             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3658             88  ERROR-CORRECTION       VALUE 'E'.
  3659         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3660         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3661         16  CL-BENEFICIARY          PIC X(10).
  3662         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3663         16  CL-DENIAL-TYPE          PIC X.
  3664             88  CL-TYPE-DENIAL          VALUE '1'.
  3665             88  CL-TYPE-RESCISSION      VALUE '2'.
  3666             88  CL-TYPE-REFORMATION     VALUE '3'.
  3667             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3668             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3669         16  CL-CRIT-PER-RECURRENT   PIC X.
  3670         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3671         16  CL-RTW-DT               PIC XX.
  3672
  3673     12  CL-TRAILER-CONTROLS.
  3674         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3675             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3676             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3677             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3678         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3679         16  FILLER                  PIC XX.
  3680         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3681         16  CL-ADDRESS-TRAILER-CNT.
  3682             20  CL-INSURED-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  69
* EL131.cbl
  3683                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3684             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3685                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3686             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3687                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3688             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3689                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3690             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3691                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3692             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3693                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3694             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3695                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3696
  3697     12  CL-CV-REFERENCE-NO.
  3698         16  CL-CV-REFNO-PRIME       PIC X(18).
  3699         16  CL-CV-REFNO-SFX         PIC XX.
  3700
  3701     12  CL-FILE-LOCATION            PIC X(4).
  3702
  3703     12  CL-PROCESS-ERRORS.
  3704         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3705             88  NO-FATAL-ERRORS        VALUE ZERO.
  3706         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3707             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3708
  3709     12  CL-PRODUCT-CD               PIC X.
  3710
  3711     12  CL-CURRENT-KEY-DATA.
  3712         16  CL-CURRENT-CARRIER      PIC X.
  3713         16  CL-CURRENT-GROUPING     PIC X(6).
  3714         16  CL-CURRENT-STATE        PIC XX.
  3715         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3716
  3717     12  CL-ASSOCIATES               PIC X.
  3718         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3719         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3720         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3721         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3722
  3723     12  CL-ACTIVITY-CODE            PIC 99.
  3724     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3725     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3726
  3727     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3728     12  CL-LAG-REPORT-CODE          PIC 9.
  3729     12  CL-LOAN-TYPE                PIC XX.
  3730     12  CL-LEGAL-STATE              PIC XX.
  3731
  3732     12  CL-YESNOSW                  PIC X.
  3733     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3734         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3735         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3736         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3737     12  cl-insured-claim            pic x.
  3738         88  cl-claim-on-primary         value 'P'.
  3739         88  cl-claim-on-secondary       value 'S'.
  3740     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  70
* EL131.cbl
  3741
  3742*                                COPY ELCCERT.
  3743******************************************************************
  3744*                                                                *
  3745*                            ELCCERT.                            *
  3746*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3747*                            VMOD=2.013                          *
  3748*                                                                *
  3749*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3750*                                                                *
  3751*   FILE TYPE = VSAM,KSDS                                        *
  3752*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3753*                                                                *
  3754*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3755*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3756*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3757*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3758*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3759*                                                                *
  3760*   LOG = YES                                                    *
  3761*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3762******************************************************************
  3763*                   C H A N G E   L O G
  3764*
  3765* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3766*-----------------------------------------------------------------
  3767*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3768* EFFECTIVE    NUMBER
  3769*-----------------------------------------------------------------
  3770* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3771* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3772* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3773* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3774* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3775* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3776* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3777* 032612  CR2011110200001  PEMA  AHL CHANGES
  3778******************************************************************
  3779
  3780 01  CERTIFICATE-MASTER.
  3781     12  CM-RECORD-ID                      PIC XX.
  3782         88  VALID-CM-ID                      VALUE 'CM'.
  3783
  3784     12  CM-CONTROL-PRIMARY.
  3785         16  CM-COMPANY-CD                 PIC X.
  3786         16  CM-CARRIER                    PIC X.
  3787         16  CM-GROUPING.
  3788             20  CM-GROUPING-PREFIX        PIC X(3).
  3789             20  CM-GROUPING-PRIME         PIC X(3).
  3790         16  CM-STATE                      PIC XX.
  3791         16  CM-ACCOUNT.
  3792             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3793             20  CM-ACCOUNT-PRIME          PIC X(6).
  3794         16  CM-CERT-EFF-DT                PIC XX.
  3795         16  CM-CERT-NO.
  3796             20  CM-CERT-PRIME             PIC X(10).
  3797             20  CM-CERT-SFX               PIC X.
  3798
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  71
* EL131.cbl
  3799     12  CM-CONTROL-BY-NAME.
  3800         16  CM-COMPANY-CD-A1              PIC X.
  3801         16  CM-INSURED-LAST-NAME          PIC X(15).
  3802         16  CM-INSURED-INITIALS.
  3803             20  CM-INSURED-INITIAL1       PIC X.
  3804             20  CM-INSURED-INITIAL2       PIC X.
  3805
  3806     12  CM-CONTROL-BY-SSN.
  3807         16  CM-COMPANY-CD-A2              PIC X.
  3808         16  CM-SOC-SEC-NO.
  3809             20  CM-SSN-STATE              PIC XX.
  3810             20  CM-SSN-ACCOUNT            PIC X(6).
  3811             20  CM-SSN-LN3.
  3812                 25  CM-INSURED-INITIALS-A2.
  3813                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3814                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3815                 25 CM-PART-LAST-NAME-A2         PIC X.
  3816
  3817     12  CM-CONTROL-BY-CERT-NO.
  3818         16  CM-COMPANY-CD-A4              PIC X.
  3819         16  CM-CERT-NO-A4                 PIC X(11).
  3820
  3821     12  CM-CONTROL-BY-MEMB.
  3822         16  CM-COMPANY-CD-A5              PIC X.
  3823         16  CM-MEMBER-NO.
  3824             20  CM-MEMB-STATE             PIC XX.
  3825             20  CM-MEMB-ACCOUNT           PIC X(6).
  3826             20  CM-MEMB-LN4.
  3827                 25  CM-INSURED-INITIALS-A5.
  3828                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3829                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3830                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3831
  3832     12  CM-INSURED-PROFILE-DATA.
  3833         16  CM-INSURED-FIRST-NAME.
  3834             20  CM-INSURED-1ST-INIT       PIC X.
  3835             20  FILLER                    PIC X(9).
  3836         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3837         16  CM-INSURED-SEX                PIC X.
  3838             88  CM-SEX-MALE                  VALUE 'M'.
  3839             88  CM-SEX-FEMAL                 VALUE 'F'.
  3840         16  CM-INSURED-JOINT-AGE          PIC 99.
  3841         16  CM-JOINT-INSURED-NAME.
  3842             20  CM-JT-LAST-NAME           PIC X(15).
  3843             20  CM-JT-FIRST-NAME.
  3844                 24  CM-JT-1ST-INIT        PIC X.
  3845                 24  FILLER                PIC X(9).
  3846             20  CM-JT-INITIAL             PIC X.
  3847
  3848     12  CM-LIFE-DATA.
  3849         16  CM-LF-BENEFIT-CD              PIC XX.
  3850         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3851         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3852         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3853         16  CM-LF-DEV-CODE                PIC XXX.
  3854         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3855         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3856         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  72
* EL131.cbl
  3857         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3858         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3859         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3860         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3861         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3862         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3863         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3864         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3865         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3866         16  FILLER                        PIC XX.
  3867
  3868     12  CM-AH-DATA.
  3869         16  CM-AH-BENEFIT-CD              PIC XX.
  3870         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3871         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3872         16  CM-AH-DEV-CODE                PIC XXX.
  3873         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3874         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3875         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3876         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3877         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3878         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3879         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3880         16  CM-AH-PAID-THRU-DT            PIC XX.
  3881             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3882         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3883         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3884         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3885         16  FILLER                        PIC X.
  3886
  3887     12  CM-LOAN-INFORMATION.
  3888         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3889         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3890                                           PIC S9(5)V99  COMP-3.
  3891         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3892         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3893         16  CM-PAY-FREQUENCY              PIC S99.
  3894         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3895         16  CM-RATE-CLASS                 PIC XX.
  3896         16  CM-BENEFICIARY                PIC X(25).
  3897         16  CM-POLICY-FORM-NO             PIC X(12).
  3898         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3899         16  CM-LAST-ADD-ON-DT             PIC XX.
  3900         16  CM-DEDUCTIBLE-AMOUNTS.
  3901             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3902             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3903         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3904             20  CM-RESIDENT-STATE         PIC XX.
  3905             20  CM-RATE-CODE              PIC X(4).
  3906             20  FILLER                    PIC XX.
  3907         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3908             20  CM-LOAN-OFFICER           PIC X(5).
  3909             20  FILLER                    PIC XXX.
  3910         16  CM-CSR-CODE                   PIC XXX.
  3911         16  CM-UNDERWRITING-CODE          PIC X.
  3912             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3913         16  CM-POST-CARD-IND              PIC X.
  3914         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  73
* EL131.cbl
  3915         16  CM-PREMIUM-TYPE               PIC X.
  3916             88  CM-SING-PRM                  VALUE '1'.
  3917             88  CM-O-B-COVERAGE              VALUE '2'.
  3918             88  CM-OPEN-END                  VALUE '3'.
  3919         16  CM-IND-GRP-TYPE               PIC X.
  3920             88  CM-INDIVIDUAL                VALUE 'I'.
  3921             88  CM-GROUP                     VALUE 'G'.
  3922         16  CM-SKIP-CODE                  PIC X.
  3923             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3924             88  SKIP-JULY                    VALUE '1'.
  3925             88  SKIP-AUGUST                  VALUE '2'.
  3926             88  SKIP-SEPTEMBER               VALUE '3'.
  3927             88  SKIP-JULY-AUG                VALUE '4'.
  3928             88  SKIP-AUG-SEPT                VALUE '5'.
  3929             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3930             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3931             88  SKIP-JUNE                    VALUE '8'.
  3932             88  SKIP-JUNE-JULY               VALUE '9'.
  3933             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3934             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3935         16  CM-PAYMENT-MODE               PIC X.
  3936             88  PAY-MONTHLY                  VALUE SPACE.
  3937             88  PAY-WEEKLY                   VALUE '1'.
  3938             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3939             88  PAY-BI-WEEKLY                VALUE '3'.
  3940             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3941         16  CM-LOAN-NUMBER                PIC X(8).
  3942         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3943         16  CM-OLD-LOF                    PIC XXX.
  3944*        16  CM-LOAN-OFFICER               PIC XXX.
  3945         16  CM-REIN-TABLE                 PIC XXX.
  3946         16  CM-SPECIAL-REIN-CODE          PIC X.
  3947         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3948         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3949         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3950
  3951     12  CM-STATUS-DATA.
  3952         16  CM-ENTRY-STATUS               PIC X.
  3953         16  CM-ENTRY-DT                   PIC XX.
  3954
  3955         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3956         16  CM-LF-CANCEL-DT               PIC XX.
  3957         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3958
  3959         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3960         16  CM-LF-DEATH-DT                PIC XX.
  3961         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3962
  3963         16  CM-LF-CURRENT-STATUS          PIC X.
  3964             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3965                                                'M' '4' '5' '9'.
  3966             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3967             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3968             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3969             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3970             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3971             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3972             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  74
* EL131.cbl
  3973             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3974             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3975             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3976             88  CM-LF-DECLINED               VALUE 'D'.
  3977             88  CM-LF-VOIDED                 VALUE 'V'.
  3978
  3979         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3980         16  CM-AH-CANCEL-DT               PIC XX.
  3981         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3982
  3983         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3984         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3985         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3986
  3987         16  CM-AH-CURRENT-STATUS          PIC X.
  3988             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3989                                                'M' '4' '5' '9'.
  3990             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3991             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3992             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3993             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3994             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3995             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3996             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3997             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3998             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3999             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4000             88  CM-AH-DECLINED               VALUE 'D'.
  4001             88  CM-AH-VOIDED                 VALUE 'V'.
  4002
  4003         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4004             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4005             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4006             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4007         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4008
  4009         16  CM-ENTRY-BATCH                PIC X(6).
  4010         16  CM-LF-EXIT-BATCH              PIC X(6).
  4011         16  CM-AH-EXIT-BATCH              PIC X(6).
  4012         16  CM-LAST-MONTH-END             PIC XX.
  4013
  4014     12  CM-NOTE-SW                        PIC X.
  4015         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4016         88  CERT-NOTES-PRESENT               VALUE '1'.
  4017         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4018         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4019         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4020         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4021         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4022         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4023     12  CM-COMP-EXCP-SW                   PIC X.
  4024         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4025         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4026     12  CM-INSURED-ADDRESS-SW             PIC X.
  4027         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4028         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4029
  4030*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  75
* EL131.cbl
  4031     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4032     12  FILLER                            PIC X.
  4033
  4034*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4035     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4036     12  FILLER                            PIC X.
  4037*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4038     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4039
  4040     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4041         88  CERT-ADDED-BATCH                 VALUE ' '.
  4042         88  CERT-ADDED-ONLINE                VALUE '1'.
  4043         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4044         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4045         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4046     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4047         88  CERT-AS-LOADED                   VALUE ' '.
  4048         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4049         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4050         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4051         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4052         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4053         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4054         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4055
  4056     12  CM-ACCOUNT-COMM-PCTS.
  4057         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4058         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4059
  4060     12  CM-USER-FIELD                     PIC X.
  4061     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4062     12  CM-CLP-STATE                      PIC XX.
  4063     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4064     12  CM-USER-RESERVED                  PIC XXX.
  4065     12  FILLER REDEFINES CM-USER-RESERVED.
  4066         16  CM-AH-CLASS-CD                PIC XX.
  4067         16  F                             PIC X.
  4068******************************************************************
  4069
  4070*                                COPY ELCTRLR.
  4071******************************************************************
  4072*                                                                *
  4073*                            ELCTRLR.                            *
  4074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4075*                            VMOD=2.014                          *
  4076*                                                                *
  4077*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4078*                                                                *
  4079*   FILE TYPE = VSAM,KSDS                                        *
  4080*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4081*                                                                *
  4082*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4083*       ALTERNATE INDEX = NONE                                   *
  4084*                                                                *
  4085*   LOG = YES                                                    *
  4086*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4087******************************************************************
  4088*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  76
* EL131.cbl
  4089*
  4090* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4091*-----------------------------------------------------------------
  4092*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4093* EFFECTIVE    NUMBER
  4094*-----------------------------------------------------------------
  4095* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4096* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4097* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4098* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4099* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4100* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4101* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4102* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4103* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4104* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4105* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4106* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4107* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4108* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4109* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4110* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4111******************************************************************
  4112 01  ACTIVITY-TRAILERS.
  4113     12  AT-RECORD-ID                    PIC XX.
  4114         88  VALID-AT-ID                       VALUE 'AT'.
  4115
  4116     12  AT-CONTROL-PRIMARY.
  4117         16  AT-COMPANY-CD               PIC X.
  4118         16  AT-CARRIER                  PIC X.
  4119         16  AT-CLAIM-NO                 PIC X(7).
  4120         16  AT-CERT-NO.
  4121             20  AT-CERT-PRIME           PIC X(10).
  4122             20  AT-CERT-SFX             PIC X.
  4123         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4124             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4125             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4126             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4127             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4128             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4129             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4130             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4131             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4132             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4133             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4134             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4135             88  AT-BENEFICIARY-TRL           VALUE +91.
  4136             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4137             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4138             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4139             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4140
  4141     12  AT-TRAILER-TYPE                 PIC X.
  4142         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4143         88  PAYMENT-TR                       VALUE '2'.
  4144         88  AUTO-PAY-TR                      VALUE '3'.
  4145         88  CORRESPONDENCE-TR                VALUE '4'.
  4146         88  ADDRESS-TR                       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  77
* EL131.cbl
  4147         88  GENERAL-INFO-TR                  VALUE '6'.
  4148         88  AUTO-PROMPT-TR                   VALUE '7'.
  4149         88  DENIAL-TR                        VALUE '8'.
  4150         88  INCURRED-CHG-TR                  VALUE '9'.
  4151         88  FORM-CONTROL-TR                  VALUE 'A'.
  4152
  4153     12  AT-RECORDED-DT                  PIC XX.
  4154     12  AT-RECORDED-BY                  PIC X(4).
  4155     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4156
  4157     12  AT-TRAILER-BODY                 PIC X(165).
  4158
  4159     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4160         16  AT-RESERVE-CONTROLS.
  4161             20  AT-MANUAL-SW            PIC X.
  4162                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4163             20  AT-FUTURE-SW            PIC X.
  4164                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4165             20  AT-PTC-SW               PIC X.
  4166                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4167             20  AT-IBNR-SW              PIC X.
  4168                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4169             20  AT-PTC-LF-SW            PIC X.
  4170                 88  AT-LF-PTC-USED          VALUE '1'.
  4171             20  AT-CDT-ACCESS-METHOD    PIC X.
  4172                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4173                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4174                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4175             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4176         16  AT-LAST-COMPUTED-DT         PIC XX.
  4177         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4178         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4179         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4180         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4181         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4182         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4183         16  AT-EXPENSE-CONTROLS.
  4184             20  AT-EXPENSE-METHOD       PIC X.
  4185                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4186                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4187                 88  PERCENT-OF-PMT           VALUE '3'.
  4188                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4189             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4190             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4191         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4192         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4193
  4194         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4195         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4196
  4197*        16  FILLER                      PIC X(53).
  4198         16  FILLER                      PIC X(47).
  4199
  4200         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4201         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4202
  4203         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4204             20  AT-OPEN-CLOSE-DATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  78
* EL131.cbl
  4205             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4206*                    C = CLOSED
  4207*                    O = OPEN
  4208             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4209*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4210
  4211     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4212         16  AT-PAYMENT-TYPE             PIC X.
  4213             88  PARTIAL-PAYMENT                VALUE '1'.
  4214             88  FINAL-PAYMENT                  VALUE '2'.
  4215             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4216             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4217             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4218             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4219             88  VOIDED-PAYMENT                 VALUE '9'.
  4220             88  TRANSFER                       VALUE 'T'.
  4221             88  LIFE-INTEREST                  VALUE 'I'.
  4222
  4223         16  AT-CLAIM-TYPE               PIC X.
  4224             88  PAID-FOR-AH                    VALUE 'A'.
  4225             88  PAID-FOR-LIFE                  VALUE 'L'.
  4226             88  PAID-FOR-IUI                   VALUE 'I'.
  4227             88  PAID-FOR-GAP                   VALUE 'G'.
  4228         16  AT-CLAIM-PREM-TYPE          PIC X.
  4229             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4230             88  AT-O-B-COVERAGE                VALUE '2'.
  4231             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4232         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4233         16  AT-CHECK-NO                 PIC X(7).
  4234         16  AT-PAID-FROM-DT             PIC XX.
  4235         16  AT-PAID-THRU-DT             PIC XX.
  4236         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4237         16  FILLER                      PIC X.
  4238         16  AT-PAYEES-NAME              PIC X(30).
  4239         16  AT-PAYMENT-ORIGIN           PIC X.
  4240             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4241             88  ONLINE-AUTO-PMT                VALUE '2'.
  4242             88  OFFLINE-PMT                    VALUE '3'.
  4243         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4244         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4245         16  AT-VOID-DATA.
  4246             20  AT-VOID-DT              PIC XX.
  4247*00144       20  AT-VOID-REASON          PIC X(30).
  4248             20  AT-VOID-REASON          PIC X(26).
  4249         16  AT-PMT-APPROVED-BY          PIC X(04).
  4250         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4251         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4252         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4253                                         PIC S99V9(5)  COMP-3.
  4254         16  AT-CREDIT-INTERFACE.
  4255             20  AT-PMT-SELECT-DT        PIC XX.
  4256                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4257             20  AT-PMT-ACCEPT-DT        PIC XX.
  4258                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4259             20  AT-VOID-SELECT-DT       PIC XX.
  4260                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4261             20  AT-VOID-ACCEPT-DT       PIC XX.
  4262                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  79
* EL131.cbl
  4263
  4264         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4265                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4266                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4267         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4268
  4269         16  AT-FORCE-CONTROL            PIC X.
  4270             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4271         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4272         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4273         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4274         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4275         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4276         16  AT-BENEFIT-TYPE             PIC X.
  4277
  4278         16  AT-EXPENSE-TYPE             PIC X.
  4279         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4280
  4281         16  AT-PAYEE-TYPE-CD.
  4282             20  AT-PAYEE-TYPE           PIC X.
  4283                 88  INSURED-PAID           VALUE 'I'.
  4284                 88  BENEFICIARY-PAID       VALUE 'B'.
  4285                 88  ACCOUNT-PAID           VALUE 'A'.
  4286                 88  OTHER-1-PAID           VALUE 'O'.
  4287                 88  OTHER-2-PAID           VALUE 'Q'.
  4288                 88  DOCTOR-PAID            VALUE 'P'.
  4289                 88  EMPLOYER-PAID          VALUE 'E'.
  4290             20  AT-PAYEE-SEQ            PIC X.
  4291
  4292         16  AT-CASH-PAYMENT             PIC X.
  4293         16  AT-GROUPED-PAYMENT          PIC X.
  4294         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4295         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4296         16  AT-APPROVED-LEVEL           PIC X.
  4297         16  AT-VOID-TYPE                PIC X.
  4298             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4299             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4300         16  AT-AIG-UNEMP-IND            PIC X.
  4301             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4302         16  AT-ASSOCIATES               PIC X.
  4303             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4304             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4305
  4306         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4307         16  AT-CV-PMT-CODE              PIC X.
  4308             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4309             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4310             88  FULL-ADD-PAYMENT           VALUE '3'.
  4311             88  HALF-ADD-PAYMENT           VALUE '4'.
  4312             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4313             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4314             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4315             88  ADDL-PAYMENT               VALUE '8'.
  4316
  4317         16  AT-EOB-CODE1                PIC XXX.
  4318         16  AT-EOB-CODE2                PIC XXX.
  4319         16  AT-EOB-CODE3                PIC XXX.
  4320         16  FILLER REDEFINES AT-EOB-CODE3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  80
* EL131.cbl
  4321             20  AT-PRINT-CLM-FORM       PIC X.
  4322             20  AT-PRINT-SURVEY         PIC X.
  4323             20  FILLER                  PIC X.
  4324         16  AT-EOB-CODE4                PIC XXX.
  4325         16  FILLER REDEFINES AT-EOB-CODE4.
  4326             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4327             20  FILLER                  PIC X.
  4328         16  AT-EOB-CODE5                PIC XXX.
  4329         16  FILLER REDEFINES AT-EOB-CODE5.
  4330             20  AT-PMT-PROOF-DT         PIC XX.
  4331             20  FILLER                  PIC X.
  4332
  4333         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4334             88  AT-PRINT-EOB            VALUE 'Y'.
  4335
  4336         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4337         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4338
  4339     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4340         16  AT-SCHEDULE-START-DT        PIC XX.
  4341         16  AT-SCHEDULE-END-DT          PIC XX.
  4342         16  AT-TERMINATED-DT            PIC XX.
  4343         16  AT-LAST-PMT-TYPE            PIC X.
  4344             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4345             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4346         16  AT-FIRST-PMT-DATA.
  4347             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4348             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4349             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4350         16  AT-REGULAR-PMT-DATA.
  4351             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4352             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4353             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4354         16  AT-AUTO-PAYEE-CD.
  4355             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4356                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4357                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4358                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4359                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4360                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4361             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4362         16  AT-AUTO-PAY-DAY             PIC 99.
  4363         16  AT-AUTO-CASH                PIC X.
  4364             88  AT-CASH                      VALUE 'Y'.
  4365             88  AT-NON-CASH                  VALUE 'N'.
  4366*        16  FILLER                      PIC X(129).
  4367         16  AT-AUTO-END-LETTER          PIC X(4).
  4368         16  FILLER                      PIC X(125).
  4369
  4370         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4371         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4372
  4373     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4374         16  AT-LETTER-SENT-DT           PIC XX.
  4375         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4376         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4377         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4378         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  81
* EL131.cbl
  4379         16  AT-LETTER-ORIGIN            PIC X.
  4380             88  ONLINE-CREATION              VALUE '1' '3'.
  4381             88  OFFLINE-CREATION             VALUE '2' '4'.
  4382             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4383             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4384         16  AT-STD-LETTER-FORM          PIC X(4).
  4385         16  AT-REASON-TEXT              PIC X(70).
  4386         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4387         16  AT-ADDRESEE-TYPE            PIC X.
  4388              88  INSURED-ADDRESEE            VALUE 'I'.
  4389              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4390              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4391              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4392              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4393              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4394              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4395         16  AT-ADDRESSEE-NAME           PIC X(30).
  4396         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4397         16  AT-RESEND-PRINT-DATE        PIC XX.
  4398         16  AT-CORR-SOL-UNSOL           PIC X.
  4399         16  AT-LETTER-PURGED-DT         PIC XX.
  4400*
  4401*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4402*
  4403         16  AT-CSO-REDEFINITION.
  4404             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4405             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4406             20  AT-LETTER-TO-BENE       PIC X(1).
  4407             20  AT-STOP-LETTER-DT       PIC X(2).
  4408             20  FILLER                  PIC X(19).
  4409*             20  FILLER                  PIC X(27).
  4410             20  AT-CSO-LETTER-STATUS    PIC X.
  4411                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4412                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4413                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4414             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4415             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4416*
  4417*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4418*
  4419*        16  FILLER                      PIC X(26).
  4420*
  4421*        16  AT-DMD-BSR-CODE             PIC X.
  4422*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4423*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4424*
  4425*        16  AT-DMD-LETTER-STATUS        PIC X.
  4426*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4427*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4428*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4429*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4430*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4431
  4432         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4433         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4434
  4435     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4436         16  AT-ADDRESS-TYPE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  82
* EL131.cbl
  4437             88  INSURED-ADDRESS               VALUE 'I'.
  4438             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4439             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4440             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4441             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4442             88  OTHER-ADDRESS-1               VALUE 'O'.
  4443             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4444         16  AT-MAIL-TO-NAME             PIC X(30).
  4445         16  AT-ADDRESS-LINE-1           PIC X(30).
  4446         16  AT-ADDRESS-LINE-2           PIC X(30).
  4447         16  AT-CITY-STATE.
  4448             20  AT-CITY                 PIC X(28).
  4449             20  AT-STATE                PIC XX.
  4450         16  AT-ZIP.
  4451             20  AT-ZIP-CODE.
  4452                 24  AT-ZIP-1ST          PIC X.
  4453                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4454                 24  FILLER              PIC X(4).
  4455             20  AT-ZIP-PLUS4            PIC X(4).
  4456         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4457             20  AT-CAN-POSTAL-1         PIC XXX.
  4458             20  AT-CAN-POSTAL-2         PIC XXX.
  4459             20  FILLER                  PIC XXX.
  4460         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4461*         16  FILLER                      PIC X(23).
  4462         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4463         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4464         16  FILLER                      PIC X(13).
  4465         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4466         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4467
  4468     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4469         16  AT-INFO-LINE-1              PIC X(60).
  4470         16  FILLER REDEFINES AT-INFO-LINE-1.
  4471             20  AT-NOTE-ERROR-NO OCCURS 15
  4472                                         PIC X(4).
  4473         16  AT-INFO-LINE-2              PIC X(60).
  4474         16  AT-INFO-TRAILER-TYPE        PIC X.
  4475             88  AT-ERRORS-NOTE          VALUE 'E'.
  4476             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4477             88  AT-CALL-NOTE            VALUE 'C'.
  4478             88  AT-MAINT-NOTE           VALUE 'M'.
  4479             88  AT-CERT-CHANGE          VALUE 'X'.
  4480             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4481             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4482         16  AT-CALL-TYPE                PIC X.
  4483             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4484             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4485         16  AT-NOTE-CONTINUATION        PIC X.
  4486             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4487         16  AT-EOB-CODES-EXIST          PIC X.
  4488             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4489         16  FILLER                      PIC X(35).
  4490         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4491         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4492
  4493     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4494         16  AT-PROMPT-LINE-1            PIC X(60).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  83
* EL131.cbl
  4495         16  AT-PROMPT-LINE-2            PIC X(60).
  4496         16  AT-PROMPT-START-DT          PIC XX.
  4497         16  AT-PROMPT-END-DT            PIC XX.
  4498         16  FILLER                      PIC X(35).
  4499         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4500         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4501
  4502     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4503         16  AT-DENIAL-INFO-1            PIC X(60).
  4504         16  AT-DENIAL-INFO-2            PIC X(60).
  4505         16  AT-DENIAL-DT                PIC XX.
  4506         16  AT-RETRACTION-DT            PIC XX.
  4507         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4508*         16  FILLER                      PIC X(31).
  4509         16  AT-DENIAL-PROOF-DT          PIC XX.
  4510         16  FILLER                      PIC X(29).
  4511         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4512         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4513
  4514     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4515         16  AT-OLD-INCURRED-DT          PIC XX.
  4516         16  AT-OLD-REPORTED-DT          PIC XX.
  4517         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4518         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4519         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4520         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4521         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4522         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4523         16  FILLER                      PIC X(26).
  4524         16  AT-OLD-DIAG-CODE            PIC X(6).
  4525         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4526         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4527         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4528         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4529         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4530         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4531         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4532         16  FILLER                      PIC X(25).
  4533         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4534
  4535     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4536         16  AT-FORM-SEND-ON-DT          PIC XX.
  4537         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4538         16  AT-FORM-RE-SEND-DT          PIC XX.
  4539         16  AT-FORM-ANSWERED-DT         PIC XX.
  4540         16  AT-FORM-PRINTED-DT          PIC XX.
  4541         16  AT-FORM-REPRINT-DT          PIC XX.
  4542         16  AT-FORM-TYPE                PIC X.
  4543             88  INITIAL-FORM                  VALUE '1'.
  4544             88  PROGRESS-FORM                 VALUE '2'.
  4545         16  AT-INSTRUCT-LN-1            PIC X(28).
  4546         16  AT-INSTRUCT-LN-2            PIC X(28).
  4547         16  AT-INSTRUCT-LN-3            PIC X(28).
  4548         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4549         16  AT-FORM-ADDRESS             PIC X.
  4550             88  FORM-TO-INSURED              VALUE 'I'.
  4551             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4552             88  FORM-TO-OTHER-1              VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  84
* EL131.cbl
  4553             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4554         16  AT-RELATED-1.
  4555             20 AT-REL-CARR-1            PIC X.
  4556             20 AT-REL-CLAIM-1           PIC X(7).
  4557             20 AT-REL-CERT-1            PIC X(11).
  4558         16  AT-RELATED-2.
  4559             20 AT-REL-CARR-2            PIC X.
  4560             20 AT-REL-CLAIM-2           PIC X(7).
  4561             20 AT-REL-CERT-2            PIC X(11).
  4562         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4563         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4564         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4565         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4566         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4567         16  AT-STOP-FORM-DT             PIC X(2).
  4568
  4569         16  FILLER                      PIC X(09).
  4570         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4571         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4572******************************************************************
  4573
  4574*                                COPY ELCCNTL.
  4575******************************************************************
  4576*                                                                *
  4577*                                                                *
  4578*                            ELCCNTL.                            *
  4579*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4580*                            VMOD=2.059                          *
  4581*                                                                *
  4582*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4583*                                                                *
  4584*   FILE TYPE = VSAM,KSDS                                        *
  4585*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4586*                                                                *
  4587*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4588*       ALTERNATE INDEX = NONE                                   *
  4589*                                                                *
  4590*   LOG = YES                                                    *
  4591*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4592******************************************************************
  4593*                   C H A N G E   L O G
  4594*
  4595* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4596*-----------------------------------------------------------------
  4597*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4598* EFFECTIVE    NUMBER
  4599*-----------------------------------------------------------------
  4600* 082503                   PEMA  ADD BENEFIT GROUP
  4601* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4602* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4603* 092705    2005050300006  PEMA  ADD SPP LEASES
  4604* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4605* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4606* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4607* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4608* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4609* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4610* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  85
* EL131.cbl
  4611* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4612* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4613******************************************************************
  4614*
  4615 01  CONTROL-FILE.
  4616     12  CF-RECORD-ID                       PIC XX.
  4617         88  VALID-CF-ID                        VALUE 'CF'.
  4618
  4619     12  CF-CONTROL-PRIMARY.
  4620         16  CF-COMPANY-ID                  PIC XXX.
  4621         16  CF-RECORD-TYPE                 PIC X.
  4622             88  CF-COMPANY-MASTER              VALUE '1'.
  4623             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4624             88  CF-STATE-MASTER                VALUE '3'.
  4625             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4626             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4627             88  CF-CARRIER-MASTER              VALUE '6'.
  4628             88  CF-MORTALITY-MASTER            VALUE '7'.
  4629             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4630             88  CF-TERMINAL-MASTER             VALUE '9'.
  4631             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4632             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4633             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4634             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4635             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4636             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4637             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4638             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4639             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4640         16  CF-ACCESS-CD-GENL              PIC X(4).
  4641         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4642             20  CF-PROCESSOR               PIC X(4).
  4643         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4644             20  CF-STATE-CODE              PIC XX.
  4645             20  FILLER                     PIC XX.
  4646         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4647             20  FILLER                     PIC XX.
  4648             20  CF-HI-BEN-IN-REC           PIC XX.
  4649         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4650             20  FILLER                     PIC XXX.
  4651             20  CF-CARRIER-CNTL            PIC X.
  4652         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4653             20  FILLER                     PIC XX.
  4654             20  CF-HI-TYPE-IN-REC          PIC 99.
  4655         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4656             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4657                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4658             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4659             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4660         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4661             20  FILLER                     PIC X.
  4662             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4663         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4664             20  FILLER                     PIC XX.
  4665             20  CF-MORTGAGE-PLAN           PIC XX.
  4666         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4667
  4668     12  CF-LAST-MAINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  86
* EL131.cbl
  4669     12  CF-LAST-MAINT-BY                   PIC X(4).
  4670     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4671
  4672     12  CF-RECORD-BODY                     PIC X(728).
  4673
  4674
  4675****************************************************************
  4676*             COMPANY MASTER RECORD                            *
  4677****************************************************************
  4678
  4679     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4680         16  CF-COMPANY-ADDRESS.
  4681             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4682             20  CF-CL-IN-CARE-OF           PIC X(30).
  4683             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4684             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4685             20  CF-CL-CITY-STATE           PIC X(30).
  4686             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4687             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4688         16  CF-COMPANY-CD                  PIC X.
  4689         16  CF-COMPANY-PASSWORD            PIC X(8).
  4690         16  CF-SECURITY-OPTION             PIC X.
  4691             88  ALL-SECURITY                   VALUE '1'.
  4692             88  COMPANY-VERIFY                 VALUE '2'.
  4693             88  PROCESSOR-VERIFY               VALUE '3'.
  4694             88  NO-SECURITY                    VALUE '4'.
  4695             88  ALL-BUT-TERM                   VALUE '5'.
  4696         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4697             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4698         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4699             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4700         16  CF-INFORCE-LOCATION            PIC X.
  4701             88  CERTS-ARE-ONLINE               VALUE '1'.
  4702             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4703             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4704         16  CF-LOWER-CASE-LETTERS          PIC X.
  4705         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4706             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4707             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4708             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4709             88  CF-ACCNT-CNTL                  VALUE '3'.
  4710             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4711
  4712         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4713         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4714
  4715         16  CF-LGX-CREDIT-USER             PIC X.
  4716             88  CO-IS-NOT-USER                 VALUE 'N'.
  4717             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4718
  4719         16 CF-CREDIT-CALC-CODES.
  4720             20  CF-CR-REM-TERM-CALC PIC X.
  4721               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4722               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4723               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4724               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4725               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4726               88  CR-EARN-AFTER-14TH           VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  87
* EL131.cbl
  4727               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4728             20  CF-CR-R78-METHOD           PIC X.
  4729               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4730               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4731
  4732         16  CF-CLAIM-CONTROL-COUNTS.
  4733             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4734                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4735
  4736             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4737                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4738
  4739             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4740                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4741
  4742             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4743                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4744
  4745         16  CF-CURRENT-MONTH-END           PIC XX.
  4746
  4747         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4748             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4749             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4750             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4751             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4752                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4753                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4754             20  CF-CO-PREM-REJECT-SW       PIC X.
  4755                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4756                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4757             20  CF-CO-REF-REJECT-SW        PIC X.
  4758                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4759                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4760
  4761         16  CF-CO-REPORTING-DT             PIC XX.
  4762         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4763         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4764           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4765           88  CF-CO-MONTH-END                  VALUE '1'.
  4766
  4767         16  CF-LGX-CLAIM-USER              PIC X.
  4768             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4769             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4770
  4771         16  CF-CREDIT-EDIT-CONTROLS.
  4772             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4773             20  CF-MIN-AGE                 PIC 99.
  4774             20  CF-DEFAULT-AGE             PIC 99.
  4775             20  CF-MIN-TERM                PIC S999      COMP-3.
  4776             20  CF-MAX-TERM                PIC S999      COMP-3.
  4777             20  CF-DEFAULT-SEX             PIC X.
  4778             20  CF-JOINT-AGE-INPUT         PIC X.
  4779                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4780             20  CF-BIRTH-DATE-INPUT        PIC X.
  4781                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4782             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4783                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4784                 88  CF-ZERO-CARRIER            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  88
* EL131.cbl
  4785                 88  CF-ZERO-GROUPING           VALUE '2'.
  4786                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4787             20  CF-EDIT-SW                 PIC X.
  4788                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4789             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4790             20  CF-CR-PR-METHOD            PIC X.
  4791               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4792               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4793             20  FILLER                     PIC X.
  4794
  4795         16  CF-CREDIT-MISC-CONTROLS.
  4796             20  CF-REIN-TABLE-SW           PIC X.
  4797                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4798             20  CF-COMP-TABLE-SW           PIC X.
  4799                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4800             20  CF-EXPERIENCE-RETENTION-AGE
  4801                                            PIC S9        COMP-3.
  4802             20  CF-CONVERSION-DT           PIC XX.
  4803             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4804             20  CF-RUN-FREQUENCY-SW        PIC X.
  4805                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4806                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4807
  4808             20  CF-CR-CHECK-NO-CONTROL.
  4809                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4810                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4811                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4812                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4813                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4814                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4815
  4816                 24  CF-CR-CHECK-COUNT       REDEFINES
  4817                     CF-CR-CHECK-COUNTER      PIC X(4).
  4818
  4819                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4820                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4821
  4822                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4823                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4824                 24  CF-MAIL-PROCESSING       PIC X.
  4825                     88  MAIL-PROCESSING          VALUE 'Y'.
  4826
  4827         16  CF-MISC-SYSTEM-CONTROL.
  4828             20  CF-SYSTEM-C                 PIC X.
  4829                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4830             20  CF-SYSTEM-D                 PIC X.
  4831                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4832             20  CF-SOC-SEC-NO-SW            PIC X.
  4833                 88  SOC-SEC-NO-USED             VALUE '1'.
  4834             20  CF-MEMBER-NO-SW             PIC X.
  4835                 88  MEMBER-NO-USED              VALUE '1'.
  4836             20  CF-TAX-ID-NUMBER            PIC X(11).
  4837             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4838             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4839                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4840                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4841                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4842                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  89
* EL131.cbl
  4843             20  CF-SYSTEM-E                 PIC X.
  4844                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4845
  4846         16  CF-LGX-LIFE-USER               PIC X.
  4847             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4848             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4849
  4850         16  CF-CR-MONTH-END-DT             PIC XX.
  4851
  4852         16  CF-FILE-MAINT-DATES.
  4853             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4854                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4855             20  CF-LAST-BATCH       REDEFINES
  4856                 CF-LAST-BATCH-NO               PIC X(4).
  4857             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4858             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4859             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4860             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4861             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4862             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4863             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4864             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4865             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4866             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4867
  4868         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4869         16  FILLER                         PIC X.
  4870
  4871         16  CF-ALT-MORT-CODE               PIC X(4).
  4872         16  CF-MEMBER-CAPTION              PIC X(10).
  4873
  4874         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4875             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4876             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4877             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4878             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4879             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4880
  4881         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4882
  4883         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4884         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4885         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4886         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4887
  4888         16  CF-AH-OVERRIDE-L1              PIC X.
  4889         16  CF-AH-OVERRIDE-L2              PIC XX.
  4890         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4891         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4892
  4893         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4894         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4895
  4896         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4897         16  CF-AR-LAST-EL860-DT            PIC XX.
  4898         16  CF-MP-MONTH-END-DT             PIC XX.
  4899
  4900         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  90
* EL131.cbl
  4901         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4902             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4903
  4904         16  CF-AR-MONTH-END-DT             PIC XX.
  4905
  4906         16  CF-CRDTCRD-USER                PIC X.
  4907             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4908             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4909
  4910         16  CF-CC-MONTH-END-DT             PIC XX.
  4911
  4912         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4913
  4914         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4915             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4916             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4917             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4918         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4919         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4920         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4921         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4922             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4923             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4924         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4925         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4926         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4927             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4928         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4929
  4930         16  CF-CL-ZIP-CODE.
  4931             20  CF-CL-ZIP-PRIME.
  4932                 24  CF-CL-ZIP-1ST          PIC X.
  4933                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4934                 24  FILLER                 PIC X(4).
  4935             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4936         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4937             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4938             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4939             20  FILLER                     PIC XXX.
  4940
  4941         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4942         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4943         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4944         16  CF-CO-OPTION-START-DATE        PIC XX.
  4945         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4946           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4947                                                      '3' '4'.
  4948           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4949           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4950           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4951           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4952           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4953           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4954
  4955         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4956
  4957         16  CF-PAYMENT-APPROVAL-LEVELS.
  4958             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  91
* EL131.cbl
  4959             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4960             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4961             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4962             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4963             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4964
  4965         16  CF-END-USER-REPORTING-USER     PIC X.
  4966             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4967             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4968
  4969         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4970             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4971             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4972
  4973         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4974
  4975         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4976         16  FILLER                         PIC X.
  4977
  4978         16  CF-CREDIT-ARCHIVE-CNTL.
  4979             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4980             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4981             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4982
  4983         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4984
  4985         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4986             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4987             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4988
  4989         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4990             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4991             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4992
  4993         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4994
  4995         16  CF-CO-ACH-ID-CODE              PIC  X.
  4996             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4997             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4998             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4999         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5000         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5001         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5002         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5003         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5004         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5005         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5006         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5007         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5008                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5009         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5010                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5011
  5012         16  CF-CO-OVER-SHORT.
  5013             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5014             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5015
  5016*         16  FILLER                         PIC X(102).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  92
* EL131.cbl
  5017         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5018             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5019             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5020
  5021         16  CF-AH-APPROVAL-DAYS.
  5022             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5023             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5024             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5025             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5026
  5027         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5028
  5029         16  CF-APPROV-LEV-5.
  5030             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5031             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5032             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5033
  5034         16  FILLER                         PIC X(68).
  5035****************************************************************
  5036*             PROCESSOR/USER RECORD                            *
  5037****************************************************************
  5038
  5039     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5040         16  CF-PROCESSOR-NAME              PIC X(30).
  5041         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5042         16  CF-PROCESSOR-TITLE             PIC X(26).
  5043         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5044                 88  MESSAGE-YES                VALUE 'Y'.
  5045                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5046
  5047*****************************************************
  5048****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5049****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5050****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5051****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5052*****************************************************
  5053
  5054         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5055             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5056             20  CF-APPLICATION-FORCE       PIC X.
  5057             20  CF-INDIVIDUAL-APP.
  5058                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5059                     28  CF-BROWSE-APP      PIC X.
  5060                     28  CF-UPDATE-APP      PIC X.
  5061
  5062         16  CF-CURRENT-TERM-ON             PIC X(4).
  5063         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5064             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5065             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5066             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5067             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5068             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5069             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5070             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5071         16  CF-PROCESSOR-CARRIER           PIC X.
  5072             88  NO-CARRIER-SECURITY            VALUE ' '.
  5073         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5074             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  93
* EL131.cbl
  5075         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5076             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5077         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5078             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5079
  5080         16  CF-PROC-SYS-ACCESS-SW.
  5081             20  CF-PROC-CREDIT-CLAIMS-SW.
  5082                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5083                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5084                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5085                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5086             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5087                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5088                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5089             20  CF-PROC-LIFE-GNRLDGR-SW.
  5090                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5091                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5092                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5093                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5094             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5095                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5096                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5097         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5098             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5099             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5100         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5101
  5102         16  CF-APPROVAL-LEVEL                  PIC X.
  5103             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5104             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5105             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5106             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5107             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5108
  5109         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5110
  5111         16  CF-LANGUAGE-TYPE                   PIC X.
  5112             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5113             88  CF-LANG-IS-FR                      VALUE 'F'.
  5114
  5115         16  CF-CSR-IND                         PIC X.
  5116         16  FILLER                             PIC X(239).
  5117
  5118****************************************************************
  5119*             PROCESSOR/REMINDERS RECORD                       *
  5120****************************************************************
  5121
  5122     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5123         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5124             20  CF-START-REMIND-DT         PIC XX.
  5125             20  CF-END-REMIND-DT           PIC XX.
  5126             20  CF-REMINDER-TEXT           PIC X(50).
  5127         16  FILLER                         PIC X(296).
  5128
  5129
  5130****************************************************************
  5131*             STATE MASTER RECORD                              *
  5132****************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  94
* EL131.cbl
  5133
  5134     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5135         16  CF-STATE-ABBREVIATION          PIC XX.
  5136         16  CF-STATE-NAME                  PIC X(25).
  5137         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5138         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5139             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5140             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5141             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5142             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5143                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5144                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5145             20  CF-ST-PREM-REJECT-SW       PIC X.
  5146                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5147                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5148             20  CF-ST-REF-REJECT-SW        PIC X.
  5149                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5150                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5151         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5152         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5153         16  CF-ST-REFUND-RULES.
  5154             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5155             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5156             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5157         16  CF-ST-FST-PMT-EXTENSION.
  5158             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5159             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5160                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5161                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5162                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5163                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5164         16  CF-ST-STATE-CALL.
  5165             20  CF-ST-CALL-UNEARNED        PIC X.
  5166             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5167             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5168         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5169             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5170             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5171         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5172         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5173         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5174         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5175         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5176         16  FILLER                         PIC X.
  5177         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5178             20  CF-ST-BENEFIT-CD           PIC XX.
  5179             20  CF-ST-BENEFIT-KIND         PIC X.
  5180                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5181                 88  CF-ST-AH-KIND              VALUE 'A'.
  5182             20  CF-ST-REM-TERM-CALC        PIC X.
  5183                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5184                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5185                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5186                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5187                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5188                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5189                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5190                 88  ST-EARN-AFTER-16TH         VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  95
* EL131.cbl
  5191
  5192             20  CF-ST-REFUND-CALC          PIC X.
  5193                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5194                 88  ST-REFD-BY-R78             VALUE '1'.
  5195                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5196                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5197                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5198                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5199                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5200                 88  ST-REFD-UTAH               VALUE '7'.
  5201                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5202                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5203                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5204
  5205             20  CF-ST-EARNING-CALC         PIC X.
  5206                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5207                 88  ST-EARN-BY-R78             VALUE '1'.
  5208                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5209                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5210                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5211                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5212                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5213                 88  ST-EARN-MEAN               VALUE '8'.
  5214                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5215
  5216             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5217                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5218                 88  ST-OVRD-BY-R78             VALUE '1'.
  5219                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5220                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5221                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5222                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5223                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5224                 88  ST-OVRD-MEAN               VALUE '8'.
  5225                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5226             20  FILLER                     PIC X.
  5227
  5228         16  CF-ST-COMMISSION-CAPS.
  5229             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5230             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5231             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5232             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5233         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5234                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5235
  5236         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5237
  5238         16  CF-ST-STATUTORY-INTEREST.
  5239             20  CF-ST-STAT-DATE-FROM       PIC X.
  5240                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5241                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5242             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5243             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5244             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5245             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5246             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5247
  5248         16  CF-ST-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  96
* EL131.cbl
  5249             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5250             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5251
  5252         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5253
  5254         16  CF-ST-RT-CALC                  PIC X.
  5255
  5256         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5257         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5258         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5259         16  CF-ST-RF-LR-CALC               PIC X.
  5260         16  CF-ST-RF-LL-CALC               PIC X.
  5261         16  CF-ST-RF-LN-CALC               PIC X.
  5262         16  CF-ST-RF-AH-CALC               PIC X.
  5263         16  CF-ST-RF-CP-CALC               PIC X.
  5264*        16  FILLER                         PIC X(206).
  5265*CIDMOD         16  FILLER                         PIC X(192).
  5266         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5267             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5268         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5269         16  CF-ST-VFY-2ND-BENE             PIC X.
  5270         16  CF-ST-CAUSAL-STATE             PIC X.
  5271         16  FILLER                         PIC X(185).
  5272
  5273****************************************************************
  5274*             BENEFIT MASTER RECORD                            *
  5275****************************************************************
  5276
  5277     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5278         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5279             20  CF-BENEFIT-CODE            PIC XX.
  5280             20  CF-BENEFIT-NUMERIC  REDEFINES
  5281                 CF-BENEFIT-CODE            PIC XX.
  5282             20  CF-BENEFIT-ALPHA           PIC XXX.
  5283             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5284             20  CF-BENEFIT-COMMENT         PIC X(10).
  5285
  5286             20  CF-LF-COVERAGE-TYPE        PIC X.
  5287                 88  CF-REDUCING                VALUE 'R'.
  5288                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5289
  5290             20  CF-SPECIAL-CALC-CD         PIC X.
  5291                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5292                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5293                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5294                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5295                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5296                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5297                 88  CF-FARM-PLAN               VALUE 'F'.
  5298                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5299                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5300                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5301                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5302                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5303                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5304                 88  CF-PRUDENTIAL              VALUE 'P'.
  5305                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5306                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  97
* EL131.cbl
  5307                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5308                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5309                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5310                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5311
  5312             20  CF-JOINT-INDICATOR         PIC X.
  5313                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5314
  5315*            20  FILLER                     PIC X(12).
  5316             20  FILLER                     PIC X(11).
  5317             20  CF-BENEFIT-CATEGORY        PIC X.
  5318             20  CF-LOAN-TYPE               PIC X(8).
  5319
  5320             20  CF-CO-REM-TERM-CALC        PIC X.
  5321                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5322                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5323                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5324                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5325                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5326
  5327             20  CF-CO-EARNINGS-CALC        PIC X.
  5328                 88  CO-EARN-BY-R78             VALUE '1'.
  5329                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5330                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5331                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5332                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5333                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5334                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5335                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5336
  5337             20  CF-CO-REFUND-CALC          PIC X.
  5338                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5339                 88  CO-REFD-BY-R78             VALUE '1'.
  5340                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5341                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5342                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5343                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5344                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5345                 88  CO-REFD-MEAN               VALUE '8'.
  5346                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5347                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5348                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5349
  5350             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5351                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5352                 88  CO-OVRD-BY-R78             VALUE '1'.
  5353                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5354                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5355                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5356                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5357                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5358                 88  CO-OVRD-MEAN               VALUE '8'.
  5359                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5360
  5361             20  CF-CO-BEN-I-G-CD           PIC X.
  5362                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5363                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5364                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  98
* EL131.cbl
  5365
  5366         16  FILLER                         PIC X(304).
  5367
  5368
  5369****************************************************************
  5370*             CARRIER MASTER RECORD                            *
  5371****************************************************************
  5372
  5373     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5374         16  CF-ADDRESS-DATA.
  5375             20  CF-MAIL-TO-NAME            PIC X(30).
  5376             20  CF-IN-CARE-OF              PIC X(30).
  5377             20  CF-ADDRESS-LINE-1          PIC X(30).
  5378             20  CF-ADDRESS-LINE-2          PIC X(30).
  5379             20  CF-CITY-STATE              PIC X(30).
  5380             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5381             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5382
  5383         16  CF-CLAIM-NO-CONTROL.
  5384             20  CF-CLAIM-NO-METHOD         PIC X.
  5385                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5386                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5387                 88  CLAIM-NO-SEQ               VALUE '3'.
  5388                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5389             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5390                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5391                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5392                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5393
  5394         16  CF-CHECK-NO-CONTROL.
  5395             20  CF-CHECK-NO-METHOD         PIC X.
  5396                 88  CHECK-NO-MANUAL            VALUE '1'.
  5397                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5398                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5399                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5400             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5401                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5402
  5403         16  CF-DOMICILE-STATE              PIC XX.
  5404
  5405         16  CF-EXPENSE-CONTROLS.
  5406             20  CF-EXPENSE-METHOD          PIC X.
  5407                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5408                 88  DOLLARS-PER-PMT            VALUE '2'.
  5409                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5410                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5411             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5412             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5413
  5414         16  CF-CORRESPONDENCE-CONTROL.
  5415             20  CF-LETTER-RESEND-OPT       PIC X.
  5416                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5417                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5418             20  FILLER                     PIC X(4).
  5419
  5420         16  CF-RESERVE-CONTROLS.
  5421             20  CF-MANUAL-SW               PIC X.
  5422                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page  99
* EL131.cbl
  5423             20  CF-FUTURE-SW               PIC X.
  5424                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5425             20  CF-PTC-SW                  PIC X.
  5426                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5427             20  CF-IBNR-SW                 PIC X.
  5428                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5429             20  CF-PTC-LF-SW               PIC X.
  5430                 88  CF-LF-PTC-USED             VALUE '1'.
  5431             20  CF-CDT-ACCESS-METHOD       PIC X.
  5432                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5433                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5434                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5435             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5436
  5437         16  CF-CLAIM-CALC-METHOD           PIC X.
  5438             88  360-PLUS-MONTHS                VALUE '1'.
  5439             88  365-PLUS-MONTHS                VALUE '2'.
  5440             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5441             88  360-DAILY                      VALUE '4'.
  5442             88  365-DAILY                      VALUE '5'.
  5443
  5444         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5445         16  FILLER                         PIC X(11).
  5446
  5447         16  CF-LIMIT-AMOUNTS.
  5448             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5449             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5450             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5451             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5452             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5453             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5454             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5455             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5456             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5457             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5458
  5459         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5460         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5461         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5462
  5463         16  CF-ZIP-CODE.
  5464             20  CF-ZIP-PRIME.
  5465                 24  CF-ZIP-1ST             PIC X.
  5466                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5467                 24  FILLER                 PIC X(4).
  5468             20  CF-ZIP-PLUS4               PIC X(4).
  5469         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5470             20  CF-CAN-POSTAL-1            PIC XXX.
  5471             20  CF-CAN-POSTAL-2            PIC XXX.
  5472             20  FILLER                     PIC XXX.
  5473
  5474         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5475         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5476         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5477
  5478         16  CF-RATING-SWITCH               PIC X.
  5479             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5480             88  CF-NO-RATING                   VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 100
* EL131.cbl
  5481
  5482         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5483
  5484         16  CF-CARRIER-OVER-SHORT.
  5485             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5486             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5487
  5488         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5489         16  CF-SECPAY-SWITCH               PIC X.
  5490             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5491             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5492         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5493         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5494         16  FILLER                         PIC X(444).
  5495*        16  FILLER                         PIC X(452).
  5496
  5497
  5498****************************************************************
  5499*             MORTALITY MASTER RECORD                          *
  5500****************************************************************
  5501
  5502     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5503         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5504                                INDEXED BY CF-MORT-NDX.
  5505             20  CF-MORT-TABLE              PIC X(5).
  5506             20  CF-MORT-TABLE-TYPE         PIC X.
  5507                 88  CF-MORT-JOINT              VALUE 'J'.
  5508                 88  CF-MORT-SINGLE             VALUE 'S'.
  5509                 88  CF-MORT-COMBINED           VALUE 'C'.
  5510                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5511                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5512             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5513             20  CF-MORT-AGE-METHOD         PIC XX.
  5514                 88  CF-AGE-LAST                VALUE 'AL'.
  5515                 88  CF-AGE-NEAR                VALUE 'AN'.
  5516             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5517             20  CF-MORT-ADJUSTMENT-DIRECTION
  5518                                            PIC X.
  5519                 88  CF-MINUS                   VALUE '-'.
  5520                 88  CF-PLUS                    VALUE '+'.
  5521             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5522             20  CF-MORT-JOINT-CODE         PIC X.
  5523                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5524             20  CF-MORT-PC-Q               PIC X.
  5525                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5526             20  CF-MORT-TABLE-CODE         PIC X(4).
  5527             20  CF-MORT-COMMENTS           PIC X(15).
  5528             20  FILLER                     PIC X(14).
  5529
  5530         16  FILLER                         PIC X(251).
  5531
  5532
  5533****************************************************************
  5534*             BUSSINESS TYPE MASTER RECORD                     *
  5535****************************************************************
  5536
  5537     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5538* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 101
* EL131.cbl
  5539* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5540* AND RECORD 05 IS TYPES 81-99
  5541         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5542             20  CF-BUSINESS-TITLE          PIC  X(19).
  5543             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5544                                            PIC S9V9(4) COMP-3.
  5545             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5546             20  FILLER                     PIC  X.
  5547         16  FILLER                         PIC  X(248).
  5548
  5549
  5550****************************************************************
  5551*             TERMINAL MASTER RECORD                           *
  5552****************************************************************
  5553
  5554     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5555
  5556         16  CF-COMPANY-TERMINALS.
  5557             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5558                                  PIC X(4).
  5559         16  FILLER               PIC X(248).
  5560
  5561
  5562****************************************************************
  5563*             LIFE EDIT MASTER RECORD                          *
  5564****************************************************************
  5565
  5566     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5567         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5568             20  CF-LIFE-CODE-IN            PIC XX.
  5569             20  CF-LIFE-CODE-OUT           PIC XX.
  5570         16  FILLER                         PIC X(248).
  5571
  5572
  5573****************************************************************
  5574*             AH EDIT MASTER RECORD                            *
  5575****************************************************************
  5576
  5577     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5578         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5579             20  CF-AH-CODE-IN              PIC XXX.
  5580             20  CF-AH-CODE-OUT             PIC XX.
  5581         16  FILLER                         PIC X(248).
  5582
  5583
  5584****************************************************************
  5585*             CREDIBILITY TABLES                               *
  5586****************************************************************
  5587
  5588     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5589         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5590                             INDEXED BY CF-CRDB-NDX.
  5591             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5592             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5593             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5594         16  FILLER                         PIC  X(332).
  5595
  5596
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 102
* EL131.cbl
  5597****************************************************************
  5598*             REPORT CUSTOMIZATION RECORD                      *
  5599****************************************************************
  5600
  5601     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5602         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5603             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5604             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5605             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5606**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5607****       A T-TRANSFER.                                   ****
  5608             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5609
  5610         16  FILLER                         PIC XX.
  5611
  5612         16  CF-CARRIER-CNTL-OPT.
  5613             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5614                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5615                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5616             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5617                                            PIC X.
  5618         16  CF-GROUP-CNTL-OPT.
  5619             20  CF-GROUP-OPT-SEQ           PIC 9.
  5620                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5621                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5622             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5623                                            PIC X(6).
  5624         16  CF-STATE-CNTL-OPT.
  5625             20  CF-STATE-OPT-SEQ           PIC 9.
  5626                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5627                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5628             20  CF-STATE-SELECT OCCURS 3 TIMES
  5629                                            PIC XX.
  5630         16  CF-ACCOUNT-CNTL-OPT.
  5631             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5632                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5633                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5634             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5635                                            PIC X(10).
  5636         16  CF-BUS-TYP-CNTL-OPT.
  5637             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5638                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5639                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5640             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5641                                            PIC XX.
  5642         16  CF-LF-TYP-CNTL-OPT.
  5643             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5644                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5645                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5646             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5647                                            PIC XX.
  5648         16  CF-AH-TYP-CNTL-OPT.
  5649             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5650                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5651                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5652             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5653                                            PIC XX.
  5654         16  CF-REPTCD1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 103
* EL131.cbl
  5655             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5656                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5657                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5658             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5659                                            PIC X(10).
  5660         16  CF-REPTCD2-CNTL-OPT.
  5661             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5662                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5663                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5664             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5665                                            PIC X(10).
  5666         16  CF-USER1-CNTL-OPT.
  5667             20  CF-USER1-OPT-SEQ           PIC 9.
  5668                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5669                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5670             20  CF-USER1-SELECT OCCURS 3 TIMES
  5671                                            PIC X(10).
  5672         16  CF-USER2-CNTL-OPT.
  5673             20  CF-USER2-OPT-SEQ           PIC 9.
  5674                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5675                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5676             20  CF-USER2-SELECT OCCURS 3 TIMES
  5677                                            PIC X(10).
  5678         16  CF-USER3-CNTL-OPT.
  5679             20  CF-USER3-OPT-SEQ           PIC 9.
  5680                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5681                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5682             20  CF-USER3-SELECT OCCURS 3 TIMES
  5683                                            PIC X(10).
  5684         16  CF-USER4-CNTL-OPT.
  5685             20  CF-USER4-OPT-SEQ           PIC 9.
  5686                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5687                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5688             20  CF-USER4-SELECT OCCURS 3 TIMES
  5689                                            PIC X(10).
  5690         16  CF-USER5-CNTL-OPT.
  5691             20  CF-USER5-OPT-SEQ           PIC 9.
  5692                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5693                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5694             20  CF-USER5-SELECT OCCURS 3 TIMES
  5695                                            PIC X(10).
  5696         16  CF-REINS-CNTL-OPT.
  5697             20  CF-REINS-OPT-SEQ           PIC 9.
  5698                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5699                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5700             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5701                 24  CF-REINS-PRIME         PIC XXX.
  5702                 24  CF-REINS-SUB           PIC XXX.
  5703
  5704         16  CF-AGENT-CNTL-OPT.
  5705             20  CF-AGENT-OPT-SEQ           PIC 9.
  5706                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5707                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5708             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5709                                            PIC X(10).
  5710
  5711         16  FILLER                         PIC X(43).
  5712
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 104
* EL131.cbl
  5713         16  CF-LOSS-RATIO-SELECT.
  5714             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5715             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5716         16  CF-ENTRY-DATE-SELECT.
  5717             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5718             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5719         16  CF-EFFECTIVE-DATE-SELECT.
  5720             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5721             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5722
  5723         16  CF-EXCEPTION-LIST-IND          PIC X.
  5724             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5725
  5726         16  FILLER                         PIC X(318).
  5727
  5728****************************************************************
  5729*                  EXCEPTION REPORTING RECORD                  *
  5730****************************************************************
  5731
  5732     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5733         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5734             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5735
  5736         16  CF-COMBINED-LIFE-AH-OPT.
  5737             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5738             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5739             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5740             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5741
  5742         16  CF-LIFE-OPT.
  5743             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5744             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5745             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5746             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5747             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5748             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5749             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5750             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5751             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5752             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5753
  5754         16  CF-AH-OPT.
  5755             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5756             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5757             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5758             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5759             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5760             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5761             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5762             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5763             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5764             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5765
  5766         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5767             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5768             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5769             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5770
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 105
* EL131.cbl
  5771         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5772
  5773         16  FILLER                         PIC X(673).
  5774
  5775
  5776****************************************************************
  5777*             MORTGAGE SYSTEM PLAN RECORD                      *
  5778****************************************************************
  5779
  5780     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5781         16  CF-PLAN-TYPE                   PIC X.
  5782             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5783             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5784             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5785         16  CF-PLAN-ABBREV                 PIC XXX.
  5786         16  CF-PLAN-DESCRIPT               PIC X(10).
  5787         16  CF-PLAN-NOTES                  PIC X(20).
  5788         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5789         16  CF-PLAN-UNDERWRITING.
  5790             20  CF-PLAN-TERM-DATA.
  5791                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5792                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5793             20  CF-PLAN-AGE-DATA.
  5794                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5795                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5796                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5797             20  CF-PLAN-BENEFIT-DATA.
  5798                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5799                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5800                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5801                                            PIC S9(7)V99  COMP-3.
  5802         16  CF-PLAN-POLICY-FORMS.
  5803             20  CF-POLICY-FORM             PIC X(12).
  5804             20  CF-MASTER-APPLICATION      PIC X(12).
  5805             20  CF-MASTER-POLICY           PIC X(12).
  5806         16  CF-PLAN-RATING.
  5807             20  CF-RATE-CODE               PIC X(5).
  5808             20  CF-SEX-RATING              PIC X.
  5809                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5810                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5811             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5812             20  CF-SUB-STD-TYPE            PIC X.
  5813                 88  CF-PCT-OF-PREM            VALUE '1'.
  5814                 88  CF-PCT-OF-BENE            VALUE '2'.
  5815         16  CF-PLAN-PREM-TOLERANCES.
  5816             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5817             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5818         16  CF-PLAN-PYMT-TOLERANCES.
  5819             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5820             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5821         16  CF-PLAN-MISC-DATA.
  5822             20  FILLER                     PIC X.
  5823             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5824             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5825         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5826         16  CF-PLAN-IND-GRP                PIC X.
  5827             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5828                                                     '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 106
* EL131.cbl
  5829             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5830                                                     '2'.
  5831         16  CF-MIB-SEARCH-SW               PIC X.
  5832             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5833             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5834             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5835             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5836         16  CF-ALPHA-SEARCH-SW             PIC X.
  5837             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5838             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5839             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5840             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5841             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5842             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5843             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5844             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5845             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5846             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5847                                                     'A' 'B' 'C'
  5848                                                     'X' 'Y' 'Z'.
  5849         16  CF-EFF-DT-RULE-SW              PIC X.
  5850             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5851             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5852             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5853             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5854             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5855         16  FILLER                         PIC X(4).
  5856         16  CF-HEALTH-QUESTIONS            PIC X.
  5857             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5858         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5859         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5860         16  CF-PLAN-SNGL-JNT               PIC X.
  5861             88  CF-COMBINED-PLAN              VALUE 'C'.
  5862             88  CF-JNT-PLAN                   VALUE 'J'.
  5863             88  CF-SNGL-PLAN                  VALUE 'S'.
  5864         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5865         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5866         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5867         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5868         16  CF-RERATE-CNTL                 PIC  X.
  5869             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5870             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5871             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5872             88  CF-AUTO-RECALC                 VALUE '4'.
  5873         16  CF-BENEFIT-TYPE                PIC  X.
  5874             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5875             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5876         16  CF-POLICY-FEE                  PIC S999V99
  5877                                                    COMP-3.
  5878         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5879         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5880         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5881         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5882         16  FILLER                         PIC  X(32).
  5883         16  CF-TERMINATION-FORM            PIC  X(04).
  5884         16  FILLER                         PIC  X(08).
  5885         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5886                                                       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 107
* EL131.cbl
  5887         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5888         16  CF-ISSUE-LETTER                PIC  X(4).
  5889         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5890         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5891             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5892             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5893         16  CF-MP-REFUND-CALC              PIC X.
  5894             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5895             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5896             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5897             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5898             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5899             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5900             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5901             88  CF-MP-REFD-MEAN                VALUE '8'.
  5902         16  CF-ALT-RATE-CODE               PIC  X(5).
  5903
  5904
  5905         16  FILLER                         PIC X(498).
  5906****************************************************************
  5907*             MORTGAGE COMPANY MASTER RECORD                   *
  5908****************************************************************
  5909
  5910     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5911         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5912         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5913             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5914             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5915             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5916             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5917             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5918
  5919         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5920         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5921         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5922         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5923         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5924
  5925         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5926             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5927         16  CF-MP-RECON-USE-IND            PIC X(1).
  5928             88  CF-MP-USE-RECON             VALUE 'Y'.
  5929         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5930             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5931         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5932             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5933             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5934         16  FILLER                         PIC X(1).
  5935         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5936             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5937         16  CF-MORTG-MIB-VERSION           PIC X.
  5938             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5939             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5940             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5941         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5942             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5943                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5944             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 108
* EL131.cbl
  5945                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5946             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5947                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5948             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5949                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5950             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5951                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5952             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5953                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5954         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5955         16  FILLER                         PIC X(7).
  5956         16  CF-MORTG-DESTINATION-SYMBOL.
  5957             20  CF-MORTG-MIB-COMM          PIC X(5).
  5958             20  CF-MORTG-MIB-TERM          PIC X(5).
  5959         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5960             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5961         16  FILLER                         PIC X(03).
  5962         16  CF-MP-CHECK-NO-CONTROL.
  5963             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5964                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5965                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5966                                                ' ' LOW-VALUES.
  5967                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5968                                               VALUE '3'.
  5969         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5970         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5971         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5972             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5973                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5974             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5975                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5976             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5977                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5978             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5979                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5980             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5981                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5982             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5983                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5984         16  CF-MORTG-BILLING-AREA.
  5985             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5986                                            PIC X.
  5987         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5988         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5989         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5990         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5991             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5992             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5993         16  FILLER                         PIC X.
  5994         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5995             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5996             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5997         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5998         16  FILLER                         PIC X(8).
  5999         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6000         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6001         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6002         16  CF-ACH-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 109
* EL131.cbl
  6003             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6004                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6005                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6006                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6007             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6008         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6009             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6010         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6011             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6012             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6013         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6014         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6015         16  FILLER                         PIC X(536).
  6016
  6017****************************************************************
  6018*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6019****************************************************************
  6020
  6021     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6022         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6023             20  CF-FEMALE-HEIGHT.
  6024                 24  CF-FEMALE-FT           PIC 99.
  6025                 24  CF-FEMALE-IN           PIC 99.
  6026             20  CF-FEMALE-MIN-WT           PIC 999.
  6027             20  CF-FEMALE-MAX-WT           PIC 999.
  6028         16  FILLER                         PIC X(428).
  6029
  6030     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6031         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6032             20  CF-MALE-HEIGHT.
  6033                 24  CF-MALE-FT             PIC 99.
  6034                 24  CF-MALE-IN             PIC 99.
  6035             20  CF-MALE-MIN-WT             PIC 999.
  6036             20  CF-MALE-MAX-WT             PIC 999.
  6037         16  FILLER                         PIC X(428).
  6038******************************************************************
  6039*             AUTOMATIC ACTIVITY RECORD                          *
  6040******************************************************************
  6041     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6042         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6043             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6044             20  CF-SYS-LETTER-ID           PIC X(04).
  6045             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6046             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6047             20  CF-SYS-RESET-SW            PIC X(01).
  6048             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6049             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6050
  6051         16  FILLER                         PIC X(50).
  6052
  6053         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6054             20  CF-USER-ACTIVE-SW          PIC X(01).
  6055             20  CF-USER-LETTER-ID          PIC X(04).
  6056             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6057             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6058             20  CF-USER-RESET-SW           PIC X(01).
  6059             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6060             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 110
* EL131.cbl
  6061             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6062
  6063         16  FILLER                         PIC X(246).
  6064
  6065*                                COPY ELCACTQ.
  6066******************************************************************
  6067*                                                                *
  6068*                            ELCACTQ.                            *
  6069*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6070*                            VMOD=2.004                          *
  6071*                                                                *
  6072*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6073*                                                                *
  6074*   FILE TYPE = VSAM,KSDS                                        *
  6075*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6076*                                                                *
  6077*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6078*       ALTERNATE INDEX = NONE                                   *
  6079*                                                                *
  6080*   LOG = YES                                                    *
  6081*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6082*                                                                *
  6083*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6084******************************************************************
  6085
  6086 01  ACTIVITY-QUE.
  6087     12  AQ-RECORD-ID                PIC XX.
  6088         88  VALID-AQ-ID                VALUE 'AQ'.
  6089
  6090     12  AQ-CONTROL-PRIMARY.
  6091         16  AQ-COMPANY-CD           PIC X.
  6092         16  AQ-CARRIER              PIC X.
  6093         16  AQ-CLAIM-NO             PIC X(7).
  6094         16  AQ-CERT-NO.
  6095             20  AQ-CERT-PRIME       PIC X(10).
  6096             20  AQ-CERT-SFX         PIC X.
  6097
  6098     12  AQ-PENDING-ACTIVITY-FLAGS.
  6099         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6100         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6101             88  PENDING-PAYMENTS       VALUE '1'.
  6102         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6103             88  PENDING-FULL-PRINT     VALUE '1'.
  6104             88  PENDING-PART-PRINT     VALUE '2'.
  6105         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6106             88  PENDING-LETTERS        VALUE '1'.
  6107         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6108             88  PENDING-RESTORE        VALUE 'C'.
  6109             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6110
  6111     12  FILLER                      PIC X(20).
  6112
  6113     12  AQ-RESEND-DATE              PIC XX.
  6114     12  AQ-FOLLOWUP-DATE            PIC XX.
  6115     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6116     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6117     12  AQ-AUTO-LETTER              PIC X(4).
  6118     12  FILLER                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 111
* EL131.cbl
  6119     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6120*****************************************************************
  6121
  6122*                                COPY ERCACCT.
  6123******************************************************************
  6124*                                                                *
  6125*                                                                *
  6126*                            ERCACCT                             *
  6127*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6128*                            VMOD=2.031                          *
  6129*                                                                *
  6130*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6131*                                                                *
  6132*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6133*   VSAM ACCOUNT MASTER FILES.                                   *
  6134*                                                                *
  6135*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6136*                                                                *
  6137*   FILE TYPE = VSAM,KSDS                                        *
  6138*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6139*                                                                *
  6140*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6141*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6142*                                                                *
  6143*   LOG = NO                                                     *
  6144*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6145*                                                                *
  6146*                                                                *
  6147******************************************************************
  6148*                   C H A N G E   L O G
  6149*
  6150* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6151*-----------------------------------------------------------------
  6152*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6153* EFFECTIVE    NUMBER
  6154*-----------------------------------------------------------------
  6155* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6156* 092705    2005050300006  PEMA  ADD SPP LEASES
  6157* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6158* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6159* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6160* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6161* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6162******************************************************************
  6163
  6164 01  ACCOUNT-MASTER.
  6165     12  AM-RECORD-ID                      PIC XX.
  6166         88  VALID-AM-ID                      VALUE 'AM'.
  6167
  6168     12  AM-CONTROL-PRIMARY.
  6169         16  AM-COMPANY-CD                 PIC X.
  6170         16  AM-MSTR-CNTRL.
  6171             20  AM-CONTROL-A.
  6172                 24  AM-CARRIER            PIC X.
  6173                 24  AM-GROUPING.
  6174                     28 AM-GROUPING-PREFIX PIC XXX.
  6175                     28 AM-GROUPING-PRIME  PIC XXX.
  6176                 24  AM-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 112
* EL131.cbl
  6177                 24  AM-ACCOUNT.
  6178                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6179                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6180             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6181                                           PIC X(19).
  6182             20  AM-CNTRL-B.
  6183                 24  AM-EXPIRATION-DT      PIC XX.
  6184                 24  FILLER                PIC X(4).
  6185             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6186                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6187
  6188     12  AM-CONTROL-BY-VAR-GRP.
  6189         16  AM-COMPANY-CD-A1              PIC X.
  6190         16  AM-VG-CARRIER                 PIC X.
  6191         16  AM-VG-GROUPING                PIC X(6).
  6192         16  AM-VG-STATE                   PIC XX.
  6193         16  AM-VG-ACCOUNT                 PIC X(10).
  6194         16  AM-VG-DATE.
  6195             20  AM-VG-EXPIRATION-DT       PIC XX.
  6196             20  FILLER                    PIC X(4).
  6197         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6198                                           PIC 9(11)      COMP-3.
  6199     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6200         16  FILLER                        PIC X(10).
  6201         16  AM-VG-KEY3.
  6202             20  AM-VG3-ACCOUNT            PIC X(10).
  6203             20  AM-VG3-EXP-DT             PIC XX.
  6204         16  FILLER                        PIC X(4).
  6205     12  AM-MAINT-INFORMATION.
  6206         16  AM-LAST-MAINT-DT              PIC XX.
  6207         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6208         16  AM-LAST-MAINT-USER            PIC X(4).
  6209         16  FILLER                        PIC XX.
  6210
  6211     12  AM-EFFECTIVE-DT                   PIC XX.
  6212     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6213
  6214     12  AM-PREV-DATES  COMP-3.
  6215         16  AM-PREV-EXP-DT                PIC 9(11).
  6216         16  AM-PREV-EFF-DT                PIC 9(11).
  6217
  6218     12  AM-REPORT-CODE-1                  PIC X(10).
  6219     12  AM-REPORT-CODE-2                  PIC X(10).
  6220
  6221     12  AM-CITY-CODE                      PIC X(4).
  6222     12  AM-COUNTY-PARISH                  PIC X(6).
  6223
  6224     12  AM-NAME                           PIC X(30).
  6225     12  AM-PERSON                         PIC X(30).
  6226     12  AM-ADDRS                          PIC X(30).
  6227     12  AM-CITY.
  6228         16  AM-ADDR-CITY                  PIC X(28).
  6229         16  AM-ADDR-STATE                 PIC XX.
  6230     12  AM-ZIP.
  6231         16  AM-ZIP-PRIME.
  6232             20  AM-ZIP-PRI-1ST            PIC X.
  6233                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6234             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 113
* EL131.cbl
  6235         16  AM-ZIP-PLUS4                  PIC X(4).
  6236     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6237         16  AM-CAN-POSTAL-1               PIC XXX.
  6238         16  AM-CAN-POSTAL-2               PIC XXX.
  6239         16  FILLER                        PIC XXX.
  6240     12  AM-TEL-NO.
  6241         16  AM-AREA-CODE                  PIC 999.
  6242         16  AM-TEL-PRE                    PIC 999.
  6243         16  AM-TEL-NBR                    PIC 9(4).
  6244     12  AM-TEL-LOC                        PIC X.
  6245         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6246         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6247
  6248     12  AM-COMM-STRUCTURE.
  6249         16  AM-DEFN-1.
  6250             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6251                 24  AM-AGT.
  6252                     28  AM-AGT-PREFIX     PIC X(4).
  6253                     28  AM-AGT-PRIME      PIC X(6).
  6254                 24  AM-COM-TYP            PIC X.
  6255                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6256                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6257                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6258                 24  AM-RECALC-LV-INDIC    PIC X.
  6259                 24  AM-RETRO-LV-INDIC     PIC X.
  6260                 24  AM-GL-CODES           PIC X.
  6261                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6262                 24  FILLER                PIC X(01).
  6263         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6264             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6265                 24  FILLER                PIC X(11).
  6266                 24  AM-L-COMA             PIC XXX.
  6267                 24  AM-J-COMA             PIC XXX.
  6268                 24  AM-A-COMA             PIC XXX.
  6269                 24  FILLER                PIC X(6).
  6270
  6271     12  AM-COMM-CHANGE-STATUS             PIC X.
  6272         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6273
  6274     12  AM-CSR-CODE                       PIC X(4).
  6275
  6276     12  AM-BILLING-STATUS                 PIC X.
  6277         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6278         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6279     12  AM-AUTO-REFUND-SW                 PIC X.
  6280         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6281         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6282     12  AM-GPCD                           PIC 99.
  6283     12  AM-IG                             PIC X.
  6284         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6285         88  AM-HAS-GROUP                     VALUE '2'.
  6286     12  AM-STATUS                         PIC X.
  6287         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6288         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6289         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6290         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6291         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6292         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 114
* EL131.cbl
  6293     12  AM-REMIT-TO                       PIC 99.
  6294     12  AM-ID-NO                          PIC X(11).
  6295
  6296     12  AM-CAL-TABLE                      PIC XX.
  6297     12  AM-LF-DEVIATION                   PIC XXX.
  6298     12  AM-AH-DEVIATION                   PIC XXX.
  6299     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6300     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6301     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6302     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6303     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6304     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6305
  6306     12  AM-USER-FIELDS.
  6307         16  AM-FLD-1                      PIC XX.
  6308         16  AM-FLD-2                      PIC XX.
  6309         16  AM-FLD-3                      PIC XX.
  6310         16  AM-FLD-4                      PIC XX.
  6311         16  AM-FLD-5                      PIC XX.
  6312
  6313     12  AM-1ST-PROD-DATE.
  6314         16  AM-1ST-PROD-YR                PIC XX.
  6315         16  AM-1ST-PROD-MO                PIC XX.
  6316         16  AM-1ST-PROD-DA                PIC XX.
  6317     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6318     12  AM-CERTS-PURGED-DATE.
  6319         16  AM-PUR-YR                     PIC XX.
  6320         16  AM-PUR-MO                     PIC XX.
  6321         16  AM-PUR-DA                     PIC XX.
  6322     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6323     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6324     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6325     12  AM-INACTIVE-DATE.
  6326         16  AM-INA-MO                     PIC 99.
  6327         16  AM-INA-DA                     PIC 99.
  6328         16  AM-INA-YR                     PIC 99.
  6329     12  AM-AR-HI-CERT-DATE                PIC XX.
  6330
  6331     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6332     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6333
  6334     12  AM-OB-PAYMENT-MODE                PIC X.
  6335         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6336         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6337         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6338         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6339
  6340     12  AM-AH-ONLY-INDICATOR              PIC X.
  6341         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6342         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6343
  6344     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6345
  6346     12  AM-OVER-SHORT.
  6347         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6348         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6349
  6350     12  AM-DCC-PRODUCT-CODE               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 115
* EL131.cbl
  6351     12  AM-DCC-CLP-STATE                  PIC XX.
  6352
  6353     12  AM-RECALC-COMM                    PIC X.
  6354     12  AM-RECALC-REIN                    PIC X.
  6355
  6356     12  AM-REI-TABLE                      PIC XXX.
  6357     12  AM-REI-ET-LF                      PIC X.
  6358     12  AM-REI-ET-AH                      PIC X.
  6359     12  AM-REI-PE-LF                      PIC X.
  6360     12  AM-REI-PE-AH                      PIC X.
  6361     12  AM-REI-PRT-ST                     PIC X.
  6362     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6363     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6364     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6365     12  AM-REI-GROUP-A                    PIC X(6).
  6366     12  AM-REI-MORT                       PIC X(4).
  6367     12  AM-REI-PRT-OW                     PIC X.
  6368     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6369     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6370     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6371     12  AM-REI-GROUP-B                    PIC X(6).
  6372
  6373     12  AM-TRUST-TYPE                     PIC X(2).
  6374
  6375     12  AM-EMPLOYER-STMT-USED             PIC X.
  6376     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6377
  6378     12  AM-STD-AH-TYPE                    PIC XX.
  6379     12  AM-EARN-METHODS.
  6380         16  AM-EARN-METHOD-R              PIC X.
  6381             88 AM-REF-RL-R78                 VALUE 'R'.
  6382             88 AM-REF-RL-PR                  VALUE 'P'.
  6383             88 AM-REF-RL-MEAN                VALUE 'M'.
  6384             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6385         16  AM-EARN-METHOD-L              PIC X.
  6386             88 AM-REF-LL-R78                 VALUE 'R'.
  6387             88 AM-REF-LL-PR                  VALUE 'P'.
  6388             88 AM-REF-LL-MEAN                VALUE 'M'.
  6389             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6390         16  AM-EARN-METHOD-A              PIC X.
  6391             88 AM-REF-AH-R78                 VALUE 'R'.
  6392             88 AM-REF-AH-PR                  VALUE 'P'.
  6393             88 AM-REF-AH-MEAN                VALUE 'M'.
  6394             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6395             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6396             88 AM-REF-AH-NET                 VALUE 'N'.
  6397
  6398     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6399     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6400     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6401
  6402     12  AM-RET-Y-N                        PIC X.
  6403     12  AM-RET-P-E                        PIC X.
  6404     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6405     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6406     12  AM-RET-GRP                        PIC X(6).
  6407     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6408         16  AM-POOL-PRIME                 PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 116
* EL131.cbl
  6409         16  AM-POOL-SUB                   PIC XXX.
  6410     12  AM-RETRO-EARNINGS.
  6411         16  AM-RET-EARN-R                 PIC X.
  6412         16  AM-RET-EARN-L                 PIC X.
  6413         16  AM-RET-EARN-A                 PIC X.
  6414     12  AM-RET-ST-TAX-USE                 PIC X.
  6415         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6416         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6417     12  AM-RETRO-BEG-EARNINGS.
  6418         16  AM-RET-BEG-EARN-R             PIC X.
  6419         16  AM-RET-BEG-EARN-L             PIC X.
  6420         16  AM-RET-BEG-EARN-A             PIC X.
  6421     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6422     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6423
  6424     12  AM-USER-SELECT-OPTIONS.
  6425         16  AM-USER-SELECT-1              PIC X(10).
  6426         16  AM-USER-SELECT-2              PIC X(10).
  6427         16  AM-USER-SELECT-3              PIC X(10).
  6428         16  AM-USER-SELECT-4              PIC X(10).
  6429         16  AM-USER-SELECT-5              PIC X(10).
  6430
  6431     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6432
  6433     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6434
  6435     12  AM-RPT045A-SWITCH                 PIC X.
  6436         88  RPT045A-OFF                   VALUE 'N'.
  6437
  6438     12  AM-INSURANCE-LIMITS.
  6439         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6440         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6441
  6442     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6443         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6444
  6445     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6446         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6447         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6448
  6449     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6450
  6451     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6452     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6453     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6454     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6455     12  AM-DCC-UEF-STATE                  PIC XX.
  6456     12  FILLER                            PIC XXX.
  6457     12  AM-REPORT-CODE-3                  PIC X(10).
  6458*    12  FILLER                            PIC X(22).
  6459
  6460     12  AM-RESERVE-DATE.
  6461         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6462         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6463         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6464
  6465     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6466     12  AM-NOTIFICATION-TYPES.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 117
* EL131.cbl
  6467         16  AM-NOTIF-OF-LETTERS           PIC X.
  6468         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6469         16  AM-NOTIF-OF-REPORTS           PIC X.
  6470         16  AM-NOTIF-OF-STATUS            PIC X.
  6471
  6472     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6473         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6474         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6475         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6476         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6477
  6478     12  AM-BENEFIT-CONTROLS.
  6479         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6480             20  AM-BENEFIT-CODE           PIC XX.
  6481             20  AM-BENEFIT-TYPE           PIC X.
  6482             20  AM-BENEFIT-REVISION       PIC XXX.
  6483             20  AM-BENEFIT-REM-TERM       PIC X.
  6484             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6485             20  FILLER                    PIC XX.
  6486         16  FILLER                        PIC X(80).
  6487
  6488     12  AM-TRANSFER-DATA.
  6489         16  AM-TRANSFERRED-FROM.
  6490             20  AM-TRNFROM-CARRIER        PIC X.
  6491             20  AM-TRNFROM-GROUPING.
  6492                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6493                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6494             20  AM-TRNFROM-STATE          PIC XX.
  6495             20  AM-TRNFROM-ACCOUNT.
  6496                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6497                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6498             20  AM-TRNFROM-DTE            PIC XX.
  6499         16  AM-TRANSFERRED-TO.
  6500             20  AM-TRNTO-CARRIER          PIC X.
  6501             20  AM-TRNTO-GROUPING.
  6502                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6503                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6504             20  AM-TRNTO-STATE            PIC XX.
  6505             20  AM-TRNTO-ACCOUNT.
  6506                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6507                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6508             20  AM-TRNTO-DTE              PIC XX.
  6509         16  FILLER                        PIC X(10).
  6510
  6511     12  AM-SAVED-REMIT-TO                 PIC 99.
  6512
  6513     12  AM-COMM-STRUCTURE-SAVED.
  6514         16  AM-DEFN-1-SAVED.
  6515             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6516                 24  AM-AGT-SV             PIC X(10).
  6517                 24  AM-COM-TYP-SV         PIC X.
  6518                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6519                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6520                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6521                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6522                 24  FILLER                PIC X.
  6523                 24  AM-GL-CODES-SV        PIC X.
  6524                 24  AM-COM-CHARGEBACK-SV  PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 118
* EL131.cbl
  6525                 24  FILLER                PIC X.
  6526         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6527             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6528                 24  FILLER                PIC X(11).
  6529                 24  AM-L-COMA-SV          PIC XXX.
  6530                 24  AM-J-COMA-SV          PIC XXX.
  6531                 24  AM-A-COMA-SV          PIC XXX.
  6532                 24  FILLER                PIC X(6).
  6533
  6534     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6535         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6536            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6537            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6538            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6539
  6540     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6541     12  FILLER                            PIC X(120).
  6542
  6543     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6544         16  AM-CONTROL-NAME               PIC X(30).
  6545         16  AM-EXECUTIVE-ONE.
  6546             20  AM-EXEC1-NAME             PIC X(15).
  6547             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6548                                                          COMP-3.
  6549             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6550                                                          COMP-3.
  6551         16  AM-EXECUTIVE-TWO.
  6552             20  AM-EXEC2-NAME             PIC X(15).
  6553             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6554                                                          COMP-3.
  6555             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6556                                                          COMP-3.
  6557
  6558     12  AM-RETRO-ADDITIONAL-DATA.
  6559         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6560         16  AM-RETRO-PREM-P-E             PIC X.
  6561         16  AM-RETRO-CLMS-P-I             PIC X.
  6562         16  AM-RETRO-RET-BRACKET-LF.
  6563             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6564                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6565                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6566             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6567                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6568                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6569             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6570                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6571                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6572         16  AM-RETRO-RET-BRACKET-AH.
  6573             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6574                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6575                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6576                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6577             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6578                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6579                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6580             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6581                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6582                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 119
* EL131.cbl
  6583
  6584     12  AM-COMMENTS.
  6585         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6586
  6587     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6588         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6589         16  AM-FLI-BILLING-CODE           PIC X.
  6590         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6591         16  AM-FLI-UNITED-IDENT           PIC X.
  6592         16  AM-FLI-INTEREST-LOST-DATA.
  6593             20  AM-FLI-BANK-NO            PIC X(5).
  6594             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6595             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6596             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6597         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6598             20  AM-FLI-AGT                PIC X(9).
  6599             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6600             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6601         16  FILLER                        PIC X(102).
  6602
  6603     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6604         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6605             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6606             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6607             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6608             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6609             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6610         16  FILLER                          PIC X(10).
  6611******************************************************************
  6612
  6613*                                COPY ELCCHKQ.
  6614******************************************************************
  6615*                                                                *
  6616*                                                                *
  6617*                            ELCCHKQ.                            *
  6618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6619*                            VMOD=2.007                          *
  6620*                                                                *
  6621*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6622*                                                                *
  6623*   FILE TYPE = VSAM,KSDS                                        *
  6624*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6625*                                                                *
  6626*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6627*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6628*                                                                *
  6629*   LOG = YES                                                    *
  6630*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6631******************************************************************
  6632 01  CHECK-QUE.
  6633     12  CQ-RECORD-ID                PIC XX.
  6634         88  VALID-CQ-ID         VALUE 'CQ'.
  6635
  6636     12  CQ-CONTROL-PRIMARY.
  6637         16  CQ-COMPANY-CD           PIC X.
  6638         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6639         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6640
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 120
* EL131.cbl
  6641     12  CQ-CONTROL-BY-PAYEE.
  6642         16  CQ-CONTROL-BY-NUMBER.
  6643             20  CQ-COMPANY-CD-A1     PIC X.
  6644             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6645         16  CQ-PAYEE-CARRIER        PIC X.
  6646         16  CQ-PAYEE-GROUPING       PIC X(6).
  6647         16  CQ-PAYEE-STATE          PIC XX.
  6648         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6649         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6650
  6651     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6652         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6653         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6654         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6655         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6656         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6657         16  FILLER                  PIC X(3).
  6658
  6659     12  CQ-ENTRY-TYPE               PIC X.
  6660             88  CHECK-ON-QUE           VALUE 'Q'.
  6661             88  ALIGNMENT-CHECK        VALUE 'A'.
  6662             88  SPOILED-CHECK          VALUE 'S'.
  6663             88  PAYMENT-ABORTED        VALUE 'X'.
  6664
  6665     12  CQ-CLAIM-MAST-CNTL.
  6666         16  CQ-CARRIER              PIC X.
  6667         16  CQ-CLAIM-NO             PIC X(7).
  6668         16  CQ-CERT-NO.
  6669             20  CQ-CERT-PRIME       PIC X(10).
  6670             20  CQ-CERT-SFX         PIC X.
  6671         16  CQ-CLAIM-TYPE           PIC X.
  6672             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6673             88  CQ-AH-CLAIM            VALUE 'A'.
  6674         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6675             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6676             88  CQ-O-B-COVERAGE        VALUE '2'.
  6677             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6678
  6679     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6680     12  CQ-CHECK-NUMBER             PIC X(7).
  6681     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6682     12  CQ-PAYMENT-TYPE             PIC X.
  6683             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6684             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6685             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6686             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6687             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6688             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6689             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6690             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6691     12  CQ-VOID-INDICATOR           PIC X.
  6692             88  CHECK-IS-STOPPED          VALUE 'S'.
  6693             88  CHECK-IS-VOID             VALUE 'V'.
  6694     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6695     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6696     12  CQ-CHECK-BY-USER            PIC X(4).
  6697     12  CQ-PRE-NUMBERING-SW         PIC X.
  6698       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 121
* EL131.cbl
  6699       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6700
  6701     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6702     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6703     12  CQ-LEDGER-FLAG              PIC X(01).
  6704     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6705     12  CQ-LAST-UPDATED-DT          PIC XX.
  6706     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6707     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6708
  6709     12  FILLER                      PIC X(04).
  6710
  6711******************************************************************
  6712
  6713*                                COPY ELCARCH.
  6714******************************************************************
  6715*                                                                *
  6716*                            ELCARCH.                            *
  6717*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6718*                            VMOD=2.007                          *
  6719*                                                                *
  6720*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6721*                                                                *
  6722*   FILE TYPE = VSAM,KSDS                                        *
  6723*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6724*                                                                *
  6725*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6726*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6727*                                                                *
  6728*   LOG = NO                                                     *
  6729*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6730*                                                                *
  6731*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6732******************************************************************
  6733 01  LETTER-ARCHIVE.
  6734     12  LA-RECORD-ID                PIC XX.
  6735         88  VALID-LA-ID                VALUE 'LA'.
  6736
  6737     12  LA-CONTROL-PRIMARY.
  6738         16  LA-COMPANY-CD           PIC X.
  6739         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6740         16  LA-RECORD-TYPE          PIC X.
  6741             88  LA-HEADER-DATA         VALUE '1'.
  6742             88  LA-ADDRESS-DATA        VALUE '2'.
  6743             88  LA-TEXT-DATA           VALUE '3'.
  6744             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6745         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6746
  6747     12  LA-CONTROL-BY-TYPE.
  6748         16  LA-COMPANY-CD-A1        PIC X.
  6749         16  LA-RECORD-TYPE-A1       PIC X.
  6750         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6751         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6752
  6753     12  LA-TEXT-RECORD.
  6754         16  LA-SKIP-CONTROL         PIC XX.
  6755             88  NO-LINES-SKIPPED       VALUE SPACES.
  6756             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 122
* EL131.cbl
  6757         16  LA-TEXT-LINE            PIC X(70).
  6758
  6759     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6760         16  FILLER                  PIC XX.
  6761         16  LA-ADDRESS-LINE         PIC X(30).
  6762         16  FILLER                  PIC X(40).
  6763
  6764     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6765         16  FILLER                  PIC XX.
  6766         16  LA-CARRIER              PIC X.
  6767         16  LA-CLAIM-NO             PIC X(7).
  6768         16  LA-CERT-NO.
  6769             20  LA-CERT-PRIME       PIC X(10).
  6770             20  LA-CERT-SFX         PIC X.
  6771         16  LA-NO-OF-COPIES         PIC S9.
  6772         16  LA-RESEND-DATE          PIC XX.
  6773         16  LA-PROCESSOR-CD         PIC X(4).
  6774         16  LA-CREATION-DT          PIC XX.
  6775         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6776         16  LA-RESEND-PRINT-DATE    PIC XX.
  6777         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6778         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6779*
  6780* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6781*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6782*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6783*   I        20  LA-DMD-RES-ST           PIC XX.
  6784*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6785*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6786*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6787*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6788*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6789*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6790*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6791*   I        20  LA-DMD-UND-CODE         PIC XX.
  6792*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6793*   V    16  FILLER                  PIC X(15).
  6794* -----
  6795*
  6796* REINSERTED  CSO  MODS
  6797*
  6798         16  FILLER.
  6799             20  FILLER                  PIC X(29).
  6800             20  LA-CSO-LETTER-STATUS    PIC X.
  6801                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6802                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6803                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6804             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6805             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6806*
  6807
  6808     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6809         16  FILLER                  PIC XX.
  6810         16  LA4-CARRIER             PIC X.
  6811         16  LA4-CLAIM-NO            PIC X(7).
  6812         16  LA4-CERT-NO.
  6813             20  LA4-CERT-PRIME      PIC X(10).
  6814             20  LA4-CERT-SFX        PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 123
* EL131.cbl
  6815         16  LA4-NO-OF-COPIES        PIC S9.
  6816         16  LA4-RESEND-DATE         PIC XX.
  6817         16  LA4-PROCESSOR-CD        PIC X(4).
  6818         16  LA4-CREATION-DT         PIC XX.
  6819         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6820         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6821         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6822         16  LA4-FORM-TYPE           PIC X.
  6823             88  LA4-INITIAL-FORM    VALUE '1'.
  6824             88  LA4-PROGRESS-FORM   VALUE '2'.
  6825         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6826         16  LA4-STATE               PIC X(02).
  6827         16  FILLER                  PIC X(31).
  6828******************************************************************
  6829
  6830*                                COPY ELCBENE.
  6831******************************************************************
  6832*                                                                *
  6833*                            ELCBENE.                            *
  6834*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6835*                            VMOD=2.006                          *
  6836*                                                                *
  6837*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6838*                                                                *
  6839*   FILE TYPE = VSAM,KSDS                                        *
  6840*   RECORD SIZE = 500   RECFORM = FIX                            *
  6841*                                                                *
  6842*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6843*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6844*                                                                *
  6845*   LOG = YES                                                    *
  6846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6847*                                                                *
  6848*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6849******************************************************************
  6850
  6851 01  BENEFICIARY-MASTER.
  6852     12  BE-RECORD-ID                PIC XX.
  6853         88  VALID-BE-ID                VALUE 'BE'.
  6854
  6855     12  BE-CONTROL-PRIMARY.
  6856         16  BE-COMPANY-CD           PIC X.
  6857         16  BE-RECORD-TYPE          PIC X.
  6858             88  BENEFICIARY-RECORD  VALUE 'B'.
  6859             88  ADJUSTOR-RECORD     VALUE 'A'.
  6860         16  BE-BENEFICIARY          PIC X(10).
  6861     12  BE-CONTROL-BY-NAME.
  6862         16  BE-COMPANY-CD-A1        PIC X.
  6863         16  BE-RECORD-TYPE-A1       PIC X.
  6864         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6865         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6866
  6867     12  BE-LAST-MAINT-DT            PIC XX.
  6868     12  BE-LAST-MAINT-BY            PIC X(4).
  6869     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6870
  6871     12  BE-ADDRESS-DATA.
  6872         16  BE-MAIL-TO-NAME         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 124
* EL131.cbl
  6873         16  BE-ADDRESS-LINE-1       PIC X(30).
  6874         16  BE-ADDRESS-LINE-2       PIC X(30).
  6875         16  BE-ADDRESS-LINE-3       PIC X(30).
  6876         16  BE-CITY-STATE.
  6877             20  BE-CITY             PIC X(28).
  6878             20  BE-STATE            PIC XX.
  6879         16  BE-ZIP-CODE.
  6880             20  BE-ZIP-PRIME.
  6881                 24  BE-ZIP-1ST      PIC X.
  6882                     88  BE-CANADIAN-POST-CODE
  6883                                         VALUE 'A' THRU 'Z'.
  6884                 24  FILLER          PIC X(4).
  6885             20  BE-ZIP-PLUS4        PIC X(4).
  6886         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6887             20  BE-CAN-POSTAL-1     PIC XXX.
  6888             20  BE-CAN-POSTAL-2     PIC XXX.
  6889             20  FILLER              PIC XXX.
  6890         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6891         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6892
  6893******************************************************************
  6894*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6895*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6896******************************************************************
  6897     12  BE-CARRIER                  PIC X.
  6898
  6899     12  BE-ADDRESS-DATA2.
  6900         16  BE-MAIL-TO-NAME2        PIC X(30).
  6901         16  BE-ADDRESS-LINE-12      PIC X(30).
  6902         16  BE-ADDRESS-LINE-22      PIC X(30).
  6903         16  BE-ADDRESS-LINE-32      PIC X(30).
  6904         16  BE-CITY-STATE2.
  6905             20  BE-CITY2            PIC X(28).
  6906             20  BE-STATE2           PIC XX.
  6907         16  BE-ZIP-CODE2.
  6908             20  BE-ZIP-PRIME2.
  6909                 24  BE-ZIP-1ST2     PIC X.
  6910                     88  BE-CANADIAN-POST-CODE2
  6911                                         VALUE 'A' THRU 'Z'.
  6912                 24  FILLER          PIC X(4).
  6913             20  BE-ZIP-PLUS42       PIC X(4).
  6914         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6915             20  BE-CAN-POSTAL-12    PIC XXX.
  6916             20  BE-CAN-POSTAL-22    PIC XXX.
  6917             20  FILLER              PIC XXX.
  6918         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6919         16  BE-BILLING-STMT-DATA.
  6920             20  BE-BSR              PIC X.
  6921                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6922                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6923             20  BE-BSR-FROM         PIC X(30).
  6924             20  BE-BSR-DEPT         PIC X(30).
  6925             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6926             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6927             20  BE-OUTPUT-TYPE      PIC X.
  6928                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6929                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6930
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 125
* EL131.cbl
  6931     12  FILLER                      PIC X(28).
  6932******************************************************************
  6933
  6934*                                COPY ELCDAR.
  6935******************************************************************
  6936*                                                                *
  6937*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6938*   FILE TYPE = VSAM,KSDS                                        *
  6939*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6940*   BASE CLUSTER = DLYACTV                                       *
  6941*   LOG = YES                                                    *
  6942*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6943*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6944*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6945*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6946*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6947*               BY PROGRAM "LGINFCE".                            *
  6948*                                                                *
  6949******************************************************************
  6950 01  DAILY-ACTIVITY-RECORD.
  6951     05  DA-KEY.
  6952         10  DA-COMP-CD          PIC X.
  6953         10  DA-CARRIER          PIC X.
  6954         10  DA-CLAIM-NO         PIC X(7).
  6955         10  DA-CERT-NO.
  6956             15  DA-CERT-PRIME   PIC X(10).
  6957             15  DA-CERT-SFX     PIC X.
  6958     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6959     05  DA-RECORD-TYPE          PIC X.
  6960     05  FILLER                  PIC X(2).
  6961******************************************************************
  6962
  6963*                                COPY ELCALPH.
  6964******************************************************************
  6965*                                                                *
  6966*                            ELCALPH.                            *
  6967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6968*                            VMOD=2.003                          *
  6969*                                                                *
  6970*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6971*                                                                *
  6972*   FILE TYPE = VSAM,KSDS                                        *
  6973*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6974*                                                                *
  6975*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6976*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6977*                                                                *
  6978*   LOG = YES                                                    *
  6979*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6980*                                                                *
  6981*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6982******************************************************************
  6983
  6984 01  ALPHA-INDEX.
  6985     12  AI-RECORD-ID                         PIC XX.
  6986         88  VALID-AI-ID                  VALUE 'AI'.
  6987     12  AI-CONTROL-PRIMARY.
  6988         16  AI-COMPANY-CD                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 126
* EL131.cbl
  6989         16  AI-SOURCE                         PIC X.
  6990             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6991             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6992         16  AI-NAME.
  6993             20  AI-LAST-NAME                  PIC X(15).
  6994             20  AI-FIRST-NAME.
  6995                 24  AI-FIRST-INITIAL          PIC X.
  6996                 24  FILLER                    PIC X(11).
  6997             20  AI-MIDDLE-INIT                PIC X.
  6998         16  AI-DATE                           PIC X(8).
  6999         16  AI-TIME                           PIC S9(07) COMP-3.
  7000
  7001     12  AI-CONTROL-BY-ADMIN-KEY.
  7002         16  AI-CM-COMPANY-CD                  PIC X.
  7003         16  AI-CM-SOURCE                      PIC X.
  7004         16  AI-CM-CARRIER                     PIC X.
  7005         16  AI-CM-GROUPING.
  7006             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7007             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7008         16  AI-CM-STATE                       PIC XX.
  7009         16  AI-CM-PRODUCER.
  7010             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7011             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7012         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7013         16  AI-CM-CERTIFICATE-NUMBER.
  7014             20  AI-CM-CERT-PRIME              PIC X(10).
  7015             20  AI-CM-CERT-SFX                PIC X.
  7016         16  AI-CM-DATE                        PIC X(8).
  7017         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7018         16  FILLER                            PIC X(11).
  7019
  7020     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7021         AI-CONTROL-BY-ADMIN-KEY.
  7022         16  AI-CL-COMPANY-CD                  PIC X.
  7023         16  AI-CL-SOURCE                      PIC X.
  7024         16  AI-CL-CARRIER                     PIC X.
  7025         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7026         16  AI-CL-CERTIFICATE-NUMBER.
  7027             20  AI-CL-CERT-PRIME              PIC X(10).
  7028             20  AI-CL-CERT-SFX                PIC X.
  7029         16  AI-CL-DATE                        PIC X(8).
  7030         16  AI-CL-INCURRED-DATE               PIC XX.
  7031         16  AI-CL-CLOSE-DATE                  PIC XX.
  7032         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7033         16  AI-CREDIT-CARD-NUMBER.
  7034             20  AI-CCN.
  7035                 24  AI-CCN-PREFIX             PIC X(4).
  7036                 24  AI-CCN-PRIME              PIC X(12).
  7037             20  AI-CCN-FILLER                 PIC X(4).
  7038
  7039     12  AI-MAINT-INFO.
  7040         16  AI-LAST-MAINT-BY                  PIC X(4).
  7041         16  AI-LAST-MAINT-DT                  PIC XX.
  7042         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7043
  7044     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7045
  7046     12  FILLER                                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 127
* EL131.cbl
  7047
  7048
  7049*                                COPY ERCDMDNT.
  7050******************************************************************
  7051*                                                                *
  7052*                            ERCDMDNT                            *
  7053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7054*                            VMOD=2.005                          *
  7055*                                                                *
  7056*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7057*                                                                *
  7058*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7059*                                                                *
  7060*        FILE TYPE= VSAM,KSDS                                    *
  7061*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7062*                                                                *
  7063*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7064*                                                                *
  7065*        LOG = YES                                               *
  7066*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7067*                                                                *
  7068******************************************************************
  7069
  7070 01  CERTIFICATE-NOTE.
  7071     12  CN-RECORD-ID                     PIC  XX.
  7072         88  VALID-CN-ID                      VALUE 'CN'.
  7073
  7074     12  CN-CONTROL-PRIMARY.
  7075         16  CN-COMPANY-CD                PIC X.
  7076         16  CN-CERT-KEY.
  7077             20  CN-CARRIER               PIC X.
  7078             20  CN-GROUPING.
  7079                 24  CN-GROUPING-PREFIX   PIC XXX.
  7080                 24  CN-GROUPING-PRIME    PIC XXX.
  7081             20  CN-STATE                 PIC XX.
  7082             20  CN-ACCOUNT.
  7083                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7084                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7085             20  CN-CERT-EFF-DT           PIC XX.
  7086             20  CN-CERT-NO.
  7087                 24  CN-CERT-PRIME        PIC X(10).
  7088                 24  CN-CERT-SFX          PIC X.
  7089
  7090     12  CN-BILLING-START-LINE-NO         PIC 99.
  7091     12  CN-BILLING-END-LINE-NO           PIC 99.
  7092
  7093     12  CN-LINES.
  7094         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7095
  7096     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7097         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7098         16  CN-CSI-GENERAL-DATA-AREA.
  7099             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7100
  7101         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7102             CN-CSI-GENERAL-DATA-AREA.
  7103             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7104             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 128
* EL131.cbl
  7105             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7106             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7107             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7108             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7109             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7110             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7111             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7112             20  FILLER                       PIC XX.
  7113             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7114             20  FILLER                       PIC X(38).
  7115
  7116         16  CN-CSI-PRODUCT-DATA-AREA.
  7117             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7118
  7119         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7120             CN-CSI-PRODUCT-DATA-AREA.
  7121             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7122             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7123             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7124             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7125             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7126             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7127             20  FILLER                   PIC XX.
  7128             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7129             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7130             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7131             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7132             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7133             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7134             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7135             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7136             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7137             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7138             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7139             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7140             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7141             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7142             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7143             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7144             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7145             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7146             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7147             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7148             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7149             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7150             20  FILLER                   PIC X(25).
  7151
  7152         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7153             CN-CSI-CREDIT-CARD-DATA.
  7154             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7155             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7156             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7157             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7158             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7159             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7160             20  FILLER                   PIC XX.
  7161             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7162             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 129
* EL131.cbl
  7163             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7164             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7165             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7166             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7167             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7168             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7169             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7170             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7171             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7172             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7173             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7174             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7175             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7176             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7177             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7178             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7179             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7180             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7181             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7182             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7183             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7184             20  FILLER                   PIC X(17).
  7185
  7186         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7187             CN-CSI-FAMILY-LEAVE-DATA.
  7188             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7189             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7190             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7191             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7192             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7193             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7194             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7195             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7196             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7197             20  CN-CSI-SL-INT-ON-PROCEEDS
  7198                                          PIC S9(5)V99  COMP-3.
  7199             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7200             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7201             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7202             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7203             20  CN-CSI-SL-POLICY-BENEFITS
  7204                                          PIC S9(5)V99  COMP-3.
  7205             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7206             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7207             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7208             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7209             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7210             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7211             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7212             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7213             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7214             20  CN-CSI-SL-STATE-NOT      PIC X.
  7215             20  FILLER                   PIC XX.
  7216
  7217         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7218             CN-CSI-SENIOR-LIFE-DATA.
  7219             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7220             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 130
* EL131.cbl
  7221             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7222                                          PIC S9(5)V99  COMP-3.
  7223             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7224             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7225             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7226             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7227             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7228             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7229             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7230             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7231             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7232             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7233             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7234             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7235             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7236             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7237             20  CN-CSI-PP-REPAIR         PIC X.
  7238             20  CN-CSI-PP-REPLACE        PIC X.
  7239             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7240             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7241             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7242             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7243             20  FILLER                   PIC X(5).
  7244
  7245         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7246             CN-CSI-PURCH-PROP-DATA.
  7247             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7248             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7249             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7250             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7251             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7252             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7253             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7254             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7255             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7256             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7257             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7258             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7259             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7260             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7261             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7262             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7263             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7264             20  CN-CSI-EW-REPLACE        PIC X.
  7265             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7266             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7267             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7268             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7269             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7270             20  FILLER                   PIC X(4).
  7271
  7272     12  CN-LAST-MAINT-DT                 PIC XX.
  7273     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7274     12  CN-LAST-MAINT-USER               PIC X(4).
  7275     12  FILLER                           PIC X(6).
  7276
  7277******************************************************************
  7278
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 131
* EL131.cbl
  7280 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7281                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7282                          CONTROL-FILE ACTIVITY-QUE
  7283                          ACCOUNT-MASTER CHECK-QUE
  7284                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7285                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7286                          CERTIFICATE-NOTE.
  7287 0000-DFHEXIT SECTION.
  7288     MOVE '9#                    $   ' TO DFHEIV0.
  7289     MOVE 'EL131' TO DFHEIV1.
  7290     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7291
  7292     IF EIBCALEN = ZERO
  7293         GO TO 8800-UNAUTHORIZED-ACCESS.
  7294
  7295     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7296     MOVE '5'                    TO DC-OPTION-CODE.
  7297     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7298     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7299     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7300     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7301
  7302     IF SAVE-DATE-YY GREATER 70
  7303         MOVE 19                 TO SAVE-DATE-CC
  7304      ELSE
  7305         MOVE 20                 TO SAVE-DATE-CC.
  7306
  7307
  7308* EXEC CICS HANDLE CONDITION
  7309*        PGMIDERR (8820-XCTL-ERROR)
  7310*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7311*        ERROR    (9990-ABEND)
  7312*    END-EXEC.
  7313*    MOVE '"$LI.                 ! " #00007303' TO DFHEIV0
  7314     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7316     MOVE X'2220233030303037333033' TO DFHEIV0(25:11)
  7317     CALL 'kxdfhei1' USING DFHEIV0
  7318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7319
  7320
  7321     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7322     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7323     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7324
  7325     INITIALIZE    EDIT-WORK-AREA.
  7326     MOVE '/'                    TO WORK-SLASH.
  7327     MOVE SPACES                 TO ERROR-SWITCHES.
  7328
  7329     MOVE TRAN-ID                TO TRANS-ID.
  7330     MOVE EIBTRMID               TO PI-TERM.
  7331     MOVE MAP-ID                 TO PI-QUAL.
  7332
  7333     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7334
  7335     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7336         MOVE LOW-VALUES         TO EL131AO
  7337         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 132
* EL131.cbl
  7338         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7339         MOVE -1                 TO MAINTL
  7340         GO TO 8110-SEND-DATA.
  7341
  7342     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7343         MOVE LOW-VALUES         TO EL131AO
  7344         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7345         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7346         MOVE 'X'                TO PI-RETURN-CD-1
  7347         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7348         MOVE -1                 TO MAINTL
  7349         IF WS-RETURNED-FROM = XCTL-EL114
  7350             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7351         END-IF
  7352         GO TO 8100-SEND-MAP.
  7353
  7354     IF EIBAID = DFHCLEAR
  7355         GO TO 8200-RETURN-PRIOR.
  7356
  7357     IF PI-PROCESSOR-ID = 'LGXX'
  7358         NEXT SENTENCE
  7359     ELSE
  7360
  7361* EXEC CICS READQ TS
  7362*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7363*            INTO    (SECURITY-CONTROL)
  7364*            LENGTH  (SC-COMM-LENGTH)
  7365*            ITEM    (SC-ITEM)
  7366*        END-EXEC
  7367*    MOVE '*$II   L              ''   #00007348' TO DFHEIV0
  7368     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7369     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7370     MOVE X'2020233030303037333438' TO DFHEIV0(25:11)
  7371     CALL 'kxdfhei1' USING DFHEIV0,
  7372           PI-SECURITY-TEMP-STORE-ID,
  7373           SECURITY-CONTROL,
  7374           SC-COMM-LENGTH,
  7375           SC-ITEM,
  7376           DFHEIV99,
  7377           DFHEIV99
  7378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7379         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7380         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7381         IF NOT DISPLAY-CAP
  7382             MOVE 'READ'               TO  SM-READ
  7383             PERFORM 9995-SECURITY-VIOLATION
  7384             MOVE ER-0070              TO  EMI-ERROR
  7385             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7386             GO TO 8100-SEND-MAP.
  7387
  7388
  7389* EXEC CICS RECEIVE
  7390*        MAP    ('EL131A')
  7391*        MAPSET ('EL131S')
  7392*    END-EXEC.
  7393     MOVE 'EL131A' TO DFHEIV1
  7394     MOVE 'EL131S' TO DFHEIV2
  7395*    MOVE '8"T                   ''   #00007363' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 133
* EL131.cbl
  7396     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7397     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7398     MOVE X'2020233030303037333633' TO DFHEIV0(25:11)
  7399     CALL 'kxdfhei1' USING DFHEIV0,
  7400           DFHEIV1,
  7401           EL131AI,
  7402           DFHEIV99,
  7403           DFHEIV2,
  7404           DFHEIV99,
  7405           DFHEIV99
  7406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7407
  7408
  7409     IF PFKEYL GREATER THAN ZERO
  7410         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7411
  7412     IF SCREEN-ERROR
  7413         MOVE ER-0004 TO EMI-ERROR
  7414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7415         MOVE -1 TO MAINTL
  7416         GO TO 8110-SEND-DATA.
  7417
  7418     IF EIBAID = DFHPF3
  7419         GO TO 8500-TRLR-MNT.
  7420
  7421     IF EIBAID = DFHPF4
  7422         GO TO 8600-ADDR-MNT.
  7423
  7424     IF EIBAID = DFHPF5
  7425         GO TO 8700-CERT-MNT.
  7426
  7427     IF PI-COMPANY-ID = 'DMD'
  7428       IF EIBAID = DFHPF6
  7429         GO TO 8750-DMD-CLM-FIX.
  7430
  7431     IF EIBAID = DFHPF7
  7432         GO TO 4000-FORCE-ERRORS.
  7433
  7434     IF EIBAID = DFHPF12
  7435         GO TO 8300-GET-HELP.
  7436
  7437     IF EIBAID = DFHPF15
  7438         GO TO 8725-BENEFICIARY-MNT
  7439     END-IF.
  7440
  7441     IF EIBAID = DFHPF23
  7442         GO TO 8810-PF23-ENTERED.
  7443
  7444     IF EIBAID = DFHPF24
  7445         GO TO 8400-RETURN-MASTER.
  7446
  7447     IF EIBAID NOT = DFHENTER
  7448         MOVE ER-0029            TO EMI-ERROR
  7449         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7450         MOVE -1                 TO MAINTL
  7451         GO TO 8110-SEND-DATA.
  7452
  7453     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 134
* EL131.cbl
  7454         MOVE ER-0311            TO EMI-ERROR
  7455         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7456         MOVE -1                 TO MAINTL
  7457         GO TO 8110-SEND-DATA.
  7458
  7459     IF MAINTI = 'A'
  7460         GO TO 0500-ADD-ALPHA-ONLY.
  7461
  7462     IF MAINTI = 'N'
  7463         GO TO 0600-CHANGE-NAME.
  7464
  7465     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7466
  7467     IF SCREEN-ERROR
  7468         GO TO 8110-SEND-DATA.
  7469
  7470     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7471         MOVE ER-0276            TO EMI-ERROR
  7472         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7473         MOVE -1                 TO MAINTL
  7474         GO TO 8110-SEND-DATA.
  7475
  7476     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7477
  7478     IF SCREEN-ERROR
  7479         GO TO 8110-SEND-DATA.
  7480
  7481     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7482
  7483     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7484
  7485     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7486         GO TO 8110-SEND-DATA.
  7487
  7488     IF EMI-FATAL-CTR GREATER THAN ZERO
  7489         GO TO 8110-SEND-DATA.
  7490
  7491     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7492
  7493     IF WS-OPEN-CLOSE-SW = 'Y'
  7494         IF PI-LETTER-SW = 'Y'
  7495             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7496             MOVE 'T'            TO  CNTL-REC-TYPE
  7497             MOVE SPACES         TO  CNTL-PROC-ID
  7498             MOVE +0             TO  CNTL-SEQ-NO
  7499
  7500* EXEC CICS READ
  7501*                DATASET   (CNTL-FILE-ID)
  7502*                RIDFLD    (CNTL-KEY)
  7503*                SET       (ADDRESS OF CONTROL-FILE)
  7504*            END-EXEC
  7505*    MOVE '&"S        E          (   #00007458' TO DFHEIV0
  7506     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7508     MOVE X'2020233030303037343538' TO DFHEIV0(25:11)
  7509     CALL 'kxdfhei1' USING DFHEIV0,
  7510           CNTL-FILE-ID,
  7511           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 135
* EL131.cbl
  7512           DFHEIV99,
  7513           CNTL-KEY,
  7514           DFHEIV99,
  7515           DFHEIV99,
  7516           DFHEIV99
  7517     SET ADDRESS OF CONTROL-FILE TO
  7518         DFHEIV20
  7519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7520             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7521
  7522     MOVE ER-0000                TO EMI-ERROR.
  7523     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7524
  7525     MOVE SPACE                  TO MAINTO.
  7526     MOVE -1                     TO MAINTL.
  7527     GO TO 8100-SEND-MAP.
  7528
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 136
* EL131.cbl
  7530 0100-UPDATE-PI.
  7531
  7532     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7533     IF WS-RETURNED-FROM = XCTL-EL114
  7534***sometimes there is crap in positions 7-10 when no code was sele
  7535        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7536          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7537        END-IF
  7538     END-IF.
  7539
  7540     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7541         GO TO 0110-UPDATE-UP.
  7542
  7543     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7544     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7545     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7546     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7547     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7548     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7549     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7550     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7551     GO TO 0120-UPDATE-PI-EXIT.
  7552
  7553 0110-UPDATE-UP.
  7554     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7555     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7556     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7557     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7558     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7559     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7560     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7561     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7562
  7563
  7564* EXEC CICS HANDLE CONDITION
  7565*         QIDERR    (0130-TS-ERROR)
  7566*         ITEMERR   (0130-TS-ERROR)
  7567*    END-EXEC.
  7568*    MOVE '"$N<                  ! # #00007506' TO DFHEIV0
  7569     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7571     MOVE X'2320233030303037353036' TO DFHEIV0(25:11)
  7572     CALL 'kxdfhei1' USING DFHEIV0
  7573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7574
  7575
  7576     IF WS-RETURNED-FROM = XCTL-EL114
  7577
  7578* EXEC CICS READQ TS
  7579*            QUEUE    (PI-KEY)
  7580*            INTO     (EL131AI)
  7581*            LENGTH   (MAP-LENGTH)
  7582*       END-EXEC
  7583*    MOVE '*$I    L              ''   #00007512' TO DFHEIV0
  7584     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7585     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7586     MOVE X'2020233030303037353132' TO DFHEIV0(25:11)
  7587     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 137
* EL131.cbl
  7588           PI-KEY,
  7589           EL131AI,
  7590           MAP-LENGTH,
  7591           DFHEIV99,
  7592           DFHEIV99,
  7593           DFHEIV99
  7594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7595
  7596        IF WS-SAVE-BENEFICIARY > SPACES
  7597            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7598            MOVE +10            TO BENEL
  7599            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7600        END-IF
  7601        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7602     END-IF.
  7603
  7604
  7605* EXEC CICS READQ TS
  7606*         QUEUE    (PI-KEY)
  7607*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7608*         LENGTH   (PI-COMM-LENGTH)
  7609*    END-EXEC.
  7610*    MOVE '*$I    L              ''   #00007526' TO DFHEIV0
  7611     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7613     MOVE X'2020233030303037353236' TO DFHEIV0(25:11)
  7614     CALL 'kxdfhei1' USING DFHEIV0,
  7615           PI-KEY,
  7616           PROGRAM-INTERFACE-BLOCK,
  7617           PI-COMM-LENGTH,
  7618           DFHEIV99,
  7619           DFHEIV99,
  7620           DFHEIV99
  7621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7622
  7623
  7624
  7625* EXEC CICS DELETEQ TS
  7626*         QUEUE    (PI-KEY)
  7627*    END-EXEC.
  7628*    MOVE '*&                    #   #00007532' TO DFHEIV0
  7629     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7630     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7631     MOVE X'2020233030303037353332' TO DFHEIV0(25:11)
  7632     CALL 'kxdfhei1' USING DFHEIV0,
  7633           PI-KEY,
  7634           DFHEIV99
  7635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7636
  7637
  7638 0120-UPDATE-PI-EXIT.
  7639     EXIT.
  7640
  7641 0130-TS-ERROR.
  7642     MOVE LOW-VALUES             TO EL131AO.
  7643     MOVE ER-0192                TO EMI-ERROR.
  7644
  7645     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 138
* EL131.cbl
  7646
  7647     GO TO 8100-SEND-MAP.
  7648
  7649 0200-TRANS-PF.
  7650     IF EIBAID NOT = DFHENTER
  7651         MOVE 'X'                TO ERROR-SWITCH
  7652         GO TO 0210-EXIT.
  7653
  7654     IF PFKEYI NOT NUMERIC
  7655         MOVE 'X'                TO ERROR-SWITCH
  7656         GO TO 0210-EXIT.
  7657
  7658     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7659
  7660     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7661         MOVE 'X' TO ERROR-SWITCH
  7662         GO TO 0210-EXIT.
  7663
  7664     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7665
  7666 0210-EXIT.
  7667     EXIT.
  7668
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 139
* EL131.cbl
  7670 0500-ADD-ALPHA-ONLY.
  7671******************************************************************
  7672*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7673*    RECORD.                                                     *
  7674******************************************************************
  7675
  7676     IF MLNAMEL = +0 AND
  7677        MFNAMEL = +0 AND
  7678        MMINITL = +0
  7679         MOVE ER-0797                TO  EMI-ERROR
  7680         MOVE -1                     TO  MAINTL
  7681         MOVE AL-UABON               TO  MAINTA
  7682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7683         GO TO 8110-SEND-DATA.
  7684
  7685     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7686     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7687     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7688     MOVE PI-CERT-NO                 TO  CERT-NO.
  7689
  7690
  7691* EXEC CICS READ
  7692*        DATASET   (CLMS-FILE-ID)
  7693*        RIDFLD    (MSTR-KEY)
  7694*        SET       (ADDRESS OF CLAIM-MASTER)
  7695*    END-EXEC.
  7696*    MOVE '&"S        E          (   #00007588' TO DFHEIV0
  7697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7699     MOVE X'2020233030303037353838' TO DFHEIV0(25:11)
  7700     CALL 'kxdfhei1' USING DFHEIV0,
  7701           CLMS-FILE-ID,
  7702           DFHEIV20,
  7703           DFHEIV99,
  7704           MSTR-KEY,
  7705           DFHEIV99,
  7706           DFHEIV99,
  7707           DFHEIV99
  7708     SET ADDRESS OF CLAIM-MASTER TO
  7709         DFHEIV20
  7710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7711
  7712
  7713
  7714* EXEC CICS GETMAIN
  7715*        SET       (ADDRESS OF ALPHA-INDEX)
  7716*        LENGTH    (ALPH-LENGTH)
  7717*        INITIMG   (GETMAIN-SPACE)
  7718*    END-EXEC.
  7719*    MOVE ',"IL                  $   #00007594' TO DFHEIV0
  7720     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7722     MOVE X'2020233030303037353934' TO DFHEIV0(25:11)
  7723     CALL 'kxdfhei1' USING DFHEIV0,
  7724           DFHEIV20,
  7725           ALPH-LENGTH,
  7726           GETMAIN-SPACE
  7727     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 140
* EL131.cbl
  7728         DFHEIV20
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732     MOVE 'AI'                       TO  AI-RECORD-ID.
  7733     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7734                                         AI-CL-COMPANY-CD.
  7735     MOVE 'C'                        TO  AI-SOURCE
  7736                                         AI-CL-SOURCE.
  7737
  7738     IF MLNAMEL IS GREATER THAN +0
  7739         MOVE MLNAMEI                TO  AI-LAST-NAME
  7740     ELSE
  7741         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7742
  7743     IF MFNAMEL IS GREATER THAN +0
  7744         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7745     ELSE
  7746         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7747
  7748     IF MMINITL IS GREATER THAN +0
  7749         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7750     ELSE
  7751         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7752
  7753     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7754     MOVE '5'                        TO  DC-OPTION-CODE.
  7755     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7756     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7757     IF BUILD-YEAR IS GREATER THAN 50
  7758         MOVE '19'                   TO  WS-ALPHA-YY-1
  7759         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7760         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7761         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7762     ELSE
  7763         MOVE '20'                   TO  WS-ALPHA-YY-1
  7764         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7765         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7766         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7767
  7768     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7769                                         AI-CL-DATE.
  7770
  7771     MOVE EIBTIME                    TO  AI-TIME
  7772                                         AI-CL-TIME.
  7773
  7774     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7775     MOVE 'C'                        TO  AI-CL-SOURCE.
  7776     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7777     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7778     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7779     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7780     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7781
  7782     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7783     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7784     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7785
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 141
* EL131.cbl
  7786
  7787* EXEC CICS WRITE
  7788*        DATASET   (ALPH-FILE-ID)
  7789*        RIDFLD    (AI-CONTROL-PRIMARY)
  7790*        FROM      (ALPHA-INDEX)
  7791*    END-EXEC.
  7792     MOVE LENGTH OF
  7793      ALPHA-INDEX
  7794       TO DFHEIV11
  7795*    MOVE '&$ L                  ''   #00007654' TO DFHEIV0
  7796     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7797     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7798     MOVE X'2020233030303037363534' TO DFHEIV0(25:11)
  7799     CALL 'kxdfhei1' USING DFHEIV0,
  7800           ALPH-FILE-ID,
  7801           ALPHA-INDEX,
  7802           DFHEIV11,
  7803           AI-CONTROL-PRIMARY,
  7804           DFHEIV99,
  7805           DFHEIV99
  7806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7807
  7808
  7809     MOVE LOW-VALUES                 TO  EL131AO.
  7810     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7811     MOVE ER-0000                    TO  EMI-ERROR.
  7812     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7813     MOVE -1                         TO  MAINTL.
  7814     GO TO 8100-SEND-MAP.
  7815
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 142
* EL131.cbl
  7817 0600-CHANGE-NAME.
  7818******************************************************************
  7819*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7820*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7821******************************************************************
  7822
  7823     IF MLNAMEL = +0 AND
  7824        MFNAMEL = +0 AND
  7825        MMINITL = +0
  7826         MOVE ER-0276                TO  EMI-ERROR
  7827         MOVE -1                     TO  MAINTL
  7828         MOVE AL-UABON               TO  MAINTA
  7829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7830         GO TO 8110-SEND-DATA.
  7831
  7832     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7833     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7834     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7835     MOVE PI-CERT-NO                 TO  CERT-NO.
  7836
  7837
  7838* EXEC CICS READ
  7839*        DATASET   (CLMS-FILE-ID)
  7840*        RIDFLD    (MSTR-KEY)
  7841*        SET       (ADDRESS OF CLAIM-MASTER)
  7842*    END-EXEC.
  7843*    MOVE '&"S        E          (   #00007688' TO DFHEIV0
  7844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7846     MOVE X'2020233030303037363838' TO DFHEIV0(25:11)
  7847     CALL 'kxdfhei1' USING DFHEIV0,
  7848           CLMS-FILE-ID,
  7849           DFHEIV20,
  7850           DFHEIV99,
  7851           MSTR-KEY,
  7852           DFHEIV99,
  7853           DFHEIV99,
  7854           DFHEIV99
  7855     SET ADDRESS OF CLAIM-MASTER TO
  7856         DFHEIV20
  7857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7858
  7859
  7860
  7861* EXEC CICS GETMAIN
  7862*        SET       (ADDRESS OF ALPHA-INDEX)
  7863*        LENGTH    (ALPH-LENGTH)
  7864*        INITIMG   (GETMAIN-SPACE)
  7865*    END-EXEC.
  7866*    MOVE ',"IL                  $   #00007694' TO DFHEIV0
  7867     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7868     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7869     MOVE X'2020233030303037363934' TO DFHEIV0(25:11)
  7870     CALL 'kxdfhei1' USING DFHEIV0,
  7871           DFHEIV20,
  7872           ALPH-LENGTH,
  7873           GETMAIN-SPACE
  7874     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 143
* EL131.cbl
  7875         DFHEIV20
  7876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7877
  7878
  7879     MOVE 'AI'                       TO  AI-RECORD-ID.
  7880     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7881                                         AI-CL-COMPANY-CD.
  7882     MOVE 'C'                        TO  AI-SOURCE
  7883                                         AI-CL-SOURCE.
  7884
  7885     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7886     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7887     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7888
  7889     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7890     MOVE '5'                        TO  DC-OPTION-CODE.
  7891     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7892     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7893     IF BUILD-YEAR IS GREATER THAN 50
  7894         MOVE '19'                   TO  WS-ALPHA-YY-1
  7895         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7896         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7897         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7898     ELSE
  7899         MOVE '20'                   TO  WS-ALPHA-YY-1
  7900         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7901         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7902         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7903
  7904     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7905                                         AI-CL-DATE.
  7906
  7907     MOVE EIBTIME                    TO  AI-TIME
  7908                                         AI-CL-TIME.
  7909
  7910     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7911     MOVE 'C'                        TO  AI-CL-SOURCE.
  7912     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7913     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7914     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7915     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7916     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7917
  7918     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7919     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7920     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7921
  7922     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7923         MOVE 'Y'                TO CL-YESNOSW
  7924     END-IF.
  7925
  7926
  7927* EXEC CICS WRITE
  7928*        DATASET   (ALPH-FILE-ID)
  7929*        RIDFLD    (AI-CONTROL-PRIMARY)
  7930*        FROM      (ALPHA-INDEX)
  7931*    END-EXEC.
  7932     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 144
* EL131.cbl
  7933      ALPHA-INDEX
  7934       TO DFHEIV11
  7935*    MOVE '&$ L                  ''   #00007747' TO DFHEIV0
  7936     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7937     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7938     MOVE X'2020233030303037373437' TO DFHEIV0(25:11)
  7939     CALL 'kxdfhei1' USING DFHEIV0,
  7940           ALPH-FILE-ID,
  7941           ALPHA-INDEX,
  7942           DFHEIV11,
  7943           AI-CONTROL-PRIMARY,
  7944           DFHEIV99,
  7945           DFHEIV99
  7946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7947
  7948
  7949
  7950* EXEC CICS READ
  7951*        DATASET   (CLMS-FILE-ID)
  7952*        RIDFLD    (MSTR-KEY)
  7953*        SET       (ADDRESS OF CLAIM-MASTER)
  7954*        UPDATE
  7955*    END-EXEC.
  7956*    MOVE '&"S        EU         (   #00007753' TO DFHEIV0
  7957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7958     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7959     MOVE X'2020233030303037373533' TO DFHEIV0(25:11)
  7960     CALL 'kxdfhei1' USING DFHEIV0,
  7961           CLMS-FILE-ID,
  7962           DFHEIV20,
  7963           DFHEIV99,
  7964           MSTR-KEY,
  7965           DFHEIV99,
  7966           DFHEIV99,
  7967           DFHEIV99
  7968     SET ADDRESS OF CLAIM-MASTER TO
  7969         DFHEIV20
  7970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7971
  7972
  7973     if (cl-priority-cd = '8')
  7974        and (pi-processor-id not = 'PEMA'and 'JMS '
  7975             AND 'AMWA' AND 'KMSB')
  7976        MOVE ER-8003             TO EMI-ERROR
  7977        PERFORM 9900-ERROR-FORMAT
  7978                                 THRU 9900-EXIT
  7979        MOVE -1                  TO MAINTL
  7980        GO TO 8110-SEND-DATA
  7981     end-if
  7982
  7983     IF MLNAMEL IS GREATER THAN +0
  7984         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7985
  7986     IF MFNAMEL IS GREATER THAN +0
  7987         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7988
  7989     IF MMINITL IS GREATER THAN +0
  7990         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 145
* EL131.cbl
  7991
  7992     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7993     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7994     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7995     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7996
  7997     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7998         MOVE 'Y'                TO CL-YESNOSW
  7999     END-IF.
  8000
  8001
  8002* EXEC CICS HANDLE CONDITION
  8003*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8004*    END-EXEC.
  8005*    MOVE '"$$                   ! $ #00007788' TO DFHEIV0
  8006     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8008     MOVE X'2420233030303037373838' TO DFHEIV0(25:11)
  8009     CALL 'kxdfhei1' USING DFHEIV0
  8010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8011
  8012
  8013
  8014* EXEC CICS REWRITE
  8015*        DATASET   (CLMS-FILE-ID)
  8016*        FROM      (CLAIM-MASTER)
  8017*    END-EXEC.
  8018     MOVE LENGTH OF
  8019      CLAIM-MASTER
  8020       TO DFHEIV11
  8021*    MOVE '&& L                  %   #00007792' TO DFHEIV0
  8022     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8023     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8024     MOVE X'2020233030303037373932' TO DFHEIV0(25:11)
  8025     CALL 'kxdfhei1' USING DFHEIV0,
  8026           CLMS-FILE-ID,
  8027           CLAIM-MASTER,
  8028           DFHEIV11,
  8029           DFHEIV99
  8030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8031
  8032
  8033 0600-CONTINUE-NAME-UPDATE.
  8034
  8035     MOVE LOW-VALUES                 TO  EL131AO.
  8036     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8037     MOVE ER-0000                    TO  EMI-ERROR.
  8038     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8039     MOVE -1                         TO  MAINTL.
  8040     GO TO 8100-SEND-MAP.
  8041
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 146
* EL131.cbl
  8043 1000-EDIT-SCREEN.
  8044
  8045     MOVE MAINTI                 TO CHECK-MAINT.
  8046
  8047     IF NOT VALID-OPTIONS
  8048         MOVE 'X'                TO ERROR-SWITCH
  8049         MOVE -1                 TO MAINTL
  8050         MOVE AL-UABON           TO MAINTA
  8051         MOVE ER-0023            TO EMI-ERROR
  8052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8053         GO TO 1010-EXIT.
  8054
  8055     IF NOT MODIFY-CAP
  8056         MOVE 'UPDATE'           TO  SM-READ
  8057         PERFORM 9995-SECURITY-VIOLATION
  8058         MOVE ER-0070               TO  EMI-ERROR
  8059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8060         GO TO 8100-SEND-MAP.
  8061
  8062     IF DELETE-CLAIM
  8063         MOVE AL-UANON TO MAINTA
  8064         GO TO 1010-EXIT.
  8065
  8066     MOVE AL-UANON               TO MAINTA.
  8067
  8068     IF CCNOI GREATER THAN LOW-VALUES
  8069         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8070
  8071     IF PI-COMPANY-ID = 'CSL'
  8072        CONTINUE
  8073     ELSE
  8074        IF TYPEL > ZERO
  8075           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8076              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8077                    PI-LIFE-OVERRIDE-L1))
  8078                       OR
  8079              ((PI-COMPANY-ID = 'DCC')
  8080              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8081                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  8082              MOVE AL-UANON      TO TYPEA
  8083              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8084           ELSE
  8085              MOVE ER-0199       TO EMI-ERROR
  8086              PERFORM 9900-ERROR-FORMAT
  8087                                 THRU 9900-EXIT
  8088              MOVE AL-UABON      TO TYPEA
  8089              MOVE -1            TO TYPEL
  8090              MOVE 'X'           TO ERROR-SWITCH
  8091           END-IF
  8092        ELSE
  8093           MOVE AL-UANOF         TO TYPEA
  8094        END-IF
  8095     END-IF
  8096     IF STATUSI GREATER THAN LOW-VALUES
  8097         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8098             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8099             MOVE AL-UANON       TO STATUSA
  8100             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 147
* EL131.cbl
  8101             MOVE 'Y'            TO DLYACTV-SW
  8102         ELSE
  8103             MOVE ER-0333        TO EMI-ERROR
  8104             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8105             MOVE AL-UABON       TO STATUSA
  8106             MOVE -1             TO STATUSL
  8107             MOVE 'X'            TO ERROR-SWITCH
  8108         END-IF
  8109     ELSE
  8110         MOVE SPACE              TO TRLR-SWITCH
  8111         MOVE 'N'                TO DLYACTV-SW
  8112         MOVE AL-UANOF           TO STATUSA.
  8113
  8114     IF PROCI GREATER THAN LOW-VALUES
  8115         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8116     ELSE
  8117         MOVE AL-UANOF TO PROCA.
  8118
  8119     IF SEXI GREATER THAN LOW-VALUES
  8120         IF SEXI = 'F' OR 'M'
  8121             MOVE AL-UANON       TO SEXA
  8122             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8123           ELSE
  8124             MOVE ER-0219        TO EMI-ERROR
  8125             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8126             MOVE AL-UABON       TO SEXA
  8127             MOVE -1             TO SEXL
  8128             MOVE 'X'            TO ERROR-SWITCH
  8129       ELSE
  8130         MOVE AL-UANOF           TO SEXA.
  8131
  8132     IF BIRTHL = +0
  8133         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8134         MOVE AL-UANOF           TO  BIRTHA
  8135         GO TO 1000-CONTINUE-EDITS.
  8136
  8137     IF BIRTHI = SPACES
  8138         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8139         MOVE 'X'                TO  UPDATE-SWITCH
  8140                                     MSTR-SWITCH
  8141         GO TO 1000-CONTINUE-EDITS.
  8142
  8143     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8144     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8145     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8146     MOVE '4'                    TO  DC-OPTION-CODE.
  8147     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8148     IF DATE-CONVERSION-ERROR
  8149         MOVE ER-0220            TO  EMI-ERROR
  8150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8151         MOVE AL-UABON           TO  BIRTHA
  8152         MOVE -1                 TO  BIRTHL
  8153         MOVE 'X'                TO  ERROR-SWITCH
  8154         GO TO 1000-CONTINUE-EDITS.
  8155
  8156******************************************************************
  8157**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8158**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 148
* EL131.cbl
  8159**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8160******************************************************************
  8161     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8162         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8163         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8164         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8165         MOVE '4'                TO  DC-OPTION-CODE
  8166         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8167         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8168                                     DC-ELAPSED-DAYS
  8169         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8170         IF DATE-CONVERSION-ERROR
  8171             MOVE ER-0220        TO  EMI-ERROR
  8172             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8173             MOVE AL-UABON       TO  BIRTHA
  8174             MOVE -1             TO  BIRTHL
  8175             MOVE 'X'            TO  ERROR-SWITCH
  8176             GO TO 1000-CONTINUE-EDITS.
  8177
  8178     MOVE AL-UANON               TO  BIRTHA.
  8179     MOVE 'X'                    TO  UPDATE-SWITCH
  8180                                     MSTR-SWITCH.
  8181     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8182     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8183     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8184
  8185 1000-CONTINUE-EDITS.
  8186
  8187     IF SOCIALI GREATER THAN LOW-VALUES
  8188         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8189         IF WS-SOC-SEC-NO NUMERIC AND
  8190           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8191             NEXT SENTENCE
  8192         ELSE
  8193            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8194               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8195               WS-SSN-DASH2 = '-'
  8196                 NEXT SENTENCE
  8197            ELSE
  8198                 MOVE ER-0887        TO  EMI-ERROR
  8199                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8200                 MOVE AL-UABON       TO  SOCIALA
  8201                 MOVE -1             TO  SOCIALL
  8202                 MOVE 'X'            TO  ERROR-SWITCH
  8203            END-IF
  8204        END-IF
  8205     END-IF.
  8206
  8207     IF SOCIALI GREATER THAN LOW-VALUES
  8208         MOVE AL-UANON           TO SOCIALA
  8209         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8210     ELSE
  8211         MOVE AL-UANOF           TO SOCIALA.
  8212
  8213     IF OCCI GREATER THAN LOW-VALUES
  8214         MOVE AL-UANON           TO OCCA
  8215         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8216     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 149
* EL131.cbl
  8217         MOVE AL-UANOF           TO OCCA.
  8218
  8219     IF BENEL NOT GREATER THAN ZERO
  8220            GO TO 1005-CONTINUE-EDITS.
  8221
  8222     IF BENEI = SPACES
  8223        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8224           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8225           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8226           IF AUTO-PAY-TO-BENE = 'Y'
  8227               MOVE ER-1773      TO  EMI-ERROR
  8228               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8229               MOVE 'X'          TO ERROR-SWITCH
  8230               MOVE AL-UABON     TO BENEA
  8231               MOVE -1           TO BENEL
  8232           ELSE
  8233               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8234           END-IF
  8235        ELSE
  8236           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8237        END-IF
  8238        GO TO 1005-CONTINUE-EDITS.
  8239
  8240
  8241* EXEC CICS HANDLE CONDITION
  8242*        NOTFND (1004-BENE-NOT-FOUND)
  8243*    END-EXEC.
  8244*    MOVE '"$I                   ! % #00008004' TO DFHEIV0
  8245     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8247     MOVE X'2520233030303038303034' TO DFHEIV0(25:11)
  8248     CALL 'kxdfhei1' USING DFHEIV0
  8249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8250
  8251
  8252     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8253     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8254     MOVE BENEI                  TO  WS-ELBENE-ID.
  8255
  8256
  8257* EXEC CICS READ
  8258*        DATASET ('ELBENE')
  8259*        RIDFLD  (WS-ELBENE-KEY)
  8260*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8261*    END-EXEC.
  8262     MOVE 'ELBENE' TO DFHEIV1
  8263*    MOVE '&"S        E          (   #00008012' TO DFHEIV0
  8264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8266     MOVE X'2020233030303038303132' TO DFHEIV0(25:11)
  8267     CALL 'kxdfhei1' USING DFHEIV0,
  8268           DFHEIV1,
  8269           DFHEIV20,
  8270           DFHEIV99,
  8271           WS-ELBENE-KEY,
  8272           DFHEIV99,
  8273           DFHEIV99,
  8274           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 150
* EL131.cbl
  8275     SET ADDRESS OF BENEFICIARY-MASTER TO
  8276         DFHEIV20
  8277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8278
  8279
  8280     MOVE AL-UANON               TO  BENEA.
  8281     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8282
  8283     GO TO 1005-CONTINUE-EDITS.
  8284
  8285 1004-BENE-NOT-FOUND.
  8286     MOVE ER-0565                TO  EMI-ERROR.
  8287
  8288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8289     MOVE 'X'                    TO ERROR-SWITCH.
  8290     MOVE AL-UABON               TO BENEA.
  8291     MOVE -1                     TO BENEL.
  8292
  8293 1005-CONTINUE-EDITS.
  8294
  8295     IF DIAGI GREATER THAN LOW-VALUES
  8296         MOVE AL-UANON           TO DIAGA
  8297         MOVE 'X'                TO UPDATE-SWITCH
  8298                                    NINETY-TRLR-SWITCH
  8299     ELSE
  8300         MOVE AL-UANOF           TO DIAGA.
  8301
  8302     IF CAUSEI GREATER THAN LOW-VALUES
  8303         MOVE AL-UANON           TO CAUSEA
  8304         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8305     ELSE
  8306         MOVE AL-UANOF           TO CAUSEA.
  8307
  8308     IF ENDL GREATER THAN ZERO
  8309         MOVE LOW-VALUES         TO HOLD-END
  8310         IF ENDI = SPACES
  8311             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8312         ELSE
  8313             MOVE ENDI           TO DEEDIT-DATE-INPUT
  8314
  8315* EXEC CICS BIF DEEDIT
  8316*                FIELD    (DEEDIT-DATE-INPUT)
  8317*                LENGTH   (DATE-LENGTH)
  8318*            END-EXEC
  8319*    MOVE '@"L                   #   #00008052' TO DFHEIV0
  8320     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8321     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8322     MOVE X'2020233030303038303532' TO DFHEIV0(25:11)
  8323     CALL 'kxdfhei1' USING DFHEIV0,
  8324           DEEDIT-DATE-INPUT,
  8325           DATE-LENGTH
  8326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8327             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8328             MOVE '4'            TO DC-OPTION-CODE
  8329             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8330             IF NOT DATE-CONVERSION-ERROR
  8331                 MOVE DC-BIN-DATE-1      TO HOLD-END
  8332                 MOVE AL-UANON   TO ENDA
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 151
* EL131.cbl
  8333                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8334                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8335             ELSE
  8336                 MOVE ER-0224    TO EMI-ERROR
  8337                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8338                 MOVE AL-UABON   TO ENDA
  8339                 MOVE -1         TO ENDL
  8340                 MOVE 'X'        TO ERROR-SWITCH
  8341       ELSE
  8342           MOVE AL-UANOF         TO ENDA.
  8343
  8344     IF INCL GREATER THAN ZERO
  8345         MOVE LOW-VALUES         TO HOLD-INCUR
  8346         IF INCI = SPACES
  8347             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8348         ELSE
  8349             MOVE INCI           TO DEEDIT-DATE-INPUT
  8350
  8351* EXEC CICS BIF DEEDIT
  8352*                FIELD    (DEEDIT-DATE-INPUT)
  8353*                LENGTH   (DATE-LENGTH)
  8354*            END-EXEC
  8355*    MOVE '@"L                   #   #00008079' TO DFHEIV0
  8356     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8357     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8358     MOVE X'2020233030303038303739' TO DFHEIV0(25:11)
  8359     CALL 'kxdfhei1' USING DFHEIV0,
  8360           DEEDIT-DATE-INPUT,
  8361           DATE-LENGTH
  8362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8363             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8364             MOVE '4'            TO DC-OPTION-CODE
  8365             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8366             IF NOT DATE-CONVERSION-ERROR
  8367                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8368                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8369                 MOVE AL-UANON           TO INCA
  8370                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8371             ELSE
  8372                 MOVE ER-0222    TO EMI-ERROR
  8373                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8374                 MOVE AL-UABON   TO INCA
  8375                 MOVE -1         TO INCL
  8376                 MOVE 'X'        TO ERROR-SWITCH
  8377       ELSE
  8378           IF PI-NO-PMTS = ZEROS
  8379               MOVE AL-UANOF     TO INCA.
  8380
  8381     IF REPL GREATER THAN ZERO
  8382         MOVE LOW-VALUES         TO HOLD-REPORTED
  8383         IF REPI = SPACES
  8384             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8385         ELSE
  8386             MOVE REPI           TO DEEDIT-DATE-INPUT
  8387
  8388* EXEC CICS BIF DEEDIT
  8389*                FIELD    (DEEDIT-DATE-INPUT)
  8390*                LENGTH   (DATE-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 152
* EL131.cbl
  8391*            END-EXEC
  8392*    MOVE '@"L                   #   #00008107' TO DFHEIV0
  8393     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8394     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8395     MOVE X'2020233030303038313037' TO DFHEIV0(25:11)
  8396     CALL 'kxdfhei1' USING DFHEIV0,
  8397           DEEDIT-DATE-INPUT,
  8398           DATE-LENGTH
  8399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8400             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8401             MOVE '4'            TO DC-OPTION-CODE
  8402             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8403             IF NOT DATE-CONVERSION-ERROR
  8404                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8405                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8406                 MOVE AL-UANON   TO REPA
  8407                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8408             ELSE
  8409                 MOVE ER-0223    TO EMI-ERROR
  8410                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8411                 MOVE AL-UABON   TO REPA
  8412                 MOVE -1         TO REPL
  8413                 MOVE 'X'        TO ERROR-SWITCH
  8414       ELSE
  8415         MOVE AL-UANOF TO REPA.
  8416
  8417     IF PDTHRUI GREATER THAN LOW-VALUES
  8418        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8419        IF PDTHRUI = SPACES
  8420           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8421        ELSE
  8422           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8423
  8424* EXEC CICS BIF DEEDIT
  8425*               FIELD    (DEEDIT-DATE-INPUT)
  8426*               LENGTH   (DATE-LENGTH)
  8427*          END-EXEC
  8428*    MOVE '@"L                   #   #00008134' TO DFHEIV0
  8429     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8430     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8431     MOVE X'2020233030303038313334' TO DFHEIV0(25:11)
  8432     CALL 'kxdfhei1' USING DFHEIV0,
  8433           DEEDIT-DATE-INPUT,
  8434           DATE-LENGTH
  8435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8436           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8437           MOVE '4'            TO DC-OPTION-CODE
  8438           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8439           IF NOT DATE-CONVERSION-ERROR
  8440              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8441              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8442              MOVE AL-UANON   TO PDTHRUA
  8443              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8444              IF PI-USES-PAID-TO
  8445                 MOVE '6'            TO DC-OPTION-CODE
  8446                 MOVE -1             TO DC-ELAPSED-DAYS
  8447                 MOVE +0             TO DC-ELAPSED-MONTHS
  8448                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 153
* EL131.cbl
  8449                 IF NO-CONVERSION-ERROR
  8450                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8451                 ELSE
  8452                    NEXT SENTENCE
  8453              ELSE
  8454                 NEXT SENTENCE
  8455           ELSE
  8456              MOVE ER-0475    TO EMI-ERROR
  8457              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8458              MOVE AL-UABON   TO PDTHRUA
  8459              MOVE -1         TO PDTHRUL
  8460              MOVE 'X'        TO ERROR-SWITCH
  8461     ELSE
  8462        IF MODIFY-CAP
  8463           MOVE AL-UANOF        TO PDTHRUA.
  8464
  8465     IF PDAMTL GREATER THAN +0
  8466         MOVE ZEROS              TO HOLD-PDAMT
  8467
  8468* EXEC CICS BIF DEEDIT
  8469*            FIELD    (PDAMTI)
  8470*            LENGTH   (9)
  8471*        END-EXEC
  8472     MOVE 9
  8473       TO DFHEIV11
  8474*    MOVE '@"L                   #   #00008169' TO DFHEIV0
  8475     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8476     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8477     MOVE X'2020233030303038313639' TO DFHEIV0(25:11)
  8478     CALL 'kxdfhei1' USING DFHEIV0,
  8479           PDAMTI,
  8480           DFHEIV11
  8481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8482         IF PDAMTI NUMERIC
  8483             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8484             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8485             MOVE AL-UNNON       TO PDAMTA
  8486         ELSE
  8487             MOVE ER-0547        TO EMI-ERROR
  8488             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8489             MOVE AL-UNBON       TO PDAMTA
  8490             MOVE -1             TO PDAMTL
  8491             MOVE 'X'            TO ERROR-SWITCH
  8492     ELSE
  8493         IF MODIFY-CAP
  8494            MOVE AL-UNNOF        TO PDAMTA.
  8495
  8496     IF NODAYSI GREATER THAN LOW-VALUES
  8497         MOVE ZEROS              TO HOLD-NODAYS
  8498
  8499* EXEC CICS BIF DEEDIT
  8500*            FIELD (NODAYSI)
  8501*            LENGTH (5)
  8502*        END-EXEC
  8503     MOVE 5
  8504       TO DFHEIV11
  8505*    MOVE '@"L                   #   #00008189' TO DFHEIV0
  8506     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 154
* EL131.cbl
  8507     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8508     MOVE X'2020233030303038313839' TO DFHEIV0(25:11)
  8509     CALL 'kxdfhei1' USING DFHEIV0,
  8510           NODAYSI,
  8511           DFHEIV11
  8512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8513         IF NODAYSI NUMERIC
  8514             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8515             MOVE AL-UNNON       TO NODAYSA
  8516             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8517         ELSE
  8518             MOVE ER-0491        TO EMI-ERROR
  8519             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8520             MOVE AL-UNBON       TO NODAYSA
  8521             MOVE -1             TO NODAYSL
  8522             MOVE 'X'            TO ERROR-SWITCH
  8523     ELSE
  8524         IF MODIFY-CAP
  8525            MOVE AL-UNNOF        TO NODAYSA.
  8526
  8527     IF NOPMTSI GREATER THAN LOW-VALUES
  8528         MOVE ZEROS              TO HOLD-NOPMTS
  8529
  8530* EXEC CICS BIF DEEDIT
  8531*            FIELD (NOPMTSI)
  8532*            LENGTH (4)
  8533*        END-EXEC
  8534     MOVE 4
  8535       TO DFHEIV11
  8536*    MOVE '@"L                   #   #00008209' TO DFHEIV0
  8537     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8538     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8539     MOVE X'2020233030303038323039' TO DFHEIV0(25:11)
  8540     CALL 'kxdfhei1' USING DFHEIV0,
  8541           NOPMTSI,
  8542           DFHEIV11
  8543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8544         IF NOPMTSI NUMERIC
  8545             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8546             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8547             MOVE AL-UNNON       TO NOPMTSA
  8548           ELSE
  8549             MOVE ER-0548        TO EMI-ERROR
  8550             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8551             MOVE AL-UNBON       TO NOPMTSA
  8552             MOVE -1             TO NOPMTSL
  8553             MOVE 'X'            TO ERROR-SWITCH
  8554       ELSE
  8555         IF MODIFY-CAP
  8556            MOVE AL-UNNOF        TO NOPMTSA.
  8557
  8558     IF FORMTYPI GREATER THAN LOW-VALUES
  8559         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8560             MOVE AL-UANON       TO FORMTYPA
  8561             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8562           ELSE
  8563             MOVE ER-7650        TO EMI-ERROR
  8564             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 155
* EL131.cbl
  8565             MOVE AL-UABON       TO FORMTYPA
  8566             MOVE -1             TO FORMTYPL
  8567             MOVE 'X'            TO ERROR-SWITCH
  8568       ELSE
  8569         MOVE AL-UANOF           TO FORMTYPA.
  8570
  8571     IF PRICDL GREATER THAN ZERO
  8572         IF (PRICDI = ' ') OR
  8573            (PRICDI GREATER THAN ZERO   AND
  8574             PRICDI NOT GREATER THAN '9')
  8575             MOVE AL-UANON       TO PRICDA
  8576             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8577         ELSE
  8578             MOVE ER-0274        TO EMI-ERROR
  8579             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8580             MOVE AL-UABON       TO PRICDA
  8581             MOVE -1             TO PRICDL
  8582             MOVE 'X'            TO ERROR-SWITCH
  8583     ELSE
  8584         MOVE AL-UANOF TO PRICDA.
  8585
  8586     IF PI-COMPANY-ID = 'DMD'
  8587     IF PRICDL GREATER THAN ZERO
  8588       IF SYSTEM-MODIFY-CAP  OR
  8589          PI-PROCESSOR-ID = 'LGXX'
  8590             NEXT SENTENCE
  8591           ELSE
  8592            IF CL-PRIORITY-CD = '9'  OR
  8593               PRICDI         = '9'
  8594                  MOVE ER-0938        TO EMI-ERROR
  8595                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8596                  MOVE AL-UABON       TO PRICDA
  8597                  MOVE -1             TO PRICDL
  8598                  MOVE 'X'            TO ERROR-SWITCH.
  8599
  8600     IF FILETOL GREATER THAN ZERO
  8601         MOVE AL-UANON           TO FILETOA
  8602         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8603     ELSE
  8604         MOVE AL-UANOF TO FILETOA.
  8605
  8606     IF SUPVL GREATER THAN ZERO
  8607         IF SUPVI = 'Y' OR 'N' OR SPACE
  8608             MOVE AL-UANON       TO SUPVA
  8609             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8610         ELSE
  8611             MOVE ER-0230        TO EMI-ERROR
  8612             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8613             MOVE AL-UABON       TO SUPVA
  8614             MOVE -1             TO SUPVL
  8615             MOVE 'X'            TO ERROR-SWITCH
  8616     ELSE
  8617         MOVE AL-UANOF           TO SUPVA.
  8618
  8619     IF MLNAMEL GREATER THAN ZERO
  8620         IF MLNAMEI GREATER THAN SPACES
  8621            MOVE AL-UANON        TO MLNAMEA
  8622            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 156
* EL131.cbl
  8623                                     MSTR-KEY-SWITCH
  8624         ELSE
  8625            MOVE ER-0236         TO EMI-ERROR
  8626            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8627            MOVE AL-UABON        TO MLNAMEA
  8628            MOVE -1              TO MLNAMEL
  8629            MOVE 'X'             TO ERROR-SWITCH
  8630     ELSE
  8631         MOVE AL-UANOF           TO MLNAMEA.
  8632
  8633     IF MFNAMEI GREATER THAN LOW-VALUES
  8634         MOVE AL-UANON           TO MFNAMEA
  8635         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8636     ELSE
  8637         MOVE AL-UANOF           TO MFNAMEA.
  8638
  8639     IF MMINITI GREATER THAN LOW-VALUES
  8640         MOVE AL-UANON           TO MMINITA
  8641         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8642     ELSE
  8643         MOVE AL-UANOF           TO MMINITA.
  8644
  8645     IF CRTLNMEI GREATER THAN LOW-VALUES
  8646         IF CRTLNMEI NOT = SPACES
  8647            MOVE AL-UANON        TO CRTLNMEA
  8648            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8649                                     CERT-KEY-SWITCH
  8650        ELSE
  8651            MOVE ER-0236         TO EMI-ERROR
  8652            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8653            MOVE AL-UABON        TO CRTLNMEA
  8654            MOVE -1              TO CRTLNMEL
  8655            MOVE 'X'             TO ERROR-SWITCH
  8656     ELSE
  8657         MOVE AL-UANOF           TO CRTLNMEA.
  8658
  8659     IF CRTFNMEI GREATER THAN LOW-VALUES
  8660         MOVE AL-UANON           TO CRTFNMEA
  8661         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8662     ELSE
  8663         MOVE AL-UANOF           TO CRTFNMEA.
  8664
  8665     IF CRTINITI GREATER THAN LOW-VALUES
  8666         MOVE AL-UANON           TO CRTINITA
  8667         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8668     ELSE
  8669         MOVE AL-UANOF           TO CRTINITA.
  8670
  8671     IF ISSAGEL GREATER THAN ZERO
  8672         IF ISSAGEI NUMERIC
  8673            MOVE AL-UANON        TO ISSAGEA
  8674            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8675         ELSE
  8676            MOVE ER-0237         TO EMI-ERROR
  8677            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8678            MOVE AL-UABON        TO ISSAGEA
  8679            MOVE -1              TO ISSAGEL
  8680            MOVE 'X'             TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 157
* EL131.cbl
  8681     ELSE
  8682         MOVE AL-UANOF           TO ISSAGEA.
  8683
  8684     IF JNTFNMEI GREATER THAN LOW-VALUES
  8685         MOVE AL-UANON           TO JNTFNMEA
  8686         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8687     ELSE
  8688         MOVE AL-UANOF           TO JNTFNMEA.
  8689
  8690     IF JNTLNMEI GREATER THAN LOW-VALUES
  8691         MOVE AL-UANON           TO JNTLNMEA
  8692         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8693     ELSE
  8694         MOVE AL-UANOF           TO JNTLNMEA.
  8695
  8696     IF JNTINITI GREATER THAN LOW-VALUES
  8697         MOVE AL-UANON           TO JNTINITA
  8698         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8699     ELSE
  8700         MOVE AL-UANOF           TO JNTINITA.
  8701
  8702     IF JNTAGEL GREATER THAN ZERO
  8703         IF JNTAGEI NUMERIC
  8704            MOVE AL-UANON        TO JNTAGEA
  8705            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8706         ELSE
  8707            MOVE ER-0238         TO EMI-ERROR
  8708            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8709            MOVE AL-UABON        TO JNTAGEA
  8710            MOVE -1              TO JNTAGEL
  8711            MOVE 'X'             TO ERROR-SWITCH
  8712     ELSE
  8713         MOVE AL-UANOF           TO JNTAGEA.
  8714
  8715     IF ADDONDTI GREATER THAN LOW-VALUES
  8716         MOVE LOW-VALUES         TO HOLD-ADDON
  8717         IF ADDONDTI = SPACES
  8718             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8719         ELSE
  8720             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8721
  8722* EXEC CICS BIF DEEDIT
  8723*                FIELD    (DEEDIT-DATE-INPUT)
  8724*                LENGTH   (DATE-LENGTH)
  8725*            END-EXEC
  8726*    MOVE '@"L                   #   #00008390' TO DFHEIV0
  8727     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8729     MOVE X'2020233030303038333930' TO DFHEIV0(25:11)
  8730     CALL 'kxdfhei1' USING DFHEIV0,
  8731           DEEDIT-DATE-INPUT,
  8732           DATE-LENGTH
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8734             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8735             MOVE '4'            TO DC-OPTION-CODE
  8736             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8737             IF NOT DATE-CONVERSION-ERROR
  8738                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 158
* EL131.cbl
  8739                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8740                                                  CERT-SWITCH
  8741                 MOVE AL-UANON   TO ADDONDTA
  8742                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8743             ELSE
  8744                 MOVE ER-7651    TO EMI-ERROR
  8745                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8746                 MOVE AL-UABON   TO ADDONDTA
  8747                 MOVE -1         TO ADDONDTL
  8748                 MOVE 'X'        TO ERROR-SWITCH
  8749       ELSE
  8750         MOVE AL-UANOF TO ADDONDTA.
  8751
  8752     IF LCVCDI GREATER THAN LOW-VALUES
  8753         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8754         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8755     ELSE
  8756         MOVE AL-UANOF           TO LCVCDA.
  8757
  8758     IF ACVCDI GREATER THAN LOW-VALUES
  8759         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8760         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8761     ELSE
  8762         MOVE AL-UANOF           TO ACVCDA.
  8763
  8764     IF LCVOTRMI GREATER THAN LOW-VALUES
  8765
  8766* EXEC CICS BIF DEEDIT
  8767*            FIELD (LCVOTRMI)
  8768*            LENGTH(3)
  8769*        END-EXEC
  8770     MOVE 3
  8771       TO DFHEIV11
  8772*    MOVE '@"L                   #   #00008425' TO DFHEIV0
  8773     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8774     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8775     MOVE X'2020233030303038343235' TO DFHEIV0(25:11)
  8776     CALL 'kxdfhei1' USING DFHEIV0,
  8777           LCVOTRMI,
  8778           DFHEIV11
  8779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8780         IF LCVOTRMI IS NUMERIC
  8781             MOVE LCVOTRMI       TO LCVOTRMO
  8782             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8783             MOVE AL-UANON       TO LCVOTRMA
  8784         ELSE
  8785             MOVE ER-0241        TO EMI-ERROR
  8786             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8787             MOVE AL-UNBON       TO LCVOTRMA
  8788             MOVE 'X'            TO ERROR-SWITCH
  8789             MOVE -1             TO LCVOTRML
  8790     ELSE
  8791         MOVE AL-UANOF           TO LCVOTRMA.
  8792
  8793     IF ACVOTRMI GREATER THAN LOW-VALUES
  8794
  8795* EXEC CICS BIF DEEDIT
  8796*            FIELD (ACVOTRMI)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 159
* EL131.cbl
  8797*            LENGTH(3)
  8798*        END-EXEC
  8799     MOVE 3
  8800       TO DFHEIV11
  8801*    MOVE '@"L                   #   #00008443' TO DFHEIV0
  8802     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8803     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8804     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
  8805     CALL 'kxdfhei1' USING DFHEIV0,
  8806           ACVOTRMI,
  8807           DFHEIV11
  8808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8809         IF ACVOTRMI IS NUMERIC
  8810             MOVE ACVOTRMI       TO ACVOTRMO
  8811             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8812             MOVE AL-UANON       TO ACVOTRMA
  8813         ELSE
  8814             MOVE ER-0241        TO EMI-ERROR
  8815             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8816             MOVE AL-UNBON       TO ACVOTRMA
  8817             MOVE 'X'            TO ERROR-SWITCH
  8818             MOVE -1             TO ACVOTRML
  8819     ELSE
  8820         MOVE AL-UANOF           TO ACVOTRMA.
  8821
  8822     IF LCVRATEL GREATER THAN +0
  8823
  8824* EXEC CICS BIF DEEDIT
  8825*            FIELD (LCVRATEI)
  8826*            LENGTH(6)
  8827*        END-EXEC
  8828     MOVE 6
  8829       TO DFHEIV11
  8830*    MOVE '@"L                   #   #00008461' TO DFHEIV0
  8831     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8832     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8833     MOVE X'2020233030303038343631' TO DFHEIV0(25:11)
  8834     CALL 'kxdfhei1' USING DFHEIV0,
  8835           LCVRATEI,
  8836           DFHEIV11
  8837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8838         IF LCVRATEI IS NUMERIC
  8839             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8840             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8841             MOVE AL-UNNON       TO LCVRATEA
  8842         ELSE
  8843             MOVE ER-2280        TO EMI-ERROR
  8844             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8845             MOVE AL-UNBON       TO LCVRATEA
  8846             MOVE 'X'            TO ERROR-SWITCH
  8847             MOVE -1             TO LCVRATEL
  8848     ELSE
  8849         MOVE AL-UNNOF           TO LCVRATEA.
  8850
  8851     IF ACVRATEL GREATER THAN +0
  8852
  8853* EXEC CICS BIF DEEDIT
  8854*            FIELD (ACVRATEI)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 160
* EL131.cbl
  8855*            LENGTH(6)
  8856*        END-EXEC
  8857     MOVE 6
  8858       TO DFHEIV11
  8859*    MOVE '@"L                   #   #00008479' TO DFHEIV0
  8860     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8861     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8862     MOVE X'2020233030303038343739' TO DFHEIV0(25:11)
  8863     CALL 'kxdfhei1' USING DFHEIV0,
  8864           ACVRATEI,
  8865           DFHEIV11
  8866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8867         IF ACVRATEI IS NUMERIC
  8868             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  8869             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8870             MOVE AL-UNNON       TO ACVRATEA
  8871         ELSE
  8872             MOVE ER-2280        TO EMI-ERROR
  8873             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8874             MOVE AL-UNBON       TO ACVRATEA
  8875             MOVE 'X'            TO ERROR-SWITCH
  8876             MOVE -1             TO ACVRATEL
  8877     ELSE
  8878         MOVE AL-UNNOF           TO ACVRATEA.
  8879
  8880     IF LCVBENEL GREATER THAN ZERO
  8881
  8882* EXEC CICS BIF DEEDIT
  8883*            FIELD (LCVBENEI)
  8884*            LENGTH (11)
  8885*        END-EXEC
  8886     MOVE 11
  8887       TO DFHEIV11
  8888*    MOVE '@"L                   #   #00008497' TO DFHEIV0
  8889     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8890     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8891     MOVE X'2020233030303038343937' TO DFHEIV0(25:11)
  8892     CALL 'kxdfhei1' USING DFHEIV0,
  8893           LCVBENEI,
  8894           DFHEIV11
  8895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8896         IF LCVBENEI IS NUMERIC
  8897            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8898            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8899            MOVE AL-UNNON        TO LCVBENEA
  8900         ELSE
  8901            MOVE ER-0243         TO EMI-ERROR
  8902            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8903            MOVE AL-UNBON        TO LCVBENEA
  8904            MOVE -1              TO LCVBENEL
  8905            MOVE 'X'             TO ERROR-SWITCH
  8906     ELSE
  8907         MOVE AL-UANOF           TO LCVBENEA.
  8908
  8909     IF ACVBENEL GREATER THAN ZERO
  8910
  8911* EXEC CICS BIF DEEDIT
  8912*            FIELD (ACVBENEI)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 161
* EL131.cbl
  8913*            LENGTH (11)
  8914*        END-EXEC
  8915     MOVE 11
  8916       TO DFHEIV11
  8917*    MOVE '@"L                   #   #00008515' TO DFHEIV0
  8918     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8919     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8920     MOVE X'2020233030303038353135' TO DFHEIV0(25:11)
  8921     CALL 'kxdfhei1' USING DFHEIV0,
  8922           ACVBENEI,
  8923           DFHEIV11
  8924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8925         IF ACVBENEI IS NUMERIC
  8926            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  8927            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8928            MOVE AL-UNNON        TO ACVBENEA
  8929         ELSE
  8930            MOVE ER-0243         TO EMI-ERROR
  8931            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8932            MOVE AL-UNBON        TO ACVBENEA
  8933            MOVE -1              TO ACVBENEL
  8934            MOVE 'X'             TO ERROR-SWITCH
  8935     ELSE
  8936         MOVE AL-UANOF           TO ACVBENEA.
  8937
  8938     IF LCVFORMI GREATER THAN LOW-VALUES
  8939        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8940        MOVE AL-UANON            TO LCVFORMA
  8941     ELSE
  8942        MOVE AL-UANOF            TO LCVFORMA.
  8943
  8944     IF ACVFORMI GREATER THAN LOW-VALUES
  8945        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8946        MOVE AL-UANON            TO ACVFORMA
  8947     ELSE
  8948        MOVE AL-UANOF            TO ACVFORMA.
  8949
  8950     IF LCVCNDTL GREATER THAN ZERO
  8951         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8952         IF LCVCNDTI = SPACES
  8953             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8954         ELSE
  8955             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8956             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8957             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8958             MOVE '4'            TO DC-OPTION-CODE
  8959             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8960             IF NOT DATE-CONVERSION-ERROR
  8961                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8962                 MOVE AL-UANON   TO LCVCNDTA
  8963                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8964                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8965             ELSE
  8966                 MOVE ER-0246    TO EMI-ERROR
  8967                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8968                 MOVE AL-UABON   TO LCVCNDTA
  8969                 MOVE -1         TO LCVCNDTL
  8970                 MOVE 'X'        TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 162
* EL131.cbl
  8971     ELSE
  8972         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8973         MOVE AL-UANOF           TO LCVCNDTA.
  8974
  8975     IF ACVCNDTL GREATER THAN ZERO
  8976         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8977         IF ACVCNDTI = SPACES
  8978             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8979         ELSE
  8980             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8981             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8982             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8983             MOVE '4'            TO DC-OPTION-CODE
  8984             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8985             IF NOT DATE-CONVERSION-ERROR
  8986                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8987                 MOVE AL-UANON   TO ACVCNDTA
  8988                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8989                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8990             ELSE
  8991                 MOVE ER-0246    TO EMI-ERROR
  8992                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8993                 MOVE AL-UABON   TO ACVCNDTA
  8994                 MOVE -1         TO ACVCNDTL
  8995                 MOVE 'X'        TO ERROR-SWITCH
  8996     ELSE
  8997         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8998         MOVE AL-UANOF           TO ACVCNDTA.
  8999
  9000     IF APRL GREATER THAN +0
  9001
  9002* EXEC CICS BIF DEEDIT
  9003*            FIELD    (APRI)
  9004*            LENGTH   (8)
  9005*        END-EXEC
  9006     MOVE 8
  9007       TO DFHEIV11
  9008*    MOVE '@"L                   #   #00008595' TO DFHEIV0
  9009     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9010     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9011     MOVE X'2020233030303038353935' TO DFHEIV0(25:11)
  9012     CALL 'kxdfhei1' USING DFHEIV0,
  9013           APRI,
  9014           DFHEIV11
  9015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9016         IF APRI NUMERIC
  9017            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9018            MOVE APRI            TO HOLD-APR APRO
  9019            MOVE AL-UANON        TO APRA
  9020          ELSE
  9021            MOVE ER-0259         TO EMI-ERROR
  9022            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9023            MOVE AL-UABON        TO APRA
  9024            MOVE -1              TO APRL
  9025            MOVE 'X'             TO ERROR-SWITCH
  9026     ELSE
  9027         MOVE AL-UANOF           TO APRA.
  9028
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 163
* EL131.cbl
  9029     IF PMTFREQL GREATER THAN ZERO
  9030
  9031* EXEC CICS BIF DEEDIT
  9032*            FIELD    (PMTFREQI)
  9033*            LENGTH   (2)
  9034*        END-EXEC
  9035     MOVE 2
  9036       TO DFHEIV11
  9037*    MOVE '@"L                   #   #00008613' TO DFHEIV0
  9038     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9039     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9040     MOVE X'2020233030303038363133' TO DFHEIV0(25:11)
  9041     CALL 'kxdfhei1' USING DFHEIV0,
  9042           PMTFREQI,
  9043           DFHEIV11
  9044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9045         IF PMTFREQI NUMERIC
  9046            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9047            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9048            MOVE AL-UANON        TO PMTFREQA
  9049          ELSE
  9050            MOVE ER-0427         TO EMI-ERROR
  9051            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9052            MOVE AL-UABON        TO PMTFREQA
  9053            MOVE -1              TO PMTFREQL
  9054            MOVE 'X'             TO ERROR-SWITCH
  9055     ELSE
  9056         MOVE AL-UANOF           TO PMTFREQA.
  9057
  9058     IF INDGRPL GREATER THAN ZERO
  9059         IF INDGRPI = 'I' OR 'G' OR SPACE
  9060             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9061             MOVE AL-UANON       TO INDGRPA
  9062          ELSE
  9063             MOVE ER-0260        TO EMI-ERROR
  9064             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9065             MOVE AL-UABON       TO INDGRPA
  9066             MOVE -1             TO INDGRPL
  9067             MOVE 'X'            TO ERROR-SWITCH
  9068     ELSE
  9069         MOVE AL-UANOF           TO INDGRPA.
  9070
  9071     IF PREMTYPL GREATER THAN ZERO
  9072         IF PREMTYPI = '1' OR '2' OR '3'
  9073            MOVE PREMTYPI        TO PI-PREM-TYPE
  9074            MOVE AL-UNNON        TO PREMTYPA
  9075            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9076          ELSE
  9077            MOVE ER-0227         TO EMI-ERROR
  9078            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9079            MOVE AL-UNBON        TO PREMTYPA
  9080            MOVE -1              TO PREMTYPL
  9081            MOVE 'X'             TO ERROR-SWITCH
  9082     ELSE
  9083         MOVE AL-UANOF           TO PREMTYPA.
  9084
  9085     IF LOANBALL GREATER THAN ZERO
  9086
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 164
* EL131.cbl
  9087* EXEC CICS BIF DEEDIT
  9088*             FIELD    (LOANBALI)
  9089*             LENGTH   (9)
  9090*        END-EXEC
  9091     MOVE 9
  9092       TO DFHEIV11
  9093*    MOVE '@"L                   #   #00008658' TO DFHEIV0
  9094     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9095     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9096     MOVE X'2020233030303038363538' TO DFHEIV0(25:11)
  9097     CALL 'kxdfhei1' USING DFHEIV0,
  9098           LOANBALI,
  9099           DFHEIV11
  9100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9101         IF LOANBALI NUMERIC
  9102             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9103             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9104             MOVE AL-UNNON TO LOANBALA
  9105         ELSE
  9106             MOVE ER-0639        TO EMI-ERROR
  9107             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9108             MOVE AL-UNBON       TO LOANBALA
  9109             MOVE -1             TO LOANBALL
  9110             MOVE 'X'            TO ERROR-SWITCH
  9111     ELSE
  9112         MOVE AL-UNNOF           TO LOANBALA.
  9113
  9114     IF LOANNOL GREATER THAN ZERO
  9115        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9116        MOVE AL-UANON            TO LOANNOA
  9117     ELSE
  9118        MOVE AL-UANOF            TO LOANNOA.
  9119
  9120     IF REINCDI GREATER THAN LOW-VALUES
  9121        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9122        MOVE AL-UANON            TO REINCDA
  9123     ELSE
  9124        MOVE AL-UANOF            TO REINCDA.
  9125
  9126     IF CERTI GREATER THAN LOW-VALUES
  9127         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9128     ELSE
  9129         MOVE AL-UANOF           TO CERTA.
  9130
  9131     IF CERTEFFI GREATER THAN LOW-VALUES
  9132         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9133     ELSE
  9134         MOVE AL-UANOF           TO CERTEFFA.
  9135
  9136     IF CERTACTI GREATER THAN LOW-VALUES
  9137         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9138     ELSE
  9139         MOVE AL-UANOF           TO CERTACTA.
  9140
  9141     IF CERTSTI GREATER THAN LOW-VALUES
  9142         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9143     ELSE
  9144         MOVE AL-UANOF           TO CERTSTA.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 165
* EL131.cbl
  9145
  9146     IF CERTCARI GREATER THAN LOW-VALUES
  9147         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9148     ELSE
  9149         MOVE AL-UANOF           TO CERTCARA.
  9150
  9151     IF DLYACTV-RECORD-NEEDED
  9152         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9153                 1150-EXIT
  9154     END-IF.
  9155
  9156     IF CERTEFFI GREATER LOW-VALUES OR
  9157        CERTACTI GREATER LOW-VALUES OR
  9158        CERTSTI  GREATER LOW-VALUES OR
  9159        CERTCARI GREATER LOW-VALUES OR
  9160        CERTGRPI GREATER LOW-VALUES
  9161        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9162
  9163*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9164*      IF PI-PREM-TYPE NOT = '1'  AND
  9165*         PI-NO-PMTS = ZEROS
  9166*          IF LOANBALL GREATER +0 OR
  9167*             ACVBENEL GREATER +0
  9168*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9169
  9170     if accswl > zeros
  9171        if accswi = 'Y' OR 'N'
  9172           MOVE 'X'              TO UPDATE-SWITCH
  9173                                    MSTR-SWITCH
  9174           MOVE AL-UANON         TO accswa
  9175        else
  9176           move er-1656          to emi-error
  9177           PERFORM 9900-ERROR-FORMAT
  9178                                 THRU 9900-EXIT
  9179           move al-uabon         to accswa
  9180           move -1               to accswl
  9181           move 'X'              to error-switch
  9182           move al-uanof         to accswa
  9183        end-if
  9184     end-if
  9185     IF CERTL = ZEROS AND
  9186        SUFXL = ZEROS
  9187          GO TO 1010-EXIT.
  9188
  9189     IF CERTL GREATER THAN ZEROS
  9190         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9191             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9192             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9193             MOVE 'X'            TO ERROR-SWITCH
  9194             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9195
  9196     IF SUFXL GREATER THAN ZEROS
  9197         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9198             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9199             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9200             MOVE 'X'            TO ERROR-SWITCH
  9201             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9202
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 166
* EL131.cbl
  9203 1010-EXIT.
  9204     EXIT.
  9205
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 167
* EL131.cbl
  9207 1120-EDIT-PROC.
  9208     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9209     MOVE '2'                    TO CNTL-REC-TYPE.
  9210     MOVE PROCI                  TO CNTL-PROC-ID.
  9211     MOVE ZERO                   TO CNTL-SEQ-NO.
  9212
  9213
  9214* EXEC CICS HANDLE CONDITION
  9215*         NOTFND    (1120-CNTL-NOTFND)
  9216*    END-EXEC.
  9217*    MOVE '"$I                   ! & #00008774' TO DFHEIV0
  9218     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9220     MOVE X'2620233030303038373734' TO DFHEIV0(25:11)
  9221     CALL 'kxdfhei1' USING DFHEIV0
  9222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9223
  9224
  9225
  9226* EXEC CICS READ
  9227*         SET      (ADDRESS OF CONTROL-FILE)
  9228*         DATASET  (CNTL-FILE-ID)
  9229*         RIDFLD   (CNTL-KEY)
  9230*    END-EXEC.
  9231*    MOVE '&"S        E          (   #00008778' TO DFHEIV0
  9232     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9234     MOVE X'2020233030303038373738' TO DFHEIV0(25:11)
  9235     CALL 'kxdfhei1' USING DFHEIV0,
  9236           CNTL-FILE-ID,
  9237           DFHEIV20,
  9238           DFHEIV99,
  9239           CNTL-KEY,
  9240           DFHEIV99,
  9241           DFHEIV99,
  9242           DFHEIV99
  9243     SET ADDRESS OF CONTROL-FILE TO
  9244         DFHEIV20
  9245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9246
  9247
  9248     MOVE AL-UANON               TO PROCA.
  9249     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9250     GO TO 1120-EXIT.
  9251
  9252 1120-CNTL-NOTFND.
  9253     MOVE ER-0273                TO EMI-ERROR.
  9254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9255     MOVE AL-UABON               TO PROCA.
  9256     MOVE -1                     TO PROCL.
  9257     MOVE 'X'                    TO ERROR-SWITCH.
  9258
  9259 1120-EXIT.
  9260     EXIT.
  9261
  9262*************************************************************
  9263*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9264*************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 168
* EL131.cbl
  9265
  9266 1150-OUTPUT-ACTIVITY-RECORD.
  9267
  9268
  9269* EXEC CICS GETMAIN
  9270*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9271*        LENGTH (25)
  9272*        INITIMG (WS-BLANK)
  9273*    END-EXEC.
  9274     MOVE 25
  9275       TO DFHEIV11
  9276*    MOVE ',"IL                  $   #00008804' TO DFHEIV0
  9277     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9278     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9279     MOVE X'2020233030303038383034' TO DFHEIV0(25:11)
  9280     CALL 'kxdfhei1' USING DFHEIV0,
  9281           DFHEIV20,
  9282           DFHEIV11,
  9283           WS-BLANK
  9284     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9285         DFHEIV20
  9286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9287
  9288
  9289     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9290     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9291     MOVE PI-CARRIER             TO DA-CARRIER.
  9292     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9293     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9294     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9295     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9296
  9297
  9298* EXEC CICS HANDLE CONDITION
  9299*        NOTOPEN (1150-NOTOPEN-ERROR)
  9300*        DUPREC (1150-EXIT)
  9301*    END-EXEC.
  9302*    MOVE '"$J%                  ! '' #00008818' TO DFHEIV0
  9303     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9305     MOVE X'2720233030303038383138' TO DFHEIV0(25:11)
  9306     CALL 'kxdfhei1' USING DFHEIV0
  9307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9308
  9309     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9310     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9311     MOVE 'A'                    TO JP-RECORD-TYPE.
  9312     MOVE +48                    TO JOURNAL-LENGTH.
  9313
  9314
  9315* EXEC CICS WRITE
  9316*        DATASET ('DLYACTV')
  9317*        RIDFLD (DA-KEY)
  9318*        FROM (DAILY-ACTIVITY-RECORD)
  9319*        LENGTH (25)
  9320*    END-EXEC.
  9321     MOVE 'DLYACTV' TO DFHEIV1
  9322     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 169
* EL131.cbl
  9323       TO DFHEIV11
  9324*    MOVE '&$ L                  ''   #00008827' TO DFHEIV0
  9325     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9327     MOVE X'2020233030303038383237' TO DFHEIV0(25:11)
  9328     CALL 'kxdfhei1' USING DFHEIV0,
  9329           DFHEIV1,
  9330           DAILY-ACTIVITY-RECORD,
  9331           DFHEIV11,
  9332           DA-KEY,
  9333           DFHEIV99,
  9334           DFHEIV99
  9335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9336
  9337
  9338     GO TO 1150-EXIT.
  9339
  9340 1150-NOTOPEN-ERROR.
  9341
  9342     MOVE '2955'                 TO EMI-ERROR.
  9343     MOVE -1                     TO MAINTL.
  9344     MOVE AL-UANON               TO MAINTA.
  9345     MOVE 'X'                    TO ERROR-SWITCH.
  9346     PERFORM 9900-ERROR-FORMAT THRU
  9347             9900-EXIT.
  9348
  9349 1150-EXIT.
  9350     EXIT.
  9351
  9352*************************************************************
  9353*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9354*************************************************************
  9355
  9356 1240-EDIT-LIFE-CODE.
  9357
  9358     IF INVALID-BENEFIT-CODE
  9359         GO TO 1240-SET-ERROR.
  9360
  9361     MOVE SPACES                 TO BENEFIT-KEY.
  9362     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9363     MOVE '4'                    TO BEN-REC-TYPE.
  9364     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9365     MOVE ZERO                   TO BEN-SEQ-NO.
  9366
  9367
  9368* EXEC CICS READ GTEQ
  9369*         DATASET  (CNTL-FILE-ID)
  9370*         RIDFLD   (BENEFIT-KEY)
  9371*         SET      (ADDRESS OF CONTROL-FILE)
  9372*    END-EXEC.
  9373*    MOVE '&"S        G          (   #00008863' TO DFHEIV0
  9374     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9376     MOVE X'2020233030303038383633' TO DFHEIV0(25:11)
  9377     CALL 'kxdfhei1' USING DFHEIV0,
  9378           CNTL-FILE-ID,
  9379           DFHEIV20,
  9380           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 170
* EL131.cbl
  9381           BENEFIT-KEY,
  9382           DFHEIV99,
  9383           DFHEIV99,
  9384           DFHEIV99
  9385     SET ADDRESS OF CONTROL-FILE TO
  9386         DFHEIV20
  9387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9388
  9389
  9390     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9391        CF-RECORD-TYPE NOT = '4'
  9392         GO TO 1240-SET-ERROR.
  9393
  9394     MOVE ZERO                   TO COUNT-2.
  9395     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9396
  9397     IF SCREEN-ERROR
  9398         GO TO 1240-SET-ERROR.
  9399
  9400 1240-SET-CODE-SWITCHES.
  9401     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9402     MOVE AL-UANON               TO LCVCDA.
  9403     GO TO 1240-EXIT.
  9404
  9405 1240-SET-ERROR.
  9406     MOVE ER-0240                TO EMI-ERROR.
  9407     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9408     MOVE 'X'                    TO ERROR-SWITCH.
  9409     MOVE AL-UABON               TO LCVCDA.
  9410     MOVE -1                     TO LCVCDL.
  9411
  9412 1240-EXIT.
  9413     EXIT.
  9414
  9415 1310-EDIT-AH-CODE.
  9416     IF INVALID-BENEFIT-CODE
  9417         GO TO 1310-SET-ERROR.
  9418
  9419     MOVE SPACES                 TO BENEFIT-KEY.
  9420     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9421     MOVE '5'                    TO BEN-REC-TYPE.
  9422     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9423     MOVE ZERO                   TO BEN-SEQ-NO.
  9424
  9425
  9426* EXEC CICS READ GTEQ
  9427*         DATASET  (CNTL-FILE-ID)
  9428*         RIDFLD   (BENEFIT-KEY)
  9429*         SET      (ADDRESS OF CONTROL-FILE)
  9430*    END-EXEC.
  9431*    MOVE '&"S        G          (   #00008904' TO DFHEIV0
  9432     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9434     MOVE X'2020233030303038393034' TO DFHEIV0(25:11)
  9435     CALL 'kxdfhei1' USING DFHEIV0,
  9436           CNTL-FILE-ID,
  9437           DFHEIV20,
  9438           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 171
* EL131.cbl
  9439           BENEFIT-KEY,
  9440           DFHEIV99,
  9441           DFHEIV99,
  9442           DFHEIV99
  9443     SET ADDRESS OF CONTROL-FILE TO
  9444         DFHEIV20
  9445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9446
  9447
  9448     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9449        CF-RECORD-TYPE NOT = '5'
  9450         GO TO 1310-SET-ERROR.
  9451
  9452     MOVE ZERO                   TO COUNT-2.
  9453     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9454     IF SCREEN-ERROR
  9455         GO TO 1310-SET-ERROR.
  9456
  9457 1310-SET-CODE-SWITCHES.
  9458     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9459     MOVE AL-UANON               TO ACVCDA.
  9460     GO TO 1310-EXIT.
  9461
  9462 1310-SET-ERROR.
  9463     MOVE ER-0250                TO EMI-ERROR.
  9464     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9465     MOVE AL-UABON               TO ACVCDA.
  9466     MOVE 'X'                    TO ERROR-SWITCH.
  9467     MOVE -1                     TO ACVCDL.
  9468
  9469 1310-EXIT.
  9470     EXIT.
  9471
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 172
* EL131.cbl
  9473 1460-EDIT-CERT-NO.
  9474     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9475     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9476
  9477     IF WS-SAVE-CERT-NO = SPACES
  9478         MOVE ER-0203            TO EMI-ERROR
  9479         GO TO 1460-CERT-NO-ERROR.
  9480
  9481     IF WS-CERT-NO-PRIME = SPACES AND
  9482        WS-CERT-NO-SUFX GREATER THAN SPACE
  9483            MOVE ER-0210         TO EMI-ERROR
  9484            GO TO 1460-CERT-NO-ERROR.
  9485
  9486     MOVE 'X'                    TO UPDATE-SWITCH.
  9487     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9488     MOVE AL-UANON               TO CERTA.
  9489
  9490     IF SUFXL IS GREATER THAN 0
  9491         MOVE AL-UANON           TO SUFXA.
  9492
  9493     GO TO 1460-EXIT.
  9494
  9495 1460-CERT-NO-ERROR.
  9496     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9497     MOVE AL-UABON               TO SUFXA.
  9498     MOVE AL-UABON               TO CERTA.
  9499     MOVE -1                     TO CERTL.
  9500     MOVE 'X'                    TO ERROR-SWITCH.
  9501
  9502 1460-EXIT.
  9503     EXIT.
  9504
  9505 1470-EDIT-EFF.
  9506     IF CERTEFFI = SPACES
  9507         GO TO 1470-DATE-ERROR.
  9508
  9509     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9510     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9511     IF DEEDIT-DATE = ZERO
  9512         GO TO 1470-DATE-ERROR.
  9513
  9514     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9515     MOVE '4'                    TO DC-OPTION-CODE.
  9516     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9517     IF NOT DATE-CONVERSION-ERROR
  9518         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9519         MOVE AL-UANON           TO CERTEFFA
  9520         MOVE 'X'                TO UPDATE-SWITCH
  9521         MOVE 'Y'                TO CERT-KEY-SWITCH
  9522         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9523         GO TO 1470-EXIT.
  9524
  9525 1470-DATE-ERROR.
  9526     MOVE ER-0215                TO EMI-ERROR.
  9527     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9528     MOVE AL-UABON               TO CERTEFFA.
  9529     MOVE -1                     TO CERTEFFL.
  9530     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 173
* EL131.cbl
  9531
  9532 1470-EXIT.
  9533     EXIT.
  9534
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 174
* EL131.cbl
  9536 1480-EDIT-ACCT.
  9537     IF CERTACTI = SPACES
  9538         MOVE ER-0232            TO EMI-ERROR
  9539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9540         MOVE AL-UABON           TO CERTACTA
  9541         MOVE -1                 TO CERTACTL
  9542         MOVE 'X'                TO ERROR-SWITCH
  9543     ELSE
  9544         MOVE 'X'                TO UPDATE-SWITCH
  9545         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9546
  9547 1480-EXIT.
  9548     EXIT.
  9549
  9550 1490-EDIT-STATE.
  9551     IF CERTSTI = SPACES
  9552         MOVE ER-0233            TO EMI-ERROR
  9553         GO TO 1490-STATE-ERROR.
  9554
  9555     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9556     MOVE '3'                    TO CNTL-REC-TYPE.
  9557     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9558     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9559     MOVE ZERO                   TO CNTL-SEQ-NO.
  9560
  9561
  9562* EXEC CICS HANDLE CONDITION
  9563*         NOTFND (1490-STATE-NOTFND)
  9564*    END-EXEC.
  9565*    MOVE '"$I                   ! ( #00009023' TO DFHEIV0
  9566     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9568     MOVE X'2820233030303039303233' TO DFHEIV0(25:11)
  9569     CALL 'kxdfhei1' USING DFHEIV0
  9570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9571
  9572
  9573
  9574* EXEC CICS READ
  9575*         SET        (ADDRESS OF CONTROL-FILE)
  9576*         DATASET    ('ELCNTL')
  9577*         RIDFLD     (CNTL-KEY)
  9578*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9579*         GENERIC
  9580*    END-EXEC.
  9581     MOVE 'ELCNTL' TO DFHEIV1
  9582*    MOVE '&"S  KG    E          (   #00009027' TO DFHEIV0
  9583     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9584     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9585     MOVE X'2020233030303039303237' TO DFHEIV0(25:11)
  9586     CALL 'kxdfhei1' USING DFHEIV0,
  9587           DFHEIV1,
  9588           DFHEIV20,
  9589           DFHEIV99,
  9590           CNTL-KEY,
  9591           CNTL-GENERIC-LENGTH,
  9592           DFHEIV99,
  9593           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 175
* EL131.cbl
  9594     SET ADDRESS OF CONTROL-FILE TO
  9595         DFHEIV20
  9596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9597
  9598
  9599     MOVE AL-UANON               TO CERTSTA.
  9600     MOVE 'X'                    TO UPDATE-SWITCH.
  9601     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9602     GO TO 1490-EXIT.
  9603
  9604 1490-STATE-NOTFND.
  9605     MOVE ER-0149                TO EMI-ERROR.
  9606
  9607 1490-STATE-ERROR.
  9608     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9609     MOVE AL-UABON               TO CERTSTA.
  9610     MOVE -1                     TO CERTSTL.
  9611     MOVE 'X'                    TO ERROR-SWITCH.
  9612
  9613 1490-EXIT.
  9614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 176
* EL131.cbl
  9616 1500-EDIT-CARR.
  9617     IF CERTCARI = SPACES
  9618         GO TO 1500-CARR-NOTFND.
  9619
  9620     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9621     MOVE '6'                    TO CNTL-REC-TYPE.
  9622     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9623     MOVE CERTCARI               TO CNTL-CARRIER.
  9624     MOVE ZERO                   TO CNTL-SEQ-NO.
  9625
  9626
  9627* EXEC CICS HANDLE CONDITION
  9628*         NOTFND   (1500-CARR-NOTFND)
  9629*    END-EXEC.
  9630*    MOVE '"$I                   ! ) #00009062' TO DFHEIV0
  9631     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9633     MOVE X'2920233030303039303632' TO DFHEIV0(25:11)
  9634     CALL 'kxdfhei1' USING DFHEIV0
  9635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9636
  9637
  9638
  9639* EXEC CICS READ
  9640*         SET        (ADDRESS OF CONTROL-FILE)
  9641*         DATASET    ('ELCNTL')
  9642*         RIDFLD     (CNTL-KEY)
  9643*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9644*         GENERIC
  9645*    END-EXEC.
  9646     MOVE 'ELCNTL' TO DFHEIV1
  9647*    MOVE '&"S  KG    E          (   #00009066' TO DFHEIV0
  9648     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9649     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9650     MOVE X'2020233030303039303636' TO DFHEIV0(25:11)
  9651     CALL 'kxdfhei1' USING DFHEIV0,
  9652           DFHEIV1,
  9653           DFHEIV20,
  9654           DFHEIV99,
  9655           CNTL-KEY,
  9656           CNTL-GENERIC-LENGTH,
  9657           DFHEIV99,
  9658           DFHEIV99
  9659     SET ADDRESS OF CONTROL-FILE TO
  9660         DFHEIV20
  9661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9662
  9663
  9664     MOVE AL-UANON               TO CERTCARA.
  9665     MOVE 'X'                    TO UPDATE-SWITCH.
  9666     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9667     GO TO 1500-EXIT.
  9668
  9669 1500-CARR-NOTFND.
  9670     MOVE ER-0360                TO EMI-ERROR.
  9671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9672     MOVE AL-UABON               TO CERTCARA.
  9673     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 177
* EL131.cbl
  9674     MOVE 'X'                    TO ERROR-SWITCH.
  9675
  9676 1500-EXIT.
  9677     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 178
* EL131.cbl
  9679 1510-DEEDIT-DATE.
  9680
  9681* EXEC CICS BIF DEEDIT
  9682*         FIELD    (DEEDIT-DATE-INPUT)
  9683*         LENGTH   (DATE-LENGTH)
  9684*    END-EXEC.
  9685*    MOVE '@"L                   #   #00009090' TO DFHEIV0
  9686     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9687     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9688     MOVE X'2020233030303039303930' TO DFHEIV0(25:11)
  9689     CALL 'kxdfhei1' USING DFHEIV0,
  9690           DEEDIT-DATE-INPUT,
  9691           DATE-LENGTH
  9692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9693
  9694
  9695 1510-EXIT.
  9696     EXIT.
  9697
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 179
* EL131.cbl
  9699 1620-VERIFY-ACCT.
  9700
  9701     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9702     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9703     MOVE PI-GROUPING            TO ACCT-GROUP.
  9704     MOVE PI-STATE               TO ACCT-STATE.
  9705     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9706
  9707     IF CERTEFFI GREATER THAN LOW-VALUES
  9708         MOVE HOLD-EFF           TO ACCT-DATE
  9709     ELSE
  9710         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9711
  9712     IF CERTACTI GREATER THAN LOW-VALUES
  9713         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9714     IF CERTSTI GREATER THAN LOW-VALUES
  9715         MOVE CERTSTI            TO  ACCT-STATE.
  9716     IF CERTCARI GREATER THAN LOW-VALUES
  9717         MOVE CERTCARI           TO  ACCT-CARRIER.
  9718     IF CERTGRPI GREATER THAN LOW-VALUES
  9719         MOVE CERTGRPI           TO ACCT-GROUP.
  9720
  9721     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9722
  9723
  9724* EXEC CICS HANDLE CONDITION
  9725*         NOTFND  (1620-ACCT-NOTFND)
  9726*    END-EXEC.
  9727*    MOVE '"$I                   ! * #00009123' TO DFHEIV0
  9728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9730     MOVE X'2A20233030303039313233' TO DFHEIV0(25:11)
  9731     CALL 'kxdfhei1' USING DFHEIV0
  9732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9733
  9734
  9735
  9736* EXEC CICS STARTBR
  9737*         DATASET   (ACCT-FILE-ID)
  9738*         RIDFLD    (ACCT-KEY)
  9739*    END-EXEC.
  9740     MOVE 0
  9741       TO DFHEIV11
  9742*    MOVE '&,         G          &   #00009127' TO DFHEIV0
  9743     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9744     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9745     MOVE X'2020233030303039313237' TO DFHEIV0(25:11)
  9746     CALL 'kxdfhei1' USING DFHEIV0,
  9747           ACCT-FILE-ID,
  9748           ACCT-KEY,
  9749           DFHEIV99,
  9750           DFHEIV11,
  9751           DFHEIV99
  9752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9753
  9754
  9755 1620-ACCT-LOOP.
  9756
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 180
* EL131.cbl
  9757
  9758* EXEC CICS READNEXT
  9759*         DATASET  (ACCT-FILE-ID)
  9760*         RIDFLD   (ACCT-KEY)
  9761*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9762*    END-EXEC.
  9763     MOVE 0
  9764       TO DFHEIV11
  9765*    MOVE '&.S                   )   #00009134' TO DFHEIV0
  9766     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9767     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9768     MOVE X'2020233030303039313334' TO DFHEIV0(25:11)
  9769     CALL 'kxdfhei1' USING DFHEIV0,
  9770           ACCT-FILE-ID,
  9771           DFHEIV20,
  9772           DFHEIV99,
  9773           ACCT-KEY,
  9774           DFHEIV99,
  9775           DFHEIV11,
  9776           DFHEIV99,
  9777           DFHEIV99
  9778     SET ADDRESS OF ACCOUNT-MASTER TO
  9779         DFHEIV20
  9780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9781
  9782
  9783     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9784         GO TO 1620-ACCT-NOTFND.
  9785
  9786     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9787        HOLD-EFF     LESS AM-EXPIRATION-DT
  9788         NEXT SENTENCE
  9789     ELSE
  9790         GO TO 1620-ACCT-LOOP.
  9791
  9792     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9793         GO TO 1620-ACCT-END-BROWSE.
  9794
  9795     IF LOANBALL GREATER THAN +0
  9796         IF AM-MAX-TOT-BEN NUMERIC  AND
  9797            AM-MAX-TOT-BEN GREATER THAN ZERO
  9798             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9799                 MOVE AL-UNBON     TO LOANBALA
  9800                 MOVE -1           TO LOANBALL
  9801                 MOVE 'X'          TO ERROR-SWITCH
  9802                 MOVE ER-7641      TO EMI-ERROR
  9803                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9804
  9805     IF ACVBENEL GREATER THAN +0
  9806         IF AM-MAX-MON-BEN NUMERIC  AND
  9807            AM-MAX-MON-BEN GREATER THAN ZERO
  9808             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9809                 MOVE AL-UNBON     TO ACVBENEA
  9810                 MOVE -1           TO ACVBENEL
  9811                 MOVE 'X'          TO ERROR-SWITCH
  9812                 MOVE ER-7642      TO EMI-ERROR
  9813                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9814
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 181
* EL131.cbl
  9815 1620-ACCT-END-BROWSE.
  9816
  9817
  9818* EXEC CICS ENDBR
  9819*         DATASET (ACCT-FILE-ID)
  9820*    END-EXEC.
  9821     MOVE 0
  9822       TO DFHEIV11
  9823*    MOVE '&2                    $   #00009174' TO DFHEIV0
  9824     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9825     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9826     MOVE X'2020233030303039313734' TO DFHEIV0(25:11)
  9827     CALL 'kxdfhei1' USING DFHEIV0,
  9828           ACCT-FILE-ID,
  9829           DFHEIV11,
  9830           DFHEIV99
  9831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9832
  9833
  9834     GO TO 1620-EXIT.
  9835
  9836 1620-ACCT-NOTFND.
  9837
  9838     MOVE -1                     TO MAINTL.
  9839     MOVE 'X'                    TO ERROR-SWITCH.
  9840     MOVE ER-0426                TO EMI-ERROR.
  9841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9842
  9843 1620-EXIT.
  9844     EXIT.
  9845
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 182
* EL131.cbl
  9847 2000-UPDATE-CLAIM.
  9848
  9849     MOVE SPACES                 TO ERROR-SWITCH.
  9850     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9851     MOVE PI-CARRIER             TO CARRIER-CODE.
  9852     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9853     MOVE PI-CERT-NO             TO CERT-NO.
  9854
  9855     IF DELETE-CLAIM
  9856         GO TO 3000-DELETE-CLAIM.
  9857
  9858     IF  NOT MODIFY-CAP
  9859         MOVE ER-0070            TO EMI-ERROR
  9860         MOVE 'X'                TO ERROR-SWITCH
  9861         MOVE -1                 TO MAINTL
  9862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9863         GO TO 2000-EXIT.
  9864
  9865     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9866     MOVE ZERO                   TO TRLR-SEQ-NO.
  9867
  9868
  9869* EXEC CICS READ UPDATE
  9870*         SET       (ADDRESS OF CLAIM-MASTER)
  9871*         DATASET   (CLMS-FILE-ID)
  9872*         RIDFLD    (MSTR-KEY)
  9873*    END-EXEC.
  9874*    MOVE '&"S        EU         (   #00009212' TO DFHEIV0
  9875     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9876     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9877     MOVE X'2020233030303039323132' TO DFHEIV0(25:11)
  9878     CALL 'kxdfhei1' USING DFHEIV0,
  9879           CLMS-FILE-ID,
  9880           DFHEIV20,
  9881           DFHEIV99,
  9882           MSTR-KEY,
  9883           DFHEIV99,
  9884           DFHEIV99,
  9885           DFHEIV99
  9886     SET ADDRESS OF CLAIM-MASTER TO
  9887         DFHEIV20
  9888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9889
  9890
  9891     if (incl > zeros)
  9892        and (cl-no-of-pmts-made > 0)
  9893        and (hold-incur > low-values)
  9894        and (hold-incur not = cl-incurred-dt)
  9895        if hold-incur > cl-incurred-dt
  9896           move cl-incurred-dt   to dc-bin-date-1
  9897           move hold-incur       to dc-bin-date-2
  9898        else
  9899           move hold-incur       to dc-bin-date-1
  9900           move cl-incurred-dt   to dc-bin-date-2
  9901        end-if
  9902        move '1'                 to dc-option-code
  9903        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9904        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 183
* EL131.cbl
  9905           MOVE ER-1663             TO EMI-ERROR
  9906           PERFORM 9900-ERROR-FORMAT
  9907                                 THRU 9900-EXIT
  9908           MOVE -1                  TO MAINTL
  9909           GO TO 8110-SEND-DATA
  9910        end-if
  9911     end-if
  9912     IF (CL-PRIORITY-CD = '8')
  9913        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  9914             AND 'AMWA' AND 'KMSB')
  9915        MOVE ER-8003             TO EMI-ERROR
  9916        PERFORM 9900-ERROR-FORMAT
  9917                                 THRU 9900-EXIT
  9918        MOVE -1                  TO MAINTL
  9919        GO TO 8110-SEND-DATA
  9920     END-IF
  9921
  9922     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9923         MOVE ER-0068            TO EMI-ERROR
  9924         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9925         GO TO 2000-EXIT.
  9926
  9927     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9928         MOVE ER-0068            TO EMI-ERROR
  9929         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9930         GO TO 2000-EXIT.
  9931
  9932     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9933         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9934
  9935     IF CL-PURGED-DT NOT = LOW-VALUES
  9936         MOVE ER-7691            TO EMI-ERROR
  9937         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9938         GO TO 2000-EXIT.
  9939
  9940     IF CERT-KEY-CHANGED
  9941         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9942
  9943     IF SCREEN-ERROR
  9944         MOVE ER-0068            TO EMI-ERROR
  9945         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9946         GO TO 2000-EXIT.
  9947
  9948     IF NINETY-TRLR-UPDATED
  9949         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9950
  9951     IF MSTR-KEY-CHANGED
  9952         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9953        ELSE
  9954         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9955
  9956     IF TRLR-UPDATE-REQUIRED
  9957         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9958
  9959 2000-CHECK-CERT.
  9960     IF NOT CERT-UPDATES
  9961         GO TO 2000-EXIT.
  9962
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 184
* EL131.cbl
  9963     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9964     MOVE PI-CARRIER             TO CERT-CARRIER.
  9965     MOVE PI-GROUPING            TO CERT-GROUP.
  9966     MOVE PI-STATE               TO CERT-STATE.
  9967     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9968     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9969     MOVE PI-CERT-NO             TO CERT-CERT.
  9970
  9971     IF CERT-ALT-KEY-CHANGED
  9972         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9973     ELSE
  9974         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9975
  9976 2000-EXIT.
  9977     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 185
* EL131.cbl
  9979 2010-RELEASE-REC.
  9980
  9981* EXEC CICS UNLOCK
  9982*         DATASET  (CLMS-FILE-ID)
  9983*    END-EXEC
  9984*    MOVE '&*                    #   #00009307' TO DFHEIV0
  9985     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9986     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9987     MOVE X'2020233030303039333037' TO DFHEIV0(25:11)
  9988     CALL 'kxdfhei1' USING DFHEIV0,
  9989           CLMS-FILE-ID,
  9990           DFHEIV99
  9991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9992
  9993     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9994     MOVE 'X'                    TO ERROR-SWITCH.
  9995
  9996 2010-EXIT.
  9997     EXIT.
  9998
  9999 2020-NORMAL-UPDATE.
 10000     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10001
 10002     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10003
 10004     IF WS-OPEN-CLOSE-SW = 'Y'
 10005       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10006       IF PI-REC-FOUND-SW = 'Y'
 10007         IF CL-ACTIVITY-CODE = 09
 10008           NEXT SENTENCE
 10009         ELSE
 10010           IF WS-RESET-SW = 'Y'
 10011             IF CL-CLAIM-STATUS = 'C'
 10012               MOVE 07               TO  CL-ACTIVITY-CODE
 10013               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10014               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10015             ELSE
 10016               MOVE 08               TO  CL-ACTIVITY-CODE
 10017               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10018               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10019
 10020     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10021         MOVE 'Y'                TO CL-YESNOSW
 10022     END-IF.
 10023
 10024     if pi-company-id = 'DCC'
 10025        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10026        perform 2120-check-pdef  thru 2120-exit
 10027     end-if
 10028
 10029* EXEC CICS HANDLE CONDITION
 10030*         DUPKEY   (2020-EXIT)
 10031*    END-EXEC.
 10032*    MOVE '"$$                   ! + #00009346' TO DFHEIV0
 10033     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10035     MOVE X'2B20233030303039333436' TO DFHEIV0(25:11)
 10036     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 186
* EL131.cbl
 10037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10038
 10039
 10040
 10041* EXEC CICS REWRITE
 10042*         DATASET   (CLMS-FILE-ID)
 10043*         FROM      (CLAIM-MASTER)
 10044*    END-EXEC.
 10045     MOVE LENGTH OF
 10046      CLAIM-MASTER
 10047       TO DFHEIV11
 10048*    MOVE '&& L                  %   #00009350' TO DFHEIV0
 10049     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10050     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10051     MOVE X'2020233030303039333530' TO DFHEIV0(25:11)
 10052     CALL 'kxdfhei1' USING DFHEIV0,
 10053           CLMS-FILE-ID,
 10054           CLAIM-MASTER,
 10055           DFHEIV11,
 10056           DFHEIV99
 10057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10058
 10059
 10060 2020-EXIT.
 10061     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 187
* EL131.cbl
 10063 2030-KEY-UPDATE.
 10064     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10065
 10066
 10067* EXEC CICS DELETE
 10068*        DATASET  (CLMS-FILE-ID)
 10069*    END-EXEC.
 10070*    MOVE '&(                    &   #00009361' TO DFHEIV0
 10071     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10072     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10073     MOVE X'2020233030303039333631' TO DFHEIV0(25:11)
 10074     CALL 'kxdfhei1' USING DFHEIV0,
 10075           CLMS-FILE-ID,
 10076           DFHEIV99,
 10077           DFHEIV99,
 10078           DFHEIV99,
 10079           DFHEIV99
 10080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10081
 10082
 10083
 10084* EXEC CICS GETMAIN
 10085*         SET      (ADDRESS OF CLAIM-MASTER)
 10086*         LENGTH   (MSTR-LENGTH)
 10087*         INITIMG  (GETMAIN-SPACE)
 10088*    END-EXEC.
 10089*    MOVE ',"IL                  $   #00009365' TO DFHEIV0
 10090     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10091     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10092     MOVE X'2020233030303039333635' TO DFHEIV0(25:11)
 10093     CALL 'kxdfhei1' USING DFHEIV0,
 10094           DFHEIV20,
 10095           MSTR-LENGTH,
 10096           GETMAIN-SPACE
 10097     SET ADDRESS OF CLAIM-MASTER TO
 10098         DFHEIV20
 10099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10100
 10101
 10102     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10103
 10104     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10105
 10106     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10107
 10108     IF WS-OPEN-CLOSE-SW = 'Y'
 10109       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10110         IF PI-REC-FOUND-SW = 'Y'
 10111           IF CL-ACTIVITY-CODE = 09
 10112             NEXT SENTENCE
 10113           ELSE
 10114             IF WS-RESET-SW = 'Y'
 10115               IF CL-CLAIM-STATUS = 'C'
 10116                 MOVE 07             TO  CL-ACTIVITY-CODE
 10117                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10118                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10119               ELSE
 10120                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 188
* EL131.cbl
 10121                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10122                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10123
 10124
 10125* EXEC CICS HANDLE CONDITION
 10126*         DUPKEY    (2030-EXIT)
 10127*    END-EXEC.
 10128*    MOVE '"$$                   ! , #00009393' TO DFHEIV0
 10129     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10131     MOVE X'2C20233030303039333933' TO DFHEIV0(25:11)
 10132     CALL 'kxdfhei1' USING DFHEIV0
 10133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10134
 10135
 10136** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10137*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10138
 10139     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10140         MOVE 'Y'                TO CL-YESNOSW
 10141     END-IF.
 10142
 10143
 10144* EXEC CICS WRITE
 10145*         DATASET   (CLMS-FILE-ID)
 10146*         RIDFLD    (MSTR-KEY)
 10147*         FROM      (CLAIM-MASTER)
 10148*    END-EXEC.
 10149     MOVE LENGTH OF
 10150      CLAIM-MASTER
 10151       TO DFHEIV11
 10152*    MOVE '&$ L                  ''   #00009404' TO DFHEIV0
 10153     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10154     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10155     MOVE X'2020233030303039343034' TO DFHEIV0(25:11)
 10156     CALL 'kxdfhei1' USING DFHEIV0,
 10157           CLMS-FILE-ID,
 10158           CLAIM-MASTER,
 10159           DFHEIV11,
 10160           MSTR-KEY,
 10161           DFHEIV99,
 10162           DFHEIV99
 10163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10164
 10165
 10166 2030-EXIT.
 10167     EXIT.
 10168
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 189
* EL131.cbl
 10170 2040-NORMAL-UPDATE.
 10171
 10172* EXEC CICS READ UPDATE
 10173*         DATASET  (CERT-FILE-ID)
 10174*         RIDFLD   (CERT-KEY)
 10175*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10176*    END-EXEC.
 10177*    MOVE '&"S        EU         (   #00009415' TO DFHEIV0
 10178     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10179     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10180     MOVE X'2020233030303039343135' TO DFHEIV0(25:11)
 10181     CALL 'kxdfhei1' USING DFHEIV0,
 10182           CERT-FILE-ID,
 10183           DFHEIV20,
 10184           DFHEIV99,
 10185           CERT-KEY,
 10186           DFHEIV99,
 10187           DFHEIV99,
 10188           DFHEIV99
 10189     SET ADDRESS OF CERTIFICATE-MASTER TO
 10190         DFHEIV20
 10191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10192
 10193
 10194     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10195
 10196
 10197* EXEC CICS HANDLE CONDITION
 10198*         DUPKEY   (2040-EXIT)
 10199*    END-EXEC.
 10200*    MOVE '"$$                   ! - #00009423' TO DFHEIV0
 10201     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10203     MOVE X'2D20233030303039343233' TO DFHEIV0(25:11)
 10204     CALL 'kxdfhei1' USING DFHEIV0
 10205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10206
 10207
 10208
 10209* EXEC CICS REWRITE
 10210*         DATASET  (CERT-FILE-ID)
 10211*         FROM     (CERTIFICATE-MASTER)
 10212*    END-EXEC.
 10213     MOVE LENGTH OF
 10214      CERTIFICATE-MASTER
 10215       TO DFHEIV11
 10216*    MOVE '&& L                  %   #00009427' TO DFHEIV0
 10217     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10218     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10219     MOVE X'2020233030303039343237' TO DFHEIV0(25:11)
 10220     CALL 'kxdfhei1' USING DFHEIV0,
 10221           CERT-FILE-ID,
 10222           CERTIFICATE-MASTER,
 10223           DFHEIV11,
 10224           DFHEIV99
 10225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10226
 10227
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 190
* EL131.cbl
 10228 2040-EXIT.
 10229     EXIT.
 10230
 10231 2050-KEY-UPDATE.
 10232
 10233* EXEC CICS READ UPDATE
 10234*         DATASET  (CERT-FILE-ID)
 10235*         RIDFLD   (CERT-KEY)
 10236*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10237*    END-EXEC.
 10238*    MOVE '&"S        EU         (   #00009436' TO DFHEIV0
 10239     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10240     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10241     MOVE X'2020233030303039343336' TO DFHEIV0(25:11)
 10242     CALL 'kxdfhei1' USING DFHEIV0,
 10243           CERT-FILE-ID,
 10244           DFHEIV20,
 10245           DFHEIV99,
 10246           CERT-KEY,
 10247           DFHEIV99,
 10248           DFHEIV99,
 10249           DFHEIV99
 10250     SET ADDRESS OF CERTIFICATE-MASTER TO
 10251         DFHEIV20
 10252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10253
 10254
 10255     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10256
 10257
 10258* EXEC CICS DELETE
 10259*         DATASET   (CERT-FILE-ID)
 10260*    END-EXEC.
 10261*    MOVE '&(                    &   #00009444' TO DFHEIV0
 10262     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10263     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10264     MOVE X'2020233030303039343434' TO DFHEIV0(25:11)
 10265     CALL 'kxdfhei1' USING DFHEIV0,
 10266           CERT-FILE-ID,
 10267           DFHEIV99,
 10268           DFHEIV99,
 10269           DFHEIV99,
 10270           DFHEIV99
 10271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10272
 10273
 10274
 10275* EXEC CICS GETMAIN
 10276*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10277*         LENGTH    (CERT-LENGTH)
 10278*         INITIMG   (GETMAIN-SPACE)
 10279*    END-EXEC.
 10280*    MOVE ',"IL                  $   #00009448' TO DFHEIV0
 10281     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10282     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10283     MOVE X'2020233030303039343438' TO DFHEIV0(25:11)
 10284     CALL 'kxdfhei1' USING DFHEIV0,
 10285           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 191
* EL131.cbl
 10286           CERT-LENGTH,
 10287           GETMAIN-SPACE
 10288     SET ADDRESS OF CERTIFICATE-MASTER TO
 10289         DFHEIV20
 10290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10291
 10292
 10293     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10294
 10295     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10296
 10297
 10298* EXEC CICS HANDLE CONDITION
 10299*         DUPKEY (2050-EXIT)
 10300*    END-EXEC.
 10301*    MOVE '"$$                   ! . #00009458' TO DFHEIV0
 10302     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10304     MOVE X'2E20233030303039343538' TO DFHEIV0(25:11)
 10305     CALL 'kxdfhei1' USING DFHEIV0
 10306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10307
 10308
 10309
 10310* EXEC CICS WRITE
 10311*         DATASET  (CERT-FILE-ID)
 10312*         RIDFLD   (CERT-KEY)
 10313*         FROM     (CERTIFICATE-MASTER)
 10314*    END-EXEC.
 10315     MOVE LENGTH OF
 10316      CERTIFICATE-MASTER
 10317       TO DFHEIV11
 10318*    MOVE '&$ L                  ''   #00009462' TO DFHEIV0
 10319     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10320     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10321     MOVE X'2020233030303039343632' TO DFHEIV0(25:11)
 10322     CALL 'kxdfhei1' USING DFHEIV0,
 10323           CERT-FILE-ID,
 10324           CERTIFICATE-MASTER,
 10325           DFHEIV11,
 10326           CERT-KEY,
 10327           DFHEIV99,
 10328           DFHEIV99
 10329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10330
 10331
 10332 2050-EXIT.
 10333     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 192
* EL131.cbl
 10335 2060-CHANGE-CERT.
 10336     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10337     MOVE PI-CARRIER             TO CERT-CARRIER.
 10338     MOVE PI-GROUPING            TO CERT-GROUP.
 10339     MOVE PI-STATE               TO CERT-STATE.
 10340     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10341     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10342     MOVE PI-CERT-NO             TO CERT-CERT.
 10343     IF CERTEFFI GREATER THAN LOW-VALUES
 10344         MOVE HOLD-EFF           TO CERT-DATE.
 10345     IF CERTACTI GREATER THAN LOW-VALUES
 10346         MOVE CERTACTI           TO CERT-ACCOUNT.
 10347     IF CERTSTI GREATER THAN LOW-VALUES
 10348         MOVE CERTSTI            TO CERT-STATE.
 10349     IF CERTCARI GREATER THAN LOW-VALUES
 10350         MOVE CERTCARI           TO CERT-CARRIER.
 10351     IF CERTGRPI GREATER THAN LOW-VALUES
 10352         MOVE CERTGRPI           TO CERT-GROUP.
 10353     IF CERTI GREATER THAN LOW-VALUES
 10354         MOVE CERTI              TO CERT-CERT-PRIME.
 10355     IF SUFXI GREATER THAN LOW-VALUES
 10356         MOVE SUFXI              TO CERT-CERT-SUFX.
 10357
 10358
 10359* EXEC CICS HANDLE CONDITION
 10360*         NOTFND   (2060-CERT-NOTFND)
 10361*    END-EXEC.
 10362*    MOVE '"$I                   ! / #00009494' TO DFHEIV0
 10363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10365     MOVE X'2F20233030303039343934' TO DFHEIV0(25:11)
 10366     CALL 'kxdfhei1' USING DFHEIV0
 10367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10368
 10369
 10370
 10371* EXEC CICS READ UPDATE
 10372*         DATASET  (CERT-FILE-ID)
 10373*         RIDFLD   (CERT-KEY)
 10374*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10375*    END-EXEC.
 10376*    MOVE '&"S        EU         (   #00009498' TO DFHEIV0
 10377     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10378     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10379     MOVE X'2020233030303039343938' TO DFHEIV0(25:11)
 10380     CALL 'kxdfhei1' USING DFHEIV0,
 10381           CERT-FILE-ID,
 10382           DFHEIV20,
 10383           DFHEIV99,
 10384           CERT-KEY,
 10385           DFHEIV99,
 10386           DFHEIV99,
 10387           DFHEIV99
 10388     SET ADDRESS OF CERTIFICATE-MASTER TO
 10389         DFHEIV20
 10390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10391
 10392
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 193
* EL131.cbl
 10393     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10394
 10395     IF CM-CLAIM-INTERFACE-SW = SPACES
 10396        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10397
 10398
 10399* EXEC CICS HANDLE CONDITION
 10400*         DUPKEY   (2060-DUPKEY)
 10401*    END-EXEC.
 10402*    MOVE '"$$                   ! 0 #00009509' TO DFHEIV0
 10403     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10405     MOVE X'3020233030303039353039' TO DFHEIV0(25:11)
 10406     CALL 'kxdfhei1' USING DFHEIV0
 10407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10408
 10409
 10410
 10411* EXEC CICS REWRITE
 10412*         DATASET  (CERT-FILE-ID)
 10413*         FROM     (CERTIFICATE-MASTER)
 10414*    END-EXEC.
 10415     MOVE LENGTH OF
 10416      CERTIFICATE-MASTER
 10417       TO DFHEIV11
 10418*    MOVE '&& L                  %   #00009513' TO DFHEIV0
 10419     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10420     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10421     MOVE X'2020233030303039353133' TO DFHEIV0(25:11)
 10422     CALL 'kxdfhei1' USING DFHEIV0,
 10423           CERT-FILE-ID,
 10424           CERTIFICATE-MASTER,
 10425           DFHEIV11,
 10426           DFHEIV99
 10427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10428
 10429
 10430 2060-DUPKEY.
 10431
 10432     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10433
 10434 2060-CHANGE-TRLR-ACTQ.
 10435     IF SCREEN-ERROR
 10436         GO TO 2060-EXIT.
 10437
 10438     IF CERTI    GREATER LOW-VALUES OR
 10439        SUFXI    GREATER LOW-VALUES OR
 10440        CERTCARI GREATER LOW-VALUES
 10441         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10442         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10443
 10444     MOVE SPACES                 TO CERT-KEY-SWITCH
 10445                                    CERT-SWITCH
 10446                                    TRLR-SWITCH
 10447                                    NINETY-TRLR-SWITCH.
 10448     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10449     GO TO 2060-EXIT.
 10450
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 194
* EL131.cbl
 10451 2060-CERT-NOTFND.
 10452     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10453
 10454     IF WS-REC-FOUND-SW = 'N'
 10455         MOVE ER-0206            TO  EMI-ERROR
 10456         MOVE -1                 TO  MAINTL
 10457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10458
 10459* EXEC CICS UNLOCK
 10460*            DATASET   (CLMS-FILE-ID)
 10461*        END-EXEC
 10462*    MOVE '&*                    #   #00009546' TO DFHEIV0
 10463     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10464     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10465     MOVE X'2020233030303039353436' TO DFHEIV0(25:11)
 10466     CALL 'kxdfhei1' USING DFHEIV0,
 10467           CLMS-FILE-ID,
 10468           DFHEIV99
 10469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10470         GO TO 8110-SEND-DATA.
 10471
 10472     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10473
 10474     GO TO 2060-CHANGE-TRLR-ACTQ.
 10475
 10476 2060-EXIT.
 10477     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 195
* EL131.cbl
 10479 2070-CHECK-OLD.
 10480
 10481
 10482* EXEC CICS HANDLE CONDITION
 10483*        NOTFND   (2070-NOT-FOUND)
 10484*    END-EXEC.
 10485*    MOVE '"$I                   ! 1 #00009560' TO DFHEIV0
 10486     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10488     MOVE X'3120233030303039353630' TO DFHEIV0(25:11)
 10489     CALL 'kxdfhei1' USING DFHEIV0
 10490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10491
 10492
 10493     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10494     MOVE PI-CARRIER             TO CERT-CARRIER.
 10495     MOVE PI-GROUPING            TO CERT-GROUP.
 10496     MOVE PI-STATE               TO CERT-STATE.
 10497     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10498     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10499     MOVE PI-CERT-NO             TO CERT-CERT.
 10500
 10501
 10502* EXEC CICS READ UPDATE
 10503*         DATASET  (CERT-FILE-ID)
 10504*         RIDFLD   (CERT-KEY)
 10505*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10506*    END-EXEC.
 10507*    MOVE '&"S        EU         (   #00009572' TO DFHEIV0
 10508     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10509     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10510     MOVE X'2020233030303039353732' TO DFHEIV0(25:11)
 10511     CALL 'kxdfhei1' USING DFHEIV0,
 10512           CERT-FILE-ID,
 10513           DFHEIV20,
 10514           DFHEIV99,
 10515           CERT-KEY,
 10516           DFHEIV99,
 10517           DFHEIV99,
 10518           DFHEIV99
 10519     SET ADDRESS OF CERTIFICATE-MASTER TO
 10520         DFHEIV20
 10521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10522
 10523
 10524     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10525     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10526     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10527
 10528     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10529         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10530
 10531     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10532       AND
 10533        CERT-WAS-CREATED-FOR-CLAIM
 10534         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10535
 10536* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 196
* EL131.cbl
 10537*             DATASET   (CERT-FILE-ID)
 10538*        END-EXEC
 10539*    MOVE '&(                    &   #00009589' TO DFHEIV0
 10540     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10542     MOVE X'2020233030303039353839' TO DFHEIV0(25:11)
 10543     CALL 'kxdfhei1' USING DFHEIV0,
 10544           CERT-FILE-ID,
 10545           DFHEIV99,
 10546           DFHEIV99,
 10547           DFHEIV99,
 10548           DFHEIV99
 10549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10550         GO TO 2070-EXIT.
 10551
 10552     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10553         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10554
 10555
 10556* EXEC CICS HANDLE CONDITION
 10557*         DUPKEY   (2070-EXIT)
 10558*    END-EXEC.
 10559*    MOVE '"$$                   ! 2 #00009597' TO DFHEIV0
 10560     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10562     MOVE X'3220233030303039353937' TO DFHEIV0(25:11)
 10563     CALL 'kxdfhei1' USING DFHEIV0
 10564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10565
 10566
 10567
 10568* EXEC CICS REWRITE
 10569*         DATASET  (CERT-FILE-ID)
 10570*         FROM     (CERTIFICATE-MASTER)
 10571*    END-EXEC.
 10572     MOVE LENGTH OF
 10573      CERTIFICATE-MASTER
 10574       TO DFHEIV11
 10575*    MOVE '&& L                  %   #00009601' TO DFHEIV0
 10576     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10577     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10578     MOVE X'2020233030303039363031' TO DFHEIV0(25:11)
 10579     CALL 'kxdfhei1' USING DFHEIV0,
 10580           CERT-FILE-ID,
 10581           CERTIFICATE-MASTER,
 10582           DFHEIV11,
 10583           DFHEIV99
 10584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10585
 10586
 10587     GO TO 2070-EXIT.
 10588
 10589 2070-NOT-FOUND.
 10590     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10591
 10592 2070-EXIT.
 10593     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 197
* EL131.cbl
 10595 2080-CREATE-CERT.
 10596
 10597* EXEC CICS GETMAIN
 10598*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10599*         LENGTH    (CERT-LENGTH)
 10600*         INITIMG   (GETMAIN-SPACE)
 10601*    END-EXEC.
 10602*    MOVE ',"IL                  $   #00009615' TO DFHEIV0
 10603     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10604     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10605     MOVE X'2020233030303039363135' TO DFHEIV0(25:11)
 10606     CALL 'kxdfhei1' USING DFHEIV0,
 10607           DFHEIV20,
 10608           CERT-LENGTH,
 10609           GETMAIN-SPACE
 10610     SET ADDRESS OF CERTIFICATE-MASTER TO
 10611         DFHEIV20
 10612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10613
 10614
 10615     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10616
 10617     IF CERTEFFI GREATER THAN LOW-VALUES
 10618         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10619                                    DC-BIN-DATE-1
 10620         MOVE '6'                TO DC-OPTION-CODE
 10621         MOVE +1                 TO DC-ELAPSED-MONTHS
 10622         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10623         IF NO-CONVERSION-ERROR
 10624             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10625
 10626     IF CERTACTI GREATER THAN LOW-VALUES
 10627         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10628     IF CERTSTI GREATER THAN LOW-VALUES
 10629         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10630     IF CERTCARI GREATER THAN LOW-VALUES
 10631         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10632     IF CERTGRPI GREATER THAN LOW-VALUES
 10633         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10634     IF CERTI GREATER THAN LOW-VALUES
 10635         MOVE CERTI              TO CERT-CERT-PRIME
 10636                                    CM-CERT-PRIME
 10637         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10638
 10639     IF SUFXI GREATER THAN LOW-VALUES
 10640         MOVE SUFXI              TO CERT-CERT-SUFX
 10641                                    CM-CERT-SFX
 10642         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10643
 10644     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10645
 10646     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10647
 10648     MOVE SPACES                 TO CM-ENTRY-BATCH
 10649                                    CM-LF-EXIT-BATCH
 10650                                    CM-AH-EXIT-BATCH
 10651                                    CM-CREDIT-INTERFACE-SW-1
 10652                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 198
* EL131.cbl
 10653
 10654     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10655                               '9' OR 'D' OR 'V'
 10656         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10657
 10658     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10659                               '9' OR 'D' OR 'V'
 10660         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10661
 10662     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10663                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10664     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10665
 10666
 10667* EXEC CICS HANDLE CONDITION
 10668*         DUPKEY (2080-EXIT)
 10669*    END-EXEC.
 10670*    MOVE '"$$                   ! 3 #00009672' TO DFHEIV0
 10671     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10673     MOVE X'3320233030303039363732' TO DFHEIV0(25:11)
 10674     CALL 'kxdfhei1' USING DFHEIV0
 10675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10676
 10677
 10678
 10679* EXEC CICS WRITE
 10680*         DATASET  (CERT-FILE-ID)
 10681*         RIDFLD   (CERT-KEY)
 10682*         FROM     (CERTIFICATE-MASTER)
 10683*    END-EXEC.
 10684     MOVE LENGTH OF
 10685      CERTIFICATE-MASTER
 10686       TO DFHEIV11
 10687*    MOVE '&$ L                  ''   #00009676' TO DFHEIV0
 10688     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10689     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10690     MOVE X'2020233030303039363736' TO DFHEIV0(25:11)
 10691     CALL 'kxdfhei1' USING DFHEIV0,
 10692           CERT-FILE-ID,
 10693           CERTIFICATE-MASTER,
 10694           DFHEIV11,
 10695           CERT-KEY,
 10696           DFHEIV99,
 10697           DFHEIV99
 10698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10699
 10700
 10701 2080-EXIT.
 10702     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 199
* EL131.cbl
 10704 2100-MOVE-MSTR.
 10705     IF TYPEI GREATER THAN LOW-VALUES
 10706         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10707
 10708     IF STATUSI = LOW-VALUES
 10709         GO TO 2100-NO-STATUS-CHANGE.
 10710
 10711     IF STATUSI = 'OPEN' OR 'O'
 10712         IF CL-CLAIM-STATUS = 'O'
 10713             MOVE SPACES         TO TRLR-SWITCH
 10714                 GO TO 2100-NO-STATUS-CHANGE.
 10715
 10716     IF STATUSI = 'CLOSED' OR 'C'
 10717         IF CL-CLAIM-STATUS = 'C'
 10718             MOVE SPACES         TO TRLR-SWITCH
 10719                 GO TO 2100-NO-STATUS-CHANGE.
 10720
 10721     IF PI-COMPANY-ID = 'DMD'
 10722        IF STATUSI = 'OPEN' OR 'O'
 10723           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10724              MOVE ZERO       TO STATUSL
 10725              MOVE LOW-VALUES TO STATUSI
 10726              GO TO 2100-NO-STATUS-CHANGE.
 10727
 10728     IF PI-COMPANY-ID = 'DMD'
 10729         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10730
 10731     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10732
 10733 2100-NO-STATUS-CHANGE.
 10734
 10735     IF CCNOI GREATER THAN LOW-VALUES
 10736         MOVE CCNOI              TO CL-CCN.
 10737
 10738     IF PROCI GREATER THAN LOW-VALUES
 10739         MOVE PROCI              TO CL-PROCESSOR-ID.
 10740
 10741     if accswi > low-values
 10742        and accswi = 'Y' OR 'N'
 10743        move accswi              to cl-accident-claim-sw
 10744     end-if
 10745     IF SEXI GREATER THAN LOW-VALUES
 10746         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10747
 10748     IF BIRTHI GREATER THAN LOW-VALUES
 10749         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10750
 10751     IF SOCIALI GREATER THAN LOW-VALUES
 10752       AND
 10753        SOCIALI = SPACES
 10754         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10755         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10756         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10757     ELSE
 10758         IF SOCIALI GREATER THAN LOW-VALUES
 10759             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10760
 10761     IF OCCI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 200
* EL131.cbl
 10762         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10763
 10764     IF BENEL GREATER THAN ZERO
 10765         MOVE BENEI              TO CL-BENEFICIARY.
 10766
 10767     IF DIAGI GREATER THAN LOW-VALUES
 10768         MOVE DIAGI              TO WS-DIAGNOSIS.
 10769
 10770     IF PREMTYPI GREATER THAN LOW-VALUES
 10771         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10772
 10773     IF CAUSEI GREATER THAN LOW-VALUES
 10774         MOVE CAUSEI             TO CL-CAUSE-CD.
 10775
 10776     IF ENDI GREATER THAN LOW-VALUES
 10777         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10778
 10779     IF PDTHRUI GREATER THAN LOW-VALUES
 10780        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10781
 10782     IF PDAMTL GREATER THAN +0
 10783        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10784
 10785     IF NODAYSI GREATER THAN LOW-VALUES
 10786        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10787
 10788     IF NOPMTSI GREATER THAN LOW-VALUES
 10789        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10790
 10791     IF FORMTYPI GREATER THAN LOW-VALUES
 10792        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10793
 10794     IF INCI GREATER THAN LOW-VALUES
 10795        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10796
 10797     IF REPI GREATER THAN LOW-VALUES
 10798        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10799
 10800     IF ADDONDTI GREATER THAN LOW-VALUES
 10801        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10802
 10803     IF PRICDI GREATER THAN LOW-VALUES
 10804         MOVE PRICDI             TO CL-PRIORITY-CD.
 10805
 10806     IF CRITPTL > ZEROS
 10807        MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 10808     END-IF
 10809
 10810     IF RTWMOSL > ZEROS
 10811        MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 10812     END-IF
 10813     IF FILETOI GREATER THAN LOW-VALUES
 10814         MOVE FILETOI            TO CL-FILE-LOCATION.
 10815
 10816     IF SUPVI GREATER THAN LOW-VALUES
 10817         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10818
 10819     IF MLNAMEI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 201
* EL131.cbl
 10820         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10821
 10822     IF MFNAMEI GREATER THAN LOW-VALUES
 10823         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10824
 10825     IF MMINITI GREATER THAN LOW-VALUES
 10826         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10827
 10828     IF CERTEFFI GREATER THAN LOW-VALUES
 10829         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10830
 10831     IF CERTACTI GREATER THAN LOW-VALUES
 10832         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10833
 10834     IF CERTSTI GREATER THAN LOW-VALUES
 10835         MOVE CERTSTI            TO CL-CERT-STATE.
 10836
 10837     IF CERTCARI GREATER THAN LOW-VALUES
 10838         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10839                                    CL-CARRIER.
 10840
 10841     IF CERTGRPI GREATER THAN LOW-VALUES
 10842         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10843
 10844     IF CERTI GREATER THAN LOW-VALUES
 10845         MOVE CERTI              TO CERT-NO-PRIME.
 10846
 10847     IF SUFXI GREATER THAN LOW-VALUES
 10848         MOVE SUFXI              TO CERT-NO-SUFX.
 10849
 10850     MOVE CERT-NO                TO CL-CERT-NO
 10851                                    CL-CERT-NO-A4.
 10852
 10853     IF PI-COMPANY-ID = 'FLA'
 10854          NEXT SENTENCE
 10855     ELSE
 10856         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10857         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10858         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10859         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10860
 10861     IF TRLR-UPDATE-REQUIRED
 10862        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10863        MOVE ZEROS              TO TRLR-SEQ-NO
 10864
 10865* EXEC CICS READ
 10866*            DATASET   (TRLR-FILE-ID)
 10867*            RIDFLD    (TRLR-KEY)
 10868*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10869*       END-EXEC
 10870*    MOVE '&"S        E          (   #00009845' TO DFHEIV0
 10871     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10872     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10873     MOVE X'2020233030303039383435' TO DFHEIV0(25:11)
 10874     CALL 'kxdfhei1' USING DFHEIV0,
 10875           TRLR-FILE-ID,
 10876           DFHEIV20,
 10877           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 202
* EL131.cbl
 10878           TRLR-KEY,
 10879           DFHEIV99,
 10880           DFHEIV99,
 10881           DFHEIV99
 10882     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10883         DFHEIV20
 10884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10885        IF AT-TRAILER-TYPE = '1'
 10886           MOVE +1 TO MISC-SUB
 10887           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10888           MISC-SUB GREATER THAN +6 OR
 10889           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10890           IF MISC-SUB GREATER THAN +1
 10891              SUBTRACT +1 FROM MISC-SUB
 10892              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10893                 GO TO 2100-BYPASS-LAST-UPDATE.
 10894
 10895     IF TRLR-UPDATE-REQUIRED AND
 10896        CLAIM-IS-OPEN
 10897         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10898     ELSE
 10899         IF TRLR-UPDATE-REQUIRED AND
 10900            CLAIM-IS-CLOSED
 10901             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10902             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10903
 10904 2100-BYPASS-LAST-UPDATE.
 10905     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10906     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10907
 10908     GO TO 2100-EXIT.
 10909
 10910 2100-BUMP-OPEN-CLOSE-HIST.
 10911     ADD +1                      TO MISC-SUB.
 10912
 10913 2100-EXIT.
 10914     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 203
* EL131.cbl
 10916 2120-check-pdef.
 10917
 10918
 10919     move +0                     to s1
 10920     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 10921     move spaces                 to ws-dcc-error-line
 10922     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 10923     IF ERPDEF-FOUND
 10924        perform 2130-check-trlr  thru 2130-exit
 10925        move +1                  to s1
 10926*       if cl-accident-claim-sw = ' '
 10927*          move er-1655             to ws-error-no (s1)
 10928*          add +1 to s1
 10929*       end-if
 10930        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 10931        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 10932        MOVE '1'                 TO DC-OPTION-CODE
 10933        MOVE +0                  TO DC-ELAPSED-MONTHS
 10934                                    DC-ELAPSED-DAYS
 10935        PERFORM 9800-CONVERT-DATE
 10936                                 THRU 9800-EXIT
 10937        IF NO-CONVERSION-ERROR
 10938           MOVE DC-ELAPSED-MONTHS
 10939                                 TO WS-MONTHS-BETWEEN
 10940           IF DC-ELAPSED-DAYS > 1
 10941              ADD 1 TO WS-MONTHS-BETWEEN
 10942           END-IF
 10943        ELSE
 10944           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 10945        END-IF
 10946        IF (WS-EXCL-PERIOD = ZEROS)
 10947           OR (WS-MONTHS-BETWEEN = ZEROS)
 10948           CONTINUE
 10949        ELSE
 10950           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 10951              MOVE ER-1651       TO ws-error-no (s1)
 10952              add +1             to s1
 10953           END-IF
 10954        END-IF
 10955        IF (WS-COV-ENDS = ZEROS)
 10956           OR (WS-MONTHS-BETWEEN = ZEROS)
 10957           CONTINUE
 10958        ELSE
 10959           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 10960              MOVE -1            TO MAINTL
 10961              MOVE ER-1653       TO ws-error-no (s1)
 10962              add +1 to s1
 10963           END-IF
 10964        END-IF
 10965        IF (WS-ACC-PERIOD = ZEROS)
 10966           OR (WS-MONTHS-BETWEEN = ZEROS)
 10967           CONTINUE
 10968        ELSE
 10969           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
 10970              and (cl-accident-claim-sw = ' ')
 10971              move er-1655       to ws-error-no (s1)
 10972              add +1             to s1
 10973           end-if
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 204
* EL131.cbl
 10974           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 10975              if cl-accident-claim-sw not = 'Y'
 10976                 MOVE ER-1652    TO ws-error-no (s1)
 10977              else
 10978                 move er-1662    to ws-error-no (s1)
 10979              end-if
 10980              MOVE -1            TO MAINTL
 10981              add +1             to s1
 10982           END-IF
 10983        END-IF
 10984        if cl-claim-type  = 'I'
 10985           move er-1661          to ws-error-no (s1)
 10986           add +1                to s1
 10987        end-if
 10988        perform 2130-check-trlr  thru 2130-exit
 10989     END-IF
 10990
 10991     .
 10992 2120-exit.
 10993     exit.
 10994
 10995 2130-check-trlr.
 10996
 10997     evaluate true
 10998        when s1 = +0
 10999           move cl-control-primary
 11000                                 to trlr-key
 11001           MOVE +95              TO TRLR-SEQ-NO
 11002
 11003* EXEC CICS READ
 11004*             update
 11005*             DATASET  ('ELTRLR')
 11006*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11007*             RIDFLD   (TRLR-KEY)
 11008*             RESP     (WS-RESPONSE)
 11009*          END-EXEC
 11010     MOVE 'ELTRLR' TO DFHEIV1
 11011*    MOVE '&"S        EU         (  N#00009967' TO DFHEIV0
 11012     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11013     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11014     MOVE X'204E233030303039393637' TO DFHEIV0(25:11)
 11015     CALL 'kxdfhei1' USING DFHEIV0,
 11016           DFHEIV1,
 11017           DFHEIV20,
 11018           DFHEIV99,
 11019           TRLR-KEY,
 11020           DFHEIV99,
 11021           DFHEIV99,
 11022           DFHEIV99
 11023     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11024         DFHEIV20
 11025     MOVE EIBRESP  TO WS-RESPONSE
 11026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11027           if ws-resp-normal
 11028              move spaces        to at-info-line-1
 11029           end-if
 11030        when s1 = +1
 11031           if ws-resp-normal
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 205
* EL131.cbl
 11032
 11033* exec cics rewrite
 11034*                dataset   ('ELTRLR')
 11035*                from      (activity-trailers)
 11036*             end-exec
 11037     MOVE LENGTH OF
 11038      activity-trailers
 11039       TO DFHEIV11
 11040     MOVE 'ELTRLR' TO DFHEIV1
 11041*    MOVE '&& L                  %   #00009979' TO DFHEIV0
 11042     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11043     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11044     MOVE X'2020233030303039393739' TO DFHEIV0(25:11)
 11045     CALL 'kxdfhei1' USING DFHEIV0,
 11046           DFHEIV1,
 11047           activity-trailers,
 11048           DFHEIV11,
 11049           DFHEIV99
 11050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11051           end-if
 11052        when s1 > +1
 11053           if ws-resp-normal
 11054              move ws-dcc-error-line
 11055                                 to at-info-line-1
 11056
 11057* exec cics rewrite
 11058*                dataset   ('ELTRLR')
 11059*                from      (activity-trailers)
 11060*             end-exec
 11061     MOVE LENGTH OF
 11062      activity-trailers
 11063       TO DFHEIV11
 11064     MOVE 'ELTRLR' TO DFHEIV1
 11065*    MOVE '&& L                  %   #00009988' TO DFHEIV0
 11066     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11067     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11068     MOVE X'2020233030303039393838' TO DFHEIV0(25:11)
 11069     CALL 'kxdfhei1' USING DFHEIV0,
 11070           DFHEIV1,
 11071           activity-trailers,
 11072           DFHEIV11,
 11073           DFHEIV99
 11074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11075           else
 11076
 11077* EXEC CICS GETMAIN
 11078*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11079*                LENGTH   (TRLR-LENGTH)
 11080*                INITIMG  (GETMAIN-SPACE)
 11081*             END-EXEC
 11082*    MOVE ',"IL                  $   #00009993' TO DFHEIV0
 11083     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11084     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11085     MOVE X'2020233030303039393933' TO DFHEIV0(25:11)
 11086     CALL 'kxdfhei1' USING DFHEIV0,
 11087           DFHEIV20,
 11088           TRLR-LENGTH,
 11089           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 206
* EL131.cbl
 11090     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11091         DFHEIV20
 11092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11093              move 'AT'          to at-record-id
 11094              move cl-control-primary
 11095                                 to at-control-primary
 11096              move +95           to at-sequence-no
 11097              move '6'           to at-trailer-type
 11098              move ws-dcc-error-line
 11099                                 to at-info-line-1
 11100              move 'E'           to at-info-trailer-type
 11101              move save-bin-date to at-recorded-dt
 11102                                    at-gen-info-last-maint-dt
 11103              move pi-processor-id
 11104                                 to at-recorded-by
 11105                                    at-gen-info-last-updated-by
 11106              move eibtime       to at-last-maint-hhmmss
 11107
 11108* exec cics write
 11109*                dataset   ('ELTRLR')
 11110*                from      (activity-trailers)
 11111*                ridfld    (trlr-key)
 11112*             end-exec
 11113     MOVE LENGTH OF
 11114      activity-trailers
 11115       TO DFHEIV11
 11116     MOVE 'ELTRLR' TO DFHEIV1
 11117*    MOVE '&$ L                  ''   #00010012' TO DFHEIV0
 11118     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11119     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11120     MOVE X'2020233030303130303132' TO DFHEIV0(25:11)
 11121     CALL 'kxdfhei1' USING DFHEIV0,
 11122           DFHEIV1,
 11123           activity-trailers,
 11124           DFHEIV11,
 11125           trlr-key,
 11126           DFHEIV99,
 11127           DFHEIV99
 11128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11129              perform varying s1 from +1 by +1 until
 11130                 ws-error-no (s1) = spaces
 11131                 move ws-error-no (s1)
 11132                                 to emi-error
 11133                 PERFORM 9900-ERROR-FORMAT
 11134                                 THRU 9900-EXIT
 11135              end-perform
 11136           end-if
 11137     end-evaluate
 11138
 11139     .
 11140 2130-exit.
 11141     exit.
 11142 2200-MOVE-CERT.
 11143     IF CRTLNMEI GREATER THAN LOW-VALUES
 11144         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11145
 11146     IF CRTFNMEI GREATER THAN LOW-VALUES
 11147         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 207
* EL131.cbl
 11148         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11149
 11150     IF CRTINITI GREATER THAN LOW-VALUES
 11151         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11152
 11153     IF CM-INSURED-INITIALS = SPACES
 11154         MOVE '**'               TO CM-INSURED-INITIALS.
 11155
 11156     IF ISSAGEI GREATER THAN LOW-VALUES
 11157         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11158
 11159     IF JNTFNMEI GREATER THAN LOW-VALUES
 11160         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11161
 11162     IF JNTLNMEI GREATER THAN LOW-VALUES
 11163         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11164
 11165     IF JNTINITI GREATER THAN LOW-VALUES
 11166         MOVE JNTINITI           TO CM-JT-INITIAL.
 11167
 11168     IF JNTAGEI GREATER THAN LOW-VALUES
 11169         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11170
 11171     IF ADDONDTI GREATER THAN LOW-VALUES
 11172        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11173
 11174     IF LCVCDI GREATER THAN LOW-VALUES
 11175        IF LCVCDI = SPACES OR ZEROS
 11176           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11177        ELSE
 11178           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11179
 11180     IF LCVOTRMI GREATER THAN LOW-VALUES
 11181         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11182
 11183     IF LCVRATEL GREATER THAN +0
 11184         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11185
 11186     IF LCVBENEL GREATER THAN +0
 11187         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11188
 11189     IF LCVFORMI GREATER THAN LOW-VALUES
 11190         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11191
 11192     IF LCVCNDTI = LOW-VALUES
 11193        GO TO 2210-SET-STATUS.
 11194
 11195     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11196        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11197        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11198        GO TO 2210-SET-STATUS.
 11199
 11200     IF CM-LF-CURRENT-STATUS = '7'
 11201        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11202        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11203        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11204                                    CM-LF-DEATH-DT
 11205        GO TO 2210-SET-STATUS.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 208
* EL131.cbl
 11206
 11207     IF CM-LF-CURRENT-STATUS = '8'
 11208        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11209        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11210                                    CM-LF-CANCEL-DT.
 11211
 11212 2210-SET-STATUS.
 11213
 11214     IF CM-LF-CURRENT-STATUS = SPACES
 11215         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11216
 11217     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11218         MOVE '6'                TO DC-OPTION-CODE
 11219         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11220         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11221         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11222         IF NO-CONVERSION-ERROR
 11223             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11224         ELSE
 11225             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11226     ELSE
 11227         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11228
 11229 2215-PROCESS-AH-SIDE.
 11230
 11231     IF ACVCDI GREATER THAN LOW-VALUES
 11232        IF ACVCDI = SPACES OR ZEROS
 11233           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11234        ELSE
 11235           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11236
 11237     IF ACVOTRMI GREATER THAN LOW-VALUES
 11238         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11239
 11240     IF ACVRATEL GREATER THAN +0
 11241         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11242
 11243     IF ACVBENEL GREATER THAN +0
 11244         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 11245                                    PI-PAYMENT-AMT.
 11246
 11247     IF ACVFORMI GREATER THAN LOW-VALUES
 11248         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11249
 11250     IF ACVCNDTI = LOW-VALUES
 11251        GO TO 2220-SET-STATUS.
 11252
 11253     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11254        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11255        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11256        GO TO 2220-SET-STATUS.
 11257
 11258     IF CM-AH-CURRENT-STATUS = '6'
 11259        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11260                                 TO CM-AH-CURRENT-STATUS
 11261        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11262        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11263                                    CM-AH-SETTLEMENT-DT
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 209
* EL131.cbl
 11264        GO TO 2220-SET-STATUS.
 11265
 11266     IF CM-AH-CURRENT-STATUS = '8'
 11267        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11268        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11269                                    CM-AH-CANCEL-DT.
 11270
 11271 2220-SET-STATUS.
 11272     IF CM-AH-CURRENT-STATUS = SPACES
 11273         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11274
 11275     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11276         MOVE '6'                TO DC-OPTION-CODE
 11277         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11278         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11279         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11280         IF NO-CONVERSION-ERROR
 11281             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11282         ELSE
 11283             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11284     ELSE
 11285         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11286
 11287 2225-FINISH-CERT.
 11288     IF APRL GREATER THAN +0
 11289         MOVE HOLD-APR           TO CM-LOAN-APR.
 11290
 11291     IF PMTFREQI GREATER THAN LOW-VALUES
 11292         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11293
 11294     IF INDGRPI GREATER THAN LOW-VALUES
 11295         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11296
 11297     IF LOANNOI GREATER THAN LOW-VALUES
 11298        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11299
 11300     IF LOANBALL GREATER THAN +0
 11301        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11302
 11303     IF PREMTYPI GREATER THAN LOW-VALUES
 11304         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11305
 11306     IF REINCDI GREATER THAN LOW-VALUES
 11307         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11308                                    WS-REIN-1
 11309                                    WS-REIN-2
 11310                                    WS-REIN-3
 11311         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11312
 11313     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11314
 11315     MOVE ZEROS                  TO CM-LOAN-TERM
 11316                                    CM-LIFE-COMM-PCT
 11317                                    CM-AH-COMM-PCT.
 11318
 11319*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11320*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11321*         PI-NO-PMTS = ZEROS
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 210
* EL131.cbl
 11322*          IF LOANBALL GREATER THAN +0          OR
 11323*             ACVBENEL GREATER THAN +0          OR
 11324*             APRL     GREATER THAN +0          OR
 11325*             LCVRATEL GREATER THAN +0          OR
 11326*             ACVRATEL GREATER THAN +0
 11327*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11328
 11329 2200-EXIT.
 11330     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 211
* EL131.cbl
 11332 2300-UPDATE-TRLR.
 11333     MOVE ZERO                   TO TRLR-SEQ-NO.
 11334
 11335* EXEC CICS READ UPDATE
 11336*         DATASET  (TRLR-FILE-ID)
 11337*         RIDFLD   (TRLR-KEY)
 11338*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11339*    END-EXEC.
 11340*    MOVE '&"S        EU         (   #00010222' TO DFHEIV0
 11341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11342     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11343     MOVE X'2020233030303130323232' TO DFHEIV0(25:11)
 11344     CALL 'kxdfhei1' USING DFHEIV0,
 11345           TRLR-FILE-ID,
 11346           DFHEIV20,
 11347           DFHEIV99,
 11348           TRLR-KEY,
 11349           DFHEIV99,
 11350           DFHEIV99,
 11351           DFHEIV99
 11352     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11353         DFHEIV20
 11354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11355
 11356
 11357     MOVE ZERO                   TO COUNT-2.
 11358
 11359     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11360         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11361
 11362     IF NOT UPDATE-MADE
 11363         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11364
 11365
 11366* EXEC CICS REWRITE
 11367*         DATASET  (TRLR-FILE-ID)
 11368*         FROM     (ACTIVITY-TRAILERS)
 11369*    END-EXEC.
 11370     MOVE LENGTH OF
 11371      ACTIVITY-TRAILERS
 11372       TO DFHEIV11
 11373*    MOVE '&& L                  %   #00010236' TO DFHEIV0
 11374     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11375     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11376     MOVE X'2020233030303130323336' TO DFHEIV0(25:11)
 11377     CALL 'kxdfhei1' USING DFHEIV0,
 11378           TRLR-FILE-ID,
 11379           ACTIVITY-TRAILERS,
 11380           DFHEIV11,
 11381           DFHEIV99
 11382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11383
 11384
 11385 2300-EXIT.
 11386     EXIT.
 11387
 11388 2310-INS-STATUS.
 11389     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 212
* EL131.cbl
 11390     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11391         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11392         MOVE 'Y'                TO TRLR-SWITCH.
 11393
 11394 2310-EXIT.
 11395     EXIT.
 11396
 11397 2320-SHIFT-STATUS.
 11398     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11399        MOVE 6                   TO COUNT-2
 11400        GO TO 2320-EXIT.
 11401
 11402     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11403     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11404     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11405     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11406     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11407     MOVE 6       TO COUNT-2.
 11408     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11409
 11410 2320-EXIT.
 11411     EXIT.
 11412
 11413 2330-ADD-UPDATE.
 11414
 11415     IF COUNT-2 GREATER THAN 1
 11416        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11417        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11418           GO TO 2330-EXIT.
 11419
 11420     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11421                                   AT-RESERVES-LAST-MAINT-DT
 11422
 11423     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11424     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11425     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11426     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11427
 11428 2330-EXIT.
 11429     EXIT.
 11430
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 213
* EL131.cbl
 11432 2400-UPDATE-TRLR.
 11433
 11434* EXEC CICS HANDLE CONDITION
 11435*         NOTFND    (2400-TRLR-NOTFND)
 11436*         ENDFILE   (2410-EXIT)
 11437*    END-EXEC.
 11438*    MOVE '"$I''                  ! 4 #00010289' TO DFHEIV0
 11439     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11441     MOVE X'3420233030303130323839' TO DFHEIV0(25:11)
 11442     CALL 'kxdfhei1' USING DFHEIV0
 11443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11444
 11445
 11446
 11447* EXEC CICS STARTBR
 11448*        DATASET (TRLR-FILE-ID)
 11449*        RIDFLD  (TRLR-KEY)
 11450*    END-EXEC.
 11451     MOVE 0
 11452       TO DFHEIV11
 11453*    MOVE '&,         G          &   #00010294' TO DFHEIV0
 11454     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11455     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11456     MOVE X'2020233030303130323934' TO DFHEIV0(25:11)
 11457     CALL 'kxdfhei1' USING DFHEIV0,
 11458           TRLR-FILE-ID,
 11459           TRLR-KEY,
 11460           DFHEIV99,
 11461           DFHEIV11,
 11462           DFHEIV99
 11463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11464
 11465
 11466
 11467* EXEC CICS GETMAIN
 11468*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11469*         LENGTH    (TRLR-LENGTH)
 11470*         INITIMG   (GETMAIN-SPACE)
 11471*    END-EXEC.
 11472*    MOVE ',"IL                  $   #00010299' TO DFHEIV0
 11473     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11474     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11475     MOVE X'2020233030303130323939' TO DFHEIV0(25:11)
 11476     CALL 'kxdfhei1' USING DFHEIV0,
 11477           DFHEIV20,
 11478           TRLR-LENGTH,
 11479           GETMAIN-SPACE
 11480     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11481         DFHEIV20
 11482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11483
 11484
 11485     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 11486
 11487
 11488* EXEC CICS ENDBR
 11489*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 214
* EL131.cbl
 11490*    END-EXEC.
 11491     MOVE 0
 11492       TO DFHEIV11
 11493*    MOVE '&2                    $   #00010307' TO DFHEIV0
 11494     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11495     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11496     MOVE X'2020233030303130333037' TO DFHEIV0(25:11)
 11497     CALL 'kxdfhei1' USING DFHEIV0,
 11498           TRLR-FILE-ID,
 11499           DFHEIV11,
 11500           DFHEIV99
 11501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11502
 11503
 11504     GO TO 2400-EXIT.
 11505
 11506 2400-TRLR-NOTFND.
 11507     MOVE ER-0205                TO EMI-ERROR.
 11508     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11509     MOVE 'X'                    TO ERROR-SWITCH.
 11510
 11511 2400-EXIT.
 11512     EXIT.
 11513
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 215
* EL131.cbl
 11515 2410-CHANGE-TRLR.
 11516
 11517* EXEC CICS READNEXT
 11518*        DATASET (TRLR-FILE-ID)
 11519*        RIDFLD  (TRLR-KEY)
 11520*        INTO    (ACTIVITY-TRAILERS)
 11521*    END-EXEC.
 11522     MOVE LENGTH OF
 11523      ACTIVITY-TRAILERS
 11524       TO DFHEIV12
 11525     MOVE 0
 11526       TO DFHEIV11
 11527*    MOVE '&.IL                  )   #00010323' TO DFHEIV0
 11528     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11529     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11530     MOVE X'2020233030303130333233' TO DFHEIV0(25:11)
 11531     CALL 'kxdfhei1' USING DFHEIV0,
 11532           TRLR-FILE-ID,
 11533           ACTIVITY-TRAILERS,
 11534           DFHEIV12,
 11535           TRLR-KEY,
 11536           DFHEIV99,
 11537           DFHEIV11,
 11538           DFHEIV99,
 11539           DFHEIV99
 11540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11541
 11542
 11543     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 11544        GO TO 2410-CHANGE-TRLR.
 11545
 11546     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 11547                                    CHECK-KEY.
 11548
 11549     IF CHECK-KEY NOT = MSTR-KEY
 11550         GO TO 2410-EXIT.
 11551
 11552
 11553* EXEC CICS ENDBR
 11554*        DATASET (TRLR-FILE-ID)
 11555*    END-EXEC.
 11556     MOVE 0
 11557       TO DFHEIV11
 11558*    MOVE '&2                    $   #00010338' TO DFHEIV0
 11559     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11560     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11561     MOVE X'2020233030303130333338' TO DFHEIV0(25:11)
 11562     CALL 'kxdfhei1' USING DFHEIV0,
 11563           TRLR-FILE-ID,
 11564           DFHEIV11,
 11565           DFHEIV99
 11566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11567
 11568
 11569
 11570* EXEC CICS READ UPDATE
 11571*        DATASET (TRLR-FILE-ID)
 11572*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 216
* EL131.cbl
 11573*        INTO    (ACTIVITY-TRAILERS)
 11574*    END-EXEC.
 11575     MOVE LENGTH OF
 11576      ACTIVITY-TRAILERS
 11577       TO DFHEIV11
 11578*    MOVE '&"IL       EU         (   #00010342' TO DFHEIV0
 11579     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11580     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11581     MOVE X'2020233030303130333432' TO DFHEIV0(25:11)
 11582     CALL 'kxdfhei1' USING DFHEIV0,
 11583           TRLR-FILE-ID,
 11584           ACTIVITY-TRAILERS,
 11585           DFHEIV11,
 11586           TRLR-KEY,
 11587           DFHEIV99,
 11588           DFHEIV99,
 11589           DFHEIV99
 11590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11591
 11592
 11593
 11594* EXEC CICS DELETE
 11595*        DATASET (TRLR-FILE-ID)
 11596*    END-EXEC.
 11597*    MOVE '&(                    &   #00010348' TO DFHEIV0
 11598     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11599     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11600     MOVE X'2020233030303130333438' TO DFHEIV0(25:11)
 11601     CALL 'kxdfhei1' USING DFHEIV0,
 11602           TRLR-FILE-ID,
 11603           DFHEIV99,
 11604           DFHEIV99,
 11605           DFHEIV99,
 11606           DFHEIV99
 11607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11608
 11609
 11610     IF AT-SEQUENCE-NO = ZERO AND
 11611        TRLR-UPDATE-REQUIRED
 11612         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 11613
 11614     IF CERTI GREATER THAN LOW-VALUES
 11615        MOVE CERTI               TO AT-CERT-PRIME.
 11616
 11617     IF SUFXI GREATER THAN LOW-VALUES
 11618        MOVE SUFXI               TO AT-CERT-SFX.
 11619
 11620     IF CERTCARI GREATER THAN LOW-VALUES
 11621        MOVE CERTCARI            TO AT-CARRIER.
 11622
 11623     IF PAYMENT-TR
 11624        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 11625           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 11626              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 11627
 11628     IF CORRESPONDENCE-TR
 11629        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11630           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 217
* EL131.cbl
 11631
 11632
 11633* EXEC CICS WRITE
 11634*         DATASET  (TRLR-FILE-ID)
 11635*         RIDFLD   (AT-CONTROL-PRIMARY)
 11636*         FROM     (ACTIVITY-TRAILERS)
 11637*    END-EXEC.
 11638     MOVE LENGTH OF
 11639      ACTIVITY-TRAILERS
 11640       TO DFHEIV11
 11641*    MOVE '&$ L                  ''   #00010374' TO DFHEIV0
 11642     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11643     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11644     MOVE X'2020233030303130333734' TO DFHEIV0(25:11)
 11645     CALL 'kxdfhei1' USING DFHEIV0,
 11646           TRLR-FILE-ID,
 11647           ACTIVITY-TRAILERS,
 11648           DFHEIV11,
 11649           AT-CONTROL-PRIMARY,
 11650           DFHEIV99,
 11651           DFHEIV99
 11652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11653
 11654
 11655
 11656* EXEC CICS STARTBR
 11657*         DATASET  (TRLR-FILE-ID)
 11658*         RIDFLD   (TRLR-KEY)
 11659*    END-EXEC.
 11660     MOVE 0
 11661       TO DFHEIV11
 11662*    MOVE '&,         G          &   #00010380' TO DFHEIV0
 11663     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11664     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11665     MOVE X'2020233030303130333830' TO DFHEIV0(25:11)
 11666     CALL 'kxdfhei1' USING DFHEIV0,
 11667           TRLR-FILE-ID,
 11668           TRLR-KEY,
 11669           DFHEIV99,
 11670           DFHEIV11,
 11671           DFHEIV99
 11672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11673
 11674
 11675     GO TO 2410-CHANGE-TRLR.
 11676
 11677 2410-EXIT.
 11678     EXIT.
 11679
 11680 2420-UPDATE-TRLR.
 11681     MOVE ZERO TO COUNT-2.
 11682     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11683         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11684
 11685     IF NOT UPDATE-MADE
 11686         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11687
 11688 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 218
* EL131.cbl
 11689     EXIT.
 11690
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 219
* EL131.cbl
 11692 2425-UPDATE-NINETY-TRLR.
 11693
 11694     MOVE +90                    TO TRLR-SEQ-NO.
 11695
 11696
 11697* EXEC CICS HANDLE CONDITION
 11698*         NOTFND    (2425-NINETY-NOTFND)
 11699*         ENDFILE   (2425-NINETY-NOTFND)
 11700*    END-EXEC.
 11701*    MOVE '"$I''                  ! 5 #00010406' TO DFHEIV0
 11702     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11704     MOVE X'3520233030303130343036' TO DFHEIV0(25:11)
 11705     CALL 'kxdfhei1' USING DFHEIV0
 11706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11707
 11708
 11709
 11710* EXEC CICS READ UPDATE
 11711*        DATASET (TRLR-FILE-ID)
 11712*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11713*        RIDFLD  (TRLR-KEY)
 11714*    END-EXEC.
 11715*    MOVE '&"S        EU         (   #00010411' TO DFHEIV0
 11716     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11717     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11718     MOVE X'2020233030303130343131' TO DFHEIV0(25:11)
 11719     CALL 'kxdfhei1' USING DFHEIV0,
 11720           TRLR-FILE-ID,
 11721           DFHEIV20,
 11722           DFHEIV99,
 11723           TRLR-KEY,
 11724           DFHEIV99,
 11725           DFHEIV99,
 11726           DFHEIV99
 11727     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11728         DFHEIV20
 11729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11730
 11731
 11732     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11733
 11734     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11735
 11736
 11737* EXEC CICS REWRITE
 11738*        DATASET (TRLR-FILE-ID)
 11739*        FROM    (ACTIVITY-TRAILERS)
 11740*    END-EXEC.
 11741     MOVE LENGTH OF
 11742      ACTIVITY-TRAILERS
 11743       TO DFHEIV11
 11744*    MOVE '&& L                  %   #00010421' TO DFHEIV0
 11745     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11746     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11747     MOVE X'2020233030303130343231' TO DFHEIV0(25:11)
 11748     CALL 'kxdfhei1' USING DFHEIV0,
 11749           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 220
* EL131.cbl
 11750           ACTIVITY-TRAILERS,
 11751           DFHEIV11,
 11752           DFHEIV99
 11753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11754
 11755
 11756     IF DIAGI NOT = WS-DIAGNOSIS
 11757         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11758         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11759         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11760
 11761     GO TO 2425-EXIT.
 11762
 11763 2425-NINETY-NOTFND.
 11764
 11765
 11766* EXEC CICS GETMAIN
 11767*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11768*         LENGTH    (TRLR-LENGTH)
 11769*         INITIMG   (GETMAIN-SPACE)
 11770*    END-EXEC.
 11771*    MOVE ',"IL                  $   #00010435' TO DFHEIV0
 11772     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11773     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11774     MOVE X'2020233030303130343335' TO DFHEIV0(25:11)
 11775     CALL 'kxdfhei1' USING DFHEIV0,
 11776           DFHEIV20,
 11777           TRLR-LENGTH,
 11778           GETMAIN-SPACE
 11779     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11780         DFHEIV20
 11781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11782
 11783
 11784     MOVE +90                  TO TRLR-SEQ-NO.
 11785     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11786
 11787     MOVE 'AT'                 TO AT-RECORD-ID
 11788     MOVE '6'                  TO AT-TRAILER-TYPE
 11789     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11790                                  AT-GEN-INFO-LAST-MAINT-DT
 11791     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11792                                  AT-GEN-INFO-LAST-UPDATED-BY
 11793     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11794     MOVE DIAGI                TO AT-INFO-LINE-1.
 11795
 11796
 11797* EXEC CICS WRITE
 11798*        DATASET (TRLR-FILE-ID)
 11799*        FROM    (ACTIVITY-TRAILERS)
 11800*        RIDFLD  (TRLR-KEY)
 11801*    END-EXEC.
 11802     MOVE LENGTH OF
 11803      ACTIVITY-TRAILERS
 11804       TO DFHEIV11
 11805*    MOVE '&$ L                  ''   #00010453' TO DFHEIV0
 11806     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11807     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 221
* EL131.cbl
 11808     MOVE X'2020233030303130343533' TO DFHEIV0(25:11)
 11809     CALL 'kxdfhei1' USING DFHEIV0,
 11810           TRLR-FILE-ID,
 11811           ACTIVITY-TRAILERS,
 11812           DFHEIV11,
 11813           TRLR-KEY,
 11814           DFHEIV99,
 11815           DFHEIV99
 11816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11817
 11818
 11819 2425-EXIT.
 11820     EXIT.
 11821
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 222
* EL131.cbl
 11823 2430-UPDATE-ACTQ.
 11824
 11825* EXEC CICS HANDLE CONDITION
 11826*         NOTFND    (2430-EXIT)
 11827*         ENDFILE   (2440-EXIT)
 11828*    END-EXEC.
 11829*    MOVE '"$I''                  ! 6 #00010464' TO DFHEIV0
 11830     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11832     MOVE X'3620233030303130343634' TO DFHEIV0(25:11)
 11833     CALL 'kxdfhei1' USING DFHEIV0
 11834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11835
 11836
 11837
 11838* EXEC CICS STARTBR
 11839*         DATASET  (ACTQ-FILE-ID)
 11840*         RIDFLD   (ACTQ-KEY)
 11841*    END-EXEC.
 11842     MOVE 0
 11843       TO DFHEIV11
 11844*    MOVE '&,         G          &   #00010469' TO DFHEIV0
 11845     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11846     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11847     MOVE X'2020233030303130343639' TO DFHEIV0(25:11)
 11848     CALL 'kxdfhei1' USING DFHEIV0,
 11849           ACTQ-FILE-ID,
 11850           ACTQ-KEY,
 11851           DFHEIV99,
 11852           DFHEIV11,
 11853           DFHEIV99
 11854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11855
 11856
 11857
 11858* EXEC CICS GETMAIN
 11859*         SET      (ADDRESS OF ACTIVITY-QUE)
 11860*         LENGTH   (ACTQ-LENGTH)
 11861*         INITIMG  (GETMAIN-SPACE)
 11862*    END-EXEC.
 11863*    MOVE ',"IL                  $   #00010474' TO DFHEIV0
 11864     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11865     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11866     MOVE X'2020233030303130343734' TO DFHEIV0(25:11)
 11867     CALL 'kxdfhei1' USING DFHEIV0,
 11868           DFHEIV20,
 11869           ACTQ-LENGTH,
 11870           GETMAIN-SPACE
 11871     SET ADDRESS OF ACTIVITY-QUE TO
 11872         DFHEIV20
 11873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11874
 11875
 11876     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11877
 11878 2430-EXIT.
 11879     EXIT.
 11880
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 223
* EL131.cbl
 11881 2440-CHANGE-ACTQ.
 11882
 11883
 11884* EXEC CICS READNEXT
 11885*         DATASET  (ACTQ-FILE-ID)
 11886*         RIDFLD   (ACTQ-KEY)
 11887*         INTO     (ACTIVITY-QUE)
 11888*    END-EXEC.
 11889     MOVE LENGTH OF
 11890      ACTIVITY-QUE
 11891       TO DFHEIV12
 11892     MOVE 0
 11893       TO DFHEIV11
 11894*    MOVE '&.IL                  )   #00010487' TO DFHEIV0
 11895     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11896     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11897     MOVE X'2020233030303130343837' TO DFHEIV0(25:11)
 11898     CALL 'kxdfhei1' USING DFHEIV0,
 11899           ACTQ-FILE-ID,
 11900           ACTIVITY-QUE,
 11901           DFHEIV12,
 11902           ACTQ-KEY,
 11903           DFHEIV99,
 11904           DFHEIV11,
 11905           DFHEIV99,
 11906           DFHEIV99
 11907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11908
 11909
 11910
 11911* EXEC CICS ENDBR
 11912*         DATASET (ACTQ-FILE-ID)
 11913*    END-EXEC.
 11914     MOVE 0
 11915       TO DFHEIV11
 11916*    MOVE '&2                    $   #00010493' TO DFHEIV0
 11917     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11918     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11919     MOVE X'2020233030303130343933' TO DFHEIV0(25:11)
 11920     CALL 'kxdfhei1' USING DFHEIV0,
 11921           ACTQ-FILE-ID,
 11922           DFHEIV11,
 11923           DFHEIV99
 11924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11925
 11926
 11927     IF ACTQ-KEY NOT = MSTR-KEY
 11928         GO TO 2440-EXIT.
 11929
 11930
 11931* EXEC CICS READ UPDATE
 11932*         DATASET  (ACTQ-FILE-ID)
 11933*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11934*         SET      (ADDRESS OF ACTIVITY-QUE)
 11935*    END-EXEC.
 11936*    MOVE '&"S        EU         (   #00010500' TO DFHEIV0
 11937     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11938     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 224
* EL131.cbl
 11939     MOVE X'2020233030303130353030' TO DFHEIV0(25:11)
 11940     CALL 'kxdfhei1' USING DFHEIV0,
 11941           ACTQ-FILE-ID,
 11942           DFHEIV20,
 11943           DFHEIV99,
 11944           AQ-CONTROL-PRIMARY,
 11945           DFHEIV99,
 11946           DFHEIV99,
 11947           DFHEIV99
 11948     SET ADDRESS OF ACTIVITY-QUE TO
 11949         DFHEIV20
 11950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11951
 11952
 11953     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11954
 11955
 11956* EXEC CICS DELETE
 11957*         DATASET (ACTQ-FILE-ID)
 11958*    END-EXEC.
 11959*    MOVE '&(                    &   #00010508' TO DFHEIV0
 11960     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11961     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11962     MOVE X'2020233030303130353038' TO DFHEIV0(25:11)
 11963     CALL 'kxdfhei1' USING DFHEIV0,
 11964           ACTQ-FILE-ID,
 11965           DFHEIV99,
 11966           DFHEIV99,
 11967           DFHEIV99,
 11968           DFHEIV99
 11969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11970
 11971
 11972     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11973     IF CERTI GREATER THAN LOW-VALUES
 11974        MOVE CERTI               TO AQ-CERT-PRIME.
 11975     IF SUFXI GREATER THAN LOW-VALUES
 11976        MOVE SUFXI               TO AQ-CERT-SFX.
 11977     IF CERTCARI GREATER THAN LOW-VALUES
 11978        MOVE CERTCARI            TO AQ-CARRIER.
 11979
 11980
 11981* EXEC CICS HANDLE CONDITION
 11982*         DUPREC   (2440-EXIT)
 11983*    END-EXEC.
 11984*    MOVE '"$%                   ! 7 #00010520' TO DFHEIV0
 11985     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11987     MOVE X'3720233030303130353230' TO DFHEIV0(25:11)
 11988     CALL 'kxdfhei1' USING DFHEIV0
 11989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11990
 11991
 11992
 11993* EXEC CICS WRITE
 11994*         DATASET  (ACTQ-FILE-ID)
 11995*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11996*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 225
* EL131.cbl
 11997*    END-EXEC.
 11998     MOVE LENGTH OF
 11999      ACTIVITY-QUE
 12000       TO DFHEIV11
 12001*    MOVE '&$ L                  ''   #00010524' TO DFHEIV0
 12002     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12004     MOVE X'2020233030303130353234' TO DFHEIV0(25:11)
 12005     CALL 'kxdfhei1' USING DFHEIV0,
 12006           ACTQ-FILE-ID,
 12007           ACTIVITY-QUE,
 12008           DFHEIV11,
 12009           AQ-CONTROL-PRIMARY,
 12010           DFHEIV99,
 12011           DFHEIV99
 12012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12013
 12014
 12015 2440-EXIT.
 12016     EXIT.
 12017
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 226
* EL131.cbl
 12019 2460-UPDATE-CHECKQ.
 12020
 12021* EXEC CICS HANDLE CONDITION
 12022*         NOTFND   (2460-EXIT)
 12023*    END-EXEC.
 12024*    MOVE '"$I                   ! 8 #00010535' TO DFHEIV0
 12025     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12026     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12027     MOVE X'3820233030303130353335' TO DFHEIV0(25:11)
 12028     CALL 'kxdfhei1' USING DFHEIV0
 12029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12030
 12031
 12032     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12033     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12034     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12035
 12036
 12037* EXEC CICS READ UPDATE
 12038*         DATASET   (CHKQ-FILE-ID)
 12039*         RIDFLD    (CHKQ-KEY)
 12040*         SET       (ADDRESS OF CHECK-QUE)
 12041*    END-EXEC.
 12042*    MOVE '&"S        EU         (   #00010543' TO DFHEIV0
 12043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12044     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12045     MOVE X'2020233030303130353433' TO DFHEIV0(25:11)
 12046     CALL 'kxdfhei1' USING DFHEIV0,
 12047           CHKQ-FILE-ID,
 12048           DFHEIV20,
 12049           DFHEIV99,
 12050           CHKQ-KEY,
 12051           DFHEIV99,
 12052           DFHEIV99,
 12053           DFHEIV99
 12054     SET ADDRESS OF CHECK-QUE TO
 12055         DFHEIV20
 12056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12057
 12058
 12059     IF CERTI GREATER THAN LOW-VALUES
 12060        MOVE CERTI               TO CQ-CERT-PRIME.
 12061     IF SUFXI GREATER THAN LOW-VALUES
 12062        MOVE SUFXI               TO CQ-CERT-SFX.
 12063     IF CERTCARI GREATER THAN LOW-VALUES
 12064        MOVE CERTCARI            TO CQ-CARRIER.
 12065
 12066
 12067* EXEC CICS REWRITE
 12068*         DATASET  (CHKQ-FILE-ID)
 12069*         FROM     (CHECK-QUE)
 12070*    END-EXEC.
 12071     MOVE LENGTH OF
 12072      CHECK-QUE
 12073       TO DFHEIV11
 12074*    MOVE '&& L                  %   #00010556' TO DFHEIV0
 12075     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12076     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 227
* EL131.cbl
 12077     MOVE X'2020233030303130353536' TO DFHEIV0(25:11)
 12078     CALL 'kxdfhei1' USING DFHEIV0,
 12079           CHKQ-FILE-ID,
 12080           CHECK-QUE,
 12081           DFHEIV11,
 12082           DFHEIV99
 12083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12084
 12085
 12086 2460-EXIT.
 12087     EXIT.
 12088
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 228
* EL131.cbl
 12090 2475-UPDATE-LETTER.
 12091
 12092* EXEC CICS HANDLE CONDITION
 12093*         NOTFND   (2475-EXIT)
 12094*    END-EXEC.
 12095*    MOVE '"$I                   ! 9 #00010566' TO DFHEIV0
 12096     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12098     MOVE X'3920233030303130353636' TO DFHEIV0(25:11)
 12099     CALL 'kxdfhei1' USING DFHEIV0
 12100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12101
 12102
 12103     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12104     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12105     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12106     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12107
 12108
 12109* EXEC CICS READ UPDATE
 12110*         DATASET   (ARCH-FILE-ID)
 12111*         RIDFLD    (ARCH-KEY)
 12112*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12113*    END-EXEC.
 12114*    MOVE '&"S        EU         (   #00010575' TO DFHEIV0
 12115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12117     MOVE X'2020233030303130353735' TO DFHEIV0(25:11)
 12118     CALL 'kxdfhei1' USING DFHEIV0,
 12119           ARCH-FILE-ID,
 12120           DFHEIV20,
 12121           DFHEIV99,
 12122           ARCH-KEY,
 12123           DFHEIV99,
 12124           DFHEIV99,
 12125           DFHEIV99
 12126     SET ADDRESS OF LETTER-ARCHIVE TO
 12127         DFHEIV20
 12128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12129
 12130
 12131* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12132* TO THIS MASTER-KEY INFORMATION.
 12133
 12134     IF LA-CARRIER  = CARRIER-CODE AND
 12135        LA-CLAIM-NO = CLAIM-NO     AND
 12136        LA-CERT-NO  = CERT-NO
 12137        NEXT SENTENCE
 12138     ELSE
 12139        GO TO 2475-UNLOCK.
 12140
 12141     IF CERTI GREATER THAN LOW-VALUES
 12142        MOVE CERTI               TO LA-CERT-PRIME.
 12143     IF SUFXI GREATER THAN LOW-VALUES
 12144        MOVE SUFXI               TO LA-CERT-SFX.
 12145     IF CERTCARI GREATER THAN LOW-VALUES
 12146        MOVE CERTCARI            TO LA-CARRIER.
 12147
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 229
* EL131.cbl
 12148
 12149* EXEC CICS REWRITE
 12150*         DATASET  (ARCH-FILE-ID)
 12151*         FROM     (LETTER-ARCHIVE)
 12152*    END-EXEC.
 12153     MOVE LENGTH OF
 12154      LETTER-ARCHIVE
 12155       TO DFHEIV11
 12156*    MOVE '&& L                  %   #00010598' TO DFHEIV0
 12157     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12158     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12159     MOVE X'2020233030303130353938' TO DFHEIV0(25:11)
 12160     CALL 'kxdfhei1' USING DFHEIV0,
 12161           ARCH-FILE-ID,
 12162           LETTER-ARCHIVE,
 12163           DFHEIV11,
 12164           DFHEIV99
 12165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12166
 12167
 12168     GO TO 2475-EXIT.
 12169
 12170 2475-UNLOCK.
 12171
 12172* EXEC CICS UNLOCK
 12173*         DATASET  (ARCH-FILE-ID)
 12174*    END-EXEC.
 12175*    MOVE '&*                    #   #00010606' TO DFHEIV0
 12176     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12177     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12178     MOVE X'2020233030303130363036' TO DFHEIV0(25:11)
 12179     CALL 'kxdfhei1' USING DFHEIV0,
 12180           ARCH-FILE-ID,
 12181           DFHEIV99
 12182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12183
 12184
 12185 2475-EXIT.
 12186     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 230
* EL131.cbl
 12188 2600-CREATE-MAINT-NOTE.
 12189     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12190     MOVE '1'                    TO CNTL-REC-TYPE.
 12191     MOVE SPACES                 TO CNTL-PROC-ID.
 12192     MOVE ZERO                   TO CNTL-SEQ-NO.
 12193
 12194
 12195* EXEC CICS READ
 12196*         SET        (ADDRESS OF CONTROL-FILE)
 12197*         DATASET    ('ELCNTL')
 12198*         RIDFLD     (CNTL-KEY)
 12199*    END-EXEC.
 12200     MOVE 'ELCNTL' TO DFHEIV1
 12201*    MOVE '&"S        E          (   #00010619' TO DFHEIV0
 12202     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12203     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12204     MOVE X'2020233030303130363139' TO DFHEIV0(25:11)
 12205     CALL 'kxdfhei1' USING DFHEIV0,
 12206           DFHEIV1,
 12207           DFHEIV20,
 12208           DFHEIV99,
 12209           CNTL-KEY,
 12210           DFHEIV99,
 12211           DFHEIV99,
 12212           DFHEIV99
 12213     SET ADDRESS OF CONTROL-FILE TO
 12214         DFHEIV20
 12215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12216
 12217
 12218     IF CO-NO-USE-AUDIT-CHANGES
 12219         GO TO 2600-EXIT.
 12220
 12221     IF PROCL GREATER ZERO
 12222     IF PROCI NOT = LOW-VALUES
 12223     IF PROCI NOT = CL-PROCESSOR-ID
 12224         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12225         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12226         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12227
 12228     IF SEXL GREATER ZERO
 12229     IF SEXI NOT = LOW-VALUES
 12230     IF SEXI NOT = CL-INSURED-SEX-CD
 12231         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12232         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12233         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12234
 12235     IF BIRTHL GREATER ZERO
 12236     IF HOLD-BIRTH NOT = LOW-VALUES
 12237     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12238         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12239         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12240         MOVE SPACES               TO DC-OPTION-CODE
 12241         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12242         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12243         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12244
 12245     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 231
* EL131.cbl
 12246     IF SOCIALI NOT = LOW-VALUES
 12247     IF SOCIALI NOT = CL-SOC-SEC-NO
 12248         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12249         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12250         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12251
 12252     IF OCCL GREATER ZERO
 12253     IF OCCI NOT = LOW-VALUES
 12254     IF OCCI NOT = CL-INSURED-OCC-CD
 12255         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12256         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12257         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12258
 12259     IF BENEL GREATER ZERO
 12260     IF BENEI NOT = LOW-VALUES
 12261     IF BENEI NOT = CL-BENEFICIARY
 12262         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12263         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12264         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12265
 12266     IF PREMTYPL GREATER ZERO
 12267     IF PREMTYPI NOT = LOW-VALUES
 12268     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12269         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12270         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12271         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12272
 12273     IF CAUSEL GREATER ZERO
 12274     IF CAUSEI NOT = LOW-VALUES
 12275     IF CAUSEI NOT = CL-CAUSE-CD
 12276         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12277         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12278         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12279
 12280     IF ENDL GREATER ZERO
 12281     IF HOLD-END NOT = LOW-VALUES
 12282     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12283         MOVE 'END DT'             TO SPLIT-INFO-DESC
 12284         MOVE CL-EST-END-OF-DISAB-DT
 12285                                   TO DC-BIN-DATE-1
 12286         MOVE SPACES               TO DC-OPTION-CODE
 12287         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12288         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12289         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12290
 12291     IF PDTHRUL GREATER ZERO
 12292     IF HOLD-PDTHRU NOT = LOW-VALUES
 12293     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12294         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12295         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12296         MOVE SPACES               TO DC-OPTION-CODE
 12297         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12298         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12299         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12300
 12301     IF PDAMTL GREATER ZERO
 12302     IF HOLD-PDAMT NOT = ZEROS
 12303     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 232
* EL131.cbl
 12304         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12305         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12306         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12307         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12308
 12309     IF NODAYSL GREATER ZERO
 12310     IF HOLD-NODAYS NOT = ZEROS
 12311     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12312         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12313         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12314         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12315         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12316
 12317     IF NOPMTSL GREATER ZERO
 12318     IF HOLD-NOPMTS NOT = ZEROS
 12319     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12320         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12321         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12322         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12323         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12324
 12325     IF FORMTYPL GREATER ZERO
 12326     IF FORMTYPI NOT = LOW-VALUES
 12327     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12328         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12329         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12330         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12331
 12332     IF REPL GREATER ZERO
 12333     IF HOLD-REPORTED NOT = LOW-VALUES
 12334     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12335         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12336         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12337         MOVE SPACES               TO DC-OPTION-CODE
 12338         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12339         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12340         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12341
 12342     IF ADDONDTL GREATER ZERO
 12343     IF HOLD-ADDON NOT = LOW-VALUES
 12344     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12345         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12346         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12347         MOVE SPACES               TO DC-OPTION-CODE
 12348         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12349         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12350         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12351
 12352     IF PRICDL GREATER ZERO
 12353     IF PRICDI NOT = LOW-VALUES
 12354     IF PRICDI NOT = CL-PRIORITY-CD
 12355         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12356         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12357         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12358
 12359     IF FILETOL GREATER ZERO
 12360     IF FILETOI NOT = LOW-VALUES
 12361     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 233
* EL131.cbl
 12362         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12363         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12364         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12365
 12366     IF SUPVL GREATER ZERO
 12367     IF SUPVI NOT = LOW-VALUES
 12368     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12369         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12370         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12371         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12372     IF (CRITPTL > ZERO)
 12373        AND (CRITPTI NOT = LOW-VALUES)
 12374        AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12375        MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12376        MOVE CL-CRIT-PER-RECURRENT
 12377                                 TO SPLIT-INFO-OLD
 12378        PERFORM 2650-WRITE-MAINT-NOTE
 12379                                 THRU 2650-EXIT
 12380     END-IF
 12381
 12382     IF (RTWMOSL > ZERO)
 12383        AND (RTWMOSI NOT = LOW-VALUES)
 12384        AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12385        MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12386        MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12387        PERFORM 2650-WRITE-MAINT-NOTE
 12388                                 THRU 2650-EXIT
 12389     END-IF
 12390     IF MLNAMEL GREATER ZERO
 12391     IF MLNAMEI NOT = LOW-VALUES
 12392     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12393         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12394         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12395         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12396
 12397     IF MFNAMEL GREATER ZERO
 12398     IF MFNAMEI NOT = LOW-VALUES
 12399     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12400         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12401         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12402         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12403
 12404     IF MMINITL GREATER ZERO
 12405     IF MMINITI NOT = LOW-VALUES
 12406     IF MMINITI NOT = CL-INSURED-MID-INIT
 12407         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12408         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12409         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12410
 12411     IF CERTEFFL GREATER ZERO
 12412     IF HOLD-EFF NOT = LOW-VALUES
 12413     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12414         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12415         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12416         MOVE SPACES               TO DC-OPTION-CODE
 12417         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12418         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12419         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 234
* EL131.cbl
 12420
 12421     IF CERTACTL GREATER ZERO
 12422     IF CERTACTI NOT = LOW-VALUES
 12423     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12424         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12425         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12426         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12427
 12428     IF CERTSTL GREATER ZERO
 12429     IF CERTSTI NOT = LOW-VALUES
 12430     IF CERTSTI NOT = CL-CERT-STATE
 12431         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 12432         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 12433         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12434
 12435     IF CERTCARL GREATER ZERO
 12436     IF CERTCARI NOT = LOW-VALUES
 12437     IF CERTCARI NOT = CL-CERT-CARRIER
 12438         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 12439         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 12440         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12441
 12442     IF CERTGRPL GREATER ZERO
 12443     IF CERTGRPI NOT = LOW-VALUES
 12444     IF CERTGRPI NOT = CL-CERT-GROUPING
 12445         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 12446         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 12447         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12448
 12449     IF CERTL GREATER ZERO OR
 12450        SUFXL GREATER ZERO
 12451     IF (CERTI NOT = LOW-VALUES AND
 12452                     CL-CERT-PRIME)
 12453                OR
 12454        (SUFXI NOT = LOW-VALUES AND
 12455                     CL-CERT-SFX)
 12456         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 12457         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 12458         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12459     IF incl > zeros
 12460        IF (HOLD-INCUR NOT = LOW-VALUES)
 12461           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 12462           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 12463           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 12464           MOVE SPACES           TO DC-OPTION-CODE
 12465           PERFORM 9800-CONVERT-DATE
 12466                                 THRU 9800-EXIT
 12467           MOVE DC-GREG-DATE-1-EDIT
 12468                                 TO SPLIT-INFO-OLD
 12469           PERFORM 2650-WRITE-MAINT-NOTE
 12470                                 THRU 2650-EXIT
 12471        END-IF
 12472     END-IF
 12473     .
 12474 2600-EXIT.
 12475      EXIT.
 12476
 12477 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 235
* EL131.cbl
 12478
 12479* EXEC CICS GETMAIN
 12480*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12481*         LENGTH   (TRLR-LENGTH)
 12482*         INITIMG  (GETMAIN-SPACE)
 12483*    END-EXEC.
 12484*    MOVE ',"IL                  $   #00010885' TO DFHEIV0
 12485     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12486     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12487     MOVE X'2020233030303130383835' TO DFHEIV0(25:11)
 12488     CALL 'kxdfhei1' USING DFHEIV0,
 12489           DFHEIV20,
 12490           TRLR-LENGTH,
 12491           GETMAIN-SPACE
 12492     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12493         DFHEIV20
 12494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12495
 12496
 12497
 12498* EXEC CICS HANDLE CONDITION
 12499*         DUPREC   (2650-EXIT)
 12500*    END-EXEC.
 12501*    MOVE '"$%                   ! : #00010891' TO DFHEIV0
 12502     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12504     MOVE X'3A20233030303130383931' TO DFHEIV0(25:11)
 12505     CALL 'kxdfhei1' USING DFHEIV0
 12506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12507
 12508
 12509     MOVE SPACES             TO ACTIVITY-TRAILERS.
 12510
 12511     IF CERTL GREATER ZERO
 12512         MOVE CERTI          TO CL-CERT-PRIME.
 12513
 12514     IF SUFXL GREATER ZERO
 12515         MOVE SUFXI          TO CL-CERT-SFX.
 12516
 12517     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 12518
 12519     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 12520     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 12521
 12522     MOVE 'AT'               TO AT-RECORD-ID.
 12523
 12524     MOVE '6'                TO AT-TRAILER-TYPE.
 12525     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 12526                                AT-GEN-INFO-LAST-MAINT-DT.
 12527     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 12528                                AT-GEN-INFO-LAST-UPDATED-BY.
 12529     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 12530     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 12531     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 12532
 12533
 12534* EXEC CICS WRITE
 12535*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 236
* EL131.cbl
 12536*         RIDFLD   (AT-CONTROL-PRIMARY)
 12537*         FROM     (ACTIVITY-TRAILERS)
 12538*    END-EXEC.
 12539     MOVE LENGTH OF
 12540      ACTIVITY-TRAILERS
 12541       TO DFHEIV11
 12542*    MOVE '&$ L                  ''   #00010919' TO DFHEIV0
 12543     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12544     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12545     MOVE X'2020233030303130393139' TO DFHEIV0(25:11)
 12546     CALL 'kxdfhei1' USING DFHEIV0,
 12547           TRLR-FILE-ID,
 12548           ACTIVITY-TRAILERS,
 12549           DFHEIV11,
 12550           AT-CONTROL-PRIMARY,
 12551           DFHEIV99,
 12552           DFHEIV99
 12553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12554
 12555
 12556 2650-EXIT.
 12557      EXIT.
 12558
 12559 2800-CHECK-AUTO-PAY.
 12560
 12561     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 12562     MOVE PI-CARRIER         TO TRLR-CARRIER.
 12563     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 12564     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 12565     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 12566
 12567
 12568* EXEC CICS HANDLE CONDITION
 12569*         NOTFND    (2800-EXIT)
 12570*         ENDFILE   (2800-EXIT)
 12571*    END-EXEC.
 12572*    MOVE '"$I''                  ! ; #00010936' TO DFHEIV0
 12573     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12575     MOVE X'3B20233030303130393336' TO DFHEIV0(25:11)
 12576     CALL 'kxdfhei1' USING DFHEIV0
 12577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12578
 12579
 12580
 12581* EXEC CICS READ
 12582*        DATASET (TRLR-FILE-ID)
 12583*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12584*        RIDFLD  (TRLR-KEY)
 12585*    END-EXEC.
 12586*    MOVE '&"S        E          (   #00010941' TO DFHEIV0
 12587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12589     MOVE X'2020233030303130393431' TO DFHEIV0(25:11)
 12590     CALL 'kxdfhei1' USING DFHEIV0,
 12591           TRLR-FILE-ID,
 12592           DFHEIV20,
 12593           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 237
* EL131.cbl
 12594           TRLR-KEY,
 12595           DFHEIV99,
 12596           DFHEIV99,
 12597           DFHEIV99
 12598     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12599         DFHEIV20
 12600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12601
 12602
 12603     IF BENEFICIARY-PAID-AUTO
 12604         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 12605     END-IF.
 12606
 12607 2800-EXIT.
 12608      EXIT.
 12609
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 238
* EL131.cbl
 12611 3000-DELETE-CLAIM.
 12612     IF  NOT MODIFY-CAP
 12613         MOVE ER-0070            TO EMI-ERROR
 12614         MOVE -1                 TO MAINTL
 12615         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12616         GO TO 8110-SEND-DATA.
 12617
 12618
 12619* EXEC CICS READ
 12620*         SET      (ADDRESS OF CLAIM-MASTER)
 12621*         DATASET  (CLMS-FILE-ID)
 12622*         RIDFLD   (MSTR-KEY)
 12623*    END-EXEC.
 12624*    MOVE '&"S        E          (   #00010962' TO DFHEIV0
 12625     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12627     MOVE X'2020233030303130393632' TO DFHEIV0(25:11)
 12628     CALL 'kxdfhei1' USING DFHEIV0,
 12629           CLMS-FILE-ID,
 12630           DFHEIV20,
 12631           DFHEIV99,
 12632           MSTR-KEY,
 12633           DFHEIV99,
 12634           DFHEIV99,
 12635           DFHEIV99
 12636     SET ADDRESS OF CLAIM-MASTER TO
 12637         DFHEIV20
 12638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12639
 12640
 12641     IF CL-1ST-TRL-AVAIL
 12642         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 12643     ELSE
 12644        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 12645        MOVE 0                   TO TRLR-SEQ-NO
 12646
 12647* EXEC CICS STARTBR
 12648*            DATASET (TRLR-FILE-ID)
 12649*            RIDFLD  (TRLR-KEY)
 12650*        END-EXEC
 12651     MOVE 0
 12652       TO DFHEIV11
 12653*    MOVE '&,         G          &   #00010973' TO DFHEIV0
 12654     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12656     MOVE X'2020233030303130393733' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0,
 12658           TRLR-FILE-ID,
 12659           TRLR-KEY,
 12660           DFHEIV99,
 12661           DFHEIV11,
 12662           DFHEIV99
 12663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12664         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 12665
 12666* EXEC CICS ENDBR
 12667*            DATASET (TRLR-FILE-ID)
 12668*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 239
* EL131.cbl
 12669     MOVE 0
 12670       TO DFHEIV11
 12671*    MOVE '&2                    $   #00010978' TO DFHEIV0
 12672     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12673     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12674     MOVE X'2020233030303130393738' TO DFHEIV0(25:11)
 12675     CALL 'kxdfhei1' USING DFHEIV0,
 12676           TRLR-FILE-ID,
 12677           DFHEIV11,
 12678           DFHEIV99
 12679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12680        IF SCREEN-ERROR
 12681            MOVE ER-0208         TO EMI-ERROR
 12682            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12683            MOVE -1              TO MAINTL
 12684            GO TO 8110-SEND-DATA
 12685        ELSE
 12686            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 12687
 12688     IF SCREEN-ERROR
 12689         MOVE -1                 TO MAINTL
 12690         GO TO 8110-SEND-DATA.
 12691
 12692     MOVE -1                     TO ONE-OR-MIN1.
 12693     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 12694
 12695     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 12696         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 12697                                    WS-SAVE-CLAIM-KEY
 12698         MOVE +1                 TO ONE-OR-MIN1
 12699         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 12700
 12701     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 12702
 12703     MOVE LOW-VALUES             TO EL131AO.
 12704     MOVE ER-0000                TO EMI-ERROR.
 12705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12706     MOVE 'X'                    TO PI-RETURN-CD-1.
 12707     MOVE -1                     TO MAINTL.
 12708     GO TO 8100-SEND-MAP.
 12709
 12710 3010-DEL-MSTR-TRLR.
 12711
 12712* EXEC CICS READ UPDATE
 12713*         SET       (ADDRESS OF CLAIM-MASTER)
 12714*         DATASET   (CLMS-FILE-ID)
 12715*         RIDFLD    (MSTR-KEY)
 12716*    END-EXEC.
 12717*    MOVE '&"S        EU         (   #00011012' TO DFHEIV0
 12718     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12719     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12720     MOVE X'2020233030303131303132' TO DFHEIV0(25:11)
 12721     CALL 'kxdfhei1' USING DFHEIV0,
 12722           CLMS-FILE-ID,
 12723           DFHEIV20,
 12724           DFHEIV99,
 12725           MSTR-KEY,
 12726           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 240
* EL131.cbl
 12727           DFHEIV99,
 12728           DFHEIV99
 12729     SET ADDRESS OF CLAIM-MASTER TO
 12730         DFHEIV20
 12731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12732
 12733
 12734     if (cl-priority-cd = '8')
 12735        and (pi-processor-id not = 'PEMA' and 'JMS '
 12736             AND 'AMWA')
 12737        MOVE ER-8003             TO EMI-ERROR
 12738        PERFORM 9900-ERROR-FORMAT
 12739                                 THRU 9900-EXIT
 12740        MOVE -1                  TO MAINTL
 12741        GO TO 8110-SEND-DATA
 12742     end-if
 12743
 12744     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 12745     MOVE ZERO                   TO TRLR-SEQ-NO.
 12746
 12747
 12748* EXEC CICS HANDLE CONDITION
 12749*         NOTFND    (3010-DEL-ACTQ)
 12750*         ENDFILE   (3040-EXIT)
 12751*    END-EXEC.
 12752*    MOVE '"$I''                  ! < #00011031' TO DFHEIV0
 12753     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12754     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12755     MOVE X'3C20233030303131303331' TO DFHEIV0(25:11)
 12756     CALL 'kxdfhei1' USING DFHEIV0
 12757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12758
 12759
 12760     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12761
 12762 3010-DEL-ACTQ.
 12763
 12764
 12765* EXEC CICS HANDLE CONDITION
 12766*         NOTFND    (3010-NO-ACTIVITY)
 12767*         ENDFILE   (3050-EXIT)
 12768*    END-EXEC.
 12769*    MOVE '"$I''                  ! = #00011040' TO DFHEIV0
 12770     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12771     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12772     MOVE X'3D20233030303131303430' TO DFHEIV0(25:11)
 12773     CALL 'kxdfhei1' USING DFHEIV0
 12774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12775
 12776
 12777
 12778* EXEC CICS STARTBR
 12779*         DATASET  (ACTQ-FILE-ID)
 12780*         RIDFLD   (ACTQ-KEY)
 12781*    END-EXEC.
 12782     MOVE 0
 12783       TO DFHEIV11
 12784*    MOVE '&,         G          &   #00011045' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 241
* EL131.cbl
 12785     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12786     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12787     MOVE X'2020233030303131303435' TO DFHEIV0(25:11)
 12788     CALL 'kxdfhei1' USING DFHEIV0,
 12789           ACTQ-FILE-ID,
 12790           ACTQ-KEY,
 12791           DFHEIV99,
 12792           DFHEIV11,
 12793           DFHEIV99
 12794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12795
 12796
 12797
 12798* EXEC CICS GETMAIN
 12799*         SET      (ADDRESS OF ACTIVITY-QUE)
 12800*         LENGTH   (ACTQ-LENGTH)
 12801*         INITIMG  (GETMAIN-SPACE)
 12802*    END-EXEC.
 12803*    MOVE ',"IL                  $   #00011050' TO DFHEIV0
 12804     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12805     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12806     MOVE X'2020233030303131303530' TO DFHEIV0(25:11)
 12807     CALL 'kxdfhei1' USING DFHEIV0,
 12808           DFHEIV20,
 12809           ACTQ-LENGTH,
 12810           GETMAIN-SPACE
 12811     SET ADDRESS OF ACTIVITY-QUE TO
 12812         DFHEIV20
 12813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12814
 12815
 12816     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12817
 12818
 12819* EXEC CICS ENDBR
 12820*         DATASET (ACTQ-FILE-ID)
 12821*    END-EXEC.
 12822     MOVE 0
 12823       TO DFHEIV11
 12824*    MOVE '&2                    $   #00011058' TO DFHEIV0
 12825     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12827     MOVE X'2020233030303131303538' TO DFHEIV0(25:11)
 12828     CALL 'kxdfhei1' USING DFHEIV0,
 12829           ACTQ-FILE-ID,
 12830           DFHEIV11,
 12831           DFHEIV99
 12832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12833
 12834
 12835 3010-NO-ACTIVITY.
 12836
 12837
 12838* EXEC CICS HANDLE CONDITION
 12839*        NOTFND   (3010-CERT-NOT-FOUND)
 12840*    END-EXEC.
 12841*    MOVE '"$I                   ! > #00011064' TO DFHEIV0
 12842     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 242
* EL131.cbl
 12843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12844     MOVE X'3E20233030303131303634' TO DFHEIV0(25:11)
 12845     CALL 'kxdfhei1' USING DFHEIV0
 12846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12847
 12848
 12849     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12850     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12851     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12852     MOVE CL-CERT-STATE          TO CERT-STATE.
 12853     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12854     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12855     MOVE CL-CERT-NO             TO CERT-CERT.
 12856
 12857
 12858* EXEC CICS READ
 12859*        DATASET   (CERT-FILE-ID)
 12860*        RIDFLD    (CERT-KEY)
 12861*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12862*    END-EXEC.
 12863*    MOVE '&"S        E          (   #00011076' TO DFHEIV0
 12864     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12865     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12866     MOVE X'2020233030303131303736' TO DFHEIV0(25:11)
 12867     CALL 'kxdfhei1' USING DFHEIV0,
 12868           CERT-FILE-ID,
 12869           DFHEIV20,
 12870           DFHEIV99,
 12871           CERT-KEY,
 12872           DFHEIV99,
 12873           DFHEIV99,
 12874           DFHEIV99
 12875     SET ADDRESS OF CERTIFICATE-MASTER TO
 12876         DFHEIV20
 12877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12878
 12879
 12880     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12881       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12882         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12883     ELSE
 12884         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12885
 12886  3010-UPDATE-CERT-TRLR.
 12887
 12888      MOVE CERT-KEY              TO ELCRTT-KEY
 12889      MOVE 'B'                   TO CTRLR-REC-TYPE
 12890
 12891* EXEC CICS READ
 12892*        UPDATE
 12893*        DATASET   ('ELCRTT')
 12894*        RIDFLD    (ELCRTT-KEY)
 12895*        INTO      (CERTIFICATE-TRAILERS)
 12896*        RESP      (WS-RESPONSE)
 12897*     END-EXEC
 12898     MOVE LENGTH OF
 12899      CERTIFICATE-TRAILERS
 12900       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 243
* EL131.cbl
 12901     MOVE 'ELCRTT' TO DFHEIV1
 12902*    MOVE '&"IL       EU         (  N#00011092' TO DFHEIV0
 12903     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12904     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12905     MOVE X'204E233030303131303932' TO DFHEIV0(25:11)
 12906     CALL 'kxdfhei1' USING DFHEIV0,
 12907           DFHEIV1,
 12908           CERTIFICATE-TRAILERS,
 12909           DFHEIV11,
 12910           ELCRTT-KEY,
 12911           DFHEIV99,
 12912           DFHEIV99,
 12913           DFHEIV99
 12914     MOVE EIBRESP  TO WS-RESPONSE
 12915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12916      IF WS-RESP-NORMAL
 12917*    if cl-insured-claim = 'S'
 12918*       move +2 to s1
 12919*    else
 12920*       MOVE +1 to s1
 12921*    end-if
 12922
 12923     move +1 to s1
 12924     evaluate cl-claim-type
 12925        when 'A'
 12926           move +1 to s2
 12927        when 'I'
 12928           move +2 to s2
 12929        when 'G'
 12930           move +3 to s2
 12931        when 'L'
 12932           move +4 to s2
 12933        when 'P'
 12934           move +5 to s2
 12935     end-evaluate
 12936     SUBTRACT +1 FROM CS-NO-OF-CLAIMS (S1 S2)
 12937     IF CS-NO-OF-CLAIMS (S1 S2) < ZEROS
 12938        MOVE ZEROS               TO CS-NO-OF-CLAIMS (S1 S2)
 12939     END-IF
 12940     if cs-no-of-claims (s1 s2) = zeros
 12941        move spaces              to cs-claim-type (s1 s2)
 12942     end-if
 12943
 12944
 12945* EXEC CICS REWRITE
 12946*       DATASET   ('ELCRTT')
 12947*       FROM      (CERTIFICATE-TRAILERS)
 12948*    END-EXEC
 12949     MOVE LENGTH OF
 12950      CERTIFICATE-TRAILERS
 12951       TO DFHEIV11
 12952     MOVE 'ELCRTT' TO DFHEIV1
 12953*    MOVE '&& L                  %   #00011127' TO DFHEIV0
 12954     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12955     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12956     MOVE X'2020233030303131313237' TO DFHEIV0(25:11)
 12957     CALL 'kxdfhei1' USING DFHEIV0,
 12958           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 244
* EL131.cbl
 12959           CERTIFICATE-TRAILERS,
 12960           DFHEIV11,
 12961           DFHEIV99
 12962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12963     .
 12964 3010-CERT-NOT-FOUND.
 12965
 12966
 12967* EXEC CICS DELETE
 12968*        DATASET  (CLMS-FILE-ID)
 12969*    END-EXEC.
 12970*    MOVE '&(                    &   #00011134' TO DFHEIV0
 12971     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12972     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12973     MOVE X'2020233030303131313334' TO DFHEIV0(25:11)
 12974     CALL 'kxdfhei1' USING DFHEIV0,
 12975           CLMS-FILE-ID,
 12976           DFHEIV99,
 12977           DFHEIV99,
 12978           DFHEIV99,
 12979           DFHEIV99
 12980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12981
 12982
 12983 3010-EXIT.
 12984      EXIT.
 12985
 12986 3020-UPDATE-CERT.
 12987
 12988* EXEC CICS READ UPDATE
 12989*         DATASET  (CERT-FILE-ID)
 12990*         RIDFLD   (CERT-KEY)
 12991*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12992*    END-EXEC.
 12993*    MOVE '&"S        EU         (   #00011142' TO DFHEIV0
 12994     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12995     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12996     MOVE X'2020233030303131313432' TO DFHEIV0(25:11)
 12997     CALL 'kxdfhei1' USING DFHEIV0,
 12998           CERT-FILE-ID,
 12999           DFHEIV20,
 13000           DFHEIV99,
 13001           CERT-KEY,
 13002           DFHEIV99,
 13003           DFHEIV99,
 13004           DFHEIV99
 13005     SET ADDRESS OF CERTIFICATE-MASTER TO
 13006         DFHEIV20
 13007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13008
 13009
 13010     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13011
 13012
 13013* EXEC CICS HANDLE CONDITION
 13014*         DUPKEY   (3020-EXIT)
 13015*    END-EXEC.
 13016*    MOVE '"$$                   ! ? #00011150' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 245
* EL131.cbl
 13017     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13019     MOVE X'3F20233030303131313530' TO DFHEIV0(25:11)
 13020     CALL 'kxdfhei1' USING DFHEIV0
 13021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13022
 13023
 13024
 13025* EXEC CICS REWRITE
 13026*         DATASET  (CERT-FILE-ID)
 13027*         FROM     (CERTIFICATE-MASTER)
 13028*    END-EXEC.
 13029     MOVE LENGTH OF
 13030      CERTIFICATE-MASTER
 13031       TO DFHEIV11
 13032*    MOVE '&& L                  %   #00011154' TO DFHEIV0
 13033     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13034     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13035     MOVE X'2020233030303131313534' TO DFHEIV0(25:11)
 13036     CALL 'kxdfhei1' USING DFHEIV0,
 13037           CERT-FILE-ID,
 13038           CERTIFICATE-MASTER,
 13039           DFHEIV11,
 13040           DFHEIV99
 13041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13042
 13043
 13044 3020-EXIT.
 13045     EXIT.
 13046
 13047 3030-DELETE-CERT.
 13048
 13049* EXEC CICS READ UPDATE
 13050*         DATASET  (CERT-FILE-ID)
 13051*         RIDFLD   (CERT-KEY)
 13052*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13053*    END-EXEC.
 13054*    MOVE '&"S        EU         (   #00011163' TO DFHEIV0
 13055     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13056     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13057     MOVE X'2020233030303131313633' TO DFHEIV0(25:11)
 13058     CALL 'kxdfhei1' USING DFHEIV0,
 13059           CERT-FILE-ID,
 13060           DFHEIV20,
 13061           DFHEIV99,
 13062           CERT-KEY,
 13063           DFHEIV99,
 13064           DFHEIV99,
 13065           DFHEIV99
 13066     SET ADDRESS OF CERTIFICATE-MASTER TO
 13067         DFHEIV20
 13068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13069
 13070
 13071
 13072* EXEC CICS DELETE
 13073*         DATASET   (CERT-FILE-ID)
 13074*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 246
* EL131.cbl
 13075*    MOVE '&(                    &   #00011169' TO DFHEIV0
 13076     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13077     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13078     MOVE X'2020233030303131313639' TO DFHEIV0(25:11)
 13079     CALL 'kxdfhei1' USING DFHEIV0,
 13080           CERT-FILE-ID,
 13081           DFHEIV99,
 13082           DFHEIV99,
 13083           DFHEIV99,
 13084           DFHEIV99
 13085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13086
 13087
 13088 3030-EXIT.
 13089     EXIT.
 13090
 13091 3040-DELETE-TRLR.
 13092
 13093* EXEC CICS READ
 13094*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13095*         DATASET  (TRLR-FILE-ID)
 13096*         RIDFLD   (TRLR-KEY)
 13097*         GTEQ
 13098*    END-EXEC.
 13099*    MOVE '&"S        G          (   #00011177' TO DFHEIV0
 13100     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13102     MOVE X'2020233030303131313737' TO DFHEIV0(25:11)
 13103     CALL 'kxdfhei1' USING DFHEIV0,
 13104           TRLR-FILE-ID,
 13105           DFHEIV20,
 13106           DFHEIV99,
 13107           TRLR-KEY,
 13108           DFHEIV99,
 13109           DFHEIV99,
 13110           DFHEIV99
 13111     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13112         DFHEIV20
 13113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13114
 13115
 13116     IF PI-COMPANY-CD = AT-COMPANY-CD
 13117        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13118        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13119           GO TO 3040-EXIT
 13120        ELSE
 13121           NEXT SENTENCE
 13122     ELSE
 13123        GO TO 3040-EXIT.
 13124
 13125
 13126* EXEC CICS DELETE
 13127*         DATASET  (TRLR-FILE-ID)
 13128*         RIDFLD   (TRLR-KEY)
 13129*    END-EXEC.
 13130*    MOVE '&(  R                 &   #00011193' TO DFHEIV0
 13131     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13132     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 247
* EL131.cbl
 13133     MOVE X'2020233030303131313933' TO DFHEIV0(25:11)
 13134     CALL 'kxdfhei1' USING DFHEIV0,
 13135           TRLR-FILE-ID,
 13136           TRLR-KEY,
 13137           DFHEIV99,
 13138           DFHEIV99,
 13139           DFHEIV99
 13140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13141
 13142
 13143     GO TO 3040-DELETE-TRLR.
 13144
 13145 3040-EXIT.
 13146     EXIT.
 13147
 13148 3050-DELETE-ACTQ.
 13149
 13150* EXEC CICS READNEXT
 13151*         DATASET  (ACTQ-FILE-ID)
 13152*         RIDFLD   (ACTQ-KEY)
 13153*         INTO     (ACTIVITY-QUE)
 13154*    END-EXEC.
 13155     MOVE LENGTH OF
 13156      ACTIVITY-QUE
 13157       TO DFHEIV12
 13158     MOVE 0
 13159       TO DFHEIV11
 13160*    MOVE '&.IL                  )   #00011204' TO DFHEIV0
 13161     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13162     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13163     MOVE X'2020233030303131323034' TO DFHEIV0(25:11)
 13164     CALL 'kxdfhei1' USING DFHEIV0,
 13165           ACTQ-FILE-ID,
 13166           ACTIVITY-QUE,
 13167           DFHEIV12,
 13168           ACTQ-KEY,
 13169           DFHEIV99,
 13170           DFHEIV11,
 13171           DFHEIV99,
 13172           DFHEIV99
 13173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13174
 13175
 13176     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13177         GO TO 3050-EXIT.
 13178
 13179
 13180* EXEC CICS ENDBR
 13181*         DATASET  (ACTQ-FILE-ID)
 13182*    END-EXEC.
 13183     MOVE 0
 13184       TO DFHEIV11
 13185*    MOVE '&2                    $   #00011213' TO DFHEIV0
 13186     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13187     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13188     MOVE X'2020233030303131323133' TO DFHEIV0(25:11)
 13189     CALL 'kxdfhei1' USING DFHEIV0,
 13190           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 248
* EL131.cbl
 13191           DFHEIV11,
 13192           DFHEIV99
 13193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13194
 13195
 13196
 13197* EXEC CICS DELETE
 13198*         DATASET   (ACTQ-FILE-ID)
 13199*         RIDFLD    (ACTQ-KEY)
 13200*    END-EXEC.
 13201*    MOVE '&(  R                 &   #00011217' TO DFHEIV0
 13202     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13203     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13204     MOVE X'2020233030303131323137' TO DFHEIV0(25:11)
 13205     CALL 'kxdfhei1' USING DFHEIV0,
 13206           ACTQ-FILE-ID,
 13207           ACTQ-KEY,
 13208           DFHEIV99,
 13209           DFHEIV99,
 13210           DFHEIV99
 13211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13212
 13213
 13214
 13215* EXEC CICS STARTBR
 13216*         DATASET   (ACTQ-FILE-ID)
 13217*         RIDFLD    (ACTQ-KEY)
 13218*    END-EXEC.
 13219     MOVE 0
 13220       TO DFHEIV11
 13221*    MOVE '&,         G          &   #00011222' TO DFHEIV0
 13222     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13224     MOVE X'2020233030303131323232' TO DFHEIV0(25:11)
 13225     CALL 'kxdfhei1' USING DFHEIV0,
 13226           ACTQ-FILE-ID,
 13227           ACTQ-KEY,
 13228           DFHEIV99,
 13229           DFHEIV11,
 13230           DFHEIV99
 13231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13232
 13233
 13234     GO TO 3050-DELETE-ACTQ.
 13235
 13236 3050-EXIT.
 13237     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 249
* EL131.cbl
 13239 3060-READ-TRLR.
 13240
 13241* EXEC CICS HANDLE CONDITION
 13242*         NOTFND    (3060-EXIT)
 13243*         ENDFILE   (3060-EXIT)
 13244*    END-EXEC.
 13245*    MOVE '"$I''                  ! @ #00011233' TO DFHEIV0
 13246     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13248     MOVE X'4020233030303131323333' TO DFHEIV0(25:11)
 13249     CALL 'kxdfhei1' USING DFHEIV0
 13250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13251
 13252
 13253 3060-LOOP.
 13254
 13255* EXEC CICS READNEXT
 13256*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13257*         DATASET  (TRLR-FILE-ID)
 13258*         RIDFLD   (TRLR-KEY)
 13259*    END-EXEC.
 13260     MOVE 0
 13261       TO DFHEIV11
 13262*    MOVE '&.S                   )   #00011239' TO DFHEIV0
 13263     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13264     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13265     MOVE X'2020233030303131323339' TO DFHEIV0(25:11)
 13266     CALL 'kxdfhei1' USING DFHEIV0,
 13267           TRLR-FILE-ID,
 13268           DFHEIV20,
 13269           DFHEIV99,
 13270           TRLR-KEY,
 13271           DFHEIV99,
 13272           DFHEIV11,
 13273           DFHEIV99,
 13274           DFHEIV99
 13275     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13276         DFHEIV20
 13277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13278
 13279
 13280     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13281         GO TO 3060-EXIT.
 13282
 13283     IF FORM-CONTROL-TR
 13284         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13285             NEXT SENTENCE
 13286         ELSE
 13287             MOVE 'X'            TO ERROR-SWITCH
 13288             GO TO 3060-EXIT
 13289     ELSE
 13290         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13291            MOVE 'X'                 TO ERROR-SWITCH
 13292            GO TO 3060-EXIT.
 13293
 13294     GO TO 3060-LOOP.
 13295
 13296 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 250
* EL131.cbl
 13297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 251
* EL131.cbl
 13299 3997-GET-ERPDEF.
 13300
 13301     move cl-company-cd          to cert-company-code
 13302     move cl-cert-key-data       to cert-key (2:21)
 13303     move cl-cert-no             to cert-cert
 13304
 13305
 13306* EXEC CICS READ
 13307*        DATASET   (CERT-FILE-ID)
 13308*        RIDFLD    (CERT-KEY)
 13309*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13310*        resp      (ws-response)
 13311*    END-EXEC
 13312*    MOVE '&"S        E          (  N#00011270' TO DFHEIV0
 13313     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13315     MOVE X'204E233030303131323730' TO DFHEIV0(25:11)
 13316     CALL 'kxdfhei1' USING DFHEIV0,
 13317           CERT-FILE-ID,
 13318           DFHEIV20,
 13319           DFHEIV99,
 13320           CERT-KEY,
 13321           DFHEIV99,
 13322           DFHEIV99,
 13323           DFHEIV99
 13324     SET ADDRESS OF CERTIFICATE-MASTER TO
 13325         DFHEIV20
 13326     MOVE EIBRESP  TO ws-response
 13327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13328
 13329     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 13330                                    WS-ERPDEF-SW
 13331     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13332                                    WS-CRIT-PER-RTW-MOS
 13333
 13334     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13335     MOVE CM-STATE               TO ERPDEF-STATE
 13336     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13337     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 13338     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
 13339     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13340     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13341
 13342
 13343* EXEC CICS STARTBR
 13344*        DATASET  ('ERPDEF')
 13345*        RIDFLD   (ERPDEF-KEY)
 13346*        GTEQ
 13347*        RESP     (WS-RESPONSE)
 13348*    END-EXEC
 13349     MOVE 'ERPDEF' TO DFHEIV1
 13350     MOVE 0
 13351       TO DFHEIV11
 13352*    MOVE '&,         G          &  N#00011290' TO DFHEIV0
 13353     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13354     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13355     MOVE X'204E233030303131323930' TO DFHEIV0(25:11)
 13356     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 252
* EL131.cbl
 13357           DFHEIV1,
 13358           ERPDEF-KEY,
 13359           DFHEIV99,
 13360           DFHEIV11,
 13361           DFHEIV99
 13362     MOVE EIBRESP  TO WS-RESPONSE
 13363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13364
 13365     IF WS-RESP-NORMAL
 13366
 13367* EXEC CICS READNEXT
 13368*          DATASET  ('ERPDEF')
 13369*          INTO     (PRODUCT-MASTER)
 13370*          RIDFLD   (ERPDEF-KEY)
 13371*          RESP     (WS-RESPONSE)
 13372*       END-EXEC
 13373     MOVE LENGTH OF
 13374      PRODUCT-MASTER
 13375       TO DFHEIV12
 13376     MOVE 'ERPDEF' TO DFHEIV1
 13377     MOVE 0
 13378       TO DFHEIV11
 13379*    MOVE '&.IL                  )  N#00011298' TO DFHEIV0
 13380     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13381     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13382     MOVE X'204E233030303131323938' TO DFHEIV0(25:11)
 13383     CALL 'kxdfhei1' USING DFHEIV0,
 13384           DFHEIV1,
 13385           PRODUCT-MASTER,
 13386           DFHEIV12,
 13387           ERPDEF-KEY,
 13388           DFHEIV99,
 13389           DFHEIV11,
 13390           DFHEIV99,
 13391           DFHEIV99
 13392     MOVE EIBRESP  TO WS-RESPONSE
 13393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13394        IF WS-RESP-NORMAL
 13395           IF (ERPDEF-KEY-SAVE (1:16) =
 13396              PD-CONTROL-PRIMARY (1:16))
 13397              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13398              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13399                 (A1 > +8)
 13400                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13401              END-PERFORM
 13402              IF A1 < +9
 13403                 SET ERPDEF-FOUND TO TRUE
 13404                 MOVE PD-CRIT-PERIOD (A1)
 13405                              TO WS-CRITICAL-PERIOD
 13406                 MOVE PD-REC-CRIT-PERIOD (A1)
 13407                              TO WS-CRIT-PER-RECURRENT
 13408                 IF PD-RTW-MOS (A1) NUMERIC
 13409                    MOVE PD-RTW-MOS (A1)
 13410                              TO WS-CRIT-PER-RTW-MOS
 13411                 ELSE
 13412                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13413                 END-IF
 13414                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 253
* EL131.cbl
 13415                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13416                                 TO WS-EXCL-PERIOD
 13417                 END-IF
 13418                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 13419                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 13420                                 TO WS-COV-ENDS
 13421                 END-IF
 13422                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 13423                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 13424                                 TO WS-ACC-PERIOD
 13425                 END-IF
 13426              END-IF
 13427           END-IF
 13428        END-IF
 13429     END-IF
 13430
 13431     .
 13432 3997-EXIT.
 13433     EXIT.
 13434 4000-FORCE-ERRORS.
 13435     IF PI-RETURN-CD-1 = 'X'
 13436         MOVE ER-0311            TO EMI-ERROR
 13437         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13438         MOVE -1                 TO MAINTL
 13439         GO TO 8110-SEND-DATA.
 13440
 13441     IF NOT FORCE-CAP
 13442         MOVE ER-0416            TO EMI-ERROR
 13443         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13444         MOVE -1                 TO MAINTL
 13445         GO TO 8110-SEND-DATA.
 13446
 13447     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 13448     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 13449     IF EMI-FATAL-CTR GREATER THAN ZERO
 13450         GO TO 4000-FATAL-ERRORS.
 13451
 13452     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 13453
 13454     IF EMI-FATAL-CTR GREATER THAN ZERO
 13455         GO TO 4000-FATAL-ERRORS.
 13456
 13457     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 13458
 13459     IF EMI-FATAL-CTR GREATER THAN ZERO
 13460         GO TO 4000-FATAL-ERRORS.
 13461
 13462     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 13463     MOVE AL-UANOF               TO CERTA.
 13464     MOVE ER-0000 TO EMI-ERROR.
 13465     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13466
 13467 4000-FATAL-ERRORS.
 13468     MOVE -1                     TO MAINTL.
 13469     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 254
* EL131.cbl
 13471
 13472 4100-SAVE-CHANGES.
 13473     IF MAINTL > 0
 13474         MOVE MAINTI  TO WS-SAVE-MAINTI
 13475         MOVE MAINTL  TO WS-SAVE-MAINTL
 13476     END-IF
 13477     IF STATUSL > 0
 13478         MOVE STATUSI  TO WS-SAVE-STATUSI
 13479         MOVE STATUSL  TO WS-SAVE-STATUSL
 13480     END-IF
 13481     IF REPL > 0
 13482         MOVE REPI  TO WS-SAVE-REPI
 13483         MOVE REPL  TO WS-SAVE-REPL
 13484     END-IF
 13485     IF CAUSEL > 0
 13486         MOVE CAUSEI  TO WS-SAVE-CAUSEI
 13487         MOVE CAUSEL  TO WS-SAVE-CAUSEL
 13488     END-IF
 13489     IF ENDL > 0
 13490         MOVE ENDI  TO WS-SAVE-ENDI
 13491         MOVE ENDL  TO WS-SAVE-ENDL
 13492     END-IF
 13493     IF DIAGL > 0
 13494         MOVE DIAGI  TO WS-SAVE-DIAGI
 13495         MOVE DIAGL  TO WS-SAVE-DIAGL
 13496     END-IF
 13497     IF BENEL > 0
 13498         MOVE BENEI  TO WS-SAVE-BENEI
 13499         MOVE BENEL  TO WS-SAVE-BENEL
 13500     END-IF
 13501     IF BIRTHL > 0
 13502         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 13503         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 13504     END-IF
 13505     IF SOCIALL > 0
 13506         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 13507         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 13508     END-IF
 13509     IF SEXL > 0
 13510         MOVE SEXI  TO WS-SAVE-SEXI
 13511         MOVE SEXL  TO WS-SAVE-SEXL
 13512     END-IF
 13513     IF MLNAMEL > 0
 13514         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 13515         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 13516     END-IF
 13517     IF MFNAMEL > 0
 13518         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 13519         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 13520     END-IF
 13521     IF MMINITL > 0
 13522         MOVE MMINITI  TO WS-SAVE-MMINITI
 13523         MOVE MMINITL  TO WS-SAVE-MMINITL
 13524     END-IF
 13525     IF LOANNOL > 0
 13526         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 13527         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 13528     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 255
* EL131.cbl
 13529     IF LOANBALL > 0
 13530         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 13531         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 13532     END-IF
 13533     IF PROCL > 0
 13534         MOVE PROCI  TO WS-SAVE-PROCI
 13535         MOVE PROCL  TO WS-SAVE-PROCL
 13536     END-IF
 13537     IF SUPVL > 0
 13538         MOVE SUPVI  TO WS-SAVE-SUPVI
 13539         MOVE SUPVL  TO WS-SAVE-SUPVL
 13540     END-IF
 13541     IF PRICDL > 0
 13542         MOVE PRICDI  TO WS-SAVE-PRICDI
 13543         MOVE PRICDL  TO WS-SAVE-PRICDL
 13544     END-IF
 13545     IF FILETOL > 0
 13546         MOVE FILETOI  TO WS-SAVE-FILETOI
 13547         MOVE FILETOL  TO WS-SAVE-FILETOL
 13548     END-IF
 13549     IF PDTHRUL > 0
 13550         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 13551         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 13552     END-IF
 13553     IF PDAMTL > 0
 13554         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 13555         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 13556     END-IF
 13557     IF NODAYSL > 0
 13558         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 13559         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 13560     END-IF
 13561     IF NOPMTSL > 0
 13562         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 13563         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 13564     END-IF
 13565     IF FORMTYPL > 0
 13566         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 13567         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 13568     END-IF
 13569     IF OCCL > 0
 13570         MOVE OCCI  TO WS-SAVE-OCCI
 13571         MOVE OCCL  TO WS-SAVE-OCCL
 13572     END-IF.
 13573 4100-EXIT.
 13574      EXIT.
 13575
 13576 4200-LOAD-CHANGES.
 13577     IF WS-SAVE-MAINTL > 0
 13578         MOVE WS-SAVE-MAINTI  TO MAINTI
 13579         MOVE WS-SAVE-MAINTL  TO MAINTL
 13580         MOVE AL-UANON        TO MAINTA
 13581     END-IF
 13582     IF WS-SAVE-STATUSL > 0
 13583         MOVE WS-SAVE-STATUSI  TO STATUSI
 13584         MOVE WS-SAVE-STATUSL  TO STATUSL
 13585         MOVE AL-UANON         TO STATUSA
 13586     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 256
* EL131.cbl
 13587     IF WS-SAVE-REPL > 0
 13588         MOVE WS-SAVE-REPI  TO REPI
 13589         MOVE WS-SAVE-REPL  TO REPL
 13590         MOVE AL-UANON      TO REPA
 13591     END-IF
 13592     IF WS-SAVE-CAUSEL > 0
 13593         MOVE WS-SAVE-CAUSEI  TO CAUSEI
 13594         MOVE WS-SAVE-CAUSEL  TO CAUSEL
 13595         MOVE AL-UANON        TO CAUSEA
 13596     END-IF
 13597     IF WS-SAVE-ENDL > 0
 13598         MOVE WS-SAVE-ENDI  TO ENDI
 13599         MOVE WS-SAVE-ENDL  TO ENDL
 13600         MOVE AL-UANON      TO ENDA
 13601     END-IF
 13602     IF WS-SAVE-DIAGL > 0
 13603         MOVE WS-SAVE-DIAGI  TO DIAGI
 13604         MOVE WS-SAVE-DIAGL  TO DIAGL
 13605         MOVE AL-UANON       TO DIAGA
 13606     END-IF
 13607     IF WS-SAVE-BENEL > 0
 13608         MOVE WS-SAVE-BENEI  TO BENEI
 13609         MOVE WS-SAVE-BENEL  TO BENEL
 13610         MOVE AL-UANON       TO BENEA
 13611     END-IF
 13612     IF WS-SAVE-BIRTHL > 0
 13613         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 13614         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 13615         MOVE AL-UANON        TO BIRTHA
 13616     END-IF
 13617     IF WS-SAVE-SOCIALL > 0
 13618         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 13619         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 13620         MOVE AL-UANON         TO SOCIALA
 13621     END-IF
 13622     IF WS-SAVE-SEXL > 0
 13623         MOVE WS-SAVE-SEXI  TO SEXI
 13624         MOVE WS-SAVE-SEXL  TO SEXL
 13625         MOVE AL-UANON      TO SEXA
 13626     END-IF
 13627     IF WS-SAVE-MLNAMEL > 0
 13628         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 13629         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 13630         MOVE AL-UANON         TO MLNAMEA
 13631     END-IF
 13632     IF WS-SAVE-MFNAMEL > 0
 13633         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 13634         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 13635         MOVE AL-UANON         TO MFNAMEA
 13636     END-IF
 13637     IF WS-SAVE-MMINITL > 0
 13638         MOVE WS-SAVE-MMINITI  TO MMINITI
 13639         MOVE WS-SAVE-MMINITL  TO MMINITL
 13640         MOVE AL-UANON         TO MMINITA
 13641     END-IF
 13642     IF WS-SAVE-LOANNOL > 0
 13643         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 13644         MOVE WS-SAVE-LOANNOL  TO LOANNOL
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 257
* EL131.cbl
 13645         MOVE AL-UANON         TO LOANNOA
 13646     END-IF
 13647     IF WS-SAVE-LOANBALL > 0
 13648         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 13649         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 13650         MOVE AL-UANON          TO LOANBALA
 13651     END-IF
 13652     IF WS-SAVE-PROCL > 0
 13653         MOVE WS-SAVE-PROCI  TO PROCI
 13654         MOVE WS-SAVE-PROCL  TO PROCL
 13655         MOVE AL-UANON       TO PROCA
 13656     END-IF
 13657     IF WS-SAVE-SUPVL > 0
 13658         MOVE WS-SAVE-SUPVI  TO SUPVI
 13659         MOVE WS-SAVE-SUPVL  TO SUPVL
 13660         MOVE AL-UANON       TO SUPVA
 13661     END-IF
 13662     IF WS-SAVE-PRICDL > 0
 13663         MOVE WS-SAVE-PRICDI  TO PRICDI
 13664         MOVE WS-SAVE-PRICDL  TO PRICDL
 13665         MOVE AL-UANON        TO PRICDA
 13666     END-IF
 13667     IF WS-SAVE-FILETOL > 0
 13668         MOVE WS-SAVE-FILETOI  TO FILETOI
 13669         MOVE WS-SAVE-FILETOL  TO FILETOL
 13670         MOVE AL-UANON         TO FILETOA
 13671     END-IF
 13672     IF WS-SAVE-PDTHRUL > 0
 13673         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 13674         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 13675         MOVE AL-UANON         TO PDTHRUA
 13676     END-IF
 13677     IF WS-SAVE-PDAMTL > 0
 13678         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 13679         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 13680         MOVE AL-UANON        TO PDAMTA
 13681     END-IF
 13682     IF WS-SAVE-NODAYSL > 0
 13683         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 13684         MOVE WS-SAVE-NODAYSL  TO NODAYSL
 13685         MOVE AL-UANON         TO NODAYSA
 13686     END-IF
 13687     IF WS-SAVE-NOPMTSL > 0
 13688         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 13689         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 13690         MOVE AL-UANON         TO NOPMTSA
 13691     END-IF
 13692     IF WS-SAVE-FORMTYPL > 0
 13693         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 13694         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 13695         MOVE AL-UANON          TO FORMTYPA
 13696     END-IF
 13697     IF WS-SAVE-OCCL > 0
 13698         MOVE WS-SAVE-OCCI  TO OCCI
 13699         MOVE WS-SAVE-OCCL  TO OCCL
 13700         MOVE AL-UANON      TO OCCA
 13701     END-IF.
 13702 4200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 258
* EL131.cbl
 13703      EXIT.
 13704
 13705 5000-BUILD-MAP.
 13706     IF PI-RETURN-CD-1 = SPACE
 13707         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 13708
 13709     MOVE SPACE                  TO PI-RETURN-CD-1.
 13710
 13711     MOVE LOW-VALUES             TO EL131AI.
 13712
 13713     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 13714     MOVE PI-CARRIER             TO CARRIER-CODE.
 13715     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 13716     MOVE PI-CERT-NO             TO CERT-NO.
 13717
 13718 5000-READ-CLAIM-MASTER.
 13719
 13720
 13721* EXEC CICS READ
 13722*         SET      (ADDRESS OF CLAIM-MASTER)
 13723*         DATASET  (CLMS-FILE-ID)
 13724*         RIDFLD   (MSTR-KEY)
 13725*    END-EXEC.
 13726*    MOVE '&"S        E          (   #00011630' TO DFHEIV0
 13727     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13729     MOVE X'2020233030303131363330' TO DFHEIV0(25:11)
 13730     CALL 'kxdfhei1' USING DFHEIV0,
 13731           CLMS-FILE-ID,
 13732           DFHEIV20,
 13733           DFHEIV99,
 13734           MSTR-KEY,
 13735           DFHEIV99,
 13736           DFHEIV99,
 13737           DFHEIV99
 13738     SET ADDRESS OF CLAIM-MASTER TO
 13739         DFHEIV20
 13740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13741
 13742
 13743     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 13744
 13745 5000-READ-DIAGNOSIS-TRAILER.
 13746
 13747
 13748* EXEC CICS HANDLE CONDITION
 13749*         NOTFND (5000-TRLR-NOT-FOUND)
 13750*    END-EXEC.
 13751*    MOVE '"$I                   ! A #00011640' TO DFHEIV0
 13752     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13754     MOVE X'4120233030303131363430' TO DFHEIV0(25:11)
 13755     CALL 'kxdfhei1' USING DFHEIV0
 13756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13757
 13758
 13759     MOVE MSTR-KEY               TO TRLR-KEY.
 13760     MOVE NINETY                 TO TRLR-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 259
* EL131.cbl
 13761
 13762
 13763* EXEC CICS READ
 13764*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13765*         DATASET  (TRLR-FILE-ID)
 13766*         RIDFLD   (TRLR-KEY)
 13767*    END-EXEC.
 13768*    MOVE '&"S        E          (   #00011647' TO DFHEIV0
 13769     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13770     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13771     MOVE X'2020233030303131363437' TO DFHEIV0(25:11)
 13772     CALL 'kxdfhei1' USING DFHEIV0,
 13773           TRLR-FILE-ID,
 13774           DFHEIV20,
 13775           DFHEIV99,
 13776           TRLR-KEY,
 13777           DFHEIV99,
 13778           DFHEIV99,
 13779           DFHEIV99
 13780     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13781         DFHEIV20
 13782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13783
 13784
 13785     MOVE AT-INFO-LINE-1         TO DIAGO.
 13786
 13787 5000-READ-CERTIFICATE-MASTER.
 13788
 13789     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 13790     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 13791     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 13792     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 13793     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 13794     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 13795     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 13796
 13797
 13798* EXEC CICS HANDLE CONDITION
 13799*         NOTFND (5000-CERT-NOT-FOUND)
 13800*    END-EXEC.
 13801*    MOVE '"$I                   ! B #00011665' TO DFHEIV0
 13802     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13804     MOVE X'4220233030303131363635' TO DFHEIV0(25:11)
 13805     CALL 'kxdfhei1' USING DFHEIV0
 13806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13807
 13808
 13809
 13810* EXEC CICS READ
 13811*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13812*         DATASET  (CERT-FILE-ID)
 13813*         RIDFLD   (CERT-KEY)
 13814*    END-EXEC.
 13815*    MOVE '&"S        E          (   #00011669' TO DFHEIV0
 13816     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13817     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13818     MOVE X'2020233030303131363639' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 260
* EL131.cbl
 13819     CALL 'kxdfhei1' USING DFHEIV0,
 13820           CERT-FILE-ID,
 13821           DFHEIV20,
 13822           DFHEIV99,
 13823           CERT-KEY,
 13824           DFHEIV99,
 13825           DFHEIV99,
 13826           DFHEIV99
 13827     SET ADDRESS OF CERTIFICATE-MASTER TO
 13828         DFHEIV20
 13829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13830
 13831
 13832     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 13833     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 13834
 13835     GO TO 5000-EXIT.
 13836
 13837 5000-TRLR-NOT-FOUND.
 13838     MOVE ER-7687                TO EMI-ERROR.
 13839     MOVE -1                     TO DIAGL.
 13840     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13841     GO TO 5000-EXIT.
 13842
 13843 5000-CERT-NOT-FOUND.
 13844     MOVE ER-0206                TO EMI-ERROR.
 13845     MOVE -1                     TO CERTL.
 13846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13847
 13848 5000-EXIT.
 13849     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 261
* EL131.cbl
 13851 5010-RESET-PI-AREA.
 13852     IF CERTI GREATER THAN LOW-VALUES
 13853         MOVE CERTI              TO PI-CERT-PRIME.
 13854
 13855     IF SUFXI GREATER THAN LOW-VALUES
 13856         MOVE SUFXI              TO PI-CERT-SFX.
 13857
 13858     IF CERTEFFI GREATER THAN LOW-VALUES
 13859         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 13860
 13861     IF CERTACTI GREATER THAN LOW-VALUES
 13862         MOVE CERTACTI           TO PI-ACCOUNT.
 13863
 13864     IF CERTSTI GREATER THAN LOW-VALUES
 13865         MOVE CERTSTI            TO PI-STATE.
 13866
 13867     IF CERTCARI GREATER THAN LOW-VALUES
 13868         MOVE CERTCARI           TO PI-CARRIER.
 13869
 13870     IF CERTGRPI GREATER THAN LOW-VALUES
 13871         MOVE CERTGRPI           TO PI-GROUPING.
 13872
 13873 5010-EXIT.
 13874     EXIT.
 13875
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 262
* EL131.cbl
 13877 5020-MOVE-MSTR.
 13878
 13879     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 13880     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 13881     MOVE WS-CLAIM-SEQU          TO SEQUO.
 13882     MOVE AL-SABON               TO SEQUA.
 13883     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 13884     MOVE CL-CLAIM-TYPE          TO TYPEO
 13885                                    pi-claim-type
 13886
 13887     IF CL-TOTAL-PAID-AMT  = +0 AND
 13888        CL-LAST-PMT-AMT    = +0 AND
 13889        CL-NO-OF-PMTS-MADE = +0
 13890          MOVE AL-UANON          TO TYPEA.
 13891
 13892     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13893     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13894     MOVE CL-CERT-PRIME          TO CERTO.
 13895     MOVE CL-CERT-SFX            TO SUFXO.
 13896     MOVE CL-CERT-CARRIER        TO CARRO.
 13897
 13898     IF CL-CLAIM-STATUS = 'C'
 13899         MOVE 'CLOSED'           TO STATUSO
 13900     ELSE
 13901         MOVE 'OPEN  '           TO STATUSO.
 13902
 13903     move cl-accident-claim-sw   to accswo
 13904     MOVE CL-PROCESSOR-ID        TO PROCO.
 13905
 13906     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 13907     MOVE CL-CCN                 TO CCNOO.
 13908
 13909     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 13910     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 13911     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 13912     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13913
 13914     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 13915         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13916         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13917         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13918         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 13919     ELSE
 13920         MOVE SPACES             TO BIRTHO.
 13921
 13922     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 13923        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 13924         NEXT SENTENCE
 13925       ELSE
 13926         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 13927
 13928     IF PI-COMPANY-ID = 'DMD'
 13929       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 13930          IF SOCIALO = SPACES OR LOW-VALUES
 13931            MOVE ER-0885         TO EMI-ERROR
 13932            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13933
 13934     MOVE CL-INSURED-OCC-CD      TO OCCO.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 263
* EL131.cbl
 13935     MOVE CL-CAUSE-CD            TO CAUSEO.
 13936
 13937     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 13938         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13939         MOVE SPACES                 TO DC-OPTION-CODE
 13940         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13941         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 13942     ELSE
 13943         MOVE SPACES             TO ENDO.
 13944
 13945     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 13946        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13947        MOVE SPACES             TO DC-OPTION-CODE
 13948        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13949        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13950        IF PI-USES-PAID-TO
 13951           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13952           MOVE '6'                TO DC-OPTION-CODE
 13953           MOVE +1                 TO DC-ELAPSED-DAYS
 13954           MOVE +0                 TO DC-ELAPSED-MONTHS
 13955           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13956           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13957        ELSE
 13958           NEXT SENTENCE
 13959     ELSE
 13960        MOVE SPACES             TO PDTHRUO.
 13961
 13962     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 13963     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 13964     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 13965     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 13966
 13967     IF MODIFY-CAP
 13968        MOVE AL-UNNOF            TO PDAMTA
 13969                                    NODAYSA
 13970                                    NOPMTSA
 13971        MOVE AL-UANOF            TO PDTHRUA.
 13972     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 13973     MOVE '2'                    TO CNTL-REC-TYPE
 13974     MOVE +0                     TO CNTL-SEQ-NO
 13975     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 13976
 13977
 13978* EXEC CICS READ
 13979*         DATASET  (CNTL-FILE-ID)
 13980*         SET      (ADDRESS OF CONTROL-FILE)
 13981*         RIDFLD   (CNTL-KEY)
 13982*         RESP     (WS-RESPONSE)
 13983*    END-EXEC
 13984*    MOVE '&"S        E          (  N#00011820' TO DFHEIV0
 13985     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13986     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13987     MOVE X'204E233030303131383230' TO DFHEIV0(25:11)
 13988     CALL 'kxdfhei1' USING DFHEIV0,
 13989           CNTL-FILE-ID,
 13990           DFHEIV20,
 13991           DFHEIV99,
 13992           CNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 264
* EL131.cbl
 13993           DFHEIV99,
 13994           DFHEIV99,
 13995           DFHEIV99
 13996     SET ADDRESS OF CONTROL-FILE TO
 13997         DFHEIV20
 13998     MOVE EIBRESP  TO WS-RESPONSE
 13999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14000
 14001     IF WS-RESP-NORMAL
 14002        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14003     end-if
 14004     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14005         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14006         MOVE SPACES             TO DC-OPTION-CODE
 14007         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14008         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14009     ELSE
 14010         MOVE SPACES             TO INCO.
 14011
 14012     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14013        or (pi-approval-level = '5')
 14014        MOVE AL-UANOF            TO INCA
 14015     end-if
 14016     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14017
 14018     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14019         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14020         MOVE SPACES             TO DC-OPTION-CODE
 14021         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14022         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14023     ELSE
 14024         MOVE SPACES             TO REPO.
 14025
 14026     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14027         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14028         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14029         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14030         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14031     ELSE
 14032         MOVE SPACES             TO ESTO.
 14033
 14034     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14035         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14036         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14037         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14038         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14039     ELSE
 14040         MOVE SPACES             TO MNTDTO.
 14041
 14042
 14043     IF CL-LAST-MAINT-TYPE = SPACE
 14044         MOVE 'SET-UP'           TO MNTTYPEO
 14045     ELSE
 14046     IF CL-LAST-MAINT-TYPE = '1'
 14047         MOVE 'PAYMNT'           TO MNTTYPEO
 14048     ELSE
 14049     IF CL-LAST-MAINT-TYPE = '2'
 14050         MOVE 'LETTER'           TO MNTTYPEO
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 265
* EL131.cbl
 14051     ELSE
 14052     IF CL-LAST-MAINT-TYPE = '3'
 14053         MOVE 'UPDATE'           TO MNTTYPEO
 14054     ELSE
 14055     IF CL-LAST-MAINT-TYPE = '4'
 14056         MOVE 'RESTOR'           TO MNTTYPEO
 14057     ELSE
 14058     IF CL-LAST-MAINT-TYPE = '5'
 14059         MOVE 'INC DT'           TO MNTTYPEO
 14060     ELSE
 14061     IF CL-LAST-MAINT-TYPE = '6'
 14062         MOVE ' CONV'            TO MNTTYPEO
 14063     ELSE
 14064     IF CL-LAST-MAINT-TYPE = 'C'
 14065         MOVE 'CHGBEN'           TO MNTTYPEO
 14066     ELSE
 14067     IF CL-LAST-MAINT-TYPE = 'E'
 14068         MOVE 'ERRCOR'           TO MNTTYPEO
 14069     ELSE
 14070         MOVE SPACES             TO MNTTYPEO.
 14071
 14072     MOVE CL-BENEFICIARY         TO BENEO.
 14073     MOVE CL-FILE-LOCATION       TO FILETOO.
 14074     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14075        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14076     END-IF
 14077     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14078     MOVE CL-CRIT-PER-RECURRENT
 14079                                 TO CRITPTO
 14080     IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14081        MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14082     END-IF
 14083     MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14084     MOVE CL-PRIORITY-CD         TO PRICDO.
 14085     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14086     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14087     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14088     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14089
 14090 5020-EXIT.
 14091     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 266
* EL131.cbl
 14093 5030-MOVE-CERT.
 14094
 14095     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14096         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14097         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14098         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14099         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14100       ELSE
 14101         MOVE SPACES             TO CERTEFFO
 14102         MOVE ZERO               TO HOLD-DATE.
 14103
 14104     MOVE CM-ACCOUNT             TO CERTACTO.
 14105     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14106     MOVE CM-GROUPING            TO CERTGRPO.
 14107     MOVE CM-CARRIER             TO CERTCARO.
 14108     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14109     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14110     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14111     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14112     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14113     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14114     MOVE CM-JT-INITIAL          TO JNTINITO.
 14115     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14116
 14117*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14118     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14119     MOVE '3'                    TO CNTL-REC-TYPE.
 14120     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14121     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14122     MOVE ZERO                   TO CNTL-SEQ-NO.
 14123
 14124
 14125* EXEC CICS READ
 14126*         SET        (ADDRESS OF CONTROL-FILE)
 14127*         DATASET    ('ELCNTL')
 14128*         RIDFLD     (CNTL-KEY)
 14129*         RESP       (WS-RESPONSE)
 14130*    END-EXEC.
 14131     MOVE 'ELCNTL' TO DFHEIV1
 14132*    MOVE '&"S        E          (  N#00011950' TO DFHEIV0
 14133     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14135     MOVE X'204E233030303131393530' TO DFHEIV0(25:11)
 14136     CALL 'kxdfhei1' USING DFHEIV0,
 14137           DFHEIV1,
 14138           DFHEIV20,
 14139           DFHEIV99,
 14140           CNTL-KEY,
 14141           DFHEIV99,
 14142           DFHEIV99,
 14143           DFHEIV99
 14144     SET ADDRESS OF CONTROL-FILE TO
 14145         DFHEIV20
 14146     MOVE EIBRESP  TO WS-RESPONSE
 14147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14148
 14149
 14150     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 267
* EL131.cbl
 14151        MOVE ZERO                TO CP-FREE-LOOK
 14152     ELSE
 14153        MOVE CF-ST-FREE-LOOK-PERIOD
 14154                                 TO CP-FREE-LOOK.
 14155
 14156     IF CM-LF-BENEFIT-CD = '00'
 14157        GO TO 5030-MOVE-CERT-AH.
 14158
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 268
* EL131.cbl
 14160     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14161     MOVE '5'                    TO DC-OPTION-CODE
 14162     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14163     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14164     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14165     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14166     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 14167     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14168     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14169     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 14170     MOVE '4'                    TO CP-REM-TERM-METHOD
 14171     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 14172     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14173     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14174
 14175     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14176     IF CM-LF-PREMIUM-RATE NUMERIC
 14177         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14178     ELSE
 14179         MOVE ZEROS              TO LCVRATEO.
 14180
 14181     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14182         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 14183
 14184     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 14185
 14186     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 14187
 14188     IF CM-LF-CURRENT-STATUS = '8'
 14189        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14190            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14191            MOVE ' '             TO DC-OPTION-CODE
 14192            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14193            IF NOT DATE-CONVERSION-ERROR
 14194                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14195
 14196     IF CM-LF-CURRENT-STATUS = '7'
 14197        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14198            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 14199            MOVE ' '             TO DC-OPTION-CODE
 14200            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14201            IF NOT DATE-CONVERSION-ERROR
 14202                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14203
 14204     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14205         MOVE ' '                TO DC-OPTION-CODE
 14206         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 14207         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14208         IF NOT DATE-CONVERSION-ERROR
 14209             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 14210             MOVE HOLD-MONTH     TO WORK-MONTH
 14211             MOVE HOLD-YEAR      TO WORK-YEAR
 14212             MOVE WORK-DATE-MY   TO LCVEXITO.
 14213
 14214     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14215        IF CP-REMAINING-TERM-3 = ZEROS
 14216           MOVE 'EXPIRED'        TO LCVSTATO
 14217        ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 269
* EL131.cbl
 14218           MOVE 'ACTIVE'         TO LCVSTATO.
 14219
 14220     IF CM-LF-CURRENT-STATUS = '2'
 14221        MOVE 'PEND   '           TO LCVSTATO.
 14222     IF CM-LF-CURRENT-STATUS = '3'
 14223        MOVE 'RESTORE'           TO LCVSTATO.
 14224     IF CM-LF-CURRENT-STATUS = '5'
 14225        MOVE 'REISSUE'           TO LCVSTATO.
 14226     IF CM-LF-CURRENT-STATUS = '6'
 14227        MOVE 'LMP DIS'           TO LCVSTATO.
 14228     IF CM-LF-CURRENT-STATUS = '7'
 14229        MOVE 'DEATH  '           TO LCVSTATO.
 14230     IF CM-LF-CURRENT-STATUS = '8'
 14231        MOVE 'CANCEL '           TO LCVSTATO.
 14232     IF CM-LF-CURRENT-STATUS = '9'
 14233        MOVE 'RE-ONLY'           TO LCVSTATO.
 14234     IF CM-LF-CURRENT-STATUS = 'V'
 14235        MOVE 'VOID   '           TO LCVSTATO.
 14236     IF CM-LF-CURRENT-STATUS = 'D'
 14237        MOVE 'DECLINE'           TO LCVSTATO.
 14238
 14239     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14240     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14241     MOVE '4'                    TO BEN-REC-TYPE.
 14242     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 14243     MOVE ZERO                   TO BEN-SEQ-NO.
 14244
 14245
 14246* EXEC CICS READ GTEQ
 14247*         DATASET  (CNTL-FILE-ID)
 14248*         RIDFLD   (BENEFIT-KEY)
 14249*         SET      (ADDRESS OF CONTROL-FILE)
 14250*    END-EXEC.
 14251*    MOVE '&"S        G          (   #00012052' TO DFHEIV0
 14252     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14254     MOVE X'2020233030303132303532' TO DFHEIV0(25:11)
 14255     CALL 'kxdfhei1' USING DFHEIV0,
 14256           CNTL-FILE-ID,
 14257           DFHEIV20,
 14258           DFHEIV99,
 14259           BENEFIT-KEY,
 14260           DFHEIV99,
 14261           DFHEIV99,
 14262           DFHEIV99
 14263     SET ADDRESS OF CONTROL-FILE TO
 14264         DFHEIV20
 14265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14266
 14267
 14268     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14269        CF-RECORD-TYPE NOT = '4'
 14270         MOVE ER-0240            TO EMI-ERROR
 14271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14272         GO TO 5030-MOVE-CERT-FINISH.
 14273
 14274     MOVE ZERO                   TO COUNT-2.
 14275     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 270
* EL131.cbl
 14276
 14277     IF SCREEN-ERROR
 14278         MOVE ER-0282            TO EMI-ERROR
 14279         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14280        ELSE
 14281         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 14282
 14283 5030-MOVE-CERT-AH.
 14284
 14285     IF CM-LF-BENEFIT-CD = '00'
 14286         IF CM-AH-BENEFIT-CD = '00'
 14287             GO TO 5030-MOVE-CERT-FINISH.
 14288
 14289     IF CM-AH-BENEFIT-CD = '00'
 14290        MOVE SPACES             TO ACVKINDO
 14291        COMPUTE PI-PAYMENT-AMT =
 14292                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 14293        GO TO 5030-MOVE-CERT-FINISH.
 14294
 14295     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14296     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 14297     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 14298     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 14299     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14300     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14301     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14302     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 14303
 14304**DMD **********************************************
 14305     IF PI-COMPANY-ID = 'DMD'
 14306         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 14307                                   CM-PMT-EXTENSION-DAYS
 14308         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 14309                                      CL-NO-OF-DAYS-PAID
 14310         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 14311             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 14312         MOVE WS-REM-MOS         TO ACVRTRMO
 14313                                    CP-REMAINING-TERM-3
 14314*        MOVE WS-REM-DAYS        TO DAYSPO
 14315         GO TO 5030-SKIP-RTRM.
 14316**DMD **********************************************
 14317
 14318     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14319     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14320     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14321     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14322
 14323 5030-SKIP-RTRM.
 14324     IF CM-AH-PREMIUM-RATE NUMERIC
 14325         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14326     ELSE
 14327         MOVE ZEROS              TO ACVRATEO.
 14328
 14329     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 14330     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 14331
 14332     IF CM-AH-CURRENT-STATUS = '8'
 14333        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 271
* EL131.cbl
 14334            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14335            MOVE ' '             TO DC-OPTION-CODE
 14336            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14337            IF NOT DATE-CONVERSION-ERROR
 14338                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14339
 14340     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14341        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14342            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 14343            MOVE ' '             TO DC-OPTION-CODE
 14344            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14345            IF NOT DATE-CONVERSION-ERROR
 14346                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14347
 14348     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14349        IF CP-REMAINING-TERM-3 = ZEROS
 14350           MOVE 'EXPIRED'        TO ACVSTATO
 14351        ELSE
 14352           MOVE 'ACTIVE'         TO ACVSTATO.
 14353
 14354     IF CM-AH-CURRENT-STATUS = '2'
 14355        MOVE 'PEND   '           TO ACVSTATO.
 14356     IF CM-AH-CURRENT-STATUS = '3'
 14357        MOVE 'RESTORE'           TO ACVSTATO.
 14358     IF CM-AH-CURRENT-STATUS = '5'
 14359        MOVE 'REISSUE'           TO ACVSTATO.
 14360     IF CM-AH-CURRENT-STATUS = '6'
 14361        MOVE 'LMP DIS'           TO ACVSTATO.
 14362     IF CM-AH-CURRENT-STATUS = '7'
 14363        MOVE 'DEATH  '           TO ACVSTATO.
 14364     IF CM-AH-CURRENT-STATUS = '8'
 14365        MOVE 'CANCEL '           TO ACVSTATO.
 14366     IF CM-AH-CURRENT-STATUS = '9'
 14367        MOVE 'RE-ONLY'           TO ACVSTATO.
 14368     IF CM-AH-CURRENT-STATUS = 'V'
 14369        MOVE 'VOID   '           TO ACVSTATO.
 14370     IF CM-AH-CURRENT-STATUS = '9'
 14371        MOVE 'DECLINE'           TO ACVSTATO.
 14372
 14373     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14374         MOVE ' '                TO DC-OPTION-CODE
 14375         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14376         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14377         IF NOT DATE-CONVERSION-ERROR
 14378             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 14379             MOVE HOLD-MONTH     TO WORK-MONTH
 14380             MOVE HOLD-YEAR      TO WORK-YEAR
 14381             MOVE WORK-DATE-MY   TO ACVEXITO.
 14382
 14383     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14384
 14385     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14386     MOVE '5'                    TO BEN-REC-TYPE.
 14387     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 14388     MOVE ZERO                   TO BEN-SEQ-NO.
 14389
 14390
 14391* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 272
* EL131.cbl
 14392*         DATASET  (CNTL-FILE-ID)
 14393*         RIDFLD   (BENEFIT-KEY)
 14394*         SET      (ADDRESS OF CONTROL-FILE)
 14395*    END-EXEC.
 14396*    MOVE '&"S        G          (   #00012180' TO DFHEIV0
 14397     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14399     MOVE X'2020233030303132313830' TO DFHEIV0(25:11)
 14400     CALL 'kxdfhei1' USING DFHEIV0,
 14401           CNTL-FILE-ID,
 14402           DFHEIV20,
 14403           DFHEIV99,
 14404           BENEFIT-KEY,
 14405           DFHEIV99,
 14406           DFHEIV99,
 14407           DFHEIV99
 14408     SET ADDRESS OF CONTROL-FILE TO
 14409         DFHEIV20
 14410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14411
 14412
 14413     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14414        CF-RECORD-TYPE NOT = '5'
 14415         MOVE ER-0250            TO EMI-ERROR
 14416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14417         GO TO 5030-MOVE-CERT-FINISH.
 14418
 14419     MOVE ZERO                   TO COUNT-2.
 14420     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 14421
 14422     IF SCREEN-ERROR
 14423         MOVE ER-0283            TO EMI-ERROR
 14424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14425       ELSE
 14426         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 14427
 14428 5030-MOVE-CERT-FINISH.
 14429
 14430     MOVE CM-LOAN-APR            TO APRO.
 14431     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14432     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14433     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 14434     MOVE CM-LOAN-NUMBER         TO LOANNOO
 14435     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 14436     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 14437
 14438     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 14439         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14440         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14441         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14442         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 14443     ELSE
 14444         MOVE SPACES               TO ADDONDTO.
 14445
 14446     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 14447
 14448 5030-EXIT.
 14449     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 273
* EL131.cbl
 14451 5040-FIND-BENEFIT.
 14452     ADD 1                       TO COUNT-2.
 14453     IF COUNT-2 GREATER THAN 8
 14454         GO TO 5050-BENEFIT-NOTFND.
 14455
 14456     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 14457         GO TO 5060-EXIT.
 14458
 14459     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 14460         GO TO 5050-BENEFIT-NOTFND.
 14461
 14462     GO TO 5040-FIND-BENEFIT.
 14463
 14464 5050-BENEFIT-NOTFND.
 14465     MOVE 'X'                    TO ERROR-SWITCH.
 14466
 14467 5060-EXIT.
 14468     EXIT.
 14469
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 274
* EL131.cbl
 14471 6000-CALCULATE-CERT-TERM.
 14472
 14473     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 14474         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 14475     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 14476         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 14477     IF CM-LOAN-APR NOT NUMERIC
 14478         MOVE ZEROS              TO CM-LOAN-APR.
 14479
 14480*    IF WS-CALC-METHOD  = 'G'
 14481         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 14482*     ELSE
 14483*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 14484
 14485     IF N GREATER 120
 14486         MOVE 120                TO N.
 14487
 14488     MOVE '6'                    TO DC-OPTION-CODE.
 14489     MOVE N                      TO DC-ELAPSED-MONTHS.
 14490     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14491     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 14492
 14493     IF CM-LF-BENEFIT-CD NOT = ZERO
 14494         MOVE N                  TO CM-LF-ORIG-TERM
 14495         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 14496         IF NO-CONVERSION-ERROR
 14497             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 14498
 14499     IF CM-AH-BENEFIT-CD NOT = ZERO
 14500         MOVE N                  TO CM-AH-ORIG-TERM
 14501         IF NO-CONVERSION-ERROR
 14502             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 14503
 14504 6000-EXIT.
 14505      EXIT.
 14506
 14507 6100-CALC-GROSS-TERM.
 14508     MOVE CM-LOAN-BALANCE         TO L.
 14509     MOVE PI-PAYMENT-AMT          TO M.
 14510
 14511     COMPUTE N = L / M.
 14512     IF N LESS 1
 14513         MOVE 1  TO N.
 14514
 14515     IF CM-LF-BENEFIT-CD NOT = ZERO
 14516         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 14517     ELSE
 14518         MOVE ZEROS               TO WS-LF-RATE.
 14519
 14520     IF CM-AH-BENEFIT-CD NOT = ZERO
 14521         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 14522     ELSE
 14523         MOVE ZEROS               TO WS-AH-RATE.
 14524
 14525     COMPUTE I = CM-LOAN-APR / +1200.
 14526
 14527 6105-LOOP.
 14528     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 275
* EL131.cbl
 14529         GO TO 6200-EXIT.
 14530     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 14531     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 14532         ADD 1 TO N
 14533         GO TO 6105-LOOP.
 14534
 14535 6200-EXIT.
 14536      EXIT.
 14537
 14538 6210-CALC-LEFT-RIGHTONE.
 14539      MOVE L         TO LEFT-TOT-1.
 14540      SUBTRACT 1 FROM N.
 14541      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14542      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 14543      ADD 1 TO N.
 14544 6211-CALC-TERM1.
 14545      MOVE N         TO TERM1.
 14546      MULTIPLY M BY TERM1.
 14547 6212-LOOP.
 14548      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 14549      ADD 1 TO A-N.
 14550      MULTIPLY A-N BY TERM1.
 14551      SUBTRACT 1 FROM A-N.
 14552      ADD TERM1 TO LEFT-TOT-1.
 14553 6213-CALC-TERM2.
 14554      MOVE M         TO TERM2.
 14555      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 14556      MULTIPLY IA-N BY TERM2.
 14557      SUBTRACT TERM2 FROM LEFT-TOT-1.
 14558 6215-CALC-RIGHTONE.
 14559      MOVE M         TO RIGHT-TOT-1.
 14560      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14561      MULTIPLY A-N BY RIGHT-TOT-1.
 14562 6220-EXIT.
 14563      EXIT.
 14564
 14565 6300-CALC-A-N.
 14566     IF N LESS 1
 14567         MOVE 0     TO A-N
 14568         GO TO 6300-EXIT.
 14569     IF I = 0
 14570         MOVE .00001 TO I.
 14571     ADD 1 TO I.
 14572     DIVIDE I INTO 1 GIVING V.
 14573     SUBTRACT 1 FROM I.
 14574     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14575     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 14576     DIVIDE I INTO TERM3 GIVING A-N.
 14577 6300-EXIT.
 14578      EXIT.
 14579
 14580 6350-CALC-IA-N.
 14581     IF N LESS 1
 14582         MOVE 0      TO IA-N
 14583         GO TO 6400-EXIT.
 14584     ADD 1 TO N.
 14585     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14586     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 276
* EL131.cbl
 14587     MULTIPLY N BY V-EX-N GIVING TERM3.
 14588     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 14589     SUBTRACT V FROM 1 GIVING TERM4.
 14590     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 14591 6400-EXIT.
 14592      EXIT.
 14593
 14594 6450-CALC-V-EX-N.
 14595     IF N LESS 1
 14596         MOVE 1    TO V-EX-N
 14597         GO TO 6490-EXIT.
 14598     MOVE N        TO NV-STORE.
 14599     IF V-EX-ONETIME = 1  OR
 14600        V NOT = V-EXPONENT (1)
 14601          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 14602 6460-LOOP.
 14603     IF N GREATER 248
 14604         MOVE 248 TO N.
 14605     IF N = 1
 14606         MOVE V               TO V-EX-N
 14607      ELSE
 14608         MOVE V-EXPONENT (N)  TO V-EX-N.
 14609     GO TO 6490-EXIT.
 14610
 14611 6470-BUILD-V-EX-TABLE.
 14612     MOVE 2      TO N.
 14613     MOVE V      TO V-EXPONENT (1)
 14614                    V-EX-N.
 14615 6471-LOOP.
 14616     MULTIPLY V BY V-EX-N.
 14617     MOVE V-EX-N   TO V-EXPONENT (N).
 14618     ADD 1 TO N.
 14619     IF N LESS 248
 14620         GO TO 6471-LOOP.
 14621     MOVE NV-STORE     TO N.
 14622     MOVE 0            TO V-EX-ONETIME.
 14623 6480-EXIT.
 14624      EXIT.
 14625
 14626 6490-EXIT.
 14627      EXIT.
 14628
 14629 6500-CALC-NET-TERM.
 14630     MOVE CM-LOAN-BALANCE         TO L.
 14631     MOVE PI-PAYMENT-AMT          TO M.
 14632
 14633     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 14634     IF WS-REMAIN GREATER ZERO
 14635         ADD 1 TO N.
 14636     IF N = 0
 14637         MOVE 1 TO N.
 14638
 14639 6700-EXIT.
 14640      EXIT.
 14641
 14642 6999-CALC-TERM-EXIT.
 14643     EXIT.
 14644
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 277
* EL131.cbl
 14646 7000-RESET-ATTRIBUTE.
 14647
 14648     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 14649                                    CERTSTA   CERTCARA
 14650                                    CERTGRPA.
 14651     MOVE -1                     TO CERTCARL.
 14652
 14653 7000-EXIT.
 14654     EXIT.
 14655
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 278
* EL131.cbl
 14657 7600-BROWSE-CLAIM.
 14658
 14659
 14660* EXEC CICS READ
 14661*        DATASET(CLMS-FILE-ID)
 14662*        SET    (ADDRESS OF CLAIM-MASTER)
 14663*        RIDFLD (MSTR-KEY)
 14664*        GENERIC
 14665*        EQUAL
 14666*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14667*    END-EXEC.
 14668*    MOVE '&"S  KG    E          (   #00012432' TO DFHEIV0
 14669     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14670     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14671     MOVE X'2020233030303132343332' TO DFHEIV0(25:11)
 14672     CALL 'kxdfhei1' USING DFHEIV0,
 14673           CLMS-FILE-ID,
 14674           DFHEIV20,
 14675           DFHEIV99,
 14676           MSTR-KEY,
 14677           ELMSTR-GENERIC-LENGTH,
 14678           DFHEIV99,
 14679           DFHEIV99
 14680     SET ADDRESS OF CLAIM-MASTER TO
 14681         DFHEIV20
 14682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14683
 14684
 14685     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 14686
 14687     if cl-assoc-cert-total = 0
 14688        move 1 to cl-assoc-cert-total
 14689     end-if
 14690     IF CL-ASSOC-CERT-SEQU = 0
 14691        MOVE 1 TO CL-ASSOC-CERT-SEQU
 14692     END-IF
 14693
 14694     IF CL-ASSOC-CERT-TOTAL = 1
 14695         MOVE AL-SADOF           TO BCERT1A
 14696                                    BSUFX1A
 14697                                    BCERT2A
 14698                                    BSUFX2A
 14699                                    BCERT3A
 14700                                    BSUFX3A
 14701                                    BCERT4A
 14702                                    BSUFX4A
 14703                                    BCERT5A
 14704                                    BSUFX5A
 14705                                    PCERTNOA
 14706                                    PSUFXA
 14707                                    LABEL1A
 14708                                    LABEL2A
 14709         GO TO 7699-EXIT.
 14710
 14711 7610-BROWSE-CLAIM-LOOP.
 14712
 14713     MOVE LOW-VALUES             TO BCERT1O
 14714                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 279
* EL131.cbl
 14715                                    BCERT2O
 14716                                    BSUFX2O
 14717                                    BCERT3O
 14718                                    BSUFX3O
 14719                                    BCERT4O
 14720                                    BSUFX4O
 14721                                    BCERT5O
 14722                                    BSUFX5O.
 14723
 14724
 14725* EXEC CICS HANDLE CONDITION
 14726*        ENDFILE  (7630-END-BROWSE)
 14727*    END-EXEC.
 14728*    MOVE '"$''                   ! C #00012480' TO DFHEIV0
 14729     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14731     MOVE X'4320233030303132343830' TO DFHEIV0(25:11)
 14732     CALL 'kxdfhei1' USING DFHEIV0
 14733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14734
 14735
 14736
 14737* EXEC CICS STARTBR
 14738*        DATASET    (CLMS-FILE-ID)
 14739*        RIDFLD     (MSTR-KEY)
 14740*    END-EXEC.
 14741     MOVE 0
 14742       TO DFHEIV11
 14743*    MOVE '&,         G          &   #00012484' TO DFHEIV0
 14744     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14745     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14746     MOVE X'2020233030303132343834' TO DFHEIV0(25:11)
 14747     CALL 'kxdfhei1' USING DFHEIV0,
 14748           CLMS-FILE-ID,
 14749           MSTR-KEY,
 14750           DFHEIV99,
 14751           DFHEIV11,
 14752           DFHEIV99
 14753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14754
 14755
 14756     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14757
 14758 7620-READ-CLAIM-LOOP.
 14759
 14760
 14761* EXEC CICS READNEXT
 14762*        DATASET   (CLMS-FILE-ID)
 14763*        SET       (ADDRESS OF CLAIM-MASTER)
 14764*        RIDFLD    (MSTR-KEY)
 14765*    END-EXEC.
 14766     MOVE 0
 14767       TO DFHEIV11
 14768*    MOVE '&.S                   )   #00012493' TO DFHEIV0
 14769     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14770     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14771     MOVE X'2020233030303132343933' TO DFHEIV0(25:11)
 14772     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 280
* EL131.cbl
 14773           CLMS-FILE-ID,
 14774           DFHEIV20,
 14775           DFHEIV99,
 14776           MSTR-KEY,
 14777           DFHEIV99,
 14778           DFHEIV11,
 14779           DFHEIV99,
 14780           DFHEIV99
 14781     SET ADDRESS OF CLAIM-MASTER TO
 14782         DFHEIV20
 14783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14784
 14785
 14786     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 14787        CL-CARRIER     NOT = CARRI           OR
 14788        CL-CLAIM-NO    NOT = CLAIMI
 14789        GO TO 7630-END-BROWSE.
 14790
 14791     IF WS-ASSOCIATED-CERTS = 1
 14792         MOVE CL-CERT-PRIME      TO BCERT1O
 14793         MOVE CL-CERT-SFX        TO BSUFX1O.
 14794
 14795     IF WS-ASSOCIATED-CERTS = 2
 14796         MOVE CL-CERT-PRIME      TO BCERT2O
 14797         MOVE CL-CERT-SFX        TO BSUFX2O.
 14798
 14799     IF WS-ASSOCIATED-CERTS = 3
 14800         MOVE CL-CERT-PRIME      TO BCERT3O
 14801         MOVE CL-CERT-SFX        TO BSUFX3O.
 14802
 14803     IF WS-ASSOCIATED-CERTS = 4
 14804         MOVE CL-CERT-PRIME      TO BCERT4O
 14805         MOVE CL-CERT-SFX        TO BSUFX4O.
 14806
 14807     IF WS-ASSOCIATED-CERTS = 5
 14808         MOVE CL-CERT-PRIME      TO BCERT5O
 14809         MOVE CL-CERT-SFX        TO BSUFX5O
 14810     ELSE
 14811         ADD +1                  TO WS-ASSOCIATED-CERTS
 14812         GO TO 7620-READ-CLAIM-LOOP.
 14813
 14814 7630-END-BROWSE.
 14815
 14816
 14817* EXEC CICS ENDBR
 14818*        DATASET   (CLMS-FILE-ID)
 14819*    END-EXEC.
 14820     MOVE 0
 14821       TO DFHEIV11
 14822*    MOVE '&2                    $   #00012529' TO DFHEIV0
 14823     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14824     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14825     MOVE X'2020233030303132353239' TO DFHEIV0(25:11)
 14826     CALL 'kxdfhei1' USING DFHEIV0,
 14827           CLMS-FILE-ID,
 14828           DFHEIV11,
 14829           DFHEIV99
 14830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 281
* EL131.cbl
 14831
 14832
 14833 7640-HIGHLIGHT-CERT-DISPLAYED.
 14834
 14835     MOVE AL-SANON               TO BCERT1A
 14836                                    BSUFX1A
 14837                                    BCERT2A
 14838                                    BSUFX2A
 14839                                    BCERT3A
 14840                                    BSUFX3A
 14841                                    BCERT4A
 14842                                    BSUFX4A
 14843                                    BCERT5A
 14844                                    BSUFX5A.
 14845
 14846     IF BCERT1O = CERTI AND
 14847        BSUFX1O = SUFXI
 14848            MOVE AL-SABON        TO BCERT1A
 14849                                    BSUFX1A.
 14850
 14851     IF BCERT2O = CERTI AND
 14852        BSUFX2O = SUFXI
 14853            MOVE AL-SABON        TO BCERT2A
 14854                                    BSUFX2A.
 14855
 14856     IF BCERT3O = CERTI AND
 14857        BSUFX3O = SUFXI
 14858            MOVE AL-SABON        TO BCERT3A
 14859                                    BSUFX3A.
 14860
 14861     IF BCERT4O = CERTI AND
 14862        BSUFX4O = SUFXI
 14863            MOVE AL-SABON        TO BCERT4A
 14864                                    BSUFX4A.
 14865
 14866     IF BCERT5O = CERTI AND
 14867        BSUFX5O = SUFXI
 14868            MOVE AL-SABON        TO BCERT5A
 14869                                    BSUFX5A.
 14870
 14871 7699-EXIT.
 14872     EXIT.
 14873
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 282
* EL131.cbl
 14875 7700-CHECK-SEQUENCE.
 14876
 14877
 14878* EXEC CICS HANDLE CONDITION
 14879*        ENDFILE  (7799-EXIT)
 14880*        NOTFND   (7799-EXIT)
 14881*    END-EXEC.
 14882*    MOVE '"$''I                  ! D #00012577' TO DFHEIV0
 14883     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14884     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14885     MOVE X'4420233030303132353737' TO DFHEIV0(25:11)
 14886     CALL 'kxdfhei1' USING DFHEIV0
 14887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14888
 14889
 14890
 14891* EXEC CICS READ
 14892*        DATASET(CLMS-FILE-ID)
 14893*        SET    (ADDRESS OF CLAIM-MASTER)
 14894*        RIDFLD (MSTR-KEY)
 14895*        GENERIC
 14896*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14897*    END-EXEC.
 14898*    MOVE '&"S  KG    E          (   #00012582' TO DFHEIV0
 14899     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14901     MOVE X'2020233030303132353832' TO DFHEIV0(25:11)
 14902     CALL 'kxdfhei1' USING DFHEIV0,
 14903           CLMS-FILE-ID,
 14904           DFHEIV20,
 14905           DFHEIV99,
 14906           MSTR-KEY,
 14907           ELMSTR-GENERIC-LENGTH,
 14908           DFHEIV99,
 14909           DFHEIV99
 14910     SET ADDRESS OF CLAIM-MASTER TO
 14911         DFHEIV20
 14912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14913
 14914
 14915     COMPUTE WS-ASSOC-CERT-TOTAL =
 14916             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14917
 14918     GO TO 7799-EXIT.
 14919
 14920 7710-RESEQUENCE-CLAIMS.
 14921
 14922
 14923* EXEC CICS HANDLE CONDITION
 14924*        ENDFILE  (7799-EXIT)
 14925*    END-EXEC.
 14926*    MOVE '"$''                   ! E #00012597' TO DFHEIV0
 14927     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14929     MOVE X'4520233030303132353937' TO DFHEIV0(25:11)
 14930     CALL 'kxdfhei1' USING DFHEIV0
 14931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14932
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 283
* EL131.cbl
 14933
 14934
 14935* EXEC CICS STARTBR
 14936*        DATASET(CLMS-FILE-ID)
 14937*        RIDFLD (MSTR-KEY)
 14938*    END-EXEC.
 14939     MOVE 0
 14940       TO DFHEIV11
 14941*    MOVE '&,         G          &   #00012601' TO DFHEIV0
 14942     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14943     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14944     MOVE X'2020233030303132363031' TO DFHEIV0(25:11)
 14945     CALL 'kxdfhei1' USING DFHEIV0,
 14946           CLMS-FILE-ID,
 14947           MSTR-KEY,
 14948           DFHEIV99,
 14949           DFHEIV11,
 14950           DFHEIV99
 14951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14952
 14953
 14954     COMPUTE WS-ASSOC-CERT-SEQU =
 14955             WS-ASSOC-CERT-SEQU + 1.
 14956
 14957     COMPUTE WS-READNEXT-SWITCH =
 14958             WS-READNEXT-SWITCH + 1.
 14959
 14960 7720-READ-CLAIM-LOOP.
 14961
 14962
 14963* EXEC CICS READNEXT
 14964*        DATASET(CLMS-FILE-ID)
 14965*        SET    (ADDRESS OF CLAIM-MASTER)
 14966*        RIDFLD (MSTR-KEY)
 14967*    END-EXEC.
 14968     MOVE 0
 14969       TO DFHEIV11
 14970*    MOVE '&.S                   )   #00012614' TO DFHEIV0
 14971     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14972     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14973     MOVE X'2020233030303132363134' TO DFHEIV0(25:11)
 14974     CALL 'kxdfhei1' USING DFHEIV0,
 14975           CLMS-FILE-ID,
 14976           DFHEIV20,
 14977           DFHEIV99,
 14978           MSTR-KEY,
 14979           DFHEIV99,
 14980           DFHEIV11,
 14981           DFHEIV99,
 14982           DFHEIV99
 14983     SET ADDRESS OF CLAIM-MASTER TO
 14984         DFHEIV20
 14985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14986
 14987
 14988     IF WS-READNEXT-SWITCH = 1
 14989         ADD 1                   TO WS-READNEXT-SWITCH
 14990         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 284
* EL131.cbl
 14991
 14992 7730-END-BROWSE.
 14993
 14994
 14995* EXEC CICS ENDBR
 14996*        DATASET(CLMS-FILE-ID)
 14997*    END-EXEC.
 14998     MOVE 0
 14999       TO DFHEIV11
 15000*    MOVE '&2                    $   #00012626' TO DFHEIV0
 15001     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15002     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15003     MOVE X'2020233030303132363236' TO DFHEIV0(25:11)
 15004     CALL 'kxdfhei1' USING DFHEIV0,
 15005           CLMS-FILE-ID,
 15006           DFHEIV11,
 15007           DFHEIV99
 15008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15009
 15010
 15011 7740-READ-CLAIM-UPDATE.
 15012
 15013     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15014        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15015        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15016        GO TO 7799-EXIT
 15017     ELSE
 15018        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15019
 15020
 15021* EXEC CICS READ
 15022*        DATASET(CLMS-FILE-ID)
 15023*        SET    (ADDRESS OF CLAIM-MASTER)
 15024*        RIDFLD (MSTR-KEY)
 15025*        UPDATE
 15026*    END-EXEC.
 15027*    MOVE '&"S        EU         (   #00012639' TO DFHEIV0
 15028     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15029     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15030     MOVE X'2020233030303132363339' TO DFHEIV0(25:11)
 15031     CALL 'kxdfhei1' USING DFHEIV0,
 15032           CLMS-FILE-ID,
 15033           DFHEIV20,
 15034           DFHEIV99,
 15035           MSTR-KEY,
 15036           DFHEIV99,
 15037           DFHEIV99,
 15038           DFHEIV99
 15039     SET ADDRESS OF CLAIM-MASTER TO
 15040         DFHEIV20
 15041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15042
 15043
 15044     if (cl-priority-cd = '8')
 15045        and (pi-processor-id not = 'PEMA' and 'JMS '
 15046             AND 'AMWA')
 15047        MOVE ER-8003             TO EMI-ERROR
 15048        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 285
* EL131.cbl
 15049                                 THRU 9900-EXIT
 15050        MOVE -1                  TO MAINTL
 15051        GO TO 8110-SEND-DATA
 15052     end-if
 15053
 15054     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15055         MOVE 'Y'                TO CL-YESNOSW
 15056     END-IF.
 15057
 15058     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15059     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15060
 15061
 15062* EXEC CICS REWRITE
 15063*         DATASET(CLMS-FILE-ID)
 15064*         FROM   (CLAIM-MASTER)
 15065*    END-EXEC.
 15066     MOVE LENGTH OF
 15067      CLAIM-MASTER
 15068       TO DFHEIV11
 15069*    MOVE '&& L                  %   #00012663' TO DFHEIV0
 15070     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15071     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15072     MOVE X'2020233030303132363633' TO DFHEIV0(25:11)
 15073     CALL 'kxdfhei1' USING DFHEIV0,
 15074           CLMS-FILE-ID,
 15075           CLAIM-MASTER,
 15076           DFHEIV11,
 15077           DFHEIV99
 15078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15079
 15080
 15081     GO TO 7710-RESEQUENCE-CLAIMS.
 15082
 15083 7799-EXIT.
 15084     EXIT.
 15085
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 286
* EL131.cbl
 15087 7800-CHECK-AUTO-ACTIVITY.
 15088
 15089
 15090* EXEC CICS HANDLE CONDITION
 15091*        NOTFND   (7800-NOT-FOUND)
 15092*    END-EXEC.
 15093*    MOVE '"$I                   ! F #00012676' TO DFHEIV0
 15094     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15096     MOVE X'4620233030303132363736' TO DFHEIV0(25:11)
 15097     CALL 'kxdfhei1' USING DFHEIV0
 15098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15099
 15100
 15101     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15102     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15103     MOVE SPACES                     TO  CNTL-PROC-ID.
 15104     MOVE +0                         TO  CNTL-SEQ-NO.
 15105
 15106
 15107* EXEC CICS READ
 15108*        DATASET   (CNTL-FILE-ID)
 15109*        RIDFLD    (CNTL-KEY)
 15110*        SET       (ADDRESS OF CONTROL-FILE)
 15111*    END-EXEC.
 15112*    MOVE '&"S        E          (   #00012685' TO DFHEIV0
 15113     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15114     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15115     MOVE X'2020233030303132363835' TO DFHEIV0(25:11)
 15116     CALL 'kxdfhei1' USING DFHEIV0,
 15117           CNTL-FILE-ID,
 15118           DFHEIV20,
 15119           DFHEIV99,
 15120           CNTL-KEY,
 15121           DFHEIV99,
 15122           DFHEIV99,
 15123           DFHEIV99
 15124     SET ADDRESS OF CONTROL-FILE TO
 15125         DFHEIV20
 15126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15127
 15128
 15129     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15130         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15131
 15132     IF CL-ACTIVITY-CODE NOT = ZEROS
 15133         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15134         IF MISC-SUB IS GREATER THAN +9
 15135             SUBTRACT +9 FROM MISC-SUB
 15136             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15137         ELSE
 15138             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15139     ELSE
 15140         MOVE 'Y'                              TO  WS-RESET-SW.
 15141
 15142     IF STATUSI = 'C' OR 'CLOSED'
 15143         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15144             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 287
* EL131.cbl
 15145                                         PI-LETTER-SW
 15146             GO TO 7800-EXIT.
 15147
 15148     IF STATUSI = 'C' OR 'CLOSED'
 15149         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15150             MOVE 'N'                TO  PI-LETTER-SW
 15151         ELSE
 15152             MOVE 'Y'                TO  PI-LETTER-SW.
 15153
 15154     IF STATUSI = 'O' OR 'OPEN'
 15155         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15156             MOVE 'N'                TO  PI-REC-FOUND-SW
 15157                                         PI-LETTER-SW
 15158             GO TO 7800-EXIT.
 15159
 15160     IF STATUSI = 'O' OR 'OPEN'
 15161         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15162             MOVE 'N'                TO  PI-LETTER-SW
 15163         ELSE
 15164             MOVE 'Y'                TO  PI-LETTER-SW.
 15165
 15166     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 15167     GO TO 7800-EXIT.
 15168
 15169 7800-NOT-FOUND.
 15170
 15171     MOVE 'N'                        TO  PI-REC-FOUND-SW
 15172                                         PI-LETTER-SW.
 15173
 15174 7800-EXIT.
 15175     EXIT.
 15176
 15177 7850-AUTO-LETTER-WRITER.
 15178
 15179     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 15180     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 15181
 15182     IF STATUSI = 'C' OR 'CLOSED'
 15183         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 15184     ELSE
 15185         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 15186
 15187     IF STATUSI = 'C' OR 'CLOSED'
 15188         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 15189             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15190             MOVE '6'                TO  DC-OPTION-CODE
 15191             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 15192             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15193             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15194             IF NO-CONVERSION-ERROR
 15195                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15196             ELSE
 15197                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15198
 15199     IF STATUSI = 'C' OR 'CLOSED'
 15200         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 15201             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15202             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 288
* EL131.cbl
 15203             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 15204             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15205             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15206             IF NO-CONVERSION-ERROR
 15207                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15208             ELSE
 15209                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15210
 15211     IF STATUSI = 'O' OR 'OPEN'
 15212         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 15213             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15214             MOVE '6'                TO  DC-OPTION-CODE
 15215             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 15216             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15217             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15218             IF NO-CONVERSION-ERROR
 15219                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15220             ELSE
 15221                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15222
 15223     IF STATUSI = 'O' OR 'OPEN'
 15224         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 15225             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15226             MOVE '6'                TO  DC-OPTION-CODE
 15227             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 15228             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15229             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15230             IF NO-CONVERSION-ERROR
 15231                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15232             ELSE
 15233                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15234
 15235
 15236* EXEC CICS LINK
 15237*        PROGRAM    (LINK-1523)
 15238*        COMMAREA   (W-1523-LINKDATA)
 15239*        LENGTH     (W-1523-COMM-LENGTH)
 15240*    END-EXEC.
 15241*    MOVE '."C                   (   #00012797' TO DFHEIV0
 15242     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15244     MOVE X'2020233030303132373937' TO DFHEIV0(25:11)
 15245     CALL 'kxdfhei1' USING DFHEIV0,
 15246           LINK-1523,
 15247           W-1523-LINKDATA,
 15248           W-1523-COMM-LENGTH,
 15249           DFHEIV99,
 15250           DFHEIV99,
 15251           DFHEIV99,
 15252           DFHEIV99
 15253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15254
 15255
 15256     IF W-1523-ERROR-CODE = ZEROS
 15257         GO TO 7850-EXIT.
 15258
 15259     IF W-1523-FATAL-ERROR
 15260         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 289
* EL131.cbl
 15261         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15262
 15263     IF W-1523-ERROR-CODE = 0191
 15264         MOVE ER-0803                TO  EMI-ERROR
 15265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15266
 15267 7850-EXIT.
 15268     EXIT.
 15269
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 290
* EL131.cbl
 15271 8000-CREATE-DMO-REC.
 15272     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 15273     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 15274     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 15275
 15276
 15277* EXEC CICS HANDLE CONDITION
 15278*         NOTFND   (8000-NOTE-NOT-FOUND)
 15279*    END-EXEC.
 15280*    MOVE '"$I                   ! G #00012823' TO DFHEIV0
 15281     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15283     MOVE X'4720233030303132383233' TO DFHEIV0(25:11)
 15284     CALL 'kxdfhei1' USING DFHEIV0
 15285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15286
 15287
 15288
 15289* EXEC CICS READ
 15290*         DATASET(NOTE-FILE-ID)
 15291*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 15292*         RIDFLD (NOTE-KEY)
 15293*    END-EXEC.
 15294*    MOVE '&"S        E          (   #00012827' TO DFHEIV0
 15295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15296     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15297     MOVE X'2020233030303132383237' TO DFHEIV0(25:11)
 15298     CALL 'kxdfhei1' USING DFHEIV0,
 15299           NOTE-FILE-ID,
 15300           DFHEIV20,
 15301           DFHEIV99,
 15302           NOTE-KEY,
 15303           DFHEIV99,
 15304           DFHEIV99,
 15305           DFHEIV99
 15306     SET ADDRESS OF CERTIFICATE-NOTE TO
 15307         DFHEIV20
 15308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15309
 15310
 15311     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 15312     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 15313     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 15314
 15315     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 15316         MOVE 'CC'               TO DCT-PRODUCT-CODE
 15317     ELSE
 15318         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 15319
 15320     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 15321     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 15322
 15323
 15324* EXEC CICS LINK
 15325*        PROGRAM    ('DLO006')
 15326*        COMMAREA   (DCT-COMMUNICATION-AREA)
 15327*        LENGTH     (WS-DCT-LENGTH)
 15328*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 291
* EL131.cbl
 15329     MOVE 'DLO006' TO DFHEIV1
 15330*    MOVE '."C                   (   #00012845' TO DFHEIV0
 15331     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15333     MOVE X'2020233030303132383435' TO DFHEIV0(25:11)
 15334     CALL 'kxdfhei1' USING DFHEIV0,
 15335           DFHEIV1,
 15336           DCT-COMMUNICATION-AREA,
 15337           WS-DCT-LENGTH,
 15338           DFHEIV99,
 15339           DFHEIV99,
 15340           DFHEIV99,
 15341           DFHEIV99
 15342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15343
 15344
 15345     IF  DCT-RETURN-CODE = 'OK'
 15346         GO TO 8000-CONT.
 15347
 15348     IF DCT-RETURN-CODE = '01' OR '02'
 15349         GO TO 8000-EXIT.
 15350
 15351     IF DCT-RETURN-CODE = '03'
 15352         MOVE ER-0951            TO EMI-ERROR
 15353         MOVE -1                 TO MAINTL
 15354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15355         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15356         GO TO 8110-SEND-DATA.
 15357
 15358     IF DCT-RETURN-CODE = '04'
 15359         MOVE ER-0946            TO EMI-ERROR
 15360         MOVE -1                 TO MAINTL
 15361         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15362         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15363         GO TO 8110-SEND-DATA.
 15364
 15365     IF DCT-RETURN-CODE = '05'
 15366         MOVE ER-0947            TO EMI-ERROR
 15367         MOVE -1                 TO MAINTL
 15368         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15369         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15370         GO TO 8110-SEND-DATA.
 15371
 15372     IF DCT-RETURN-CODE = '06'
 15373         MOVE ER-0921            TO EMI-ERROR
 15374         MOVE -1                 TO MAINTL
 15375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15376         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15377         GO TO 8110-SEND-DATA.
 15378
 15379     IF DCT-RETURN-CODE = '07'
 15380         MOVE ER-0919            TO EMI-ERROR
 15381         MOVE -1                 TO MAINTL
 15382         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15383         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15384         GO TO 8110-SEND-DATA.
 15385
 15386     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 292
* EL131.cbl
 15387         MOVE ER-0948            TO EMI-ERROR
 15388         MOVE -1                 TO MAINTL
 15389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15390         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15391         GO TO 8110-SEND-DATA.
 15392
 15393     IF DCT-RETURN-CODE = 'N1'
 15394         MOVE ER-0950            TO EMI-ERROR
 15395         MOVE -1                 TO MAINTL
 15396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15397         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15398         GO TO 8110-SEND-DATA.
 15399
 15400     IF DCT-RETURN-CODE = 'E1'
 15401         MOVE ER-0974            TO EMI-ERROR
 15402         MOVE -1                 TO MAINTL
 15403         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15404         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15405         GO TO 8110-SEND-DATA.
 15406
 15407     IF DCT-RETURN-CODE = 'E2'
 15408         MOVE ER-0975            TO EMI-ERROR
 15409         MOVE -1                 TO MAINTL
 15410         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15411         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15412         GO TO 8110-SEND-DATA.
 15413
 15414     IF DCT-RETURN-CODE NOT = 'OK'
 15415         MOVE ER-0949            TO EMI-ERROR
 15416         MOVE -1                 TO MAINTL
 15417         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15418         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15419         GO TO 8110-SEND-DATA.
 15420
 15421 8000-CONT.
 15422
 15423     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 15424     MOVE 'CS'                   TO DM-RECORD-TYPE.
 15425     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 15426     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 15427     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 15428     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 15429     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 15430     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 15431
 15432     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 15433     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 15434     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 15435     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 15436     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 15437
 15438     IF STATUSI = 'OPEN' OR 'O'
 15439         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 15440      ELSE
 15441         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 15442
 15443     IF STATUSI = 'OPEN' OR 'O'
 15444        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 293
* EL131.cbl
 15445         MOVE '1'                TO DM-CLAIM-STATUS
 15446      ELSE
 15447         MOVE '2'                TO DM-CLAIM-STATUS.
 15448
 15449     IF STATUSI = 'CLOSED' OR 'C'
 15450        IF NOT FINAL-PAID
 15451         MOVE '3'                TO DM-CLAIM-STATUS
 15452      ELSE
 15453         MOVE '4'                TO DM-CLAIM-STATUS.
 15454
 15455     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 15456
 15457
 15458* EXEC CICS LINK
 15459*        PROGRAM    ('DLO025')
 15460*        COMMAREA   (DMO-COMMUNICATION-AREA)
 15461*        LENGTH     (WS-DMO-LENGTH)
 15462*    END-EXEC.
 15463     MOVE 'DLO025' TO DFHEIV1
 15464*    MOVE '."C                   (   #00012963' TO DFHEIV0
 15465     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15467     MOVE X'2020233030303132393633' TO DFHEIV0(25:11)
 15468     CALL 'kxdfhei1' USING DFHEIV0,
 15469           DFHEIV1,
 15470           DMO-COMMUNICATION-AREA,
 15471           WS-DMO-LENGTH,
 15472           DFHEIV99,
 15473           DFHEIV99,
 15474           DFHEIV99,
 15475           DFHEIV99
 15476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15477
 15478
 15479     IF  DM-RETURN-CODE = 'OK'
 15480         GO TO 8000-EXIT.
 15481
 15482     IF DM-RETURN-CODE = '01'
 15483         MOVE ER-8051            TO EMI-ERROR
 15484         MOVE -1                 TO MAINTL
 15485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15486         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15487         GO TO 8110-SEND-DATA.
 15488
 15489     IF DM-RETURN-CODE = '02'
 15490         MOVE ER-8052            TO EMI-ERROR
 15491         MOVE -1                 TO MAINTL
 15492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15493         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15494         GO TO 8110-SEND-DATA.
 15495
 15496     IF DM-RETURN-CODE = '03'
 15497         MOVE ER-8053            TO EMI-ERROR
 15498         MOVE -1                 TO MAINTL
 15499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15500         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15501         GO TO 8110-SEND-DATA.
 15502
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 294
* EL131.cbl
 15503     IF DM-RETURN-CODE = '04'
 15504         MOVE ER-8054            TO EMI-ERROR
 15505         MOVE -1                 TO MAINTL
 15506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15507         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15508         GO TO 8110-SEND-DATA.
 15509
 15510     IF DM-RETURN-CODE = '05'
 15511         MOVE ER-8055            TO EMI-ERROR
 15512         MOVE -1                 TO MAINTL
 15513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15514         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15515         GO TO 8110-SEND-DATA.
 15516
 15517     IF DM-RETURN-CODE = '06'
 15518         MOVE ER-8056            TO EMI-ERROR
 15519         MOVE -1                 TO MAINTL
 15520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15521         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15522         GO TO 8110-SEND-DATA.
 15523
 15524     IF DM-RETURN-CODE = '07'
 15525         MOVE ER-8057            TO EMI-ERROR
 15526         MOVE -1                 TO MAINTL
 15527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15528         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15529         GO TO 8110-SEND-DATA.
 15530
 15531     IF DM-RETURN-CODE = '08'
 15532         MOVE ER-8058            TO EMI-ERROR
 15533         MOVE -1                 TO MAINTL
 15534         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15535         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15536         GO TO 8110-SEND-DATA.
 15537
 15538     IF DM-RETURN-CODE = '09'
 15539         MOVE ER-8059            TO EMI-ERROR
 15540         MOVE -1                 TO MAINTL
 15541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15542         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15543         GO TO 8110-SEND-DATA.
 15544
 15545     IF DM-RETURN-CODE = '10'
 15546         MOVE ER-8060            TO EMI-ERROR
 15547         MOVE -1                 TO MAINTL
 15548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15549         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15550         GO TO 8110-SEND-DATA.
 15551
 15552     IF DM-RETURN-CODE = '11'
 15553         MOVE ER-8061            TO EMI-ERROR
 15554         MOVE -1                 TO MAINTL
 15555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15556         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15557         GO TO 8110-SEND-DATA.
 15558
 15559     IF DM-RETURN-CODE = '12'
 15560         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 295
* EL131.cbl
 15561         MOVE -1                 TO MAINTL
 15562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15563         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15564         GO TO 8110-SEND-DATA.
 15565
 15566     IF DM-RETURN-CODE = '13'
 15567         MOVE ER-8063            TO EMI-ERROR
 15568         MOVE -1                 TO MAINTL
 15569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15570         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15571         GO TO 8110-SEND-DATA.
 15572
 15573     IF DM-RETURN-CODE = '14'
 15574         MOVE ER-8064            TO EMI-ERROR
 15575         MOVE -1                 TO MAINTL
 15576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15577         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15578         GO TO 8110-SEND-DATA.
 15579
 15580     IF DM-RETURN-CODE = '15'
 15581         MOVE ER-8065            TO EMI-ERROR
 15582         MOVE -1                 TO MAINTL
 15583         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15584         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15585         GO TO 8110-SEND-DATA.
 15586
 15587     IF DM-RETURN-CODE = '16'
 15588         MOVE ER-8154            TO EMI-ERROR
 15589         MOVE -1                 TO MAINTL
 15590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15591         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15592         GO TO 8110-SEND-DATA.
 15593
 15594     IF DM-RETURN-CODE = '17'
 15595         MOVE ER-8155            TO EMI-ERROR
 15596         MOVE -1                 TO MAINTL
 15597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15598         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15599         GO TO 8110-SEND-DATA.
 15600
 15601     IF DM-RETURN-CODE = 'N1'
 15602         MOVE ER-8152            TO EMI-ERROR
 15603         MOVE -1                 TO MAINTL
 15604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15605         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15606         GO TO 8110-SEND-DATA.
 15607
 15608     IF DM-RETURN-CODE = 'E1'
 15609         MOVE ER-8153            TO EMI-ERROR
 15610         MOVE -1                 TO MAINTL
 15611         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15612         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15613         GO TO 8110-SEND-DATA.
 15614
 15615     MOVE ER-8066                TO EMI-ERROR.
 15616     MOVE -1                     TO MAINTL.
 15617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15618     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 296
* EL131.cbl
 15619     GO TO 8110-SEND-DATA.
 15620
 15621 8000-NOTE-NOT-FOUND.
 15622
 15623* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15624*    MOVE '6"R                   !   #00013112' TO DFHEIV0
 15625     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15627     MOVE X'2020233030303133313132' TO DFHEIV0(25:11)
 15628     CALL 'kxdfhei1' USING DFHEIV0
 15629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15630
 15631     MOVE ER-0954                TO EMI-ERROR.
 15632     MOVE -1                     TO MAINTL.
 15633     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15634     GO TO 8110-SEND-DATA.
 15635
 15636 8000-EXIT.
 15637     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 297
* EL131.cbl
 15639 8050-FORMAT-LAST-NAME-1ST.
 15640*****************************************************************
 15641*             M O V E   N A M E   R O U T I N E                 *
 15642*                                                               *
 15643*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15644*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15645*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 15646*                                                               *
 15647*                  FIELD               VALUE                    *
 15648*                  -----               -----                    *
 15649*           W-NAME-LAST    (CL15)      SMITH                    *
 15650*           W-NAME-FIRST   (CL15)      JOHN                     *
 15651*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15652*                                                               *
 15653*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 15654*                SMITH, JOHN ALLEN                              *
 15655*                     OR                                        *
 15656*                SMITH, JOHN A.                                 *
 15657*                                                               *
 15658*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 15659*     COPYBOOK, ELCNWA.                                         *
 15660*****************************************************************.
 15661
 15662     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15663     MOVE ZERO                   TO WS-NAME-SW.
 15664     SET NWA-INDEX               TO +1.
 15665
 15666     IF W-NAME-LAST   = SPACES  AND
 15667        W-NAME-MIDDLE = SPACES
 15668          MOVE +1                TO WS-NAME-SW.
 15669
 15670     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15671     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15672
 15673     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15674     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15675
 15676     SET NWA-INDEX UP BY +1.
 15677
 15678     IF W-NAME-MIDDLE NOT = SPACES
 15679         IF W-NAME-MIDDLE-2 = SPACES
 15680             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15681             SET NWA-INDEX UP BY +1
 15682             MOVE '.'            TO WS-NW (NWA-INDEX)
 15683             SET NWA-INDEX UP BY +2
 15684         ELSE
 15685             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15686             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15687
 15688 8050-EXIT.
 15689     EXIT.
 15690
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 298
* EL131.cbl
 15692 8060-MOVE-NAME.
 15693     IF WS-NAME-SW GREATER THAN +1
 15694         GO TO 8060-EXIT.
 15695
 15696     IF WS-NAME-WORK2 = SPACES
 15697         GO TO 8060-EXIT.
 15698
 15699     SET NWA-INDEX2            TO +1.
 15700     SET NWA-INDEX3            TO +2.
 15701
 15702 8060-MOVE-NAME-CYCLE.
 15703     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15704
 15705     IF NWA-INDEX LESS THAN +30
 15706         SET NWA-INDEX UP BY +1
 15707     ELSE
 15708         ADD +2 TO  WS-NAME-SW
 15709         GO TO 8060-EXIT.
 15710
 15711     IF NWA-INDEX2 LESS THAN +20
 15712         SET NWA-INDEX3 UP BY +1
 15713         SET NWA-INDEX2 UP BY +1.
 15714
 15715     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 15716        WS-NW2 (NWA-INDEX3) = SPACES
 15717         IF WS-NAME-SW = ZERO
 15718             MOVE ','            TO WS-NW (NWA-INDEX)
 15719             SET NWA-INDEX UP BY +2
 15720             MOVE +1             TO WS-NAME-SW
 15721             GO TO 8060-EXIT
 15722         ELSE
 15723             GO TO 8060-EXIT.
 15724
 15725     GO TO 8060-MOVE-NAME-CYCLE.
 15726
 15727 8060-EXIT.
 15728     EXIT.
 15729
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 299
* EL131.cbl
 15731
 15732 8070-UNLOCK-CLAIM-MSTR.
 15733
 15734* EXEC CICS UNLOCK
 15735*        DATASET   (CLMS-FILE-ID)
 15736*    END-EXEC.
 15737*    MOVE '&*                    #   #00013215' TO DFHEIV0
 15738     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15739     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15740     MOVE X'2020233030303133323135' TO DFHEIV0(25:11)
 15741     CALL 'kxdfhei1' USING DFHEIV0,
 15742           CLMS-FILE-ID,
 15743           DFHEIV99
 15744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15745
 15746
 15747 8070-EXIT.
 15748      EXIT.
 15749
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 300
* EL131.cbl
 15751 8100-SEND-MAP.
 15752     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15753
 15754     IF NOT PI-NO-CARRIER-SECURITY
 15755        MOVE AL-SANOF            TO CERTCARA.
 15756     IF NOT PI-NO-ACCOUNT-SECURITY
 15757        MOVE AL-SANOF            TO CERTACTA.
 15758
 15759     IF PI-PROCESSOR-ID = 'LGXX'
 15760        MOVE AL-UANON            TO CCNOA.
 15761
 15762     IF PI-COMPANY-ID = 'DMD'
 15763        NEXT SENTENCE
 15764     ELSE
 15765        MOVE AL-SADOF            TO PFKEY6A.
 15766
 15767     IF PI-USES-PAID-TO
 15768        MOVE 'PAID TO  :' TO PTHRHDGO.
 15769
 15770
 15771* EXEC CICS SEND
 15772*         MAP     ('EL131A')
 15773*         MAPSET  ('EL131S')
 15774*         ERASE
 15775*         FREEKB
 15776*         CURSOR
 15777*    END-EXEC.
 15778     MOVE 'EL131A' TO DFHEIV1
 15779     MOVE -1
 15780       TO DFHEIV11
 15781     MOVE 'EL131S' TO DFHEIV2
 15782*    MOVE '8$     CT  E F  H     ,   #00013242' TO DFHEIV0
 15783     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15784     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15785     MOVE X'2020233030303133323432' TO DFHEIV0(25:11)
 15786     CALL 'kxdfhei1' USING DFHEIV0,
 15787           DFHEIV1,
 15788           EL131AO,
 15789           DFHEIV99,
 15790           DFHEIV2,
 15791           DFHEIV99,
 15792           DFHEIV99,
 15793           DFHEIV99,
 15794           DFHEIV11,
 15795           DFHEIV99,
 15796           DFHEIV99,
 15797           DFHEIV99
 15798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15799
 15800
 15801     GO TO 9000-RETURN-TRANS.
 15802
 15803 8110-SEND-DATA.
 15804     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15805
 15806     IF PI-USES-PAID-TO
 15807        MOVE 'PAID TO  :' TO PTHRHDGO.
 15808
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 301
* EL131.cbl
 15809     IF PI-PROCESSOR-ID = 'LGXX'
 15810        MOVE AL-UANON            TO CCNOA.
 15811
 15812     IF PI-COMPANY-ID = 'DMD'
 15813        NEXT SENTENCE
 15814     ELSE
 15815        MOVE AL-SADOF            TO PFKEY6A.
 15816
 15817
 15818* EXEC CICS SEND
 15819*         MAP      ('EL131A')
 15820*         MAPSET   ('EL131S')
 15821*         DATAONLY
 15822*         FREEKB
 15823*         CURSOR
 15824*    END-EXEC.
 15825     MOVE 'EL131A' TO DFHEIV1
 15826     MOVE -1
 15827       TO DFHEIV11
 15828     MOVE 'EL131S' TO DFHEIV2
 15829*    MOVE '8$D    CT    F  H     ,   #00013266' TO DFHEIV0
 15830     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15831     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15832     MOVE X'2020233030303133323636' TO DFHEIV0(25:11)
 15833     CALL 'kxdfhei1' USING DFHEIV0,
 15834           DFHEIV1,
 15835           EL131AO,
 15836           DFHEIV99,
 15837           DFHEIV2,
 15838           DFHEIV99,
 15839           DFHEIV99,
 15840           DFHEIV99,
 15841           DFHEIV11,
 15842           DFHEIV99,
 15843           DFHEIV99,
 15844           DFHEIV99
 15845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15846
 15847
 15848     GO TO 9000-RETURN-TRANS.
 15849
 15850 8120-FORMAT-TIME-DATE.
 15851     perform 8140-check-for-prev-errors
 15852                                 thru 8140-exit
 15853     IF SKIP-ATTRIBUTE = 'Y'
 15854        MOVE SPACES              TO SKIP-ATTRIBUTE
 15855        MOVE ER-0598             TO EMI-ERROR
 15856        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15857        GO TO 8125-SKIP-ATTRIBUTE.
 15858
 15859*     IF PI-COMPANY-ID = 'DMD'
 15860      IF PI-PROCESSOR-ID <> 'EMER'
 15861         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 15862                                    CERTCARA  CERTGRPA CERTA SUFXA
 15863
 15864     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 15865                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 15866                                    JNTINITA  JNTAGEA   APRA
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 302
* EL131.cbl
 15867                                    LCVCDA    LCVOTRMA  LCVRTRMA
 15868                                    LCVBENEA  LCVFORMA  LCVCNDTA
 15869                                    LCVEXITA  LCVSTATA  LCVKINDA
 15870                                    ACVCDA    ACVOTRMA  ACVRTRMA
 15871                                    ACVBENEA  ACVFORMA  ACVCNDTA
 15872                                    ACVEXITA  ACVSTATA  ACVKINDA
 15873                                    PMTFREQA  INDGRPA   PREMTYPA
 15874                                    REINCDA   LCVRATEA  ACVRATEA
 15875                                    ADDONDTA.
 15876
 15877*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 15878*       IF PI-COMPANY-ID = 'DMD'
 15879*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 15880*                                   SUFXA
 15881*                                   PDAMTA    NODAYSA   NOPMTSA
 15882*                                   INCA      OCCA
 15883*          IF NOT SYSTEM-MODIFY-CAP
 15884*              MOVE AL-SANOF         TO PDTHRUA.
 15885
 15886     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 15887         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15888
 15889 8125-SKIP-ATTRIBUTE.
 15890
 15891     MOVE SAVE-DATE              TO DATEO.
 15892
 15893* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 15894*    END-EXEC
 15895*    MOVE '0"A                   "   #00013318' TO DFHEIV0
 15896     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 15897     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 15898     MOVE X'2020233030303133333138' TO DFHEIV0(25:11)
 15899     CALL 'kxdfhei1' USING DFHEIV0,
 15900           LCP-CICS-TIME
 15901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15902
 15903* EXEC CICS FORMATTIME
 15904*              ABSTIME(LCP-CICS-TIME)
 15905*              TIME(LCP-TIME-OF-DAY-XX)
 15906*    END-EXEC
 15907*    MOVE 'j$(     (             #   #00013320' TO DFHEIV0
 15908     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 15909     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15910     MOVE X'2020233030303133333230' TO DFHEIV0(25:11)
 15911     CALL 'kxdfhei1' USING DFHEIV0,
 15912           LCP-CICS-TIME,
 15913           LCP-TIME-OF-DAY-XX
 15914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15915     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 15916     MOVE UN-HOURS               TO FOR-HOURS.
 15917     MOVE UN-MINUTES             TO FOR-MINUTES.
 15918     MOVE TIME-OUT               TO TIMEO.
 15919     MOVE PI-COMPANY-ID          TO COMPO.
 15920     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15921     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 15922     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15923     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 15924     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 303
* EL131.cbl
 15925
 15926 8130-EXIT.
 15927     EXIT.
 15928
 15929 8140-check-for-prev-errors.
 15930
 15931     MOVE PI-COMPANY-CD          TO trlr-company-cd
 15932     MOVE PI-CARRIER             TO trlr-carrier
 15933     MOVE PI-CLAIM-NO            TO trlr-claim-no
 15934     MOVE PI-CERT-NO             TO trlr-cert-no
 15935     MOVE +95                    TO TRLR-SEQ-NO
 15936
 15937
 15938* EXEC CICS READ
 15939*       DATASET  ('ELTRLR')
 15940*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15941*       RIDFLD   (TRLR-KEY)
 15942*       RESP     (WS-RESPONSE)
 15943*    END-EXEC
 15944     MOVE 'ELTRLR' TO DFHEIV1
 15945*    MOVE '&"S        E          (  N#00013346' TO DFHEIV0
 15946     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15948     MOVE X'204E233030303133333436' TO DFHEIV0(25:11)
 15949     CALL 'kxdfhei1' USING DFHEIV0,
 15950           DFHEIV1,
 15951           DFHEIV20,
 15952           DFHEIV99,
 15953           TRLR-KEY,
 15954           DFHEIV99,
 15955           DFHEIV99,
 15956           DFHEIV99
 15957     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15958         DFHEIV20
 15959     MOVE EIBRESP  TO WS-RESPONSE
 15960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15961
 15962     if ws-resp-normal
 15963        perform varying s1 from +1 by +1 until
 15964           at-note-error-no (s1) = spaces
 15965           if at-note-error-no (s1) = '1652'
 15966              continue
 15967           else
 15968              move at-note-error-no (s1)
 15969                                 to emi-error
 15970              move -1 to maintl
 15971              if at-note-error-no (s1) = '1653'
 15972                 evaluate true
 15973                    when pi-claim-type = 'L'
 15974                       move '  LF  '
 15975                        to emi-claim-type
 15976                    when pi-claim-type = 'I'
 15977                       move '  IU  '
 15978                        to emi-claim-type
 15979                    when other
 15980                       move '  AH  '
 15981                        to emi-claim-type
 15982                 end-evaluate
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 304
* EL131.cbl
 15983              end-if
 15984              PERFORM 9900-ERROR-FORMAT
 15985                                 THRU 9900-EXIT
 15986           end-if
 15987*          if at-note-error-no (s1) = '1653'
 15988*             perform varying emi-sub from 1 by 1 until
 15989*                emi-sub > 3
 15990*                if emi-error-number (emi-sub) = '1653'
 15991*                   evaluate true
 15992*                      when pi-claim-type = 'L'
 15993*                         move '  LF  '
 15994*                          to emi-claim-type
 15995*                      when pi-claim-type = 'I'
 15996*                         move '  IU  '
 15997*                          to emi-claim-type
 15998*                      when other
 15999*                         move '  AH  '
 16000*                          to emi-claim-type
 16001*                   end-evaluate
 16002*                end-if
 16003*             end-perform
 16004*          end-if
 16005        end-perform
 16006     else
 16007        display ' resp not normal ' ws-response ' '
 16008        trlr-key (2:19)
 16009     end-if
 16010
 16011     .
 16012 8140-exit.
 16013     exit.
 16014 8150-ENTERED-CLAIM-NOTFOUND.
 16015
 16016     MOVE ER-0204                TO EMI-ERROR.
 16017     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16018     MOVE -1                     TO MAINTL.
 16019     GO TO 8100-SEND-MAP.
 16020
 16021 8200-RETURN-PRIOR.
 16022     MOVE SPACE                  TO PI-RETURN-CD-1.
 16023     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16024     GO TO 9200-XCTL.
 16025
 16026 8300-GET-HELP.
 16027     MOVE XCTL-EL010             TO CALL-PGM.
 16028     GO TO 9200-XCTL.
 16029
 16030 8400-RETURN-MASTER.
 16031     MOVE SPACE                  TO PI-RETURN-CD-1.
 16032     MOVE XCTL-EL126             TO CALL-PGM.
 16033     GO TO 9200-XCTL.
 16034
 16035 8500-TRLR-MNT.
 16036     IF PI-RETURN-CD-1 = 'X'
 16037         MOVE ER-0311            TO EMI-ERROR
 16038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16039         MOVE -1                 TO MAINTL
 16040         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 305
* EL131.cbl
 16041
 16042
 16043* EXEC CICS WRITEQ TS
 16044*         QUEUE     (PI-KEY)
 16045*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16046*         LENGTH    (PI-COMM-LENGTH)
 16047*    END-EXEC.
 16048*    MOVE '*"                    ''   #00013433' TO DFHEIV0
 16049     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16050     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16051     MOVE X'2020233030303133343333' TO DFHEIV0(25:11)
 16052     CALL 'kxdfhei1' USING DFHEIV0,
 16053           PI-KEY,
 16054           PROGRAM-INTERFACE-BLOCK,
 16055           PI-COMM-LENGTH,
 16056           DFHEIV99,
 16057           DFHEIV99,
 16058           DFHEIV99
 16059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16060
 16061
 16062     MOVE XCTL-EL142             TO CALL-PGM.
 16063     GO TO 9200-XCTL.
 16064
 16065 8600-ADDR-MNT.
 16066     IF PI-RETURN-CD-1 = 'X'
 16067         MOVE ER-0311            TO EMI-ERROR
 16068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16069         MOVE -1                 TO MAINTL
 16070         GO TO 8110-SEND-DATA.
 16071
 16072
 16073* EXEC CICS WRITEQ TS
 16074*         QUEUE     (PI-KEY)
 16075*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16076*         LENGTH    (PI-COMM-LENGTH)
 16077*    END-EXEC.
 16078*    MOVE '*"                    ''   #00013449' TO DFHEIV0
 16079     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16080     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16081     MOVE X'2020233030303133343439' TO DFHEIV0(25:11)
 16082     CALL 'kxdfhei1' USING DFHEIV0,
 16083           PI-KEY,
 16084           PROGRAM-INTERFACE-BLOCK,
 16085           PI-COMM-LENGTH,
 16086           DFHEIV99,
 16087           DFHEIV99,
 16088           DFHEIV99
 16089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16090
 16091
 16092     MOVE XCTL-EL141             TO CALL-PGM.
 16093     GO TO 9200-XCTL.
 16094
 16095 8700-CERT-MNT.
 16096     IF PI-RETURN-CD-1 = 'X'
 16097         MOVE ER-7690            TO EMI-ERROR
 16098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 306
* EL131.cbl
 16099         MOVE -1                 TO MAINTL
 16100         GO TO 8110-SEND-DATA.
 16101
 16102
 16103* EXEC CICS WRITEQ TS
 16104*         QUEUE     (PI-KEY)
 16105*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16106*         LENGTH    (PI-COMM-LENGTH)
 16107*    END-EXEC.
 16108*    MOVE '*"                    ''   #00013465' TO DFHEIV0
 16109     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16110     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16111     MOVE X'2020233030303133343635' TO DFHEIV0(25:11)
 16112     CALL 'kxdfhei1' USING DFHEIV0,
 16113           PI-KEY,
 16114           PROGRAM-INTERFACE-BLOCK,
 16115           PI-COMM-LENGTH,
 16116           DFHEIV99,
 16117           DFHEIV99,
 16118           DFHEIV99
 16119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16120
 16121
 16122     MOVE XCTL-EL1273            TO CALL-PGM.
 16123     GO TO 9200-XCTL.
 16124
 16125 8725-BENEFICIARY-MNT.
 16126     IF PI-RETURN-CD-1 = 'X'
 16127         MOVE ER-0311            TO EMI-ERROR
 16128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16129         MOVE -1                 TO MAINTL
 16130         GO TO 8110-SEND-DATA.
 16131
 16132
 16133* EXEC CICS WRITEQ TS
 16134*         QUEUE     (PI-KEY)
 16135*         FROM      (EL131AI)
 16136*         LENGTH    (MAP-LENGTH)
 16137*    END-EXEC.
 16138*    MOVE '*"                    ''   #00013481' TO DFHEIV0
 16139     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16140     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16141     MOVE X'2020233030303133343831' TO DFHEIV0(25:11)
 16142     CALL 'kxdfhei1' USING DFHEIV0,
 16143           PI-KEY,
 16144           EL131AI,
 16145           MAP-LENGTH,
 16146           DFHEIV99,
 16147           DFHEIV99,
 16148           DFHEIV99
 16149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16150
 16151
 16152
 16153* EXEC CICS WRITEQ TS
 16154*         QUEUE     (PI-KEY)
 16155*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16156*         LENGTH    (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 307
* EL131.cbl
 16157*    END-EXEC.
 16158*    MOVE '*"                    ''   #00013487' TO DFHEIV0
 16159     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16160     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16161     MOVE X'2020233030303133343837' TO DFHEIV0(25:11)
 16162     CALL 'kxdfhei1' USING DFHEIV0,
 16163           PI-KEY,
 16164           PROGRAM-INTERFACE-BLOCK,
 16165           PI-COMM-LENGTH,
 16166           DFHEIV99,
 16167           DFHEIV99,
 16168           DFHEIV99
 16169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16170
 16171
 16172     MOVE XCTL-EL114             TO CALL-PGM.
 16173     GO TO 9200-XCTL.
 16174
 16175 8750-DMD-CLM-FIX.
 16176
 16177* EXEC CICS WRITEQ TS
 16178*         QUEUE     (PI-KEY)
 16179*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16180*         LENGTH    (PI-COMM-LENGTH)
 16181*    END-EXEC.
 16182*    MOVE '*"                    ''   #00013497' TO DFHEIV0
 16183     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16184     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16185     MOVE X'2020233030303133343937' TO DFHEIV0(25:11)
 16186     CALL 'kxdfhei1' USING DFHEIV0,
 16187           PI-KEY,
 16188           PROGRAM-INTERFACE-BLOCK,
 16189           PI-COMM-LENGTH,
 16190           DFHEIV99,
 16191           DFHEIV99,
 16192           DFHEIV99
 16193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16194
 16195
 16196     MOVE XCTL-EL400DMD          TO CALL-PGM.
 16197     GO TO 9200-XCTL.
 16198
 16199 8800-UNAUTHORIZED-ACCESS.
 16200     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16201     GO TO 8990-SEND-TEXT.
 16202
 16203 8810-PF23-ENTERED.
 16204     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 16205     MOVE XCTL-EL005             TO CALL-PGM.
 16206     GO TO 9200-XCTL.
 16207
 16208 8820-XCTL-ERROR.
 16209
 16210* EXEC CICS HANDLE CONDITION
 16211*        PGMIDERR (8990-SEND-TEXT)
 16212*    END-EXEC.
 16213*    MOVE '"$L                   ! H #00013516' TO DFHEIV0
 16214     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 308
* EL131.cbl
 16215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16216     MOVE X'4820233030303133353136' TO DFHEIV0(25:11)
 16217     CALL 'kxdfhei1' USING DFHEIV0
 16218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16219
 16220
 16221     MOVE SPACE                 TO PI-ENTRY-CD-1.
 16222     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 16223     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 16224     MOVE XCTL-EL005            TO CALL-PGM.
 16225     GO TO 9200-XCTL.
 16226
 16227 8990-SEND-TEXT.
 16228
 16229* EXEC CICS SEND TEXT
 16230*         FROM      (LOGOFF-TEXT)
 16231*         LENGTH    (LOGOFF-LENGTH)
 16232*         ERASE
 16233*         FREEKB
 16234*    END-EXEC.
 16235*    MOVE '8&      T  E F  H   F -   #00013527' TO DFHEIV0
 16236     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16237     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16238     MOVE X'2020233030303133353237' TO DFHEIV0(25:11)
 16239     CALL 'kxdfhei1' USING DFHEIV0,
 16240           LOGOFF-TEXT,
 16241           LOGOFF-LENGTH,
 16242           DFHEIV99,
 16243           DFHEIV99,
 16244           DFHEIV99,
 16245           DFHEIV99,
 16246           DFHEIV99,
 16247           DFHEIV99,
 16248           DFHEIV99,
 16249           DFHEIV99,
 16250           DFHEIV99,
 16251           DFHEIV99
 16252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16253
 16254
 16255     GO TO 9100-RETURN-CICS.
 16256
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 309
* EL131.cbl
 16258 9000-RETURN-TRANS.
 16259
 16260* EXEC CICS RETURN
 16261*         TRANSID   (TRANS-ID)
 16262*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16263*         LENGTH    (PI-COMM-LENGTH)
 16264*    END-EXEC.
 16265*    MOVE '.(CT                  ''   #00013538' TO DFHEIV0
 16266     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16267     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16268     MOVE X'2020233030303133353338' TO DFHEIV0(25:11)
 16269     CALL 'kxdfhei1' USING DFHEIV0,
 16270           TRANS-ID,
 16271           PROGRAM-INTERFACE-BLOCK,
 16272           PI-COMM-LENGTH,
 16273           DFHEIV99,
 16274           DFHEIV99,
 16275           DFHEIV99
 16276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16277
 16278
 16279
 16280* GOBACK.
 16281     MOVE '9%                    "   ' TO DFHEIV0
 16282     MOVE 'EL131' TO DFHEIV1
 16283     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16284     GOBACK.
 16285
 16286 9100-RETURN-CICS.
 16287
 16288* EXEC CICS RETURN
 16289*    END-EXEC.
 16290*    MOVE '.(                    ''   #00013547' TO DFHEIV0
 16291     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16292     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16293     MOVE X'2020233030303133353437' TO DFHEIV0(25:11)
 16294     CALL 'kxdfhei1' USING DFHEIV0,
 16295           DFHEIV99,
 16296           DFHEIV99,
 16297           DFHEIV99,
 16298           DFHEIV99,
 16299           DFHEIV99,
 16300           DFHEIV99
 16301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16302
 16303
 16304
 16305* GOBACK.
 16306     MOVE '9%                    "   ' TO DFHEIV0
 16307     MOVE 'EL131' TO DFHEIV1
 16308     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16309     GOBACK.
 16310
 16311 9200-XCTL.
 16312
 16313* EXEC CICS XCTL
 16314*         PROGRAM    (CALL-PGM)
 16315*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 310
* EL131.cbl
 16316*         LENGTH     (PI-COMM-LENGTH)
 16317*    END-EXEC.
 16318*    MOVE '.$C                   %   #00013553' TO DFHEIV0
 16319     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16320     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16321     MOVE X'2020233030303133353533' TO DFHEIV0(25:11)
 16322     CALL 'kxdfhei1' USING DFHEIV0,
 16323           CALL-PGM,
 16324           PROGRAM-INTERFACE-BLOCK,
 16325           PI-COMM-LENGTH,
 16326           DFHEIV99
 16327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16328
 16329
 16330 9700-LINK-RTRM-FILE-ID.
 16331
 16332* EXEC CICS LINK
 16333*        PROGRAM  (RTRM-FILE-ID)
 16334*        COMMAREA (CALCULATION-PASS-AREA)
 16335*        LENGTH   (CP-COMM-LENGTH)
 16336*    END-EXEC.
 16337*    MOVE '."C                   (   #00013560' TO DFHEIV0
 16338     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16340     MOVE X'2020233030303133353630' TO DFHEIV0(25:11)
 16341     CALL 'kxdfhei1' USING DFHEIV0,
 16342           RTRM-FILE-ID,
 16343           CALCULATION-PASS-AREA,
 16344           CP-COMM-LENGTH,
 16345           DFHEIV99,
 16346           DFHEIV99,
 16347           DFHEIV99,
 16348           DFHEIV99
 16349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16350
 16351
 16352 9700-EXIT.
 16353      EXIT.
 16354
 16355 9800-CONVERT-DATE.
 16356     MOVE SPACES TO DC-ERROR-CODE.
 16357
 16358* EXEC CICS LINK
 16359*         PROGRAM    (DATE-CONV)
 16360*         COMMAREA   (DATE-CONVERSION-DATA)
 16361*         LENGTH     (DC-COMM-LENGTH)
 16362*    END-EXEC.
 16363*    MOVE '."C                   (   #00013571' TO DFHEIV0
 16364     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16365     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16366     MOVE X'2020233030303133353731' TO DFHEIV0(25:11)
 16367     CALL 'kxdfhei1' USING DFHEIV0,
 16368           DATE-CONV,
 16369           DATE-CONVERSION-DATA,
 16370           DC-COMM-LENGTH,
 16371           DFHEIV99,
 16372           DFHEIV99,
 16373           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 311
* EL131.cbl
 16374           DFHEIV99
 16375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16376
 16377
 16378 9800-EXIT.
 16379     EXIT.
 16380
 16381 9900-ERROR-FORMAT.
 16382
 16383* EXEC CICS LINK
 16384*         PROGRAM    (XCTL-EL001)
 16385*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 16386*         LENGTH     (EMI-COMM-LENGTH)
 16387*    END-EXEC.
 16388*    MOVE '."C                   (   #00013581' TO DFHEIV0
 16389     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16390     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16391     MOVE X'2020233030303133353831' TO DFHEIV0(25:11)
 16392     CALL 'kxdfhei1' USING DFHEIV0,
 16393           XCTL-EL001,
 16394           ERROR-MESSAGE-INTERFACE-BLOCK,
 16395           EMI-COMM-LENGTH,
 16396           DFHEIV99,
 16397           DFHEIV99,
 16398           DFHEIV99,
 16399           DFHEIV99
 16400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16401
 16402
 16403 9900-EXIT.
 16404     EXIT.
 16405
 16406 9990-ABEND.
 16407     MOVE DFHEIBLK               TO EMI-LINE1.
 16408
 16409* EXEC CICS LINK
 16410*         PROGRAM   (XCTL-EL004)
 16411*         COMMAREA  (EMI-LINE1)
 16412*         LENGTH    (72)
 16413*     END-EXEC.
 16414     MOVE 72
 16415       TO DFHEIV11
 16416*    MOVE '."C                   (   #00013592' TO DFHEIV0
 16417     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16419     MOVE X'2020233030303133353932' TO DFHEIV0(25:11)
 16420     CALL 'kxdfhei1' USING DFHEIV0,
 16421           XCTL-EL004,
 16422           EMI-LINE1,
 16423           DFHEIV11,
 16424           DFHEIV99,
 16425           DFHEIV99,
 16426           DFHEIV99,
 16427           DFHEIV99
 16428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16429
 16430
 16431     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 312
* EL131.cbl
 16432
 16433     GO TO 8110-SEND-DATA.
 16434
 16435 9995-SECURITY-VIOLATION.
 16436*           COPY ELCSCTP.
 16437******************************************************************
 16438*                                                                *
 16439*                            ELCSCTP                             *
 16440*                            VMOD=2.001                          *
 16441*                                                                *
 16442*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16443******************************************************************
 16444
 16445
 16446     MOVE EIBDATE          TO SM-JUL-DATE.
 16447     MOVE EIBTRMID         TO SM-TERMID.
 16448     MOVE THIS-PGM         TO SM-PGM.
 16449     MOVE EIBTIME          TO TIME-IN.
 16450     MOVE TIME-OUT         TO SM-TIME.
 16451     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16452
 16453
 16454* EXEC CICS LINK
 16455*         PROGRAM  ('EL003')
 16456*         COMMAREA (SECURITY-MESSAGE)
 16457*         LENGTH   (80)
 16458*    END-EXEC.
 16459     MOVE 'EL003' TO DFHEIV1
 16460     MOVE 80
 16461       TO DFHEIV11
 16462*    MOVE '."C                   (   #00013620' TO DFHEIV0
 16463     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16464     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16465     MOVE X'2020233030303133363230' TO DFHEIV0(25:11)
 16466     CALL 'kxdfhei1' USING DFHEIV0,
 16467           DFHEIV1,
 16468           SECURITY-MESSAGE,
 16469           DFHEIV11,
 16470           DFHEIV99,
 16471           DFHEIV99,
 16472           DFHEIV99,
 16473           DFHEIV99
 16474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16475
 16476
 16477******************************************************************
 16478
 16479
 16480
 16481 9999-DFHBACK SECTION.
 16482     MOVE '9%                    "   ' TO DFHEIV0
 16483     MOVE 'EL131' TO DFHEIV1
 16484     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16485     GOBACK.
 16486 9999-DFHEXIT.
 16487     IF DFHEIGDJ EQUAL 0001
 16488         NEXT SENTENCE
 16489     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 313
* EL131.cbl
 16490         GO TO 8820-XCTL-ERROR,
 16491               8150-ENTERED-CLAIM-NOTFOUND,
 16492               9990-ABEND
 16493         DEPENDING ON DFHEIGDI
 16494     ELSE IF DFHEIGDJ EQUAL 3
 16495         GO TO 0130-TS-ERROR,
 16496               0130-TS-ERROR
 16497         DEPENDING ON DFHEIGDI
 16498     ELSE IF DFHEIGDJ EQUAL 4
 16499         GO TO 0600-CONTINUE-NAME-UPDATE
 16500         DEPENDING ON DFHEIGDI
 16501     ELSE IF DFHEIGDJ EQUAL 5
 16502         GO TO 1004-BENE-NOT-FOUND
 16503         DEPENDING ON DFHEIGDI
 16504     ELSE IF DFHEIGDJ EQUAL 6
 16505         GO TO 1120-CNTL-NOTFND
 16506         DEPENDING ON DFHEIGDI
 16507     ELSE IF DFHEIGDJ EQUAL 7
 16508         GO TO 1150-NOTOPEN-ERROR,
 16509               1150-EXIT
 16510         DEPENDING ON DFHEIGDI
 16511     ELSE IF DFHEIGDJ EQUAL 8
 16512         GO TO 1490-STATE-NOTFND
 16513         DEPENDING ON DFHEIGDI
 16514     ELSE IF DFHEIGDJ EQUAL 9
 16515         GO TO 1500-CARR-NOTFND
 16516         DEPENDING ON DFHEIGDI
 16517     ELSE IF DFHEIGDJ EQUAL 10
 16518         GO TO 1620-ACCT-NOTFND
 16519         DEPENDING ON DFHEIGDI
 16520     ELSE IF DFHEIGDJ EQUAL 11
 16521         GO TO 2020-EXIT
 16522         DEPENDING ON DFHEIGDI
 16523     ELSE IF DFHEIGDJ EQUAL 12
 16524         GO TO 2030-EXIT
 16525         DEPENDING ON DFHEIGDI
 16526     ELSE IF DFHEIGDJ EQUAL 13
 16527         GO TO 2040-EXIT
 16528         DEPENDING ON DFHEIGDI
 16529     ELSE IF DFHEIGDJ EQUAL 14
 16530         GO TO 2050-EXIT
 16531         DEPENDING ON DFHEIGDI
 16532     ELSE IF DFHEIGDJ EQUAL 15
 16533         GO TO 2060-CERT-NOTFND
 16534         DEPENDING ON DFHEIGDI
 16535     ELSE IF DFHEIGDJ EQUAL 16
 16536         GO TO 2060-DUPKEY
 16537         DEPENDING ON DFHEIGDI
 16538     ELSE IF DFHEIGDJ EQUAL 17
 16539         GO TO 2070-NOT-FOUND
 16540         DEPENDING ON DFHEIGDI
 16541     ELSE IF DFHEIGDJ EQUAL 18
 16542         GO TO 2070-EXIT
 16543         DEPENDING ON DFHEIGDI
 16544     ELSE IF DFHEIGDJ EQUAL 19
 16545         GO TO 2080-EXIT
 16546         DEPENDING ON DFHEIGDI
 16547     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 314
* EL131.cbl
 16548         GO TO 2400-TRLR-NOTFND,
 16549               2410-EXIT
 16550         DEPENDING ON DFHEIGDI
 16551     ELSE IF DFHEIGDJ EQUAL 21
 16552         GO TO 2425-NINETY-NOTFND,
 16553               2425-NINETY-NOTFND
 16554         DEPENDING ON DFHEIGDI
 16555     ELSE IF DFHEIGDJ EQUAL 22
 16556         GO TO 2430-EXIT,
 16557               2440-EXIT
 16558         DEPENDING ON DFHEIGDI
 16559     ELSE IF DFHEIGDJ EQUAL 23
 16560         GO TO 2440-EXIT
 16561         DEPENDING ON DFHEIGDI
 16562     ELSE IF DFHEIGDJ EQUAL 24
 16563         GO TO 2460-EXIT
 16564         DEPENDING ON DFHEIGDI
 16565     ELSE IF DFHEIGDJ EQUAL 25
 16566         GO TO 2475-EXIT
 16567         DEPENDING ON DFHEIGDI
 16568     ELSE IF DFHEIGDJ EQUAL 26
 16569         GO TO 2650-EXIT
 16570         DEPENDING ON DFHEIGDI
 16571     ELSE IF DFHEIGDJ EQUAL 27
 16572         GO TO 2800-EXIT,
 16573               2800-EXIT
 16574         DEPENDING ON DFHEIGDI
 16575     ELSE IF DFHEIGDJ EQUAL 28
 16576         GO TO 3010-DEL-ACTQ,
 16577               3040-EXIT
 16578         DEPENDING ON DFHEIGDI
 16579     ELSE IF DFHEIGDJ EQUAL 29
 16580         GO TO 3010-NO-ACTIVITY,
 16581               3050-EXIT
 16582         DEPENDING ON DFHEIGDI
 16583     ELSE IF DFHEIGDJ EQUAL 30
 16584         GO TO 3010-CERT-NOT-FOUND
 16585         DEPENDING ON DFHEIGDI
 16586     ELSE IF DFHEIGDJ EQUAL 31
 16587         GO TO 3020-EXIT
 16588         DEPENDING ON DFHEIGDI
 16589     ELSE IF DFHEIGDJ EQUAL 32
 16590         GO TO 3060-EXIT,
 16591               3060-EXIT
 16592         DEPENDING ON DFHEIGDI
 16593     ELSE IF DFHEIGDJ EQUAL 33
 16594         GO TO 5000-TRLR-NOT-FOUND
 16595         DEPENDING ON DFHEIGDI
 16596     ELSE IF DFHEIGDJ EQUAL 34
 16597         GO TO 5000-CERT-NOT-FOUND
 16598         DEPENDING ON DFHEIGDI
 16599     ELSE IF DFHEIGDJ EQUAL 35
 16600         GO TO 7630-END-BROWSE
 16601         DEPENDING ON DFHEIGDI
 16602     ELSE IF DFHEIGDJ EQUAL 36
 16603         GO TO 7799-EXIT,
 16604               7799-EXIT
 16605         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 24-Sep-13 11:23 Page 315
* EL131.cbl
 16606     ELSE IF DFHEIGDJ EQUAL 37
 16607         GO TO 7799-EXIT
 16608         DEPENDING ON DFHEIGDI
 16609     ELSE IF DFHEIGDJ EQUAL 38
 16610         GO TO 7800-NOT-FOUND
 16611         DEPENDING ON DFHEIGDI
 16612     ELSE IF DFHEIGDJ EQUAL 39
 16613         GO TO 8000-NOTE-NOT-FOUND
 16614         DEPENDING ON DFHEIGDI
 16615     ELSE IF DFHEIGDJ EQUAL 40
 16616         GO TO 8990-SEND-TEXT
 16617         DEPENDING ON DFHEIGDI.
 16618     MOVE '9%                    "   ' TO DFHEIV0
 16619     MOVE 'EL131' TO DFHEIV1
 16620     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16621     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13428     Code:       56991
