* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL630.cbl
* Options: int("EL630.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL630.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL630.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL630.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL630.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/19/94 08:59:00.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.046.
     9
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL630.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXA5 - NEW BUSINESS - DATA ENTRY.
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 103001    2001100100006  SMVA  CHECK FOR ? MARKS ANYWHERE IN
    35*                              BATCH NUMBER
    36* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
    37* 111109  CR2008100900003  AJRA  ADD NEW CERT NOTE TABLE
    38* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER ON 6301
    39******************************************************************
    40
    41 ENVIRONMENT DIVISION.
    42
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL630.cbl
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL630 WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    51
    52*    COPY ELCSCTM.
    53******************************************************************
    54*                                                                *
    55*                                                                *
    56*                            ELCSCTM                             *
    57*                            VMOD=2.001                          *
    58*                                                                *
    59*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    60*                                                                *
    61******************************************************************
    62 01  SECURITY-MESSAGE.
    63     12  FILLER                          PIC X(30)
    64            VALUE '** LOGIC SECURITY VIOLATION -'.
    65     12  SM-READ                         PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' PGM='.
    68     12  SM-PGM                          PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' OPR='.
    71     12  SM-PROCESSOR-ID                 PIC X(4).
    72     12  FILLER                          PIC X(6)
    73            VALUE ' TERM='.
    74     12  SM-TERMID                       PIC X(4).
    75     12  FILLER                          PIC XX   VALUE SPACE.
    76     12  SM-JUL-DATE                     PIC 9(5).
    77     12  FILLER                          PIC X    VALUE SPACE.
    78     12  SM-TIME                         PIC 99.99.
    79
    80*    COPY ELCSCRTY.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCRTY                            *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    88*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    89*        SAVED IN PI-SECURITY-ADDRESS.                           *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-CONTROL.
    93     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    94     12  FILLER                       PIC XX    VALUE 'SC'.
    95     12  SC-CREDIT-CODES.
    96         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    97             20  SC-CREDIT-DISPLAY    PIC X.
    98             20  SC-CREDIT-UPDATE     PIC X.
    99     12  SC-CLAIMS-CODES.
   100         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   101             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL630.cbl
   102             20  SC-CLAIMS-UPDATE     PIC X.
   103
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL630.cbl
   105
   106 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1900.
   107 01  STANDARD-AREAS.
   108     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
   109     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   110     12  MAP-NAME                PIC X(8)    VALUE 'EL630A'.
   111     12  MAPSET-NAME             PIC X(8)    VALUE 'EL630S '.
   112     12  SCREEN-NUMBER           PIC X(4)    VALUE '630A'.
   113     12  TRANS-ID                PIC X(4)    VALUE 'EXA5'.
   114     12  EDIT-TRANS              PIC X(4)    VALUE 'EXEB'.
   115     12  PASS-AREA-LEN           PIC S9(4)   COMP VALUE +16.
   116     12  THIS-PGM                PIC X(8)    VALUE 'EL630'.
   117     12  PGM-NAME                PIC X(8)    VALUE SPACES.
   118     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
   119     12  TIME-OUT-R  REDEFINES TIME-IN.
   120         16  FILLER              PIC X.
   121         16  TIME-OUT            PIC 99V99.
   122         16  FILLER              PIC X(2).
   123     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   124     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   125     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   126     12  XCTL-6301               PIC X(8)    VALUE 'EL6301'.
   127     12  XCTL-6302               PIC X(8)    VALUE 'EL6302'.
   128     12  XCTL-633                PIC X(8)    VALUE 'EL633'.
   129     12  XCTL-633DMD             PIC X(8)    VALUE 'EL633DMD'.
   130     12  XCTL-635                PIC X(8)    VALUE 'EL635'.
   131     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   132     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   133     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   134     12  ELCNTL-FILE-ID          PIC X(8)    VALUE 'ELCNTL'.
   135     12  ERPNDB-FILE-ID          PIC X(8)    VALUE 'ERPNDB'.
   136     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   137     12  ERACCT2-FILE-ID         PIC X(8)    VALUE 'ERACCT2'.
   138     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   139     12  ERNOTE-FILE-ID          PIC X(8)    VALUE 'ERNOTE'.
   140     12  ERCNOT-FILE-ID          PIC X(8)    VALUE 'ERCNOT'.
   141     12  ERMAIL-FILE-ID          PIC X(8)    VALUE 'ERMAIL'.
   142     12  ERCOMP-FILE-ID          PIC X(8)    VALUE 'ERCOMP'.
   143     12  ERPNDM-FILE-ID          PIC X(8)    VALUE 'ERPNDM'.
   144     12  ERRQST-FILE-ID          PIC X(8)    VALUE 'ERRQST'.
   145     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   146     12  WS-CURRENT-DT           PIC X(8)    VALUE SPACES.
   147     12  WS-CURRENT-YMD          PIC 9(6)    VALUE ZEROS.
   148     12  WS-SYNC-CNTR            PIC S9(3)   VALUE +0 COMP-3.
   149     12  WS-SUB1                 PIC S9(4)   VALUE +0 COMP.
   150     12  WS-SUB2                 PIC S9(4)   VALUE +0 COMP.
   151     12  PIC6-SUB                PIC S9(04)  VALUE +0 COMP.
   152     12  WS-AR-REPORTING         PIC X       VALUE SPACE.
   153         88  AR-NET-REPORT               VALUE 'N'.
   154         88  AR-GROSS-REPORT             VALUE 'G'.
   155     12  WS-COMP-MASTER-ERROR-SW PIC X       VALUE SPACE.
   156         88  WS-COMP-MASTER-ERROR        VALUE 'Y'.
   157
   158     12  WS-UPDATE-REFERENCE-SW  PIC X       VALUE SPACE.
   159         88  WS-UPDATE-REFERENCE         VALUE 'Y'.
   160
   161     12  WS-SWITCH               PIC X(01)   VALUE SPACE.
   162         88  QUESTION-MARK-FOUND             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL630.cbl
   163
   164     12  WS-RECORD-FOUND-SW      PIC X       VALUE SPACE.
   165         88  RECORD-FOUND                VALUE 'Y'.
   166         88  RECORD-NOT-FOUND            VALUE 'N'.
   167
   168     12  WS-ON1-SW1              PIC X(01)   VALUE 'Y'.
   169     12  WS-ON1-SW2              PIC X(01)   VALUE 'Y'.
   170     12  WS-ON1-SW3              PIC X(01)   VALUE 'Y'.
   171     12  WS-ON1-SW4              PIC X(01)   VALUE 'Y'.
   172     12  WS-ON1-SW5              PIC X(01)   VALUE 'Y'.
   173     12  WS-ON1-SW6              PIC X(01)   VALUE 'Y'.
   174     12  WS-ON1-SW7              PIC X(01)   VALUE 'Y'.
   175
   176     12  WS-ERPNDB-RECORD        PIC X(585)  VALUE SPACES.
   177
   178 01  BATCH-TO-PROCESS.
   179     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
   180     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
   181     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
   182     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
   183
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL630.cbl
   185 01  ERROR-MESSAGES.
   186     12  ER-0008                 PIC X(4)    VALUE '0008'.
   187     12  ER-0023                 PIC X(4)    VALUE '0023'.
   188     12  ER-0029                 PIC X(4)    VALUE '0029'.
   189     12  ER-0070                 PIC X(4)    VALUE '0070'.
   190     12  ER-0194                 PIC X(4)    VALUE '0194'.
   191     12  ER-0195                 PIC X(4)    VALUE '0195'.
   192     12  ER-0196                 PIC X(4)    VALUE '0196'.
   193     12  ER-0197                 PIC X(4)    VALUE '0197'.
   194     12  ER-0340                 PIC X(4)    VALUE '0340'.
   195     12  ER-0587                 PIC X(4)    VALUE '0587'.
   196     12  ER-0905                 PIC X(4)    VALUE '0905'.
   197     12  ER-2119                 PIC X(4)    VALUE '2119'.
   198     12  ER-2126                 PIC X(4)    VALUE '2126'.
   199     12  ER-2132                 PIC X(4)    VALUE '2132'.
   200     12  ER-2201                 PIC X(4)    VALUE '2201'.
   201     12  ER-2208                 PIC X(4)    VALUE '2208'.
   202     12  ER-2209                 PIC X(4)    VALUE '2209'.
   203     12  ER-2210                 PIC X(4)    VALUE '2210'.
   204     12  ER-2211                 PIC X(4)    VALUE '2211'.
   205     12  ER-2212                 PIC X(4)    VALUE '2212'.
   206     12  ER-2213                 PIC X(4)    VALUE '2213'.
   207     12  ER-2214                 PIC X(4)    VALUE '2214'.
   208     12  ER-2215                 PIC X(4)    VALUE '2215'.
   209     12  ER-2216                 PIC X(4)    VALUE '2216'.
   210     12  ER-2229                 PIC X(4)    VALUE '2229'.
   211     12  ER-2242                 PIC X(4)    VALUE '2242'.
   212     12  ER-2248                 PIC X(4)    VALUE '2248'.
   213     12  ER-2370                 PIC X(4)    VALUE '2370'.
   214     12  ER-2371                 PIC X(4)    VALUE '2371'.
   215     12  ER-2402                 PIC X(4)    VALUE '2402'.
   216     12  ER-2422                 PIC X(4)    VALUE '2422'.
   217     12  ER-2800                 PIC X(4)    VALUE '2800'.
   218     12  ER-2880                 PIC X(4)    VALUE '2880'.
   219     12  ER-2990                 PIC X(4)    VALUE '2990'.
   220
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL630.cbl
   222 01  ACCESS-KEYS.
   223     12  ELCNTL-KEY.
   224         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   225         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   226         16  CNTL-ACCESS.
   227             20  CNTL-STATE      PIC XX    VALUE SPACES.
   228             20  FILLER          PIC X     VALUE SPACES.
   229             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   230         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   231
   232     12  ERPNDB-KEY.
   233         16  PNDB-COMP-CD        PIC X     VALUE SPACE.
   234         16  PNDB-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   235         16  PNDB-BATCH-SEQ      PIC S9(4) VALUE +0 COMP.
   236         16  PNDB-BATCH-CHG-SEQ  PIC S9(4) VALUE +0 COMP.
   237
   238     12  ERACCT-KEY.
   239         16  ERACCT-COMP-KEY.
   240             20  ACCT-CO         PIC X     VALUE SPACES.
   241             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   242             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   243             20  ACCT-STATE      PIC XX    VALUE SPACES.
   244             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   245         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   246         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   247     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   248
   249     12  ELCERT-KEY.
   250         16  CERT-COMPANY-CD     PIC X     VALUE SPACES.
   251         16  CERT-CARRIER        PIC X     VALUE SPACES.
   252         16  CERT-GROUPING       PIC X(6)  VALUE SPACES.
   253         16  CERT-STATE          PIC XX    VALUE SPACES.
   254         16  FILLER              PIC X(23) VALUE SPACES.
   255
   256     12  ERCOMP-KEY.
   257         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   258         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   259         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   260         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   261         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   262         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   263
   264     12  ERRQST-KEY.
   265         16  ERRQST-COMP-CD      PIC X     VALUE SPACE.
   266         16  ERRQST-ENTRY-BATCH  PIC X(6)  VALUE SPACES.
   267
   268     12  ERCNOT-KEY.
   269         16  ERCNOT-PART-KEY.
   270             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   271             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   272             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   273             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   274             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   275             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   276             20  ERCNOT-CERT-NO.
   277                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   278                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   279         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL630.cbl
   280         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   281
   282
   283 01  FILLER.
   284     12  WS-DEEDIT-FIELD         PIC S9(8)V99 VALUE ZEROS.
   285     12  WS-DT-DEEDIT-FIELD REDEFINES
   286         WS-DEEDIT-FIELD         PIC X(10).
   287     12  WS-DEEDIT-FIELD-DATE  REDEFINES  WS-DEEDIT-FIELD.
   288         16   FILLER                           PIC X(04).
   289         16   WS-DEEDIT-FIELD-DATE-OUT         PIC X(06).
   290     12  QUESTION-MARKS          PIC X(6)      VALUE '??????'.
   291     12  QUESTION-MARK           PIC X(01)     VALUE '?'.
   292     12  WS-BATCH-NO             PIC 9(6)      VALUE ZEROS.
   293     12  WS-OBAL                 PIC S9(8)V99  VALUE ZEROS.
   294     12  WS-OCNT                 PIC S9(5)     VALUE ZEROS.
   295     12  WS-DELETE-CNT           PIC S9(5)     VALUE ZEROS.
   296     12  WS-PF1-SW               PIC X         VALUE SPACES.
   297         88  WS-PF1                            VALUE 'Y'.
   298
   299     12  WS-SAV-PNDB-KEY.
   300         16  WS-SAV-COMP-CD        PIC X       VALUE LOW-VALUES.
   301         16  WS-SAV-ENTRY-BATCH    PIC X(6)       VALUE SPACES.
   302         16  WS-SAV-BATCH-SEQ      PIC S9(4) COMP VALUE ZEROS.
   303         16  WS-SAV-BATCH-CHG-SEQ  PIC S9(4) COMP VALUE ZEROS.
   304
   305     12  DATE-TEST-AREA          PIC 9(6)         VALUE ZEROS.
   306     12  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
   307         16  DATE-TEST-MM        PIC 99.
   308         16  DATE-TEST-DD        PIC 99.
   309         16  DATE-TEST-YY        PIC 99.
   310     12  DIVIDE-RESULT           PIC 99           VALUE ZEROS.
   311     12  DIVIDE-REMAINDER        PIC 9            VALUE 0.
   312     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   313         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   314     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   315         88 CERT-ADDRESS-PRESENT     VALUE 'Y'.
   316     12  WS-PRM-HEADER.
   317         16  WS-PRM-OVERRIDE     PIC XX           VALUE SPACES.
   318         16  FILLER              PIC X(8)  VALUE '-PREMIUM'.
   319     12  WS-REFUND-HEADER.
   320         16  WS-REFUND-OVERRIDE  PIC XX    VALUE SPACES.
   321         16  FILLER              PIC X(7)  VALUE '-REFUND'.
   322
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL630.cbl
   324
   325*    COPY ELCDATE.
   326******************************************************************
   327*                                                                *
   328*                                                                *
   329*                            ELCDATE.                            *
   330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   331*                            VMOD=2.003
   332*                                                                *
   333*                                                                *
   334*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   335*                 LENGTH = 200                                   *
   336******************************************************************
   337
   338 01  DATE-CONVERSION-DATA.
   339     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   340     12  DC-OPTION-CODE                PIC X.
   341         88  BIN-TO-GREG                VALUE ' '.
   342         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   343         88  EDIT-GREG-TO-BIN           VALUE '2'.
   344         88  YMD-GREG-TO-BIN            VALUE '3'.
   345         88  MDY-GREG-TO-BIN            VALUE '4'.
   346         88  JULIAN-TO-BIN              VALUE '5'.
   347         88  BIN-PLUS-ELAPSED           VALUE '6'.
   348         88  FIND-CENTURY               VALUE '7'.
   349         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   350         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   351         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   352         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   353         88  JULIAN-TO-BIN-3            VALUE 'C'.
   354         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   355         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   356         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   357         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   358         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   359         88  CHECK-LEAP-YEAR            VALUE 'H'.
   360         88  BIN-3-TO-GREG              VALUE 'I'.
   361         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   362         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   363         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   364         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   365         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   366         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   367         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   368         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   369         88  THREE-CHARACTER-BIN
   370                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   371         88  GREGORIAN-TO-BIN
   372                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   373         88  BIN-TO-GREGORIAN
   374                  VALUES ' ' '1' 'I' '8' 'G'.
   375         88  JULIAN-TO-BINARY
   376                  VALUES '5' 'C' 'E' 'F'.
   377     12  DC-ERROR-CODE                 PIC X.
   378         88  NO-CONVERSION-ERROR        VALUE ' '.
   379         88  DATE-CONVERSION-ERROR
   380                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   381         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL630.cbl
   382         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   383         88  DATE-IS-INVALID            VALUE '3'.
   384         88  DATE1-GREATER-DATE2        VALUE '4'.
   385         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   386         88  DATE-INVALID-OPTION        VALUE '9'.
   387         88  INVALID-CENTURY            VALUE 'A'.
   388         88  ONLY-CENTURY               VALUE 'B'.
   389         88  ONLY-LEAP-YEAR             VALUE 'C'.
   390         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   391     12  DC-END-OF-MONTH               PIC X.
   392         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   393     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   394         88  USE-NORMAL-PROCESS         VALUE ' '.
   395         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   396         88  ADJUST-UP-100-YRS          VALUE '2'.
   397     12  FILLER                        PIC X.
   398     12  DC-CONVERSION-DATES.
   399         16  DC-BIN-DATE-1             PIC XX.
   400         16  DC-BIN-DATE-2             PIC XX.
   401         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   402         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   403                       DC-GREG-DATE-1-EDIT.
   404             20  DC-EDIT1-MONTH        PIC 99.
   405             20  SLASH1-1              PIC X.
   406             20  DC-EDIT1-DAY          PIC 99.
   407             20  SLASH1-2              PIC X.
   408             20  DC-EDIT1-YEAR         PIC 99.
   409         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   410         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   411                     DC-GREG-DATE-2-EDIT.
   412             20  DC-EDIT2-MONTH        PIC 99.
   413             20  SLASH2-1              PIC X.
   414             20  DC-EDIT2-DAY          PIC 99.
   415             20  SLASH2-2              PIC X.
   416             20  DC-EDIT2-YEAR         PIC 99.
   417         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   418         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   419                     DC-GREG-DATE-1-YMD.
   420             20  DC-YMD-YEAR           PIC 99.
   421             20  DC-YMD-MONTH          PIC 99.
   422             20  DC-YMD-DAY            PIC 99.
   423         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   424         16  DC-GREG-DATE-1-MDY-R REDEFINES
   425                      DC-GREG-DATE-1-MDY.
   426             20  DC-MDY-MONTH          PIC 99.
   427             20  DC-MDY-DAY            PIC 99.
   428             20  DC-MDY-YEAR           PIC 99.
   429         16  DC-GREG-DATE-1-ALPHA.
   430             20  DC-ALPHA-MONTH        PIC X(10).
   431             20  DC-ALPHA-DAY          PIC 99.
   432             20  FILLER                PIC XX.
   433             20  DC-ALPHA-CENTURY.
   434                 24 DC-ALPHA-CEN-N     PIC 99.
   435             20  DC-ALPHA-YEAR         PIC 99.
   436         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   437         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   438         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   439         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL630.cbl
   440         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   441                                       PIC 9(05).
   442         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   443             20  DC-JULIAN-YEAR        PIC 99.
   444             20  DC-JULIAN-DAYS        PIC 999.
   445         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   446         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   447         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   448     12  DATE-CONVERSION-VARIBLES.
   449         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   450         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   451             20  FILLER                PIC 9(3).
   452             20  HOLD-CEN-1-CCYY.
   453                 24  HOLD-CEN-1-CC     PIC 99.
   454                 24  HOLD-CEN-1-YY     PIC 99.
   455             20  HOLD-CEN-1-MO         PIC 99.
   456             20  HOLD-CEN-1-DA         PIC 99.
   457         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   458             20  HOLD-CEN-1-R-MO       PIC 99.
   459             20  HOLD-CEN-1-R-DA       PIC 99.
   460             20  HOLD-CEN-1-R-CCYY.
   461                 24  HOLD-CEN-1-R-CC   PIC 99.
   462                 24  HOLD-CEN-1-R-YY   PIC 99.
   463             20  FILLER                PIC 9(3).
   464         16  HOLD-CENTURY-1-X.
   465             20  FILLER                PIC X(3)  VALUE SPACES.
   466             20  HOLD-CEN-1-X-CCYY.
   467                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   468                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   469             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   470             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   471         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   472             20  HOLD-CEN-1-R-X-MO     PIC XX.
   473             20  HOLD-CEN-1-R-X-DA     PIC XX.
   474             20  HOLD-CEN-1-R-X-CCYY.
   475                 24  HOLD-CEN-1-R-X-CC PIC XX.
   476                 24  HOLD-CEN-1-R-X-YY PIC XX.
   477             20  FILLER                PIC XXX.
   478         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   479         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   480         16  DC-JULIAN-DATE-1          PIC 9(07).
   481         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   482             20  DC-JULIAN-1-CCYY.
   483                 24  DC-JULIAN-1-CC    PIC 99.
   484                 24  DC-JULIAN-1-YR    PIC 99.
   485             20  DC-JULIAN-DA-1        PIC 999.
   486         16  DC-JULIAN-DATE-2          PIC 9(07).
   487         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   488             20  DC-JULIAN-2-CCYY.
   489                 24  DC-JULIAN-2-CC    PIC 99.
   490                 24  DC-JULIAN-2-YR    PIC 99.
   491             20  DC-JULIAN-DA-2        PIC 999.
   492         16  DC-GREG-DATE-A-EDIT.
   493             20  DC-EDITA-MONTH        PIC 99.
   494             20  SLASHA-1              PIC X VALUE '/'.
   495             20  DC-EDITA-DAY          PIC 99.
   496             20  SLASHA-2              PIC X VALUE '/'.
   497             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL630.cbl
   498                 24  DC-EDITA-CENT     PIC 99.
   499                 24  DC-EDITA-YEAR     PIC 99.
   500         16  DC-GREG-DATE-B-EDIT.
   501             20  DC-EDITB-MONTH        PIC 99.
   502             20  SLASHB-1              PIC X VALUE '/'.
   503             20  DC-EDITB-DAY          PIC 99.
   504             20  SLASHB-2              PIC X VALUE '/'.
   505             20  DC-EDITB-CCYY.
   506                 24  DC-EDITB-CENT     PIC 99.
   507                 24  DC-EDITB-YEAR     PIC 99.
   508         16  DC-GREG-DATE-CYMD         PIC 9(08).
   509         16  DC-GREG-DATE-CYMD-R REDEFINES
   510                              DC-GREG-DATE-CYMD.
   511             20  DC-CYMD-CEN           PIC 99.
   512             20  DC-CYMD-YEAR          PIC 99.
   513             20  DC-CYMD-MONTH         PIC 99.
   514             20  DC-CYMD-DAY           PIC 99.
   515         16  DC-GREG-DATE-MDCY         PIC 9(08).
   516         16  DC-GREG-DATE-MDCY-R REDEFINES
   517                              DC-GREG-DATE-MDCY.
   518             20  DC-MDCY-MONTH         PIC 99.
   519             20  DC-MDCY-DAY           PIC 99.
   520             20  DC-MDCY-CEN           PIC 99.
   521             20  DC-MDCY-YEAR          PIC 99.
   522    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   523        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   524    12  DC-EL310-DATE                  PIC X(21).
   525    12  FILLER                         PIC X(28).
   526
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL630.cbl
   528*    COPY ELCLOGOF.
   529******************************************************************
   530*                                                                *
   531*                                                                *
   532*                            ELCLOGOF.                           *
   533*                            VMOD=2.001                          *
   534*                                                                *
   535*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   536*                                                                *
   537******************************************************************
   538 01  CLASIC-LOGOFF.
   539     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   540     12  LOGOFF-TEXT.
   541         16  FILLER          PIC X(5)    VALUE SPACES.
   542         16  LOGOFF-MSG.
   543             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   544             20  FILLER      PIC X       VALUE SPACES.
   545             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   546         16  FILLER          PIC X(80)
   547           VALUE '* YOU ARE NOW LOGGED OFF'.
   548         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   549         16  FILLER          PIC X       VALUE QUOTE.
   550         16  LOGOFF-SYS-MSG  PIC X(17)
   551           VALUE 'S CLAS-IC SYSTEM '.
   552     12  TEXT-MESSAGES.
   553         16  UNACCESS-MSG    PIC X(29)
   554             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   555         16  PGMIDERR-MSG    PIC X(17)
   556             VALUE 'PROGRAM NOT FOUND'.
   557
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL630.cbl
   559*    COPY ELCATTR.
   560******************************************************************
   561*                                                                *
   562*                            ELCATTR.                            *
   563*                            VMOD=2.001                          *
   564*                                                                *
   565*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   566*                                                                *
   567*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   568*                                                                *
   569*                   POS 1   P=PROTECTED                          *
   570*                           U=UNPROTECTED                        *
   571*                           S=ASKIP                              *
   572*                   POS 2   A=ALPHA/NUMERIC                      *
   573*                           N=NUMERIC                            *
   574*                   POS 3   N=NORMAL                             *
   575*                           B=BRIGHT                             *
   576*                           D=DARK                               *
   577*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   578*                           OF=MODIFIED DATA TAG OFF             *
   579*                                                                *
   580*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   581******************************************************************
   582 01  ATTRIBUTE-LIST.
   583     12  AL-PABOF            PIC X       VALUE 'Y'.
   584     12  AL-PABON            PIC X       VALUE 'Z'.
   585     12  AL-PADOF            PIC X       VALUE '%'.
   586     12  AL-PADON            PIC X       VALUE '_'.
   587     12  AL-PANOF            PIC X       VALUE '-'.
   588     12  AL-PANON            PIC X       VALUE '/'.
   589     12  AL-SABOF            PIC X       VALUE '8'.
   590     12  AL-SABON            PIC X       VALUE '9'.
   591     12  AL-SADOF            PIC X       VALUE '@'.
   592     12  AL-SADON            PIC X       VALUE QUOTE.
   593     12  AL-SANOF            PIC X       VALUE '0'.
   594     12  AL-SANON            PIC X       VALUE '1'.
   595     12  AL-UABOF            PIC X       VALUE 'H'.
   596     12  AL-UABON            PIC X       VALUE 'I'.
   597     12  AL-UADOF            PIC X       VALUE '<'.
   598     12  AL-UADON            PIC X       VALUE '('.
   599     12  AL-UANOF            PIC X       VALUE ' '.
   600     12  AL-UANON            PIC X       VALUE 'A'.
   601     12  AL-UNBOF            PIC X       VALUE 'Q'.
   602     12  AL-UNBON            PIC X       VALUE 'R'.
   603     12  AL-UNDOF            PIC X       VALUE '*'.
   604     12  AL-UNDON            PIC X       VALUE ')'.
   605     12  AL-UNNOF            PIC X       VALUE '&'.
   606     12  AL-UNNON            PIC X       VALUE 'J'.
   607
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL630.cbl
   609*    COPY ELCEMIB.
   610******************************************************************
   611*                                                                *
   612*                                                                *
   613*                            ELCEMIB.                            *
   614*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   615*                            VMOD=2.005                          *
   616*                                                                *
   617*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   618*                                                                *
   619******************************************************************
   620 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   621     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   622     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   623     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   624     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   625     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   626     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   627     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   628     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   629     12  EMI-SWITCH1             PIC X        VALUE '1'.
   630         88  EMI-NO-ERRORS                    VALUE '1'.
   631         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   632         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   633     12  EMI-SWITCH2             PIC X        VALUE '1'.
   634         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   635     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   636         88  EMI-AREA1-EMPTY                  VALUE '1'.
   637         88  EMI-AREA1-FULL                   VALUE '2'.
   638     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   639         88  EMI-AREA2-EMPTY                  VALUE '1'.
   640         88  EMI-AREA2-FULL                   VALUE '2'.
   641     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   642         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   643         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   644         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   645         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   646         88  EMI-BYPASS-FATALS                VALUE 'X'.
   647     12  EMI-ERROR-LINES.
   648         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   649         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   650         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   651         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   652             20  EMI-ERR-CODES OCCURS 10 TIMES.
   653                 24  EMI-ERR-NUM         PIC X(4).
   654                 24  EMI-FILLER          PIC X.
   655                 24  EMI-SEV             PIC X.
   656                 24  FILLER              PIC X.
   657             20  FILLER                  PIC X(02).
   658     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   659         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   660             20  EMI-ERROR-NUMBER    PIC X(4).
   661             20  EMI-FILL            PIC X.
   662             20  EMI-SEVERITY        PIC X.
   663             20  FILLER              PIC X.
   664             20  EMI-ERROR-TEXT.
   665                 24  EMI-TEXT-VARIABLE   PIC X(10).
   666                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL630.cbl
   667     12  EMI-SEVERITY-SAVE           PIC X.
   668         88  EMI-NOTE                    VALUE 'N'.
   669         88  EMI-WARNING                 VALUE 'W'.
   670         88  EMI-FORCABLE                VALUE 'F'.
   671         88  EMI-FATAL                   VALUE 'X'.
   672     12  EMI-MESSAGE-FLAG            PIC X.
   673         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   674         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   675     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   676     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   677         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   678         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   679         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   680     12  FILLER                      PIC X(137)  VALUE SPACES.
   681     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   682     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   683     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   684     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   685
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL630.cbl
   687*    COPY ELCINTF.
   688******************************************************************
   689*                                                                *
   690*                                                                *
   691*                            ELCINTF.                            *
   692*                            VMOD=2.017                          *
   693*                                                                *
   694*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   695*                                                                *
   696*       LENGTH = 1024                                            *
   697*                                                                *
   698******************************************************************
   699 01  PROGRAM-INTERFACE-BLOCK.
   700     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   701     12  PI-CALLING-PROGRAM              PIC X(8).
   702     12  PI-SAVED-PROGRAM-1              PIC X(8).
   703     12  PI-SAVED-PROGRAM-2              PIC X(8).
   704     12  PI-SAVED-PROGRAM-3              PIC X(8).
   705     12  PI-SAVED-PROGRAM-4              PIC X(8).
   706     12  PI-SAVED-PROGRAM-5              PIC X(8).
   707     12  PI-SAVED-PROGRAM-6              PIC X(8).
   708     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   709     12  PI-COMPANY-ID                   PIC XXX.
   710     12  PI-COMPANY-CD                   PIC X.
   711
   712     12  PI-COMPANY-PASSWORD             PIC X(8).
   713
   714     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   715
   716     12  PI-CONTROL-IN-PROGRESS.
   717         16  PI-CARRIER                  PIC X.
   718         16  PI-GROUPING                 PIC X(6).
   719         16  PI-STATE                    PIC XX.
   720         16  PI-ACCOUNT                  PIC X(10).
   721         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   722                                         PIC X(10).
   723         16  PI-CLAIM-CERT-GRP.
   724             20  PI-CLAIM-NO             PIC X(7).
   725             20  PI-CERT-NO.
   726                 25  PI-CERT-PRIME       PIC X(10).
   727                 25  PI-CERT-SFX         PIC X.
   728             20  PI-CERT-EFF-DT          PIC XX.
   729         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   730             20  PI-PLAN-CODE            PIC X(2).
   731             20  PI-REVISION-NUMBER      PIC X(3).
   732             20  PI-PLAN-EFF-DT          PIC X(2).
   733             20  PI-PLAN-EXP-DT          PIC X(2).
   734             20  FILLER                  PIC X(11).
   735         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   736             20  PI-OE-REFERENCE-1.
   737                 25  PI-OE-REF-1-PRIME   PIC X(18).
   738                 25  PI-OE-REF-1-SUFF    PIC XX.
   739
   740     12  PI-SESSION-IN-PROGRESS          PIC X.
   741         88  CLAIM-SESSION                   VALUE '1'.
   742         88  CREDIT-SESSION                  VALUE '2'.
   743         88  WARRANTY-SESSION                VALUE '3'.
   744         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL630.cbl
   745         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   746
   747
   748*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   749
   750     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   751     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   752
   753     12  PI-CREDIT-USER                  PIC X.
   754         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   755         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   756
   757     12  PI-CLAIM-USER                   PIC X.
   758         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   759         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   760
   761     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   762         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   763         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   764         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   765         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   766         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   767
   768     12  PI-PROCESSOR-ID                 PIC X(4).
   769
   770     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   771
   772     12  PI-MEMBER-CAPTION               PIC X(10).
   773
   774     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   775         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   776
   777     12  PI-LIFE-OVERRIDE-L1             PIC X.
   778     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   779     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   780     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   781
   782     12  PI-AH-OVERRIDE-L1               PIC X.
   783     12  PI-AH-OVERRIDE-L2               PIC XX.
   784     12  PI-AH-OVERRIDE-L6               PIC X(6).
   785     12  PI-AH-OVERRIDE-L12              PIC X(12).
   786
   787     12  PI-NEW-SYSTEM                   PIC X(2).
   788
   789     12  PI-PRIMARY-CERT-NO              PIC X(11).
   790     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   791         88  PI-USES-PAID-TO                 VALUE '1'.
   792     12  PI-CRDTCRD-SYSTEM.
   793         16  PI-CRDTCRD-USER             PIC X.
   794             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   795             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   796         16  PI-CC-MONTH-END-DT          PIC XX.
   797     12  PI-PROCESSOR-PRINTER            PIC X(4).
   798
   799     12  PI-OE-REFERENCE-2.
   800         16  PI-OE-REF-2-PRIME           PIC X(10).
   801         16  PI-OE-REF-2-SUFF            PIC X.
   802
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL630.cbl
   803     12  PI-REM-TRM-CALC-OPTION          PIC X.
   804
   805     12  PI-LANGUAGE-TYPE                PIC X.
   806             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   807             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   808             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   809
   810     12  PI-POLICY-LINKAGE-IND           PIC X.
   811         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   812         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   813                                                   LOW-VALUES.
   814
   815     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   816     12  PI-CLAIM-PW-SESSION             PIC X(1).
   817         88  PI-CLAIM-CREDIT                 VALUE '1'.
   818         88  PI-CLAIM-CONVEN                 VALUE '2'.
   819     12  FILLER                          PIC X(4).
   820
   821     12  PI-SYSTEM-LEVEL                 PIC X(145).
   822
   823     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   824         PI-SYSTEM-LEVEL.
   825
   826         16  PI-ENTRY-CODES.
   827             20  PI-ENTRY-CD-1           PIC X.
   828             20  PI-ENTRY-CD-2           PIC X.
   829
   830         16  PI-RETURN-CODES.
   831             20  PI-RETURN-CD-1          PIC X.
   832             20  PI-RETURN-CD-2          PIC X.
   833
   834         16  PI-UPDATE-STATUS-SAVE.
   835             20  PI-UPDATE-BY            PIC X(4).
   836             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   837
   838         16  PI-LOWER-CASE-LETTERS       PIC X.
   839             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   840
   841*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   842*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   843*            88  CARRIER-CLM-CNTL            VALUE '2'.
   844
   845         16  PI-CERT-ACCESS-CONTROL      PIC X.
   846             88  ST-ACCNT-CNTL               VALUE ' '.
   847             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   848             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   849             88  ACCNT-CNTL                  VALUE '3'.
   850             88  CARR-ACCNT-CNTL             VALUE '4'.
   851
   852         16  PI-PROCESSOR-CAP-LIST.
   853             20  PI-SYSTEM-CONTROLS.
   854                24 PI-SYSTEM-DISPLAY     PIC X.
   855                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   856                24 PI-SYSTEM-MODIFY      PIC X.
   857                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   858             20  FILLER                  PIC XX.
   859             20  PI-DISPLAY-CAP          PIC X.
   860                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL630.cbl
   861             20  PI-MODIFY-CAP           PIC X.
   862                 88  MODIFY-CAP              VALUE 'Y'.
   863             20  PI-MSG-AT-LOGON-CAP     PIC X.
   864                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   865             20  PI-FORCE-CAP            PIC X.
   866                 88  FORCE-CAP               VALUE 'Y'.
   867
   868         16  PI-PROGRAM-CONTROLS.
   869             20  PI-PGM-PRINT-OPT        PIC X.
   870             20  PI-PGM-FORMAT-OPT       PIC X.
   871             20  PI-PGM-PROCESS-OPT      PIC X.
   872             20  PI-PGM-TOTALS-OPT       PIC X.
   873
   874         16  PI-HELP-INTERFACE.
   875             20  PI-LAST-ERROR-NO        PIC X(4).
   876             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   877
   878         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   879             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   880
   881         16  PI-CR-CONTROL-IN-PROGRESS.
   882             20  PI-CR-CARRIER           PIC X.
   883             20  PI-CR-GROUPING          PIC X(6).
   884             20  PI-CR-STATE             PIC XX.
   885             20  PI-CR-ACCOUNT           PIC X(10).
   886             20  PI-CR-FIN-RESP          PIC X(10).
   887             20  PI-CR-TYPE              PIC X.
   888
   889         16  PI-CR-BATCH-NUMBER          PIC X(6).
   890
   891         16  PI-CR-MONTH-END-DT          PIC XX.
   892
   893         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   894             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   895             88  PI-ZERO-CARRIER             VALUE '1'.
   896             88  PI-ZERO-GROUPING            VALUE '2'.
   897             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   898
   899         16  PI-CARRIER-SECURITY         PIC X.
   900             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   901
   902         16  PI-ACCOUNT-SECURITY         PIC X(10).
   903             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   904             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   905
   906         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   907             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   908                                         INDEXED BY PI-ACCESS-NDX
   909                                         PIC X.
   910
   911         16  PI-GA-BILLING-CONTROL       PIC X.
   912             88  PI-GA-BILLING               VALUE '1'.
   913
   914         16  PI-MAIL-PROCESSING          PIC X.
   915             88  PI-MAIL-YES                 VALUE 'Y'.
   916
   917         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   918
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL630.cbl
   919         16  PI-AR-SYSTEM.
   920             20  PI-AR-PROCESSING-CNTL   PIC X.
   921                 88  PI-AR-PROCESSING        VALUE 'Y'.
   922             20  PI-AR-SUMMARY-CODE      PIC X(6).
   923             20  PI-AR-MONTH-END-DT      PIC XX.
   924
   925         16  PI-MP-SYSTEM.
   926             20  PI-MORTGAGE-USER            PIC X.
   927                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   928                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   929             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   930                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   931                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   932                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   933                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   934                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   935             20  PI-MP-MONTH-END-DT          PIC XX.
   936             20  PI-MP-REFERENCE-NO.
   937                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   938                 24  PI-MP-REFERENCE-SFX     PIC XX.
   939
   940         16  PI-LABEL-CONTROL            PIC X(01).
   941             88  PI-CREATE-LABELS                    VALUE 'Y'.
   942             88  PI-BYPASS-LABELS                    VALUE 'N'.
   943
   944         16  PI-BILL-GROUPING-CODE       PIC X(01).
   945             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   946
   947         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   948             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   949             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   950
   951         16  FILLER                      PIC X(14).
   952
   953     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   954******************************************************************
   955*    COPY ELC630PI.
   956******************************************************************
   957*                                                                *
   958*                            ELC630PI                            *
   959*                            VMOD=2.014                          *
   960*                                                                *
   961* - PI-PROGRAM-WORK-AREA FOR THE DATA-ENTRY SUB-SYSTEM -         *
   962*                                                                *
   963*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
   964*                                                                *
   965*               EL630 - EL6301 - EL6302                          *
   966******************************************************************
   967*                   C H A N G E   L O G
   968*
   969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   970*-----------------------------------------------------------------
   971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   972* EFFECTIVE    NUMBER
   973*-----------------------------------------------------------------
   974* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
   975* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER FIELD
   976******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL630.cbl
   977
   978     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   979         16  PI-AM-NAME                  PIC X(30).
   980         16  PI-MAP-NAME                 PIC X(8).
   981         16  PI-BATCH-AMOUNTS    COMP-3.
   982             20  PI-LF-ISS-REMITTED      PIC S9(8)V99.
   983             20  PI-LF-ISS-ENTERED       PIC S9(8)V99.
   984             20  PI-LF-CAN-REMITTED      PIC S9(8)V99.
   985             20  PI-LF-CAN-ENTERED       PIC S9(8)V99.
   986             20  PI-AH-ISS-REMITTED      PIC S9(8)V99.
   987             20  PI-AH-ISS-ENTERED       PIC S9(8)V99.
   988             20  PI-AH-CAN-REMITTED      PIC S9(8)V99.
   989             20  PI-AH-CAN-ENTERED       PIC S9(8)V99.
   990             20  PI-ISS-CNT-REMITTED     PIC S9(5).
   991             20  PI-ISS-CNT-ENTERED      PIC S9(5).
   992             20  PI-CAN-CNT-REMITTED     PIC S9(5).
   993             20  PI-CAN-CNT-ENTERED      PIC S9(5).
   994         16  PI-MAINT-FUNC               PIC X.
   995         16  PI-ERROR-SW                 PIC X.
   996             88  PI-DATA-ERRORS              VALUE 'Y'.
   997         16  PI-UPDATE-SW                PIC X.
   998             88  PI-DATA-UPDATED             VALUE 'Y'.
   999         16  PI-DISPLAY-SW               PIC X.
  1000             88  PI-LAST-FUNC-DISPLAY        VALUE 'Y'.
  1001         16  PI-SAVE-CALLING-PGM         PIC X(8).
  1002         16  PI-LAST-SEQ-NO-ADDED        PIC S9(4) COMP.
  1003         16  PI-NEXT-DISPLAY-SEQ-NO      PIC S9(4) COMP.
  1004         16  PI-SAV-CARRIER              PIC X.
  1005         16  PI-SAV-GROUPING             PIC X(6).
  1006         16  PI-SAV-STATE                PIC XX.
  1007         16  PI-SAV-ACCOUNT              PIC X(10).
  1008         16  PI-SAV-CERT-EFF-DT          PIC XX.
  1009         16  PI-SAV-CERT-NO.
  1010             20  PI-SAV-CERT-PRIME       PIC X(14).
  1011             20  PI-SAV-CERT-SFX         PIC X.
  1012         16  PI-PYAJ-REFERENCE REDEFINES PI-SAV-CERT-NO.
  1013             20  PI-SAV-PYAJ-REFERENCE   PIC X(12).
  1014             20  FILLER                  PIC X(3).
  1015         16  PI-SAV-ENDING-ERPNDB-KEY.
  1016             20  PI-SAV-COMP-CD          PIC X.
  1017             20  PI-SAV-ENTRY-BATCH      PIC X(6).
  1018             20  PI-SAV-BATCH-SEQ        PIC S9(4) COMP.
  1019             20  PI-SAV-BATCH-CHG-SEQ    PIC S9(4) COMP.
  1020         16  PI-SAV-REFERENCE            PIC X(12).
  1021         16  PI-SAV-FULL-CONTROL.
  1022             20  PI-SAV-FC-CARRIER       PIC X.
  1023             20  PI-SAV-FC-GROUPING      PIC X(6).
  1024             20  PI-SAV-FC-STATE         PIC XX.
  1025         16  PI-VERIFY-DELETE-SW         PIC X.
  1026             88  PI-DELETE-IS-OK             VALUE 'Y'.
  1027         16  PI-EL630-FIRST-TIME-SW      PIC X.
  1028             88  PI-EL630-FIRST-TIME         VALUE SPACE.
  1029         16  PI-CREDIT-EDIT-CONTROLS.
  1030             20  PI-MIN-PREMIUM          PIC S9(3)V99  COMP-3.
  1031             20  PI-MIN-AGE              PIC 99.
  1032             20  PI-DEFAULT-AGE          PIC 99.
  1033             20  PI-MIN-TERM             PIC S9(3)     COMP-3.
  1034             20  PI-MAX-TERM             PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL630.cbl
  1035             20  PI-DEFAULT-SEX          PIC X.
  1036             20  PI-JOINT-AGE-INPUT      PIC X.
  1037                 88 PI-JOINT-AGE-IS-INPUT       VALUE '1'.
  1038             20  PI-BIRTH-DATE-INPUT     PIC X.
  1039                 88 PI-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1040         16  PI-KEYED-SWITCHES.
  1041             20  PI-ISS-SUFFIX-KEYED-SW  PIC X.
  1042                 88  PI-ISS-SUFFIX-KEYED     VALUE 'Y'.
  1043             20  PI-CAN-SUFFIX-KEYED-SW  PIC X.
  1044                 88  PI-CAN-SUFFIX-KEYED     VALUE 'Y'.
  1045             20  PI-IG-KEYED-SW          PIC X.
  1046                 88  PI-IG-KEYED             VALUE 'Y'.
  1047             20  PI-APR-KEYED-SW         PIC X.
  1048                 88  PI-APR-KEYED            VALUE 'Y'.
  1049*            20  PI-FREQ-KEYED-SW        PIC X.
  1050*                88  PI-FREQ-KEYED           VALUE 'Y'.
  1051             20  PI-VIN-KEYED-SW         PIC X.
  1052                 88  PI-VIN-KEYED            VALUE 'Y'.
  1053             20  PI-SIG-KEYED-SW         PIC X.
  1054                 88  PI-SIG-KEYED            VALUE 'Y'.
  1055             20  PI-LFRT-KEYED-SW        PIC X.
  1056                 88  PI-LFRT-KEYED           VALUE 'Y'.
  1057             20  PI-AHRT-KEYED-SW        PIC X.
  1058                 88  PI-AHRT-KEYED           VALUE 'Y'.
  1059             20  PI-SSNUM-KEYED-SW       PIC X.
  1060                 88  PI-SSNUM-KEYED          VALUE 'Y'.
  1061             20  PI-JNT-SSNUM-KEYED-SW   PIC X.
  1062                 88  PI-JNT-SSNUM-KEYED      VALUE 'Y'.
  1063             20  PI-MEMBER-KEYED-SW      PIC X.
  1064                 88  PI-MEMBER-KEYED         VALUE 'Y'.
  1065             20  PI-MODE-KEYED-SW        PIC X.
  1066                 88  PI-MODE-KEYED           VALUE 'Y'.
  1067             20  PI-PMTS-KEYED-SW        PIC X.
  1068                 88  PI-PMTS-KEYED           VALUE 'Y'.
  1069             20  PI-LN-OFFICER-KEYED-SW  PIC X.
  1070                 88  PI-LN-OFFICER-KEYED     VALUE 'Y'.
  1071             20  PI-ENTRY-KEYED-SW       PIC X.
  1072                 88  PI-ENTRY-KEYED          VALUE 'Y'.
  1073             20  PI-FORCE-KEYED-SW       PIC X.
  1074                 88  PI-FORCE-KEYED          VALUE 'Y'.
  1075             20  PI-RINCD-KEYED-SW       PIC X.
  1076                 88  PI-RINCD-KEYED          VALUE 'Y'.
  1077             20  PI-BILLCD-KEYED-SW      PIC X.
  1078                 88  PI-BILLCD-KEYED         VALUE 'Y'.
  1079             20  PI-RTCLS-KEYED-SW       PIC X.
  1080                 88  PI-RTCLS-KEYED          VALUE 'Y'.
  1081             20  PI-LNTRM-KEYED-SW       PIC X.
  1082                 88  PI-LNTRM-KEYED          VALUE 'Y'.
  1083             20  PI-EXPIR-KEYED-SW       PIC X.
  1084                 88  PI-EXPIR-KEYED          VALUE 'Y'.
  1085             20  PI-PMT-KEYED-SW         PIC X.
  1086                 88  PI-PMT-KEYED            VALUE 'Y'.
  1087             20  PI-1ST-PMT-KEYED-SW     PIC X.
  1088                 88  PI-1ST-PMT-KEYED        VALUE 'Y'.
  1089             20  PI-DAYS-KEYED-SW        PIC X.
  1090                 88  PI-DAYS-KEYED           VALUE 'Y'.
  1091             20  PI-SKPCD-KEYED-SW       PIC X.
  1092                 88  PI-SKPCD-KEYED          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL630.cbl
  1093             20  PI-JNT-AGE-KEYED-SW     PIC X.
  1094                 88  PI-JNT-AGE-KEYED        VALUE 'Y'.
  1095             20  PI-JNT-NAME-KEYED-SW    PIC X.
  1096                 88  PI-JNT-NAME-KEYED       VALUE 'Y'.
  1097             20  PI-ISS-LIVES-KEYED-SW   PIC X.
  1098                 88  PI-ISS-LIVES-KEYED      VALUE 'Y'.
  1099             20  PI-CAN-LIVES-KEYED-SW   PIC X.
  1100                 88  PI-CAN-LIVES-KEYED      VALUE 'Y'.
  1101             20  PI-PAYEE-KEYED-SW       PIC X.
  1102                 88  PI-PAYEE-KEYED          VALUE 'Y'.
  1103             20  PI-CHK-REQ-KEYED-SW     PIC X.
  1104                 88  PI-CHK-REQ-KEYED        VALUE 'Y'.
  1105             20  PI-ZIP4-KEYED-SW        PIC X.
  1106                 88  PI-ZIP4-KEYED           VALUE 'Y'.
  1107             20  PI-POLICY-KEYED-SW      PIC X.
  1108                 88  PI-POLICY-KEYED         VALUE 'Y'.
  1109             20  PI-EXPIRE-KEYED-SW      PIC X.
  1110                 88  PI-EXPIRE-KEYED         VALUE 'Y'.
  1111             20  PI-CRIT-PERD-KEYED-SW    PIC X.
  1112                 88  PI-CRIT-PERD-KEYED      VALUE 'Y'.
  1113             20  PI-BENEFICIARY-KEYED-SW PIC X.
  1114                 88  PI-BENEFICIARY-KEYED    VALUE 'Y'.
  1115             20  PI-PHONE-KEYED-SW       PIC X.
  1116                 88  PI-PHONE-KEYED          VALUE 'Y'.
  1117             20  PI-ALT-BEN-KEYED-SW     PIC X.
  1118                 88  PI-ALT-BEN-KEYED        VALUE 'Y'.
  1119             20  PI-ALT-PREM-KEYED-SW    PIC X.
  1120                 88  PI-ALT-PREM-KEYED       VALUE 'Y'.
  1121             20  PI-REFUND-MTHD-KEYED-SW PIC X.
  1122                 88  PI-REFUND-MTHD-KEYED    VALUE 'Y'.
  1123         16  PI-ACCT-LOW-EFF-DT          PIC XX.
  1124         16  PI-ACCT-HIGH-EXP-DT         PIC XX.
  1125         16  PI-BATCH-EOF-SW             PIC X.
  1126             88  PI-BATCH-EOF                VALUE 'Y'.
  1127         16  PI-NB-MONTH-END-DT          PIC XX.
  1128         16  PI-ISSUE-ADDED-SW           PIC X.
  1129             88  PI-ISSUE-ADDED              VALUE 'Y'.
  1130         16  PI-BROWSE-SW                PIC X.
  1131             88  PI-BROWSE                   VALUE 'Y'.
  1132         16  PI-ACCT-AGENT-ERROR-SW      PIC X.
  1133             88  PI-ACCT-AGENT-ERROR         VALUE 'Y'.
  1134         16  PI-FIN-RESP-ERROR-SW        PIC X.
  1135             88  PI-FIN-RESP-ERROR           VALUE 'Y'.
  1136         16  PI-MICRO-NO-KEYED-SW        PIC X.
  1137             88  PI-MICRO-NO-KEYED           VALUE 'Y'.
  1138         16  PI-AM-EDIT-LOAN-OFC         PIC X.
  1139         16  PI-AM-ADDR1                 PIC X(30).
  1140         16  PI-AM-ADDR2                 PIC X(30).
  1141         16  PI-AM-CITYST.
  1142             20  PI-AM-CITY              PIC X(28).
  1143             20  PI-AM-STATE             PIC XX.
  1144         16  PI-AM-ZIP                   PIC X(9).
  1145         16  FILLER                      PIC X(290).
  1146*        16  FILLER                      PIC X(390).
  1147     12  PI-MISC.
  1148         16  PI-ACCT-DATE-RANGES OCCURS 32 TIMES.
  1149             20  PI-ACCT-EFF-DT          PIC XX.
  1150             20  PI-ACCT-EXP-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL630.cbl
  1151             20  PI-REMIT-AGENT          PIC X(10).
  1152             20  PI-ACCT-AGENT           PIC X(10).
  1153         16  PI-ACCOUNT-AGENT            PIC X(10).
  1154         16  PI-FIN-RESP                 PIC X(10).
  1155         16  PI-SUMMARY-CODE             PIC X(6).
  1156         16  PI-SUB                      PIC S9(4) COMP.
  1157         16  PI-COMP-CARRIER             PIC X.
  1158         16  PI-COMP-GROUPING            PIC X(6).
  1159         16  PI-ACCT-AGENT-PROCESSED-SW  PIC X.
  1160             88  PI-ACCT-AGENT-PROCESSED     VALUE 'Y'.
  1161         16  PI-CLEAR-ERROR-SW           PIC X.
  1162             88  PI-CLEAR-ERROR              VALUE 'Y'.
  1163         16  PI-AGE-KEYED-SW             PIC X.
  1164             88  PI-AGE-KEYED                VALUE 'Y'.
  1165         16  PI-BIRTHDT-KEYED-SW         PIC X.
  1166             88  PI-BIRTHDT-KEYED            VALUE 'Y'.
  1167         16  PI-RECEIVED-DT              PIC XX.
  1168         16  PI-CSR-ID                   PIC X(4).
  1169
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL630.cbl
  1171          16  FILLER              PIC X(390).
  1172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL630.cbl
  1174*    COPY ELCAID.
  1175******************************************************************
  1176*                                                                *
  1177*                            ELCAID.                             *
  1178*                            VMOD=2.001                          *
  1179*                                                                *
  1180*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1181*                                                                *
  1182*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1183*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1184******************************************************************
  1185
  1186 01  DFHAID.
  1187   02  DFHNULL   PIC  X  VALUE  ' '.
  1188   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1189   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1190   02  DFHPEN    PIC  X  VALUE  '='.
  1191   02  DFHOPID   PIC  X  VALUE  'W'.
  1192   02  DFHPA1    PIC  X  VALUE  '%'.
  1193   02  DFHPA2    PIC  X  VALUE  '>'.
  1194   02  DFHPA3    PIC  X  VALUE  ','.
  1195   02  DFHPF1    PIC  X  VALUE  '1'.
  1196   02  DFHPF2    PIC  X  VALUE  '2'.
  1197   02  DFHPF3    PIC  X  VALUE  '3'.
  1198   02  DFHPF4    PIC  X  VALUE  '4'.
  1199   02  DFHPF5    PIC  X  VALUE  '5'.
  1200   02  DFHPF6    PIC  X  VALUE  '6'.
  1201   02  DFHPF7    PIC  X  VALUE  '7'.
  1202   02  DFHPF8    PIC  X  VALUE  '8'.
  1203   02  DFHPF9    PIC  X  VALUE  '9'.
  1204   02  DFHPF10   PIC  X  VALUE  ':'.
  1205   02  DFHPF11   PIC  X  VALUE  '#'.
  1206   02  DFHPF12   PIC  X  VALUE  '@'.
  1207   02  DFHPF13   PIC  X  VALUE  'A'.
  1208   02  DFHPF14   PIC  X  VALUE  'B'.
  1209   02  DFHPF15   PIC  X  VALUE  'C'.
  1210   02  DFHPF16   PIC  X  VALUE  'D'.
  1211   02  DFHPF17   PIC  X  VALUE  'E'.
  1212   02  DFHPF18   PIC  X  VALUE  'F'.
  1213   02  DFHPF19   PIC  X  VALUE  'G'.
  1214   02  DFHPF20   PIC  X  VALUE  'H'.
  1215   02  DFHPF21   PIC  X  VALUE  'I'.
  1216*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1217   02  DFHPF22   PIC  X  VALUE  '['.
  1218   02  DFHPF23   PIC  X  VALUE  '.'.
  1219   02  DFHPF24   PIC  X  VALUE  '<'.
  1220   02  DFHMSRE   PIC  X  VALUE  'X'.
  1221   02  DFHSTRF   PIC  X  VALUE  'h'.
  1222   02  DFHTRIG   PIC  X  VALUE  '"'.
  1223 01  FILLER    REDEFINES DFHAID.
  1224     12  FILLER              PIC X(8).
  1225     12  PF-VALUES           PIC X       OCCURS 2.
  1226     12  FILLER              PIC X(25).
  1227
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL630.cbl
  1229*    COPY EL630S.
  1230 01  EL630AI.
  1231     05  FILLER            PIC  X(0012).
  1232*    -------------------------------
  1233     05  DATEL PIC S9(0004) COMP.
  1234     05  DATEF PIC  X(0001).
  1235     05  FILLER REDEFINES DATEF.
  1236         10  DATEA PIC  X(0001).
  1237     05  DATEI PIC  X(0008).
  1238*    -------------------------------
  1239     05  TIMEL PIC S9(0004) COMP.
  1240     05  TIMEF PIC  X(0001).
  1241     05  FILLER REDEFINES TIMEF.
  1242         10  TIMEA PIC  X(0001).
  1243     05  TIMEI PIC  X(0005).
  1244*    -------------------------------
  1245     05  MAINTL PIC S9(0004) COMP.
  1246     05  MAINTF PIC  X(0001).
  1247     05  FILLER REDEFINES MAINTF.
  1248         10  MAINTA PIC  X(0001).
  1249     05  MAINTI PIC  X(0001).
  1250*    -------------------------------
  1251     05  REFHDGL PIC S9(0004) COMP.
  1252     05  REFHDGF PIC  X(0001).
  1253     05  FILLER REDEFINES REFHDGF.
  1254         10  REFHDGA PIC  X(0001).
  1255     05  REFHDGI PIC  X(0015).
  1256*    -------------------------------
  1257     05  CARRHDGL PIC S9(0004) COMP.
  1258     05  CARRHDGF PIC  X(0001).
  1259     05  FILLER REDEFINES CARRHDGF.
  1260         10  CARRHDGA PIC  X(0001).
  1261     05  CARRHDGI PIC  X(0007).
  1262*    -------------------------------
  1263     05  GRPHDGL PIC S9(0004) COMP.
  1264     05  GRPHDGF PIC  X(0001).
  1265     05  FILLER REDEFINES GRPHDGF.
  1266         10  GRPHDGA PIC  X(0001).
  1267     05  GRPHDGI PIC  X(0008).
  1268*    -------------------------------
  1269     05  STHDGL PIC S9(0004) COMP.
  1270     05  STHDGF PIC  X(0001).
  1271     05  FILLER REDEFINES STHDGF.
  1272         10  STHDGA PIC  X(0001).
  1273     05  STHDGI PIC  X(0005).
  1274*    -------------------------------
  1275     05  BATCHL PIC S9(0004) COMP.
  1276     05  BATCHF PIC  X(0001).
  1277     05  FILLER REDEFINES BATCHF.
  1278         10  BATCHA PIC  X(0001).
  1279     05  BATCHI PIC  X(0006).
  1280*    -------------------------------
  1281     05  REFL PIC S9(0004) COMP.
  1282     05  REFF PIC  X(0001).
  1283     05  FILLER REDEFINES REFF.
  1284         10  REFA PIC  X(0001).
  1285     05  REFI PIC  X(0012).
  1286*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL630.cbl
  1287     05  CARRIERL PIC S9(0004) COMP.
  1288     05  CARRIERF PIC  X(0001).
  1289     05  FILLER REDEFINES CARRIERF.
  1290         10  CARRIERA PIC  X(0001).
  1291     05  CARRIERI PIC  X(0001).
  1292*    -------------------------------
  1293     05  GROUPL PIC S9(0004) COMP.
  1294     05  GROUPF PIC  X(0001).
  1295     05  FILLER REDEFINES GROUPF.
  1296         10  GROUPA PIC  X(0001).
  1297     05  GROUPI PIC  X(0006).
  1298*    -------------------------------
  1299     05  STATEL PIC S9(0004) COMP.
  1300     05  STATEF PIC  X(0001).
  1301     05  FILLER REDEFINES STATEF.
  1302         10  STATEA PIC  X(0001).
  1303     05  STATEI PIC  X(0002).
  1304*    -------------------------------
  1305     05  ACCOUNTL PIC S9(0004) COMP.
  1306     05  ACCOUNTF PIC  X(0001).
  1307     05  FILLER REDEFINES ACCOUNTF.
  1308         10  ACCOUNTA PIC  X(0001).
  1309     05  ACCOUNTI PIC  X(0010).
  1310*    -------------------------------
  1311     05  LFPHDGL PIC S9(0004) COMP.
  1312     05  LFPHDGF PIC  X(0001).
  1313     05  FILLER REDEFINES LFPHDGF.
  1314         10  LFPHDGA PIC  X(0001).
  1315     05  LFPHDGI PIC  X(0010).
  1316*    -------------------------------
  1317     05  AHPHDGL PIC S9(0004) COMP.
  1318     05  AHPHDGF PIC  X(0001).
  1319     05  FILLER REDEFINES AHPHDGF.
  1320         10  AHPHDGA PIC  X(0001).
  1321     05  AHPHDGI PIC  X(0010).
  1322*    -------------------------------
  1323     05  LFRHDGL PIC S9(0004) COMP.
  1324     05  LFRHDGF PIC  X(0001).
  1325     05  FILLER REDEFINES LFRHDGF.
  1326         10  LFRHDGA PIC  X(0001).
  1327     05  LFRHDGI PIC  X(0009).
  1328*    -------------------------------
  1329     05  AHRHDGL PIC S9(0004) COMP.
  1330     05  AHRHDGF PIC  X(0001).
  1331     05  FILLER REDEFINES AHRHDGF.
  1332         10  AHRHDGA PIC  X(0001).
  1333     05  AHRHDGI PIC  X(0009).
  1334*    -------------------------------
  1335     05  EISSCNTL PIC S9(0004) COMP.
  1336     05  EISSCNTF PIC  X(0001).
  1337     05  FILLER REDEFINES EISSCNTF.
  1338         10  EISSCNTA PIC  X(0001).
  1339     05  EISSCNTI PIC  S9(6).
  1340*    -------------------------------
  1341     05  ELFISSL PIC S9(0004) COMP.
  1342     05  ELFISSF PIC  X(0001).
  1343     05  FILLER REDEFINES ELFISSF.
  1344         10  ELFISSA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL630.cbl
  1345     05  ELFISSI PIC  S9(10)V9(2).
  1346*    -------------------------------
  1347     05  EAHISSL PIC S9(0004) COMP.
  1348     05  EAHISSF PIC  X(0001).
  1349     05  FILLER REDEFINES EAHISSF.
  1350         10  EAHISSA PIC  X(0001).
  1351     05  EAHISSI PIC  S9(10)V9(2).
  1352*    -------------------------------
  1353     05  ECANCNTL PIC S9(0004) COMP.
  1354     05  ECANCNTF PIC  X(0001).
  1355     05  FILLER REDEFINES ECANCNTF.
  1356         10  ECANCNTA PIC  X(0001).
  1357     05  ECANCNTI PIC  S9(6).
  1358*    -------------------------------
  1359     05  ELFCANL PIC S9(0004) COMP.
  1360     05  ELFCANF PIC  X(0001).
  1361     05  FILLER REDEFINES ELFCANF.
  1362         10  ELFCANA PIC  X(0001).
  1363     05  ELFCANI PIC  S9(8)V9(2).
  1364*    -------------------------------
  1365     05  EAHCANL PIC S9(0004) COMP.
  1366     05  EAHCANF PIC  X(0001).
  1367     05  FILLER REDEFINES EAHCANF.
  1368         10  EAHCANA PIC  X(0001).
  1369     05  EAHCANI PIC  S9(8)V9(2).
  1370*    -------------------------------
  1371     05  AISSCNTL PIC S9(0004) COMP.
  1372     05  AISSCNTF PIC  X(0001).
  1373     05  FILLER REDEFINES AISSCNTF.
  1374         10  AISSCNTA PIC  X(0001).
  1375     05  AISSCNTI PIC  S9(6).
  1376*    -------------------------------
  1377     05  ALFISSL PIC S9(0004) COMP.
  1378     05  ALFISSF PIC  X(0001).
  1379     05  FILLER REDEFINES ALFISSF.
  1380         10  ALFISSA PIC  X(0001).
  1381     05  ALFISSI PIC  S9(10)V9(2).
  1382*    -------------------------------
  1383     05  AAHISSL PIC S9(0004) COMP.
  1384     05  AAHISSF PIC  X(0001).
  1385     05  FILLER REDEFINES AAHISSF.
  1386         10  AAHISSA PIC  X(0001).
  1387     05  AAHISSI PIC  S9(10)V9(2).
  1388*    -------------------------------
  1389     05  ACANCNTL PIC S9(0004) COMP.
  1390     05  ACANCNTF PIC  X(0001).
  1391     05  FILLER REDEFINES ACANCNTF.
  1392         10  ACANCNTA PIC  X(0001).
  1393     05  ACANCNTI PIC  S9(6).
  1394*    -------------------------------
  1395     05  ALFCANL PIC S9(0004) COMP.
  1396     05  ALFCANF PIC  X(0001).
  1397     05  FILLER REDEFINES ALFCANF.
  1398         10  ALFCANA PIC  X(0001).
  1399     05  ALFCANI PIC  S9(8)V9(2).
  1400*    -------------------------------
  1401     05  AAHCANL PIC S9(0004) COMP.
  1402     05  AAHCANF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL630.cbl
  1403     05  FILLER REDEFINES AAHCANF.
  1404         10  AAHCANA PIC  X(0001).
  1405     05  AAHCANI PIC  S9(8)V9(2).
  1406*    -------------------------------
  1407     05  OISSCNTL PIC S9(0004) COMP.
  1408     05  OISSCNTF PIC  X(0001).
  1409     05  FILLER REDEFINES OISSCNTF.
  1410         10  OISSCNTA PIC  X(0001).
  1411     05  OISSCNTI PIC  S9(6).
  1412*    -------------------------------
  1413     05  OLFISSL PIC S9(0004) COMP.
  1414     05  OLFISSF PIC  X(0001).
  1415     05  FILLER REDEFINES OLFISSF.
  1416         10  OLFISSA PIC  X(0001).
  1417     05  OLFISSI PIC  S9(10)V9(2).
  1418*    -------------------------------
  1419     05  OAHISSL PIC S9(0004) COMP.
  1420     05  OAHISSF PIC  X(0001).
  1421     05  FILLER REDEFINES OAHISSF.
  1422         10  OAHISSA PIC  X(0001).
  1423     05  OAHISSI PIC  S9(10)V9(2).
  1424*    -------------------------------
  1425     05  OCANCNTL PIC S9(0004) COMP.
  1426     05  OCANCNTF PIC  X(0001).
  1427     05  FILLER REDEFINES OCANCNTF.
  1428         10  OCANCNTA PIC  X(0001).
  1429     05  OCANCNTI PIC  S9(6).
  1430*    -------------------------------
  1431     05  OLFCANL PIC S9(0004) COMP.
  1432     05  OLFCANF PIC  X(0001).
  1433     05  FILLER REDEFINES OLFCANF.
  1434         10  OLFCANA PIC  X(0001).
  1435     05  OLFCANI PIC  S9(8)V9(2).
  1436*    -------------------------------
  1437     05  OAHCANL PIC S9(0004) COMP.
  1438     05  OAHCANF PIC  X(0001).
  1439     05  FILLER REDEFINES OAHCANF.
  1440         10  OAHCANA PIC  X(0001).
  1441     05  OAHCANI PIC  S9(8)V9(2).
  1442*    -------------------------------
  1443     05  RECEVDTL PIC S9(0004) COMP.
  1444     05  RECEVDTF PIC  X(0001).
  1445     05  FILLER REDEFINES RECEVDTF.
  1446         10  RECEVDTA PIC  X(0001).
  1447     05  RECEVDTI PIC  X(0008).
  1448*    -------------------------------
  1449     05  MNTHNDTL PIC S9(0004) COMP.
  1450     05  MNTHNDTF PIC  X(0001).
  1451     05  FILLER REDEFINES MNTHNDTF.
  1452         10  MNTHNDTA PIC  X(0001).
  1453     05  MNTHNDTI PIC  X(0008).
  1454*    -------------------------------
  1455     05  ERRMSG1L PIC S9(0004) COMP.
  1456     05  ERRMSG1F PIC  X(0001).
  1457     05  FILLER REDEFINES ERRMSG1F.
  1458         10  ERRMSG1A PIC  X(0001).
  1459     05  ERRMSG1I PIC  X(0076).
  1460*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL630.cbl
  1461     05  ERRMSG2L PIC S9(0004) COMP.
  1462     05  ERRMSG2F PIC  X(0001).
  1463     05  FILLER REDEFINES ERRMSG2F.
  1464         10  ERRMSG2A PIC  X(0001).
  1465     05  ERRMSG2I PIC  X(0076).
  1466*    -------------------------------
  1467     05  PFENTERL PIC S9(0004) COMP.
  1468     05  PFENTERF PIC  X(0001).
  1469     05  FILLER REDEFINES PFENTERF.
  1470         10  PFENTERA PIC  X(0001).
  1471     05  PFENTERI PIC  9(2).
  1472*    -------------------------------
  1473     05  PF5L PIC S9(0004) COMP.
  1474     05  PF5F PIC  X(0001).
  1475     05  FILLER REDEFINES PF5F.
  1476         10  PF5A PIC  X(0001).
  1477     05  PF5I PIC  X(0015).
  1478 01  EL630AO REDEFINES EL630AI.
  1479     05  FILLER            PIC  X(0012).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  DATEO PIC  X(0008).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  TIMEO PIC  99.99.
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  MAINTO PIC  X(0001).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  REFHDGO PIC  X(0015).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  CARRHDGO PIC  X(0007).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  GRPHDGO PIC  X(0008).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  STHDGO PIC  X(0005).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  BATCHO PIC  X(0006).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  REFO PIC  X(0012).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  CARRIERO PIC  X(0001).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  GROUPO PIC  X(0006).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  STATEO PIC  X(0002).
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  ACCOUNTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL630.cbl
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  LFPHDGO PIC  X(0010).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  AHPHDGO PIC  X(0010).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  LFRHDGO PIC  X(0009).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  AHRHDGO PIC  X(0009).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  EISSCNTO PIC  Z(5)-.
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  ELFISSO PIC  Z(8).99-.
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  EAHISSO PIC  Z(8).99-.
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  ECANCNTO PIC  Z(5)-.
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  ELFCANO PIC  Z(6).99-.
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
  1548     05  EAHCANO PIC  Z(6).99-.
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  AISSCNTO PIC  Z(5)-.
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  ALFISSO PIC  Z(8).99-.
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  AAHISSO PIC  Z(8).99-.
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  ACANCNTO PIC  Z(5)-.
  1561*    -------------------------------
  1562     05  FILLER            PIC  X(0003).
  1563     05  ALFCANO PIC  Z(6).99-.
  1564*    -------------------------------
  1565     05  FILLER            PIC  X(0003).
  1566     05  AAHCANO PIC  Z(6).99-.
  1567*    -------------------------------
  1568     05  FILLER            PIC  X(0003).
  1569     05  OISSCNTO PIC  Z(5)-.
  1570*    -------------------------------
  1571     05  FILLER            PIC  X(0003).
  1572     05  OLFISSO PIC  Z(8).99-.
  1573*    -------------------------------
  1574     05  FILLER            PIC  X(0003).
  1575     05  OAHISSO PIC  Z(8).99-.
  1576*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL630.cbl
  1577     05  FILLER            PIC  X(0003).
  1578     05  OCANCNTO PIC  Z(5)-.
  1579*    -------------------------------
  1580     05  FILLER            PIC  X(0003).
  1581     05  OLFCANO PIC  Z(6).99-.
  1582*    -------------------------------
  1583     05  FILLER            PIC  X(0003).
  1584     05  OAHCANO PIC  Z(6).99-.
  1585*    -------------------------------
  1586     05  FILLER            PIC  X(0003).
  1587     05  RECEVDTO PIC  X(0008).
  1588*    -------------------------------
  1589     05  FILLER            PIC  X(0003).
  1590     05  MNTHNDTO PIC  X(0008).
  1591*    -------------------------------
  1592     05  FILLER            PIC  X(0003).
  1593     05  ERRMSG1O PIC  X(0076).
  1594*    -------------------------------
  1595     05  FILLER            PIC  X(0003).
  1596     05  ERRMSG2O PIC  X(0076).
  1597*    -------------------------------
  1598     05  FILLER            PIC  X(0003).
  1599     05  PFENTERO PIC  X(0002).
  1600*    -------------------------------
  1601     05  FILLER            PIC  X(0003).
  1602     05  PF5O PIC  X(0015).
  1603*    -------------------------------
  1604
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL630.cbl
  1606****************************************************************
  1607*
  1608* Copyright (c) 2007 by Clerity Solutions, Inc.
  1609* All rights reserved.
  1610*
  1611****************************************************************
  1612 01  DFHEIV.
  1613   02  DFHEIV0               PIC X(35).
  1614   02  DFHEIV1               PIC X(08).
  1615   02  DFHEIV2               PIC X(08).
  1616   02  DFHEIV3               PIC X(08).
  1617   02  DFHEIV4               PIC X(06).
  1618   02  DFHEIV5               PIC X(04).
  1619   02  DFHEIV6               PIC X(04).
  1620   02  DFHEIV7               PIC X(02).
  1621   02  DFHEIV8               PIC X(02).
  1622   02  DFHEIV9               PIC X(01).
  1623   02  DFHEIV10              PIC S9(7) COMP-3.
  1624   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1625   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1626   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1627   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1628   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1629   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1630   02  DFHEIV17              PIC X(04).
  1631   02  DFHEIV18              PIC X(04).
  1632   02  DFHEIV19              PIC X(04).
  1633   02  DFHEIV20              USAGE IS POINTER.
  1634   02  DFHEIV21              USAGE IS POINTER.
  1635   02  DFHEIV22              USAGE IS POINTER.
  1636   02  DFHEIV23              USAGE IS POINTER.
  1637   02  DFHEIV24              USAGE IS POINTER.
  1638   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1639   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1640   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1641   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1642   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1643   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1644   02  FILLER                PIC X(02).
  1645   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1646   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1647   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1648   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1649   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1650 LINKAGE  SECTION.
  1651*****************************************************************
  1652*                                                               *
  1653* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1654* All rights reserved.                                          *
  1655*                                                               *
  1656*****************************************************************
  1657 01  dfheiblk.
  1658     02  eibtime          pic s9(7) comp-3.
  1659     02  eibdate          pic s9(7) comp-3.
  1660     02  eibtrnid         pic x(4).
  1661     02  eibtaskn         pic s9(7) comp-3.
  1662     02  eibtrmid         pic x(4).
  1663     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL630.cbl
  1664     02  eibcposn         pic s9(4) comp.
  1665     02  eibcalen         pic s9(4) comp.
  1666     02  eibaid           pic x(1).
  1667     02  eibfiller1       pic x(1).
  1668     02  eibfn            pic x(2).
  1669     02  eibfiller2       pic x(2).
  1670     02  eibrcode         pic x(6).
  1671     02  eibfiller3       pic x(2).
  1672     02  eibds            pic x(8).
  1673     02  eibreqid         pic x(8).
  1674     02  eibrsrce         pic x(8).
  1675     02  eibsync          pic x(1).
  1676     02  eibfree          pic x(1).
  1677     02  eibrecv          pic x(1).
  1678     02  eibsend          pic x(1).
  1679     02  eibatt           pic x(1).
  1680     02  eibeoc           pic x(1).
  1681     02  eibfmh           pic x(1).
  1682     02  eibcompl         pic x(1).
  1683     02  eibsig           pic x(1).
  1684     02  eibconf          pic x(1).
  1685     02  eiberr           pic x(1).
  1686     02  eibrldbk         pic x(1).
  1687     02  eiberrcd         pic x(4).
  1688     02  eibsynrb         pic x(1).
  1689     02  eibnodat         pic x(1).
  1690     02  eibfiller5       pic x(2).
  1691     02  eibresp          pic 9(09) comp.
  1692     02  eibresp2         pic 9(09) comp.
  1693     02  dfheigdj         pic s9(4) comp.
  1694     02  dfheigdk         pic s9(4) comp.
  1695 01  DFHCOMMAREA             PIC X(1900).
  1696
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL630.cbl
  1698
  1699*    COPY ELCCNTL.
  1700******************************************************************
  1701*                                                                *
  1702*                                                                *
  1703*                            ELCCNTL.                            *
  1704*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1705*                            VMOD=2.059                          *
  1706*                                                                *
  1707*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1708*                                                                *
  1709*   FILE TYPE = VSAM,KSDS                                        *
  1710*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1711*                                                                *
  1712*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1713*       ALTERNATE INDEX = NONE                                   *
  1714*                                                                *
  1715*   LOG = YES                                                    *
  1716*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1717******************************************************************
  1718*                   C H A N G E   L O G
  1719*
  1720* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1721*-----------------------------------------------------------------
  1722*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1723* EFFECTIVE    NUMBER
  1724*-----------------------------------------------------------------
  1725* 082503                   PEMA  ADD BENEFIT GROUP
  1726* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1727* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1728* 092705    2005050300006  PEMA  ADD SPP LEASES
  1729* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1730* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1731* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1732* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1733******************************************************************
  1734*
  1735 01  CONTROL-FILE.
  1736     12  CF-RECORD-ID                       PIC XX.
  1737         88  VALID-CF-ID                        VALUE 'CF'.
  1738
  1739     12  CF-CONTROL-PRIMARY.
  1740         16  CF-COMPANY-ID                  PIC XXX.
  1741         16  CF-RECORD-TYPE                 PIC X.
  1742             88  CF-COMPANY-MASTER              VALUE '1'.
  1743             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1744             88  CF-STATE-MASTER                VALUE '3'.
  1745             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1746             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1747             88  CF-CARRIER-MASTER              VALUE '6'.
  1748             88  CF-MORTALITY-MASTER            VALUE '7'.
  1749             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1750             88  CF-TERMINAL-MASTER             VALUE '9'.
  1751             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1752             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1753             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1754             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1755             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL630.cbl
  1756             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1757             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1758             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1759             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1760         16  CF-ACCESS-CD-GENL              PIC X(4).
  1761         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1762             20  CF-PROCESSOR               PIC X(4).
  1763         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1764             20  CF-STATE-CODE              PIC XX.
  1765             20  FILLER                     PIC XX.
  1766         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1767             20  FILLER                     PIC XX.
  1768             20  CF-HI-BEN-IN-REC           PIC XX.
  1769         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1770             20  FILLER                     PIC XXX.
  1771             20  CF-CARRIER-CNTL            PIC X.
  1772         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1773             20  FILLER                     PIC XX.
  1774             20  CF-HI-TYPE-IN-REC          PIC 99.
  1775         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1776             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1777                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1778             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1779             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1780         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1781             20  FILLER                     PIC X.
  1782             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1783         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1784             20  FILLER                     PIC XX.
  1785             20  CF-MORTGAGE-PLAN           PIC XX.
  1786         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1787
  1788     12  CF-LAST-MAINT-DT                   PIC XX.
  1789     12  CF-LAST-MAINT-BY                   PIC X(4).
  1790     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1791
  1792     12  CF-RECORD-BODY                     PIC X(728).
  1793
  1794
  1795****************************************************************
  1796*             COMPANY MASTER RECORD                            *
  1797****************************************************************
  1798
  1799     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1800         16  CF-COMPANY-ADDRESS.
  1801             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1802             20  CF-CL-IN-CARE-OF           PIC X(30).
  1803             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1804             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1805             20  CF-CL-CITY-STATE           PIC X(30).
  1806             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1807             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1808         16  CF-COMPANY-CD                  PIC X.
  1809         16  CF-COMPANY-PASSWORD            PIC X(8).
  1810         16  CF-SECURITY-OPTION             PIC X.
  1811             88  ALL-SECURITY                   VALUE '1'.
  1812             88  COMPANY-VERIFY                 VALUE '2'.
  1813             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL630.cbl
  1814             88  NO-SECURITY                    VALUE '4'.
  1815             88  ALL-BUT-TERM                   VALUE '5'.
  1816         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1817             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1818         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1819             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1820         16  CF-INFORCE-LOCATION            PIC X.
  1821             88  CERTS-ARE-ONLINE               VALUE '1'.
  1822             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1823             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1824         16  CF-LOWER-CASE-LETTERS          PIC X.
  1825         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1826             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1827             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1828             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1829             88  CF-ACCNT-CNTL                  VALUE '3'.
  1830             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1831
  1832         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1833         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1834
  1835         16  CF-LGX-CREDIT-USER             PIC X.
  1836             88  CO-IS-NOT-USER                 VALUE 'N'.
  1837             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1838
  1839         16 CF-CREDIT-CALC-CODES.
  1840             20  CF-CR-REM-TERM-CALC PIC X.
  1841               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1842               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1843               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1844               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1845               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1846               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1847               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1848             20  CF-CR-R78-METHOD           PIC X.
  1849               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1850               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1851
  1852         16  CF-CLAIM-CONTROL-COUNTS.
  1853             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1854                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1855
  1856             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1857                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1858
  1859             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1860                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1861
  1862             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1863                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1864
  1865         16  CF-CURRENT-MONTH-END           PIC XX.
  1866
  1867         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1868             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1869             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1870             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1871             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL630.cbl
  1872                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1873                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1874             20  CF-CO-PREM-REJECT-SW       PIC X.
  1875                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1876                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1877             20  CF-CO-REF-REJECT-SW        PIC X.
  1878                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1879                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1880
  1881         16  CF-CO-REPORTING-DT             PIC XX.
  1882         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1883         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1884           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1885           88  CF-CO-MONTH-END                  VALUE '1'.
  1886
  1887         16  CF-LGX-CLAIM-USER              PIC X.
  1888             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1889             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1890
  1891         16  CF-CREDIT-EDIT-CONTROLS.
  1892             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1893             20  CF-MIN-AGE                 PIC 99.
  1894             20  CF-DEFAULT-AGE             PIC 99.
  1895             20  CF-MIN-TERM                PIC S999      COMP-3.
  1896             20  CF-MAX-TERM                PIC S999      COMP-3.
  1897             20  CF-DEFAULT-SEX             PIC X.
  1898             20  CF-JOINT-AGE-INPUT         PIC X.
  1899                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1900             20  CF-BIRTH-DATE-INPUT        PIC X.
  1901                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1902             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1903                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1904                 88  CF-ZERO-CARRIER            VALUE '1'.
  1905                 88  CF-ZERO-GROUPING           VALUE '2'.
  1906                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1907             20  CF-EDIT-SW                 PIC X.
  1908                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1909             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1910             20  CF-CR-PR-METHOD            PIC X.
  1911               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1912               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1913             20  FILLER                     PIC X.
  1914
  1915         16  CF-CREDIT-MISC-CONTROLS.
  1916             20  CF-REIN-TABLE-SW           PIC X.
  1917                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1918             20  CF-COMP-TABLE-SW           PIC X.
  1919                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1920             20  CF-EXPERIENCE-RETENTION-AGE
  1921                                            PIC S9        COMP-3.
  1922             20  CF-CONVERSION-DT           PIC XX.
  1923             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1924             20  CF-RUN-FREQUENCY-SW        PIC X.
  1925                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1926                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1927
  1928             20  CF-CR-CHECK-NO-CONTROL.
  1929                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL630.cbl
  1930                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1931                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1932                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1933                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1934                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1935
  1936                 24  CF-CR-CHECK-COUNT       REDEFINES
  1937                     CF-CR-CHECK-COUNTER      PIC X(4).
  1938
  1939                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1940                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1941
  1942                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1943                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1944                 24  CF-MAIL-PROCESSING       PIC X.
  1945                     88  MAIL-PROCESSING          VALUE 'Y'.
  1946
  1947         16  CF-MISC-SYSTEM-CONTROL.
  1948             20  CF-SYSTEM-C                 PIC X.
  1949                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1950             20  CF-SYSTEM-D                 PIC X.
  1951                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1952             20  CF-SOC-SEC-NO-SW            PIC X.
  1953                 88  SOC-SEC-NO-USED             VALUE '1'.
  1954             20  CF-MEMBER-NO-SW             PIC X.
  1955                 88  MEMBER-NO-USED              VALUE '1'.
  1956             20  CF-TAX-ID-NUMBER            PIC X(11).
  1957             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1958             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1959                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1960                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1961                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1962                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1963             20  CF-SYSTEM-E                 PIC X.
  1964                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1965
  1966         16  CF-LGX-LIFE-USER               PIC X.
  1967             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1968             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1969
  1970         16  CF-CR-MONTH-END-DT             PIC XX.
  1971
  1972         16  CF-FILE-MAINT-DATES.
  1973             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1974                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1975             20  CF-LAST-BATCH       REDEFINES
  1976                 CF-LAST-BATCH-NO               PIC X(4).
  1977             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1978             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1979             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1980             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1981             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1982             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1983             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1984             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1985             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1986             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1987
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL630.cbl
  1988         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1989         16  FILLER                         PIC X.
  1990
  1991         16  CF-ALT-MORT-CODE               PIC X(4).
  1992         16  CF-MEMBER-CAPTION              PIC X(10).
  1993
  1994         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1995             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1996             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1997             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1998             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1999             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2000
  2001         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2002
  2003         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2004         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2005         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2006         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2007
  2008         16  CF-AH-OVERRIDE-L1              PIC X.
  2009         16  CF-AH-OVERRIDE-L2              PIC XX.
  2010         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2011         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2012
  2013         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2014         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2015
  2016         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2017         16  CF-AR-LAST-EL860-DT            PIC XX.
  2018         16  CF-MP-MONTH-END-DT             PIC XX.
  2019
  2020         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2021         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2022             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2023
  2024         16  CF-AR-MONTH-END-DT             PIC XX.
  2025
  2026         16  CF-CRDTCRD-USER                PIC X.
  2027             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2028             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2029
  2030         16  CF-CC-MONTH-END-DT             PIC XX.
  2031
  2032         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2033
  2034         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2035             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2036             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2037             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2038         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2039         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2040         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2041         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2042             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2043             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2044         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2045         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL630.cbl
  2046         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2047             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2048         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2049
  2050         16  CF-CL-ZIP-CODE.
  2051             20  CF-CL-ZIP-PRIME.
  2052                 24  CF-CL-ZIP-1ST          PIC X.
  2053                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2054                 24  FILLER                 PIC X(4).
  2055             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2056         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2057             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2058             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2059             20  FILLER                     PIC XXX.
  2060
  2061         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2062         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2063         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2064         16  CF-CO-OPTION-START-DATE        PIC XX.
  2065         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2066           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2067                                                      '3' '4'.
  2068           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2069           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2070           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2071           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2072           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2073           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2074
  2075         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2076
  2077         16  CF-PAYMENT-APPROVAL-LEVELS.
  2078             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2079             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2080             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2081             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2082             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2083             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2084
  2085         16  CF-END-USER-REPORTING-USER     PIC X.
  2086             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2087             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2088
  2089         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2090             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2091             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2092
  2093         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2094
  2095         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2096         16  FILLER                         PIC X.
  2097
  2098         16  CF-CREDIT-ARCHIVE-CNTL.
  2099             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2100             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2101             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2102
  2103         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL630.cbl
  2104
  2105         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2106             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2107             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2108
  2109         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2110             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2111             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2112
  2113         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2114
  2115         16  CF-CO-ACH-ID-CODE              PIC  X.
  2116             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2117             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2118             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2119         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2120         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2121         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2122         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2123         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2124         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2125         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2126         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2127         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2128                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2129         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2130                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2131
  2132         16  CF-CO-OVER-SHORT.
  2133             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2134             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2135
  2136*         16  FILLER                         PIC X(102).
  2137         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2138             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2139             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2140
  2141         16  CF-AH-APPROVAL-DAYS.
  2142             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2143             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2144             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2145             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2146
  2147         16  FILLER                         PIC X(82).
  2148****************************************************************
  2149*             PROCESSOR/USER RECORD                            *
  2150****************************************************************
  2151
  2152     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2153         16  CF-PROCESSOR-NAME              PIC X(30).
  2154         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2155         16  CF-PROCESSOR-TITLE             PIC X(26).
  2156         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2157                 88  MESSAGE-YES                VALUE 'Y'.
  2158                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2159
  2160*****************************************************
  2161****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL630.cbl
  2162****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2163****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2164****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2165*****************************************************
  2166
  2167         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2168             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2169             20  CF-APPLICATION-FORCE       PIC X.
  2170             20  CF-INDIVIDUAL-APP.
  2171                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2172                     28  CF-BROWSE-APP      PIC X.
  2173                     28  CF-UPDATE-APP      PIC X.
  2174
  2175         16  CF-CURRENT-TERM-ON             PIC X(4).
  2176         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2177             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2178             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2179             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2180             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2181             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2182             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2183             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2184         16  CF-PROCESSOR-CARRIER           PIC X.
  2185             88  NO-CARRIER-SECURITY            VALUE ' '.
  2186         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2187             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2188         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2189             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2190         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2191             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2192
  2193         16  CF-PROC-SYS-ACCESS-SW.
  2194             20  CF-PROC-CREDIT-CLAIMS-SW.
  2195                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2196                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2197                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2198                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2199             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2200                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2201                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2202             20  CF-PROC-LIFE-GNRLDGR-SW.
  2203                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2204                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2205                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2206                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2207             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2208                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2209                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2210         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2211             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2212             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2213         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2214
  2215         16  CF-APPROVAL-LEVEL                  PIC X.
  2216             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2217             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2218             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2219             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL630.cbl
  2220
  2221         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2222
  2223         16  CF-LANGUAGE-TYPE                   PIC X.
  2224             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2225             88  CF-LANG-IS-FR                      VALUE 'F'.
  2226         16  FILLER                             PIC  X(240).
  2227
  2228****************************************************************
  2229*             PROCESSOR/REMINDERS RECORD                       *
  2230****************************************************************
  2231
  2232     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2233         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2234             20  CF-START-REMIND-DT         PIC XX.
  2235             20  CF-END-REMIND-DT           PIC XX.
  2236             20  CF-REMINDER-TEXT           PIC X(50).
  2237         16  FILLER                         PIC X(296).
  2238
  2239
  2240****************************************************************
  2241*             STATE MASTER RECORD                              *
  2242****************************************************************
  2243
  2244     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2245         16  CF-STATE-ABBREVIATION          PIC XX.
  2246         16  CF-STATE-NAME                  PIC X(25).
  2247         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2248         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2249             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2250             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2251             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2252             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2253                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2254                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2255             20  CF-ST-PREM-REJECT-SW       PIC X.
  2256                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2257                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2258             20  CF-ST-REF-REJECT-SW        PIC X.
  2259                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2260                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2261         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2262         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2263         16  CF-ST-REFUND-RULES.
  2264             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2265             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2266             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2267         16  CF-ST-FST-PMT-EXTENSION.
  2268             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2269             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2270                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2271                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2272                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2273                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2274         16  CF-ST-STATE-CALL.
  2275             20  CF-ST-CALL-UNEARNED        PIC X.
  2276             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2277             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL630.cbl
  2278         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2279             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2280             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2281         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2282         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2283         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2284         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2285         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2286         16  FILLER                         PIC X.
  2287         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2288             20  CF-ST-BENEFIT-CD           PIC XX.
  2289             20  CF-ST-BENEFIT-KIND         PIC X.
  2290                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2291                 88  CF-ST-AH-KIND              VALUE 'A'.
  2292             20  CF-ST-REM-TERM-CALC        PIC X.
  2293                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2294                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2295                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2296                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2297                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2298                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2299                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2300                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2301
  2302             20  CF-ST-REFUND-CALC          PIC X.
  2303                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2304                 88  ST-REFD-BY-R78             VALUE '1'.
  2305                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2306                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2307                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2308                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2309                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2310                 88  ST-REFD-UTAH               VALUE '7'.
  2311                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2312                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2313                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2314
  2315             20  CF-ST-EARNING-CALC         PIC X.
  2316                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2317                 88  ST-EARN-BY-R78             VALUE '1'.
  2318                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2319                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2320                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2321                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2322                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2323                 88  ST-EARN-MEAN               VALUE '8'.
  2324                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2325
  2326             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2327                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2328                 88  ST-OVRD-BY-R78             VALUE '1'.
  2329                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2330                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2331                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2332                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2333                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2334                 88  ST-OVRD-MEAN               VALUE '8'.
  2335                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL630.cbl
  2336             20  FILLER                     PIC X.
  2337
  2338         16  CF-ST-COMMISSION-CAPS.
  2339             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2340             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2341             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2342             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2343         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2344                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2345
  2346         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2347
  2348         16  CF-ST-STATUTORY-INTEREST.
  2349             20  CF-ST-STAT-DATE-FROM       PIC X.
  2350                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2351                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2352             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2353             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2354             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2355             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2356             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2357
  2358         16  CF-ST-OVER-SHORT.
  2359             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2360             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2361
  2362         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2363
  2364         16  CF-ST-RT-CALC                  PIC X.
  2365
  2366         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2367         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2368         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2369         16  CF-ST-RF-LR-CALC               PIC X.
  2370         16  CF-ST-RF-LL-CALC               PIC X.
  2371         16  CF-ST-RF-LN-CALC               PIC X.
  2372         16  CF-ST-RF-AH-CALC               PIC X.
  2373         16  CF-ST-RF-CP-CALC               PIC X.
  2374*        16  FILLER                         PIC X(206).
  2375*CIDMOD         16  FILLER                         PIC X(192).
  2376         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2377             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2378         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2379         16  FILLER                         PIC X(187).
  2380
  2381****************************************************************
  2382*             BENEFIT MASTER RECORD                            *
  2383****************************************************************
  2384
  2385     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2386         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2387             20  CF-BENEFIT-CODE            PIC XX.
  2388             20  CF-BENEFIT-NUMERIC  REDEFINES
  2389                 CF-BENEFIT-CODE            PIC XX.
  2390             20  CF-BENEFIT-ALPHA           PIC XXX.
  2391             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2392             20  CF-BENEFIT-COMMENT         PIC X(10).
  2393
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL630.cbl
  2394             20  CF-LF-COVERAGE-TYPE        PIC X.
  2395                 88  CF-REDUCING                VALUE 'R'.
  2396                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2397
  2398             20  CF-SPECIAL-CALC-CD         PIC X.
  2399                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2400                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2401                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2402                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2403                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2404                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2405                 88  CF-FARM-PLAN               VALUE 'F'.
  2406                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2407                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2408                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2409                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2410                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2411                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2412                 88  CF-PRUDENTIAL              VALUE 'P'.
  2413                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2414                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2415                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2416                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2417                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2418                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2419
  2420             20  CF-JOINT-INDICATOR         PIC X.
  2421                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2422
  2423*            20  FILLER                     PIC X(12).
  2424             20  FILLER                     PIC X(11).
  2425             20  CF-BENEFIT-CATEGORY        PIC X.
  2426             20  CF-LOAN-TYPE               PIC X(8).
  2427
  2428             20  CF-CO-REM-TERM-CALC        PIC X.
  2429                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2430                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2431                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2432                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2433                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2434
  2435             20  CF-CO-EARNINGS-CALC        PIC X.
  2436                 88  CO-EARN-BY-R78             VALUE '1'.
  2437                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2438                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2439                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2440                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2441                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2442                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2443                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2444
  2445             20  CF-CO-REFUND-CALC          PIC X.
  2446                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2447                 88  CO-REFD-BY-R78             VALUE '1'.
  2448                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2449                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2450                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2451                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL630.cbl
  2452                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2453                 88  CO-REFD-MEAN               VALUE '8'.
  2454                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2455                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2456                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2457
  2458             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2459                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2460                 88  CO-OVRD-BY-R78             VALUE '1'.
  2461                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2462                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2463                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2464                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2465                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2466                 88  CO-OVRD-MEAN               VALUE '8'.
  2467                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2468
  2469             20  CF-CO-BEN-I-G-CD           PIC X.
  2470                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2471                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2472                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2473
  2474         16  FILLER                         PIC X(304).
  2475
  2476
  2477****************************************************************
  2478*             CARRIER MASTER RECORD                            *
  2479****************************************************************
  2480
  2481     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2482         16  CF-ADDRESS-DATA.
  2483             20  CF-MAIL-TO-NAME            PIC X(30).
  2484             20  CF-IN-CARE-OF              PIC X(30).
  2485             20  CF-ADDRESS-LINE-1          PIC X(30).
  2486             20  CF-ADDRESS-LINE-2          PIC X(30).
  2487             20  CF-CITY-STATE              PIC X(30).
  2488             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2489             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2490
  2491         16  CF-CLAIM-NO-CONTROL.
  2492             20  CF-CLAIM-NO-METHOD         PIC X.
  2493                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2494                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2495                 88  CLAIM-NO-SEQ               VALUE '3'.
  2496                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2497             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2498                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2499                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2500                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2501
  2502         16  CF-CHECK-NO-CONTROL.
  2503             20  CF-CHECK-NO-METHOD         PIC X.
  2504                 88  CHECK-NO-MANUAL            VALUE '1'.
  2505                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2506                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2507                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2508             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2509                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL630.cbl
  2510
  2511         16  CF-DOMICILE-STATE              PIC XX.
  2512
  2513         16  CF-EXPENSE-CONTROLS.
  2514             20  CF-EXPENSE-METHOD          PIC X.
  2515                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2516                 88  DOLLARS-PER-PMT            VALUE '2'.
  2517                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2518                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2519             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2520             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2521
  2522         16  CF-CORRESPONDENCE-CONTROL.
  2523             20  CF-LETTER-RESEND-OPT       PIC X.
  2524                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2525                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2526             20  FILLER                     PIC X(4).
  2527
  2528         16  CF-RESERVE-CONTROLS.
  2529             20  CF-MANUAL-SW               PIC X.
  2530                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2531             20  CF-FUTURE-SW               PIC X.
  2532                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2533             20  CF-PTC-SW                  PIC X.
  2534                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2535             20  CF-IBNR-SW                 PIC X.
  2536                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2537             20  CF-PTC-LF-SW               PIC X.
  2538                 88  CF-LF-PTC-USED             VALUE '1'.
  2539             20  CF-CDT-ACCESS-METHOD       PIC X.
  2540                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2541                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2542                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2543             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2544
  2545         16  CF-CLAIM-CALC-METHOD           PIC X.
  2546             88  360-PLUS-MONTHS                VALUE '1'.
  2547             88  365-PLUS-MONTHS                VALUE '2'.
  2548             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2549             88  360-DAILY                      VALUE '4'.
  2550             88  365-DAILY                      VALUE '5'.
  2551
  2552         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2553         16  FILLER                         PIC X(11).
  2554
  2555         16  CF-LIMIT-AMOUNTS.
  2556             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2557             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2558             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2559             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2560             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2561             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2562             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2563             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2564             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2565             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2566
  2567         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL630.cbl
  2568         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2569         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2570
  2571         16  CF-ZIP-CODE.
  2572             20  CF-ZIP-PRIME.
  2573                 24  CF-ZIP-1ST             PIC X.
  2574                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2575                 24  FILLER                 PIC X(4).
  2576             20  CF-ZIP-PLUS4               PIC X(4).
  2577         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2578             20  CF-CAN-POSTAL-1            PIC XXX.
  2579             20  CF-CAN-POSTAL-2            PIC XXX.
  2580             20  FILLER                     PIC XXX.
  2581
  2582         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2583         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2584         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2585
  2586         16  CF-RATING-SWITCH               PIC X.
  2587             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2588             88  CF-NO-RATING                   VALUE 'N'.
  2589
  2590         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2591
  2592         16  CF-CARRIER-OVER-SHORT.
  2593             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2594             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2595
  2596         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2597         16  CF-SECPAY-SWITCH               PIC X.
  2598             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2599             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2600         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2601         16  FILLER                         PIC X(448).
  2602*        16  FILLER                         PIC X(452).
  2603
  2604
  2605****************************************************************
  2606*             MORTALITY MASTER RECORD                          *
  2607****************************************************************
  2608
  2609     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2610         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2611                                INDEXED BY CF-MORT-NDX.
  2612             20  CF-MORT-TABLE              PIC X(5).
  2613             20  CF-MORT-TABLE-TYPE         PIC X.
  2614                 88  CF-MORT-JOINT              VALUE 'J'.
  2615                 88  CF-MORT-SINGLE             VALUE 'S'.
  2616                 88  CF-MORT-COMBINED           VALUE 'C'.
  2617                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2618                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2619             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2620             20  CF-MORT-AGE-METHOD         PIC XX.
  2621                 88  CF-AGE-LAST                VALUE 'AL'.
  2622                 88  CF-AGE-NEAR                VALUE 'AN'.
  2623             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2624             20  CF-MORT-ADJUSTMENT-DIRECTION
  2625                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL630.cbl
  2626                 88  CF-MINUS                   VALUE '-'.
  2627                 88  CF-PLUS                    VALUE '+'.
  2628             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2629             20  CF-MORT-JOINT-CODE         PIC X.
  2630                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2631             20  CF-MORT-PC-Q               PIC X.
  2632                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2633             20  CF-MORT-TABLE-CODE         PIC X(4).
  2634             20  CF-MORT-COMMENTS           PIC X(15).
  2635             20  FILLER                     PIC X(14).
  2636
  2637         16  FILLER                         PIC X(251).
  2638
  2639
  2640****************************************************************
  2641*             BUSSINESS TYPE MASTER RECORD                     *
  2642****************************************************************
  2643
  2644     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2645* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2646* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2647* AND RECORD 05 IS TYPES 81-99
  2648         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2649             20  CF-BUSINESS-TITLE          PIC  X(19).
  2650             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2651                                            PIC S9V9(4) COMP-3.
  2652             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2653             20  FILLER                     PIC  X.
  2654         16  FILLER                         PIC  X(248).
  2655
  2656
  2657****************************************************************
  2658*             TERMINAL MASTER RECORD                           *
  2659****************************************************************
  2660
  2661     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2662
  2663         16  CF-COMPANY-TERMINALS.
  2664             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2665                                  PIC X(4).
  2666         16  FILLER               PIC X(248).
  2667
  2668
  2669****************************************************************
  2670*             LIFE EDIT MASTER RECORD                          *
  2671****************************************************************
  2672
  2673     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2674         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2675             20  CF-LIFE-CODE-IN            PIC XX.
  2676             20  CF-LIFE-CODE-OUT           PIC XX.
  2677         16  FILLER                         PIC X(248).
  2678
  2679
  2680****************************************************************
  2681*             AH EDIT MASTER RECORD                            *
  2682****************************************************************
  2683
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL630.cbl
  2684     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2685         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2686             20  CF-AH-CODE-IN              PIC XXX.
  2687             20  CF-AH-CODE-OUT             PIC XX.
  2688         16  FILLER                         PIC X(248).
  2689
  2690
  2691****************************************************************
  2692*             CREDIBILITY TABLES                               *
  2693****************************************************************
  2694
  2695     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2696         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2697                             INDEXED BY CF-CRDB-NDX.
  2698             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2699             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2700             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2701         16  FILLER                         PIC  X(332).
  2702
  2703
  2704****************************************************************
  2705*             REPORT CUSTOMIZATION RECORD                      *
  2706****************************************************************
  2707
  2708     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2709         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2710             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2711             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2712             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2713**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2714****       A T-TRANSFER.                                   ****
  2715             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2716
  2717         16  FILLER                         PIC XX.
  2718
  2719         16  CF-CARRIER-CNTL-OPT.
  2720             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2721                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2722                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2723             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2724                                            PIC X.
  2725         16  CF-GROUP-CNTL-OPT.
  2726             20  CF-GROUP-OPT-SEQ           PIC 9.
  2727                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2728                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2729             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2730                                            PIC X(6).
  2731         16  CF-STATE-CNTL-OPT.
  2732             20  CF-STATE-OPT-SEQ           PIC 9.
  2733                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2734                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2735             20  CF-STATE-SELECT OCCURS 3 TIMES
  2736                                            PIC XX.
  2737         16  CF-ACCOUNT-CNTL-OPT.
  2738             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2739                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2740                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2741             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL630.cbl
  2742                                            PIC X(10).
  2743         16  CF-BUS-TYP-CNTL-OPT.
  2744             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2745                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2746                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2747             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2748                                            PIC XX.
  2749         16  CF-LF-TYP-CNTL-OPT.
  2750             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2751                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2752                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2753             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2754                                            PIC XX.
  2755         16  CF-AH-TYP-CNTL-OPT.
  2756             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2757                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2758                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2759             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2760                                            PIC XX.
  2761         16  CF-REPTCD1-CNTL-OPT.
  2762             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2763                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2764                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2765             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2766                                            PIC X(10).
  2767         16  CF-REPTCD2-CNTL-OPT.
  2768             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2769                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2770                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2771             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2772                                            PIC X(10).
  2773         16  CF-USER1-CNTL-OPT.
  2774             20  CF-USER1-OPT-SEQ           PIC 9.
  2775                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2776                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2777             20  CF-USER1-SELECT OCCURS 3 TIMES
  2778                                            PIC X(10).
  2779         16  CF-USER2-CNTL-OPT.
  2780             20  CF-USER2-OPT-SEQ           PIC 9.
  2781                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2782                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2783             20  CF-USER2-SELECT OCCURS 3 TIMES
  2784                                            PIC X(10).
  2785         16  CF-USER3-CNTL-OPT.
  2786             20  CF-USER3-OPT-SEQ           PIC 9.
  2787                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2788                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2789             20  CF-USER3-SELECT OCCURS 3 TIMES
  2790                                            PIC X(10).
  2791         16  CF-USER4-CNTL-OPT.
  2792             20  CF-USER4-OPT-SEQ           PIC 9.
  2793                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2794                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2795             20  CF-USER4-SELECT OCCURS 3 TIMES
  2796                                            PIC X(10).
  2797         16  CF-USER5-CNTL-OPT.
  2798             20  CF-USER5-OPT-SEQ           PIC 9.
  2799                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL630.cbl
  2800                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2801             20  CF-USER5-SELECT OCCURS 3 TIMES
  2802                                            PIC X(10).
  2803         16  CF-REINS-CNTL-OPT.
  2804             20  CF-REINS-OPT-SEQ           PIC 9.
  2805                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2806                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2807             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2808                 24  CF-REINS-PRIME         PIC XXX.
  2809                 24  CF-REINS-SUB           PIC XXX.
  2810
  2811         16  CF-AGENT-CNTL-OPT.
  2812             20  CF-AGENT-OPT-SEQ           PIC 9.
  2813                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2814                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2815             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2816                                            PIC X(10).
  2817
  2818         16  FILLER                         PIC X(43).
  2819
  2820         16  CF-LOSS-RATIO-SELECT.
  2821             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2822             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2823         16  CF-ENTRY-DATE-SELECT.
  2824             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2825             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2826         16  CF-EFFECTIVE-DATE-SELECT.
  2827             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2828             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2829
  2830         16  CF-EXCEPTION-LIST-IND          PIC X.
  2831             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2832
  2833         16  FILLER                         PIC X(318).
  2834
  2835****************************************************************
  2836*                  EXCEPTION REPORTING RECORD                  *
  2837****************************************************************
  2838
  2839     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2840         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2841             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2842
  2843         16  CF-COMBINED-LIFE-AH-OPT.
  2844             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2845             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2846             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2847             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2848
  2849         16  CF-LIFE-OPT.
  2850             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2851             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2852             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2853             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2854             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2855             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2856             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2857             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL630.cbl
  2858             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2859             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2860
  2861         16  CF-AH-OPT.
  2862             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2863             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2864             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2865             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2866             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2867             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2868             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2869             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2870             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2871             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2872
  2873         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2874             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2875             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2876             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2877
  2878         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2879
  2880         16  FILLER                         PIC X(673).
  2881
  2882
  2883****************************************************************
  2884*             MORTGAGE SYSTEM PLAN RECORD                      *
  2885****************************************************************
  2886
  2887     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2888         16  CF-PLAN-TYPE                   PIC X.
  2889             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2890             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2891             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2892         16  CF-PLAN-ABBREV                 PIC XXX.
  2893         16  CF-PLAN-DESCRIPT               PIC X(10).
  2894         16  CF-PLAN-NOTES                  PIC X(20).
  2895         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2896         16  CF-PLAN-UNDERWRITING.
  2897             20  CF-PLAN-TERM-DATA.
  2898                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2899                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2900             20  CF-PLAN-AGE-DATA.
  2901                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2902                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2903                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2904             20  CF-PLAN-BENEFIT-DATA.
  2905                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2906                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2907                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2908                                            PIC S9(7)V99  COMP-3.
  2909         16  CF-PLAN-POLICY-FORMS.
  2910             20  CF-POLICY-FORM             PIC X(12).
  2911             20  CF-MASTER-APPLICATION      PIC X(12).
  2912             20  CF-MASTER-POLICY           PIC X(12).
  2913         16  CF-PLAN-RATING.
  2914             20  CF-RATE-CODE               PIC X(5).
  2915             20  CF-SEX-RATING              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL630.cbl
  2916                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2917                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2918             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2919             20  CF-SUB-STD-TYPE            PIC X.
  2920                 88  CF-PCT-OF-PREM            VALUE '1'.
  2921                 88  CF-PCT-OF-BENE            VALUE '2'.
  2922         16  CF-PLAN-PREM-TOLERANCES.
  2923             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2924             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2925         16  CF-PLAN-PYMT-TOLERANCES.
  2926             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2927             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2928         16  CF-PLAN-MISC-DATA.
  2929             20  FILLER                     PIC X.
  2930             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2931             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2932         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2933         16  CF-PLAN-IND-GRP                PIC X.
  2934             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2935                                                     '1'.
  2936             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2937                                                     '2'.
  2938         16  CF-MIB-SEARCH-SW               PIC X.
  2939             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2940             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2941             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2942             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2943         16  CF-ALPHA-SEARCH-SW             PIC X.
  2944             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2945             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2946             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2947             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2948             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2949             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2950             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2951             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2952             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2953             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2954                                                     'A' 'B' 'C'
  2955                                                     'X' 'Y' 'Z'.
  2956         16  CF-EFF-DT-RULE-SW              PIC X.
  2957             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2958             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2959             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2960             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2961             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2962         16  FILLER                         PIC X(4).
  2963         16  CF-HEALTH-QUESTIONS            PIC X.
  2964             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2965         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2966         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2967         16  CF-PLAN-SNGL-JNT               PIC X.
  2968             88  CF-COMBINED-PLAN              VALUE 'C'.
  2969             88  CF-JNT-PLAN                   VALUE 'J'.
  2970             88  CF-SNGL-PLAN                  VALUE 'S'.
  2971         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2972         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2973         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL630.cbl
  2974         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2975         16  CF-RERATE-CNTL                 PIC  X.
  2976             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2977             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2978             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2979             88  CF-AUTO-RECALC                 VALUE '4'.
  2980         16  CF-BENEFIT-TYPE                PIC  X.
  2981             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2982             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2983         16  CF-POLICY-FEE                  PIC S999V99
  2984                                                    COMP-3.
  2985         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2986         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2987         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2988         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2989         16  FILLER                         PIC  X(32).
  2990         16  CF-TERMINATION-FORM            PIC  X(04).
  2991         16  FILLER                         PIC  X(08).
  2992         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2993                                                       COMP-3.
  2994         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2995         16  CF-ISSUE-LETTER                PIC  X(4).
  2996         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2997         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2998             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2999             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3000         16  CF-MP-REFUND-CALC              PIC X.
  3001             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3002             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3003             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3004             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3005             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3006             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3007             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3008             88  CF-MP-REFD-MEAN                VALUE '8'.
  3009         16  CF-ALT-RATE-CODE               PIC  X(5).
  3010
  3011
  3012         16  FILLER                         PIC X(498).
  3013****************************************************************
  3014*             MORTGAGE COMPANY MASTER RECORD                   *
  3015****************************************************************
  3016
  3017     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3018         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3019         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3020             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3021             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3022             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3023             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3024             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3025
  3026         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3027         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3028         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3029         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3030         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3031
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL630.cbl
  3032         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3033             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3034         16  CF-MP-RECON-USE-IND            PIC X(1).
  3035             88  CF-MP-USE-RECON             VALUE 'Y'.
  3036         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3037             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3038         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3039             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3040             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3041         16  FILLER                         PIC X(1).
  3042         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3043             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3044         16  CF-MORTG-MIB-VERSION           PIC X.
  3045             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3046             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3047             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3048         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3049             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3050                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3051             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3052                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3053             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3054                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3055             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3056                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3057             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3058                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3059             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3060                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3061         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3062         16  FILLER                         PIC X(7).
  3063         16  CF-MORTG-DESTINATION-SYMBOL.
  3064             20  CF-MORTG-MIB-COMM          PIC X(5).
  3065             20  CF-MORTG-MIB-TERM          PIC X(5).
  3066         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3067             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3068         16  FILLER                         PIC X(03).
  3069         16  CF-MP-CHECK-NO-CONTROL.
  3070             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3071                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3072                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3073                                                ' ' LOW-VALUES.
  3074                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3075                                               VALUE '3'.
  3076         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3077         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3078         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3079             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3080                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3081             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3082                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3083             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3084                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3085             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3086                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3087             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3088                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3089             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL630.cbl
  3090                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3091         16  CF-MORTG-BILLING-AREA.
  3092             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3093                                            PIC X.
  3094         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3095         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3096         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3097         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3098             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3099             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3100         16  FILLER                         PIC X.
  3101         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3102             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3103             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3104         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3105         16  FILLER                         PIC X(8).
  3106         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3107         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3108         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3109         16  CF-ACH-COMPANY-ID.
  3110             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3111                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3112                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3113                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3114             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3115         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3116             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3117         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3118             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3119             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3120         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3121         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3122         16  FILLER                         PIC X(536).
  3123
  3124****************************************************************
  3125*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3126****************************************************************
  3127
  3128     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3129         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3130             20  CF-FEMALE-HEIGHT.
  3131                 24  CF-FEMALE-FT           PIC 99.
  3132                 24  CF-FEMALE-IN           PIC 99.
  3133             20  CF-FEMALE-MIN-WT           PIC 999.
  3134             20  CF-FEMALE-MAX-WT           PIC 999.
  3135         16  FILLER                         PIC X(428).
  3136
  3137     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3138         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3139             20  CF-MALE-HEIGHT.
  3140                 24  CF-MALE-FT             PIC 99.
  3141                 24  CF-MALE-IN             PIC 99.
  3142             20  CF-MALE-MIN-WT             PIC 999.
  3143             20  CF-MALE-MAX-WT             PIC 999.
  3144         16  FILLER                         PIC X(428).
  3145******************************************************************
  3146*             AUTOMATIC ACTIVITY RECORD                          *
  3147******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL630.cbl
  3148     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3149         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3150             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3151             20  CF-SYS-LETTER-ID           PIC X(04).
  3152             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3153             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3154             20  CF-SYS-RESET-SW            PIC X(01).
  3155             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3156             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3157
  3158         16  FILLER                         PIC X(50).
  3159
  3160         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3161             20  CF-USER-ACTIVE-SW          PIC X(01).
  3162             20  CF-USER-LETTER-ID          PIC X(04).
  3163             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3164             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3165             20  CF-USER-RESET-SW           PIC X(01).
  3166             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3167             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3168             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3169
  3170         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL630.cbl
  3172*    COPY ERCPNDB.
  3173******************************************************************
  3174*                                                                *
  3175*                                                                *
  3176*                            ERCPNDB.                            *
  3177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3178*                            VMOD=2.025                          *
  3179*                                                                *
  3180*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3181*                                                                *
  3182******************************************************************
  3183*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3184*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3185******************************************************************
  3186*                                                                *
  3187*                                                                *
  3188*   FILE TYPE = VSAM,KSDS                                        *
  3189*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3190*                                                                *
  3191*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3192*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3193*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3194*                                                 RKP=13,LEN=36  *
  3195*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3196*                                      AND CHG-SEQ.)             *
  3197*                                                RKP=49,LEN=11   *
  3198*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3199*                                      AND CHG-SEQ.)             *
  3200*                                                RKP=60,LEN=15   *
  3201*                                                                *
  3202*   LOG = NO                                                     *
  3203*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3204******************************************************************
  3205******************************************************************
  3206*                   C H A N G E   L O G
  3207*
  3208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3209*-----------------------------------------------------------------
  3210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3211* EFFECTIVE    NUMBER
  3212*-----------------------------------------------------------------
  3213* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3214* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3215* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3216* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3217* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3218* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3219* 032306                   PEMA  ADD BOW LOAN NUMBER
  3220* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3221* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3222* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3223* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3224* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3225* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3226* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3227******************************************************************
  3228
  3229 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL630.cbl
  3230     12  PB-RECORD-ID                     PIC XX.
  3231         88  VALID-PB-ID                        VALUE 'PB'.
  3232
  3233     12  PB-CONTROL-PRIMARY.
  3234         16  PB-COMPANY-CD                PIC X.
  3235         16  PB-ENTRY-BATCH               PIC X(6).
  3236         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3237         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3238
  3239     12  PB-CONTROL-BY-ACCOUNT.
  3240         16  PB-COMPANY-CD-A1             PIC X.
  3241         16  PB-CARRIER                   PIC X.
  3242         16  PB-GROUPING.
  3243             20  PB-GROUPING-PREFIX       PIC XXX.
  3244             20  PB-GROUPING-PRIME        PIC XXX.
  3245         16  PB-STATE                     PIC XX.
  3246         16  PB-ACCOUNT.
  3247             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3248             20  PB-ACCOUNT-PRIME         PIC X(6).
  3249         16  PB-CERT-EFF-DT               PIC XX.
  3250         16  PB-CERT-NO.
  3251             20  PB-CERT-PRIME            PIC X(10).
  3252             20  PB-CERT-SFX              PIC X.
  3253         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3254
  3255         16  PB-RECORD-TYPE               PIC X.
  3256             88  PB-MAILING-DATA                VALUE '0'.
  3257             88  PB-ISSUE                       VALUE '1'.
  3258             88  PB-CANCELLATION                VALUE '2'.
  3259             88  PB-BATCH-TRAILER               VALUE '9'.
  3260
  3261     12  PB-CONTROL-BY-ORIG-BATCH.
  3262         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3263         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3264         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3265         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3266
  3267     12  PB-CONTROL-BY-CSR.
  3268         16  PB-CSR-COMPANY-CD            PIC X.
  3269         16  PB-CSR-ID                    PIC X(4).
  3270         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3271         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3272         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3273******************************************************************
  3274*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3275******************************************************************
  3276
  3277     12  PB-LAST-MAINT-DT                 PIC XX.
  3278     12  PB-LAST-MAINT-BY                 PIC X(4).
  3279     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3280
  3281     12  PB-RECORD-BODY                   PIC X(375).
  3282
  3283     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3284         16  PB-CERT-ORIGIN               PIC X.
  3285             88  CLASIC-CREATED-CERT         VALUE '1'.
  3286         16  PB-I-NAME.
  3287             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL630.cbl
  3288             20  PB-I-INSURED-FIRST-NAME.
  3289                 24  PB-I-INSURED-1ST-INIT PIC X.
  3290                 24  FILLER                PIC X(9).
  3291             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3292         16  PB-I-AGE                     PIC S99   COMP-3.
  3293         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3294         16  PB-I-BIRTHDAY                PIC XX.
  3295         16  PB-I-INSURED-SEX             PIC X.
  3296             88  PB-SEX-MALE     VALUE 'M'.
  3297             88  PB-SEX-FEMALE   VALUE 'F'.
  3298
  3299         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3300         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3301         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3302         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3303         16  PB-I-SKIP-CODE               PIC X.
  3304             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3305             88  PB-SKIP-JULY              VALUE '1'.
  3306             88  PB-SKIP-AUGUST            VALUE '2'.
  3307             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3308             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3309             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3310             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3311             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3312             88  PB-SKIP-JUNE              VALUE '8'.
  3313             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3314             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3315             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3316         16  PB-I-TERM-TYPE               PIC X.
  3317             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3318             88  PB-PAID-WEEKLY            VALUE 'W'.
  3319             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3320             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3321             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3322         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3323         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3324         16  PB-I-DATA-ENTRY-SW           PIC X.
  3325             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3326             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3327             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3328             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3329         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3330         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3331*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3332         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3333         16  FILLER                       PIC X.
  3334
  3335         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3336             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3337             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3338                                                   '90' THRU '99'.
  3339         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3340                                          PIC XX.
  3341         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3342         16  PB-I-AMOUNT-FINANCED REDEFINES
  3343                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3344         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3345         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL630.cbl
  3346                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3347         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3348         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3349         16  PB-I-CLP-AMOUNT REDEFINES
  3350                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3351         16  PB-I-LF-CALC-FLAG            PIC X.
  3352             88 PB-COMP-LF-PREM               VALUE '?'.
  3353         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3354         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3355         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3356         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3357         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3358         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3359         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3360         16  PB-I-LF-ABBR                 PIC XXX.
  3361         16  PB-I-LF-INPUT-CD             PIC XX.
  3362
  3363         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3364             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3365             88  PB-INVALID-AH               VALUE '  ' '00'
  3366                                                   '90' THRU '99'.
  3367         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3368         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3369         16  PB-I-AH-CALC-FLAG            PIC X.
  3370             88 PB-COMP-AH-PREM                  VALUE '?'.
  3371         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3372         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3373         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3374         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3375         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3376         16  PB-I-AH-ABBR                 PIC XXX.
  3377         16  PB-I-AH-INPUT-CD             PIC XXX.
  3378
  3379         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3380         16  PB-I-REIN-TABLE              PIC XXX.
  3381         16  PB-I-BUSINESS-TYPE           PIC 99.
  3382         16  PB-I-INDV-GRP-CD             PIC X.
  3383         16  PB-I-MORT-CODE.
  3384             20  PB-I-TABLE               PIC X.
  3385             20  PB-I-INTEREST            PIC XX.
  3386             20  PB-I-MORT-TYP            PIC X.
  3387         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3388         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3389         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3390         16  PB-I-INDV-GRP-OVRD           PIC X.
  3391         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3392         16  PB-I-SIG-SW                  PIC X.
  3393             88  PB-POLICY-SIGNED             VALUE 'Y'.
  3394         16  PB-I-RATE-CLASS              PIC XX.
  3395         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3396         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3397         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3398         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3399         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3400         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3401         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3402         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3403         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL630.cbl
  3404             88  PB-I-OB                      VALUE 'B'.
  3405             88  PB-I-SUMMARY                 VALUE 'Z'.
  3406         16  PB-I-ENTRY-STATUS            PIC X.
  3407             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3408                                              'M' '5' '9' '2'.
  3409             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3410             88  PB-I-POLICY-PENDING          VALUE '2'.
  3411             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3412             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3413             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3414             88  PB-I-REIN-ONLY               VALUE '9'.
  3415             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3416             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3417             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3418             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3419         16  PB-I-INT-CODE                PIC X.
  3420             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3421             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3422         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3423         16  PB-I-SOC-SEC-NO              PIC X(11).
  3424         16  PB-I-MEMBER-NO               PIC X(12).
  3425         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3426*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3427         16  PB-I-OLD-LOF                 PIC XXX.
  3428         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3429         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3430         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3431         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3432         16  PB-I-LIFE-INDICATOR          PIC X.
  3433             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3434         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3435         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3436             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3437             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3438         16  PB-I-1ST-PMT-DT              PIC XX.
  3439         16  PB-I-JOINT-INSURED.
  3440             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3441             20 PB-I-JOINT-FIRST-NAME.
  3442                24  PB-I-JOINT-FIRST-INIT PIC X.
  3443                24  FILLER                PIC X(9).
  3444             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3445*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3446         16  PB-I-BENEFICIARY-NAME.
  3447             20  PB-I-BANK-NUMBER         PIC X(10).
  3448             20  FILLER                   PIC X(15).
  3449         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  3450         16  PB-I-REFERENCE               PIC X(12).
  3451         16  FILLER REDEFINES PB-I-REFERENCE.
  3452             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3453             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3454             20  PB-I-CLP-STATE           PIC XX.
  3455         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3456             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3457             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3458             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3459         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3460         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3461         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL630.cbl
  3462         16  PB-I-RATE-CODE               PIC X(4).
  3463         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3464         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3465         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3466         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3467         16  PB-I-BANK-NOCHRGB            PIC 99.
  3468         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3469         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3470
  3471     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3472         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3473             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3474         16  PB-C-CANCEL-ORIGIN           PIC X.
  3475             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3476         16  PB-C-LF-CANCEL-DT            PIC XX.
  3477         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3478         16  PB-C-LF-CALC-REQ             PIC X.
  3479             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3480         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3481         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3482         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3483             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3484         16  PB-C-AH-CANCEL-DT            PIC XX.
  3485         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3486         16  PB-C-AH-CALC-REQ             PIC X.
  3487             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3488         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3489         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3490         16  PB-C-LAST-NAME               PIC X(15).
  3491         16  PB-C-REFUND-SW               PIC X.
  3492             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3493             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3494         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  3495         16  PB-C-PAYEE-CODE              PIC X(6).
  3496         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  3497         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  3498         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  3499         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  3500         16  PB-C-REFERENCE               PIC X(12).
  3501         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3502         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3503         16  PB-C-POST-CARD-IND           PIC X.
  3504         16  PB-C-CANCEL-REASON           PIC X.
  3505         16  PB-C-REF-INTERFACE-SW        PIC X.
  3506         16  FILLER                       PIC X(09).
  3507*        16  FILLER                       PIC X(18).
  3508         16  PB-C-POLICY-FORM-NO          PIC X(12).
  3509*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  3510         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  3511         16  PB-CANCELED-CERT-DATA.
  3512             20  PB-CI-INSURED-NAME.
  3513                 24  PB-CI-LAST-NAME      PIC X(15).
  3514                 24  PB-CI-INITIALS       PIC XX.
  3515             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  3516             20  PB-CI-INSURED-SEX        PIC X.
  3517             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  3518             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  3519             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL630.cbl
  3520             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  3521             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3522             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  3523             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  3524             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  3525             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  3526             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3527             20  PB-CI-RATE-CLASS         PIC XX.
  3528             20  PB-CI-RATE-DEV-LF        PIC XXX.
  3529             20  PB-CI-RATE-DEV-AH        PIC XXX.
  3530             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  3531             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  3532             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  3533             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  3534             20  PB-CI-LF-ABBR            PIC X(3).
  3535             20  PB-CI-AH-ABBR            PIC X(3).
  3536             20  PB-CI-OB-FLAG            PIC X.
  3537                 88  PB-CI-OB                VALUE 'B'.
  3538             20  PB-CI-LF-POLICY-STATUS   PIC X.
  3539                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  3540                                           'M' '4' '5' '9' '2'.
  3541                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  3542                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  3543                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  3544                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  3545                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3546                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3547                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3548                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3549                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3550                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3551                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3552                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3553             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3554                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3555                                           'M' '4' '5' '9' '2'.
  3556                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3557                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3558                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3559                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3560                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3561                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3562                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3563                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3564                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  3565                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3566                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3567                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  3568             20  PB-CI-PAY-FREQUENCY      PIC 99.
  3569             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3570             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3571             20  PB-CI-MEMBER-NO          PIC X(12).
  3572             20  PB-CI-INT-CODE           PIC X.
  3573                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3574                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3575             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3576             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  3577             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL630.cbl
  3578                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3579                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3580             20  PB-CI-ENTRY-STATUS       PIC X.
  3581             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3582             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3583             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3584             20  PB-CI-DEATH-DT           PIC XX.
  3585             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3586             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3587             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3588             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3589             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3590             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3591             20  PB-CI-ENTRY-DT              PIC XX.
  3592             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3593             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3594             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3595             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3596             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3597             20  PB-CI-OLD-LOF               PIC XXX.
  3598*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3599             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3600             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3601             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3602             20  PB-CI-INDV-GRP-CD           PIC X.
  3603             20  PB-CI-BENEFICIARY-NAME.
  3604                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3605                 24  FILLER                  PIC X(15).
  3606             20  PB-CI-NOTE-SW               PIC X.
  3607             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3608             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3609             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3610             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3611             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3612             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3613             20  PB-CI-FIRST-NAME            PIC X(10).
  3614
  3615         16  FILLER                       PIC X(17).
  3616*032306  16  FILLER                       PIC X(27).
  3617*        16  FILLER                       PIC X(46).
  3618
  3619     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3620         16  FILLER                       PIC X(10).
  3621         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  3622         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3623         16  PB-M-INSURED-MID-INIT        PIC X.
  3624         16  PB-M-INSURED-AGE             PIC 99.
  3625         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  3626         16  PB-M-INSURED-SEX             PIC X.
  3627         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3628         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3629         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3630         16  PB-M-INSURED-CITY-STATE.
  3631             20  PB-M-INSURED-CITY        PIC X(28).
  3632             20  PB-M-INSURED-STATE       PIC XX.
  3633         16  PB-M-INSURED-ZIP-CODE.
  3634             20  PB-M-INSURED-ZIP-PRIME.
  3635                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL630.cbl
  3636                     88  PB-M-CANADIAN-POST-CODE
  3637                                             VALUE 'A' THRU 'Z'.
  3638                 24  FILLER               PIC X(4).
  3639             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3640         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3641                                        PB-M-INSURED-ZIP-CODE.
  3642             20  PM-M-INS-CAN-POST1       PIC XXX.
  3643             20  PM-M-INS-CAN-POST2       PIC XXX.
  3644             20  FILLER                   PIC XXX.
  3645         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3646         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3647         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3648         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3649         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3650         16  PB-M-CRED-BENE-CITYST.
  3651             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3652             20  PB-M-CRED-BENE-STATE     PIC XX.
  3653         16  FILLER                       PIC X(92).
  3654
  3655     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3656         16  FILLER                       PIC X(10).
  3657         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3658         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3659         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3660         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3661         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3662         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3663         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3664         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3665         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3666         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3667         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3668         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3669         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3670         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3671         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3672         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3673         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3674         16  PB-ACCOUNT-NAME              PIC X(30).
  3675         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3676         16  PB-REFERENCE                 PIC X(12).
  3677         16  PB-B-RECEIVED-DT             PIC XX.
  3678         16  FILLER                       PIC X(234).
  3679
  3680     12  PB-RECORD-STATUS.
  3681         16  PB-CREDIT-SELECT-DT          PIC XX.
  3682         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  3683         16  PB-BILLED-DT                 PIC XX.
  3684         16  PB-BILLING-STATUS            PIC X.
  3685             88  PB-ENTRY-REVERSED            VALUE 'R'.
  3686             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  3687             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  3688         16  PB-RECORD-BILL               PIC X.
  3689             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  3690             88  PB-RECORD-RETURNED           VALUE 'R'.
  3691             88  PB-RECORD-ENDORSED           VALUE 'E'.
  3692             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  3693             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL630.cbl
  3694             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  3695         16  PB-BATCH-ENTRY               PIC X.
  3696             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  3697             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  3698             88  PB-REISSUED-CERT             VALUE 'E'.
  3699             88  PB-MONTHLY-CERT              VALUE 'M'.
  3700             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  3701             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  3702             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  3703         16  PB-FORCE-CODE                PIC X.
  3704             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  3705             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  3706             88  PB-CANCEL-FORCE              VALUE '8'.
  3707             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  3708             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  3709             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  3710             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  3711             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  3712             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  3713             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  3714         16  PB-FATAL-FLAG                PIC X.
  3715             88  PB-FATAL-ERRORS              VALUE 'X'.
  3716         16  PB-FORCE-ER-CD               PIC X.
  3717             88  PB-FORCE-ERRORS              VALUE 'F'.
  3718             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  3719         16  PB-WARN-ER-CD                PIC X.
  3720             88  PB-WARNING-ERRORS            VALUE 'W'.
  3721         16  FILLER                       PIC X.
  3722         16  PB-OUT-BAL-CD                PIC X.
  3723             88  PB-OUT-OF-BAL                VALUE 'O'.
  3724         16  PB-LIFE-OVERRIDE-L1          PIC X.
  3725         16  PB-AH-OVERRIDE-L1            PIC X.
  3726         16  PB-INPUT-DT                  PIC XX.
  3727         16  PB-INPUT-BY                  PIC X(4).
  3728         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  3729         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  3730         16  PB-TOLERANCE-REJECT-SW       PIC X.
  3731         16  PB-LF-EARNING-METHOD         PIC X.
  3732         16  PB-AH-EARNING-METHOD         PIC X.
  3733         16  PB-LF-TERM-CALC-METHOD       PIC X.
  3734         16  PB-AH-TERM-CALC-METHOD       PIC X.
  3735         16  PB-REIN-CD                   PIC XXX.
  3736         16  PB-LF-REFUND-TYPE            PIC X.
  3737         16  PB-AH-REFUND-TYPE            PIC X.
  3738         16  PB-ACCT-EFF-DT               PIC XX.
  3739         16  PB-ACCT-EXP-DT               PIC XX.
  3740         16  PB-COMPANY-ID                PIC X(3).
  3741         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3742         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3743         16  PB-SV-CARRIER                PIC X.
  3744         16  PB-SV-GROUPING               PIC X(6).
  3745         16  PB-SV-STATE                  PIC XX.
  3746         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  3747         16  PB-GA-BILLING-INFO.
  3748             20  PB-GA-BILL-DT OCCURS 5 TIMES
  3749                                          PIC XX.
  3750         16  PB-SV-REMIT-TO  REDEFINES
  3751             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL630.cbl
  3752         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  3753         16  PB-I-LOAN-OFFICER            PIC X(5).
  3754         16  PB-I-VIN                     PIC X(17).
  3755
  3756         16  FILLER                       PIC X(04).
  3757         16  IMNET-BYPASS-SW              PIC X.
  3758
  3759******************************************************************
  3760*                COMMON EDIT ERRORS                              *
  3761******************************************************************
  3762
  3763     12  PB-COMMON-ERRORS.
  3764         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  3765                                           PIC S9(4)     COMP.
  3766
  3767******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL630.cbl
  3769*    COPY ERCACCT.
  3770******************************************************************
  3771*                                                                *
  3772*                                                                *
  3773*                            ERCACCT                             *
  3774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3775*                            VMOD=2.031                          *
  3776*                                                                *
  3777*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3778*                                                                *
  3779*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3780*   VSAM ACCOUNT MASTER FILES.                                   *
  3781*                                                                *
  3782*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3783*                                                                *
  3784*   FILE TYPE = VSAM,KSDS                                        *
  3785*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3786*                                                                *
  3787*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3788*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3789*                                                                *
  3790*   LOG = NO                                                     *
  3791*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3792*                                                                *
  3793*                                                                *
  3794******************************************************************
  3795*                   C H A N G E   L O G
  3796*
  3797* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3798*-----------------------------------------------------------------
  3799*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3800* EFFECTIVE    NUMBER
  3801*-----------------------------------------------------------------
  3802* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3803* 092705    2005050300006  PEMA  ADD SPP LEASES
  3804* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3805* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3806******************************************************************
  3807
  3808 01  ACCOUNT-MASTER.
  3809     12  AM-RECORD-ID                      PIC XX.
  3810         88  VALID-AM-ID                      VALUE 'AM'.
  3811
  3812     12  AM-CONTROL-PRIMARY.
  3813         16  AM-COMPANY-CD                 PIC X.
  3814         16  AM-MSTR-CNTRL.
  3815             20  AM-CONTROL-A.
  3816                 24  AM-CARRIER            PIC X.
  3817                 24  AM-GROUPING.
  3818                     28 AM-GROUPING-PREFIX PIC XXX.
  3819                     28 AM-GROUPING-PRIME  PIC XXX.
  3820                 24  AM-STATE              PIC XX.
  3821                 24  AM-ACCOUNT.
  3822                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3823                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3824             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3825                                           PIC X(19).
  3826             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL630.cbl
  3827                 24  AM-EXPIRATION-DT      PIC XX.
  3828                 24  FILLER                PIC X(4).
  3829             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3830                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3831
  3832     12  AM-CONTROL-BY-VAR-GRP.
  3833         16  AM-COMPANY-CD-A1              PIC X.
  3834         16  AM-VG-CARRIER                 PIC X.
  3835         16  AM-VG-GROUPING                PIC X(6).
  3836         16  AM-VG-STATE                   PIC XX.
  3837         16  AM-VG-ACCOUNT                 PIC X(10).
  3838         16  AM-VG-DATE.
  3839             20  AM-VG-EXPIRATION-DT       PIC XX.
  3840             20  FILLER                    PIC X(4).
  3841         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3842                                           PIC 9(11)      COMP-3.
  3843     12  AM-MAINT-INFORMATION.
  3844         16  AM-LAST-MAINT-DT              PIC XX.
  3845         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3846         16  AM-LAST-MAINT-USER            PIC X(4).
  3847         16  FILLER                        PIC XX.
  3848
  3849     12  AM-EFFECTIVE-DT                   PIC XX.
  3850     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3851
  3852     12  AM-PREV-DATES  COMP-3.
  3853         16  AM-PREV-EXP-DT                PIC 9(11).
  3854         16  AM-PREV-EFF-DT                PIC 9(11).
  3855
  3856     12  AM-REPORT-CODE-1                  PIC X(10).
  3857     12  AM-REPORT-CODE-2                  PIC X(10).
  3858
  3859     12  AM-CITY-CODE                      PIC X(4).
  3860     12  AM-COUNTY-PARISH                  PIC X(6).
  3861
  3862     12  AM-NAME                           PIC X(30).
  3863     12  AM-PERSON                         PIC X(30).
  3864     12  AM-ADDRS                          PIC X(30).
  3865     12  AM-CITY.
  3866         16  AM-ADDR-CITY                  PIC X(28).
  3867         16  AM-ADDR-STATE                 PIC XX.
  3868     12  AM-ZIP.
  3869         16  AM-ZIP-PRIME.
  3870             20  AM-ZIP-PRI-1ST            PIC X.
  3871                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3872             20  FILLER                    PIC X(4).
  3873         16  AM-ZIP-PLUS4                  PIC X(4).
  3874     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3875         16  AM-CAN-POSTAL-1               PIC XXX.
  3876         16  AM-CAN-POSTAL-2               PIC XXX.
  3877         16  FILLER                        PIC XXX.
  3878     12  AM-TEL-NO.
  3879         16  AM-AREA-CODE                  PIC 999.
  3880         16  AM-TEL-PRE                    PIC 999.
  3881         16  AM-TEL-NBR                    PIC 9(4).
  3882     12  AM-TEL-LOC                        PIC X.
  3883         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3884         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL630.cbl
  3885
  3886     12  AM-COMM-STRUCTURE.
  3887         16  AM-DEFN-1.
  3888             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3889                 24  AM-AGT.
  3890                     28  AM-AGT-PREFIX     PIC X(4).
  3891                     28  AM-AGT-PRIME      PIC X(6).
  3892                 24  AM-COM-TYP            PIC X.
  3893                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3894                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3895                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3896                 24  AM-RECALC-LV-INDIC    PIC X.
  3897                 24  AM-RETRO-LV-INDIC     PIC X.
  3898                 24  AM-GL-CODES           PIC X.
  3899                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3900                 24  FILLER                PIC X(01).
  3901         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3902             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3903                 24  FILLER                PIC X(11).
  3904                 24  AM-L-COMA             PIC XXX.
  3905                 24  AM-J-COMA             PIC XXX.
  3906                 24  AM-A-COMA             PIC XXX.
  3907                 24  FILLER                PIC X(6).
  3908
  3909     12  AM-COMM-CHANGE-STATUS             PIC X.
  3910         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3911
  3912     12  AM-CSR-CODE                       PIC X(4).
  3913
  3914     12  AM-BILLING-STATUS                 PIC X.
  3915         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3916         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3917     12  AM-AUTO-REFUND-SW                 PIC X.
  3918         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3919         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3920     12  AM-GPCD                           PIC 99.
  3921     12  AM-IG                             PIC X.
  3922         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3923         88  AM-HAS-GROUP                     VALUE '2'.
  3924     12  AM-STATUS                         PIC X.
  3925         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3926         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3927         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3928         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3929         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3930     12  AM-REMIT-TO                       PIC 99.
  3931     12  AM-ID-NO                          PIC X(11).
  3932
  3933     12  AM-CAL-TABLE                      PIC XX.
  3934     12  AM-LF-DEVIATION                   PIC XXX.
  3935     12  AM-AH-DEVIATION                   PIC XXX.
  3936     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3937     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3938     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3939     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3940     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3941     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3942
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL630.cbl
  3943     12  AM-USER-FIELDS.
  3944         16  AM-FLD-1                      PIC XX.
  3945         16  AM-FLD-2                      PIC XX.
  3946         16  AM-FLD-3                      PIC XX.
  3947         16  AM-FLD-4                      PIC XX.
  3948         16  AM-FLD-5                      PIC XX.
  3949
  3950     12  AM-1ST-PROD-DATE.
  3951         16  AM-1ST-PROD-YR                PIC XX.
  3952         16  AM-1ST-PROD-MO                PIC XX.
  3953         16  AM-1ST-PROD-DA                PIC XX.
  3954     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3955     12  AM-CERTS-PURGED-DATE.
  3956         16  AM-PUR-YR                     PIC XX.
  3957         16  AM-PUR-MO                     PIC XX.
  3958         16  AM-PUR-DA                     PIC XX.
  3959     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3960     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3961     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3962     12  AM-INACTIVE-DATE.
  3963         16  AM-INA-MO                     PIC 99.
  3964         16  AM-INA-DA                     PIC 99.
  3965         16  AM-INA-YR                     PIC 99.
  3966     12  AM-AR-HI-CERT-DATE                PIC XX.
  3967
  3968     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3969     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3970
  3971     12  AM-OB-PAYMENT-MODE                PIC X.
  3972         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3973         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3974         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3975         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3976
  3977     12  AM-AH-ONLY-INDICATOR              PIC X.
  3978         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3979         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3980
  3981     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3982
  3983     12  AM-OVER-SHORT.
  3984         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3985         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3986
  3987     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3988     12  AM-DCC-CLP-STATE                  PIC XX.
  3989
  3990     12  AM-RECALC-COMM                    PIC X.
  3991     12  AM-RECALC-REIN                    PIC X.
  3992
  3993     12  AM-REI-TABLE                      PIC XXX.
  3994     12  AM-REI-ET-LF                      PIC X.
  3995     12  AM-REI-ET-AH                      PIC X.
  3996     12  AM-REI-PE-LF                      PIC X.
  3997     12  AM-REI-PE-AH                      PIC X.
  3998     12  AM-REI-PRT-ST                     PIC X.
  3999     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4000     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL630.cbl
  4001     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4002     12  AM-REI-GROUP-A                    PIC X(6).
  4003     12  AM-REI-MORT                       PIC X(4).
  4004     12  AM-REI-PRT-OW                     PIC X.
  4005     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4006     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4007     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4008     12  AM-REI-GROUP-B                    PIC X(6).
  4009
  4010     12  AM-TRUST-TYPE                     PIC X(2).
  4011
  4012     12  AM-EMPLOYER-STMT-USED             PIC X.
  4013     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4014
  4015     12  AM-STD-AH-TYPE                    PIC XX.
  4016     12  AM-EARN-METHODS.
  4017         16  AM-EARN-METHOD-R              PIC X.
  4018             88 AM-REF-RL-R78                 VALUE 'R'.
  4019             88 AM-REF-RL-PR                  VALUE 'P'.
  4020             88 AM-REF-RL-MEAN                VALUE 'M'.
  4021             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4022         16  AM-EARN-METHOD-L              PIC X.
  4023             88 AM-REF-LL-R78                 VALUE 'R'.
  4024             88 AM-REF-LL-PR                  VALUE 'P'.
  4025             88 AM-REF-LL-MEAN                VALUE 'M'.
  4026             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4027         16  AM-EARN-METHOD-A              PIC X.
  4028             88 AM-REF-AH-R78                 VALUE 'R'.
  4029             88 AM-REF-AH-PR                  VALUE 'P'.
  4030             88 AM-REF-AH-MEAN                VALUE 'M'.
  4031             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4032             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4033             88 AM-REF-AH-NET                 VALUE 'N'.
  4034
  4035     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4036     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4037     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4038
  4039     12  AM-RET-Y-N                        PIC X.
  4040     12  AM-RET-P-E                        PIC X.
  4041     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4042     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4043     12  AM-RET-GRP                        PIC X(6).
  4044     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4045         16  AM-POOL-PRIME                 PIC XXX.
  4046         16  AM-POOL-SUB                   PIC XXX.
  4047     12  AM-RETRO-EARNINGS.
  4048         16  AM-RET-EARN-R                 PIC X.
  4049         16  AM-RET-EARN-L                 PIC X.
  4050         16  AM-RET-EARN-A                 PIC X.
  4051     12  AM-RET-ST-TAX-USE                 PIC X.
  4052         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4053         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4054     12  AM-RETRO-BEG-EARNINGS.
  4055         16  AM-RET-BEG-EARN-R             PIC X.
  4056         16  AM-RET-BEG-EARN-L             PIC X.
  4057         16  AM-RET-BEG-EARN-A             PIC X.
  4058     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL630.cbl
  4059     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4060
  4061     12  AM-USER-SELECT-OPTIONS.
  4062         16  AM-USER-SELECT-1              PIC X(10).
  4063         16  AM-USER-SELECT-2              PIC X(10).
  4064         16  AM-USER-SELECT-3              PIC X(10).
  4065         16  AM-USER-SELECT-4              PIC X(10).
  4066         16  AM-USER-SELECT-5              PIC X(10).
  4067
  4068     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4069
  4070     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4071
  4072     12  AM-RPT045A-SWITCH                 PIC X.
  4073         88  RPT045A-OFF                   VALUE 'N'.
  4074
  4075     12  AM-INSURANCE-LIMITS.
  4076         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4077         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4078
  4079     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4080         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4081
  4082     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4083         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4084         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4085
  4086     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4087
  4088     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4089     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4090     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4091     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4092     12  FILLER                            PIC X(5).
  4093     12  AM-REPORT-CODE-3                  PIC X(10).
  4094*    12  FILLER                            PIC X(22).
  4095
  4096     12  AM-RESERVE-DATE.
  4097         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4098         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4099         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4100
  4101     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4102     12  AM-NOTIFICATION-TYPES.
  4103         16  AM-NOTIF-OF-LETTERS           PIC X.
  4104         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4105         16  AM-NOTIF-OF-REPORTS           PIC X.
  4106         16  AM-NOTIF-OF-STATUS            PIC X.
  4107
  4108     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4109         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4110         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4111         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4112         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4113
  4114     12  AM-BENEFIT-CONTROLS.
  4115         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4116             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL630.cbl
  4117             20  AM-BENEFIT-TYPE           PIC X.
  4118             20  AM-BENEFIT-REVISION       PIC XXX.
  4119             20  AM-BENEFIT-REM-TERM       PIC X.
  4120             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4121             20  FILLER                    PIC XX.
  4122         16  FILLER                        PIC X(80).
  4123
  4124     12  AM-TRANSFER-DATA.
  4125         16  AM-TRANSFERRED-FROM.
  4126             20  AM-TRNFROM-CARRIER        PIC X.
  4127             20  AM-TRNFROM-GROUPING.
  4128                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4129                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4130             20  AM-TRNFROM-STATE          PIC XX.
  4131             20  AM-TRNFROM-ACCOUNT.
  4132                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4133                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4134             20  AM-TRNFROM-DTE            PIC XX.
  4135         16  AM-TRANSFERRED-TO.
  4136             20  AM-TRNTO-CARRIER          PIC X.
  4137             20  AM-TRNTO-GROUPING.
  4138                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4139                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4140             20  AM-TRNTO-STATE            PIC XX.
  4141             20  AM-TRNTO-ACCOUNT.
  4142                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4143                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4144             20  AM-TRNTO-DTE              PIC XX.
  4145         16  FILLER                        PIC X(10).
  4146
  4147     12  AM-SAVED-REMIT-TO                 PIC 99.
  4148
  4149     12  AM-COMM-STRUCTURE-SAVED.
  4150         16  AM-DEFN-1-SAVED.
  4151             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4152                 24  AM-AGT-SV             PIC X(10).
  4153                 24  AM-COM-TYP-SV         PIC X.
  4154                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4155                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4156                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4157                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4158                 24  FILLER                PIC X.
  4159                 24  AM-GL-CODES-SV        PIC X.
  4160                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4161                 24  FILLER                PIC X.
  4162         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4163             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4164                 24  FILLER                PIC X(11).
  4165                 24  AM-L-COMA-SV          PIC XXX.
  4166                 24  AM-J-COMA-SV          PIC XXX.
  4167                 24  AM-A-COMA-SV          PIC XXX.
  4168                 24  FILLER                PIC X(6).
  4169
  4170     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4171         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4172            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4173            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4174            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL630.cbl
  4175
  4176     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4177     12  FILLER                            PIC X(120).
  4178
  4179     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4180         16  AM-CONTROL-NAME               PIC X(30).
  4181         16  AM-EXECUTIVE-ONE.
  4182             20  AM-EXEC1-NAME             PIC X(15).
  4183             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4184                                                          COMP-3.
  4185             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4186                                                          COMP-3.
  4187         16  AM-EXECUTIVE-TWO.
  4188             20  AM-EXEC2-NAME             PIC X(15).
  4189             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4190                                                          COMP-3.
  4191             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4192                                                          COMP-3.
  4193
  4194     12  AM-RETRO-ADDITIONAL-DATA.
  4195         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4196         16  AM-RETRO-PREM-P-E             PIC X.
  4197         16  AM-RETRO-CLMS-P-I             PIC X.
  4198         16  AM-RETRO-RET-BRACKET-LF.
  4199             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4200                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4201                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4202             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4203                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4204                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4205             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4206                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4207                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4208         16  AM-RETRO-RET-BRACKET-AH.
  4209             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4210                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4211                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4212                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4213             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4214                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4215                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4216             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4217                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4218                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4219
  4220     12  AM-COMMENTS.
  4221         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4222
  4223     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4224         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4225         16  AM-FLI-BILLING-CODE           PIC X.
  4226         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4227         16  AM-FLI-UNITED-IDENT           PIC X.
  4228         16  AM-FLI-INTEREST-LOST-DATA.
  4229             20  AM-FLI-BANK-NO            PIC X(5).
  4230             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4231             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4232             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL630.cbl
  4233         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4234             20  AM-FLI-AGT                PIC X(9).
  4235             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4236             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4237         16  FILLER                        PIC X(102).
  4238
  4239     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4240         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4241             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4242             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4243             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4244             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4245             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4246         16  FILLER                          PIC X(10).
  4247******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL630.cbl
  4249*    COPY ELCCERT.
  4250******************************************************************
  4251*                                                                *
  4252*                            ELCCERT.                            *
  4253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4254*                            VMOD=2.013                          *
  4255*                                                                *
  4256*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4257*                                                                *
  4258*   FILE TYPE = VSAM,KSDS                                        *
  4259*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4260*                                                                *
  4261*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4262*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4263*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4264*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4265*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4266*                                                                *
  4267*   LOG = YES                                                    *
  4268*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4269******************************************************************
  4270*                   C H A N G E   L O G
  4271*
  4272* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4273*-----------------------------------------------------------------
  4274*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4275* EFFECTIVE    NUMBER
  4276*-----------------------------------------------------------------
  4277* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4278* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4279* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4280* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4281* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4282* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4283* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4284******************************************************************
  4285
  4286 01  CERTIFICATE-MASTER.
  4287     12  CM-RECORD-ID                      PIC XX.
  4288         88  VALID-CM-ID                      VALUE 'CM'.
  4289
  4290     12  CM-CONTROL-PRIMARY.
  4291         16  CM-COMPANY-CD                 PIC X.
  4292         16  CM-CARRIER                    PIC X.
  4293         16  CM-GROUPING.
  4294             20  CM-GROUPING-PREFIX        PIC X(3).
  4295             20  CM-GROUPING-PRIME         PIC X(3).
  4296         16  CM-STATE                      PIC XX.
  4297         16  CM-ACCOUNT.
  4298             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4299             20  CM-ACCOUNT-PRIME          PIC X(6).
  4300         16  CM-CERT-EFF-DT                PIC XX.
  4301         16  CM-CERT-NO.
  4302             20  CM-CERT-PRIME             PIC X(10).
  4303             20  CM-CERT-SFX               PIC X.
  4304
  4305     12  CM-CONTROL-BY-NAME.
  4306         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL630.cbl
  4307         16  CM-INSURED-LAST-NAME          PIC X(15).
  4308         16  CM-INSURED-INITIALS.
  4309             20  CM-INSURED-INITIAL1       PIC X.
  4310             20  CM-INSURED-INITIAL2       PIC X.
  4311
  4312     12  CM-CONTROL-BY-SSN.
  4313         16  CM-COMPANY-CD-A2              PIC X.
  4314         16  CM-SOC-SEC-NO.
  4315             20  CM-SSN-STATE              PIC XX.
  4316             20  CM-SSN-ACCOUNT            PIC X(6).
  4317             20  CM-SSN-LN3.
  4318                 25  CM-INSURED-INITIALS-A2.
  4319                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4320                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4321                 25 CM-PART-LAST-NAME-A2         PIC X.
  4322
  4323     12  CM-CONTROL-BY-CERT-NO.
  4324         16  CM-COMPANY-CD-A4              PIC X.
  4325         16  CM-CERT-NO-A4                 PIC X(11).
  4326
  4327     12  CM-CONTROL-BY-MEMB.
  4328         16  CM-COMPANY-CD-A5              PIC X.
  4329         16  CM-MEMBER-NO.
  4330             20  CM-MEMB-STATE             PIC XX.
  4331             20  CM-MEMB-ACCOUNT           PIC X(6).
  4332             20  CM-MEMB-LN4.
  4333                 25  CM-INSURED-INITIALS-A5.
  4334                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4335                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4336                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4337
  4338     12  CM-INSURED-PROFILE-DATA.
  4339         16  CM-INSURED-FIRST-NAME.
  4340             20  CM-INSURED-1ST-INIT       PIC X.
  4341             20  FILLER                    PIC X(9).
  4342         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4343         16  CM-INSURED-SEX                PIC X.
  4344             88  CM-SEX-MALE                  VALUE 'M'.
  4345             88  CM-SEX-FEMAL                 VALUE 'F'.
  4346         16  CM-INSURED-JOINT-AGE          PIC 99.
  4347         16  CM-JOINT-INSURED-NAME.
  4348             20  CM-JT-LAST-NAME           PIC X(15).
  4349             20  CM-JT-FIRST-NAME.
  4350                 24  CM-JT-1ST-INIT        PIC X.
  4351                 24  FILLER                PIC X(9).
  4352             20  CM-JT-INITIAL             PIC X.
  4353
  4354     12  CM-LIFE-DATA.
  4355         16  CM-LF-BENEFIT-CD              PIC XX.
  4356         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4357         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4358         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4359         16  CM-LF-DEV-CODE                PIC XXX.
  4360         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4361         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4362         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4363         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4364         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL630.cbl
  4365         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4366         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4367         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4368         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4369         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4370         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4371         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4372         16  FILLER                        PIC XX.
  4373
  4374     12  CM-AH-DATA.
  4375         16  CM-AH-BENEFIT-CD              PIC XX.
  4376         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4377         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4378         16  CM-AH-DEV-CODE                PIC XXX.
  4379         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4380         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4381         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4382         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4383         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4384         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4385         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4386         16  CM-AH-PAID-THRU-DT            PIC XX.
  4387             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4388         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4389         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4390         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4391         16  FILLER                        PIC X.
  4392
  4393     12  CM-LOAN-INFORMATION.
  4394         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4395         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4396         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4397         16  CM-PAY-FREQUENCY              PIC S99.
  4398         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4399         16  CM-RATE-CLASS                 PIC XX.
  4400         16  CM-BENEFICIARY                PIC X(25).
  4401         16  CM-POLICY-FORM-NO             PIC X(12).
  4402         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4403         16  CM-LAST-ADD-ON-DT             PIC XX.
  4404         16  CM-DEDUCTIBLE-AMOUNTS.
  4405             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4406             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4407         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4408             20  CM-RESIDENT-STATE         PIC XX.
  4409             20  CM-RATE-CODE              PIC X(4).
  4410             20  FILLER                    PIC XX.
  4411         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4412             20  CM-LOAN-OFFICER           PIC X(5).
  4413             20  FILLER                    PIC XXX.
  4414         16  CM-CSR-CODE                   PIC XXX.
  4415         16  CM-UNDERWRITING-CODE          PIC X.
  4416             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4417         16  CM-POST-CARD-IND              PIC X.
  4418         16  CM-NH-INTERFACE-SW            PIC X.
  4419         16  CM-PREMIUM-TYPE               PIC X.
  4420             88  CM-SING-PRM                  VALUE '1'.
  4421             88  CM-O-B-COVERAGE              VALUE '2'.
  4422             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL630.cbl
  4423         16  CM-IND-GRP-TYPE               PIC X.
  4424             88  CM-INDIVIDUAL                VALUE 'I'.
  4425             88  CM-GROUP                     VALUE 'G'.
  4426         16  CM-SKIP-CODE                  PIC X.
  4427             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4428             88  SKIP-JULY                    VALUE '1'.
  4429             88  SKIP-AUGUST                  VALUE '2'.
  4430             88  SKIP-SEPTEMBER               VALUE '3'.
  4431             88  SKIP-JULY-AUG                VALUE '4'.
  4432             88  SKIP-AUG-SEPT                VALUE '5'.
  4433             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4434             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4435             88  SKIP-JUNE                    VALUE '8'.
  4436             88  SKIP-JUNE-JULY               VALUE '9'.
  4437             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4438             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4439         16  CM-PAYMENT-MODE               PIC X.
  4440             88  PAY-MONTHLY                  VALUE SPACE.
  4441             88  PAY-WEEKLY                   VALUE '1'.
  4442             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4443             88  PAY-BI-WEEKLY                VALUE '3'.
  4444             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4445         16  CM-LOAN-NUMBER                PIC X(8).
  4446         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4447         16  CM-OLD-LOF                    PIC XXX.
  4448*        16  CM-LOAN-OFFICER               PIC XXX.
  4449         16  CM-REIN-TABLE                 PIC XXX.
  4450         16  CM-SPECIAL-REIN-CODE          PIC X.
  4451         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4452         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4453         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4454
  4455     12  CM-STATUS-DATA.
  4456         16  CM-ENTRY-STATUS               PIC X.
  4457         16  CM-ENTRY-DT                   PIC XX.
  4458
  4459         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4460         16  CM-LF-CANCEL-DT               PIC XX.
  4461         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4462
  4463         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4464         16  CM-LF-DEATH-DT                PIC XX.
  4465         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4466
  4467         16  CM-LF-CURRENT-STATUS          PIC X.
  4468             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4469                                                'M' '4' '5' '9'.
  4470             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4471             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4472             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4473             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4474             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4475             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4476             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4477             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4478             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4479             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4480             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL630.cbl
  4481             88  CM-LF-VOIDED                 VALUE 'V'.
  4482
  4483         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4484         16  CM-AH-CANCEL-DT               PIC XX.
  4485         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4486
  4487         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4488         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4489         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4490
  4491         16  CM-AH-CURRENT-STATUS          PIC X.
  4492             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4493                                                'M' '4' '5' '9'.
  4494             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4495             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4496             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4497             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4498             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4499             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4500             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4501             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4502             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4503             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4504             88  CM-AH-DECLINED               VALUE 'D'.
  4505             88  CM-AH-VOIDED                 VALUE 'V'.
  4506
  4507         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4508             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4509             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4510             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4511         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4512
  4513         16  CM-ENTRY-BATCH                PIC X(6).
  4514         16  CM-LF-EXIT-BATCH              PIC X(6).
  4515         16  CM-AH-EXIT-BATCH              PIC X(6).
  4516         16  CM-LAST-MONTH-END             PIC XX.
  4517
  4518     12  CM-NOTE-SW                        PIC X.
  4519         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4520         88  CERT-NOTES-PRESENT               VALUE '1'.
  4521         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4522         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4523         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4524         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4525         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4526         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4527     12  CM-COMP-EXCP-SW                   PIC X.
  4528         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4529         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4530     12  CM-INSURED-ADDRESS-SW             PIC X.
  4531         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4532         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4533
  4534*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4535     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4536     12  FILLER                            PIC X.
  4537
  4538*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL630.cbl
  4539     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4540     12  FILLER                            PIC X.
  4541*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4542     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4543
  4544     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4545         88  CERT-ADDED-BATCH                 VALUE ' '.
  4546         88  CERT-ADDED-ONLINE                VALUE '1'.
  4547         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4548         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4549         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4550     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4551         88  CERT-AS-LOADED                   VALUE ' '.
  4552         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4553         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4554         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4555         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4556         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4557         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4558         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4559
  4560     12  CM-ACCOUNT-COMM-PCTS.
  4561         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4562         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4563
  4564     12  CM-USER-FIELD                     PIC X.
  4565     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4566     12  CM-CLP-STATE                      PIC XX.
  4567     12  CM-USER-RESERVED                  PIC XXX.
  4568******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL630.cbl
  4570*    COPY ERCNOTE.
  4571******************************************************************
  4572*                                                                *
  4573*                                                                *
  4574*                            ERCNOTE                             *
  4575*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4576*                            VMOD=2.003                          *
  4577*                                                                *
  4578*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  4579*                                                                *
  4580*        FILE TYPE= VSAM,KSDS                                    *
  4581*        RECORD SIZE = 825    RECFORM = FIXED                    *
  4582*                                                                *
  4583*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  4584*                                                                *
  4585*        LOG = YES                                               *
  4586*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4587*                                                                *
  4588******************************************************************
  4589*                   C H A N G E   L O G
  4590*
  4591* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4592*-----------------------------------------------------------------
  4593*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4594* EFFECTIVE    NUMBER
  4595*-----------------------------------------------------------------
  4596* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  4597*                                FILE WILL CONTAIN BILLING NOTES O
  4598******************************************************************
  4599
  4600 01  CERTIFICATE-NOTE.
  4601     12  CN-RECORD-ID                PIC  XX.
  4602         88  VALID-CN-ID                  VALUE 'CN'.
  4603
  4604     12  CN-CONTROL-PRIMARY.
  4605         16  CN-COMPANY-CD           PIC X.
  4606         16  CN-CARRIER              PIC X.
  4607         16  CN-GROUPING.
  4608             20 CN-GROUPING-PREFIX   PIC XXX.
  4609             20 CN-GROUPING-PRIME    PIC XXX.
  4610         16  CN-STATE                PIC XX.
  4611         16  CN-ACCOUNT.
  4612             20 CN-ACCOUNT-PREFIX    PIC X(4).
  4613             20 CN-ACCOUNT-PRIME     PIC X(6).
  4614         16  CN-CERT-EFF-DT          PIC XX.
  4615         16  CN-CERT-NO.
  4616             20  CN-CERT-PRIME       PIC X(10).
  4617             20  CN-CERT-SFX         PIC X.
  4618
  4619     12  CN-BILLING-START-LINE-NO    PIC 99.
  4620     12  CN-BILLING-END-LINE-NO      PIC 99.
  4621
  4622     12  CN-LINES.
  4623         16  CN-LINE OCCURS 10       PIC X(77).
  4624
  4625     12  CN-LAST-MAINT-DT            PIC XX.
  4626     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  4627     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL630.cbl
  4628     12  FILLER                      PIC X(6).
  4629******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL630.cbl
  4631*    COPY ERCMAIL.
  4632******************************************************************
  4633*                                                                *
  4634*                                                                *
  4635*                            ERCMAIL                             *
  4636*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4637*                            VMOD=2.003                          *
  4638*                                                                *
  4639*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  4640*                                                                *
  4641*   FILE TYPE = VSAM,KSDS                                        *
  4642*   RECORD SIZE = 374   RECFORM = FIX                            *
  4643*                                                                *
  4644*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  4645*   ALTERNATE PATH    = NOT USED                                 *
  4646*                                                                *
  4647*   LOG = YES                                                    *
  4648*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4649******************************************************************
  4650*                   C H A N G E   L O G
  4651*
  4652* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4653*-----------------------------------------------------------------
  4654*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4655* EFFECTIVE    NUMBER
  4656*-----------------------------------------------------------------
  4657* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4658* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4659* 111108                   PEMA  ADD CRED BENE ADDR2
  4660******************************************************************
  4661
  4662 01  MAILING-DATA.
  4663     12  MA-RECORD-ID                      PIC XX.
  4664         88  VALID-MA-ID                       VALUE 'MA'.
  4665
  4666     12  MA-CONTROL-PRIMARY.
  4667         16  MA-COMPANY-CD                 PIC X.
  4668         16  MA-CARRIER                    PIC X.
  4669         16  MA-GROUPING.
  4670             20  MA-GROUPING-PREFIX        PIC XXX.
  4671             20  MA-GROUPING-PRIME         PIC XXX.
  4672         16  MA-STATE                      PIC XX.
  4673         16  MA-ACCOUNT.
  4674             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4675             20  MA-ACCOUNT-PRIME          PIC X(6).
  4676         16  MA-CERT-EFF-DT                PIC XX.
  4677         16  MA-CERT-NO.
  4678             20  MA-CERT-PRIME             PIC X(10).
  4679             20  MA-CERT-SFX               PIC X.
  4680
  4681     12  FILLER                            PIC XX.
  4682
  4683     12  MA-ACCESS-CONTROL.
  4684         16  MA-SOURCE-SYSTEM              PIC XX.
  4685             88  MA-FROM-CREDIT                VALUE 'CR'.
  4686             88  MA-FROM-VSI                   VALUE 'VS'.
  4687             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4688             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL630.cbl
  4689         16  MA-RECORD-ADD-DT              PIC XX.
  4690         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4691         16  MA-LAST-MAINT-DT              PIC XX.
  4692         16  MA-LAST-MAINT-BY              PIC XXXX.
  4693         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4694
  4695     12  MA-PROFILE-INFO.
  4696         16  MA-QUALIFY-CODE-1             PIC XX.
  4697         16  MA-QUALIFY-CODE-2             PIC XX.
  4698         16  MA-QUALIFY-CODE-3             PIC XX.
  4699         16  MA-QUALIFY-CODE-4             PIC XX.
  4700         16  MA-QUALIFY-CODE-5             PIC XX.
  4701
  4702         16  MA-INSURED-LAST-NAME          PIC X(15).
  4703         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4704         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4705         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4706         16  MA-INSURED-BIRTH-DT           PIC XX.
  4707         16  MA-INSURED-SEX                PIC X.
  4708             88  MA-SEX-MALE                   VALUE 'M'.
  4709             88  MA-SEX-FEMALE                 VALUE 'F'.
  4710         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4711
  4712         16  MA-ADDRESS-CORRECTED          PIC X.
  4713         16  MA-JOINT-BIRTH-DT             PIC XX.
  4714*        16  FILLER                        PIC X(12).
  4715
  4716         16  MA-ADDRESS-LINE-1             PIC X(30).
  4717         16  MA-ADDRESS-LINE-2             PIC X(30).
  4718         16  MA-CITY-STATE.
  4719             20  MA-CITY                   PIC X(28).
  4720             20  MA-ADDR-STATE             PIC XX.
  4721         16  MA-ZIP.
  4722             20  MA-ZIP-CODE.
  4723                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4724                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4725                 24  FILLER                PIC X(4).
  4726             20  MA-ZIP-PLUS4              PIC X(4).
  4727         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4728             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4729             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4730             20  FILLER                    PIC X(3).
  4731
  4732         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4733
  4734         16  FILLER                        PIC XXX.
  4735*        16  FILLER                        PIC X(10).
  4736
  4737     12  MA-CRED-BENE-INFO.
  4738         16  MA-CRED-BENE-NAME                 PIC X(25).
  4739         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4740         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4741         16  MA-CRED-BENE-CTYST.
  4742             20  MA-CRED-BENE-CITY             PIC X(28).
  4743             20  MA-CRED-BENE-STATE            PIC XX.
  4744         16  MA-CRED-BENE-ZIP.
  4745             20  MA-CB-ZIP-CODE.
  4746                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL630.cbl
  4747                     88  MA-CB-CANADIAN-POST-CODE
  4748                                           VALUE 'A' THRU 'Z'.
  4749                 24  FILLER                    PIC X(4).
  4750             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4751         16  MA-CB-CANADIAN-POSTAL-CODE
  4752                            REDEFINES MA-CRED-BENE-ZIP.
  4753             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4754             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4755             20  FILLER                        PIC X(3).
  4756     12  MA-POST-CARD-MAIL-DATA.
  4757         16  MA-MAIL-DATA OCCURS 7.
  4758             20  MA-MAIL-TYPE              PIC X.
  4759                 88  MA-12MO-MAILING           VALUE '1'.
  4760                 88  MA-EXP-MAILING            VALUE '2'.
  4761             20  MA-MAIL-STATUS            PIC X.
  4762                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4763                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4764                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4765             20  MA-MAIL-DATE              PIC XX.
  4766     12  FILLER                            PIC XX.
  4767     12  FILLER                            PIC XX.
  4768*    12  FILLER                            PIC X(30).
  4769******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL630.cbl
  4771*    COPY ERCPNDM.
  4772******************************************************************
  4773*                                                                *
  4774*                                                                *
  4775*                            ERCPNDM                             *
  4776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4777*                            VMOD=2.003                          *
  4778*                                                                *
  4779*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  4780*                                                                *
  4781*   FILE TYPE = VSAM,KSDS                                        *
  4782*   RECORD SIZE = 374   RECFORM = FIX                            *
  4783*                                                                *
  4784*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  4785*   ALTERNATE PATH    = NOT USED                                 *
  4786*                                                                *
  4787*   LOG = YES                                                    *
  4788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4789******************************************************************
  4790*                   C H A N G E   L O G
  4791*
  4792* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4793*-----------------------------------------------------------------
  4794*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4795* EFFECTIVE    NUMBER
  4796*-----------------------------------------------------------------
  4797* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4798* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  4799* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4800******************************************************************
  4801
  4802 01  PENDING-MAILING-DATA.
  4803     12  PM-RECORD-ID                      PIC XX.
  4804         88  VALID-MA-ID                       VALUE 'PM'.
  4805
  4806     12  PM-CONTROL-PRIMARY.
  4807         16  PM-COMPANY-CD                 PIC X.
  4808         16  PM-ENTRY-BATCH                PIC X(6).
  4809         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  4810         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  4811
  4812     12  FILLER                            PIC X(14).
  4813
  4814     12  PM-ACCESS-CONTROL.
  4815         16  PM-SOURCE-SYSTEM              PIC XX.
  4816             88  PM-FROM-CREDIT                VALUE 'CR'.
  4817             88  PM-FROM-VSI                   VALUE 'VS'.
  4818             88  PM-FROM-WARRANTY              VALUE 'WA'.
  4819             88  PM-FROM-OTHER                 VALUE 'OT'.
  4820         16  PM-RECORD-ADD-DT              PIC XX.
  4821         16  PM-RECORD-ADDED-BY            PIC XXXX.
  4822         16  PM-LAST-MAINT-DT              PIC XX.
  4823         16  PM-LAST-MAINT-BY              PIC XXXX.
  4824         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4825
  4826     12  PM-PROFILE-INFO.
  4827         16  PM-QUALIFY-CODE-1             PIC XX.
  4828         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL630.cbl
  4829         16  PM-QUALIFY-CODE-3             PIC XX.
  4830         16  PM-QUALIFY-CODE-4             PIC XX.
  4831         16  PM-QUALIFY-CODE-5             PIC XX.
  4832
  4833         16  PM-INSURED-LAST-NAME          PIC X(15).
  4834         16  PM-INSURED-FIRST-NAME         PIC X(10).
  4835         16  PM-INSURED-MIDDLE-INIT        PIC X.
  4836         16  PM-INSURED-ISSUE-AGE          PIC 99.
  4837         16  PM-INSURED-BIRTH-DT           PIC XX.
  4838         16  PM-INSURED-SEX                PIC X.
  4839             88  PM-SEX-MALE                   VALUE 'M'.
  4840             88  PM-SEX-FEMALE                 VALUE 'F'.
  4841         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  4842
  4843         16  PM-ADDRESS-CORRECTED          PIC X.
  4844         16  PM-JOINT-BIRTH-DT             PIC XX.
  4845*        16  FILLER                        PIC X(12).
  4846
  4847         16  PM-ADDRESS-LINE-1             PIC X(30).
  4848         16  PM-ADDRESS-LINE-2             PIC X(30).
  4849         16  PM-CITY-STATE.
  4850             20  PM-CITY                   PIC X(28).
  4851             20  PM-STATE                  PIC XX.
  4852         16  PM-ZIP.
  4853             20  PM-ZIP-CODE.
  4854                 24  PM-ZIP-1              PIC X.
  4855                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4856                 24  FILLER                PIC X(4).
  4857             20  PM-ZIP-PLUS4              PIC X(4).
  4858         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  4859             20  PM-CAN-POST1              PIC XXX.
  4860             20  PM-CAN-POST2              PIC XXX.
  4861             20  FILLER                    PIC XXX.
  4862
  4863         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  4864
  4865         16  FILLER                        PIC X(03).
  4866
  4867     12  PM-CRED-BENE-INFO.
  4868         16  PM-CRED-BENE-NAME             PIC X(25).
  4869         16  PM-CRED-BENE-ADDR             PIC X(30).
  4870         16  PM-CRED-BENE-ADDR2            PIC X(30).
  4871         16  PM-CRED-BENE-CTYST.
  4872             20  PM-CRED-BENE-CITY         PIC X(28).
  4873             20  PM-CRED-BENE-STATE        PIC XX.
  4874         16  PM-CRED-BENE-ZIP.
  4875             20  PM-CB-ZIP-CODE.
  4876                 24  PM-CB-ZIP-1           PIC X.
  4877                     88  PM-CB-CANADIAN-POST-CODE
  4878                                  VALUE 'A' THRU 'Z'.
  4879                 24  FILLER                PIC X(4).
  4880             20  PM-CB-ZIP-PLUS4           PIC X(4).
  4881         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  4882             20  PM-CB-CAN-POST1           PIC XXX.
  4883             20  PM-CB-CAN-POST2           PIC XXX.
  4884             20  FILLER                    PIC XXX.
  4885     12  PM-POST-CARD-MAIL-DATA.
  4886         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL630.cbl
  4887             20  PM-MAIL-TYPE              PIC X.
  4888                 88  PM-12MO-MAILING           VALUE '1'.
  4889                 88  PM-EXP-MAILING            VALUE '2'.
  4890             20  PM-MAIL-STATUS            PIC X.
  4891                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  4892                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  4893                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  4894             20  PM-MAIL-DATE              PIC XX.
  4895     12  FILLER                            PIC XX.
  4896     12  FILLER                            PIC X(12).
  4897*    12  FILLER                            PIC X(30).
  4898
  4899******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL630.cbl
  4901*    COPY ERCCOMP.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ERCCOMP                             *
  4906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4907*                            VMOD=2.019                          *
  4908*                                                                *
  4909*   ONLINE CREDIT SYSTEM                                         *
  4910*                                                                *
  4911*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4912*                                                                *
  4913*   FILE TYPE = VSAM,KSDS                                        *
  4914*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4915*                                                                *
  4916*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4917*       ALTERNATE PATH = NONE                                    *
  4918*                                                                *
  4919*   LOG = NO                                                     *
  4920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4921*                                                                *
  4922******************************************************************
  4923*                   C H A N G E   L O G
  4924*
  4925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4926*-----------------------------------------------------------------
  4927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4928* EFFECTIVE    NUMBER
  4929*-----------------------------------------------------------------
  4930* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4931* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4932* 092205    2005050300006  PEMA  ADD LEASE FEE
  4933* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4934* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4935* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4936* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4937* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4938******************************************************************
  4939
  4940 01  COMPENSATION-MASTER.
  4941     12  CO-RECORD-ID                          PIC XX.
  4942         88  VALID-CO-ID                          VALUE 'CO'.
  4943
  4944     12  CO-CONTROL-PRIMARY.
  4945         16  CO-COMPANY-CD                     PIC X.
  4946         16  CO-CONTROL.
  4947             20  CO-CTL-1.
  4948                 24  CO-CARR-GROUP.
  4949                     28  CO-CARRIER            PIC X.
  4950                     28  CO-GROUPING.
  4951                         32  CO-GROUP-PREFIX   PIC XXX.
  4952                         32  CO-GROUP-PRIME    PIC XXX.
  4953                 24  CO-RESP-NO.
  4954                     28  CO-RESP-PREFIX        PIC X(4).
  4955                     28  CO-RESP-PRIME         PIC X(6).
  4956             20  CO-CTL-2.
  4957                 24  CO-ACCOUNT.
  4958                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL630.cbl
  4959                     28  CO-ACCT-PRIME         PIC X(6).
  4960         16  CO-TYPE                           PIC X.
  4961             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4962             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4963             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4964
  4965     12  CO-MAINT-INFORMATION.
  4966         16  CO-LAST-MAINT-DT                  PIC XX.
  4967         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4968         16  CO-LAST-MAINT-USER                PIC X(4).
  4969     12  FILLER                                PIC XX.
  4970     12  CO-STMT-TYPE                          PIC XXX.
  4971     12  CO-COMP-TYPE                          PIC X.
  4972         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4973     12  CO-STMT-OWNER                         PIC X(4).
  4974     12  CO-BALANCE-CONTROL                    PIC X.
  4975         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4976         88  CO-NO-BALANCE                        VALUE 'N'.
  4977
  4978     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4979         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4980         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4981         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4982
  4983     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4984         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4985         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4986
  4987     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4988     12  CO-GA-DIRECT-DEP                      PIC X.
  4989     12  CO-FUTURE-SPACE                       PIC X.
  4990         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4991
  4992     12  CO-ACCT-NAME                          PIC X(30).
  4993     12  CO-MAIL-NAME                          PIC X(30).
  4994     12  CO-ADDR-1                             PIC X(30).
  4995     12  CO-ADDR-2                             PIC X(30).
  4996     12  CO-ADDR-3.
  4997         16  CO-ADDR-CITY                      PIC X(27).
  4998         16  CO-ADDR-STATE                     PIC XX.
  4999     12  CO-CSO-1099                           PIC X.
  5000     12  CO-ZIP.
  5001         16  CO-ZIP-PRIME.
  5002             20  CO-ZIP-PRI-1ST                PIC X.
  5003                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5004             20  FILLER                        PIC X(4).
  5005         16  CO-ZIP-PLUS4                      PIC X(4).
  5006     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5007         16  CO-CAN-POSTAL-1                   PIC XXX.
  5008         16  CO-CAN-POSTAL-2                   PIC XXX.
  5009         16  FILLER                            PIC XXX.
  5010     12  CO-SOC-SEC                            PIC X(13).
  5011     12  CO-TELEPHONE.
  5012         16  CO-AREA-CODE                      PIC XXX.
  5013         16  CO-PREFIX                         PIC XXX.
  5014         16  CO-PHONE                          PIC X(4).
  5015
  5016     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL630.cbl
  5017
  5018     12  CO-AR-BAL-LEVEL                       PIC X.
  5019         88  CO-AR-REF-LVL                        VALUE '1'.
  5020         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5021         88  CO-AR-BILL-LVL                       VALUE '2'.
  5022         88  CO-AR-AGT-LVL                        VALUE '3'.
  5023         88  CO-AR-FR-LVL                         VALUE '4'.
  5024
  5025     12  CO-AR-NORMAL-PRINT                    PIC X.
  5026         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5027         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5028
  5029     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5030
  5031     12  CO-AR-REPORTING                       PIC X.
  5032         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5033         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5034
  5035     12  CO-AR-PULL-CHECK                      PIC X.
  5036         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5037         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5038
  5039     12  CO-AR-BALANCE-PRINT                   PIC X.
  5040         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5041
  5042     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5043         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5044         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5045         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5046
  5047     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5048
  5049     12  CO-USER-CODE                          PIC X.
  5050     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5051
  5052******************************************************************
  5053*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5054*    THE LAST MONTH END RUN.
  5055******************************************************************
  5056
  5057     12  CO-LAST-ACTIVITY-DATE.
  5058         16  CO-ACT-YEAR                       PIC 99.
  5059         16  CO-ACT-MONTH                      PIC 99.
  5060         16  CO-ACT-DAY                        PIC 99.
  5061
  5062     12  CO-LAST-STMT-DT.
  5063         16  CO-LAST-STMT-YEAR                 PIC 99.
  5064         16  CO-LAST-STMT-MONTH                PIC 99.
  5065         16  CO-LAST-STMT-DAY                  PIC 99.
  5066
  5067     12  CO-MO-END-TOTALS.
  5068         16  CO-MONTHLY-TOTALS.
  5069             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5070             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5071             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5072             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5073             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  5074
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL630.cbl
  5075         16  CO-AGING-TOTALS.
  5076             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5077             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5078             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5079             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5080
  5081         16  CO-YTD-TOTALS.
  5082             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5083             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5084
  5085         16  CO-OVER-UNDER-TOTALS.
  5086             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5087             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5088
  5089     12  CO-MISCELLANEOUS-TOTALS.
  5090         16  CO-FICA-TOTALS.
  5091             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5092             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5093
  5094         16  CO-CLAIM-TOTALS.
  5095             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5096             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5097
  5098******************************************************************
  5099*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5100*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5101******************************************************************
  5102
  5103     12  CO-CURRENT-TOTALS.
  5104         16  CO-CURRENT-LAST-STMT-DT.
  5105             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5106             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5107             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5108
  5109         16  CO-CURRENT-MONTHLY-TOTALS.
  5110             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5111             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5112             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5113             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5114             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5115
  5116         16  CO-CURRENT-AGING-TOTALS.
  5117             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5118             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5119             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5120             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5121
  5122         16  CO-CURRENT-YTD-TOTALS.
  5123             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5124             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5125
  5126     12  CO-PAID-COMM-TOTALS.
  5127         16  CO-YTD-PAID-COMMS.
  5128             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5129             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5130
  5131     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  5132         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL630.cbl
  5133         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5134
  5135     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5136         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5137         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5138         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5139         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5140         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5141         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5142         88  CO-FINAL-LETTER                  VALUE 'F'.
  5143         88  CO-RECONCILING                   VALUE 'R'.
  5144         88  CO-PHONE-CALL                    VALUE 'P'.
  5145         88  CO-LEGAL                         VALUE 'L'.
  5146         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5147         88  CO-WRITE-OFF                     VALUE 'W'.
  5148         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5149
  5150     12  CO-CSR-CODE                       PIC X(4).
  5151
  5152     12  CO-GA-STATUS-INFO.
  5153         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5154         16  CO-GA-TERMINATION-DT          PIC XX.
  5155         16  CO-GA-STATUS-CODE             PIC X.
  5156             88  CO-GA-ACTIVE                 VALUE 'A'.
  5157             88  CO-GA-INACTIVE               VALUE 'I'.
  5158             88  CO-GA-PENDING                VALUE 'P'.
  5159         16  CO-GA-COMMENTS.
  5160             20  CO-GA-COMMENT-1           PIC X(40).
  5161             20  CO-GA-COMMENT-2           PIC X(40).
  5162             20  CO-GA-COMMENT-3           PIC X(40).
  5163             20  CO-GA-COMMENT-4           PIC X(40).
  5164
  5165     12  CO-RPTCD2                         PIC X(10).
  5166
  5167     12  CO-TYPE-AGENT                     PIC X(01).
  5168         88  CO-CORPORATION                   VALUE 'C'.
  5169         88  CO-PARTNERSHIP                   VALUE 'P'.
  5170         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5171         88  CO-TRUST                         VALUE 'T'.
  5172         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5173
  5174     12  CO-FAXNO.
  5175         16  CO-FAX-AREA-CODE                  PIC XXX.
  5176         16  CO-FAX-PREFIX                     PIC XXX.
  5177         16  CO-FAX-PHONE                      PIC X(4).
  5178
  5179     12  CO-BANK-INFORMATION.
  5180         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5181         16  CO-BANK-TRANSIT-NON REDEFINES
  5182             CO-BANK-TRANSIT-NO                PIC 9(8).
  5183
  5184         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5185     12  CO-MISC-DEDUCT-INFO REDEFINES
  5186                  CO-BANK-INFORMATION.
  5187         16  CO-MD-GL-ACCT                     PIC X(10).
  5188         16  CO-MD-DIV                         PIC XX.
  5189         16  CO-MD-CENTER                      PIC X(4).
  5190         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL630.cbl
  5191         16  CO-CREATE-AP-CHECK                PIC X.
  5192         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5193         16  FILLER                            PIC XXX.
  5194     12  CO-ACH-STATUS                         PIC X.
  5195         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5196         88  CO-ACH-PENDING                        VALUE 'P'.
  5197
  5198     12  CO-BILL-SW                            PIC X.
  5199     12  CO-CONTROL-NAME                       PIC X(30).
  5200     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5201     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5202     12  CO-CLP-STATE                          PIC XX.
  5203     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5204     12  CO-SPP-REFUND-EDIT                    PIC X.
  5205
  5206******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL630.cbl
  5208*    COPY ERCRQST.
  5209******************************************************************
  5210*                                                                *
  5211*                                                                *
  5212*                            ERCRQST.                            *
  5213*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5214*                            VMOD=2.002                          *
  5215*                                                                *
  5216*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5217*                                                                *
  5218*   FILE TYPE = VSAM,KSDS                                        *
  5219*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5220*                                                                *
  5221*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5222*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5223*                                   ACCOUNT, REF, BATCH)         *
  5224*                                                RKP=9, LEN=38   *
  5225*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5226*                                   ACCOUNT, REF, BATCH)         *
  5227*                                                RKP=47, LEN=46  *
  5228*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5229*                                   BATCH)                       *
  5230*                                                RKP=93, LEN=24  *
  5231*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5232*                                   REF, BATCH)                  *
  5233*                                                RKP=117, LEN=35 *
  5234*   LOG = NO                                                     *
  5235*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5236******************************************************************
  5237
  5238 01  AR-REQUEST-RECORD.
  5239     12  RQ-RECORD-ID                     PIC XX.
  5240         88  VALID-RQ-ID                        VALUE 'RQ'.
  5241
  5242     12  RQ-CONTROL-PRIMARY.
  5243         16  RQ-COMPANY-CD                PIC X.
  5244         16  RQ-ENTRY-BATCH               PIC X(6).
  5245
  5246     12  RQ-CONTROL-BY-ACCT-REF.
  5247         16  RQ-COMPANY-CD-A1             PIC X.
  5248         16  RQ-CARRIER-A1                PIC X.
  5249         16  RQ-GROUPING-A1               PIC X(6).
  5250         16  RQ-STATE-A1                  PIC XX.
  5251         16  RQ-ACCOUNT-A1                PIC X(10).
  5252         16  RQ-REFERENCE-A1              PIC X(12).
  5253         16  RQ-BATCH-A1                  PIC X(6).
  5254
  5255     12  RQ-CONTROL-BY-FIN-RESP.
  5256         16  RQ-COMPANY-CD-A2             PIC X.
  5257         16  RQ-CARRIER-A2                PIC X.
  5258         16  RQ-GROUPING-A2               PIC X(6).
  5259         16  RQ-FIN-RESP-A2               PIC X(10).
  5260         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5261         16  RQ-REFERENCE-A2              PIC X(12).
  5262         16  RQ-BATCH-A2                  PIC X(6).
  5263
  5264     12  RQ-CONTROL-BY-ACCT-AGENT.
  5265         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL630.cbl
  5266         16  RQ-CARRIER-A3                PIC X.
  5267         16  RQ-GROUPING-A3               PIC X(6).
  5268         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5269         16  RQ-BATCH-A3                  PIC X(6).
  5270
  5271     12  RQ-CONTROL-BY-SUMMARY.
  5272         16  RQ-COMPANY-CD-A4             PIC X.
  5273         16  RQ-SUMMARY-CODE              PIC X(6).
  5274         16  RQ-ACCOUNT-A4                PIC X(10).
  5275         16  RQ-REFERENCE-A4              PIC X(12).
  5276         16  RQ-BATCH-A4                  PIC X(6).
  5277
  5278     12  RQ-REQUEST-METHOD                PIC X.
  5279         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5280         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5281         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5282         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5283     12  FILLER                           PIC X.
  5284     12  RQ-STATUS                        PIC X.
  5285         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5286         88  RQ-RESUBMIT                      VALUE 'R'.
  5287     12  RQ-PROCESSOR-ID                  PIC X(4).
  5288     12  RQ-ENTRY-DT                      PIC XX.
  5289     12  RQ-MO-END-DT                     PIC XX.
  5290     12  RQ-REQUEST-DT                    PIC XX.
  5291     12  RQ-STMT-DT                       PIC XX.
  5292     12  RQ-REVERSAL-DT                   PIC XX.
  5293     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5294     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5295
  5296     12  FILLER                           PIC X(27).
  5297
  5298******************************************************************
  5299
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL630.cbl
  5301*    COPY ERCCNOT.
  5302******************************************************************
  5303*                                                                *
  5304*                            ERCCNOT                             *
  5305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5306*                            VMOD=2.003                          *
  5307*                                                                *
  5308*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5309*                                                                *
  5310*        FILE TYPE= VSAM,KSDS                                    *
  5311*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5312*                                                                *
  5313*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5314*                                                                *
  5315*        LOG = YES                                               *
  5316*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5317*                                                                *
  5318******************************************************************
  5319*                   C H A N G E   L O G
  5320*
  5321* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5322*-----------------------------------------------------------------
  5323*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5324* EFFECTIVE    NUMBER
  5325*-----------------------------------------------------------------
  5326* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5327******************************************************************
  5328
  5329 01  CERT-NOTE-FILE.
  5330     12  CZ-RECORD-ID                PIC  XX.
  5331         88  VALID-CZ-ID                  VALUE 'CZ'.
  5332
  5333     12  CZ-CONTROL-PRIMARY.
  5334         16  CZ-COMPANY-CD           PIC X.
  5335         16  CZ-CARRIER              PIC X.
  5336         16  CZ-GROUPING.
  5337             20 CZ-GROUPING-PREFIX   PIC XXX.
  5338             20 CZ-GROUPING-PRIME    PIC XXX.
  5339         16  CZ-STATE                PIC XX.
  5340         16  CZ-ACCOUNT.
  5341             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5342             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5343         16  CZ-CERT-EFF-DT          PIC XX.
  5344         16  CZ-CERT-NO.
  5345             20  CZ-CERT-PRIME       PIC X(10).
  5346             20  CZ-CERT-SFX         PIC X.
  5347         16  CZ-RECORD-TYPE          PIC X.
  5348             88  CERT-NOTE           VALUE '1'.
  5349             88  CLAIM-CERT-NOTE     VALUE '2'.
  5350         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5351
  5352     12  CZ-LAST-MAINT-DT            PIC XX.
  5353     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5354     12  CZ-LAST-MAINT-USER          PIC X(4).
  5355
  5356     12  CZ-NOTE-INFORMATION.
  5357         16  CZ-NOTE                 PIC X(63).
  5358         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL630.cbl
  5359******************************************************************
  5360
  5361 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5362                          PENDING-BUSINESS ACCOUNT-MASTER
  5363                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  5364                          MAILING-DATA PENDING-MAILING-DATA
  5365                          COMPENSATION-MASTER AR-REQUEST-RECORD
  5366                          CERT-NOTE-FILE.
  5367 0000-DFHEXIT SECTION.
  5368     MOVE '9#                    $   ' TO DFHEIV0.
  5369     MOVE 'EL630' TO DFHEIV1.
  5370     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5371
  5372     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5373     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5374     IF EIBCALEN = 0
  5375         GO TO 8800-UNAUTHORIZED-ACCESS.
  5376
  5377     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5378     MOVE '5'                    TO DC-OPTION-CODE.
  5379     PERFORM 9700-DATE-LINK.
  5380
  5381     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  5382     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  5383     MOVE DC-GREG-DATE-1-YMD     TO WS-CURRENT-YMD.
  5384
  5385     MOVE PI-CALLING-PROGRAM TO PI-SAVE-CALLING-PGM.
  5386     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5387         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5388             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5389             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5390             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5391             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5392             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5393             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5394             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5395             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5396             MOVE SPACES               TO PI-PROGRAM-WORK-AREA
  5397                                          PI-MISC
  5398         ELSE
  5399             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5400             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5401             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5402             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5403             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5404             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5405             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5406             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5407
  5408     MOVE LOW-VALUES             TO EL630AI.
  5409
  5410     IF PI-SAVE-CALLING-PGM = XCTL-6302
  5411         GO TO 4000-SHOW-TOTALS.
  5412
  5413     IF PI-SAVE-CALLING-PGM = XCTL-6301
  5414         MOVE 'N'                TO PI-EL630-FIRST-TIME-SW
  5415         IF (PI-CAN-CNT-REMITTED GREATER ZERO OR
  5416             PI-ISS-CNT-REMITTED GREATER ZERO)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL630.cbl
  5417                 GO TO 4000-SHOW-TOTALS
  5418         ELSE
  5419         IF PI-ISS-CNT-ENTERED = ZEROS  AND
  5420            PI-CAN-CNT-ENTERED = ZEROS
  5421             MOVE 'Y'            TO PI-VERIFY-DELETE-SW
  5422             GO TO 3000-DELETE-ENTERED-BATCH
  5423         ELSE
  5424             GO TO 4000-SHOW-TOTALS.
  5425
  5426     IF EIBTRNID NOT = TRANS-ID
  5427         MOVE SPACE              TO PI-BROWSE-SW
  5428         MOVE ZEROS              TO PI-LAST-SEQ-NO-ADDED
  5429         MOVE SPACES             TO PI-CR-CONTROL-IN-PROGRESS
  5430         MOVE QUESTION-MARKS     TO BATCHI
  5431         MOVE AL-UANON           TO BATCHA
  5432         GO TO 8100-SEND-INITIAL-MAP.
  5433
  5434
  5435* EXEC CICS HANDLE CONDITION
  5436*        PGMIDERR  (9600-PGMID-ERROR)
  5437*        ERROR     (9990-ABEND)
  5438*    END-EXEC.
  5439*    MOVE '"$L.                  ! " #00005430' TO DFHEIV0
  5440     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5441     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5442     MOVE X'2220233030303035343330' TO DFHEIV0(25:11)
  5443     CALL 'kxdfhei1' USING DFHEIV0
  5444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5445
  5446
  5447     IF EIBAID = DFHCLEAR
  5448        MOVE SPACES              TO PI-ACCT-AGENT-PROCESSED-SW
  5449        GO TO 9400-CLEAR.
  5450
  5451     IF PI-PROCESSOR-ID = 'LGXX'
  5452         GO TO 0200-RECEIVE.
  5453
  5454
  5455* EXEC CICS READQ TS
  5456*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5457*        INTO   (SECURITY-CONTROL)
  5458*        LENGTH (SC-COMM-LENGTH)
  5459*        ITEM   (SC-ITEM)
  5460*    END-EXEC.
  5461*    MOVE '*$II   L              ''   #00005442' TO DFHEIV0
  5462     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5463     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5464     MOVE X'2020233030303035343432' TO DFHEIV0(25:11)
  5465     CALL 'kxdfhei1' USING DFHEIV0,
  5466           PI-SECURITY-TEMP-STORE-ID,
  5467           SECURITY-CONTROL,
  5468           SC-COMM-LENGTH,
  5469           SC-ITEM,
  5470           DFHEIV99,
  5471           DFHEIV99
  5472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5473
  5474
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL630.cbl
  5475     MOVE SC-CREDIT-DISPLAY (11)  TO PI-DISPLAY-CAP.
  5476     MOVE SC-CREDIT-UPDATE  (11)  TO PI-MODIFY-CAP.
  5477
  5478     IF NOT DISPLAY-CAP
  5479         MOVE 'READ'          TO SM-READ
  5480         PERFORM 9995-SECURITY-VIOLATION
  5481                              THRU 9995-EXIT
  5482         MOVE ER-0070         TO  EMI-ERROR
  5483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5484         GO TO 8100-SEND-INITIAL-MAP.
  5485
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL630.cbl
  5487 0200-RECEIVE.
  5488     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5489         MOVE ER-0008            TO EMI-ERROR
  5490         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5491         MOVE -1                 TO MAINTL
  5492         GO TO 8200-SEND-DATAONLY.
  5493
  5494
  5495* EXEC CICS RECEIVE
  5496*        MAP      (MAP-NAME)
  5497*        MAPSET   (MAPSET-NAME)
  5498*        INTO     (EL630AI)
  5499*    END-EXEC.
  5500     MOVE LENGTH OF
  5501      EL630AI
  5502       TO DFHEIV11
  5503*    MOVE '8"T I  L              ''   #00005468' TO DFHEIV0
  5504     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5506     MOVE X'2020233030303035343638' TO DFHEIV0(25:11)
  5507     CALL 'kxdfhei1' USING DFHEIV0,
  5508           MAP-NAME,
  5509           EL630AI,
  5510           DFHEIV11,
  5511           MAPSET-NAME,
  5512           DFHEIV99,
  5513           DFHEIV99
  5514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5515
  5516
  5517     IF PFENTERL = 0
  5518         GO TO 0300-CHECK-PFKEYS.
  5519
  5520     IF PFENTERI NUMERIC
  5521        IF PFENTERI GREATER 0 AND LESS 25
  5522           MOVE PF-VALUES (PFENTERI) TO EIBAID
  5523        ELSE
  5524           MOVE ER-0029            TO EMI-ERROR
  5525           GO TO 0320-INPUT-ERROR.
  5526
  5527 0300-CHECK-PFKEYS.
  5528     IF EIBAID = DFHENTER
  5529        IF PI-CLEAR-ERROR
  5530           MOVE -1                 TO PFENTERL
  5531           MOVE ER-2213            TO EMI-ERROR
  5532           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5533           GO TO 4000-SHOW-TOTALS.
  5534
  5535     IF EIBAID = DFHPF23
  5536         GO TO 8810-PF23.
  5537     IF EIBAID = DFHPF24
  5538         GO TO 9200-RETURN-MAIN-MENU.
  5539     IF EIBAID = DFHPF12
  5540         GO TO 9500-PF12.
  5541
  5542     IF EIBAID = DFHPF1
  5543        IF PI-DATA-UPDATED
  5544           MOVE 'Y'            TO WS-PF1-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL630.cbl
  5545           MOVE SPACE          TO PI-NB-MONTH-END-DT
  5546                                  PI-CLEAR-ERROR-SW
  5547           PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  5548           MOVE SPACES TO BATCH-TO-PROCESS
  5549           MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  5550           MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  5551           MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  5552
  5553* EXEC CICS START
  5554*               TRANSID       (EDIT-TRANS)
  5555*               FROM          (BATCH-TO-PROCESS)
  5556*               LENGTH        (PASS-AREA-LEN)
  5557*          END-EXEC
  5558*    MOVE '0( LF                 0   #00005509' TO DFHEIV0
  5559     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5560     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  5561     MOVE X'2020233030303035353039' TO DFHEIV0(25:11)
  5562     CALL 'kxdfhei1' USING DFHEIV0,
  5563           DFHEIV99,
  5564           EDIT-TRANS,
  5565           DFHEIV99,
  5566           BATCH-TO-PROCESS,
  5567           PASS-AREA-LEN,
  5568           DFHEIV99,
  5569           DFHEIV99,
  5570           DFHEIV99,
  5571           DFHEIV99,
  5572           DFHEIV99,
  5573           DFHEIV99,
  5574           DFHEIV99,
  5575           DFHEIV99,
  5576           DFHEIV99,
  5577           DFHEIV99
  5578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5579           MOVE PI-SAV-REFERENCE TO PI-SAV-PYAJ-REFERENCE
  5580           MOVE SPACES         TO PI-UPDATE-SW
  5581                                  PI-KEYED-SWITCHES
  5582                                  PI-AGE-KEYED-SW
  5583                                  PI-BIRTHDT-KEYED-SW
  5584                                  PI-ACCT-AGENT-PROCESSED-SW
  5585                                  PI-SAV-REFERENCE
  5586           MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  5587                                  PI-CAN-CNT-ENTERED
  5588           MOVE LOW-VALUES     TO EL630AO
  5589           MOVE SPACE          TO PI-BROWSE-SW
  5590           MOVE QUESTION-MARKS TO BATCHI
  5591           MOVE AL-UANON       TO BATCHA
  5592           MOVE -1             TO MAINTL
  5593           IF EMI-NO-ERRORS
  5594               MOVE ZEROS          TO EMI-ERROR
  5595               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5596               GO TO 8100-SEND-INITIAL-MAP
  5597           ELSE
  5598               GO TO 8100-SEND-INITIAL-MAP
  5599        ELSE
  5600           IF  MAINTI = 'N'
  5601               MOVE -1             TO MAINTL
  5602               MOVE ER-2211        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL630.cbl
  5603               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5604               GO TO 8200-SEND-DATAONLY.
  5605
  5606     IF EIBAID = DFHPF1
  5607        MOVE SPACE          TO PI-NB-MONTH-END-DT
  5608                               PI-CLEAR-ERROR-SW
  5609        MOVE SPACES TO BATCH-TO-PROCESS
  5610        MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  5611        MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  5612        MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  5613        IF EDIT-BATCH GREATER SPACES
  5614
  5615* EXEC CICS START
  5616*               TRANSID       (EDIT-TRANS)
  5617*               FROM          (BATCH-TO-PROCESS)
  5618*               LENGTH        (PASS-AREA-LEN)
  5619*            END-EXEC
  5620*    MOVE '0( LF                 0   #00005549' TO DFHEIV0
  5621     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5622     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  5623     MOVE X'2020233030303035353439' TO DFHEIV0(25:11)
  5624     CALL 'kxdfhei1' USING DFHEIV0,
  5625           DFHEIV99,
  5626           EDIT-TRANS,
  5627           DFHEIV99,
  5628           BATCH-TO-PROCESS,
  5629           PASS-AREA-LEN,
  5630           DFHEIV99,
  5631           DFHEIV99,
  5632           DFHEIV99,
  5633           DFHEIV99,
  5634           DFHEIV99,
  5635           DFHEIV99,
  5636           DFHEIV99,
  5637           DFHEIV99,
  5638           DFHEIV99,
  5639           DFHEIV99
  5640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5641             MOVE SPACES         TO PI-UPDATE-SW
  5642                                    PI-KEYED-SWITCHES
  5643                                    PI-AGE-KEYED-SW
  5644                                    PI-BIRTHDT-KEYED-SW
  5645                                    PI-ACCT-AGENT-PROCESSED-SW
  5646                                    PI-SAV-REFERENCE
  5647             MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  5648                                    PI-CAN-CNT-ENTERED
  5649                                    EMI-ERROR
  5650             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5651             MOVE LOW-VALUES     TO EL630AO
  5652             MOVE SPACE          TO PI-BROWSE-SW
  5653             MOVE QUESTION-MARKS TO BATCHI
  5654             MOVE AL-UANON       TO BATCHA
  5655             MOVE -1             TO MAINTL
  5656             GO TO 8100-SEND-INITIAL-MAP
  5657        ELSE
  5658             MOVE -1             TO MAINTL
  5659             MOVE ER-2211        TO EMI-ERROR
  5660             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL630.cbl
  5661             GO TO 8200-SEND-DATAONLY.
  5662
  5663     IF EIBAID = DFHPF3
  5664         IF NOT PI-DATA-UPDATED
  5665             MOVE SPACE          TO PI-EL630-FIRST-TIME-SW
  5666             IF PI-AR-PROCESSING
  5667                MOVE XCTL-635       TO PGM-NAME
  5668                GO TO 9300-XCTL
  5669             ELSE
  5670                IF PI-COMPANY-ID = 'DMD'
  5671                   MOVE XCTL-633DMD TO PGM-NAME
  5672                   GO TO 9300-XCTL
  5673                ELSE
  5674                   MOVE XCTL-633    TO PGM-NAME
  5675                   GO TO 9300-XCTL
  5676         ELSE
  5677             MOVE -1             TO BATCHL
  5678             MOVE AL-UABON       TO BATCHA
  5679             MOVE ER-2213        TO EMI-ERROR
  5680             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5681             GO TO 8200-SEND-DATAONLY.
  5682
  5683     IF EIBAID = DFHPF4
  5684         IF NOT PI-EL630-FIRST-TIME
  5685             MOVE XCTL-6302      TO PGM-NAME
  5686             GO TO 9300-XCTL
  5687         ELSE
  5688             PERFORM 0400-PRIME-BATCH-TOTALS THRU 0490-EXIT
  5689             IF EMI-ERROR = ZEROS
  5690                 MOVE 'N'        TO PI-EL630-FIRST-TIME-SW
  5691                 MOVE XCTL-6302  TO PGM-NAME
  5692                 GO TO 9300-XCTL
  5693             ELSE
  5694                 GO TO 8200-SEND-DATAONLY.
  5695
  5696     IF EIBAID = DFHPF5
  5697             IF PI-EL630-FIRST-TIME
  5698                 MOVE -1         TO MAINTL
  5699                 GO TO 8200-SEND-DATAONLY
  5700             ELSE
  5701             IF PI-ISS-CNT-ENTERED = ZEROS  AND
  5702                PI-CAN-CNT-ENTERED = ZEROS
  5703                 MOVE LOW-VALUES TO     EL630AO
  5704                 MOVE QUESTION-MARKS TO BATCHI
  5705                 MOVE AL-UANON   TO     BATCHA
  5706                 MOVE -1         TO     MAINTL
  5707                 GO TO 8100-SEND-INITIAL-MAP
  5708             ELSE
  5709                 MOVE -1         TO BATCHL
  5710                 MOVE AL-UABON   TO BATCHA
  5711                 MOVE ER-2213    TO EMI-ERROR
  5712                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5713                 GO TO 4000-SHOW-TOTALS.
  5714
  5715     IF EIBAID = DFHPF2
  5716        MOVE  AL-UANON           TO  BATCHA
  5717        MOVE  BATCHI             TO PI-SAV-ENTRY-BATCH
  5718        GO TO 3000-DELETE-ENTERED-BATCH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL630.cbl
  5719
  5720     IF  MAINTI = 'S'
  5721         MOVE  MAINTI            TO  PI-MAINT-FUNC
  5722         PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT
  5723             IF EMI-ERROR = ZEROS
  5724                 MOVE 'N'        TO PI-EL630-FIRST-TIME-SW
  5725                 GO TO 4000-SHOW-TOTALS
  5726             ELSE
  5727                 GO TO 8200-SEND-DATAONLY.
  5728
  5729     IF EIBAID = DFHENTER
  5730         GO TO 0330-EDIT-DATA.
  5731
  5732 0320-INPUT-ERROR.
  5733     MOVE ER-0029                TO EMI-ERROR.
  5734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5735     MOVE AL-UNBON               TO PFENTERA.
  5736     IF PFENTERL = 0
  5737         MOVE -1                 TO MAINTL
  5738     ELSE
  5739         MOVE -1                 TO PFENTERL.
  5740
  5741     GO TO 8200-SEND-DATAONLY.
  5742
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL630.cbl
  5744 0330-EDIT-DATA.
  5745     IF MODIFY-CAP
  5746         NEXT SENTENCE
  5747       ELSE
  5748         IF MAINTI NOT = 'S'
  5749           MOVE 'UPDATE'       TO SM-READ
  5750           PERFORM 9995-SECURITY-VIOLATION
  5751                              THRU 9995-EXIT
  5752           MOVE ER-0070        TO EMI-ERROR
  5753           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5754           GO TO 8100-SEND-INITIAL-MAP.
  5755
  5756     MOVE SPACE                  TO  PI-NB-MONTH-END-DT.
  5757
  5758     PERFORM 1250-READ-COMPANY-REC THRU 1250-EXIT.
  5759
  5760     IF MAINTI = 'N' OR 'C' OR 'B' OR 'K'
  5761         NEXT SENTENCE
  5762     ELSE
  5763         MOVE ER-0023            TO EMI-ERROR
  5764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5765         MOVE -1                 TO MAINTL
  5766         MOVE AL-UABON           TO MAINTA
  5767         GO TO 8200-SEND-DATAONLY.
  5768
  5769     IF PI-CARRIER-SECURITY GREATER SPACES
  5770         IF CARRIERL GREATER ZEROS
  5771           IF PI-CARRIER-SECURITY = CARRIERI
  5772              MOVE AL-UANON       TO CARRIERA
  5773            ELSE
  5774              MOVE -1             TO CARRIERL
  5775              MOVE AL-UABON       TO CARRIERA
  5776              MOVE ER-2370       TO EMI-ERROR
  5777              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5778
  5779     IF PI-ACCOUNT-SECURITY GREATER SPACES
  5780         IF ACCOUNTL GREATER ZEROS
  5781             IF PI-ACCOUNT-SECURITY = ACCOUNTI
  5782                 MOVE AL-UANON   TO ACCOUNTA
  5783               ELSE
  5784                 MOVE -1         TO ACCOUNTL
  5785                 MOVE AL-UABON   TO ACCOUNTA
  5786                 MOVE ER-2371   TO EMI-ERROR
  5787                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5788
  5789     IF  NOT EMI-NO-ERRORS
  5790         GO TO 8200-SEND-DATAONLY.
  5791
  5792     MOVE MAINTI                 TO PI-MAINT-FUNC.
  5793     MOVE AL-UANON               TO MAINTA.
  5794
  5795     MOVE PI-COMPANY-CD          TO PI-SAV-COMP-CD.
  5796     MOVE ZEROS                  TO PI-SAV-BATCH-SEQ
  5797                                    PI-SAV-BATCH-CHG-SEQ.
  5798     MOVE SPACES                 TO PI-SAV-CERT-EFF-DT
  5799                                    PI-SAV-CERT-NO.
  5800
  5801     IF BATCHL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL630.cbl
  5802         MOVE -1                 TO BATCHL
  5803         MOVE AL-UNBON           TO BATCHA
  5804         MOVE ER-2201            TO EMI-ERROR
  5805         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5806     ELSE
  5807         IF BATCHI = QUESTION-MARKS OR SPACES
  5808             IF MAINTI = 'N'
  5809                 PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  5810             ELSE
  5811                 MOVE -1         TO BATCHL
  5812                 MOVE AL-UNBON   TO BATCHA
  5813                 MOVE ER-2201    TO EMI-ERROR
  5814                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5815         ELSE
  5816             MOVE SPACE TO WS-SWITCH
  5817             PERFORM 0335-FAT-FINGER-EDIT VARYING PIC6-SUB
  5818                 FROM +1 BY +1
  5819                 UNTIL PIC6-SUB > +6 OR QUESTION-MARK-FOUND.
  5820
  5821     IF QUESTION-MARK-FOUND
  5822         IF MAINTI = 'N'
  5823             PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  5824         ELSE
  5825             MOVE -1         TO BATCHL
  5826             MOVE AL-UNBON   TO BATCHA
  5827             MOVE ER-2201    TO EMI-ERROR
  5828             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5829     ELSE
  5830         IF BATCHI = PI-SAV-ENTRY-BATCH
  5831             MOVE AL-UANON   TO BATCHA
  5832         ELSE
  5833             MOVE BATCHI TO PI-SAV-ENTRY-BATCH
  5834             IF MAINTI = 'C' OR 'B'
  5835                 MOVE AL-UANON TO BATCHA
  5836                 MOVE ZEROS      TO ELFISSL  ELFCANL
  5837                                    EAHISSL  EAHCANL
  5838                                    EISSCNTL ECANCNTL
  5839                                    PI-LF-ISS-REMITTED
  5840                                    PI-LF-CAN-REMITTED
  5841                                    PI-AH-ISS-REMITTED
  5842                                    PI-AH-CAN-REMITTED
  5843                                    PI-ISS-CNT-REMITTED
  5844                                    PI-CAN-CNT-REMITTED.
  5845
  5846     IF REFL GREATER ZEROS
  5847        MOVE REFI                TO PI-SAV-REFERENCE.
  5848
  5849     IF MAINTI = 'C' OR 'B'
  5850         GO TO 0340-CHECK-TOTALS.
  5851
  5852     IF CARRIERL GREATER ZEROS
  5853         MOVE AL-UANON           TO CARRIERA
  5854         PERFORM 1000-VERIFY-CARRIER-ID THRU 1000-EXIT
  5855     ELSE
  5856         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  5857             MOVE -1             TO CARRIERL
  5858             MOVE AL-UABON       TO CARRIERA
  5859             MOVE ER-0194        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL630.cbl
  5860             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5861
  5862     IF GROUPL GREATER ZEROS
  5863         MOVE AL-UANON           TO GROUPA
  5864     ELSE
  5865         IF CARR-GROUP-ST-ACCNT-CNTL
  5866             MOVE -1 TO          GROUPL
  5867             MOVE AL-UABON       TO GROUPA
  5868             MOVE ER-0195        TO EMI-ERROR
  5869             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5870
  5871     IF STATEL GREATER ZEROS
  5872         MOVE AL-UANON           TO STATEA
  5873         PERFORM 1100-VERIFY-STATE-ID THRU 1100-EXIT
  5874     ELSE
  5875         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  5876             MOVE -1             TO STATEL
  5877             MOVE AL-UABON       TO STATEA
  5878             MOVE ER-0196        TO EMI-ERROR
  5879             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5880
  5881     IF ACCOUNTL GREATER ZEROS
  5882         MOVE AL-UANON           TO ACCOUNTA
  5883         PERFORM 1200-VERIFY-ACCOUNT THRU 1200-EXIT
  5884     ELSE
  5885         MOVE -1 TO ACCOUNTL
  5886         MOVE AL-UABON           TO ACCOUNTA
  5887         MOVE ER-0197            TO EMI-ERROR
  5888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5889
  5890 0335-FAT-FINGER-EDIT.
  5891
  5892     IF BATCHI (PIC6-SUB:1) = QUESTION-MARK
  5893         SET QUESTION-MARK-FOUND TO TRUE
  5894     END-IF.
  5895
  5896 0340-CHECK-TOTALS.
  5897******************************************************************
  5898*        IF MAINTENANCE FUNCTION = 'K' (COPY BATCH)              *
  5899*           GO TO CHECK ERRORS.                                  *
  5900******************************************************************
  5901
  5902     IF  MAINTI = 'K'
  5903         GO TO 0340-ERROR-CHECK.
  5904
  5905*    ********************************************************
  5906*    *         THE FOLLOWING FIELDS ARE NOT REQUIRED        *
  5907*    *         IF ENTERED THE ONLY REQUIREMENT IS NUMERIC   *
  5908*    ********************************************************
  5909
  5910     IF ELFISSL GREATER ZEROS
  5911         MOVE AL-UNNON           TO ELFISSA
  5912
  5913* EXEC CICS BIF DEEDIT
  5914*            FIELD   (ELFISSI)
  5915*            LENGTH  (12)
  5916*        END-EXEC
  5917     MOVE 12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL630.cbl
  5918       TO DFHEIV11
  5919*    MOVE '@"L                   #   #00005825' TO DFHEIV0
  5920     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5921     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5922     MOVE X'2020233030303035383235' TO DFHEIV0(25:11)
  5923     CALL 'kxdfhei1' USING DFHEIV0,
  5924           ELFISSI,
  5925           DFHEIV11
  5926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5927         MOVE ELFISSI            TO PI-LF-ISS-REMITTED
  5928     ELSE
  5929         MOVE ZEROS              TO PI-LF-ISS-REMITTED.
  5930
  5931     IF ELFCANL GREATER ZEROS
  5932         MOVE AL-UNNON           TO ELFCANA
  5933
  5934* EXEC CICS BIF DEEDIT
  5935*            FIELD   (ELFCANI)
  5936*            LENGTH  (10)
  5937*        END-EXEC
  5938     MOVE 10
  5939       TO DFHEIV11
  5940*    MOVE '@"L                   #   #00005835' TO DFHEIV0
  5941     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5942     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5943     MOVE X'2020233030303035383335' TO DFHEIV0(25:11)
  5944     CALL 'kxdfhei1' USING DFHEIV0,
  5945           ELFCANI,
  5946           DFHEIV11
  5947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5948         MOVE ELFCANI            TO PI-LF-CAN-REMITTED
  5949     ELSE
  5950         MOVE ZEROS              TO PI-LF-CAN-REMITTED.
  5951
  5952     IF EAHISSL GREATER ZEROS
  5953         MOVE AL-UNNON           TO EAHISSA
  5954
  5955* EXEC CICS BIF DEEDIT
  5956*            FIELD   (EAHISSI)
  5957*            LENGTH  (12)
  5958*        END-EXEC
  5959     MOVE 12
  5960       TO DFHEIV11
  5961*    MOVE '@"L                   #   #00005845' TO DFHEIV0
  5962     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5963     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5964     MOVE X'2020233030303035383435' TO DFHEIV0(25:11)
  5965     CALL 'kxdfhei1' USING DFHEIV0,
  5966           EAHISSI,
  5967           DFHEIV11
  5968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5969         MOVE EAHISSI            TO PI-AH-ISS-REMITTED
  5970     ELSE
  5971         MOVE ZEROS              TO PI-AH-ISS-REMITTED.
  5972
  5973     IF EAHCANL GREATER ZEROS
  5974         MOVE AL-UNNON           TO EAHCANA
  5975
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL630.cbl
  5976* EXEC CICS BIF DEEDIT
  5977*            FIELD   (EAHCANI)
  5978*            LENGTH  (10)
  5979*        END-EXEC
  5980     MOVE 10
  5981       TO DFHEIV11
  5982*    MOVE '@"L                   #   #00005855' TO DFHEIV0
  5983     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5984     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5985     MOVE X'2020233030303035383535' TO DFHEIV0(25:11)
  5986     CALL 'kxdfhei1' USING DFHEIV0,
  5987           EAHCANI,
  5988           DFHEIV11
  5989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5990         MOVE EAHCANI            TO PI-AH-CAN-REMITTED
  5991     ELSE
  5992         MOVE ZEROS              TO PI-AH-CAN-REMITTED.
  5993
  5994     IF EISSCNTL GREATER ZEROS
  5995         MOVE AL-UNNON           TO EISSCNTA
  5996
  5997* EXEC CICS BIF DEEDIT
  5998*            FIELD (EISSCNTI)
  5999*            LENGTH(6)
  6000*        END-EXEC
  6001     MOVE 6
  6002       TO DFHEIV11
  6003*    MOVE '@"L                   #   #00005865' TO DFHEIV0
  6004     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6005     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6006     MOVE X'2020233030303035383635' TO DFHEIV0(25:11)
  6007     CALL 'kxdfhei1' USING DFHEIV0,
  6008           EISSCNTI,
  6009           DFHEIV11
  6010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6011         MOVE EISSCNTI           TO PI-ISS-CNT-REMITTED
  6012     ELSE
  6013         MOVE ZEROS              TO PI-ISS-CNT-REMITTED.
  6014
  6015     IF ECANCNTL GREATER ZEROS
  6016         MOVE AL-UNNON           TO ECANCNTA
  6017
  6018* EXEC CICS BIF DEEDIT
  6019*            FIELD  (ECANCNTI)
  6020*            LENGTH (6)
  6021*        END-EXEC
  6022     MOVE 6
  6023       TO DFHEIV11
  6024*    MOVE '@"L                   #   #00005875' TO DFHEIV0
  6025     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6026     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6027     MOVE X'2020233030303035383735' TO DFHEIV0(25:11)
  6028     CALL 'kxdfhei1' USING DFHEIV0,
  6029           ECANCNTI,
  6030           DFHEIV11
  6031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6032         MOVE ECANCNTI           TO PI-CAN-CNT-REMITTED
  6033     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL630.cbl
  6034         MOVE ZEROS              TO PI-CAN-CNT-REMITTED.
  6035
  6036     IF MNTHNDTL GREATER ZEROS
  6037        NEXT SENTENCE
  6038       ELSE
  6039        GO TO 0340-RECEIVED-DATE.
  6040
  6041     MOVE MNTHNDTI               TO WS-DT-DEEDIT-FIELD.
  6042     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  6043
  6044     MOVE WS-DEEDIT-FIELD-DATE-OUT
  6045                                 TO DC-GREG-DATE-1-MDY.
  6046     MOVE '4'          TO DC-OPTION-CODE.
  6047     PERFORM 9700-DATE-LINK.
  6048
  6049     IF DATE-CONVERSION-ERROR
  6050        GO TO 0340-MNTH-DAY-ERROR.
  6051
  6052     MOVE DC-GREG-DATE-1-EDIT    TO MNTHNDTO.
  6053     MOVE DC-BIN-DATE-1          TO PI-NB-MONTH-END-DT.
  6054     MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
  6055
  6056     IF DATE-TEST-DD = DC-DAYS-IN-MONTH OR 01
  6057        CONTINUE
  6058     ELSE
  6059        GO TO 0340-MNTH-DAY-ERROR.
  6060
  6061 0340-RECEIVED-DATE.
  6062
  6063     IF RECEVDTL GREATER ZEROS
  6064        NEXT SENTENCE
  6065       ELSE
  6066        MOVE WS-CURRENT-DT       TO RECEVDTI.
  6067
  6068     MOVE RECEVDTI               TO WS-DT-DEEDIT-FIELD.
  6069     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  6070
  6071     MOVE WS-DEEDIT-FIELD-DATE-OUT
  6072                                 TO DC-GREG-DATE-1-MDY.
  6073     MOVE '4'          TO DC-OPTION-CODE.
  6074     PERFORM 9700-DATE-LINK.
  6075
  6076     IF DATE-CONVERSION-ERROR
  6077        GO TO 0340-RECEV-DAY-ERROR.
  6078
  6079     MOVE DC-GREG-DATE-1-EDIT    TO RECEVDTO.
  6080     MOVE DC-BIN-DATE-1          TO PI-RECEIVED-DT.
  6081
  6082     GO TO 0340-ERROR-CHECK.
  6083
  6084 0340-MNTH-DAY-ERROR.
  6085
  6086     MOVE -1       TO MNTHNDTL.
  6087     MOVE AL-UABON TO MNTHNDTA.
  6088     MOVE ER-0587  TO EMI-ERROR.
  6089     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6090     GO TO 0340-ERROR-CHECK.
  6091
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL630.cbl
  6092 0340-RECEV-DAY-ERROR.
  6093
  6094     MOVE -1       TO RECEVDTL.
  6095     MOVE AL-UABON TO RECEVDTA.
  6096     MOVE ER-0905  TO EMI-ERROR.
  6097     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6098
  6099 0340-ERROR-CHECK.
  6100
  6101     IF NOT EMI-NO-ERRORS
  6102         GO TO 8200-SEND-DATAONLY.
  6103
  6104     IF PI-NB-MONTH-END-DT EQUAL LOW-VALUES OR SPACES
  6105        GO TO 0345-END-DATE-CHECK.
  6106
  6107     IF PI-NB-MONTH-END-DT LESS THAN PI-CR-MONTH-END-DT
  6108        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-1
  6109        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-2
  6110     ELSE
  6111     IF PI-CR-MONTH-END-DT LESS THAN PI-NB-MONTH-END-DT
  6112        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-2
  6113        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-1
  6114     ELSE
  6115        GO TO 0345-END-DATE-CHECK.
  6116
  6117     MOVE  '1'                   TO  DC-OPTION-CODE.
  6118     PERFORM  9700-DATE-LINK.
  6119
  6120     IF (DATE-CONVERSION-ERROR)
  6121                   OR
  6122        ((DC-ELAPSED-MONTHS GREATER THAN +1) AND
  6123         (PI-COMPANY-ID NOT EQUAL 'DMD'))
  6124        MOVE -1       TO MNTHNDTL
  6125        MOVE AL-UABON TO MNTHNDTA
  6126        MOVE ER-0587  TO EMI-ERROR
  6127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6128
  6129 0345-END-DATE-CHECK.
  6130
  6131     IF NOT EMI-NO-ERRORS
  6132         GO TO 8200-SEND-DATAONLY.
  6133
  6134     IF PI-DELETE-IS-OK
  6135         MOVE SPACE              TO PI-VERIFY-DELETE-SW.
  6136
  6137     IF MAINTI = 'N'
  6138       AND PI-DATA-UPDATED
  6139         MOVE 'C'                TO PI-MAINT-FUNC
  6140         GO TO 0360-XCTL-EL6301.
  6141
  6142
  6143* EXEC CICS HANDLE CONDITION
  6144*        NOTFND  (0350-NO-RECORDS)
  6145*        ENDFILE (0350-NO-RECORDS)
  6146*    END-EXEC.
  6147*    MOVE '"$I''                  ! # #00005989' TO DFHEIV0
  6148     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL630.cbl
  6150     MOVE X'2320233030303035393839' TO DFHEIV0(25:11)
  6151     CALL 'kxdfhei1' USING DFHEIV0
  6152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6153
  6154
  6155
  6156* EXEC CICS READ
  6157*        SET     (ADDRESS OF PENDING-BUSINESS)
  6158*        DATASET (ERPNDB-FILE-ID)
  6159*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  6160*        GTEQ
  6161*    END-EXEC.
  6162*    MOVE '&"S        G          (   #00005994' TO DFHEIV0
  6163     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6165     MOVE X'2020233030303035393934' TO DFHEIV0(25:11)
  6166     CALL 'kxdfhei1' USING DFHEIV0,
  6167           ERPNDB-FILE-ID,
  6168           DFHEIV20,
  6169           DFHEIV99,
  6170           PI-SAV-ENDING-ERPNDB-KEY,
  6171           DFHEIV99,
  6172           DFHEIV99,
  6173           DFHEIV99
  6174     SET ADDRESS OF PENDING-BUSINESS TO
  6175         DFHEIV20
  6176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6177
  6178
  6179     IF PI-SAV-COMP-CD     = PB-COMPANY-CD  AND
  6180        PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6181         IF MAINTI = 'N'
  6182             MOVE ER-2229        TO EMI-ERROR
  6183             MOVE -1             TO MAINTL
  6184             MOVE AL-UABON       TO MAINTA
  6185             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6186             GO TO 8200-SEND-DATAONLY
  6187         ELSE
  6188             NEXT SENTENCE
  6189     ELSE
  6190         GO TO 0350-NO-RECORDS.
  6191
  6192     IF PI-CARRIER-SECURITY GREATER SPACES
  6193        IF PB-CARRIER = PI-CARRIER-SECURITY
  6194           NEXT SENTENCE
  6195         ELSE
  6196           GO TO 0350-NO-RECORDS.
  6197
  6198     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6199        IF PB-ACCOUNT = PI-ACCOUNT-SECURITY
  6200           NEXT SENTENCE
  6201         ELSE
  6202           GO TO 0350-NO-RECORDS.
  6203
  6204     IF PB-BILLED-DT NOT = LOW-VALUES
  6205         MOVE ER-2402            TO EMI-ERROR
  6206         MOVE -1                 TO BATCHL
  6207         MOVE AL-UABON           TO BATCHA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL630.cbl
  6208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6209         GO TO 8200-SEND-DATAONLY.
  6210
  6211******************************************************************
  6212*        IF MAINTENANCE FUNCTION = 'K'                           *
  6213*           REWRITE ENTIRE BATCH WITH NEW ACCOUNT INFORMATION.   *
  6214******************************************************************
  6215
  6216     IF  PI-SAV-COMP-CD = PB-COMPANY-CD
  6217         IF  PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6218             IF  MAINTI = 'K'
  6219                 GO TO 6000-REWRITE-ENTIRE-BATCH.
  6220
  6221     IF PI-SAV-COMP-CD     = PB-COMPANY-CD   AND
  6222        PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH  AND
  6223        MAINTI NOT = 'N'
  6224         MOVE PB-CARRIER         TO PI-SAV-CARRIER
  6225                                    ACCT-CARRIER
  6226         MOVE PB-GROUPING        TO PI-SAV-GROUPING
  6227                                    ACCT-GROUPING
  6228         MOVE PB-STATE           TO PI-SAV-STATE
  6229                                    ACCT-STATE
  6230         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT
  6231                                    ACCT-ACCOUNT
  6232         PERFORM 1200-READ-ACCOUNT THRU 1200-EXIT
  6233         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  6234         MOVE 'EL630B'           TO PI-MAP-NAME.
  6235         GO TO 0360-XCTL-EL6301.
  6236
  6237 0350-NO-RECORDS.
  6238     IF MAINTI = 'N'
  6239         MOVE SPACE              TO PI-ISSUE-ADDED-SW
  6240         MOVE ZEROS              TO PI-LF-ISS-ENTERED
  6241                                    PI-LF-CAN-ENTERED
  6242                                    PI-AH-ISS-ENTERED
  6243                                    PI-AH-CAN-ENTERED
  6244                                    PI-ISS-CNT-ENTERED
  6245                                    PI-CAN-CNT-ENTERED
  6246         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  6247         IF PI-LF-ISS-REMITTED  = ZEROS AND
  6248            PI-AH-ISS-REMITTED  = ZEROS AND
  6249            PI-LF-CAN-REMITTED  = ZEROS AND
  6250            PI-AH-CAN-REMITTED  = ZEROS AND
  6251            PI-ISS-CNT-REMITTED = ZEROS AND
  6252            PI-CAN-CNT-REMITTED = ZEROS
  6253             MOVE 'EL630B'     TO PI-MAP-NAME
  6254             GO TO 0360-XCTL-EL6301
  6255         ELSE
  6256             IF PI-LF-ISS-REMITTED  = ZEROS AND
  6257                PI-AH-ISS-REMITTED  = ZEROS AND
  6258                PI-ISS-CNT-REMITTED = ZEROS
  6259                 MOVE 'EL630C'     TO PI-MAP-NAME
  6260                 GO TO 0360-XCTL-EL6301
  6261             ELSE
  6262                 MOVE 'EL630B'     TO PI-MAP-NAME
  6263                 GO TO 0360-XCTL-EL6301
  6264     ELSE
  6265         MOVE ER-2212            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL630.cbl
  6266         MOVE -1                 TO BATCHL
  6267         MOVE AL-UABON           TO BATCHA
  6268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6269         GO TO 8200-SEND-DATAONLY.
  6270
  6271 0360-XCTL-EL6301.
  6272     IF PI-MAINT-FUNC = 'N'
  6273         MOVE SPACES             TO PI-KEYED-SWITCHES
  6274                                    PI-AGE-KEYED-SW
  6275                                    PI-BIRTHDT-KEYED-SW.
  6276
  6277     MOVE XCTL-6301           TO PGM-NAME.
  6278
  6279     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL630.cbl
  6281 0400-PRIME-BATCH-TOTALS.
  6282
  6283* EXEC CICS HANDLE CONDITION
  6284*        NOTFND (0480-NO-BATCH-TRAILER)
  6285*    END-EXEC.
  6286*    MOVE '"$I                   ! $ #00006104' TO DFHEIV0
  6287     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6289     MOVE X'2420233030303036313034' TO DFHEIV0(25:11)
  6290     CALL 'kxdfhei1' USING DFHEIV0
  6291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6292
  6293
  6294     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  6295     MOVE 9999                   TO PNDB-BATCH-SEQ.
  6296     MOVE BATCHI                 TO PNDB-ENTRY-BATCH.
  6297
  6298
  6299* EXEC CICS READ
  6300*        DATASET (ERPNDB-FILE-ID)
  6301*        SET     (ADDRESS OF PENDING-BUSINESS)
  6302*        RIDFLD  (ERPNDB-KEY)
  6303*    END-EXEC.
  6304*    MOVE '&"S        E          (   #00006112' TO DFHEIV0
  6305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6307     MOVE X'2020233030303036313132' TO DFHEIV0(25:11)
  6308     CALL 'kxdfhei1' USING DFHEIV0,
  6309           ERPNDB-FILE-ID,
  6310           DFHEIV20,
  6311           DFHEIV99,
  6312           ERPNDB-KEY,
  6313           DFHEIV99,
  6314           DFHEIV99,
  6315           DFHEIV99
  6316     SET ADDRESS OF PENDING-BUSINESS TO
  6317         DFHEIV20
  6318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6319
  6320
  6321     IF PB-BILLED-DT NOT = LOW-VALUES
  6322         MOVE ER-2402            TO EMI-ERROR
  6323         MOVE -1                 TO BATCHL
  6324         MOVE AL-UABON           TO BATCHA
  6325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6326         GO TO 0490-EXIT.
  6327
  6328     MOVE SPACES                   TO PI-ACCT-AGENT-PROCESSED-SW.
  6329     MOVE PI-COMPANY-CD            TO PI-SAV-COMP-CD.
  6330     MOVE PB-ENTRY-BATCH           TO PI-SAV-ENTRY-BATCH.
  6331
  6332     MOVE PB-REFERENCE             TO PI-SAV-REFERENCE.
  6333     MOVE PB-CSR-ID                TO PI-CSR-ID.
  6334
  6335     MOVE PB-CARRIER               TO PI-SAV-CARRIER.
  6336     MOVE PB-GROUPING              TO PI-SAV-GROUPING.
  6337     MOVE PB-STATE                 TO PI-SAV-STATE.
  6338     MOVE PB-ACCOUNT               TO PI-SAV-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL630.cbl
  6339     MOVE PB-B-LF-ISS-PRM-REMITTED TO PI-LF-ISS-REMITTED.
  6340     MOVE PB-B-LF-ISS-PRM-ENTERED  TO PI-LF-ISS-ENTERED.
  6341     MOVE PB-B-AH-ISS-PRM-REMITTED TO PI-AH-ISS-REMITTED.
  6342     MOVE PB-B-AH-ISS-PRM-ENTERED  TO PI-AH-ISS-ENTERED.
  6343     MOVE PB-B-LF-CAN-PRM-REMITTED TO PI-LF-CAN-REMITTED.
  6344     MOVE PB-B-LF-CAN-PRM-ENTERED  TO PI-LF-CAN-ENTERED.
  6345     MOVE PB-B-AH-CAN-PRM-REMITTED TO PI-AH-CAN-REMITTED.
  6346     MOVE PB-B-AH-CAN-PRM-ENTERED  TO PI-AH-CAN-ENTERED.
  6347     MOVE PB-B-ISSUE-CNT-REMITTED  TO PI-ISS-CNT-REMITTED.
  6348     MOVE PB-B-ISSUE-CNT-ENTERED   TO PI-ISS-CNT-ENTERED.
  6349     MOVE PB-B-CANCEL-CNT-REMITTED TO PI-CAN-CNT-REMITTED.
  6350     MOVE PB-B-CANCEL-CNT-ENTERED  TO PI-CAN-CNT-ENTERED.
  6351
  6352******************************************************************
  6353*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  6354*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE PRIME THE    *
  6355*       TRAILER'S MONTH-END-DATE.                                *
  6356******************************************************************
  6357
  6358     MOVE SPACE                    TO PI-NB-MONTH-END-DT.
  6359     IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  6360         NEXT SENTENCE
  6361       ELSE
  6362         MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  6363
  6364     IF  PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
  6365         MOVE PB-INPUT-DT          TO PI-RECEIVED-DT
  6366     ELSE
  6367         MOVE PB-B-RECEIVED-DT     TO PI-RECEIVED-DT.
  6368
  6369     GO TO 0490-EXIT.
  6370
  6371 0480-NO-BATCH-TRAILER.
  6372     MOVE ER-2212                TO EMI-ERROR.
  6373     MOVE -1                     TO BATCHL.
  6374     MOVE AL-UABON               TO BATCHA.
  6375     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6376
  6377 0490-EXIT.
  6378     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL630.cbl
  6380 1000-VERIFY-CARRIER-ID.
  6381     MOVE SPACES                 TO ELCNTL-KEY.
  6382     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6383     MOVE '6'                    TO CNTL-REC-TYPE.
  6384     MOVE CARRIERI               TO CNTL-CARRIER
  6385     MOVE +0                     TO CNTL-SEQ.
  6386
  6387
  6388* EXEC CICS HANDLE CONDITION
  6389*        NOTFND   (1000-NO-CARRIER)
  6390*    END-EXEC.
  6391*    MOVE '"$I                   ! % #00006184' TO DFHEIV0
  6392     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6393     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6394     MOVE X'2520233030303036313834' TO DFHEIV0(25:11)
  6395     CALL 'kxdfhei1' USING DFHEIV0
  6396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6397
  6398
  6399
  6400* EXEC CICS READ
  6401*        DATASET   (ELCNTL-FILE-ID)
  6402*        SET       (ADDRESS OF CONTROL-FILE)
  6403*        RIDFLD    (ELCNTL-KEY)
  6404*    END-EXEC.
  6405*    MOVE '&"S        E          (   #00006188' TO DFHEIV0
  6406     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6408     MOVE X'2020233030303036313838' TO DFHEIV0(25:11)
  6409     CALL 'kxdfhei1' USING DFHEIV0,
  6410           ELCNTL-FILE-ID,
  6411           DFHEIV20,
  6412           DFHEIV99,
  6413           ELCNTL-KEY,
  6414           DFHEIV99,
  6415           DFHEIV99,
  6416           DFHEIV99
  6417     SET ADDRESS OF CONTROL-FILE TO
  6418         DFHEIV20
  6419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6420
  6421
  6422     GO TO 1000-EXIT.
  6423
  6424 1000-NO-CARRIER.
  6425     MOVE ER-2208                TO EMI-ERROR
  6426     MOVE -1                     TO CARRIERL
  6427     MOVE AL-UABON               TO CARRIERA
  6428     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6429
  6430 1000-EXIT.
  6431     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL630.cbl
  6433 1100-VERIFY-STATE-ID.
  6434     MOVE SPACES                 TO ELCNTL-KEY.
  6435     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6436     MOVE '3'                    TO CNTL-REC-TYPE.
  6437     MOVE STATEI                 TO CNTL-STATE.
  6438     MOVE +0                     TO CNTL-SEQ.
  6439
  6440
  6441* EXEC CICS HANDLE CONDITION
  6442*        NOTFND   (1100-NO-STATE)
  6443*    END-EXEC.
  6444*    MOVE '"$I                   ! & #00006212' TO DFHEIV0
  6445     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6447     MOVE X'2620233030303036323132' TO DFHEIV0(25:11)
  6448     CALL 'kxdfhei1' USING DFHEIV0
  6449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6450
  6451
  6452
  6453* EXEC CICS READ
  6454*        DATASET   (ELCNTL-FILE-ID)
  6455*        SET       (ADDRESS OF CONTROL-FILE)
  6456*        RIDFLD    (ELCNTL-KEY)
  6457*    END-EXEC.
  6458*    MOVE '&"S        E          (   #00006216' TO DFHEIV0
  6459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6461     MOVE X'2020233030303036323136' TO DFHEIV0(25:11)
  6462     CALL 'kxdfhei1' USING DFHEIV0,
  6463           ELCNTL-FILE-ID,
  6464           DFHEIV20,
  6465           DFHEIV99,
  6466           ELCNTL-KEY,
  6467           DFHEIV99,
  6468           DFHEIV99,
  6469           DFHEIV99
  6470     SET ADDRESS OF CONTROL-FILE TO
  6471         DFHEIV20
  6472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6473
  6474
  6475     GO TO 1100-EXIT.
  6476
  6477 1100-NO-STATE.
  6478     MOVE ER-2209                TO EMI-ERROR.
  6479     MOVE -1                     TO STATEL.
  6480     MOVE AL-UABON               TO STATEA.
  6481     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6482     GO TO 8200-SEND-DATAONLY.
  6483
  6484 1100-EXIT.
  6485     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL630.cbl
  6487
  6488 1200-VERIFY-ACCOUNT.
  6489     IF CARRIERL GREATER ZEROS
  6490         MOVE CARRIERI           TO ACCT-CARRIER
  6491     ELSE
  6492         MOVE SPACES             TO ACCT-CARRIER.
  6493
  6494     IF GROUPL GREATER ZEROS
  6495         MOVE GROUPI             TO ACCT-GROUPING
  6496     ELSE
  6497         MOVE SPACES             TO ACCT-GROUPING.
  6498
  6499     IF STATEL GREATER ZEROS
  6500         MOVE STATEI             TO ACCT-STATE
  6501     ELSE
  6502         MOVE SPACES             TO ACCT-STATE.
  6503
  6504     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  6505
  6506 1200-READ-ACCOUNT.
  6507     MOVE PI-COMPANY-CD          TO ACCT-CO.
  6508     MOVE LOW-VALUES             TO ACCT-EXP-DATE
  6509                                    PI-ACCT-LOW-EFF-DT
  6510                                    PI-ACCT-HIGH-EXP-DT.
  6511
  6512
  6513* EXEC CICS HANDLE CONDITION
  6514*        NOTFND   (1200-ACCOUNT-INVALID)
  6515*        ENDFILE  (1200-ACCOUNT-INVALID)
  6516*    END-EXEC.
  6517*    MOVE '"$I''                  ! '' #00006259' TO DFHEIV0
  6518     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6520     MOVE X'2720233030303036323539' TO DFHEIV0(25:11)
  6521     CALL 'kxdfhei1' USING DFHEIV0
  6522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6523
  6524
  6525
  6526* EXEC CICS STARTBR
  6527*        DATASET (ERACCT2-FILE-ID)
  6528*        RIDFLD  (ERACCT-KEY)
  6529*    END-EXEC.
  6530     MOVE 0
  6531       TO DFHEIV11
  6532*    MOVE '&,         G          &   #00006264' TO DFHEIV0
  6533     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6534     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6535     MOVE X'2020233030303036323634' TO DFHEIV0(25:11)
  6536     CALL 'kxdfhei1' USING DFHEIV0,
  6537           ERACCT2-FILE-ID,
  6538           ERACCT-KEY,
  6539           DFHEIV99,
  6540           DFHEIV11,
  6541           DFHEIV99
  6542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6543
  6544
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL630.cbl
  6545     MOVE ERACCT-KEY             TO ERACCT-SAVE-KEY.
  6546
  6547 1200-READ-LOOP.
  6548
  6549* EXEC CICS READNEXT
  6550*        DATASET   (ERACCT2-FILE-ID)
  6551*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6552*        RIDFLD    (ERACCT-KEY)
  6553*    END-EXEC.
  6554     MOVE 0
  6555       TO DFHEIV11
  6556*    MOVE '&.S                   )   #00006272' TO DFHEIV0
  6557     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6558     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6559     MOVE X'2020233030303036323732' TO DFHEIV0(25:11)
  6560     CALL 'kxdfhei1' USING DFHEIV0,
  6561           ERACCT2-FILE-ID,
  6562           DFHEIV20,
  6563           DFHEIV99,
  6564           ERACCT-KEY,
  6565           DFHEIV99,
  6566           DFHEIV11,
  6567           DFHEIV99,
  6568           DFHEIV99
  6569     SET ADDRESS OF ACCOUNT-MASTER TO
  6570         DFHEIV20
  6571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6572
  6573
  6574     IF ERACCT-COMP-KEY NOT = ERACCT-SAVE-KEY
  6575         GO TO 1200-ACCOUNT-INVALID.
  6576
  6577     IF WS-ON1-SW1 IS EQUAL TO 'Y'
  6578         MOVE 'N'                TO WS-ON1-SW1
  6579         MOVE +0                 TO WS-SUB1
  6580         MOVE AM-CARRIER         TO PI-SAV-FC-CARRIER
  6581         MOVE AM-GROUPING        TO PI-SAV-FC-GROUPING
  6582         MOVE AM-STATE           TO PI-SAV-FC-STATE
  6583         MOVE AM-VG-CARRIER      TO PI-SAV-CARRIER
  6584         MOVE AM-VG-GROUPING     TO PI-SAV-GROUPING
  6585         MOVE AM-VG-STATE        TO PI-SAV-STATE
  6586         MOVE AM-VG-ACCOUNT      TO PI-SAV-ACCOUNT
  6587         MOVE AM-EFFECTIVE-DT    TO PI-ACCT-LOW-EFF-DT.
  6588
  6589     MOVE AM-EXPIRATION-DT       TO PI-ACCT-HIGH-EXP-DT.
  6590     MOVE AM-NAME                TO PI-AM-NAME.
  6591     IF AM-EDIT-LOAN-OFC = 'Y'
  6592        MOVE 'Y'                 TO PI-AM-EDIT-LOAN-OFC
  6593     ELSE
  6594        MOVE 'N'                 TO PI-AM-EDIT-LOAN-OFC
  6595     END-IF
  6596     IF AM-GPCD = 02 OR 03 OR 04 OR 05
  6597        MOVE AM-PERSON           TO PI-AM-ADDR1
  6598        MOVE AM-ADDRS            TO PI-AM-ADDR2
  6599*       MOVE AM-CITY             TO PI-AM-CITYST
  6600        MOVE AM-ADDR-CITY        TO PI-AM-CITY
  6601        MOVE AM-ADDR-STATE       TO PI-AM-STATE
  6602        MOVE AM-ZIP              TO PI-AM-ZIP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL630.cbl
  6603     ELSE
  6604        MOVE SPACES TO PI-AM-ADDR1 PI-AM-ADDR2
  6605                      PI-AM-CITYST PI-AM-ZIP
  6606     END-IF
  6607
  6608     MOVE AM-CARRIER             TO PI-COMP-CARRIER.
  6609     MOVE AM-GROUPING            TO PI-COMP-GROUPING.
  6610     MOVE AM-CSR-CODE            TO PI-CSR-ID.
  6611
  6612     IF PI-AR-PROCESSING
  6613        MOVE 'Y'                 TO WS-RECORD-FOUND-SW
  6614        PERFORM 1260-FIND-ACCT-AGENT THRU 1260-EXIT
  6615        IF RECORD-NOT-FOUND
  6616           GO TO 8200-SEND-DATAONLY.
  6617
  6618     GO TO 1200-READ-LOOP.
  6619
  6620 1200-ACCOUNT-INVALID.
  6621     IF PI-ACCT-LOW-EFF-DT NOT = LOW-VALUES
  6622        MOVE 'Y'                 TO PI-ACCT-AGENT-PROCESSED-SW
  6623        GO TO 1200-EXIT.
  6624
  6625     IF CARR-GROUP-ST-ACCNT-CNTL
  6626         MOVE -1                     TO CARRIERL
  6627         MOVE AL-UABON               TO CARRIERA
  6628                                        GROUPA
  6629                                        STATEA
  6630                                        ACCOUNTA
  6631     ELSE
  6632         IF ST-ACCNT-CNTL
  6633             MOVE -1                 TO STATEL
  6634             MOVE AL-UABON           TO STATEA
  6635                                        ACCOUNTA
  6636         ELSE
  6637             IF CARR-ST-ACCNT-CNTL
  6638                 MOVE -1             TO CARRIERL
  6639                 MOVE AL-UABON       TO CARRIERA
  6640                                        STATEA
  6641                                        ACCOUNTA
  6642             ELSE
  6643                 IF ACCNT-CNTL
  6644                     MOVE -1         TO ACCOUNTL
  6645                     MOVE AL-UABON   TO ACCOUNTA
  6646                 ELSE
  6647                     MOVE -1         TO CARRIERL
  6648                     MOVE AL-UABON   TO CARRIERA
  6649                                        ACCOUNTA.
  6650
  6651     MOVE ER-2210                TO EMI-ERROR.
  6652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6653
  6654 1200-EXIT.
  6655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL630.cbl
  6657 1250-READ-COMPANY-REC.
  6658     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  6659     MOVE '1'                    TO CNTL-REC-TYPE.
  6660     MOVE SPACES                 TO CNTL-ACCESS.
  6661     MOVE +0                     TO CNTL-SEQ.
  6662
  6663
  6664* EXEC CICS HANDLE CONDITION
  6665*        NOTFND   (1250-NO-COMPANY-REC)
  6666*    END-EXEC.
  6667*    MOVE '"$I                   ! ( #00006367' TO DFHEIV0
  6668     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6670     MOVE X'2820233030303036333637' TO DFHEIV0(25:11)
  6671     CALL 'kxdfhei1' USING DFHEIV0
  6672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6673
  6674
  6675
  6676* EXEC CICS READ
  6677*        DATASET   (ELCNTL-FILE-ID)
  6678*        SET       (ADDRESS OF CONTROL-FILE)
  6679*        RIDFLD    (ELCNTL-KEY)
  6680*    END-EXEC.
  6681*    MOVE '&"S        E          (   #00006371' TO DFHEIV0
  6682     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6683     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6684     MOVE X'2020233030303036333731' TO DFHEIV0(25:11)
  6685     CALL 'kxdfhei1' USING DFHEIV0,
  6686           ELCNTL-FILE-ID,
  6687           DFHEIV20,
  6688           DFHEIV99,
  6689           ELCNTL-KEY,
  6690           DFHEIV99,
  6691           DFHEIV99,
  6692           DFHEIV99
  6693     SET ADDRESS OF CONTROL-FILE TO
  6694         DFHEIV20
  6695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6696
  6697
  6698     MOVE CF-CREDIT-EDIT-CONTROLS TO PI-CREDIT-EDIT-CONTROLS.
  6699     GO TO 1250-EXIT.
  6700
  6701 1250-NO-COMPANY-REC.
  6702     MOVE ER-2248                TO EMI-ERROR.
  6703     MOVE -1                     TO BATCHL.
  6704     MOVE AL-UABON               TO CARRIERA
  6705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6706     GO TO 8200-SEND-DATAONLY.
  6707
  6708 1250-EXIT.
  6709     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL630.cbl
  6711
  6712 1260-FIND-ACCT-AGENT.
  6713
  6714******************************************************************
  6715*                                                                *
  6716*            F I N D   A C C O U N T   A G E N T                 *
  6717*                                                                *
  6718*    NOTE:  IT IS NECESSARY TO LOAD EVERY DATE RANGE FOR         *
  6719*           EACH ACCOUNT AGENT / FINANCIAL RESPONSIBILITY        *
  6720*           INTO THE PROGRAM INTERFACE AREA.  THE ACCOUNT        *
  6721*           DATE RANGES ARE CHECKED DURING DATA ENTRY IN         *
  6722*           EL6301.                                              *
  6723*                                                                *
  6724******************************************************************
  6725
  6726     IF PI-ACCT-AGENT-PROCESSED
  6727        GO TO 1260-EXIT.
  6728
  6729     IF WS-ON1-SW2 IS EQUAL TO 'Y'
  6730        MOVE 'N'                 TO WS-ON1-SW2
  6731     ELSE
  6732        MOVE +0                  TO WS-SUB2
  6733        GO TO 1260-CONT-FIND-ACCT-AGENT.
  6734
  6735     MOVE +0                     TO WS-SUB2.
  6736
  6737 1260-INITIALIZE-DATE-RANGES.
  6738     ADD +1                      TO WS-SUB2.
  6739
  6740     IF WS-SUB2 GREATER +32
  6741        GO TO 1260-INITIALIZE-FINISHED.
  6742
  6743     MOVE SPACES                 TO PI-ACCT-EFF-DT (WS-SUB2)
  6744                                    PI-ACCT-EXP-DT (WS-SUB2)
  6745                                    PI-REMIT-AGENT (WS-SUB2)
  6746                                    PI-ACCT-AGENT  (WS-SUB2).
  6747
  6748     GO TO 1260-INITIALIZE-DATE-RANGES.
  6749
  6750 1260-INITIALIZE-FINISHED.
  6751     MOVE SPACES                 TO PI-ACCOUNT-AGENT
  6752                                    PI-FIN-RESP.
  6753
  6754     MOVE 'N'                    TO PI-ACCT-AGENT-ERROR-SW
  6755                                    PI-FIN-RESP-ERROR-SW.
  6756
  6757     MOVE +0                     TO WS-SUB2.
  6758
  6759 1260-CONT-FIND-ACCT-AGENT.
  6760     ADD  +1                     TO WS-SUB2.
  6761
  6762     IF WS-SUB2 GREATER +10
  6763        MOVE  SPACES             TO PI-ACCT-AGENT (WS-SUB1)
  6764        GO TO 1260-EXIT.
  6765
  6766     IF AM-COM-TYP (WS-SUB2) = 'C' OR 'D' OR 'F' OR 'S'
  6767        NEXT SENTENCE
  6768     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL630.cbl
  6769        GO TO 1260-CONT-FIND-ACCT-AGENT.
  6770
  6771     IF WS-SUB1 = +0
  6772        MOVE +1                   TO WS-SUB1
  6773                                     PI-SUB
  6774        MOVE AM-EFFECTIVE-DT      TO PI-ACCT-EFF-DT (WS-SUB1)
  6775        MOVE AM-EXPIRATION-DT     TO PI-ACCT-EXP-DT (WS-SUB1)
  6776        MOVE AM-AGT (WS-SUB2)     TO PI-ACCT-AGENT  (WS-SUB1)
  6777        MOVE AM-AGT (AM-REMIT-TO) TO PI-REMIT-AGENT (WS-SUB1)
  6778        GO TO 1260-EXIT.
  6779
  6780     IF AM-AGT (WS-SUB2)     = PI-ACCT-AGENT  (WS-SUB1) AND
  6781        AM-AGT (AM-REMIT-TO) = PI-REMIT-AGENT (WS-SUB1)
  6782          MOVE AM-EXPIRATION-DT  TO PI-ACCT-EXP-DT (WS-SUB1)
  6783        ELSE
  6784          ADD +1                      TO WS-SUB1
  6785          IF WS-SUB1 GREATER +32
  6786              MOVE  ER-2119             TO EMI-ERROR
  6787              MOVE -1                   TO MAINTL
  6788              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  6789              MOVE 'N'                  TO WS-RECORD-FOUND-SW
  6790              GO TO 1260-EXIT
  6791          ELSE
  6792           MOVE WS-SUB1              TO PI-SUB
  6793           MOVE AM-EFFECTIVE-DT      TO PI-ACCT-EFF-DT (WS-SUB1)
  6794           MOVE AM-EXPIRATION-DT     TO PI-ACCT-EXP-DT (WS-SUB1)
  6795           MOVE AM-AGT (WS-SUB2)     TO PI-ACCT-AGENT  (WS-SUB1)
  6796           MOVE AM-AGT (AM-REMIT-TO) TO PI-REMIT-AGENT (WS-SUB1).
  6797
  6798 1260-EXIT.
  6799      EXIT.
  6800
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL630.cbl
  6802
  6803 1300-GET-BATCH-NO.
  6804
  6805* EXEC CICS HANDLE CONDITION
  6806*        NOTFND   (1300-NO-COMPANY-REC)
  6807*    END-EXEC.
  6808*    MOVE '"$I                   ! ) #00006483' TO DFHEIV0
  6809     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6811     MOVE X'2920233030303036343833' TO DFHEIV0(25:11)
  6812     CALL 'kxdfhei1' USING DFHEIV0
  6813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6814
  6815
  6816
  6817* EXEC CICS READ
  6818*        DATASET   (ELCNTL-FILE-ID)
  6819*        SET       (ADDRESS OF CONTROL-FILE)
  6820*        RIDFLD    (ELCNTL-KEY)
  6821*        UPDATE
  6822*    END-EXEC.
  6823*    MOVE '&"S        EU         (   #00006487' TO DFHEIV0
  6824     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6825     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6826     MOVE X'2020233030303036343837' TO DFHEIV0(25:11)
  6827     CALL 'kxdfhei1' USING DFHEIV0,
  6828           ELCNTL-FILE-ID,
  6829           DFHEIV20,
  6830           DFHEIV99,
  6831           ELCNTL-KEY,
  6832           DFHEIV99,
  6833           DFHEIV99,
  6834           DFHEIV99
  6835     SET ADDRESS OF CONTROL-FILE TO
  6836         DFHEIV20
  6837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6838
  6839
  6840 1300-ASSIGN-NUMBER-LOOP.
  6841     IF CF-LAST-BATCH-RESET
  6842         MOVE ZEROS              TO CF-LAST-BATCH-NO
  6843         ADD +1                  TO CF-LAST-BATCH-NO
  6844     ELSE
  6845         ADD +1                  TO CF-LAST-BATCH-NO.
  6846
  6847     MOVE CF-LAST-BATCH-NO       TO WS-BATCH-NO.
  6848     MOVE WS-BATCH-NO            TO PI-SAV-ENTRY-BATCH.
  6849
  6850 1300-REWRITE-COMPANY-REC.
  6851     MOVE WS-BATCH-NO            TO BATCHI.
  6852     MOVE AL-UANON               TO BATCHA.
  6853
  6854
  6855* EXEC CICS REWRITE
  6856*        DATASET (ELCNTL-FILE-ID)
  6857*        FROM    (CONTROL-FILE)
  6858*    END-EXEC.
  6859     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL630.cbl
  6860      CONTROL-FILE
  6861       TO DFHEIV11
  6862*    MOVE '&& L                  %   #00006508' TO DFHEIV0
  6863     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6864     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6865     MOVE X'2020233030303036353038' TO DFHEIV0(25:11)
  6866     CALL 'kxdfhei1' USING DFHEIV0,
  6867           ELCNTL-FILE-ID,
  6868           CONTROL-FILE,
  6869           DFHEIV11,
  6870           DFHEIV99
  6871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6872
  6873
  6874
  6875* EXEC CICS SYNCPOINT
  6876*    END-EXEC.
  6877*    MOVE '6"                    !   #00006513' TO DFHEIV0
  6878     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6880     MOVE X'2020233030303036353133' TO DFHEIV0(25:11)
  6881     CALL 'kxdfhei1' USING DFHEIV0
  6882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6883
  6884
  6885 1300-CHECK-FOR-DUP-BATCH.
  6886
  6887* EXEC CICS HANDLE CONDITION
  6888*        NOTFND  (1300-EXIT)
  6889*    END-EXEC.
  6890*    MOVE '"$I                   ! * #00006517' TO DFHEIV0
  6891     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6893     MOVE X'2A20233030303036353137' TO DFHEIV0(25:11)
  6894     CALL 'kxdfhei1' USING DFHEIV0
  6895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6896
  6897
  6898
  6899* EXEC CICS READ
  6900*        SET     (ADDRESS OF PENDING-BUSINESS)
  6901*        DATASET (ERPNDB-FILE-ID)
  6902*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  6903*        GTEQ
  6904*    END-EXEC.
  6905*    MOVE '&"S        G          (   #00006521' TO DFHEIV0
  6906     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6907     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6908     MOVE X'2020233030303036353231' TO DFHEIV0(25:11)
  6909     CALL 'kxdfhei1' USING DFHEIV0,
  6910           ERPNDB-FILE-ID,
  6911           DFHEIV20,
  6912           DFHEIV99,
  6913           PI-SAV-ENDING-ERPNDB-KEY,
  6914           DFHEIV99,
  6915           DFHEIV99,
  6916           DFHEIV99
  6917     SET ADDRESS OF PENDING-BUSINESS TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL630.cbl
  6918         DFHEIV20
  6919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6920
  6921
  6922     IF PI-SAV-COMP-CD NOT = PB-COMPANY-CD
  6923         GO TO 1300-EXIT.
  6924
  6925     IF PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  6926         MOVE LOW-VALUES         TO EL630AO
  6927         MOVE QUESTION-MARKS     TO BATCHO
  6928         MOVE AL-UABON           TO BATCHA
  6929         MOVE -1                 TO BATCHL
  6930         MOVE ER-2229            TO EMI-ERROR
  6931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6932         GO TO 8100-SEND-INITIAL-MAP.
  6933
  6934     GO TO 1300-EXIT.
  6935
  6936 1300-NO-COMPANY-REC.
  6937     MOVE ER-2248                TO EMI-ERROR.
  6938     MOVE -1                     TO BATCHL.
  6939     MOVE AL-UABON               TO CARRIERA
  6940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6941     GO TO 8200-SEND-DATAONLY.
  6942
  6943 1300-EXIT.
  6944     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL630.cbl
  6946
  6947 1400-VERIFY-COMP-MASTER.
  6948
  6949******************************************************************
  6950*
  6951*      V E R I F Y    C O M P E N S A T I O N    M A S T E R
  6952*
  6953*       READ COMPENSATION MASTER AND SAVE SUMMARY CODE FOR
  6954*       A.R. PROCESSING.
  6955*
  6956******************************************************************
  6957
  6958
  6959* EXEC CICS HANDLE CONDITION
  6960*        NOTFND   (1470-NO-COMP-MSTR)
  6961*    END-EXEC.
  6962*    MOVE '"$I                   ! + #00006564' TO DFHEIV0
  6963     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6965     MOVE X'2B20233030303036353634' TO DFHEIV0(25:11)
  6966     CALL 'kxdfhei1' USING DFHEIV0
  6967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6968
  6969
  6970     MOVE SPACE                  TO WS-COMP-MASTER-ERROR-SW.
  6971     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  6972
  6973     IF PI-ZERO-CARRIER OR
  6974        PI-ZERO-CAR-GROUP
  6975        MOVE ZEROS               TO ERCOMP-CARRIER
  6976     ELSE
  6977        MOVE PI-COMP-CARRIER     TO ERCOMP-CARRIER.
  6978
  6979     IF PI-ZERO-GROUPING OR
  6980        PI-ZERO-CAR-GROUP
  6981        MOVE ZEROS               TO ERCOMP-GROUPING
  6982     ELSE
  6983        MOVE PI-COMP-GROUPING    TO ERCOMP-GROUPING.
  6984
  6985     MOVE PI-FIN-RESP            TO ERCOMP-FIN-RESP.
  6986     MOVE PI-ACCOUNT-AGENT       TO ERCOMP-ACCT.
  6987     MOVE 'A'                    TO ERCOMP-RECORD-TYPE.
  6988
  6989
  6990* EXEC CICS READ
  6991*        DATASET   (ERCOMP-FILE-ID)
  6992*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6993*        RIDFLD    (ERCOMP-KEY)
  6994*    END-EXEC.
  6995*    MOVE '&"S        E          (   #00006587' TO DFHEIV0
  6996     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6998     MOVE X'2020233030303036353837' TO DFHEIV0(25:11)
  6999     CALL 'kxdfhei1' USING DFHEIV0,
  7000           ERCOMP-FILE-ID,
  7001           DFHEIV20,
  7002           DFHEIV99,
  7003           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL630.cbl
  7004           DFHEIV99,
  7005           DFHEIV99,
  7006           DFHEIV99
  7007     SET ADDRESS OF COMPENSATION-MASTER TO
  7008         DFHEIV20
  7009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7010
  7011
  7012     MOVE CO-AR-SUMMARY-CODE     TO PI-SUMMARY-CODE.
  7013
  7014     IF REFL GREATER ZEROS
  7015         GO TO 1490-EXIT.
  7016
  7017     IF PI-SAV-REFERENCE GREATER SPACES
  7018         GO TO 1490-EXIT.
  7019
  7020     IF CO-AR-NET-REPORT
  7021        MOVE 'Y'                 TO WS-UPDATE-REFERENCE-SW
  7022        MOVE WS-CURRENT-YMD      TO PI-SAV-REFERENCE
  7023     ELSE
  7024        MOVE SPACES              TO PI-SAV-REFERENCE.
  7025
  7026     GO TO 1490-EXIT.
  7027
  7028 1470-NO-COMP-MSTR.
  7029     MOVE ER-2800                TO EMI-ERROR.
  7030     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7031     MOVE 'Y'                    TO WS-COMP-MASTER-ERROR-SW.
  7032
  7033 1490-EXIT.
  7034     EXIT.
  7035
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL630.cbl
  7037
  7038******************************************************************
  7039*                                                                *
  7040*           W R I T E   R E Q U E S T   R E C O R D              *
  7041*                                                                *
  7042******************************************************************
  7043
  7044 1900-WRITE-REQUEST-RECORD.
  7045
  7046* EXEC CICS GETMAIN
  7047*         SET       (ADDRESS OF AR-REQUEST-RECORD)
  7048*         LENGTH    (200)
  7049*         INITIMG   (GETMAIN-SPACE)
  7050*    END-EXEC.
  7051     MOVE 200
  7052       TO DFHEIV11
  7053*    MOVE ',"IL                  $   #00006626' TO DFHEIV0
  7054     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7055     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7056     MOVE X'2020233030303036363236' TO DFHEIV0(25:11)
  7057     CALL 'kxdfhei1' USING DFHEIV0,
  7058           DFHEIV20,
  7059           DFHEIV11,
  7060           GETMAIN-SPACE
  7061     SET ADDRESS OF AR-REQUEST-RECORD TO
  7062         DFHEIV20
  7063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7064
  7065
  7066     MOVE 'RQ'                   TO RQ-RECORD-ID.
  7067
  7068     MOVE PI-SAV-ENTRY-BATCH     TO RQ-ENTRY-BATCH
  7069                                    RQ-BATCH-A1
  7070                                    RQ-BATCH-A2
  7071                                    RQ-BATCH-A3
  7072                                    RQ-BATCH-A4.
  7073
  7074     MOVE PI-SAV-REFERENCE       TO RQ-REFERENCE-A1
  7075                                    RQ-REFERENCE-A2
  7076                                    RQ-REFERENCE-A4.
  7077
  7078     MOVE PI-COMPANY-CD          TO RQ-COMPANY-CD
  7079                                    RQ-COMPANY-CD-A1
  7080                                    RQ-COMPANY-CD-A2
  7081                                    RQ-COMPANY-CD-A3
  7082                                    RQ-COMPANY-CD-A4.
  7083
  7084     MOVE PI-SAV-FC-CARRIER      TO RQ-CARRIER-A1
  7085                                    RQ-CARRIER-A2
  7086                                    RQ-CARRIER-A3
  7087                                    PI-CR-CARRIER.
  7088
  7089     MOVE PI-SAV-FC-GROUPING     TO RQ-GROUPING-A1
  7090                                    RQ-GROUPING-A2
  7091                                    RQ-GROUPING-A3
  7092                                    PI-CR-GROUPING.
  7093
  7094     IF PI-ZERO-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL630.cbl
  7095        MOVE ZERO                TO RQ-CARRIER-A2
  7096                                    PI-CR-CARRIER.
  7097
  7098     IF PI-ZERO-GROUPING
  7099        MOVE ZEROS               TO RQ-GROUPING-A2
  7100                                    PI-CR-GROUPING.
  7101
  7102     IF PI-ZERO-CAR-GROUP
  7103        MOVE ZEROS               TO RQ-CARRIER-A2
  7104                                    RQ-GROUPING-A2
  7105                                    PI-CR-CARRIER
  7106                                    PI-CR-GROUPING.
  7107
  7108     MOVE PI-SAV-FC-STATE        TO RQ-STATE-A1
  7109                                    PI-CR-STATE.
  7110
  7111     MOVE PI-SAV-ACCOUNT         TO RQ-ACCOUNT-A1
  7112                                    RQ-ACCOUNT-A4
  7113                                    PI-CR-ACCOUNT.
  7114
  7115
  7116     MOVE PI-ACCOUNT-AGENT       TO RQ-ACCT-AGENT-A2
  7117                                    RQ-ACCT-AGENT-A3.
  7118
  7119     MOVE WS-CURRENT-BIN-DT      TO RQ-ENTRY-DT.
  7120
  7121     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7122         MOVE PI-NB-MONTH-END-DT TO RQ-MO-END-DT
  7123     ELSE
  7124         MOVE PI-CR-MONTH-END-DT TO RQ-MO-END-DT.
  7125
  7126     MOVE LOW-VALUES             TO RQ-REQUEST-DT
  7127                                    RQ-STMT-DT
  7128                                    RQ-REVERSAL-DT
  7129                                    RQ-CREDIT-SELECT-DT
  7130                                    RQ-CREDIT-ACCEPT-DT.
  7131
  7132     IF PI-FIN-RESP-ERROR
  7133        MOVE 'E'                 TO RQ-STATUS
  7134        MOVE 'UNKNOWN'           TO RQ-FIN-RESP-A2
  7135                                    PI-CR-FIN-RESP
  7136     ELSE
  7137        MOVE PI-FIN-RESP         TO RQ-FIN-RESP-A2
  7138                                    PI-CR-FIN-RESP.
  7139
  7140     IF PI-ACCT-AGENT-ERROR
  7141        MOVE 'E'                 TO RQ-STATUS
  7142        MOVE 'UNKNOWN'           TO RQ-ACCT-AGENT-A2
  7143                                    RQ-ACCT-AGENT-A3.
  7144
  7145     IF WS-COMP-MASTER-ERROR
  7146        MOVE 'E'                 TO RQ-STATUS
  7147        MOVE 'UNKNOWN'           TO PI-CR-FIN-RESP.
  7148
  7149     MOVE RQ-CONTROL-PRIMARY     TO ERRQST-KEY.
  7150     MOVE LOW-VALUES             TO RQ-STMT-DT
  7151                                    RQ-REQUEST-DT
  7152                                    RQ-REVERSAL-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL630.cbl
  7153
  7154     MOVE CO-AR-SUMMARY-CODE     TO RQ-SUMMARY-CODE.
  7155
  7156     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7157         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  7158     ELSE
  7159         MOVE PI-CR-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  7160
  7161
  7162* EXEC CICS HANDLE CONDITION
  7163*        DUPREC (1990-EXIT)
  7164*    END-EXEC.
  7165*    MOVE '"$%                   ! , #00006727' TO DFHEIV0
  7166     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7168     MOVE X'2C20233030303036373237' TO DFHEIV0(25:11)
  7169     CALL 'kxdfhei1' USING DFHEIV0
  7170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7171
  7172
  7173
  7174* EXEC CICS WRITE
  7175*         DATASET    (ERRQST-FILE-ID)
  7176*         FROM       (AR-REQUEST-RECORD)
  7177*         RIDFLD     (ERRQST-KEY)
  7178*    END-EXEC.
  7179     MOVE LENGTH OF
  7180      AR-REQUEST-RECORD
  7181       TO DFHEIV11
  7182*    MOVE '&$ L                  ''   #00006731' TO DFHEIV0
  7183     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7184     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7185     MOVE X'2020233030303036373331' TO DFHEIV0(25:11)
  7186     CALL 'kxdfhei1' USING DFHEIV0,
  7187           ERRQST-FILE-ID,
  7188           AR-REQUEST-RECORD,
  7189           DFHEIV11,
  7190           ERRQST-KEY,
  7191           DFHEIV99,
  7192           DFHEIV99
  7193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7194
  7195
  7196 1990-EXIT.
  7197     EXIT.
  7198
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL630.cbl
  7200 2000-WRITE-BATCH-TOTAL-REC.
  7201
  7202     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  7203     MOVE PI-SAV-ENTRY-BATCH     TO PNDB-ENTRY-BATCH.
  7204     MOVE 9999                   TO PNDB-BATCH-SEQ.
  7205
  7206
  7207* EXEC CICS HANDLE CONDITION
  7208*        NOTFND (2100-ADD-BATCH-TOTAL-REC)
  7209*    END-EXEC.
  7210*    MOVE '"$I                   ! - #00006747' TO DFHEIV0
  7211     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7213     MOVE X'2D20233030303036373437' TO DFHEIV0(25:11)
  7214     CALL 'kxdfhei1' USING DFHEIV0
  7215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7216
  7217
  7218
  7219* EXEC CICS READ
  7220*        SET    (ADDRESS OF PENDING-BUSINESS)
  7221*        DATASET(ERPNDB-FILE-ID)
  7222*        RIDFLD (ERPNDB-KEY)
  7223*        UPDATE
  7224*    END-EXEC.
  7225*    MOVE '&"S        EU         (   #00006751' TO DFHEIV0
  7226     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7227     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7228     MOVE X'2020233030303036373531' TO DFHEIV0(25:11)
  7229     CALL 'kxdfhei1' USING DFHEIV0,
  7230           ERPNDB-FILE-ID,
  7231           DFHEIV20,
  7232           DFHEIV99,
  7233           ERPNDB-KEY,
  7234           DFHEIV99,
  7235           DFHEIV99,
  7236           DFHEIV99
  7237     SET ADDRESS OF PENDING-BUSINESS TO
  7238         DFHEIV20
  7239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7240
  7241
  7242******************************************************************
  7243*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  7244*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE AND THE      *
  7245*       OPERATOR HAS NOT ENTERED A NEW MONTH-END-DATE USE THE    *
  7246*       MONTH-END-DATE IN TRAILER RECORD FOR ALL DETAIL RECORDS. *
  7247******************************************************************
  7248
  7249     IF  PI-NB-MONTH-END-DT = SPACES
  7250         IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  7251             NEXT SENTENCE
  7252         ELSE
  7253             MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  7254
  7255     IF PI-AR-PROCESSING
  7256        IF REFL = ZEROS
  7257           IF PB-REFERENCE GREATER SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL630.cbl
  7258              MOVE PB-REFERENCE  TO PI-SAV-REFERENCE
  7259           ELSE
  7260              NEXT SENTENCE
  7261        ELSE
  7262           IF PI-SAV-REFERENCE NOT = PB-REFERENCE
  7263              MOVE 'Y'              TO WS-UPDATE-REFERENCE-SW
  7264                                       WS-RECORD-FOUND-SW
  7265              PERFORM 7100-REWRITE-REQUEST-REC THRU 7190-EXIT
  7266              IF RECORD-NOT-FOUND
  7267                  GO TO 8200-SEND-DATAONLY
  7268              ELSE
  7269                  MOVE PI-SAV-REFERENCE TO PB-REFERENCE.
  7270
  7271     IF ELFISSL NOT = ZEROS
  7272         MOVE PI-LF-ISS-REMITTED  TO PB-B-LF-ISS-PRM-REMITTED.
  7273     IF EAHISSL NOT = ZEROS
  7274         MOVE PI-AH-ISS-REMITTED  TO PB-B-AH-ISS-PRM-REMITTED.
  7275     IF EISSCNTL NOT = ZEROS
  7276         MOVE PI-ISS-CNT-REMITTED TO PB-B-ISSUE-CNT-REMITTED.
  7277     IF ECANCNTL NOT = ZEROS
  7278         MOVE PI-CAN-CNT-REMITTED TO PB-B-CANCEL-CNT-REMITTED.
  7279     IF ELFCANL NOT = ZEROS
  7280         MOVE PI-LF-CAN-REMITTED  TO PB-B-LF-CAN-PRM-REMITTED.
  7281     IF EAHCANL NOT = ZEROS
  7282         MOVE PI-AH-CAN-REMITTED  TO PB-B-AH-CAN-PRM-REMITTED.
  7283
  7284     IF WS-PF1
  7285         MOVE PI-LF-ISS-ENTERED   TO PB-B-LF-ISS-PRM-ENTERED
  7286         MOVE PI-AH-ISS-ENTERED   TO PB-B-AH-ISS-PRM-ENTERED
  7287         MOVE PI-ISS-CNT-ENTERED  TO PB-B-ISSUE-CNT-ENTERED
  7288         MOVE PI-CAN-CNT-ENTERED  TO PB-B-CANCEL-CNT-ENTERED
  7289         MOVE PI-LF-CAN-ENTERED   TO PB-B-LF-CAN-PRM-ENTERED
  7290         MOVE PI-AH-CAN-ENTERED   TO PB-B-AH-CAN-PRM-ENTERED
  7291         MOVE PI-LAST-SEQ-NO-ADDED TO PB-B-HIGHEST-SEQ-NO.
  7292
  7293     MOVE PI-RECEIVED-DT         TO PB-B-RECEIVED-DT.
  7294
  7295     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  7296     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  7297     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  7298
  7299     IF PI-AR-PROCESSING
  7300        IF PI-DATA-UPDATED
  7301           PERFORM 1400-VERIFY-COMP-MASTER   THRU 1490-EXIT
  7302           PERFORM 1900-WRITE-REQUEST-RECORD THRU 1990-EXIT
  7303           IF PI-MAINT-FUNC NOT = 'K'
  7304              MOVE PI-SAV-REFERENCE TO PB-REFERENCE.
  7305
  7306
  7307* EXEC CICS REWRITE
  7308*        DATASET(ERPNDB-FILE-ID)
  7309*        FROM   (PENDING-BUSINESS)
  7310*    END-EXEC.
  7311     MOVE LENGTH OF
  7312      PENDING-BUSINESS
  7313       TO DFHEIV11
  7314*    MOVE '&& L                  %   #00006822' TO DFHEIV0
  7315     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL630.cbl
  7316     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7317     MOVE X'2020233030303036383232' TO DFHEIV0(25:11)
  7318     CALL 'kxdfhei1' USING DFHEIV0,
  7319           ERPNDB-FILE-ID,
  7320           PENDING-BUSINESS,
  7321           DFHEIV11,
  7322           DFHEIV99
  7323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7324
  7325
  7326     IF  PI-AR-PROCESSING
  7327         IF WS-UPDATE-REFERENCE
  7328            PERFORM 5000-UPDATE-ENTIRE-BATCH THRU 5900-EXIT
  7329            GO TO 2990-EXIT.
  7330
  7331     IF PI-NB-MONTH-END-DT = PB-CREDIT-SELECT-DT
  7332        GO TO 2990-EXIT.
  7333
  7334     IF PI-NB-MONTH-END-DT GREATER SPACES
  7335         PERFORM 5000-UPDATE-ENTIRE-BATCH THRU 5900-EXIT
  7336             IF PI-AR-PROCESSING
  7337                 MOVE 'Y'          TO WS-RECORD-FOUND-SW
  7338                 PERFORM 7200-REWRITE-REQUEST THRU 7299-EXIT
  7339                 IF RECORD-NOT-FOUND
  7340                     GO TO 8200-SEND-DATAONLY.
  7341
  7342     GO TO 2990-EXIT.
  7343
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL630.cbl
  7345
  7346 2100-ADD-BATCH-TOTAL-REC.
  7347
  7348* EXEC CICS GETMAIN
  7349*        SET    (ADDRESS OF PENDING-BUSINESS)
  7350*        LENGTH (585)
  7351*        INITIMG(GETMAIN-SPACE)
  7352*    END-EXEC.
  7353     MOVE 585
  7354       TO DFHEIV11
  7355*    MOVE ',"IL                  $   #00006848' TO DFHEIV0
  7356     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7357     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7358     MOVE X'2020233030303036383438' TO DFHEIV0(25:11)
  7359     CALL 'kxdfhei1' USING DFHEIV0,
  7360           DFHEIV20,
  7361           DFHEIV11,
  7362           GETMAIN-SPACE
  7363     SET ADDRESS OF PENDING-BUSINESS TO
  7364         DFHEIV20
  7365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7366
  7367
  7368     MOVE 'PB'                   TO PB-RECORD-ID.
  7369     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  7370                                    PB-COMPANY-CD-A1.
  7371     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  7372     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH
  7373                                    PB-CERT-NO.
  7374     MOVE 9999                   TO PB-BATCH-SEQ-NO.
  7375     MOVE HIGH-VALUES            TO PB-CERT-EFF-DT.
  7376     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  7377                                    PB-ALT-CHG-SEQ-NO.
  7378
  7379     IF REFL GREATER THAN +0
  7380        MOVE REFI                TO PB-REFERENCE
  7381                                    PI-SAV-REFERENCE.
  7382
  7383     IF PI-LF-ISS-REMITTED     NOT NUMERIC
  7384        MOVE +0                  TO PI-LF-ISS-REMITTED.
  7385
  7386     IF PI-LF-ISS-ENTERED      NOT NUMERIC
  7387        MOVE +0                  TO PI-LF-ISS-ENTERED.
  7388
  7389     IF PI-AH-ISS-REMITTED     NOT NUMERIC
  7390        MOVE +0                  TO PI-AH-ISS-REMITTED.
  7391
  7392     IF PI-AH-ISS-ENTERED      NOT NUMERIC
  7393        MOVE +0                  TO PI-AH-ISS-ENTERED.
  7394
  7395     IF PI-ISS-CNT-REMITTED    NOT NUMERIC
  7396        MOVE +0                  TO PI-ISS-CNT-REMITTED.
  7397
  7398     IF PI-ISS-CNT-ENTERED     NOT NUMERIC
  7399        MOVE +0                  TO PI-ISS-CNT-ENTERED.
  7400
  7401     IF PI-CAN-CNT-REMITTED    NOT NUMERIC
  7402        MOVE +0                  TO PI-CAN-CNT-REMITTED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL630.cbl
  7403
  7404     IF PI-CAN-CNT-ENTERED     NOT NUMERIC
  7405        MOVE +0                  TO PI-CAN-CNT-ENTERED.
  7406
  7407     IF PI-LF-CAN-REMITTED     NOT NUMERIC
  7408        MOVE +0                  TO PI-LF-CAN-REMITTED.
  7409
  7410     IF PI-LF-CAN-ENTERED      NOT NUMERIC
  7411        MOVE +0                  TO PI-LF-CAN-ENTERED.
  7412
  7413     IF PI-LF-CAN-REMITTED     NOT NUMERIC
  7414        MOVE +0                  TO PI-LF-CAN-REMITTED.
  7415
  7416     IF PI-AH-CAN-REMITTED     NOT NUMERIC
  7417        MOVE +0                  TO PI-AH-CAN-REMITTED.
  7418
  7419     IF PI-AH-CAN-ENTERED      NOT NUMERIC
  7420        MOVE +0                  TO PI-AH-CAN-ENTERED.
  7421
  7422
  7423     MOVE PI-SAV-CARRIER         TO PB-CARRIER.
  7424     MOVE PI-SAV-GROUPING        TO PB-GROUPING.
  7425     MOVE PI-SAV-STATE           TO PB-STATE.
  7426     MOVE PI-SAV-ACCOUNT         TO PB-ACCOUNT.
  7427     MOVE '9'                    TO PB-RECORD-TYPE.
  7428     MOVE PI-LF-ISS-REMITTED     TO PB-B-LF-ISS-PRM-REMITTED.
  7429     MOVE PI-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED.
  7430     MOVE PI-AH-ISS-REMITTED     TO PB-B-AH-ISS-PRM-REMITTED.
  7431     MOVE PI-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED.
  7432     MOVE PI-ISS-CNT-REMITTED    TO PB-B-ISSUE-CNT-REMITTED.
  7433     MOVE PI-ISS-CNT-ENTERED     TO PB-B-ISSUE-CNT-ENTERED.
  7434     MOVE PI-CAN-CNT-REMITTED    TO PB-B-CANCEL-CNT-REMITTED.
  7435     MOVE PI-CAN-CNT-ENTERED     TO PB-B-CANCEL-CNT-ENTERED.
  7436     MOVE PI-LF-CAN-REMITTED     TO PB-B-LF-CAN-PRM-REMITTED.
  7437     MOVE PI-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED.
  7438     MOVE PI-AH-CAN-REMITTED     TO PB-B-AH-CAN-PRM-REMITTED.
  7439     MOVE PI-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED.
  7440     MOVE ZEROS                  TO PB-B-LF-ISS-PRM-COMPUTED
  7441                                    PB-B-LF-CAN-PRM-COMPUTED
  7442                                    PB-B-AH-ISS-PRM-COMPUTED
  7443                                    PB-B-AH-CAN-PRM-COMPUTED
  7444                                    PB-LF-BILLED-AMTS
  7445                                    PB-AH-BILLED-AMTS
  7446                                    PB-CHG-COUNT
  7447                                    PB-CALC-TOLERANCE.
  7448     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  7449                                    PB-BILLED-DT
  7450                                    PB-ACCT-EFF-DT
  7451                                    PB-ACCT-EXP-DT.
  7452
  7453     IF  PI-NB-MONTH-END-DT GREATER SPACES
  7454         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  7455        ELSE
  7456         MOVE PI-CR-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  7457
  7458     MOVE PI-LAST-SEQ-NO-ADDED   TO PB-B-HIGHEST-SEQ-NO.
  7459
  7460     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL630.cbl
  7461                                    PB-INPUT-BY.
  7462     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  7463     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  7464                                    PB-INPUT-DT.
  7465
  7466     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
  7467
  7468     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
  7469     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
  7470     MOVE PI-CSR-ID              TO PB-CSR-ID.
  7471     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
  7472     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
  7473
  7474     MOVE PI-RECEIVED-DT         TO PB-B-RECEIVED-DT.
  7475
  7476     MOVE PI-AM-NAME             TO  PB-ACCOUNT-NAME.
  7477     MOVE PI-SAV-FC-CARRIER      TO  PB-SV-CARRIER.
  7478     MOVE PI-SAV-FC-GROUPING     TO  PB-SV-GROUPING.
  7479     MOVE PI-SAV-FC-STATE        TO  PB-SV-STATE.
  7480
  7481     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-KEY.
  7482
  7483
  7484* EXEC CICS WRITE
  7485*        DATASET(ERPNDB-FILE-ID)
  7486*        FROM   (PENDING-BUSINESS)
  7487*        RIDFLD (PB-CONTROL-PRIMARY)
  7488*    END-EXEC.
  7489     MOVE LENGTH OF
  7490      PENDING-BUSINESS
  7491       TO DFHEIV11
  7492*    MOVE '&$ L                  ''   #00006969' TO DFHEIV0
  7493     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7495     MOVE X'2020233030303036393639' TO DFHEIV0(25:11)
  7496     CALL 'kxdfhei1' USING DFHEIV0,
  7497           ERPNDB-FILE-ID,
  7498           PENDING-BUSINESS,
  7499           DFHEIV11,
  7500           PB-CONTROL-PRIMARY,
  7501           DFHEIV99,
  7502           DFHEIV99
  7503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7504
  7505
  7506 2990-EXIT.
  7507     EXIT.
  7508
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL630.cbl
  7510 3000-DELETE-ENTERED-BATCH.
  7511     MOVE SPACE          TO PI-NB-MONTH-END-DT
  7512                            PI-SAV-REFERENCE.
  7513
  7514     IF NOT PI-DELETE-IS-OK
  7515         MOVE 'Y'                TO PI-VERIFY-DELETE-SW
  7516         GO TO 3300-FIRST-PF2.
  7517
  7518     MOVE SPACE                  TO PI-ACCT-AGENT-PROCESSED-SW
  7519                                    PI-VERIFY-DELETE-SW.
  7520     MOVE PI-COMPANY-CD          TO PNDB-COMP-CD.
  7521     MOVE PI-SAV-ENTRY-BATCH     TO PNDB-ENTRY-BATCH.
  7522     MOVE 1                      TO PNDB-BATCH-SEQ.
  7523
  7524
  7525* EXEC CICS SYNCPOINT
  7526*    END-EXEC.
  7527*    MOVE '6"                    !   #00006993' TO DFHEIV0
  7528     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7530     MOVE X'2020233030303036393933' TO DFHEIV0(25:11)
  7531     CALL 'kxdfhei1' USING DFHEIV0
  7532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7533
  7534
  7535
  7536* EXEC CICS HANDLE CONDITION
  7537*        NOTFND(3200-NO-RECORDS)
  7538*    END-EXEC.
  7539*    MOVE '"$I                   ! . #00006996' TO DFHEIV0
  7540     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7542     MOVE X'2E20233030303036393936' TO DFHEIV0(25:11)
  7543     CALL 'kxdfhei1' USING DFHEIV0
  7544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7545
  7546
  7547
  7548* EXEC CICS STARTBR
  7549*        DATASET(ERPNDB-FILE-ID)
  7550*        RIDFLD(ERPNDB-KEY)
  7551*    END-EXEC.
  7552     MOVE 0
  7553       TO DFHEIV11
  7554*    MOVE '&,         G          &   #00007000' TO DFHEIV0
  7555     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7556     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7557     MOVE X'2020233030303037303030' TO DFHEIV0(25:11)
  7558     CALL 'kxdfhei1' USING DFHEIV0,
  7559           ERPNDB-FILE-ID,
  7560           ERPNDB-KEY,
  7561           DFHEIV99,
  7562           DFHEIV11,
  7563           DFHEIV99
  7564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7565
  7566
  7567 3000-GET-NEXT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL630.cbl
  7568
  7569* EXEC CICS HANDLE CONDITION
  7570*        NOTFND(3120-END-ROUTINE)
  7571*    END-EXEC.
  7572*    MOVE '"$I                   ! / #00007006' TO DFHEIV0
  7573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7575     MOVE X'2F20233030303037303036' TO DFHEIV0(25:11)
  7576     CALL 'kxdfhei1' USING DFHEIV0
  7577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7578
  7579
  7580     ADD +1                      TO  WS-SYNC-CNTR.
  7581
  7582     IF WS-SYNC-CNTR GREATER +100
  7583         MOVE +0                 TO  WS-SYNC-CNTR
  7584
  7585* EXEC  CICS SYNCPOINT
  7586*        END-EXEC.
  7587*    MOVE '6"                    !   #00007014' TO DFHEIV0
  7588     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7589     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7590     MOVE X'2020233030303037303134' TO DFHEIV0(25:11)
  7591     CALL 'kxdfhei1' USING DFHEIV0
  7592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7593
  7594
  7595     IF WS-ON1-SW3 IS EQUAL TO 'Y'
  7596         MOVE 'N'                TO  WS-ON1-SW3
  7597         GO TO 3005-READ-NEXT-RECORD.
  7598
  7599
  7600* EXEC CICS STARTBR
  7601*        DATASET(ERPNDB-FILE-ID)
  7602*        RIDFLD (ERPNDB-KEY)
  7603*    END-EXEC.
  7604     MOVE 0
  7605       TO DFHEIV11
  7606*    MOVE '&,         G          &   #00007021' TO DFHEIV0
  7607     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7608     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7609     MOVE X'2020233030303037303231' TO DFHEIV0(25:11)
  7610     CALL 'kxdfhei1' USING DFHEIV0,
  7611           ERPNDB-FILE-ID,
  7612           ERPNDB-KEY,
  7613           DFHEIV99,
  7614           DFHEIV11,
  7615           DFHEIV99
  7616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7617
  7618
  7619
  7620* EXEC CICS HANDLE CONDITION
  7621*        NOTFND (3100-STOP-BROWSE)
  7622*        ENDFILE(3100-STOP-BROWSE)
  7623*    END-EXEC.
  7624*    MOVE '"$I''                  ! 0 #00007026' TO DFHEIV0
  7625     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL630.cbl
  7626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7627     MOVE X'3020233030303037303236' TO DFHEIV0(25:11)
  7628     CALL 'kxdfhei1' USING DFHEIV0
  7629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7630
  7631
  7632 3005-READ-NEXT-RECORD.
  7633
  7634* EXEC CICS READNEXT
  7635*        SET    (ADDRESS OF PENDING-BUSINESS)
  7636*        DATASET(ERPNDB-FILE-ID)
  7637*        RIDFLD (ERPNDB-KEY)
  7638*    END-EXEC.
  7639     MOVE 0
  7640       TO DFHEIV11
  7641*    MOVE '&.S                   )   #00007032' TO DFHEIV0
  7642     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7643     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7644     MOVE X'2020233030303037303332' TO DFHEIV0(25:11)
  7645     CALL 'kxdfhei1' USING DFHEIV0,
  7646           ERPNDB-FILE-ID,
  7647           DFHEIV20,
  7648           DFHEIV99,
  7649           ERPNDB-KEY,
  7650           DFHEIV99,
  7651           DFHEIV11,
  7652           DFHEIV99,
  7653           DFHEIV99
  7654     SET ADDRESS OF PENDING-BUSINESS TO
  7655         DFHEIV20
  7656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7657
  7658
  7659     IF PB-COMPANY-CD  = PI-SAV-COMP-CD AND
  7660        PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  7661         NEXT SENTENCE
  7662     ELSE
  7663         GO TO 3100-STOP-BROWSE.
  7664
  7665     IF PB-BILLED-DT NOT = LOW-VALUES
  7666
  7667* EXEC CICS SYNCPOINT ROLLBACK
  7668*        END-EXEC
  7669*    MOVE '6"R                   !   #00007045' TO DFHEIV0
  7670     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  7671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7672     MOVE X'2020233030303037303435' TO DFHEIV0(25:11)
  7673     CALL 'kxdfhei1' USING DFHEIV0
  7674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7675         MOVE ER-2402            TO EMI-ERROR
  7676         MOVE -1                 TO BATCHL
  7677         MOVE AL-UABON           TO BATCHA
  7678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7679         GO TO 8200-SEND-DATAONLY.
  7680
  7681******************************************************************
  7682*                DELETE PENDING ADDRESS RECORD                   *
  7683******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL630.cbl
  7684
  7685     IF PB-I-MAIL-ADDRS-PRESENT
  7686        NEXT SENTENCE
  7687       ELSE
  7688        GO TO 3006-DELETE-CERTIFICATE.
  7689
  7690
  7691* EXEC CICS HANDLE CONDITION
  7692*         NOTOPEN  (3006-DELETE-CERTIFICATE)
  7693*         NOTFND   (3006-DELETE-CERTIFICATE)
  7694*    END-EXEC.
  7695*    MOVE '"$JI                  ! 1 #00007062' TO DFHEIV0
  7696     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7698     MOVE X'3120233030303037303632' TO DFHEIV0(25:11)
  7699     CALL 'kxdfhei1' USING DFHEIV0
  7700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7701
  7702
  7703
  7704* EXEC CICS READ
  7705*        EQUAL
  7706*        DATASET   (ERPNDM-FILE-ID)
  7707*        SET       (ADDRESS OF PENDING-MAILING-DATA)
  7708*        RIDFLD    (ERPNDB-KEY)
  7709*        UPDATE
  7710*    END-EXEC.
  7711*    MOVE '&"S        EU         (   #00007067' TO DFHEIV0
  7712     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7713     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7714     MOVE X'2020233030303037303637' TO DFHEIV0(25:11)
  7715     CALL 'kxdfhei1' USING DFHEIV0,
  7716           ERPNDM-FILE-ID,
  7717           DFHEIV20,
  7718           DFHEIV99,
  7719           ERPNDB-KEY,
  7720           DFHEIV99,
  7721           DFHEIV99,
  7722           DFHEIV99
  7723     SET ADDRESS OF PENDING-MAILING-DATA TO
  7724         DFHEIV20
  7725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7726
  7727
  7728
  7729* EXEC CICS DELETE
  7730*        DATASET   (ERPNDM-FILE-ID)
  7731*    END-EXEC.
  7732*    MOVE '&(                    &   #00007075' TO DFHEIV0
  7733     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7734     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7735     MOVE X'2020233030303037303735' TO DFHEIV0(25:11)
  7736     CALL 'kxdfhei1' USING DFHEIV0,
  7737           ERPNDM-FILE-ID,
  7738           DFHEIV99,
  7739           DFHEIV99,
  7740           DFHEIV99,
  7741           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL630.cbl
  7742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7743
  7744
  7745 3006-DELETE-CERTIFICATE.
  7746     IF PB-BATCH-TRAILER
  7747        GO TO 3020-CONTINUE-DELETE.
  7748
  7749
  7750* EXEC CICS HANDLE CONDITION
  7751*         NOTFND  (3020-CONTINUE-DELETE)
  7752*    END-EXEC.
  7753*    MOVE '"$I                   ! 2 #00007083' TO DFHEIV0
  7754     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7756     MOVE X'3220233030303037303833' TO DFHEIV0(25:11)
  7757     CALL 'kxdfhei1' USING DFHEIV0
  7758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7759
  7760
  7761     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  7762     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7763     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7764     MOVE PB-SV-STATE            TO CERT-STATE.
  7765
  7766* EXEC CICS READ
  7767*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  7768*        DATASET (ELCERT-FILE-ID)
  7769*        RIDFLD  (ELCERT-KEY)
  7770*        UPDATE
  7771*    END-EXEC.
  7772*    MOVE '&"S        EU         (   #00007091' TO DFHEIV0
  7773     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7774     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7775     MOVE X'2020233030303037303931' TO DFHEIV0(25:11)
  7776     CALL 'kxdfhei1' USING DFHEIV0,
  7777           ELCERT-FILE-ID,
  7778           DFHEIV20,
  7779           DFHEIV99,
  7780           ELCERT-KEY,
  7781           DFHEIV99,
  7782           DFHEIV99,
  7783           DFHEIV99
  7784     SET ADDRESS OF CERTIFICATE-MASTER TO
  7785         DFHEIV20
  7786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7787
  7788
  7789     IF INSURED-ADDR-PRESENT
  7790        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  7791     ELSE
  7792        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  7793
  7794     IF  CERT-NOTES-ARE-NOT-PRESENT
  7795         MOVE ' '                TO WS-CERT-NOTE-SW
  7796     ELSE
  7797         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  7798
  7799     IF PB-CANCELLATION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL630.cbl
  7800        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  7801           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7802           MOVE ZERO                  TO CM-LF-ITD-CANCEL-AMT
  7803           MOVE LOW-VALUES            TO CM-LF-CANCEL-EXIT-DT
  7804                                         CM-LF-CANCEL-DT
  7805           MOVE SPACE                 TO CM-LF-EXIT-BATCH
  7806        ELSE
  7807           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7808           MOVE PB-CI-LF-CANCEL-AMT   TO CM-LF-ITD-CANCEL-AMT
  7809           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  7810           MOVE PB-CI-LIVES              TO CM-LIVES.
  7811
  7812     IF PB-CANCELLATION
  7813        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  7814           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL SPACE
  7815               MOVE CM-LF-STATUS-AT-CANCEL
  7816                                        TO CM-LF-CURRENT-STATUS
  7817               MOVE SPACE
  7818                                        TO CM-LF-STATUS-AT-CANCEL
  7819            ELSE
  7820               MOVE PB-CI-LF-POLICY-STATUS
  7821                                        TO CM-LF-CURRENT-STATUS
  7822        ELSE
  7823            MOVE PB-CI-LF-POLICY-STATUS TO CM-LF-CURRENT-STATUS.
  7824
  7825     IF PB-CANCELLATION
  7826        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  7827           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7828           MOVE ZERO                  TO CM-AH-ITD-CANCEL-AMT
  7829           MOVE LOW-VALUES            TO CM-AH-CANCEL-EXIT-DT
  7830                                         CM-AH-CANCEL-DT
  7831           MOVE SPACE                 TO CM-AH-EXIT-BATCH
  7832        ELSE
  7833           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  7834           MOVE PB-CI-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT
  7835           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  7836           MOVE PB-CI-LIVES           TO CM-LIVES.
  7837
  7838     IF PB-CANCELLATION
  7839        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  7840           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL SPACE
  7841               MOVE CM-AH-STATUS-AT-CANCEL
  7842                                        TO CM-AH-CURRENT-STATUS
  7843               MOVE SPACE
  7844                                        TO CM-AH-STATUS-AT-CANCEL
  7845               GO TO 3010-REWRITE-CERT
  7846            ELSE
  7847               MOVE PB-CI-AH-POLICY-STATUS
  7848                                        TO CM-AH-CURRENT-STATUS
  7849               GO TO 3010-REWRITE-CERT
  7850        ELSE
  7851            MOVE PB-CI-AH-POLICY-STATUS TO CM-AH-CURRENT-STATUS
  7852            GO TO 3010-REWRITE-CERT.
  7853
  7854******************************************************************
  7855******************************************************************
  7856******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
  7857******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL630.cbl
  7858******************************************************************
  7859******************************************************************
  7860
  7861     IF CERT-ADDED-BATCH AND
  7862        (NOT NO-CLAIM-ATTACHED
  7863         OR
  7864         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
  7865        GO TO 3010-REWRITE-CERT.
  7866
  7867******************************************************************
  7868******************************************************************
  7869
  7870     IF CERT-ADDED-BATCH  AND
  7871        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
  7872        GO TO 3010-REWRITE-CERT.
  7873
  7874     IF NO-CLAIM-ATTACHED
  7875         NEXT SENTENCE
  7876       ELSE
  7877         MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  7878         MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
  7879         GO TO 3010-REWRITE-CERT.
  7880
  7881
  7882* EXEC CICS DELETE
  7883*            DATASET    (ELCERT-FILE-ID)
  7884*       END-EXEC.
  7885*    MOVE '&(                    &   #00007190' TO DFHEIV0
  7886     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7887     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7888     MOVE X'2020233030303037313930' TO DFHEIV0(25:11)
  7889     CALL 'kxdfhei1' USING DFHEIV0,
  7890           ELCERT-FILE-ID,
  7891           DFHEIV99,
  7892           DFHEIV99,
  7893           DFHEIV99,
  7894           DFHEIV99
  7895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7896
  7897
  7898******************************************************************
  7899*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  7900******************************************************************
  7901
  7902     IF CERT-NOTES-ARE-PRESENT
  7903        NEXT SENTENCE
  7904     ELSE
  7905        GO TO 3007-DELETE-MAILING-DATA.
  7906
  7907
  7908* EXEC CICS HANDLE CONDITION
  7909*         NOTFND  (3006-DELETE-ERNOTE)
  7910*    END-EXEC.
  7911*    MOVE '"$I                   ! 3 #00007203' TO DFHEIV0
  7912     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7914     MOVE X'3320233030303037323033' TO DFHEIV0(25:11)
  7915     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL630.cbl
  7916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7917
  7918
  7919     MOVE ELCERT-KEY            TO ERCNOT-KEY.
  7920     MOVE '0'                   TO ERCNOT-REC-TYPE.
  7921     MOVE 0                     TO ERCNOT-SEQUENCE.
  7922
  7923 3006-DELETE-ERCNOT-LOOP.
  7924
  7925
  7926* EXEC CICS READ
  7927*        GTEQ
  7928*        DATASET   (ERCNOT-FILE-ID)
  7929*        SET       (ADDRESS OF CERT-NOTE-FILE)
  7930*        RIDFLD    (ERCNOT-KEY)
  7931*    END-EXEC.
  7932*    MOVE '&"S        G          (   #00007213' TO DFHEIV0
  7933     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7934     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7935     MOVE X'2020233030303037323133' TO DFHEIV0(25:11)
  7936     CALL 'kxdfhei1' USING DFHEIV0,
  7937           ERCNOT-FILE-ID,
  7938           DFHEIV20,
  7939           DFHEIV99,
  7940           ERCNOT-KEY,
  7941           DFHEIV99,
  7942           DFHEIV99,
  7943           DFHEIV99
  7944     SET ADDRESS OF CERT-NOTE-FILE TO
  7945         DFHEIV20
  7946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7947
  7948
  7949     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
  7950     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
  7951         GO TO 3006-DELETE-ERNOTE
  7952     END-IF.
  7953
  7954
  7955* EXEC CICS DELETE
  7956*        DATASET   (ERCNOT-FILE-ID)
  7957*        RIDFLD    (ERCNOT-KEY)
  7958*        END-EXEC.
  7959*    MOVE '&(  R                 &   #00007225' TO DFHEIV0
  7960     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7961     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7962     MOVE X'2020233030303037323235' TO DFHEIV0(25:11)
  7963     CALL 'kxdfhei1' USING DFHEIV0,
  7964           ERCNOT-FILE-ID,
  7965           ERCNOT-KEY,
  7966           DFHEIV99,
  7967           DFHEIV99,
  7968           DFHEIV99
  7969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7970
  7971
  7972     GO TO 3006-DELETE-ERCNOT-LOOP.
  7973
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL630.cbl
  7974 3006-DELETE-ERNOTE.
  7975
  7976
  7977* EXEC CICS HANDLE CONDITION
  7978*         NOTFND   (3007-DELETE-MAILING-DATA)
  7979*    END-EXEC.
  7980*    MOVE '"$I                   ! 4 #00007234' TO DFHEIV0
  7981     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7983     MOVE X'3420233030303037323334' TO DFHEIV0(25:11)
  7984     CALL 'kxdfhei1' USING DFHEIV0
  7985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7986
  7987
  7988
  7989* EXEC CICS READ
  7990*        EQUAL
  7991*        DATASET   (ERNOTE-FILE-ID)
  7992*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  7993*        RIDFLD    (ELCERT-KEY)
  7994*        UPDATE
  7995*    END-EXEC.
  7996*    MOVE '&"S        EU         (   #00007238' TO DFHEIV0
  7997     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7998     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7999     MOVE X'2020233030303037323338' TO DFHEIV0(25:11)
  8000     CALL 'kxdfhei1' USING DFHEIV0,
  8001           ERNOTE-FILE-ID,
  8002           DFHEIV20,
  8003           DFHEIV99,
  8004           ELCERT-KEY,
  8005           DFHEIV99,
  8006           DFHEIV99,
  8007           DFHEIV99
  8008     SET ADDRESS OF CERTIFICATE-NOTE TO
  8009         DFHEIV20
  8010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8011
  8012
  8013
  8014* EXEC CICS DELETE
  8015*        DATASET   (ERNOTE-FILE-ID)
  8016*    END-EXEC.
  8017*    MOVE '&(                    &   #00007246' TO DFHEIV0
  8018     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8019     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8020     MOVE X'2020233030303037323436' TO DFHEIV0(25:11)
  8021     CALL 'kxdfhei1' USING DFHEIV0,
  8022           ERNOTE-FILE-ID,
  8023           DFHEIV99,
  8024           DFHEIV99,
  8025           DFHEIV99,
  8026           DFHEIV99
  8027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8028
  8029
  8030******************************************************************
  8031*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL630.cbl
  8032******************************************************************
  8033
  8034 3007-DELETE-MAILING-DATA.
  8035     IF CERT-ADDRESS-PRESENT
  8036        NEXT SENTENCE
  8037     ELSE
  8038        GO TO 3020-CONTINUE-DELETE.
  8039
  8040
  8041* EXEC CICS HANDLE CONDITION
  8042*         NOTOPEN  (3020-CONTINUE-DELETE)
  8043*         NOTFND   (3020-CONTINUE-DELETE)
  8044*    END-EXEC.
  8045*    MOVE '"$JI                  ! 5 #00007260' TO DFHEIV0
  8046     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8048     MOVE X'3520233030303037323630' TO DFHEIV0(25:11)
  8049     CALL 'kxdfhei1' USING DFHEIV0
  8050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8051
  8052
  8053
  8054* EXEC CICS READ
  8055*        EQUAL
  8056*        DATASET   (ERMAIL-FILE-ID)
  8057*        SET       (ADDRESS OF MAILING-DATA)
  8058*        RIDFLD    (ELCERT-KEY)
  8059*        UPDATE
  8060*    END-EXEC.
  8061*    MOVE '&"S        EU         (   #00007265' TO DFHEIV0
  8062     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8063     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8064     MOVE X'2020233030303037323635' TO DFHEIV0(25:11)
  8065     CALL 'kxdfhei1' USING DFHEIV0,
  8066           ERMAIL-FILE-ID,
  8067           DFHEIV20,
  8068           DFHEIV99,
  8069           ELCERT-KEY,
  8070           DFHEIV99,
  8071           DFHEIV99,
  8072           DFHEIV99
  8073     SET ADDRESS OF MAILING-DATA TO
  8074         DFHEIV20
  8075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8076
  8077
  8078
  8079* EXEC CICS DELETE
  8080*        DATASET   (ERMAIL-FILE-ID)
  8081*    END-EXEC.
  8082*    MOVE '&(                    &   #00007273' TO DFHEIV0
  8083     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8084     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8085     MOVE X'2020233030303037323733' TO DFHEIV0(25:11)
  8086     CALL 'kxdfhei1' USING DFHEIV0,
  8087           ERMAIL-FILE-ID,
  8088           DFHEIV99,
  8089           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL630.cbl
  8090           DFHEIV99,
  8091           DFHEIV99
  8092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8093
  8094
  8095     GO TO 3020-CONTINUE-DELETE.
  8096
  8097 3010-REWRITE-CERT.
  8098
  8099
  8100* EXEC CICS REWRITE
  8101*        DATASET    (ELCERT-FILE-ID)
  8102*        FROM       (CERTIFICATE-MASTER)
  8103*    END-EXEC.
  8104     MOVE LENGTH OF
  8105      CERTIFICATE-MASTER
  8106       TO DFHEIV11
  8107*    MOVE '&& L                  %   #00007281' TO DFHEIV0
  8108     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8109     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8110     MOVE X'2020233030303037323831' TO DFHEIV0(25:11)
  8111     CALL 'kxdfhei1' USING DFHEIV0,
  8112           ELCERT-FILE-ID,
  8113           CERTIFICATE-MASTER,
  8114           DFHEIV11,
  8115           DFHEIV99
  8116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8117
  8118
  8119 3020-CONTINUE-DELETE.
  8120
  8121
  8122* EXEC CICS ENDBR
  8123*        DATASET(ERPNDB-FILE-ID)
  8124*    END-EXEC.
  8125     MOVE 0
  8126       TO DFHEIV11
  8127*    MOVE '&2                    $   #00007288' TO DFHEIV0
  8128     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8129     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8130     MOVE X'2020233030303037323838' TO DFHEIV0(25:11)
  8131     CALL 'kxdfhei1' USING DFHEIV0,
  8132           ERPNDB-FILE-ID,
  8133           DFHEIV11,
  8134           DFHEIV99
  8135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8136
  8137
  8138
  8139* EXEC CICS DELETE
  8140*        DATASET(ERPNDB-FILE-ID)
  8141*        RIDFLD (ERPNDB-KEY)
  8142*    END-EXEC.
  8143*    MOVE '&(  R                 &   #00007292' TO DFHEIV0
  8144     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8145     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8146     MOVE X'2020233030303037323932' TO DFHEIV0(25:11)
  8147     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL630.cbl
  8148           ERPNDB-FILE-ID,
  8149           ERPNDB-KEY,
  8150           DFHEIV99,
  8151           DFHEIV99,
  8152           DFHEIV99
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8154
  8155
  8156     ADD 1   TO WS-DELETE-CNT.
  8157     GO TO 3000-GET-NEXT-RECORD.
  8158
  8159 3100-STOP-BROWSE.
  8160
  8161* EXEC CICS ENDBR
  8162*        DATASET(ERPNDB-FILE-ID)
  8163*    END-EXEC.
  8164     MOVE 0
  8165       TO DFHEIV11
  8166*    MOVE '&2                    $   #00007301' TO DFHEIV0
  8167     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8168     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8169     MOVE X'2020233030303037333031' TO DFHEIV0(25:11)
  8170     CALL 'kxdfhei1' USING DFHEIV0,
  8171           ERPNDB-FILE-ID,
  8172           DFHEIV11,
  8173           DFHEIV99
  8174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8175
  8176
  8177 3120-END-ROUTINE.
  8178     MOVE SPACE                  TO PI-UPDATE-SW.
  8179
  8180     IF WS-DELETE-CNT NOT GREATER ZERO
  8181         GO TO 3200-NO-RECORDS.
  8182
  8183     IF PI-AR-PROCESSING
  8184        MOVE 'Y'                 TO WS-RECORD-FOUND-SW
  8185        PERFORM 7000-VERIFY-REQUEST-REC THRU 7090-EXIT
  8186        IF RECORD-NOT-FOUND
  8187           GO TO 8200-SEND-DATAONLY.
  8188
  8189     IF PI-SAVE-CALLING-PGM NOT = XCTL-6301
  8190         MOVE ZEROS              TO EMI-ERROR
  8191         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8192
  8193     MOVE SPACE                  TO PI-BROWSE-SW.
  8194     MOVE LOW-VALUES             TO EL630AO.
  8195     MOVE QUESTION-MARKS         TO BATCHI.
  8196     MOVE AL-UANON               TO BATCHA.
  8197     MOVE -1                     TO MAINTL.
  8198     GO TO 8100-SEND-INITIAL-MAP.
  8199
  8200 3200-NO-RECORDS.
  8201     MOVE ER-2242                TO EMI-ERROR.
  8202     MOVE -1 TO BATCHL
  8203     MOVE AL-UABON               TO BATCHA.
  8204     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8205     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL630.cbl
  8206
  8207 3300-FIRST-PF2.
  8208     MOVE SPACE                  TO PI-CLEAR-ERROR-SW.
  8209     MOVE ER-2422                TO EMI-ERROR.
  8210     MOVE -1                     TO PFENTERL.
  8211     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8212     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL630.cbl
  8214
  8215 4000-SHOW-TOTALS.
  8216
  8217     MOVE LOW-VALUES             TO EL630AI.
  8218     MOVE PI-SAV-ENTRY-BATCH     TO BATCHO.
  8219     MOVE PI-SAV-REFERENCE       TO REFO.
  8220
  8221     IF PI-DATA-UPDATED
  8222        MOVE 'C'                TO PI-MAINT-FUNC.
  8223
  8224     MOVE PI-MAINT-FUNC          TO MAINTO.
  8225
  8226     IF PI-SAV-CARRIER NOT = SPACES
  8227         MOVE PI-SAV-CARRIER     TO CARRIERO.
  8228
  8229     IF PI-SAV-GROUPING NOT = SPACES
  8230         MOVE PI-SAV-GROUPING    TO GROUPO.
  8231
  8232     IF PI-SAV-STATE NOT = SPACES
  8233         MOVE PI-SAV-STATE       TO STATEO.
  8234
  8235     MOVE PI-SAV-ACCOUNT         TO ACCOUNTO.
  8236
  8237     IF PI-DATA-UPDATED
  8238         MOVE AL-SANON           TO BATCHA
  8239                                    MAINTA
  8240                                    CARRIERA
  8241                                    GROUPA
  8242                                    STATEA
  8243                                    ACCOUNTA
  8244     ELSE
  8245         MOVE AL-UANON           TO BATCHA
  8246                                    MAINTA
  8247                                    CARRIERA
  8248                                    GROUPA
  8249                                    STATEA
  8250                                    ACCOUNTA.
  8251
  8252     MOVE PI-LF-ISS-ENTERED      TO ALFISSO.
  8253     IF PI-LF-ISS-REMITTED NOT = ZEROS
  8254         MOVE PI-LF-ISS-REMITTED TO ELFISSO
  8255         MOVE AL-UNNON           TO ELFISSA
  8256         COMPUTE WS-OBAL = PI-LF-ISS-REMITTED - PI-LF-ISS-ENTERED
  8257         IF WS-OBAL NOT = ZEROS
  8258             MOVE WS-OBAL        TO OLFISSO.
  8259
  8260     MOVE PI-LF-CAN-ENTERED      TO ALFCANO.
  8261     IF PI-LF-CAN-REMITTED NOT = ZEROS
  8262         MOVE PI-LF-CAN-REMITTED TO ELFCANO
  8263         MOVE AL-UNNON           TO ELFCANA
  8264         COMPUTE WS-OBAL = PI-LF-CAN-REMITTED - PI-LF-CAN-ENTERED
  8265         IF WS-OBAL NOT = ZEROS
  8266             MOVE WS-OBAL        TO OLFCANO.
  8267
  8268     MOVE PI-AH-ISS-ENTERED      TO AAHISSO.
  8269     IF PI-AH-ISS-REMITTED NOT = ZEROS
  8270         MOVE PI-AH-ISS-REMITTED TO EAHISSO
  8271         MOVE AL-UNNON           TO EAHISSA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL630.cbl
  8272         COMPUTE WS-OBAL = PI-AH-ISS-REMITTED - PI-AH-ISS-ENTERED
  8273         IF WS-OBAL NOT = ZEROS
  8274             MOVE WS-OBAL        TO OAHISSO.
  8275
  8276     MOVE PI-AH-CAN-ENTERED      TO AAHCANO.
  8277     IF PI-AH-CAN-REMITTED NOT = ZEROS
  8278         MOVE PI-AH-CAN-REMITTED TO EAHCANO
  8279         MOVE AL-UNNON           TO EAHCANA
  8280         COMPUTE WS-OBAL = PI-AH-CAN-REMITTED - PI-AH-CAN-ENTERED
  8281         IF WS-OBAL NOT = ZEROS
  8282             MOVE WS-OBAL        TO OAHCANO.
  8283
  8284     MOVE PI-ISS-CNT-ENTERED     TO AISSCNTO.
  8285     IF PI-ISS-CNT-REMITTED NOT = ZEROS
  8286         MOVE PI-ISS-CNT-REMITTED TO EISSCNTO
  8287         MOVE AL-UNNON            TO EISSCNTA
  8288         COMPUTE WS-OCNT = PI-ISS-CNT-REMITTED -
  8289                                PI-ISS-CNT-ENTERED
  8290         IF WS-OCNT NOT = ZEROS
  8291             MOVE WS-OCNT        TO OISSCNTO.
  8292
  8293     MOVE PI-CAN-CNT-ENTERED     TO ACANCNTO.
  8294     IF PI-CAN-CNT-REMITTED NOT = ZEROS
  8295         MOVE PI-CAN-CNT-REMITTED TO ECANCNTO
  8296         MOVE AL-UNNON            TO ECANCNTA
  8297         COMPUTE WS-OCNT = PI-CAN-CNT-REMITTED -
  8298                                PI-CAN-CNT-ENTERED
  8299         IF WS-OCNT NOT = ZEROS
  8300             MOVE WS-OCNT        TO OCANCNTO.
  8301
  8302     IF  PI-NB-MONTH-END-DT GREATER SPACES
  8303         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  8304       ELSE
  8305         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  8306
  8307     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8308     PERFORM  9700-DATE-LINK.
  8309
  8310     IF  DATE-CONVERSION-ERROR
  8311         MOVE LOW-VALUES TO MNTHNDTO
  8312         GO TO 0490-EXIT.
  8313
  8314     MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO.
  8315     MOVE AL-UANON               TO  MNTHNDTA.
  8316
  8317     IF  PI-NB-MONTH-END-DT GREATER SPACES
  8318         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  8319       ELSE
  8320         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  8321
  8322     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8323     PERFORM  9700-DATE-LINK.
  8324
  8325     IF  DATE-CONVERSION-ERROR
  8326         MOVE LOW-VALUES TO MNTHNDTO
  8327     ELSE
  8328         MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO
  8329         MOVE AL-UANON               TO  MNTHNDTA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL630.cbl
  8330
  8331     MOVE PI-RECEIVED-DT         TO DC-BIN-DATE-1.
  8332
  8333     MOVE  SPACE                 TO  DC-OPTION-CODE.
  8334     PERFORM  9700-DATE-LINK.
  8335
  8336     IF  DATE-CONVERSION-ERROR
  8337         MOVE LOW-VALUES TO RECEVDTO
  8338     ELSE
  8339         MOVE DC-GREG-DATE-1-EDIT    TO  RECEVDTO
  8340         MOVE AL-UANON               TO  RECEVDTA.
  8341
  8342     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL630.cbl
  8344
  8345*****************************************************************
  8346*            U P D A T E   E N T I R E   B A T C H              *
  8347*  THIS SECTION UPDATES AN ENTIRE BATCH WITH A NEW MONTH END    *
  8348*  DATE.                                                        *
  8349*****************************************************************
  8350
  8351 5000-UPDATE-ENTIRE-BATCH.
  8352
  8353     MOVE ZEROS                  TO  PNDB-BATCH-SEQ
  8354                                     PNDB-BATCH-CHG-SEQ.
  8355
  8356
  8357* EXEC CICS HANDLE CONDITION
  8358*        NOTFND(5900-EXIT)
  8359*    END-EXEC.
  8360*    MOVE '"$I                   ! 6 #00007484' TO DFHEIV0
  8361     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8363     MOVE X'3620233030303037343834' TO DFHEIV0(25:11)
  8364     CALL 'kxdfhei1' USING DFHEIV0
  8365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8366
  8367
  8368
  8369* EXEC CICS STARTBR
  8370*        DATASET(ERPNDB-FILE-ID)
  8371*        RIDFLD (ERPNDB-KEY)
  8372*    END-EXEC.
  8373     MOVE 0
  8374       TO DFHEIV11
  8375*    MOVE '&,         G          &   #00007488' TO DFHEIV0
  8376     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8377     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8378     MOVE X'2020233030303037343838' TO DFHEIV0(25:11)
  8379     CALL 'kxdfhei1' USING DFHEIV0,
  8380           ERPNDB-FILE-ID,
  8381           ERPNDB-KEY,
  8382           DFHEIV99,
  8383           DFHEIV11,
  8384           DFHEIV99
  8385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8386
  8387
  8388 5010-GET-NEXT-RECORD.
  8389
  8390* EXEC CICS HANDLE CONDITION
  8391*        NOTFND (5100-STOP-BROWSE)
  8392*        ENDFILE(5100-STOP-BROWSE)
  8393*    END-EXEC.
  8394*    MOVE '"$I''                  ! 7 #00007494' TO DFHEIV0
  8395     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8397     MOVE X'3720233030303037343934' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0
  8399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8400
  8401
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL630.cbl
  8402 5020-READ-NEXT-RECORD.
  8403
  8404* EXEC CICS READNEXT
  8405*        SET    (ADDRESS OF PENDING-BUSINESS)
  8406*        DATASET(ERPNDB-FILE-ID)
  8407*        RIDFLD (ERPNDB-KEY)
  8408*    END-EXEC.
  8409     MOVE 0
  8410       TO DFHEIV11
  8411*    MOVE '&.S                   )   #00007500' TO DFHEIV0
  8412     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8413     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8414     MOVE X'2020233030303037353030' TO DFHEIV0(25:11)
  8415     CALL 'kxdfhei1' USING DFHEIV0,
  8416           ERPNDB-FILE-ID,
  8417           DFHEIV20,
  8418           DFHEIV99,
  8419           ERPNDB-KEY,
  8420           DFHEIV99,
  8421           DFHEIV11,
  8422           DFHEIV99,
  8423           DFHEIV99
  8424     SET ADDRESS OF PENDING-BUSINESS TO
  8425         DFHEIV20
  8426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8427
  8428
  8429     IF WS-ON1-SW4 IS EQUAL TO 'Y'
  8430         MOVE 'N'                    TO  WS-ON1-SW4
  8431         MOVE PB-CONTROL-PRIMARY     TO  WS-SAV-PNDB-KEY
  8432         GO TO 5030-READ-FOR-UPDATE.
  8433
  8434     IF ERPNDB-KEY = WS-SAV-PNDB-KEY
  8435        GO TO 5020-READ-NEXT-RECORD.
  8436
  8437     IF PB-COMPANY-CD  = WS-SAV-COMP-CD  AND
  8438        PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  8439         NEXT SENTENCE
  8440     ELSE
  8441         GO TO 5100-STOP-BROWSE.
  8442
  8443     IF PB-ISSUE
  8444        IF PB-I-REFERENCE NOT = PI-SAV-REFERENCE
  8445           GO TO 5030-READ-FOR-UPDATE.
  8446
  8447     IF PB-CANCELLATION
  8448        IF PB-C-REFERENCE NOT = PI-SAV-REFERENCE
  8449           GO TO 5030-READ-FOR-UPDATE.
  8450
  8451     IF PB-CREDIT-SELECT-DT = PI-NB-MONTH-END-DT
  8452         GO TO 5010-GET-NEXT-RECORD.
  8453
  8454 5030-READ-FOR-UPDATE.
  8455
  8456* EXEC CICS ENDBR
  8457*        DATASET(ERPNDB-FILE-ID)
  8458*    END-EXEC.
  8459     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL630.cbl
  8460       TO DFHEIV11
  8461*    MOVE '&2                    $   #00007532' TO DFHEIV0
  8462     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8463     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8464     MOVE X'2020233030303037353332' TO DFHEIV0(25:11)
  8465     CALL 'kxdfhei1' USING DFHEIV0,
  8466           ERPNDB-FILE-ID,
  8467           DFHEIV11,
  8468           DFHEIV99
  8469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8470
  8471
  8472
  8473* EXEC CICS READ
  8474*        SET     (ADDRESS OF PENDING-BUSINESS)
  8475*        DATASET (ERPNDB-FILE-ID)
  8476*        RIDFLD  (ERPNDB-KEY)
  8477*        UPDATE
  8478*    END-EXEC.
  8479*    MOVE '&"S        EU         (   #00007536' TO DFHEIV0
  8480     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8481     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8482     MOVE X'2020233030303037353336' TO DFHEIV0(25:11)
  8483     CALL 'kxdfhei1' USING DFHEIV0,
  8484           ERPNDB-FILE-ID,
  8485           DFHEIV20,
  8486           DFHEIV99,
  8487           ERPNDB-KEY,
  8488           DFHEIV99,
  8489           DFHEIV99,
  8490           DFHEIV99
  8491     SET ADDRESS OF PENDING-BUSINESS TO
  8492         DFHEIV20
  8493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8494
  8495
  8496     MOVE ERPNDB-KEY                  TO WS-SAV-PNDB-KEY.
  8497
  8498     IF PI-NB-MONTH-END-DT GREATER THAN SPACES
  8499        MOVE  PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT.
  8500
  8501     IF PB-ISSUE
  8502        IF PB-I-REFERENCE NOT = PI-SAV-REFERENCE
  8503           MOVE PI-SAV-REFERENCE TO PB-I-REFERENCE.
  8504
  8505     IF PB-CANCELLATION
  8506        IF PB-C-REFERENCE NOT = PI-SAV-REFERENCE
  8507           MOVE PI-SAV-REFERENCE TO PB-C-REFERENCE.
  8508
  8509 5050-REWRITE-PENDING-BUS.
  8510
  8511* EXEC CICS REWRITE
  8512*         DATASET    (ERPNDB-FILE-ID)
  8513*         FROM       (PENDING-BUSINESS)
  8514*     END-EXEC.
  8515     MOVE LENGTH OF
  8516      PENDING-BUSINESS
  8517       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL630.cbl
  8518*    MOVE '&& L                  %   #00007557' TO DFHEIV0
  8519     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8520     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8521     MOVE X'2020233030303037353537' TO DFHEIV0(25:11)
  8522     CALL 'kxdfhei1' USING DFHEIV0,
  8523           ERPNDB-FILE-ID,
  8524           PENDING-BUSINESS,
  8525           DFHEIV11,
  8526           DFHEIV99
  8527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8528
  8529
  8530
  8531* EXEC CICS STARTBR
  8532*        DATASET(ERPNDB-FILE-ID)
  8533*        RIDFLD (ERPNDB-KEY)
  8534*    END-EXEC.
  8535     MOVE 0
  8536       TO DFHEIV11
  8537*    MOVE '&,         G          &   #00007562' TO DFHEIV0
  8538     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8540     MOVE X'2020233030303037353632' TO DFHEIV0(25:11)
  8541     CALL 'kxdfhei1' USING DFHEIV0,
  8542           ERPNDB-FILE-ID,
  8543           ERPNDB-KEY,
  8544           DFHEIV99,
  8545           DFHEIV11,
  8546           DFHEIV99
  8547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8548
  8549
  8550     GO TO 5010-GET-NEXT-RECORD.
  8551
  8552 5100-STOP-BROWSE.
  8553
  8554* EXEC CICS ENDBR
  8555*        DATASET(ERPNDB-FILE-ID)
  8556*    END-EXEC.
  8557     MOVE 0
  8558       TO DFHEIV11
  8559*    MOVE '&2                    $   #00007570' TO DFHEIV0
  8560     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8561     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8562     MOVE X'2020233030303037353730' TO DFHEIV0(25:11)
  8563     CALL 'kxdfhei1' USING DFHEIV0,
  8564           ERPNDB-FILE-ID,
  8565           DFHEIV11,
  8566           DFHEIV99
  8567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8568
  8569
  8570 5900-EXIT.
  8571      EXIT.
  8572
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL630.cbl
  8574
  8575******************************************************************
  8576*          R E W R I T E   E N T I R E   B A T C H              *
  8577*  THIS SECTION REWRITES AN ENTIRE BATCH WITH NEW ACCOUNT INFO. *
  8578*  1.  DELETE THE PENDING BUSINESS RECORD                       *
  8579*  2.  IF THE PENDING RECORD IS AN ISSUE, AND THE CERTIFICATE   *
  8580*      HAS NOT BEEN ADDED TO BATCH OR A CLAIM IS NOT ATTACHED,  *
  8581*      DELETE THE CERTIFICATE,CERTIFICATE NOTES, AND MAILING    *
  8582*      RECORDS                                                  *
  8583*  3.  IF THE PENDING RECORD HAS BEEN ADDED TO BATCH OR A CLAIM *
  8584*      IS ATTACHED MOVE SPACE TO CM-CREDIT-INTERFACE-SW-1 AND   *
  8585*      REWRITE THE CERTIFICATE.                                 *
  8586*  4.  IF THE PENDING RECORD IS CANCELLATION, BACKOUT THE       *
  8587*      CANCELLATION INFORMATION IN THE CERTIFICATE RECORD       *
  8588*      AND REWRITE THE CERTIFICATE.                             *
  8589*  5.  WRITE A NEW PENDING BUSINESS RECORD WITH THE NEW ACCOUNT *
  8590*      INFORMATION.                                             *
  8591*  6.  AFTER EACH DETAIL RECORD IS PROCESSED REWRITE THE BATCH  *
  8592*      RECORD WITH THE NEW ACCOUNT INFORMATION.                 *
  8593*  7.  ONCE THE BATCH IS REWRITTEN FORCE THE OPERATOR TO        *
  8594*      RE-EDITED THE BATCH.                                     *
  8595*  NOTE:  THE PENDING BUSINESS RECORDS ARE DELETED AND ADDED    *
  8596*         TO RESET THE ALTERNATE INDEX.                         *
  8597******************************************************************
  8598 6000-REWRITE-ENTIRE-BATCH.
  8599     IF  NOT EMI-NO-ERRORS
  8600         GO TO 8200-SEND-DATAONLY.
  8601
  8602     PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT.
  8603
  8604     IF  EMI-ERROR = ZEROS
  8605         MOVE 'N'                TO  PI-EL630-FIRST-TIME-SW
  8606       ELSE
  8607         GO TO 8200-SEND-DATAONLY.
  8608
  8609     MOVE PI-SAV-COMP-CD         TO  PNDB-COMP-CD.
  8610     MOVE PI-SAV-ENTRY-BATCH     TO  PNDB-ENTRY-BATCH.
  8611
  8612     MOVE ZEROS                  TO  PNDB-BATCH-SEQ
  8613                                     PNDB-BATCH-CHG-SEQ.
  8614
  8615
  8616* EXEC CICS GETMAIN
  8617*        SET    (ADDRESS OF PENDING-BUSINESS)
  8618*        LENGTH (585)
  8619*        INITIMG(GETMAIN-SPACE)
  8620*    END-EXEC.
  8621     MOVE 585
  8622       TO DFHEIV11
  8623*    MOVE ',"IL                  $   #00007619' TO DFHEIV0
  8624     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8625     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8626     MOVE X'2020233030303037363139' TO DFHEIV0(25:11)
  8627     CALL 'kxdfhei1' USING DFHEIV0,
  8628           DFHEIV20,
  8629           DFHEIV11,
  8630           GETMAIN-SPACE
  8631     SET ADDRESS OF PENDING-BUSINESS TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL630.cbl
  8632         DFHEIV20
  8633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8634
  8635
  8636
  8637* EXEC CICS HANDLE CONDITION
  8638*        NOTFND(6500-NO-RECORDS)
  8639*    END-EXEC.
  8640*    MOVE '"$I                   ! 8 #00007625' TO DFHEIV0
  8641     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8643     MOVE X'3820233030303037363235' TO DFHEIV0(25:11)
  8644     CALL 'kxdfhei1' USING DFHEIV0
  8645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8646
  8647
  8648 6010-GET-NEXT-RECORD.
  8649     IF WS-ON1-SW5 IS EQUAL TO 'Y'
  8650         MOVE 'N'                TO  WS-ON1-SW5
  8651         GO TO 6015-START-BROWSE.
  8652
  8653
  8654* EXEC CICS HANDLE CONDITION
  8655*        NOTFND (6400-STOP-BROWSE)
  8656*        ENDFILE(6400-STOP-BROWSE)
  8657*    END-EXEC.
  8658*    MOVE '"$I''                  ! 9 #00007634' TO DFHEIV0
  8659     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8661     MOVE X'3920233030303037363334' TO DFHEIV0(25:11)
  8662     CALL 'kxdfhei1' USING DFHEIV0
  8663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8664
  8665
  8666 6015-START-BROWSE.
  8667
  8668* EXEC CICS STARTBR
  8669*        DATASET(ERPNDB-FILE-ID)
  8670*        RIDFLD (ERPNDB-KEY)
  8671*    END-EXEC.
  8672     MOVE 0
  8673       TO DFHEIV11
  8674*    MOVE '&,         G          &   #00007640' TO DFHEIV0
  8675     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8676     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8677     MOVE X'2020233030303037363430' TO DFHEIV0(25:11)
  8678     CALL 'kxdfhei1' USING DFHEIV0,
  8679           ERPNDB-FILE-ID,
  8680           ERPNDB-KEY,
  8681           DFHEIV99,
  8682           DFHEIV11,
  8683           DFHEIV99
  8684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8685
  8686
  8687 6020-READ-NEXT-RECORD.
  8688
  8689* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL630.cbl
  8690*        INTO   (PENDING-BUSINESS)
  8691*        DATASET(ERPNDB-FILE-ID)
  8692*        RIDFLD (ERPNDB-KEY)
  8693*    END-EXEC.
  8694     MOVE LENGTH OF
  8695      PENDING-BUSINESS
  8696       TO DFHEIV12
  8697     MOVE 0
  8698       TO DFHEIV11
  8699*    MOVE '&.IL                  )   #00007646' TO DFHEIV0
  8700     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8701     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8702     MOVE X'2020233030303037363436' TO DFHEIV0(25:11)
  8703     CALL 'kxdfhei1' USING DFHEIV0,
  8704           ERPNDB-FILE-ID,
  8705           PENDING-BUSINESS,
  8706           DFHEIV12,
  8707           ERPNDB-KEY,
  8708           DFHEIV99,
  8709           DFHEIV11,
  8710           DFHEIV99,
  8711           DFHEIV99
  8712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8713
  8714
  8715     IF WS-ON1-SW6 IS EQUAL TO 'Y'
  8716         MOVE 'N'                    TO WS-ON1-SW6
  8717         MOVE PB-CONTROL-PRIMARY     TO WS-SAV-PNDB-KEY
  8718         GO TO 6030-READ-FOR-UPDATE.
  8719
  8720     IF ERPNDB-KEY = WS-SAV-PNDB-KEY
  8721         GO TO 6020-READ-NEXT-RECORD.
  8722
  8723     IF PB-COMPANY-CD  = WS-SAV-COMP-CD  AND
  8724        PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  8725         NEXT SENTENCE
  8726     ELSE
  8727         GO TO 6400-STOP-BROWSE.
  8728
  8729 6030-READ-FOR-UPDATE.
  8730
  8731* EXEC CICS ENDBR
  8732*        DATASET(ERPNDB-FILE-ID)
  8733*    END-EXEC.
  8734     MOVE 0
  8735       TO DFHEIV11
  8736*    MOVE '&2                    $   #00007667' TO DFHEIV0
  8737     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8738     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8739     MOVE X'2020233030303037363637' TO DFHEIV0(25:11)
  8740     CALL 'kxdfhei1' USING DFHEIV0,
  8741           ERPNDB-FILE-ID,
  8742           DFHEIV11,
  8743           DFHEIV99
  8744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8745
  8746
  8747
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL630.cbl
  8748* EXEC CICS READ
  8749*        INTO (PENDING-BUSINESS)
  8750*        DATASET (ERPNDB-FILE-ID)
  8751*        RIDFLD  (ERPNDB-KEY)
  8752*        UPDATE
  8753*    END-EXEC.
  8754     MOVE LENGTH OF
  8755      PENDING-BUSINESS
  8756       TO DFHEIV11
  8757*    MOVE '&"IL       EU         (   #00007671' TO DFHEIV0
  8758     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8759     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8760     MOVE X'2020233030303037363731' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0,
  8762           ERPNDB-FILE-ID,
  8763           PENDING-BUSINESS,
  8764           DFHEIV11,
  8765           ERPNDB-KEY,
  8766           DFHEIV99,
  8767           DFHEIV99,
  8768           DFHEIV99
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8770
  8771
  8772     MOVE ERPNDB-KEY                  TO WS-SAV-PNDB-KEY.
  8773
  8774     MOVE PENDING-BUSINESS       TO WS-ERPNDB-RECORD.
  8775
  8776 6050-DELETE-PENDING-BUS.
  8777
  8778* EXEC CICS DELETE
  8779*        DATASET    (ERPNDB-FILE-ID)
  8780*    END-EXEC.
  8781*    MOVE '&(                    &   #00007683' TO DFHEIV0
  8782     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8783     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8784     MOVE X'2020233030303037363833' TO DFHEIV0(25:11)
  8785     CALL 'kxdfhei1' USING DFHEIV0,
  8786           ERPNDB-FILE-ID,
  8787           DFHEIV99,
  8788           DFHEIV99,
  8789           DFHEIV99,
  8790           DFHEIV99
  8791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8792
  8793
  8794     MOVE WS-ERPNDB-RECORD       TO PENDING-BUSINESS.
  8795
  8796     IF  PB-BATCH-TRAILER
  8797         GO TO 6300-WRITE-PNDB-RECORD.
  8798
  8799     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  8800     IF  PB-SV-CARRIER GREATER SPACES
  8801         MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8802     IF  PB-SV-GROUPING GREATER SPACES
  8803         MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8804     IF  PB-SV-STATE GREATER SPACES
  8805         MOVE PB-SV-STATE            TO CERT-STATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL630.cbl
  8806
  8807     IF PB-ISSUE
  8808         NEXT SENTENCE
  8809       ELSE
  8810         GO TO 6200-PROCESS-CANCELS.
  8811
  8812
  8813* EXEC CICS HANDLE CONDITION
  8814*         NOTFND  (6300-WRITE-PNDB-RECORD)
  8815*    END-EXEC.
  8816*    MOVE '"$I                   ! : #00007705' TO DFHEIV0
  8817     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8819     MOVE X'3A20233030303037373035' TO DFHEIV0(25:11)
  8820     CALL 'kxdfhei1' USING DFHEIV0
  8821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8822
  8823
  8824
  8825* EXEC CICS READ
  8826*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  8827*        DATASET (ELCERT-FILE-ID)
  8828*        RIDFLD  (ELCERT-KEY)
  8829*        UPDATE
  8830*    END-EXEC.
  8831*    MOVE '&"S        EU         (   #00007709' TO DFHEIV0
  8832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8833     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8834     MOVE X'2020233030303037373039' TO DFHEIV0(25:11)
  8835     CALL 'kxdfhei1' USING DFHEIV0,
  8836           ELCERT-FILE-ID,
  8837           DFHEIV20,
  8838           DFHEIV99,
  8839           ELCERT-KEY,
  8840           DFHEIV99,
  8841           DFHEIV99,
  8842           DFHEIV99
  8843     SET ADDRESS OF CERTIFICATE-MASTER TO
  8844         DFHEIV20
  8845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8846
  8847
  8848     IF INSURED-ADDR-PRESENT
  8849        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  8850     ELSE
  8851        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  8852
  8853     IF  CERT-NOTES-ARE-NOT-PRESENT
  8854         MOVE ' '                TO WS-CERT-NOTE-SW
  8855     ELSE
  8856         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  8857
  8858     IF  CERT-ADDED-BATCH
  8859
  8860* EXEC CICS UNLOCK
  8861*             DATASET (ELCERT-FILE-ID)
  8862*        END-EXEC
  8863*    MOVE '&*                    #   #00007727' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL630.cbl
  8864     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8865     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8866     MOVE X'2020233030303037373237' TO DFHEIV0(25:11)
  8867     CALL 'kxdfhei1' USING DFHEIV0,
  8868           ELCERT-FILE-ID,
  8869           DFHEIV99
  8870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8871         GO TO 6300-WRITE-PNDB-RECORD.
  8872
  8873     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
  8874         NEXT SENTENCE
  8875        ELSE
  8876         GO TO 6060-DELETE-CERTIFICATE.
  8877
  8878     MOVE SPACE                 TO  CM-CREDIT-INTERFACE-SW-1.
  8879     MOVE '2'                   TO  CM-CLAIM-INTERFACE-SW.
  8880
  8881
  8882* EXEC CICS REWRITE
  8883*         DATASET    (ELCERT-FILE-ID)
  8884*         FROM       (CERTIFICATE-MASTER)
  8885*    END-EXEC.
  8886     MOVE LENGTH OF
  8887      CERTIFICATE-MASTER
  8888       TO DFHEIV11
  8889*    MOVE '&& L                  %   #00007740' TO DFHEIV0
  8890     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8891     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8892     MOVE X'2020233030303037373430' TO DFHEIV0(25:11)
  8893     CALL 'kxdfhei1' USING DFHEIV0,
  8894           ELCERT-FILE-ID,
  8895           CERTIFICATE-MASTER,
  8896           DFHEIV11,
  8897           DFHEIV99
  8898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8899
  8900
  8901     GO TO 6300-WRITE-PNDB-RECORD.
  8902
  8903 6060-DELETE-CERTIFICATE.
  8904
  8905
  8906* EXEC CICS DELETE
  8907*         DATASET    (ELCERT-FILE-ID)
  8908*    END-EXEC.
  8909*    MOVE '&(                    &   #00007749' TO DFHEIV0
  8910     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8911     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8912     MOVE X'2020233030303037373439' TO DFHEIV0(25:11)
  8913     CALL 'kxdfhei1' USING DFHEIV0,
  8914           ELCERT-FILE-ID,
  8915           DFHEIV99,
  8916           DFHEIV99,
  8917           DFHEIV99,
  8918           DFHEIV99
  8919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8920
  8921
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL630.cbl
  8922******************************************************************
  8923*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  8924******************************************************************
  8925
  8926     IF CERT-NOTES-ARE-PRESENT
  8927        NEXT SENTENCE
  8928     ELSE
  8929        GO TO 6070-DELETE-MAILING.
  8930
  8931
  8932* EXEC CICS HANDLE CONDITION
  8933*         NOTFND  (6070-DELETE-MAILING)
  8934*    END-EXEC.
  8935*    MOVE '"$I                   ! ; #00007762' TO DFHEIV0
  8936     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8938     MOVE X'3B20233030303037373632' TO DFHEIV0(25:11)
  8939     CALL 'kxdfhei1' USING DFHEIV0
  8940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8941
  8942
  8943
  8944* EXEC CICS READ
  8945*        EQUAL
  8946*        DATASET   (ERNOTE-FILE-ID)
  8947*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  8948*        RIDFLD    (ELCERT-KEY)
  8949*        UPDATE
  8950*    END-EXEC.
  8951*    MOVE '&"S        EU         (   #00007766' TO DFHEIV0
  8952     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8953     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8954     MOVE X'2020233030303037373636' TO DFHEIV0(25:11)
  8955     CALL 'kxdfhei1' USING DFHEIV0,
  8956           ERNOTE-FILE-ID,
  8957           DFHEIV20,
  8958           DFHEIV99,
  8959           ELCERT-KEY,
  8960           DFHEIV99,
  8961           DFHEIV99,
  8962           DFHEIV99
  8963     SET ADDRESS OF CERTIFICATE-NOTE TO
  8964         DFHEIV20
  8965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8966
  8967
  8968
  8969* EXEC CICS DELETE
  8970*        DATASET   (ERNOTE-FILE-ID)
  8971*    END-EXEC.
  8972*    MOVE '&(                    &   #00007774' TO DFHEIV0
  8973     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8974     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8975     MOVE X'2020233030303037373734' TO DFHEIV0(25:11)
  8976     CALL 'kxdfhei1' USING DFHEIV0,
  8977           ERNOTE-FILE-ID,
  8978           DFHEIV99,
  8979           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL630.cbl
  8980           DFHEIV99,
  8981           DFHEIV99
  8982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8983
  8984
  8985******************************************************************
  8986*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
  8987******************************************************************
  8988
  8989 6070-DELETE-MAILING.
  8990     IF CERT-ADDRESS-PRESENT
  8991        NEXT SENTENCE
  8992     ELSE
  8993        GO TO 6300-WRITE-PNDB-RECORD.
  8994
  8995
  8996* EXEC CICS HANDLE CONDITION
  8997*         NOTOPEN (6300-WRITE-PNDB-RECORD)
  8998*         NOTFND  (6300-WRITE-PNDB-RECORD)
  8999*    END-EXEC.
  9000*    MOVE '"$JI                  ! < #00007788' TO DFHEIV0
  9001     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9002     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9003     MOVE X'3C20233030303037373838' TO DFHEIV0(25:11)
  9004     CALL 'kxdfhei1' USING DFHEIV0
  9005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9006
  9007
  9008
  9009* EXEC CICS READ
  9010*        EQUAL
  9011*        DATASET   (ERMAIL-FILE-ID)
  9012*        SET       (ADDRESS OF MAILING-DATA)
  9013*        RIDFLD    (ELCERT-KEY)
  9014*        UPDATE
  9015*    END-EXEC.
  9016*    MOVE '&"S        EU         (   #00007793' TO DFHEIV0
  9017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9018     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9019     MOVE X'2020233030303037373933' TO DFHEIV0(25:11)
  9020     CALL 'kxdfhei1' USING DFHEIV0,
  9021           ERMAIL-FILE-ID,
  9022           DFHEIV20,
  9023           DFHEIV99,
  9024           ELCERT-KEY,
  9025           DFHEIV99,
  9026           DFHEIV99,
  9027           DFHEIV99
  9028     SET ADDRESS OF MAILING-DATA TO
  9029         DFHEIV20
  9030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9031
  9032
  9033
  9034* EXEC CICS DELETE
  9035*        DATASET   (ERMAIL-FILE-ID)
  9036*    END-EXEC.
  9037*    MOVE '&(                    &   #00007801' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL630.cbl
  9038     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9039     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9040     MOVE X'2020233030303037383031' TO DFHEIV0(25:11)
  9041     CALL 'kxdfhei1' USING DFHEIV0,
  9042           ERMAIL-FILE-ID,
  9043           DFHEIV99,
  9044           DFHEIV99,
  9045           DFHEIV99,
  9046           DFHEIV99
  9047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9048
  9049
  9050     GO TO 6300-WRITE-PNDB-RECORD.
  9051
  9052 6200-PROCESS-CANCELS.
  9053
  9054* EXEC CICS HANDLE CONDITION
  9055*         NOTFND  (6300-WRITE-PNDB-RECORD)
  9056*    END-EXEC.
  9057*    MOVE '"$I                   ! = #00007808' TO DFHEIV0
  9058     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9060     MOVE X'3D20233030303037383038' TO DFHEIV0(25:11)
  9061     CALL 'kxdfhei1' USING DFHEIV0
  9062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9063
  9064
  9065
  9066* EXEC CICS READ
  9067*        SET     (ADDRESS OF CERTIFICATE-MASTER)
  9068*        DATASET (ELCERT-FILE-ID)
  9069*        RIDFLD  (ELCERT-KEY)
  9070*        UPDATE
  9071*    END-EXEC.
  9072*    MOVE '&"S        EU         (   #00007812' TO DFHEIV0
  9073     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9074     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9075     MOVE X'2020233030303037383132' TO DFHEIV0(25:11)
  9076     CALL 'kxdfhei1' USING DFHEIV0,
  9077           ELCERT-FILE-ID,
  9078           DFHEIV20,
  9079           DFHEIV99,
  9080           ELCERT-KEY,
  9081           DFHEIV99,
  9082           DFHEIV99,
  9083           DFHEIV99
  9084     SET ADDRESS OF CERTIFICATE-MASTER TO
  9085         DFHEIV20
  9086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9087
  9088
  9089     IF PB-CANCELLATION
  9090        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  9091           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9092           MOVE ZERO                   TO CM-LF-ITD-CANCEL-AMT
  9093           MOVE LOW-VALUES             TO CM-LF-CANCEL-EXIT-DT
  9094                                          CM-LF-CANCEL-DT
  9095        ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL630.cbl
  9096           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9097           MOVE PB-CI-LF-CANCEL-AMT    TO CM-LF-ITD-CANCEL-AMT
  9098           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  9099           MOVE PB-CI-LIVES            TO CM-LIVES.
  9100
  9101     IF PB-CANCELLATION
  9102        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
  9103           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL SPACE
  9104               MOVE CM-LF-STATUS-AT-CANCEL
  9105                                        TO CM-LF-CURRENT-STATUS
  9106               MOVE SPACE
  9107                                        TO CM-LF-STATUS-AT-CANCEL
  9108            ELSE
  9109               MOVE PB-CI-LF-POLICY-STATUS
  9110                                        TO CM-LF-CURRENT-STATUS
  9111        ELSE
  9112            MOVE PB-CI-LF-POLICY-STATUS TO CM-LF-CURRENT-STATUS.
  9113
  9114     IF PB-CANCELLATION
  9115        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  9116           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9117           MOVE ZERO                   TO CM-AH-ITD-CANCEL-AMT
  9118           MOVE LOW-VALUES             TO CM-AH-CANCEL-EXIT-DT
  9119                                          CM-AH-CANCEL-DT
  9120        ELSE
  9121           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
  9122           MOVE PB-CI-AH-CANCEL-AMT    TO CM-AH-ITD-CANCEL-AMT
  9123           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  9124           MOVE PB-CI-LIVES            TO CM-LIVES.
  9125
  9126     IF PB-CANCELLATION
  9127        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  9128           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL SPACE
  9129               MOVE CM-AH-STATUS-AT-CANCEL
  9130                                        TO CM-AH-CURRENT-STATUS
  9131               MOVE SPACE
  9132                                        TO CM-AH-STATUS-AT-CANCEL
  9133            ELSE
  9134               MOVE PB-CI-AH-POLICY-STATUS
  9135                                        TO CM-AH-CURRENT-STATUS
  9136        ELSE
  9137            MOVE PB-CI-AH-POLICY-STATUS TO CM-AH-CURRENT-STATUS.
  9138
  9139 6255-REWRITE-CERT.
  9140
  9141
  9142* EXEC CICS REWRITE
  9143*        DATASET    (ELCERT-FILE-ID)
  9144*        FROM       (CERTIFICATE-MASTER)
  9145*    END-EXEC.
  9146     MOVE LENGTH OF
  9147      CERTIFICATE-MASTER
  9148       TO DFHEIV11
  9149*    MOVE '&& L                  %   #00007871' TO DFHEIV0
  9150     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9151     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9152     MOVE X'2020233030303037383731' TO DFHEIV0(25:11)
  9153     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL630.cbl
  9154           ELCERT-FILE-ID,
  9155           CERTIFICATE-MASTER,
  9156           DFHEIV11,
  9157           DFHEIV99
  9158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9159
  9160
  9161 6300-WRITE-PNDB-RECORD.
  9162
  9163     MOVE 'X'                    TO  PB-FATAL-FLAG.
  9164
  9165     MOVE SPACES                 TO  PB-I-RATE-DEVIATION-LF
  9166                                     PB-I-RATE-DEVIATION-AH
  9167                                     PB-REIN-CD
  9168                                     PB-SV-CARRIER
  9169                                     PB-SV-GROUPING
  9170                                     PB-SV-STATE.
  9171
  9172     IF PB-BATCH-TRAILER
  9173         MOVE PI-AM-NAME         TO  PB-ACCOUNT-NAME
  9174         MOVE PI-SAV-FC-CARRIER  TO  PB-SV-CARRIER
  9175         MOVE PI-SAV-FC-GROUPING TO  PB-SV-GROUPING
  9176         MOVE PI-SAV-FC-STATE    TO  PB-SV-STATE.
  9177
  9178     MOVE LOW-VALUES             TO  PB-ACCT-EFF-DT
  9179                                     PB-ACCT-EXP-DT.
  9180
  9181     MOVE ZEROS                  TO  PB-CALC-TOLERANCE.
  9182
  9183     IF  CARRIERL GREATER ZEROS
  9184         MOVE CARRIERI           TO PB-CARRIER
  9185        ELSE
  9186         MOVE SPACES             TO PB-CARRIER.
  9187
  9188     IF  GROUPL   GREATER ZEROS
  9189         MOVE GROUPI             TO PB-GROUPING
  9190        ELSE
  9191         MOVE SPACES             TO PB-GROUPING.
  9192
  9193     IF  STATEL   GREATER ZEROS
  9194         MOVE STATEI             TO PB-STATE
  9195        ELSE
  9196         MOVE SPACES             TO PB-STATE.
  9197
  9198     IF  ACCOUNTL GREATER ZEROS
  9199         MOVE ACCOUNTI           TO PB-ACCOUNT
  9200        ELSE
  9201         MOVE SPACES             TO PB-ACCOUNT.
  9202
  9203     IF WS-ON1-SW7 IS EQUAL TO 'Y'
  9204         MOVE 'N'                TO WS-ON1-SW7
  9205         MOVE PB-GROUPING        TO PI-SAV-GROUPING
  9206         MOVE PB-STATE           TO PI-SAV-STATE
  9207         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT.
  9208
  9209
  9210* EXEC CICS WRITE
  9211*        DATASET(ERPNDB-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL630.cbl
  9212*        FROM   (PENDING-BUSINESS)
  9213*        RIDFLD (PB-CONTROL-PRIMARY)
  9214*    END-EXEC.
  9215     MOVE LENGTH OF
  9216      PENDING-BUSINESS
  9217       TO DFHEIV11
  9218*    MOVE '&$ L                  ''   #00007924' TO DFHEIV0
  9219     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9220     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9221     MOVE X'2020233030303037393234' TO DFHEIV0(25:11)
  9222     CALL 'kxdfhei1' USING DFHEIV0,
  9223           ERPNDB-FILE-ID,
  9224           PENDING-BUSINESS,
  9225           DFHEIV11,
  9226           PB-CONTROL-PRIMARY,
  9227           DFHEIV99,
  9228           DFHEIV99
  9229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9230
  9231
  9232     GO TO 6010-GET-NEXT-RECORD.
  9233
  9234 6400-STOP-BROWSE.
  9235
  9236* EXEC CICS ENDBR
  9237*        DATASET(ERPNDB-FILE-ID)
  9238*    END-EXEC.
  9239     MOVE 0
  9240       TO DFHEIV11
  9241*    MOVE '&2                    $   #00007933' TO DFHEIV0
  9242     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9243     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9244     MOVE X'2020233030303037393333' TO DFHEIV0(25:11)
  9245     CALL 'kxdfhei1' USING DFHEIV0,
  9246           ERPNDB-FILE-ID,
  9247           DFHEIV11,
  9248           DFHEIV99
  9249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9250
  9251
  9252     MOVE 'Y'                    TO  PI-UPDATE-SW.
  9253
  9254     IF PI-AR-PROCESSING
  9255        PERFORM 6600-REWRITE-REQUEST THRU 6690-EXIT.
  9256
  9257     MOVE ER-2990                TO EMI-ERROR.
  9258     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9259     MOVE -1                     TO MAINTL.
  9260     MOVE AL-SANON               TO MAINTA.
  9261     MOVE PI-SAV-REFERENCE       TO REFO.
  9262     GO TO 8200-SEND-DATAONLY.
  9263
  9264 6500-NO-RECORDS.
  9265     MOVE ER-2242                TO EMI-ERROR.
  9266     MOVE -1                     TO BATCHL.
  9267     MOVE AL-UABON               TO BATCHA.
  9268     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9269     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL630.cbl
  9270
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL630.cbl
  9272
  9273******************************************************************
  9274*                                                                *
  9275*          R E W R I T E   R E Q U E S T   R E C O R D           *
  9276*                                                                *
  9277******************************************************************
  9278
  9279 6600-REWRITE-REQUEST.
  9280
  9281
  9282* EXEC CICS HANDLE CONDITION
  9283*        NOTFND (6690-EXIT)
  9284*    END-EXEC.
  9285*    MOVE '"$I                   ! > #00007966' TO DFHEIV0
  9286     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9288     MOVE X'3E20233030303037393636' TO DFHEIV0(25:11)
  9289     CALL 'kxdfhei1' USING DFHEIV0
  9290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9291
  9292
  9293     MOVE PI-COMPANY-CD          TO  ERRQST-COMP-CD.
  9294     MOVE PI-SAV-ENTRY-BATCH     TO  ERRQST-ENTRY-BATCH.
  9295
  9296
  9297* EXEC CICS READ
  9298*         DATASET    (ERRQST-FILE-ID)
  9299*         SET        (ADDRESS OF AR-REQUEST-RECORD)
  9300*         RIDFLD     (ERRQST-KEY)
  9301*         UPDATE
  9302*    END-EXEC.
  9303*    MOVE '&"S        EU         (   #00007973' TO DFHEIV0
  9304     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9305     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9306     MOVE X'2020233030303037393733' TO DFHEIV0(25:11)
  9307     CALL 'kxdfhei1' USING DFHEIV0,
  9308           ERRQST-FILE-ID,
  9309           DFHEIV20,
  9310           DFHEIV99,
  9311           ERRQST-KEY,
  9312           DFHEIV99,
  9313           DFHEIV99,
  9314           DFHEIV99
  9315     SET ADDRESS OF AR-REQUEST-RECORD TO
  9316         DFHEIV20
  9317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9318
  9319
  9320     IF  CARRIERL GREATER ZEROS
  9321         MOVE CARRIERI           TO RQ-CARRIER-A1
  9322                                    RQ-CARRIER-A2
  9323                                    RQ-CARRIER-A2.
  9324
  9325     IF  GROUPL   GREATER ZEROS
  9326         MOVE GROUPI             TO RQ-GROUPING-A1
  9327                                    RQ-GROUPING-A2
  9328                                    RQ-GROUPING-A3.
  9329
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL630.cbl
  9330     IF  STATEL   GREATER ZEROS
  9331         MOVE STATEI             TO RQ-STATE-A1.
  9332
  9333     IF  ACCOUNTL GREATER ZEROS
  9334         MOVE ACCOUNTI           TO RQ-ACCOUNT-A1
  9335                                    RQ-ACCOUNT-A4.
  9336
  9337     IF PI-ZERO-CARRIER
  9338        MOVE ZERO                TO RQ-CARRIER-A2.
  9339
  9340     IF PI-ZERO-GROUPING
  9341        MOVE ZEROS               TO RQ-GROUPING-A2.
  9342
  9343     IF PI-ZERO-CAR-GROUP
  9344        MOVE ZEROS               TO RQ-CARRIER-A2
  9345                                    RQ-GROUPING-A2.
  9346
  9347     MOVE PI-REMIT-AGENT (PI-SUB) TO RQ-FIN-RESP-A2
  9348                                     PI-FIN-RESP.
  9349
  9350     MOVE PI-ACCT-AGENT  (PI-SUB) TO RQ-ACCT-AGENT-A2
  9351                                     PI-ACCOUNT-AGENT.
  9352
  9353
  9354* EXEC CICS REWRITE
  9355*         DATASET    (ERRQST-FILE-ID)
  9356*         FROM       (AR-REQUEST-RECORD)
  9357*    END-EXEC.
  9358     MOVE LENGTH OF
  9359      AR-REQUEST-RECORD
  9360       TO DFHEIV11
  9361*    MOVE '&& L                  %   #00008013' TO DFHEIV0
  9362     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9363     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9364     MOVE X'2020233030303038303133' TO DFHEIV0(25:11)
  9365     CALL 'kxdfhei1' USING DFHEIV0,
  9366           ERRQST-FILE-ID,
  9367           AR-REQUEST-RECORD,
  9368           DFHEIV11,
  9369           DFHEIV99
  9370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9371
  9372
  9373 6690-EXIT.
  9374     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL630.cbl
  9376
  9377******************************************************************
  9378*                                                                *
  9379*           V E R I F Y   R E Q U E S T   R E C O R D            *
  9380*                                                                *
  9381******************************************************************
  9382
  9383 7000-VERIFY-REQUEST-REC.
  9384
  9385* EXEC CICS HANDLE CONDITION
  9386*        NOTFND(7090-EXIT)
  9387*    END-EXEC.
  9388*    MOVE '"$I                   ! ? #00008029' TO DFHEIV0
  9389     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9391     MOVE X'3F20233030303038303239' TO DFHEIV0(25:11)
  9392     CALL 'kxdfhei1' USING DFHEIV0
  9393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9394
  9395
  9396     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9397     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9398
  9399
  9400* EXEC CICS READ
  9401*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9402*        DATASET(ERRQST-FILE-ID)
  9403*        RIDFLD (ERRQST-KEY)
  9404*    END-EXEC.
  9405*    MOVE '&"S        E          (   #00008036' TO DFHEIV0
  9406     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9408     MOVE X'2020233030303038303336' TO DFHEIV0(25:11)
  9409     CALL 'kxdfhei1' USING DFHEIV0,
  9410           ERRQST-FILE-ID,
  9411           DFHEIV20,
  9412           DFHEIV99,
  9413           ERRQST-KEY,
  9414           DFHEIV99,
  9415           DFHEIV99,
  9416           DFHEIV99
  9417     SET ADDRESS OF AR-REQUEST-RECORD TO
  9418         DFHEIV20
  9419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9420
  9421
  9422     IF RQ-STMT-DT NOT = LOW-VALUES
  9423        MOVE ER-2126        TO EMI-ERROR
  9424        MOVE -1             TO BATCHL
  9425        MOVE AL-UABON       TO BATCHA
  9426        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  9427        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9428        GO TO 7090-EXIT.
  9429
  9430******************************************************************
  9431*                                                                *
  9432*   IF THE BATCH IS BEING DELETED (PF2), DELETE REQUEST RECORD.  *
  9433*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL630.cbl
  9434******************************************************************
  9435
  9436     IF EIBAID = DFHPF2
  9437        NEXT SENTENCE
  9438     ELSE
  9439        GO TO 7090-EXIT.
  9440
  9441
  9442* EXEC CICS READ
  9443*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9444*        DATASET(ERRQST-FILE-ID)
  9445*        RIDFLD (ERRQST-KEY)
  9446*        UPDATE
  9447*    END-EXEC.
  9448*    MOVE '&"S        EU         (   #00008061' TO DFHEIV0
  9449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9450     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9451     MOVE X'2020233030303038303631' TO DFHEIV0(25:11)
  9452     CALL 'kxdfhei1' USING DFHEIV0,
  9453           ERRQST-FILE-ID,
  9454           DFHEIV20,
  9455           DFHEIV99,
  9456           ERRQST-KEY,
  9457           DFHEIV99,
  9458           DFHEIV99,
  9459           DFHEIV99
  9460     SET ADDRESS OF AR-REQUEST-RECORD TO
  9461         DFHEIV20
  9462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9463
  9464
  9465
  9466* EXEC CICS DELETE
  9467*        DATASET(ERRQST-FILE-ID)
  9468*    END-EXEC.
  9469*    MOVE '&(                    &   #00008068' TO DFHEIV0
  9470     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9471     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9472     MOVE X'2020233030303038303638' TO DFHEIV0(25:11)
  9473     CALL 'kxdfhei1' USING DFHEIV0,
  9474           ERRQST-FILE-ID,
  9475           DFHEIV99,
  9476           DFHEIV99,
  9477           DFHEIV99,
  9478           DFHEIV99
  9479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9480
  9481
  9482 7090-EXIT.
  9483      EXIT.
  9484
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL630.cbl
  9486
  9487 7100-REWRITE-REQUEST-REC.
  9488
  9489
  9490* EXEC CICS HANDLE CONDITION
  9491*        NOTFND(7180-NO-REQUEST-REC)
  9492*    END-EXEC.
  9493*    MOVE '"$I                   ! @ #00008079' TO DFHEIV0
  9494     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9496     MOVE X'4020233030303038303739' TO DFHEIV0(25:11)
  9497     CALL 'kxdfhei1' USING DFHEIV0
  9498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9499
  9500
  9501
  9502     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9503     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9504
  9505
  9506* EXEC CICS READ
  9507*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9508*        DATASET(ERRQST-FILE-ID)
  9509*        RIDFLD (ERRQST-KEY)
  9510*        UPDATE
  9511*    END-EXEC.
  9512*    MOVE '&"S        EU         (   #00008087' TO DFHEIV0
  9513     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9514     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9515     MOVE X'2020233030303038303837' TO DFHEIV0(25:11)
  9516     CALL 'kxdfhei1' USING DFHEIV0,
  9517           ERRQST-FILE-ID,
  9518           DFHEIV20,
  9519           DFHEIV99,
  9520           ERRQST-KEY,
  9521           DFHEIV99,
  9522           DFHEIV99,
  9523           DFHEIV99
  9524     SET ADDRESS OF AR-REQUEST-RECORD TO
  9525         DFHEIV20
  9526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9527
  9528
  9529     IF RQ-STMT-DT NOT = LOW-VALUES
  9530        MOVE ER-2126        TO EMI-ERROR
  9531        MOVE -1             TO BATCHL
  9532        MOVE AL-UABON       TO BATCHA
  9533        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  9534        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9535        GO TO 7190-EXIT.
  9536
  9537     MOVE PI-SAV-REFERENCE  TO RQ-REFERENCE-A1
  9538                               RQ-REFERENCE-A2
  9539                               RQ-REFERENCE-A4.
  9540
  9541
  9542* EXEC CICS REWRITE
  9543*        DATASET(ERRQST-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL630.cbl
  9544*        FROM   (AR-REQUEST-RECORD)
  9545*    END-EXEC.
  9546     MOVE LENGTH OF
  9547      AR-REQUEST-RECORD
  9548       TO DFHEIV11
  9549*    MOVE '&& L                  %   #00008106' TO DFHEIV0
  9550     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9551     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9552     MOVE X'2020233030303038313036' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0,
  9554           ERRQST-FILE-ID,
  9555           AR-REQUEST-RECORD,
  9556           DFHEIV11,
  9557           DFHEIV99
  9558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9559
  9560
  9561     GO TO 7190-EXIT.
  9562
  9563 7180-NO-REQUEST-REC.
  9564     MOVE ER-2132        TO EMI-ERROR.
  9565     MOVE -1             TO BATCHL.
  9566     MOVE AL-UABON       TO BATCHA.
  9567     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9568     MOVE 'N'            TO WS-RECORD-FOUND-SW.
  9569     GO TO 7190-EXIT.
  9570
  9571 7190-EXIT.
  9572     EXIT.
  9573
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL630.cbl
  9575
  9576******************************************************************
  9577*
  9578*     7200-REWRITE IS USED TO REWRITE THE REQUEST FILE WHEN
  9579*     THE EOM DATE IS CHANGED.
  9580*
  9581******************************************************************
  9582
  9583 7200-REWRITE-REQUEST.
  9584
  9585* EXEC CICS HANDLE CONDITION
  9586*        NOTFND(7280-NO-REQUEST-REC)
  9587*    END-EXEC.
  9588*    MOVE '"$I                   ! A #00008134' TO DFHEIV0
  9589     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9591     MOVE X'4120233030303038313334' TO DFHEIV0(25:11)
  9592     CALL 'kxdfhei1' USING DFHEIV0
  9593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9594
  9595
  9596     MOVE PI-COMPANY-CD          TO ERRQST-COMP-CD.
  9597     MOVE PI-SAV-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
  9598
  9599
  9600* EXEC CICS READ
  9601*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9602*        DATASET(ERRQST-FILE-ID)
  9603*        RIDFLD (ERRQST-KEY)
  9604*        UPDATE
  9605*    END-EXEC.
  9606*    MOVE '&"S        EU         (   #00008141' TO DFHEIV0
  9607     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9608     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9609     MOVE X'2020233030303038313431' TO DFHEIV0(25:11)
  9610     CALL 'kxdfhei1' USING DFHEIV0,
  9611           ERRQST-FILE-ID,
  9612           DFHEIV20,
  9613           DFHEIV99,
  9614           ERRQST-KEY,
  9615           DFHEIV99,
  9616           DFHEIV99,
  9617           DFHEIV99
  9618     SET ADDRESS OF AR-REQUEST-RECORD TO
  9619         DFHEIV20
  9620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9621
  9622
  9623     IF RQ-STMT-DT NOT = LOW-VALUES
  9624        MOVE ER-2126        TO EMI-ERROR
  9625        MOVE -1             TO BATCHL
  9626        MOVE AL-UABON       TO BATCHA
  9627        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9628        MOVE 'N'            TO WS-RECORD-FOUND-SW
  9629        GO TO 7299-EXIT.
  9630
  9631
  9632     IF PI-NB-MONTH-END-DT NOT = RQ-MO-END-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL630.cbl
  9633        MOVE PI-NB-MONTH-END-DT  TO  RQ-MO-END-DT.
  9634
  9635     IF PI-SAV-REFERENCE NOT = RQ-REFERENCE-A1
  9636        MOVE PI-SAV-REFERENCE    TO RQ-REFERENCE-A1
  9637                                    RQ-REFERENCE-A2
  9638                                    RQ-REFERENCE-A4.
  9639
  9640
  9641* EXEC CICS REWRITE
  9642*        DATASET(ERRQST-FILE-ID)
  9643*        FROM   (AR-REQUEST-RECORD)
  9644*    END-EXEC.
  9645     MOVE LENGTH OF
  9646      AR-REQUEST-RECORD
  9647       TO DFHEIV11
  9648*    MOVE '&& L                  %   #00008165' TO DFHEIV0
  9649     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9650     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9651     MOVE X'2020233030303038313635' TO DFHEIV0(25:11)
  9652     CALL 'kxdfhei1' USING DFHEIV0,
  9653           ERRQST-FILE-ID,
  9654           AR-REQUEST-RECORD,
  9655           DFHEIV11,
  9656           DFHEIV99
  9657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9658
  9659
  9660     GO TO 7299-EXIT.
  9661
  9662 7280-NO-REQUEST-REC.
  9663     MOVE ER-2132        TO EMI-ERROR.
  9664     MOVE -1             TO BATCHL.
  9665     MOVE AL-UABON       TO BATCHA.
  9666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9667     MOVE 'N'            TO WS-RECORD-FOUND-SW.
  9668
  9669 7299-EXIT.
  9670     EXIT.
  9671
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL630.cbl
  9673
  9674 8100-SEND-INITIAL-MAP.
  9675     MOVE WS-CURRENT-DT          TO DATEO.
  9676     MOVE EIBTIME                TO TIME-IN.
  9677     MOVE TIME-OUT               TO TIMEO.
  9678     MOVE -1                     TO MAINTL.
  9679     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9680     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  9681
  9682     MOVE PI-LIFE-OVERRIDE-L2    TO WS-PRM-OVERRIDE
  9683                                    WS-REFUND-OVERRIDE.
  9684     MOVE WS-PRM-HEADER          TO LFPHDGO.
  9685     MOVE WS-REFUND-HEADER       TO LFRHDGO.
  9686
  9687     MOVE PI-AH-OVERRIDE-L2      TO WS-PRM-OVERRIDE
  9688                                    WS-REFUND-OVERRIDE.
  9689     MOVE WS-PRM-HEADER          TO AHPHDGO.
  9690     MOVE WS-REFUND-HEADER       TO AHRHDGO.
  9691
  9692     IF NOT PI-AR-PROCESSING
  9693        MOVE AL-SADOF            TO REFHDGA
  9694                                    REFA.
  9695
  9696     MOVE AL-SANOF               TO PF5A.
  9697
  9698     IF CARR-GROUP-ST-ACCNT-CNTL
  9699         NEXT SENTENCE
  9700     ELSE
  9701         IF ST-ACCNT-CNTL
  9702             MOVE AL-SADOF       TO CARRHDGA
  9703                                    GRPHDGA
  9704             MOVE AL-SANOF       TO CARRIERA
  9705                                    GROUPA
  9706         ELSE
  9707             IF CARR-ST-ACCNT-CNTL
  9708                 MOVE AL-SADOF   TO GRPHDGA
  9709                 MOVE AL-SANOF   TO GROUPA
  9710             ELSE
  9711                 IF ACCNT-CNTL
  9712                     MOVE AL-SADOF TO CARRHDGA
  9713                                      GRPHDGA
  9714                                      STHDGA
  9715                     MOVE AL-SANOF TO CARRIERA
  9716                                      GROUPA
  9717                                      STATEA
  9718                 ELSE
  9719                     IF CARR-ACCNT-CNTL
  9720                         MOVE AL-SADOF TO GRPHDGA
  9721                                          STHDGA
  9722                         MOVE AL-SANOF TO GROUPA
  9723                                          STATEA.
  9724
  9725* EXEC CICS SEND
  9726*        MAP      (MAP-NAME)
  9727*        MAPSET   (MAPSET-NAME)
  9728*        FROM     (EL630AO)
  9729*        ERASE
  9730*        CURSOR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL630.cbl
  9731*    END-EXEC.
  9732     MOVE LENGTH OF
  9733      EL630AO
  9734       TO DFHEIV12
  9735     MOVE -1
  9736       TO DFHEIV11
  9737*    MOVE '8$     CT  E    H L F ,   #00008234' TO DFHEIV0
  9738     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9739     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9740     MOVE X'2020233030303038323334' TO DFHEIV0(25:11)
  9741     CALL 'kxdfhei1' USING DFHEIV0,
  9742           MAP-NAME,
  9743           EL630AO,
  9744           DFHEIV12,
  9745           MAPSET-NAME,
  9746           DFHEIV99,
  9747           DFHEIV99,
  9748           DFHEIV99,
  9749           DFHEIV11,
  9750           DFHEIV99,
  9751           DFHEIV99,
  9752           DFHEIV99
  9753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9754
  9755
  9756     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL630.cbl
  9758
  9759 8200-SEND-DATAONLY.
  9760     MOVE WS-CURRENT-DT          TO DATEO.
  9761     MOVE EIBTIME                TO TIME-IN.
  9762     MOVE TIME-OUT               TO TIMEO.
  9763     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9764     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  9765
  9766* EXEC CICS SEND
  9767*        MAP      (MAP-NAME)
  9768*        MAPSET   (MAPSET-NAME)
  9769*        FROM     (EL630AO)
  9770*        DATAONLY
  9771*        ERASEAUP
  9772*        CURSOR
  9773*    END-EXEC.
  9774     MOVE LENGTH OF
  9775      EL630AO
  9776       TO DFHEIV12
  9777     MOVE -1
  9778       TO DFHEIV11
  9779*    MOVE '8$D    CT  A    H L F ,   #00008251' TO DFHEIV0
  9780     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9781     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9782     MOVE X'2020233030303038323531' TO DFHEIV0(25:11)
  9783     CALL 'kxdfhei1' USING DFHEIV0,
  9784           MAP-NAME,
  9785           EL630AO,
  9786           DFHEIV12,
  9787           MAPSET-NAME,
  9788           DFHEIV99,
  9789           DFHEIV99,
  9790           DFHEIV99,
  9791           DFHEIV11,
  9792           DFHEIV99,
  9793           DFHEIV99,
  9794           DFHEIV99
  9795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9796
  9797
  9798     GO TO 9100-RETURN-TRAN.
  9799
  9800 8300-SEND-TEXT.
  9801
  9802* EXEC CICS SEND TEXT
  9803*        FROM     (LOGOFF-TEXT)
  9804*        LENGTH   (LOGOFF-LENGTH)
  9805*        ERASE
  9806*        FREEKB
  9807*    END-EXEC.
  9808*    MOVE '8&      T  E F  H   F -   #00008263' TO DFHEIV0
  9809     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9810     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9811     MOVE X'2020233030303038323633' TO DFHEIV0(25:11)
  9812     CALL 'kxdfhei1' USING DFHEIV0,
  9813           LOGOFF-TEXT,
  9814           LOGOFF-LENGTH,
  9815           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL630.cbl
  9816           DFHEIV99,
  9817           DFHEIV99,
  9818           DFHEIV99,
  9819           DFHEIV99,
  9820           DFHEIV99,
  9821           DFHEIV99,
  9822           DFHEIV99,
  9823           DFHEIV99,
  9824           DFHEIV99
  9825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9826
  9827
  9828
  9829* EXEC CICS RETURN
  9830*    END-EXEC.
  9831*    MOVE '.(                    &   #00008270' TO DFHEIV0
  9832     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9833     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9834     MOVE X'2020233030303038323730' TO DFHEIV0(25:11)
  9835     CALL 'kxdfhei1' USING DFHEIV0,
  9836           DFHEIV99,
  9837           DFHEIV99,
  9838           DFHEIV99,
  9839           DFHEIV99,
  9840           DFHEIV99
  9841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9842
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL630.cbl
  9844 8600-DEEDIT.
  9845
  9846* EXEC CICS BIF DEEDIT
  9847*        FIELD (WS-DEEDIT-FIELD)
  9848*        LENGTH(10)
  9849*     END-EXEC.
  9850     MOVE 10
  9851       TO DFHEIV11
  9852*    MOVE '@"L                   #   #00008274' TO DFHEIV0
  9853     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9854     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9855     MOVE X'2020233030303038323734' TO DFHEIV0(25:11)
  9856     CALL 'kxdfhei1' USING DFHEIV0,
  9857           WS-DEEDIT-FIELD,
  9858           DFHEIV11
  9859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9860
  9861
  9862 8600-EXIT.
  9863     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL630.cbl
  9865 8800-UNAUTHORIZED-ACCESS.
  9866     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  9867     GO TO 8300-SEND-TEXT.
  9868
  9869 8810-PF23.
  9870     IF NOT PI-DATA-UPDATED
  9871         NEXT SENTENCE
  9872     ELSE
  9873         MOVE -1                 TO PFENTERL
  9874         MOVE ER-2213            TO EMI-ERROR
  9875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9876         GO TO 4000-SHOW-TOTALS.
  9877
  9878     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  9879     MOVE XCTL-005               TO PGM-NAME.
  9880     GO TO 9300-XCTL.
  9881
  9882 9100-RETURN-TRAN.
  9883     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  9884     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  9885
  9886* EXEC CICS RETURN
  9887*        TRANSID    (TRANS-ID)
  9888*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9889*        LENGTH     (WS-COMM-LENGTH)
  9890*    END-EXEC.
  9891*    MOVE '.(CT                  &   #00008302' TO DFHEIV0
  9892     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9893     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9894     MOVE X'2020233030303038333032' TO DFHEIV0(25:11)
  9895     CALL 'kxdfhei1' USING DFHEIV0,
  9896           TRANS-ID,
  9897           PROGRAM-INTERFACE-BLOCK,
  9898           WS-COMM-LENGTH,
  9899           DFHEIV99,
  9900           DFHEIV99
  9901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9902
  9903
  9904     MOVE ZEROS  TO RETURN-CODE.
  9905
  9906* GOBACK.
  9907     MOVE '9%                    "   ' TO DFHEIV0
  9908     MOVE 'EL630' TO DFHEIV1
  9909     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9910     GOBACK.
  9911
  9912 9200-RETURN-MAIN-MENU.
  9913     IF NOT PI-DATA-UPDATED
  9914         NEXT SENTENCE
  9915     ELSE
  9916         MOVE -1                 TO PFENTERL
  9917         MOVE ER-2213            TO EMI-ERROR
  9918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9919         GO TO 4000-SHOW-TOTALS.
  9920
  9921     MOVE XCTL-626               TO PGM-NAME.
  9922     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL630.cbl
  9923
  9924 9300-XCTL.
  9925
  9926* EXEC CICS XCTL
  9927*        PROGRAM    (PGM-NAME)
  9928*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9929*        LENGTH     (WS-COMM-LENGTH)
  9930*    END-EXEC.
  9931*    MOVE '.$C                   $   #00008324' TO DFHEIV0
  9932     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9933     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9934     MOVE X'2020233030303038333234' TO DFHEIV0(25:11)
  9935     CALL 'kxdfhei1' USING DFHEIV0,
  9936           PGM-NAME,
  9937           PROGRAM-INTERFACE-BLOCK,
  9938           WS-COMM-LENGTH
  9939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9940
  9941     MOVE ZEROS  TO RETURN-CODE.
  9942
  9943* GOBACK.
  9944     MOVE '9%                    "   ' TO DFHEIV0
  9945     MOVE 'EL630' TO DFHEIV1
  9946     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9947     GOBACK.
  9948
  9949 9400-CLEAR.
  9950     IF NOT PI-DATA-UPDATED
  9951         NEXT SENTENCE
  9952     ELSE
  9953         MOVE 'Y'                TO PI-CLEAR-ERROR-SW
  9954         MOVE -1                 TO PFENTERL
  9955         MOVE ER-2213            TO EMI-ERROR
  9956         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9957         GO TO 4000-SHOW-TOTALS.
  9958
  9959     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  9960     GO TO 9300-XCTL.
  9961
  9962 9500-PF12.
  9963     MOVE XCTL-010               TO PGM-NAME.
  9964     GO TO 9300-XCTL.
  9965
  9966 9600-PGMID-ERROR.
  9967
  9968* EXEC CICS HANDLE CONDITION
  9969*        PGMIDERR    (8300-SEND-TEXT)
  9970*    END-EXEC.
  9971*    MOVE '"$L                   ! B #00008350' TO DFHEIV0
  9972     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9974     MOVE X'4220233030303038333530' TO DFHEIV0(25:11)
  9975     CALL 'kxdfhei1' USING DFHEIV0
  9976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9977
  9978
  9979     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  9980     MOVE ' '                    TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL630.cbl
  9981     MOVE XCTL-005               TO PGM-NAME.
  9982     MOVE PGM-NAME               TO LOGOFF-PGM.
  9983     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  9984     GO TO 9300-XCTL.
  9985
  9986 9700-DATE-LINK.
  9987     MOVE LINK-ELDATCV           TO PGM-NAME.
  9988
  9989* EXEC CICS LINK
  9990*        PROGRAM    (PGM-NAME)
  9991*        COMMAREA   (DATE-CONVERSION-DATA)
  9992*        LENGTH     (DC-COMM-LENGTH)
  9993*    END-EXEC.
  9994*    MOVE '."C                   ''   #00008363' TO DFHEIV0
  9995     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9996     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9997     MOVE X'2020233030303038333633' TO DFHEIV0(25:11)
  9998     CALL 'kxdfhei1' USING DFHEIV0,
  9999           PGM-NAME,
 10000           DATE-CONVERSION-DATA,
 10001           DC-COMM-LENGTH,
 10002           DFHEIV99,
 10003           DFHEIV99,
 10004           DFHEIV99
 10005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10006
 10007
 10008 9900-ERROR-FORMAT.
 10009     IF NOT EMI-ERRORS-COMPLETE
 10010         MOVE LINK-001           TO PGM-NAME
 10011
 10012* EXEC CICS LINK
 10013*            PROGRAM    (PGM-NAME)
 10014*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10015*            LENGTH     (EMI-COMM-LENGTH)
 10016*        END-EXEC.
 10017*    MOVE '."C                   ''   #00008372' TO DFHEIV0
 10018     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10019     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10020     MOVE X'2020233030303038333732' TO DFHEIV0(25:11)
 10021     CALL 'kxdfhei1' USING DFHEIV0,
 10022           PGM-NAME,
 10023           ERROR-MESSAGE-INTERFACE-BLOCK,
 10024           EMI-COMM-LENGTH,
 10025           DFHEIV99,
 10026           DFHEIV99,
 10027           DFHEIV99
 10028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10029
 10030
 10031 9900-EXIT.
 10032     EXIT.
 10033
 10034 9990-ABEND.
 10035     MOVE LINK-004               TO PGM-NAME.
 10036     MOVE DFHEIBLK               TO EMI-LINE1.
 10037
 10038* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL630.cbl
 10039*        PROGRAM   (PGM-NAME)
 10040*        COMMAREA  (EMI-LINE1)
 10041*        LENGTH    (72)
 10042*    END-EXEC.
 10043     MOVE 72
 10044       TO DFHEIV11
 10045*    MOVE '."C                   ''   #00008384' TO DFHEIV0
 10046     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10047     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10048     MOVE X'2020233030303038333834' TO DFHEIV0(25:11)
 10049     CALL 'kxdfhei1' USING DFHEIV0,
 10050           PGM-NAME,
 10051           EMI-LINE1,
 10052           DFHEIV11,
 10053           DFHEIV99,
 10054           DFHEIV99,
 10055           DFHEIV99
 10056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10057
 10058
 10059     MOVE -1                     TO PFENTERL.
 10060     GO TO 8200-SEND-DATAONLY.
 10061
 10062 9995-SECURITY-VIOLATION.
 10063*                            COPY ELCSCTP.
 10064******************************************************************
 10065*                                                                *
 10066*                            ELCSCTP                             *
 10067*                            VMOD=2.001                          *
 10068*                                                                *
 10069*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10070******************************************************************
 10071
 10072
 10073     MOVE EIBDATE          TO SM-JUL-DATE.
 10074     MOVE EIBTRMID         TO SM-TERMID.
 10075     MOVE THIS-PGM         TO SM-PGM.
 10076     MOVE EIBTIME          TO TIME-IN.
 10077     MOVE TIME-OUT         TO SM-TIME.
 10078     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10079
 10080
 10081* EXEC CICS LINK
 10082*         PROGRAM  ('EL003')
 10083*         COMMAREA (SECURITY-MESSAGE)
 10084*         LENGTH   (80)
 10085*    END-EXEC.
 10086     MOVE 'EL003' TO DFHEIV1
 10087     MOVE 80
 10088       TO DFHEIV11
 10089*    MOVE '."C                   ''   #00008411' TO DFHEIV0
 10090     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10092     MOVE X'2020233030303038343131' TO DFHEIV0(25:11)
 10093     CALL 'kxdfhei1' USING DFHEIV0,
 10094           DFHEIV1,
 10095           SECURITY-MESSAGE,
 10096           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL630.cbl
 10097           DFHEIV99,
 10098           DFHEIV99,
 10099           DFHEIV99
 10100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10101
 10102
 10103******************************************************************
 10104
 10105
 10106 9995-EXIT.
 10107     EXIT.
 10108
 10109
 10110 9999-DFHBACK SECTION.
 10111     MOVE '9%                    "   ' TO DFHEIV0
 10112     MOVE 'EL630' TO DFHEIV1
 10113     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10114     GOBACK.
 10115 9999-DFHEXIT.
 10116     IF DFHEIGDJ EQUAL 0001
 10117         NEXT SENTENCE
 10118     ELSE IF DFHEIGDJ EQUAL 2
 10119         GO TO 9600-PGMID-ERROR,
 10120               9990-ABEND
 10121         DEPENDING ON DFHEIGDI
 10122     ELSE IF DFHEIGDJ EQUAL 3
 10123         GO TO 0350-NO-RECORDS,
 10124               0350-NO-RECORDS
 10125         DEPENDING ON DFHEIGDI
 10126     ELSE IF DFHEIGDJ EQUAL 4
 10127         GO TO 0480-NO-BATCH-TRAILER
 10128         DEPENDING ON DFHEIGDI
 10129     ELSE IF DFHEIGDJ EQUAL 5
 10130         GO TO 1000-NO-CARRIER
 10131         DEPENDING ON DFHEIGDI
 10132     ELSE IF DFHEIGDJ EQUAL 6
 10133         GO TO 1100-NO-STATE
 10134         DEPENDING ON DFHEIGDI
 10135     ELSE IF DFHEIGDJ EQUAL 7
 10136         GO TO 1200-ACCOUNT-INVALID,
 10137               1200-ACCOUNT-INVALID
 10138         DEPENDING ON DFHEIGDI
 10139     ELSE IF DFHEIGDJ EQUAL 8
 10140         GO TO 1250-NO-COMPANY-REC
 10141         DEPENDING ON DFHEIGDI
 10142     ELSE IF DFHEIGDJ EQUAL 9
 10143         GO TO 1300-NO-COMPANY-REC
 10144         DEPENDING ON DFHEIGDI
 10145     ELSE IF DFHEIGDJ EQUAL 10
 10146         GO TO 1300-EXIT
 10147         DEPENDING ON DFHEIGDI
 10148     ELSE IF DFHEIGDJ EQUAL 11
 10149         GO TO 1470-NO-COMP-MSTR
 10150         DEPENDING ON DFHEIGDI
 10151     ELSE IF DFHEIGDJ EQUAL 12
 10152         GO TO 1990-EXIT
 10153         DEPENDING ON DFHEIGDI
 10154     ELSE IF DFHEIGDJ EQUAL 13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL630.cbl
 10155         GO TO 2100-ADD-BATCH-TOTAL-REC
 10156         DEPENDING ON DFHEIGDI
 10157     ELSE IF DFHEIGDJ EQUAL 14
 10158         GO TO 3200-NO-RECORDS
 10159         DEPENDING ON DFHEIGDI
 10160     ELSE IF DFHEIGDJ EQUAL 15
 10161         GO TO 3120-END-ROUTINE
 10162         DEPENDING ON DFHEIGDI
 10163     ELSE IF DFHEIGDJ EQUAL 16
 10164         GO TO 3100-STOP-BROWSE,
 10165               3100-STOP-BROWSE
 10166         DEPENDING ON DFHEIGDI
 10167     ELSE IF DFHEIGDJ EQUAL 17
 10168         GO TO 3006-DELETE-CERTIFICATE,
 10169               3006-DELETE-CERTIFICATE
 10170         DEPENDING ON DFHEIGDI
 10171     ELSE IF DFHEIGDJ EQUAL 18
 10172         GO TO 3020-CONTINUE-DELETE
 10173         DEPENDING ON DFHEIGDI
 10174     ELSE IF DFHEIGDJ EQUAL 19
 10175         GO TO 3006-DELETE-ERNOTE
 10176         DEPENDING ON DFHEIGDI
 10177     ELSE IF DFHEIGDJ EQUAL 20
 10178         GO TO 3007-DELETE-MAILING-DATA
 10179         DEPENDING ON DFHEIGDI
 10180     ELSE IF DFHEIGDJ EQUAL 21
 10181         GO TO 3020-CONTINUE-DELETE,
 10182               3020-CONTINUE-DELETE
 10183         DEPENDING ON DFHEIGDI
 10184     ELSE IF DFHEIGDJ EQUAL 22
 10185         GO TO 5900-EXIT
 10186         DEPENDING ON DFHEIGDI
 10187     ELSE IF DFHEIGDJ EQUAL 23
 10188         GO TO 5100-STOP-BROWSE,
 10189               5100-STOP-BROWSE
 10190         DEPENDING ON DFHEIGDI
 10191     ELSE IF DFHEIGDJ EQUAL 24
 10192         GO TO 6500-NO-RECORDS
 10193         DEPENDING ON DFHEIGDI
 10194     ELSE IF DFHEIGDJ EQUAL 25
 10195         GO TO 6400-STOP-BROWSE,
 10196               6400-STOP-BROWSE
 10197         DEPENDING ON DFHEIGDI
 10198     ELSE IF DFHEIGDJ EQUAL 26
 10199         GO TO 6300-WRITE-PNDB-RECORD
 10200         DEPENDING ON DFHEIGDI
 10201     ELSE IF DFHEIGDJ EQUAL 27
 10202         GO TO 6070-DELETE-MAILING
 10203         DEPENDING ON DFHEIGDI
 10204     ELSE IF DFHEIGDJ EQUAL 28
 10205         GO TO 6300-WRITE-PNDB-RECORD,
 10206               6300-WRITE-PNDB-RECORD
 10207         DEPENDING ON DFHEIGDI
 10208     ELSE IF DFHEIGDJ EQUAL 29
 10209         GO TO 6300-WRITE-PNDB-RECORD
 10210         DEPENDING ON DFHEIGDI
 10211     ELSE IF DFHEIGDJ EQUAL 30
 10212         GO TO 6690-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL630.cbl
 10213         DEPENDING ON DFHEIGDI
 10214     ELSE IF DFHEIGDJ EQUAL 31
 10215         GO TO 7090-EXIT
 10216         DEPENDING ON DFHEIGDI
 10217     ELSE IF DFHEIGDJ EQUAL 32
 10218         GO TO 7180-NO-REQUEST-REC
 10219         DEPENDING ON DFHEIGDI
 10220     ELSE IF DFHEIGDJ EQUAL 33
 10221         GO TO 7280-NO-REQUEST-REC
 10222         DEPENDING ON DFHEIGDI
 10223     ELSE IF DFHEIGDJ EQUAL 34
 10224         GO TO 8300-SEND-TEXT
 10225         DEPENDING ON DFHEIGDI.
 10226     MOVE '9%                    "   ' TO DFHEIV0
 10227     MOVE 'EL630' TO DFHEIV1
 10228     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10229     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6372     Code:       27663
