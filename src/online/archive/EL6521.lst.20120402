* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   1
* EL6521.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL6521.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6521.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6521.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/18/94 10:26:25.
     7*                            VMOD=2.004
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   2
* EL6521.cbl
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*                                                                *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23*
    24*REMARKS.    TRANSACTION - EXD8 - COMPENSATION GA STATUS DATA.
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    35* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
    36* 092707    2004020600003  PEMA  ADD DELIVER TO MEL SWITCH
    37* 030211    2010012100001  PEMA  ADD RDS EMAILS TO LOGIC
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   3
* EL6521.cbl
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL6521 WORKING STORAGE    *'.
    47 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.004 *********'.
    48
    49 01  WS-DATE-AREA.
    50     05  WS-SAVE-DATE                PIC X(8) VALUE SPACES.
    51     05  WS-SAVE-BIN-DT              PIC XX   VALUE SPACES.
    52     05  WS-EFF-YMD                  PIC X(6).
    53     05  WS-SAVE-BIN-EFFDT           PIC XX   VALUE SPACES.
    54     05  WS-TRM-YMD                  PIC X(6).
    55     05  WS-SAVE-BIN-TRMDT           PIC XX   VALUE SPACES.
    56     05  WS-ACH-SW                   PIC X    VALUE 'N'.
    57         88  ACH-HAS-CHANGED             VALUE 'Y'.
    58         88  NO-ACH-CHANGE               VALUE 'N'.
    59     05  SUPPRESS-MAP-SW             PIC X    VALUE SPACE.
    60         88  DO-NOT-MOVE-TO-MAP          VALUE 'N'.
    61         88  MOVE-TO-MAP                 VALUE 'Y'.
    62     05  MAP-CHANGED-SW              PIC X    VALUE 'N'.
    63         88  MAP-NOT-CHANGED             VALUE 'N'.
    64         88  MAP-CHANGED                 VALUE 'Y'.
    65     05  BILL-INST-SW                PIC X.
    66         88  BILL-INST-CHANGED           VALUE 'Y'.
    67
    68 01  WS-RESPONSE                 PIC S9(8)   COMP.
    69     88  RESP-NORMAL                  VALUE +00.
    70     88  RESP-NOTFND                  VALUE +13.
    71     88  RESP-NOTOPEN                 VALUE +19.
    72     88  RESP-ENDFILE                 VALUE +20.
    73 01  STANDARD-AREAS.
    74     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
    75     12  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1024.
    76     12  WS-SUB                      PIC S9(4) COMP VALUE +0.
    77     12  MAP-NAME                    PIC X(8) VALUE 'EL6521A'.
    78     12  MAPSET-NAME                 PIC X(8) VALUE 'EL6521S'.
    79     12  SCREEN-NUMBER               PIC X(4) VALUE '652B'.
    80     12  TRANS-ID                    PIC X(4) VALUE 'EXD8'.
    81     12  EL611-TRANS-ID              PIC X(4) VALUE 'EXL3'.
    82     12  EL6525-TRANS-ID             PIC X(4) VALUE 'EXDF'.
    83     12  EL6526-TRANS-ID             PIC X(4) VALUE 'EXDG'.
    84     12  THIS-PGM                    PIC X(8) VALUE 'EL6521'.
    85     12  PGM-NAME                    PIC X(8).
    86     12  TIME-IN                     PIC S9(7).
    87     12  TIME-OUT-R  REDEFINES TIME-IN.
    88         16  FILLER                  PIC X.
    89         16  TIME-OUT                PIC 99V99.
    90         16  FILLER                  PIC XX.
    91     12  XCTL-005                    PIC X(8) VALUE 'EL005'.
    92     12  XCTL-010                    PIC X(8) VALUE 'EL010'.
    93     12  XCTL-626                    PIC X(8) VALUE 'EL626'.
    94     12  XCTL-611                    PIC X(8) VALUE 'EL611'.
    95     12  XCTL-6525                   PIC X(8) VALUE 'EL6525'.
    96     12  XCTL-6526                   PIC X(8) VALUE 'EL6526'.
    97     12  XCTL-652                    PIC X(8) VALUE 'EL652'.
    98     12  LINK-001                    PIC X(8) VALUE 'EL001'.
    99     12  LINK-004                    PIC X(8) VALUE 'EL004'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   4
* EL6521.cbl
   100     12  QID.
   101         16  QID-TERM                PIC X(4) VALUE SPACES.
   102         16  FILLER                  PIC X(4) VALUE '521A'.
   103     12  MAP-LENGTH                  PIC S9(4) VALUE +600  COMP.
   104     12  ERCOBI-FILE-ID              PIC X(8) VALUE 'ERCOBI'.
   105     12  ERCOMP-FILE-ID              PIC X(8) VALUE 'ERCOMP'.
   106     12  ELACHP-FILE-ID              PIC X(8) VALUE 'ELACHP'.
   107     12  ELBANK-FILE-ID              PIC X(8) VALUE 'ELBANK'.
   108     12  WS-AGENT-BANK-DESC.
   109         16 FILLER                   PIC X(7) VALUE '  AGENT'.
   110         16 FILLER                   PIC X(1) VALUE X'7D'.
   111         16 FILLER                   PIC X(15)
   112                                      VALUE 'S BANK ACCOUNT:'.
   113
   114     12  DEEDIT-FIELD                PIC X(15).
   115     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
   116
   117     12  ERCOBI-KEY.
   118         16  ERCOBI-COMPANY-CD      PIC X.
   119         16  ERCOBI-STMT-OWNER      PIC X(4).
   120         16  ERCOBI-RGID            PIC X(12).
   121     12  WS-BILL-INST-SW            PIC X  VALUE SPACES.
   122         88  BILLING-INSTRUCTIONS-FOUND  VALUE 'Y'.
   123     12  ERROR-MESSAGES.
   124         16  ER-0000                 PIC X(4) VALUE '0000'.
   125         16  ER-0004                 PIC X(4) VALUE '0004'.
   126         16  ER-0008                 PIC X(4) VALUE '0008'.
   127         16  ER-0029                 PIC X(4) VALUE '0029'.
   128         16  ER-0068                 PIC X(4) VALUE '0068'.
   129         16  ER-0070                 PIC X(4) VALUE '0070'.
   130         16  ER-0348                 PIC X(4) VALUE '0348'.
   131         16  ER-0454                 PIC X(4) VALUE '0454'.
   132         16  ER-0876                 PIC X(4) VALUE '0876'.
   133         16  ER-1228                 PIC X(4) VALUE '1228'.
   134         16  ER-1626                 PIC X(4) VALUE '1626'.
   135         16  ER-1629                 PIC X(4) VALUE '1629'.
   136         16  ER-2039                 PIC X(4) VALUE '2039'.
   137         16  ER-2233                 PIC X(4) VALUE '2233'.
   138         16  ER-2797                 PIC X(4) VALUE '2797'.
   139         16  ER-7430                 PIC X(4) VALUE '7430'.
   140         16  ER-7431                 PIC X(4) VALUE '7431'.
   141         16  ER-7432                 PIC X(4) VALUE '7432'.
   142         16  ER-7434                 PIC X(4) VALUE '7434'.
   143         16  ER-7435                 PIC X(4) VALUE '7435'.
   144         16  ER-7436                 PIC X(4) VALUE '7436'.
   145         16  ER-7438                 PIC X(4) VALUE '7438'.
   146         16  ER-7440                 PIC X(4) VALUE '7440'.
   147         16  ER-7447                 PIC X(4) VALUE '7447'.
   148         16  ER-7449                 PIC X(4) VALUE '7449'.
   149         16  ER-7462                 PIC X(4) VALUE '7462'.
   150         16  ER-7465                 PIC X(4) VALUE '7465'.
   151         16  ER-7468                 PIC X(4) VALUE '7468'.
   152         16  ER-7469                 PIC X(4) VALUE '7469'.
   153         16  ER-8799                 PIC X(4) VALUE '8799'.
   154         16  ER-9388                 PIC X(4) VALUE '9388'.
   155         16  ER-9399                 PIC X(4) VALUE '9399'.
   156         16  ER-9999                 PIC X(4) VALUE '9999'.
   157
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   5
* EL6521.cbl
   158     12  ELCNTL-KEY.
   159         16  CNTL-COMP-ID            PIC X(3) VALUE SPACES.
   160         16  CNTL-REC-TYPE           PIC X    VALUE SPACES.
   161         16  CNTL-ACCESS             PIC X(4) VALUE SPACES.
   162         16  CNTL-SEQ-NO             PIC S9(4) VALUE +0  COMP.
   163
   164     12  WS-BANK-INFORMATION.
   165         16 WS-BANK-DATA.
   166             20 WS-TRANSIT1              PIC X(4).
   167             20 WS-TRANSIT2              PIC X(4).
   168             20 WS-BKACCTI               PIC X(17).
   169         16 WS-ACTCDI                    PIC X(1).
   170
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   6
* EL6521.cbl
   172*    COPY ELCLOGOF.
   173******************************************************************
   174*                                                                *
   175*                                                                *
   176*                            ELCLOGOF.                           *
   177*                            VMOD=2.001                          *
   178*                                                                *
   179*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   180*                                                                *
   181******************************************************************
   182 01  CLASIC-LOGOFF.
   183     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   184     12  LOGOFF-TEXT.
   185         16  FILLER          PIC X(5)    VALUE SPACES.
   186         16  LOGOFF-MSG.
   187             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   188             20  FILLER      PIC X       VALUE SPACES.
   189             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   190         16  FILLER          PIC X(80)
   191           VALUE '* YOU ARE NOW LOGGED OFF'.
   192         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   193         16  FILLER          PIC X       VALUE QUOTE.
   194         16  LOGOFF-SYS-MSG  PIC X(17)
   195           VALUE 'S CLAS-IC SYSTEM '.
   196     12  TEXT-MESSAGES.
   197         16  UNACCESS-MSG    PIC X(29)
   198             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   199         16  PGMIDERR-MSG    PIC X(17)
   200             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   7
* EL6521.cbl
   202*    COPY ELCDATE.
   203******************************************************************
   204*                                                                *
   205*                                                                *
   206*                            ELCDATE.                            *
   207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   208*                            VMOD=2.003
   209*                                                                *
   210*                                                                *
   211*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   212*                 LENGTH = 200                                   *
   213******************************************************************
   214
   215 01  DATE-CONVERSION-DATA.
   216     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   217     12  DC-OPTION-CODE                PIC X.
   218         88  BIN-TO-GREG                VALUE ' '.
   219         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   220         88  EDIT-GREG-TO-BIN           VALUE '2'.
   221         88  YMD-GREG-TO-BIN            VALUE '3'.
   222         88  MDY-GREG-TO-BIN            VALUE '4'.
   223         88  JULIAN-TO-BIN              VALUE '5'.
   224         88  BIN-PLUS-ELAPSED           VALUE '6'.
   225         88  FIND-CENTURY               VALUE '7'.
   226         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   227         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   228         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   229         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   230         88  JULIAN-TO-BIN-3            VALUE 'C'.
   231         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   232         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   233         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   234         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   235         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   236         88  CHECK-LEAP-YEAR            VALUE 'H'.
   237         88  BIN-3-TO-GREG              VALUE 'I'.
   238         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   239         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   240         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   241         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   242         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   243         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   244         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   245         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   246         88  THREE-CHARACTER-BIN
   247                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   248         88  GREGORIAN-TO-BIN
   249                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   250         88  BIN-TO-GREGORIAN
   251                  VALUES ' ' '1' 'I' '8' 'G'.
   252         88  JULIAN-TO-BINARY
   253                  VALUES '5' 'C' 'E' 'F'.
   254     12  DC-ERROR-CODE                 PIC X.
   255         88  NO-CONVERSION-ERROR        VALUE ' '.
   256         88  DATE-CONVERSION-ERROR
   257                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   258         88  DATE-IS-ZERO               VALUE '1'.
   259         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   8
* EL6521.cbl
   260         88  DATE-IS-INVALID            VALUE '3'.
   261         88  DATE1-GREATER-DATE2        VALUE '4'.
   262         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   263         88  DATE-INVALID-OPTION        VALUE '9'.
   264         88  INVALID-CENTURY            VALUE 'A'.
   265         88  ONLY-CENTURY               VALUE 'B'.
   266         88  ONLY-LEAP-YEAR             VALUE 'C'.
   267         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   268     12  DC-END-OF-MONTH               PIC X.
   269         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   270     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   271         88  USE-NORMAL-PROCESS         VALUE ' '.
   272         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   273         88  ADJUST-UP-100-YRS          VALUE '2'.
   274     12  FILLER                        PIC X.
   275     12  DC-CONVERSION-DATES.
   276         16  DC-BIN-DATE-1             PIC XX.
   277         16  DC-BIN-DATE-2             PIC XX.
   278         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   279         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   280                       DC-GREG-DATE-1-EDIT.
   281             20  DC-EDIT1-MONTH        PIC 99.
   282             20  SLASH1-1              PIC X.
   283             20  DC-EDIT1-DAY          PIC 99.
   284             20  SLASH1-2              PIC X.
   285             20  DC-EDIT1-YEAR         PIC 99.
   286         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   287         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   288                     DC-GREG-DATE-2-EDIT.
   289             20  DC-EDIT2-MONTH        PIC 99.
   290             20  SLASH2-1              PIC X.
   291             20  DC-EDIT2-DAY          PIC 99.
   292             20  SLASH2-2              PIC X.
   293             20  DC-EDIT2-YEAR         PIC 99.
   294         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   295         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   296                     DC-GREG-DATE-1-YMD.
   297             20  DC-YMD-YEAR           PIC 99.
   298             20  DC-YMD-MONTH          PIC 99.
   299             20  DC-YMD-DAY            PIC 99.
   300         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   301         16  DC-GREG-DATE-1-MDY-R REDEFINES
   302                      DC-GREG-DATE-1-MDY.
   303             20  DC-MDY-MONTH          PIC 99.
   304             20  DC-MDY-DAY            PIC 99.
   305             20  DC-MDY-YEAR           PIC 99.
   306         16  DC-GREG-DATE-1-ALPHA.
   307             20  DC-ALPHA-MONTH        PIC X(10).
   308             20  DC-ALPHA-DAY          PIC 99.
   309             20  FILLER                PIC XX.
   310             20  DC-ALPHA-CENTURY.
   311                 24 DC-ALPHA-CEN-N     PIC 99.
   312             20  DC-ALPHA-YEAR         PIC 99.
   313         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   314         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   315         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   316         16  DC-JULIAN-DATE            PIC 9(05).
   317         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page   9
* EL6521.cbl
   318                                       PIC 9(05).
   319         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   320             20  DC-JULIAN-YEAR        PIC 99.
   321             20  DC-JULIAN-DAYS        PIC 999.
   322         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   323         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   324         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   325     12  DATE-CONVERSION-VARIBLES.
   326         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   327         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   328             20  FILLER                PIC 9(3).
   329             20  HOLD-CEN-1-CCYY.
   330                 24  HOLD-CEN-1-CC     PIC 99.
   331                 24  HOLD-CEN-1-YY     PIC 99.
   332             20  HOLD-CEN-1-MO         PIC 99.
   333             20  HOLD-CEN-1-DA         PIC 99.
   334         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   335             20  HOLD-CEN-1-R-MO       PIC 99.
   336             20  HOLD-CEN-1-R-DA       PIC 99.
   337             20  HOLD-CEN-1-R-CCYY.
   338                 24  HOLD-CEN-1-R-CC   PIC 99.
   339                 24  HOLD-CEN-1-R-YY   PIC 99.
   340             20  FILLER                PIC 9(3).
   341         16  HOLD-CENTURY-1-X.
   342             20  FILLER                PIC X(3)  VALUE SPACES.
   343             20  HOLD-CEN-1-X-CCYY.
   344                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   345                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   346             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   347             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   348         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   349             20  HOLD-CEN-1-R-X-MO     PIC XX.
   350             20  HOLD-CEN-1-R-X-DA     PIC XX.
   351             20  HOLD-CEN-1-R-X-CCYY.
   352                 24  HOLD-CEN-1-R-X-CC PIC XX.
   353                 24  HOLD-CEN-1-R-X-YY PIC XX.
   354             20  FILLER                PIC XXX.
   355         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   356         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   357         16  DC-JULIAN-DATE-1          PIC 9(07).
   358         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   359             20  DC-JULIAN-1-CCYY.
   360                 24  DC-JULIAN-1-CC    PIC 99.
   361                 24  DC-JULIAN-1-YR    PIC 99.
   362             20  DC-JULIAN-DA-1        PIC 999.
   363         16  DC-JULIAN-DATE-2          PIC 9(07).
   364         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   365             20  DC-JULIAN-2-CCYY.
   366                 24  DC-JULIAN-2-CC    PIC 99.
   367                 24  DC-JULIAN-2-YR    PIC 99.
   368             20  DC-JULIAN-DA-2        PIC 999.
   369         16  DC-GREG-DATE-A-EDIT.
   370             20  DC-EDITA-MONTH        PIC 99.
   371             20  SLASHA-1              PIC X VALUE '/'.
   372             20  DC-EDITA-DAY          PIC 99.
   373             20  SLASHA-2              PIC X VALUE '/'.
   374             20  DC-EDITA-CCYY.
   375                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  10
* EL6521.cbl
   376                 24  DC-EDITA-YEAR     PIC 99.
   377         16  DC-GREG-DATE-B-EDIT.
   378             20  DC-EDITB-MONTH        PIC 99.
   379             20  SLASHB-1              PIC X VALUE '/'.
   380             20  DC-EDITB-DAY          PIC 99.
   381             20  SLASHB-2              PIC X VALUE '/'.
   382             20  DC-EDITB-CCYY.
   383                 24  DC-EDITB-CENT     PIC 99.
   384                 24  DC-EDITB-YEAR     PIC 99.
   385         16  DC-GREG-DATE-CYMD         PIC 9(08).
   386         16  DC-GREG-DATE-CYMD-R REDEFINES
   387                              DC-GREG-DATE-CYMD.
   388             20  DC-CYMD-CEN           PIC 99.
   389             20  DC-CYMD-YEAR          PIC 99.
   390             20  DC-CYMD-MONTH         PIC 99.
   391             20  DC-CYMD-DAY           PIC 99.
   392         16  DC-GREG-DATE-MDCY         PIC 9(08).
   393         16  DC-GREG-DATE-MDCY-R REDEFINES
   394                              DC-GREG-DATE-MDCY.
   395             20  DC-MDCY-MONTH         PIC 99.
   396             20  DC-MDCY-DAY           PIC 99.
   397             20  DC-MDCY-CEN           PIC 99.
   398             20  DC-MDCY-YEAR          PIC 99.
   399    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   400        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   401    12  DC-EL310-DATE                  PIC X(21).
   402    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  11
* EL6521.cbl
   404*    COPY ELCATTR.
   405******************************************************************
   406*                                                                *
   407*                            ELCATTR.                            *
   408*                            VMOD=2.001                          *
   409*                                                                *
   410*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   411*                                                                *
   412*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   413*                                                                *
   414*                   POS 1   P=PROTECTED                          *
   415*                           U=UNPROTECTED                        *
   416*                           S=ASKIP                              *
   417*                   POS 2   A=ALPHA/NUMERIC                      *
   418*                           N=NUMERIC                            *
   419*                   POS 3   N=NORMAL                             *
   420*                           B=BRIGHT                             *
   421*                           D=DARK                               *
   422*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   423*                           OF=MODIFIED DATA TAG OFF             *
   424*                                                                *
   425*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   426******************************************************************
   427 01  ATTRIBUTE-LIST.
   428     12  AL-PABOF            PIC X       VALUE 'Y'.
   429     12  AL-PABON            PIC X       VALUE 'Z'.
   430     12  AL-PADOF            PIC X       VALUE '%'.
   431     12  AL-PADON            PIC X       VALUE '_'.
   432     12  AL-PANOF            PIC X       VALUE '-'.
   433     12  AL-PANON            PIC X       VALUE '/'.
   434     12  AL-SABOF            PIC X       VALUE '8'.
   435     12  AL-SABON            PIC X       VALUE '9'.
   436     12  AL-SADOF            PIC X       VALUE '@'.
   437     12  AL-SADON            PIC X       VALUE QUOTE.
   438     12  AL-SANOF            PIC X       VALUE '0'.
   439     12  AL-SANON            PIC X       VALUE '1'.
   440     12  AL-UABOF            PIC X       VALUE 'H'.
   441     12  AL-UABON            PIC X       VALUE 'I'.
   442     12  AL-UADOF            PIC X       VALUE '<'.
   443     12  AL-UADON            PIC X       VALUE '('.
   444     12  AL-UANOF            PIC X       VALUE ' '.
   445     12  AL-UANON            PIC X       VALUE 'A'.
   446     12  AL-UNBOF            PIC X       VALUE 'Q'.
   447     12  AL-UNBON            PIC X       VALUE 'R'.
   448     12  AL-UNDOF            PIC X       VALUE '*'.
   449     12  AL-UNDON            PIC X       VALUE ')'.
   450     12  AL-UNNOF            PIC X       VALUE '&'.
   451     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  12
* EL6521.cbl
   453*    COPY ELCEMIB.
   454******************************************************************
   455*                                                                *
   456*                                                                *
   457*                            ELCEMIB.                            *
   458*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   459*                            VMOD=2.005                          *
   460*                                                                *
   461*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   462*                                                                *
   463******************************************************************
   464 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   465     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   466     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   467     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   468     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   469     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   470     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   471     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   472     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   473     12  EMI-SWITCH1             PIC X        VALUE '1'.
   474         88  EMI-NO-ERRORS                    VALUE '1'.
   475         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   476         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   477     12  EMI-SWITCH2             PIC X        VALUE '1'.
   478         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   479     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   480         88  EMI-AREA1-EMPTY                  VALUE '1'.
   481         88  EMI-AREA1-FULL                   VALUE '2'.
   482     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   483         88  EMI-AREA2-EMPTY                  VALUE '1'.
   484         88  EMI-AREA2-FULL                   VALUE '2'.
   485     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   486         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   487         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   488         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   489         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   490         88  EMI-BYPASS-FATALS                VALUE 'X'.
   491     12  EMI-ERROR-LINES.
   492         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   493         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   494         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   495         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   496             20  EMI-ERR-CODES OCCURS 10 TIMES.
   497                 24  EMI-ERR-NUM         PIC X(4).
   498                 24  EMI-FILLER          PIC X.
   499                 24  EMI-SEV             PIC X.
   500                 24  FILLER              PIC X.
   501             20  FILLER                  PIC X(02).
   502     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   503         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   504             20  EMI-ERROR-NUMBER    PIC X(4).
   505             20  EMI-FILL            PIC X.
   506             20  EMI-SEVERITY        PIC X.
   507             20  FILLER              PIC X.
   508             20  EMI-ERROR-TEXT.
   509                 24  EMI-TEXT-VARIABLE   PIC X(10).
   510                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  13
* EL6521.cbl
   511     12  EMI-SEVERITY-SAVE           PIC X.
   512         88  EMI-NOTE                    VALUE 'N'.
   513         88  EMI-WARNING                 VALUE 'W'.
   514         88  EMI-FORCABLE                VALUE 'F'.
   515         88  EMI-FATAL                   VALUE 'X'.
   516     12  EMI-MESSAGE-FLAG            PIC X.
   517         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   518         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   519     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   520     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   521         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   522         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   523         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   524     12  FILLER                      PIC X(137)  VALUE SPACES.
   525     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   526     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   527     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   528     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  14
* EL6521.cbl
   530*    COPY ELCSCTM.
   531******************************************************************
   532*                                                                *
   533*                                                                *
   534*                            ELCSCTM                             *
   535*                            VMOD=2.001                          *
   536*                                                                *
   537*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   538*                                                                *
   539******************************************************************
   540 01  SECURITY-MESSAGE.
   541     12  FILLER                          PIC X(30)
   542            VALUE '** LOGIC SECURITY VIOLATION -'.
   543     12  SM-READ                         PIC X(6).
   544     12  FILLER                          PIC X(5)
   545            VALUE ' PGM='.
   546     12  SM-PGM                          PIC X(6).
   547     12  FILLER                          PIC X(5)
   548            VALUE ' OPR='.
   549     12  SM-PROCESSOR-ID                 PIC X(4).
   550     12  FILLER                          PIC X(6)
   551            VALUE ' TERM='.
   552     12  SM-TERMID                       PIC X(4).
   553     12  FILLER                          PIC XX   VALUE SPACE.
   554     12  SM-JUL-DATE                     PIC 9(5).
   555     12  FILLER                          PIC X    VALUE SPACE.
   556     12  SM-TIME                         PIC 99.99.
   557
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  15
* EL6521.cbl
   559*    COPY ELCSCRTY.
   560******************************************************************
   561*                                                                *
   562*                                                                *
   563*                            ELCSCRTY                            *
   564*                            VMOD=2.001                          *
   565*                                                                *
   566*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   567*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   568*        SAVED IN PI-SECURITY-ADDRESS.                           *
   569*                                                                *
   570******************************************************************
   571 01  SECURITY-CONTROL.
   572     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   573     12  FILLER                       PIC XX    VALUE 'SC'.
   574     12  SC-CREDIT-CODES.
   575         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   576             20  SC-CREDIT-DISPLAY    PIC X.
   577             20  SC-CREDIT-UPDATE     PIC X.
   578     12  SC-CLAIMS-CODES.
   579         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   580             20  SC-CLAIMS-DISPLAY    PIC X.
   581             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  16
* EL6521.cbl
   583*    COPY ELCINTF.
   584******************************************************************
   585*                                                                *
   586*                                                                *
   587*                            ELCINTF.                            *
   588*                            VMOD=2.017                          *
   589*                                                                *
   590*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   591*                                                                *
   592*       LENGTH = 1024                                            *
   593*                                                                *
   594******************************************************************
   595 01  PROGRAM-INTERFACE-BLOCK.
   596     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   597     12  PI-CALLING-PROGRAM              PIC X(8).
   598     12  PI-SAVED-PROGRAM-1              PIC X(8).
   599     12  PI-SAVED-PROGRAM-2              PIC X(8).
   600     12  PI-SAVED-PROGRAM-3              PIC X(8).
   601     12  PI-SAVED-PROGRAM-4              PIC X(8).
   602     12  PI-SAVED-PROGRAM-5              PIC X(8).
   603     12  PI-SAVED-PROGRAM-6              PIC X(8).
   604     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   605     12  PI-COMPANY-ID                   PIC XXX.
   606     12  PI-COMPANY-CD                   PIC X.
   607
   608     12  PI-COMPANY-PASSWORD             PIC X(8).
   609
   610     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   611
   612     12  PI-CONTROL-IN-PROGRESS.
   613         16  PI-CARRIER                  PIC X.
   614         16  PI-GROUPING                 PIC X(6).
   615         16  PI-STATE                    PIC XX.
   616         16  PI-ACCOUNT                  PIC X(10).
   617         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   618                                         PIC X(10).
   619         16  PI-CLAIM-CERT-GRP.
   620             20  PI-CLAIM-NO             PIC X(7).
   621             20  PI-CERT-NO.
   622                 25  PI-CERT-PRIME       PIC X(10).
   623                 25  PI-CERT-SFX         PIC X.
   624             20  PI-CERT-EFF-DT          PIC XX.
   625         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   626             20  PI-PLAN-CODE            PIC X(2).
   627             20  PI-REVISION-NUMBER      PIC X(3).
   628             20  PI-PLAN-EFF-DT          PIC X(2).
   629             20  PI-PLAN-EXP-DT          PIC X(2).
   630             20  FILLER                  PIC X(11).
   631         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   632             20  PI-OE-REFERENCE-1.
   633                 25  PI-OE-REF-1-PRIME   PIC X(18).
   634                 25  PI-OE-REF-1-SUFF    PIC XX.
   635
   636     12  PI-SESSION-IN-PROGRESS          PIC X.
   637         88  CLAIM-SESSION                   VALUE '1'.
   638         88  CREDIT-SESSION                  VALUE '2'.
   639         88  WARRANTY-SESSION                VALUE '3'.
   640         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  17
* EL6521.cbl
   641         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   642
   643
   644*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   645
   646     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   647     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   648
   649     12  PI-CREDIT-USER                  PIC X.
   650         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   651         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   652
   653     12  PI-CLAIM-USER                   PIC X.
   654         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   655         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   656
   657     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   658         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   659         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   660         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   661         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   662         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   663
   664     12  PI-PROCESSOR-ID                 PIC X(4).
   665
   666     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   667
   668     12  PI-MEMBER-CAPTION               PIC X(10).
   669
   670     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   671         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   672
   673     12  PI-LIFE-OVERRIDE-L1             PIC X.
   674     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   675     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   676     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   677
   678     12  PI-AH-OVERRIDE-L1               PIC X.
   679     12  PI-AH-OVERRIDE-L2               PIC XX.
   680     12  PI-AH-OVERRIDE-L6               PIC X(6).
   681     12  PI-AH-OVERRIDE-L12              PIC X(12).
   682
   683     12  PI-NEW-SYSTEM                   PIC X(2).
   684
   685     12  PI-PRIMARY-CERT-NO              PIC X(11).
   686     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   687         88  PI-USES-PAID-TO                 VALUE '1'.
   688     12  PI-CRDTCRD-SYSTEM.
   689         16  PI-CRDTCRD-USER             PIC X.
   690             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   691             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   692         16  PI-CC-MONTH-END-DT          PIC XX.
   693     12  PI-PROCESSOR-PRINTER            PIC X(4).
   694
   695     12  PI-OE-REFERENCE-2.
   696         16  PI-OE-REF-2-PRIME           PIC X(10).
   697         16  PI-OE-REF-2-SUFF            PIC X.
   698
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  18
* EL6521.cbl
   699     12  PI-REM-TRM-CALC-OPTION          PIC X.
   700
   701     12  PI-LANGUAGE-TYPE                PIC X.
   702             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   703             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   704             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   705
   706     12  PI-POLICY-LINKAGE-IND           PIC X.
   707         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   708         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   709                                                   LOW-VALUES.
   710
   711     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   712     12  PI-CLAIM-PW-SESSION             PIC X(1).
   713         88  PI-CLAIM-CREDIT                 VALUE '1'.
   714         88  PI-CLAIM-CONVEN                 VALUE '2'.
   715     12  FILLER                          PIC X(4).
   716
   717     12  PI-SYSTEM-LEVEL                 PIC X(145).
   718
   719     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   720         PI-SYSTEM-LEVEL.
   721
   722         16  PI-ENTRY-CODES.
   723             20  PI-ENTRY-CD-1           PIC X.
   724             20  PI-ENTRY-CD-2           PIC X.
   725
   726         16  PI-RETURN-CODES.
   727             20  PI-RETURN-CD-1          PIC X.
   728             20  PI-RETURN-CD-2          PIC X.
   729
   730         16  PI-UPDATE-STATUS-SAVE.
   731             20  PI-UPDATE-BY            PIC X(4).
   732             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   733
   734         16  PI-LOWER-CASE-LETTERS       PIC X.
   735             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   736
   737*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   738*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   739*            88  CARRIER-CLM-CNTL            VALUE '2'.
   740
   741         16  PI-CERT-ACCESS-CONTROL      PIC X.
   742             88  ST-ACCNT-CNTL               VALUE ' '.
   743             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   744             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   745             88  ACCNT-CNTL                  VALUE '3'.
   746             88  CARR-ACCNT-CNTL             VALUE '4'.
   747
   748         16  PI-PROCESSOR-CAP-LIST.
   749             20  PI-SYSTEM-CONTROLS.
   750                24 PI-SYSTEM-DISPLAY     PIC X.
   751                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   752                24 PI-SYSTEM-MODIFY      PIC X.
   753                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   754             20  FILLER                  PIC XX.
   755             20  PI-DISPLAY-CAP          PIC X.
   756                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  19
* EL6521.cbl
   757             20  PI-MODIFY-CAP           PIC X.
   758                 88  MODIFY-CAP              VALUE 'Y'.
   759             20  PI-MSG-AT-LOGON-CAP     PIC X.
   760                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   761             20  PI-FORCE-CAP            PIC X.
   762                 88  FORCE-CAP               VALUE 'Y'.
   763
   764         16  PI-PROGRAM-CONTROLS.
   765             20  PI-PGM-PRINT-OPT        PIC X.
   766             20  PI-PGM-FORMAT-OPT       PIC X.
   767             20  PI-PGM-PROCESS-OPT      PIC X.
   768             20  PI-PGM-TOTALS-OPT       PIC X.
   769
   770         16  PI-HELP-INTERFACE.
   771             20  PI-LAST-ERROR-NO        PIC X(4).
   772             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   773
   774         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   775             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   776
   777         16  PI-CR-CONTROL-IN-PROGRESS.
   778             20  PI-CR-CARRIER           PIC X.
   779             20  PI-CR-GROUPING          PIC X(6).
   780             20  PI-CR-STATE             PIC XX.
   781             20  PI-CR-ACCOUNT           PIC X(10).
   782             20  PI-CR-FIN-RESP          PIC X(10).
   783             20  PI-CR-TYPE              PIC X.
   784
   785         16  PI-CR-BATCH-NUMBER          PIC X(6).
   786
   787         16  PI-CR-MONTH-END-DT          PIC XX.
   788
   789         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   790             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   791             88  PI-ZERO-CARRIER             VALUE '1'.
   792             88  PI-ZERO-GROUPING            VALUE '2'.
   793             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   794
   795         16  PI-CARRIER-SECURITY         PIC X.
   796             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   797
   798         16  PI-ACCOUNT-SECURITY         PIC X(10).
   799             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   800             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   801
   802         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   803             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   804                                         INDEXED BY PI-ACCESS-NDX
   805                                         PIC X.
   806
   807         16  PI-GA-BILLING-CONTROL       PIC X.
   808             88  PI-GA-BILLING               VALUE '1'.
   809
   810         16  PI-MAIL-PROCESSING          PIC X.
   811             88  PI-MAIL-YES                 VALUE 'Y'.
   812
   813         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   814
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  20
* EL6521.cbl
   815         16  PI-AR-SYSTEM.
   816             20  PI-AR-PROCESSING-CNTL   PIC X.
   817                 88  PI-AR-PROCESSING        VALUE 'Y'.
   818             20  PI-AR-SUMMARY-CODE      PIC X(6).
   819             20  PI-AR-MONTH-END-DT      PIC XX.
   820
   821         16  PI-MP-SYSTEM.
   822             20  PI-MORTGAGE-USER            PIC X.
   823                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   824                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   825             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   826                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   827                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   828                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   829                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   830                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   831             20  PI-MP-MONTH-END-DT          PIC XX.
   832             20  PI-MP-REFERENCE-NO.
   833                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   834                 24  PI-MP-REFERENCE-SFX     PIC XX.
   835
   836         16  PI-LABEL-CONTROL            PIC X(01).
   837             88  PI-CREATE-LABELS                    VALUE 'Y'.
   838             88  PI-BYPASS-LABELS                    VALUE 'N'.
   839
   840         16  PI-BILL-GROUPING-CODE       PIC X(01).
   841             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   842
   843         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   844             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   845             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   846
   847         16  FILLER                      PIC X(14).
   848
   849     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   850******************************************************************
   851     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   852         16  PI-MAINT                PIC  X.
   853         16  PI-CHECK-TYPE           PIC  X.
   854         16  PI-CHECK-CARRY-BAL      PIC  X.
   855         16  PI-FIRST-TIME-SW        PIC  X.
   856             88  FIRST-TIME                  VALUE 'Y'.
   857         16  PI-ERCOMP-EOF-SW        PIC  X.
   858             88  ERCOMP-EOF                  VALUE 'Y'.
   859         16  PI-SAVE-PHONE           PIC  X(10).
   860         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
   861         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
   862         16  PI-ERCOMP-KEY.
   863             20  PI-ERC-GROUP-CD     PIC  X.
   864             20  PI-ERC-CARRIER      PIC  X.
   865             20  PI-ERC-GROUP        PIC  X(6).
   866             20  PI-ERC-RESP         PIC  X(10).
   867             20  PI-ERC-ACCT         PIC  X(10).
   868             20  PI-ERC-TYPE         PIC  X.
   869         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
   870         16  PI-BANK-TRANSIT-NUMBER.
   871             20  PI-BANK-COMPANY-CD  PIC X.
   872             20  PI-FEDERAL-NUMBER   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  21
* EL6521.cbl
   873             20  PI-BANK-NUMBER      PIC X(4).
   874         16  PI-BANK-ACCOUNT-NO      PIC X(17).
   875         16  PI-BANK-ACTION-CODE     PIC X.
   876         16  PI-ERCOBI-KEY.
   877             20  PI-ERCOBI-COMPANY-CD PIC X.
   878             20  PI-ERCOBI-STMT-OWNER PIC X(4).
   879             20  PI-ERCOBI-RGID      PIC X(12).
   880         16  PI-SAVE-ERCOBI-KEY      PIC X(17).
   881         16  FILLER                  PIC  X(500).
   882
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  22
* EL6521.cbl
   884*    COPY ELCAID.
   885******************************************************************
   886*                                                                *
   887*                            ELCAID.                             *
   888*                            VMOD=2.001                          *
   889*                                                                *
   890*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   891*                                                                *
   892*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   893*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   894******************************************************************
   895
   896 01  DFHAID.
   897   02  DFHNULL   PIC  X  VALUE  ' '.
   898   02  DFHENTER  PIC  X  VALUE  QUOTE.
   899   02  DFHCLEAR  PIC  X  VALUE  '_'.
   900   02  DFHPEN    PIC  X  VALUE  '='.
   901   02  DFHOPID   PIC  X  VALUE  'W'.
   902   02  DFHPA1    PIC  X  VALUE  '%'.
   903   02  DFHPA2    PIC  X  VALUE  '>'.
   904   02  DFHPA3    PIC  X  VALUE  ','.
   905   02  DFHPF1    PIC  X  VALUE  '1'.
   906   02  DFHPF2    PIC  X  VALUE  '2'.
   907   02  DFHPF3    PIC  X  VALUE  '3'.
   908   02  DFHPF4    PIC  X  VALUE  '4'.
   909   02  DFHPF5    PIC  X  VALUE  '5'.
   910   02  DFHPF6    PIC  X  VALUE  '6'.
   911   02  DFHPF7    PIC  X  VALUE  '7'.
   912   02  DFHPF8    PIC  X  VALUE  '8'.
   913   02  DFHPF9    PIC  X  VALUE  '9'.
   914   02  DFHPF10   PIC  X  VALUE  ':'.
   915   02  DFHPF11   PIC  X  VALUE  '#'.
   916   02  DFHPF12   PIC  X  VALUE  '@'.
   917   02  DFHPF13   PIC  X  VALUE  'A'.
   918   02  DFHPF14   PIC  X  VALUE  'B'.
   919   02  DFHPF15   PIC  X  VALUE  'C'.
   920   02  DFHPF16   PIC  X  VALUE  'D'.
   921   02  DFHPF17   PIC  X  VALUE  'E'.
   922   02  DFHPF18   PIC  X  VALUE  'F'.
   923   02  DFHPF19   PIC  X  VALUE  'G'.
   924   02  DFHPF20   PIC  X  VALUE  'H'.
   925   02  DFHPF21   PIC  X  VALUE  'I'.
   926*00039    02  DFHPF22   PIC  X  VALUE  ''.
   927   02  DFHPF22   PIC  X  VALUE  '['.
   928   02  DFHPF23   PIC  X  VALUE  '.'.
   929   02  DFHPF24   PIC  X  VALUE  '<'.
   930   02  DFHMSRE   PIC  X  VALUE  'X'.
   931   02  DFHSTRF   PIC  X  VALUE  'h'.
   932   02  DFHTRIG   PIC  X  VALUE  '"'.
   933 01  FILLER    REDEFINES DFHAID.
   934     12  FILLER                      PIC X(8).
   935     12  PF-VALUES                   PIC X       OCCURS 2.
   936
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  23
* EL6521.cbl
   938*    COPY EL6521S.
   939 01  EL6521AI.
   940     05  FILLER            PIC  X(0012).
   941*    -------------------------------
   942     05  DATEL PIC S9(0004) COMP.
   943     05  DATEF PIC  X(0001).
   944     05  FILLER REDEFINES DATEF.
   945         10  DATEA PIC  X(0001).
   946     05  DATEI PIC  X(0008).
   947*    -------------------------------
   948     05  TIMEL PIC S9(0004) COMP.
   949     05  TIMEF PIC  X(0001).
   950     05  FILLER REDEFINES TIMEF.
   951         10  TIMEA PIC  X(0001).
   952     05  TIMEI PIC  X(0005).
   953*    -------------------------------
   954     05  CMPNYIDL PIC S9(0004) COMP.
   955     05  CMPNYIDF PIC  X(0001).
   956     05  FILLER REDEFINES CMPNYIDF.
   957         10  CMPNYIDA PIC  X(0001).
   958     05  CMPNYIDI PIC  X(0003).
   959*    -------------------------------
   960     05  USERIDL PIC S9(0004) COMP.
   961     05  USERIDF PIC  X(0001).
   962     05  FILLER REDEFINES USERIDF.
   963         10  USERIDA PIC  X(0001).
   964     05  USERIDI PIC  X(0004).
   965*    -------------------------------
   966     05  MAINTYPL PIC S9(0004) COMP.
   967     05  MAINTYPF PIC  X(0001).
   968     05  FILLER REDEFINES MAINTYPF.
   969         10  MAINTYPA PIC  X(0001).
   970     05  MAINTYPI PIC  X(0001).
   971*    -------------------------------
   972     05  CARRIERL PIC S9(0004) COMP.
   973     05  CARRIERF PIC  X(0001).
   974     05  FILLER REDEFINES CARRIERF.
   975         10  CARRIERA PIC  X(0001).
   976     05  CARRIERI PIC  X(0001).
   977*    -------------------------------
   978     05  GROUPL PIC S9(0004) COMP.
   979     05  GROUPF PIC  X(0001).
   980     05  FILLER REDEFINES GROUPF.
   981         10  GROUPA PIC  X(0001).
   982     05  GROUPI PIC  X(0006).
   983*    -------------------------------
   984     05  TYPEL PIC S9(0004) COMP.
   985     05  TYPEF PIC  X(0001).
   986     05  FILLER REDEFINES TYPEF.
   987         10  TYPEA PIC  X(0001).
   988     05  TYPEI PIC  X(0001).
   989*    -------------------------------
   990     05  FINRESPL PIC S9(0004) COMP.
   991     05  FINRESPF PIC  X(0001).
   992     05  FILLER REDEFINES FINRESPF.
   993         10  FINRESPA PIC  X(0001).
   994     05  FINRESPI PIC  X(0010).
   995*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  24
* EL6521.cbl
   996     05  COACCTL PIC S9(0004) COMP.
   997     05  COACCTF PIC  X(0001).
   998     05  FILLER REDEFINES COACCTF.
   999         10  COACCTA PIC  X(0001).
  1000     05  COACCTI PIC  X(0010).
  1001*    -------------------------------
  1002     05  EFFDTL PIC S9(0004) COMP.
  1003     05  EFFDTF PIC  X(0001).
  1004     05  FILLER REDEFINES EFFDTF.
  1005         10  EFFDTA PIC  X(0001).
  1006     05  EFFDTI PIC  X(0008).
  1007*    -------------------------------
  1008     05  TRMDTL PIC S9(0004) COMP.
  1009     05  TRMDTF PIC  X(0001).
  1010     05  FILLER REDEFINES TRMDTF.
  1011         10  TRMDTA PIC  X(0001).
  1012     05  TRMDTI PIC  X(0008).
  1013*    -------------------------------
  1014     05  STATL PIC S9(0004) COMP.
  1015     05  STATF PIC  X(0001).
  1016     05  FILLER REDEFINES STATF.
  1017         10  STATA PIC  X(0001).
  1018     05  STATI PIC  X(0001).
  1019*    -------------------------------
  1020     05  WTHLDL PIC S9(0004) COMP.
  1021     05  WTHLDF PIC  X(0001).
  1022     05  FILLER REDEFINES WTHLDF.
  1023         10  WTHLDA PIC  X(0001).
  1024     05  WTHLDI PIC  S99V9999.
  1025*    -------------------------------
  1026     05  GADDL PIC S9(0004) COMP.
  1027     05  GADDF PIC  X(0001).
  1028     05  FILLER REDEFINES GADDF.
  1029         10  GADDA PIC  X(0001).
  1030     05  GADDI PIC  X(0001).
  1031*    -------------------------------
  1032     05  APCHKL PIC S9(0004) COMP.
  1033     05  APCHKF PIC  X(0001).
  1034     05  FILLER REDEFINES APCHKF.
  1035         10  APCHKA PIC  X(0001).
  1036     05  APCHKI PIC  X(0001).
  1037*    -------------------------------
  1038     05  MELSWL PIC S9(0004) COMP.
  1039     05  MELSWF PIC  X(0001).
  1040     05  FILLER REDEFINES MELSWF.
  1041         10  MELSWA PIC  X(0001).
  1042     05  MELSWI PIC  X(0001).
  1043*    -------------------------------
  1044     05  MDACTL PIC S9(0004) COMP.
  1045     05  MDACTF PIC  X(0001).
  1046     05  FILLER REDEFINES MDACTF.
  1047         10  MDACTA PIC  X(0001).
  1048     05  MDACTI PIC  X(0010).
  1049*    -------------------------------
  1050     05  MDDIVL PIC S9(0004) COMP.
  1051     05  MDDIVF PIC  X(0001).
  1052     05  FILLER REDEFINES MDDIVF.
  1053         10  MDDIVA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  25
* EL6521.cbl
  1054     05  MDDIVI PIC  X(0002).
  1055*    -------------------------------
  1056     05  MDCNTRL PIC S9(0004) COMP.
  1057     05  MDCNTRF PIC  X(0001).
  1058     05  FILLER REDEFINES MDCNTRF.
  1059         10  MDCNTRA PIC  X(0001).
  1060     05  MDCNTRI PIC  X(0004).
  1061*    -------------------------------
  1062     05  MDLOBL PIC S9(0004) COMP.
  1063     05  MDLOBF PIC  X(0001).
  1064     05  FILLER REDEFINES MDLOBF.
  1065         10  MDLOBA PIC  X(0001).
  1066     05  MDLOBI PIC  X(0006).
  1067*    -------------------------------
  1068     05  MDSTL PIC S9(0004) COMP.
  1069     05  MDSTF PIC  X(0001).
  1070     05  FILLER REDEFINES MDSTF.
  1071         10  MDSTA PIC  X(0001).
  1072     05  MDSTI PIC  X(0002).
  1073*    -------------------------------
  1074     05  MDAMTL PIC S9(0004) COMP.
  1075     05  MDAMTF PIC  X(0001).
  1076     05  FILLER REDEFINES MDAMTF.
  1077         10  MDAMTA PIC  X(0001).
  1078     05  MDAMTI PIC  S999999V99.
  1079*    -------------------------------
  1080     05  DELTOL PIC S9(0004) COMP.
  1081     05  DELTOF PIC  X(0001).
  1082     05  FILLER REDEFINES DELTOF.
  1083         10  DELTOA PIC  X(0001).
  1084     05  DELTOI PIC  X(0004).
  1085*    -------------------------------
  1086     05  RGIDL PIC S9(0004) COMP.
  1087     05  RGIDF PIC  X(0001).
  1088     05  FILLER REDEFINES RGIDF.
  1089         10  RGIDA PIC  X(0001).
  1090     05  RGIDI PIC  X(0012).
  1091*    -------------------------------
  1092     05  COMM1L PIC S9(0004) COMP.
  1093     05  COMM1F PIC  X(0001).
  1094     05  FILLER REDEFINES COMM1F.
  1095         10  COMM1A PIC  X(0001).
  1096     05  COMM1I PIC  X(0040).
  1097*    -------------------------------
  1098     05  COMM2L PIC S9(0004) COMP.
  1099     05  COMM2F PIC  X(0001).
  1100     05  FILLER REDEFINES COMM2F.
  1101         10  COMM2A PIC  X(0001).
  1102     05  COMM2I PIC  X(0040).
  1103*    -------------------------------
  1104     05  COMM3L PIC S9(0004) COMP.
  1105     05  COMM3F PIC  X(0001).
  1106     05  FILLER REDEFINES COMM3F.
  1107         10  COMM3A PIC  X(0001).
  1108     05  COMM3I PIC  X(0040).
  1109*    -------------------------------
  1110     05  COMM4L PIC S9(0004) COMP.
  1111     05  COMM4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  26
* EL6521.cbl
  1112     05  FILLER REDEFINES COMM4F.
  1113         10  COMM4A PIC  X(0001).
  1114     05  COMM4I PIC  X(0040).
  1115*    -------------------------------
  1116     05  BKLITL PIC S9(0004) COMP.
  1117     05  BKLITF PIC  X(0001).
  1118     05  FILLER REDEFINES BKLITF.
  1119         10  BKLITA PIC  X(0001).
  1120     05  BKLITI PIC  X(0023).
  1121*    -------------------------------
  1122     05  TRNSIT1L PIC S9(0004) COMP.
  1123     05  TRNSIT1F PIC  X(0001).
  1124     05  FILLER REDEFINES TRNSIT1F.
  1125         10  TRNSIT1A PIC  X(0001).
  1126     05  TRNSIT1I PIC  X(0004).
  1127*    -------------------------------
  1128     05  TRDASHL PIC S9(0004) COMP.
  1129     05  TRDASHF PIC  X(0001).
  1130     05  FILLER REDEFINES TRDASHF.
  1131         10  TRDASHA PIC  X(0001).
  1132     05  TRDASHI PIC  X(0001).
  1133*    -------------------------------
  1134     05  TRNSIT2L PIC S9(0004) COMP.
  1135     05  TRNSIT2F PIC  X(0001).
  1136     05  FILLER REDEFINES TRNSIT2F.
  1137         10  TRNSIT2A PIC  X(0001).
  1138     05  TRNSIT2I PIC  X(0004).
  1139*    -------------------------------
  1140     05  BKDESCL PIC S9(0004) COMP.
  1141     05  BKDESCF PIC  X(0001).
  1142     05  FILLER REDEFINES BKDESCF.
  1143         10  BKDESCA PIC  X(0001).
  1144     05  BKDESCI PIC  X(0023).
  1145*    -------------------------------
  1146     05  BKACCTL PIC S9(0004) COMP.
  1147     05  BKACCTF PIC  X(0001).
  1148     05  FILLER REDEFINES BKACCTF.
  1149         10  BKACCTA PIC  X(0001).
  1150     05  BKACCTI PIC  X(0017).
  1151*    -------------------------------
  1152     05  ACTLITL PIC S9(0004) COMP.
  1153     05  ACTLITF PIC  X(0001).
  1154     05  FILLER REDEFINES ACTLITF.
  1155         10  ACTLITA PIC  X(0001).
  1156     05  ACTLITI PIC  X(0023).
  1157*    -------------------------------
  1158     05  ACTCDL PIC S9(0004) COMP.
  1159     05  ACTCDF PIC  X(0001).
  1160     05  FILLER REDEFINES ACTCDF.
  1161         10  ACTCDA PIC  X(0001).
  1162     05  ACTCDI PIC  X(0001).
  1163*    -------------------------------
  1164     05  CRSLITL PIC S9(0004) COMP.
  1165     05  CRSLITF PIC  X(0001).
  1166     05  FILLER REDEFINES CRSLITF.
  1167         10  CRSLITA PIC  X(0001).
  1168     05  CRSLITI PIC  X(0017).
  1169*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  27
* EL6521.cbl
  1170     05  CRSTATL PIC S9(0004) COMP.
  1171     05  CRSTATF PIC  X(0001).
  1172     05  FILLER REDEFINES CRSTATF.
  1173         10  CRSTATA PIC  X(0001).
  1174     05  CRSTATI PIC  X(0010).
  1175*    -------------------------------
  1176     05  ERRMSG1L PIC S9(0004) COMP.
  1177     05  ERRMSG1F PIC  X(0001).
  1178     05  FILLER REDEFINES ERRMSG1F.
  1179         10  ERRMSG1A PIC  X(0001).
  1180     05  ERRMSG1I PIC  X(0071).
  1181*    -------------------------------
  1182     05  ERRMSG2L PIC S9(0004) COMP.
  1183     05  ERRMSG2F PIC  X(0001).
  1184     05  FILLER REDEFINES ERRMSG2F.
  1185         10  ERRMSG2A PIC  X(0001).
  1186     05  ERRMSG2I PIC  X(0071).
  1187*    -------------------------------
  1188     05  PFENTERL PIC S9(0004) COMP.
  1189     05  PFENTERF PIC  X(0001).
  1190     05  FILLER REDEFINES PFENTERF.
  1191         10  PFENTERA PIC  X(0001).
  1192     05  PFENTERI PIC  99.
  1193*    -------------------------------
  1194     05  ACHPF1L PIC S9(0004) COMP.
  1195     05  ACHPF1F PIC  X(0001).
  1196     05  FILLER REDEFINES ACHPF1F.
  1197         10  ACHPF1A PIC  X(0001).
  1198     05  ACHPF1I PIC  X(0015).
  1199 01  EL6521AO REDEFINES EL6521AI.
  1200     05  FILLER            PIC  X(0012).
  1201*    -------------------------------
  1202     05  FILLER            PIC  X(0003).
  1203     05  DATEO PIC  X(0008).
  1204*    -------------------------------
  1205     05  FILLER            PIC  X(0003).
  1206     05  TIMEO PIC  99.99.
  1207*    -------------------------------
  1208     05  FILLER            PIC  X(0003).
  1209     05  CMPNYIDO PIC  X(0003).
  1210*    -------------------------------
  1211     05  FILLER            PIC  X(0003).
  1212     05  USERIDO PIC  X(0004).
  1213*    -------------------------------
  1214     05  FILLER            PIC  X(0003).
  1215     05  MAINTYPO PIC  X(0001).
  1216*    -------------------------------
  1217     05  FILLER            PIC  X(0003).
  1218     05  CARRIERO PIC  X(0001).
  1219*    -------------------------------
  1220     05  FILLER            PIC  X(0003).
  1221     05  GROUPO PIC  X(0006).
  1222*    -------------------------------
  1223     05  FILLER            PIC  X(0003).
  1224     05  TYPEO PIC  X(0001).
  1225*    -------------------------------
  1226     05  FILLER            PIC  X(0003).
  1227     05  FINRESPO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  28
* EL6521.cbl
  1228*    -------------------------------
  1229     05  FILLER            PIC  X(0003).
  1230     05  COACCTO PIC  X(0010).
  1231*    -------------------------------
  1232     05  FILLER            PIC  X(0003).
  1233     05  EFFDTO PIC  X(0008).
  1234*    -------------------------------
  1235     05  FILLER            PIC  X(0003).
  1236     05  TRMDTO PIC  X(0008).
  1237*    -------------------------------
  1238     05  FILLER            PIC  X(0003).
  1239     05  STATO PIC  X(0001).
  1240*    -------------------------------
  1241     05  FILLER            PIC  X(0003).
  1242     05  WTHLDO PIC  Z.9999.
  1243*    -------------------------------
  1244     05  FILLER            PIC  X(0003).
  1245     05  GADDO PIC  X(0001).
  1246*    -------------------------------
  1247     05  FILLER            PIC  X(0003).
  1248     05  APCHKO PIC  X(0001).
  1249*    -------------------------------
  1250     05  FILLER            PIC  X(0003).
  1251     05  MELSWO PIC  X(0001).
  1252*    -------------------------------
  1253     05  FILLER            PIC  X(0003).
  1254     05  MDACTO PIC  X(0010).
  1255*    -------------------------------
  1256     05  FILLER            PIC  X(0003).
  1257     05  MDDIVO PIC  X(0002).
  1258*    -------------------------------
  1259     05  FILLER            PIC  X(0003).
  1260     05  MDCNTRO PIC  X(0004).
  1261*    -------------------------------
  1262     05  FILLER            PIC  X(0003).
  1263     05  MDLOBO PIC  X(0006).
  1264*    -------------------------------
  1265     05  FILLER            PIC  X(0003).
  1266     05  MDSTO PIC  X(0002).
  1267*    -------------------------------
  1268     05  FILLER            PIC  X(0003).
  1269     05  MDAMTO PIC  ZZZZZ.99.
  1270*    -------------------------------
  1271     05  FILLER            PIC  X(0003).
  1272     05  DELTOO PIC  X(0004).
  1273*    -------------------------------
  1274     05  FILLER            PIC  X(0003).
  1275     05  RGIDO PIC  X(0012).
  1276*    -------------------------------
  1277     05  FILLER            PIC  X(0003).
  1278     05  COMM1O PIC  X(0040).
  1279*    -------------------------------
  1280     05  FILLER            PIC  X(0003).
  1281     05  COMM2O PIC  X(0040).
  1282*    -------------------------------
  1283     05  FILLER            PIC  X(0003).
  1284     05  COMM3O PIC  X(0040).
  1285*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  29
* EL6521.cbl
  1286     05  FILLER            PIC  X(0003).
  1287     05  COMM4O PIC  X(0040).
  1288*    -------------------------------
  1289     05  FILLER            PIC  X(0003).
  1290     05  BKLITO PIC  X(0023).
  1291*    -------------------------------
  1292     05  FILLER            PIC  X(0003).
  1293     05  TRNSIT1O PIC  X(0004).
  1294*    -------------------------------
  1295     05  FILLER            PIC  X(0003).
  1296     05  TRDASHO PIC  X(0001).
  1297*    -------------------------------
  1298     05  FILLER            PIC  X(0003).
  1299     05  TRNSIT2O PIC  X(0004).
  1300*    -------------------------------
  1301     05  FILLER            PIC  X(0003).
  1302     05  BKDESCO PIC  X(0023).
  1303*    -------------------------------
  1304     05  FILLER            PIC  X(0003).
  1305     05  BKACCTO PIC  X(0017).
  1306*    -------------------------------
  1307     05  FILLER            PIC  X(0003).
  1308     05  ACTLITO PIC  X(0023).
  1309*    -------------------------------
  1310     05  FILLER            PIC  X(0003).
  1311     05  ACTCDO PIC  X(0001).
  1312*    -------------------------------
  1313     05  FILLER            PIC  X(0003).
  1314     05  CRSLITO PIC  X(0017).
  1315*    -------------------------------
  1316     05  FILLER            PIC  X(0003).
  1317     05  CRSTATO PIC  X(0010).
  1318*    -------------------------------
  1319     05  FILLER            PIC  X(0003).
  1320     05  ERRMSG1O PIC  X(0071).
  1321*    -------------------------------
  1322     05  FILLER            PIC  X(0003).
  1323     05  ERRMSG2O PIC  X(0071).
  1324*    -------------------------------
  1325     05  FILLER            PIC  X(0003).
  1326     05  PFENTERO PIC  99.
  1327*    -------------------------------
  1328     05  FILLER            PIC  X(0003).
  1329     05  ACHPF1O PIC  X(0015).
  1330*    -------------------------------
  1331
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  30
* EL6521.cbl
  1333****************************************************************
  1334*
  1335* Copyright (c) 2007 by Clerity Solutions, Inc.
  1336* All rights reserved.
  1337*
  1338****************************************************************
  1339 01  DFHEIV.
  1340   02  DFHEIV0               PIC X(35).
  1341   02  DFHEIV1               PIC X(08).
  1342   02  DFHEIV2               PIC X(08).
  1343   02  DFHEIV3               PIC X(08).
  1344   02  DFHEIV4               PIC X(06).
  1345   02  DFHEIV5               PIC X(04).
  1346   02  DFHEIV6               PIC X(04).
  1347   02  DFHEIV7               PIC X(02).
  1348   02  DFHEIV8               PIC X(02).
  1349   02  DFHEIV9               PIC X(01).
  1350   02  DFHEIV10              PIC S9(7) COMP-3.
  1351   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1352   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1353   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1354   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1355   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1356   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1357   02  DFHEIV17              PIC X(04).
  1358   02  DFHEIV18              PIC X(04).
  1359   02  DFHEIV19              PIC X(04).
  1360   02  DFHEIV20              USAGE IS POINTER.
  1361   02  DFHEIV21              USAGE IS POINTER.
  1362   02  DFHEIV22              USAGE IS POINTER.
  1363   02  DFHEIV23              USAGE IS POINTER.
  1364   02  DFHEIV24              USAGE IS POINTER.
  1365   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1366   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1367   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1368   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1369   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1370   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1371   02  FILLER                PIC X(02).
  1372   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1373   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1374   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1375   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1376   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1377 LINKAGE  SECTION.
  1378*****************************************************************
  1379*                                                               *
  1380* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1381* All rights reserved.                                          *
  1382*                                                               *
  1383*****************************************************************
  1384 01  dfheiblk.
  1385     02  eibtime          pic s9(7) comp-3.
  1386     02  eibdate          pic s9(7) comp-3.
  1387     02  eibtrnid         pic x(4).
  1388     02  eibtaskn         pic s9(7) comp-3.
  1389     02  eibtrmid         pic x(4).
  1390     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  31
* EL6521.cbl
  1391     02  eibcposn         pic s9(4) comp.
  1392     02  eibcalen         pic s9(4) comp.
  1393     02  eibaid           pic x(1).
  1394     02  eibfiller1       pic x(1).
  1395     02  eibfn            pic x(2).
  1396     02  eibfiller2       pic x(2).
  1397     02  eibrcode         pic x(6).
  1398     02  eibfiller3       pic x(2).
  1399     02  eibds            pic x(8).
  1400     02  eibreqid         pic x(8).
  1401     02  eibrsrce         pic x(8).
  1402     02  eibsync          pic x(1).
  1403     02  eibfree          pic x(1).
  1404     02  eibrecv          pic x(1).
  1405     02  eibsend          pic x(1).
  1406     02  eibatt           pic x(1).
  1407     02  eibeoc           pic x(1).
  1408     02  eibfmh           pic x(1).
  1409     02  eibcompl         pic x(1).
  1410     02  eibsig           pic x(1).
  1411     02  eibconf          pic x(1).
  1412     02  eiberr           pic x(1).
  1413     02  eibrldbk         pic x(1).
  1414     02  eiberrcd         pic x(4).
  1415     02  eibsynrb         pic x(1).
  1416     02  eibnodat         pic x(1).
  1417     02  eibfiller5       pic x(2).
  1418     02  eibresp          pic 9(09) comp.
  1419     02  eibresp2         pic 9(09) comp.
  1420     02  dfheigdj         pic s9(4) comp.
  1421     02  dfheigdk         pic s9(4) comp.
  1422 01  DFHCOMMAREA                     PIC X(1024).
  1423
  1424*    COPY ERCCOMP.
  1425******************************************************************
  1426*                                                                *
  1427*                                                                *
  1428*                            ERCCOMP                             *
  1429*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1430*                            VMOD=2.019                          *
  1431*                                                                *
  1432*   ONLINE CREDIT SYSTEM                                         *
  1433*                                                                *
  1434*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1435*                                                                *
  1436*   FILE TYPE = VSAM,KSDS                                        *
  1437*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1438*                                                                *
  1439*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1440*       ALTERNATE PATH = NONE                                    *
  1441*                                                                *
  1442*   LOG = NO                                                     *
  1443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1444*                                                                *
  1445******************************************************************
  1446*                   C H A N G E   L O G
  1447*
  1448* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  32
* EL6521.cbl
  1449*-----------------------------------------------------------------
  1450*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1451* EFFECTIVE    NUMBER
  1452*-----------------------------------------------------------------
  1453* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1454* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1455* 092205    2005050300006  PEMA  ADD LEASE FEE
  1456* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1457* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1458* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1459* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1460* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1461******************************************************************
  1462
  1463 01  COMPENSATION-MASTER.
  1464     12  CO-RECORD-ID                          PIC XX.
  1465         88  VALID-CO-ID                          VALUE 'CO'.
  1466
  1467     12  CO-CONTROL-PRIMARY.
  1468         16  CO-COMPANY-CD                     PIC X.
  1469         16  CO-CONTROL.
  1470             20  CO-CTL-1.
  1471                 24  CO-CARR-GROUP.
  1472                     28  CO-CARRIER            PIC X.
  1473                     28  CO-GROUPING.
  1474                         32  CO-GROUP-PREFIX   PIC XXX.
  1475                         32  CO-GROUP-PRIME    PIC XXX.
  1476                 24  CO-RESP-NO.
  1477                     28  CO-RESP-PREFIX        PIC X(4).
  1478                     28  CO-RESP-PRIME         PIC X(6).
  1479             20  CO-CTL-2.
  1480                 24  CO-ACCOUNT.
  1481                     28  CO-ACCT-PREFIX        PIC X(4).
  1482                     28  CO-ACCT-PRIME         PIC X(6).
  1483         16  CO-TYPE                           PIC X.
  1484             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1485             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1486             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1487
  1488     12  CO-MAINT-INFORMATION.
  1489         16  CO-LAST-MAINT-DT                  PIC XX.
  1490         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1491         16  CO-LAST-MAINT-USER                PIC X(4).
  1492     12  FILLER                                PIC XX.
  1493     12  CO-STMT-TYPE                          PIC XXX.
  1494     12  CO-COMP-TYPE                          PIC X.
  1495         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1496     12  CO-STMT-OWNER                         PIC X(4).
  1497     12  CO-BALANCE-CONTROL                    PIC X.
  1498         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1499         88  CO-NO-BALANCE                        VALUE 'N'.
  1500
  1501     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1502         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1503         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1504         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1505
  1506     12  CO-INTERNAL-CONTROL-2                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  33
* EL6521.cbl
  1507         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1508         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1509
  1510     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1511     12  CO-GA-DIRECT-DEP                      PIC X.
  1512     12  CO-FUTURE-SPACE                       PIC X.
  1513         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1514
  1515     12  CO-ACCT-NAME                          PIC X(30).
  1516     12  CO-MAIL-NAME                          PIC X(30).
  1517     12  CO-ADDR-1                             PIC X(30).
  1518     12  CO-ADDR-2                             PIC X(30).
  1519     12  CO-ADDR-3.
  1520         16  CO-ADDR-CITY                      PIC X(27).
  1521         16  CO-ADDR-STATE                     PIC XX.
  1522     12  CO-CSO-1099                           PIC X.
  1523     12  CO-ZIP.
  1524         16  CO-ZIP-PRIME.
  1525             20  CO-ZIP-PRI-1ST                PIC X.
  1526                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1527             20  FILLER                        PIC X(4).
  1528         16  CO-ZIP-PLUS4                      PIC X(4).
  1529     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1530         16  CO-CAN-POSTAL-1                   PIC XXX.
  1531         16  CO-CAN-POSTAL-2                   PIC XXX.
  1532         16  FILLER                            PIC XXX.
  1533     12  CO-SOC-SEC                            PIC X(13).
  1534     12  CO-TELEPHONE.
  1535         16  CO-AREA-CODE                      PIC XXX.
  1536         16  CO-PREFIX                         PIC XXX.
  1537         16  CO-PHONE                          PIC X(4).
  1538
  1539     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1540
  1541     12  CO-AR-BAL-LEVEL                       PIC X.
  1542         88  CO-AR-REF-LVL                        VALUE '1'.
  1543         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1544         88  CO-AR-BILL-LVL                       VALUE '2'.
  1545         88  CO-AR-AGT-LVL                        VALUE '3'.
  1546         88  CO-AR-FR-LVL                         VALUE '4'.
  1547
  1548     12  CO-AR-NORMAL-PRINT                    PIC X.
  1549         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1550         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1551
  1552     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1553
  1554     12  CO-AR-REPORTING                       PIC X.
  1555         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1556         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1557
  1558     12  CO-AR-PULL-CHECK                      PIC X.
  1559         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1560         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1561
  1562     12  CO-AR-BALANCE-PRINT                   PIC X.
  1563         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1564
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  34
* EL6521.cbl
  1565     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1566         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1567         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1568         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1569
  1570     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1571
  1572     12  CO-USER-CODE                          PIC X.
  1573     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1574
  1575******************************************************************
  1576*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1577*    THE LAST MONTH END RUN.
  1578******************************************************************
  1579
  1580     12  CO-LAST-ACTIVITY-DATE.
  1581         16  CO-ACT-YEAR                       PIC 99.
  1582         16  CO-ACT-MONTH                      PIC 99.
  1583         16  CO-ACT-DAY                        PIC 99.
  1584
  1585     12  CO-LAST-STMT-DT.
  1586         16  CO-LAST-STMT-YEAR                 PIC 99.
  1587         16  CO-LAST-STMT-MONTH                PIC 99.
  1588         16  CO-LAST-STMT-DAY                  PIC 99.
  1589
  1590     12  CO-MO-END-TOTALS.
  1591         16  CO-MONTHLY-TOTALS.
  1592             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1593             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1594             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1595             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1596             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1597
  1598         16  CO-AGING-TOTALS.
  1599             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1600             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1601             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1602             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1603
  1604         16  CO-YTD-TOTALS.
  1605             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1606             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1607
  1608         16  CO-OVER-UNDER-TOTALS.
  1609             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1610             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1611
  1612     12  CO-MISCELLANEOUS-TOTALS.
  1613         16  CO-FICA-TOTALS.
  1614             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1615             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1616
  1617         16  CO-CLAIM-TOTALS.
  1618             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1619             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1620
  1621******************************************************************
  1622*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  35
* EL6521.cbl
  1623*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1624******************************************************************
  1625
  1626     12  CO-CURRENT-TOTALS.
  1627         16  CO-CURRENT-LAST-STMT-DT.
  1628             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1629             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1630             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1631
  1632         16  CO-CURRENT-MONTHLY-TOTALS.
  1633             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1634             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1635             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1636             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1637             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1638
  1639         16  CO-CURRENT-AGING-TOTALS.
  1640             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1641             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1642             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1643             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1644
  1645         16  CO-CURRENT-YTD-TOTALS.
  1646             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1647             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1648
  1649     12  CO-PAID-COMM-TOTALS.
  1650         16  CO-YTD-PAID-COMMS.
  1651             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1652             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1653
  1654     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1655         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1656         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1657
  1658     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1659         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1660         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1661         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1662         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1663         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1664         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1665         88  CO-FINAL-LETTER                  VALUE 'F'.
  1666         88  CO-RECONCILING                   VALUE 'R'.
  1667         88  CO-PHONE-CALL                    VALUE 'P'.
  1668         88  CO-LEGAL                         VALUE 'L'.
  1669         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1670         88  CO-WRITE-OFF                     VALUE 'W'.
  1671         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1672
  1673     12  CO-CSR-CODE                       PIC X(4).
  1674
  1675     12  CO-GA-STATUS-INFO.
  1676         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1677         16  CO-GA-TERMINATION-DT          PIC XX.
  1678         16  CO-GA-STATUS-CODE             PIC X.
  1679             88  CO-GA-ACTIVE                 VALUE 'A'.
  1680             88  CO-GA-INACTIVE               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  36
* EL6521.cbl
  1681             88  CO-GA-PENDING                VALUE 'P'.
  1682         16  CO-GA-COMMENTS.
  1683             20  CO-GA-COMMENT-1           PIC X(40).
  1684             20  CO-GA-COMMENT-2           PIC X(40).
  1685             20  CO-GA-COMMENT-3           PIC X(40).
  1686             20  CO-GA-COMMENT-4           PIC X(40).
  1687
  1688     12  CO-RPTCD2                         PIC X(10).
  1689
  1690     12  CO-TYPE-AGENT                     PIC X(01).
  1691         88  CO-CORPORATION                   VALUE 'C'.
  1692         88  CO-PARTNERSHIP                   VALUE 'P'.
  1693         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1694         88  CO-TRUST                         VALUE 'T'.
  1695         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1696
  1697     12  CO-FAXNO.
  1698         16  CO-FAX-AREA-CODE                  PIC XXX.
  1699         16  CO-FAX-PREFIX                     PIC XXX.
  1700         16  CO-FAX-PHONE                      PIC X(4).
  1701
  1702     12  CO-BANK-INFORMATION.
  1703         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1704         16  CO-BANK-TRANSIT-NON REDEFINES
  1705             CO-BANK-TRANSIT-NO                PIC 9(8).
  1706
  1707         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1708     12  CO-MISC-DEDUCT-INFO REDEFINES
  1709                  CO-BANK-INFORMATION.
  1710         16  CO-MD-GL-ACCT                     PIC X(10).
  1711         16  CO-MD-DIV                         PIC XX.
  1712         16  CO-MD-CENTER                      PIC X(4).
  1713         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1714         16  CO-CREATE-AP-CHECK                PIC X.
  1715         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1716         16  FILLER                            PIC XXX.
  1717     12  CO-ACH-STATUS                         PIC X.
  1718         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1719         88  CO-ACH-PENDING                        VALUE 'P'.
  1720
  1721     12  CO-BILL-SW                            PIC X.
  1722     12  CO-CONTROL-NAME                       PIC X(30).
  1723     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1724     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1725     12  CO-CLP-STATE                          PIC XX.
  1726     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1727     12  CO-SPP-REFUND-EDIT                    PIC X.
  1728
  1729******************************************************************
  1730*    COPY ERCCOBI.
  1731******************************************************************
  1732*                                                                *
  1733*                                                                *
  1734*                            ERCCOBI                             *
  1735*                                                                *
  1736*   ONLINE CREDIT SYSTEM                                         *
  1737*                                                                *
  1738*   FILE DESCRIPTION = COMPENSATION MASTER BILLING INSTRUCTIONS  *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  37
* EL6521.cbl
  1739*                                                                *
  1740*   FILE TYPE = VSAM,KSDS                                        *
  1741*   RECORD SIZE = 620   RECFORM = FIXED                          *
  1742*                                                                *
  1743*   BASE CLUSTER NAME = ERCOBI                   RKP=2,LEN=17    *
  1744*       ALTERNATE PATH = NONE                                    *
  1745*                                                                *
  1746*   LOG = NO                                                     *
  1747*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1748*                                                                *
  1749******************************************************************
  1750*                   C H A N G E   L O G
  1751*
  1752* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1753*-----------------------------------------------------------------
  1754*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1755* EFFECTIVE    NUMBER
  1756*-----------------------------------------------------------------
  1757* 081808    2008061100001  PEMA  NEW FILE FOR BILLING INSTRUCTIONS
  1758******************************************************************
  1759 01  COMP-BILLING-INSTRUCTIONS.
  1760     12  BL-RECORD-ID                          PIC XX.
  1761         88  VALID-BL-ID                          VALUE 'BL'.
  1762     12  BL-CONTROL-PRIMARY.
  1763         16  BL-COMPANY-CD                     PIC X.
  1764         16  BL-STMT-OWNER                     PIC X(4).
  1765         16  BL-REPORT-GROUP-ID                PIC X(12).
  1766     12  BL-MAINT-INFORMATION.
  1767         16  BL-LAST-MAINT-DT                  PIC XX.
  1768         16  BL-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1769         16  BL-LAST-MAINT-USER                PIC X(4).
  1770         16  FILLER                            PIC X(10).
  1771     12  BL-ACCOUNT-NAME                       PIC X(35).
  1772     12  BL-CONTACT-NAME                       PIC X(35).
  1773     12  BL-ADDR1                              PIC X(30).
  1774     12  BL-ADDR2                              PIC X(30).
  1775     12  BL-CITY                               PIC X(30).
  1776     12  BL-STATE                              PIC XX.
  1777     12  BL-ZIP.
  1778         16  BL-ZIP-PRIME.
  1779             20  BL-ZIP-PRI-1ST                PIC X.
  1780                 88  BL-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1781             20  FILLER                        PIC X(4).
  1782         16  BL-ZIP-PLUS4                      PIC X(4).
  1783     12  BL-CANADIAN-POSTAL-CODE  REDEFINES  BL-ZIP.
  1784         16  BL-CAN-POSTAL-1                   PIC XXX.
  1785         16  BL-CAN-POSTAL-2                   PIC XXX.
  1786         16  FILLER                            PIC XXX.
  1787*    12  FILLER                                PIC X(30).
  1788     12  BL-CHECK-HANDLING                     PIC X.
  1789         88  BL-CHECKS-NET                VALUE '1' ' '.
  1790         88  BL-CHECKS-SEPARATE           VALUE '2'.
  1791     12  BL-SPECIAL-INSTRUCTIONS.
  1792         16  BL-SI-LINE-1                      PIC X(70).
  1793         16  BL-SI-LINE-2                      PIC X(70).
  1794         16  BL-SI-LINE-3                      PIC X(70).
  1795         16  BL-SI-LINE-4                      PIC X(70).
  1796         16  BL-SI-LINE-5                      PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  38
* EL6521.cbl
  1797     12  FILLER                                PIC X(59).
  1798
  1799******************************************************************
  1800*    COPY ELCACHP.
  1801******************************************************************
  1802*                                                                *
  1803*                           ELCACHP                              *
  1804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1805*                            VMOD=2.002                          *
  1806*                                                                *
  1807*   FILE DESCRIPTION = ACH PRE-NOTIFICATION                      *
  1808*                                                                *
  1809*   FILE TYPE = VSAM,KSDS                                        *
  1810*   RECORD SIZE = 120  RECFORM = FIXED                           *
  1811*                                                                *
  1812*   BASE CLUSTER = ELACHP                         RKP=2,LEN=29   *
  1813*       ALTERNATE (NONE)                                         *
  1814*                                                                *
  1815*   LOG = YES                                                    *
  1816*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1817*                                                                *
  1818*  NO  CID  MODS  IN  COPYBOOK  ELCACHP                          *
  1819******************************************************************
  1820
  1821 01  ACH-PRENOTIFICATION.
  1822     12  AP-RECORD-ID                      PIC XX.
  1823         88  VALID-AP-ID                      VALUE 'AP'.
  1824
  1825******************************************************************
  1826*   BASE CLUSTER = ELACHP         (BASE KEY)      RKP=2,LEN=29   *
  1827******************************************************************
  1828
  1829     12  AP-CONTROL-PRIMARY.
  1830         16  AP-CONTROL-CD                 PIC X.
  1831         16  AP-CARRIER                    PIC X.
  1832         16  AP-GROUPING                   PIC X(6).
  1833         16  AP-FIN-RESP                   PIC X(10).
  1834         16  AP-ACCT-AGENT                 PIC X(10).
  1835         16  AP-CO-TYPE                    PIC X.
  1836
  1837     12  AP-CONTROL-ALT   REDEFINES  AP-CONTROL-PRIMARY.
  1838         16  AP-COMPANY-CD-ALT             PIC X.
  1839         16  AP-BENEFICIARY                PIC X(10).
  1840         16  FILLER                        PIC X(18).
  1841
  1842******************************************************************
  1843*                 FILE SYNCHRONIZATION DATA                      *
  1844******************************************************************
  1845
  1846     12  AP-FILE-SYNCH-DATA.
  1847         16  AP-LAST-CHANGE-DT             PIC XX.
  1848         16  AP-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1849         16  AP-LAST-CHANGE-PROCESSOR      PIC X(4).
  1850
  1851******************************************************************
  1852*                     PRENOTE INFORMATION
  1853******************************************************************
  1854
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  39
* EL6521.cbl
  1855     12  AP-BANK-INFORMATION.
  1856         16  AP-TRANSIT-NUMBER             PIC X(8).
  1857         16  AP-BANK-ACCOUNT-NO            PIC X(17).
  1858         16  AP-BANK-NAME                  PIC X(23).
  1859
  1860     12  FILLER                            PIC X(31).
  1861
  1862******************************************************************
  1863*    COPY ELCBANK.
  1864******************************************************************
  1865*                                                                *
  1866*                           ELCBANK                              *
  1867*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1868*                            VMOD=2.002                          *
  1869*                                                                *
  1870*   FILE DESCRIPTION = BANK MASTER FILE                          *
  1871*                                                                *
  1872*   FILE TYPE = VSAM,KSDS                                        *
  1873*   RECORD SIZE = 210  RECFORM = FIXED                           *
  1874*                                                                *
  1875*   BASE CLUSTER = ELBANK                         RKP=2,LEN=9    *
  1876*       ALTERNATE (NONE)                                         *
  1877*                                                                *
  1878*   LOG = YES                                                    *
  1879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1880*                                                                *
  1881*  NO  CID  MODS  IN  COPYBOOK  ELCBANK                          *
  1882******************************************************************
  1883
  1884 01  BANK-MASTER.
  1885     12  BM-RECORD-ID                      PIC XX.
  1886         88  VALID-BM-ID                      VALUE 'BM'.
  1887
  1888******************************************************************
  1889*   BASE CLUSTER = MPBANK         (BASE KEY)      RKP=2,LEN=9    *
  1890******************************************************************
  1891
  1892     12  BM-CONTROL-PRIMARY.
  1893         16  BM-COMPANY-CD                 PIC X.
  1894         16  BM-TRANSIT-NUMBER.
  1895             20  BM-FEDERAL-NUMBER         PIC X(4).
  1896             20  BM-BANK-NUMBER            PIC X(4).
  1897     12  FILLER                            PIC X(20).
  1898
  1899******************************************************************
  1900*                 FILE SYNCHRONIZATION DATA                      *
  1901******************************************************************
  1902
  1903     12  BM-FILE-SYNCH-DATA.
  1904         16  BM-LAST-CHANGE-DT             PIC XX.
  1905         16  BM-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1906         16  BM-LAST-CHANGE-PROCESSOR      PIC X(4).
  1907
  1908******************************************************************
  1909*                       BANK INFORMATION                         *
  1910******************************************************************
  1911
  1912     12  BM-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  40
* EL6521.cbl
  1913         16  BM-NAME                       PIC X(30).
  1914         16  BM-ADDRESS1                   PIC X(30).
  1915         16  BM-ADDRESS2                   PIC X(30).
  1916         16  BM-CITY                       PIC X(25).
  1917         16  BM-STATE                      PIC X(25).
  1918         16  BM-ZIP.
  1919             20  BM-ZIP1                   PIC X(5).
  1920             20  BM-ZIP2                   PIC X(4).
  1921     12  FILLER                            PIC X(20).
  1922
  1923******************************************************************
  1924 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1925                          COMPENSATION-MASTER
  1926                          COMP-BILLING-INSTRUCTIONS
  1927                          ACH-PRENOTIFICATION BANK-MASTER.
  1928 0000-DFHEXIT SECTION.
  1929     MOVE '9#                    $   ' TO DFHEIV0.
  1930     MOVE 'EL6521' TO DFHEIV1.
  1931     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1932
  1933     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1934     MOVE '5'                    TO DC-OPTION-CODE.
  1935     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  1936     MOVE DC-GREG-DATE-1-EDIT    TO WS-SAVE-DATE.
  1937     MOVE DC-BIN-DATE-1          TO WS-SAVE-BIN-DT.
  1938
  1939     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1940     MOVE EIBTRMID               TO QID-TERM.
  1941     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  1942     MOVE SPACE                  TO SUPPRESS-MAP-SW.
  1943
  1944     IF EIBCALEN = 0
  1945        GO TO 8800-UNAUTHORIZED-ACCESS
  1946     END-IF
  1947     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  1948        MOVE PI-CALLING-PROGRAM  TO RETURNED-FROM
  1949     END-IF
  1950     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1951        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1952           MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-6
  1953           MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-5
  1954           MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-4
  1955           MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-3
  1956           MOVE PI-SAVED-PROGRAM-1    TO PI-SAVED-PROGRAM-2
  1957           MOVE PI-RETURN-TO-PROGRAM  TO PI-SAVED-PROGRAM-1
  1958           MOVE PI-CALLING-PROGRAM    TO PI-RETURN-TO-PROGRAM
  1959           MOVE THIS-PGM              TO PI-CALLING-PROGRAM
  1960        ELSE
  1961           MOVE PI-RETURN-TO-PROGRAM  TO PI-CALLING-PROGRAM
  1962           MOVE PI-SAVED-PROGRAM-1    TO PI-RETURN-TO-PROGRAM
  1963           MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-1
  1964           MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-2
  1965           MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-3
  1966           MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-4
  1967           MOVE PI-SAVED-PROGRAM-6    TO PI-SAVED-PROGRAM-5
  1968           MOVE SPACES                TO PI-SAVED-PROGRAM-6
  1969        END-IF
  1970     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  41
* EL6521.cbl
  1971     MOVE LOW-VALUES             TO EL6521AI
  1972     IF EIBTRNID = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  1973           EL6526-TRANS-ID
  1974        CONTINUE
  1975     ELSE
  1976        GO TO 0100-NOT-EL611-RETURN
  1977     END-IF
  1978
  1979     PERFORM 0600-RECOVER-TS  THRU  0600-EXIT.
  1980     MOVE XCTL-652           TO PI-RETURN-TO-PROGRAM.
  1981
  1982     MOVE PI-FEDERAL-NUMBER      TO TRNSIT1O.
  1983     MOVE PI-BANK-NUMBER         TO TRNSIT2O.
  1984     MOVE PI-BANK-ACCOUNT-NO     TO BKACCTO.
  1985
  1986     IF PI-BANK-ACTION-CODE EQUAL   'P'
  1987        MOVE 'PENDING'           TO CRSTATO.
  1988
  1989     IF PI-BANK-ACTION-CODE EQUAL   'A'
  1990        MOVE 'ACTIVE '           TO CRSTATO.
  1991
  1992     IF MAINTYPL GREATER THAN ZERO
  1993         MOVE AL-UABON           TO MAINTYPA.
  1994
  1995     IF STATL    GREATER THAN ZERO
  1996         MOVE 'Y'                TO MAP-CHANGED-SW
  1997         MOVE AL-UANON           TO STATA.
  1998
  1999     IF WTHLDL > ZERO
  2000        MOVE 'Y'                 TO MAP-CHANGED-SW
  2001        MOVE AL-UNNON            TO WTHLDA
  2002     END-IF
  2003     IF GADDL > ZERO
  2004        MOVE 'Y'                 TO MAP-CHANGED-SW
  2005        MOVE AL-UANON            TO GADDA
  2006     END-IF
  2007     IF MELSWL > ZERO
  2008        MOVE 'Y'                 TO MAP-CHANGED-SW
  2009        MOVE AL-UANON            TO MELSWA
  2010     END-IF
  2011     IF APCHKL > ZERO
  2012        MOVE 'Y'                 TO MAP-CHANGED-SW
  2013        MOVE AL-UANON            TO APCHKA
  2014     END-IF
  2015     IF MDACTL > ZERO
  2016        MOVE 'Y'                 TO MAP-CHANGED-SW
  2017        MOVE AL-UANON            TO MDACTA
  2018     END-IF
  2019     IF MDDIVL > ZERO
  2020        MOVE 'Y'                 TO MAP-CHANGED-SW
  2021        MOVE AL-UANON            TO MDDIVA
  2022     END-IF
  2023     IF MDCNTRL > ZERO
  2024        MOVE 'Y'                 TO MAP-CHANGED-SW
  2025        MOVE AL-UANON            TO MDCNTRA
  2026     END-IF
  2027     IF MDAMTL > ZERO
  2028        MOVE 'Y'                 TO MAP-CHANGED-SW
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  42
* EL6521.cbl
  2029        MOVE AL-UNNON            TO MDAMTA
  2030     END-IF
  2031     IF EFFDTL   GREATER THAN ZERO
  2032         MOVE 'Y'                TO MAP-CHANGED-SW
  2033         MOVE AL-UANON           TO EFFDTA.
  2034
  2035     IF TRMDTL   GREATER THAN ZERO
  2036         MOVE 'Y'                TO MAP-CHANGED-SW
  2037         MOVE AL-UANON           TO TRMDTA.
  2038
  2039     IF COMM1L   GREATER THAN ZERO
  2040         MOVE 'Y'                TO MAP-CHANGED-SW
  2041         MOVE AL-UANON           TO COMM1A.
  2042
  2043     IF COMM2L   GREATER THAN ZERO
  2044         MOVE 'Y'                TO MAP-CHANGED-SW
  2045         MOVE AL-UANON           TO COMM2A.
  2046
  2047     IF COMM3L   GREATER THAN ZERO
  2048         MOVE 'Y'                TO MAP-CHANGED-SW
  2049         MOVE AL-UANON           TO COMM3A.
  2050
  2051     IF COMM4L   GREATER THAN ZERO
  2052         MOVE 'Y'                TO MAP-CHANGED-SW
  2053         MOVE AL-UANON           TO COMM4A.
  2054
  2055     IF TRNSIT1L GREATER THAN ZERO
  2056         MOVE 'Y'                TO MAP-CHANGED-SW
  2057         MOVE AL-UABON           TO TRNSIT1A.
  2058
  2059     IF TRNSIT2L GREATER THAN ZERO
  2060         MOVE 'Y'                TO MAP-CHANGED-SW
  2061         MOVE AL-UABON           TO TRNSIT2A.
  2062
  2063     IF BKACCTL  GREATER THAN ZERO
  2064         MOVE 'Y'                TO MAP-CHANGED-SW
  2065         MOVE AL-UABON           TO BKACCTA.
  2066
  2067     IF ACTCDL   GREATER THAN ZERO
  2068         MOVE 'Y'                TO MAP-CHANGED-SW
  2069         MOVE AL-UABON           TO ACTCDA.
  2070
  2071     IF DELTOL > 0
  2072        MOVE 'Y'                 TO MAP-CHANGED-SW
  2073        MOVE AL-UANON            TO DELTOA
  2074     END-IF
  2075     IF RGIDL > 0
  2076        MOVE 'Y'                 TO MAP-CHANGED-SW
  2077        MOVE AL-UANON            TO RGIDA
  2078     END-IF
  2079     IF MAP-NOT-CHANGED
  2080         GO TO 0100-NOT-EL611-RETURN.
  2081
  2082     GO TO 8100-SEND-INITIAL-MAP.
  2083
  2084 0100-NOT-EL611-RETURN.
  2085
  2086     IF EIBTRNID NOT = TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  43
* EL6521.cbl
  2087         MOVE PI-MAINT           TO MAINTYPO
  2088         MOVE AL-UANON           TO MAINTYPA
  2089         MOVE -1                 TO MAINTYPL
  2090         IF PI-MAINT = 'S' OR 'C'
  2091             GO TO 4000-SHOW
  2092         ELSE
  2093             GO TO 8100-SEND-INITIAL-MAP.
  2094
  2095
  2096* EXEC CICS HANDLE CONDITION
  2097*        PGMIDERR  (9600-PGMID-ERROR)
  2098*        ERROR     (9990-ABEND)
  2099*    END-EXEC.
  2100*    MOVE '"$L.                  ! " #00002091' TO DFHEIV0
  2101     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2103     MOVE X'2220233030303032303931' TO DFHEIV0(25:11)
  2104     CALL 'kxdfhei1' USING DFHEIV0
  2105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2106
  2107
  2108     IF EIBAID = DFHCLEAR
  2109         GO TO 9400-CLEAR.
  2110
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  44
* EL6521.cbl
  2112 0200-RECEIVE.
  2113     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2114         MOVE ER-0008            TO EMI-ERROR
  2115         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2116         MOVE -1                 TO PFENTERL
  2117         GO TO 8200-SEND-DATAONLY.
  2118
  2119
  2120* EXEC CICS RECEIVE
  2121*        MAP      (MAP-NAME)
  2122*        MAPSET   (MAPSET-NAME)
  2123*        INTO     (EL6521AI)
  2124*    END-EXEC.
  2125     MOVE LENGTH OF
  2126      EL6521AI
  2127       TO DFHEIV11
  2128*    MOVE '8"T I  L              ''   #00002107' TO DFHEIV0
  2129     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2131     MOVE X'2020233030303032313037' TO DFHEIV0(25:11)
  2132     CALL 'kxdfhei1' USING DFHEIV0,
  2133           MAP-NAME,
  2134           EL6521AI,
  2135           DFHEIV11,
  2136           MAPSET-NAME,
  2137           DFHEIV99,
  2138           DFHEIV99
  2139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2140
  2141
  2142     IF PFENTERL = 0
  2143         GO TO 0300-CHECK-PFKEYS.
  2144
  2145     IF EIBAID NOT = DFHENTER
  2146         MOVE ER-0004            TO EMI-ERROR
  2147         GO TO 0320-INPUT-ERROR.
  2148
  2149     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  2150         MOVE PF-VALUES (PFENTERI) TO EIBAID
  2151     ELSE
  2152         MOVE ER-0029              TO EMI-ERROR
  2153         GO TO 0320-INPUT-ERROR.
  2154
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  45
* EL6521.cbl
  2156
  2157 0300-CHECK-PFKEYS.
  2158     IF PI-AR-PROCESSING
  2159        IF EIBAID = DFHPF1
  2160             PERFORM 0500-WRITE-TS  THRU  0500-EXIT
  2161             MOVE XCTL-611       TO PGM-NAME
  2162             GO TO 9300-XCTL.
  2163     IF EIBAID = DFHPF2
  2164        MOVE PI-COMPANY-CD       TO PI-ERCOBI-COMPANY-CD
  2165        MOVE DELTOI              TO PI-ERCOBI-STMT-OWNER
  2166        MOVE RGIDI               TO PI-ERCOBI-RGID
  2167        PERFORM 0500-WRITE-TS    THRU 0500-EXIT
  2168        MOVE XCTL-6525           TO PGM-NAME
  2169        GO TO 9300-XCTL
  2170     END-IF
  2171     IF EIBAID = DFHPF3
  2172        PERFORM 0500-WRITE-TS    THRU 0500-EXIT
  2173        MOVE XCTL-6526           TO PGM-NAME
  2174        GO TO 9300-XCTL
  2175     END-IF
  2176     IF EIBAID = DFHPF23
  2177         GO TO 8810-PF23.
  2178     IF EIBAID = DFHPF24
  2179         GO TO 9200-RETURN-MAIN-MENU.
  2180     IF EIBAID = DFHPF12
  2181         GO TO 9500-PF12.
  2182     IF EIBAID = DFHENTER
  2183         GO TO 0330-CHECK-MAINTYP.
  2184
  2185     MOVE ER-0029                TO EMI-ERROR.
  2186 0320-INPUT-ERROR.
  2187     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2188     MOVE AL-UNBON               TO PFENTERA.
  2189     MOVE -1                     TO PFENTERL.
  2190     GO TO 8200-SEND-DATAONLY.
  2191
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  46
* EL6521.cbl
  2193 0330-CHECK-MAINTYP.
  2194
  2195     IF MAINTYPL GREATER ZERO
  2196         IF MAINTYPI = 'S' OR 'C'
  2197             MOVE AL-UANON       TO MAINTYPA
  2198             MOVE MAINTYPI       TO PI-MAINT
  2199         ELSE
  2200             MOVE -1             TO MAINTYPL
  2201             MOVE AL-UABON       TO MAINTYPA
  2202             MOVE ER-2039        TO EMI-ERROR
  2203             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2204             GO TO 8200-SEND-DATAONLY
  2205     ELSE
  2206         MOVE -1                 TO MAINTYPL
  2207         MOVE AL-UABON           TO MAINTYPA
  2208         MOVE ER-2039            TO EMI-ERROR
  2209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2210         GO TO 8200-SEND-DATAONLY.
  2211
  2212     IF PI-MAINT = 'S'
  2213         GO TO 4000-SHOW.
  2214
  2215     GO TO 4200-MAINT.
  2216
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  47
* EL6521.cbl
  2218
  2219 0500-WRITE-TS.
  2220
  2221* EXEC CICS WRITEQ TS
  2222*         QUEUE  (QID)
  2223*         FROM   (EL6521AO)
  2224*         LENGTH (MAP-LENGTH)
  2225*    END-EXEC.
  2226*    MOVE '*"                    ''   #00002191' TO DFHEIV0
  2227     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  2228     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2229     MOVE X'2020233030303032313931' TO DFHEIV0(25:11)
  2230     CALL 'kxdfhei1' USING DFHEIV0,
  2231           QID,
  2232           EL6521AO,
  2233           MAP-LENGTH,
  2234           DFHEIV99,
  2235           DFHEIV99,
  2236           DFHEIV99
  2237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2238
  2239
  2240 0500-EXIT.
  2241      EXIT.
  2242
  2243 0600-RECOVER-TS.
  2244
  2245* EXEC CICS READQ TS
  2246*         QUEUE  (QID)
  2247*         INTO (EL6521AO)
  2248*         LENGTH (MAP-LENGTH)
  2249*    END-EXEC.
  2250*    MOVE '*$I    L              ''   #00002201' TO DFHEIV0
  2251     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  2252     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2253     MOVE X'2020233030303032323031' TO DFHEIV0(25:11)
  2254     CALL 'kxdfhei1' USING DFHEIV0,
  2255           QID,
  2256           EL6521AO,
  2257           MAP-LENGTH,
  2258           DFHEIV99,
  2259           DFHEIV99,
  2260           DFHEIV99
  2261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2262
  2263
  2264     PERFORM 0700-DELETE-TS  THRU  0700-EXIT.
  2265
  2266 0600-EXIT.
  2267      EXIT.
  2268
  2269 0700-DELETE-TS.
  2270
  2271* EXEC CICS HANDLE CONDITION
  2272*        QIDERR (0700-EXIT)
  2273*    END-EXEC.
  2274*    MOVE '"$N                   ! # #00002213' TO DFHEIV0
  2275     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  48
* EL6521.cbl
  2276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2277     MOVE X'2320233030303032323133' TO DFHEIV0(25:11)
  2278     CALL 'kxdfhei1' USING DFHEIV0
  2279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2280
  2281
  2282
  2283* EXEC CICS DELETEQ TS
  2284*        QUEUE (QID)
  2285*    END-EXEC.
  2286*    MOVE '*&                    #   #00002217' TO DFHEIV0
  2287     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  2288     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2289     MOVE X'2020233030303032323137' TO DFHEIV0(25:11)
  2290     CALL 'kxdfhei1' USING DFHEIV0,
  2291           QID,
  2292           DFHEIV99
  2293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2294
  2295
  2296 0700-EXIT.
  2297      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  49
* EL6521.cbl
  2299
  2300 4000-SHOW.
  2301
  2302     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2303
  2304     IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2305           EL6526-TRANS-ID
  2306         NEXT SENTENCE
  2307     ELSE
  2308         MOVE LOW-VALUES         TO EL6521AO.
  2309
  2310     GO TO 5000-BUILD-INITIAL-SCREEN.
  2311
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  50
* EL6521.cbl
  2313 4200-MAINT.
  2314     IF NOT MODIFY-CAP
  2315         MOVE 'UPDATE'           TO SM-READ
  2316         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2317         MOVE ER-0070            TO EMI-ERROR
  2318         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2319         GO TO 8100-SEND-INITIAL-MAP.
  2320
  2321     MOVE 'N'                     TO SUPPRESS-MAP-SW.
  2322     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2323
  2324     IF EMI-NO-ERRORS
  2325         NEXT SENTENCE
  2326     ELSE
  2327       IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2328              EL6526-TRANS-ID
  2329           GO TO 8100-SEND-INITIAL-MAP
  2330       ELSE
  2331           GO TO 8200-SEND-DATAONLY.
  2332
  2333     PERFORM 7000-EDIT THRU 7099-EXIT.
  2334
  2335     IF EMI-NO-ERRORS
  2336         NEXT SENTENCE
  2337     ELSE
  2338       IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2339             EL6526-TRANS-ID
  2340           GO TO 8100-SEND-INITIAL-MAP
  2341       ELSE
  2342           GO TO 8200-SEND-DATAONLY.
  2343
  2344     MOVE ER-0000               TO EMI-ERROR
  2345     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2346
  2347     PERFORM 7300-READ-ERCOMP-UPDATE THRU 7300-EXIT.
  2348
  2349     PERFORM 6000-CHECK-FOR-UPDATE   THRU 6049-EXIT.
  2350
  2351     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  2352     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  2353     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2354     MOVE '5'                    TO DC-OPTION-CODE.
  2355     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  2356
  2357     MOVE DC-BIN-DATE-1          TO CO-LAST-MAINT-DT.
  2358
  2359     PERFORM 5500-PROCESS-ELACHP THRU 5599-PROCESS-EXIT
  2360     PERFORM 6100-CHECK-BILL-INSTR
  2361                                 THRU 6100-EXIT
  2362
  2363
  2364* EXEC CICS REWRITE
  2365*        DATASET  (ERCOMP-FILE-ID)
  2366*        FROM     (COMPENSATION-MASTER)
  2367*    END-EXEC.
  2368     MOVE LENGTH OF
  2369      COMPENSATION-MASTER
  2370       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  51
* EL6521.cbl
  2371*    MOVE '&& L                  %   #00002288' TO DFHEIV0
  2372     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2373     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2374     MOVE X'2020233030303032323838' TO DFHEIV0(25:11)
  2375     CALL 'kxdfhei1' USING DFHEIV0,
  2376           ERCOMP-FILE-ID,
  2377           COMPENSATION-MASTER,
  2378           DFHEIV11,
  2379           DFHEIV99
  2380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2381
  2382
  2383     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2384     MOVE LOW-VALUES             TO EL6521AO.
  2385     MOVE 'C'                    TO PI-MAINT.
  2386
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  52
* EL6521.cbl
  2388
  2389 5000-BUILD-INITIAL-SCREEN.
  2390     MOVE CO-CARRIER             TO CARRIERO.
  2391     MOVE CO-GROUPING            TO GROUPO.
  2392     MOVE CO-TYPE                TO TYPEO.
  2393     MOVE CO-RESP-NO             TO FINRESPO.
  2394     MOVE CO-CTL-2               TO COACCTO.
  2395     MOVE CO-GA-STATUS-CODE      TO STATO.
  2396     IF CO-GA-STATUS-CODE = 'A' OR 'I' OR 'P'
  2397         MOVE CO-GA-STATUS-CODE  TO STATO
  2398         MOVE AL-UANON           TO STATA
  2399         MOVE +1                 TO STATL
  2400     ELSE
  2401         MOVE AL-UANOF           TO STATA
  2402     END-IF
  2403     IF CO-GA-WITHOLD-PCT NOT NUMERIC
  2404        MOVE ZEROS               TO CO-GA-WITHOLD-PCT
  2405     END-IF
  2406     MOVE CO-GA-WITHOLD-PCT      TO WTHLDO
  2407     IF CO-GA-WITHOLD-PCT NOT = ZEROS
  2408        MOVE +3                  TO WTHLDL
  2409        MOVE AL-UANON            TO WTHLDA
  2410     END-IF
  2411     IF CO-GA-DIRECT-DEP = 'Y'
  2412        MOVE 'Y'                 TO GADDO
  2413        MOVE AL-UANON            TO GADDA
  2414        MOVE +1                  TO GADDL
  2415     ELSE
  2416        MOVE 'N'                 TO GADDO
  2417        MOVE AL-UANON            TO GADDA
  2418        MOVE +1                  TO GADDL
  2419     END-IF
  2420     IF CO-DELIVER-CK-TO-MEL = 'Y'
  2421        MOVE 'Y'                 TO MELSWO
  2422        MOVE AL-UANON            TO MELSWA
  2423        MOVE +1                  TO MELSWL
  2424     ELSE
  2425        MOVE 'N'                 TO MELSWO
  2426        MOVE AL-UANON            TO MELSWA
  2427        MOVE +1                  TO MELSWL
  2428     END-IF
  2429     IF CO-CREATE-AP-CHECK = 'Y'
  2430        MOVE 'Y'                 TO APCHKO
  2431        MOVE AL-UANON            TO APCHKA
  2432        MOVE +1                  TO APCHKL
  2433     ELSE
  2434        MOVE 'N'                 TO APCHKO
  2435        MOVE AL-UANON            TO APCHKA
  2436        MOVE +1                  TO APCHKL
  2437     END-IF
  2438     IF CO-MD-GL-ACCT = SPACES OR LOW-VALUES
  2439        MOVE AL-UANOF            TO MDACTA
  2440     ELSE
  2441        MOVE CO-MD-GL-ACCT       TO MDACTO
  2442        MOVE +2                  TO MDACTL
  2443        MOVE AL-UANON            TO MDACTA
  2444     END-IF
  2445     IF CO-MD-DIV = SPACES OR LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  53
* EL6521.cbl
  2446        MOVE AL-UANOF            TO MDDIVA
  2447     ELSE
  2448        MOVE CO-MD-DIV           TO MDDIVO
  2449        MOVE AL-UANON            TO MDDIVA
  2450     END-IF
  2451     IF CO-MD-CENTER = SPACES OR LOW-VALUES
  2452        MOVE AL-UANOF            TO MDCNTRA
  2453     ELSE
  2454        MOVE CO-MD-CENTER        TO MDCNTRO
  2455        MOVE +2                  TO MDCNTRL
  2456        MOVE AL-UANON            TO MDCNTRA
  2457     END-IF
  2458     IF CO-MD-AMT NOT NUMERIC
  2459        MOVE ZEROS               TO CO-MD-AMT
  2460     END-IF
  2461     MOVE CO-MD-AMT              TO MDAMTO
  2462     IF CO-MD-AMT NOT = ZEROS
  2463        MOVE +3                  TO MDAMTL
  2464        MOVE AL-UANON            TO MDAMTA
  2465     END-IF
  2466     MOVE ZEROS                  TO MDLOBO
  2467                                    MDSTO
  2468     IF CO-GA-EFFECTIVE-DT = LOW-VALUES OR SPACES
  2469         MOVE AL-UANOF           TO EFFDTA
  2470     ELSE
  2471         MOVE CO-GA-EFFECTIVE-DT TO DC-BIN-DATE-1
  2472         MOVE ' '                TO DC-OPTION-CODE
  2473         PERFORM 9700-DATE-CONVERT THRU 9700-EXIT
  2474         MOVE DC-GREG-DATE-1-EDIT
  2475                                 TO EFFDTO
  2476         MOVE AL-UANON           TO EFFDTA
  2477         MOVE +8                 TO EFFDTL.
  2478
  2479     IF CO-GA-TERMINATION-DT = HIGH-VALUES
  2480        MOVE '99/99/99'          TO TRMDTO
  2481        MOVE AL-UANON            TO TRMDTA
  2482     ELSE
  2483        IF CO-GA-TERMINATION-DT = LOW-VALUES OR SPACES
  2484            MOVE AL-UANOF        TO TRMDTA
  2485        ELSE
  2486           MOVE CO-GA-TERMINATION-DT
  2487                                 TO DC-BIN-DATE-1
  2488           MOVE ' '              TO DC-OPTION-CODE
  2489           PERFORM 9700-DATE-CONVERT
  2490                                 THRU 9700-EXIT
  2491           MOVE DC-GREG-DATE-1-EDIT
  2492                                 TO TRMDTO
  2493           MOVE AL-UANON         TO TRMDTA
  2494           MOVE +8               TO TRMDTL
  2495        END-IF
  2496     END-IF
  2497
  2498     IF CO-GA-COMMENT-1 = LOW-VALUES OR SPACES
  2499         MOVE AL-UANOF            TO COMM1A
  2500     ELSE
  2501         MOVE CO-GA-COMMENT-1    TO COMM1O
  2502         MOVE AL-UANON           TO COMM1A
  2503         MOVE +40                TO COMM1L.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  54
* EL6521.cbl
  2504
  2505     IF CO-GA-COMMENT-2 = LOW-VALUES OR SPACES
  2506         MOVE AL-UANOF            TO COMM2A
  2507     ELSE
  2508         MOVE CO-GA-COMMENT-2    TO COMM2O
  2509         MOVE AL-UANON           TO COMM2A
  2510         MOVE +40                TO COMM2L.
  2511
  2512     IF CO-GA-COMMENT-3 = LOW-VALUES OR SPACES
  2513         MOVE AL-UANOF           TO COMM3A
  2514     ELSE
  2515         MOVE CO-GA-COMMENT-3    TO COMM3O
  2516         MOVE AL-UANON           TO COMM3A
  2517         MOVE +40                TO COMM3L.
  2518
  2519     IF CO-GA-COMMENT-4 = LOW-VALUES OR SPACES
  2520         MOVE AL-UANOF           TO COMM4A
  2521     ELSE
  2522         MOVE CO-GA-COMMENT-4    TO COMM4O
  2523         MOVE AL-UANON           TO COMM4A
  2524         MOVE +40                TO COMM4L.
  2525
  2526     IF PI-COMPANY-ID = 'CID' OR 'DCC'
  2527        CONTINUE
  2528     ELSE
  2529        IF (CO-BANK-TRANSIT-NO (1:4) = LOW-VALUES OR SPACES) AND
  2530           (CO-BANK-TRANSIT-NO (5:4) = LOW-VALUES OR SPACES)
  2531            MOVE AL-UANOF        TO TRNSIT1A
  2532            MOVE AL-UANOF        TO TRNSIT2A
  2533        ELSE
  2534           MOVE CO-BANK-TRANSIT-NO (1:4)
  2535                                 TO PI-BANK-TRANSIT-NUMBER (2:4)
  2536                                    TRNSIT1O
  2537           MOVE CO-BANK-TRANSIT-NO (5:4)
  2538                                 TO PI-BANK-TRANSIT-NUMBER (6:4)
  2539                                    TRNSIT2O
  2540        END-IF
  2541        IF CO-BANK-ACCOUNT-NUMBER = LOW-VALUES OR SPACES
  2542           MOVE AL-UANOF         TO BKACCTA
  2543        ELSE
  2544           MOVE CO-BANK-ACCOUNT-NUMBER
  2545                                 TO PI-BANK-ACCOUNT-NO
  2546                                    BKACCTO
  2547        END-IF
  2548     END-IF
  2549     MOVE    '       '           TO CRSTATO.
  2550
  2551     MOVE CO-ACH-STATUS          TO PI-BANK-ACTION-CODE.
  2552
  2553     IF CO-ACH-STATUS IS EQUAL      'P'
  2554        MOVE 'PENDING'           TO CRSTATO.
  2555
  2556     IF CO-ACH-STATUS IS EQUAL      'A'
  2557        MOVE 'ACTIVE '           TO CRSTATO.
  2558     IF CO-STMT-OWNER NOT = SPACES AND LOW-VALUES
  2559        MOVE CO-STMT-OWNER       TO DELTOO
  2560        MOVE AL-UANON            TO DELTOA
  2561        MOVE +4                  TO DELTOL
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  55
* EL6521.cbl
  2562     ELSE
  2563        MOVE AL-UANOF            TO DELTOA
  2564     END-IF
  2565     IF CO-REPORT-GROUP-ID NOT = SPACES AND LOW-VALUES
  2566        MOVE CO-REPORT-GROUP-ID  TO RGIDO
  2567        MOVE AL-UANON            TO RGIDA
  2568        MOVE +12                 TO RGIDL
  2569     ELSE
  2570        MOVE AL-UANOF            TO RGIDA
  2571     END-IF
  2572     MOVE PI-MAINT               TO MAINTYPO.
  2573     MOVE AL-UANOF               TO MAINTYPA.
  2574     MOVE -1                     TO MAINTYPL.
  2575
  2576     GO TO 8100-SEND-INITIAL-MAP.
  2577
  2578 5099-EXIT.
  2579     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  56
* EL6521.cbl
  2581 5500-PROCESS-ELACHP.
  2582
  2583     IF ACTCDI = 'D'
  2584        PERFORM 7400-DELETE-PRE-NOTE THRU 7499-EXIT
  2585        MOVE SPACES              TO CO-BANK-INFORMATION
  2586                                    CO-ACH-STATUS
  2587        GO TO 5599-PROCESS-EXIT.
  2588
  2589     IF ACTCDI = 'C'
  2590         PERFORM 7400-DELETE-PRE-NOTE THRU 7499-EXIT
  2591         PERFORM 7600-WRITE-ELACHP THRU 7620-WRITE-EXIT
  2592         MOVE WS-BANK-DATA       TO CO-BANK-INFORMATION
  2593         MOVE WS-BKACCTI         TO CO-BANK-ACCOUNT-NUMBER
  2594         MOVE 'P'                TO CO-ACH-STATUS
  2595         GO TO 5599-PROCESS-EXIT.
  2596
  2597     IF ACTCDI =  'N'
  2598         PERFORM 7600-WRITE-ELACHP THRU 7620-WRITE-EXIT
  2599         MOVE WS-BANK-DATA       TO CO-BANK-INFORMATION
  2600         MOVE WS-BKACCTI         TO CO-BANK-ACCOUNT-NUMBER
  2601         MOVE 'P'                TO CO-ACH-STATUS  WS-ACTCDI
  2602         GO TO 5599-PROCESS-EXIT.
  2603
  2604     IF ACTCDI = 'A'
  2605         MOVE 'A'                TO CO-ACH-STATUS  WS-ACTCDI
  2606         GO TO 5599-PROCESS-EXIT.
  2607
  2608 5599-PROCESS-EXIT.
  2609
  2610     EXIT.
  2611 6000-CHECK-FOR-UPDATE.
  2612     IF STATL GREATER ZERO
  2613        MOVE STATI               TO CO-GA-STATUS-CODE.
  2614
  2615     IF EFFDTL GREATER ZERO
  2616        MOVE WS-SAVE-BIN-EFFDT   TO CO-GA-EFFECTIVE-DT.
  2617
  2618     IF TRMDTL GREATER ZERO
  2619        MOVE WS-SAVE-BIN-TRMDT   TO CO-GA-TERMINATION-DT.
  2620
  2621     IF GADDL > ZERO
  2622        MOVE GADDI               TO CO-GA-DIRECT-DEP
  2623     END-IF
  2624     IF MELSWL > ZERO
  2625        MOVE MELSWI              TO CO-DELIVER-CK-TO-MEL
  2626     END-IF
  2627     IF APCHKL > ZERO
  2628        MOVE APCHKI              TO CO-CREATE-AP-CHECK
  2629     END-IF
  2630     IF MDACTL > ZERO
  2631        MOVE MDACTI              TO CO-MD-GL-ACCT
  2632     END-IF
  2633     IF MDDIVL > ZERO
  2634        MOVE MDDIVI              TO CO-MD-DIV
  2635     END-IF
  2636     IF MDCNTRL > ZERO
  2637        MOVE MDCNTRI             TO CO-MD-CENTER
  2638     END-IF
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  57
* EL6521.cbl
  2639     IF WTHLDL > ZERO
  2640        MOVE WTHLDI              TO CO-GA-WITHOLD-PCT
  2641     END-IF
  2642     IF MDAMTL > ZERO
  2643        MOVE MDAMTI              TO CO-MD-AMT
  2644     END-IF
  2645     IF DELTOL > ZERO
  2646        MOVE DELTOI              TO CO-STMT-OWNER
  2647     END-IF
  2648     IF RGIDL > ZERO
  2649        MOVE RGIDI               TO CO-REPORT-GROUP-ID
  2650     END-IF
  2651     IF COMM1L GREATER ZERO
  2652        MOVE COMM1I              TO CO-GA-COMMENT-1.
  2653
  2654     IF COMM2L GREATER ZERO
  2655        MOVE COMM2I              TO CO-GA-COMMENT-2.
  2656
  2657     IF COMM3L GREATER ZERO
  2658        MOVE COMM3I              TO CO-GA-COMMENT-3.
  2659
  2660     IF COMM4L GREATER ZERO
  2661        MOVE COMM4I              TO CO-GA-COMMENT-4.
  2662
  2663 6049-EXIT.
  2664     EXIT.
  2665 6100-CHECK-BILL-INSTR.
  2666     MOVE PI-COMPANY-CD          TO ERCOBI-COMPANY-CD
  2667     MOVE DELTOI                 TO ERCOBI-STMT-OWNER
  2668     MOVE RGIDI                  TO ERCOBI-RGID
  2669
  2670* EXEC CICS READ
  2671*       DATASET (ERCOBI-FILE-ID)
  2672*       SET     (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  2673*       RIDFLD  (ERCOBI-KEY)
  2674*       RESP    (WS-RESPONSE)
  2675*       UPDATE
  2676*    END-EXEC
  2677*    MOVE '&"S        EU         (  N#00002579' TO DFHEIV0
  2678     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2679     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2680     MOVE X'204E233030303032353739' TO DFHEIV0(25:11)
  2681     CALL 'kxdfhei1' USING DFHEIV0,
  2682           ERCOBI-FILE-ID,
  2683           DFHEIV20,
  2684           DFHEIV99,
  2685           ERCOBI-KEY,
  2686           DFHEIV99,
  2687           DFHEIV99,
  2688           DFHEIV99
  2689     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  2690         DFHEIV20
  2691     MOVE EIBRESP  TO WS-RESPONSE
  2692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2693     IF NOT RESP-NORMAL
  2694        MOVE AL-UABON            TO DELTOA
  2695                                    RGIDA
  2696        MOVE ER-2797             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  58
* EL6521.cbl
  2697        MOVE -1                  TO DELTOL
  2698        PERFORM 9900-ERROR-FORMAT
  2699                                 THRU 9900-EXIT
  2700     END-IF
  2701     .
  2702 6100-EXIT.
  2703     EXIT.
  2704
  2705 7000-EDIT.
  2706     IF STATL GREATER ZERO
  2707         IF STATI = 'A' OR 'I' OR 'P'
  2708             NEXT SENTENCE
  2709          ELSE
  2710             MOVE -1             TO STATL
  2711             MOVE AL-UABON       TO STATA
  2712             MOVE ER-7438        TO EMI-ERROR
  2713             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2714
  2715     MOVE LOW-VALUES             TO WS-SAVE-BIN-EFFDT.
  2716     MOVE LOW-VALUES             TO WS-SAVE-BIN-TRMDT.
  2717
  2718     IF EFFDTL NOT = ZERO
  2719         MOVE EFFDTI             TO DEEDIT-FIELD
  2720         PERFORM 8600-DEEDIT
  2721         MOVE DEEDIT-FIELD-V0    TO DC-GREG-DATE-1-MDY
  2722         MOVE '4'                TO DC-OPTION-CODE
  2723         PERFORM 9700-DATE-CONVERT THRU 9700-EXIT
  2724         IF DATE-CONVERSION-ERROR
  2725             MOVE ER-0348        TO EMI-ERROR
  2726             MOVE -1             TO EFFDTL
  2727             MOVE AL-UABON       TO EFFDTA
  2728             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2729         ELSE
  2730             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
  2731             MOVE AL-UANON             TO EFFDTA
  2732             MOVE DC-BIN-DATE-1        TO WS-SAVE-BIN-EFFDT.
  2733
  2734     IF TRMDTL NOT = ZERO
  2735        MOVE TRMDTI              TO DEEDIT-FIELD
  2736        PERFORM 8600-DEEDIT
  2737        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  2738        IF DC-GREG-DATE-1-MDY = 999999
  2739           MOVE HIGH-VALUES      TO WS-SAVE-BIN-TRMDT
  2740        ELSE
  2741           MOVE '4'              TO DC-OPTION-CODE
  2742           PERFORM 9700-DATE-CONVERT
  2743                                 THRU 9700-EXIT
  2744           IF DATE-CONVERSION-ERROR
  2745              MOVE ER-0454       TO EMI-ERROR
  2746              MOVE -1            TO TRMDTL
  2747              MOVE AL-UABON      TO TRMDTA
  2748              PERFORM 9900-ERROR-FORMAT
  2749                                 THRU 9900-EXIT
  2750           ELSE
  2751              MOVE DC-GREG-DATE-1-EDIT
  2752                                 TO TRMDTI
  2753              MOVE AL-UANON      TO TRMDTA
  2754              MOVE DC-BIN-DATE-1 TO WS-SAVE-BIN-TRMDT
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  59
* EL6521.cbl
  2755           END-IF
  2756        END-IF
  2757     END-IF
  2758     IF GADDL > ZERO
  2759        IF GADDI = 'Y' OR 'N' OR ' '
  2760           MOVE AL-UANON         TO GADDA
  2761        ELSE
  2762           MOVE AL-UABON         TO GADDA
  2763           MOVE ER-0876          TO EMI-ERROR
  2764           MOVE -1               TO GADDL
  2765           PERFORM 9900-ERROR-FORMAT
  2766                                 THRU 9900-EXIT
  2767        END-IF
  2768     END-IF
  2769     IF MELSWL > ZERO
  2770        IF MELSWI = 'Y' OR 'N' OR ' '
  2771           MOVE AL-UANON         TO MELSWA
  2772        ELSE
  2773           MOVE AL-UABON         TO MELSWA
  2774           MOVE ER-0876          TO EMI-ERROR
  2775           MOVE -1               TO MELSWL
  2776           PERFORM 9900-ERROR-FORMAT
  2777                                 THRU 9900-EXIT
  2778        END-IF
  2779     END-IF
  2780     IF APCHKL > ZERO
  2781        IF APCHKI = 'Y' OR 'N' OR ' '
  2782           MOVE AL-UANON         TO APCHKA
  2783        ELSE
  2784           MOVE AL-UABON         TO APCHKA
  2785           MOVE ER-0876          TO EMI-ERROR
  2786           MOVE -1               TO APCHKL
  2787           PERFORM 9900-ERROR-FORMAT
  2788                                 THRU 9900-EXIT
  2789        END-IF
  2790     END-IF
  2791     IF WTHLDL  > ZERO
  2792
  2793* EXEC CICS BIF
  2794*          DEEDIT
  2795*          FIELD   (WTHLDI)
  2796*          LENGTH  (6)
  2797*       END-EXEC
  2798     MOVE 6
  2799       TO DFHEIV11
  2800*    MOVE '@"L                   #   #00002685' TO DFHEIV0
  2801     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2802     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2803     MOVE X'2020233030303032363835' TO DFHEIV0(25:11)
  2804     CALL 'kxdfhei1' USING DFHEIV0,
  2805           WTHLDI,
  2806           DFHEIV11
  2807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2808        IF WTHLDI NUMERIC
  2809           MOVE AL-UNNON         TO WTHLDA
  2810        ELSE
  2811           MOVE -1               TO WTHLDL
  2812           MOVE AL-UABON         TO WTHLDA
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  60
* EL6521.cbl
  2813           MOVE ER-8799          TO EMI-ERROR
  2814           PERFORM 9900-ERROR-FORMAT
  2815                                 THRU  9900-EXIT
  2816        END-IF
  2817     END-IF
  2818     IF MDAMTL  > ZERO
  2819
  2820* EXEC CICS BIF
  2821*          DEEDIT
  2822*          FIELD   (MDAMTI)
  2823*          LENGTH  (8)
  2824*       END-EXEC
  2825     MOVE 8
  2826       TO DFHEIV11
  2827*    MOVE '@"L                   #   #00002701' TO DFHEIV0
  2828     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2829     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2830     MOVE X'2020233030303032373031' TO DFHEIV0(25:11)
  2831     CALL 'kxdfhei1' USING DFHEIV0,
  2832           MDAMTI,
  2833           DFHEIV11
  2834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2835        IF MDAMTI NUMERIC
  2836           MOVE AL-UNNON         TO MDAMTA
  2837        ELSE
  2838           MOVE -1               TO MDAMTL
  2839           MOVE AL-UABON         TO MDAMTA
  2840           MOVE ER-8799          TO EMI-ERROR
  2841           PERFORM 9900-ERROR-FORMAT
  2842                                 THRU  9900-EXIT
  2843        END-IF
  2844     END-IF
  2845     IF WS-SAVE-BIN-EFFDT = LOW-VALUES OR
  2846        WS-SAVE-BIN-TRMDT = LOW-VALUES
  2847         NEXT SENTENCE
  2848       ELSE
  2849         IF WS-SAVE-BIN-TRMDT LESS THAN WS-SAVE-BIN-EFFDT
  2850             MOVE ER-1228        TO EMI-ERROR
  2851             MOVE -1             TO EFFDTL
  2852             MOVE AL-UABON       TO EFFDTA
  2853             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2854
  2855      IF ((DELTOL > +0)
  2856         OR (RGIDL > +0))
  2857         AND ((DELTOI NOT = SPACES)
  2858         AND (RGIDI NOT = SPACES))
  2859         PERFORM 6100-CHECK-BILL-INSTR
  2860                                 THRU 6100-EXIT
  2861      END-IF
  2862     MOVE SPACES                 TO WS-BANK-INFORMATION.
  2863
  2864     IF PI-AR-PROCESSING
  2865        NEXT SENTENCE
  2866     ELSE
  2867        MOVE ZEROS               TO ACTCDL, TRNSIT1L TRNSIT2L
  2868                                    BKACCTL
  2869        GO TO 7099-EXIT.
  2870
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  61
* EL6521.cbl
  2871     IF (TRNSIT1L NOT = ZERO) OR
  2872        (TRNSIT2L NOT = ZERO) OR
  2873        (BKACCTL  NOT = ZERO) OR
  2874        (ACTCDL   NOT = ZERO)
  2875         MOVE 'Y'                TO WS-ACH-SW
  2876     ELSE
  2877         GO TO 7099-EXIT.
  2878
  2879     IF (ACTCDL = ZERO) OR
  2880        (ACTCDI NOT = 'N' AND 'C' AND 'A' AND 'D')
  2881         MOVE -1                 TO ACTCDL
  2882         MOVE AL-UABON           TO ACTCDA
  2883         MOVE ER-7436            TO EMI-ERROR
  2884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2885         GO TO 7099-EXIT.
  2886
  2887     IF ACTCDI = 'N'
  2888         GO TO 7020-NEW-ACH.
  2889
  2890     IF ACTCDI = 'C'
  2891         GO TO 7040-CHANGE-ACH.
  2892
  2893     IF ACTCDI = 'A'
  2894         GO TO 7060-ACTIVATE-ACH.
  2895
  2896****   ACH DELETE PROCESSING EDITS
  2897
  2898     IF TRNSIT1L NOT = ZERO OR
  2899        TRNSIT2L NOT = ZERO OR
  2900        BKACCTL  NOT = ZERO
  2901         MOVE -1                 TO ACTCDL
  2902         MOVE AL-UABON           TO ACTCDA
  2903         MOVE ER-7430            TO EMI-ERROR
  2904         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2905
  2906     GO TO 7099-EXIT.
  2907
  2908****   ACH NEW ENTRY PROCESSING EDITS
  2909 7020-NEW-ACH.
  2910
  2911     IF CO-ACH-STATUS = 'A' OR 'P'
  2912         MOVE -1                 TO ACTCDL
  2913         MOVE AL-UABON           TO ACTCDA
  2914         MOVE ER-7434            TO EMI-ERROR
  2915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2916         GO TO 7099-EXIT.
  2917
  2918     IF TRNSIT1L = ZERO OR
  2919        TRNSIT2L = ZERO OR
  2920        BKACCTL = ZERO
  2921         MOVE -1                 TO TRNSIT1L
  2922         MOVE ER-7431            TO EMI-ERROR
  2923         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2924         GO TO 7099-EXIT.
  2925
  2926     IF TRNSIT1L GREATER THAN ZERO
  2927         IF TRNSIT1I = SPACES
  2928             MOVE -1             TO TRNSIT1L
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  62
* EL6521.cbl
  2929             MOVE ER-7435        TO EMI-ERROR
  2930             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2931             GO TO 7099-EXIT
  2932         ELSE
  2933             MOVE TRNSIT1I       TO WS-TRANSIT1.
  2934
  2935     IF TRNSIT2L GREATER THAN ZERO
  2936         IF TRNSIT2I = SPACES
  2937             MOVE -1             TO TRNSIT2L
  2938             MOVE ER-7435        TO EMI-ERROR
  2939             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2940             GO TO 7099-EXIT
  2941         ELSE
  2942             MOVE TRNSIT2I       TO WS-TRANSIT2.
  2943
  2944     IF BKACCTL GREATER THAN ZERO
  2945         IF BKACCTI = SPACES
  2946             MOVE -1             TO BKACCTL
  2947             MOVE ER-7435        TO EMI-ERROR
  2948             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2949             GO TO 7099-EXIT
  2950         ELSE
  2951             MOVE BKACCTI        TO WS-BKACCTI.
  2952         MOVE BKACCTI            TO WS-BKACCTI.
  2953
  2954     PERFORM 7500-VALIDATE-TRANSIT  THRU  7500-VALIDATE-EXIT.
  2955
  2956     GO TO 7099-EXIT.
  2957
  2958****   ACH CHANGE ENTRY PROCESSING EDITS
  2959 7040-CHANGE-ACH.
  2960
  2961     IF (TRNSIT1L = ZERO) AND
  2962        (TRNSIT2L = ZERO) AND
  2963        (BKACCTL = ZERO)
  2964         MOVE -1                 TO TRNSIT1L
  2965         MOVE ER-7435            TO EMI-ERROR
  2966         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2967         GO TO 7099-EXIT.
  2968
  2969     IF CO-BANK-INFORMATION = SPACES OR LOW-VALUES
  2970         MOVE -1                 TO ACTCDL
  2971         MOVE ER-7432            TO EMI-ERROR
  2972         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2973         GO TO 7099-EXIT.
  2974
  2975     MOVE CO-BANK-INFORMATION    TO WS-BANK-INFORMATION.
  2976
  2977     IF TRNSIT1L GREATER THAN ZERO
  2978         IF TRNSIT1I = SPACES
  2979             MOVE -1             TO TRNSIT1L
  2980             MOVE ER-7435        TO EMI-ERROR
  2981             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2982             GO TO 7099-EXIT
  2983         ELSE
  2984             MOVE TRNSIT1I       TO WS-TRANSIT1.
  2985
  2986     IF TRNSIT2L GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  63
* EL6521.cbl
  2987         IF TRNSIT2I = SPACES
  2988             MOVE -1             TO TRNSIT2L
  2989             MOVE ER-7435        TO EMI-ERROR
  2990             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2991             GO TO 7099-EXIT
  2992         ELSE
  2993             MOVE TRNSIT2I       TO WS-TRANSIT2.
  2994
  2995     IF BKACCTL GREATER THAN ZERO
  2996         IF BKACCTI = SPACES
  2997             MOVE -1             TO BKACCTL
  2998             MOVE ER-7435        TO EMI-ERROR
  2999             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3000             GO TO 7099-EXIT
  3001         ELSE
  3002             MOVE BKACCTI        TO WS-BKACCTI.
  3003
  3004     IF CO-BANK-INFORMATION = WS-BANK-INFORMATION
  3005         MOVE -1                 TO ACTCDL
  3006         MOVE ER-7449            TO EMI-ERROR
  3007         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3008         GO TO 7099-EXIT.
  3009
  3010     IF TRNSIT1L GREATER THAN ZERO OR
  3011        TRNSIT2L GREATER THAN ZERO
  3012         PERFORM 7500-VALIDATE-TRANSIT  THRU  7500-VALIDATE-EXIT.
  3013
  3014     GO TO 7099-EXIT.
  3015
  3016****   ACH ACTIVATE ENTRY PROCESSING EDITS
  3017 7060-ACTIVATE-ACH.
  3018
  3019     IF NOT CO-ACH-PENDING
  3020         MOVE -1                 TO ACTCDL
  3021         MOVE ER-7465            TO EMI-ERROR
  3022         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3023         GO TO 7099-EXIT.
  3024
  3025     IF TRNSIT1L NOT = ZERO OR
  3026        TRNSIT2L NOT = ZERO OR
  3027        BKACCTL  NOT = ZERO
  3028         MOVE -1                 TO ACTCDL
  3029         MOVE ER-7440            TO EMI-ERROR
  3030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3031         GO TO 7099-EXIT.
  3032
  3033 7099-EXIT.
  3034     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  64
* EL6521.cbl
  3036
  3037 7100-READ-ERCOMP.
  3038
  3039
  3040* EXEC CICS HANDLE CONDITION
  3041*        NOTOPEN (7100-NOTOPEN)
  3042*        NOTFND  (7100-NOTFND)
  3043*    END-EXEC.
  3044*    MOVE '"$JI                  ! $ #00002910' TO DFHEIV0
  3045     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3047     MOVE X'2420233030303032393130' TO DFHEIV0(25:11)
  3048     CALL 'kxdfhei1' USING DFHEIV0
  3049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3050
  3051
  3052
  3053* EXEC CICS READ
  3054*         DATASET  (ERCOMP-FILE-ID)
  3055*         SET      (ADDRESS OF COMPENSATION-MASTER)
  3056*         RIDFLD   (PI-ERCOMP-KEY)
  3057*    END-EXEC.
  3058*    MOVE '&"S        E          (   #00002915' TO DFHEIV0
  3059     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3061     MOVE X'2020233030303032393135' TO DFHEIV0(25:11)
  3062     CALL 'kxdfhei1' USING DFHEIV0,
  3063           ERCOMP-FILE-ID,
  3064           DFHEIV20,
  3065           DFHEIV99,
  3066           PI-ERCOMP-KEY,
  3067           DFHEIV99,
  3068           DFHEIV99,
  3069           DFHEIV99
  3070     SET ADDRESS OF COMPENSATION-MASTER TO
  3071         DFHEIV20
  3072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3073
  3074
  3075*    PERFORM 7200-READ-ERCOBI    THRU 7200-EXIT
  3076     IF DO-NOT-MOVE-TO-MAP
  3077        MOVE 'Y'                 TO SUPPRESS-MAP-SW
  3078        GO TO 7100-EXIT.
  3079
  3080     MOVE CO-LAST-MAINT-USER     TO PI-UPDATE-BY.
  3081     MOVE CO-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  3082     MOVE CO-CONTROL-PRIMARY     TO PI-ERCOMP-KEY.
  3083     MOVE CO-CARRIER             TO CARRIERO.
  3084     MOVE CO-GROUPING            TO GROUPO.
  3085     MOVE CO-TYPE                TO TYPEO.
  3086     MOVE CO-RESP-NO             TO FINRESPO.
  3087     MOVE CO-CTL-2               TO COACCTO.
  3088     MOVE CO-BANK-INFORMATION    TO PI-BANK-TRANSIT-NUMBER (2:8)
  3089     MOVE PI-FEDERAL-NUMBER      TO TRNSIT1O.
  3090     MOVE PI-BANK-NUMBER         TO TRNSIT2O.
  3091     GO TO 7100-EXIT.
  3092
  3093 7100-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  65
* EL6521.cbl
  3094     MOVE ER-7462               TO EMI-ERROR
  3095     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3096     GO TO 7100-EXIT.
  3097
  3098 7100-NOTOPEN.
  3099     MOVE ER-2233               TO EMI-ERROR
  3100     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3101     GO TO 7100-EXIT.
  3102
  3103 7100-EXIT.
  3104     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  66
* EL6521.cbl
  3106
  3107 7200-READ-ERCOBI.
  3108     MOVE CO-CONTROL-PRIMARY     TO ERCOBI-KEY
  3109
  3110* EXEC CICS READ
  3111*       DATASET (ERCOBI-FILE-ID)
  3112*       SET     (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  3113*       RIDFLD  (ERCOBI-KEY)
  3114*       RESP    (WS-RESPONSE)
  3115*    END-EXEC
  3116*    MOVE '&"S        E          (  N#00002955' TO DFHEIV0
  3117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3119     MOVE X'204E233030303032393535' TO DFHEIV0(25:11)
  3120     CALL 'kxdfhei1' USING DFHEIV0,
  3121           ERCOBI-FILE-ID,
  3122           DFHEIV20,
  3123           DFHEIV99,
  3124           ERCOBI-KEY,
  3125           DFHEIV99,
  3126           DFHEIV99,
  3127           DFHEIV99
  3128     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  3129         DFHEIV20
  3130     MOVE EIBRESP  TO WS-RESPONSE
  3131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3132     IF RESP-NORMAL
  3133        SET BILLING-INSTRUCTIONS-FOUND TO TRUE
  3134     END-IF
  3135     .
  3136 7200-EXIT.
  3137     EXIT.
  3138 7300-READ-ERCOMP-UPDATE.
  3139
  3140* EXEC CICS HANDLE CONDITION
  3141*        NOTFND  (7300-NOTFND)
  3142*        NOTOPEN (7300-NOTOPEN)
  3143*    END-EXEC.
  3144*    MOVE '"$IJ                  ! % #00002968' TO DFHEIV0
  3145     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3147     MOVE X'2520233030303032393638' TO DFHEIV0(25:11)
  3148     CALL 'kxdfhei1' USING DFHEIV0
  3149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3150
  3151
  3152
  3153* EXEC CICS READ
  3154*         DATASET  (ERCOMP-FILE-ID)
  3155*         SET      (ADDRESS OF COMPENSATION-MASTER)
  3156*         RIDFLD   (PI-ERCOMP-KEY)
  3157*         UPDATE
  3158*    END-EXEC.
  3159*    MOVE '&"S        EU         (   #00002973' TO DFHEIV0
  3160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3161     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3162     MOVE X'2020233030303032393733' TO DFHEIV0(25:11)
  3163     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  67
* EL6521.cbl
  3164           ERCOMP-FILE-ID,
  3165           DFHEIV20,
  3166           DFHEIV99,
  3167           PI-ERCOMP-KEY,
  3168           DFHEIV99,
  3169           DFHEIV99,
  3170           DFHEIV99
  3171     SET ADDRESS OF COMPENSATION-MASTER TO
  3172         DFHEIV20
  3173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3174
  3175     GO TO 7300-EXIT.
  3176
  3177 7300-NOTOPEN.
  3178
  3179     MOVE ER-2233               TO EMI-ERROR
  3180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3181     GO TO 7300-EXIT.
  3182 7300-NOTFND.
  3183
  3184     MOVE ER-7462               TO EMI-ERROR
  3185     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3186     GO TO 7300-EXIT.
  3187
  3188 7300-EXIT.
  3189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  68
* EL6521.cbl
  3191
  3192 7400-DELETE-PRE-NOTE.
  3193
  3194
  3195* EXEC CICS HANDLE CONDITION
  3196*        NOTFND  (7499-EXIT)
  3197*        NOTOPEN (7450-NOTOPEN)
  3198*    END-EXEC.
  3199*    MOVE '"$IJ                  ! & #00002998' TO DFHEIV0
  3200     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3202     MOVE X'2620233030303032393938' TO DFHEIV0(25:11)
  3203     CALL 'kxdfhei1' USING DFHEIV0
  3204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3205
  3206
  3207
  3208* EXEC CICS READ
  3209*         DATASET  (ELACHP-FILE-ID)
  3210*         SET     (ADDRESS OF ACH-PRENOTIFICATION)
  3211*         RIDFLD   (CO-CONTROL-PRIMARY)
  3212*         UPDATE
  3213*    END-EXEC.
  3214*    MOVE '&"S        EU         (   #00003003' TO DFHEIV0
  3215     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3216     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3217     MOVE X'2020233030303033303033' TO DFHEIV0(25:11)
  3218     CALL 'kxdfhei1' USING DFHEIV0,
  3219           ELACHP-FILE-ID,
  3220           DFHEIV20,
  3221           DFHEIV99,
  3222           CO-CONTROL-PRIMARY,
  3223           DFHEIV99,
  3224           DFHEIV99,
  3225           DFHEIV99
  3226     SET ADDRESS OF ACH-PRENOTIFICATION TO
  3227         DFHEIV20
  3228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3229
  3230
  3231
  3232* EXEC CICS DELETE
  3233*        DATASET   (ELACHP-FILE-ID)
  3234*    END-EXEC.
  3235*    MOVE '&(                    &   #00003010' TO DFHEIV0
  3236     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  3237     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3238     MOVE X'2020233030303033303130' TO DFHEIV0(25:11)
  3239     CALL 'kxdfhei1' USING DFHEIV0,
  3240           ELACHP-FILE-ID,
  3241           DFHEIV99,
  3242           DFHEIV99,
  3243           DFHEIV99,
  3244           DFHEIV99
  3245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3246
  3247
  3248     GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  69
* EL6521.cbl
  3249
  3250 7450-NOTOPEN.
  3251     MOVE ER-7469               TO EMI-ERROR
  3252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3253
  3254 7499-EXIT.
  3255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  70
* EL6521.cbl
  3257
  3258******************************************************************
  3259*             V A L I D T E  T R A N S I T  N U M B E R
  3260******************************************************************
  3261 7500-VALIDATE-TRANSIT.
  3262
  3263
  3264* EXEC CICS HANDLE CONDITION
  3265*        NOTFND   (7500-NOT-FOUND)
  3266*        NOTOPEN  (7500-NOT-OPEN)
  3267*    END-EXEC.
  3268*    MOVE '"$IJ                  ! '' #00003029' TO DFHEIV0
  3269     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3271     MOVE X'2720233030303033303239' TO DFHEIV0(25:11)
  3272     CALL 'kxdfhei1' USING DFHEIV0
  3273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3274
  3275
  3276     MOVE WS-TRANSIT1          TO PI-FEDERAL-NUMBER.
  3277     MOVE WS-TRANSIT2          TO PI-BANK-NUMBER.
  3278     MOVE PI-COMPANY-CD        TO PI-BANK-COMPANY-CD.
  3279
  3280
  3281* EXEC CICS READ
  3282*        EQUAL
  3283*        DATASET   (ELBANK-FILE-ID)
  3284*        SET       (ADDRESS OF BANK-MASTER)
  3285*        RIDFLD    (PI-BANK-TRANSIT-NUMBER)
  3286*    END-EXEC.
  3287*    MOVE '&"S        E          (   #00003038' TO DFHEIV0
  3288     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3289     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3290     MOVE X'2020233030303033303338' TO DFHEIV0(25:11)
  3291     CALL 'kxdfhei1' USING DFHEIV0,
  3292           ELBANK-FILE-ID,
  3293           DFHEIV20,
  3294           DFHEIV99,
  3295           PI-BANK-TRANSIT-NUMBER,
  3296           DFHEIV99,
  3297           DFHEIV99,
  3298           DFHEIV99
  3299     SET ADDRESS OF BANK-MASTER TO
  3300         DFHEIV20
  3301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3302
  3303
  3304     GO TO 7500-VALIDATE-EXIT.
  3305
  3306 7500-NOT-OPEN.
  3307
  3308     MOVE -1                    TO TRNSIT1L
  3309     MOVE AL-UABON              TO TRNSIT1A
  3310     MOVE AL-UABON              TO TRNSIT2A
  3311     MOVE ER-7468               TO EMI-ERROR .
  3312     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3313     GO TO 7500-VALIDATE-EXIT.
  3314
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  71
* EL6521.cbl
  3315 7500-NOT-FOUND.
  3316
  3317     MOVE -1                    TO TRNSIT1L
  3318     MOVE AL-UABON              TO TRNSIT1A
  3319     MOVE AL-UABON              TO TRNSIT2A
  3320     MOVE ER-9388               TO EMI-ERROR .
  3321     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3322     GO TO 7500-VALIDATE-EXIT.
  3323
  3324 7500-VALIDATE-EXIT.
  3325     EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  72
* EL6521.cbl
  3327
  3328 7600-WRITE-ELACHP.
  3329
  3330* EXEC CICS HANDLE CONDITION
  3331*        NOTOPEN (7450-NOTOPEN)
  3332*        DUPREC   (7610-DUPREC)
  3333*    END-EXEC.
  3334*    MOVE '"$J%                  ! ( #00003070' TO DFHEIV0
  3335     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  3336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3337     MOVE X'2820233030303033303730' TO DFHEIV0(25:11)
  3338     CALL 'kxdfhei1' USING DFHEIV0
  3339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3340
  3341
  3342
  3343* EXEC CICS GETMAIN
  3344*        SET      (ADDRESS OF ACH-PRENOTIFICATION)
  3345*        LENGTH   (210)
  3346*    END-EXEC.
  3347     MOVE 210
  3348       TO DFHEIV11
  3349*    MOVE '," L                  $   #00003075' TO DFHEIV0
  3350     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3351     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3352     MOVE X'2020233030303033303735' TO DFHEIV0(25:11)
  3353     CALL 'kxdfhei1' USING DFHEIV0,
  3354           DFHEIV20,
  3355           DFHEIV11,
  3356           DFHEIV99
  3357     SET ADDRESS OF ACH-PRENOTIFICATION TO
  3358         DFHEIV20
  3359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3360
  3361
  3362     INITIALIZE  ACH-PRENOTIFICATION.
  3363
  3364     MOVE  'AP'                  TO AP-RECORD-ID.
  3365
  3366     MOVE PI-PROCESSOR-ID        TO AP-LAST-CHANGE-PROCESSOR
  3367     MOVE CO-CONTROL-PRIMARY     TO AP-CONTROL-PRIMARY
  3368     MOVE EIBTIME                TO AP-LAST-CHANGE-TIME
  3369     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3370     MOVE '5'                    TO DC-OPTION-CODE.
  3371     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  3372
  3373     MOVE DC-BIN-DATE-1          TO AP-LAST-CHANGE-DT.
  3374     MOVE WS-BANK-DATA           TO AP-BANK-INFORMATION.
  3375     MOVE BM-NAME                TO AP-BANK-NAME.
  3376
  3377
  3378* EXEC CICS WRITE
  3379*        FROM      (ACH-PRENOTIFICATION)
  3380*        DATASET   (ELACHP-FILE-ID)
  3381*        RIDFLD    (CO-CONTROL-PRIMARY)
  3382*    END-EXEC.
  3383     MOVE LENGTH OF
  3384      ACH-PRENOTIFICATION
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  73
* EL6521.cbl
  3385       TO DFHEIV11
  3386*    MOVE '&$ L                  ''   #00003095' TO DFHEIV0
  3387     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3389     MOVE X'2020233030303033303935' TO DFHEIV0(25:11)
  3390     CALL 'kxdfhei1' USING DFHEIV0,
  3391           ELACHP-FILE-ID,
  3392           ACH-PRENOTIFICATION,
  3393           DFHEIV11,
  3394           CO-CONTROL-PRIMARY,
  3395           DFHEIV99,
  3396           DFHEIV99
  3397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3398
  3399
  3400     GO TO 7620-WRITE-EXIT.
  3401
  3402 7610-DUPREC.
  3403
  3404     MOVE    ER-7447            TO EMI-ERROR
  3405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3406     GO TO 7620-WRITE-EXIT.
  3407
  3408 7620-WRITE-EXIT.
  3409      EXIT.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  74
* EL6521.cbl
  3411******************************************************************
  3412 8100-SEND-INITIAL-MAP.
  3413     MOVE WS-SAVE-DATE           TO DATEO.
  3414     MOVE EIBTIME                TO TIME-IN.
  3415     MOVE TIME-OUT               TO TIMEO.
  3416     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3417     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3418     MOVE -1                     TO MAINTYPL.
  3419     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3420     MOVE WS-AGENT-BANK-DESC    TO BKDESCO.
  3421
  3422* HIDE ACH FIELDS IF NOT AR PROCESSING
  3423     IF PI-AR-PROCESSING
  3424        NEXT SENTENCE
  3425     ELSE
  3426        MOVE AL-SADOF             TO BKLITA, BKDESCA  CRSTATA
  3427                                     ACTLITA CRSLITA ACHPF1A
  3428                                     TRNSIT1A TRNSIT2A TRDASHA
  3429                                     BKACCTA, ACTCDA.
  3430
  3431* EXEC CICS SEND
  3432*        MAP      (MAP-NAME)
  3433*        MAPSET   (MAPSET-NAME)
  3434*        FROM     (EL6521AO)
  3435*        ERASE
  3436*        CURSOR
  3437*    END-EXEC.
  3438     MOVE LENGTH OF
  3439      EL6521AO
  3440       TO DFHEIV12
  3441     MOVE -1
  3442       TO DFHEIV11
  3443*    MOVE '8$     CT  E    H L F ,   #00003131' TO DFHEIV0
  3444     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3445     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3446     MOVE X'2020233030303033313331' TO DFHEIV0(25:11)
  3447     CALL 'kxdfhei1' USING DFHEIV0,
  3448           MAP-NAME,
  3449           EL6521AO,
  3450           DFHEIV12,
  3451           MAPSET-NAME,
  3452           DFHEIV99,
  3453           DFHEIV99,
  3454           DFHEIV99,
  3455           DFHEIV11,
  3456           DFHEIV99,
  3457           DFHEIV99,
  3458           DFHEIV99
  3459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3460
  3461
  3462     GO TO 9100-RETURN-TRAN.
  3463
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  75
* EL6521.cbl
  3465 8200-SEND-DATAONLY.
  3466     MOVE WS-SAVE-DATE           TO DATEO.
  3467     MOVE EIBTIME                TO TIME-IN.
  3468     MOVE TIME-OUT               TO TIMEO.
  3469     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3470     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3471     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  3472     MOVE WS-AGENT-BANK-DESC     TO BKDESCO.
  3473
  3474* HIDE ACH FIELDS IF NOT AR PROCESSING
  3475     IF PI-AR-PROCESSING
  3476        NEXT SENTENCE
  3477     ELSE
  3478        MOVE AL-SADOF             TO BKLITA, BKDESCA  CRSTATA
  3479                                     ACTLITA CRSLITA ACHPF1A
  3480                                     TRNSIT1A TRNSIT2A TRDASHA
  3481                                     BKACCTA, ACTCDA.
  3482
  3483* EXEC CICS SEND
  3484*        MAP      (MAP-NAME)
  3485*        MAPSET   (MAPSET-NAME)
  3486*        FROM     (EL6521AO)
  3487*        DATAONLY
  3488*        CURSOR
  3489*    END-EXEC.
  3490     MOVE LENGTH OF
  3491      EL6521AO
  3492       TO DFHEIV12
  3493     MOVE -1
  3494       TO DFHEIV11
  3495*    MOVE '8$D    CT       H L F ,   #00003159' TO DFHEIV0
  3496     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3497     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3498     MOVE X'2020233030303033313539' TO DFHEIV0(25:11)
  3499     CALL 'kxdfhei1' USING DFHEIV0,
  3500           MAP-NAME,
  3501           EL6521AO,
  3502           DFHEIV12,
  3503           MAPSET-NAME,
  3504           DFHEIV99,
  3505           DFHEIV99,
  3506           DFHEIV99,
  3507           DFHEIV11,
  3508           DFHEIV99,
  3509           DFHEIV99,
  3510           DFHEIV99
  3511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3512
  3513
  3514     GO TO 9100-RETURN-TRAN.
  3515
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  76
* EL6521.cbl
  3517 8300-SEND-TEXT.
  3518
  3519* EXEC CICS SEND TEXT
  3520*        FROM     (LOGOFF-TEXT)
  3521*        LENGTH   (LOGOFF-LENGTH)
  3522*        ERASE
  3523*        FREEKB
  3524*    END-EXEC.
  3525*    MOVE '8&      T  E F  H   F -   #00003171' TO DFHEIV0
  3526     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3527     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3528     MOVE X'2020233030303033313731' TO DFHEIV0(25:11)
  3529     CALL 'kxdfhei1' USING DFHEIV0,
  3530           LOGOFF-TEXT,
  3531           LOGOFF-LENGTH,
  3532           DFHEIV99,
  3533           DFHEIV99,
  3534           DFHEIV99,
  3535           DFHEIV99,
  3536           DFHEIV99,
  3537           DFHEIV99,
  3538           DFHEIV99,
  3539           DFHEIV99,
  3540           DFHEIV99,
  3541           DFHEIV99
  3542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3543
  3544
  3545
  3546* EXEC CICS RETURN
  3547*    END-EXEC.
  3548*    MOVE '.(                    &   #00003178' TO DFHEIV0
  3549     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3550     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3551     MOVE X'2020233030303033313738' TO DFHEIV0(25:11)
  3552     CALL 'kxdfhei1' USING DFHEIV0,
  3553           DFHEIV99,
  3554           DFHEIV99,
  3555           DFHEIV99,
  3556           DFHEIV99,
  3557           DFHEIV99
  3558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3559
  3560
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  77
* EL6521.cbl
  3562 8600-DEEDIT.
  3563
  3564* EXEC CICS BIF DEEDIT
  3565*         FIELD(DEEDIT-FIELD)
  3566*         LENGTH(15)
  3567*    END-EXEC.
  3568     MOVE 15
  3569       TO DFHEIV11
  3570*    MOVE '@"L                   #   #00003183' TO DFHEIV0
  3571     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3572     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3573     MOVE X'2020233030303033313833' TO DFHEIV0(25:11)
  3574     CALL 'kxdfhei1' USING DFHEIV0,
  3575           DEEDIT-FIELD,
  3576           DFHEIV11
  3577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3578
  3579
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  78
* EL6521.cbl
  3581 8800-UNAUTHORIZED-ACCESS.
  3582     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3583     GO TO 8300-SEND-TEXT.
  3584
  3585 8810-PF23.
  3586     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3587     MOVE XCTL-005               TO PGM-NAME.
  3588     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  79
* EL6521.cbl
  3590
  3591 9100-RETURN-TRAN.
  3592     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3593     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  3594
  3595* EXEC CICS RETURN
  3596*        TRANSID    (TRANS-ID)
  3597*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3598*        LENGTH     (WS-COMM-LENGTH)
  3599*    END-EXEC.
  3600*    MOVE '.(CT                  &   #00003202' TO DFHEIV0
  3601     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3602     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3603     MOVE X'2020233030303033323032' TO DFHEIV0(25:11)
  3604     CALL 'kxdfhei1' USING DFHEIV0,
  3605           TRANS-ID,
  3606           PROGRAM-INTERFACE-BLOCK,
  3607           WS-COMM-LENGTH,
  3608           DFHEIV99,
  3609           DFHEIV99
  3610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3611
  3612
  3613 9200-RETURN-MAIN-MENU.
  3614     MOVE XCTL-626               TO PGM-NAME.
  3615     GO TO 9300-XCTL.
  3616
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  80
* EL6521.cbl
  3618 9300-XCTL.
  3619
  3620* EXEC CICS XCTL
  3621*        PROGRAM    (PGM-NAME)
  3622*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3623*        LENGTH     (WS-COMM-LENGTH)
  3624*    END-EXEC.
  3625*    MOVE '.$C                   $   #00003214' TO DFHEIV0
  3626     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3627     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3628     MOVE X'2020233030303033323134' TO DFHEIV0(25:11)
  3629     CALL 'kxdfhei1' USING DFHEIV0,
  3630           PGM-NAME,
  3631           PROGRAM-INTERFACE-BLOCK,
  3632           WS-COMM-LENGTH
  3633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3634
  3635
  3636 9400-CLEAR.
  3637     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  3638     GO TO 9300-XCTL.
  3639
  3640 9500-PF12.
  3641     MOVE XCTL-010               TO PGM-NAME.
  3642     GO TO 9300-XCTL.
  3643
  3644 9600-PGMID-ERROR.
  3645
  3646* EXEC CICS HANDLE CONDITION
  3647*        PGMIDERR    (8300-SEND-TEXT)
  3648*    END-EXEC.
  3649*    MOVE '"$L                   ! ) #00003229' TO DFHEIV0
  3650     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3652     MOVE X'2920233030303033323239' TO DFHEIV0(25:11)
  3653     CALL 'kxdfhei1' USING DFHEIV0
  3654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3655
  3656
  3657     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  3658     MOVE ' '                    TO PI-ENTRY-CD-1.
  3659     MOVE XCTL-005               TO PGM-NAME.
  3660     MOVE PGM-NAME               TO LOGOFF-PGM.
  3661     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3662     GO TO 9300-XCTL.
  3663
  3664 9700-DATE-CONVERT.
  3665
  3666* EXEC CICS LINK
  3667*        PROGRAM    ('ELDATCV')
  3668*        COMMAREA   (DATE-CONVERSION-DATA)
  3669*        LENGTH     (DC-COMM-LENGTH)
  3670*    END-EXEC.
  3671     MOVE 'ELDATCV' TO DFHEIV1
  3672*    MOVE '."C                   ''   #00003241' TO DFHEIV0
  3673     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3674     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3675     MOVE X'2020233030303033323431' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  81
* EL6521.cbl
  3676     CALL 'kxdfhei1' USING DFHEIV0,
  3677           DFHEIV1,
  3678           DATE-CONVERSION-DATA,
  3679           DC-COMM-LENGTH,
  3680           DFHEIV99,
  3681           DFHEIV99,
  3682           DFHEIV99
  3683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3684
  3685
  3686 9700-EXIT.
  3687     EXIT.
  3688
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  82
* EL6521.cbl
  3690 9900-ERROR-FORMAT.
  3691
  3692     IF NOT EMI-ERRORS-COMPLETE
  3693         MOVE LINK-001           TO PGM-NAME
  3694
  3695* EXEC CICS LINK
  3696*            PROGRAM    (PGM-NAME)
  3697*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3698*            LENGTH     (EMI-COMM-LENGTH)
  3699*        END-EXEC.
  3700*    MOVE '."C                   ''   #00003255' TO DFHEIV0
  3701     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3702     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3703     MOVE X'2020233030303033323535' TO DFHEIV0(25:11)
  3704     CALL 'kxdfhei1' USING DFHEIV0,
  3705           PGM-NAME,
  3706           ERROR-MESSAGE-INTERFACE-BLOCK,
  3707           EMI-COMM-LENGTH,
  3708           DFHEIV99,
  3709           DFHEIV99,
  3710           DFHEIV99
  3711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3712
  3713
  3714 9900-EXIT.
  3715     EXIT.
  3716
  3717 9990-ABEND.
  3718     MOVE LINK-004               TO PGM-NAME.
  3719     MOVE DFHEIBLK               TO EMI-LINE1.
  3720
  3721* EXEC CICS LINK
  3722*        PROGRAM   (PGM-NAME)
  3723*        COMMAREA  (EMI-LINE1)
  3724*        LENGTH    (72)
  3725*    END-EXEC.
  3726     MOVE 72
  3727       TO DFHEIV11
  3728*    MOVE '."C                   ''   #00003267' TO DFHEIV0
  3729     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3730     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3731     MOVE X'2020233030303033323637' TO DFHEIV0(25:11)
  3732     CALL 'kxdfhei1' USING DFHEIV0,
  3733           PGM-NAME,
  3734           EMI-LINE1,
  3735           DFHEIV11,
  3736           DFHEIV99,
  3737           DFHEIV99,
  3738           DFHEIV99
  3739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3740
  3741
  3742     GO TO 8200-SEND-DATAONLY.
  3743
  3744 9995-SECURITY-VIOLATION.
  3745*           COPY ELCSCTP.
  3746******************************************************************
  3747*                                                                *
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  83
* EL6521.cbl
  3748*                            ELCSCTP                             *
  3749*                            VMOD=2.001                          *
  3750*                                                                *
  3751*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3752******************************************************************
  3753
  3754
  3755     MOVE EIBDATE          TO SM-JUL-DATE.
  3756     MOVE EIBTRMID         TO SM-TERMID.
  3757     MOVE THIS-PGM         TO SM-PGM.
  3758     MOVE EIBTIME          TO TIME-IN.
  3759     MOVE TIME-OUT         TO SM-TIME.
  3760     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3761
  3762
  3763* EXEC CICS LINK
  3764*         PROGRAM  ('EL003')
  3765*         COMMAREA (SECURITY-MESSAGE)
  3766*         LENGTH   (80)
  3767*    END-EXEC.
  3768     MOVE 'EL003' TO DFHEIV1
  3769     MOVE 80
  3770       TO DFHEIV11
  3771*    MOVE '."C                   ''   #00003293' TO DFHEIV0
  3772     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3773     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3774     MOVE X'2020233030303033323933' TO DFHEIV0(25:11)
  3775     CALL 'kxdfhei1' USING DFHEIV0,
  3776           DFHEIV1,
  3777           SECURITY-MESSAGE,
  3778           DFHEIV11,
  3779           DFHEIV99,
  3780           DFHEIV99,
  3781           DFHEIV99
  3782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3783
  3784
  3785******************************************************************
  3786
  3787
  3788 9995-EXIT.
  3789      EXIT.
  3790
  3791 9999-DFHBACK SECTION.
  3792     MOVE '9%                    "   ' TO DFHEIV0
  3793     MOVE 'EL6521' TO DFHEIV1
  3794     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3795     GOBACK.
  3796 9999-DFHEXIT.
  3797     IF DFHEIGDJ EQUAL 0001
  3798         NEXT SENTENCE
  3799     ELSE IF DFHEIGDJ EQUAL 2
  3800         GO TO 9600-PGMID-ERROR,
  3801               9990-ABEND
  3802         DEPENDING ON DFHEIGDI
  3803     ELSE IF DFHEIGDJ EQUAL 3
  3804         GO TO 0700-EXIT
  3805         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 03-Mar-11 10:35 Page  84
* EL6521.cbl
  3806     ELSE IF DFHEIGDJ EQUAL 4
  3807         GO TO 7100-NOTOPEN,
  3808               7100-NOTFND
  3809         DEPENDING ON DFHEIGDI
  3810     ELSE IF DFHEIGDJ EQUAL 5
  3811         GO TO 7300-NOTFND,
  3812               7300-NOTOPEN
  3813         DEPENDING ON DFHEIGDI
  3814     ELSE IF DFHEIGDJ EQUAL 6
  3815         GO TO 7499-EXIT,
  3816               7450-NOTOPEN
  3817         DEPENDING ON DFHEIGDI
  3818     ELSE IF DFHEIGDJ EQUAL 7
  3819         GO TO 7500-NOT-FOUND,
  3820               7500-NOT-OPEN
  3821         DEPENDING ON DFHEIGDI
  3822     ELSE IF DFHEIGDJ EQUAL 8
  3823         GO TO 7450-NOTOPEN,
  3824               7610-DUPREC
  3825         DEPENDING ON DFHEIGDI
  3826     ELSE IF DFHEIGDJ EQUAL 9
  3827         GO TO 8300-SEND-TEXT
  3828         DEPENDING ON DFHEIGDI.
  3829     MOVE '9%                    "   ' TO DFHEIV0
  3830     MOVE 'EL6521' TO DFHEIV1
  3831     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3832     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        4388     Code:       11149
