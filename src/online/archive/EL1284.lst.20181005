* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   1
* EL1284.cbl
* Options: int("EL1284.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1284.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1284.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1284.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1284.
     4*
     5*AUTHOR.           LOGIC,INC.
     6*                  DALLAS,TEXAS.
     7
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            * THIS PROGRAM IS THE PROPERTY OF LOCIC, INC. *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   2
* EL1284.cbl
    14*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    16*            *                                                   *
    17*            *****************************************************
    18*
    19*REMARKS.     TRANSACTION - EXXG - CLAIM MEMO MAINTENANCE.
    20*
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 010416   2015072900002   TANA  NEW CLAIM MEMO SCREEN
    30* 040416   2016021500002   TANA  CHANGE REWRITE FIELD VALID VALUES
    31******************************************************************
    32*
    33 ENVIRONMENT DIVISION.
    34
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   3
* EL1284.cbl
    36 DATA DIVISION.
    37 WORKING-STORAGE SECTION.
    38 01  DFH-START PIC X(04).
    39 77  FILLER  PIC X(32)  VALUE '********************************'.
    40 77  FILLER  PIC X(32)  VALUE '*     EL1284 WORKING STORAGE   *'.
    41 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    42
    43*    COPY ELCSCTM.
    44******************************************************************
    45*                                                                *
    46*                                                                *
    47*                            ELCSCTM                             *
    48*                            VMOD=2.001                          *
    49*                                                                *
    50*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    51*                                                                *
    52******************************************************************
    53 01  SECURITY-MESSAGE.
    54     12  FILLER                          PIC X(30)
    55            VALUE '** LOGIC SECURITY VIOLATION -'.
    56     12  SM-READ                         PIC X(6).
    57     12  FILLER                          PIC X(5)
    58            VALUE ' PGM='.
    59     12  SM-PGM                          PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' OPR='.
    62     12  SM-PROCESSOR-ID                 PIC X(4).
    63     12  FILLER                          PIC X(6)
    64            VALUE ' TERM='.
    65     12  SM-TERMID                       PIC X(4).
    66     12  FILLER                          PIC XX   VALUE SPACE.
    67     12  SM-JUL-DATE                     PIC 9(5).
    68     12  FILLER                          PIC X    VALUE SPACE.
    69     12  SM-TIME                         PIC 99.99.
    70
    71*    COPY ELCSCRTY.
    72******************************************************************
    73*                                                                *
    74*                                                                *
    75*                            ELCSCRTY                            *
    76*                            VMOD=2.001                          *
    77*                                                                *
    78*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    79*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    80*        SAVED IN PI-SECURITY-ADDRESS.                           *
    81*                                                                *
    82******************************************************************
    83 01  SECURITY-CONTROL.
    84     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    85     12  FILLER                       PIC XX    VALUE 'SC'.
    86     12  SC-CREDIT-CODES.
    87         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    88             20  SC-CREDIT-DISPLAY    PIC X.
    89             20  SC-CREDIT-UPDATE     PIC X.
    90     12  SC-CLAIMS-CODES.
    91         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    92             20  SC-CLAIMS-DISPLAY    PIC X.
    93             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   4
* EL1284.cbl
    94
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   5
* EL1284.cbl
    96 01  STANDARD-AREAS.
    97     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
    98     12  MAP-NAME                PIC X(8)    VALUE 'EL1284A'.
    99     12  MAPSET-NAME             PIC X(8)    VALUE 'EL1284S '.
   100     12  SCRN-NUMBER             PIC X(4)    VALUE '128D'.
   101     12  TRANS-ID                PIC X(4)    VALUE 'EXXG'.
   102     12  THIS-PGM                PIC X(8)    VALUE 'EL1284'.
   103     12  PGM-NAME                PIC X(8).
   104     12  PGM-EL1276              PIC X(8)    VALUE 'EL1276'.
   105
   106     12  ELMEMO-FILE-ID          PIC X(8)    VALUE 'ELMEMO'.
   107     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT'.
   108     12  QID.
   109         16  QID-TERM            PIC X(4).
   110         16  FILLER              PIC X(4)    VALUE '128D'.
   111     12  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   112     12  SC-ITEM                 PIC S9(4)   COMP VALUE +1.
   113     12  WS-LINE                 PIC 9(3)    VALUE 0.
   114     12  WS-BLANK-LINES          PIC S9(4)   COMP VALUE +0.
   115
   116 01  WORK-AREA.
   117     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   118     12  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   119
   120     12  ELMEMO-LENGTH           PIC S9(4)   COMP VALUE +132.
   121     12  ELMEMO-KEY-LENGTH       PIC S9(4)   COMP VALUE +23.
   122     12  ELMEMO-START-LENGTH     PIC S9(4)   COMP VALUE +21.
   123     12  ELMEMO-KEY.
   124         16  ELMEMO-PARTIAL-KEY.
   125             20 ELMEMO-COMPANY-CD    PIC X.
   126             20 ELMEMO-RECORD-TYPE   PIC X.
   127             20 ELMEMO-CARRIER       PIC X.
   128             20 ELMEMO-CLAIM-NO      PIC  X(7).
   129             20 ELMEMO-CERT-NO.
   130                25 ELMEMO-CERT-PRIME PIC X(10).
   131                25 ELMEMO-CERT-SFX   PIC X.
   132         16 ELMEMO-SEQ           PIC S9(4) COMP.
   133     12  SV-PRIOR-KEY.
   134         20 SV-COMPANY-CD            PIC X.
   135         20 SV-RECORD-TYPE           PIC X.
   136         20 SV-CARRIER               PIC X.
   137         20 SV-CLAIM-NO              PIC  X(7).
   138         20 SV-CERT-NO.
   139            25 SV-CERT-PRIME         PIC X(10).
   140            25 SV-CERT-SFX           PIC X(1).
   141     12  ELCERT-KEY.
   142         16  ELCERT-COMPANY-CD        PIC X.
   143         16  ELCERT-CARRIER           PIC X.
   144         16  ELCERT-GROUPING          PIC X(6).
   145         16  ELCERT-STATE             PIC XX.
   146         16  ELCERT-ACCOUNT           PIC X(10).
   147         16  ELCERT-EFF-DT            PIC XX.
   148         16  ELCERT-CERT-NO.
   149             20  ELCERT-CERT-PRIME    PIC X(10).
   150             20  ELCERT-CERT-SFX      PIC X.
   151
   152     12  TIME-IN                 PIC S9(7).
   153     12  TIME-SPLIT REDEFINES TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   6
* EL1284.cbl
   154         16  FILLER              PIC X.
   155         16  TIME-OUT            PIC 99V99.
   156         16  FILLER              PIC X(2).
   157     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   158     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   159     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   160     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   161     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   162     12  MAX-LINES               PIC 999     VALUE 300.
   163     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 10.
   164     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   165     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0  COMP-3.
   166     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   167     12  ROLL-COUNTER            PIC S999    VALUE +0 COMP-3.
   168     12  TEMP-CURR-LINE          PIC S9(3)   COMP-3.
   169     12  WS-SUB                  PIC S9(3)   COMP-3.
   170     12  WS-SUB1                 PIC S9(3)   COMP-3.
   171     12  WS-ERASE-EOF            PIC X       VALUE X'80'.
   172     12  DEEDIT-DATE-INPUT.
   173         16  FILLER              PIC XX.
   174         16  DEEDIT-DATE         PIC X(6).
   175     12  WS-CURSOR-SET           PIC X       VALUE 'N'.
   176         88 CURSOR-SET                       VALUE 'Y'.
   177     12  WS-SCREEN-LINE          PIC X       VALUE 'N'.
   178         88 SCREEN-LINE-FOUND                VALUE 'Y'.
   179
   180     12  ELMSTR-KEY.
   181         16  MSTR-COMP-CD    PIC X.
   182         16  MSTR-CARRIER    PIC X.
   183         16  MSTR-CLAIM-NO   PIC X(7).
   184         16  MSTR-CERT-NO.
   185             20  MSTR-CERT-NO-PRIME  PIC X(10).
   186             20  MSTR-CERT-NO-SUFX   PIC X.
   187 01  COMP-LENGTHS.
   188     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   189     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   190     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   191     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   192     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   193     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   194     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   195     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   196     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   197     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   198     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   199     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   200     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   201     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   7
* EL1284.cbl
   203 01  ERROR-MESSAGES.
   204     12  ER-0000             PIC X(04)       VALUE '0000'.
   205     12  ER-0004             PIC X(04)       VALUE '0004'.
   206     12  ER-0006             PIC X(04)       VALUE '0006'.
   207     12  ER-0008             PIC X(04)       VALUE '0008'.
   208     12  ER-0023             PIC X(04)       VALUE '0023'.
   209     12  ER-0029             PIC X(04)       VALUE '0029'.
   210     12  ER-0030             PIC X(04)       VALUE '0030'.
   211     12  ER-0031             PIC X(04)       VALUE '0031'.
   212     12  ER-0032             PIC X(04)       VALUE '0032'.
   213     12  ER-0033             PIC X(04)       VALUE '0033'.
   214     12  ER-0041             PIC X(04)       VALUE '0041'.
   215     12  ER-0044             PIC X(04)       VALUE '0044'.
   216     12  ER-0045             PIC X(04)       VALUE '0045'.
   217     12  ER-0046             PIC X(04)       VALUE '0046'.
   218     12  ER-0047             PIC X(04)       VALUE '0047'.
   219     12  ER-0048             PIC X(04)       VALUE '0048'.
   220     12  ER-0049             PIC X(04)       VALUE '0049'.
   221     12  ER-0050             PIC X(04)       VALUE '0050'.
   222     12  ER-0051             PIC X(04)       VALUE '0051'.
   223     12  ER-0066             PIC X(04)       VALUE '0066'.
   224     12  ER-0067             PIC X(04)       VALUE '0067'.
   225     12  ER-0069             PIC X(04)       VALUE '0069'.
   226     12  ER-0070             PIC X(04)       VALUE '0070'.
   227     12  ER-0140             PIC X(04)       VALUE '0140'.
   228     12  ER-0314             PIC X(04)       VALUE '0314'.
   229     12  ER-2954             PIC X(04)       VALUE '2954'.
   230     12  ER-3846             PIC X(04)       VALUE '3846'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   8
* EL1284.cbl
   232*                       COPY ELCLOGOF.
   233******************************************************************
   234*                                                                *
   235*                                                                *
   236*                            ELCLOGOF.                           *
   237*                            VMOD=2.001                          *
   238*                                                                *
   239*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   240*                                                                *
   241******************************************************************
   242 01  CLASIC-LOGOFF.
   243     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   244     12  LOGOFF-TEXT.
   245         16  FILLER          PIC X(5)    VALUE SPACES.
   246         16  LOGOFF-MSG.
   247             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   248             20  FILLER      PIC X       VALUE SPACES.
   249             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   250         16  FILLER          PIC X(80)
   251           VALUE '* YOU ARE NOW LOGGED OFF'.
   252         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   253         16  FILLER          PIC X       VALUE QUOTE.
   254         16  LOGOFF-SYS-MSG  PIC X(17)
   255           VALUE 'S CLAS-IC SYSTEM '.
   256     12  TEXT-MESSAGES.
   257         16  UNACCESS-MSG    PIC X(29)
   258             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   259         16  PGMIDERR-MSG    PIC X(17)
   260             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page   9
* EL1284.cbl
   262*                       COPY ELCAID.
   263******************************************************************
   264*                                                                *
   265*                            ELCAID.                             *
   266*                            VMOD=2.001                          *
   267*                                                                *
   268*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   269*                                                                *
   270*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   271*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   272******************************************************************
   273
   274 01  DFHAID.
   275   02  DFHNULL   PIC  X  VALUE  ' '.
   276   02  DFHENTER  PIC  X  VALUE  QUOTE.
   277   02  DFHCLEAR  PIC  X  VALUE  '_'.
   278   02  DFHPEN    PIC  X  VALUE  '='.
   279   02  DFHOPID   PIC  X  VALUE  'W'.
   280   02  DFHPA1    PIC  X  VALUE  '%'.
   281   02  DFHPA2    PIC  X  VALUE  '>'.
   282   02  DFHPA3    PIC  X  VALUE  ','.
   283   02  DFHPF1    PIC  X  VALUE  '1'.
   284   02  DFHPF2    PIC  X  VALUE  '2'.
   285   02  DFHPF3    PIC  X  VALUE  '3'.
   286   02  DFHPF4    PIC  X  VALUE  '4'.
   287   02  DFHPF5    PIC  X  VALUE  '5'.
   288   02  DFHPF6    PIC  X  VALUE  '6'.
   289   02  DFHPF7    PIC  X  VALUE  '7'.
   290   02  DFHPF8    PIC  X  VALUE  '8'.
   291   02  DFHPF9    PIC  X  VALUE  '9'.
   292   02  DFHPF10   PIC  X  VALUE  ':'.
   293   02  DFHPF11   PIC  X  VALUE  '#'.
   294   02  DFHPF12   PIC  X  VALUE  '@'.
   295   02  DFHPF13   PIC  X  VALUE  'A'.
   296   02  DFHPF14   PIC  X  VALUE  'B'.
   297   02  DFHPF15   PIC  X  VALUE  'C'.
   298   02  DFHPF16   PIC  X  VALUE  'D'.
   299   02  DFHPF17   PIC  X  VALUE  'E'.
   300   02  DFHPF18   PIC  X  VALUE  'F'.
   301   02  DFHPF19   PIC  X  VALUE  'G'.
   302   02  DFHPF20   PIC  X  VALUE  'H'.
   303   02  DFHPF21   PIC  X  VALUE  'I'.
   304*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   305   02  DFHPF22   PIC  X  VALUE  '['.
   306   02  DFHPF23   PIC  X  VALUE  '.'.
   307   02  DFHPF24   PIC  X  VALUE  '<'.
   308   02  DFHMSRE   PIC  X  VALUE  'X'.
   309   02  DFHSTRF   PIC  X  VALUE  'h'.
   310   02  DFHTRIG   PIC  X  VALUE  '"'.
   311 01  FILLER  REDEFINES DFHAID.
   312     12  FILLER                  PIC X(8).
   313     12  PF-VALUES OCCURS 24 TIMES       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  10
* EL1284.cbl
   315*                       COPY ELCEMIB.
   316******************************************************************
   317*                                                                *
   318*                                                                *
   319*                            ELCEMIB.                            *
   320*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   321*                            VMOD=2.005                          *
   322*                                                                *
   323*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   324*                                                                *
   325******************************************************************
   326 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   327     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   328     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   329     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   330     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   331     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   332     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   333     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   334     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   335     12  EMI-SWITCH1             PIC X        VALUE '1'.
   336         88  EMI-NO-ERRORS                    VALUE '1'.
   337         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   338         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   339     12  EMI-SWITCH2             PIC X        VALUE '1'.
   340         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   341     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   342         88  EMI-AREA1-EMPTY                  VALUE '1'.
   343         88  EMI-AREA1-FULL                   VALUE '2'.
   344     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   345         88  EMI-AREA2-EMPTY                  VALUE '1'.
   346         88  EMI-AREA2-FULL                   VALUE '2'.
   347     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   348         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   349         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   350         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   351         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   352         88  EMI-BYPASS-FATALS                VALUE 'X'.
   353     12  EMI-ERROR-LINES.
   354         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   355         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   356         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   357         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   358             20  EMI-ERR-CODES OCCURS 10 TIMES.
   359                 24  EMI-ERR-NUM         PIC X(4).
   360                 24  EMI-FILLER          PIC X.
   361                 24  EMI-SEV             PIC X.
   362                 24  FILLER              PIC X.
   363             20  FILLER                  PIC X(02).
   364     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   365         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   366             20  EMI-ERROR-NUMBER    PIC X(4).
   367             20  EMI-FILL            PIC X.
   368             20  EMI-SEVERITY        PIC X.
   369             20  FILLER              PIC X.
   370             20  EMI-ERROR-TEXT.
   371                 24  EMI-TEXT-VARIABLE   PIC X(10).
   372                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  11
* EL1284.cbl
   373     12  EMI-SEVERITY-SAVE           PIC X.
   374         88  EMI-NOTE                    VALUE 'N'.
   375         88  EMI-WARNING                 VALUE 'W'.
   376         88  EMI-FORCABLE                VALUE 'F'.
   377         88  EMI-FATAL                   VALUE 'X'.
   378     12  EMI-MESSAGE-FLAG            PIC X.
   379         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   380         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   381     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   382     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   383         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   384         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   385         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   386     12  emi-claim-no                pic x(7).
   387     12  emi-claim-type              pic x(6).
   388     12  FILLER                      PIC X(124)  VALUE SPACES.
   389     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   390     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   391     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   392     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  12
* EL1284.cbl
   394*                       COPY ELCINTF.
   395******************************************************************
   396*                                                                *
   397*                                                                *
   398*                            ELCINTF.                            *
   399*                            VMOD=2.017                          *
   400*                                                                *
   401*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   402*                                                                *
   403*       LENGTH = 1024                                            *
   404*                                                                *
   405******************************************************************
   406*                   C H A N G E   L O G
   407*
   408* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   409*-----------------------------------------------------------------
   410*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   411* EFFECTIVE    NUMBER
   412*-----------------------------------------------------------------
   413* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   414******************************************************************
   415 01  PROGRAM-INTERFACE-BLOCK.
   416     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   417     12  PI-CALLING-PROGRAM              PIC X(8).
   418     12  PI-SAVED-PROGRAM-1              PIC X(8).
   419     12  PI-SAVED-PROGRAM-2              PIC X(8).
   420     12  PI-SAVED-PROGRAM-3              PIC X(8).
   421     12  PI-SAVED-PROGRAM-4              PIC X(8).
   422     12  PI-SAVED-PROGRAM-5              PIC X(8).
   423     12  PI-SAVED-PROGRAM-6              PIC X(8).
   424     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   425     12  PI-COMPANY-ID                   PIC XXX.
   426     12  PI-COMPANY-CD                   PIC X.
   427
   428     12  PI-COMPANY-PASSWORD             PIC X(8).
   429
   430     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   431
   432     12  PI-CONTROL-IN-PROGRESS.
   433         16  PI-CARRIER                  PIC X.
   434         16  PI-GROUPING                 PIC X(6).
   435         16  PI-STATE                    PIC XX.
   436         16  PI-ACCOUNT                  PIC X(10).
   437         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   438                                         PIC X(10).
   439         16  PI-CLAIM-CERT-GRP.
   440             20  PI-CLAIM-NO             PIC X(7).
   441             20  PI-CERT-NO.
   442                 25  PI-CERT-PRIME       PIC X(10).
   443                 25  PI-CERT-SFX         PIC X.
   444             20  PI-CERT-EFF-DT          PIC XX.
   445         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   446             20  PI-PLAN-CODE            PIC X(2).
   447             20  PI-REVISION-NUMBER      PIC X(3).
   448             20  PI-PLAN-EFF-DT          PIC X(2).
   449             20  PI-PLAN-EXP-DT          PIC X(2).
   450             20  FILLER                  PIC X(11).
   451         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  13
* EL1284.cbl
   452             20  PI-OE-REFERENCE-1.
   453                 25  PI-OE-REF-1-PRIME   PIC X(18).
   454                 25  PI-OE-REF-1-SUFF    PIC XX.
   455
   456     12  PI-SESSION-IN-PROGRESS          PIC X.
   457         88  CLAIM-SESSION                   VALUE '1'.
   458         88  CREDIT-SESSION                  VALUE '2'.
   459         88  WARRANTY-SESSION                VALUE '3'.
   460         88  MORTGAGE-SESSION                VALUE '4'.
   461         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   462
   463
   464*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   465
   466     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   467     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   468
   469     12  PI-CREDIT-USER                  PIC X.
   470         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   471         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   472
   473     12  PI-CLAIM-USER                   PIC X.
   474         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   475         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   476
   477     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   478         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   479         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   480         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   481         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   482         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   483
   484     12  PI-PROCESSOR-ID                 PIC X(4).
   485
   486     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   487
   488     12  PI-MEMBER-CAPTION               PIC X(10).
   489
   490     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   491         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   492
   493     12  PI-LIFE-OVERRIDE-L1             PIC X.
   494     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   495     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   496     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   497
   498     12  PI-AH-OVERRIDE-L1               PIC X.
   499     12  PI-AH-OVERRIDE-L2               PIC XX.
   500     12  PI-AH-OVERRIDE-L6               PIC X(6).
   501     12  PI-AH-OVERRIDE-L12              PIC X(12).
   502
   503     12  PI-NEW-SYSTEM                   PIC X(2).
   504
   505     12  PI-PRIMARY-CERT-NO              PIC X(11).
   506     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   507         88  PI-USES-PAID-TO                 VALUE '1'.
   508     12  PI-CRDTCRD-SYSTEM.
   509         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  14
* EL1284.cbl
   510             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   511             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   512         16  PI-CC-MONTH-END-DT          PIC XX.
   513     12  PI-PROCESSOR-PRINTER            PIC X(4).
   514
   515     12  PI-OE-REFERENCE-2.
   516         16  PI-OE-REF-2-PRIME           PIC X(10).
   517         16  PI-OE-REF-2-SUFF            PIC X.
   518
   519     12  PI-REM-TRM-CALC-OPTION          PIC X.
   520
   521     12  PI-LANGUAGE-TYPE                PIC X.
   522             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   523             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   524             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   525
   526     12  PI-POLICY-LINKAGE-IND           PIC X.
   527         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   528         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   529                                                   LOW-VALUES.
   530
   531     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   532     12  PI-CLAIM-PW-SESSION             PIC X(1).
   533         88  PI-CLAIM-CREDIT                 VALUE '1'.
   534         88  PI-CLAIM-CONVEN                 VALUE '2'.
   535
   536     12  PI-PROCESSOR-CSR-IND            PIC X.
   537         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   538         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   539
   540     12  FILLER                          PIC X(3).
   541
   542     12  PI-SYSTEM-LEVEL                 PIC X(145).
   543
   544     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   545         PI-SYSTEM-LEVEL.
   546
   547         16  PI-ENTRY-CODES.
   548             20  PI-ENTRY-CD-1           PIC X.
   549             20  PI-ENTRY-CD-2           PIC X.
   550
   551         16  PI-RETURN-CODES.
   552             20  PI-RETURN-CD-1          PIC X.
   553             20  PI-RETURN-CD-2          PIC X.
   554
   555         16  PI-UPDATE-STATUS-SAVE.
   556             20  PI-UPDATE-BY            PIC X(4).
   557             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   558
   559         16  PI-LOWER-CASE-LETTERS       PIC X.
   560             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   561
   562*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   563*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   564*            88  CARRIER-CLM-CNTL            VALUE '2'.
   565
   566         16  PI-CERT-ACCESS-CONTROL      PIC X.
   567             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  15
* EL1284.cbl
   568             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   569             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   570             88  ACCNT-CNTL                  VALUE '3'.
   571             88  CARR-ACCNT-CNTL             VALUE '4'.
   572
   573         16  PI-PROCESSOR-CAP-LIST.
   574             20  PI-SYSTEM-CONTROLS.
   575                24 PI-SYSTEM-DISPLAY     PIC X.
   576                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   577                24 PI-SYSTEM-MODIFY      PIC X.
   578                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   579             20  FILLER                  PIC XX.
   580             20  PI-DISPLAY-CAP          PIC X.
   581                 88  DISPLAY-CAP             VALUE 'Y'.
   582             20  PI-MODIFY-CAP           PIC X.
   583                 88  MODIFY-CAP              VALUE 'Y'.
   584             20  PI-MSG-AT-LOGON-CAP     PIC X.
   585                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   586             20  PI-FORCE-CAP            PIC X.
   587                 88  FORCE-CAP               VALUE 'Y'.
   588
   589         16  PI-PROGRAM-CONTROLS.
   590             20  PI-PGM-PRINT-OPT        PIC X.
   591             20  PI-PGM-FORMAT-OPT       PIC X.
   592             20  PI-PGM-PROCESS-OPT      PIC X.
   593             20  PI-PGM-TOTALS-OPT       PIC X.
   594
   595         16  PI-HELP-INTERFACE.
   596             20  PI-LAST-ERROR-NO        PIC X(4).
   597             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   598
   599         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   600             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   601
   602         16  PI-CR-CONTROL-IN-PROGRESS.
   603             20  PI-CR-CARRIER           PIC X.
   604             20  PI-CR-GROUPING          PIC X(6).
   605             20  PI-CR-STATE             PIC XX.
   606             20  PI-CR-ACCOUNT           PIC X(10).
   607             20  PI-CR-FIN-RESP          PIC X(10).
   608             20  PI-CR-TYPE              PIC X.
   609
   610         16  PI-CR-BATCH-NUMBER          PIC X(6).
   611
   612         16  PI-CR-MONTH-END-DT          PIC XX.
   613
   614         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   615             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   616             88  PI-ZERO-CARRIER             VALUE '1'.
   617             88  PI-ZERO-GROUPING            VALUE '2'.
   618             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   619
   620         16  PI-CARRIER-SECURITY         PIC X.
   621             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   622
   623         16  PI-ACCOUNT-SECURITY         PIC X(10).
   624             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   625             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  16
* EL1284.cbl
   626
   627         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   628             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   629                                         INDEXED BY PI-ACCESS-NDX
   630                                         PIC X.
   631
   632         16  PI-GA-BILLING-CONTROL       PIC X.
   633             88  PI-GA-BILLING               VALUE '1'.
   634
   635         16  PI-MAIL-PROCESSING          PIC X.
   636             88  PI-MAIL-YES                 VALUE 'Y'.
   637
   638         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   639
   640         16  PI-AR-SYSTEM.
   641             20  PI-AR-PROCESSING-CNTL   PIC X.
   642                 88  PI-AR-PROCESSING        VALUE 'Y'.
   643             20  PI-AR-SUMMARY-CODE      PIC X(6).
   644             20  PI-AR-MONTH-END-DT      PIC XX.
   645
   646         16  PI-MP-SYSTEM.
   647             20  PI-MORTGAGE-USER            PIC X.
   648                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   649                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   650             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   651                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   652                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   653                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   654                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   655                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   656             20  PI-MP-MONTH-END-DT          PIC XX.
   657             20  PI-MP-REFERENCE-NO.
   658                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   659                 24  PI-MP-REFERENCE-SFX     PIC XX.
   660
   661         16  PI-LABEL-CONTROL            PIC X(01).
   662             88  PI-CREATE-LABELS                    VALUE 'Y'.
   663             88  PI-BYPASS-LABELS                    VALUE 'N'.
   664
   665         16  PI-BILL-GROUPING-CODE       PIC X(01).
   666             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   667
   668         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   669             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   670             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   671
   672         16  FILLER                      PIC X(14).
   673
   674     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   675******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  17
* EL1284.cbl
   677     12  PI-EL1284-AREA    REDEFINES PI-PROGRAM-WORK-AREA.
   678         16  FILLER              PIC X(318).
   679         16  PI-TOTAL-LINES      PIC S9(3).
   680         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   681         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   682         16  PI-UPDATE-SW        PIC X.
   683             88  PI-CHANGES-MADE             VALUE '1'.
   684         16  PI-LONG-HLTH-APP    PIC  X(01).
   685         16  PI-REWRITE          PIC  X(01).
   686         16  PI-CHKCOVG          PIC  X(01).
   687         16  PI-MR-RELEASE-DATE  PIC  X(08).
   688         16  PI-BILLING-NOTES-EXIST PIC X.
   689         16  PI-CERT-NOTES-EXIST    PIC X.
   690         16  PI-CLAIM-NOTES-EXIST   PIC X.
   691         16  PI-SET-NOTE-CHANGE  PIC X.
   692             88 PI-CHANGE-IN-NOTE-TYPE       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  18
* EL1284.cbl
   694*                          COPY ELCATTR.
   695******************************************************************
   696*                                                                *
   697*                            ELCATTR.                            *
   698*                            VMOD=2.001                          *
   699*                                                                *
   700*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   701*                                                                *
   702*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   703*                                                                *
   704*                   POS 1   P=PROTECTED                          *
   705*                           U=UNPROTECTED                        *
   706*                           S=ASKIP                              *
   707*                   POS 2   A=ALPHA/NUMERIC                      *
   708*                           N=NUMERIC                            *
   709*                   POS 3   N=NORMAL                             *
   710*                           B=BRIGHT                             *
   711*                           D=DARK                               *
   712*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   713*                           OF=MODIFIED DATA TAG OFF             *
   714*                                                                *
   715*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   716******************************************************************
   717 01  ATTRIBUTE-LIST.
   718     12  AL-PABOF            PIC X       VALUE 'Y'.
   719     12  AL-PABON            PIC X       VALUE 'Z'.
   720     12  AL-PADOF            PIC X       VALUE '%'.
   721     12  AL-PADON            PIC X       VALUE '_'.
   722     12  AL-PANOF            PIC X       VALUE '-'.
   723     12  AL-PANON            PIC X       VALUE '/'.
   724     12  AL-SABOF            PIC X       VALUE '8'.
   725     12  AL-SABON            PIC X       VALUE '9'.
   726     12  AL-SADOF            PIC X       VALUE '@'.
   727     12  AL-SADON            PIC X       VALUE QUOTE.
   728     12  AL-SANOF            PIC X       VALUE '0'.
   729     12  AL-SANON            PIC X       VALUE '1'.
   730     12  AL-UABOF            PIC X       VALUE 'H'.
   731     12  AL-UABON            PIC X       VALUE 'I'.
   732     12  AL-UADOF            PIC X       VALUE '<'.
   733     12  AL-UADON            PIC X       VALUE '('.
   734     12  AL-UANOF            PIC X       VALUE ' '.
   735     12  AL-UANON            PIC X       VALUE 'A'.
   736     12  AL-UNBOF            PIC X       VALUE 'Q'.
   737     12  AL-UNBON            PIC X       VALUE 'R'.
   738     12  AL-UNDOF            PIC X       VALUE '*'.
   739     12  AL-UNDON            PIC X       VALUE ')'.
   740     12  AL-UNNOF            PIC X       VALUE '&'.
   741     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  19
* EL1284.cbl
   743*                          COPY ELCDATE.
   744******************************************************************
   745*                                                                *
   746*                                                                *
   747*                            ELCDATE.                            *
   748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   749*                            VMOD=2.003
   750*                                                                *
   751*                                                                *
   752*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   753*                 LENGTH = 200                                   *
   754******************************************************************
   755
   756 01  DATE-CONVERSION-DATA.
   757     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   758     12  DC-OPTION-CODE                PIC X.
   759         88  BIN-TO-GREG                VALUE ' '.
   760         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   761         88  EDIT-GREG-TO-BIN           VALUE '2'.
   762         88  YMD-GREG-TO-BIN            VALUE '3'.
   763         88  MDY-GREG-TO-BIN            VALUE '4'.
   764         88  JULIAN-TO-BIN              VALUE '5'.
   765         88  BIN-PLUS-ELAPSED           VALUE '6'.
   766         88  FIND-CENTURY               VALUE '7'.
   767         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   768         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   769         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   770         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   771         88  JULIAN-TO-BIN-3            VALUE 'C'.
   772         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   773         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   774         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   775         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   776         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   777         88  CHECK-LEAP-YEAR            VALUE 'H'.
   778         88  BIN-3-TO-GREG              VALUE 'I'.
   779         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   780         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   781         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   782         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   783         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   784         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   785         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   786         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   787         88  THREE-CHARACTER-BIN
   788                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   789         88  GREGORIAN-TO-BIN
   790                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   791         88  BIN-TO-GREGORIAN
   792                  VALUES ' ' '1' 'I' '8' 'G'.
   793         88  JULIAN-TO-BINARY
   794                  VALUES '5' 'C' 'E' 'F'.
   795     12  DC-ERROR-CODE                 PIC X.
   796         88  NO-CONVERSION-ERROR        VALUE ' '.
   797         88  DATE-CONVERSION-ERROR
   798                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   799         88  DATE-IS-ZERO               VALUE '1'.
   800         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  20
* EL1284.cbl
   801         88  DATE-IS-INVALID            VALUE '3'.
   802         88  DATE1-GREATER-DATE2        VALUE '4'.
   803         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   804         88  DATE-INVALID-OPTION        VALUE '9'.
   805         88  INVALID-CENTURY            VALUE 'A'.
   806         88  ONLY-CENTURY               VALUE 'B'.
   807         88  ONLY-LEAP-YEAR             VALUE 'C'.
   808         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   809     12  DC-END-OF-MONTH               PIC X.
   810         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   811     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   812         88  USE-NORMAL-PROCESS         VALUE ' '.
   813         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   814         88  ADJUST-UP-100-YRS          VALUE '2'.
   815     12  FILLER                        PIC X.
   816     12  DC-CONVERSION-DATES.
   817         16  DC-BIN-DATE-1             PIC XX.
   818         16  DC-BIN-DATE-2             PIC XX.
   819         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   820         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   821                       DC-GREG-DATE-1-EDIT.
   822             20  DC-EDIT1-MONTH        PIC 99.
   823             20  SLASH1-1              PIC X.
   824             20  DC-EDIT1-DAY          PIC 99.
   825             20  SLASH1-2              PIC X.
   826             20  DC-EDIT1-YEAR         PIC 99.
   827         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   828         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   829                     DC-GREG-DATE-2-EDIT.
   830             20  DC-EDIT2-MONTH        PIC 99.
   831             20  SLASH2-1              PIC X.
   832             20  DC-EDIT2-DAY          PIC 99.
   833             20  SLASH2-2              PIC X.
   834             20  DC-EDIT2-YEAR         PIC 99.
   835         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   836         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   837                     DC-GREG-DATE-1-YMD.
   838             20  DC-YMD-YEAR           PIC 99.
   839             20  DC-YMD-MONTH          PIC 99.
   840             20  DC-YMD-DAY            PIC 99.
   841         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   842         16  DC-GREG-DATE-1-MDY-R REDEFINES
   843                      DC-GREG-DATE-1-MDY.
   844             20  DC-MDY-MONTH          PIC 99.
   845             20  DC-MDY-DAY            PIC 99.
   846             20  DC-MDY-YEAR           PIC 99.
   847         16  DC-GREG-DATE-1-ALPHA.
   848             20  DC-ALPHA-MONTH        PIC X(10).
   849             20  DC-ALPHA-DAY          PIC 99.
   850             20  FILLER                PIC XX.
   851             20  DC-ALPHA-CENTURY.
   852                 24 DC-ALPHA-CEN-N     PIC 99.
   853             20  DC-ALPHA-YEAR         PIC 99.
   854         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   855         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   856         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   857         16  DC-JULIAN-DATE            PIC 9(05).
   858         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  21
* EL1284.cbl
   859                                       PIC 9(05).
   860         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   861             20  DC-JULIAN-YEAR        PIC 99.
   862             20  DC-JULIAN-DAYS        PIC 999.
   863         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   864         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   865         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   866     12  DATE-CONVERSION-VARIBLES.
   867         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   868         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   869             20  FILLER                PIC 9(3).
   870             20  HOLD-CEN-1-CCYY.
   871                 24  HOLD-CEN-1-CC     PIC 99.
   872                 24  HOLD-CEN-1-YY     PIC 99.
   873             20  HOLD-CEN-1-MO         PIC 99.
   874             20  HOLD-CEN-1-DA         PIC 99.
   875         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   876             20  HOLD-CEN-1-R-MO       PIC 99.
   877             20  HOLD-CEN-1-R-DA       PIC 99.
   878             20  HOLD-CEN-1-R-CCYY.
   879                 24  HOLD-CEN-1-R-CC   PIC 99.
   880                 24  HOLD-CEN-1-R-YY   PIC 99.
   881             20  FILLER                PIC 9(3).
   882         16  HOLD-CENTURY-1-X.
   883             20  FILLER                PIC X(3)  VALUE SPACES.
   884             20  HOLD-CEN-1-X-CCYY.
   885                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   886                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   887             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   888             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   889         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   890             20  HOLD-CEN-1-R-X-MO     PIC XX.
   891             20  HOLD-CEN-1-R-X-DA     PIC XX.
   892             20  HOLD-CEN-1-R-X-CCYY.
   893                 24  HOLD-CEN-1-R-X-CC PIC XX.
   894                 24  HOLD-CEN-1-R-X-YY PIC XX.
   895             20  FILLER                PIC XXX.
   896         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   897         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   898         16  DC-JULIAN-DATE-1          PIC 9(07).
   899         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   900             20  DC-JULIAN-1-CCYY.
   901                 24  DC-JULIAN-1-CC    PIC 99.
   902                 24  DC-JULIAN-1-YR    PIC 99.
   903             20  DC-JULIAN-DA-1        PIC 999.
   904         16  DC-JULIAN-DATE-2          PIC 9(07).
   905         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   906             20  DC-JULIAN-2-CCYY.
   907                 24  DC-JULIAN-2-CC    PIC 99.
   908                 24  DC-JULIAN-2-YR    PIC 99.
   909             20  DC-JULIAN-DA-2        PIC 999.
   910         16  DC-GREG-DATE-A-EDIT.
   911             20  DC-EDITA-MONTH        PIC 99.
   912             20  SLASHA-1              PIC X VALUE '/'.
   913             20  DC-EDITA-DAY          PIC 99.
   914             20  SLASHA-2              PIC X VALUE '/'.
   915             20  DC-EDITA-CCYY.
   916                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  22
* EL1284.cbl
   917                 24  DC-EDITA-YEAR     PIC 99.
   918         16  DC-GREG-DATE-B-EDIT.
   919             20  DC-EDITB-MONTH        PIC 99.
   920             20  SLASHB-1              PIC X VALUE '/'.
   921             20  DC-EDITB-DAY          PIC 99.
   922             20  SLASHB-2              PIC X VALUE '/'.
   923             20  DC-EDITB-CCYY.
   924                 24  DC-EDITB-CENT     PIC 99.
   925                 24  DC-EDITB-YEAR     PIC 99.
   926         16  DC-GREG-DATE-CYMD         PIC 9(08).
   927         16  DC-GREG-DATE-CYMD-R REDEFINES
   928                              DC-GREG-DATE-CYMD.
   929             20  DC-CYMD-CEN           PIC 99.
   930             20  DC-CYMD-YEAR          PIC 99.
   931             20  DC-CYMD-MONTH         PIC 99.
   932             20  DC-CYMD-DAY           PIC 99.
   933         16  DC-GREG-DATE-MDCY         PIC 9(08).
   934         16  DC-GREG-DATE-MDCY-R REDEFINES
   935                              DC-GREG-DATE-MDCY.
   936             20  DC-MDCY-MONTH         PIC 99.
   937             20  DC-MDCY-DAY           PIC 99.
   938             20  DC-MDCY-CEN           PIC 99.
   939             20  DC-MDCY-YEAR          PIC 99.
   940    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   941        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   942    12  DC-EL310-DATE                  PIC X(21).
   943    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  23
* EL1284.cbl
   945*                          COPY EL1284S.
   946 01  EL1284AI.
   947     05  FILLER            PIC  X(0012).
   948*    -------------------------------
   949     05  DATEL PIC S9(0004) COMP.
   950     05  DATEF PIC  X(0001).
   951     05  FILLER REDEFINES DATEF.
   952         10  DATEA PIC  X(0001).
   953     05  DATEI PIC  X(0008).
   954*    -------------------------------
   955     05  TIMEL PIC S9(0004) COMP.
   956     05  TIMEF PIC  X(0001).
   957     05  FILLER REDEFINES TIMEF.
   958         10  TIMEA PIC  X(0001).
   959     05  TIMEI PIC  X(0005).
   960*    -------------------------------
   961     05  CMPNYIDL PIC S9(0004) COMP.
   962     05  CMPNYIDF PIC  X(0001).
   963     05  FILLER REDEFINES CMPNYIDF.
   964         10  CMPNYIDA PIC  X(0001).
   965     05  CMPNYIDI PIC  X(0003).
   966*    -------------------------------
   967     05  USERIDL PIC S9(0004) COMP.
   968     05  USERIDF PIC  X(0001).
   969     05  FILLER REDEFINES USERIDF.
   970         10  USERIDA PIC  X(0001).
   971     05  USERIDI PIC  X(0004).
   972*    -------------------------------
   973     05  CLAIMNOL PIC S9(0004) COMP.
   974     05  CLAIMNOF PIC  X(0001).
   975     05  FILLER REDEFINES CLAIMNOF.
   976         10  CLAIMNOA PIC  X(0001).
   977     05  CLAIMNOI PIC  X(0007).
   978*    -------------------------------
   979     05  TYPEL PIC S9(0004) COMP.
   980     05  TYPEF PIC  X(0001).
   981     05  FILLER REDEFINES TYPEF.
   982         10  TYPEA PIC  X(0001).
   983     05  TYPEI PIC  X(0006).
   984*    -------------------------------
   985     05  CARRL PIC S9(0004) COMP.
   986     05  CARRF PIC  X(0001).
   987     05  FILLER REDEFINES CARRF.
   988         10  CARRA PIC  X(0001).
   989     05  CARRI PIC  X(0001).
   990*    -------------------------------
   991     05  CERTNOL PIC S9(0004) COMP.
   992     05  CERTNOF PIC  X(0001).
   993     05  FILLER REDEFINES CERTNOF.
   994         10  CERTNOA PIC  X(0001).
   995     05  CERTNOI PIC  X(0011).
   996*    -------------------------------
   997     05  FSTNMEL PIC S9(0004) COMP.
   998     05  FSTNMEF PIC  X(0001).
   999     05  FILLER REDEFINES FSTNMEF.
  1000         10  FSTNMEA PIC  X(0001).
  1001     05  FSTNMEI PIC  X(0012).
  1002*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  24
* EL1284.cbl
  1003     05  LASTNMEL PIC S9(0004) COMP.
  1004     05  LASTNMEF PIC  X(0001).
  1005     05  FILLER REDEFINES LASTNMEF.
  1006         10  LASTNMEA PIC  X(0001).
  1007     05  LASTNMEI PIC  X(0015).
  1008*    -------------------------------
  1009     05  TOTL PIC S9(0004) COMP.
  1010     05  TOTF PIC  X(0001).
  1011     05  FILLER REDEFINES TOTF.
  1012         10  TOTA PIC  X(0001).
  1013     05  TOTI PIC  X(0003).
  1014*    -------------------------------
  1015     05  LNGHLAPL PIC S9(0004) COMP.
  1016     05  LNGHLAPF PIC  X(0001).
  1017     05  FILLER REDEFINES LNGHLAPF.
  1018         10  LNGHLAPA PIC  X(0001).
  1019     05  LNGHLAPI PIC  X(0001).
  1020*    -------------------------------
  1021     05  REWRITEL PIC S9(0004) COMP.
  1022     05  REWRITEF PIC  X(0001).
  1023     05  FILLER REDEFINES REWRITEF.
  1024         10  REWRITEA PIC  X(0001).
  1025     05  REWRITEI PIC  X(0001).
  1026*    -------------------------------
  1027     05  CHKCOVGL PIC S9(0004) COMP.
  1028     05  CHKCOVGF PIC  X(0001).
  1029     05  FILLER REDEFINES CHKCOVGF.
  1030         10  CHKCOVGA PIC  X(0001).
  1031     05  CHKCOVGI PIC  X(0001).
  1032*    -------------------------------
  1033     05  MRRELDTL PIC S9(0004) COMP.
  1034     05  MRRELDTF PIC  X(0001).
  1035     05  FILLER REDEFINES MRRELDTF.
  1036         10  MRRELDTA PIC  X(0001).
  1037     05  MRRELDTI PIC  X(0008).
  1038*    -------------------------------
  1039     05  LN1L PIC S9(0004) COMP.
  1040     05  LN1F PIC  X(0001).
  1041     05  FILLER REDEFINES LN1F.
  1042         10  LN1A PIC  X(0001).
  1043     05  LN1I PIC  X(0003).
  1044*    -------------------------------
  1045     05  FNLINE1L PIC S9(0004) COMP.
  1046     05  FNLINE1F PIC  X(0001).
  1047     05  FILLER REDEFINES FNLINE1F.
  1048         10  FNLINE1A PIC  X(0001).
  1049     05  FNLINE1I PIC  X(0063).
  1050*    -------------------------------
  1051     05  MTBY1L PIC S9(0004) COMP.
  1052     05  MTBY1F PIC  X(0001).
  1053     05  FILLER REDEFINES MTBY1F.
  1054         10  MTBY1A PIC  X(0001).
  1055     05  MTBY1I PIC  X(0004).
  1056*    -------------------------------
  1057     05  MTDT1L PIC S9(0004) COMP.
  1058     05  MTDT1F PIC  X(0001).
  1059     05  FILLER REDEFINES MTDT1F.
  1060         10  MTDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  25
* EL1284.cbl
  1061     05  MTDT1I PIC  X(0006).
  1062*    -------------------------------
  1063     05  LN2L PIC S9(0004) COMP.
  1064     05  LN2F PIC  X(0001).
  1065     05  FILLER REDEFINES LN2F.
  1066         10  LN2A PIC  X(0001).
  1067     05  LN2I PIC  X(0003).
  1068*    -------------------------------
  1069     05  FNLINE2L PIC S9(0004) COMP.
  1070     05  FNLINE2F PIC  X(0001).
  1071     05  FILLER REDEFINES FNLINE2F.
  1072         10  FNLINE2A PIC  X(0001).
  1073     05  FNLINE2I PIC  X(0063).
  1074*    -------------------------------
  1075     05  MTBY2L PIC S9(0004) COMP.
  1076     05  MTBY2F PIC  X(0001).
  1077     05  FILLER REDEFINES MTBY2F.
  1078         10  MTBY2A PIC  X(0001).
  1079     05  MTBY2I PIC  X(0004).
  1080*    -------------------------------
  1081     05  MTDT2L PIC S9(0004) COMP.
  1082     05  MTDT2F PIC  X(0001).
  1083     05  FILLER REDEFINES MTDT2F.
  1084         10  MTDT2A PIC  X(0001).
  1085     05  MTDT2I PIC  X(0006).
  1086*    -------------------------------
  1087     05  LN3L PIC S9(0004) COMP.
  1088     05  LN3F PIC  X(0001).
  1089     05  FILLER REDEFINES LN3F.
  1090         10  LN3A PIC  X(0001).
  1091     05  LN3I PIC  X(0003).
  1092*    -------------------------------
  1093     05  FNLINE3L PIC S9(0004) COMP.
  1094     05  FNLINE3F PIC  X(0001).
  1095     05  FILLER REDEFINES FNLINE3F.
  1096         10  FNLINE3A PIC  X(0001).
  1097     05  FNLINE3I PIC  X(0063).
  1098*    -------------------------------
  1099     05  MTBY3L PIC S9(0004) COMP.
  1100     05  MTBY3F PIC  X(0001).
  1101     05  FILLER REDEFINES MTBY3F.
  1102         10  MTBY3A PIC  X(0001).
  1103     05  MTBY3I PIC  X(0004).
  1104*    -------------------------------
  1105     05  MTDT3L PIC S9(0004) COMP.
  1106     05  MTDT3F PIC  X(0001).
  1107     05  FILLER REDEFINES MTDT3F.
  1108         10  MTDT3A PIC  X(0001).
  1109     05  MTDT3I PIC  X(0006).
  1110*    -------------------------------
  1111     05  LN4L PIC S9(0004) COMP.
  1112     05  LN4F PIC  X(0001).
  1113     05  FILLER REDEFINES LN4F.
  1114         10  LN4A PIC  X(0001).
  1115     05  LN4I PIC  X(0003).
  1116*    -------------------------------
  1117     05  FNLINE4L PIC S9(0004) COMP.
  1118     05  FNLINE4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  26
* EL1284.cbl
  1119     05  FILLER REDEFINES FNLINE4F.
  1120         10  FNLINE4A PIC  X(0001).
  1121     05  FNLINE4I PIC  X(0063).
  1122*    -------------------------------
  1123     05  MTBY4L PIC S9(0004) COMP.
  1124     05  MTBY4F PIC  X(0001).
  1125     05  FILLER REDEFINES MTBY4F.
  1126         10  MTBY4A PIC  X(0001).
  1127     05  MTBY4I PIC  X(0004).
  1128*    -------------------------------
  1129     05  MTDT4L PIC S9(0004) COMP.
  1130     05  MTDT4F PIC  X(0001).
  1131     05  FILLER REDEFINES MTDT4F.
  1132         10  MTDT4A PIC  X(0001).
  1133     05  MTDT4I PIC  X(0006).
  1134*    -------------------------------
  1135     05  LN5L PIC S9(0004) COMP.
  1136     05  LN5F PIC  X(0001).
  1137     05  FILLER REDEFINES LN5F.
  1138         10  LN5A PIC  X(0001).
  1139     05  LN5I PIC  X(0003).
  1140*    -------------------------------
  1141     05  FNLINE5L PIC S9(0004) COMP.
  1142     05  FNLINE5F PIC  X(0001).
  1143     05  FILLER REDEFINES FNLINE5F.
  1144         10  FNLINE5A PIC  X(0001).
  1145     05  FNLINE5I PIC  X(0063).
  1146*    -------------------------------
  1147     05  MTBY5L PIC S9(0004) COMP.
  1148     05  MTBY5F PIC  X(0001).
  1149     05  FILLER REDEFINES MTBY5F.
  1150         10  MTBY5A PIC  X(0001).
  1151     05  MTBY5I PIC  X(0004).
  1152*    -------------------------------
  1153     05  MTDT5L PIC S9(0004) COMP.
  1154     05  MTDT5F PIC  X(0001).
  1155     05  FILLER REDEFINES MTDT5F.
  1156         10  MTDT5A PIC  X(0001).
  1157     05  MTDT5I PIC  X(0006).
  1158*    -------------------------------
  1159     05  LN6L PIC S9(0004) COMP.
  1160     05  LN6F PIC  X(0001).
  1161     05  FILLER REDEFINES LN6F.
  1162         10  LN6A PIC  X(0001).
  1163     05  LN6I PIC  X(0003).
  1164*    -------------------------------
  1165     05  FNLINE6L PIC S9(0004) COMP.
  1166     05  FNLINE6F PIC  X(0001).
  1167     05  FILLER REDEFINES FNLINE6F.
  1168         10  FNLINE6A PIC  X(0001).
  1169     05  FNLINE6I PIC  X(0063).
  1170*    -------------------------------
  1171     05  MTBY6L PIC S9(0004) COMP.
  1172     05  MTBY6F PIC  X(0001).
  1173     05  FILLER REDEFINES MTBY6F.
  1174         10  MTBY6A PIC  X(0001).
  1175     05  MTBY6I PIC  X(0004).
  1176*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  27
* EL1284.cbl
  1177     05  MTDT6L PIC S9(0004) COMP.
  1178     05  MTDT6F PIC  X(0001).
  1179     05  FILLER REDEFINES MTDT6F.
  1180         10  MTDT6A PIC  X(0001).
  1181     05  MTDT6I PIC  X(0006).
  1182*    -------------------------------
  1183     05  LN7L PIC S9(0004) COMP.
  1184     05  LN7F PIC  X(0001).
  1185     05  FILLER REDEFINES LN7F.
  1186         10  LN7A PIC  X(0001).
  1187     05  LN7I PIC  X(0003).
  1188*    -------------------------------
  1189     05  FNLINE7L PIC S9(0004) COMP.
  1190     05  FNLINE7F PIC  X(0001).
  1191     05  FILLER REDEFINES FNLINE7F.
  1192         10  FNLINE7A PIC  X(0001).
  1193     05  FNLINE7I PIC  X(0063).
  1194*    -------------------------------
  1195     05  MTBY7L PIC S9(0004) COMP.
  1196     05  MTBY7F PIC  X(0001).
  1197     05  FILLER REDEFINES MTBY7F.
  1198         10  MTBY7A PIC  X(0001).
  1199     05  MTBY7I PIC  X(0004).
  1200*    -------------------------------
  1201     05  MTDT7L PIC S9(0004) COMP.
  1202     05  MTDT7F PIC  X(0001).
  1203     05  FILLER REDEFINES MTDT7F.
  1204         10  MTDT7A PIC  X(0001).
  1205     05  MTDT7I PIC  X(0006).
  1206*    -------------------------------
  1207     05  LN8L PIC S9(0004) COMP.
  1208     05  LN8F PIC  X(0001).
  1209     05  FILLER REDEFINES LN8F.
  1210         10  LN8A PIC  X(0001).
  1211     05  LN8I PIC  X(0003).
  1212*    -------------------------------
  1213     05  FNLINE8L PIC S9(0004) COMP.
  1214     05  FNLINE8F PIC  X(0001).
  1215     05  FILLER REDEFINES FNLINE8F.
  1216         10  FNLINE8A PIC  X(0001).
  1217     05  FNLINE8I PIC  X(0063).
  1218*    -------------------------------
  1219     05  MTBY8L PIC S9(0004) COMP.
  1220     05  MTBY8F PIC  X(0001).
  1221     05  FILLER REDEFINES MTBY8F.
  1222         10  MTBY8A PIC  X(0001).
  1223     05  MTBY8I PIC  X(0004).
  1224*    -------------------------------
  1225     05  MTDT8L PIC S9(0004) COMP.
  1226     05  MTDT8F PIC  X(0001).
  1227     05  FILLER REDEFINES MTDT8F.
  1228         10  MTDT8A PIC  X(0001).
  1229     05  MTDT8I PIC  X(0006).
  1230*    -------------------------------
  1231     05  LN9L PIC S9(0004) COMP.
  1232     05  LN9F PIC  X(0001).
  1233     05  FILLER REDEFINES LN9F.
  1234         10  LN9A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  28
* EL1284.cbl
  1235     05  LN9I PIC  X(0003).
  1236*    -------------------------------
  1237     05  FNLINE9L PIC S9(0004) COMP.
  1238     05  FNLINE9F PIC  X(0001).
  1239     05  FILLER REDEFINES FNLINE9F.
  1240         10  FNLINE9A PIC  X(0001).
  1241     05  FNLINE9I PIC  X(0063).
  1242*    -------------------------------
  1243     05  MTBY9L PIC S9(0004) COMP.
  1244     05  MTBY9F PIC  X(0001).
  1245     05  FILLER REDEFINES MTBY9F.
  1246         10  MTBY9A PIC  X(0001).
  1247     05  MTBY9I PIC  X(0004).
  1248*    -------------------------------
  1249     05  MTDT9L PIC S9(0004) COMP.
  1250     05  MTDT9F PIC  X(0001).
  1251     05  FILLER REDEFINES MTDT9F.
  1252         10  MTDT9A PIC  X(0001).
  1253     05  MTDT9I PIC  X(0006).
  1254*    -------------------------------
  1255     05  LN10L PIC S9(0004) COMP.
  1256     05  LN10F PIC  X(0001).
  1257     05  FILLER REDEFINES LN10F.
  1258         10  LN10A PIC  X(0001).
  1259     05  LN10I PIC  X(0003).
  1260*    -------------------------------
  1261     05  FNLIN10L PIC S9(0004) COMP.
  1262     05  FNLIN10F PIC  X(0001).
  1263     05  FILLER REDEFINES FNLIN10F.
  1264         10  FNLIN10A PIC  X(0001).
  1265     05  FNLIN10I PIC  X(0063).
  1266*    -------------------------------
  1267     05  MTBY10L PIC S9(0004) COMP.
  1268     05  MTBY10F PIC  X(0001).
  1269     05  FILLER REDEFINES MTBY10F.
  1270         10  MTBY10A PIC  X(0001).
  1271     05  MTBY10I PIC  X(0004).
  1272*    -------------------------------
  1273     05  MTDT10L PIC S9(0004) COMP.
  1274     05  MTDT10F PIC  X(0001).
  1275     05  FILLER REDEFINES MTDT10F.
  1276         10  MTDT10A PIC  X(0001).
  1277     05  MTDT10I PIC  X(0006).
  1278*    -------------------------------
  1279     05  ERRMSGBL PIC S9(0004) COMP.
  1280     05  ERRMSGBF PIC  X(0001).
  1281     05  FILLER REDEFINES ERRMSGBF.
  1282         10  ERRMSGBA PIC  X(0001).
  1283     05  ERRMSGBI PIC  X(0072).
  1284*    -------------------------------
  1285     05  FUNCTL PIC S9(0004) COMP.
  1286     05  FUNCTF PIC  X(0001).
  1287     05  FILLER REDEFINES FUNCTF.
  1288         10  FUNCTA PIC  X(0001).
  1289     05  FUNCTI PIC  X(0001).
  1290*    -------------------------------
  1291     05  LINE1L PIC S9(0004) COMP.
  1292     05  LINE1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  29
* EL1284.cbl
  1293     05  FILLER REDEFINES LINE1F.
  1294         10  LINE1A PIC  X(0001).
  1295     05  LINE1I PIC  999.
  1296*    -------------------------------
  1297     05  LINE2L PIC S9(0004) COMP.
  1298     05  LINE2F PIC  X(0001).
  1299     05  FILLER REDEFINES LINE2F.
  1300         10  LINE2A PIC  X(0001).
  1301     05  LINE2I PIC  999.
  1302*    -------------------------------
  1303     05  PFENTERL PIC S9(0004) COMP.
  1304     05  PFENTERF PIC  X(0001).
  1305     05  FILLER REDEFINES PFENTERF.
  1306         10  PFENTERA PIC  X(0001).
  1307     05  PFENTERI PIC  99.
  1308*    -------------------------------
  1309     05  PF6NOTEL PIC S9(0004) COMP.
  1310     05  PF6NOTEF PIC  X(0001).
  1311     05  FILLER REDEFINES PF6NOTEF.
  1312         10  PF6NOTEA PIC  X(0001).
  1313     05  PF6NOTEI PIC  X(0017).
  1314 01  EL1284AO REDEFINES EL1284AI.
  1315     05  FILLER            PIC  X(0012).
  1316*    -------------------------------
  1317     05  FILLER            PIC  X(0003).
  1318     05  DATEO PIC  X(0008).
  1319*    -------------------------------
  1320     05  FILLER            PIC  X(0003).
  1321     05  TIMEO PIC  99.99.
  1322*    -------------------------------
  1323     05  FILLER            PIC  X(0003).
  1324     05  CMPNYIDO PIC  X(0003).
  1325*    -------------------------------
  1326     05  FILLER            PIC  X(0003).
  1327     05  USERIDO PIC  X(0004).
  1328*    -------------------------------
  1329     05  FILLER            PIC  X(0003).
  1330     05  CLAIMNOO PIC  X(0007).
  1331*    -------------------------------
  1332     05  FILLER            PIC  X(0003).
  1333     05  TYPEO PIC  X(0006).
  1334*    -------------------------------
  1335     05  FILLER            PIC  X(0003).
  1336     05  CARRO PIC  X(0001).
  1337*    -------------------------------
  1338     05  FILLER            PIC  X(0003).
  1339     05  CERTNOO PIC  X(0011).
  1340*    -------------------------------
  1341     05  FILLER            PIC  X(0003).
  1342     05  FSTNMEO PIC  X(0012).
  1343*    -------------------------------
  1344     05  FILLER            PIC  X(0003).
  1345     05  LASTNMEO PIC  X(0015).
  1346*    -------------------------------
  1347     05  FILLER            PIC  X(0003).
  1348     05  TOTO PIC  ZZ9.
  1349*    -------------------------------
  1350     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  30
* EL1284.cbl
  1351     05  LNGHLAPO PIC  X(0001).
  1352*    -------------------------------
  1353     05  FILLER            PIC  X(0003).
  1354     05  REWRITEO PIC  X(0001).
  1355*    -------------------------------
  1356     05  FILLER            PIC  X(0003).
  1357     05  CHKCOVGO PIC  X(0001).
  1358*    -------------------------------
  1359     05  FILLER            PIC  X(0003).
  1360     05  MRRELDTO PIC  X(0008).
  1361*    -------------------------------
  1362     05  FILLER            PIC  X(0003).
  1363     05  LN1O PIC  ZZ9.
  1364*    -------------------------------
  1365     05  FILLER            PIC  X(0003).
  1366     05  FNLINE1O PIC  X(0063).
  1367*    -------------------------------
  1368     05  FILLER            PIC  X(0003).
  1369     05  MTBY1O PIC  X(0004).
  1370*    -------------------------------
  1371     05  FILLER            PIC  X(0003).
  1372     05  MTDT1O PIC  X(0006).
  1373*    -------------------------------
  1374     05  FILLER            PIC  X(0003).
  1375     05  LN2O PIC  ZZ9.
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(0003).
  1378     05  FNLINE2O PIC  X(0063).
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  MTBY2O PIC  X(0004).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  MTDT2O PIC  X(0006).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  LN3O PIC  ZZ9.
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  FNLINE3O PIC  X(0063).
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  MTBY3O PIC  X(0004).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  MTDT3O PIC  X(0006).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  LN4O PIC  ZZ9.
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  FNLINE4O PIC  X(0063).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  MTBY4O PIC  X(0004).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  MTDT4O PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  31
* EL1284.cbl
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  LN5O PIC  ZZ9.
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(0003).
  1414     05  FNLINE5O PIC  X(0063).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  MTBY5O PIC  X(0004).
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  MTDT5O PIC  X(0006).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  LN6O PIC  ZZ9.
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  FNLINE6O PIC  X(0063).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  MTBY6O PIC  X(0004).
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  MTDT6O PIC  X(0006).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  LN7O PIC  ZZ9.
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  FNLINE7O PIC  X(0063).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  MTBY7O PIC  X(0004).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  MTDT7O PIC  X(0006).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  LN8O PIC  ZZ9.
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  FNLINE8O PIC  X(0063).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  MTBY8O PIC  X(0004).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  MTDT8O PIC  X(0006).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  LN9O PIC  ZZ9.
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  FNLINE9O PIC  X(0063).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  MTBY9O PIC  X(0004).
  1466*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  32
* EL1284.cbl
  1467     05  FILLER            PIC  X(0003).
  1468     05  MTDT9O PIC  X(0006).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
  1471     05  LN10O PIC  ZZ9.
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  FNLIN10O PIC  X(0063).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  MTBY10O PIC  X(0004).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  MTDT10O PIC  X(0006).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  ERRMSGBO PIC  X(0072).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  FUNCTO PIC  X(0001).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  LINE1O PIC  X(0003).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  LINE2O PIC  X(0003).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  PFENTERO PIC  X(0002).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  PF6NOTEO PIC  X(0017).
  1499*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  33
* EL1284.cbl
  1501*01  EL1284R REDEFINES EL1284AI.
  1502 66 GROUP2  RENAMES LN1L THRU MTDT10I.
  1503 01  EL1284R.
  1504*    12  FILLER                  PIC X(202).
  1505     12  SC-ALL-LINES.
  1506      14 SC-LINES OCCURS 10 TIMES INDEXED BY SC-INDX.
  1507         16  SC-LINL             PIC S9(4)   COMP.
  1508         16  SC-LINA             PIC X.
  1509         16  SC-LIN              PIC ZZ9.
  1510         16  SC-TEXTL            PIC S9(4)   COMP.
  1511         16  SC-TEXTA            PIC X.
  1512         16  SC-TEXT             PIC X(63).
  1513         16  SC-MTBYL            PIC S9(4)   COMP.
  1514         16  SC-MTBYA            PIC X.
  1515         16  SC-MTBY             PIC X(4).
  1516         16  SC-MTDTL            PIC S9(4)   COMP.
  1517         16  SC-MTDTA            PIC X.
  1518         16  SC-MTDT             PIC X(6).
  1519*    12  FILLER                  PIC X(116).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  34
* EL1284.cbl
  1521 01  RECORD-TABLE                PIC X(21900) VALUE SPACES.
  1522 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1523     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3650).
  1524 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1525     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1526         16  REC-TEXT                    PIC X(63).
  1527         16  REC-LAST-MAINT-BY           PIC XXXX.
  1528         16  REC-LAST-MAINT-DT           PIC XX.
  1529         16  REC-LAST-MAINT-HHMMSS       PIC S9(7) COMP-3.
  1530
  1531 01  TS-WORK-AREA                        PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  35
* EL1284.cbl
  1533*        COPY ELCMSTR.
  1534******************************************************************
  1535*                                                                *
  1536*                            ELCMSTR.                            *
  1537*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1538*                            VMOD=2.012                          *
  1539*                                                                *
  1540*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1541*                                                                *
  1542*   FILE TYPE = VSAM,KSDS                                        *
  1543*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1544*                                                                *
  1545*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1546*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1547*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1548*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1549*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1550*                                                 RKP=75,LEN=21  *
  1551*                                                                *
  1552*   **** NOTE ****                                               *
  1553*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1554*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1555*                                                                *
  1556*   LOG = YES                                                    *
  1557*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1558******************************************************************
  1559*                   C H A N G E   L O G
  1560*
  1561* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1562*-----------------------------------------------------------------
  1563*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1564* EFFECTIVE    NUMBER
  1565*-----------------------------------------------------------------
  1566* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1567* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1568* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1569* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1570* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1571******************************************************************
  1572 01  CLAIM-MASTER.
  1573     12  CL-RECORD-ID                PIC XX.
  1574         88  VALID-CL-ID         VALUE 'CL'.
  1575
  1576     12  CL-CONTROL-PRIMARY.
  1577         16  CL-COMPANY-CD           PIC X.
  1578         16  CL-CARRIER              PIC X.
  1579         16  CL-CLAIM-NO             PIC X(7).
  1580         16  CL-CERT-NO.
  1581             20  CL-CERT-PRIME       PIC X(10).
  1582             20  CL-CERT-SFX         PIC X.
  1583
  1584     12  CL-CONTROL-BY-NAME.
  1585         16  CL-COMPANY-CD-A1        PIC X.
  1586         16  CL-INSURED-LAST-NAME    PIC X(15).
  1587         16  CL-INSURED-NAME.
  1588             20  CL-INSURED-1ST-NAME PIC X(12).
  1589             20  CL-INSURED-MID-INIT PIC X.
  1590
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  36
* EL1284.cbl
  1591     12  CL-CONTROL-BY-SSN.
  1592         16  CL-COMPANY-CD-A2        PIC X.
  1593         16  CL-SOC-SEC-NO.
  1594             20  CL-SSN-STATE        PIC XX.
  1595             20  CL-SSN-ACCOUNT      PIC X(6).
  1596             20  CL-SSN-LN3          PIC X(3).
  1597
  1598     12  CL-CONTROL-BY-CERT-NO.
  1599         16  CL-COMPANY-CD-A4        PIC X.
  1600         16  CL-CERT-NO-A4.
  1601             20  CL-CERT-A4-PRIME    PIC X(10).
  1602             20  CL-CERT-A4-SFX      PIC X.
  1603
  1604     12  CL-CONTROL-BY-CCN.
  1605         16  CL-COMPANY-CD-A5        PIC X.
  1606         16  CL-CCN-A5.
  1607             20  CL-CCN.
  1608                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1609                 24  CL-CCN-PRIME-A5 PIC X(12).
  1610             20  CL-CCN-FILLER-A5    PIC X(4).
  1611
  1612     12  CL-INSURED-PROFILE-DATA.
  1613         16  CL-INSURED-BIRTH-DT     PIC XX.
  1614         16  CL-INSURED-SEX-CD       PIC X.
  1615             88  INSURED-IS-MALE        VALUE 'M'.
  1616             88  INSURED-IS-FEMALE      VALUE 'F'.
  1617             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1618         16  CL-INSURED-OCC-CD       PIC X(6).
  1619         16  FILLER                  PIC X(5).
  1620
  1621     12  CL-PROCESSING-INFO.
  1622         16  CL-PROCESSOR-ID         PIC X(4).
  1623         16  CL-CLAIM-STATUS         PIC X.
  1624             88  CLAIM-IS-OPEN          VALUE 'O'.
  1625             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1626         16  CL-CLAIM-TYPE           PIC X.
  1627*            88  AH-CLAIM               VALUE 'A'.
  1628*            88  LIFE-CLAIM             VALUE 'L'.
  1629*            88  PROPERTY-CLAIM         VALUE 'P'.
  1630*            88  IUI-CLAIM              VALUE 'I'.
  1631*            88  GAP-CLAIM              VALUE 'G'.
  1632*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1633         16  CL-CLAIM-PREM-TYPE      PIC X.
  1634             88  SINGLE-PREMIUM         VALUE '1'.
  1635             88  O-B-COVERAGE           VALUE '2'.
  1636             88  OPEN-END-COVERAGE      VALUE '3'.
  1637         16  CL-INCURRED-DT          PIC XX.
  1638         16  CL-REPORTED-DT          PIC XX.
  1639         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1640         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1641         16  CL-LAST-PMT-DT          PIC XX.
  1642         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1643         16  CL-PAID-THRU-DT         PIC XX.
  1644         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1645         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1646         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1647         16  CL-PMT-CALC-METHOD      PIC X.
  1648             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  37
* EL1284.cbl
  1649             88  CL-365-DAY-YR          VALUE '2'.
  1650             88  CL-FULL-MONTHS         VALUE '3'.
  1651         16  CL-CAUSE-CD             PIC X(6).
  1652
  1653         16  CL-PRIME-CERT-NO.
  1654             20  CL-PRIME-CERT-PRIME PIC X(10).
  1655             20  CL-PRIME-CERT-SFX   PIC X.
  1656
  1657         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1658             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1659             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1660
  1661         16  CL-MICROFILM-NO         PIC X(10).
  1662         16  FILLER REDEFINES CL-MICROFILM-NO.
  1663             20  CL-BENEFIT-PERIOD   PIC 99.
  1664             20  FILLER              PIC X(8).
  1665         16  CL-PROG-FORM-TYPE       PIC X.
  1666         16  CL-LAST-ADD-ON-DT       PIC XX.
  1667
  1668         16  CL-LAST-REOPEN-DT       PIC XX.
  1669         16  CL-LAST-CLOSE-DT        PIC XX.
  1670         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1671             88  FINAL-PAID             VALUE '1'.
  1672             88  CLAIM-DENIED           VALUE '2'.
  1673             88  AUTO-CLOSE             VALUE '3'.
  1674             88  MANUAL-CLOSE           VALUE '4'.
  1675             88  BENEFITS-CHANGED       VALUE 'C'.
  1676             88  SETUP-ERRORS           VALUE 'E'.
  1677         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1678         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1679         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1680             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1681         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1682         16  FILLER                  PIC X.
  1683
  1684     12  CL-CERTIFICATE-DATA.
  1685         16  CL-CERT-ORIGIN          PIC X.
  1686             88  CERT-WAS-ONLINE        VALUE '1'.
  1687             88  CERT-WAS-CREATED       VALUE '2'.
  1688             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1689         16  CL-CERT-KEY-DATA.
  1690             20  CL-CERT-CARRIER     PIC X.
  1691             20  CL-CERT-GROUPING    PIC X(6).
  1692             20  CL-CERT-STATE       PIC XX.
  1693             20  CL-CERT-ACCOUNT.
  1694                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1695                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1696             20  CL-CERT-EFF-DT      PIC XX.
  1697
  1698     12  CL-STATUS-CONTROLS.
  1699         16  CL-PRIORITY-CD          PIC X.
  1700             88  CONFIDENTIAL-DATA      VALUE '8'.
  1701             88  HIGHEST-PRIORITY       VALUE '9'.
  1702         16  CL-SUPV-ATTN-CD         PIC X.
  1703             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1704             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1705         16  CL-PURGED-DT            PIC XX.
  1706         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  38
* EL1284.cbl
  1707         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1708         16  CL-NEXT-RESEND-DT       PIC XX.
  1709         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1710         16  CL-CRITICAL-PERIOD      PIC 99.
  1711*        16  FILLER                  PIC XX.
  1712         16  CL-LAST-MAINT-DT        PIC XX.
  1713         16  CL-LAST-MAINT-USER      PIC X(4).
  1714         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1715         16  CL-LAST-MAINT-TYPE      PIC X.
  1716             88  CLAIM-SET-UP           VALUE ' '.
  1717             88  PAYMENT-MADE           VALUE '1'.
  1718             88  LETTER-SENT            VALUE '2'.
  1719             88  MASTER-WAS-ALTERED     VALUE '3'.
  1720             88  MASTER-WAS-RESTORED    VALUE '4'.
  1721             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1722             88  FILE-CONVERTED         VALUE '6'.
  1723             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1724             88  ERROR-CORRECTION       VALUE 'E'.
  1725         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1726         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1727         16  CL-BENEFICIARY          PIC X(10).
  1728         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1729         16  CL-DENIAL-TYPE          PIC X.
  1730             88  CL-TYPE-DENIAL          VALUE '1'.
  1731             88  CL-TYPE-RESCISSION      VALUE '2'.
  1732             88  CL-TYPE-REFORMATION     VALUE '3'.
  1733             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1734             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1735         16  filler                  pic x(5).
  1736*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1737*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1738*        16  CL-RTW-DT               PIC XX.
  1739
  1740     12  CL-TRAILER-CONTROLS.
  1741         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1742             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1743             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1744             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1745         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1746         16  FILLER                  PIC XX.
  1747         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1748         16  CL-ADDRESS-TRAILER-CNT.
  1749             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1750                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1751             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1752                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1753             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1754                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1755             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1756                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1757             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1758                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1759             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1760                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1761             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1762                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1763
  1764     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  39
* EL1284.cbl
  1765         16  CL-CV-REFNO-PRIME       PIC X(18).
  1766         16  CL-CV-REFNO-SFX         PIC XX.
  1767
  1768     12  CL-FILE-LOCATION            PIC X(4).
  1769
  1770     12  CL-PROCESS-ERRORS.
  1771         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1772             88  NO-FATAL-ERRORS        VALUE ZERO.
  1773         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1774             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1775
  1776     12  CL-PRODUCT-CD               PIC X.
  1777
  1778     12  CL-CURRENT-KEY-DATA.
  1779         16  CL-CURRENT-CARRIER      PIC X.
  1780         16  CL-CURRENT-GROUPING     PIC X(6).
  1781         16  CL-CURRENT-STATE        PIC XX.
  1782         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1783
  1784     12  CL-ASSOCIATES               PIC X.
  1785         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1786         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1787         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1788         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1789
  1790     12  CL-ACTIVITY-CODE            PIC 99.
  1791     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1792     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1793
  1794     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1795     12  CL-LAG-REPORT-CODE          PIC 9.
  1796     12  CL-LOAN-TYPE                PIC XX.
  1797     12  CL-LEGAL-STATE              PIC XX.
  1798
  1799     12  CL-YESNOSW                  PIC X.
  1800     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1801         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1802         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1803         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1804     12  cl-insured-type             pic x.
  1805         88  cl-claim-on-primary         value 'P'.
  1806         88  cl-claim-on-co-borrower     value 'C'.
  1807     12  cl-benefit-expiration-dt    PIC XX.
  1808****************************************************************
  1809*
  1810* Copyright (c) 2007 by Clerity Solutions, Inc.
  1811* All rights reserved.
  1812*
  1813****************************************************************
  1814 01  DFHEIV.
  1815   02  DFHEIV0               PIC X(35).
  1816   02  DFHEIV1               PIC X(08).
  1817   02  DFHEIV2               PIC X(08).
  1818   02  DFHEIV3               PIC X(08).
  1819   02  DFHEIV4               PIC X(06).
  1820   02  DFHEIV5               PIC X(04).
  1821   02  DFHEIV6               PIC X(04).
  1822   02  DFHEIV7               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  40
* EL1284.cbl
  1823   02  DFHEIV8               PIC X(02).
  1824   02  DFHEIV9               PIC X(01).
  1825   02  DFHEIV10              PIC S9(7) COMP-3.
  1826   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1827   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1828   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1829   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1830   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1831   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1832   02  DFHEIV17              PIC X(04).
  1833   02  DFHEIV18              PIC X(04).
  1834   02  DFHEIV19              PIC X(04).
  1835   02  DFHEIV20              USAGE IS POINTER.
  1836   02  DFHEIV21              USAGE IS POINTER.
  1837   02  DFHEIV22              USAGE IS POINTER.
  1838   02  DFHEIV23              USAGE IS POINTER.
  1839   02  DFHEIV24              USAGE IS POINTER.
  1840   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1841   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1842   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1843   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1844   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1845   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1846   02  FILLER                PIC X(02).
  1847   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1848   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1849   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1850   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1851   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1852 LINKAGE  SECTION.
  1853*****************************************************************
  1854*                                                               *
  1855* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1856* All rights reserved.                                          *
  1857*                                                               *
  1858*****************************************************************
  1859 01  dfheiblk.
  1860     02  eibtime          pic s9(7) comp-3.
  1861     02  eibdate          pic s9(7) comp-3.
  1862     02  eibtrnid         pic x(4).
  1863     02  eibtaskn         pic s9(7) comp-3.
  1864     02  eibtrmid         pic x(4).
  1865     02  dfheigdi         pic s9(4) comp.
  1866     02  eibcposn         pic s9(4) comp.
  1867     02  eibcalen         pic s9(4) comp.
  1868     02  eibaid           pic x(1).
  1869     02  eibfiller1       pic x(1).
  1870     02  eibfn            pic x(2).
  1871     02  eibfiller2       pic x(2).
  1872     02  eibrcode         pic x(6).
  1873     02  eibfiller3       pic x(2).
  1874     02  eibds            pic x(8).
  1875     02  eibreqid         pic x(8).
  1876     02  eibrsrce         pic x(8).
  1877     02  eibsync          pic x(1).
  1878     02  eibfree          pic x(1).
  1879     02  eibrecv          pic x(1).
  1880     02  eibsend          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  41
* EL1284.cbl
  1881     02  eibatt           pic x(1).
  1882     02  eibeoc           pic x(1).
  1883     02  eibfmh           pic x(1).
  1884     02  eibcompl         pic x(1).
  1885     02  eibsig           pic x(1).
  1886     02  eibconf          pic x(1).
  1887     02  eiberr           pic x(1).
  1888     02  eibrldbk         pic x(1).
  1889     02  eiberrcd         pic x(4).
  1890     02  eibsynrb         pic x(1).
  1891     02  eibnodat         pic x(1).
  1892     02  eibfiller5       pic x(2).
  1893     02  eibresp          pic 9(09) comp.
  1894     02  eibresp2         pic 9(09) comp.
  1895     02  dfheigdj         pic s9(4) comp.
  1896     02  dfheigdk         pic s9(4) comp.
  1897 01  DFHCOMMAREA                 PIC X(1500).
  1898
  1899*        COPY ELCMEMO.
  1900******************************************************************
  1901*                                                                *
  1902*                                                                *
  1903*                           ELCMEMO.                             *
  1904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE           *
  1905*                                                                *
  1906*                                                                *
  1907*   FILE DESCRIPTION = CLAIM MEMO NOTES                          *
  1908*                                                                *
  1909*   FILE TYPE = VSAM,KSDS                                        *
  1910*   RECORD SIZE = 132    RECFORM = FIXED                         *
  1911*                                                                *
  1912*   BASE CLUSTER NAME = ELMEMO             RKP=2,LEN=23          *
  1913*       ALTERNATE INDEX = NONE                                   *
  1914*                                                                *
  1915*   LOG = YES                                                    *
  1916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1917******************************************************************
  1918 01  CLAIM-MEMO-FILE.
  1919     12  MM-RECORD-ID                  PIC  XX.
  1920         88  VALID-MM-ID                    VALUE 'MM'.
  1921     12  MM-CONTROL-PRIMARY.
  1922       16  MM-COMPANY-CD               PIC  X.
  1923       16  MM-RECORD-TYPE              PIC  X.
  1924           88  MM-HDR-REC                   VALUE '1'.
  1925           88  MM-DETAIL-REC                VALUE '2'.
  1926       16  MM-CARRIER                  PIC  X.
  1927       16  MM-CLAIM-NO                 PIC  X(7).
  1928       16  MM-CERT-NO.
  1929           20  MM-CERT-PRIME           PIC  X(10).
  1930           20  MM-CERT-SFX             PIC  X.
  1931       16  MM-PAYMENT-SEQ-NO           PIC  S9(4)  COMP.
  1932
  1933   12  MM-CLAIM-MEMO                   PIC  X(63).
  1934   12  MM-HEADER-INFO REDEFINES MM-CLAIM-MEMO.
  1935       16  MM-LONG-HEALTH-APP          PIC  X(01).
  1936       16  MM-REWRITE-IND              PIC  X(01).
  1937       16  MM-CHECKED-OTHER-COVG       PIC  X(01).
  1938       16  MM-MR-RELEASED-FROM-DATE    PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  42
* EL1284.cbl
  1939   12  FILLER                          PIC  X(34).
  1940
  1941   12  MM-LAST-MAINT-DT                PIC  XX.
  1942   12  MM-LAST-MAINT-BY                PIC  X(4).
  1943   12  MM-LAST-MAINT-HHMMSS            PIC  S9(6) COMP-3.
  1944
  1945*        COPY ELCCERT.
  1946******************************************************************
  1947*                                                                *
  1948*                            ELCCERT.                            *
  1949*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1950*                            VMOD=2.013                          *
  1951*                                                                *
  1952*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1953*                                                                *
  1954*   FILE TYPE = VSAM,KSDS                                        *
  1955*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1956*                                                                *
  1957*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1958*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1959*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1960*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1961*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1962*                                                                *
  1963*   LOG = YES                                                    *
  1964*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1965******************************************************************
  1966*                   C H A N G E   L O G
  1967*
  1968* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1969*-----------------------------------------------------------------
  1970*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1971* EFFECTIVE    NUMBER
  1972*-----------------------------------------------------------------
  1973* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1974* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1975* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1976* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1977* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1978* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1979* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1980* 032612  CR2011110200001  PEMA  AHL CHANGES
  1981* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1982* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1983******************************************************************
  1984
  1985 01  CERTIFICATE-MASTER.
  1986     12  CM-RECORD-ID                      PIC XX.
  1987         88  VALID-CM-ID                      VALUE 'CM'.
  1988
  1989     12  CM-CONTROL-PRIMARY.
  1990         16  CM-COMPANY-CD                 PIC X.
  1991         16  CM-CARRIER                    PIC X.
  1992         16  CM-GROUPING.
  1993             20  CM-GROUPING-PREFIX        PIC X(3).
  1994             20  CM-GROUPING-PRIME         PIC X(3).
  1995         16  CM-STATE                      PIC XX.
  1996         16  CM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  43
* EL1284.cbl
  1997             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1998             20  CM-ACCOUNT-PRIME          PIC X(6).
  1999         16  CM-CERT-EFF-DT                PIC XX.
  2000         16  CM-CERT-NO.
  2001             20  CM-CERT-PRIME             PIC X(10).
  2002             20  CM-CERT-SFX               PIC X.
  2003
  2004     12  CM-CONTROL-BY-NAME.
  2005         16  CM-COMPANY-CD-A1              PIC X.
  2006         16  CM-INSURED-LAST-NAME          PIC X(15).
  2007         16  CM-INSURED-INITIALS.
  2008             20  CM-INSURED-INITIAL1       PIC X.
  2009             20  CM-INSURED-INITIAL2       PIC X.
  2010
  2011     12  CM-CONTROL-BY-SSN.
  2012         16  CM-COMPANY-CD-A2              PIC X.
  2013         16  CM-SOC-SEC-NO.
  2014             20  CM-SSN-STATE              PIC XX.
  2015             20  CM-SSN-ACCOUNT            PIC X(6).
  2016             20  CM-SSN-LN3.
  2017                 25  CM-INSURED-INITIALS-A2.
  2018                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2019                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2020                 25 CM-PART-LAST-NAME-A2         PIC X.
  2021
  2022     12  CM-CONTROL-BY-CERT-NO.
  2023         16  CM-COMPANY-CD-A4              PIC X.
  2024         16  CM-CERT-NO-A4                 PIC X(11).
  2025
  2026     12  CM-CONTROL-BY-MEMB.
  2027         16  CM-COMPANY-CD-A5              PIC X.
  2028         16  CM-MEMBER-NO.
  2029             20  CM-MEMB-STATE             PIC XX.
  2030             20  CM-MEMB-ACCOUNT           PIC X(6).
  2031             20  CM-MEMB-LN4.
  2032                 25  CM-INSURED-INITIALS-A5.
  2033                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2034                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2035                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2036
  2037     12  CM-INSURED-PROFILE-DATA.
  2038         16  CM-INSURED-FIRST-NAME.
  2039             20  CM-INSURED-1ST-INIT       PIC X.
  2040             20  FILLER                    PIC X(9).
  2041         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2042         16  CM-INSURED-SEX                PIC X.
  2043             88  CM-SEX-MALE                  VALUE 'M'.
  2044             88  CM-SEX-FEMAL                 VALUE 'F'.
  2045         16  CM-INSURED-JOINT-AGE          PIC 99.
  2046         16  CM-JOINT-INSURED-NAME.
  2047             20  CM-JT-LAST-NAME           PIC X(15).
  2048             20  CM-JT-FIRST-NAME.
  2049                 24  CM-JT-1ST-INIT        PIC X.
  2050                 24  FILLER                PIC X(9).
  2051             20  CM-JT-INITIAL             PIC X.
  2052
  2053     12  CM-LIFE-DATA.
  2054         16  CM-LF-BENEFIT-CD              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  44
* EL1284.cbl
  2055         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2056         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2057         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2058         16  CM-LF-DEV-CODE                PIC XXX.
  2059         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2060         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2061         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2062         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2063         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2064         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2065         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2066         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2067         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2068         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2069         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2070         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2071         16  cm-temp-epiq                  pic xx.
  2072             88  EPIQ-CLASS                  value 'EQ'.
  2073*        16  FILLER                        PIC XX.
  2074
  2075     12  CM-AH-DATA.
  2076         16  CM-AH-BENEFIT-CD              PIC XX.
  2077         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2078         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2079         16  CM-AH-DEV-CODE                PIC XXX.
  2080         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2081         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2082         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2083         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2084         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2085         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2086         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2087         16  CM-AH-PAID-THRU-DT            PIC XX.
  2088             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2089         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2090         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2091         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2092         16  FILLER                        PIC X.
  2093
  2094     12  CM-LOAN-INFORMATION.
  2095         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2096         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2097                                           PIC S9(5)V99  COMP-3.
  2098         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2099         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2100         16  CM-PAY-FREQUENCY              PIC S99.
  2101         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2102         16  CM-RATE-CLASS                 PIC XX.
  2103         16  CM-BENEFICIARY                PIC X(25).
  2104         16  CM-POLICY-FORM-NO             PIC X(12).
  2105         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2106         16  CM-LAST-ADD-ON-DT             PIC XX.
  2107         16  CM-DEDUCTIBLE-AMOUNTS.
  2108             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2109             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2110         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2111             20  CM-RESIDENT-STATE         PIC XX.
  2112             20  CM-RATE-CODE              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  45
* EL1284.cbl
  2113             20  FILLER                    PIC XX.
  2114         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2115             20  CM-LOAN-OFFICER           PIC X(5).
  2116             20  FILLER                    PIC XXX.
  2117         16  CM-CSR-CODE                   PIC XXX.
  2118         16  CM-UNDERWRITING-CODE          PIC X.
  2119             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2120         16  CM-POST-CARD-IND              PIC X.
  2121         16  CM-NH-INTERFACE-SW            PIC X.
  2122         16  CM-PREMIUM-TYPE               PIC X.
  2123             88  CM-SING-PRM                  VALUE '1'.
  2124             88  CM-O-B-COVERAGE              VALUE '2'.
  2125             88  CM-OPEN-END                  VALUE '3'.
  2126         16  CM-IND-GRP-TYPE               PIC X.
  2127             88  CM-INDIVIDUAL                VALUE 'I'.
  2128             88  CM-GROUP                     VALUE 'G'.
  2129         16  CM-SKIP-CODE                  PIC X.
  2130             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2131             88  SKIP-JULY                    VALUE '1'.
  2132             88  SKIP-AUGUST                  VALUE '2'.
  2133             88  SKIP-SEPTEMBER               VALUE '3'.
  2134             88  SKIP-JULY-AUG                VALUE '4'.
  2135             88  SKIP-AUG-SEPT                VALUE '5'.
  2136             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2137             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2138             88  SKIP-JUNE                    VALUE '8'.
  2139             88  SKIP-JUNE-JULY               VALUE '9'.
  2140             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2141             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2142         16  CM-PAYMENT-MODE               PIC X.
  2143             88  PAY-MONTHLY                  VALUE SPACE.
  2144             88  PAY-WEEKLY                   VALUE '1'.
  2145             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2146             88  PAY-BI-WEEKLY                VALUE '3'.
  2147             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2148         16  CM-LOAN-NUMBER                PIC X(8).
  2149         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2150         16  CM-OLD-LOF                    PIC XXX.
  2151*        16  CM-LOAN-OFFICER               PIC XXX.
  2152         16  CM-REIN-TABLE                 PIC XXX.
  2153         16  CM-SPECIAL-REIN-CODE          PIC X.
  2154         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2155         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2156         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2157
  2158     12  CM-STATUS-DATA.
  2159         16  CM-ENTRY-STATUS               PIC X.
  2160         16  CM-ENTRY-DT                   PIC XX.
  2161
  2162         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2163         16  CM-LF-CANCEL-DT               PIC XX.
  2164         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2165
  2166         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2167         16  CM-LF-DEATH-DT                PIC XX.
  2168         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2169
  2170         16  CM-LF-CURRENT-STATUS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  46
* EL1284.cbl
  2171             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2172                                                'M' '4' '5' '9'.
  2173             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2174             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2175             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2176             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2177             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2178             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2179             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2180             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2181             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2182             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2183             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2184             88  CM-LF-DECLINED               VALUE 'D'.
  2185             88  CM-LF-VOIDED                 VALUE 'V'.
  2186
  2187         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2188         16  CM-AH-CANCEL-DT               PIC XX.
  2189         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2190
  2191         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2192         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2193         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2194
  2195         16  CM-AH-CURRENT-STATUS          PIC X.
  2196             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2197                                                'M' '4' '5' '9'.
  2198             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2199             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2200             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2201             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2202             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2203             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2204             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2205             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2206             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2207             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2208             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2209             88  CM-AH-DECLINED               VALUE 'D'.
  2210             88  CM-AH-VOIDED                 VALUE 'V'.
  2211
  2212         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2213             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2214             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2215             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2216         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2217
  2218         16  CM-ENTRY-BATCH                PIC X(6).
  2219         16  CM-LF-EXIT-BATCH              PIC X(6).
  2220         16  CM-AH-EXIT-BATCH              PIC X(6).
  2221         16  CM-LAST-MONTH-END             PIC XX.
  2222
  2223     12  CM-NOTE-SW                        PIC X.
  2224         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2225         88  CERT-NOTES-PRESENT               VALUE '1'.
  2226         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2227         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2228         88  CLAIM-NOTES-PRESENT              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  47
* EL1284.cbl
  2229         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2230         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2231         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2232     12  CM-COMP-EXCP-SW                   PIC X.
  2233         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2234         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2235     12  CM-INSURED-ADDRESS-SW             PIC X.
  2236         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2237         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2238
  2239*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2240     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2241     12  FILLER                            PIC X.
  2242
  2243*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2244     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2245     12  FILLER                            PIC X.
  2246*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2247     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2248
  2249     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2250         88  CERT-ADDED-BATCH                 VALUE ' '.
  2251         88  CERT-ADDED-ONLINE                VALUE '1'.
  2252         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2253         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2254         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2255     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2256         88  CERT-AS-LOADED                   VALUE ' '.
  2257         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2258         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2259         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2260         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2261         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2262         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2263         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2264
  2265     12  CM-ACCOUNT-COMM-PCTS.
  2266         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2267         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2268
  2269     12  CM-USER-FIELD                     PIC X.
  2270     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2271     12  CM-CLP-STATE                      PIC XX.
  2272     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2273     12  CM-USER-RESERVED                  PIC XXX.
  2274     12  FILLER REDEFINES CM-USER-RESERVED.
  2275         16  CM-AH-CLASS-CD                PIC XX.
  2276         16  F                             PIC X.
  2277******************************************************************
  2278 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MEMO-FILE
  2279                          CERTIFICATE-MASTER.
  2280 0000-DFHEXIT SECTION.
  2281     MOVE '9#                    $   ' TO DFHEIV0.
  2282     MOVE 'EL1284' TO DFHEIV1.
  2283     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2284
  2285     MOVE EIBTRMID               TO QID-TERM.
  2286     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  48
* EL1284.cbl
  2287     MOVE '5'                    TO DC-OPTION-CODE.
  2288     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2289     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  2290     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  2291
  2292     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK
  2293     IF EIBCALEN = ZEROS
  2294         GO TO 8800-UNAUTHORIZED-ACCESS
  2295     END-IF.
  2296
  2297*    IF PI-CALLING-PROGRAM NOT = THIS-PGM AND PGM-EL1276
  2298*        PERFORM 4900-SET-NOTES-FLAG THRU 4900-EXIT
  2299*        IF CLAIM-SESSION
  2300*            SET PI-CLAIM-NOTE TO TRUE
  2301*        ELSE
  2302*            SET PI-CERT-NOTE TO TRUE
  2303*        END-IF
  2304*    END-IF.
  2305
  2306*    IF PI-CALLING-PROGRAM = PGM-EL1276
  2307*        MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  2308*        MOVE 'N'                TO PI-PF5-PRESSED
  2309*        MOVE 'N'                TO PI-PF6-PRESSED
  2310*    END-IF.
  2311
  2312     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2313        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2314           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2315           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2316           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2317           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2318           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2319           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2320           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2321           MOVE THIS-PGM TO PI-CALLING-PROGRAM
  2322        ELSE
  2323           MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2324           MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2325           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2326           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2327           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2328           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2329           MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2330           MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2331        END-IF
  2332     END-IF.
  2333
  2334 1000-START.
  2335     MOVE 'N' TO WS-CURSOR-SET
  2336
  2337     MOVE LOW-VALUES TO EL1284AI
  2338                        EL1284R
  2339     MOVE SPACES                 TO  ELMEMO-KEY
  2340                                     ELCERT-KEY.
  2341
  2342     MOVE PI-COMPANY-CD          TO  ELMEMO-COMPANY-CD
  2343                                     ELCERT-COMPANY-CD.
  2344     MOVE PI-CARRIER             TO  ELMEMO-CARRIER
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  49
* EL1284.cbl
  2345                                     ELCERT-CARRIER.
  2346     MOVE PI-CLAIM-NO            TO  ELMEMO-CLAIM-NO
  2347     MOVE PI-CERT-PRIME          TO  ELMEMO-CERT-PRIME
  2348                                     ELCERT-CERT-PRIME.
  2349     MOVE PI-CERT-SFX            TO  ELMEMO-CERT-SFX
  2350                                     ELCERT-CERT-SFX.
  2351     MOVE ZEROS                  TO  ELMEMO-RECORD-TYPE
  2352     MOVE ZEROS                  TO  ELMEMO-SEQ.
  2353     MOVE ELMEMO-PARTIAL-KEY     TO  SV-PRIOR-KEY.
  2354
  2355     IF EIBTRNID NOT = TRANS-ID
  2356        INITIALIZE PI-EL1284-AREA
  2357        MOVE '0'                 TO  PI-UPDATE-SW
  2358        IF PI-PROCESSOR-ID NOT = 'LGXX'
  2359
  2360* EXEC CICS READQ TS
  2361*                    QUEUE (PI-SECURITY-TEMP-STORE-ID)
  2362*                    INTO (SECURITY-CONTROL)
  2363*                    LENGTH (SC-COMM-LENGTH)
  2364*                    ITEM  (SC-ITEM)
  2365*           END-EXEC
  2366*    MOVE '*$II   L              ''   #00002355' TO DFHEIV0
  2367     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2368     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2369     MOVE X'2020233030303032333535' TO DFHEIV0(25:11)
  2370     CALL 'kxdfhei1' USING DFHEIV0,
  2371           PI-SECURITY-TEMP-STORE-ID,
  2372           SECURITY-CONTROL,
  2373           SC-COMM-LENGTH,
  2374           SC-ITEM,
  2375           DFHEIV99,
  2376           DFHEIV99
  2377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2378          MOVE SC-CREDIT-DISPLAY (32) TO PI-DISPLAY-CAP
  2379          MOVE SC-CREDIT-UPDATE (32)  TO PI-MODIFY-CAP
  2380        END-IF
  2381     END-IF.
  2382
  2383     IF NOT DISPLAY-CAP
  2384         MOVE 'READ'             TO  SM-READ
  2385         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2386         MOVE ER-0070            TO  EMI-ERROR
  2387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2388         GO TO 8100-SEND-INITIAL-MAP
  2389     END-IF.
  2390
  2391
  2392* EXEC CICS HANDLE AID
  2393*         CLEAR(9400-CLEAR)
  2394*    END-EXEC.
  2395*    MOVE '"&=                  V! " #00002374' TO DFHEIV0
  2396     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  2397     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2398     MOVE X'2220233030303032333734' TO DFHEIV0(25:11)
  2399     CALL 'kxdfhei1' USING DFHEIV0
  2400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2401
  2402
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  50
* EL1284.cbl
  2403
  2404* EXEC CICS HANDLE CONDITION
  2405*         ERROR(9990-ABEND)
  2406*         PGMIDERR(9600-PGMID-ERROR)
  2407*    END-EXEC.
  2408*    MOVE '"$.L                  ! # #00002378' TO DFHEIV0
  2409     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2411     MOVE X'2320233030303032333738' TO DFHEIV0(25:11)
  2412     CALL 'kxdfhei1' USING DFHEIV0
  2413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2414
  2415
  2416     IF EIBTRNID NOT = TRANS-ID
  2417         GO TO 7000-BUILD-TABLE
  2418     END-IF.
  2419
  2420     IF PI-CHANGE-IN-NOTE-TYPE
  2421         GO TO 7000-BUILD-TABLE
  2422     END-IF.
  2423
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  51
* EL1284.cbl
  2425 2000-RECEIVE.
  2426     IF EIBAID = DFHPA1 OR
  2427        EIBAID = DFHPA2 OR
  2428        EIBAID = DFHPA3
  2429           MOVE ER-0008 TO EMI-ERROR
  2430           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2431           GO TO 8200-SEND-DATAONLY
  2432     END-IF.
  2433
  2434
  2435* EXEC CICS RECEIVE
  2436*         MAP(MAP-NAME)
  2437*         MAPSET(MAPSET-NAME)
  2438*         INTO(EL1284AI)
  2439*    END-EXEC.
  2440     MOVE LENGTH OF
  2441      EL1284AI
  2442       TO DFHEIV11
  2443*    MOVE '8"T I  L              ''   #00002401' TO DFHEIV0
  2444     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2445     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2446     MOVE X'2020233030303032343031' TO DFHEIV0(25:11)
  2447     CALL 'kxdfhei1' USING DFHEIV0,
  2448           MAP-NAME,
  2449           EL1284AI,
  2450           DFHEIV11,
  2451           MAPSET-NAME,
  2452           DFHEIV99,
  2453           DFHEIV99
  2454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2455
  2456     MOVE GROUP2 TO EL1284R.
  2457
  2458     IF PFENTERL = ZEROS
  2459        GO TO 2001-CHECK-PFKEYS
  2460     END-IF.
  2461
  2462     IF EIBAID NOT = DFHENTER
  2463        MOVE ER-0004             TO EMI-ERROR
  2464        GO TO 2002-INPUT-ERROR
  2465     END-IF.
  2466
  2467     IF PFENTERI NUMERIC AND
  2468        (PFENTERI > 00 AND  < 25)
  2469        MOVE PF-VALUES (PFENTERI) TO EIBAID
  2470     ELSE
  2471        MOVE ER-0029 TO EMI-ERROR
  2472        GO TO 2002-INPUT-ERROR
  2473     END-IF.
  2474
  2475 2001-CHECK-PFKEYS.
  2476     IF EIBAID = DFHPF23
  2477        GO TO 9000-RETURN-CICS
  2478     END-IF.
  2479
  2480     IF EIBAID = DFHPF24
  2481        GO TO 9200-RETURN-MAIN-MENU
  2482     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  52
* EL1284.cbl
  2483
  2484     IF EIBAID = DFHPF12
  2485        GO TO 9500-PF12
  2486     END-IF.
  2487
  2488     IF FUNCTL NOT = ZEROS AND EIBAID NOT = DFHENTER
  2489        IF FUNCTI = 'A' OR = SPACES
  2490           NEXT SENTENCE
  2491        ELSE
  2492           MOVE ER-0050          TO EMI-ERROR
  2493           MOVE -1 TO FUNCTL
  2494           MOVE AL-UABON TO FUNCTA PFENTERA
  2495           GO TO 2002-INPUT-ERROR
  2496        END-IF
  2497     END-IF.
  2498
  2499     IF EIBAID = DFHPF1
  2500        MOVE NUM-LINES-PER-SCREEN TO ROLL-COUNTER
  2501        GO TO 7400-PAGE-ROUTINE
  2502     END-IF.
  2503
  2504     IF EIBAID = DFHPF2
  2505        SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  2506        GO TO 7400-PAGE-ROUTINE
  2507     END-IF.
  2508
  2509     IF EIBAID = DFHPF3
  2510        MOVE 5                   TO ROLL-COUNTER
  2511        GO TO 7400-PAGE-ROUTINE
  2512     END-IF.
  2513
  2514     IF EIBAID = DFHPF4
  2515        MOVE -5                  TO ROLL-COUNTER
  2516        GO TO 7400-PAGE-ROUTINE
  2517     END-IF.
  2518
  2519     IF EIBAID = DFHENTER
  2520        GO TO 2003-EDIT-DATA
  2521     END-IF.
  2522
  2523     MOVE ER-0029                TO EMI-ERROR.
  2524
  2525 2002-INPUT-ERROR.
  2526     MOVE -1                     TO PFENTERL
  2527     MOVE AL-UNBON               TO PFENTERA
  2528     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2529     GO TO 8200-SEND-DATAONLY.
  2530
  2531 2003-EDIT-DATA.
  2532
  2533     IF FUNCTI = 'L'
  2534         NEXT SENTENCE
  2535     ELSE
  2536         IF NOT MODIFY-CAP
  2537             MOVE 'UPDATE'       TO  SM-READ
  2538             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2539             MOVE ER-0070        TO  EMI-ERROR
  2540             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  53
* EL1284.cbl
  2541             GO TO 8100-SEND-INITIAL-MAP
  2542         END-IF
  2543     END-IF.
  2544     IF FUNCTI NOT = 'Q'
  2545        PERFORM 2010-EDIT-CHECK
  2546     END-IF.
  2547
  2548     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  2549        GO TO 4000-CHANGE-ROUTINE
  2550     END-IF.
  2551
  2552     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  2553                = 'I' OR = 'A' OR = 'L')
  2554         NEXT SENTENCE
  2555     ELSE
  2556         MOVE ER-0023            TO EMI-ERROR
  2557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2558         MOVE AL-UABON           TO FUNCTA
  2559         MOVE -1                 TO FUNCTL
  2560         GO TO 8200-SEND-DATAONLY
  2561     END-IF.
  2562
  2563     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
  2564        PERFORM 2500-LINE-CHECK THRU 2599-EXIT
  2565     ELSE
  2566        IF LINE1L NOT = ZEROS OR
  2567           LINE2L NOT = ZEROS
  2568           MOVE ER-0030          TO EMI-ERROR
  2569           MOVE -1               TO LINE1L
  2570           MOVE AL-UNBON         TO LINE1A LINE2A
  2571           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2572           GO TO 8200-SEND-DATAONLY
  2573        END-IF
  2574     END-IF.
  2575
  2576     IF FUNCTI = 'A'
  2577        GO TO 5000-ADD-NEW-LINES
  2578     END-IF.
  2579     IF FUNCTI = 'Q'
  2580        GO TO 9410-RETURN
  2581     END-IF.
  2582     IF FUNCTI = 'S'
  2583        GO TO 4500-SAVE-DATA
  2584     END-IF.
  2585     IF PI-TOTAL-LINES = 0
  2586        MOVE ER-0048             TO EMI-ERROR
  2587        MOVE -1                  TO FUNCTL
  2588        MOVE AL-UNBON            TO FUNCTA
  2589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2590        GO TO 8200-SEND-DATAONLY
  2591     END-IF.
  2592     IF FUNCTI = 'L'
  2593        GO TO 5500-LOOKUP
  2594     END-IF.
  2595     IF FUNCTI = 'D'
  2596        GO TO 3000-DELETE-LINES
  2597     END-IF.
  2598
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  54
* EL1284.cbl
  2599     GO TO 3500-INSERT-LINES.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  55
* EL1284.cbl
  2601 2010-EDIT-CHECK.
  2602*
  2603     IF LNGHLAPL > 0
  2604        MOVE LNGHLAPI TO  PI-LONG-HLTH-APP
  2605        MOVE '1'      TO PI-UPDATE-SW
  2606     ELSE
  2607        IF LNGHLAPA = WS-ERASE-EOF
  2608           MOVE SPACES TO PI-LONG-HLTH-APP
  2609           MOVE '1'    TO PI-UPDATE-SW
  2610        END-IF
  2611        MOVE PI-LONG-HLTH-APP TO LNGHLAPI
  2612     END-IF.
  2613*
  2614     IF LNGHLAPI > SPACE
  2615        IF LNGHLAPI = 'N' OR 'Y'
  2616           CONTINUE
  2617        ELSE
  2618           MOVE -1                     TO LNGHLAPL
  2619           MOVE AL-UABON               TO LNGHLAPA
  2620           MOVE ER-0046                TO EMI-ERROR
  2621           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2622           GO TO 8200-SEND-DATAONLY
  2623        END-IF
  2624     END-IF.
  2625*
  2626     IF REWRITEL > 0
  2627        MOVE REWRITEI TO PI-REWRITE
  2628        MOVE '1'      TO PI-UPDATE-SW
  2629     ELSE
  2630        IF REWRITEA = WS-ERASE-EOF
  2631           MOVE SPACES TO PI-REWRITE
  2632           MOVE '1'    TO PI-UPDATE-SW
  2633        END-IF
  2634        MOVE PI-REWRITE TO REWRITEI
  2635     END-IF
  2636*
  2637     IF REWRITEI > SPACE
  2638        IF REWRITEI = 'N' OR 'Y' OR 'D'
  2639           CONTINUE
  2640        ELSE
  2641           MOVE -1                     TO REWRITEL
  2642           MOVE AL-UABON               TO REWRITEA
  2643           MOVE ER-3846                TO EMI-ERROR
  2644           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2645           GO TO 8200-SEND-DATAONLY
  2646        END-IF
  2647     END-IF.
  2648*
  2649     IF CHKCOVGL > 0
  2650        MOVE CHKCOVGI TO PI-CHKCOVG
  2651        MOVE '1'      TO PI-UPDATE-SW
  2652     ELSE
  2653        IF CHKCOVGA = WS-ERASE-EOF
  2654           MOVE SPACES TO PI-CHKCOVG
  2655           MOVE '1'    TO PI-UPDATE-SW
  2656        END-IF
  2657        MOVE PI-CHKCOVG TO CHKCOVGI
  2658     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  56
* EL1284.cbl
  2659*
  2660     IF CHKCOVGI > SPACE
  2661        IF CHKCOVGI = 'N' OR 'Y'
  2662           CONTINUE
  2663        ELSE
  2664           MOVE -1                     TO CHKCOVGL
  2665           MOVE AL-UABON               TO CHKCOVGA
  2666           MOVE ER-0046                TO EMI-ERROR
  2667           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2668           GO TO 8200-SEND-DATAONLY
  2669        END-IF
  2670     END-IF.
  2671*
  2672     IF MRRELDTL > 0
  2673        MOVE MRRELDTI TO PI-MR-RELEASE-DATE
  2674        MOVE '1'      TO PI-UPDATE-SW
  2675     ELSE
  2676        IF MRRELDTA = WS-ERASE-EOF
  2677           MOVE SPACES TO PI-MR-RELEASE-DATE
  2678           MOVE '1'    TO PI-UPDATE-SW
  2679        END-IF
  2680        MOVE PI-MR-RELEASE-DATE TO MRRELDTI
  2681     END-IF.
  2682*
  2683 2500-LINE-CHECK.
  2684     IF LINE1L = ZEROS AND
  2685        LINE2L = ZEROS
  2686        MOVE ER-0069             TO EMI-ERROR
  2687        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2688        MOVE -1                  TO LINE1L
  2689        GO TO 8200-SEND-DATAONLY
  2690     END-IF.
  2691
  2692     IF LINE1L NOT = ZEROS
  2693        IF LINE1I = ZERO AND FUNCTI EQUAL 'L'
  2694            MOVE 1               TO LINE1I
  2695        END-IF
  2696        IF LINE1I = ZERO AND FUNCTI EQUAL 'D'
  2697           MOVE ER-0049          TO EMI-ERROR
  2698           MOVE AL-UNBON         TO LINE1A
  2699           MOVE -1               TO LINE1L
  2700           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2701           GO TO 8200-SEND-DATAONLY
  2702        END-IF
  2703        IF LINE1I NOT NUMERIC OR
  2704           LINE1I > PI-TOTAL-LINES
  2705           MOVE ER-0031          TO EMI-ERROR
  2706           MOVE AL-UNBON         TO LINE1A
  2707           MOVE -1               TO LINE1L
  2708           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2709           GO TO 8200-SEND-DATAONLY
  2710        ELSE
  2711           IF LINE2L = ZEROS
  2712              MOVE 1             TO LINE2I
  2713              IF FUNCTI = 'I'
  2714                  GO TO 2510-MAX-CHECK
  2715              ELSE
  2716                  NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  57
* EL1284.cbl
  2717              END-IF
  2718           ELSE
  2719              IF FUNCTI = 'I'
  2720                 GO TO 2510-MAX-CHECK
  2721              ELSE
  2722                 IF LINE2I NOT NUMERIC
  2723                    MOVE AL-UNBON TO LINE2A
  2724                    MOVE ER-0032  TO EMI-ERROR
  2725                    MOVE -1       TO LINE2L
  2726                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2727                    GO TO 8200-SEND-DATAONLY
  2728                 ELSE
  2729                    NEXT SENTENCE
  2730                 END-IF
  2731              END-IF
  2732           END-IF
  2733        END-IF
  2734     ELSE
  2735        IF LINE2L = ZEROS
  2736           NEXT SENTENCE
  2737        ELSE
  2738           MOVE -1               TO LINE2L
  2739           MOVE ER-0041          TO EMI-ERROR
  2740           MOVE AL-UNBON         TO LINE2A
  2741           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2742           GO TO 8200-SEND-DATAONLY
  2743        END-IF
  2744     END-IF.
  2745     GO TO 2599-EXIT.
  2746 2510-MAX-CHECK.
  2747     IF LINE2I NOT NUMERIC
  2748        MOVE -1                  TO LINE2L
  2749        MOVE ER-0032             TO EMI-ERROR
  2750        MOVE AL-UNBON            TO LINE2A
  2751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2752        GO TO 8200-SEND-DATAONLY
  2753     ELSE
  2754        COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  2755        IF ROLL-COUNTER GREATER THAN MAX-LINES
  2756           MOVE -1               TO LINE2L
  2757           MOVE ER-0044          TO EMI-ERROR
  2758           MOVE AL-UNBON         TO LINE2A
  2759           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2760           GO TO 8200-SEND-DATAONLY
  2761        END-IF
  2762     END-IF.
  2763 2599-EXIT.
  2764      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  58
* EL1284.cbl
  2766 3000-DELETE-LINES.
  2767     IF LINE2L = ZEROS AND LINE2I = 1
  2768        MOVE LINE1I              TO LINE2I
  2769     END-IF.
  2770
  2771     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  2772        MOVE ER-0049             TO EMI-ERROR
  2773        MOVE AL-UNBON            TO LINE2A
  2774        MOVE -1                  TO LINE2L
  2775        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2776        GO TO 8200-SEND-DATAONLY
  2777     END-IF.
  2778
  2779     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2780     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2781             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2782             SC-INDX > NUM-LINES-PER-SCREEN
  2783     SET TB-INDX TO LINE1I.
  2784
  2785     IF NOT EMI-NO-ERRORS
  2786        GO TO 8200-SEND-DATAONLY
  2787     END-IF.
  2788
  2789     SET TB-INDX TO LINE1I
  2790     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1.
  2791
  2792     IF LINE2I NOT = PI-TOTAL-LINES
  2793        SET TB-INDX1 TO LINE2I
  2794        SET TB-INDX1 UP BY 1
  2795        PERFORM 3100-DELETE-TABLE-ENTRIES
  2796                UNTIL TB-INDX1 > PI-TOTAL-LINES
  2797     END-IF.
  2798
  2799     PERFORM 3150-BLANK-TABLE-ENTRIES
  2800             ROLL-COUNTER TIMES.
  2801     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES.
  2802
  2803     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  2804        MOVE PI-TOTAL-LINES      TO PI-CURRENT-LINE
  2805        SUBTRACT 1 FROM PI-CURRENT-LINE
  2806     END-IF.
  2807
  2808     SET TB-INDX  TO PI-CURRENT-LINE
  2809     MOVE LOW-VALUES             TO EL1284AI
  2810                                    EL1284R
  2811
  2812     PERFORM 7800-MOVE-SAVE-TO-MAP.
  2813     IF PI-CURRENT-LINE > ZERO
  2814         PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2815             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2816             SC-INDX > NUM-LINES-PER-SCREEN
  2817         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  2818     END-IF.
  2819
  2820     MOVE '1'                    TO PI-UPDATE-SW.
  2821     IF PI-TOTAL-LINES = ZEROS
  2822        MOVE ZEROS               TO PI-CURRENT-LINE
  2823     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  59
* EL1284.cbl
  2824     MOVE -1 TO FUNCTL
  2825     SET CURSOR-SET TO TRUE
  2826     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  60
* EL1284.cbl
  2828
  2829 3100-DELETE-TABLE-ENTRIES.
  2830     MOVE REC-ENT (TB-INDX1)     TO REC-ENT (TB-INDX)
  2831     SET TB-INDX TB-INDX1 UP BY 1.
  2832
  2833 3150-BLANK-TABLE-ENTRIES.
  2834     MOVE SPACES               TO REC-ENT (TB-INDX).
  2835     MOVE SAVE-BIN-DATE        TO REC-LAST-MAINT-DT (TB-INDX).
  2836     MOVE EIBTIME              TO REC-LAST-MAINT-HHMMSS (TB-INDX).
  2837     MOVE PI-PROCESSOR-ID      TO REC-LAST-MAINT-BY (TB-INDX).
  2838     SET TB-INDX UP BY 1.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  61
* EL1284.cbl
  2840 3500-INSERT-LINES.
  2841
  2842     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2843     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2844             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2845             SC-INDX > NUM-LINES-PER-SCREEN.
  2846
  2847     IF NOT EMI-NO-ERRORS
  2848        GO TO 8200-SEND-DATAONLY
  2849     END-IF.
  2850
  2851     SET TB-INDX TO PI-TOTAL-LINES.
  2852     ADD LINE2I TO PI-TOTAL-LINES.
  2853     SET TB-INDX1 TO PI-TOTAL-LINES.
  2854     PERFORM 3600-INSERT-TABLE-ENTRIES
  2855             UNTIL TB-INDX = LINE1I.
  2856     SET TB-INDX UP BY 1.
  2857
  2858     IF LINE1I EQUAL ZERO
  2859         SET PI-CURRENT-LINE TO 1
  2860     ELSE
  2861         SET PI-CURRENT-LINE TO LINE1I
  2862     END-IF.
  2863
  2864     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE +
  2865                            NUM-LINES-PER-SCREEN.
  2866     IF TB-INDX NOT LESS THAN ROLL-COUNTER OR
  2867                    LESS THAN PI-CURRENT-LINE
  2868        SET SC-INDX TO 1
  2869        SET SC-INDX DOWN BY 1
  2870     ELSE
  2871        SET ROLL-COUNTER TO TB-INDX
  2872        COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  2873                  + 1
  2874        SET SC-INDX TO ROLL-COUNTER
  2875     END-IF.
  2876
  2877     PERFORM 3150-BLANK-TABLE-ENTRIES LINE2I TIMES.
  2878     SET TB-INDX TO PI-CURRENT-LINE.
  2879     MOVE LOW-VALUES             TO EL1284AI
  2880                                    EL1284R
  2881
  2882     IF SC-INDX NOT = ZERO
  2883        MOVE -1 TO SC-TEXTL (SC-INDX)
  2884        SET CURSOR-SET TO TRUE
  2885     END-IF.
  2886
  2887     PERFORM 7800-MOVE-SAVE-TO-MAP.
  2888     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  2889            VARYING SC-INDX FROM 1 BY 1 UNTIL
  2890            SC-INDX > NUM-LINES-PER-SCREEN.
  2891     PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT.
  2892     MOVE '1'                    TO PI-UPDATE-SW.
  2893     MOVE -1 TO FUNCTL
  2894     SET CURSOR-SET TO TRUE
  2895     GO TO 8100-SEND-INITIAL-MAP.
  2896
  2897 3600-INSERT-TABLE-ENTRIES.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  62
* EL1284.cbl
  2898     MOVE REC-ENT (TB-INDX)      TO REC-ENT (TB-INDX1).
  2899     SET TB-INDX TB-INDX1 DOWN BY 1.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  63
* EL1284.cbl
  2901
  2902 4000-CHANGE-ROUTINE.
  2903     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2904     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2905             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2906             SC-INDX > NUM-LINES-PER-SCREEN.
  2907
  2908     IF NOT EMI-NO-ERRORS
  2909        GO TO 8200-SEND-DATAONLY
  2910     END-IF.
  2911
  2912     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  2913     MOVE SPACES                 TO ERRMSGBO.
  2914     GO TO 8200-SEND-DATAONLY.
  2915
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  64
* EL1284.cbl
  2917 4500-SAVE-DATA.
  2918     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  2919     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  2920             VARYING SC-INDX FROM 1 BY 1 UNTIL
  2921             SC-INDX > NUM-LINES-PER-SCREEN.
  2922     IF NOT EMI-NO-ERRORS
  2923        GO TO 8200-SEND-DATAONLY
  2924     END-IF.
  2925
  2926
  2927* EXEC CICS HANDLE CONDITION
  2928*         NOTFND(4610-ENDBR)
  2929*         NOTOPEN(6000-NOT-OPEN)
  2930*         ENDFILE(4610-ENDBR)
  2931*    END-EXEC.
  2932*    MOVE '"$IJ''                 ! $ #00002876' TO DFHEIV0
  2933     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  2934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2935     MOVE X'2420233030303032383736' TO DFHEIV0(25:11)
  2936     CALL 'kxdfhei1' USING DFHEIV0
  2937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2938
  2939
  2940 4610-LOOP.
  2941
  2942* EXEC CICS READ
  2943*        DATASET (ELMEMO-FILE-ID)
  2944*        RIDFLD  (ELMEMO-KEY)
  2945*        SET     (ADDRESS OF CLAIM-MEMO-FILE)
  2946*        GTEQ
  2947*    END-EXEC.
  2948*    MOVE '&"S        G          (   #00002883' TO DFHEIV0
  2949     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2950     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2951     MOVE X'2020233030303032383833' TO DFHEIV0(25:11)
  2952     CALL 'kxdfhei1' USING DFHEIV0,
  2953           ELMEMO-FILE-ID,
  2954           DFHEIV20,
  2955           DFHEIV99,
  2956           ELMEMO-KEY,
  2957           DFHEIV99,
  2958           DFHEIV99,
  2959           DFHEIV99
  2960     SET ADDRESS OF CLAIM-MEMO-FILE TO
  2961         DFHEIV20
  2962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2963
  2964
  2965     MOVE MM-CONTROL-PRIMARY     TO ELMEMO-KEY.
  2966
  2967     IF ELMEMO-PARTIAL-KEY NOT = SV-PRIOR-KEY
  2968         MOVE SV-PRIOR-KEY       TO ELMEMO-PARTIAL-KEY
  2969         GO TO 4610-ENDBR
  2970     END-IF.
  2971
  2972
  2973* EXEC CICS DELETE
  2974*        DATASET (ELMEMO-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  65
* EL1284.cbl
  2975*        RIDFLD  (ELMEMO-KEY)
  2976*    END-EXEC.
  2977*    MOVE '&(  R                 &   #00002897' TO DFHEIV0
  2978     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  2979     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2980     MOVE X'2020233030303032383937' TO DFHEIV0(25:11)
  2981     CALL 'kxdfhei1' USING DFHEIV0,
  2982           ELMEMO-FILE-ID,
  2983           ELMEMO-KEY,
  2984           DFHEIV99,
  2985           DFHEIV99,
  2986           DFHEIV99
  2987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2988
  2989
  2990     GO TO 4610-LOOP.
  2991 4610-ENDBR.
  2992
  2993* EXEC CICS GETMAIN
  2994*         LENGTH(ELMEMO-LENGTH)
  2995*         SET(ADDRESS OF CLAIM-MEMO-FILE)
  2996*         INITIMG(GETMAIN-SPACE)
  2997*    END-EXEC.
  2998*    MOVE ',"IL                  $   #00002904' TO DFHEIV0
  2999     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3000     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3001     MOVE X'2020233030303032393034' TO DFHEIV0(25:11)
  3002     CALL 'kxdfhei1' USING DFHEIV0,
  3003           DFHEIV20,
  3004           ELMEMO-LENGTH,
  3005           GETMAIN-SPACE
  3006     SET ADDRESS OF CLAIM-MEMO-FILE TO
  3007         DFHEIV20
  3008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3009
  3010     PERFORM 4650-WRITE-HEADER THRU 4650-EXIT.
  3011
  3012     MOVE 1                      TO  ELMEMO-SEQ.
  3013     MOVE ZERO                   TO  WS-BLANK-LINES.
  3014
  3015     PERFORM 4700-WRITE-FILE THRU 4799-EXIT
  3016             VARYING TB-INDX FROM 1 BY 1 UNTIL
  3017             TB-INDX > PI-TOTAL-LINES.
  3018
  3019     SUBTRACT WS-BLANK-LINES FROM PI-TOTAL-LINES.
  3020
  3021     GO TO 9410-RETURN.
  3022 4650-WRITE-HEADER.
  3023
  3024     MOVE SPACES                 TO  CLAIM-MEMO-FILE.
  3025     MOVE ZERO                   TO  ELMEMO-SEQ.
  3026     MOVE ELMEMO-KEY             TO  MM-CONTROL-PRIMARY.
  3027     MOVE  'MM'                  TO  MM-RECORD-ID.
  3028     MOVE REC-TEXT (TB-INDX)     TO  MM-CLAIM-MEMO
  3029     MOVE LNGHLAPI               TO MM-LONG-HEALTH-APP
  3030     MOVE REWRITEI               TO MM-REWRITE-IND
  3031     MOVE CHKCOVGI               TO MM-CHECKED-OTHER-COVG
  3032     IF MRRELDTI > SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  66
* EL1284.cbl
  3033        MOVE MRRELDTI               TO DEEDIT-DATE-INPUT
  3034
  3035* EXEC CICS BIF DEEDIT
  3036*           FIELD    (DEEDIT-DATE-INPUT)
  3037*           LENGTH   (DATE-LENGTH)
  3038*       END-EXEC
  3039*    MOVE '@"L                   #   #00002933' TO DFHEIV0
  3040     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3041     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3042     MOVE X'2020233030303032393333' TO DFHEIV0(25:11)
  3043     CALL 'kxdfhei1' USING DFHEIV0,
  3044           DEEDIT-DATE-INPUT,
  3045           DATE-LENGTH
  3046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3047        MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  3048        MOVE '4'            TO DC-OPTION-CODE
  3049        PERFORM PERFORM 9700-LINK-DATE-CONVERT
  3050        IF NOT DATE-CONVERSION-ERROR
  3051            MOVE DC-BIN-DATE-1      TO MM-MR-RELEASED-FROM-DATE
  3052*           MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  3053*           MOVE AL-UANON           TO INCA
  3054*           MOVE DC-GREG-DATE-1-EDIT TO INCO
  3055        ELSE
  3056            MOVE -1         TO MRRELDTL
  3057            MOVE ER-0314    TO EMI-ERROR
  3058            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3059            GO TO 8200-SEND-DATAONLY
  3060        END-IF
  3061     END-IF.
  3062*        MOVE AL-UABON   TO INCA
  3063*        MOVE -1         TO INCL
  3064*        MOVE 'X'        TO ERROR-SWITCH.
  3065
  3066* EXEC CICS WRITE
  3067*         DATASET(ELMEMO-FILE-ID)
  3068*         FROM(CLAIM-MEMO-FILE)
  3069*         RIDFLD(ELMEMO-KEY)
  3070*    END-EXEC.
  3071     MOVE LENGTH OF
  3072      CLAIM-MEMO-FILE
  3073       TO DFHEIV11
  3074*    MOVE '&$ L                  ''   #00002955' TO DFHEIV0
  3075     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3076     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3077     MOVE X'2020233030303032393535' TO DFHEIV0(25:11)
  3078     CALL 'kxdfhei1' USING DFHEIV0,
  3079           ELMEMO-FILE-ID,
  3080           CLAIM-MEMO-FILE,
  3081           DFHEIV11,
  3082           ELMEMO-KEY,
  3083           DFHEIV99,
  3084           DFHEIV99
  3085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3086
  3087 4650-EXIT.
  3088      EXIT.
  3089
  3090 4700-WRITE-FILE.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  67
* EL1284.cbl
  3091*    IF REC-TEXT (TB-INDX)  EQUAL SPACES
  3092*        ADD +1                  TO  WS-BLANK-LINES
  3093*        GO TO 4799-EXIT
  3094*    END-IF.
  3095
  3096     MOVE SPACES                 TO  CLAIM-MEMO-FILE.
  3097     ADD 1                       TO  ELMEMO-SEQ.
  3098     MOVE ELMEMO-KEY             TO  MM-CONTROL-PRIMARY.
  3099     MOVE  'MM'                  TO  MM-RECORD-ID.
  3100     MOVE REC-TEXT (TB-INDX)     TO  MM-CLAIM-MEMO
  3101     MOVE REC-LAST-MAINT-BY (TB-INDX)
  3102                                 TO  MM-LAST-MAINT-BY
  3103     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  3104                                 TO  MM-LAST-MAINT-HHMMSS.
  3105     MOVE REC-LAST-MAINT-DT (TB-INDX)
  3106                                 TO  MM-LAST-MAINT-DT.
  3107
  3108
  3109* EXEC CICS WRITE
  3110*         DATASET(ELMEMO-FILE-ID)
  3111*         FROM(CLAIM-MEMO-FILE)
  3112*         RIDFLD(ELMEMO-KEY)
  3113*    END-EXEC.
  3114     MOVE LENGTH OF
  3115      CLAIM-MEMO-FILE
  3116       TO DFHEIV11
  3117*    MOVE '&$ L                  ''   #00002981' TO DFHEIV0
  3118     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3119     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3120     MOVE X'2020233030303032393831' TO DFHEIV0(25:11)
  3121     CALL 'kxdfhei1' USING DFHEIV0,
  3122           ELMEMO-FILE-ID,
  3123           CLAIM-MEMO-FILE,
  3124           DFHEIV11,
  3125           ELMEMO-KEY,
  3126           DFHEIV99,
  3127           DFHEIV99
  3128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3129
  3130 4799-EXIT.
  3131      EXIT.
  3132
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  68
* EL1284.cbl
  3134
  3135 4900-SET-NOTES-FLAG.
  3136
  3137
  3138* EXEC CICS HANDLE CONDITION
  3139*        NOTFND   (4900-EXIT)
  3140*    END-EXEC.
  3141*    MOVE '"$I                   ! % #00002993' TO DFHEIV0
  3142     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3144     MOVE X'2520233030303032393933' TO DFHEIV0(25:11)
  3145     CALL 'kxdfhei1' USING DFHEIV0
  3146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3147
  3148
  3149     MOVE SPACES                 TO  ELCERT-KEY.
  3150     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  3151     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  3152     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  3153     MOVE PI-STATE               TO  ELCERT-STATE.
  3154     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  3155     MOVE PI-CERT-EFF-DT         TO  ELCERT-EFF-DT.
  3156     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  3157     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  3158
  3159
  3160* EXEC CICS READ
  3161*    EQUAL
  3162*    DATASET   (ELCERT-FILE-ID)
  3163*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  3164*    RIDFLD    (ELCERT-KEY)
  3165*    END-EXEC.
  3166*    MOVE '&"S        E          (   #00003007' TO DFHEIV0
  3167     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3169     MOVE X'2020233030303033303037' TO DFHEIV0(25:11)
  3170     CALL 'kxdfhei1' USING DFHEIV0,
  3171           ELCERT-FILE-ID,
  3172           DFHEIV20,
  3173           DFHEIV99,
  3174           ELCERT-KEY,
  3175           DFHEIV99,
  3176           DFHEIV99,
  3177           DFHEIV99
  3178     SET ADDRESS OF CERTIFICATE-MASTER TO
  3179         DFHEIV20
  3180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3181
  3182
  3183*    MOVE 'N'                    TO PI-BILLING-NOTES-EXIST
  3184*                                   PI-CERT-NOTES-EXIST
  3185*                                   PI-CLAIM-NOTES-EXIST.
  3186*    IF CM-NOTE-SW EQUAL '2' OR '3' OR '6' OR '7'
  3187*         MOVE 'Y'               TO PI-BILLING-NOTES-EXIST
  3188*    END-IF.
  3189*    IF CM-NOTE-SW EQUAL '1' OR '3' OR '5' OR '7'
  3190*         MOVE 'Y'               TO PI-CERT-NOTES-EXIST
  3191*    END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  69
* EL1284.cbl
  3192*    IF CM-NOTE-SW EQUAL '4' OR '5' OR '6' OR '7'
  3193*         MOVE 'Y'               TO PI-CLAIM-NOTES-EXIST
  3194*    END-IF.
  3195
  3196
  3197 4900-EXIT.
  3198      EXIT.
  3199
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  70
* EL1284.cbl
  3201 5000-ADD-NEW-LINES.
  3202     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3203     MOVE 'N'                    TO WS-SCREEN-LINE.
  3204     MOVE 1                      TO WS-SUB.
  3205     MOVE ZERO                   TO WS-SUB1.
  3206     PERFORM VARYING SC-INDX FROM NUM-LINES-PER-SCREEN BY -1
  3207             UNTIL SCREEN-LINE-FOUND OR SC-INDX < 1
  3208         IF SC-TEXT (SC-INDX) >  SPACES
  3209             SET WS-SUB          TO SC-INDX
  3210             MOVE 'Y'            TO WS-SCREEN-LINE
  3211         END-IF
  3212     END-PERFORM.
  3213     IF PI-TOTAL-LINES = 0
  3214         MOVE 1                  TO WS-SUB1
  3215     ELSE
  3216         MOVE 2                  TO WS-SUB1
  3217     END-IF.
  3218     PERFORM VARYING SC-INDX FROM WS-SUB1 BY 1
  3219             UNTIL SC-INDX GREATER THAN WS-SUB
  3220         IF SC-TEXTL (SC-INDX) EQUAL ZEROS
  3221             MOVE 1      TO SC-TEXTL (SC-INDX)
  3222             MOVE SPACES TO SC-TEXT (SC-INDX)
  3223             MOVE LOW-VALUES TO SC-MTBY (SC-INDX)
  3224                                SC-MTDT (SC-INDX)
  3225         END-IF
  3226     END-PERFORM.
  3227     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3228             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3229             SC-INDX > NUM-LINES-PER-SCREEN.
  3230
  3231     IF NOT EMI-NO-ERRORS
  3232        GO TO 8200-SEND-DATAONLY
  3233     END-IF.
  3234
  3235     MOVE PI-TOTAL-LINES         TO  PI-CURRENT-LINE.
  3236     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3237     MOVE LOW-VALUES             TO  EL1284AI
  3238                                     EL1284R
  3239     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3240     SET TB-INDX TO PI-CURRENT-LINE.
  3241     MOVE 'A'                    TO FUNCTI.
  3242     MOVE -1                     TO  SC-TEXTL (2).
  3243     SET CURSOR-SET TO TRUE
  3244     MOVE AL-UANON               TO  FUNCTA.
  3245     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3246             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3247             SC-INDX > NUM-LINES-PER-SCREEN.
  3248     MOVE '1'                    TO PI-UPDATE-SW.
  3249     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  71
* EL1284.cbl
  3251 5500-LOOKUP.
  3252     PERFORM 7500-READ-TS THRU 7599-EXIT.
  3253     SET TB-INDX TO PI-CURRENT-LINE.
  3254     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3255             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3256             SC-INDX > NUM-LINES-PER-SCREEN.
  3257
  3258     IF NOT EMI-NO-ERRORS
  3259        GO TO 8200-SEND-DATAONLY
  3260     END-IF.
  3261
  3262     MOVE LINE1I                 TO  PI-CURRENT-LINE.
  3263     SET TB-INDX                 TO PI-CURRENT-LINE.
  3264     MOVE LOW-VALUES             TO  EL1284AI
  3265                                     EL1284R
  3266     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3267     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3268             VARYING SC-INDX FROM 1 BY 1
  3269             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3270     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3271     MOVE -1 TO FUNCTL
  3272     SET CURSOR-SET TO TRUE
  3273     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  72
* EL1284.cbl
  3275 6000-NOT-OPEN.
  3276     MOVE ER-2954                TO  EMI-ERROR.
  3277     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3278
  3279     IF EIBAID = DFHCLEAR
  3280         GO TO 9410-RETURN
  3281     ELSE
  3282         GO TO 8100-SEND-INITIAL-MAP
  3283     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  73
* EL1284.cbl
  3285 7000-BUILD-TABLE.
  3286
  3287     SET TB-INDX TO 1.
  3288     MOVE ZEROS                  TO  PI-TOTAL-LINES
  3289                                     PI-CURRENT-LINE
  3290                                     PI-TEMP-STOR-ITEMS
  3291                                     PI-UPDATE-SW.
  3292     MOVE LOW-VALUES             TO  EL1284AI
  3293                                     EL1284R
  3294
  3295****IF TEMP STORAGE EXISTS, DELETE IT.
  3296     IF PI-CHANGE-IN-NOTE-TYPE
  3297         MOVE 'N' TO PI-SET-NOTE-CHANGE
  3298     ELSE
  3299         PERFORM 7500-READ-TS THRU 7599-EXIT
  3300     END-IF.
  3301
  3302     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  3303        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  3304     END-IF.
  3305
  3306
  3307* EXEC CICS HANDLE CONDITION
  3308*         NOTFND(7010-ENDBR)
  3309*         NOTOPEN(6000-NOT-OPEN)
  3310*         ENDFILE(7010-ENDBR)
  3311*    END-EXEC.
  3312*    MOVE '"$IJ''                 ! & #00003137' TO DFHEIV0
  3313     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3315     MOVE X'2620233030303033313337' TO DFHEIV0(25:11)
  3316     CALL 'kxdfhei1' USING DFHEIV0
  3317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3318
  3319
  3320
  3321* EXEC CICS STARTBR
  3322*         DATASET(ELMEMO-FILE-ID)
  3323*         RIDFLD(ELMEMO-KEY)
  3324*         KEYLENGTH(ELMEMO-START-LENGTH)
  3325*         GENERIC
  3326*         GTEQ
  3327*    END-EXEC.
  3328     MOVE 0
  3329       TO DFHEIV11
  3330*    MOVE '&,   KG    G          &   #00003143' TO DFHEIV0
  3331     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3332     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3333     MOVE X'2020233030303033313433' TO DFHEIV0(25:11)
  3334     CALL 'kxdfhei1' USING DFHEIV0,
  3335           ELMEMO-FILE-ID,
  3336           ELMEMO-KEY,
  3337           ELMEMO-START-LENGTH,
  3338           DFHEIV11,
  3339           DFHEIV99
  3340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3341
  3342
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  74
* EL1284.cbl
  3343 7001-LOOP.
  3344
  3345* EXEC CICS READNEXT
  3346*         SET(ADDRESS OF CLAIM-MEMO-FILE)
  3347*         DATASET(ELMEMO-FILE-ID)
  3348*         RIDFLD(ELMEMO-KEY)
  3349*    END-EXEC.
  3350     MOVE 0
  3351       TO DFHEIV11
  3352*    MOVE '&.S                   )   #00003152' TO DFHEIV0
  3353     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3354     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3355     MOVE X'2020233030303033313532' TO DFHEIV0(25:11)
  3356     CALL 'kxdfhei1' USING DFHEIV0,
  3357           ELMEMO-FILE-ID,
  3358           DFHEIV20,
  3359           DFHEIV99,
  3360           ELMEMO-KEY,
  3361           DFHEIV99,
  3362           DFHEIV11,
  3363           DFHEIV99,
  3364           DFHEIV99
  3365     SET ADDRESS OF CLAIM-MEMO-FILE TO
  3366         DFHEIV20
  3367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3368
  3369
  3370     IF MM-COMPANY-CD NOT = SV-COMPANY-CD
  3371         GO TO 7010-ENDBR
  3372     END-IF.
  3373
  3374     IF (MM-CARRIER = SV-CARRIER)
  3375        AND (MM-CERT-NO = SV-CERT-NO)
  3376        AND (MM-CLAIM-NO = SV-CLAIM-NO)
  3377        AND (MM-RECORD-TYPE = SV-RECORD-TYPE)
  3378        IF MM-PAYMENT-SEQ-NO = ZERO
  3379           MOVE MM-LONG-HEALTH-APP TO LNGHLAPO
  3380                                      PI-LONG-HLTH-APP
  3381           MOVE MM-REWRITE-IND TO REWRITEO
  3382                                  PI-REWRITE
  3383           MOVE MM-CHECKED-OTHER-COVG TO CHKCOVGO
  3384                                         PI-CHKCOVG
  3385           MOVE MM-MR-RELEASED-FROM-DATE TO DC-BIN-DATE-1
  3386           MOVE ' '                    TO DC-OPTION-CODE
  3387           PERFORM 9700-LINK-DATE-CONVERT
  3388           IF DC-EDIT1-MONTH > ZERO
  3389              MOVE DC-GREG-DATE-1-EDIT    TO MRRELDTO
  3390                                             PI-MR-RELEASE-DATE
  3391           END-IF
  3392        ELSE
  3393           MOVE MM-CLAIM-MEMO TO REC-TEXT (TB-INDX)
  3394           MOVE MM-LAST-MAINT-BY TO REC-LAST-MAINT-BY (TB-INDX)
  3395           MOVE MM-LAST-MAINT-DT TO REC-LAST-MAINT-DT (TB-INDX)
  3396           MOVE MM-LAST-MAINT-HHMMSS TO
  3397                          REC-LAST-MAINT-HHMMSS (TB-INDX)
  3398           SET TB-INDX UP BY 1
  3399        END-IF
  3400        GO TO 7001-LOOP
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  75
* EL1284.cbl
  3401     END-IF.
  3402 7010-ENDBR.
  3403     IF TB-INDX = 1
  3404         MOVE ER-0006            TO EMI-ERROR
  3405         MOVE 'A'                TO FUNCTI
  3406         MOVE -1                 TO SC-TEXTL (1)
  3407         MOVE AL-UANON           TO FUNCTA
  3408         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3409         MOVE ZEROS              TO PI-TOTAL-LINES
  3410         GO TO 8100-SEND-INITIAL-MAP
  3411     END-IF.
  3412
  3413
  3414* EXEC CICS ENDBR
  3415*         DATASET(ELMEMO-FILE-ID)
  3416*    END-EXEC.
  3417     MOVE 0
  3418       TO DFHEIV11
  3419*    MOVE '&2                    $   #00003201' TO DFHEIV0
  3420     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3421     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3422     MOVE X'2020233030303033323031' TO DFHEIV0(25:11)
  3423     CALL 'kxdfhei1' USING DFHEIV0,
  3424           ELMEMO-FILE-ID,
  3425           DFHEIV11,
  3426           DFHEIV99
  3427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3428
  3429
  3430     SET TB-INDX DOWN BY 1.
  3431     SET PI-TOTAL-LINES TO TB-INDX.
  3432     MOVE 1                      TO PI-CURRENT-LINE.
  3433
  3434 7050-FORMAT-LINES.
  3435     SET TB-INDX TO PI-CURRENT-LINE.
  3436     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3437             VARYING SC-INDX FROM 1
  3438             BY 1 UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3439     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3440     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  76
* EL1284.cbl
  3442 7100-FORMAT-SCREEN.
  3443     IF TB-INDX > PI-TOTAL-LINES
  3444        IF FUNCTI NOT = 'A'
  3445           MOVE AL-PANON         TO SC-TEXTA (SC-INDX)
  3446        END-IF
  3447     END-IF.
  3448
  3449     IF TB-INDX > PI-TOTAL-LINES
  3450         GO TO 7100-EXIT
  3451     END-IF.
  3452
  3453     SET WS-LINE TO TB-INDX.
  3454     MOVE WS-LINE TO SC-LIN (SC-INDX).
  3455     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  3456     MOVE REC-LAST-MAINT-BY (TB-INDX) TO SC-MTBY (SC-INDX).
  3457     MOVE REC-LAST-MAINT-DT (TB-INDX) TO DC-BIN-DATE-1.
  3458     MOVE ' '                    TO DC-OPTION-CODE.
  3459     PERFORM 9700-LINK-DATE-CONVERT.
  3460     MOVE DC-GREG-DATE-1-MDY     TO SC-MTDT (SC-INDX).
  3461     SET ROLL-COUNTER TO TB-INDX.
  3462
  3463     IF NOT MODIFY-CAP
  3464         MOVE AL-PANOF           TO SC-TEXTA (SC-INDX)
  3465         SET TB-INDX UP BY 1
  3466         GO TO 7100-EXIT
  3467     END-IF.
  3468
  3469     SET TB-INDX UP BY 1.
  3470
  3471 7100-EXIT.
  3472      EXIT.
  3473
  3474 7200-PUT-TEMP-STOR.
  3475     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3476     SET TS-INDX TO 1.
  3477     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
  3478     PERFORM 7300-WRITE-TS THRU 7399-EXIT
  3479             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
  3480             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
  3481 7249-EXIT.
  3482      EXIT.
  3483 7250-DELETE-TEMP-STOR.
  3484
  3485* EXEC CICS HANDLE CONDITION
  3486*         QIDERR(7299-EXIT)
  3487*    END-EXEC.
  3488*    MOVE '"$N                   ! '' #00003259' TO DFHEIV0
  3489     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3491     MOVE X'2720233030303033323539' TO DFHEIV0(25:11)
  3492     CALL 'kxdfhei1' USING DFHEIV0
  3493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3494
  3495
  3496* EXEC CICS DELETEQ TS
  3497*         QUEUE(QID)
  3498*    END-EXEC.
  3499*    MOVE '*&                    #   #00003262' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  77
* EL1284.cbl
  3500     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3501     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3502     MOVE X'2020233030303033323632' TO DFHEIV0(25:11)
  3503     CALL 'kxdfhei1' USING DFHEIV0,
  3504           QID,
  3505           DFHEIV99
  3506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3507
  3508 7299-EXIT.
  3509     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  78
* EL1284.cbl
  3511 7300-WRITE-TS.
  3512     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
  3513     SET TS-INDX UP BY 1.
  3514     ADD 1 TO PI-TEMP-STOR-ITEMS.
  3515
  3516* EXEC CICS WRITEQ TS
  3517*         FROM(TS-WORK-AREA)
  3518*         QUEUE(QID)
  3519*         LENGTH(TS-LENGTH)
  3520*         ITEM(PI-TEMP-STOR-ITEMS)
  3521*    END-EXEC.
  3522*    MOVE '*" I                  ''   #00003272' TO DFHEIV0
  3523     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  3524     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3525     MOVE X'2020233030303033323732' TO DFHEIV0(25:11)
  3526     CALL 'kxdfhei1' USING DFHEIV0,
  3527           QID,
  3528           TS-WORK-AREA,
  3529           TS-LENGTH,
  3530           PI-TEMP-STOR-ITEMS,
  3531           DFHEIV99,
  3532           DFHEIV99
  3533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3534
  3535 7399-EXIT.
  3536     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  79
* EL1284.cbl
  3538 7400-PAGE-ROUTINE.
  3539
  3540     IF PFENTERL NOT = ZEROS
  3541        MOVE -1                  TO PFENTERL
  3542        ELSE
  3543        MOVE -1                  TO FUNCTL
  3544     END-IF.
  3545
  3546     IF PI-TOTAL-LINES = 0
  3547        MOVE ER-0047             TO EMI-ERROR
  3548        MOVE -1                  TO FUNCTL
  3549        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3550        GO TO 8200-SEND-DATAONLY
  3551     END-IF.
  3552
  3553     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
  3554
  3555     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3556        MOVE ER-0067             TO EMI-ERROR
  3557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3558        MOVE 1 TO TEMP-CURR-LINE
  3559     END-IF.
  3560
  3561     IF TEMP-CURR-LINE GREATER THAN PI-TOTAL-LINES
  3562        MOVE ER-0066             TO EMI-ERROR
  3563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3564        COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  3565                               - NUM-LINES-PER-SCREEN
  3566        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  3567           MOVE 1                TO TEMP-CURR-LINE
  3568        END-IF
  3569     END-IF.
  3570
  3571     PERFORM 7450-SET-INDX THRU 7450-EXIT.
  3572     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3573             VARYING SC-INDX FROM 1 BY 1 UNTIL
  3574             SC-INDX > NUM-LINES-PER-SCREEN.
  3575
  3576     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  3577        NEXT SENTENCE
  3578     ELSE
  3579        GO TO 8200-SEND-DATAONLY
  3580     END-IF.
  3581
  3582     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
  3583     SET TB-INDX TO PI-CURRENT-LINE.
  3584     MOVE LOW-VALUES             TO EL1284AI
  3585                                    EL1284R
  3586     PERFORM 7800-MOVE-SAVE-TO-MAP.
  3587     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  3588             VARYING SC-INDX FROM 1 BY 1
  3589             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  3590     PERFORM 7200-PUT-TEMP-STOR THRU 7249-EXIT.
  3591     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  80
* EL1284.cbl
  3593
  3594 7450-SET-INDX.
  3595     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  3596        SET TB-INDX TO 1
  3597     ELSE
  3598        PERFORM 7500-READ-TS THRU 7599-EXIT
  3599        IF PI-CURRENT-LINE = 0
  3600           SET TB-INDX TO 1
  3601        ELSE
  3602           SET TB-INDX TO PI-CURRENT-LINE
  3603        END-IF
  3604     END-IF.
  3605 7450-EXIT.
  3606      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  81
* EL1284.cbl
  3608 7500-READ-TS.
  3609
  3610* EXEC CICS HANDLE CONDITION
  3611*         QIDERR(7590-TS-QIDERR)
  3612*         ITEMERR(7585-QID-ITEMERR)
  3613*    END-EXEC.
  3614*    MOVE '"$N<                  ! ( #00003352' TO DFHEIV0
  3615     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  3616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3617     MOVE X'2820233030303033333532' TO DFHEIV0(25:11)
  3618     CALL 'kxdfhei1' USING DFHEIV0
  3619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3620
  3621     SET TS-INDX TO 1.
  3622     MOVE 1                      TO QID-ITEM.
  3623 7501-LOOP.
  3624
  3625* EXEC CICS READQ TS
  3626*         INTO(TS-WORK-AREA)
  3627*         QUEUE(QID)
  3628*         LENGTH(TS-LENGTH)
  3629*         ITEM(QID-ITEM)
  3630*    END-EXEC.
  3631*    MOVE '*$II   L              ''   #00003359' TO DFHEIV0
  3632     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3633     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3634     MOVE X'2020233030303033333539' TO DFHEIV0(25:11)
  3635     CALL 'kxdfhei1' USING DFHEIV0,
  3636           QID,
  3637           TS-WORK-AREA,
  3638           TS-LENGTH,
  3639           QID-ITEM,
  3640           DFHEIV99,
  3641           DFHEIV99
  3642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3643
  3644     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
  3645     SET TS-INDX UP BY 1.
  3646     ADD 1 TO QID-ITEM.
  3647     GO TO 7501-LOOP.
  3648
  3649 7585-QID-ITEMERR.
  3650     IF EIBTRNID NOT = TRANS-ID
  3651        SUBTRACT 1 FROM QID-ITEM
  3652        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS
  3653     END-IF.
  3654     GO TO 7599-EXIT.
  3655
  3656 7590-TS-QIDERR.
  3657     IF EIBTRNID = TRANS-ID
  3658        AND EIBAID = DFHCLEAR
  3659           GO TO 9410-RETURN
  3660     END-IF.
  3661     IF EIBTRNID = TRANS-ID
  3662        MOVE ER-0033             TO EMI-ERROR
  3663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3664        GO TO 8100-SEND-INITIAL-MAP
  3665     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  82
* EL1284.cbl
  3666
  3667 7599-EXIT.
  3668      EXIT.
  3669
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  83
* EL1284.cbl
  3671 7600-UPDATE-TABLE-FROM-SCREEN.
  3672
  3673     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3674         IF TB-INDX NOT > PI-TOTAL-LINES
  3675             PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3676             SET TB-INDX UP BY 1
  3677         ELSE
  3678             IF PI-TOTAL-LINES = MAX-LINES
  3679                 MOVE ER-0051    TO EMI-ERROR
  3680                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3681                 GO TO 8200-SEND-DATAONLY
  3682             ELSE
  3683                 PERFORM 7700-MOVE-DATA THRU 7700-EXIT
  3684                 SET TB-INDX UP BY 1
  3685                 ADD 1 TO PI-TOTAL-LINES
  3686             END-IF
  3687         END-IF
  3688     ELSE
  3689        IF TB-INDX NOT > PI-TOTAL-LINES
  3690           SET TB-INDX UP BY 1
  3691        END-IF
  3692     END-IF.
  3693
  3694 7699-EXIT.
  3695      EXIT.
  3696
  3697 7700-MOVE-DATA.
  3698     MOVE '1'                    TO PI-UPDATE-SW.
  3699
  3700     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  3701        MOVE SC-TEXT (SC-INDX)  TO REC-TEXT (TB-INDX)
  3702        MOVE PI-PROCESSOR-ID    TO REC-LAST-MAINT-BY (TB-INDX)
  3703        MOVE EIBTIME            TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  3704        MOVE SAVE-BIN-DATE      TO REC-LAST-MAINT-DT (TB-INDX)
  3705     END-IF.
  3706
  3707 7700-EXIT.
  3708      EXIT.
  3709 7800-MOVE-SAVE-TO-MAP.
  3710     MOVE PI-LONG-HLTH-APP TO LNGHLAPI
  3711     MOVE PI-REWRITE TO REWRITEI
  3712     MOVE PI-CHKCOVG TO CHKCOVGI
  3713     MOVE PI-MR-RELEASE-DATE TO MRRELDTI.
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  84
* EL1284.cbl
  3715 8100-SEND-INITIAL-MAP.
  3716     MOVE SAVE-DATE              TO DATEO.
  3717     MOVE EIBTIME                TO TIME-IN.
  3718     MOVE TIME-OUT               TO TIMEO.
  3719     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3720     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3721     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGBO.
  3722     MOVE PI-CARRIER             TO CARRO
  3723*    MOVE PI-GROUPING            TO FGROUPO.
  3724*    MOVE PI-STATE               TO FSTO.
  3725*    MOVE PI-ACCOUNT             TO FACOUNTO.
  3726     MOVE PI-CERT-NO             TO CERTNOO
  3727     MOVE PI-CLAIM-NO            TO CLAIMNOO
  3728*    MOVE PI-CERT-SFX            TO FCRTSFXO.
  3729*
  3730     PERFORM 8150-READ-CLAIM.
  3731*
  3732     MOVE  ' '                   TO DC-OPTION-CODE.
  3733     MOVE PI-CERT-EFF-DT         TO DC-BIN-DATE-1.
  3734     PERFORM 9700-LINK-DATE-CONVERT.
  3735*    MOVE DC-GREG-DATE-1-EDIT    TO FEFFDTO.
  3736     MOVE PI-TOTAL-LINES         TO TOTO.
  3737*    IF PI-CLAIM-NOTE
  3738*        MOVE SCR-CLAIM-NOTE-TYPE TO FTYPEO
  3739*        MOVE SCR-PF6-CERT        TO PF6NOTEO
  3740*        MOVE SCR-CERT-YN         TO FTYPEYNO
  3741*        IF PI-CERT-NOTES-EXIST = 'Y'
  3742*            MOVE 'YES'           TO FCERTYNO
  3743*        ELSE
  3744*            MOVE 'NO '           TO FCERTYNO
  3745*        END-IF
  3746*    ELSE
  3747*        MOVE SCR-CERT-NOTE-TYPE TO FTYPEO
  3748*        MOVE SCR-PF6-CLAIM      TO PF6NOTEO
  3749*        MOVE SCR-CLAIM-YN       TO FTYPEYNO
  3750*        IF PI-CLAIM-NOTES-EXIST = 'Y'
  3751*            MOVE 'YES'           TO FCERTYNO
  3752*        ELSE
  3753*            MOVE 'NO '           TO FCERTYNO
  3754*        END-IF
  3755*    END-IF.
  3756*    IF PI-BILLING-NOTES-EXIST = 'Y'
  3757*        MOVE 'YES'           TO FBILLYNO
  3758*    ELSE
  3759*        MOVE 'NO '           TO FBILLYNO
  3760*    END-IF
  3761
  3762     MOVE EL1284R TO GROUP2.
  3763     IF NOT CURSOR-SET
  3764        MOVE -1                     TO LNGHLAPL
  3765     END-IF
  3766
  3767
  3768* EXEC CICS SEND
  3769*         MAP(MAP-NAME)
  3770*         MAPSET(MAPSET-NAME)
  3771*         FROM(EL1284AO)
  3772*         ERASE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  85
* EL1284.cbl
  3773*         CURSOR
  3774*    END-EXEC.
  3775     MOVE LENGTH OF
  3776      EL1284AO
  3777       TO DFHEIV12
  3778     MOVE -1
  3779       TO DFHEIV11
  3780*    MOVE '8$     CT  E    H L F ,   #00003488' TO DFHEIV0
  3781     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3782     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3783     MOVE X'2020233030303033343838' TO DFHEIV0(25:11)
  3784     CALL 'kxdfhei1' USING DFHEIV0,
  3785           MAP-NAME,
  3786           EL1284AO,
  3787           DFHEIV12,
  3788           MAPSET-NAME,
  3789           DFHEIV99,
  3790           DFHEIV99,
  3791           DFHEIV99,
  3792           DFHEIV11,
  3793           DFHEIV99,
  3794           DFHEIV99,
  3795           DFHEIV99
  3796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3797
  3798
  3799     GO TO 9100-RETURN-TRAN.
  3800
  3801 8150-READ-CLAIM.
  3802
  3803* EXEC CICS HANDLE CONDITION
  3804*        NOTFND   (8150-NOT-FOUND)
  3805*    END-EXEC.
  3806*    MOVE '"$I                   ! ) #00003499' TO DFHEIV0
  3807     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3809     MOVE X'2920233030303033343939' TO DFHEIV0(25:11)
  3810     CALL 'kxdfhei1' USING DFHEIV0
  3811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3812
  3813     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  3814     MOVE PI-CARRIER             TO MSTR-CARRIER.
  3815     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  3816     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  3817
  3818
  3819* EXEC CICS READ
  3820*        UPDATE
  3821*        DATASET   ('ELMSTR')
  3822*        RIDFLD    (ELMSTR-KEY)
  3823*        INTO      (CLAIM-MASTER)
  3824*    END-EXEC.
  3825     MOVE LENGTH OF
  3826      CLAIM-MASTER
  3827       TO DFHEIV11
  3828     MOVE 'ELMSTR' TO DFHEIV1
  3829*    MOVE '&"IL       EU         (   #00003507' TO DFHEIV0
  3830     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  86
* EL1284.cbl
  3831     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3832     MOVE X'2020233030303033353037' TO DFHEIV0(25:11)
  3833     CALL 'kxdfhei1' USING DFHEIV0,
  3834           DFHEIV1,
  3835           CLAIM-MASTER,
  3836           DFHEIV11,
  3837           ELMSTR-KEY,
  3838           DFHEIV99,
  3839           DFHEIV99,
  3840           DFHEIV99
  3841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3842
  3843     EVALUATE TRUE
  3844        WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  3845           MOVE PI-AH-OVERRIDE-L6
  3846                                 TO TYPEO
  3847        WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  3848           MOVE PI-LIFE-OVERRIDE-L6
  3849                                 TO TYPEO
  3850        WHEN CL-CLAIM-TYPE = 'I'
  3851           MOVE '  IU  '         TO TYPEO
  3852        WHEN CL-CLAIM-TYPE = 'G'
  3853           MOVE ' GAP  '         TO TYPEO
  3854        WHEN CL-CLAIM-TYPE = 'F'
  3855           MOVE ' FAM  '         TO TYPEO
  3856     END-EVALUATE.
  3857     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
  3858     MOVE CL-INSURED-LAST-NAME   TO LASTNMEO.
  3859 8150-NOT-FOUND.
  3860     MOVE SPACES    TO TYPEO.
  3861*
  3862 8200-SEND-DATAONLY.
  3863     MOVE EIBTIME                TO TIME-IN.
  3864     MOVE TIME-OUT               TO TIMEO.
  3865     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3866     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3867     MOVE PI-TOTAL-LINES         TO TOTO.
  3868     MOVE EL1284R TO GROUP2.
  3869
  3870     IF NOT EMI-NO-ERRORS
  3871        MOVE EMI-MESSAGE-AREA (1) TO ERRMSGBO
  3872     ELSE
  3873        MOVE -1                  TO FUNCTL
  3874     END-IF.
  3875
  3876
  3877* EXEC CICS SEND
  3878*         MAP(MAP-NAME)
  3879*         MAPSET(MAPSET-NAME)
  3880*         FROM(EL1284AO)
  3881*         DATAONLY
  3882*         CURSOR
  3883*    END-EXEC.
  3884     MOVE LENGTH OF
  3885      EL1284AO
  3886       TO DFHEIV12
  3887     MOVE -1
  3888       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  87
* EL1284.cbl
  3889*    MOVE '8$D    CT       H L F ,   #00003546' TO DFHEIV0
  3890     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3891     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3892     MOVE X'2020233030303033353436' TO DFHEIV0(25:11)
  3893     CALL 'kxdfhei1' USING DFHEIV0,
  3894           MAP-NAME,
  3895           EL1284AO,
  3896           DFHEIV12,
  3897           MAPSET-NAME,
  3898           DFHEIV99,
  3899           DFHEIV99,
  3900           DFHEIV99,
  3901           DFHEIV11,
  3902           DFHEIV99,
  3903           DFHEIV99,
  3904           DFHEIV99
  3905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3906
  3907
  3908     GO TO 9100-RETURN-TRAN.
  3909
  3910 8300-SEND-TEXT.
  3911
  3912* EXEC CICS SEND TEXT
  3913*         FROM(LOGOFF-TEXT)
  3914*         ERASE
  3915*         FREEKB
  3916*         LENGTH(LOGOFF-LENGTH)
  3917*    END-EXEC.
  3918*    MOVE '8&      T  E F  H   F -   #00003557' TO DFHEIV0
  3919     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3920     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3921     MOVE X'2020233030303033353537' TO DFHEIV0(25:11)
  3922     CALL 'kxdfhei1' USING DFHEIV0,
  3923           LOGOFF-TEXT,
  3924           LOGOFF-LENGTH,
  3925           DFHEIV99,
  3926           DFHEIV99,
  3927           DFHEIV99,
  3928           DFHEIV99,
  3929           DFHEIV99,
  3930           DFHEIV99,
  3931           DFHEIV99,
  3932           DFHEIV99,
  3933           DFHEIV99,
  3934           DFHEIV99
  3935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3936
  3937
  3938     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  3939
  3940
  3941* EXEC CICS RETURN
  3942*    END-EXEC.
  3943*    MOVE '.(                    ''   #00003566' TO DFHEIV0
  3944     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3945     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3946     MOVE X'2020233030303033353636' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  88
* EL1284.cbl
  3947     CALL 'kxdfhei1' USING DFHEIV0,
  3948           DFHEIV99,
  3949           DFHEIV99,
  3950           DFHEIV99,
  3951           DFHEIV99,
  3952           DFHEIV99,
  3953           DFHEIV99
  3954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3955
  3956
  3957 8800-UNAUTHORIZED-ACCESS.
  3958     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3959     GO TO 8300-SEND-TEXT.
  3960
  3961 9000-RETURN-CICS.
  3962     IF PI-CHANGES-MADE
  3963        MOVE ER-0045             TO EMI-ERROR
  3964        MOVE -1                  TO FUNCTL
  3965        MOVE SPACES              TO PFENTERO
  3966        MOVE AL-UNNOF            TO PFENTERA
  3967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3968        GO TO 8200-SEND-DATAONLY
  3969     END-IF.
  3970
  3971     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3972     MOVE XCTL-005               TO PGM-NAME.
  3973     GO TO 9300-XCTL.
  3974
  3975 9100-RETURN-TRAN.
  3976     MOVE SCRN-NUMBER            TO PI-CURRENT-SCREEN-NO.
  3977     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3978
  3979* EXEC CICS RETURN
  3980*         TRANSID(TRANS-ID)
  3981*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3982*         LENGTH(PI-COMM-LENGTH)
  3983*    END-EXEC.
  3984*    MOVE '.(CT                  ''   #00003590' TO DFHEIV0
  3985     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3986     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3987     MOVE X'2020233030303033353930' TO DFHEIV0(25:11)
  3988     CALL 'kxdfhei1' USING DFHEIV0,
  3989           TRANS-ID,
  3990           PROGRAM-INTERFACE-BLOCK,
  3991           PI-COMM-LENGTH,
  3992           DFHEIV99,
  3993           DFHEIV99,
  3994           DFHEIV99
  3995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3996
  3997
  3998
  3999 9200-RETURN-MAIN-MENU.
  4000     IF PI-CHANGES-MADE
  4001        MOVE -1                  TO FUNCTL
  4002        MOVE SPACES              TO PFENTERO
  4003        MOVE AL-UNNOF            TO PFENTERA
  4004        MOVE ER-0045             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  89
* EL1284.cbl
  4005        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4006        GO TO 8200-SEND-DATAONLY
  4007     END-IF.
  4008
  4009     MOVE XCTL-126               TO PGM-NAME.
  4010
  4011 9300-XCTL.
  4012     PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT.
  4013
  4014* EXEC CICS XCTL
  4015*         PROGRAM  (PGM-NAME)
  4016*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4017*         LENGTH   (PI-COMM-LENGTH)
  4018*    END-EXEC.
  4019*    MOVE '.$C                   %   #00003611' TO DFHEIV0
  4020     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4021     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4022     MOVE X'2020233030303033363131' TO DFHEIV0(25:11)
  4023     CALL 'kxdfhei1' USING DFHEIV0,
  4024           PGM-NAME,
  4025           PROGRAM-INTERFACE-BLOCK,
  4026           PI-COMM-LENGTH,
  4027           DFHEIV99
  4028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4029
  4030
  4031 9400-CLEAR.
  4032
  4033     IF PI-CHANGES-MADE
  4034         MOVE ER-0045            TO EMI-ERROR
  4035         MOVE -1                 TO FUNCTL
  4036         SET CURSOR-SET TO TRUE
  4037         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4038         PERFORM 7800-MOVE-SAVE-TO-MAP
  4039         IF PI-CURRENT-LINE GREATER THAN ZERO
  4040             PERFORM 7500-READ-TS THRU 7599-EXIT
  4041             SET TB-INDX TO PI-CURRENT-LINE
  4042             PERFORM 7100-FORMAT-SCREEN  THRU  7100-EXIT
  4043                 VARYING SC-INDX FROM 1 BY 1 UNTIL
  4044                 SC-INDX GREATER NUM-LINES-PER-SCREEN
  4045         END-IF
  4046         GO TO 8100-SEND-INITIAL-MAP
  4047     END-IF.
  4048
  4049 9410-RETURN.
  4050*    IF PF5-PRESSED
  4051*        MOVE PGM-EL1276           TO PGM-NAME
  4052*    ELSE
  4053*        IF PF6-PRESSED
  4054*            IF PI-CLAIM-NOTE
  4055*                SET PI-CERT-NOTE  TO TRUE
  4056*            ELSE
  4057*                SET PI-CLAIM-NOTE TO TRUE
  4058*            END-IF
  4059*            SET PI-CHANGE-IN-NOTE-TYPE TO TRUE
  4060*            MOVE 'N'              TO PI-PF6-PRESSED
  4061*            GO TO 1000-START
  4062*        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  90
* EL1284.cbl
  4063             MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
  4064*        END-IF
  4065*    END-IF.
  4066     GO TO 9300-XCTL.
  4067
  4068 9500-PF12.
  4069     IF PI-CHANGES-MADE
  4070        MOVE -1                  TO FUNCTL
  4071        MOVE SPACES              TO PFENTERO
  4072        MOVE AL-UNNOF            TO PFENTERA
  4073        MOVE ER-0045             TO EMI-ERROR
  4074        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4075        GO TO 8200-SEND-DATAONLY
  4076     END-IF.
  4077
  4078     MOVE 'EL010'                TO PGM-NAME.
  4079     GO TO 9300-XCTL.
  4080
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  91
* EL1284.cbl
  4082
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  92
* EL1284.cbl
  4084 9600-PGMID-ERROR.
  4085
  4086* EXEC CICS HANDLE CONDITION
  4087*         PGMIDERR(8300-SEND-TEXT)
  4088*    END-EXEC.
  4089*    MOVE '"$L                   ! * #00003671' TO DFHEIV0
  4090     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4092     MOVE X'2A20233030303033363731' TO DFHEIV0(25:11)
  4093     CALL 'kxdfhei1' USING DFHEIV0
  4094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4095
  4096
  4097     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  4098     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  4099     MOVE XCTL-005               TO  PGM-NAME.
  4100     MOVE PGM-NAME               TO  LOGOFF-PGM.
  4101     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  4102
  4103     GO TO 9300-XCTL.
  4104
  4105 9700-LINK-DATE-CONVERT.
  4106
  4107     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4108
  4109* EXEC CICS LINK
  4110*        PROGRAM    (PGM-NAME)
  4111*        COMMAREA   (DATE-CONVERSION-DATA)
  4112*        LENGTH     (DC-COMM-LENGTH)
  4113*    END-EXEC.
  4114*    MOVE '."C                   (   #00003686' TO DFHEIV0
  4115     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4117     MOVE X'2020233030303033363836' TO DFHEIV0(25:11)
  4118     CALL 'kxdfhei1' USING DFHEIV0,
  4119           PGM-NAME,
  4120           DATE-CONVERSION-DATA,
  4121           DC-COMM-LENGTH,
  4122           DFHEIV99,
  4123           DFHEIV99,
  4124           DFHEIV99,
  4125           DFHEIV99
  4126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4127
  4128
  4129 9700-EXIT.
  4130     EXIT.
  4131
  4132 9900-ERROR-FORMAT.
  4133     IF NOT EMI-ERRORS-COMPLETE
  4134        MOVE LINK-001            TO  PGM-NAME
  4135
  4136* EXEC CICS LINK
  4137*            PROGRAM(PGM-NAME)
  4138*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4139*            LENGTH(EMI-COMM-LENGTH)
  4140*       END-EXEC
  4141*    MOVE '."C                   (   #00003698' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  93
* EL1284.cbl
  4142     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4143     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4144     MOVE X'2020233030303033363938' TO DFHEIV0(25:11)
  4145     CALL 'kxdfhei1' USING DFHEIV0,
  4146           PGM-NAME,
  4147           ERROR-MESSAGE-INTERFACE-BLOCK,
  4148           EMI-COMM-LENGTH,
  4149           DFHEIV99,
  4150           DFHEIV99,
  4151           DFHEIV99,
  4152           DFHEIV99
  4153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4154     END-IF.
  4155 9900-EXIT.
  4156     EXIT.
  4157
  4158 9990-ABEND.
  4159     MOVE LINK-004               TO  PGM-NAME.
  4160     MOVE DFHEIBLK               TO  EMI-LINE1.
  4161
  4162
  4163* EXEC CICS LINK
  4164*        PROGRAM   (PGM-NAME)
  4165*        COMMAREA  (EMI-LINE1)
  4166*        LENGTH    (72)
  4167*    END-EXEC.
  4168     MOVE 72
  4169       TO DFHEIV11
  4170*    MOVE '."C                   (   #00003711' TO DFHEIV0
  4171     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4172     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4173     MOVE X'2020233030303033373131' TO DFHEIV0(25:11)
  4174     CALL 'kxdfhei1' USING DFHEIV0,
  4175           PGM-NAME,
  4176           EMI-LINE1,
  4177           DFHEIV11,
  4178           DFHEIV99,
  4179           DFHEIV99,
  4180           DFHEIV99,
  4181           DFHEIV99
  4182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4183
  4184
  4185     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSGBO.
  4186     MOVE -1                     TO  FUNCTL.
  4187
  4188     GO TO 8100-SEND-INITIAL-MAP.
  4189
  4190
  4191* GOBACK.
  4192     MOVE '9%                    "   ' TO DFHEIV0
  4193     MOVE 'EL1284' TO DFHEIV1
  4194     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4195     GOBACK.
  4196
  4197 9995-SECURITY-VIOLATION.
  4198*                                COPY ELCSCTP.
  4199******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  94
* EL1284.cbl
  4200*                                                                *
  4201*                            ELCSCTP                             *
  4202*                            VMOD=2.001                          *
  4203*                                                                *
  4204*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4205******************************************************************
  4206
  4207
  4208     MOVE EIBDATE          TO SM-JUL-DATE.
  4209     MOVE EIBTRMID         TO SM-TERMID.
  4210     MOVE THIS-PGM         TO SM-PGM.
  4211     MOVE EIBTIME          TO TIME-IN.
  4212     MOVE TIME-OUT         TO SM-TIME.
  4213     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4214
  4215
  4216* EXEC CICS LINK
  4217*         PROGRAM  ('EL003')
  4218*         COMMAREA (SECURITY-MESSAGE)
  4219*         LENGTH   (80)
  4220*    END-EXEC.
  4221     MOVE 'EL003' TO DFHEIV1
  4222     MOVE 80
  4223       TO DFHEIV11
  4224*    MOVE '."C                   (   #00003742' TO DFHEIV0
  4225     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4226     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4227     MOVE X'2020233030303033373432' TO DFHEIV0(25:11)
  4228     CALL 'kxdfhei1' USING DFHEIV0,
  4229           DFHEIV1,
  4230           SECURITY-MESSAGE,
  4231           DFHEIV11,
  4232           DFHEIV99,
  4233           DFHEIV99,
  4234           DFHEIV99,
  4235           DFHEIV99
  4236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4237
  4238
  4239******************************************************************
  4240
  4241
  4242 9995-EXIT.
  4243     EXIT.
  4244
  4245 9999-DFHBACK SECTION.
  4246     MOVE '9%                    "   ' TO DFHEIV0
  4247     MOVE 'EL1284' TO DFHEIV1
  4248     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4249     GOBACK.
  4250 9999-DFHEXIT.
  4251     IF DFHEIGDJ EQUAL 0001
  4252         NEXT SENTENCE
  4253     ELSE IF DFHEIGDJ EQUAL 2
  4254         GO TO 9400-CLEAR
  4255         DEPENDING ON DFHEIGDI
  4256     ELSE IF DFHEIGDJ EQUAL 3
  4257         GO TO 9990-ABEND,
* Micro Focus Server Express         V5.1 revision 000 05-Apr-16 10:49 Page  95
* EL1284.cbl
  4258               9600-PGMID-ERROR
  4259         DEPENDING ON DFHEIGDI
  4260     ELSE IF DFHEIGDJ EQUAL 4
  4261         GO TO 4610-ENDBR,
  4262               6000-NOT-OPEN,
  4263               4610-ENDBR
  4264         DEPENDING ON DFHEIGDI
  4265     ELSE IF DFHEIGDJ EQUAL 5
  4266         GO TO 4900-EXIT
  4267         DEPENDING ON DFHEIGDI
  4268     ELSE IF DFHEIGDJ EQUAL 6
  4269         GO TO 7010-ENDBR,
  4270               6000-NOT-OPEN,
  4271               7010-ENDBR
  4272         DEPENDING ON DFHEIGDI
  4273     ELSE IF DFHEIGDJ EQUAL 7
  4274         GO TO 7299-EXIT
  4275         DEPENDING ON DFHEIGDI
  4276     ELSE IF DFHEIGDJ EQUAL 8
  4277         GO TO 7590-TS-QIDERR,
  4278               7585-QID-ITEMERR
  4279         DEPENDING ON DFHEIGDI
  4280     ELSE IF DFHEIGDJ EQUAL 9
  4281         GO TO 8150-NOT-FOUND
  4282         DEPENDING ON DFHEIGDI
  4283     ELSE IF DFHEIGDJ EQUAL 10
  4284         GO TO 8300-SEND-TEXT
  4285         DEPENDING ON DFHEIGDI.
  4286     MOVE '9%                    "   ' TO DFHEIV0
  4287     MOVE 'EL1284' TO DFHEIV1
  4288     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4289     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       31632     Code:       12604
