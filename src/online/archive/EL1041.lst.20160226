* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   1
* EL1041.cbl
* Options: int("EL1041.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1041.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1041.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1041.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1041.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   2
* EL1041.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS
    19*    SCREENS     - EL104Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31*-----------------------------------------------------------------
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 041513    2013011500003  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    40* 092413    2013062000003  AJRA  ADD BARCODE IND (USE ZREC COPYBOO
    41*-----------------------------------------------------------------
    42 ENVIRONMENT DIVISION.
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*   EL1041 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    49 77  M1                          PIC S999 COMP-3 VALUE +0.
    50 77  M2                          PIC S999 COMP-3 VALUE +0.
    51 77  WS-STOP-SW                  PIC X  VALUE ' '.
    52     88  I-SAY-TO-STOP              VALUE 'Y'.
    53 77  WS-FIND-SW                  PIC X  VALUE ' '.
    54     88  WE-FOUND-IT                VALUE 'Y'.
    55 77  WS-DONE-WITH-ENCC           PIC X  VALUE ' '.
    56     88  DONE-WITH-ENCC             VALUE 'Y'.
    57 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    58 01  ACCESS-KEYS.
    59     12  ELLETR-KEY.
    60         16  ELLETR-COMPANY-CD   PIC X.
    61         16  ELLETR-ACCESS-CD    PIC X(12).
    62         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    63
    64     12  ELENCC-KEY.
    65         16  ELENCC-COMPANY-CD    PIC X.
    66         16  ELENCC-REC-TYPE      PIC X.
    67         16  ELENCC-ENC-CODE      PIC X(5).
    68         16  F                    PIC X(09).
    69 01  WS-DATE-AREA.
    70     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    71     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   3
* EL1041.cbl
    72 01  MISC-WORK-AREAS.
    73     12  WS-RESPONSE             PIC S9(8)   COMP.
    74         88  RESP-NORMAL              VALUE +00.
    75         88  RESP-ERROR               VALUE +01.
    76         88  RESP-NOTFND              VALUE +13.
    77         88  RESP-NOTOPEN             VALUE +19.
    78         88  RESP-ENDFILE             VALUE +20.
    79     12  WS-NUMVAL.
    80         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    81         16  WS-9V999-OF-DEEDIT REDEFINES
    82             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    83     12  DEEDIT-FIELD                PIC X(11).
    84     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    85                                     PIC S9(11).
    86     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    87                                     PIC S9(09)V99.
    88
    89     12  WS-TEST-STATE               PIC X(2) VALUE SPACES.
    90         88 STATE-SPECIFIC    VALUES 'AK','AL','AR','AS','AZ',
    91            'CA','CO','CT','DC','DE','FL','GA','GU','HI','IA',
    92            'ID','IL','IN','KS','KY','LA','MA','MD','ME','MI',
    93            'MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM',
    94            'NV','NY','OH','OK','OR','PA','PR','RI','SC','SD',
    95            'TN','TX','UT','VA','VI','VT','WA','WI','WV','WY'.
    96 01  STANDARD-AREAS.
    97     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    98     12  TRANS-ID                    PIC X(04)   VALUE 'EX1E'.
    99     12  PGM-NAME                    PIC X(08).
   100     12  TIME-IN                     PIC S9(07).
   101     12  TIME-OUT-R  REDEFINES TIME-IN.
   102         16  FILLER                  PIC X(01).
   103         16  TIME-OUT                PIC 99V99.
   104         16  FILLER                  PIC X(02).
   105     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
   106     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
   107     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
   108     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
   109     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
   110     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
   111     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
   112     12  THIS-PGM                    PIC X(08)   VALUE 'EL1041'.
   113     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   114     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   115     12  ELENCC-FILE-ID              PIC X(08)   VALUE 'ELENCC'.
   116     12  ELENCC-LENGTH               PIC S9(04)  VALUE +400  COMP.
   117     12  SUB                         PIC 9(02).
   118     12  SUB-1                       PIC 9(02).
   119     12  SUB2                        PIC 9(02).
   120     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   121     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1041S'.
   122     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL104Z'.
   123     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   124     12  HOLD-ENC-CODES              PIC X(120)  VALUE SPACES.
   125     12  WS-SUB1                     PIC S9(03).
   126     12  WS-SUB2                     PIC S9(03).
   127     12  WS-SUB3                     PIC S9(03).
   128****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   129*                                    COPY ELCZREC.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   4
* EL1041.cbl
   130******************************************************************
   131*                                                                *
   132*                                                                *
   133*                            ELCZREC.                            *
   134*                                                                *
   135*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   136*                                                                *
   137******************************************************************
   138*-----------------------------------------------------------------
   139*                   C H A N G E   L O G
   140*
   141* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   142*-----------------------------------------------------------------
   143*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   144* EFFECTIVE    NUMBER
   145*-----------------------------------------------------------------
   146* 122011    2011022800001  AJRA  NEW FILE
   147* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   148* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   149* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   150*-----------------------------------------------------------------
   151 01  W-Z-CONTROL-DATA.
   152     05  W-NUMBER-OF-COPIES      PIC  9.
   153     05  FILLER                  PIC  X.
   154     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   155     05  FILLER                  PIC  X.
   156     05  W-DAYS-TO-RESEND        PIC  999.
   157     05  FILLER                  PIC  X.
   158     05  W-FORM-TO-RESEND        PIC  X(4).
   159     05  W-ADD-BAR-CODE          PIC  X.
   160     05  W-PROMPT-LETTER         PIC  X.
   161     05  W-HAS-RETURN-ENV        PIC  X.
   162     05  W-ENCLOSURE-CD          PIC  XXX.
   163     05  FILLER                  PIC  X.
   164     05  W-AUTO-CLOSE-IND        PIC  X.
   165     05  FILLER                  PIC  X.
   166     05  W-LETTER-TO-BENE        PIC  X.
   167     05  FILLER                  PIC  X.
   168     05  W-LETTER-TO-ACCT        PIC  X.
   169     05  FILLER                  PIC  X.
   170     05  W-LETTER-TYPE           PIC  X.
   171     05  FILLER                  PIC  X.
   172     05  W-PRINT-CERTIFICATE     PIC  X.
   173     05  FILLER                  PIC  X.
   174     05  W-REFUND-REQUIRED       PIC  X.
   175     05  FILLER                  PIC  X.
   176     05  W-ONBASE-CODE           PIC  XX.
   177     05  FILLER                  PIC  X.
   178     05  W-ACCT-SUMM             PIC  X.
   179     05  FILLER                  PIC  X.
   180     05  W-CSO-SUMM              PIC  X.
   181     05  FILLER                  PIC  X.
   182     05  W-REASONS-REQUIRED      PIC  X.
   183     05  FILLER                  PIC  X(29).
   184*                                    COPY ELCSCTM.
   185******************************************************************
   186*                                                                *
   187*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   5
* EL1041.cbl
   188*                            ELCSCTM                             *
   189*                            VMOD=2.001                          *
   190*                                                                *
   191*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   192*                                                                *
   193******************************************************************
   194 01  SECURITY-MESSAGE.
   195     12  FILLER                          PIC X(30)
   196            VALUE '** LOGIC SECURITY VIOLATION -'.
   197     12  SM-READ                         PIC X(6).
   198     12  FILLER                          PIC X(5)
   199            VALUE ' PGM='.
   200     12  SM-PGM                          PIC X(6).
   201     12  FILLER                          PIC X(5)
   202            VALUE ' OPR='.
   203     12  SM-PROCESSOR-ID                 PIC X(4).
   204     12  FILLER                          PIC X(6)
   205            VALUE ' TERM='.
   206     12  SM-TERMID                       PIC X(4).
   207     12  FILLER                          PIC XX   VALUE SPACE.
   208     12  SM-JUL-DATE                     PIC 9(5).
   209     12  FILLER                          PIC X    VALUE SPACE.
   210     12  SM-TIME                         PIC 99.99.
   211
   212*                                    COPY ELCSCRTY.
   213******************************************************************
   214*                                                                *
   215*                                                                *
   216*                            ELCSCRTY                            *
   217*                            VMOD=2.001                          *
   218*                                                                *
   219*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   220*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   221*        SAVED IN PI-SECURITY-ADDRESS.                           *
   222*                                                                *
   223******************************************************************
   224 01  SECURITY-CONTROL.
   225     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   226     12  FILLER                       PIC XX    VALUE 'SC'.
   227     12  SC-CREDIT-CODES.
   228         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   229             20  SC-CREDIT-DISPLAY    PIC X.
   230             20  SC-CREDIT-UPDATE     PIC X.
   231     12  SC-CLAIMS-CODES.
   232         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   233             20  SC-CLAIMS-DISPLAY    PIC X.
   234             20  SC-CLAIMS-UPDATE     PIC X.
   235 01  ERROR-MESSAGES.
   236     12  ER-0000                     PIC X(04)   VALUE '0000'.
   237     12  ER-0005                     PIC X(04)   VALUE '0005'.
   238     12  ER-0023                     PIC X(04)   VALUE '0023'.
   239     12  ER-0029                     PIC X(04)   VALUE '0029'.
   240     12  ER-0050                     PIC X(04)   VALUE '0050'.
   241     12  ER-0068                     PIC X(04)   VALUE '0068'.
   242     12  ER-0070                     PIC X(04)   VALUE '0070'.
   243     12  ER-0130                     PIC X(04)   VALUE '0130'.
   244     12  ER-0131                     PIC X(04)   VALUE '0131'.
   245     12  ER-0132                     PIC X(04)   VALUE '0132'.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   6
* EL1041.cbl
   246     12  ER-0138                     PIC X(04)   VALUE '0138'.
   247     12  ER-0144                     PIC X(04)   VALUE '0144'.
   248     12  ER-0145                     PIC X(04)   VALUE '0145'.
   249     12  ER-0184                     PIC X(04)   VALUE '0184'.
   250     12  ER-0418                     PIC X(04)   VALUE '0418'.
   251     12  ER-0491                     PIC X(04)   VALUE '0491'.
   252     12  ER-0582                     PIC X(04)   VALUE '0582'.
   253     12  ER-0627                     PIC X(04)   VALUE '0627'.
   254     12  ER-0701                     PIC X(04)   VALUE '0701'.
   255     12  ER-0702                     PIC X(04)   VALUE '0702'.
   256     12  ER-0703                     PIC X(04)   VALUE '0703'.
   257     12  ER-0704                     PIC X(04)   VALUE '0704'.
   258     12  ER-0705                     PIC X(04)   VALUE '0705'.
   259     12  ER-0706                     PIC X(04)   VALUE '0706'.
   260     12  ER-0707                     PIC X(04)   VALUE '0707'.
   261     12  ER-0708                     PIC X(04)   VALUE '0708'.
   262     12  ER-0709                     PIC X(04)   VALUE '0709'.
   263     12  ER-0710                     PIC X(04)   VALUE '0710'.
   264     12  ER-0711                     PIC X(04)   VALUE '0711'.
   265     12  ER-0712                     PIC X(04)   VALUE '0712'.
   266     12  ER-0713                     PIC X(04)   VALUE '0713'.
   267     12  ER-0717                     PIC X(04)   VALUE '0717'.
   268     12  ER-0718                     PIC X(04)   VALUE '0718'.
   269     12  ER-0719                     PIC X(04)   VALUE '0719'.
   270     12  ER-0720                     PIC X(04)   VALUE '0720'.
   271     12  ER-0721                     PIC X(04)   VALUE '0721'.
   272     12  ER-0722                     PIC X(04)   VALUE '0722'.
   273     12  ER-0723                     PIC X(04)   VALUE '0723'.
   274     12  ER-0724                     PIC X(04)   VALUE '0724'.
   275     12  ER-0725                     PIC X(04)   VALUE '0725'.
   276     12  ER-0726                     PIC X(04)   VALUE '0726'.
   277     12  ER-0727                     PIC X(04)   VALUE '0727'.
   278     12  ER-0729                     PIC X(04)   VALUE '0729'.
   279     12  ER-0754                     PIC X(04)   VALUE '0754'.
   280     12  ER-1560                     PIC X(04)   VALUE '1560'.
   281     12  ER-1562                     PIC X(04)   VALUE '1562'.
   282     12  ER-2241                     PIC X(04)   VALUE '2241'.
   283     12  ER-2276                     PIC X(04)   VALUE '2276'.
   284     12  ER-7008                     PIC X(04)   VALUE '7008'.
   285     12  ER-7031                     PIC X(04)   VALUE '7031'.
   286     12  ER-7123                     PIC X(04)   VALUE '7123'.
   287     12  ER-8150                     PIC X(04)   VALUE '8150'.
   288     12  ER-9999                     PIC XXXX    VALUE '9999'.
   289*                                    COPY ELCDATE.
   290******************************************************************
   291*                                                                *
   292*                                                                *
   293*                            ELCDATE.                            *
   294*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   295*                            VMOD=2.003
   296*                                                                *
   297*                                                                *
   298*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   299*                 LENGTH = 200                                   *
   300******************************************************************
   301
   302 01  DATE-CONVERSION-DATA.
   303     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   7
* EL1041.cbl
   304     12  DC-OPTION-CODE                PIC X.
   305         88  BIN-TO-GREG                VALUE ' '.
   306         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   307         88  EDIT-GREG-TO-BIN           VALUE '2'.
   308         88  YMD-GREG-TO-BIN            VALUE '3'.
   309         88  MDY-GREG-TO-BIN            VALUE '4'.
   310         88  JULIAN-TO-BIN              VALUE '5'.
   311         88  BIN-PLUS-ELAPSED           VALUE '6'.
   312         88  FIND-CENTURY               VALUE '7'.
   313         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   314         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   315         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   316         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   317         88  JULIAN-TO-BIN-3            VALUE 'C'.
   318         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   319         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   320         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   321         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   322         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   323         88  CHECK-LEAP-YEAR            VALUE 'H'.
   324         88  BIN-3-TO-GREG              VALUE 'I'.
   325         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   326         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   327         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   328         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   329         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   330         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   331         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   332         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   333         88  THREE-CHARACTER-BIN
   334                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   335         88  GREGORIAN-TO-BIN
   336                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   337         88  BIN-TO-GREGORIAN
   338                  VALUES ' ' '1' 'I' '8' 'G'.
   339         88  JULIAN-TO-BINARY
   340                  VALUES '5' 'C' 'E' 'F'.
   341     12  DC-ERROR-CODE                 PIC X.
   342         88  NO-CONVERSION-ERROR        VALUE ' '.
   343         88  DATE-CONVERSION-ERROR
   344                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   345         88  DATE-IS-ZERO               VALUE '1'.
   346         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   347         88  DATE-IS-INVALID            VALUE '3'.
   348         88  DATE1-GREATER-DATE2        VALUE '4'.
   349         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   350         88  DATE-INVALID-OPTION        VALUE '9'.
   351         88  INVALID-CENTURY            VALUE 'A'.
   352         88  ONLY-CENTURY               VALUE 'B'.
   353         88  ONLY-LEAP-YEAR             VALUE 'C'.
   354         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   355     12  DC-END-OF-MONTH               PIC X.
   356         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   357     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   358         88  USE-NORMAL-PROCESS         VALUE ' '.
   359         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   360         88  ADJUST-UP-100-YRS          VALUE '2'.
   361     12  FILLER                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   8
* EL1041.cbl
   362     12  DC-CONVERSION-DATES.
   363         16  DC-BIN-DATE-1             PIC XX.
   364         16  DC-BIN-DATE-2             PIC XX.
   365         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   366         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   367                       DC-GREG-DATE-1-EDIT.
   368             20  DC-EDIT1-MONTH        PIC 99.
   369             20  SLASH1-1              PIC X.
   370             20  DC-EDIT1-DAY          PIC 99.
   371             20  SLASH1-2              PIC X.
   372             20  DC-EDIT1-YEAR         PIC 99.
   373         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   374         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   375                     DC-GREG-DATE-2-EDIT.
   376             20  DC-EDIT2-MONTH        PIC 99.
   377             20  SLASH2-1              PIC X.
   378             20  DC-EDIT2-DAY          PIC 99.
   379             20  SLASH2-2              PIC X.
   380             20  DC-EDIT2-YEAR         PIC 99.
   381         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   382         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   383                     DC-GREG-DATE-1-YMD.
   384             20  DC-YMD-YEAR           PIC 99.
   385             20  DC-YMD-MONTH          PIC 99.
   386             20  DC-YMD-DAY            PIC 99.
   387         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   388         16  DC-GREG-DATE-1-MDY-R REDEFINES
   389                      DC-GREG-DATE-1-MDY.
   390             20  DC-MDY-MONTH          PIC 99.
   391             20  DC-MDY-DAY            PIC 99.
   392             20  DC-MDY-YEAR           PIC 99.
   393         16  DC-GREG-DATE-1-ALPHA.
   394             20  DC-ALPHA-MONTH        PIC X(10).
   395             20  DC-ALPHA-DAY          PIC 99.
   396             20  FILLER                PIC XX.
   397             20  DC-ALPHA-CENTURY.
   398                 24 DC-ALPHA-CEN-N     PIC 99.
   399             20  DC-ALPHA-YEAR         PIC 99.
   400         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   401         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   402         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   403         16  DC-JULIAN-DATE            PIC 9(05).
   404         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   405                                       PIC 9(05).
   406         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   407             20  DC-JULIAN-YEAR        PIC 99.
   408             20  DC-JULIAN-DAYS        PIC 999.
   409         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   410         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   411         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   412     12  DATE-CONVERSION-VARIBLES.
   413         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   414         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   415             20  FILLER                PIC 9(3).
   416             20  HOLD-CEN-1-CCYY.
   417                 24  HOLD-CEN-1-CC     PIC 99.
   418                 24  HOLD-CEN-1-YY     PIC 99.
   419             20  HOLD-CEN-1-MO         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page   9
* EL1041.cbl
   420             20  HOLD-CEN-1-DA         PIC 99.
   421         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   422             20  HOLD-CEN-1-R-MO       PIC 99.
   423             20  HOLD-CEN-1-R-DA       PIC 99.
   424             20  HOLD-CEN-1-R-CCYY.
   425                 24  HOLD-CEN-1-R-CC   PIC 99.
   426                 24  HOLD-CEN-1-R-YY   PIC 99.
   427             20  FILLER                PIC 9(3).
   428         16  HOLD-CENTURY-1-X.
   429             20  FILLER                PIC X(3)  VALUE SPACES.
   430             20  HOLD-CEN-1-X-CCYY.
   431                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   432                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   433             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   434             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   435         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   436             20  HOLD-CEN-1-R-X-MO     PIC XX.
   437             20  HOLD-CEN-1-R-X-DA     PIC XX.
   438             20  HOLD-CEN-1-R-X-CCYY.
   439                 24  HOLD-CEN-1-R-X-CC PIC XX.
   440                 24  HOLD-CEN-1-R-X-YY PIC XX.
   441             20  FILLER                PIC XXX.
   442         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   443         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   444         16  DC-JULIAN-DATE-1          PIC 9(07).
   445         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   446             20  DC-JULIAN-1-CCYY.
   447                 24  DC-JULIAN-1-CC    PIC 99.
   448                 24  DC-JULIAN-1-YR    PIC 99.
   449             20  DC-JULIAN-DA-1        PIC 999.
   450         16  DC-JULIAN-DATE-2          PIC 9(07).
   451         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   452             20  DC-JULIAN-2-CCYY.
   453                 24  DC-JULIAN-2-CC    PIC 99.
   454                 24  DC-JULIAN-2-YR    PIC 99.
   455             20  DC-JULIAN-DA-2        PIC 999.
   456         16  DC-GREG-DATE-A-EDIT.
   457             20  DC-EDITA-MONTH        PIC 99.
   458             20  SLASHA-1              PIC X VALUE '/'.
   459             20  DC-EDITA-DAY          PIC 99.
   460             20  SLASHA-2              PIC X VALUE '/'.
   461             20  DC-EDITA-CCYY.
   462                 24  DC-EDITA-CENT     PIC 99.
   463                 24  DC-EDITA-YEAR     PIC 99.
   464         16  DC-GREG-DATE-B-EDIT.
   465             20  DC-EDITB-MONTH        PIC 99.
   466             20  SLASHB-1              PIC X VALUE '/'.
   467             20  DC-EDITB-DAY          PIC 99.
   468             20  SLASHB-2              PIC X VALUE '/'.
   469             20  DC-EDITB-CCYY.
   470                 24  DC-EDITB-CENT     PIC 99.
   471                 24  DC-EDITB-YEAR     PIC 99.
   472         16  DC-GREG-DATE-CYMD         PIC 9(08).
   473         16  DC-GREG-DATE-CYMD-R REDEFINES
   474                              DC-GREG-DATE-CYMD.
   475             20  DC-CYMD-CEN           PIC 99.
   476             20  DC-CYMD-YEAR          PIC 99.
   477             20  DC-CYMD-MONTH         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  10
* EL1041.cbl
   478             20  DC-CYMD-DAY           PIC 99.
   479         16  DC-GREG-DATE-MDCY         PIC 9(08).
   480         16  DC-GREG-DATE-MDCY-R REDEFINES
   481                              DC-GREG-DATE-MDCY.
   482             20  DC-MDCY-MONTH         PIC 99.
   483             20  DC-MDCY-DAY           PIC 99.
   484             20  DC-MDCY-CEN           PIC 99.
   485             20  DC-MDCY-YEAR          PIC 99.
   486    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   487        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   488    12  DC-EL310-DATE                  PIC X(21).
   489    12  FILLER                         PIC X(28).
   490*                                    COPY ELCLOGOF.
   491******************************************************************
   492*                                                                *
   493*                                                                *
   494*                            ELCLOGOF.                           *
   495*                            VMOD=2.001                          *
   496*                                                                *
   497*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   498*                                                                *
   499******************************************************************
   500 01  CLASIC-LOGOFF.
   501     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   502     12  LOGOFF-TEXT.
   503         16  FILLER          PIC X(5)    VALUE SPACES.
   504         16  LOGOFF-MSG.
   505             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   506             20  FILLER      PIC X       VALUE SPACES.
   507             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   508         16  FILLER          PIC X(80)
   509           VALUE '* YOU ARE NOW LOGGED OFF'.
   510         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   511         16  FILLER          PIC X       VALUE QUOTE.
   512         16  LOGOFF-SYS-MSG  PIC X(17)
   513           VALUE 'S CLAS-IC SYSTEM '.
   514     12  TEXT-MESSAGES.
   515         16  UNACCESS-MSG    PIC X(29)
   516             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   517         16  PGMIDERR-MSG    PIC X(17)
   518             VALUE 'PROGRAM NOT FOUND'.
   519*                                    COPY ELCATTR.
   520******************************************************************
   521*                                                                *
   522*                            ELCATTR.                            *
   523*                            VMOD=2.001                          *
   524*                                                                *
   525*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   526*                                                                *
   527*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   528*                                                                *
   529*                   POS 1   P=PROTECTED                          *
   530*                           U=UNPROTECTED                        *
   531*                           S=ASKIP                              *
   532*                   POS 2   A=ALPHA/NUMERIC                      *
   533*                           N=NUMERIC                            *
   534*                   POS 3   N=NORMAL                             *
   535*                           B=BRIGHT                             *
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  11
* EL1041.cbl
   536*                           D=DARK                               *
   537*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   538*                           OF=MODIFIED DATA TAG OFF             *
   539*                                                                *
   540*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   541******************************************************************
   542 01  ATTRIBUTE-LIST.
   543     12  AL-PABOF            PIC X       VALUE 'Y'.
   544     12  AL-PABON            PIC X       VALUE 'Z'.
   545     12  AL-PADOF            PIC X       VALUE '%'.
   546     12  AL-PADON            PIC X       VALUE '_'.
   547     12  AL-PANOF            PIC X       VALUE '-'.
   548     12  AL-PANON            PIC X       VALUE '/'.
   549     12  AL-SABOF            PIC X       VALUE '8'.
   550     12  AL-SABON            PIC X       VALUE '9'.
   551     12  AL-SADOF            PIC X       VALUE '@'.
   552     12  AL-SADON            PIC X       VALUE QUOTE.
   553     12  AL-SANOF            PIC X       VALUE '0'.
   554     12  AL-SANON            PIC X       VALUE '1'.
   555     12  AL-UABOF            PIC X       VALUE 'H'.
   556     12  AL-UABON            PIC X       VALUE 'I'.
   557     12  AL-UADOF            PIC X       VALUE '<'.
   558     12  AL-UADON            PIC X       VALUE '('.
   559     12  AL-UANOF            PIC X       VALUE ' '.
   560     12  AL-UANON            PIC X       VALUE 'A'.
   561     12  AL-UNBOF            PIC X       VALUE 'Q'.
   562     12  AL-UNBON            PIC X       VALUE 'R'.
   563     12  AL-UNDOF            PIC X       VALUE '*'.
   564     12  AL-UNDON            PIC X       VALUE ')'.
   565     12  AL-UNNOF            PIC X       VALUE '&'.
   566     12  AL-UNNON            PIC X       VALUE 'J'.
   567*                                    COPY ELCEMIB.
   568******************************************************************
   569*                                                                *
   570*                                                                *
   571*                            ELCEMIB.                            *
   572*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   573*                            VMOD=2.005                          *
   574*                                                                *
   575*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   576*                                                                *
   577******************************************************************
   578 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   579     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   580     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   581     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   582     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   583     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   584     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   585     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   586     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   587     12  EMI-SWITCH1             PIC X        VALUE '1'.
   588         88  EMI-NO-ERRORS                    VALUE '1'.
   589         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   590         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   591     12  EMI-SWITCH2             PIC X        VALUE '1'.
   592         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   593     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  12
* EL1041.cbl
   594         88  EMI-AREA1-EMPTY                  VALUE '1'.
   595         88  EMI-AREA1-FULL                   VALUE '2'.
   596     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   597         88  EMI-AREA2-EMPTY                  VALUE '1'.
   598         88  EMI-AREA2-FULL                   VALUE '2'.
   599     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   600         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   601         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   602         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   603         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   604         88  EMI-BYPASS-FATALS                VALUE 'X'.
   605     12  EMI-ERROR-LINES.
   606         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   607         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   608         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   609         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   610             20  EMI-ERR-CODES OCCURS 10 TIMES.
   611                 24  EMI-ERR-NUM         PIC X(4).
   612                 24  EMI-FILLER          PIC X.
   613                 24  EMI-SEV             PIC X.
   614                 24  FILLER              PIC X.
   615             20  FILLER                  PIC X(02).
   616     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   617         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   618             20  EMI-ERROR-NUMBER    PIC X(4).
   619             20  EMI-FILL            PIC X.
   620             20  EMI-SEVERITY        PIC X.
   621             20  FILLER              PIC X.
   622             20  EMI-ERROR-TEXT.
   623                 24  EMI-TEXT-VARIABLE   PIC X(10).
   624                 24  FILLER          PIC X(55).
   625     12  EMI-SEVERITY-SAVE           PIC X.
   626         88  EMI-NOTE                    VALUE 'N'.
   627         88  EMI-WARNING                 VALUE 'W'.
   628         88  EMI-FORCABLE                VALUE 'F'.
   629         88  EMI-FATAL                   VALUE 'X'.
   630     12  EMI-MESSAGE-FLAG            PIC X.
   631         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   632         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   633     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   634     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   635         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   636         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   637         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   638     12  emi-claim-no                pic x(7).
   639     12  emi-claim-type              pic x(6).
   640     12  FILLER                      PIC X(124)  VALUE SPACES.
   641     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   642     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   643     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   644     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   645*                                    COPY ELCJPFX.
   646******************************************************************
   647*                                                                *
   648*                                                                *
   649*                            ELCJPFX.                            *
   650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   651*                            VMOD=2.002                          *
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  13
* EL1041.cbl
   652*                                                                *
   653*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   654*                                                                *
   655*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   656*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   657*        ELCNTL - CONTROL FILE                                   *
   658*        ELMSTR - CLAIM MASTERS                                  *
   659*        ELTRLR - ACTIVITY TRAILERS                              *
   660*        ELCHKQ - CHECK QUE                                      *
   661******************************************************************
   662 01  JOURNAL-RECORD.
   663     12  jp-date                     pic s9(5) comp-3.
   664     12  jp-time                     pic s9(7) comp-3.
   665     12  JP-USER-ID                  PIC X(4).
   666     12  JP-FILE-ID                  PIC X(8).
   667     12  JP-PROGRAM-ID               PIC X(8).
   668     12  JP-RECORD-TYPE              PIC X.
   669         88 JP-ADD              VALUE 'A'.
   670         88 JP-BEFORE-CHANGE    VALUE 'B'.
   671         88 JP-AFTER-CHANGE     VALUE 'C'.
   672         88 JP-DELETE           VALUE 'D'.
   673         88 JP-GENERIC-DELETE   VALUE 'G'.
   674         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   675         88 JP-KEY-CHG-ADD      VALUE 'N'.
   676     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   677     12  JP-RECORD-AREA
   678
   679
   680                                     PIC X(530).
   681*                                    COPY ELCINTF.
   682******************************************************************
   683*                                                                *
   684*                                                                *
   685*                            ELCINTF.                            *
   686*                            VMOD=2.017                          *
   687*                                                                *
   688*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   689*                                                                *
   690*       LENGTH = 1024                                            *
   691*                                                                *
   692******************************************************************
   693*                   C H A N G E   L O G
   694*
   695* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   696*-----------------------------------------------------------------
   697*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   698* EFFECTIVE    NUMBER
   699*-----------------------------------------------------------------
   700* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   701******************************************************************
   702 01  PROGRAM-INTERFACE-BLOCK.
   703     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   704     12  PI-CALLING-PROGRAM              PIC X(8).
   705     12  PI-SAVED-PROGRAM-1              PIC X(8).
   706     12  PI-SAVED-PROGRAM-2              PIC X(8).
   707     12  PI-SAVED-PROGRAM-3              PIC X(8).
   708     12  PI-SAVED-PROGRAM-4              PIC X(8).
   709     12  PI-SAVED-PROGRAM-5              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  14
* EL1041.cbl
   710     12  PI-SAVED-PROGRAM-6              PIC X(8).
   711     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   712     12  PI-COMPANY-ID                   PIC XXX.
   713     12  PI-COMPANY-CD                   PIC X.
   714
   715     12  PI-COMPANY-PASSWORD             PIC X(8).
   716
   717     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   718
   719     12  PI-CONTROL-IN-PROGRESS.
   720         16  PI-CARRIER                  PIC X.
   721         16  PI-GROUPING                 PIC X(6).
   722         16  PI-STATE                    PIC XX.
   723         16  PI-ACCOUNT                  PIC X(10).
   724         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   725                                         PIC X(10).
   726         16  PI-CLAIM-CERT-GRP.
   727             20  PI-CLAIM-NO             PIC X(7).
   728             20  PI-CERT-NO.
   729                 25  PI-CERT-PRIME       PIC X(10).
   730                 25  PI-CERT-SFX         PIC X.
   731             20  PI-CERT-EFF-DT          PIC XX.
   732         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   733             20  PI-PLAN-CODE            PIC X(2).
   734             20  PI-REVISION-NUMBER      PIC X(3).
   735             20  PI-PLAN-EFF-DT          PIC X(2).
   736             20  PI-PLAN-EXP-DT          PIC X(2).
   737             20  FILLER                  PIC X(11).
   738         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   739             20  PI-OE-REFERENCE-1.
   740                 25  PI-OE-REF-1-PRIME   PIC X(18).
   741                 25  PI-OE-REF-1-SUFF    PIC XX.
   742
   743     12  PI-SESSION-IN-PROGRESS          PIC X.
   744         88  CLAIM-SESSION                   VALUE '1'.
   745         88  CREDIT-SESSION                  VALUE '2'.
   746         88  WARRANTY-SESSION                VALUE '3'.
   747         88  MORTGAGE-SESSION                VALUE '4'.
   748         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   749
   750
   751*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   752
   753     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   754     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   755
   756     12  PI-CREDIT-USER                  PIC X.
   757         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   758         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   759
   760     12  PI-CLAIM-USER                   PIC X.
   761         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   762         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   763
   764     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   765         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   766         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   767         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  15
* EL1041.cbl
   768         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   769         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   770
   771     12  PI-PROCESSOR-ID                 PIC X(4).
   772
   773     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   774
   775     12  PI-MEMBER-CAPTION               PIC X(10).
   776
   777     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   778         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   779
   780     12  PI-LIFE-OVERRIDE-L1             PIC X.
   781     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   782     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   783     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   784
   785     12  PI-AH-OVERRIDE-L1               PIC X.
   786     12  PI-AH-OVERRIDE-L2               PIC XX.
   787     12  PI-AH-OVERRIDE-L6               PIC X(6).
   788     12  PI-AH-OVERRIDE-L12              PIC X(12).
   789
   790     12  PI-NEW-SYSTEM                   PIC X(2).
   791
   792     12  PI-PRIMARY-CERT-NO              PIC X(11).
   793     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   794         88  PI-USES-PAID-TO                 VALUE '1'.
   795     12  PI-CRDTCRD-SYSTEM.
   796         16  PI-CRDTCRD-USER             PIC X.
   797             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   798             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   799         16  PI-CC-MONTH-END-DT          PIC XX.
   800     12  PI-PROCESSOR-PRINTER            PIC X(4).
   801
   802     12  PI-OE-REFERENCE-2.
   803         16  PI-OE-REF-2-PRIME           PIC X(10).
   804         16  PI-OE-REF-2-SUFF            PIC X.
   805
   806     12  PI-REM-TRM-CALC-OPTION          PIC X.
   807
   808     12  PI-LANGUAGE-TYPE                PIC X.
   809             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   810             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   811             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   812
   813     12  PI-POLICY-LINKAGE-IND           PIC X.
   814         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   815         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   816                                                   LOW-VALUES.
   817
   818     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   819     12  PI-CLAIM-PW-SESSION             PIC X(1).
   820         88  PI-CLAIM-CREDIT                 VALUE '1'.
   821         88  PI-CLAIM-CONVEN                 VALUE '2'.
   822
   823     12  PI-PROCESSOR-CSR-IND            PIC X.
   824         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   825         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  16
* EL1041.cbl
   826
   827     12  FILLER                          PIC X(3).
   828
   829     12  PI-SYSTEM-LEVEL                 PIC X(145).
   830
   831     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   832         PI-SYSTEM-LEVEL.
   833
   834         16  PI-ENTRY-CODES.
   835             20  PI-ENTRY-CD-1           PIC X.
   836             20  PI-ENTRY-CD-2           PIC X.
   837
   838         16  PI-RETURN-CODES.
   839             20  PI-RETURN-CD-1          PIC X.
   840             20  PI-RETURN-CD-2          PIC X.
   841
   842         16  PI-UPDATE-STATUS-SAVE.
   843             20  PI-UPDATE-BY            PIC X(4).
   844             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   845
   846         16  PI-LOWER-CASE-LETTERS       PIC X.
   847             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   848
   849*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   850*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   851*            88  CARRIER-CLM-CNTL            VALUE '2'.
   852
   853         16  PI-CERT-ACCESS-CONTROL      PIC X.
   854             88  ST-ACCNT-CNTL               VALUE ' '.
   855             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   856             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   857             88  ACCNT-CNTL                  VALUE '3'.
   858             88  CARR-ACCNT-CNTL             VALUE '4'.
   859
   860         16  PI-PROCESSOR-CAP-LIST.
   861             20  PI-SYSTEM-CONTROLS.
   862                24 PI-SYSTEM-DISPLAY     PIC X.
   863                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   864                24 PI-SYSTEM-MODIFY      PIC X.
   865                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   866             20  FILLER                  PIC XX.
   867             20  PI-DISPLAY-CAP          PIC X.
   868                 88  DISPLAY-CAP             VALUE 'Y'.
   869             20  PI-MODIFY-CAP           PIC X.
   870                 88  MODIFY-CAP              VALUE 'Y'.
   871             20  PI-MSG-AT-LOGON-CAP     PIC X.
   872                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   873             20  PI-FORCE-CAP            PIC X.
   874                 88  FORCE-CAP               VALUE 'Y'.
   875
   876         16  PI-PROGRAM-CONTROLS.
   877             20  PI-PGM-PRINT-OPT        PIC X.
   878             20  PI-PGM-FORMAT-OPT       PIC X.
   879             20  PI-PGM-PROCESS-OPT      PIC X.
   880             20  PI-PGM-TOTALS-OPT       PIC X.
   881
   882         16  PI-HELP-INTERFACE.
   883             20  PI-LAST-ERROR-NO        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  17
* EL1041.cbl
   884             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   885
   886         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   887             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   888
   889         16  PI-CR-CONTROL-IN-PROGRESS.
   890             20  PI-CR-CARRIER           PIC X.
   891             20  PI-CR-GROUPING          PIC X(6).
   892             20  PI-CR-STATE             PIC XX.
   893             20  PI-CR-ACCOUNT           PIC X(10).
   894             20  PI-CR-FIN-RESP          PIC X(10).
   895             20  PI-CR-TYPE              PIC X.
   896
   897         16  PI-CR-BATCH-NUMBER          PIC X(6).
   898
   899         16  PI-CR-MONTH-END-DT          PIC XX.
   900
   901         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   902             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   903             88  PI-ZERO-CARRIER             VALUE '1'.
   904             88  PI-ZERO-GROUPING            VALUE '2'.
   905             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   906
   907         16  PI-CARRIER-SECURITY         PIC X.
   908             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   909
   910         16  PI-ACCOUNT-SECURITY         PIC X(10).
   911             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   912             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   913
   914         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   915             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   916                                         INDEXED BY PI-ACCESS-NDX
   917                                         PIC X.
   918
   919         16  PI-GA-BILLING-CONTROL       PIC X.
   920             88  PI-GA-BILLING               VALUE '1'.
   921
   922         16  PI-MAIL-PROCESSING          PIC X.
   923             88  PI-MAIL-YES                 VALUE 'Y'.
   924
   925         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   926
   927         16  PI-AR-SYSTEM.
   928             20  PI-AR-PROCESSING-CNTL   PIC X.
   929                 88  PI-AR-PROCESSING        VALUE 'Y'.
   930             20  PI-AR-SUMMARY-CODE      PIC X(6).
   931             20  PI-AR-MONTH-END-DT      PIC XX.
   932
   933         16  PI-MP-SYSTEM.
   934             20  PI-MORTGAGE-USER            PIC X.
   935                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   936                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   937             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   938                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   939                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   940                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   941                 88  PI-MP-PROD-CNTL                 VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  18
* EL1041.cbl
   942                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   943             20  PI-MP-MONTH-END-DT          PIC XX.
   944             20  PI-MP-REFERENCE-NO.
   945                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   946                 24  PI-MP-REFERENCE-SFX     PIC XX.
   947
   948         16  PI-LABEL-CONTROL            PIC X(01).
   949             88  PI-CREATE-LABELS                    VALUE 'Y'.
   950             88  PI-BYPASS-LABELS                    VALUE 'N'.
   951
   952         16  PI-BILL-GROUPING-CODE       PIC X(01).
   953             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   954
   955         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   956             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   957             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   958
   959         16  FILLER                      PIC X(14).
   960
   961     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   962******************************************************************
   963     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   964*                                    COPY ELC1042.
   965******************************************************************
   966*                                                                *
   967*                                                                *
   968*                           ELC1042                              *
   969*                            VMOD=2.002                          *
   970*                                                                *
   971*    NOTE                                                        *
   972*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   973*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   974*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   975*        TO THESE PROGRAMS.                                      *
   976*                                                                *
   977*    NOTE                                                        *
   978*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   979*        USE ONLY!                                               *
   980*                                                                *
   981******************************************************************
   982
   983         16  PI-1042-WA.
   984             20  PI-ACTION       PIC  X(01).
   985                 88 PI-SHOW-MODE           VALUE '1'.
   986                 88 PI-CLEAR-MODE          VALUE '2'.
   987                 88 PI-CREATE-MODE         VALUE '3'.
   988             20  PI-COMM-CONTROL PIC  X(12).
   989             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   990             20  PI-EOF-SW       PIC  X(01).
   991                 88  PI-FILE-EOF           VALUE 'Y'.
   992             20  PI-FILETYP      PIC  X(01).
   993             20  PI-FORM-SQUEEZE-CONTROL
   994                                 PIC  X(01).
   995                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   996                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   997             20  PI-LAST-CONTROL PIC  X(12).
   998             20  PI-TEMP-STOR-ITEMS
   999                                 PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  19
* EL1041.cbl
  1000             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1001             20  PI-UPDATE-SW    PIC  9(01).
  1002                 88 ANY-UPDATES            VALUE 1.
  1003             20  PI-104-SCREEN-SENT-IND
  1004                                 PIC  X(01).
  1005                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1006                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1007             20  PI-1042-SCREEN-SENT-IND
  1008                                 PIC  X(01).
  1009                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1010                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1011             20  PI-1042-ARCHIVE-IND
  1012                                 PIC  X(01).
  1013                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1014             20  FILLER          PIC  X(29).
  1015         16  PI-PREV-LETR-KEY        PIC X(15).
  1016         16  PI-CURR-LETR-KEY        PIC X(15).
  1017         16  PI-UPDATE-DT            PIC XX.
  1018         16  PI-ENC-CODES            PIC X(120).
  1019         16  PI-SPLIT-SUB            PIC S9(3)  COMP.
  1020         16  FILLER                  PIC X(434).
  1021*                                    COPY ELCAID.
  1022******************************************************************
  1023*                                                                *
  1024*                            ELCAID.                             *
  1025*                            VMOD=2.001                          *
  1026*                                                                *
  1027*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1028*                                                                *
  1029*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1030*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1031******************************************************************
  1032
  1033 01  DFHAID.
  1034   02  DFHNULL   PIC  X  VALUE  ' '.
  1035   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1036   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1037   02  DFHPEN    PIC  X  VALUE  '='.
  1038   02  DFHOPID   PIC  X  VALUE  'W'.
  1039   02  DFHPA1    PIC  X  VALUE  '%'.
  1040   02  DFHPA2    PIC  X  VALUE  '>'.
  1041   02  DFHPA3    PIC  X  VALUE  ','.
  1042   02  DFHPF1    PIC  X  VALUE  '1'.
  1043   02  DFHPF2    PIC  X  VALUE  '2'.
  1044   02  DFHPF3    PIC  X  VALUE  '3'.
  1045   02  DFHPF4    PIC  X  VALUE  '4'.
  1046   02  DFHPF5    PIC  X  VALUE  '5'.
  1047   02  DFHPF6    PIC  X  VALUE  '6'.
  1048   02  DFHPF7    PIC  X  VALUE  '7'.
  1049   02  DFHPF8    PIC  X  VALUE  '8'.
  1050   02  DFHPF9    PIC  X  VALUE  '9'.
  1051   02  DFHPF10   PIC  X  VALUE  ':'.
  1052   02  DFHPF11   PIC  X  VALUE  '#'.
  1053   02  DFHPF12   PIC  X  VALUE  '@'.
  1054   02  DFHPF13   PIC  X  VALUE  'A'.
  1055   02  DFHPF14   PIC  X  VALUE  'B'.
  1056   02  DFHPF15   PIC  X  VALUE  'C'.
  1057   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  20
* EL1041.cbl
  1058   02  DFHPF17   PIC  X  VALUE  'E'.
  1059   02  DFHPF18   PIC  X  VALUE  'F'.
  1060   02  DFHPF19   PIC  X  VALUE  'G'.
  1061   02  DFHPF20   PIC  X  VALUE  'H'.
  1062   02  DFHPF21   PIC  X  VALUE  'I'.
  1063*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1064   02  DFHPF22   PIC  X  VALUE  '['.
  1065   02  DFHPF23   PIC  X  VALUE  '.'.
  1066   02  DFHPF24   PIC  X  VALUE  '<'.
  1067   02  DFHMSRE   PIC  X  VALUE  'X'.
  1068   02  DFHSTRF   PIC  X  VALUE  'h'.
  1069   02  DFHTRIG   PIC  X  VALUE  '"'.
  1070 01  FILLER    REDEFINES DFHAID.
  1071     12  FILLER                      PIC X(08).
  1072     12  PF-VALUES                   PIC X         OCCURS 24.
  1073*                                    COPY EL1041S.
  1074 01  EL104ZI.
  1075     05  FILLER            PIC  X(0012).
  1076*    -------------------------------
  1077     05  DATEL PIC S9(0004) COMP.
  1078     05  DATEF PIC  X(0001).
  1079     05  FILLER REDEFINES DATEF.
  1080         10  DATEA PIC  X(0001).
  1081     05  FILLER            PIC  X(3).
  1082     05  DATEI PIC  X(0008).
  1083*    -------------------------------
  1084     05  TIMEL PIC S9(0004) COMP.
  1085     05  TIMEF PIC  X(0001).
  1086     05  FILLER REDEFINES TIMEF.
  1087         10  TIMEA PIC  X(0001).
  1088     05  FILLER            PIC  X(3).
  1089     05  TIMEI PIC  X(0005).
  1090*    -------------------------------
  1091     05  CMPNYIDL PIC S9(0004) COMP.
  1092     05  CMPNYIDF PIC  X(0001).
  1093     05  FILLER REDEFINES CMPNYIDF.
  1094         10  CMPNYIDA PIC  X(0001).
  1095     05  FILLER            PIC  X(3).
  1096     05  CMPNYIDI PIC  X(0003).
  1097*    -------------------------------
  1098     05  USERIDL PIC S9(0004) COMP.
  1099     05  USERIDF PIC  X(0001).
  1100     05  FILLER REDEFINES USERIDF.
  1101         10  USERIDA PIC  X(0001).
  1102     05  FILLER            PIC  X(3).
  1103     05  USERIDI PIC  X(0004).
  1104*    -------------------------------
  1105     05  MAINTL PIC S9(0004) COMP.
  1106     05  MAINTF PIC  X(0001).
  1107     05  FILLER REDEFINES MAINTF.
  1108         10  MAINTA PIC  X(0001).
  1109     05  FILLER            PIC  X(3).
  1110     05  MAINTI PIC  X(0001).
  1111*    -------------------------------
  1112     05  LSTUSRL PIC S9(0004) COMP.
  1113     05  LSTUSRF PIC  X(0001).
  1114     05  FILLER REDEFINES LSTUSRF.
  1115         10  LSTUSRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  21
* EL1041.cbl
  1116     05  FILLER            PIC  X(3).
  1117     05  LSTUSRI PIC  X(0004).
  1118*    -------------------------------
  1119     05  LSTDTEL PIC S9(0004) COMP.
  1120     05  LSTDTEF PIC  X(0001).
  1121     05  FILLER REDEFINES LSTDTEF.
  1122         10  LSTDTEA PIC  X(0001).
  1123     05  FILLER            PIC  X(3).
  1124     05  LSTDTEI PIC  X(0008).
  1125*    -------------------------------
  1126     05  LSTTIMEL PIC S9(0004) COMP.
  1127     05  LSTTIMEF PIC  X(0001).
  1128     05  FILLER REDEFINES LSTTIMEF.
  1129         10  LSTTIMEA PIC  X(0001).
  1130     05  FILLER            PIC  X(3).
  1131     05  LSTTIMEI PIC  X(0005).
  1132*    -------------------------------
  1133     05  ZLETRL PIC S9(0004) COMP.
  1134     05  ZLETRF PIC  X(0001).
  1135     05  FILLER REDEFINES ZLETRF.
  1136         10  ZLETRA PIC  X(0001).
  1137     05  FILLER            PIC  X(3).
  1138     05  ZLETRI PIC  X(0004).
  1139*    -------------------------------
  1140     05  ZCOPIESL PIC S9(0004) COMP.
  1141     05  ZCOPIESF PIC  X(0001).
  1142     05  FILLER REDEFINES ZCOPIESF.
  1143         10  ZCOPIESA PIC  X(0001).
  1144     05  FILLER            PIC  X(3).
  1145     05  ZCOPIESI PIC  X(0001).
  1146*    -------------------------------
  1147     05  ZPROMPTL PIC S9(0004) COMP.
  1148     05  ZPROMPTF PIC  X(0001).
  1149     05  FILLER REDEFINES ZPROMPTF.
  1150         10  ZPROMPTA PIC  X(0001).
  1151     05  FILLER            PIC  X(3).
  1152     05  ZPROMPTI PIC  X(0001).
  1153*    -------------------------------
  1154     05  ZENCCDL PIC S9(0004) COMP.
  1155     05  ZENCCDF PIC  X(0001).
  1156     05  FILLER REDEFINES ZENCCDF.
  1157         10  ZENCCDA PIC  X(0001).
  1158     05  FILLER            PIC  X(3).
  1159     05  ZENCCDI PIC  X(0003).
  1160*    -------------------------------
  1161     05  ZRDAYSL PIC S9(0004) COMP.
  1162     05  ZRDAYSF PIC  X(0001).
  1163     05  FILLER REDEFINES ZRDAYSF.
  1164         10  ZRDAYSA PIC  X(0001).
  1165     05  FILLER            PIC  X(3).
  1166     05  ZRDAYSI PIC  X(0003).
  1167*    -------------------------------
  1168     05  ZFORML PIC S9(0004) COMP.
  1169     05  ZFORMF PIC  X(0001).
  1170     05  FILLER REDEFINES ZFORMF.
  1171         10  ZFORMA PIC  X(0001).
  1172     05  FILLER            PIC  X(3).
  1173     05  ZFORMI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  22
* EL1041.cbl
  1174*    -------------------------------
  1175     05  ZBENEL PIC S9(0004) COMP.
  1176     05  ZBENEF PIC  X(0001).
  1177     05  FILLER REDEFINES ZBENEF.
  1178         10  ZBENEA PIC  X(0001).
  1179     05  FILLER            PIC  X(3).
  1180     05  ZBENEI PIC  X(0001).
  1181*    -------------------------------
  1182     05  ZBARCODL PIC S9(0004) COMP.
  1183     05  ZBARCODF PIC  X(0001).
  1184     05  FILLER REDEFINES ZBARCODF.
  1185         10  ZBARCODA PIC  X(0001).
  1186     05  FILLER            PIC  X(3).
  1187     05  ZBARCODI PIC  X(0001).
  1188*    -------------------------------
  1189     05  ZRETENVL PIC S9(0004) COMP.
  1190     05  ZRETENVF PIC  X(0001).
  1191     05  FILLER REDEFINES ZRETENVF.
  1192         10  ZRETENVA PIC  X(0001).
  1193     05  FILLER            PIC  X(3).
  1194     05  ZRETENVI PIC  X(0001).
  1195*    -------------------------------
  1196     05  ZCODES1L PIC S9(0004) COMP.
  1197     05  ZCODES1F PIC  X(0001).
  1198     05  FILLER REDEFINES ZCODES1F.
  1199         10  ZCODES1A PIC  X(0001).
  1200     05  FILLER            PIC  X(3).
  1201     05  ZCODES1I PIC  X(0053).
  1202*    -------------------------------
  1203     05  ZCODES2L PIC S9(0004) COMP.
  1204     05  ZCODES2F PIC  X(0001).
  1205     05  FILLER REDEFINES ZCODES2F.
  1206         10  ZCODES2A PIC  X(0001).
  1207     05  FILLER            PIC  X(3).
  1208     05  ZCODES2I PIC  X(0078).
  1209*    -------------------------------
  1210     05  DCCOPTL PIC S9(0004) COMP.
  1211     05  DCCOPTF PIC  X(0001).
  1212     05  FILLER REDEFINES DCCOPTF.
  1213         10  DCCOPTA PIC  X(0001).
  1214     05  FILLER            PIC  X(3).
  1215     05  DCCOPTI PIC  X(0035).
  1216*    -------------------------------
  1217     05  ZFADAYSL PIC S9(0004) COMP.
  1218     05  ZFADAYSF PIC  X(0001).
  1219     05  FILLER REDEFINES ZFADAYSF.
  1220         10  ZFADAYSA PIC  X(0001).
  1221     05  FILLER            PIC  X(3).
  1222     05  ZFADAYSI PIC  X(0003).
  1223*    -------------------------------
  1224     05  ZACLOSEL PIC S9(0004) COMP.
  1225     05  ZACLOSEF PIC  X(0001).
  1226     05  FILLER REDEFINES ZACLOSEF.
  1227         10  ZACLOSEA PIC  X(0001).
  1228     05  FILLER            PIC  X(3).
  1229     05  ZACLOSEI PIC  X(0001).
  1230*    -------------------------------
  1231     05  ERRMSGL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  23
* EL1041.cbl
  1232     05  ERRMSGF PIC  X(0001).
  1233     05  FILLER REDEFINES ERRMSGF.
  1234         10  ERRMSGA PIC  X(0001).
  1235     05  FILLER            PIC  X(3).
  1236     05  ERRMSGI PIC  X(0072).
  1237*    -------------------------------
  1238     05  PFKEYL PIC S9(0004) COMP.
  1239     05  PFKEYF PIC  X(0001).
  1240     05  FILLER REDEFINES PFKEYF.
  1241         10  PFKEYA PIC  X(0001).
  1242     05  FILLER            PIC  X(3).
  1243     05  PFKEYI PIC  99.
  1244 01  EL104ZO REDEFINES EL104ZI.
  1245     05  FILLER            PIC  X(0012).
  1246*    -------------------------------
  1247     05  FILLER            PIC  X(3).
  1248     05  DATEC PIC  X(0001).
  1249     05  DATEH PIC  X(0001).
  1250     05  DATEU PIC  X(0001).
  1251     05  DATEO PIC  X(0008).
  1252*    -------------------------------
  1253     05  FILLER            PIC  X(3).
  1254     05  TIMEC PIC  X(0001).
  1255     05  TIMEH PIC  X(0001).
  1256     05  TIMEU PIC  X(0001).
  1257     05  TIMEO PIC  99.99.
  1258*    -------------------------------
  1259     05  FILLER            PIC  X(3).
  1260     05  CMPNYIDC PIC  X(0001).
  1261     05  CMPNYIDH PIC  X(0001).
  1262     05  CMPNYIDU PIC  X(0001).
  1263     05  CMPNYIDO PIC  X(0003).
  1264*    -------------------------------
  1265     05  FILLER            PIC  X(3).
  1266     05  USERIDC PIC  X(0001).
  1267     05  USERIDH PIC  X(0001).
  1268     05  USERIDU PIC  X(0001).
  1269     05  USERIDO PIC  X(0004).
  1270*    -------------------------------
  1271     05  FILLER            PIC  X(3).
  1272     05  MAINTC PIC  X(0001).
  1273     05  MAINTH PIC  X(0001).
  1274     05  MAINTU PIC  X(0001).
  1275     05  MAINTO PIC  X(0001).
  1276*    -------------------------------
  1277     05  FILLER            PIC  X(3).
  1278     05  LSTUSRC PIC  X(0001).
  1279     05  LSTUSRH PIC  X(0001).
  1280     05  LSTUSRU PIC  X(0001).
  1281     05  LSTUSRO PIC  X(0004).
  1282*    -------------------------------
  1283     05  FILLER            PIC  X(3).
  1284     05  LSTDTEC PIC  X(0001).
  1285     05  LSTDTEH PIC  X(0001).
  1286     05  LSTDTEU PIC  X(0001).
  1287     05  LSTDTEO PIC  X(0008).
  1288*    -------------------------------
  1289     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  24
* EL1041.cbl
  1290     05  LSTTIMEC PIC  X(0001).
  1291     05  LSTTIMEH PIC  X(0001).
  1292     05  LSTTIMEU PIC  X(0001).
  1293     05  LSTTIMEO PIC  99.99.
  1294*    -------------------------------
  1295     05  FILLER            PIC  X(3).
  1296     05  ZLETRC PIC  X(0001).
  1297     05  ZLETRH PIC  X(0001).
  1298     05  ZLETRU PIC  X(0001).
  1299     05  ZLETRO PIC  X(0004).
  1300*    -------------------------------
  1301     05  FILLER            PIC  X(3).
  1302     05  ZCOPIESC PIC  X(0001).
  1303     05  ZCOPIESH PIC  X(0001).
  1304     05  ZCOPIESU PIC  X(0001).
  1305     05  ZCOPIESO PIC  9.
  1306*    -------------------------------
  1307     05  FILLER            PIC  X(3).
  1308     05  ZPROMPTC PIC  X(0001).
  1309     05  ZPROMPTH PIC  X(0001).
  1310     05  ZPROMPTU PIC  X(0001).
  1311     05  ZPROMPTO PIC  X(0001).
  1312*    -------------------------------
  1313     05  FILLER            PIC  X(3).
  1314     05  ZENCCDC PIC  X(0001).
  1315     05  ZENCCDH PIC  X(0001).
  1316     05  ZENCCDU PIC  X(0001).
  1317     05  ZENCCDO PIC  X(0003).
  1318*    -------------------------------
  1319     05  FILLER            PIC  X(3).
  1320     05  ZRDAYSC PIC  X(0001).
  1321     05  ZRDAYSH PIC  X(0001).
  1322     05  ZRDAYSU PIC  X(0001).
  1323     05  ZRDAYSO PIC  999.
  1324*    -------------------------------
  1325     05  FILLER            PIC  X(3).
  1326     05  ZFORMC PIC  X(0001).
  1327     05  ZFORMH PIC  X(0001).
  1328     05  ZFORMU PIC  X(0001).
  1329     05  ZFORMO PIC  X(0004).
  1330*    -------------------------------
  1331     05  FILLER            PIC  X(3).
  1332     05  ZBENEC PIC  X(0001).
  1333     05  ZBENEH PIC  X(0001).
  1334     05  ZBENEU PIC  X(0001).
  1335     05  ZBENEO PIC  X(0001).
  1336*    -------------------------------
  1337     05  FILLER            PIC  X(3).
  1338     05  ZBARCODC PIC  X(0001).
  1339     05  ZBARCODH PIC  X(0001).
  1340     05  ZBARCODU PIC  X(0001).
  1341     05  ZBARCODO PIC  X(0001).
  1342*    -------------------------------
  1343     05  FILLER            PIC  X(3).
  1344     05  ZRETENVC PIC  X(0001).
  1345     05  ZRETENVH PIC  X(0001).
  1346     05  ZRETENVU PIC  X(0001).
  1347     05  ZRETENVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  25
* EL1041.cbl
  1348*    -------------------------------
  1349     05  FILLER            PIC  X(3).
  1350     05  ZCODES1C PIC  X(0001).
  1351     05  ZCODES1H PIC  X(0001).
  1352     05  ZCODES1U PIC  X(0001).
  1353     05  ZCODES1O PIC  X(0053).
  1354*    -------------------------------
  1355     05  FILLER            PIC  X(3).
  1356     05  ZCODES2C PIC  X(0001).
  1357     05  ZCODES2H PIC  X(0001).
  1358     05  ZCODES2U PIC  X(0001).
  1359     05  ZCODES2O PIC  X(0078).
  1360*    -------------------------------
  1361     05  FILLER            PIC  X(3).
  1362     05  DCCOPTC PIC  X(0001).
  1363     05  DCCOPTH PIC  X(0001).
  1364     05  DCCOPTU PIC  X(0001).
  1365     05  DCCOPTO PIC  X(0035).
  1366*    -------------------------------
  1367     05  FILLER            PIC  X(3).
  1368     05  ZFADAYSC PIC  X(0001).
  1369     05  ZFADAYSH PIC  X(0001).
  1370     05  ZFADAYSU PIC  X(0001).
  1371     05  ZFADAYSO PIC  999.
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(3).
  1374     05  ZACLOSEC PIC  X(0001).
  1375     05  ZACLOSEH PIC  X(0001).
  1376     05  ZACLOSEU PIC  X(0001).
  1377     05  ZACLOSEO PIC  X(0001).
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(3).
  1380     05  ERRMSGC PIC  X(0001).
  1381     05  ERRMSGH PIC  X(0001).
  1382     05  ERRMSGU PIC  X(0001).
  1383     05  ERRMSGO PIC  X(0072).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(3).
  1386     05  PFKEYC PIC  X(0001).
  1387     05  PFKEYH PIC  X(0001).
  1388     05  PFKEYU PIC  X(0001).
  1389     05  PFKEYO PIC  99.
  1390*    -------------------------------
  1391****************************************************************
  1392*
  1393* Copyright (c) 2007 by Clerity Solutions, Inc.
  1394* All rights reserved.
  1395*
  1396****************************************************************
  1397 01  DFHEIV.
  1398   02  DFHEIV0               PIC X(35).
  1399   02  DFHEIV1               PIC X(08).
  1400   02  DFHEIV2               PIC X(08).
  1401   02  DFHEIV3               PIC X(08).
  1402   02  DFHEIV4               PIC X(06).
  1403   02  DFHEIV5               PIC X(04).
  1404   02  DFHEIV6               PIC X(04).
  1405   02  DFHEIV7               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  26
* EL1041.cbl
  1406   02  DFHEIV8               PIC X(02).
  1407   02  DFHEIV9               PIC X(01).
  1408   02  DFHEIV10              PIC S9(7) COMP-3.
  1409   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1410   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1411   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1412   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1413   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1414   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1415   02  DFHEIV17              PIC X(04).
  1416   02  DFHEIV18              PIC X(04).
  1417   02  DFHEIV19              PIC X(04).
  1418   02  DFHEIV20              USAGE IS POINTER.
  1419   02  DFHEIV21              USAGE IS POINTER.
  1420   02  DFHEIV22              USAGE IS POINTER.
  1421   02  DFHEIV23              USAGE IS POINTER.
  1422   02  DFHEIV24              USAGE IS POINTER.
  1423   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1424   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1425   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1426   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1427   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1428   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1429   02  FILLER                PIC X(02).
  1430   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1431   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1432   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1433   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1434   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1435 LINKAGE  SECTION.
  1436*****************************************************************
  1437*                                                               *
  1438* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1439* All rights reserved.                                          *
  1440*                                                               *
  1441*****************************************************************
  1442 01  dfheiblk.
  1443     02  eibtime          pic s9(7) comp-3.
  1444     02  eibdate          pic s9(7) comp-3.
  1445     02  eibtrnid         pic x(4).
  1446     02  eibtaskn         pic s9(7) comp-3.
  1447     02  eibtrmid         pic x(4).
  1448     02  dfheigdi         pic s9(4) comp.
  1449     02  eibcposn         pic s9(4) comp.
  1450     02  eibcalen         pic s9(4) comp.
  1451     02  eibaid           pic x(1).
  1452     02  eibfiller1       pic x(1).
  1453     02  eibfn            pic x(2).
  1454     02  eibfiller2       pic x(2).
  1455     02  eibrcode         pic x(6).
  1456     02  eibfiller3       pic x(2).
  1457     02  eibds            pic x(8).
  1458     02  eibreqid         pic x(8).
  1459     02  eibrsrce         pic x(8).
  1460     02  eibsync          pic x(1).
  1461     02  eibfree          pic x(1).
  1462     02  eibrecv          pic x(1).
  1463     02  eibsend          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  27
* EL1041.cbl
  1464     02  eibatt           pic x(1).
  1465     02  eibeoc           pic x(1).
  1466     02  eibfmh           pic x(1).
  1467     02  eibcompl         pic x(1).
  1468     02  eibsig           pic x(1).
  1469     02  eibconf          pic x(1).
  1470     02  eiberr           pic x(1).
  1471     02  eibrldbk         pic x(1).
  1472     02  eiberrcd         pic x(4).
  1473     02  eibsynrb         pic x(1).
  1474     02  eibnodat         pic x(1).
  1475     02  eibfiller5       pic x(2).
  1476     02  eibresp          pic 9(09) comp.
  1477     02  eibresp2         pic 9(09) comp.
  1478     02  dfheigdj         pic s9(4) comp.
  1479     02  dfheigdk         pic s9(4) comp.
  1480 01  DFHCOMMAREA                     PIC X(1024).
  1481*                                    COPY ELCTEXT.
  1482******************************************************************
  1483*                                                                *
  1484*                                                                *
  1485*                            ELCTEXT.                            *
  1486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1487*                            VMOD=2.008                          *
  1488*                                                                *
  1489*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1490*                                     FORM LETTERS,              *
  1491*                                     CERT FORM DISPLAY.
  1492*                                                                *
  1493*   FILE TYPE = VSAM,KSDS                                        *
  1494*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1495*                                                                *
  1496*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1497*       ALTERNATE INDEX = NONE                                   *
  1498*                                                                *
  1499*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1500*       ALTERNATE INDEX = NONE                                   *
  1501*                                                                *
  1502*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1503*       ALTERNATE INDEX = NONE                                   *
  1504*                                                                *
  1505*   LOG = NO                                                     *
  1506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1507******************************************************************
  1508 01  TEXT-FILES.
  1509     12  TEXT-FILE-ID                PIC XX.
  1510         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1511         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1512         88  HELP-FILE-TEXT             VALUE 'TH'.
  1513
  1514     12  TX-CONTROL-PRIMARY.
  1515         16  TX-COMPANY-CD           PIC X.
  1516             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1517         16  TX-ACCESS-CD-GENL       PIC X(12).
  1518
  1519         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1520             20  TX-LETTER-NO        PIC X(4).
  1521             20  FILLER              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  28
* EL1041.cbl
  1522
  1523         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1524             20  TX-FORM-NO          PIC X(12).
  1525
  1526         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1527             20  TX-HELP-TYPE        PIC X.
  1528                 88  HELP-FOR-GENERAL   VALUE ' '.
  1529                 88  HELP-BY-SCREEN     VALUE 'S'.
  1530                 88  HELP-BY-ERROR      VALUE 'E'.
  1531             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1532                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1533             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1534                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1535             20  FILLER              PIC X(4).
  1536
  1537         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1538
  1539     12  TX-PROCESS-CONTROL          PIC XX.
  1540         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1541
  1542     12  TX-TEXT-LINE                PIC X(70).
  1543
  1544     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1545         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1546         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1547         88  TX-VALID-FORM-SQUEEZE-VALUE
  1548                                        VALUE 'Y' ' '.
  1549
  1550     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1551         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1552         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1553         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1554         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1555         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1556         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1557         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1558                                              'K' 'N' ' '
  1559                                              'Z'.
  1560
  1561     12  TX-ARCHIVE-SW               PIC X.
  1562         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1563         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1564         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1565
  1566     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1567     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1568
  1569     12  TX-BSR-CODE                 PIC X.
  1570         88  TX-BSR-LETTER              VALUE 'B'.
  1571         88  TX-NON-BSR-LETTER          VALUE ' '.
  1572
  1573     12  FILLER                      PIC X.
  1574*****************************************************************
  1575*                                    COPY ELCENCC.
  1576******************************************************************
  1577*                                                                *
  1578*                                                                *
  1579*                            ELCENCC                             *
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  29
* EL1041.cbl
  1580*                            VMOD=2.001                          *
  1581*                                                                *
  1582*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  1583*                                                                *
  1584*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  1585*   A NAPERSOFT DOCUMENT                                         *
  1586*                                                                *
  1587*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  1588*                                                                *
  1589*   FILE TYPE = VSAM,KSDS                                        *
  1590*   RECORD SIZE = 400   RECFORM = FIX                            *
  1591*                                                                *
  1592*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  1593*                                                                *
  1594*   LOG = NO                                                     *
  1595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1596*                                                                *
  1597*                                                                *
  1598******************************************************************
  1599*                   C H A N G E   L O G
  1600*
  1601* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1602*-----------------------------------------------------------------
  1603*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1604* EFFECTIVE    NUMBER
  1605*-----------------------------------------------------------------
  1606* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  1607******************************************************************
  1608 01  ENCLOSURE-CODES.
  1609     12  NC-RECORD-ID                      PIC XX.
  1610         88  VALID-NC-ID                      VALUE 'NC'.
  1611     12  NC-CONTROL-PRIMARY.
  1612         16  NC-COMPANY-CD                 PIC X.
  1613         16  NC-REC-TYPE                   PIC X.
  1614             88  NC-CLAIMS                   VALUE '1'.
  1615             88  NC-ADMIN                    VALUE '2'.
  1616         16  NC-ENC-CODE                   PIC X(5).
  1617         16  FILLER                        PIC X(09).
  1618     12  NC-MAINT-INFORMATION.
  1619         16  NC-LAST-MAINT-DT              PIC XX.
  1620         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1621         16  NC-LAST-MAINT-USER            PIC X(4).
  1622         16  FILLER                        PIC XX.
  1623     12  NC-OUTPUT-STACK                   PIC XXX.
  1624     12  NC-ENCLOSURE-LINE                 PIC X(100).
  1625     12  NC-ATTACHMENTS                    PIC X(100).
  1626     12  NC-FUTURE                         PIC X(50).
  1627     12  FILLER                            PIC X(117).
  1628******************************************************************
  1629 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES
  1630                          ENCLOSURE-CODES.
  1631 0000-DFHEXIT SECTION.
  1632     MOVE '9#                    $   ' TO DFHEIV0.
  1633     MOVE 'EL1041' TO DFHEIV1.
  1634     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1635     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1636     MOVE '5'                    TO DC-OPTION-CODE
  1637     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  30
* EL1041.cbl
  1638     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1639     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1640     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1641     IF EIBCALEN = 0
  1642        GO TO 8800-UNAUTHORIZED-ACCESS.
  1643     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1644     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1645     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1646
  1647* EXEC CICS HANDLE CONDITION
  1648*        DUPREC     (8850-DUPREC)
  1649*        NOTOPEN    (8870-NOTOPEN)
  1650*        NOTFND     (8880-NOT-FOUND)
  1651*        PGMIDERR   (9600-PGMID-ERROR)
  1652*        ERROR      (9990-ABEND)
  1653*    END-EXEC.
  1654*    MOVE '"$%JIL.               ! " #00001642' TO DFHEIV0
  1655     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1657     MOVE X'2220233030303031363432' TO DFHEIV0(25:11)
  1658     CALL 'kxdfhei1' USING DFHEIV0
  1659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1660
  1661     .
  1662 0150-SET-PROGRAM-SAVES.
  1663     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1664         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1665             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1666             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1667             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1668             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1669             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1670             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1671             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1672             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1673         ELSE
  1674             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1675             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1676             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1677             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1678             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1679             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1680             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1681             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1682     ELSE
  1683         GO TO 0200-RECEIVE.
  1684     DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1685     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1686     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1687     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1688     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1689                                    PI-PREV-LETR-KEY
  1690
  1691     PERFORM 6500-BUILD-CURRENT-CODES THRU 6500-EXIT
  1692
  1693     GO TO 1000-SHOW-LETR-RECORD
  1694     .
  1695 0200-RECEIVE.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  31
* EL1041.cbl
  1696     IF EIBAID = DFHCLEAR
  1697        GO TO 9400-CLEAR.
  1698     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1699         MOVE LOW-VALUES             TO  EL104ZI
  1700         MOVE ER-7008                TO  EMI-ERROR
  1701         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1702         MOVE -1                     TO  MAINTL
  1703         GO TO 8200-SEND-DATAONLY.
  1704     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1705         NEXT SENTENCE
  1706     ELSE
  1707
  1708* EXEC CICS READQ TS
  1709*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1710*            INTO   (SECURITY-CONTROL)
  1711*            LENGTH (SC-COMM-LENGTH)
  1712*            ITEM   (SC-ITEM)
  1713*        END-EXEC
  1714*    MOVE '*$II   L              ''   #00001695' TO DFHEIV0
  1715     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1716     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1717     MOVE X'2020233030303031363935' TO DFHEIV0(25:11)
  1718     CALL 'kxdfhei1' USING DFHEIV0,
  1719           PI-SECURITY-TEMP-STORE-ID,
  1720           SECURITY-CONTROL,
  1721           SC-COMM-LENGTH,
  1722           SC-ITEM,
  1723           DFHEIV99,
  1724           DFHEIV99
  1725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1726         MOVE SC-CLAIMS-DISPLAY (4)  TO  PI-DISPLAY-CAP
  1727         MOVE SC-CLAIMS-UPDATE  (4)  TO  PI-MODIFY-CAP.
  1728
  1729* EXEC CICS RECEIVE
  1730*        MAP      (WS-MAP-NAME)
  1731*        MAPSET   (MAPSET-NAME)
  1732*        INTO     (EL104ZI)
  1733*    END-EXEC
  1734     MOVE LENGTH OF
  1735      EL104ZI
  1736       TO DFHEIV11
  1737*    MOVE '8"T I  L              ''   #00001703' TO DFHEIV0
  1738     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1739     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1740     MOVE X'2020233030303031373033' TO DFHEIV0(25:11)
  1741     CALL 'kxdfhei1' USING DFHEIV0,
  1742           WS-MAP-NAME,
  1743           EL104ZI,
  1744           DFHEIV11,
  1745           MAPSET-NAME,
  1746           DFHEIV99,
  1747           DFHEIV99
  1748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1749     IF PFKEYL = +0
  1750         GO TO 0300-CHECK-PFKEYS.
  1751     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1752         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1753     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  32
* EL1041.cbl
  1754         MOVE ER-0029                TO  EMI-ERROR
  1755         GO TO 0320-INPUT-ERROR.
  1756 0300-CHECK-PFKEYS.
  1757     DISPLAY ' MADE IT TO 0300 '
  1758     IF EIBAID EQUAL DFHPF23
  1759         GO TO 8810-PF23.
  1760     IF EIBAID EQUAL DFHPF24
  1761         GO TO 9200-RETURN-MAIN-MENU.
  1762     IF EIBAID EQUAL DFHPF12
  1763         GO TO 9500-PF12.
  1764     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1765         MOVE ER-0050            TO EMI-ERROR
  1766         GO TO 0320-INPUT-ERROR.
  1767     IF EIBAID EQUAL DFHENTER
  1768         GO TO 0330-EDIT-DATA.
  1769     MOVE ER-0029                    TO  EMI-ERROR.
  1770 0320-INPUT-ERROR.
  1771     DISPLAY ' MADE IT TO 0320 '
  1772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1773     MOVE AL-UNBON                   TO  PFKEYA.
  1774     MOVE -1                         TO  PFKEYL.
  1775     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  33
* EL1041.cbl
  1777 0330-EDIT-DATA.
  1778     IF NOT DISPLAY-CAP
  1779         MOVE 'READ'                 TO  SM-READ
  1780         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1781         MOVE ER-0070                TO  EMI-ERROR
  1782         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1783         MOVE -1                     TO  MAINTL
  1784         GO TO 8100-SEND-INITIAL-MAP.
  1785     IF MAINTI EQUAL 'S'
  1786        GO TO 1000-SHOW-LETR-RECORD.
  1787     IF MAINTI = 'C' OR 'A'
  1788        IF NOT MODIFY-CAP
  1789           PERFORM 9995-SECURITY-VIOLATION
  1790                                 THRU 9995-EXIT
  1791           MOVE ER-0070          TO EMI-ERROR
  1792           PERFORM 9900-ERROR-FORMAT
  1793                                 THRU 9900-EXIT
  1794           MOVE LOW-VALUES       TO EL104ZO
  1795           MOVE -1               TO MAINTL
  1796           GO TO 8100-SEND-INITIAL-MAP
  1797        END-IF
  1798     END-IF
  1799     IF MAINTI = 'C'
  1800        GO TO 2000-CHANGE-LETR-RECORD
  1801     END-IF
  1802     IF MAINTI = 'A'
  1803        GO TO 3000-ADD-LETR-RECORD
  1804     END-IF
  1805     MOVE ER-0023                    TO  EMI-ERROR.
  1806     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1807     MOVE -1                         TO  MAINTL.
  1808     MOVE AL-UABON                   TO  MAINTA.
  1809     GO TO 8200-SEND-DATAONLY.
  1810 1000-SHOW-LETR-RECORD.
  1811     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1812
  1813* EXEC CICS STARTBR
  1814*        DATASET   (ELLETR-FILE-ID)
  1815*        RIDFLD    (ELLETR-KEY)
  1816*        GTEQ
  1817*        RESP      (WS-RESPONSE)
  1818*    END-EXEC
  1819     MOVE 0
  1820       TO DFHEIV11
  1821*    MOVE '&,         G          &  N#00001771' TO DFHEIV0
  1822     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1823     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1824     MOVE X'204E233030303031373731' TO DFHEIV0(25:11)
  1825     CALL 'kxdfhei1' USING DFHEIV0,
  1826           ELLETR-FILE-ID,
  1827           ELLETR-KEY,
  1828           DFHEIV99,
  1829           DFHEIV11,
  1830           DFHEIV99
  1831     MOVE EIBRESP  TO WS-RESPONSE
  1832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1833     IF RESP-NORMAL
  1834        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  34
* EL1041.cbl
  1835           OR WE-FOUND-IT
  1836
  1837* EXEC CICS READNEXT
  1838*              DATASET    (ELLETR-FILE-ID)
  1839*              SET        (ADDRESS OF TEXT-FILES)
  1840*              RIDFLD     (ELLETR-KEY)
  1841*              RESP       (WS-RESPONSE)
  1842*          END-EXEC
  1843     MOVE 0
  1844       TO DFHEIV11
  1845*    MOVE '&.S                   )  N#00001780' TO DFHEIV0
  1846     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1847     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1848     MOVE X'204E233030303031373830' TO DFHEIV0(25:11)
  1849     CALL 'kxdfhei1' USING DFHEIV0,
  1850           ELLETR-FILE-ID,
  1851           DFHEIV20,
  1852           DFHEIV99,
  1853           ELLETR-KEY,
  1854           DFHEIV99,
  1855           DFHEIV11,
  1856           DFHEIV99,
  1857           DFHEIV99
  1858     SET ADDRESS OF TEXT-FILES TO
  1859         DFHEIV20
  1860     MOVE EIBRESP  TO WS-RESPONSE
  1861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1862           IF (RESP-NORMAL)
  1863              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1864              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1865                 SET WE-FOUND-IT   TO TRUE
  1866              END-IF
  1867           ELSE
  1868              SET I-SAY-TO-STOP  TO TRUE
  1869           END-IF
  1870        END-PERFORM
  1871     END-IF
  1872     IF WE-FOUND-IT
  1873        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1874                                    PI-PREV-LETR-KEY
  1875        GO TO 7000-BUILD-OUTPUT-MAP
  1876     END-IF
  1877     MOVE ER-0418                TO EMI-ERROR.
  1878     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1879     MOVE -1                     TO MAINTL
  1880     MOVE 'A'                    TO MAINTI
  1881     MOVE AL-UANON               TO MAINTA
  1882     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1883     MOVE +4                     TO ZLETRL
  1884     MOVE AL-UANON               TO ZLETRA
  1885     GO TO 8100-SEND-INITIAL-MAP
  1886     .
  1887 2000-CHANGE-LETR-RECORD.
  1888     display ' made it to 2000 '
  1889     display ' curr   ' pi-curr-letr-key
  1890     display ' prev   ' pi-prev-letr-key
  1891     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1892        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  35
* EL1041.cbl
  1893        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1894        MOVE -1                  TO MAINTL
  1895        GO TO 8200-SEND-DATAONLY
  1896     END-IF
  1897     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1898     IF NOT EMI-NO-ERRORS
  1899         GO TO 8200-SEND-DATAONLY.
  1900     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1901     .
  1902 2000-CHANGE-CONTINUE.
  1903
  1904* EXEC CICS READ
  1905*        DATASET    (ELLETR-FILE-ID)
  1906*        SET        (ADDRESS OF TEXT-FILES)
  1907*        RIDFLD     (ELLETR-KEY)
  1908*        UPDATE
  1909*        RESP       (WS-RESPONSE)
  1910*    END-EXEC
  1911*    MOVE '&"S        EU         (  N#00001827' TO DFHEIV0
  1912     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1913     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1914     MOVE X'204E233030303031383237' TO DFHEIV0(25:11)
  1915     CALL 'kxdfhei1' USING DFHEIV0,
  1916           ELLETR-FILE-ID,
  1917           DFHEIV20,
  1918           DFHEIV99,
  1919           ELLETR-KEY,
  1920           DFHEIV99,
  1921           DFHEIV99,
  1922           DFHEIV99
  1923     SET ADDRESS OF TEXT-FILES TO
  1924         DFHEIV20
  1925     MOVE EIBRESP  TO WS-RESPONSE
  1926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1927     IF RESP-NOTFND
  1928        IF ELLETR-SEQ-NO = +0
  1929           GO TO 3000-CONTINUE-ADD
  1930        END-IF
  1931     END-IF
  1932     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1933        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1934
  1935* EXEC CICS UNLOCK
  1936*            DATASET   (ELLETR-FILE-ID)
  1937*        END-EXEC
  1938*    MOVE '&*                    #   #00001841' TO DFHEIV0
  1939     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1940     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1941     MOVE X'2020233030303031383431' TO DFHEIV0(25:11)
  1942     CALL 'kxdfhei1' USING DFHEIV0,
  1943           ELLETR-FILE-ID,
  1944           DFHEIV99
  1945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1946         MOVE ER-0068                TO  EMI-ERROR
  1947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1948         GO TO 1000-SHOW-LETR-RECORD.
  1949     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1950     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  36
* EL1041.cbl
  1951     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1952     IF ZCOPIESL > +0
  1953        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1954     END-IF
  1955     IF ZFADAYSL > +0
  1956        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1957     END-IF
  1958     IF ZRDAYSL > +0
  1959        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  1960     END-IF
  1961     IF ZFORML > +0
  1962        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1963     END-IF
  1964     IF ZPROMPTL > +0
  1965        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1966     END-IF
  1967     IF ZENCCDL > +0
  1968        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1969     END-IF
  1970     IF ZACLOSEL > +0
  1971        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1972     END-IF
  1973     IF ZBENEL > +0
  1974        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1975     END-IF
  1976
  1977     IF ZBARCODL > +0
  1978        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  1979     END-IF
  1980
  1981     IF ZRETENVL > +0
  1982        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  1983     END-IF
  1984     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1985     .
  1986 2000-CONTINUE-CHANGE.
  1987     DISPLAY ' ABOUT TO REWRITE '
  1988
  1989* EXEC CICS REWRITE
  1990*        DATASET   (ELLETR-FILE-ID)
  1991*        FROM      (TEXT-FILES)
  1992*    END-EXEC.
  1993     MOVE LENGTH OF
  1994      TEXT-FILES
  1995       TO DFHEIV11
  1996*    MOVE '&& L                  %   #00001886' TO DFHEIV0
  1997     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1998     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1999     MOVE X'2020233030303031383836' TO DFHEIV0(25:11)
  2000     CALL 'kxdfhei1' USING DFHEIV0,
  2001           ELLETR-FILE-ID,
  2002           TEXT-FILES,
  2003           DFHEIV11,
  2004           DFHEIV99
  2005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2006
  2007     MOVE ER-0000                    TO  EMI-ERROR.
  2008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  37
* EL1041.cbl
  2009     GO TO 1000-SHOW-LETR-RECORD
  2010     .
  2011 3000-ADD-LETR-RECORD.
  2012     display ' made it to 3000 '
  2013     display ' curr   ' pi-curr-letr-key
  2014     display ' prev   ' pi-prev-letr-key
  2015     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2016     .
  2017 3000-CONTINUE-ADD.
  2018     IF NOT EMI-NO-ERRORS
  2019        GO TO 8200-SEND-DATAONLY
  2020     END-IF
  2021     MOVE SPACES                 TO ELLETR-KEY
  2022     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  2023     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  2024     MOVE +0                     TO ELLETR-SEQ-NO
  2025
  2026* EXEC CICS READ
  2027*        DATASET    (ELLETR-FILE-ID)
  2028*        SET        (ADDRESS OF TEXT-FILES)
  2029*        RIDFLD     (ELLETR-KEY)
  2030*        GTEQ
  2031*        RESP       (WS-RESPONSE)
  2032*    END-EXEC
  2033*    MOVE '&"S        G          (  N#00001908' TO DFHEIV0
  2034     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2036     MOVE X'204E233030303031393038' TO DFHEIV0(25:11)
  2037     CALL 'kxdfhei1' USING DFHEIV0,
  2038           ELLETR-FILE-ID,
  2039           DFHEIV20,
  2040           DFHEIV99,
  2041           ELLETR-KEY,
  2042           DFHEIV99,
  2043           DFHEIV99,
  2044           DFHEIV99
  2045     SET ADDRESS OF TEXT-FILES TO
  2046         DFHEIV20
  2047     MOVE EIBRESP  TO WS-RESPONSE
  2048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2049     IF RESP-NORMAL
  2050        IF TX-LETTER-NO = ZLETRI
  2051           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2052              MOVE ER-0132       TO EMI-ERROR
  2053              PERFORM 9900-ERROR-FORMAT
  2054                                 THRU 9900-EXIT
  2055              MOVE -1            TO ZLETRL
  2056              MOVE AL-UABON      TO ZLETRA
  2057              GO TO 8200-SEND-DATAONLY
  2058           ELSE
  2059              MOVE +0            TO WS-SEQ-NO-TO-USE
  2060           END-IF
  2061        ELSE
  2062           MOVE +1               TO WS-SEQ-NO-TO-USE
  2063        END-IF
  2064     ELSE
  2065        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2066     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  38
* EL1041.cbl
  2067
  2068* EXEC CICS GETMAIN
  2069*       SET(ADDRESS OF TEXT-FILES)
  2070*       LENGTH(ELLETR-LENGTH)
  2071*    END-EXEC
  2072*    MOVE '," L                  $   #00001933' TO DFHEIV0
  2073     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2074     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2075     MOVE X'2020233030303031393333' TO DFHEIV0(25:11)
  2076     CALL 'kxdfhei1' USING DFHEIV0,
  2077           DFHEIV20,
  2078           ELLETR-LENGTH,
  2079           DFHEIV99
  2080     SET ADDRESS OF TEXT-FILES TO
  2081         DFHEIV20
  2082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2083     MOVE SPACES                 TO TEXT-FILES
  2084     MOVE 'TL'                   TO TEXT-FILE-ID
  2085     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2086     MOVE ZLETRI                 TO TX-LETTER-NO
  2087     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2088     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2089     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2090     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2091     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2092     IF ZCOPIESL > +0
  2093        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2094     ELSE
  2095        MOVE 1                   TO W-NUMBER-OF-COPIES
  2096     END-IF
  2097     IF ZFADAYSL > +0
  2098        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2099     ELSE
  2100        MOVE ZEROS               TO W-DAYS-TO-FOLLOW-UP
  2101     END-IF
  2102     IF ZRDAYSL > +0
  2103        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2104     ELSE
  2105        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2106     END-IF
  2107     IF ZFORML > +0
  2108        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2109     END-IF
  2110     IF ZPROMPTL > +0
  2111        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2112     END-IF
  2113     IF ZENCCDL > +0
  2114        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2115     END-IF
  2116     IF ZACLOSEL > +0
  2117        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2118     END-IF
  2119     IF ZBENEL > +0
  2120        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2121     END-IF
  2122
  2123     IF ZBARCODL > +0
  2124        MOVE ZBARCODI            TO W-ADD-BAR-CODE
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  39
* EL1041.cbl
  2125     END-IF
  2126
  2127     IF ZRETENVL > +0
  2128        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2129     END-IF
  2130     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2131     DISPLAY ' ABOUT TO WRITE '
  2132     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2133                                    PI-CURR-LETR-KEY
  2134                                    PI-PREV-LETR-KEY
  2135
  2136* EXEC CICS WRITE
  2137*       DATASET (ELLETR-FILE-ID)
  2138*       FROM    (TEXT-FILES)
  2139*       RIDFLD  (ELLETR-KEY)
  2140*    END-EXEC
  2141     MOVE LENGTH OF
  2142      TEXT-FILES
  2143       TO DFHEIV11
  2144*    MOVE '&$ L                  ''   #00001989' TO DFHEIV0
  2145     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2146     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2147     MOVE X'2020233030303031393839' TO DFHEIV0(25:11)
  2148     CALL 'kxdfhei1' USING DFHEIV0,
  2149           ELLETR-FILE-ID,
  2150           TEXT-FILES,
  2151           DFHEIV11,
  2152           ELLETR-KEY,
  2153           DFHEIV99,
  2154           DFHEIV99
  2155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2156     MOVE ER-0000                    TO  EMI-ERROR.
  2157     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2158     GO TO 1000-SHOW-LETR-RECORD
  2159     .
  2160 5000-FIND-NEXT-PROD-RECORD.
  2161*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2162*
  2163*    EXEC CICS STARTBR
  2164*        DATASET   (ELLETR-FILE-ID)
  2165*        RIDFLD    (ELLETR-KEY)
  2166*        GTEQ
  2167*        RESP      (WS-RESPONSE)
  2168*    END-EXEC
  2169*
  2170*    IF NOT RESP-NORMAL
  2171*       MOVE -1                  TO PFKEYL
  2172*       MOVE ER-0130             TO EMI-ERROR
  2173*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2174*       GO TO 8200-SEND-DATAONLY
  2175*    END-IF
  2176     .
  2177 5000-READNEXT-LOOP.
  2178*    EXEC CICS READNEXT
  2179*        DATASET   (ELLETR-FILE-ID)
  2180*        SET       (ADDRESS OF PRODUCT-MASTER)
  2181*        RIDFLD    (ELLETR-KEY)
  2182*        RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  40
* EL1041.cbl
  2183*    END-EXEC
  2184*
  2185*    IF (NOT RESP-NORMAL)
  2186*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2187*       PERFORM 5000-END-BROWSE
  2188*       MOVE -1                  TO PFKEYL
  2189*       MOVE ER-0130             TO EMI-ERROR
  2190*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2191*       GO TO 1000-SHOW-LETR-RECORD
  2192*    END-IF
  2193*
  2194*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2195*       GO TO 5000-READNEXT-LOOP
  2196*    END-IF
  2197*
  2198*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2199*
  2200*    PERFORM 5000-END-BROWSE
  2201*    GO TO 7000-BUILD-OUTPUT-MAP
  2202     .
  2203 5000-END-BROWSE.
  2204*    EXEC CICS ENDBR
  2205*        DATASET   (ELLETR-FILE-ID)
  2206*    END-EXEC
  2207     .
  2208 5100-FIND-PREV-PROD-RECORD.
  2209*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2210*    IF STATEL > +0
  2211*       MOVE STATEI              TO ELLETR-STATE
  2212*    END-IF
  2213*    IF PRODCDL > +0
  2214*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2215*    END-IF
  2216*    IF BENTYPL > +0
  2217*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2218*    IF BENCODEL > +0
  2219*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2220*    IF EXPDTL IS GREATER THAN +0
  2221*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2222*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2223*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2224*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2225*        ELSE
  2226*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2227*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2228*          END-STRING
  2229*           MOVE 'L'                    TO  DC-OPTION-CODE
  2230*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2231*            IF NO-CONVERSION-ERROR
  2232*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2233*            ELSE
  2234*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2235*
  2236*    EXEC CICS HANDLE CONDITION
  2237*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2238*    END-EXEC.
  2239*
  2240*    EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  41
* EL1041.cbl
  2241*        DATASET   (ELLETR-FILE-ID)
  2242*        RIDFLD    (ELLETR-KEY)
  2243*        GTEQ
  2244*    END-EXEC.
  2245 5100-READPREV-LOOP.
  2246*    EXEC CICS READPREV
  2247*        DATASET   (ELLETR-FILE-ID)
  2248*        SET       (ADDRESS OF PRODUCT-MASTER)
  2249*        RIDFLD    (ELLETR-KEY)
  2250*    END-EXEC.
  2251*
  2252*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2253*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2254*
  2255*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2256*        GO TO 5100-READPREV-LOOP.
  2257*
  2258*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2259*
  2260*    GO TO 7000-BUILD-OUTPUT-MAP.
  2261 5100-END-BROWSE.
  2262*    EXEC CICS ENDBR
  2263*        DATASET   (ELLETR-FILE-ID)
  2264*    END-EXEC.
  2265 5100-UNSUCCESSFUL-SEARCH.
  2266     PERFORM 5100-END-BROWSE.
  2267     MOVE ER-0131                    TO  EMI-ERROR.
  2268     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2269     GO TO 1000-SHOW-LETR-RECORD.
  2270     .
  2271 6000-EDIT-INPUT-DATA.
  2272     IF MAINTI = 'A'
  2273        IF ZLETRL > +0
  2274           AND ZLETRI NOT = SPACES
  2275           CONTINUE
  2276        ELSE
  2277           MOVE AL-UNBON         TO ZCOPIESA
  2278           MOVE -1               TO ZCOPIESL
  2279           MOVE ER-0005          TO EMI-ERROR
  2280           PERFORM 9900-ERROR-FORMAT
  2281                                 THRU 9900-EXIT
  2282        END-IF
  2283     END-IF
  2284     IF ZCOPIESL > +0
  2285        IF ZCOPIESI NUMERIC
  2286           CONTINUE
  2287        ELSE
  2288           MOVE AL-UNBON         TO ZCOPIESA
  2289           MOVE -1               TO ZCOPIESL
  2290           MOVE ER-0184          TO EMI-ERROR
  2291           PERFORM 9900-ERROR-FORMAT
  2292                                 THRU 9900-EXIT
  2293        END-IF
  2294     END-IF
  2295     IF ZFADAYSL > +0
  2296        IF ZFADAYSI NUMERIC
  2297           CONTINUE
  2298        ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  42
* EL1041.cbl
  2299           MOVE AL-UNBON         TO ZFADAYSA
  2300           MOVE -1               TO ZFADAYSL
  2301           MOVE ER-0491          TO EMI-ERROR
  2302           PERFORM 9900-ERROR-FORMAT
  2303                                 THRU 9900-EXIT
  2304        END-IF
  2305     END-IF
  2306     IF ZRDAYSL > +0
  2307        IF ZRDAYSI NUMERIC
  2308           CONTINUE
  2309        ELSE
  2310           MOVE AL-UNBON         TO ZRDAYSA
  2311           MOVE -1               TO ZRDAYSL
  2312           MOVE ER-0491          TO EMI-ERROR
  2313           PERFORM 9900-ERROR-FORMAT
  2314                                 THRU 9900-EXIT
  2315        END-IF
  2316     END-IF
  2317     IF ZPROMPTL > +0
  2318        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2319           CONTINUE
  2320        ELSE
  2321           MOVE AL-UABON         TO ZPROMPTA
  2322           MOVE -1               TO ZPROMPTL
  2323           MOVE ER-0627          TO EMI-ERROR
  2324           PERFORM 9900-ERROR-FORMAT
  2325                                 THRU 9900-EXIT
  2326        END-IF
  2327     END-IF
  2328     IF MAINTI = 'A'
  2329        AND ZENCCDL <= 0
  2330        MOVE AL-UABON            TO ZENCCDA
  2331        MOVE -1                  TO ZENCCDL
  2332        MOVE ER-1560             TO EMI-ERROR
  2333        PERFORM 9900-ERROR-FORMAT
  2334                                 THRU 9900-EXIT
  2335     END-IF
  2336     IF ZENCCDL > +0
  2337        IF ZENCCDI = '@'
  2338            CONTINUE
  2339        ELSE
  2340           MOVE SPACES             TO ELENCC-KEY
  2341           MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2342           MOVE '1'                TO ELENCC-REC-TYPE
  2343           MOVE ZENCCDI            TO ELENCC-ENC-CODE
  2344
  2345
  2346* EXEC CICS READ
  2347*              DATASET    (ELENCC-FILE-ID)
  2348*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2349*              RIDFLD     (ELENCC-KEY)
  2350*              RESP       (WS-RESPONSE)
  2351*          END-EXEC
  2352*    MOVE '&"S        E          (  N#00002183' TO DFHEIV0
  2353     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2355     MOVE X'204E233030303032313833' TO DFHEIV0(25:11)
  2356     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  43
* EL1041.cbl
  2357           ELENCC-FILE-ID,
  2358           DFHEIV20,
  2359           DFHEIV99,
  2360           ELENCC-KEY,
  2361           DFHEIV99,
  2362           DFHEIV99,
  2363           DFHEIV99
  2364     SET ADDRESS OF ENCLOSURE-CODES TO
  2365         DFHEIV20
  2366     MOVE EIBRESP  TO WS-RESPONSE
  2367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2368
  2369           IF RESP-NORMAL
  2370              CONTINUE
  2371           ELSE
  2372              MOVE AL-UABON         TO ZENCCDA
  2373              MOVE -1               TO ZENCCDL
  2374              MOVE ER-1560          TO EMI-ERROR
  2375              PERFORM 9900-ERROR-FORMAT
  2376                                 THRU 9900-EXIT
  2377           END-IF
  2378        END-IF
  2379     END-IF
  2380     IF ZACLOSEL > +0
  2381        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2382           CONTINUE
  2383        ELSE
  2384           MOVE -1               TO ZACLOSEL
  2385           MOVE AL-UABON         TO ZACLOSEA
  2386           MOVE ER-1562          TO EMI-ERROR
  2387           PERFORM 9900-ERROR-FORMAT
  2388                                 THRU 9900-EXIT
  2389        END-IF
  2390     END-IF
  2391     IF ZBENEL > +0
  2392        IF ZBENEI = 'Y' OR 'N' OR ' '
  2393           CONTINUE
  2394        ELSE
  2395           MOVE AL-UABON         TO ZBENEA
  2396           MOVE -1               TO ZBENEL
  2397           MOVE ER-0627          TO EMI-ERROR
  2398           PERFORM 9900-ERROR-FORMAT
  2399                                 THRU 9900-EXIT
  2400        END-IF
  2401     END-IF
  2402
  2403     IF ZBARCODL > +0
  2404        IF ZBARCODI = 'Y' OR 'N' OR ' '
  2405           CONTINUE
  2406        ELSE
  2407           MOVE AL-UABON         TO ZBARCODA
  2408           MOVE -1               TO ZBARCODL
  2409           MOVE ER-0627          TO EMI-ERROR
  2410           PERFORM 9900-ERROR-FORMAT
  2411                                 THRU 9900-EXIT
  2412        END-IF
  2413     END-IF
  2414
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  44
* EL1041.cbl
  2415     IF ZRETENVL > +0
  2416        IF ZRETENVI = 'Y' OR 'N' OR ' '
  2417           CONTINUE
  2418        ELSE
  2419           MOVE AL-UABON         TO ZRETENVA
  2420           MOVE -1               TO ZRETENVL
  2421           MOVE ER-0627          TO EMI-ERROR
  2422           PERFORM 9900-ERROR-FORMAT
  2423                                 THRU 9900-EXIT
  2424        END-IF
  2425     END-IF
  2426     .
  2427 6000-EXIT.
  2428     EXIT.
  2429
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  45
* EL1041.cbl
  2431 6500-BUILD-CURRENT-CODES.
  2432      MOVE SPACES             TO ELENCC-KEY
  2433      MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2434      MOVE '1'                TO ELENCC-REC-TYPE
  2435      MOVE LOW-VALUES         TO ELENCC-ENC-CODE
  2436      MOVE SPACES             TO HOLD-ENC-CODES
  2437      MOVE '@'                TO HOLD-ENC-CODES (1:1)
  2438      MOVE HOLD-ENC-CODES     TO PI-ENC-CODES
  2439
  2440
  2441* EXEC CICS STARTBR
  2442*        DATASET   (ELENCC-FILE-ID)
  2443*        RIDFLD    (ELENCC-KEY)
  2444*        GTEQ
  2445*        RESP      (WS-RESPONSE)
  2446*     END-EXEC
  2447     MOVE 0
  2448       TO DFHEIV11
  2449*    MOVE '&,         G          &  N#00002261' TO DFHEIV0
  2450     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2451     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2452     MOVE X'204E233030303032323631' TO DFHEIV0(25:11)
  2453     CALL 'kxdfhei1' USING DFHEIV0,
  2454           ELENCC-FILE-ID,
  2455           ELENCC-KEY,
  2456           DFHEIV99,
  2457           DFHEIV11,
  2458           DFHEIV99
  2459     MOVE EIBRESP  TO WS-RESPONSE
  2460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2461
  2462      IF RESP-NORMAL
  2463        PERFORM UNTIL DONE-WITH-ENCC
  2464           MOVE PI-ENC-CODES TO HOLD-ENC-CODES
  2465
  2466* EXEC CICS READNEXT
  2467*              DATASET    (ELENCC-FILE-ID)
  2468*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2469*              RIDFLD     (ELENCC-KEY)
  2470*              RESP       (WS-RESPONSE)
  2471*          END-EXEC
  2472     MOVE 0
  2473       TO DFHEIV11
  2474*    MOVE '&.S                   )  N#00002271' TO DFHEIV0
  2475     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2476     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2477     MOVE X'204E233030303032323731' TO DFHEIV0(25:11)
  2478     CALL 'kxdfhei1' USING DFHEIV0,
  2479           ELENCC-FILE-ID,
  2480           DFHEIV20,
  2481           DFHEIV99,
  2482           ELENCC-KEY,
  2483           DFHEIV99,
  2484           DFHEIV11,
  2485           DFHEIV99,
  2486           DFHEIV99
  2487     SET ADDRESS OF ENCLOSURE-CODES TO
  2488         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  46
* EL1041.cbl
  2489     MOVE EIBRESP  TO WS-RESPONSE
  2490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2491           IF (RESP-NORMAL)
  2492              AND (ELENCC-COMPANY-CD = PI-COMPANY-CD)
  2493              AND (ELENCC-REC-TYPE = '1')
  2494                 PERFORM VARYING WS-SUB1 FROM 5 BY -1
  2495                      UNTIL ELENCC-ENC-CODE (WS-SUB1:1) <> ' '
  2496                 END-PERFORM
  2497                 IF WS-SUB1 > 2
  2498                     SUBTRACT +1 FROM WS-SUB1
  2499                 END-IF
  2500                 MOVE ELENCC-ENC-CODE (WS-SUB1:2) TO
  2501                             WS-TEST-STATE
  2502                 IF STATE-SPECIFIC AND
  2503                    ELENCC-ENC-CODE NOT = 'ENV'
  2504                    CONTINUE
  2505                 ELSE
  2506                    STRING HOLD-ENC-CODES DELIMITED BY ' '
  2507                         ','
  2508                         ELENCC-ENC-CODE DELIMITED BY ' '
  2509                    INTO PI-ENC-CODES
  2510                 end-if
  2511           ELSE
  2512              SET DONE-WITH-ENCC  TO TRUE
  2513           END-IF
  2514        END-PERFORM
  2515     END-IF
  2516
  2517     MOVE +53 TO PI-SPLIT-SUB
  2518     PERFORM UNTIL PI-ENC-CODES (PI-SPLIT-SUB:1) = ' ' OR ','
  2519         SUBTRACT +1 FROM PI-SPLIT-SUB
  2520     END-PERFORM
  2521
  2522     .
  2523 6500-EXIT.
  2524     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  47
* EL1041.cbl
  2526 7000-BUILD-OUTPUT-MAP.
  2527     MOVE LOW-VALUES             TO EL104ZO
  2528     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2529     MOVE TX-LETTER-NO           TO ZLETRO
  2530     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2531     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2532     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2533     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2534     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2535     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2536     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2537     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2538     MOVE W-ADD-BAR-CODE         TO ZBARCODO
  2539     MOVE W-HAS-RETURN-ENV       TO ZRETENVO
  2540     MOVE PI-SPLIT-SUB           TO WS-SUB1
  2541     COMPUTE WS-SUB2 = PI-SPLIT-SUB + 1
  2542     COMPUTE WS-SUB3 = 120 - PI-SPLIT-SUB
  2543     MOVE PI-ENC-CODES (1:WS-SUB1) TO ZCODES1O
  2544     MOVE PI-ENC-CODES (WS-SUB2:WS-SUB3) TO ZCODES2O
  2545     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2546                                    PI-UPDATE-BY
  2547     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2548                                    DC-BIN-DATE-1
  2549     MOVE ' '                    TO DC-OPTION-CODE
  2550     MOVE +0                     TO DC-ELAPSED-DAYS
  2551                                     DC-ELAPSED-MONTHS.
  2552     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2553     IF NO-CONVERSION-ERROR
  2554        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2555     ELSE
  2556        MOVE LOW-VALUES          TO LSTDTEO
  2557     END-IF
  2558     MOVE -1                     TO MAINTL
  2559     .
  2560 8100-SEND-INITIAL-MAP.
  2561     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2562     MOVE EIBTIME                    TO  TIME-IN.
  2563     MOVE SAVE-DATE                  TO  DATEO.
  2564     MOVE TIME-OUT                   TO  TIMEO
  2565     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2566     MOVE PI-PROCESSOR-ID        TO USERIDO
  2567     IF PI-COMPANY-ID = 'DCC'
  2568        MOVE '6-IU CLM FORM,   7-CONTINUING IU,  ' TO DCCOPTO
  2569     END-IF
  2570
  2571* EXEC CICS SEND
  2572*        MAP      (WS-MAP-NAME)
  2573*        MAPSET   (MAPSET-NAME)
  2574*        FROM     (EL104ZO)
  2575*        ERASE
  2576*        CURSOR
  2577*    END-EXEC.
  2578     MOVE LENGTH OF
  2579      EL104ZO
  2580       TO DFHEIV12
  2581     MOVE -1
  2582       TO DFHEIV11
  2583*    MOVE '8$     CT  E    H L F ,   #00002356' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  48
* EL1041.cbl
  2584     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2585     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2586     MOVE X'2020233030303032333536' TO DFHEIV0(25:11)
  2587     CALL 'kxdfhei1' USING DFHEIV0,
  2588           WS-MAP-NAME,
  2589           EL104ZO,
  2590           DFHEIV12,
  2591           MAPSET-NAME,
  2592           DFHEIV99,
  2593           DFHEIV99,
  2594           DFHEIV99,
  2595           DFHEIV11,
  2596           DFHEIV99,
  2597           DFHEIV99,
  2598           DFHEIV99
  2599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2600
  2601     MOVE '104Z'                 TO PI-CURRENT-SCREEN-NO
  2602     GO TO 9100-RETURN-TRAN
  2603     .
  2604 8200-SEND-DATAONLY.
  2605     DISPLAY ' MADE IT TO 8200 '
  2606     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2607     MOVE EIBTIME                    TO  TIME-IN.
  2608     MOVE SAVE-DATE                  TO  DATEO.
  2609     MOVE TIME-OUT                   TO  TIMEO.
  2610     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2611     MOVE PI-PROCESSOR-ID        TO USERIDO
  2612
  2613* EXEC CICS SEND
  2614*        MAP      (WS-MAP-NAME)
  2615*        MAPSET   (MAPSET-NAME)
  2616*        FROM     (EL104ZO)
  2617*        DATAONLY
  2618*        CURSOR
  2619*    END-EXEC.
  2620     MOVE LENGTH OF
  2621      EL104ZO
  2622       TO DFHEIV12
  2623     MOVE -1
  2624       TO DFHEIV11
  2625*    MOVE '8$D    CT       H L F ,   #00002374' TO DFHEIV0
  2626     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2627     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2628     MOVE X'2020233030303032333734' TO DFHEIV0(25:11)
  2629     CALL 'kxdfhei1' USING DFHEIV0,
  2630           WS-MAP-NAME,
  2631           EL104ZO,
  2632           DFHEIV12,
  2633           MAPSET-NAME,
  2634           DFHEIV99,
  2635           DFHEIV99,
  2636           DFHEIV99,
  2637           DFHEIV11,
  2638           DFHEIV99,
  2639           DFHEIV99,
  2640           DFHEIV99
  2641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  49
* EL1041.cbl
  2642
  2643     GO TO 9100-RETURN-TRAN
  2644     .
  2645 8300-SEND-TEXT.
  2646
  2647* EXEC CICS SEND TEXT
  2648*        FROM  (LOGOFF-TEXT)
  2649*        LENGTH(LOGOFF-LENGTH)
  2650*        ERASE
  2651*        FREEKB
  2652*    END-EXEC.
  2653*    MOVE '8&      T  E F  H   F -   #00002384' TO DFHEIV0
  2654     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2655     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2656     MOVE X'2020233030303032333834' TO DFHEIV0(25:11)
  2657     CALL 'kxdfhei1' USING DFHEIV0,
  2658           LOGOFF-TEXT,
  2659           LOGOFF-LENGTH,
  2660           DFHEIV99,
  2661           DFHEIV99,
  2662           DFHEIV99,
  2663           DFHEIV99,
  2664           DFHEIV99,
  2665           DFHEIV99,
  2666           DFHEIV99,
  2667           DFHEIV99,
  2668           DFHEIV99,
  2669           DFHEIV99
  2670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2671
  2672
  2673* EXEC CICS RETURN
  2674*        END-EXEC.
  2675*    MOVE '.(                    ''   #00002390' TO DFHEIV0
  2676     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2678     MOVE X'2020233030303032333930' TO DFHEIV0(25:11)
  2679     CALL 'kxdfhei1' USING DFHEIV0,
  2680           DFHEIV99,
  2681           DFHEIV99,
  2682           DFHEIV99,
  2683           DFHEIV99,
  2684           DFHEIV99,
  2685           DFHEIV99
  2686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2687
  2688     .
  2689 8500-DEEDIT.
  2690     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2691                                 TO WS-9V999-OF-DEEDIT
  2692     .
  2693 8500-EXIT.
  2694     EXIT.
  2695 8600-DEEDIT.
  2696     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2697                                 TO WS-NUMVAL-OF-DEEDIT
  2698     .
  2699 8600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  50
* EL1041.cbl
  2700     EXIT.
  2701 8800-UNAUTHORIZED-ACCESS.
  2702     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2703     GO TO 8300-SEND-TEXT.
  2704 8810-PF23.
  2705     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2706     MOVE XCTL-005                   TO  PGM-NAME.
  2707     GO TO 9300-XCTL.
  2708 8850-DUPREC.
  2709     MOVE ER-0132                    TO  EMI-ERROR.
  2710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2711     MOVE -1                         TO  MAINTL
  2712     MOVE AL-UABON                   TO  ZLETRA
  2713     GO TO 8100-SEND-INITIAL-MAP.
  2714 8870-NOTOPEN.
  2715     MOVE LOW-VALUES                 TO  EL104ZO.
  2716     MOVE -1                         TO  MAINTL.
  2717     MOVE ER-0701                    TO  EMI-ERROR.
  2718     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2719     GO TO 8100-SEND-INITIAL-MAP.
  2720 8880-NOT-FOUND.
  2721     MOVE ER-0702                    TO  EMI-ERROR.
  2722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2723     MOVE -1                         TO  MAINTL
  2724     MOVE AL-UABON                   TO  ZLETRA
  2725     GO TO 8100-SEND-INITIAL-MAP.
  2726     .
  2727 9100-RETURN-TRAN.
  2728     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2729
  2730* EXEC CICS RETURN
  2731*        TRANSID    (TRANS-ID)
  2732*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2733*        LENGTH     (PI-COMM-LENGTH)
  2734*    END-EXEC.
  2735*    MOVE '.(CT                  ''   #00002433' TO DFHEIV0
  2736     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2737     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2738     MOVE X'2020233030303032343333' TO DFHEIV0(25:11)
  2739     CALL 'kxdfhei1' USING DFHEIV0,
  2740           TRANS-ID,
  2741           PROGRAM-INTERFACE-BLOCK,
  2742           PI-COMM-LENGTH,
  2743           DFHEIV99,
  2744           DFHEIV99,
  2745           DFHEIV99
  2746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2747
  2748 9200-RETURN-MAIN-MENU.
  2749     MOVE XCTL-626                   TO  PGM-NAME.
  2750     GO TO 9300-XCTL.
  2751 9300-XCTL.
  2752
  2753* EXEC CICS XCTL
  2754*        PROGRAM    (PGM-NAME)
  2755*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2756*        LENGTH     (PI-COMM-LENGTH)
  2757*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  51
* EL1041.cbl
  2758*    MOVE '.$C                   %   #00002442' TO DFHEIV0
  2759     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2760     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2761     MOVE X'2020233030303032343432' TO DFHEIV0(25:11)
  2762     CALL 'kxdfhei1' USING DFHEIV0,
  2763           PGM-NAME,
  2764           PROGRAM-INTERFACE-BLOCK,
  2765           PI-COMM-LENGTH,
  2766           DFHEIV99
  2767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2768
  2769 9400-CLEAR.
  2770     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2771     GO TO 9300-XCTL.
  2772 9500-PF12.
  2773     MOVE XCTL-010                   TO  PGM-NAME.
  2774     GO TO 9300-XCTL.
  2775 9600-PGMID-ERROR.
  2776
  2777* EXEC CICS HANDLE CONDITION
  2778*        PGMIDERR   (8300-SEND-TEXT)
  2779*    END-EXEC.
  2780*    MOVE '"$L                   ! # #00002454' TO DFHEIV0
  2781     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2783     MOVE X'2320233030303032343534' TO DFHEIV0(25:11)
  2784     CALL 'kxdfhei1' USING DFHEIV0
  2785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2786
  2787     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2788     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2789     MOVE XCTL-005                   TO  PGM-NAME.
  2790     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2791     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2792     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  52
* EL1041.cbl
  2794 9700-LINK-DATE-CONVERT.
  2795
  2796* EXEC CICS LINK
  2797*        PROGRAM    ('ELDATCV')
  2798*        COMMAREA   (DATE-CONVERSION-DATA)
  2799*        LENGTH     (DC-COMM-LENGTH)
  2800*    END-EXEC.
  2801     MOVE 'ELDATCV' TO DFHEIV1
  2802*    MOVE '."C                   (   #00002465' TO DFHEIV0
  2803     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2805     MOVE X'2020233030303032343635' TO DFHEIV0(25:11)
  2806     CALL 'kxdfhei1' USING DFHEIV0,
  2807           DFHEIV1,
  2808           DATE-CONVERSION-DATA,
  2809           DC-COMM-LENGTH,
  2810           DFHEIV99,
  2811           DFHEIV99,
  2812           DFHEIV99,
  2813           DFHEIV99
  2814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2815
  2816 9700-EXIT.
  2817     EXIT.
  2818 9900-ERROR-FORMAT.
  2819     IF NOT EMI-ERRORS-COMPLETE
  2820         MOVE LINK-001               TO  PGM-NAME
  2821
  2822* EXEC CICS LINK
  2823*            PROGRAM    (PGM-NAME)
  2824*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2825*            LENGTH     (EMI-COMM-LENGTH)
  2826*        END-EXEC.
  2827*    MOVE '."C                   (   #00002475' TO DFHEIV0
  2828     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2830     MOVE X'2020233030303032343735' TO DFHEIV0(25:11)
  2831     CALL 'kxdfhei1' USING DFHEIV0,
  2832           PGM-NAME,
  2833           ERROR-MESSAGE-INTERFACE-BLOCK,
  2834           EMI-COMM-LENGTH,
  2835           DFHEIV99,
  2836           DFHEIV99,
  2837           DFHEIV99,
  2838           DFHEIV99
  2839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2840
  2841 9900-EXIT.
  2842     EXIT.
  2843 9990-ABEND.
  2844     MOVE LINK-004                   TO  PGM-NAME.
  2845     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2846
  2847* EXEC CICS LINK
  2848*        PROGRAM   (PGM-NAME)
  2849*        COMMAREA  (EMI-LINE1)
  2850*        LENGTH    (72)
  2851*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  53
* EL1041.cbl
  2852     MOVE 72
  2853       TO DFHEIV11
  2854*    MOVE '."C                   (   #00002485' TO DFHEIV0
  2855     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2857     MOVE X'2020233030303032343835' TO DFHEIV0(25:11)
  2858     CALL 'kxdfhei1' USING DFHEIV0,
  2859           PGM-NAME,
  2860           EMI-LINE1,
  2861           DFHEIV11,
  2862           DFHEIV99,
  2863           DFHEIV99,
  2864           DFHEIV99,
  2865           DFHEIV99
  2866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2867
  2868     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  54
* EL1041.cbl
  2870 9995-SECURITY-VIOLATION.
  2871*                            COPY ELCSCTP.
  2872******************************************************************
  2873*                                                                *
  2874*                            ELCSCTP                             *
  2875*                            VMOD=2.001                          *
  2876*                                                                *
  2877*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2878******************************************************************
  2879
  2880
  2881     MOVE EIBDATE          TO SM-JUL-DATE.
  2882     MOVE EIBTRMID         TO SM-TERMID.
  2883     MOVE THIS-PGM         TO SM-PGM.
  2884     MOVE EIBTIME          TO TIME-IN.
  2885     MOVE TIME-OUT         TO SM-TIME.
  2886     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2887
  2888
  2889* EXEC CICS LINK
  2890*         PROGRAM  ('EL003')
  2891*         COMMAREA (SECURITY-MESSAGE)
  2892*         LENGTH   (80)
  2893*    END-EXEC.
  2894     MOVE 'EL003' TO DFHEIV1
  2895     MOVE 80
  2896       TO DFHEIV11
  2897*    MOVE '."C                   (   #00002510' TO DFHEIV0
  2898     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2900     MOVE X'2020233030303032353130' TO DFHEIV0(25:11)
  2901     CALL 'kxdfhei1' USING DFHEIV0,
  2902           DFHEIV1,
  2903           SECURITY-MESSAGE,
  2904           DFHEIV11,
  2905           DFHEIV99,
  2906           DFHEIV99,
  2907           DFHEIV99,
  2908           DFHEIV99
  2909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2910
  2911
  2912******************************************************************
  2913
  2914 9995-EXIT.
  2915     EXIT.
  2916
  2917 9999-DFHBACK SECTION.
  2918     MOVE '9%                    "   ' TO DFHEIV0
  2919     MOVE 'EL1041' TO DFHEIV1
  2920     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2921     GOBACK.
  2922 9999-DFHEXIT.
  2923     IF DFHEIGDJ EQUAL 0001
  2924         NEXT SENTENCE
  2925     ELSE IF DFHEIGDJ EQUAL 2
  2926         GO TO 8850-DUPREC,
  2927               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 25-Nov-13 09:14 Page  55
* EL1041.cbl
  2928               8880-NOT-FOUND,
  2929               9600-PGMID-ERROR,
  2930               9990-ABEND
  2931         DEPENDING ON DFHEIGDI
  2932     ELSE IF DFHEIGDJ EQUAL 3
  2933         GO TO 8300-SEND-TEXT
  2934         DEPENDING ON DFHEIGDI.
  2935     MOVE '9%                    "   ' TO DFHEIV0
  2936     MOVE 'EL1041' TO DFHEIV1
  2937     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2938     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4940     Code:        7996
