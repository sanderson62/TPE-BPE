* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* SOCK00.cbl
* Options: int("SOCK00.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK00.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK00.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK00.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* SOCK00.cbl
    14*-----------------------------------------------------------------
    15* 091609  CR2009082400002  PEMA  ADD USER SELECT 3
    16* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
    17* 042612  CR2012042500004  PEMA  ADD CODE TO HANDLE AHL
    18*-----------------------------------------------------------------
    19 identification division.
    20 program-id. SOCK00.
    21*         This program is the first invoked by the SOCK
    22*         transaction. This transaction must be submited
    23*         by a message transmited over a stream socket.
    24*         The first message format is:
    25*         aaaa,bbbbb              ccc
    26*         where "aaaa" is the tran id SOCK (1 to 4 characters)
    27*         and "bbbbb is either "RATE " or "STATE" and ccc is eithe
    28*         DCC or CID or any future company id
    29*         Information on the originating message and
    30*         remote socket is provided in the DFHCOMMAREA.
    31*         As its first action this program must send a
    32*         message to the requesting socket. This lets the
    33*         remote program know its request has been
    34*         accepted and the transaction started.
    35*         The program will make four transmissions to
    36*         the initating program in response to received
    37*         messages and then close the socket.
    38*         This program is provided to show method and
    39*         has minimal checking and error messages.
    40*         The Cobol compiler, unless instructed otherwise,
    41*         will hold its working storage integer data items in
    42*         machine idependent form. This matches the network
    43*         ordering of information. Care should be exercised
    44*         to ensure that this data ordering is correct when
    45*         calling system library functions or passing data
    46*         structure containing such data to functions.
    47 environment division.
    48 data division.
    49 working-storage section.
    50 01  DFH-START PIC X(04).
    51*
    52* program buffers
    53*
    54 77 ws-send-msg-size           pic s9(8) comp value 4096.
    55 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    56 77 ws-recv-buf                pic x(4096).
    57 77 ws-send-buf                pic x(4096) VALUE SPACES.
    58 77 ws-recv-total              pic s9(8) comp value 0.
    59 77 ws-recv-left               pic s9(8) comp value 0.
    60 77 ws-seq-num                 pic s9(8) comp value 0.
    61 77 ws-flags                   pic s9(8) comp value 0.
    62 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    63 77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
    64 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    65 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    66 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    67 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    68 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    69 77 S1                           PIC S999 COMP-3 VALUE +0.
    70 77 S2                           PIC S999 COMP-3 VALUE +0.
    71 77 WS-BUILD-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* SOCK00.cbl
    72    88  TIME-TO-BUILD               VALUE 'Y'.
    73 77 WS-SAVE-ERACCT               PIC X(2000).
    74 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    75 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    76    88  GET-RATES                    VALUE 'R'.
    77    88  GET-ACT-ACCTS                VALUE 'A'.
    78 77 ws-bin-eff-dt                pic xx  value low-values.
    79 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    80 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    81 77 ws-disp-rate                 pic z9.99999.
    82 77  WS-ERACCT-SW                PIC X VALUE ' '.
    83     88  END-OF-ERACCT                 VALUE 'Y'.
    84 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    85     88  END-OF-ERCTBL                 VALUE 'Y'.
    86 77  WS-STATUS                   PIC X.
    87 01  ws-work-date.
    88     05  ws-work-ccyy            pic x(4).
    89     05  ws-work-mm              pic xx.
    90     05  ws-work-dd              pic xx.
    91 01  ws-work-date-num redefines ws-work-date
    92                                 pic 9(8).
    93 01  WS-AM-CITY-STATE            PIC X(30) VALUE SPACES.
    94 01  ws-work-apr.
    95     05  ws-apr-num              pic 99V999.
    96 01  ws-work-ben.
    97     05  ws-ben-num              pic 9(5).
    98 01  ws-work-term.
    99     05  ws-term-num             pic 999.
   100 01  ws-get-rate-data.
   101     05  rate-state              pic xx.
   102     05  rate-lf-ah              pic x.
   103     05  rate-ben-code           pic xx.
   104     05  rate-earn-meth          pic x.
   105     05  rate-ben-amt            pic x(5).
   106     05  rate-eff-date           pic x(10).
   107     05  rate-term               pic xxx.
   108     05  rate-apr                pic x(5).
   109 01  WS-FIN-RESP                 PIC X(10).
   110 01  WS-GA-DATA.
   111     05  WS-GA-NUM               PIC X(10).
   112     05  WS-GA-PRIMARY-CONTACT   PIC X(30).
   113     05  WS-GA-NAME              PIC X(30).
   114     05  WS-GA-MAIL-NAME         PIC X(30).
   115     05  WS-GA-ADDR1             PIC X(30).
   116     05  WS-GA-ADDR2             PIC X(30).
   117     05  WS-GA-ADDR3             PIC X(30).
   118     05  WS-GA-ZIP               PIC X(9).
   119     05  WS-GA-PHONE             PIC X(10).
   120 01  WS-AM-KEY.
   121     05  WS-AM-COMPANY-CD        PIC X.
   122     05  WS-AM-CARRIER           PIC X.
   123     05  WS-AM-GROUP             PIC X(6).
   124     05  WS-AM-STATE             PIC XX.
   125     05  WS-AM-ACCOUNT           PIC X(10).
   126     05  WS-AM-EXP-DT            PIC XX.
   127     05  FILLER                  PIC X(4).
   128 01  WS-NT-KEY.
   129     05  WS-NT-COMPANY-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* SOCK00.cbl
   130     05  WS-NT-CARRIER           PIC X.
   131     05  WS-NT-GROUP             PIC X(6).
   132     05  WS-NT-STATE             PIC XX.
   133     05  WS-NT-ACCOUNT           PIC X(10).
   134     05  WS-NT-REC-TYPE          PIC X.
   135     05  WS-NT-SEQ-NO            PIC S9(4) COMP.
   136 01  WS-AM-ALT-KEY.
   137     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   138     05  WS-AM-ALT-EXP-DT        PIC XX.
   139 01  WS-CT-KEY-SAVE              PIC X(5).
   140 01  WS-CT-KEY.
   141     05  WS-CT-COMPANY-CD        PIC X.
   142     05  WS-CT-TABLE             PIC XXX.
   143     05  WS-CT-BEN-TYPE          PIC X.
   144     05  WS-CT-BEN-CODE          PIC XX.
   145 01  WS-CF-KEY-SAVE              PIC X(10).
   146 01  WS-CF-KEY.
   147     05  WS-CF-COMPANY-ID        PIC XXX.
   148     05  WS-CF-RECORD-TYPE       PIC X.
   149     05  WS-CF-ACCESS            PIC X(4).
   150     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   151 01  WS-CO-KEY.
   152     05  WS-CO-COMPANY-CD        PIC X.
   153     05  WS-CO-CARRIER           PIC X.
   154     05  WS-CO-GROUP             PIC X(6).
   155     05  WS-CO-FIN-RESP          PIC X(10).
   156     05  WS-CO-ACCOUNT           PIC X(10).
   157     05  WS-CO-TYPE              PIC X.
   158 01  WS-WORK-SAH-COMM            PIC SV9(5) VALUE +0.
   159 01  WS-WORK-JAH-COMM            PIC SV9(5) VALUE +0.
   160 01  WS-POLICY-NO                PIC X(6).
   161 01  WS-SHORT-ACCT-NAME          PIC X(30).
   162 01  WS-LONG-ACCT-NAME           PIC X(60).
   163 01  WS-CONTR-NAME               PIC X(60).
   164 01  WS-SL-COMM                  PIC 9.99999.
   165 01  WS-JL-COMM                  PIC 9.99999.
   166 01  WS-SAH-COMM                 PIC 9.99999.
   167 01  WS-JAH-COMM                 PIC 9.99999.
   168 01  WS-CID-NO                   PIC X(8).
   169 01  WS-DISP-RESP                PIC 9(5).
   170 01  WS-RESPONSE                 PIC S9(8)   COMP.
   171     88  RESP-NORMAL                  VALUE +00.
   172     88  RESP-NOTFND                  VALUE +13.
   173     88  RESP-NOTOPEN                 VALUE +19.
   174     88  RESP-ENDFILE                 VALUE +20.
   175*                                 COPY ERCACNT.
   176******************************************************************
   177*                                                                *
   178*                                                                *
   179*                            ERCACNT.                            *
   180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   181*                            VMOD=2.002                          *
   182*                                                                *
   183*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
   184*                                                                *
   185*   FILE TYPE = VSAM,KSDS                                        *
   186*   RECORD SIZE = 120   RECFORM = FIXED                          *
   187*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* SOCK00.cbl
   188*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
   189*       ALTERNATE INDEX = NONE                                   *
   190*                                                                *
   191*                                                                *
   192*   LOG = YES                                                    *
   193*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   194******************************************************************
   195*                   C H A N G E   L O G
   196*
   197* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   198*-----------------------------------------------------------------
   199*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   200* EFFECTIVE    NUMBER
   201*-----------------------------------------------------------------
   202* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
   203*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
   204******************************************************************
   205 01  NOTE-FILE.
   206     12  NT-FILE-ID                  PIC XX.
   207         88  VALID-NOTE-ID              VALUE 'NT'.
   208
   209     12  NT-CONTROL-PRIMARY.
   210         16  NT-COMPANY-CD           PIC X.
   211         16  NT-ACCT-NOTE-KEY.
   212             18  NT-CARRIER              PIC X.
   213             18  NT-GROUPING             PIC X(06).
   214             18  NT-STATE                PIC XX.
   215             18  NT-ACCOUNT              PIC X(10).
   216         16  NT-RECORD-TYPE          PIC X.
   217              88  ACCT-NOTE          VALUE '1'.
   218              88  ACCT-BRANCH-LOC    VALUE '2'.
   219              88  ACCT-SHIPPING-ADDR VALUE '3'.
   220         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
   221
   222     12  NT-LAST-MAINT-DT            PIC XX.
   223     12  NT-LAST-MAINT-BY            PIC X(4).
   224     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
   225
   226*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
   227*     SEQUENCE NUMBERS
   228     12  NT-NOTE-INFORMATION.
   229         16  NT-NOTE-LINE            PIC X(60).
   230         16  FILLER                  PIC X(25).
   231*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
   232     12  NT-LOCATION-INFORMATION REDEFINES
   233                         NT-NOTE-INFORMATION.
   234         16  NT-BRANCH-LOC-LINE      PIC X(60).
   235         16  FILLER                  PIC X(25).
   236*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
   237*     SEQUENCE NUMBER 1 IS NAME LINE 1
   238*     SEQUENCE NUMBER 2 IS NAME LINE 2
   239*     SEQUENCE NUMBER 3 IS ADDR LINE 1
   240*     SEQUENCE NUMBER 4 IS ADDR LINE 2
   241*     SEQUENCE NUMBER 5 IS ADDR LINE 3
   242*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
   243     12  NT-SHIPPING-INFORMATION REDEFINES
   244                         NT-NOTE-INFORMATION.
   245         16  NT-SHIPPING-LINE        PIC X(60).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* SOCK00.cbl
   246         16  NT-SHIP-STATE           PIC XX.
   247         16  NT-SHIP-ZIP             PIC X(10).
   248         16  FILLER                  PIC X(13).
   249*****************************************************************
   250*                                 COPY ERCACCT.
   251******************************************************************
   252*                                                                *
   253*                                                                *
   254*                            ERCACCT                             *
   255*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   256*                            VMOD=2.031                          *
   257*                                                                *
   258*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   259*                                                                *
   260*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   261*   VSAM ACCOUNT MASTER FILES.                                   *
   262*                                                                *
   263*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   264*                                                                *
   265*   FILE TYPE = VSAM,KSDS                                        *
   266*   RECORD SIZE = 2000  RECFORM = FIX                            *
   267*                                                                *
   268*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   269*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   270*                                                                *
   271*   LOG = NO                                                     *
   272*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   273*                                                                *
   274*                                                                *
   275******************************************************************
   276*                   C H A N G E   L O G
   277*
   278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   279*-----------------------------------------------------------------
   280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   281* EFFECTIVE    NUMBER
   282*-----------------------------------------------------------------
   283* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   284* 092705    2005050300006  PEMA  ADD SPP LEASES
   285* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   286* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   287* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   288* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   289* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   290******************************************************************
   291
   292 01  ACCOUNT-MASTER.
   293     12  AM-RECORD-ID                      PIC XX.
   294         88  VALID-AM-ID                      VALUE 'AM'.
   295
   296     12  AM-CONTROL-PRIMARY.
   297         16  AM-COMPANY-CD                 PIC X.
   298         16  AM-MSTR-CNTRL.
   299             20  AM-CONTROL-A.
   300                 24  AM-CARRIER            PIC X.
   301                 24  AM-GROUPING.
   302                     28 AM-GROUPING-PREFIX PIC XXX.
   303                     28 AM-GROUPING-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* SOCK00.cbl
   304                 24  AM-STATE              PIC XX.
   305                 24  AM-ACCOUNT.
   306                     28  AM-ACCOUNT-PREFIX PIC X(4).
   307                     28  AM-ACCOUNT-PRIME  PIC X(6).
   308             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   309                                           PIC X(19).
   310             20  AM-CNTRL-B.
   311                 24  AM-EXPIRATION-DT      PIC XX.
   312                 24  FILLER                PIC X(4).
   313             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   314                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   315
   316     12  AM-CONTROL-BY-VAR-GRP.
   317         16  AM-COMPANY-CD-A1              PIC X.
   318         16  AM-VG-CARRIER                 PIC X.
   319         16  AM-VG-GROUPING                PIC X(6).
   320         16  AM-VG-STATE                   PIC XX.
   321         16  AM-VG-ACCOUNT                 PIC X(10).
   322         16  AM-VG-DATE.
   323             20  AM-VG-EXPIRATION-DT       PIC XX.
   324             20  FILLER                    PIC X(4).
   325         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   326                                           PIC 9(11)      COMP-3.
   327     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   328         16  FILLER                        PIC X(10).
   329         16  AM-VG-KEY3.
   330             20  AM-VG3-ACCOUNT            PIC X(10).
   331             20  AM-VG3-EXP-DT             PIC XX.
   332         16  FILLER                        PIC X(4).
   333     12  AM-MAINT-INFORMATION.
   334         16  AM-LAST-MAINT-DT              PIC XX.
   335         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   336         16  AM-LAST-MAINT-USER            PIC X(4).
   337         16  FILLER                        PIC XX.
   338
   339     12  AM-EFFECTIVE-DT                   PIC XX.
   340     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   341
   342     12  AM-PREV-DATES  COMP-3.
   343         16  AM-PREV-EXP-DT                PIC 9(11).
   344         16  AM-PREV-EFF-DT                PIC 9(11).
   345
   346     12  AM-REPORT-CODE-1                  PIC X(10).
   347     12  AM-REPORT-CODE-2                  PIC X(10).
   348
   349     12  AM-CITY-CODE                      PIC X(4).
   350     12  AM-COUNTY-PARISH                  PIC X(6).
   351
   352     12  AM-NAME                           PIC X(30).
   353     12  AM-PERSON                         PIC X(30).
   354     12  AM-ADDRS                          PIC X(30).
   355     12  AM-CITY.
   356         16  AM-ADDR-CITY                  PIC X(28).
   357         16  AM-ADDR-STATE                 PIC XX.
   358     12  AM-ZIP.
   359         16  AM-ZIP-PRIME.
   360             20  AM-ZIP-PRI-1ST            PIC X.
   361                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* SOCK00.cbl
   362             20  FILLER                    PIC X(4).
   363         16  AM-ZIP-PLUS4                  PIC X(4).
   364     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   365         16  AM-CAN-POSTAL-1               PIC XXX.
   366         16  AM-CAN-POSTAL-2               PIC XXX.
   367         16  FILLER                        PIC XXX.
   368     12  AM-TEL-NO.
   369         16  AM-AREA-CODE                  PIC 999.
   370         16  AM-TEL-PRE                    PIC 999.
   371         16  AM-TEL-NBR                    PIC 9(4).
   372     12  AM-TEL-LOC                        PIC X.
   373         88  AM-TEL-AT-HOME                   VALUE 'H'.
   374         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   375
   376     12  AM-COMM-STRUCTURE.
   377         16  AM-DEFN-1.
   378             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   379                 24  AM-AGT.
   380                     28  AM-AGT-PREFIX     PIC X(4).
   381                     28  AM-AGT-PRIME      PIC X(6).
   382                 24  AM-COM-TYP            PIC X.
   383                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   384                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   385                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   386                 24  AM-RECALC-LV-INDIC    PIC X.
   387                 24  AM-RETRO-LV-INDIC     PIC X.
   388                 24  AM-GL-CODES           PIC X.
   389                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   390                 24  FILLER                PIC X(01).
   391         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   392             20  AM-COM-TBLS        OCCURS 10 TIMES.
   393                 24  FILLER                PIC X(11).
   394                 24  AM-L-COMA             PIC XXX.
   395                 24  AM-J-COMA             PIC XXX.
   396                 24  AM-A-COMA             PIC XXX.
   397                 24  FILLER                PIC X(6).
   398
   399     12  AM-COMM-CHANGE-STATUS             PIC X.
   400         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   401
   402     12  AM-CSR-CODE                       PIC X(4).
   403
   404     12  AM-BILLING-STATUS                 PIC X.
   405         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   406         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   407     12  AM-AUTO-REFUND-SW                 PIC X.
   408         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   409         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   410     12  AM-GPCD                           PIC 99.
   411     12  AM-IG                             PIC X.
   412         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   413         88  AM-HAS-GROUP                     VALUE '2'.
   414     12  AM-STATUS                         PIC X.
   415         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   416         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   417         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   418         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   419         88  AM-ACCOUNT-FROZEN                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* SOCK00.cbl
   420         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   421     12  AM-REMIT-TO                       PIC 99.
   422     12  AM-ID-NO                          PIC X(11).
   423
   424     12  AM-CAL-TABLE                      PIC XX.
   425     12  AM-LF-DEVIATION                   PIC XXX.
   426     12  AM-AH-DEVIATION                   PIC XXX.
   427     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   428     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   429     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   430     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   431     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   432     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   433
   434     12  AM-USER-FIELDS.
   435         16  AM-FLD-1                      PIC XX.
   436         16  AM-FLD-2                      PIC XX.
   437         16  AM-FLD-3                      PIC XX.
   438         16  AM-FLD-4                      PIC XX.
   439         16  AM-FLD-5                      PIC XX.
   440
   441     12  AM-1ST-PROD-DATE.
   442         16  AM-1ST-PROD-YR                PIC XX.
   443         16  AM-1ST-PROD-MO                PIC XX.
   444         16  AM-1ST-PROD-DA                PIC XX.
   445     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   446     12  AM-CERTS-PURGED-DATE.
   447         16  AM-PUR-YR                     PIC XX.
   448         16  AM-PUR-MO                     PIC XX.
   449         16  AM-PUR-DA                     PIC XX.
   450     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   451     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   452     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   453     12  AM-INACTIVE-DATE.
   454         16  AM-INA-MO                     PIC 99.
   455         16  AM-INA-DA                     PIC 99.
   456         16  AM-INA-YR                     PIC 99.
   457     12  AM-AR-HI-CERT-DATE                PIC XX.
   458
   459     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   460     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   461
   462     12  AM-OB-PAYMENT-MODE                PIC X.
   463         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   464         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   465         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   466         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   467
   468     12  AM-AH-ONLY-INDICATOR              PIC X.
   469         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   470         88  AM-NO-AH-ONLY                    VALUE 'N'.
   471
   472     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   473
   474     12  AM-OVER-SHORT.
   475         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   476         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   477
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* SOCK00.cbl
   478     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   479     12  AM-DCC-CLP-STATE                  PIC XX.
   480
   481     12  AM-RECALC-COMM                    PIC X.
   482     12  AM-RECALC-REIN                    PIC X.
   483
   484     12  AM-REI-TABLE                      PIC XXX.
   485     12  AM-REI-ET-LF                      PIC X.
   486     12  AM-REI-ET-AH                      PIC X.
   487     12  AM-REI-PE-LF                      PIC X.
   488     12  AM-REI-PE-AH                      PIC X.
   489     12  AM-REI-PRT-ST                     PIC X.
   490     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   491     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   492     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   493     12  AM-REI-GROUP-A                    PIC X(6).
   494     12  AM-REI-MORT                       PIC X(4).
   495     12  AM-REI-PRT-OW                     PIC X.
   496     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   497     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   498     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   499     12  AM-REI-GROUP-B                    PIC X(6).
   500
   501     12  AM-TRUST-TYPE                     PIC X(2).
   502
   503     12  AM-EMPLOYER-STMT-USED             PIC X.
   504     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   505
   506     12  AM-STD-AH-TYPE                    PIC XX.
   507     12  AM-EARN-METHODS.
   508         16  AM-EARN-METHOD-R              PIC X.
   509             88 AM-REF-RL-R78                 VALUE 'R'.
   510             88 AM-REF-RL-PR                  VALUE 'P'.
   511             88 AM-REF-RL-MEAN                VALUE 'M'.
   512             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   513         16  AM-EARN-METHOD-L              PIC X.
   514             88 AM-REF-LL-R78                 VALUE 'R'.
   515             88 AM-REF-LL-PR                  VALUE 'P'.
   516             88 AM-REF-LL-MEAN                VALUE 'M'.
   517             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   518         16  AM-EARN-METHOD-A              PIC X.
   519             88 AM-REF-AH-R78                 VALUE 'R'.
   520             88 AM-REF-AH-PR                  VALUE 'P'.
   521             88 AM-REF-AH-MEAN                VALUE 'M'.
   522             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   523             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   524             88 AM-REF-AH-NET                 VALUE 'N'.
   525
   526     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   527     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   528     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   529
   530     12  AM-RET-Y-N                        PIC X.
   531     12  AM-RET-P-E                        PIC X.
   532     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   533     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   534     12  AM-RET-GRP                        PIC X(6).
   535     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* SOCK00.cbl
   536         16  AM-POOL-PRIME                 PIC XXX.
   537         16  AM-POOL-SUB                   PIC XXX.
   538     12  AM-RETRO-EARNINGS.
   539         16  AM-RET-EARN-R                 PIC X.
   540         16  AM-RET-EARN-L                 PIC X.
   541         16  AM-RET-EARN-A                 PIC X.
   542     12  AM-RET-ST-TAX-USE                 PIC X.
   543         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   544         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   545     12  AM-RETRO-BEG-EARNINGS.
   546         16  AM-RET-BEG-EARN-R             PIC X.
   547         16  AM-RET-BEG-EARN-L             PIC X.
   548         16  AM-RET-BEG-EARN-A             PIC X.
   549     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   550     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   551
   552     12  AM-USER-SELECT-OPTIONS.
   553         16  AM-USER-SELECT-1              PIC X(10).
   554         16  AM-USER-SELECT-2              PIC X(10).
   555         16  AM-USER-SELECT-3              PIC X(10).
   556         16  AM-USER-SELECT-4              PIC X(10).
   557         16  AM-USER-SELECT-5              PIC X(10).
   558
   559     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   560
   561     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   562
   563     12  AM-RPT045A-SWITCH                 PIC X.
   564         88  RPT045A-OFF                   VALUE 'N'.
   565
   566     12  AM-INSURANCE-LIMITS.
   567         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   568         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   569
   570     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   571         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   572
   573     12  AM-DISMBR-COVERAGE-SW             PIC X.
   574         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   575         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   576
   577     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   578
   579     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   580     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   581     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   582     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   583     12  AM-DCC-UEF-STATE                  PIC XX.
   584     12  FILLER                            PIC XXX.
   585     12  AM-REPORT-CODE-3                  PIC X(10).
   586*    12  FILLER                            PIC X(22).
   587
   588     12  AM-RESERVE-DATE.
   589         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   590         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   591         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   592
   593     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* SOCK00.cbl
   594     12  AM-NOTIFICATION-TYPES.
   595         16  AM-NOTIF-OF-LETTERS           PIC X.
   596         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   597         16  AM-NOTIF-OF-REPORTS           PIC X.
   598         16  AM-NOTIF-OF-STATUS            PIC X.
   599
   600     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   601         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   602         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   603         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   604         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   605
   606     12  AM-BENEFIT-CONTROLS.
   607         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   608             20  AM-BENEFIT-CODE           PIC XX.
   609             20  AM-BENEFIT-TYPE           PIC X.
   610             20  AM-BENEFIT-REVISION       PIC XXX.
   611             20  AM-BENEFIT-REM-TERM       PIC X.
   612             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   613             20  FILLER                    PIC XX.
   614         16  FILLER                        PIC X(80).
   615
   616     12  AM-TRANSFER-DATA.
   617         16  AM-TRANSFERRED-FROM.
   618             20  AM-TRNFROM-CARRIER        PIC X.
   619             20  AM-TRNFROM-GROUPING.
   620                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   621                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   622             20  AM-TRNFROM-STATE          PIC XX.
   623             20  AM-TRNFROM-ACCOUNT.
   624                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   625                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   626             20  AM-TRNFROM-DTE            PIC XX.
   627         16  AM-TRANSFERRED-TO.
   628             20  AM-TRNTO-CARRIER          PIC X.
   629             20  AM-TRNTO-GROUPING.
   630                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   631                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   632             20  AM-TRNTO-STATE            PIC XX.
   633             20  AM-TRNTO-ACCOUNT.
   634                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   635                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   636             20  AM-TRNTO-DTE              PIC XX.
   637         16  FILLER                        PIC X(10).
   638
   639     12  AM-SAVED-REMIT-TO                 PIC 99.
   640
   641     12  AM-COMM-STRUCTURE-SAVED.
   642         16  AM-DEFN-1-SAVED.
   643             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   644                 24  AM-AGT-SV             PIC X(10).
   645                 24  AM-COM-TYP-SV         PIC X.
   646                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   647                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   648                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   649                 24  AM-RECALC-LV-INDIC-SV PIC X.
   650                 24  FILLER                PIC X.
   651                 24  AM-GL-CODES-SV        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* SOCK00.cbl
   652                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   653                 24  FILLER                PIC X.
   654         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   655             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   656                 24  FILLER                PIC X(11).
   657                 24  AM-L-COMA-SV          PIC XXX.
   658                 24  AM-J-COMA-SV          PIC XXX.
   659                 24  AM-A-COMA-SV          PIC XXX.
   660                 24  FILLER                PIC X(6).
   661
   662     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   663         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   664            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   665            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   666            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   667
   668     12  AM-ORIG-DEALER-NO                 PIC X(10).
   669     12  FILLER                            PIC X(120).
   670
   671     12  AM-ACCOUNT-EXECUTIVE-DATA.
   672         16  AM-CONTROL-NAME               PIC X(30).
   673         16  AM-EXECUTIVE-ONE.
   674             20  AM-EXEC1-NAME             PIC X(15).
   675             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   676                                                          COMP-3.
   677             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   678                                                          COMP-3.
   679         16  AM-EXECUTIVE-TWO.
   680             20  AM-EXEC2-NAME             PIC X(15).
   681             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   682                                                          COMP-3.
   683             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   684                                                          COMP-3.
   685
   686     12  AM-RETRO-ADDITIONAL-DATA.
   687         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   688         16  AM-RETRO-PREM-P-E             PIC X.
   689         16  AM-RETRO-CLMS-P-I             PIC X.
   690         16  AM-RETRO-RET-BRACKET-LF.
   691             20  AM-RETRO-RET-METHOD-LF    PIC X.
   692                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   693                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   694             20  AM-RETRO-RET-BASIS-LF     PIC X.
   695                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   696                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   697             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   698                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   699                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   700         16  AM-RETRO-RET-BRACKET-AH.
   701             20  AM-RETRO-RET-METHOD-AH    PIC X.
   702                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   703                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   704                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   705             20  AM-RETRO-RET-BASIS-AH     PIC X.
   706                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   707                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   708             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   709                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* SOCK00.cbl
   710                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   711
   712     12  AM-COMMENTS.
   713         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   714
   715     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   716         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   717         16  AM-FLI-BILLING-CODE           PIC X.
   718         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   719         16  AM-FLI-UNITED-IDENT           PIC X.
   720         16  AM-FLI-INTEREST-LOST-DATA.
   721             20  AM-FLI-BANK-NO            PIC X(5).
   722             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   723             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   724             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   725         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   726             20  AM-FLI-AGT                PIC X(9).
   727             20  AM-FLI-AGT-COMM-ACC       PIC X.
   728             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   729         16  FILLER                        PIC X(102).
   730
   731     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   732         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   733             20  AM-BENEFIT-DMD-CODE         PIC XX.
   734             20  AM-BENEFIT-DMD-TYPE         PIC X.
   735             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   736             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   737             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   738         16  FILLER                          PIC X(10).
   739******************************************************************
   740*                                 COPY ERCCOMP.
   741******************************************************************
   742*                                                                *
   743*                                                                *
   744*                            ERCCOMP                             *
   745*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   746*                            VMOD=2.019                          *
   747*                                                                *
   748*   ONLINE CREDIT SYSTEM                                         *
   749*                                                                *
   750*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   751*                                                                *
   752*   FILE TYPE = VSAM,KSDS                                        *
   753*   RECORD SIZE = 700   RECFORM = FIXED                          *
   754*                                                                *
   755*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   756*       ALTERNATE PATH = NONE                                    *
   757*                                                                *
   758*   LOG = NO                                                     *
   759*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   760*                                                                *
   761******************************************************************
   762*                   C H A N G E   L O G
   763*
   764* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   765*-----------------------------------------------------------------
   766*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   767* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* SOCK00.cbl
   768*-----------------------------------------------------------------
   769* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   770* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   771* 092205    2005050300006  PEMA  ADD LEASE FEE
   772* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   773* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   774* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   775* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   776* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   777******************************************************************
   778
   779 01  COMPENSATION-MASTER.
   780     12  CO-RECORD-ID                          PIC XX.
   781         88  VALID-CO-ID                          VALUE 'CO'.
   782
   783     12  CO-CONTROL-PRIMARY.
   784         16  CO-COMPANY-CD                     PIC X.
   785         16  CO-CONTROL.
   786             20  CO-CTL-1.
   787                 24  CO-CARR-GROUP.
   788                     28  CO-CARRIER            PIC X.
   789                     28  CO-GROUPING.
   790                         32  CO-GROUP-PREFIX   PIC XXX.
   791                         32  CO-GROUP-PRIME    PIC XXX.
   792                 24  CO-RESP-NO.
   793                     28  CO-RESP-PREFIX        PIC X(4).
   794                     28  CO-RESP-PRIME         PIC X(6).
   795             20  CO-CTL-2.
   796                 24  CO-ACCOUNT.
   797                     28  CO-ACCT-PREFIX        PIC X(4).
   798                     28  CO-ACCT-PRIME         PIC X(6).
   799         16  CO-TYPE                           PIC X.
   800             88  CO-COMPANY-TYPE                  VALUE 'C'.
   801             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   802             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   803
   804     12  CO-MAINT-INFORMATION.
   805         16  CO-LAST-MAINT-DT                  PIC XX.
   806         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   807         16  CO-LAST-MAINT-USER                PIC X(4).
   808     12  FILLER                                PIC XX.
   809     12  CO-STMT-TYPE                          PIC XXX.
   810     12  CO-COMP-TYPE                          PIC X.
   811         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   812     12  CO-STMT-OWNER                         PIC X(4).
   813     12  CO-BALANCE-CONTROL                    PIC X.
   814         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   815         88  CO-NO-BALANCE                        VALUE 'N'.
   816
   817     12  CO-INTERNAL-CONTROL-1                 PIC X.
   818         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   819         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   820         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   821
   822     12  CO-INTERNAL-CONTROL-2                 PIC X.
   823         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   824         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   825
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* SOCK00.cbl
   826     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   827     12  CO-GA-DIRECT-DEP                      PIC X.
   828     12  CO-FUTURE-SPACE                       PIC X.
   829         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   830
   831     12  CO-ACCT-NAME                          PIC X(30).
   832     12  CO-MAIL-NAME                          PIC X(30).
   833     12  CO-ADDR-1                             PIC X(30).
   834     12  CO-ADDR-2                             PIC X(30).
   835     12  CO-ADDR-3.
   836         16  CO-ADDR-CITY                      PIC X(27).
   837         16  CO-ADDR-STATE                     PIC XX.
   838     12  CO-CSO-1099                           PIC X.
   839     12  CO-ZIP.
   840         16  CO-ZIP-PRIME.
   841             20  CO-ZIP-PRI-1ST                PIC X.
   842                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   843             20  FILLER                        PIC X(4).
   844         16  CO-ZIP-PLUS4                      PIC X(4).
   845     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   846         16  CO-CAN-POSTAL-1                   PIC XXX.
   847         16  CO-CAN-POSTAL-2                   PIC XXX.
   848         16  FILLER                            PIC XXX.
   849     12  CO-SOC-SEC                            PIC X(13).
   850     12  CO-TELEPHONE.
   851         16  CO-AREA-CODE                      PIC XXX.
   852         16  CO-PREFIX                         PIC XXX.
   853         16  CO-PHONE                          PIC X(4).
   854
   855     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   856
   857     12  CO-AR-BAL-LEVEL                       PIC X.
   858         88  CO-AR-REF-LVL                        VALUE '1'.
   859         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   860         88  CO-AR-BILL-LVL                       VALUE '2'.
   861         88  CO-AR-AGT-LVL                        VALUE '3'.
   862         88  CO-AR-FR-LVL                         VALUE '4'.
   863
   864     12  CO-AR-NORMAL-PRINT                    PIC X.
   865         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   866         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   867
   868     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   869
   870     12  CO-AR-REPORTING                       PIC X.
   871         88  CO-AR-NET-REPORT                     VALUE 'N'.
   872         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   873
   874     12  CO-AR-PULL-CHECK                      PIC X.
   875         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   876         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   877
   878     12  CO-AR-BALANCE-PRINT                   PIC X.
   879         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   880
   881     12  CO-AR-LAST-RUN-CODE                   PIC X.
   882         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   883         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* SOCK00.cbl
   884         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   885
   886     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   887
   888     12  CO-USER-CODE                          PIC X.
   889     12  CO-REPORT-GROUP-ID                    PIC X(12).
   890
   891******************************************************************
   892*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   893*    THE LAST MONTH END RUN.
   894******************************************************************
   895
   896     12  CO-LAST-ACTIVITY-DATE.
   897         16  CO-ACT-YEAR                       PIC 99.
   898         16  CO-ACT-MONTH                      PIC 99.
   899         16  CO-ACT-DAY                        PIC 99.
   900
   901     12  CO-LAST-STMT-DT.
   902         16  CO-LAST-STMT-YEAR                 PIC 99.
   903         16  CO-LAST-STMT-MONTH                PIC 99.
   904         16  CO-LAST-STMT-DAY                  PIC 99.
   905
   906     12  CO-MO-END-TOTALS.
   907         16  CO-MONTHLY-TOTALS.
   908             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   909             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   910             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   911             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   912             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   913
   914         16  CO-AGING-TOTALS.
   915             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   916             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   917             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   918             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   919
   920         16  CO-YTD-TOTALS.
   921             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   922             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   923
   924         16  CO-OVER-UNDER-TOTALS.
   925             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   926             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   927
   928     12  CO-MISCELLANEOUS-TOTALS.
   929         16  CO-FICA-TOTALS.
   930             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   931             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   932
   933         16  CO-CLAIM-TOTALS.
   934             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   935             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   936
   937******************************************************************
   938*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   939*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   940******************************************************************
   941
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* SOCK00.cbl
   942     12  CO-CURRENT-TOTALS.
   943         16  CO-CURRENT-LAST-STMT-DT.
   944             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   945             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   946             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   947
   948         16  CO-CURRENT-MONTHLY-TOTALS.
   949             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   950             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   951             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   952             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   953             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   954
   955         16  CO-CURRENT-AGING-TOTALS.
   956             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   957             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   958             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   959             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   960
   961         16  CO-CURRENT-YTD-TOTALS.
   962             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   963             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   964
   965     12  CO-PAID-COMM-TOTALS.
   966         16  CO-YTD-PAID-COMMS.
   967             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   968             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   969
   970     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   971         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   972         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   973
   974     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   975         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   976         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   977         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   978         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   979         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   980         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   981         88  CO-FINAL-LETTER                  VALUE 'F'.
   982         88  CO-RECONCILING                   VALUE 'R'.
   983         88  CO-PHONE-CALL                    VALUE 'P'.
   984         88  CO-LEGAL                         VALUE 'L'.
   985         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   986         88  CO-WRITE-OFF                     VALUE 'W'.
   987         88  CO-NO-ACTION                     VALUE 'N' ' '.
   988
   989     12  CO-CSR-CODE                       PIC X(4).
   990
   991     12  CO-GA-STATUS-INFO.
   992         16  CO-GA-EFFECTIVE-DT            PIC XX.
   993         16  CO-GA-TERMINATION-DT          PIC XX.
   994         16  CO-GA-STATUS-CODE             PIC X.
   995             88  CO-GA-ACTIVE                 VALUE 'A'.
   996             88  CO-GA-INACTIVE               VALUE 'I'.
   997             88  CO-GA-PENDING                VALUE 'P'.
   998         16  CO-GA-COMMENTS.
   999             20  CO-GA-COMMENT-1           PIC X(40).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* SOCK00.cbl
  1000             20  CO-GA-COMMENT-2           PIC X(40).
  1001             20  CO-GA-COMMENT-3           PIC X(40).
  1002             20  CO-GA-COMMENT-4           PIC X(40).
  1003
  1004     12  CO-RPTCD2                         PIC X(10).
  1005
  1006     12  CO-TYPE-AGENT                     PIC X(01).
  1007         88  CO-CORPORATION                   VALUE 'C'.
  1008         88  CO-PARTNERSHIP                   VALUE 'P'.
  1009         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1010         88  CO-TRUST                         VALUE 'T'.
  1011         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1012
  1013     12  CO-FAXNO.
  1014         16  CO-FAX-AREA-CODE                  PIC XXX.
  1015         16  CO-FAX-PREFIX                     PIC XXX.
  1016         16  CO-FAX-PHONE                      PIC X(4).
  1017
  1018     12  CO-BANK-INFORMATION.
  1019         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1020         16  CO-BANK-TRANSIT-NON REDEFINES
  1021             CO-BANK-TRANSIT-NO                PIC 9(8).
  1022
  1023         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1024     12  CO-MISC-DEDUCT-INFO REDEFINES
  1025                  CO-BANK-INFORMATION.
  1026         16  CO-MD-GL-ACCT                     PIC X(10).
  1027         16  CO-MD-DIV                         PIC XX.
  1028         16  CO-MD-CENTER                      PIC X(4).
  1029         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1030         16  CO-CREATE-AP-CHECK                PIC X.
  1031         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1032         16  FILLER                            PIC XXX.
  1033     12  CO-ACH-STATUS                         PIC X.
  1034         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1035         88  CO-ACH-PENDING                        VALUE 'P'.
  1036
  1037     12  CO-BILL-SW                            PIC X.
  1038     12  CO-CONTROL-NAME                       PIC X(30).
  1039     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1040     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1041     12  CO-CLP-STATE                          PIC XX.
  1042     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1043     12  CO-SPP-REFUND-EDIT                    PIC X.
  1044
  1045******************************************************************
  1046*                                 COPY ELCCNTL.
  1047******************************************************************
  1048*                                                                *
  1049*                                                                *
  1050*                            ELCCNTL.                            *
  1051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1052*                            VMOD=2.059                          *
  1053*                                                                *
  1054*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1055*                                                                *
  1056*   FILE TYPE = VSAM,KSDS                                        *
  1057*   RECORD SIZE = 750  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* SOCK00.cbl
  1058*                                                                *
  1059*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1060*       ALTERNATE INDEX = NONE                                   *
  1061*                                                                *
  1062*   LOG = YES                                                    *
  1063*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1064******************************************************************
  1065*                   C H A N G E   L O G
  1066*
  1067* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1068*-----------------------------------------------------------------
  1069*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1070* EFFECTIVE    NUMBER
  1071*-----------------------------------------------------------------
  1072* 082503                   PEMA  ADD BENEFIT GROUP
  1073* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1074* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1075* 092705    2005050300006  PEMA  ADD SPP LEASES
  1076* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1077* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1078* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1079* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1080* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1081******************************************************************
  1082*
  1083 01  CONTROL-FILE.
  1084     12  CF-RECORD-ID                       PIC XX.
  1085         88  VALID-CF-ID                        VALUE 'CF'.
  1086
  1087     12  CF-CONTROL-PRIMARY.
  1088         16  CF-COMPANY-ID                  PIC XXX.
  1089         16  CF-RECORD-TYPE                 PIC X.
  1090             88  CF-COMPANY-MASTER              VALUE '1'.
  1091             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1092             88  CF-STATE-MASTER                VALUE '3'.
  1093             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1094             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1095             88  CF-CARRIER-MASTER              VALUE '6'.
  1096             88  CF-MORTALITY-MASTER            VALUE '7'.
  1097             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1098             88  CF-TERMINAL-MASTER             VALUE '9'.
  1099             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1100             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1101             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1102             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1103             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1104             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1105             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1106             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1107             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1108         16  CF-ACCESS-CD-GENL              PIC X(4).
  1109         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1110             20  CF-PROCESSOR               PIC X(4).
  1111         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1112             20  CF-STATE-CODE              PIC XX.
  1113             20  FILLER                     PIC XX.
  1114         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1115             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* SOCK00.cbl
  1116             20  CF-HI-BEN-IN-REC           PIC XX.
  1117         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1118             20  FILLER                     PIC XXX.
  1119             20  CF-CARRIER-CNTL            PIC X.
  1120         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1121             20  FILLER                     PIC XX.
  1122             20  CF-HI-TYPE-IN-REC          PIC 99.
  1123         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1124             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1125                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1126             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1127             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1128         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1129             20  FILLER                     PIC X.
  1130             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1131         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1132             20  FILLER                     PIC XX.
  1133             20  CF-MORTGAGE-PLAN           PIC XX.
  1134         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1135
  1136     12  CF-LAST-MAINT-DT                   PIC XX.
  1137     12  CF-LAST-MAINT-BY                   PIC X(4).
  1138     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1139
  1140     12  CF-RECORD-BODY                     PIC X(728).
  1141
  1142
  1143****************************************************************
  1144*             COMPANY MASTER RECORD                            *
  1145****************************************************************
  1146
  1147     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1148         16  CF-COMPANY-ADDRESS.
  1149             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1150             20  CF-CL-IN-CARE-OF           PIC X(30).
  1151             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1152             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1153             20  CF-CL-CITY-STATE           PIC X(30).
  1154             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1155             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1156         16  CF-COMPANY-CD                  PIC X.
  1157         16  CF-COMPANY-PASSWORD            PIC X(8).
  1158         16  CF-SECURITY-OPTION             PIC X.
  1159             88  ALL-SECURITY                   VALUE '1'.
  1160             88  COMPANY-VERIFY                 VALUE '2'.
  1161             88  PROCESSOR-VERIFY               VALUE '3'.
  1162             88  NO-SECURITY                    VALUE '4'.
  1163             88  ALL-BUT-TERM                   VALUE '5'.
  1164         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1165             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1166         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1167             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1168         16  CF-INFORCE-LOCATION            PIC X.
  1169             88  CERTS-ARE-ONLINE               VALUE '1'.
  1170             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1171             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1172         16  CF-LOWER-CASE-LETTERS          PIC X.
  1173         16  CF-CERT-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* SOCK00.cbl
  1174             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1175             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1176             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1177             88  CF-ACCNT-CNTL                  VALUE '3'.
  1178             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1179
  1180         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1181         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1182
  1183         16  CF-LGX-CREDIT-USER             PIC X.
  1184             88  CO-IS-NOT-USER                 VALUE 'N'.
  1185             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1186
  1187         16 CF-CREDIT-CALC-CODES.
  1188             20  CF-CR-REM-TERM-CALC PIC X.
  1189               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1190               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1191               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1192               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1193               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1194               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1195               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1196             20  CF-CR-R78-METHOD           PIC X.
  1197               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1198               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1199
  1200         16  CF-CLAIM-CONTROL-COUNTS.
  1201             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1202                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1203
  1204             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1205                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1206
  1207             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1208                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1209
  1210             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1211                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1212
  1213         16  CF-CURRENT-MONTH-END           PIC XX.
  1214
  1215         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1216             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1217             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1218             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1219             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1220                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1221                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1222             20  CF-CO-PREM-REJECT-SW       PIC X.
  1223                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1224                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1225             20  CF-CO-REF-REJECT-SW        PIC X.
  1226                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1227                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1228
  1229         16  CF-CO-REPORTING-DT             PIC XX.
  1230         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1231         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* SOCK00.cbl
  1232           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1233           88  CF-CO-MONTH-END                  VALUE '1'.
  1234
  1235         16  CF-LGX-CLAIM-USER              PIC X.
  1236             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1237             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1238
  1239         16  CF-CREDIT-EDIT-CONTROLS.
  1240             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1241             20  CF-MIN-AGE                 PIC 99.
  1242             20  CF-DEFAULT-AGE             PIC 99.
  1243             20  CF-MIN-TERM                PIC S999      COMP-3.
  1244             20  CF-MAX-TERM                PIC S999      COMP-3.
  1245             20  CF-DEFAULT-SEX             PIC X.
  1246             20  CF-JOINT-AGE-INPUT         PIC X.
  1247                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1248             20  CF-BIRTH-DATE-INPUT        PIC X.
  1249                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1250             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1251                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1252                 88  CF-ZERO-CARRIER            VALUE '1'.
  1253                 88  CF-ZERO-GROUPING           VALUE '2'.
  1254                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1255             20  CF-EDIT-SW                 PIC X.
  1256                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1257             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1258             20  CF-CR-PR-METHOD            PIC X.
  1259               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1260               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1261             20  FILLER                     PIC X.
  1262
  1263         16  CF-CREDIT-MISC-CONTROLS.
  1264             20  CF-REIN-TABLE-SW           PIC X.
  1265                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1266             20  CF-COMP-TABLE-SW           PIC X.
  1267                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1268             20  CF-EXPERIENCE-RETENTION-AGE
  1269                                            PIC S9        COMP-3.
  1270             20  CF-CONVERSION-DT           PIC XX.
  1271             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1272             20  CF-RUN-FREQUENCY-SW        PIC X.
  1273                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1274                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1275
  1276             20  CF-CR-CHECK-NO-CONTROL.
  1277                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1278                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1279                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1280                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1281                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1282                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1283
  1284                 24  CF-CR-CHECK-COUNT       REDEFINES
  1285                     CF-CR-CHECK-COUNTER      PIC X(4).
  1286
  1287                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1288                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1289
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* SOCK00.cbl
  1290                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1291                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1292                 24  CF-MAIL-PROCESSING       PIC X.
  1293                     88  MAIL-PROCESSING          VALUE 'Y'.
  1294
  1295         16  CF-MISC-SYSTEM-CONTROL.
  1296             20  CF-SYSTEM-C                 PIC X.
  1297                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1298             20  CF-SYSTEM-D                 PIC X.
  1299                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1300             20  CF-SOC-SEC-NO-SW            PIC X.
  1301                 88  SOC-SEC-NO-USED             VALUE '1'.
  1302             20  CF-MEMBER-NO-SW             PIC X.
  1303                 88  MEMBER-NO-USED              VALUE '1'.
  1304             20  CF-TAX-ID-NUMBER            PIC X(11).
  1305             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1306             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1307                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1308                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1309                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1310                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1311             20  CF-SYSTEM-E                 PIC X.
  1312                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1313
  1314         16  CF-LGX-LIFE-USER               PIC X.
  1315             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1316             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1317
  1318         16  CF-CR-MONTH-END-DT             PIC XX.
  1319
  1320         16  CF-FILE-MAINT-DATES.
  1321             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1322                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1323             20  CF-LAST-BATCH       REDEFINES
  1324                 CF-LAST-BATCH-NO               PIC X(4).
  1325             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1326             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1327             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1328             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1329             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1330             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1331             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1332             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1333             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1334             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1335
  1336         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1337         16  FILLER                         PIC X.
  1338
  1339         16  CF-ALT-MORT-CODE               PIC X(4).
  1340         16  CF-MEMBER-CAPTION              PIC X(10).
  1341
  1342         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1343             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1344             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1345             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1346             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1347             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* SOCK00.cbl
  1348
  1349         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1350
  1351         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1352         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1353         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1354         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1355
  1356         16  CF-AH-OVERRIDE-L1              PIC X.
  1357         16  CF-AH-OVERRIDE-L2              PIC XX.
  1358         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1359         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1360
  1361         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1362         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1363
  1364         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1365         16  CF-AR-LAST-EL860-DT            PIC XX.
  1366         16  CF-MP-MONTH-END-DT             PIC XX.
  1367
  1368         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1369         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1370             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1371
  1372         16  CF-AR-MONTH-END-DT             PIC XX.
  1373
  1374         16  CF-CRDTCRD-USER                PIC X.
  1375             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1376             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1377
  1378         16  CF-CC-MONTH-END-DT             PIC XX.
  1379
  1380         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1381
  1382         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1383             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1384             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1385             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1386         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1387         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1388         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1389         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1390             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1391             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1392         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1393         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1394         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1395             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1396         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1397
  1398         16  CF-CL-ZIP-CODE.
  1399             20  CF-CL-ZIP-PRIME.
  1400                 24  CF-CL-ZIP-1ST          PIC X.
  1401                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1402                 24  FILLER                 PIC X(4).
  1403             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1404         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1405             20  CF-CL-CAN-POSTAL-1         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* SOCK00.cbl
  1406             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1407             20  FILLER                     PIC XXX.
  1408
  1409         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1410         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1411         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1412         16  CF-CO-OPTION-START-DATE        PIC XX.
  1413         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1414           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1415                                                      '3' '4'.
  1416           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1417           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1418           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1419           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1420           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1421           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1422
  1423         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1424
  1425         16  CF-PAYMENT-APPROVAL-LEVELS.
  1426             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1427             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1428             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1429             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1430             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1431             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1432
  1433         16  CF-END-USER-REPORTING-USER     PIC X.
  1434             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1435             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1436
  1437         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1438             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1439             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1440
  1441         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1442
  1443         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1444         16  FILLER                         PIC X.
  1445
  1446         16  CF-CREDIT-ARCHIVE-CNTL.
  1447             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1448             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1449             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1450
  1451         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1452
  1453         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1454             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1455             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1456
  1457         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1458             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1459             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1460
  1461         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1462
  1463         16  CF-CO-ACH-ID-CODE              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* SOCK00.cbl
  1464             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1465             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1466             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1467         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1468         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1469         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1470         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1471         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1472         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1473         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1474         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1475         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1476                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1477         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1478                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1479
  1480         16  CF-CO-OVER-SHORT.
  1481             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1482             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1483
  1484*         16  FILLER                         PIC X(102).
  1485         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1486             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1487             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1488
  1489         16  CF-AH-APPROVAL-DAYS.
  1490             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1491             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1492             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1493             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1494
  1495         16  FILLER                         PIC X(82).
  1496****************************************************************
  1497*             PROCESSOR/USER RECORD                            *
  1498****************************************************************
  1499
  1500     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1501         16  CF-PROCESSOR-NAME              PIC X(30).
  1502         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1503         16  CF-PROCESSOR-TITLE             PIC X(26).
  1504         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1505                 88  MESSAGE-YES                VALUE 'Y'.
  1506                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1507
  1508*****************************************************
  1509****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1510****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1511****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1512****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1513*****************************************************
  1514
  1515         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1516             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1517             20  CF-APPLICATION-FORCE       PIC X.
  1518             20  CF-INDIVIDUAL-APP.
  1519                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1520                     28  CF-BROWSE-APP      PIC X.
  1521                     28  CF-UPDATE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* SOCK00.cbl
  1522
  1523         16  CF-CURRENT-TERM-ON             PIC X(4).
  1524         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1525             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1526             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1527             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1528             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1529             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1530             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1531             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1532         16  CF-PROCESSOR-CARRIER           PIC X.
  1533             88  NO-CARRIER-SECURITY            VALUE ' '.
  1534         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1535             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1536         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1537             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1538         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1539             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1540
  1541         16  CF-PROC-SYS-ACCESS-SW.
  1542             20  CF-PROC-CREDIT-CLAIMS-SW.
  1543                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1544                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1545                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1546                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1547             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1548                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1549                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1550             20  CF-PROC-LIFE-GNRLDGR-SW.
  1551                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1552                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1553                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1554                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1555             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1556                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1557                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1558         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1559             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1560             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1561         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1562
  1563         16  CF-APPROVAL-LEVEL                  PIC X.
  1564             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1565             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1566             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1567             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1568
  1569         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1570
  1571         16  CF-LANGUAGE-TYPE                   PIC X.
  1572             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1573             88  CF-LANG-IS-FR                      VALUE 'F'.
  1574         16  FILLER                             PIC  X(240).
  1575
  1576****************************************************************
  1577*             PROCESSOR/REMINDERS RECORD                       *
  1578****************************************************************
  1579
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* SOCK00.cbl
  1580     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1581         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1582             20  CF-START-REMIND-DT         PIC XX.
  1583             20  CF-END-REMIND-DT           PIC XX.
  1584             20  CF-REMINDER-TEXT           PIC X(50).
  1585         16  FILLER                         PIC X(296).
  1586
  1587
  1588****************************************************************
  1589*             STATE MASTER RECORD                              *
  1590****************************************************************
  1591
  1592     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1593         16  CF-STATE-ABBREVIATION          PIC XX.
  1594         16  CF-STATE-NAME                  PIC X(25).
  1595         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1596         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1597             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1598             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1599             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1600             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1601                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1602                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1603             20  CF-ST-PREM-REJECT-SW       PIC X.
  1604                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1605                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1606             20  CF-ST-REF-REJECT-SW        PIC X.
  1607                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1608                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1609         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1610         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1611         16  CF-ST-REFUND-RULES.
  1612             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1613             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1614             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1615         16  CF-ST-FST-PMT-EXTENSION.
  1616             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1617             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1618                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1619                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1620                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1621                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1622         16  CF-ST-STATE-CALL.
  1623             20  CF-ST-CALL-UNEARNED        PIC X.
  1624             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1625             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1626         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1627             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1628             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1629         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1630         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1631         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1632         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1633         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1634         16  FILLER                         PIC X.
  1635         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1636             20  CF-ST-BENEFIT-CD           PIC XX.
  1637             20  CF-ST-BENEFIT-KIND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* SOCK00.cbl
  1638                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1639                 88  CF-ST-AH-KIND              VALUE 'A'.
  1640             20  CF-ST-REM-TERM-CALC        PIC X.
  1641                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1642                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1643                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1644                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1645                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1646                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1647                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1648                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1649
  1650             20  CF-ST-REFUND-CALC          PIC X.
  1651                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1652                 88  ST-REFD-BY-R78             VALUE '1'.
  1653                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1654                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1655                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1656                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1657                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1658                 88  ST-REFD-UTAH               VALUE '7'.
  1659                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1660                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1661                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1662
  1663             20  CF-ST-EARNING-CALC         PIC X.
  1664                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1665                 88  ST-EARN-BY-R78             VALUE '1'.
  1666                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1667                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1668                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1669                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1670                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1671                 88  ST-EARN-MEAN               VALUE '8'.
  1672                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1673
  1674             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1675                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1676                 88  ST-OVRD-BY-R78             VALUE '1'.
  1677                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1678                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1679                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1680                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1681                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1682                 88  ST-OVRD-MEAN               VALUE '8'.
  1683                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1684             20  FILLER                     PIC X.
  1685
  1686         16  CF-ST-COMMISSION-CAPS.
  1687             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1688             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1689             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1690             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1691         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1692                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1693
  1694         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1695
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* SOCK00.cbl
  1696         16  CF-ST-STATUTORY-INTEREST.
  1697             20  CF-ST-STAT-DATE-FROM       PIC X.
  1698                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1699                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1700             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1701             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1702             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1703             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1704             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1705
  1706         16  CF-ST-OVER-SHORT.
  1707             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1708             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1709
  1710         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1711
  1712         16  CF-ST-RT-CALC                  PIC X.
  1713
  1714         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1715         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1716         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1717         16  CF-ST-RF-LR-CALC               PIC X.
  1718         16  CF-ST-RF-LL-CALC               PIC X.
  1719         16  CF-ST-RF-LN-CALC               PIC X.
  1720         16  CF-ST-RF-AH-CALC               PIC X.
  1721         16  CF-ST-RF-CP-CALC               PIC X.
  1722*        16  FILLER                         PIC X(206).
  1723*CIDMOD         16  FILLER                         PIC X(192).
  1724         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1725             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1726         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1727         16  CF-ST-VFY-2ND-BENE             PIC X.
  1728         16  FILLER                         PIC X(186).
  1729
  1730****************************************************************
  1731*             BENEFIT MASTER RECORD                            *
  1732****************************************************************
  1733
  1734     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1735         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1736             20  CF-BENEFIT-CODE            PIC XX.
  1737             20  CF-BENEFIT-NUMERIC  REDEFINES
  1738                 CF-BENEFIT-CODE            PIC XX.
  1739             20  CF-BENEFIT-ALPHA           PIC XXX.
  1740             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1741             20  CF-BENEFIT-COMMENT         PIC X(10).
  1742
  1743             20  CF-LF-COVERAGE-TYPE        PIC X.
  1744                 88  CF-REDUCING                VALUE 'R'.
  1745                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1746
  1747             20  CF-SPECIAL-CALC-CD         PIC X.
  1748                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1749                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1750                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1751                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1752                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1753                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* SOCK00.cbl
  1754                 88  CF-FARM-PLAN               VALUE 'F'.
  1755                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1756                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1757                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1758                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1759                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1760                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1761                 88  CF-PRUDENTIAL              VALUE 'P'.
  1762                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1763                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1764                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1765                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1766                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1767                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1768
  1769             20  CF-JOINT-INDICATOR         PIC X.
  1770                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1771
  1772*            20  FILLER                     PIC X(12).
  1773             20  FILLER                     PIC X(11).
  1774             20  CF-BENEFIT-CATEGORY        PIC X.
  1775             20  CF-LOAN-TYPE               PIC X(8).
  1776
  1777             20  CF-CO-REM-TERM-CALC        PIC X.
  1778                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1779                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1780                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1781                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1782                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1783
  1784             20  CF-CO-EARNINGS-CALC        PIC X.
  1785                 88  CO-EARN-BY-R78             VALUE '1'.
  1786                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1787                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1788                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1789                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1790                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1791                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1792                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1793
  1794             20  CF-CO-REFUND-CALC          PIC X.
  1795                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1796                 88  CO-REFD-BY-R78             VALUE '1'.
  1797                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1798                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1799                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1800                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1801                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1802                 88  CO-REFD-MEAN               VALUE '8'.
  1803                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1804                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1805                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1806
  1807             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1808                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1809                 88  CO-OVRD-BY-R78             VALUE '1'.
  1810                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1811                 88  CO-OVRD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* SOCK00.cbl
  1812                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1813                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1814                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1815                 88  CO-OVRD-MEAN               VALUE '8'.
  1816                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1817
  1818             20  CF-CO-BEN-I-G-CD           PIC X.
  1819                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1820                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1821                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1822
  1823         16  FILLER                         PIC X(304).
  1824
  1825
  1826****************************************************************
  1827*             CARRIER MASTER RECORD                            *
  1828****************************************************************
  1829
  1830     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1831         16  CF-ADDRESS-DATA.
  1832             20  CF-MAIL-TO-NAME            PIC X(30).
  1833             20  CF-IN-CARE-OF              PIC X(30).
  1834             20  CF-ADDRESS-LINE-1          PIC X(30).
  1835             20  CF-ADDRESS-LINE-2          PIC X(30).
  1836             20  CF-CITY-STATE              PIC X(30).
  1837             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1838             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1839
  1840         16  CF-CLAIM-NO-CONTROL.
  1841             20  CF-CLAIM-NO-METHOD         PIC X.
  1842                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1843                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1844                 88  CLAIM-NO-SEQ               VALUE '3'.
  1845                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1846             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1847                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1848                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1849                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1850
  1851         16  CF-CHECK-NO-CONTROL.
  1852             20  CF-CHECK-NO-METHOD         PIC X.
  1853                 88  CHECK-NO-MANUAL            VALUE '1'.
  1854                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1855                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1856                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1857             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1858                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1859
  1860         16  CF-DOMICILE-STATE              PIC XX.
  1861
  1862         16  CF-EXPENSE-CONTROLS.
  1863             20  CF-EXPENSE-METHOD          PIC X.
  1864                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1865                 88  DOLLARS-PER-PMT            VALUE '2'.
  1866                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1867                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1868             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1869             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* SOCK00.cbl
  1870
  1871         16  CF-CORRESPONDENCE-CONTROL.
  1872             20  CF-LETTER-RESEND-OPT       PIC X.
  1873                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1874                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1875             20  FILLER                     PIC X(4).
  1876
  1877         16  CF-RESERVE-CONTROLS.
  1878             20  CF-MANUAL-SW               PIC X.
  1879                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1880             20  CF-FUTURE-SW               PIC X.
  1881                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1882             20  CF-PTC-SW                  PIC X.
  1883                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1884             20  CF-IBNR-SW                 PIC X.
  1885                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1886             20  CF-PTC-LF-SW               PIC X.
  1887                 88  CF-LF-PTC-USED             VALUE '1'.
  1888             20  CF-CDT-ACCESS-METHOD       PIC X.
  1889                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1890                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1891                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1892             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1893
  1894         16  CF-CLAIM-CALC-METHOD           PIC X.
  1895             88  360-PLUS-MONTHS                VALUE '1'.
  1896             88  365-PLUS-MONTHS                VALUE '2'.
  1897             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1898             88  360-DAILY                      VALUE '4'.
  1899             88  365-DAILY                      VALUE '5'.
  1900
  1901         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1902         16  FILLER                         PIC X(11).
  1903
  1904         16  CF-LIMIT-AMOUNTS.
  1905             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1906             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1907             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1908             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1909             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1910             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1911             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1912             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1913             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1914             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1915
  1916         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1917         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1918         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1919
  1920         16  CF-ZIP-CODE.
  1921             20  CF-ZIP-PRIME.
  1922                 24  CF-ZIP-1ST             PIC X.
  1923                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1924                 24  FILLER                 PIC X(4).
  1925             20  CF-ZIP-PLUS4               PIC X(4).
  1926         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1927             20  CF-CAN-POSTAL-1            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* SOCK00.cbl
  1928             20  CF-CAN-POSTAL-2            PIC XXX.
  1929             20  FILLER                     PIC XXX.
  1930
  1931         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1932         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1933         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1934
  1935         16  CF-RATING-SWITCH               PIC X.
  1936             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1937             88  CF-NO-RATING                   VALUE 'N'.
  1938
  1939         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1940
  1941         16  CF-CARRIER-OVER-SHORT.
  1942             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1943             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1944
  1945         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1946         16  CF-SECPAY-SWITCH               PIC X.
  1947             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1948             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1949         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1950         16  FILLER                         PIC X(448).
  1951*        16  FILLER                         PIC X(452).
  1952
  1953
  1954****************************************************************
  1955*             MORTALITY MASTER RECORD                          *
  1956****************************************************************
  1957
  1958     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1959         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1960                                INDEXED BY CF-MORT-NDX.
  1961             20  CF-MORT-TABLE              PIC X(5).
  1962             20  CF-MORT-TABLE-TYPE         PIC X.
  1963                 88  CF-MORT-JOINT              VALUE 'J'.
  1964                 88  CF-MORT-SINGLE             VALUE 'S'.
  1965                 88  CF-MORT-COMBINED           VALUE 'C'.
  1966                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1967                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1968             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1969             20  CF-MORT-AGE-METHOD         PIC XX.
  1970                 88  CF-AGE-LAST                VALUE 'AL'.
  1971                 88  CF-AGE-NEAR                VALUE 'AN'.
  1972             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1973             20  CF-MORT-ADJUSTMENT-DIRECTION
  1974                                            PIC X.
  1975                 88  CF-MINUS                   VALUE '-'.
  1976                 88  CF-PLUS                    VALUE '+'.
  1977             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1978             20  CF-MORT-JOINT-CODE         PIC X.
  1979                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1980             20  CF-MORT-PC-Q               PIC X.
  1981                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1982             20  CF-MORT-TABLE-CODE         PIC X(4).
  1983             20  CF-MORT-COMMENTS           PIC X(15).
  1984             20  FILLER                     PIC X(14).
  1985
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* SOCK00.cbl
  1986         16  FILLER                         PIC X(251).
  1987
  1988
  1989****************************************************************
  1990*             BUSSINESS TYPE MASTER RECORD                     *
  1991****************************************************************
  1992
  1993     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1994* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1995* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1996* AND RECORD 05 IS TYPES 81-99
  1997         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1998             20  CF-BUSINESS-TITLE          PIC  X(19).
  1999             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2000                                            PIC S9V9(4) COMP-3.
  2001             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2002             20  FILLER                     PIC  X.
  2003         16  FILLER                         PIC  X(248).
  2004
  2005
  2006****************************************************************
  2007*             TERMINAL MASTER RECORD                           *
  2008****************************************************************
  2009
  2010     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2011
  2012         16  CF-COMPANY-TERMINALS.
  2013             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2014                                  PIC X(4).
  2015         16  FILLER               PIC X(248).
  2016
  2017
  2018****************************************************************
  2019*             LIFE EDIT MASTER RECORD                          *
  2020****************************************************************
  2021
  2022     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2023         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2024             20  CF-LIFE-CODE-IN            PIC XX.
  2025             20  CF-LIFE-CODE-OUT           PIC XX.
  2026         16  FILLER                         PIC X(248).
  2027
  2028
  2029****************************************************************
  2030*             AH EDIT MASTER RECORD                            *
  2031****************************************************************
  2032
  2033     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2034         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2035             20  CF-AH-CODE-IN              PIC XXX.
  2036             20  CF-AH-CODE-OUT             PIC XX.
  2037         16  FILLER                         PIC X(248).
  2038
  2039
  2040****************************************************************
  2041*             CREDIBILITY TABLES                               *
  2042****************************************************************
  2043
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* SOCK00.cbl
  2044     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2045         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2046                             INDEXED BY CF-CRDB-NDX.
  2047             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2048             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2049             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2050         16  FILLER                         PIC  X(332).
  2051
  2052
  2053****************************************************************
  2054*             REPORT CUSTOMIZATION RECORD                      *
  2055****************************************************************
  2056
  2057     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2058         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2059             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2060             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2061             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2062**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2063****       A T-TRANSFER.                                   ****
  2064             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2065
  2066         16  FILLER                         PIC XX.
  2067
  2068         16  CF-CARRIER-CNTL-OPT.
  2069             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2070                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2071                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2072             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2073                                            PIC X.
  2074         16  CF-GROUP-CNTL-OPT.
  2075             20  CF-GROUP-OPT-SEQ           PIC 9.
  2076                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2077                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2078             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2079                                            PIC X(6).
  2080         16  CF-STATE-CNTL-OPT.
  2081             20  CF-STATE-OPT-SEQ           PIC 9.
  2082                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2083                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2084             20  CF-STATE-SELECT OCCURS 3 TIMES
  2085                                            PIC XX.
  2086         16  CF-ACCOUNT-CNTL-OPT.
  2087             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2088                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2089                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2090             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2091                                            PIC X(10).
  2092         16  CF-BUS-TYP-CNTL-OPT.
  2093             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2094                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2095                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2096             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2097                                            PIC XX.
  2098         16  CF-LF-TYP-CNTL-OPT.
  2099             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2100                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2101                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* SOCK00.cbl
  2102             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2103                                            PIC XX.
  2104         16  CF-AH-TYP-CNTL-OPT.
  2105             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2106                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2107                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2108             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2109                                            PIC XX.
  2110         16  CF-REPTCD1-CNTL-OPT.
  2111             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2112                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2113                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2114             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2115                                            PIC X(10).
  2116         16  CF-REPTCD2-CNTL-OPT.
  2117             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2118                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2119                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2120             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2121                                            PIC X(10).
  2122         16  CF-USER1-CNTL-OPT.
  2123             20  CF-USER1-OPT-SEQ           PIC 9.
  2124                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2125                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2126             20  CF-USER1-SELECT OCCURS 3 TIMES
  2127                                            PIC X(10).
  2128         16  CF-USER2-CNTL-OPT.
  2129             20  CF-USER2-OPT-SEQ           PIC 9.
  2130                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2131                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2132             20  CF-USER2-SELECT OCCURS 3 TIMES
  2133                                            PIC X(10).
  2134         16  CF-USER3-CNTL-OPT.
  2135             20  CF-USER3-OPT-SEQ           PIC 9.
  2136                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2137                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2138             20  CF-USER3-SELECT OCCURS 3 TIMES
  2139                                            PIC X(10).
  2140         16  CF-USER4-CNTL-OPT.
  2141             20  CF-USER4-OPT-SEQ           PIC 9.
  2142                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2143                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2144             20  CF-USER4-SELECT OCCURS 3 TIMES
  2145                                            PIC X(10).
  2146         16  CF-USER5-CNTL-OPT.
  2147             20  CF-USER5-OPT-SEQ           PIC 9.
  2148                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2149                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2150             20  CF-USER5-SELECT OCCURS 3 TIMES
  2151                                            PIC X(10).
  2152         16  CF-REINS-CNTL-OPT.
  2153             20  CF-REINS-OPT-SEQ           PIC 9.
  2154                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2155                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2156             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2157                 24  CF-REINS-PRIME         PIC XXX.
  2158                 24  CF-REINS-SUB           PIC XXX.
  2159
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* SOCK00.cbl
  2160         16  CF-AGENT-CNTL-OPT.
  2161             20  CF-AGENT-OPT-SEQ           PIC 9.
  2162                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2163                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2164             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2165                                            PIC X(10).
  2166
  2167         16  FILLER                         PIC X(43).
  2168
  2169         16  CF-LOSS-RATIO-SELECT.
  2170             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2171             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2172         16  CF-ENTRY-DATE-SELECT.
  2173             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2174             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2175         16  CF-EFFECTIVE-DATE-SELECT.
  2176             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2177             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2178
  2179         16  CF-EXCEPTION-LIST-IND          PIC X.
  2180             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2181
  2182         16  FILLER                         PIC X(318).
  2183
  2184****************************************************************
  2185*                  EXCEPTION REPORTING RECORD                  *
  2186****************************************************************
  2187
  2188     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2189         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2190             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2191
  2192         16  CF-COMBINED-LIFE-AH-OPT.
  2193             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2194             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2195             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2196             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2197
  2198         16  CF-LIFE-OPT.
  2199             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2200             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2201             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2202             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2203             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2204             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2205             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2206             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2207             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2208             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2209
  2210         16  CF-AH-OPT.
  2211             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2212             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2213             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2214             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2215             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2216             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2217             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* SOCK00.cbl
  2218             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2219             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2220             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2221
  2222         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2223             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2224             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2225             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2226
  2227         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2228
  2229         16  FILLER                         PIC X(673).
  2230
  2231
  2232****************************************************************
  2233*             MORTGAGE SYSTEM PLAN RECORD                      *
  2234****************************************************************
  2235
  2236     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2237         16  CF-PLAN-TYPE                   PIC X.
  2238             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2239             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2240             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2241         16  CF-PLAN-ABBREV                 PIC XXX.
  2242         16  CF-PLAN-DESCRIPT               PIC X(10).
  2243         16  CF-PLAN-NOTES                  PIC X(20).
  2244         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2245         16  CF-PLAN-UNDERWRITING.
  2246             20  CF-PLAN-TERM-DATA.
  2247                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2248                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2249             20  CF-PLAN-AGE-DATA.
  2250                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2251                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2252                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2253             20  CF-PLAN-BENEFIT-DATA.
  2254                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2255                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2256                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2257                                            PIC S9(7)V99  COMP-3.
  2258         16  CF-PLAN-POLICY-FORMS.
  2259             20  CF-POLICY-FORM             PIC X(12).
  2260             20  CF-MASTER-APPLICATION      PIC X(12).
  2261             20  CF-MASTER-POLICY           PIC X(12).
  2262         16  CF-PLAN-RATING.
  2263             20  CF-RATE-CODE               PIC X(5).
  2264             20  CF-SEX-RATING              PIC X.
  2265                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2266                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2267             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2268             20  CF-SUB-STD-TYPE            PIC X.
  2269                 88  CF-PCT-OF-PREM            VALUE '1'.
  2270                 88  CF-PCT-OF-BENE            VALUE '2'.
  2271         16  CF-PLAN-PREM-TOLERANCES.
  2272             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2273             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2274         16  CF-PLAN-PYMT-TOLERANCES.
  2275             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* SOCK00.cbl
  2276             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2277         16  CF-PLAN-MISC-DATA.
  2278             20  FILLER                     PIC X.
  2279             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2280             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2281         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2282         16  CF-PLAN-IND-GRP                PIC X.
  2283             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2284                                                     '1'.
  2285             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2286                                                     '2'.
  2287         16  CF-MIB-SEARCH-SW               PIC X.
  2288             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2289             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2290             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2291             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2292         16  CF-ALPHA-SEARCH-SW             PIC X.
  2293             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2294             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2295             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2296             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2297             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2298             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2299             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2300             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2301             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2302             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2303                                                     'A' 'B' 'C'
  2304                                                     'X' 'Y' 'Z'.
  2305         16  CF-EFF-DT-RULE-SW              PIC X.
  2306             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2307             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2308             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2309             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2310             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2311         16  FILLER                         PIC X(4).
  2312         16  CF-HEALTH-QUESTIONS            PIC X.
  2313             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2314         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2315         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2316         16  CF-PLAN-SNGL-JNT               PIC X.
  2317             88  CF-COMBINED-PLAN              VALUE 'C'.
  2318             88  CF-JNT-PLAN                   VALUE 'J'.
  2319             88  CF-SNGL-PLAN                  VALUE 'S'.
  2320         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2321         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2322         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2323         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2324         16  CF-RERATE-CNTL                 PIC  X.
  2325             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2326             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2327             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2328             88  CF-AUTO-RECALC                 VALUE '4'.
  2329         16  CF-BENEFIT-TYPE                PIC  X.
  2330             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2331             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2332         16  CF-POLICY-FEE                  PIC S999V99
  2333                                                    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* SOCK00.cbl
  2334         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2335         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2336         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2337         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2338         16  FILLER                         PIC  X(32).
  2339         16  CF-TERMINATION-FORM            PIC  X(04).
  2340         16  FILLER                         PIC  X(08).
  2341         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2342                                                       COMP-3.
  2343         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2344         16  CF-ISSUE-LETTER                PIC  X(4).
  2345         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2346         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2347             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2348             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2349         16  CF-MP-REFUND-CALC              PIC X.
  2350             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2351             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2352             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2353             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2354             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2355             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2356             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2357             88  CF-MP-REFD-MEAN                VALUE '8'.
  2358         16  CF-ALT-RATE-CODE               PIC  X(5).
  2359
  2360
  2361         16  FILLER                         PIC X(498).
  2362****************************************************************
  2363*             MORTGAGE COMPANY MASTER RECORD                   *
  2364****************************************************************
  2365
  2366     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2367         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2368         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2369             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2370             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2371             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2372             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2373             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2374
  2375         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2376         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2377         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2378         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2379         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2380
  2381         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2382             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2383         16  CF-MP-RECON-USE-IND            PIC X(1).
  2384             88  CF-MP-USE-RECON             VALUE 'Y'.
  2385         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2386             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2387         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2388             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2389             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2390         16  FILLER                         PIC X(1).
  2391         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* SOCK00.cbl
  2392             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2393         16  CF-MORTG-MIB-VERSION           PIC X.
  2394             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2395             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2396             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2397         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2398             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2399                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2400             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2401                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2402             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2403                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2404             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2405                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2406             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2407                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2408             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2409                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2410         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2411         16  FILLER                         PIC X(7).
  2412         16  CF-MORTG-DESTINATION-SYMBOL.
  2413             20  CF-MORTG-MIB-COMM          PIC X(5).
  2414             20  CF-MORTG-MIB-TERM          PIC X(5).
  2415         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2416             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2417         16  FILLER                         PIC X(03).
  2418         16  CF-MP-CHECK-NO-CONTROL.
  2419             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2420                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2421                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2422                                                ' ' LOW-VALUES.
  2423                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2424                                               VALUE '3'.
  2425         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2426         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2427         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2428             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2429                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2430             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2431                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2432             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2433                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2434             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2435                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2436             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2437                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2438             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2439                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2440         16  CF-MORTG-BILLING-AREA.
  2441             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2442                                            PIC X.
  2443         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2444         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2445         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2446         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2447             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2448             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2449         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* SOCK00.cbl
  2450         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2451             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2452             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2453         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2454         16  FILLER                         PIC X(8).
  2455         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2456         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2457         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2458         16  CF-ACH-COMPANY-ID.
  2459             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2460                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2461                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2462                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2463             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2464         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2465             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2466         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2467             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2468             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2469         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2470         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2471         16  FILLER                         PIC X(536).
  2472
  2473****************************************************************
  2474*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2475****************************************************************
  2476
  2477     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2478         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2479             20  CF-FEMALE-HEIGHT.
  2480                 24  CF-FEMALE-FT           PIC 99.
  2481                 24  CF-FEMALE-IN           PIC 99.
  2482             20  CF-FEMALE-MIN-WT           PIC 999.
  2483             20  CF-FEMALE-MAX-WT           PIC 999.
  2484         16  FILLER                         PIC X(428).
  2485
  2486     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2487         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2488             20  CF-MALE-HEIGHT.
  2489                 24  CF-MALE-FT             PIC 99.
  2490                 24  CF-MALE-IN             PIC 99.
  2491             20  CF-MALE-MIN-WT             PIC 999.
  2492             20  CF-MALE-MAX-WT             PIC 999.
  2493         16  FILLER                         PIC X(428).
  2494******************************************************************
  2495*             AUTOMATIC ACTIVITY RECORD                          *
  2496******************************************************************
  2497     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2498         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2499             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2500             20  CF-SYS-LETTER-ID           PIC X(04).
  2501             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2502             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2503             20  CF-SYS-RESET-SW            PIC X(01).
  2504             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2505             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2506
  2507         16  FILLER                         PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* SOCK00.cbl
  2508
  2509         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2510             20  CF-USER-ACTIVE-SW          PIC X(01).
  2511             20  CF-USER-LETTER-ID          PIC X(04).
  2512             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2513             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2514             20  CF-USER-RESET-SW           PIC X(01).
  2515             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2516             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2517             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2518
  2519         16  FILLER                         PIC X(246).
  2520*                                 COPY ERCCTBL.
  2521******************************************************************
  2522*                                                                *
  2523*                                                                *
  2524*                            ERCCTBL                             *
  2525*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2526*                            VMOD=2.003
  2527*                                                                *
  2528*   ONLINE CREDIT SYSTEM                                         *
  2529*                                                                *
  2530*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2531*                                                                *
  2532*   FILE TYPE = VSAM,KSDS                                        *
  2533*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2534*                                                                *
  2535*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2536*       ALTERNATE PATH = NONE                                    *
  2537*                                                                *
  2538*   LOG = NO                                                     *
  2539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2540*                                                                *
  2541*                                                                *
  2542******************************************************************
  2543
  2544 01  COMM-TABLE-RECORD.
  2545     12  CT-RECORD-ID                      PIC XX.
  2546         88  VALID-CT-ID                      VALUE 'CT'.
  2547
  2548     12  CT-CONTROL-PRIMARY.
  2549         16  CT-COMPANY-CD                 PIC X.
  2550         16  CT-TABLE                      PIC XXX.
  2551         16  CT-CNTRL-2.
  2552             20  CT-BEN-TYPE               PIC X.
  2553             20  CT-BEN-CODE               PIC XX.
  2554
  2555     12  CT-MAINT-INFORMATION.
  2556         16  CT-LAST-MAINT-DT              PIC XX.
  2557         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2558         16  CT-LAST-MAINT-USER            PIC X(4).
  2559         16  FILLER                        PIC X(31).
  2560
  2561     12  CT-LIMITS.
  2562         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2563
  2564         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2565
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* SOCK00.cbl
  2566         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2567
  2568     12  CT-RATES.
  2569         16  CT-RTX          OCCURS 27 TIMES.
  2570             20  CT-RT                     PIC SV9(5)     COMP-3.
  2571             20  CT-RT-R   REDEFINES
  2572                 CT-RT                     PIC XXX.
  2573
  2574     12  FILLER                            PIC  X(42).
  2575
  2576******************************************************************
  2577*                                 COPY ELCDATE.
  2578******************************************************************
  2579*                                                                *
  2580*                                                                *
  2581*                            ELCDATE.                            *
  2582*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2583*                            VMOD=2.003
  2584*                                                                *
  2585*                                                                *
  2586*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2587*                 LENGTH = 200                                   *
  2588******************************************************************
  2589
  2590 01  DATE-CONVERSION-DATA.
  2591     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2592     12  DC-OPTION-CODE                PIC X.
  2593         88  BIN-TO-GREG                VALUE ' '.
  2594         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2595         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2596         88  YMD-GREG-TO-BIN            VALUE '3'.
  2597         88  MDY-GREG-TO-BIN            VALUE '4'.
  2598         88  JULIAN-TO-BIN              VALUE '5'.
  2599         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2600         88  FIND-CENTURY               VALUE '7'.
  2601         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2602         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2603         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2604         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2605         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2606         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2607         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2608         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2609         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2610         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2611         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2612         88  BIN-3-TO-GREG              VALUE 'I'.
  2613         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2614         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2615         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2616         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2617         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2618         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2619         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2620         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2621         88  THREE-CHARACTER-BIN
  2622                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2623         88  GREGORIAN-TO-BIN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* SOCK00.cbl
  2624                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2625         88  BIN-TO-GREGORIAN
  2626                  VALUES ' ' '1' 'I' '8' 'G'.
  2627         88  JULIAN-TO-BINARY
  2628                  VALUES '5' 'C' 'E' 'F'.
  2629     12  DC-ERROR-CODE                 PIC X.
  2630         88  NO-CONVERSION-ERROR        VALUE ' '.
  2631         88  DATE-CONVERSION-ERROR
  2632                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2633         88  DATE-IS-ZERO               VALUE '1'.
  2634         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2635         88  DATE-IS-INVALID            VALUE '3'.
  2636         88  DATE1-GREATER-DATE2        VALUE '4'.
  2637         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2638         88  DATE-INVALID-OPTION        VALUE '9'.
  2639         88  INVALID-CENTURY            VALUE 'A'.
  2640         88  ONLY-CENTURY               VALUE 'B'.
  2641         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2642         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2643     12  DC-END-OF-MONTH               PIC X.
  2644         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2645     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2646         88  USE-NORMAL-PROCESS         VALUE ' '.
  2647         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2648         88  ADJUST-UP-100-YRS          VALUE '2'.
  2649     12  FILLER                        PIC X.
  2650     12  DC-CONVERSION-DATES.
  2651         16  DC-BIN-DATE-1             PIC XX.
  2652         16  DC-BIN-DATE-2             PIC XX.
  2653         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2654         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2655                       DC-GREG-DATE-1-EDIT.
  2656             20  DC-EDIT1-MONTH        PIC 99.
  2657             20  SLASH1-1              PIC X.
  2658             20  DC-EDIT1-DAY          PIC 99.
  2659             20  SLASH1-2              PIC X.
  2660             20  DC-EDIT1-YEAR         PIC 99.
  2661         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2662         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2663                     DC-GREG-DATE-2-EDIT.
  2664             20  DC-EDIT2-MONTH        PIC 99.
  2665             20  SLASH2-1              PIC X.
  2666             20  DC-EDIT2-DAY          PIC 99.
  2667             20  SLASH2-2              PIC X.
  2668             20  DC-EDIT2-YEAR         PIC 99.
  2669         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2670         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2671                     DC-GREG-DATE-1-YMD.
  2672             20  DC-YMD-YEAR           PIC 99.
  2673             20  DC-YMD-MONTH          PIC 99.
  2674             20  DC-YMD-DAY            PIC 99.
  2675         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2676         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2677                      DC-GREG-DATE-1-MDY.
  2678             20  DC-MDY-MONTH          PIC 99.
  2679             20  DC-MDY-DAY            PIC 99.
  2680             20  DC-MDY-YEAR           PIC 99.
  2681         16  DC-GREG-DATE-1-ALPHA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* SOCK00.cbl
  2682             20  DC-ALPHA-MONTH        PIC X(10).
  2683             20  DC-ALPHA-DAY          PIC 99.
  2684             20  FILLER                PIC XX.
  2685             20  DC-ALPHA-CENTURY.
  2686                 24 DC-ALPHA-CEN-N     PIC 99.
  2687             20  DC-ALPHA-YEAR         PIC 99.
  2688         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2689         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2690         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2691         16  DC-JULIAN-DATE            PIC 9(05).
  2692         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2693                                       PIC 9(05).
  2694         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2695             20  DC-JULIAN-YEAR        PIC 99.
  2696             20  DC-JULIAN-DAYS        PIC 999.
  2697         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2698         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2699         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2700     12  DATE-CONVERSION-VARIBLES.
  2701         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2702         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2703             20  FILLER                PIC 9(3).
  2704             20  HOLD-CEN-1-CCYY.
  2705                 24  HOLD-CEN-1-CC     PIC 99.
  2706                 24  HOLD-CEN-1-YY     PIC 99.
  2707             20  HOLD-CEN-1-MO         PIC 99.
  2708             20  HOLD-CEN-1-DA         PIC 99.
  2709         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2710             20  HOLD-CEN-1-R-MO       PIC 99.
  2711             20  HOLD-CEN-1-R-DA       PIC 99.
  2712             20  HOLD-CEN-1-R-CCYY.
  2713                 24  HOLD-CEN-1-R-CC   PIC 99.
  2714                 24  HOLD-CEN-1-R-YY   PIC 99.
  2715             20  FILLER                PIC 9(3).
  2716         16  HOLD-CENTURY-1-X.
  2717             20  FILLER                PIC X(3)  VALUE SPACES.
  2718             20  HOLD-CEN-1-X-CCYY.
  2719                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2720                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2721             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2722             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2723         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2724             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2725             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2726             20  HOLD-CEN-1-R-X-CCYY.
  2727                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2728                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2729             20  FILLER                PIC XXX.
  2730         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2731         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2732         16  DC-JULIAN-DATE-1          PIC 9(07).
  2733         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2734             20  DC-JULIAN-1-CCYY.
  2735                 24  DC-JULIAN-1-CC    PIC 99.
  2736                 24  DC-JULIAN-1-YR    PIC 99.
  2737             20  DC-JULIAN-DA-1        PIC 999.
  2738         16  DC-JULIAN-DATE-2          PIC 9(07).
  2739         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* SOCK00.cbl
  2740             20  DC-JULIAN-2-CCYY.
  2741                 24  DC-JULIAN-2-CC    PIC 99.
  2742                 24  DC-JULIAN-2-YR    PIC 99.
  2743             20  DC-JULIAN-DA-2        PIC 999.
  2744         16  DC-GREG-DATE-A-EDIT.
  2745             20  DC-EDITA-MONTH        PIC 99.
  2746             20  SLASHA-1              PIC X VALUE '/'.
  2747             20  DC-EDITA-DAY          PIC 99.
  2748             20  SLASHA-2              PIC X VALUE '/'.
  2749             20  DC-EDITA-CCYY.
  2750                 24  DC-EDITA-CENT     PIC 99.
  2751                 24  DC-EDITA-YEAR     PIC 99.
  2752         16  DC-GREG-DATE-B-EDIT.
  2753             20  DC-EDITB-MONTH        PIC 99.
  2754             20  SLASHB-1              PIC X VALUE '/'.
  2755             20  DC-EDITB-DAY          PIC 99.
  2756             20  SLASHB-2              PIC X VALUE '/'.
  2757             20  DC-EDITB-CCYY.
  2758                 24  DC-EDITB-CENT     PIC 99.
  2759                 24  DC-EDITB-YEAR     PIC 99.
  2760         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2761         16  DC-GREG-DATE-CYMD-R REDEFINES
  2762                              DC-GREG-DATE-CYMD.
  2763             20  DC-CYMD-CEN           PIC 99.
  2764             20  DC-CYMD-YEAR          PIC 99.
  2765             20  DC-CYMD-MONTH         PIC 99.
  2766             20  DC-CYMD-DAY           PIC 99.
  2767         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2768         16  DC-GREG-DATE-MDCY-R REDEFINES
  2769                              DC-GREG-DATE-MDCY.
  2770             20  DC-MDCY-MONTH         PIC 99.
  2771             20  DC-MDCY-DAY           PIC 99.
  2772             20  DC-MDCY-CEN           PIC 99.
  2773             20  DC-MDCY-YEAR          PIC 99.
  2774    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2775        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2776    12  DC-EL310-DATE                  PIC X(21).
  2777    12  FILLER                         PIC X(28).
  2778*                                 COPY ELCCALC.
  2779******************************************************************
  2780*                                                                *
  2781*                           ELCCALC.                            *
  2782*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2783*                            VMOD=2.025                          *
  2784*                                                                *
  2785*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2786*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2787*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2788*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2789*                                                                *
  2790*  PASSED TO ELRTRM                                              *
  2791*  -----------------                                             *
  2792*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2793*  ORIGINAL TERM                                                 *
  2794*  BEGINNING DATE                                                *
  2795*  ENDING DATE                                                   *
  2796*  COMPANY I.D.                                                  *
  2797*  ACCOUNT MASTER USER FIELD                                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* SOCK00.cbl
  2798*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2799*  FREE LOOK DAYS                                                *
  2800*                                                                *
  2801*  RETURNED FROM ELRTRM                                          *
  2802*  ---------------------                                         *
  2803*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2804*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2805*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2806*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2807*----------------------------------------------------------------*
  2808*  PASSED TO ELRAMT                                              *
  2809*  ----------------                                              *
  2810*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2811*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2812*  ORIGINAL AMOUNT                                               *
  2813*  ALTERNATE BENEFIT (BALLON)                                    *
  2814*  A.P.R. - NET PAY ONLY                                         *
  2815*  METHOD
  2816*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2817*  COMPANY I.D.                                                  *
  2818*  BENEFIT TYPE                                                  *
  2819*                                                                *
  2820*  RETURNED FROM ELRAMT                                          *
  2821*  --------------------                                          *
  2822*  REMAINING AMOUNT 1 - CURRENT                                  *
  2823*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2824*  REMAINING AMOUNT FACTOR
  2825*----------------------------------------------------------------*
  2826*  PASSED TO ELRESV                                              *
  2827*  -----------------                                             *
  2828*  CERTIFICATE EFFECTIVE DATE                                    *
  2829*  VALUATION DATE                                                *
  2830*  PAID THRU DATE                                                *
  2831*  BENEFIT                                                       *
  2832*  INCURRED DATE                                                 *
  2833*  REPORTED DATE                                                 *
  2834*  ISSUE AGE                                                     *
  2835*  TERM                                                          *
  2836*  CDT PERCENT                                                   *
  2837*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2838* *CLAIM TYPE (LIFE, A/H)                                        *
  2839* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2840* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2841*                                                                *
  2842*  RETURNED FROM ELRESV                                          *
  2843*  --------------------                                          *
  2844*  CDT TABLE USED                                                *
  2845*  CDT FACTOR USED                                               *
  2846*  PAY TO CURRENT RESERVE                                        *
  2847*  I.B.N.R. - A/H ONLY                                           *
  2848*  FUTURE (ACCRUED) AH ONLY                                      *
  2849*----------------------------------------------------------------*
  2850*  PASSED TO ELRATE                                              *
  2851*  ----------------                                              *
  2852*  CERT ISSUE DATE                                               *
  2853*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2854*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2855*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* SOCK00.cbl
  2856*  STATE CODE (CLIENT DEFINED)                                   *
  2857*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2858*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2859*  DEVIATION CODE                                                *
  2860*  ISSUE AGE                                                     *
  2861*  ORIGINAL BENEFIT AMOUNT                                       *
  2862*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2863*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2864*  BENEFIT KIND (LIFE OR A/H)                                    *
  2865*  A.P.R.                                                        *
  2866*  METHOD
  2867*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2868*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2869*  COMPANY I.D. (3 CHARACTER)                                    *
  2870*  BENEFIT CODE                                                  *
  2871*  BENEFIT OVERRIDE CODE                                         *
  2872*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2873*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2874*  JOINT INDICATOR (CSL ONLY)                                    *
  2875*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2876*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2877*                                                                *
  2878*  RETURNED FROM ELRATE                                          *
  2879*  --------------------                                          *
  2880*  CALCULATED PREMIUM                                            *
  2881*  PREMIUM RATE                                                  *
  2882*  MORTALITY CODE                                                *
  2883*  MAX ATTAINED AGE                                              *
  2884*  MAX AGE                                                       *
  2885*  MAX TERM                                                      *
  2886*  MAX MONTHLY BENEFIT                                           *
  2887*  MAX TOTAL BENIFIT                                             *
  2888*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2889*----------------------------------------------------------------*
  2890*  PASSED TO ELRFND                                              *
  2891*  ----------------                                              *
  2892*  CERT ISSUE DATE                                               *
  2893*  REFUND DATE                                                   *
  2894*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2895*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2896*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2897*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2898*  STATE CODE (CLIENT DEFINED)                                   *
  2899*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2900*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2901*  DEVIATION CODE                                                *
  2902*  ISSUE AGE                                                     *
  2903*  ORIGINAL BENEFIT AMOUNT                                       *
  2904*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2905*  PROCESS TYPE (CANCEL)                                         *
  2906*  BENEFIT KIND (LIFE OR A/H)                                    *
  2907*  A.P.R.                                                        *
  2908*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2909*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2910*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2911*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2912*  COMPANY I.D. (3 CHARACTER)                                    *
  2913*  BENEFIT CODE                                                  *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* SOCK00.cbl
  2914*  BENEFIT OVERRIDE CODE                                         *
  2915*                                                                *
  2916*  RETURNED FROM ELRFND                                          *
  2917*  --------------------                                          *
  2918*  CALCULATED REFUND                                             *
  2919*----------------------------------------------------------------*
  2920*  PASSED TO ELEARN                                              *
  2921*  ----------------                                              *
  2922*  CERT ISSUE DATE                                               *
  2923*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2924*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2925*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2926*  STATE CODE (CLIENT DEFINED)                                   *
  2927*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2928*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2929*  DEVIATION CODE                                                *
  2930*  ISSUE AGE                                                     *
  2931*  ORIGINAL BENEFIT AMOUNT                                       *
  2932*  BENEFIT KIND (LIFE OR A/H)                                    *
  2933*  A.P.R.                                                        *
  2934*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2935*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2936*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2937*  COMPANY I.D. (3 CHARACTER)                                    *
  2938*  BENEFIT CODE                                                  *
  2939*  BENEFIT OVERRIDE CODE                                         *
  2940*                                                                *
  2941*  RETURNED FROM ELEARN                                          *
  2942*  --------------------                                          *
  2943*  INDICATED  EARNINGS                                           *
  2944*----------------------------------------------------------------*
  2945*                 LENGTH = 450                                   *
  2946*                                                                *
  2947******************************************************************
  2948******************************************************************
  2949*                   C H A N G E   L O G
  2950*
  2951* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2952*-----------------------------------------------------------------
  2953*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2954* EFFECTIVE    NUMBER
  2955*-----------------------------------------------------------------
  2956* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2957* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2958* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2959* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2960* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2961* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2962* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2963* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2964* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2965******************************************************************
  2966
  2967 01  CALCULATION-PASS-AREA.
  2968     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2969                                     COMP.
  2970
  2971     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* SOCK00.cbl
  2972       88  NO-CP-ERROR                             VALUE ZERO.
  2973       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2974                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2975       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2976       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2977       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2978       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2979       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2980       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2981       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2982       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2983       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2984       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2985       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2986       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2987       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2988       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2989       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2990       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2991       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2992
  2993     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2994       88  NO-CP-ERROR-2                           VALUE ZERO.
  2995***********************  INPUT AREAS ****************************
  2996
  2997     12  CP-CALCULATION-AREA.
  2998         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2999         16  CP-CERT-EFF-DT        PIC XX.
  3000         16  CP-VALUATION-DT       PIC XX.
  3001         16  CP-PAID-THRU-DT       PIC XX.
  3002         16  CP-BENEFIT-TYPE       PIC X.
  3003           88  CP-AH                               VALUE 'A' 'D'
  3004                                                   'I' 'U'.
  3005           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3006           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3007         16  CP-INCURRED-DT        PIC XX.
  3008         16  CP-REPORTED-DT        PIC XX.
  3009         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3010         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3011         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3012                                     COMP-3.
  3013         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3014                                     COMP-3.
  3015         16  CP-CDT-METHOD         PIC X.
  3016           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3017           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3018           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3019         16  CP-CLAIM-TYPE         PIC X.
  3020           88  CP-AH-CLAIM                         VALUE 'A'.
  3021           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3022         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3023                                     COMP-3.
  3024         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3025                                     COMP-3.
  3026         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3027                                     COMP-3.
  3028         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3029                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* SOCK00.cbl
  3030         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3031                                     COMP-3.
  3032         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3033                                     COMP-3.
  3034         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3035                                     COMP-3.
  3036         16  CP-REM-TERM-METHOD    PIC X.
  3037           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3038           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3039           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3040           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3041           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3042           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3043           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3044         16  CP-EARNING-METHOD     PIC X.
  3045           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3046           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3047           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3048           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3049           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3050           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3051           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3052           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3053           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3054           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3055           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3056           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3057           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3058           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3059         16  CP-PROCESS-TYPE       PIC X.
  3060           88  CP-CLAIM                            VALUE '1'.
  3061           88  CP-CANCEL                           VALUE '2'.
  3062           88  CP-ISSUE                            VALUE '3'.
  3063         16  CP-SPECIAL-CALC-CD    PIC X.
  3064           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3065           88  CP-1-MTH-INTEREST               VALUE ' '.
  3066           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3067           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3068           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3069           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3070           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3071           88  CP-FARM-PLAN                    VALUE 'F'.
  3072           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3073           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3074           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3075           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3076           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3077           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3078           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3079           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3080           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3081           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3082                                                     'W' 'X'.
  3083           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3084           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3085           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3086           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3087           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* SOCK00.cbl
  3088           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3089           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3090           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3091           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3092           88  CP-CSL-METH-1                   VALUE '5'.
  3093           88  CP-CSL-METH-2                   VALUE '6'.
  3094           88  CP-CSL-METH-3                   VALUE '7'.
  3095           88  CP-CSL-METH-4                   VALUE '8'.
  3096
  3097         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3098                                     COMP-3.
  3099         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3100         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3101         16  CP-STATE              PIC XX          VALUE SPACE.
  3102         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3103         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3104           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3105               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3106         16  CP-R78-OPTION         PIC X.
  3107           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3108           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3109
  3110         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3111         16  CP-IBNR-RESERVE-SW    PIC X.
  3112         16  CP-CLAIM-STATUS       PIC X.
  3113         16  CP-RATE-FILE          PIC X.
  3114         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3115                                     COMP-3.
  3116
  3117         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3118         16  CP-AH-OVERRIDE-CODE   PIC X.
  3119
  3120         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3121                                     COMP-3.
  3122         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3123                                   PIC S9(5)V99 COMP-3.
  3124         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3125                                     COMP-3.
  3126         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3127                                     COMP-3.
  3128         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3129                                     COMP-3.
  3130         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3131                                  PIC S9(7)V99 COMP-3.
  3132
  3133         16  CP-PAID-FROM-DATE     PIC X(02).
  3134         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3135         16  CP-EXT-DAYS-CALC      PIC X.
  3136           88  CP-EXT-NO-CHG                   VALUE ' '.
  3137           88  CP-EXT-CHG-LF                   VALUE '1'.
  3138           88  CP-EXT-CHG-AH                   VALUE '2'.
  3139           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3140         16  CP-DOMICILE-STATE     PIC XX.
  3141         16  CP-CARRIER            PIC X.
  3142         16  CP-REIN-FLAG          PIC X.
  3143         16  CP-REM-TRM-CALC-OPTION PIC X.
  3144           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3145                      '2' '3' '4' '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* SOCK00.cbl
  3146           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3147           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3148           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3149           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3150           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3151           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3152           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3153           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3154         16  CP-SIG-SWITCH         PIC X.
  3155         16  CP-RATING-METHOD      PIC X.
  3156           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3157           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3158           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3159           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3160           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3161           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3162           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3163           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3164           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3165         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3166                                     COMP-3.
  3167         16  CP-BEN-CATEGORY       PIC X.
  3168         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3169         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3170                                   PIC S99V9(5) COMP-3.
  3171         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3172         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3173                                   PIC S99V9(5) COMP-3.
  3174         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3175         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3176         16  CP-EXPIRE-DT          PIC XX.
  3177         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3178         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3179         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3180         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3181         16  CP-DDF-SPEC-CALC      PIC X.
  3182             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3183             88  CP-CALC-CLP              VALUE 'C'.
  3184         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3185         16  CP-CANCEL-REASON      PIC X.
  3186         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3187         16  CP-PMT-MODE           PIC X.
  3188         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3189         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3190         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3191         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3192         16  FILLER                PIC X.
  3193
  3194***************    OUTPUT FROM ELRESV   ************************
  3195
  3196         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3197
  3198         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3199                                     COMP-3.
  3200         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3201                                     COMP-3.
  3202         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3203                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* SOCK00.cbl
  3204         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3205                                     COMP-3.
  3206         16  FILLER                PIC X(09).
  3207***************    OUTPUT FROM ELRTRM   *************************
  3208
  3209         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3210                                     COMP-3.
  3211         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3212                                     COMP-3.
  3213         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3214                                     COMP-3.
  3215         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3216                                     COMP-3.
  3217         16  FILLER                PIC X(12).
  3218
  3219***************    OUTPUT FROM ELRAMT   *************************
  3220
  3221         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3222                                     COMP-3.
  3223         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3224                                     COMP-3.
  3225         16  FILLER                PIC X(12).
  3226
  3227***************    OUTPUT FROM ELRATE   *************************
  3228
  3229         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3230                                     COMP-3.
  3231         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3232                                     COMP-3.
  3233         16  CP-MORTALITY-CODE     PIC X(4).
  3234         16  CP-RATE-EDIT-FLAG     PIC X.
  3235             88  CP-RATES-NEED-APR                  VALUE '1'.
  3236         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3237                                     COMP-3.
  3238         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3239         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3240         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3241                                   PIC S9(7)V99 COMP-3.
  3242         16  FILLER                PIC X(07).
  3243
  3244***************    OUTPUT FROM ELRFND   *************************
  3245
  3246         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3247                                     COMP-3.
  3248         16  CP-REFUND-TYPE-USED   PIC X.
  3249           88  CP-R-AS-R78                         VALUE '1'.
  3250           88  CP-R-AS-PRORATA                     VALUE '2'.
  3251           88  CP-R-AS-CALIF                       VALUE '3'.
  3252           88  CP-R-AS-TEXAS                       VALUE '4'.
  3253           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3254           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3255           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3256           88  CP-R-AS-MEAN                        VALUE '8'.
  3257           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3258           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3259           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3260           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3261           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* SOCK00.cbl
  3262           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3263         16  FILLER                PIC X(12).
  3264
  3265***************    OUTPUT FROM ELEARN   *************************
  3266
  3267         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3268                                     COMP-3.
  3269         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3270                                     COMP-3.
  3271         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3272                                     COMP-3.
  3273         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3274                                     COMP-3.
  3275         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3276                                     COMP-3.
  3277         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3278                                     COMP-3.
  3279         16  CP-EARNING-TYPE-USED  PIC X.
  3280           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3281           88  CP-E-AS-R78                         VALUE '1'.
  3282           88  CP-E-AS-PRORATA                     VALUE '2'.
  3283           88  CP-E-AS-TEXAS                       VALUE '4'.
  3284           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3285           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3286           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3287           88  CP-E-AS-MEAN                        VALUE '8'.
  3288           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3289         16  FILLER                PIC X(12).
  3290
  3291***************    OUTPUT FROM ELPMNT   *************************
  3292
  3293         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3294                                     COMP-3.
  3295         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3296                                     COMP-3.
  3297         16  FILLER                PIC X(12).
  3298
  3299***************   MISC WORK AREAS    *****************************
  3300         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3301                                     COMP-3.
  3302         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3303                                     COMP-3.
  3304         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3305                                     COMP-3.
  3306         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3307                                     COMP-3.
  3308         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3309                                     COMP-3.
  3310         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3311                                     COMP-3.
  3312         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3313             88  OPEN-RATE-FILE                   VALUE 'O'.
  3314             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3315             88  IO-ERROR                         VALUE 'E'.
  3316
  3317         16  CP-FIRST-PAY-DATE     PIC XX.
  3318
  3319         16  CP-JOINT-INDICATOR    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* SOCK00.cbl
  3320
  3321         16  CP-RESERVE-REMAINING-TERM
  3322                                   PIC S9(4)V9    VALUE ZERO
  3323                                     COMP-3.
  3324
  3325         16  CP-INSURED-BIRTH-DT   PIC XX.
  3326
  3327         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3328                                     COMP-3.
  3329
  3330         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3331                                     COMP-3.
  3332
  3333         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3334                                     COMP-3.
  3335
  3336         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3337                                     COMP-3.
  3338
  3339         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3340                                     COMP-3.
  3341
  3342         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3343                                     COMP-3.
  3344
  3345         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3346                                     COMP-3.
  3347
  3348         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3349             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3350
  3351         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3352                                     COMP-3.
  3353         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3354                                     COMP-3.
  3355         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3356         16  FILLER                PIC X(15).
  3357******************************************************************
  3358****************************************************************
  3359*
  3360* Copyright (c) 2007 by Clerity Solutions, Inc.
  3361* All rights reserved.
  3362*
  3363****************************************************************
  3364 01  DFHEIV.
  3365   02  DFHEIV0               PIC X(35).
  3366   02  DFHEIV1               PIC X(08).
  3367   02  DFHEIV2               PIC X(08).
  3368   02  DFHEIV3               PIC X(08).
  3369   02  DFHEIV4               PIC X(06).
  3370   02  DFHEIV5               PIC X(04).
  3371   02  DFHEIV6               PIC X(04).
  3372   02  DFHEIV7               PIC X(02).
  3373   02  DFHEIV8               PIC X(02).
  3374   02  DFHEIV9               PIC X(01).
  3375   02  DFHEIV10              PIC S9(7) COMP-3.
  3376   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3377   02  DFHEIV12              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* SOCK00.cbl
  3378   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3379   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3380   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3381   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3382   02  DFHEIV17              PIC X(04).
  3383   02  DFHEIV18              PIC X(04).
  3384   02  DFHEIV19              PIC X(04).
  3385   02  DFHEIV20              USAGE IS POINTER.
  3386   02  DFHEIV21              USAGE IS POINTER.
  3387   02  DFHEIV22              USAGE IS POINTER.
  3388   02  DFHEIV23              USAGE IS POINTER.
  3389   02  DFHEIV24              USAGE IS POINTER.
  3390   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3391   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3392   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3393   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3394   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3395   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3396   02  FILLER                PIC X(02).
  3397   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3398   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3399   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3400   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3401   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3402 LINKAGE  SECTION.
  3403*****************************************************************
  3404*                                                               *
  3405* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3406* All rights reserved.                                          *
  3407*                                                               *
  3408*****************************************************************
  3409 01  dfheiblk.
  3410     02  eibtime          pic s9(7) comp-3.
  3411     02  eibdate          pic s9(7) comp-3.
  3412     02  eibtrnid         pic x(4).
  3413     02  eibtaskn         pic s9(7) comp-3.
  3414     02  eibtrmid         pic x(4).
  3415     02  dfheigdi         pic s9(4) comp.
  3416     02  eibcposn         pic s9(4) comp.
  3417     02  eibcalen         pic s9(4) comp.
  3418     02  eibaid           pic x(1).
  3419     02  eibfiller1       pic x(1).
  3420     02  eibfn            pic x(2).
  3421     02  eibfiller2       pic x(2).
  3422     02  eibrcode         pic x(6).
  3423     02  eibfiller3       pic x(2).
  3424     02  eibds            pic x(8).
  3425     02  eibreqid         pic x(8).
  3426     02  eibrsrce         pic x(8).
  3427     02  eibsync          pic x(1).
  3428     02  eibfree          pic x(1).
  3429     02  eibrecv          pic x(1).
  3430     02  eibsend          pic x(1).
  3431     02  eibatt           pic x(1).
  3432     02  eibeoc           pic x(1).
  3433     02  eibfmh           pic x(1).
  3434     02  eibcompl         pic x(1).
  3435     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* SOCK00.cbl
  3436     02  eibconf          pic x(1).
  3437     02  eiberr           pic x(1).
  3438     02  eibrldbk         pic x(1).
  3439     02  eiberrcd         pic x(4).
  3440     02  eibsynrb         pic x(1).
  3441     02  eibnodat         pic x(1).
  3442     02  eibfiller5       pic x(2).
  3443     02  eibresp          pic 9(09) comp.
  3444     02  eibresp2         pic 9(09) comp.
  3445     02  dfheigdj         pic s9(4) comp.
  3446     02  dfheigdk         pic s9(4) comp.
  3447 01  DFHCOMMAREA.
  3448   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3449   05 LSTN-NAME                PIC X(8).
  3450   05 LSTN-SUBNAME             PIC X(8).
  3451   05 CLIENT-IN-DATA.
  3452      15  CLIENT-CAR           PIC X.
  3453      15  CLIENT-GRP           PIC X(6).
  3454      15  CLIENT-ST            PIC XX.
  3455      15  CLIENT-ACT           PIC X(10).
  3456      15  CLIENT-ID            PIC XXX.
  3457      15  FILLER               PIC X(14).
  3458   05 SOCKADDR-IN-PARM.
  3459     15 SIN-FAMILY             PIC 9(4) COMP.
  3460     15 SIN-PORT               PIC 9(4) COMP.
  3461     15 SIN-ADDRESS            PIC 9(8) COMP.
  3462     15 SIN-ZERO               PIC X(8).
  3463 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3464 0000-DFHEXIT SECTION.
  3465     MOVE '9#                    $   ' TO DFHEIV0.
  3466     MOVE 'SOCK00' TO DFHEIV1.
  3467     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3468*
  3469* when calling a C function the function returns its value
  3470* in the system variable return code.
  3471*
  3472 start-here.
  3473*
  3474* data with transaction
  3475*
  3476     display 'SOCK00:transaction data =', CLIENT-IN-DATA.
  3477     display 'SOCK00:socket number    =', GIVE-TAKE-SOCKET.
  3478     IF CLIENT-IN-DATA (1:4) = "RATE"
  3479        SET GET-RATES            TO TRUE
  3480     ELSE
  3481        IF CLIENT-IN-DATA (1:5) = "STATE"
  3482           SET GET-ACT-ACCTS     TO TRUE
  3483        END-IF
  3484     END-IF
  3485     IF CLIENT-ID = 'AHL'
  3486        MOVE X'06'               TO WS-COMP-CD
  3487        MOVE 'AHL'               TO WS-SEND-BUF (5:3)
  3488                                    WS-COMP-ID
  3489     ELSE
  3490        IF CLIENT-ID = 'DCC'
  3491           MOVE X'05'            TO WS-COMP-CD
  3492           MOVE 'DCC'            TO WS-SEND-BUF (5:3)
  3493                                    WS-COMP-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* SOCK00.cbl
  3494        ELSE
  3495           MOVE X'04'            TO WS-COMP-CD
  3496           MOVE 'CID'            TO WS-SEND-BUF (5:3)
  3497                                    WS-COMP-ID
  3498        END-IF
  3499     END-IF
  3500     move 'CSO'                  to ws-send-buf (1:3)
  3501     move +25                    to ws-send-msg-size
  3502* send data
  3503*
  3504     display 'SOCK00:sequence number  =', ws-seq-num.
  3505     display 'SOCK00:send buffer      =', ws-send-buf(1:25).
  3506     call "send" using by value GIVE-TAKE-SOCKET,
  3507         by reference ws-send-buf,
  3508         by value ws-send-msg-size,
  3509         by value ws-flags.
  3510     if return-code <= zero
  3511         display 'SOCK00:send error ',
  3512         go to socket-error.
  3513*
  3514* set up the receive buffer
  3515*
  3516     move low-values to ws-recv-buf.
  3517     set ws-recv-total to zero.
  3518     compute ws-recv-left = ws-recv-msg-size.
  3519*
  3520* receive data
  3521*
  3522     display 'SOCK00:About to recv '
  3523     call "recv" using by value GIVE-TAKE-SOCKET,
  3524         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3525         by value ws-recv-left,
  3526         by value ws-flags.
  3527*
  3528* test what was received and decide what we should do
  3529*
  3530     if return-code < zero
  3531        display 'SOCK00:recv error ',
  3532        go to socket-error.
  3533     if return-code = zero
  3534        display 'SOCK00:client disconnected',
  3535        go to socket-error.
  3536*
  3537     display 'SOCK00:Good recv  '
  3538     display 'SOCK00:return code      = ', return-code
  3539     display 'SOCK00:receive buffer   = ', ws-recv-buf(1:50)
  3540     move +4096                  to ws-send-msg-size
  3541*    move +750                   to ws-send-msg-size
  3542     if get-rates
  3543        perform 0300-get-rates   thru 0300-exit
  3544     end-if
  3545     IF GET-ACT-ACCTS
  3546        PERFORM 0400-GET-ACT-ACCTS
  3547                                 THRU 0400-EXIT
  3548     END-IF
  3549     move ws-recv-buf (1:19)     to client-in-data
  3550     IF (CLIENT-CAR NOT = ZEROS)
  3551        AND (CLIENT-ST NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* SOCK00.cbl
  3552        PERFORM 0500-GET-ONE-ACCT
  3553                                 THRU 0500-EXIT
  3554     END-IF
  3555     MOVE ' '                    TO WS-BUILD-SW
  3556     MOVE CLIENT-ACT             TO WS-AM-ALT-ACCOUNT
  3557     MOVE LOW-VALUES             TO WS-AM-ALT-EXP-DT
  3558     PERFORM 0010-STARTBR-ERACCT THRU 0010-EXIT
  3559     IF NOT RESP-NORMAL
  3560        MOVE 'BAD STARTBR ON ERACCT  '
  3561                                 TO WS-SEND-BUF
  3562        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3563        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3564        GO TO SEND-BUFFER
  3565     END-IF
  3566     PERFORM 0020-READNEXT-ERACCT
  3567                                 THRU 0020-EXIT
  3568     IF (NOT RESP-NORMAL)
  3569        OR (AM-ACCOUNT NOT = CLIENT-ACT)
  3570        MOVE 'BAD READNEXT ON ERACCT '
  3571                                 TO WS-SEND-BUF
  3572        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3573        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3574        GO TO SEND-BUFFER
  3575     ELSE
  3576        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  3577     END-IF
  3578     PERFORM UNTIL
  3579        (TIME-TO-BUILD)
  3580        IF AM-ACCOUNT = CLIENT-ACT
  3581         IF (AM-STATE = CLIENT-ST)
  3582                 OR
  3583            (CLIENT-ST = 00)
  3584           IF AM-EXPIRATION-DT = HIGH-VALUES
  3585              SET TIME-TO-BUILD  TO TRUE
  3586           ELSE
  3587              MOVE ACCOUNT-MASTER
  3588                                 TO WS-SAVE-ERACCT
  3589              PERFORM 0020-READNEXT-ERACCT
  3590                                 THRU 0020-EXIT
  3591              IF NOT RESP-NORMAL
  3592                 MOVE WS-SAVE-ERACCT
  3593                                 TO ACCOUNT-MASTER
  3594                 SET TIME-TO-BUILD
  3595                                 TO TRUE
  3596              END-IF
  3597           END-IF
  3598         ELSE
  3599          PERFORM 0020-READNEXT-ERACCT
  3600                            THRU 0020-EXIT
  3601         END-IF
  3602        ELSE
  3603           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  3604           SET TIME-TO-BUILD     TO TRUE
  3605        END-IF
  3606     END-PERFORM
  3607     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3608     .
  3609*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* SOCK00.cbl
  3610* send data
  3611*
  3612 SEND-BUFFER.
  3613     display 'SOCK00:About to send      '
  3614     display 'SOCK00:sequence number  =', ws-seq-num.
  3615     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  3616     call "send" using by value GIVE-TAKE-SOCKET,
  3617         by reference ws-send-buf,
  3618         by value ws-send-msg-size,
  3619         by value ws-flags.
  3620     if return-code <= zero
  3621         display 'SOCK00:send error ',
  3622         go to socket-error.
  3623     GO TO SOCKET-FIN
  3624*
  3625* set up the receive buffer
  3626*
  3627     move low-values to ws-recv-buf.
  3628     set ws-recv-total to zero.
  3629     compute ws-recv-left = ws-recv-msg-size.
  3630*
  3631* receive data
  3632*
  3633 recv-1.
  3634     call "recv" using by value GIVE-TAKE-SOCKET,
  3635         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3636         by value ws-recv-left,
  3637         by value ws-flags.
  3638*
  3639* test what was received and decide what we should do
  3640*
  3641     if return-code < zero
  3642        display 'SOCK00:recv error ',
  3643        go to socket-error.
  3644     if return-code = zero
  3645        display 'SOCK00:client disconnected',
  3646        go to socket-error.
  3647*
  3648* have we received all the data yet?
  3649*
  3650     compute ws-recv-total = ws-recv-total + return-code.
  3651     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3652*
  3653* not yet
  3654*
  3655     if ws-recv-left > 0 go to recv-1.
  3656*
  3657* received all the data
  3658*
  3659     display 'SOCK00:receive buffer   =', ws-recv-buf(1:50).
  3660*
  3661* make sure what we received was what we sent
  3662*
  3663*    if ws-recv-buf <> ws-send-buf
  3664*        display "SOCK00:data doesn't match",
  3665*        go to socket-error.
  3666*
  3667* end of pass
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* SOCK00.cbl
  3668*
  3669*loop-end.
  3670*    if ws-seq-num = 5 go to socket-error.
  3671*    go to loop-1.
  3672*
  3673* program end
  3674*
  3675 socket-error.
  3676     if ws-seq-num <> 0
  3677         display "SOCK00:did not complete".
  3678*
  3679* flush the send buffer and deallocate
  3680*
  3681*    display 'SOCK00:closing socket'.
  3682*    call "close" using by value GIVE-TAKE-SOCKET .
  3683*
  3684* finised return to cics
  3685*
  3686 socket-fin.
  3687     display 'SOCK00:closing socket'.
  3688     call "close" using by value GIVE-TAKE-SOCKET .
  3689     display 'SOCK00:done'.
  3690
  3691* exec cics return end-exec.
  3692*    MOVE '.(                    &   #00003686' TO DFHEIV0
  3693     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3694     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3695     MOVE X'2020233030303033363836' TO DFHEIV0(25:11)
  3696     CALL 'kxdfhei1' USING DFHEIV0,
  3697           DFHEIV99,
  3698           DFHEIV99,
  3699           DFHEIV99,
  3700           DFHEIV99,
  3701           DFHEIV99
  3702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3703
  3704
  3705* goback.
  3706     MOVE '9%                    "   ' TO DFHEIV0
  3707     MOVE 'SOCK00' TO DFHEIV1
  3708     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3709     goback.
  3710 0010-STARTBR-ERACCT.
  3711
  3712* EXEC CICS STARTBR
  3713*         DATASET    ('ERACCT3')
  3714*         RIDFLD     (WS-AM-ALT-KEY)
  3715*         GENERIC
  3716*         GTEQ
  3717*         KEYLENGTH  (10)
  3718*         RESP       (WS-RESPONSE)
  3719*    END-EXEC
  3720     MOVE 'ERACCT3' TO DFHEIV1
  3721     MOVE 10
  3722       TO DFHEIV11
  3723     MOVE 0
  3724       TO DFHEIV12
  3725*    MOVE '&,   KG    G          &  N#00003689' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* SOCK00.cbl
  3726     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3727     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3728     MOVE X'204E233030303033363839' TO DFHEIV0(25:11)
  3729     CALL 'kxdfhei1' USING DFHEIV0,
  3730           DFHEIV1,
  3731           WS-AM-ALT-KEY,
  3732           DFHEIV11,
  3733           DFHEIV12,
  3734           DFHEIV99
  3735     MOVE EIBRESP  TO WS-RESPONSE
  3736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3737     .
  3738 0010-EXIT.
  3739     EXIT.
  3740 0020-READNEXT-ERACCT.
  3741
  3742* EXEC CICS READNEXT
  3743*         INTO    (ACCOUNT-MASTER)
  3744*         DATASET ('ERACCT3')
  3745*         RIDFLD  (WS-AM-ALT-KEY)
  3746*         RESP    (WS-RESPONSE)
  3747*    END-EXEC
  3748     MOVE LENGTH OF
  3749      ACCOUNT-MASTER
  3750       TO DFHEIV12
  3751     MOVE 'ERACCT3' TO DFHEIV1
  3752     MOVE 0
  3753       TO DFHEIV11
  3754*    MOVE '&.IL                  )  N#00003701' TO DFHEIV0
  3755     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3756     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3757     MOVE X'204E233030303033373031' TO DFHEIV0(25:11)
  3758     CALL 'kxdfhei1' USING DFHEIV0,
  3759           DFHEIV1,
  3760           ACCOUNT-MASTER,
  3761           DFHEIV12,
  3762           WS-AM-ALT-KEY,
  3763           DFHEIV99,
  3764           DFHEIV11,
  3765           DFHEIV99,
  3766           DFHEIV99
  3767     MOVE EIBRESP  TO WS-RESPONSE
  3768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3769     .
  3770 0020-EXIT.
  3771     EXIT.
  3772 0030-BUILD-BUFFER.
  3773     PERFORM 0100-BUILD-ERACCT-STUFF
  3774                                 THRU 0100-EXIT
  3775     MOVE SPACES                 TO WS-SEND-BUF
  3776     EVALUATE AM-STATUS
  3777        WHEN '1'
  3778           MOVE 'I'              TO WS-STATUS
  3779        WHEN '2'
  3780           MOVE 'T'              TO WS-STATUS
  3781        WHEN '3'
  3782           MOVE 'C'              TO WS-STATUS
  3783        WHEN '4'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* SOCK00.cbl
  3784           MOVE 'I'              TO WS-STATUS
  3785        WHEN '5'
  3786           MOVE 'S'              TO WS-STATUS
  3787        WHEN OTHER
  3788           MOVE 'A'              TO WS-STATUS
  3789     END-EVALUATE
  3790     IF AM-REMIT-TO NOT NUMERIC
  3791        MOVE ZEROS         TO AM-REMIT-TO
  3792     END-IF
  3793     IF AM-REMIT-TO = ZEROS
  3794        MOVE 01        TO AM-REMIT-TO
  3795     END-IF
  3796     MOVE AM-AGT (AM-REMIT-TO) TO WS-FIN-RESP
  3797     MOVE SPACES                 TO WS-AM-CITY-STATE
  3798     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3799        DELIMITED BY '  ' INTO WS-AM-CITY-STATE
  3800     END-STRING
  3801     IF NOT GET-ACT-ACCTS
  3802* this is when a single account is selected
  3803       STRING
  3804        AM-ACCOUNT      ';'
  3805        WS-LONG-ACCT-NAME    ';'
  3806        WS-CONTR-NAME   ';'
  3807        AM-ADDRS        ';'
  3808        WS-AM-CITY-STATE ';'
  3809        AM-ZIP          ';'
  3810        AM-GPCD         ';'
  3811        WS-EFF-DATE     ';'
  3812        WS-EXP-DATE     ';'
  3813        WS-POLICY-NO    ';'
  3814        WS-SL-COMM      ';'
  3815        WS-JL-COMM      ';'
  3816        WS-SAH-COMM     ';'
  3817        WS-JAH-COMM     ';'
  3818        WS-CID-NO       ';'
  3819        AM-STATE        ';'
  3820        WS-GA-NUM       ';'
  3821        WS-GA-PRIMARY-CONTACT ';'
  3822        WS-GA-NAME      ';'
  3823        WS-GA-MAIL-NAME ';'
  3824        WS-GA-ADDR1     ';'
  3825        WS-GA-ADDR2     ';'
  3826        WS-GA-ADDR3     ';'
  3827        WS-GA-ZIP       ';'
  3828        WS-GA-PHONE     ';'
  3829        AM-CONTROL-NAME ';'
  3830        WS-ORIG-EFF-DT  ';'
  3831        AM-COMMENT-LINE (1) ';'
  3832        AM-COMMENT-LINE (2) ';'
  3833        AM-COMMENT-LINE (3) ';'
  3834        AM-COMMENT-LINE (4) ';'
  3835        AM-COMMENT-LINE (5) ';'
  3836        AM-TEL-NO       ';'
  3837        AM-REPORT-CODE-1    ';'
  3838        AM-REPORT-CODE-2    ';'
  3839        WS-STATUS           ';'
  3840        AM-REPORT-CODE-3    ';'
  3841        AM-USER-SELECT-2    ';'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* SOCK00.cbl
  3842        AM-CARRIER          ';'
  3843        WS-FIN-RESP         ';'
  3844        AM-USER-SELECT-3    ';'
  3845        WS-SHORT-ACCT-NAME  ';'
  3846           DELIMITED BY SIZE INTO WS-SEND-BUF
  3847       END-STRING
  3848     ELSE
  3849       STRING
  3850        AM-ACCOUNT      ';'
  3851        WS-LONG-ACCT-NAME    ';'
  3852        WS-CONTR-NAME   ';'
  3853        AM-ADDRS        ';'
  3854        WS-AM-CITY-STATE ';'
  3855        AM-ZIP          ';'
  3856        AM-GPCD         ';'
  3857        WS-EFF-DATE     ';'
  3858        WS-EXP-DATE     ';'
  3859        WS-POLICY-NO    ';'
  3860        WS-SL-COMM      ';'
  3861        WS-JL-COMM      ';'
  3862        WS-SAH-COMM     ';'
  3863        WS-JAH-COMM     ';'
  3864        WS-CID-NO       ';'
  3865        AM-STATE        ';'
  3866        WS-GA-NUM       ';'
  3867        WS-GA-PRIMARY-CONTACT ';'
  3868        WS-GA-NAME      ';'
  3869        WS-GA-MAIL-NAME ';'
  3870        WS-GA-ADDR1     ';'
  3871        WS-GA-ADDR2     ';'
  3872        WS-GA-ADDR3     ';'
  3873        WS-GA-ZIP       ';'
  3874        WS-GA-PHONE     ';'
  3875        AM-COMMENT-LINE (1) ';'
  3876        AM-COMMENT-LINE (2) ';'
  3877        AM-COMMENT-LINE (3) ';'
  3878        AM-COMMENT-LINE (4) ';'
  3879        AM-COMMENT-LINE (5) ';'
  3880        AM-CONTROL-NAME     ';'
  3881        WS-ORIG-EFF-DT      ';'
  3882        AM-TEL-NO           ';'
  3883        AM-REPORT-CODE-1    ';'
  3884        AM-REPORT-CODE-2    ';'
  3885        WS-STATUS           ';'
  3886        AM-REPORT-CODE-3    ';'
  3887        AM-USER-SELECT-2    ';'
  3888        AM-CARRIER          ';'
  3889        WS-FIN-RESP         ';'
  3890        AM-USER-SELECT-3    ';'
  3891        WS-SHORT-ACCT-NAME  ';'
  3892           DELIMITED BY SIZE INTO WS-SEND-BUF
  3893       END-STRING
  3894     END-IF
  3895     .
  3896 0030-EXIT.
  3897     EXIT.
  3898 0100-BUILD-ERACCT-STUFF.
  3899     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* SOCK00.cbl
  3900     MOVE ' '                    TO DC-OPTION-CODE
  3901     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3902     IF NO-CONVERSION-ERROR
  3903        MOVE DC-GREG-DATE-A-EDIT TO WS-EFF-DATE
  3904     ELSE
  3905        MOVE '00/00/0000'        TO WS-EFF-DATE
  3906     END-IF
  3907     IF AM-EXPIRATION-DT = HIGH-VALUES
  3908        MOVE '99/99/9999'        TO WS-EXP-DATE
  3909     ELSE
  3910        MOVE AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  3911        MOVE ' '                 TO DC-OPTION-CODE
  3912        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  3913        IF NO-CONVERSION-ERROR
  3914           MOVE DC-GREG-DATE-A-EDIT
  3915                                 TO WS-EXP-DATE
  3916        ELSE
  3917           MOVE '00/00/0000'     TO WS-EXP-DATE
  3918        END-IF
  3919     END-IF
  3920     MOVE WS-BIN-ORIG-EFF-DT     TO DC-BIN-DATE-1
  3921     MOVE ' '                    TO DC-OPTION-CODE
  3922     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3923     IF NO-CONVERSION-ERROR
  3924        MOVE DC-GREG-DATE-A-EDIT TO WS-ORIG-EFF-DT
  3925     ELSE
  3926        MOVE '00/00/0000'        TO WS-ORIG-EFF-DT
  3927     END-IF
  3928     MOVE AM-COMMENT-LINE (2)    TO WS-POLICY-NO
  3929     PERFORM VARYING S1 FROM +7 BY +1 UNTIL
  3930        (S1 > +48)
  3931        OR (AM-COMMENT-LINE (2) (S1:3) = 'CID')
  3932     END-PERFORM
  3933     IF S1 > +48
  3934        MOVE SPACES              TO WS-CID-NO
  3935     ELSE
  3936        MOVE AM-COMMENT-LINE (2) (S1:8)
  3937                                 TO WS-CID-NO
  3938     END-IF
  3939     MOVE AM-NAME                TO WS-SHORT-ACCT-NAME
  3940                                    WS-LONG-ACCT-NAME
  3941     MOVE AM-PERSON              TO WS-CONTR-NAME
  3942*    IF AM-REPORT-CODE-3 = 'RLIC'
  3943        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  3944        MOVE '3'                 TO WS-NT-REC-TYPE
  3945        MOVE +1                  TO WS-NT-SEQ-NO
  3946
  3947* EXEC CICS READ
  3948*          DATASET    ('ERACNT')
  3949*          RIDFLD     (WS-NT-KEY)
  3950*          INTO       (NOTE-FILE)
  3951*          RESP       (WS-RESPONSE)
  3952*       END-EXEC
  3953     MOVE LENGTH OF
  3954      NOTE-FILE
  3955       TO DFHEIV11
  3956     MOVE 'ERACNT' TO DFHEIV1
  3957*    MOVE '&"IL       E          (  N#00003884' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* SOCK00.cbl
  3958     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3960     MOVE X'204E233030303033383834' TO DFHEIV0(25:11)
  3961     CALL 'kxdfhei1' USING DFHEIV0,
  3962           DFHEIV1,
  3963           NOTE-FILE,
  3964           DFHEIV11,
  3965           WS-NT-KEY,
  3966           DFHEIV99,
  3967           DFHEIV99,
  3968           DFHEIV99
  3969     MOVE EIBRESP  TO WS-RESPONSE
  3970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3971        IF RESP-NORMAL
  3972           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  3973              MOVE NT-SHIPPING-LINE TO WS-LONG-ACCT-NAME
  3974           END-IF
  3975        END-IF
  3976        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  3977        MOVE '3'                 TO WS-NT-REC-TYPE
  3978        MOVE +2                  TO WS-NT-SEQ-NO
  3979
  3980* EXEC CICS READ
  3981*          DATASET    ('ERACNT')
  3982*          RIDFLD     (WS-NT-KEY)
  3983*          INTO       (NOTE-FILE)
  3984*          RESP       (WS-RESPONSE)
  3985*       END-EXEC
  3986     MOVE LENGTH OF
  3987      NOTE-FILE
  3988       TO DFHEIV11
  3989     MOVE 'ERACNT' TO DFHEIV1
  3990*    MOVE '&"IL       E          (  N#00003898' TO DFHEIV0
  3991     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3992     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3993     MOVE X'204E233030303033383938' TO DFHEIV0(25:11)
  3994     CALL 'kxdfhei1' USING DFHEIV0,
  3995           DFHEIV1,
  3996           NOTE-FILE,
  3997           DFHEIV11,
  3998           WS-NT-KEY,
  3999           DFHEIV99,
  4000           DFHEIV99,
  4001           DFHEIV99
  4002     MOVE EIBRESP  TO WS-RESPONSE
  4003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4004        IF RESP-NORMAL
  4005           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  4006              MOVE NT-SHIPPING-LINE TO WS-CONTR-NAME
  4007           END-IF
  4008        END-IF
  4009*    END-IF
  4010     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4011        (S1 > +10)
  4012        OR (AM-COM-TYP (S1) = 'D' OR 'C')
  4013     END-PERFORM
  4014     IF S1 > +10
  4015        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* SOCK00.cbl
  4016     ELSE
  4017        PERFORM 0150-BUILD-DW-COMM
  4018                                 THRU 0150-EXIT
  4019     END-IF
  4020     MOVE SPACES                 TO WS-GA-DATA
  4021     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4022        (S1 > +10)
  4023        OR (AM-COM-TYP (S1) = 'O' OR 'P' OR 'K')
  4024     END-PERFORM
  4025     IF S1 > +10
  4026        MOVE ZEROS               TO WS-GA-NUM
  4027     ELSE
  4028        MOVE AM-AGT (S1)         TO WS-GA-NUM
  4029     END-IF
  4030     IF WS-GA-NUM NOT = ZEROS
  4031        PERFORM 0200-GET-ERCOMP  THRU 0200-EXIT
  4032     END-IF
  4033     .
  4034 0100-EXIT.
  4035     EXIT.
  4036 0150-BUILD-DW-COMM.
  4037     MOVE ZEROS                  TO WS-SL-COMM
  4038                                    WS-JL-COMM
  4039                                    WS-SAH-COMM
  4040                                    WS-JAH-COMM
  4041                                    WS-WORK-SAH-COMM
  4042                                    WS-WORK-JAH-COMM
  4043     IF (AM-L-COM (S1) NOT NUMERIC)
  4044        OR (AM-L-COMA (S1) (3:1) = 'L' OR 'M')
  4045        CONTINUE
  4046     ELSE
  4047        MOVE AM-L-COM (S1)       TO WS-SL-COMM
  4048     END-IF
  4049     IF (AM-J-COM (S1) NOT NUMERIC)
  4050        OR (AM-J-COMA (S1) (3:1) = 'L' OR 'M')
  4051        CONTINUE
  4052     ELSE
  4053        MOVE AM-J-COM (S1)       TO WS-JL-COMM
  4054     END-IF
  4055     IF (AM-A-COM (S1) NOT NUMERIC)
  4056        OR (AM-A-COMA (S1) (3:1) = 'L' OR 'M')
  4057        PERFORM 0160-ERCTBL-STARTBR
  4058                                 THRU 0160-EXIT
  4059        IF RESP-NORMAL
  4060           PERFORM 0165-ERCTBL-READNEXT
  4061                                 THRU 0165-EXIT
  4062           UNTIL
  4063           ((WS-WORK-SAH-COMM NOT = ZEROS)
  4064            AND (WS-WORK-JAH-COMM NOT = ZEROS))
  4065                       OR
  4066            END-OF-ERCTBL
  4067            MOVE WS-WORK-JAH-COMM TO WS-JAH-COMM
  4068            MOVE WS-WORK-SAH-COMM TO WS-SAH-COMM
  4069        END-IF
  4070     ELSE
  4071        MOVE AM-A-COM (S1)       TO WS-SAH-COMM
  4072                                    WS-JAH-COMM
  4073     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* SOCK00.cbl
  4074     .
  4075 0150-EXIT.
  4076     EXIT.
  4077 0160-ERCTBL-STARTBR.
  4078     MOVE AM-COMPANY-CD          TO WS-CT-COMPANY-CD
  4079     MOVE AM-A-COMA (S1)         TO WS-CT-TABLE
  4080     MOVE 'A'                    TO WS-CT-BEN-TYPE
  4081     MOVE LOW-VALUES             TO WS-CT-BEN-CODE
  4082     MOVE WS-CT-KEY              TO WS-CT-KEY-SAVE
  4083
  4084* EXEC CICS STARTBR
  4085*         DATASET    ('ERCTBL')
  4086*         RIDFLD     (WS-CT-KEY)
  4087*         GTEQ
  4088*         RESP       (WS-RESPONSE)
  4089*    END-EXEC
  4090     MOVE 'ERCTBL' TO DFHEIV1
  4091     MOVE 0
  4092       TO DFHEIV11
  4093*    MOVE '&,         G          &  N#00003983' TO DFHEIV0
  4094     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4095     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4096     MOVE X'204E233030303033393833' TO DFHEIV0(25:11)
  4097     CALL 'kxdfhei1' USING DFHEIV0,
  4098           DFHEIV1,
  4099           WS-CT-KEY,
  4100           DFHEIV99,
  4101           DFHEIV11,
  4102           DFHEIV99
  4103     MOVE EIBRESP  TO WS-RESPONSE
  4104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4105     .
  4106 0160-EXIT.
  4107     EXIT.
  4108 0165-ERCTBL-READNEXT.
  4109
  4110* EXEC CICS READNEXT
  4111*         INTO    (COMM-TABLE-RECORD)
  4112*         DATASET ('ERCTBL')
  4113*         RIDFLD  (WS-CT-KEY)
  4114*         RESP    (WS-RESPONSE)
  4115*    END-EXEC
  4116     MOVE LENGTH OF
  4117      COMM-TABLE-RECORD
  4118       TO DFHEIV12
  4119     MOVE 'ERCTBL' TO DFHEIV1
  4120     MOVE 0
  4121       TO DFHEIV11
  4122*    MOVE '&.IL                  )  N#00003993' TO DFHEIV0
  4123     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4124     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4125     MOVE X'204E233030303033393933' TO DFHEIV0(25:11)
  4126     CALL 'kxdfhei1' USING DFHEIV0,
  4127           DFHEIV1,
  4128           COMM-TABLE-RECORD,
  4129           DFHEIV12,
  4130           WS-CT-KEY,
  4131           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* SOCK00.cbl
  4132           DFHEIV11,
  4133           DFHEIV99,
  4134           DFHEIV99
  4135     MOVE EIBRESP  TO WS-RESPONSE
  4136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4137     IF (RESP-NORMAL)
  4138        AND (WS-CT-KEY (1:5) = WS-CT-KEY-SAVE (1:5))
  4139        PERFORM 0170-PROCESS-BEN-CODE
  4140                                 THRU 0170-EXIT
  4141     ELSE
  4142        SET END-OF-ERCTBL        TO TRUE
  4143     END-IF
  4144     .
  4145 0165-EXIT.
  4146     EXIT.
  4147 0170-PROCESS-BEN-CODE.
  4148     MOVE SPACES                 TO WS-CF-KEY
  4149     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4150     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4151     MOVE CT-BEN-CODE            TO WS-CF-ACCESS (3:2)
  4152     MOVE +0                     TO WS-CF-SEQ-NO
  4153     MOVE WS-CF-KEY              TO WS-CF-KEY-SAVE
  4154
  4155* EXEC CICS READ
  4156*         DATASET    ('ELCNTL')
  4157*         RIDFLD     (WS-CF-KEY)
  4158*         INTO       (CONTROL-FILE)
  4159*         GTEQ
  4160*         RESP       (WS-RESPONSE)
  4161*    END-EXEC
  4162     MOVE LENGTH OF
  4163      CONTROL-FILE
  4164       TO DFHEIV11
  4165     MOVE 'ELCNTL' TO DFHEIV1
  4166*    MOVE '&"IL       G          (  N#00004016' TO DFHEIV0
  4167     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4169     MOVE X'204E233030303034303136' TO DFHEIV0(25:11)
  4170     CALL 'kxdfhei1' USING DFHEIV0,
  4171           DFHEIV1,
  4172           CONTROL-FILE,
  4173           DFHEIV11,
  4174           WS-CF-KEY,
  4175           DFHEIV99,
  4176           DFHEIV99,
  4177           DFHEIV99
  4178     MOVE EIBRESP  TO WS-RESPONSE
  4179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4180     IF NOT RESP-NORMAL
  4181        MOVE WS-RESPONSE         TO WS-DISP-RESP
  4182        DISPLAY ' ERROR - ELCNTL - READ ' WS-DISP-RESP
  4183        GO TO 0170-EXIT
  4184     END-IF
  4185     IF WS-CF-KEY (1:4) = WS-CF-KEY-SAVE (1:4)
  4186        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  4187           (S2 > +8)
  4188           OR (CT-BEN-CODE = CF-BENEFIT-CODE (S2))
  4189        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* SOCK00.cbl
  4190        IF CT-BEN-CODE = CF-BENEFIT-CODE (S2)
  4191           IF CF-JOINT-INDICATOR (S2) = 'J'
  4192              IF WS-WORK-JAH-COMM = ZEROS
  4193                 MOVE CT-RT (1)  TO WS-WORK-JAH-COMM
  4194              END-IF
  4195           ELSE
  4196              IF WS-WORK-SAH-COMM = ZEROS
  4197                 MOVE CT-RT (1)  TO WS-WORK-SAH-COMM
  4198              END-IF
  4199           END-IF
  4200        END-IF
  4201     END-IF
  4202     .
  4203 0170-EXIT.
  4204     EXIT.
  4205 0200-GET-ERCOMP.
  4206     MOVE LOW-VALUES             TO WS-CO-KEY
  4207     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  4208     MOVE AM-CARRIER             TO WS-CO-CARRIER
  4209     MOVE AM-GROUPING            TO WS-CO-GROUP
  4210     MOVE WS-GA-NUM              TO WS-CO-FIN-RESP
  4211     MOVE LOW-VALUES             TO WS-CO-ACCOUNT
  4212     MOVE 'G'                    TO WS-CO-TYPE
  4213
  4214* EXEC CICS READ
  4215*         INTO    (COMPENSATION-MASTER)
  4216*         DATASET ('ERCOMP')
  4217*         RIDFLD  (WS-CO-KEY)
  4218*         RESP    (WS-RESPONSE)
  4219*    END-EXEC
  4220     MOVE LENGTH OF
  4221      COMPENSATION-MASTER
  4222       TO DFHEIV11
  4223     MOVE 'ERCOMP' TO DFHEIV1
  4224*    MOVE '&"IL       E          (  N#00004056' TO DFHEIV0
  4225     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4226     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4227     MOVE X'204E233030303034303536' TO DFHEIV0(25:11)
  4228     CALL 'kxdfhei1' USING DFHEIV0,
  4229           DFHEIV1,
  4230           COMPENSATION-MASTER,
  4231           DFHEIV11,
  4232           WS-CO-KEY,
  4233           DFHEIV99,
  4234           DFHEIV99,
  4235           DFHEIV99
  4236     MOVE EIBRESP  TO WS-RESPONSE
  4237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4238     IF RESP-NORMAL
  4239        MOVE CO-CONTROL-NAME     TO WS-GA-PRIMARY-CONTACT
  4240        MOVE CO-ACCT-NAME        TO WS-GA-NAME
  4241        MOVE CO-MAIL-NAME        TO WS-GA-MAIL-NAME
  4242        MOVE CO-ADDR-1           TO WS-GA-ADDR1
  4243        MOVE CO-ADDR-2           TO WS-GA-ADDR2
  4244*       MOVE CO-ADDR-3           TO WS-GA-ADDR3
  4245        MOVE SPACES              TO WS-GA-ADDR3
  4246        STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  4247           DELIMITED BY '  ' INTO WS-GA-ADDR3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* SOCK00.cbl
  4248        END-STRING
  4249        MOVE CO-ZIP              TO WS-GA-ZIP
  4250        MOVE CO-TELEPHONE        TO WS-GA-PHONE
  4251     ELSE
  4252        MOVE SPACES              TO WS-GA-DATA
  4253        MOVE 'GA NOT FOUND '     TO WS-GA-NAME
  4254     END-IF
  4255     .
  4256 0200-EXIT.
  4257     EXIT.
  4258 0300-get-rates.
  4259     move +30                    to ws-send-msg-size
  4260     move ws-recv-buf (1:31)     to ws-get-rate-data
  4261     if rate-apr not numeric
  4262        move zeros               to rate-apr
  4263     end-if
  4264     move rate-apr               to ws-work-apr
  4265     if rate-ben-amt not numeric
  4266        move zeros               to rate-ben-amt
  4267     end-if
  4268     move rate-ben-amt           to ws-work-ben
  4269     if rate-term not numeric
  4270        move zeros               to rate-term
  4271     end-if
  4272     move rate-term              to ws-work-term
  4273     move rate-eff-date (7:4)    to ws-work-date (1:4)
  4274     move rate-eff-date (1:2)    to ws-work-date (5:2)
  4275     move rate-eff-date (4:2)    to ws-work-date (7:2)
  4276     move ws-work-date-num       to dc-greg-date-cymd
  4277     move 'L'                    to dc-option-code
  4278     perform 9700-date-link      thru 9700-exit
  4279     if no-conversion-error
  4280        move dc-bin-date-1       to ws-bin-eff-dt
  4281     else
  4282        move 'bad eff dt convert ' to ws-send-buf
  4283        go to send-rate-buf
  4284     end-if
  4285     move +1                     to dc-elapsed-months
  4286     move +0                     to dc-elapsed-days
  4287     move '6'                    to dc-option-code
  4288     perform 9700-date-link      thru 9700-exit
  4289     if no-conversion-error
  4290        move dc-bin-date-2       to ws-bin-1st-pay-dt
  4291     else
  4292        move 'bad 1st dt convert ' to ws-send-buf
  4293        go to send-rate-buf
  4294     end-if
  4295*    move spaces                 to calculation-pass-area
  4296     move zeros                  to cp-r-max-mon-ben
  4297                                    cp-r-max-tot-ben
  4298                                    cp-class-code
  4299                                    cp-deviation-code
  4300                                    cp-rate-dev-pct
  4301                                    cp-original-premium
  4302                                    cp-critical-months
  4303                                    cp-term-or-ext-days
  4304     move rate-state             to cp-state
  4305                                    cp-state-std-abbrv
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* SOCK00.cbl
  4306     move rate-lf-ah             to cp-benefit-type
  4307     move rate-ben-code          to cp-benefit-cd
  4308     move ws-ben-num             to cp-original-benefit
  4309                                    cp-rating-benefit-amt
  4310     move 40                     to cp-issue-age
  4311     move WS-COMP-ID             to cp-company-id
  4312     move WS-COMP-CD             to cp-company-cd
  4313     move ws-apr-num             to cp-loan-apr
  4314     move ws-term-num            to cp-original-term
  4315                                    cp-loan-term
  4316                                    cp-remaining-term
  4317     move 'L'                    to cp-life-override-code
  4318     move 'A'                    to cp-ah-override-code
  4319     move '3'                    to cp-process-type
  4320     move rate-earn-meth         to cp-earning-method
  4321                                    cp-rating-method
  4322     move 'R'                    to cp-rate-file
  4323     move ws-bin-eff-dt          to cp-cert-eff-dt
  4324     move ws-bin-1st-pay-dt      to cp-first-pay-date
  4325     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4326     if not no-cp-error
  4327        move cp-return-code      to ws-send-buf
  4328     else
  4329        move cp-calc-premium     to ws-disp-amt
  4330        move cp-premium-rate     to ws-disp-rate
  4331        string ws-disp-amt ';' ws-disp-rate delimited
  4332           by size into ws-send-buf
  4333        end-string
  4334     end-if
  4335     .
  4336 SEND-RATE-BUF.
  4337     display 'SOCK00:About to send      '
  4338     display 'SOCK00:sequence number  =', ws-seq-num.
  4339     display 'SOCK00:send buffer      =', ws-send-buf(1:30).
  4340     call "send" using by value GIVE-TAKE-SOCKET,
  4341         by reference ws-send-buf,
  4342         by value ws-send-msg-size,
  4343         by value ws-flags.
  4344     if return-code <= zero
  4345         display 'SOCK00:send error ',
  4346         go to socket-error.
  4347     GO TO SOCKET-FIN
  4348     .
  4349 0300-exit.
  4350     exit.
  4351 0400-GET-ACT-ACCTS.
  4352     MOVE WS-RECV-BUF (1:2)      TO CLIENT-ST
  4353     MOVE ' '                    TO WS-BUILD-SW
  4354     MOVE LOW-VALUES             TO WS-AM-KEY
  4355     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4356     PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4357     IF NOT RESP-NORMAL
  4358        MOVE 'BAD STARTBR ON ERACCT  '
  4359                                 TO WS-SEND-BUF
  4360        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4361        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4362        GO TO SEND-BUFFER
  4363     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* SOCK00.cbl
  4364     PERFORM 0420-READNEXT-ERACCT
  4365                                 THRU 0420-EXIT
  4366     IF NOT RESP-NORMAL
  4367        MOVE 'BAD READNEXT ON ERACCT '
  4368                                 TO WS-SEND-BUF
  4369        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4370        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4371        GO TO SEND-BUFFER
  4372     ELSE
  4373        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4374        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4375     END-IF
  4376     PERFORM UNTIL END-OF-ERACCT
  4377        IF NOT (RESP-NORMAL)
  4378           OR (AM-COMPANY-CD > WS-COMP-CD)
  4379           SET END-OF-ERACCT     TO TRUE
  4380        ELSE
  4381           IF AM-ACCOUNT NOT = WS-SAVE-ACCOUNT
  4382              MOVE AM-EFFECTIVE-DT TO WS-BIN-ORIG-EFF-DT
  4383           END-IF
  4384           IF (AM-STATE = CLIENT-ST)
  4385              AND (AM-EXPIRATION-DT = HIGH-VALUES)
  4386*             AND (AM-STATUS = '0')
  4387              PERFORM 0030-BUILD-BUFFER
  4388                                 THRU 0030-EXIT
  4389              PERFORM 0430-SEND-BUFFER
  4390                                 THRU 0430-EXIT
  4391           END-IF
  4392           PERFORM 0420-READNEXT-ERACCT
  4393                                 THRU 0420-EXIT
  4394        END-IF
  4395     END-PERFORM
  4396     GO TO SOCKET-FIN
  4397     .
  4398 0400-EXIT.
  4399     EXIT.
  4400 0410-STARTBR-ERACCT.
  4401
  4402* EXEC CICS STARTBR
  4403*         DATASET    ('ERACCT')
  4404*         RIDFLD     (WS-AM-KEY)
  4405*         GTEQ
  4406*         RESP       (WS-RESPONSE)
  4407*    END-EXEC
  4408     MOVE 'ERACCT' TO DFHEIV1
  4409     MOVE 0
  4410       TO DFHEIV11
  4411*    MOVE '&,         G          &  N#00004225' TO DFHEIV0
  4412     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4413     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4414     MOVE X'204E233030303034323235' TO DFHEIV0(25:11)
  4415     CALL 'kxdfhei1' USING DFHEIV0,
  4416           DFHEIV1,
  4417           WS-AM-KEY,
  4418           DFHEIV99,
  4419           DFHEIV11,
  4420           DFHEIV99
  4421     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* SOCK00.cbl
  4422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4423     .
  4424 0410-EXIT.
  4425     EXIT.
  4426 0420-READNEXT-ERACCT.
  4427
  4428* EXEC CICS READNEXT
  4429*         INTO    (ACCOUNT-MASTER)
  4430*         DATASET ('ERACCT')
  4431*         RIDFLD  (WS-AM-KEY)
  4432*         RESP    (WS-RESPONSE)
  4433*    END-EXEC
  4434     MOVE LENGTH OF
  4435      ACCOUNT-MASTER
  4436       TO DFHEIV12
  4437     MOVE 'ERACCT' TO DFHEIV1
  4438     MOVE 0
  4439       TO DFHEIV11
  4440*    MOVE '&.IL                  )  N#00004235' TO DFHEIV0
  4441     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4442     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4443     MOVE X'204E233030303034323335' TO DFHEIV0(25:11)
  4444     CALL 'kxdfhei1' USING DFHEIV0,
  4445           DFHEIV1,
  4446           ACCOUNT-MASTER,
  4447           DFHEIV12,
  4448           WS-AM-KEY,
  4449           DFHEIV99,
  4450           DFHEIV11,
  4451           DFHEIV99,
  4452           DFHEIV99
  4453     MOVE EIBRESP  TO WS-RESPONSE
  4454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4455     .
  4456 0420-EXIT.
  4457     EXIT.
  4458 0430-SEND-BUFFER.
  4459     display 'SOCK00:About to send      '
  4460     display 'SOCK00:sequence number  =', ws-seq-num.
  4461     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  4462     call "send" using by value GIVE-TAKE-SOCKET,
  4463         by reference ws-send-buf,
  4464         by value ws-send-msg-size,
  4465         by value ws-flags.
  4466     if return-code <= zero
  4467         display 'SOCK00:send error ',
  4468         go to socket-error.
  4469     .
  4470 0430-EXIT.
  4471     EXIT.
  4472 0500-GET-ONE-ACCT.
  4473     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4474     MOVE CLIENT-CAR             TO WS-AM-CARRIER
  4475     MOVE CLIENT-GRP             TO WS-AM-GROUP
  4476     MOVE CLIENT-ST              TO WS-AM-STATE
  4477     MOVE CLIENT-ACT             TO WS-AM-ACCOUNT
  4478     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4479     MOVE '5'                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* SOCK00.cbl
  4480     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4481     MOVE DC-BIN-DATE-1          TO WS-AM-EXP-DT
  4482     MOVE LOW-VALUES             TO WS-AM-EXP-DT
  4483     MOVE ' '                    TO WS-BUILD-SW
  4484    PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4485     IF NOT RESP-NORMAL
  4486        MOVE 'BAD STARTBR ON ERACCT  '
  4487                                 TO WS-SEND-BUF
  4488        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4489        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4490        GO TO SEND-BUFFER
  4491     END-IF
  4492     PERFORM 0420-READNEXT-ERACCT
  4493                                 THRU 0420-EXIT
  4494     IF NOT RESP-NORMAL
  4495        MOVE 'BAD READNEXT ON ERACCT '
  4496                                 TO WS-SEND-BUF
  4497        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4498        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4499        GO TO SEND-BUFFER
  4500     ELSE
  4501        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4502        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4503     END-IF
  4504     PERFORM UNTIL
  4505        (TIME-TO-BUILD)
  4506        IF AM-ACCOUNT = CLIENT-ACT
  4507           IF AM-EXPIRATION-DT = HIGH-VALUES
  4508              SET TIME-TO-BUILD  TO TRUE
  4509           ELSE
  4510              MOVE ACCOUNT-MASTER
  4511                                 TO WS-SAVE-ERACCT
  4512              PERFORM 0420-READNEXT-ERACCT
  4513                                 THRU 0420-EXIT
  4514              IF NOT RESP-NORMAL
  4515                 MOVE WS-SAVE-ERACCT
  4516                                 TO ACCOUNT-MASTER
  4517                 SET TIME-TO-BUILD
  4518                                 TO TRUE
  4519              END-IF
  4520           END-IF
  4521        ELSE
  4522           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  4523           SET TIME-TO-BUILD     TO TRUE
  4524        END-IF
  4525     END-PERFORM
  4526     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4527     PERFORM 0430-SEND-BUFFER    THRU 0430-EXIT
  4528     GO TO SOCKET-FIN
  4529     .
  4530 0500-EXIT.
  4531     EXIT.
  4532 7000-GET-RATE.
  4533
  4534* EXEC CICS LINK
  4535*       PROGRAM ('ELRATE')
  4536*       COMMAREA (CALCULATION-PASS-AREA)
  4537*       LENGTH   (CP-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* SOCK00.cbl
  4538*    END-EXEC
  4539     MOVE 'ELRATE' TO DFHEIV1
  4540*    MOVE '."C                   ''   #00004319' TO DFHEIV0
  4541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4542     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4543     MOVE X'2020233030303034333139' TO DFHEIV0(25:11)
  4544     CALL 'kxdfhei1' USING DFHEIV0,
  4545           DFHEIV1,
  4546           CALCULATION-PASS-AREA,
  4547           CP-COMM-LENGTH,
  4548           DFHEIV99,
  4549           DFHEIV99,
  4550           DFHEIV99
  4551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4552     .
  4553 7000-EXIT.
  4554     EXIT.
  4555 9700-DATE-LINK.
  4556
  4557* EXEC CICS LINK
  4558*         PROGRAM  ('ELDATCV')
  4559*         COMMAREA (DATE-CONVERSION-DATA)
  4560*         LENGTH   (DC-COMM-LENGTH)
  4561*    END-EXEC.
  4562     MOVE 'ELDATCV' TO DFHEIV1
  4563*    MOVE '."C                   ''   #00004328' TO DFHEIV0
  4564     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4565     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4566     MOVE X'2020233030303034333238' TO DFHEIV0(25:11)
  4567     CALL 'kxdfhei1' USING DFHEIV0,
  4568           DFHEIV1,
  4569           DATE-CONVERSION-DATA,
  4570           DC-COMM-LENGTH,
  4571           DFHEIV99,
  4572           DFHEIV99,
  4573           DFHEIV99
  4574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4575
  4576 9700-EXIT.
  4577      EXIT.
  4578
  4579 9999-DFHBACK SECTION.
  4580     MOVE '9%                    "   ' TO DFHEIV0
  4581     MOVE 'SOCK00' TO DFHEIV1
  4582     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4583     GOBACK.
  4584 9999-DFHEXIT.
  4585     IF DFHEIGDJ EQUAL 0001
  4586         NEXT SENTENCE.
  4587     MOVE '9%                    "   ' TO DFHEIV0
  4588     MOVE 'SOCK00' TO DFHEIV1
  4589     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4590     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16548     Code:        8728
