* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   3
* EL050.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    66
    67 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    73                                   USAGE IS POINTER.
    74 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    76                                   USAGE IS POINTER.
    77 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    82 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    83                                   USAGE IS POINTER.
    84
    85*    COPY ELC50WS.
    86*****************************************************************
    87*                                                               *
    88*                            ELC50WS.                           *
    89*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    90*                            VMOD=2.061.                        *
    91*                                                               *
    92*   THIS IS THE WORKING STORAGE FOR EL050                       *
    93*                                   EL517                       *
    94*****************************************************************
    95******************************************************************
    96*                   C H A N G E   L O G
    97*
    98* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    99*-----------------------------------------------------------------
   100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   101* EFFECTIVE    NUMBER
   102*-----------------------------------------------------------------
   103* 123102                   PEMA  ADD DCC PROCESSING
   104* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   105* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   106* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   108* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   109* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   110* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   111* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   112* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   113* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   114* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   115* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   116* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   117* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   4
* EL050.cbl
   118* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   119* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   120* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   121* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   122* 030309  CR2009021700001  PEMA  ADD ER-2883
   123* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   124* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   125* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   126* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   127* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   128* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   129* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   130* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   131* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   132* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   133* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   134* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   135* 061412  CR2011022800001  AJRA  NAPERSOFT
   136* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   137* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   138* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   139* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   140* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   141* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   142* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   143* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   144* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   145* 091114  IR2014091000001  TANA  ADD ERROR 2898
   146* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   147* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   148*-----------------------------------------------------------------
   149
   150 01  WORK-AREAS.
   151
   152*****************************************************************
   153*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   154*****************************************************************
   155
   156     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   157     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   158     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   159     12  WS-NAME-EDIT-WORK-AREA.
   160         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   161         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   162             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   163         16  WS-WORK-NAME.
   164             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   165             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   166             20  FILLER           PIC X(10)     VALUE SPACES.
   167         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   168             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   169
   170*****************************************************************
   171*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   172*****************************************************************
   173
   174     12  WS-ERRESC-KEY.
   175         16 WS-ERRESC-SEARCH-KEY.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   5
* EL050.cbl
   176             20  WS-ERRESC-COMPANY-CD PIC  X.
   177             20  WS-ERRESC-CARRIER    PIC  X.
   178             20  WS-ERRESC-GROUP      PIC X(6).
   179             20  WS-ERRESC-STATE      PIC XX.
   180             20  WS-ERRESC-ACCOUNT    PIC X(10).
   181         16 WS-ERRESC-RESIDUAL-KEY.
   182             20  WS-ERRESC-AGENT      PIC X(10).
   183             20  WS-ERRESC-RES-STATE  PIC XX.
   184             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   185*                                          YYYYMMDD
   186     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   187     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   188
   189*RESIDENT STATE TAX MASTER(ERRESS)
   190*
   191     12  WS-ERRESS-KEY.
   192         16  WS-ERRESS-COMPANY-CD      PIC  X.
   193         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   194         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   195         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   196*                                          YYYYMMDD
   197
   198     12  WS-CONTRACT-DATE              PIC 9(8).
   199*                                          YYYYMMDD
   200     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   201     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   202         16 WS-YEAR-YY                 PIC   9999.
   203         16 FILLER                     PIC 9(4).
   204*                                          YYYYMMDD
   205     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   206     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   207     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   208     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   209
   210     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   211         88  DPRB-1ST-TIME                      VALUE ' '.
   212
   213*****************************************************************
   214*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   215*****************************************************************
   216
   217     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   218     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   219     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   220     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   221     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   223     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   224     12  ws-st-agent-sig-edit    pic x          value spaces.
   225     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   226     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   227     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   228     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   229         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   230         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   231     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   232         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   233         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   6
* EL050.cbl
   234     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   235
   236     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   237     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   238
   239     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   240     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   253     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   254     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   275     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   276     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   277     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   278     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   287     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   288     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   289     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   290     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   291     12  WS-2671-SW               PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   7
* EL050.cbl
   292     12  WS-2672-SW               PIC X         VALUE SPACE.
   293     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   294         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   295     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   296         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   297     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   298
   299     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   300         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   301         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   302         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   303         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   304
   305     12  WS-CREDIT-EDIT-CONTROLS.
   306         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   307         16  WS-MIN-AGE           PIC 99                VALUE  0.
   308         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   309         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   310         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   311         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   312
   313     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   314     12  WS-AGE-FIELDS.
   315         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   316         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   317         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   318         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   319
   320     12  WS-SAVE-ALLOWABLE-BENEFIT.
   321         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   322         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   323         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   324         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   325         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   326         16  FILLER                      PIC XX.
   327
   328     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   329     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   330     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   331     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   332     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   333     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   334     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   335     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   336     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   337     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   338
   339     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   340     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   341     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   342     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   343     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   344     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   345     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   346     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   347         88  WS-REDUCING              VALUE 'R'.
   348         88  WS-LEVEL                 VALUE 'L' 'P'.
   349     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   8
* EL050.cbl
   350
   351     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   352     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   353     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   354     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   355     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   356     12  ws-ah-max-bens           pic 99        value zeros.
   357     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   358     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   359     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   360     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   361
   362     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   364     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   365     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   366     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   367     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   368     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   369     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   370     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   371     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   372     12  WS-ACCT-SIG-SW.
   373         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   374         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   375     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   376     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   377     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   379     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   382     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  WS-INITIALS.
   385         16  WS-INIT-1            PIC X         VALUE SPACES.
   386         16  WS-INIT-2            PIC X         VALUE SPACES.
   387
   388     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   389     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   390     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   391     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   392     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   393*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   394     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   401     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   402     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   404     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   405     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   406     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   407     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page   9
* EL050.cbl
   408     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416******** FLA
   417     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   418     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   419     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   421     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   422********
   423     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   424     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   425     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   426     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   427     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   428     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   429     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   430     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   431     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   432     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   433
   434     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   435         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   436                                         '0' THRU '9'.
   437
   438     12  NUMBER-OF-MONTHS.
   439         16  SK-MO OCCURS 12 TIMES PIC X.
   440
   441     12  WS-WORK-DATE.
   442         16  WS-YEAR            PIC 99    VALUE 00.
   443         16  WS-MONTH           PIC 99    VALUE 00.
   444         16  WS-DAY             PIC 99    VALUE 00.
   445
   446     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   447     12  WS-WORK-CRIT-DEV       REDEFINES
   448         WS-WORK-LF-CRIT-PER    PIC X(03).
   449
   450     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   451     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   452
   453     12  WS-WORK-DATE-FROM.
   454         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   455         16  FILLER             PIC X  VALUE SPACE.
   456         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   457         16  FILLER             PIC X         VALUE SPACE.
   458         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   459
   460     12  WS-WORK-DATE-THRU.
   461         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   462         16  FILLER             PIC X         VALUE SPACE.
   463         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X         VALUE SPACE.
   465         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  10
* EL050.cbl
   466
   467     12  WS-LF-INPUT-CD.
   468         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   469         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   470
   471     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   472     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   473         16  WS-AH-INPUT-CD-1   PIC X.
   474         16  WS-AH-INPUT-CD-2-3 PIC XX.
   475
   476     12  WS-SWITCHES.
   477         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   478         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   479             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   480         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   481             88  BANK-ACCT-FOUND          VALUE 'Y'.
   482         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   484         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   486         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   487             88  COMP-MASTER-FOUND        VALUE 'Y'.
   488         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   489             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   490         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   491             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   492         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   493             88  STAT-MASTER-FOUND        VALUE 'Y'.
   494         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   495             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   496         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   497             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   498         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   499             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   500         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   501             88  FORM-MASTER-FOUND        VALUE 'Y'.
   502         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   503             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   504         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   505             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   506         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   507             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   508         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   509             88  NO-BENEFIT-FOUND         VALUE 'N'.
   510         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   511             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   512         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   513             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   514         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   515             88  AH-BENEFIT-FOUND         VALUE ' '.
   516             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   517         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   518             88  LF-BENEFIT-FOUND         VALUE ' '.
   519             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   520         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   521             88  NO-STATE-RECORD          VALUE '1'.
   522         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   523             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  11
* EL050.cbl
   524         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   525             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   526         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   527             88  CERT-WAS-FOUND           VALUE ' '.
   528             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   529         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   530             88  BROWSE-STARTED           VALUE 'Y'.
   531         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   532             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   533         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   534             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   535         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   536             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   537         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   538             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   539         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   540             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   541         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   542             88  APP-CERT-USED            VALUE 'Y' 'A'.
   543         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   544             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   545             88  FIRST-TIME-THROUGH       VALUE '1'.
   546             88  CTBL-NOT-FOUND           VALUE '2'.
   547
   548         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   549             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   550
   551         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   552             88  DLO-ERROR-FOUND          VALUE 'Y'.
   553
   554********FLA
   555     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   556     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   557********
   558     12  RC-SW-1                  PIC X           VALUE '0'.
   559     12  RC-SW-2                  PIC X           VALUE '0'.
   560     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   561     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   562     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   570     12  LIT-SPACES               PIC X           VALUE SPACES.
   571     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   572     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   573     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   574     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   575     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   576     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   577     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   578         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   579         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   580     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   581         88  SKIP-ADDR-EDIT         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  12
* EL050.cbl
   582
   583 01  WS-EXTRA-PERIODS-BY-STATE.
   584     12  WS-INT-PERIODS          PIC 9.
   585     12  WS-EXTRA-PMTS           PIC 9.
   586 01  ws-net-only-state           pic x value 'N'.
   587 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   588     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   589     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   590 01  WS-CRI-SSN-WORK-AREA.
   591     05  WS-CRI-SOC-SEC-NO.
   592         10  WS-SS-REPT-CD       PIC X(5).
   593         10  WS-SS-LAST-NAME     PIC X(5).
   594         10  WS-SS-INITIAL       PIC X.
   595
   596     05  WS-CRI-REPORT-CODE.
   597         10  FILLER              PIC X(5).
   598         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   599
   600     05  WS-CRI-LAST-NAME.
   601         10  WS-CRI-NAME-MOVE    PIC X(5).
   602         10  FILLER              PIC X(10).
   603
   604 01  WS-NUM-TABLE                PIC X(26)  VALUE
   605     '12345678012345070923456789'.
   606 01  FILLER REDEFINES WS-NUM-TABLE.
   607     05  WS-NUM OCCURS 26        PIC 9.
   608 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   609 01  V1                          PIC S999 COMP-3.
   610 01  V2                          PIC S999 COMP-3.
   611 01  V3                          PIC S999 COMP-3.
   612 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   613 01  FILLER REDEFINES WS-WORK-VIN.
   614     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   615 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   616 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   617 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   618 01  WS-HEX-WORK.
   619     05  FILLER                  PIC X  VALUE LOW-VALUES.
   620     05  WS-HEX-BYTE             PIC X.
   621 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   622 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   623 01  WS-WORK-HIN-ROW-B.
   624     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   625
   626 01  ws-benefit-cd-chg-sw      pic x value spaces.
   627     88  benefit-code-chg           value 'Y'.
   628 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   629 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   630     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   631 01  WS-ROW-D-TABLE.
   632     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   633
   634 01  WS-HIN-TABLE-B.
   635     05  F                       PIC XX VALUE 'A2'.
   636     05  F                       PIC XX VALUE 'B3'.
   637     05  F                       PIC XX VALUE 'C4'.
   638     05  F                       PIC XX VALUE 'D5'.
   639     05  F                       PIC XX VALUE 'E6'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  13
* EL050.cbl
   640     05  F                       PIC XX VALUE 'F7'.
   641     05  F                       PIC XX VALUE 'G8'.
   642     05  F                       PIC XX VALUE 'H9'.
   643     05  F                       PIC XX VALUE 'I1'.
   644     05  F                       PIC XX VALUE 'J2'.
   645     05  F                       PIC XX VALUE 'K3'.
   646     05  F                       PIC XX VALUE 'L4'.
   647     05  F                       PIC XX VALUE 'M5'.
   648     05  F                       PIC XX VALUE 'N6'.
   649     05  F                       PIC XX VALUE 'O0'.
   650     05  F                       PIC XX VALUE 'P7'.
   651     05  F                       PIC XX VALUE 'Q0'.
   652     05  F                       PIC XX VALUE 'R8'.
   653     05  F                       PIC XX VALUE 'S9'.
   654     05  F                       PIC XX VALUE 'T2'.
   655     05  F                       PIC XX VALUE 'U3'.
   656     05  F                       PIC XX VALUE 'V4'.
   657     05  F                       PIC XX VALUE 'W5'.
   658     05  F                       PIC XX VALUE 'X6'.
   659     05  F                       PIC XX VALUE 'Y7'.
   660     05  F                       PIC XX VALUE 'Z8'.
   661 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   662     05  WS-VAL-IN               PIC X.
   663     05  WS-VAL-OUT              PIC 9.
   664 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   665 01  WS-COMPARE-BINARY-DATES.
   666     05  WS-971231                PIC XX VALUE X'92FF'.
   667     05  WS-931231                PIC XX VALUE X'8CFF'.
   668     05  WS-791231                PIC XX VALUE X'77FF'.
   669     05  WS-771001                PIC XX VALUE X'74A1'.
   670     05  WS-820301                PIC XX VALUE X'7B41'.
   671     05  WS-831031                PIC XX VALUE X'7DBF'.
   672     05  WS-831231                PIC XX VALUE X'7DFF'.
   673     05  WS-810831                PIC XX VALUE X'7A7F'.
   674     05  WS-830901                PIC XX VALUE X'7D81'.
   675
   676 01  FILE-ACCESS-IDS.
   677     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   678     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   679     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   680     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   681     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   682     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   683     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   684     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   685     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   686     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   687     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   688     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   689     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   690     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   691     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   692     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   693     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   694 01  DD-IU-SW                    PIC X   VALUE ' '.
   695     88  DD-IU-PRESENT                 VALUE 'Y'.
   696
   697 01  ACCESS-KEYS.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  14
* EL050.cbl
   698     12  ELMSTR-KEY.
   699         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   701     12  W-CLAIM-KEY.
   702         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   704
   705     12  ELCNTL-KEY.
   706         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   707         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   708         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   709         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   710
   711     12  ELCERT-KEY.
   712         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   713         16  CERT-CARRIER         PIC X       VALUE SPACE.
   714         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   715         16  CERT-STATE           PIC XX      VALUE SPACES.
   716         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   717         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   718         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   719
   720     12  ELCERT2-KEY.
   721         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   722         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   723
   724     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   725
   726     12  ELCERT-SAVE.
   727         16  FILLER                      PIC XX    VALUE SPACES.
   728
   729         16  WCS-CONTROL-PRIMARY.
   730             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   731             20  WCS-CARRIER             PIC X     VALUE SPACE.
   732             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   733             20  WCS-STATE               PIC XX    VALUE SPACES.
   734             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   735             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   736             20  WCS-CERT-NO.
   737                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   738                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   739
   740         16  CS-CONTROL-BY-NAME.
   741             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   742             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   743             20  CS-INSURED-INITIALS.
   744                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   745                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   746
   747         16  CS-CONTROL-BY-SSN.
   748             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   749             20  CS-SOC-SEC-NO.
   750                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   751                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   752                 24  CS-SSN-LN3.
   753                     28 CS-INSURED-INITIALS-A2   PIC XX
   754                                     VALUE SPACES.
   755                     28 CS-PART-LAST-NAME-A2     PIC X
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  15
* EL050.cbl
   756                                     VALUE SPACE.
   757
   758         16  CS-CONTROL-BY-CERT-NO.
   759             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   760             20  CS-CERT-NO-A4           PIC X(11)
   761                                     VALUE SPACES.
   762
   763         16  CS-CONTROL-BY-MEMB.
   764             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   765             20  CS-MEMBER-NO.
   766                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   767                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   768                 24  CS-MEMB-LN4.
   769                     28 CS-INSURED-INITIALS-A5   PIC XX
   770                                      VALUE SPACES.
   771                     28 CS-PART-LAST-NAME-A5     PIC XX
   772                                      VALUE SPACES.
   773
   774         16  FILLER              PIC X(360) VALUE SPACES.
   775
   776     12  ERACCT-KEY.
   777         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   778         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   779         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   780         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   781         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   782         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   783
   784     12  ERCOMP-KEY.
   785         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   786         16  COMP-CARRIER         PIC X     VALUE SPACES.
   787         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   788         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   789         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   790         16  COMP-TYPE            PIC X     VALUE SPACES.
   791
   792     12  ERLOFC-KEY.
   793         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   794         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   795         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   796         16  LOFC-STATE           PIC XX    VALUE SPACES.
   797         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   798         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   799
   800     12  WS-ELCRTT-KEY.
   801         16  WS-ELCRTT-PRIMARY       PIC X(33).
   802         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   803
   804     12  ERBXRF-KEY.
   805         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   807         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   808         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   809
   810     12  ERAGTC-KEY.
   811         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   812         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   813         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  16
* EL050.cbl
   814         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   815         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   816         16  AGTC-TYPE            PIC X     VALUE SPACES.
   817
   818     12  ERPLAN-KEY.
   819         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   821         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   822         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   823         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   824         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   825         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   826         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   827
   828     12  ERFORM-KEY.
   829         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   830         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   831         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   832         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   833
   834     12  ERREIN-KEY.
   835         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   836         16  REIN-TYPE            PIC X     VALUE SPACES.
   837         16  REIN-TABLE-CO.
   838             20  REIN-CODE-1      PIC X     VALUE SPACE.
   839             20  REIN-CODE-2      PIC X     VALUE SPACE.
   840             20  REIN-CODE-3      PIC X     VALUE SPACE.
   841         16  FILLER               PIC X(3)  VALUE SPACES.
   842
   843     12  ERCTBL-KEY.
   844         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   845         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   846         16  CTBL-CNTRL-2.
   847             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   848             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   849
   850     12  ELCRTO-KEY.
   851         16  ELCRTO-COMPANY-CD       PIC X.
   852         16  ELCRTO-CARRIER          PIC X.
   853         16  ELCRTO-GROUPING         PIC X(6).
   854         16  ELCRTO-STATE            PIC XX.
   855         16  ELCRTO-ACCOUNT          PIC X(10).
   856         16  ELCRTO-CERT-EFF-DT      PIC XX.
   857         16  ELCRTO-CERT-NO.
   858             20  ELCRTO-CERT-PRIME   PIC X(10).
   859             20  ELCRTO-CERT-SFX     PIC X.
   860         16  ELCRTO-RECORD-TYPE      PIC X.
   861         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   862
   863
   864     12  WS-ACCESS.
   865         16  FILLER               PIC XX    VALUE SPACES.
   866         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   867
   868     12  WS-CARR-ACCESS.
   869         16  FILLER               PIC X(3)  VALUE SPACES.
   870         16  WS-CARR              PIC X     VALUE SPACE.
   871*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  17
* EL050.cbl
   872*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   873     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   874         88  WS-DMD-LF-RATING   VALUE 'Y'.
   875         88  WS-DMD-AH-RATING   VALUE 'Y'.
   876         88  WS-DMD-NO-RATING   VALUE 'N'.
   877
   878     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   879         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   880                                         'NJ' 'NL'
   881                                         'PJ' 'PL'
   882                                         'SJ' 'SL'.
   883     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   884         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   885                                         'NI' 'NJ' 'NL' 'NU'
   886                                         'PJ' 'PL' 'PI' 'PU'
   887                                         'SI' 'SJ' 'SL' 'SU'
   888                                         'MX' 'MY' 'MZ'.
   889 01  ERPDEF-KEY-SAVE             PIC X(18).
   890 01  ERPDEF-KEY.
   891     12  ERPDEF-COMPANY-CD       PIC X.
   892     12  ERPDEF-STATE            PIC XX.
   893     12  ERPDEF-PROD-CD          PIC XXX.
   894     12  F                       PIC X(7).
   895     12  ERPDEF-BEN-TYPE         PIC X.
   896     12  ERPDEF-BEN-CODE         PIC XX.
   897     12  ERPDEF-EXP-DT           PIC XX.
   898
   899 01  ELSTAT-KEY-SAVE             PIC X(20).
   900 01  ELSTAT-KEY.
   901     12  ELSTAT-COMPANY-ID       PIC XXX.
   902     12  ELSTAT-CARRIER          PIC X.
   903     12  ELSTAT-GROUP            PIC X(6).
   904     12  ELSTAT-STATE            PIC XX.
   905     12  ELSTAT-EXP-DT           PIC 9(8).
   906 01  WS-ERROR-VALUES.
   907     12  ER-1570                     PIC S9(4)   VALUE +1570.
   908     12  ER-1571                     PIC S9(4)   VALUE +1571.
   909     12  er-1572                     pic s9(4)   value +1572.
   910     12  er-1573                     pic s9(4)   value +1573.
   911     12  er-1574                     pic s9(4)   value +1574.
   912     12  ER-1575                     PIC S9(4)   VALUE +1575.
   913     12  er-1576                     pic s9(4)   value +1576.
   914     12  er-1583                     pic s9(4)   value +1583.
   915     12  er-1743                     pic s9(4)   value +1743.
   916     12  er-1744                     pic s9(4)   value +1744.
   917     12  er-1745                     pic s9(4)   value +1745.
   918     12  er-1746                     pic s9(4)   value +1746.
   919     12  er-1747                     pic s9(4)   value +1747.
   920     12  er-1748                     pic s9(4)   value +1748.
   921     12  ER-1891                     PIC S9(4)   VALUE +1891.
   922     12  ER-1892                     PIC S9(4)   VALUE +1892.
   923     12  ER-1893                     PIC S9(4)   VALUE +1893.
   924     12  ER-1894                     PIC S9(4)   VALUE +1894.
   925     12  ER-1895                     PIC S9(4)   VALUE +1895.
   926     12  ER-1896                     PIC S9(4)   VALUE +1896.
   927     12  ER-1897                     PIC S9(4)   VALUE +1897.
   928     12  ER-1898                     PIC S9(4)   VALUE +1898.
   929     12  ER-1899                     PIC S9(4)   VALUE +1899.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  18
* EL050.cbl
   930     12  ER-1900                     PIC S9(4)   VALUE +1900.
   931     12  ER-1901                     PIC S9(4)   VALUE +1901.
   932     12  ER-1902                     PIC S9(4)   VALUE +1902.
   933     12  ER-1903                     PIC S9(4)   VALUE +1903.
   934     12  ER-1904                     PIC S9(4)   VALUE +1904.
   935     12  ER-1905                     PIC S9(4)   VALUE +1905.
   936     12  ER-1906                     PIC S9(4)   VALUE +1906.
   937     12  ER-1907                     PIC S9(4)   VALUE +1907.
   938     12  ER-1909                     PIC S9(4)   VALUE +1909.
   939     12  ER-1910                     PIC S9(4)   VALUE +1910.
   940     12  ER-1911                     PIC S9(4)   VALUE +1911.
   941     12  ER-1912                     PIC S9(4)   VALUE +1912.
   942     12  ER-1913                     PIC S9(4)   VALUE +1913.
   943     12  ER-1914                     PIC S9(4)   VALUE +1914.
   944     12  ER-1915                     PIC S9(4)   VALUE +1915.
   945     12  ER-1916                     PIC S9(4)   VALUE +1916.
   946     12  ER-1917                     PIC S9(4)   VALUE +1917.
   947     12  ER-1918                     PIC S9(4)   VALUE +1918.
   948     12  ER-1919                     PIC S9(4)   VALUE +1919.
   949     12  ER-1920                     PIC S9(4)   VALUE +1920.
   950     12  ER-1921                     PIC S9(4)   VALUE +1921.
   951     12  ER-1922                     PIC S9(4)   VALUE +1922.
   952     12  ER-1923                     PIC S9(4)   VALUE +1923.
   953     12  ER-1924                     PIC S9(4)   VALUE +1924.
   954     12  ER-1925                     PIC S9(4)   VALUE +1925.
   955     12  ER-1926                     PIC S9(4)   VALUE +1926.
   956     12  ER-1927                     PIC S9(4)   VALUE +1927.
   957     12  ER-2393                     PIC S9(4)   VALUE +2393.
   958     12  ER-2600                     PIC S9(4)   VALUE +2600.
   959     12  ER-2601                     PIC S9(4)   VALUE +2601.
   960     12  ER-2602                     PIC S9(4)   VALUE +2602.
   961     12  ER-2603                     PIC S9(4)   VALUE +2603.
   962     12  ER-2604                     PIC S9(4)   VALUE +2604.
   963     12  ER-2605                     PIC S9(4)   VALUE +2605.
   964     12  ER-2606                     PIC S9(4)   VALUE +2606.
   965     12  ER-2607                     PIC S9(4)   VALUE +2607.
   966     12  ER-2608                     PIC S9(4)   VALUE +2608.
   967     12  ER-2609                     PIC S9(4)   VALUE +2609.
   968     12  ER-2610                     PIC S9(4)   VALUE +2610.
   969     12  ER-2611                     PIC S9(4)   VALUE +2611.
   970     12  ER-2612                     PIC S9(4)   VALUE +2612.
   971     12  ER-2613                     PIC S9(4)   VALUE +2613.
   972     12  ER-2614                     PIC S9(4)   VALUE +2614.
   973     12  ER-2615                     PIC S9(4)   VALUE +2615.
   974     12  ER-2616                     PIC S9(4)   VALUE +2616.
   975     12  ER-2617                     PIC S9(4)   VALUE +2617.
   976     12  ER-2618                     PIC S9(4)   VALUE +2618.
   977     12  ER-2619                     PIC S9(4)   VALUE +2619.
   978     12  ER-2620                     PIC S9(4)   VALUE +2620.
   979     12  ER-2621                     PIC S9(4)   VALUE +2621.
   980     12  ER-2622                     PIC S9(4)   VALUE +2622.
   981     12  ER-2623                     PIC S9(4)   VALUE +2623.
   982     12  ER-2624                     PIC S9(4)   VALUE +2624.
   983     12  ER-2625                     PIC S9(4)   VALUE +2625.
   984     12  ER-2626                     PIC S9(4)   VALUE +2626.
   985     12  ER-2627                     PIC S9(4)   VALUE +2627.
   986     12  ER-2628                     PIC S9(4)   VALUE +2628.
   987     12  ER-2629                     PIC S9(4)   VALUE +2629.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  19
* EL050.cbl
   988     12  ER-2630                     PIC S9(4)   VALUE +2630.
   989     12  ER-2631                     PIC S9(4)   VALUE +2631.
   990     12  ER-2632                     PIC S9(4)   VALUE +2632.
   991     12  ER-2633                     PIC S9(4)   VALUE +2633.
   992     12  ER-2634                     PIC S9(4)   VALUE +2634.
   993     12  ER-2635                     PIC S9(4)   VALUE +2635.
   994     12  ER-2636                     PIC S9(4)   VALUE +2636.
   995     12  ER-2637                     PIC S9(4)   VALUE +2637.
   996     12  ER-2638                     PIC S9(4)   VALUE +2638.
   997     12  ER-2639                     PIC S9(4)   VALUE +2639.
   998     12  ER-2640                     PIC S9(4)   VALUE +2640.
   999     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1000     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1001     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1002     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1003     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1004     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1005     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1006     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1007     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1008     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1009     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1010     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1011     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1012     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1013     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1014     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1015     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1016     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1017     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1018     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1019     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1020     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1021     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1022     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1023     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1024     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1025     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1026     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1027     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1028     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1029     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1030     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1031     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1032     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1033     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1034     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1035     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1036     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1037     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1038     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1039     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1040     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1041     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1042     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1043     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1044     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1045     12  ER-2687                     PIC S9(4)   VALUE +2687.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  20
* EL050.cbl
  1046     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1047     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1048     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1049     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1050     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1051     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1052     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1053     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1054     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1055     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1056     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1057     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1058     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1059     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1060     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1061     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1062     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1063     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1064     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1065     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1066     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1067     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1068     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1069     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1070     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1071     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1072     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1073     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1074     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1075     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1076     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1077     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1078     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1079     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1080     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1081     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1082     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1083     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1084     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1085     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1086     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1087     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1088     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1089     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1090     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1091     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1092     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1093     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1094     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1095     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1096     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1097     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1098     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1099     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1100     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1101     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1102     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1103     12  ER-2755                     PIC S9(4)   VALUE +2755.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  21
* EL050.cbl
  1104     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1105     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1106     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1107     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1108     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1109     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1110     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1111     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1112     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1113     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1114     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1115     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1116     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1117     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1118     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1119     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1120     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1121     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1122     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1123     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1124     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1125     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1126     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1127     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1128     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1129     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1130     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1131     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1132     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1133     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1134     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1135     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1136     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1137     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1138     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1139     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1140     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1141     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1142     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1143     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1144     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1145     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1146     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1147     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1148     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1149     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1150     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1151     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1152     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1153     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1154     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1155     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1156     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1157     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1158     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1159     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1160     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1161     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  22
* EL050.cbl
  1162     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1163     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1164     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1165     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1166     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1167     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1168     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1169     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1170     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1171     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1172     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1173     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1174     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1175     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1176     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1177     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1178     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1179     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1180     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1181     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1182     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1183     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1184     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1185     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1186     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1187     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1188     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1189     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1190     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1191     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1192     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1193     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1194     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1195     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1196     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1197     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1198     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1199     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1200     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1201     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1202     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1203     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1204     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1205     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1206     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1207     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1208     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1209     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1210     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1211     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1212     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1213     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1214     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1215     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1216     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1217     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1218     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1219     12  ER-8082                     PIC S9(4)   VALUE +8082.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  23
* EL050.cbl
  1220     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1221     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1222     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1223     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1224     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1225     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1226     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1227     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1228     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1229     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1230     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1231     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1232     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1233     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1234     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1235     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1236     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1237     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1238     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1239     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1240     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1241     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1242     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1243     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1244     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1245     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1246     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1247     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1248     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1249     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1250     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1251     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1252     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1253     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1254     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1255     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1256     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1257     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1258     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1259     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1260     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1261     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1262     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1263     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1264     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1265******************************************************************
  1266***************   END OF ELC50WS     ****************************
  1267******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  24
* EL050.cbl
  1270 01  WORKING-STORAGE-WORK-AREAS.
  1271     12  WS-RESPONSE             PIC S9(8)  COMP.
  1272         88  WS-RESP-NORMAL           VALUE +00.
  1273         88  WS-RESP-ERROR            VALUE +01.
  1274         88  WS-RESP-NOTFND           VALUE +13.
  1275         88  WS-RESP-DUPREC           VALUE +14.
  1276         88  WS-RESP-ENDFILE          VALUE +20.
  1277     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1278     12  WORK-AREAS.
  1279         16  WK-CONV-GREG.
  1280             24  WCG-CENT             PIC XX.
  1281             24  WCG-REST             PIC X(4).
  1282         16  WORK-GREGORIAN-DATE.
  1283             24  WK-GREG-CENT         PIC XX.
  1284             24  WK-GREG-DATE-YYMMDD.
  1285                 28  WK-GREG-YYMM     PIC X(4).
  1286                 28  WK-GREG-DD       PIC XX.
  1287
  1288         16  WORK-SELECT-DATE.
  1289             24  WK-SELECT-CENT            PIC XX.
  1290             24  WK-SELECT-DATE-YYMMDD.
  1291                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1292                 28  FILLER                PIC XX.
  1293
  1294         16  WK-FORM-NO.
  1295             24  WK-FORM-BANK-ID       PIC X(5).
  1296             24  WK-FORM-UNDRWRTR      PIC X(1).
  1297             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1298
  1299         16  WK-MEMBER-NO.
  1300             24  WK-MEMBER-1-6        PIC X(6).
  1301             24  WK-MEMBER-7-12       PIC X(6).
  1302
  1303         16  WK-FULL-CERT-NO.
  1304             24  WK-CERT-POS-1-2      PIC X(2).
  1305             24  WK-CERT-POS-3        PIC X(1).
  1306             24  WK-CERT-POS-4        PIC X(1).
  1307             24  WK-CERT-POS-5-6      PIC X(2).
  1308             24  WK-CERT-POS-7        PIC X(1).
  1309             24  WK-CERT-POS-8-11     PIC X(4).
  1310
  1311         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1312             88  VALID-RATE-CODE        VALUE 'Y'.
  1313             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1314
  1315         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1316         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1317         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1318         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1319         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1320         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1321         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1322         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1323         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1324         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1325
  1326* DLO001
  1327 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  25
* EL050.cbl
  1328     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1329     12  DMPF-RETURN-CODE          PIC XX.
  1330         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1331         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1332         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1333         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1334         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1335         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1336
  1337* DLO002
  1338 01  WS-DLO-INTERNAL-POLICY-FORM.
  1339     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1340     12  DIPF-RETURN-CODE          PIC XX.
  1341         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1342         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1343         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1344         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1345         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1346         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1347
  1348* DLO003
  1349 01  WS-DLO-VALID-BANK-ID.
  1350     12  DVBI-BANK-ID              PIC X(5).
  1351     12  DVBI-BANK-ID-TYPE         PIC X.
  1352         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1353         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1354         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1355         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1356         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1357     12  DVBI-RETURN-CODE          PIC XX.
  1358         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1359         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1360         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1361         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1362         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1363         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1364         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1365         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1366         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO007
  1369 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1370     12  DCUA-RES-STATE            PIC XX.
  1371     12  DCUA-BEN-TYPE             PIC XX.
  1372     12  DCUA-SYS-IDENT            PIC X.
  1373         88  DCUA-CLAIM                        VALUE 'C'.
  1374         88  DCUA-PREMIUM                      VALUE 'P'.
  1375     12  DCUA-COVERAGE-RULE        PIC X.
  1376     12  DCUA-CLIENT-ID            PIC X(10).
  1377     12  DCUA-EFF-DATE             PIC X(8).
  1378     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1379     12  DCUA-RETURN-CODE          PIC XX.
  1380         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1381     12  DCUA-CERT-NUMBER          PIC X(11).
  1382     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1383     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1384
  1385* DLO011
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  26
* EL050.cbl
  1386 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1387     12  DPRB-RATE-CODE            PIC X(4).
  1388     12  DPRB-COVERAGE-CATEG       PIC X.
  1389     12  DPRB-RETURN-CODE          PIC XX.
  1390         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1391         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1392         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1393         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1394         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1395         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1396         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1397         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1398         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1399     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1400     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1401     12  DPRB-BEN-TYPE             PIC XX.
  1402
  1403* DLO017
  1404 01  WS-DLO-VALID-RATE-CODE.
  1405     12  DVRC-RATE-CODE            PIC X(4).
  1406     12  DVRC-RETURN-CODE          PIC XX.
  1407         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1409         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1410         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1411         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1412         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1413
  1414* DLO019
  1415 01  WS-DLO-ORIG-COV-CAT.
  1416     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1417     12  DOCC-RETURN-CODE          PIC XX.
  1418     12  DOCC-ORIG-COV-CAT         PIC X.
  1419     12  DOCC-UNDERWITER           PIC XX.
  1420     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1421     12  DOCC-FILLER               PIC X(6).
  1422
  1423* DLO021
  1424 01  WS-DLO-VALID-LOAN-OFFICER.
  1425     12  DVLO-LOAN-OFFICER.
  1426         16  DVLO-BILL-TYPE        PIC X.
  1427         16  DVLO-BILL-SOURCE      PIC X.
  1428         16  DVLO-BATCH-TYPE       PIC X.
  1429     12  DVLO-RETURN-CODE          PIC XX.
  1430         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1431         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1432         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1433         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1434         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1435         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1436
  1437* DLO022
  1438 01  WS-DLO-VALID-STATE-CODE.
  1439     12  DVSC-STATE-CODE           PIC XX.
  1440     12  DVSC-RETURN-CODE          PIC XX.
  1441         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1442
  1443* DLO023
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  27
* EL050.cbl
  1444 01  WS-DLO-VALID-CODE-VALUES.
  1445     12  DVCV-SYSTEM-ID            PIC XX.
  1446         88  DVCV-CLAIMS                       VALUE 'CL'.
  1447         88  DVCV-CREDIT                       VALUE 'CR'.
  1448     12  DVCV-RECORD-TYPE          PIC XX.
  1449         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1450         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1451         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1452         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1453         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1454         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1455         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1456         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1457     12  DVCV-RECORD-KEY           PIC X(6).
  1458     12  DVCV-RETURN-CODE          PIC XX.
  1459         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1460         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1461         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1462         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1463         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1464         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1465         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1466     12  DVCV-CODE-DESC            PIC X(60).
  1467     12  DVCV-GEN-DESC-1           PIC X(20).
  1468     12  DVCV-GEN-DESC-2           PIC X(20).
  1469     12  DVCV-GEN-DESC-3           PIC X(20).
  1470
  1471****  this is for aggregate report.
  1472****  Length is erpndb + 100 of passed-key-area
  1473 01  ws-passed-key-length        pic s9(4) comp value +587.
  1474 01  ws-pass-to-pemaggo.
  1475     05  ws-passed-erpndb        pic x(585).
  1476     05  ws-exceed-limit-yn      pic x.
  1477     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  28
* EL050.cbl
  1479*    COPY ERCBXRF.
  1480******************************************************************
  1481*                                                                *
  1482*                                                                *
  1483*                            ERCBXRF                             *
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499
  1500 01  BANK-CROSS-REFERENCE.
  1501     12  BK-RECORD-ID                PIC XX.
  1502         88  VALID-BK-ID             VALUE 'BK'.
  1503
  1504     12  BK-CONTROL-PRIMARY.
  1505         16  BK-COMPANY-CD           PIC X.
  1506         16  BK-CARRIER              PIC X.
  1507         16  BK-GROUPING             PIC X(6).
  1508         16  BK-BANK-NO              PIC X(10).
  1509
  1510     12  BK-MAINT-INFORMATION.
  1511         16  BK-LAST-MAINT-DT        PIC XX.
  1512         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1513         16  BK-LAST-MAINT-USER      PIC X(4).
  1514         16  FILLER                  PIC X(9).
  1515
  1516     12  FILLER                      PIC X(37).
  1517
  1518     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1519
  1520     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1521                            DEPENDING ON BK-BANK-POINTER-CNT.
  1522         16  BK-AM-ACCOUNT           PIC X(10).
  1523         16  BK-AM-EXP-DT            PIC XX.
  1524         16  BK-AM-EFF-DT            PIC XX.
  1525         16  BK-AM-STATE             PIC XX.
  1526         16  FILLER                  PIC X(20).
  1527
  1528******************************************************************
  1529
  1530*    COPY ERCCOMP.
  1531******************************************************************
  1532*                                                                *
  1533*                                                                *
  1534*                            ERCCOMP                             *
  1535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1536*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  29
* EL050.cbl
  1537*                                                                *
  1538*   ONLINE CREDIT SYSTEM                                         *
  1539*                                                                *
  1540*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1541*                                                                *
  1542*   FILE TYPE = VSAM,KSDS                                        *
  1543*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1544*                                                                *
  1545*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1546*       ALTERNATE PATH = NONE                                    *
  1547*                                                                *
  1548*   LOG = NO                                                     *
  1549*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1550*                                                                *
  1551******************************************************************
  1552*                   C H A N G E   L O G
  1553*
  1554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1555*-----------------------------------------------------------------
  1556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1557* EFFECTIVE    NUMBER
  1558*-----------------------------------------------------------------
  1559* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1560* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1561* 092205    2005050300006  PEMA  ADD LEASE FEE
  1562* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1563* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1564* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1565* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1566* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1567* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1568******************************************************************
  1569
  1570 01  COMPENSATION-MASTER.
  1571     12  CO-RECORD-ID                          PIC XX.
  1572         88  VALID-CO-ID                          VALUE 'CO'.
  1573
  1574     12  CO-CONTROL-PRIMARY.
  1575         16  CO-COMPANY-CD                     PIC X.
  1576         16  CO-CONTROL.
  1577             20  CO-CTL-1.
  1578                 24  CO-CARR-GROUP.
  1579                     28  CO-CARRIER            PIC X.
  1580                     28  CO-GROUPING.
  1581                         32  CO-GROUP-PREFIX   PIC XXX.
  1582                         32  CO-GROUP-PRIME    PIC XXX.
  1583                 24  CO-RESP-NO.
  1584                     28  CO-RESP-PREFIX        PIC X(4).
  1585                     28  CO-RESP-PRIME         PIC X(6).
  1586             20  CO-CTL-2.
  1587                 24  CO-ACCOUNT.
  1588                     28  CO-ACCT-PREFIX        PIC X(4).
  1589                     28  CO-ACCT-PRIME         PIC X(6).
  1590         16  CO-TYPE                           PIC X.
  1591             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1592             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1593             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1594
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  30
* EL050.cbl
  1595     12  CO-MAINT-INFORMATION.
  1596         16  CO-LAST-MAINT-DT                  PIC XX.
  1597         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1598         16  CO-LAST-MAINT-USER                PIC X(4).
  1599     12  FILLER                                PIC XX.
  1600     12  CO-STMT-TYPE                          PIC XXX.
  1601     12  CO-COMP-TYPE                          PIC X.
  1602         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1603     12  CO-STMT-OWNER                         PIC X(4).
  1604     12  CO-BALANCE-CONTROL                    PIC X.
  1605         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1606         88  CO-NO-BALANCE                        VALUE 'N'.
  1607
  1608     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1609         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1610         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1611         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1612
  1613     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1614         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1615         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1616
  1617     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1618     12  CO-GA-DIRECT-DEP                      PIC X.
  1619     12  CO-FUTURE-SPACE                       PIC X.
  1620         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1621
  1622     12  CO-ACCT-NAME                          PIC X(30).
  1623     12  CO-MAIL-NAME                          PIC X(30).
  1624     12  CO-ADDR-1                             PIC X(30).
  1625     12  CO-ADDR-2                             PIC X(30).
  1626     12  CO-ADDR-3.
  1627         16  CO-ADDR-CITY                      PIC X(27).
  1628         16  CO-ADDR-STATE                     PIC XX.
  1629     12  CO-CSO-1099                           PIC X.
  1630     12  CO-ZIP.
  1631         16  CO-ZIP-PRIME.
  1632             20  CO-ZIP-PRI-1ST                PIC X.
  1633                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1634             20  FILLER                        PIC X(4).
  1635         16  CO-ZIP-PLUS4                      PIC X(4).
  1636     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1637         16  CO-CAN-POSTAL-1                   PIC XXX.
  1638         16  CO-CAN-POSTAL-2                   PIC XXX.
  1639         16  FILLER                            PIC XXX.
  1640     12  CO-SOC-SEC                            PIC X(13).
  1641     12  CO-TELEPHONE.
  1642         16  CO-AREA-CODE                      PIC XXX.
  1643         16  CO-PREFIX                         PIC XXX.
  1644         16  CO-PHONE                          PIC X(4).
  1645
  1646     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1647
  1648     12  CO-AR-BAL-LEVEL                       PIC X.
  1649         88  CO-AR-REF-LVL                        VALUE '1'.
  1650         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1651         88  CO-AR-BILL-LVL                       VALUE '2'.
  1652         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  31
* EL050.cbl
  1653         88  CO-AR-FR-LVL                         VALUE '4'.
  1654
  1655     12  CO-AR-NORMAL-PRINT                    PIC X.
  1656         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1657         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1658
  1659     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1660
  1661     12  CO-AR-REPORTING                       PIC X.
  1662         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1663         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1664
  1665     12  CO-AR-PULL-CHECK                      PIC X.
  1666         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1667         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1668
  1669     12  CO-AR-BALANCE-PRINT                   PIC X.
  1670         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1671
  1672     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1673         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1674         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1675         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1676
  1677     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1678
  1679     12  CO-USER-CODE                          PIC X.
  1680     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1681
  1682******************************************************************
  1683*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1684*    THE LAST MONTH END RUN.
  1685******************************************************************
  1686
  1687     12  CO-LAST-ACTIVITY-DATE.
  1688         16  CO-ACT-YEAR                       PIC 99.
  1689         16  CO-ACT-MONTH                      PIC 99.
  1690         16  CO-ACT-DAY                        PIC 99.
  1691
  1692     12  CO-LAST-STMT-DT.
  1693         16  CO-LAST-STMT-YEAR                 PIC 99.
  1694         16  CO-LAST-STMT-MONTH                PIC 99.
  1695         16  CO-LAST-STMT-DAY                  PIC 99.
  1696
  1697     12  CO-MO-END-TOTALS.
  1698         16  CO-MONTHLY-TOTALS.
  1699             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1700             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1701             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1702             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1703             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1704
  1705         16  CO-AGING-TOTALS.
  1706             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1707             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1708             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1709             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1710
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  32
* EL050.cbl
  1711         16  CO-YTD-TOTALS.
  1712             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1713             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1714
  1715         16  CO-OVER-UNDER-TOTALS.
  1716             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1717             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1718
  1719     12  CO-MISCELLANEOUS-TOTALS.
  1720         16  CO-FICA-TOTALS.
  1721             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1722             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1723
  1724         16  CO-CLAIM-TOTALS.
  1725             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1726             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1727
  1728******************************************************************
  1729*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1730*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1731******************************************************************
  1732
  1733     12  CO-CURRENT-TOTALS.
  1734         16  CO-CURRENT-LAST-STMT-DT.
  1735             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1736             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1737             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1738
  1739         16  CO-CURRENT-MONTHLY-TOTALS.
  1740             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1741             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1742             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1743             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1745
  1746         16  CO-CURRENT-AGING-TOTALS.
  1747             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1748             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1749             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1750             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1751
  1752         16  CO-CURRENT-YTD-TOTALS.
  1753             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1754             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1755
  1756     12  CO-PAID-COMM-TOTALS.
  1757         16  CO-YTD-PAID-COMMS.
  1758             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1759             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1760
  1761     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1762         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1763         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1764
  1765     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1766         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1767         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1768         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  33
* EL050.cbl
  1769         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1770         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1771         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1772         88  CO-FINAL-LETTER                  VALUE 'F'.
  1773         88  CO-RECONCILING                   VALUE 'R'.
  1774         88  CO-PHONE-CALL                    VALUE 'P'.
  1775         88  CO-LEGAL                         VALUE 'L'.
  1776         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1777         88  CO-WRITE-OFF                     VALUE 'W'.
  1778         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1779
  1780     12  CO-CSR-CODE                       PIC X(4).
  1781
  1782     12  CO-GA-STATUS-INFO.
  1783         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1784         16  CO-GA-TERMINATION-DT          PIC XX.
  1785         16  CO-GA-STATUS-CODE             PIC X.
  1786             88  CO-GA-ACTIVE                 VALUE 'A'.
  1787             88  CO-GA-INACTIVE               VALUE 'I'.
  1788             88  CO-GA-PENDING                VALUE 'P'.
  1789         16  CO-GA-COMMENTS.
  1790             20  CO-GA-COMMENT-1           PIC X(40).
  1791             20  CO-GA-COMMENT-2           PIC X(40).
  1792             20  CO-GA-COMMENT-3           PIC X(40).
  1793             20  CO-GA-COMMENT-4           PIC X(40).
  1794
  1795     12  CO-RPTCD2                         PIC X(10).
  1796     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1797         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1798         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1799
  1800     12  CO-TYPE-AGENT                     PIC X(01).
  1801         88  CO-CORPORATION                   VALUE 'C'.
  1802         88  CO-PARTNERSHIP                   VALUE 'P'.
  1803         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1804         88  CO-TRUST                         VALUE 'T'.
  1805         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1806
  1807     12  CO-FAXNO.
  1808         16  CO-FAX-AREA-CODE                  PIC XXX.
  1809         16  CO-FAX-PREFIX                     PIC XXX.
  1810         16  CO-FAX-PHONE                      PIC X(4).
  1811
  1812     12  CO-BANK-INFORMATION.
  1813         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1814         16  CO-BANK-TRANSIT-NON REDEFINES
  1815             CO-BANK-TRANSIT-NO                PIC 9(8).
  1816
  1817         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1818     12  CO-MISC-DEDUCT-INFO REDEFINES
  1819                  CO-BANK-INFORMATION.
  1820         16  CO-MD-GL-ACCT                     PIC X(10).
  1821         16  CO-MD-DIV                         PIC XX.
  1822         16  CO-MD-CENTER                      PIC X(4).
  1823         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1824         16  CO-CREATE-AP-CHECK                PIC X.
  1825         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1826         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  34
* EL050.cbl
  1827     12  CO-ACH-STATUS                         PIC X.
  1828         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1829         88  CO-ACH-PENDING                        VALUE 'P'.
  1830
  1831     12  CO-BILL-SW                            PIC X.
  1832     12  CO-CONTROL-NAME                       PIC X(30).
  1833     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1834     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1835     12  CO-CLP-STATE                          PIC XX.
  1836     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1837     12  CO-SPP-REFUND-EDIT                    PIC X.
  1838
  1839******************************************************************
  1840
  1841*    COPY ERCAGTC.
  1842******************************************************************
  1843*                                                                *
  1844*                                                                *
  1845*                            ERCAGTC                             *
  1846*                            VMOD=2.001                          *
  1847*                                                                *
  1848*   ONLINE CREDIT SYSTEM                                         *
  1849*                                                                *
  1850*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1851*                                                                *
  1852*   FILE TYPE = VSAM,KSDS                                        *
  1853*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1854*                                                                *
  1855*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1856*       ALTERNATE PATH = NONE                                    *
  1857*                                                                *
  1858*   LOG = NO                                                     *
  1859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1860*                                                                *
  1861******************************************************************
  1862*                   C H A N G E   L O G
  1863*
  1864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1865*-----------------------------------------------------------------
  1866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1867* EFFECTIVE    NUMBER
  1868*-----------------------------------------------------------------
  1869* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1870* 111004                         NEW FILE AND COPYBOOK
  1871* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1872******************************************************************
  1873 01  AGENT-COMMISSIONS.
  1874     12  AG-RECORD-ID                          PIC XX.
  1875         88  VALID-CO-ID                          VALUE 'AG'.
  1876     12  AG-CONTROL-PRIMARY.
  1877         16  AG-COMPANY-CD                     PIC X.
  1878         16  AG-CONTROL.
  1879             20  AG-CTL-1.
  1880                 24  AG-CARR-GROUP.
  1881                     28  AG-CARRIER            PIC X.
  1882                     28  AG-GROUPING           PIC X(6).
  1883                 24  AG-BANK                   PIC X(10).
  1884             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  35
* EL050.cbl
  1885                 24  AG-EXP-DT                 PIC XX.
  1886         16  AG-TYPE                           PIC X.
  1887             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1888             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1889     12  AG-MAINT-INFORMATION.
  1890         16  AG-LAST-MAINT-DT                  PIC XX.
  1891         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1892         16  AG-LAST-MAINT-USER                PIC X(4).
  1893         16  FILLER                            PIC X(10).
  1894     12  AG-EFF-DT                             PIC XX.
  1895     12  AG-COMM-STRUCTURE.
  1896         16  AG-AGT-COMMS OCCURS 10.
  1897             20  AG-AGT                PIC X(10).
  1898             20  AG-COM-TYP            PIC X.
  1899             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1900             20  AG-RECALC-LV-INDIC    PIC X.
  1901             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1902             20  AG-LRCALC-LV-INDIC    PIC X.
  1903             20  FILLER                PIC X(05).
  1904     12  FILLER                  PIC X(145).
  1905******************************************************************
  1906*    COPY ERCRESS.
  1907******************************************************************
  1908*                                                                *
  1909*                            ERCRESS                             *
  1910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1911*                            VMOD=2.002                          *
  1912*                                                                *
  1913*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1914*                                                                *
  1915*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1916*   VSAM RESIDENT STATE TAX MASTER                              *
  1917*                                                                *
  1918*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1919*                                                                *
  1920*   FILE TYPE = VSAM,KSDS                                        *
  1921*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1922*                                                                *
  1923*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1924*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1925*                                                                *
  1926*   LOG = NO                                                     *
  1927*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1928*                                                                *
  1929*                                                                *
  1930******************************************************************
  1931
  1932 01  RESIDENT-STATE-TAX-MASTER.
  1933
  1934     10  ERRESS-PRIMARY-KEY.
  1935         15  RES-COMPANY-CD        PIC X.
  1936         15  RES-RESIDENT-STATE    PIC XX.
  1937         15  RES-COVERAGE-CATEGORY PIC X.
  1938         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1939*                                      YYYYMMDD
  1940*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1941
  1942     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  36
* EL050.cbl
  1943
  1944         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1945         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1946         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1947         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1948
  1949     10 RES-RECALC-SW              PIC   X.
  1950         88 RECALC                VALUE 'Y'.
  1951         88 NO-RECALC             VALUE 'N'.
  1952     10  RES-MAINT-BY              PIC X(4).
  1953     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1954     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1955*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  37
* EL050.cbl
  1957*    COPY ERCRESC.
  1958******************************************************************
  1959*                                                                *
  1960*                            ERCRESC                             *
  1961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1962*                            VMOD=2.003                          *
  1963*                                                                *
  1964*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1965*                                                                *
  1966*   FILE TYPE = VSAM,KSDS                                        *
  1967*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1968*                                                                *
  1969*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1970*       ALTERNATE PATH1 = NONE                                   *
  1971*                                                                *
  1972*   LOG = NO                                                     *
  1973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1978
  1979     10  ERRESC-RECORD-KEY.
  1980         15  RESC-COMPANY-CD           PIC   X.
  1981         15  RESC-CARRIER              PIC   X.
  1982         15  RESC-GROUP                PIC   X(6).
  1983         15  RESC-STATE                PIC   XX.
  1984         15  RESC-ACCOUNT              PIC   X(10).
  1985         15  RESC-AGENT                PIC   X(10).
  1986         15  RESC-RESIDENT-STATE       PIC   XX.
  1987         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1988*                                           YYYYMMDD
  1989     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1990
  1991     10  RESC-COMM-RECORD-DATA.
  1992         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1993             20 RESC-COVERAGE-CAT      PIC    X.
  1994             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1995             20 RESC-COMMISSION-TAB REDEFINES
  1996                RESC-COMMISSION-PER    PIC  XXX.
  1997
  1998     10  RESC-MAINT-BY                 PIC X(4).
  1999     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2000     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2001*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  38
* EL050.cbl
  2003*    COPY ERCPLAN.
  2004******************************************************************
  2005*                                                                *
  2006*                                                                *
  2007*                            ERCPLAN                             *
  2008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2009*                            VMOD=2.003                          *
  2010*                                                                *
  2011*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2012*                                                                *
  2013*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2014*   PLAN MASTER                                                  *
  2015*                                                                *
  2016*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2017*                                                                *
  2018*   FILE TYPE = VSAM,KSDS                                        *
  2019*   RECORD SIZE = 420   RECFORM = FIX                            *
  2020*                                                                *
  2021*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2022*       ALTERNATE PATH1 = N/A                                    *
  2023*                                                                *
  2024*   LOG = NO                                                     *
  2025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2026*                                                                *
  2027*                                                                *
  2028******************************************************************
  2029
  2030 01  PLAN-MASTER.
  2031     12  PL-RECORD-ID                      PIC XX.
  2032         88  VALID-PL-ID                      VALUE 'PL'.
  2033
  2034     12  PL-CONTROL-PRIMARY.
  2035         16  PL-COMPANY-CD                 PIC X.
  2036         16  PL-MSTR-CNTRL.
  2037             20  PL-CONTROL-A.
  2038                 24  PL-CARRIER            PIC X.
  2039                 24  PL-GROUPING           PIC X(6).
  2040                 24  PL-STATE              PIC XX.
  2041                 24  PL-ACCOUNT            PIC X(10).
  2042             20  PL-BENEFIT-TYPE           PIC X.
  2043             20  PL-BENEFIT-CODE           PIC XX.
  2044             20  PL-REVISION-NO            PIC X(3).
  2045
  2046     12  PL-CONTROL-BY-VAR-GRP.
  2047         16  PL-COMPANY-CD-A1              PIC X.
  2048         16  PL-VG-CARRIER                 PIC X.
  2049         16  PL-VG-GROUPING                PIC X(6).
  2050         16  PL-VG-STATE                   PIC XX.
  2051         16  PL-VG-ACCOUNT                 PIC X(10).
  2052         16  PL-BENEFIT-TYPE-A1            PIC X.
  2053         16  PL-BENEFIT-CODE-A1            PIC XX.
  2054         16  PL-REVISION-NO-A1             PIC 999.
  2055
  2056     12  PL-MAINT-INFORMATION.
  2057         16  PL-LAST-MAINT-DT              PIC XX.
  2058         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2059         16  PL-LAST-MAINT-USER            PIC X(4).
  2060         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  39
* EL050.cbl
  2061
  2062     12  PL-LIABILITY-LIMITS.
  2063         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2064         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2065             20  PL-LM-AGE                 PIC S99        COMP-3.
  2066             20  PL-LM-DUR                 PIC S999       COMP-3.
  2067             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2068             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2069
  2070     12  FILLER                            PIC X(30).
  2071
  2072     12  PL-GL-ACCOUNT-NOS.
  2073         16  PL-PREMIUM-GL                 PIC X(8).
  2074         16  PL-COMM-GL                    PIC X(8).
  2075         16  PL-CLAIM-GL                   PIC X(8).
  2076     12  FILLER                            PIC X(24).
  2077     12  PL-TOLERANCES.
  2078         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2079         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2080         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2081         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2082         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2083         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2084     12  PL-OVER-SHORT.
  2085         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2086         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2087     12  FILLER                            PIC X(24).
  2088     12  PLAN-MISC.
  2089         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2090         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2091         16  PL-IG                         PIC X.
  2092         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2093         16  PL-POLICY-FORM                PIC X(12).
  2094         16  PL-EDIT-FOR-FORM              PIC X(01).
  2095         16  PL-DEV-CODE                   PIC XXX.
  2096         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2097         16  PL-CALC-METHOD                PIC X.
  2098         16  PL-BENEFIT-GROUP              PIC X(05).
  2099         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2100
  2101         16  FILLER                        PIC X(99).
  2102******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  40
* EL050.cbl
  2104*    COPY ELCCERT.
  2105******************************************************************
  2106*                                                                *
  2107*                            ELCCERT.                            *
  2108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2109*                            VMOD=2.013                          *
  2110*                                                                *
  2111*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2112*                                                                *
  2113*   FILE TYPE = VSAM,KSDS                                        *
  2114*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2115*                                                                *
  2116*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2117*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2118*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2119*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2120*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2121*                                                                *
  2122*   LOG = YES                                                    *
  2123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2124******************************************************************
  2125*                   C H A N G E   L O G
  2126*
  2127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2128*-----------------------------------------------------------------
  2129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2130* EFFECTIVE    NUMBER
  2131*-----------------------------------------------------------------
  2132* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2133* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2134* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2135* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2136* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2137* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2138* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2139* 032612  CR2011110200001  PEMA  AHL CHANGES
  2140* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2141* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2142******************************************************************
  2143
  2144 01  CERTIFICATE-MASTER.
  2145     12  CM-RECORD-ID                      PIC XX.
  2146         88  VALID-CM-ID                      VALUE 'CM'.
  2147
  2148     12  CM-CONTROL-PRIMARY.
  2149         16  CM-COMPANY-CD                 PIC X.
  2150         16  CM-CARRIER                    PIC X.
  2151         16  CM-GROUPING.
  2152             20  CM-GROUPING-PREFIX        PIC X(3).
  2153             20  CM-GROUPING-PRIME         PIC X(3).
  2154         16  CM-STATE                      PIC XX.
  2155         16  CM-ACCOUNT.
  2156             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2157             20  CM-ACCOUNT-PRIME          PIC X(6).
  2158         16  CM-CERT-EFF-DT                PIC XX.
  2159         16  CM-CERT-NO.
  2160             20  CM-CERT-PRIME             PIC X(10).
  2161             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  41
* EL050.cbl
  2162
  2163     12  CM-CONTROL-BY-NAME.
  2164         16  CM-COMPANY-CD-A1              PIC X.
  2165         16  CM-INSURED-LAST-NAME          PIC X(15).
  2166         16  CM-INSURED-INITIALS.
  2167             20  CM-INSURED-INITIAL1       PIC X.
  2168             20  CM-INSURED-INITIAL2       PIC X.
  2169
  2170     12  CM-CONTROL-BY-SSN.
  2171         16  CM-COMPANY-CD-A2              PIC X.
  2172         16  CM-SOC-SEC-NO.
  2173             20  CM-SSN-STATE              PIC XX.
  2174             20  CM-SSN-ACCOUNT            PIC X(6).
  2175             20  CM-SSN-LN3.
  2176                 25  CM-INSURED-INITIALS-A2.
  2177                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2178                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2179                 25 CM-PART-LAST-NAME-A2         PIC X.
  2180
  2181     12  CM-CONTROL-BY-CERT-NO.
  2182         16  CM-COMPANY-CD-A4              PIC X.
  2183         16  CM-CERT-NO-A4                 PIC X(11).
  2184
  2185     12  CM-CONTROL-BY-MEMB.
  2186         16  CM-COMPANY-CD-A5              PIC X.
  2187         16  CM-MEMBER-NO.
  2188             20  CM-MEMB-STATE             PIC XX.
  2189             20  CM-MEMB-ACCOUNT           PIC X(6).
  2190             20  CM-MEMB-LN4.
  2191                 25  CM-INSURED-INITIALS-A5.
  2192                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2193                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2194                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2195
  2196     12  CM-INSURED-PROFILE-DATA.
  2197         16  CM-INSURED-FIRST-NAME.
  2198             20  CM-INSURED-1ST-INIT       PIC X.
  2199             20  FILLER                    PIC X(9).
  2200         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2201         16  CM-INSURED-SEX                PIC X.
  2202             88  CM-SEX-MALE                  VALUE 'M'.
  2203             88  CM-SEX-FEMAL                 VALUE 'F'.
  2204         16  CM-INSURED-JOINT-AGE          PIC 99.
  2205         16  CM-JOINT-INSURED-NAME.
  2206             20  CM-JT-LAST-NAME           PIC X(15).
  2207             20  CM-JT-FIRST-NAME.
  2208                 24  CM-JT-1ST-INIT        PIC X.
  2209                 24  FILLER                PIC X(9).
  2210             20  CM-JT-INITIAL             PIC X.
  2211
  2212     12  CM-LIFE-DATA.
  2213         16  CM-LF-BENEFIT-CD              PIC XX.
  2214         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2215         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2216         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2217         16  CM-LF-DEV-CODE                PIC XXX.
  2218         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2219         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  42
* EL050.cbl
  2220         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2221         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2222         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2223         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2224         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2225         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2226         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2227         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2228         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2229         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2230         16  cm-temp-epiq                  pic xx.
  2231             88  EPIQ-CLASS                  value 'EQ'.
  2232*        16  FILLER                        PIC XX.
  2233
  2234     12  CM-AH-DATA.
  2235         16  CM-AH-BENEFIT-CD              PIC XX.
  2236         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2237         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2238         16  CM-AH-DEV-CODE                PIC XXX.
  2239         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2240         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2241         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2242         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2243         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2244         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2245         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2246         16  CM-AH-PAID-THRU-DT            PIC XX.
  2247             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2248         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2249         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2250         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2251         16  FILLER                        PIC X.
  2252
  2253     12  CM-LOAN-INFORMATION.
  2254         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2255         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2256                                           PIC S9(5)V99  COMP-3.
  2257         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2258         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2259         16  CM-PAY-FREQUENCY              PIC S99.
  2260         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2261         16  CM-RATE-CLASS                 PIC XX.
  2262         16  CM-BENEFICIARY                PIC X(25).
  2263         16  CM-POLICY-FORM-NO             PIC X(12).
  2264         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2265         16  CM-LAST-ADD-ON-DT             PIC XX.
  2266         16  CM-DEDUCTIBLE-AMOUNTS.
  2267             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2268             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2269         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2270             20  CM-RESIDENT-STATE         PIC XX.
  2271             20  CM-RATE-CODE              PIC X(4).
  2272             20  FILLER                    PIC XX.
  2273         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2274             20  CM-LOAN-OFFICER           PIC X(5).
  2275             20  FILLER                    PIC XXX.
  2276         16  CM-CSR-CODE                   PIC XXX.
  2277         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  43
* EL050.cbl
  2278             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2279         16  CM-POST-CARD-IND              PIC X.
  2280         16  CM-NH-INTERFACE-SW            PIC X.
  2281         16  CM-PREMIUM-TYPE               PIC X.
  2282             88  CM-SING-PRM                  VALUE '1'.
  2283             88  CM-O-B-COVERAGE              VALUE '2'.
  2284             88  CM-OPEN-END                  VALUE '3'.
  2285         16  CM-IND-GRP-TYPE               PIC X.
  2286             88  CM-INDIVIDUAL                VALUE 'I'.
  2287             88  CM-GROUP                     VALUE 'G'.
  2288         16  CM-SKIP-CODE                  PIC X.
  2289             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2290             88  SKIP-JULY                    VALUE '1'.
  2291             88  SKIP-AUGUST                  VALUE '2'.
  2292             88  SKIP-SEPTEMBER               VALUE '3'.
  2293             88  SKIP-JULY-AUG                VALUE '4'.
  2294             88  SKIP-AUG-SEPT                VALUE '5'.
  2295             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2296             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2297             88  SKIP-JUNE                    VALUE '8'.
  2298             88  SKIP-JUNE-JULY               VALUE '9'.
  2299             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2300             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2301         16  CM-PAYMENT-MODE               PIC X.
  2302             88  PAY-MONTHLY                  VALUE SPACE.
  2303             88  PAY-WEEKLY                   VALUE '1'.
  2304             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2305             88  PAY-BI-WEEKLY                VALUE '3'.
  2306             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2307         16  CM-LOAN-NUMBER                PIC X(8).
  2308         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2309         16  CM-OLD-LOF                    PIC XXX.
  2310*        16  CM-LOAN-OFFICER               PIC XXX.
  2311         16  CM-REIN-TABLE                 PIC XXX.
  2312         16  CM-SPECIAL-REIN-CODE          PIC X.
  2313         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2314         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2315         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2316
  2317     12  CM-STATUS-DATA.
  2318         16  CM-ENTRY-STATUS               PIC X.
  2319         16  CM-ENTRY-DT                   PIC XX.
  2320
  2321         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2322         16  CM-LF-CANCEL-DT               PIC XX.
  2323         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2324
  2325         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2326         16  CM-LF-DEATH-DT                PIC XX.
  2327         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2328
  2329         16  CM-LF-CURRENT-STATUS          PIC X.
  2330             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2331                                                'M' '4' '5' '9'.
  2332             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2333             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2334             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2335             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  44
* EL050.cbl
  2336             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2337             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2338             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2339             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2340             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2341             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2342             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2343             88  CM-LF-DECLINED               VALUE 'D'.
  2344             88  CM-LF-VOIDED                 VALUE 'V'.
  2345
  2346         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2347         16  CM-AH-CANCEL-DT               PIC XX.
  2348         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2349
  2350         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2351         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2352         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2353
  2354         16  CM-AH-CURRENT-STATUS          PIC X.
  2355             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2356                                                'M' '4' '5' '9'.
  2357             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2358             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2359             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2360             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2361             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2362             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2363             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2364             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2365             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2366             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2367             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2368             88  CM-AH-DECLINED               VALUE 'D'.
  2369             88  CM-AH-VOIDED                 VALUE 'V'.
  2370
  2371         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2372             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2373             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2374             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2375         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2376
  2377         16  CM-ENTRY-BATCH                PIC X(6).
  2378         16  CM-LF-EXIT-BATCH              PIC X(6).
  2379         16  CM-AH-EXIT-BATCH              PIC X(6).
  2380         16  CM-LAST-MONTH-END             PIC XX.
  2381
  2382     12  CM-NOTE-SW                        PIC X.
  2383         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2384         88  CERT-NOTES-PRESENT               VALUE '1'.
  2385         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2386         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2387         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2388         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2389         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2390         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2391     12  CM-COMP-EXCP-SW                   PIC X.
  2392         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2393         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  45
* EL050.cbl
  2394     12  CM-INSURED-ADDRESS-SW             PIC X.
  2395         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2396         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2397
  2398*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2399     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2400     12  FILLER                            PIC X.
  2401
  2402*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2403     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2404     12  FILLER                            PIC X.
  2405*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2406     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2407
  2408     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2409         88  CERT-ADDED-BATCH                 VALUE ' '.
  2410         88  CERT-ADDED-ONLINE                VALUE '1'.
  2411         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2412         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2413         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2414     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2415         88  CERT-AS-LOADED                   VALUE ' '.
  2416         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2417         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2418         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2419         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2420         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2421         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2422         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2423
  2424     12  CM-ACCOUNT-COMM-PCTS.
  2425         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2426         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2427
  2428     12  CM-USER-FIELD                     PIC X.
  2429     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2430     12  CM-CLP-STATE                      PIC XX.
  2431     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2432     12  CM-USER-RESERVED                  PIC XXX.
  2433     12  FILLER REDEFINES CM-USER-RESERVED.
  2434         16  CM-AH-CLASS-CD                PIC XX.
  2435         16  F                             PIC X.
  2436******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  46
* EL050.cbl
  2438*    COPY ERCMAIL.
  2439******************************************************************
  2440*                                                                *
  2441*                                                                *
  2442*                            ERCMAIL                             *
  2443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2444*                            VMOD=2.003                          *
  2445*                                                                *
  2446*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2447*                                                                *
  2448*   FILE TYPE = VSAM,KSDS                                        *
  2449*   RECORD SIZE = 374   RECFORM = FIX                            *
  2450*                                                                *
  2451*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2452*   ALTERNATE PATH    = NOT USED                                 *
  2453*                                                                *
  2454*   LOG = YES                                                    *
  2455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2456******************************************************************
  2457*                   C H A N G E   L O G
  2458*
  2459* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2460*-----------------------------------------------------------------
  2461*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2462* EFFECTIVE    NUMBER
  2463*-----------------------------------------------------------------
  2464* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2465* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2466* 111108                   PEMA  ADD CRED BENE ADDR2
  2467******************************************************************
  2468
  2469 01  MAILING-DATA.
  2470     12  MA-RECORD-ID                      PIC XX.
  2471         88  VALID-MA-ID                       VALUE 'MA'.
  2472
  2473     12  MA-CONTROL-PRIMARY.
  2474         16  MA-COMPANY-CD                 PIC X.
  2475         16  MA-CARRIER                    PIC X.
  2476         16  MA-GROUPING.
  2477             20  MA-GROUPING-PREFIX        PIC XXX.
  2478             20  MA-GROUPING-PRIME         PIC XXX.
  2479         16  MA-STATE                      PIC XX.
  2480         16  MA-ACCOUNT.
  2481             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2482             20  MA-ACCOUNT-PRIME          PIC X(6).
  2483         16  MA-CERT-EFF-DT                PIC XX.
  2484         16  MA-CERT-NO.
  2485             20  MA-CERT-PRIME             PIC X(10).
  2486             20  MA-CERT-SFX               PIC X.
  2487
  2488     12  FILLER                            PIC XX.
  2489
  2490     12  MA-ACCESS-CONTROL.
  2491         16  MA-SOURCE-SYSTEM              PIC XX.
  2492             88  MA-FROM-CREDIT                VALUE 'CR'.
  2493             88  MA-FROM-VSI                   VALUE 'VS'.
  2494             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2495             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  47
* EL050.cbl
  2496         16  MA-RECORD-ADD-DT              PIC XX.
  2497         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2498         16  MA-LAST-MAINT-DT              PIC XX.
  2499         16  MA-LAST-MAINT-BY              PIC XXXX.
  2500         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2501
  2502     12  MA-PROFILE-INFO.
  2503         16  MA-QUALIFY-CODE-1             PIC XX.
  2504         16  MA-QUALIFY-CODE-2             PIC XX.
  2505         16  MA-QUALIFY-CODE-3             PIC XX.
  2506         16  MA-QUALIFY-CODE-4             PIC XX.
  2507         16  MA-QUALIFY-CODE-5             PIC XX.
  2508
  2509         16  MA-INSURED-LAST-NAME          PIC X(15).
  2510         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2511         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2512         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2513         16  MA-INSURED-BIRTH-DT           PIC XX.
  2514         16  MA-INSURED-SEX                PIC X.
  2515             88  MA-SEX-MALE                   VALUE 'M'.
  2516             88  MA-SEX-FEMALE                 VALUE 'F'.
  2517         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2518
  2519         16  MA-ADDRESS-CORRECTED          PIC X.
  2520         16  MA-JOINT-BIRTH-DT             PIC XX.
  2521*        16  FILLER                        PIC X(12).
  2522
  2523         16  MA-ADDRESS-LINE-1             PIC X(30).
  2524         16  MA-ADDRESS-LINE-2             PIC X(30).
  2525         16  MA-CITY-STATE.
  2526             20  MA-CITY                   PIC X(28).
  2527             20  MA-ADDR-STATE             PIC XX.
  2528         16  MA-ZIP.
  2529             20  MA-ZIP-CODE.
  2530                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2531                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2532                 24  FILLER                PIC X(4).
  2533             20  MA-ZIP-PLUS4              PIC X(4).
  2534         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2535             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2536             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2537             20  FILLER                    PIC X(3).
  2538
  2539         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2540
  2541         16  FILLER                        PIC XXX.
  2542*        16  FILLER                        PIC X(10).
  2543
  2544     12  MA-CRED-BENE-INFO.
  2545         16  MA-CRED-BENE-NAME                 PIC X(25).
  2546         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2547         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2548         16  MA-CRED-BENE-CTYST.
  2549             20  MA-CRED-BENE-CITY             PIC X(28).
  2550             20  MA-CRED-BENE-STATE            PIC XX.
  2551         16  MA-CRED-BENE-ZIP.
  2552             20  MA-CB-ZIP-CODE.
  2553                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  48
* EL050.cbl
  2554                     88  MA-CB-CANADIAN-POST-CODE
  2555                                           VALUE 'A' THRU 'Z'.
  2556                 24  FILLER                    PIC X(4).
  2557             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2558         16  MA-CB-CANADIAN-POSTAL-CODE
  2559                            REDEFINES MA-CRED-BENE-ZIP.
  2560             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2561             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2562             20  FILLER                        PIC X(3).
  2563     12  MA-POST-CARD-MAIL-DATA.
  2564         16  MA-MAIL-DATA OCCURS 7.
  2565             20  MA-MAIL-TYPE              PIC X.
  2566                 88  MA-12MO-MAILING           VALUE '1'.
  2567                 88  MA-EXP-MAILING            VALUE '2'.
  2568             20  MA-MAIL-STATUS            PIC X.
  2569                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2570                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2571                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2572             20  MA-MAIL-DATE              PIC XX.
  2573     12  FILLER                            PIC XX.
  2574     12  FILLER                            PIC XX.
  2575*    12  FILLER                            PIC X(30).
  2576******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  49
* EL050.cbl
  2578*    COPY ERCPNDM.
  2579******************************************************************
  2580*                                                                *
  2581*                                                                *
  2582*                            ERCPNDM                             *
  2583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2584*                            VMOD=2.003                          *
  2585*                                                                *
  2586*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2587*                                                                *
  2588*   FILE TYPE = VSAM,KSDS                                        *
  2589*   RECORD SIZE = 374   RECFORM = FIX                            *
  2590*                                                                *
  2591*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2592*   ALTERNATE PATH    = NOT USED                                 *
  2593*                                                                *
  2594*   LOG = YES                                                    *
  2595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2596******************************************************************
  2597*                   C H A N G E   L O G
  2598*
  2599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2600*-----------------------------------------------------------------
  2601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2602* EFFECTIVE    NUMBER
  2603*-----------------------------------------------------------------
  2604* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2605* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2606* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2607******************************************************************
  2608
  2609 01  PENDING-MAILING-DATA.
  2610     12  PM-RECORD-ID                      PIC XX.
  2611         88  VALID-MA-ID                       VALUE 'PM'.
  2612
  2613     12  PM-CONTROL-PRIMARY.
  2614         16  PM-COMPANY-CD                 PIC X.
  2615         16  PM-ENTRY-BATCH                PIC X(6).
  2616         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2617         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2618
  2619     12  FILLER                            PIC X(14).
  2620
  2621     12  PM-ACCESS-CONTROL.
  2622         16  PM-SOURCE-SYSTEM              PIC XX.
  2623             88  PM-FROM-CREDIT                VALUE 'CR'.
  2624             88  PM-FROM-VSI                   VALUE 'VS'.
  2625             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2626             88  PM-FROM-OTHER                 VALUE 'OT'.
  2627         16  PM-RECORD-ADD-DT              PIC XX.
  2628         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2629         16  PM-LAST-MAINT-DT              PIC XX.
  2630         16  PM-LAST-MAINT-BY              PIC XXXX.
  2631         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2632
  2633     12  PM-PROFILE-INFO.
  2634         16  PM-QUALIFY-CODE-1             PIC XX.
  2635         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  50
* EL050.cbl
  2636         16  PM-QUALIFY-CODE-3             PIC XX.
  2637         16  PM-QUALIFY-CODE-4             PIC XX.
  2638         16  PM-QUALIFY-CODE-5             PIC XX.
  2639
  2640         16  PM-INSURED-LAST-NAME          PIC X(15).
  2641         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2642         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2643         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2644         16  PM-INSURED-BIRTH-DT           PIC XX.
  2645         16  PM-INSURED-SEX                PIC X.
  2646             88  PM-SEX-MALE                   VALUE 'M'.
  2647             88  PM-SEX-FEMALE                 VALUE 'F'.
  2648         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2649
  2650         16  PM-ADDRESS-CORRECTED          PIC X.
  2651         16  PM-JOINT-BIRTH-DT             PIC XX.
  2652*        16  FILLER                        PIC X(12).
  2653
  2654         16  PM-ADDRESS-LINE-1             PIC X(30).
  2655         16  PM-ADDRESS-LINE-2             PIC X(30).
  2656         16  PM-CITY-STATE.
  2657             20  PM-CITY                   PIC X(28).
  2658             20  PM-STATE                  PIC XX.
  2659         16  PM-ZIP.
  2660             20  PM-ZIP-CODE.
  2661                 24  PM-ZIP-1              PIC X.
  2662                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2663                 24  FILLER                PIC X(4).
  2664             20  PM-ZIP-PLUS4              PIC X(4).
  2665         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2666             20  PM-CAN-POST1              PIC XXX.
  2667             20  PM-CAN-POST2              PIC XXX.
  2668             20  FILLER                    PIC XXX.
  2669
  2670         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2671
  2672         16  FILLER                        PIC X(03).
  2673
  2674     12  PM-CRED-BENE-INFO.
  2675         16  PM-CRED-BENE-NAME             PIC X(25).
  2676         16  PM-CRED-BENE-ADDR             PIC X(30).
  2677         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2678         16  PM-CRED-BENE-CTYST.
  2679             20  PM-CRED-BENE-CITY         PIC X(28).
  2680             20  PM-CRED-BENE-STATE        PIC XX.
  2681         16  PM-CRED-BENE-ZIP.
  2682             20  PM-CB-ZIP-CODE.
  2683                 24  PM-CB-ZIP-1           PIC X.
  2684                     88  PM-CB-CANADIAN-POST-CODE
  2685                                  VALUE 'A' THRU 'Z'.
  2686                 24  FILLER                PIC X(4).
  2687             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2688         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2689             20  PM-CB-CAN-POST1           PIC XXX.
  2690             20  PM-CB-CAN-POST2           PIC XXX.
  2691             20  FILLER                    PIC XXX.
  2692     12  PM-POST-CARD-MAIL-DATA.
  2693         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  51
* EL050.cbl
  2694             20  PM-MAIL-TYPE              PIC X.
  2695                 88  PM-12MO-MAILING           VALUE '1'.
  2696                 88  PM-EXP-MAILING            VALUE '2'.
  2697             20  PM-MAIL-STATUS            PIC X.
  2698                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2699                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2700                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2701             20  PM-MAIL-DATE              PIC XX.
  2702     12  FILLER                            PIC XX.
  2703     12  FILLER                            PIC X(12).
  2704*    12  FILLER                            PIC X(30).
  2705
  2706******************************************************************
  2707*                                COPY ERCLOFC.
  2708******************************************************************
  2709*                                                                *
  2710*                                                                *
  2711*                            ERCLOFC                             *
  2712*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2713*                            VMOD=2.003                          *
  2714*                                                                *
  2715*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2716*                                                                *
  2717*   FILE TYPE = VSAM,KSDS                                        *
  2718*   RECORD SIZE = 670   RECFORM = FIX                            *
  2719*                                                                *
  2720*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2721*                                                                *
  2722*   LOG = YES                                                    *
  2723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2724*                                                                *
  2725******************************************************************
  2726
  2727 01  LOAN-OFFICER-MASTER.
  2728     12  LO-RECORD-ID                PIC XX.
  2729         88  VALID-LO-ID                VALUE 'LO'.
  2730
  2731     12  LO-CONTROL-PRIMARY.
  2732         16  LO-COMPANY-CD           PIC X.
  2733         16  LO-CARRIER              PIC X.
  2734         16  LO-GROUPING.
  2735             20  LO-GROUPING-PREFIX  PIC XXX.
  2736             20  LO-GROUPING-PRIME   PIC XXX.
  2737         16  LO-STATE                PIC XX.
  2738         16  LO-ACCOUNT.
  2739             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2740             20  LO-ACCOUNT-PRIME    PIC X(6).
  2741         16  LO-OFFICER-CODE         PIC X(5).
  2742
  2743     12  LO-OFFICER-NAME             PIC X(30).
  2744
  2745     12  LO-LAST-MAINT-DT            PIC XX.
  2746     12  LO-LAST-USER                PIC X(4).
  2747     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2748
  2749     12  LO-COMP-CONTROL             PIC X.
  2750             88  LO-SHOW-COMP           VALUE 'Y'.
  2751             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  52
* EL050.cbl
  2752     12  LO-DETAIL-CONTROL           PIC X.
  2753             88  LO-PRINT-DETAIL        VALUE 'D'.
  2754             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2755
  2756     12  LO-SV-CARRIER               PIC X.
  2757     12  LO-SV-GROUPING              PIC X(6).
  2758     12  LO-SV-STATE                 PIC XX.
  2759
  2760     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2761     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2762
  2763     12  LO-OFFICER-INFO.
  2764         16  FILLER OCCURS 12 TIMES.
  2765             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2766             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2767             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2768             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2769             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2770             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2771             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2772             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2773     12  FILLER                      PIC X(198).
  2774******************************************************************
  2775*                                COPY ERCPDEF.
  2776******************************************************************
  2777*                                                                *
  2778*                                                                *
  2779*                            ERCPDEF.                            *
  2780*                                                                *
  2781*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2782*                                                                *
  2783*    FILE TYPE = VSAM,KSDS                                       *
  2784*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2785*                                                                *
  2786*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2787*                                                                *
  2788*    LOG = YES                                                   *
  2789*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2790******************************************************************
  2791*                   C H A N G E   L O G
  2792*
  2793* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2794*-----------------------------------------------------------------
  2795*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2796* EFFECTIVE    NUMBER
  2797*-----------------------------------------------------------------
  2798* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2799* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2800* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2801******************************************************************
  2802 01  PRODUCT-MASTER.
  2803    12  PD-RECORD-ID                 PIC X(02).
  2804        88  VALID-PD-ID                  VALUE 'PD'.
  2805    12  PD-CONTROL-PRIMARY.
  2806        16  PD-COMPANY-CD            PIC X.
  2807        16  PD-STATE                 PIC XX.
  2808        16  PD-PRODUCT-CD            PIC XXX.
  2809        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  53
* EL050.cbl
  2810        16  PD-BEN-TYPE              PIC X.
  2811        16  PD-BEN-CODE              PIC XX.
  2812        16  PD-PROD-EXP-DT           PIC XX.
  2813    12  FILLER                       PIC X(50).
  2814    12  PD-PRODUCT-DATA OCCURS 8.
  2815        16  PD-PROD-CODE             PIC X.
  2816            88  PD-PROD-LIFE           VALUE 'L'.
  2817            88  PD-PROD-PROP           VALUE 'P'.
  2818            88  PD-PROD-AH             VALUE 'A'.
  2819            88  PD-PROD-IU             VALUE 'I'.
  2820            88  PD-PROD-GAP            VALUE 'G'.
  2821            88  PD-PROD-FAML           VALUE 'F'.
  2822        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2823        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2824        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2825        16  PD-MAX-TERM              PIC S999        COMP-3.
  2826        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2827        16  FILLER                   PIC X.
  2828        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2829        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2830        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2831        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2832        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2833        16  PD-REC-CRIT-PERIOD       PIC 99.
  2834        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2835            20  PD-RECURRING-YN      PIC X.
  2836            20  FILLER               PIC X.
  2837        16  PD-RTW-MOS               PIC 99.
  2838        16  PD-MAX-EXTENSION         PIC 99.
  2839        16  pd-ben-pct               pic sv999 comp-3.
  2840*       16  FILLER                   PIC XX.
  2841    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2842    12  PD-TERM-LIMITS OCCURS 15.
  2843        16  PD-LOW-TERM              PIC S999        COMP-3.
  2844        16  PD-HI-TERM               PIC S999        COMP-3.
  2845*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2846    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2847        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2848        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2849    12  PD-EARN-FACTORS.
  2850        16  FILLER OCCURS 15.
  2851            20  FILLER OCCURS 15.
  2852                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2853    12  PD-PRODUCT-DESC              PIC X(80).
  2854    12  PD-TRUNCATED                 PIC X.
  2855    12  FILLER                       PIC X(59).
  2856    12  PD-MAINT-INFORMATION.
  2857        16  PD-LAST-MAINT-DT         PIC X(02).
  2858        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2859        16  PD-LAST-MAINT-BY         PIC X(04).
  2860*                                COPY ELCSTATE.
  2861******************************************************************
  2862*                                                                *
  2863*                                                                *
  2864*                            ELCSTATE.                           *
  2865*                                                                *
  2866*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2867*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  54
* EL050.cbl
  2868*   FILE TYPE = VSAM,KSDS                                        *
  2869*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2870*                                                                *
  2871*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2872*       ALTERNATE INDEX = NONE                                   *
  2873*                                                                *
  2874*   LOG = YES                                                    *
  2875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2876******************************************************************
  2877*                   C H A N G E   L O G
  2878*
  2879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2880*-----------------------------------------------------------------
  2881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2882* EFFECTIVE    NUMBER
  2883*-----------------------------------------------------------------
  2884* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2885******************************************************************
  2886*
  2887 01  STATE-FILE.
  2888     12  SF-RECORD-ID                       PIC XX.
  2889         88  VALID-CF-ID                        VALUE 'SF'.
  2890     12  SF-CONTROL-PRIMARY.
  2891         16  SF-COMPANY-ID                  PIC XXX.
  2892         16  SF-CARRIER-CODE                PIC X.
  2893         16  SF-GROUPING                    PIC X(6).
  2894         16  SF-STATE-CODE                  PIC XX.
  2895         16  SF-EXPIRE-DATE                 PIC 9(8).
  2896****************************************************************
  2897*             STATE CONTROLS
  2898****************************************************************
  2899     12  SF-LAST-MAINT-DT                   PIC XX.
  2900     12  SF-LAST-MAINT-BY                   PIC X(4).
  2901     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2902     12  SF-STATE-RT-CONTROLS.
  2903         16  SF-ST-RT-CALC                  PIC X.
  2904     12  SF-ST-TAX-CONTROLS.
  2905         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2906         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2907         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2908     12  SF-ST-REFUND-OPTIONS.
  2909         16  SF-ST-RF-LR-CALC               PIC X.
  2910         16  SF-ST-RF-LL-CALC               PIC X.
  2911         16  SF-ST-RF-LN-CALC               PIC X.
  2912         16  SF-ST-RF-AH-CALC               PIC X.
  2913         16  SF-ST-RF-CP-CALC               PIC X.
  2914     12  SF-ST-UNEARN-PREM-OPTIONS.
  2915         16  SF-ST-LUEP-R78                 PIC X.
  2916         16  SF-ST-LUEP-PRO                 PIC X.
  2917         16  SF-ST-LUEP-ST                  PIC X.
  2918         16  SF-ST-LUEP-DOM                 PIC X.
  2919         16  SF-ST-AUEP-R78                 PIC X.
  2920         16  SF-ST-AUEP-PRO                 PIC X.
  2921         16  SF-ST-AUEP-ST                  PIC X.
  2922         16  SF-ST-AUEP-DOM                 PIC X.
  2923         16  SF-ST-CUEP-R78                 PIC X.
  2924         16  SF-ST-CUEP-PRO                 PIC X.
  2925         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  55
* EL050.cbl
  2926         16  SF-ST-CUEP-DOM                 PIC X.
  2927     12  SF-ST-EARN-PREM-OPTIONS.
  2928         16  SF-ST-LEP-R78                  PIC X.
  2929         16  SF-ST-LEP-PRO                  PIC X.
  2930         16  SF-ST-LEP-ST                   PIC X.
  2931         16  SF-ST-LEP-DOM                  PIC X.
  2932         16  SF-ST-AEP-R78                  PIC X.
  2933         16  SF-ST-AEP-PRO                  PIC X.
  2934         16  SF-ST-AEP-ST                   PIC X.
  2935         16  SF-ST-AEP-DOM                  PIC X.
  2936         16  SF-ST-CEP-R78                  PIC X.
  2937         16  SF-ST-CEP-PRO                  PIC X.
  2938         16  SF-ST-CEP-ST                   PIC X.
  2939         16  SF-ST-CEP-DOM                  PIC X.
  2940     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  56
* EL050.cbl
  2942*    COPY ELCCRTT.
  2943******************************************************************
  2944*                                                                *
  2945*                            ELCCRTT.                            *
  2946*                                                                *
  2947*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2948*                                                                *
  2949*   FILE TYPE = VSAM,KSDS                                        *
  2950*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2951*                                                                *
  2952*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2953*                                                                *
  2954*   LOG = YES                                                    *
  2955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2956******************************************************************
  2957*                   C H A N G E   L O G
  2958*
  2959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2960*-----------------------------------------------------------------
  2961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2962* EFFECTIVE    NUMBER
  2963*-----------------------------------------------------------------
  2964* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2965* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2966* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2967* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2968* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2969* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2970* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2971* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2972* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2973******************************************************************
  2974
  2975 01  CERTIFICATE-TRAILERS.
  2976     12  CS-RECORD-ID                      PIC XX.
  2977         88  VALID-CS-ID                      VALUE 'CS'.
  2978
  2979     12  CS-CONTROL-PRIMARY.
  2980         16  CS-COMPANY-CD                 PIC X.
  2981         16  CS-CARRIER                    PIC X.
  2982         16  CS-GROUPING                   PIC X(6).
  2983         16  CS-STATE                      PIC XX.
  2984         16  CS-ACCOUNT                    PIC X(10).
  2985         16  CS-CERT-EFF-DT                PIC XX.
  2986         16  CS-CERT-NO.
  2987             20  CS-CERT-PRIME             PIC X(10).
  2988             20  CS-CERT-SFX               PIC X.
  2989         16  CS-TRAILER-TYPE               PIC X.
  2990             88  COMM-TRLR           VALUE 'A'.
  2991             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2992             88  CERT-DATA-TRLR      VALUE 'C'.
  2993
  2994     12  CS-DATA-AREA                      PIC X(516).
  2995
  2996     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2997         16  CS-BANK-COMMISSION-AREA.
  2998             20  CS-BANK-COMMS       OCCURS 10.
  2999                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  57
* EL050.cbl
  3000                 24  CS-COM-TYP            PIC X.
  3001                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3002                 24  CS-RECALC-LV-INDIC    PIC X.
  3003                 24  FILLER                PIC X(10).
  3004         16  FILLER                        PIC X(256).
  3005
  3006     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3007****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3008         16  CS-MB-CLAIM-DATA OCCURS 24.
  3009             20  CS-CLAIM-NO               PIC X(7).
  3010             20  CS-CLAIM-TYPE             PIC X.
  3011                 88  CS-AH-CLM               VALUE 'A'.
  3012                 88  CS-IU-CLM               VALUE 'I'.
  3013                 88  CS-GP-CLM               VALUE 'G'.
  3014                 88  CS-LF-CLM               VALUE 'L'.
  3015                 88  CS-PR-CLM               VALUE 'P'.
  3016                 88  CS-FL-CLM               VALUE 'F'.
  3017             20  CS-INSURED-TYPE           PIC X.
  3018                 88  CS-PRIM-INSURED          VALUE 'P'.
  3019                 88  CS-CO-BORROWER           VALUE 'C'.
  3020             20  CS-BENEFIT-PERIOD         PIC 99.
  3021             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3022             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3023             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3024         16  FILLER                        PIC X(12).
  3025     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3026         16  CS-VIN-NUMBER                 PIC X(17).
  3027         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3028         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3029         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3030         16  cs-agent-name.
  3031             20  cs-agent-fname            pic x(20).
  3032             20  cs-agent-mi               pic x.
  3033             20  cs-agent-lname            pic x(25).
  3034         16  cs-license-no                 pic x(15).
  3035         16  cs-npn-number                 pic x(10).
  3036         16  cs-agent-edit-status          pic x.
  3037             88  cs-ae-refer-to-manager      value 'M'.
  3038             88  cs-ae-cover-sheet           value 'C'.
  3039             88  cs-ae-sig-form              value 'S'.
  3040             88  cs-ae-verified              value 'V'.
  3041             88  cs-unidentified-signature   value 'U'.
  3042             88  cs-cert-returned            value 'R'.
  3043             88  cs-accept-no-commission     value 'N'.
  3044         16  cs-year                       pic 9999.
  3045         16  cs-make                       pic x(20).
  3046         16  cs-model                      pic x(20).
  3047         16  cs-future                     pic x(20).
  3048         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3049         16  FILLER                        PIC X(356). *> was 420
  3050*        16  FILLER                        PIC X(496).
  3051*    COPY ELCCRTO.
  3052******************************************************************
  3053*                                                                *
  3054*                            ELCCRTO.                            *
  3055*                                                                *
  3056*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  58
* EL050.cbl
  3058*   FILE TYPE = VSAM,KSDS                                        *
  3059*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3060*                                                                *
  3061*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3062*                                                                *
  3063*   LOG = YES                                                    *
  3064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3065******************************************************************
  3066*                   C H A N G E   L O G
  3067*
  3068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3069*-----------------------------------------------------------------
  3070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3071* EFFECTIVE    NUMBER
  3072*-----------------------------------------------------------------
  3073* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3074* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3075* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3076* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3077* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3078******************************************************************
  3079 01  ORIGINAL-CERTIFICATE.
  3080     12  OC-RECORD-ID                      PIC XX.
  3081         88  VALID-OC-ID                      VALUE 'OC'.
  3082     12  OC-CONTROL-PRIMARY.
  3083         16  OC-COMPANY-CD                 PIC X.
  3084         16  OC-CARRIER                    PIC X.
  3085         16  OC-GROUPING                   PIC X(6).
  3086         16  OC-STATE                      PIC XX.
  3087         16  OC-ACCOUNT                    PIC X(10).
  3088         16  OC-CERT-EFF-DT                PIC XX.
  3089         16  OC-CERT-NO.
  3090             20  OC-CERT-PRIME             PIC X(10).
  3091             20  OC-CERT-SFX               PIC X.
  3092         16  OC-RECORD-TYPE                PIC X.
  3093         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3094     12  OC-LAST-MAINT-DT                  PIC XX.
  3095     12  OC-LAST-MAINT-BY                  PIC X(4).
  3096     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3097     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3098     12  FILLER                            PIC X(49).
  3099     12  OC-ORIG-REC.
  3100         16  OC-INS-LAST-NAME              PIC X(15).
  3101         16  OC-INS-FIRST-NAME             PIC X(10).
  3102         16  OC-INS-MIDDLE-INIT            PIC X.
  3103         16  OC-INS-AGE                    PIC S999     COMP-3.
  3104         16  OC-JNT-LAST-NAME              PIC X(15).
  3105         16  OC-JNT-FIRST-NAME             PIC X(10).
  3106         16  OC-JNT-MIDDLE-INIT            PIC X.
  3107         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3108         16  OC-LF-BENCD                   PIC XX.
  3109         16  OC-LF-TERM                    PIC S999      COMP-3.
  3110         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3111         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3112         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3113         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3114         16  OC-LF-EXP-DT                  PIC XX.
  3115         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  59
* EL050.cbl
  3116         16  OC-LF-CANCEL-DT               PIC XX.
  3117         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3118         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3119         16  OC-AH-BENCD                   PIC XX.
  3120         16  OC-AH-TERM                    PIC S999      COMP-3.
  3121         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3122         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3123         16  OC-AH-EXP-DT                  PIC XX.
  3124         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3125         16  OC-AH-CP                      PIC 99.
  3126         16  OC-AH-CANCEL-DT               PIC XX.
  3127         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3128         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3129         16  OC-CRED-BENE-NAME             PIC X(25).
  3130         16  OC-1ST-PMT-DT                 PIC XX.
  3131         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3132         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3133         16  OC-ISSUE-TRAN-IND             PIC X.
  3134         16  OC-CANCEL-TRAN-IND            PIC X.
  3135         16  FILLER                        PIC X(211).
  3136
  3137     12  FILLER                            PIC X(50).
  3138******************************************************************
  3139
  3140*    COPY ELCDATE.
  3141******************************************************************
  3142*                                                                *
  3143*                                                                *
  3144*                            ELCDATE.                            *
  3145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3146*                            VMOD=2.003
  3147*                                                                *
  3148*                                                                *
  3149*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3150*                 LENGTH = 200                                   *
  3151******************************************************************
  3152
  3153 01  DATE-CONVERSION-DATA.
  3154     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3155     12  DC-OPTION-CODE                PIC X.
  3156         88  BIN-TO-GREG                VALUE ' '.
  3157         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3158         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3159         88  YMD-GREG-TO-BIN            VALUE '3'.
  3160         88  MDY-GREG-TO-BIN            VALUE '4'.
  3161         88  JULIAN-TO-BIN              VALUE '5'.
  3162         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3163         88  FIND-CENTURY               VALUE '7'.
  3164         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3165         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3166         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3167         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3168         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3169         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3170         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3171         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3172         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3173         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  60
* EL050.cbl
  3174         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3175         88  BIN-3-TO-GREG              VALUE 'I'.
  3176         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3177         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3178         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3179         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3180         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3181         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3182         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3183         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3184         88  THREE-CHARACTER-BIN
  3185                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3186         88  GREGORIAN-TO-BIN
  3187                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3188         88  BIN-TO-GREGORIAN
  3189                  VALUES ' ' '1' 'I' '8' 'G'.
  3190         88  JULIAN-TO-BINARY
  3191                  VALUES '5' 'C' 'E' 'F'.
  3192     12  DC-ERROR-CODE                 PIC X.
  3193         88  NO-CONVERSION-ERROR        VALUE ' '.
  3194         88  DATE-CONVERSION-ERROR
  3195                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3196         88  DATE-IS-ZERO               VALUE '1'.
  3197         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3198         88  DATE-IS-INVALID            VALUE '3'.
  3199         88  DATE1-GREATER-DATE2        VALUE '4'.
  3200         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3201         88  DATE-INVALID-OPTION        VALUE '9'.
  3202         88  INVALID-CENTURY            VALUE 'A'.
  3203         88  ONLY-CENTURY               VALUE 'B'.
  3204         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3205         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3206     12  DC-END-OF-MONTH               PIC X.
  3207         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3208     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3209         88  USE-NORMAL-PROCESS         VALUE ' '.
  3210         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3211         88  ADJUST-UP-100-YRS          VALUE '2'.
  3212     12  FILLER                        PIC X.
  3213     12  DC-CONVERSION-DATES.
  3214         16  DC-BIN-DATE-1             PIC XX.
  3215         16  DC-BIN-DATE-2             PIC XX.
  3216         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3217         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3218                       DC-GREG-DATE-1-EDIT.
  3219             20  DC-EDIT1-MONTH        PIC 99.
  3220             20  SLASH1-1              PIC X.
  3221             20  DC-EDIT1-DAY          PIC 99.
  3222             20  SLASH1-2              PIC X.
  3223             20  DC-EDIT1-YEAR         PIC 99.
  3224         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3225         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3226                     DC-GREG-DATE-2-EDIT.
  3227             20  DC-EDIT2-MONTH        PIC 99.
  3228             20  SLASH2-1              PIC X.
  3229             20  DC-EDIT2-DAY          PIC 99.
  3230             20  SLASH2-2              PIC X.
  3231             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  61
* EL050.cbl
  3232         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3233         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3234                     DC-GREG-DATE-1-YMD.
  3235             20  DC-YMD-YEAR           PIC 99.
  3236             20  DC-YMD-MONTH          PIC 99.
  3237             20  DC-YMD-DAY            PIC 99.
  3238         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3239         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3240                      DC-GREG-DATE-1-MDY.
  3241             20  DC-MDY-MONTH          PIC 99.
  3242             20  DC-MDY-DAY            PIC 99.
  3243             20  DC-MDY-YEAR           PIC 99.
  3244         16  DC-GREG-DATE-1-ALPHA.
  3245             20  DC-ALPHA-MONTH        PIC X(10).
  3246             20  DC-ALPHA-DAY          PIC 99.
  3247             20  FILLER                PIC XX.
  3248             20  DC-ALPHA-CENTURY.
  3249                 24 DC-ALPHA-CEN-N     PIC 99.
  3250             20  DC-ALPHA-YEAR         PIC 99.
  3251         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3252         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3253         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3254         16  DC-JULIAN-DATE            PIC 9(05).
  3255         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3256                                       PIC 9(05).
  3257         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3258             20  DC-JULIAN-YEAR        PIC 99.
  3259             20  DC-JULIAN-DAYS        PIC 999.
  3260         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3261         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3262         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3263     12  DATE-CONVERSION-VARIBLES.
  3264         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3265         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3266             20  FILLER                PIC 9(3).
  3267             20  HOLD-CEN-1-CCYY.
  3268                 24  HOLD-CEN-1-CC     PIC 99.
  3269                 24  HOLD-CEN-1-YY     PIC 99.
  3270             20  HOLD-CEN-1-MO         PIC 99.
  3271             20  HOLD-CEN-1-DA         PIC 99.
  3272         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3273             20  HOLD-CEN-1-R-MO       PIC 99.
  3274             20  HOLD-CEN-1-R-DA       PIC 99.
  3275             20  HOLD-CEN-1-R-CCYY.
  3276                 24  HOLD-CEN-1-R-CC   PIC 99.
  3277                 24  HOLD-CEN-1-R-YY   PIC 99.
  3278             20  FILLER                PIC 9(3).
  3279         16  HOLD-CENTURY-1-X.
  3280             20  FILLER                PIC X(3)  VALUE SPACES.
  3281             20  HOLD-CEN-1-X-CCYY.
  3282                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3283                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3284             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3285             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3286         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3287             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3288             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3289             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  62
* EL050.cbl
  3290                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3291                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3292             20  FILLER                PIC XXX.
  3293         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3294         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3295         16  DC-JULIAN-DATE-1          PIC 9(07).
  3296         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3297             20  DC-JULIAN-1-CCYY.
  3298                 24  DC-JULIAN-1-CC    PIC 99.
  3299                 24  DC-JULIAN-1-YR    PIC 99.
  3300             20  DC-JULIAN-DA-1        PIC 999.
  3301         16  DC-JULIAN-DATE-2          PIC 9(07).
  3302         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3303             20  DC-JULIAN-2-CCYY.
  3304                 24  DC-JULIAN-2-CC    PIC 99.
  3305                 24  DC-JULIAN-2-YR    PIC 99.
  3306             20  DC-JULIAN-DA-2        PIC 999.
  3307         16  DC-GREG-DATE-A-EDIT.
  3308             20  DC-EDITA-MONTH        PIC 99.
  3309             20  SLASHA-1              PIC X VALUE '/'.
  3310             20  DC-EDITA-DAY          PIC 99.
  3311             20  SLASHA-2              PIC X VALUE '/'.
  3312             20  DC-EDITA-CCYY.
  3313                 24  DC-EDITA-CENT     PIC 99.
  3314                 24  DC-EDITA-YEAR     PIC 99.
  3315         16  DC-GREG-DATE-B-EDIT.
  3316             20  DC-EDITB-MONTH        PIC 99.
  3317             20  SLASHB-1              PIC X VALUE '/'.
  3318             20  DC-EDITB-DAY          PIC 99.
  3319             20  SLASHB-2              PIC X VALUE '/'.
  3320             20  DC-EDITB-CCYY.
  3321                 24  DC-EDITB-CENT     PIC 99.
  3322                 24  DC-EDITB-YEAR     PIC 99.
  3323         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3324         16  DC-GREG-DATE-CYMD-R REDEFINES
  3325                              DC-GREG-DATE-CYMD.
  3326             20  DC-CYMD-CEN           PIC 99.
  3327             20  DC-CYMD-YEAR          PIC 99.
  3328             20  DC-CYMD-MONTH         PIC 99.
  3329             20  DC-CYMD-DAY           PIC 99.
  3330         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3331         16  DC-GREG-DATE-MDCY-R REDEFINES
  3332                              DC-GREG-DATE-MDCY.
  3333             20  DC-MDCY-MONTH         PIC 99.
  3334             20  DC-MDCY-DAY           PIC 99.
  3335             20  DC-MDCY-CEN           PIC 99.
  3336             20  DC-MDCY-YEAR          PIC 99.
  3337    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3338        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3339    12  DC-EL310-DATE                  PIC X(21).
  3340    12  FILLER                         PIC X(28).
  3341
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  63
* EL050.cbl
  3343*    COPY ELCCALC.
  3344******************************************************************
  3345*                                                                *
  3346*                           ELCCALC.                            *
  3347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3348*                            VMOD=2.025                          *
  3349*                                                                *
  3350*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3351*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3352*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3353*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3354*                                                                *
  3355*  PASSED TO ELRTRM                                              *
  3356*  -----------------                                             *
  3357*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3358*  ORIGINAL TERM                                                 *
  3359*  BEGINNING DATE                                                *
  3360*  ENDING DATE                                                   *
  3361*  COMPANY I.D.                                                  *
  3362*  ACCOUNT MASTER USER FIELD                                     *
  3363*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3364*  FREE LOOK DAYS                                                *
  3365*                                                                *
  3366*  RETURNED FROM ELRTRM                                          *
  3367*  ---------------------                                         *
  3368*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3369*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3370*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3371*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3372*----------------------------------------------------------------*
  3373*  PASSED TO ELRAMT                                              *
  3374*  ----------------                                              *
  3375*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3376*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3377*  ORIGINAL AMOUNT                                               *
  3378*  ALTERNATE BENEFIT (BALLON)                                    *
  3379*  A.P.R. - NET PAY ONLY                                         *
  3380*  METHOD
  3381*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3382*  COMPANY I.D.                                                  *
  3383*  BENEFIT TYPE                                                  *
  3384*                                                                *
  3385*  RETURNED FROM ELRAMT                                          *
  3386*  --------------------                                          *
  3387*  REMAINING AMOUNT 1 - CURRENT                                  *
  3388*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3389*  REMAINING AMOUNT FACTOR
  3390*----------------------------------------------------------------*
  3391*  PASSED TO ELRESV                                              *
  3392*  -----------------                                             *
  3393*  CERTIFICATE EFFECTIVE DATE                                    *
  3394*  VALUATION DATE                                                *
  3395*  PAID THRU DATE                                                *
  3396*  BENEFIT                                                       *
  3397*  INCURRED DATE                                                 *
  3398*  REPORTED DATE                                                 *
  3399*  ISSUE AGE                                                     *
  3400*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  64
* EL050.cbl
  3401*  CDT PERCENT                                                   *
  3402*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3403* *CLAIM TYPE (LIFE, A/H)                                        *
  3404* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3405* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3406*                                                                *
  3407*  RETURNED FROM ELRESV                                          *
  3408*  --------------------                                          *
  3409*  CDT TABLE USED                                                *
  3410*  CDT FACTOR USED                                               *
  3411*  PAY TO CURRENT RESERVE                                        *
  3412*  I.B.N.R. - A/H ONLY                                           *
  3413*  FUTURE (ACCRUED) AH ONLY                                      *
  3414*----------------------------------------------------------------*
  3415*  PASSED TO ELRATE                                              *
  3416*  ----------------                                              *
  3417*  CERT ISSUE DATE                                               *
  3418*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3419*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3420*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3421*  STATE CODE (CLIENT DEFINED)                                   *
  3422*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3423*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3424*  DEVIATION CODE                                                *
  3425*  ISSUE AGE                                                     *
  3426*  ORIGINAL BENEFIT AMOUNT                                       *
  3427*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3428*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3429*  BENEFIT KIND (LIFE OR A/H)                                    *
  3430*  A.P.R.                                                        *
  3431*  METHOD
  3432*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3433*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3434*  COMPANY I.D. (3 CHARACTER)                                    *
  3435*  BENEFIT CODE                                                  *
  3436*  BENEFIT OVERRIDE CODE                                         *
  3437*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3438*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3439*  JOINT INDICATOR (CSL ONLY)                                    *
  3440*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3441*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3442*                                                                *
  3443*  RETURNED FROM ELRATE                                          *
  3444*  --------------------                                          *
  3445*  CALCULATED PREMIUM                                            *
  3446*  PREMIUM RATE                                                  *
  3447*  MORTALITY CODE                                                *
  3448*  MAX ATTAINED AGE                                              *
  3449*  MAX AGE                                                       *
  3450*  MAX TERM                                                      *
  3451*  MAX MONTHLY BENEFIT                                           *
  3452*  MAX TOTAL BENIFIT                                             *
  3453*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3454*----------------------------------------------------------------*
  3455*  PASSED TO ELRFND                                              *
  3456*  ----------------                                              *
  3457*  CERT ISSUE DATE                                               *
  3458*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  65
* EL050.cbl
  3459*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3460*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3461*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3462*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3463*  STATE CODE (CLIENT DEFINED)                                   *
  3464*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3465*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3466*  DEVIATION CODE                                                *
  3467*  ISSUE AGE                                                     *
  3468*  ORIGINAL BENEFIT AMOUNT                                       *
  3469*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3470*  PROCESS TYPE (CANCEL)                                         *
  3471*  BENEFIT KIND (LIFE OR A/H)                                    *
  3472*  A.P.R.                                                        *
  3473*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3474*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3475*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3476*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3477*  COMPANY I.D. (3 CHARACTER)                                    *
  3478*  BENEFIT CODE                                                  *
  3479*  BENEFIT OVERRIDE CODE                                         *
  3480*                                                                *
  3481*  RETURNED FROM ELRFND                                          *
  3482*  --------------------                                          *
  3483*  CALCULATED REFUND                                             *
  3484*----------------------------------------------------------------*
  3485*  PASSED TO ELEARN                                              *
  3486*  ----------------                                              *
  3487*  CERT ISSUE DATE                                               *
  3488*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3489*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3490*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3491*  STATE CODE (CLIENT DEFINED)                                   *
  3492*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3493*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3494*  DEVIATION CODE                                                *
  3495*  ISSUE AGE                                                     *
  3496*  ORIGINAL BENEFIT AMOUNT                                       *
  3497*  BENEFIT KIND (LIFE OR A/H)                                    *
  3498*  A.P.R.                                                        *
  3499*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3500*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3501*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3502*  COMPANY I.D. (3 CHARACTER)                                    *
  3503*  BENEFIT CODE                                                  *
  3504*  BENEFIT OVERRIDE CODE                                         *
  3505*                                                                *
  3506*  RETURNED FROM ELEARN                                          *
  3507*  --------------------                                          *
  3508*  INDICATED  EARNINGS                                           *
  3509*----------------------------------------------------------------*
  3510*                 LENGTH = 450                                   *
  3511*                                                                *
  3512******************************************************************
  3513******************************************************************
  3514*                   C H A N G E   L O G
  3515*
  3516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  66
* EL050.cbl
  3517*-----------------------------------------------------------------
  3518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3519* EFFECTIVE    NUMBER
  3520*-----------------------------------------------------------------
  3521* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3522* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3523* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3524* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3525* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3526* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3527* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3528* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3529* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3530* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3531* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3532******************************************************************
  3533
  3534 01  CALCULATION-PASS-AREA.
  3535     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3536                                     COMP.
  3537
  3538     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3539       88  NO-CP-ERROR                             VALUE ZERO.
  3540       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3541                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3542       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3543       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3544       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3545       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3546       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3547       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3548       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3549       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3550       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3551       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3552       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3553       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3554       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3555       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3556       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3557       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3558       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3559
  3560     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3561       88  NO-CP-ERROR-2                           VALUE ZERO.
  3562***********************  INPUT AREAS ****************************
  3563
  3564     12  CP-CALCULATION-AREA.
  3565         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3566         16  CP-CERT-EFF-DT        PIC XX.
  3567         16  CP-VALUATION-DT       PIC XX.
  3568         16  CP-PAID-THRU-DT       PIC XX.
  3569         16  CP-BENEFIT-TYPE       PIC X.
  3570           88  CP-AH                               VALUE 'A' 'D'
  3571                                                   'I' 'U'.
  3572           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3573           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3574         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  67
* EL050.cbl
  3575         16  CP-REPORTED-DT        PIC XX.
  3576         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3577         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3578         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3579                                     COMP-3.
  3580         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3581                                     COMP-3.
  3582         16  CP-CDT-METHOD         PIC X.
  3583           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3584           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3585           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3586         16  CP-CLAIM-TYPE         PIC X.
  3587           88  CP-AH-CLAIM                         VALUE 'A'.
  3588           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3589         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3596                                     COMP-3.
  3597         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3598                                     COMP-3.
  3599         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-REM-TERM-METHOD    PIC X.
  3604           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3605           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3606           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3607           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3608           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3609           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3610           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3611         16  CP-EARNING-METHOD     PIC X.
  3612           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3613           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3614           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3615           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3616           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3617           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3618           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3619           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3620           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3621           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3622           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3623           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3624           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3625           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3626         16  CP-PROCESS-TYPE       PIC X.
  3627           88  CP-CLAIM                            VALUE '1'.
  3628           88  CP-CANCEL                           VALUE '2'.
  3629           88  CP-ISSUE                            VALUE '3'.
  3630         16  CP-SPECIAL-CALC-CD    PIC X.
  3631           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3632           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  68
* EL050.cbl
  3633           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3634           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3635           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3636           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3637           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3638           88  CP-FARM-PLAN                    VALUE 'F'.
  3639           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3640           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3641           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3642           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3643           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3644           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3645           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3646           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3647           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3648           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3649                                                     'W' 'X'.
  3650           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3651           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3652           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3653           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3654           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3655           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3656           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3657           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3658           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3659           88  CP-CSL-METH-1                   VALUE '5'.
  3660           88  CP-CSL-METH-2                   VALUE '6'.
  3661           88  CP-CSL-METH-3                   VALUE '7'.
  3662           88  CP-CSL-METH-4                   VALUE '8'.
  3663
  3664         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3667         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3668         16  CP-STATE              PIC XX          VALUE SPACE.
  3669         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3670         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3671           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3672               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3673         16  CP-R78-OPTION         PIC X.
  3674           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3675           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3676
  3677         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3678         16  CP-IBNR-RESERVE-SW    PIC X.
  3679         16  CP-CLAIM-STATUS       PIC X.
  3680         16  CP-RATE-FILE          PIC X.
  3681         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3682                                     COMP-3.
  3683
  3684         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3685         16  CP-AH-OVERRIDE-CODE   PIC X.
  3686
  3687         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3688                                     COMP-3.
  3689         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3690                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  69
* EL050.cbl
  3691         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3698                                  PIC S9(7)V99 COMP-3.
  3699
  3700         16  CP-PAID-FROM-DATE     PIC X(02).
  3701         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3702         16  CP-EXT-DAYS-CALC      PIC X.
  3703           88  CP-EXT-NO-CHG                   VALUE ' '.
  3704           88  CP-EXT-CHG-LF                   VALUE '1'.
  3705           88  CP-EXT-CHG-AH                   VALUE '2'.
  3706           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3707         16  CP-DOMICILE-STATE     PIC XX.
  3708         16  CP-CARRIER            PIC X.
  3709         16  CP-REIN-FLAG          PIC X.
  3710         16  CP-REM-TRM-CALC-OPTION PIC X.
  3711           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3712                      '2' '3' '4' '5'.
  3713           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3714           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3715           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3716           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3717           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3718           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3719           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3720           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3721         16  CP-SIG-SWITCH         PIC X.
  3722         16  CP-RATING-METHOD      PIC X.
  3723           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3724           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3725           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3726           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3727           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3728           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3729           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3730           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3731           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3732         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3733                                     COMP-3.
  3734         16  CP-BEN-CATEGORY       PIC X.
  3735         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3736         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3737                                   PIC S99V9(5) COMP-3.
  3738         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3739         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3740                                   PIC S99V9(5) COMP-3.
  3741         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3742         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3743         16  CP-EXPIRE-DT          PIC XX.
  3744         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3745         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3746         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3747         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3748         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  70
* EL050.cbl
  3749             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3750             88  CP-CALC-CLP              VALUE 'C'.
  3751         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3752         16  CP-CANCEL-REASON      PIC X.
  3753         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3754         16  CP-PMT-MODE           PIC X.
  3755         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3756         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3757         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3758         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3759         16  FILLER                PIC X.
  3760
  3761***************    OUTPUT FROM ELRESV   ************************
  3762
  3763         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3764
  3765         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  FILLER                PIC X(09).
  3774***************    OUTPUT FROM ELRTRM   *************************
  3775
  3776         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3783                                     COMP-3.
  3784         16  FILLER                PIC X(12).
  3785
  3786***************    OUTPUT FROM ELRAMT   *************************
  3787
  3788         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3789                                     COMP-3.
  3790         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3791                                     COMP-3.
  3792         16  FILLER                PIC X(12).
  3793
  3794***************    OUTPUT FROM ELRATE   *************************
  3795
  3796         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3797                                     COMP-3.
  3798         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3799                                     COMP-3.
  3800         16  CP-MORTALITY-CODE     PIC X(4).
  3801         16  CP-RATE-EDIT-FLAG     PIC X.
  3802             88  CP-RATES-NEED-APR                  VALUE '1'.
  3803         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3806         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  71
* EL050.cbl
  3807         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3808                                   PIC S9(7)V99 COMP-3.
  3809         16  FILLER                PIC X(07).
  3810
  3811***************    OUTPUT FROM ELRFND   *************************
  3812
  3813         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-REFUND-TYPE-USED   PIC X.
  3816           88  CP-R-AS-R78                         VALUE '1'.
  3817           88  CP-R-AS-PRORATA                     VALUE '2'.
  3818           88  CP-R-AS-CALIF                       VALUE '3'.
  3819           88  CP-R-AS-TEXAS                       VALUE '4'.
  3820           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3821           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3822           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3823           88  CP-R-AS-MEAN                        VALUE '8'.
  3824           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3825           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3826           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3827           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3828           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3829           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3830         16  FILLER                PIC X(12).
  3831
  3832***************    OUTPUT FROM ELEARN   *************************
  3833
  3834         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3841                                     COMP-3.
  3842         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3843                                     COMP-3.
  3844         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-EARNING-TYPE-USED  PIC X.
  3847           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3848           88  CP-E-AS-R78                         VALUE '1'.
  3849           88  CP-E-AS-PRORATA                     VALUE '2'.
  3850           88  CP-E-AS-TEXAS                       VALUE '4'.
  3851           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3852           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3853           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3854           88  CP-E-AS-MEAN                        VALUE '8'.
  3855           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3856         16  FILLER                PIC X(12).
  3857
  3858***************    OUTPUT FROM ELPMNT   *************************
  3859
  3860         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3861                                     COMP-3.
  3862         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3863                                     COMP-3.
  3864         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  72
* EL050.cbl
  3865
  3866***************   MISC WORK AREAS    *****************************
  3867         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3870                                     COMP-3.
  3871         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3872                                     COMP-3.
  3873         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3878                                     COMP-3.
  3879         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3880             88  OPEN-RATE-FILE                   VALUE 'O'.
  3881             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3882             88  IO-ERROR                         VALUE 'E'.
  3883
  3884         16  CP-FIRST-PAY-DATE     PIC XX.
  3885
  3886         16  CP-JOINT-INDICATOR    PIC X.
  3887
  3888         16  CP-RESERVE-REMAINING-TERM
  3889                                   PIC S9(4)V9    VALUE ZERO
  3890                                     COMP-3.
  3891
  3892         16  CP-INSURED-BIRTH-DT   PIC XX.
  3893
  3894         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3895                                     COMP-3.
  3896
  3897         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3898                                     COMP-3.
  3899
  3900         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3904                                     COMP-3.
  3905
  3906         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3907                                     COMP-3.
  3908
  3909         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3910                                     COMP-3.
  3911
  3912         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3913                                     COMP-3.
  3914
  3915         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3916             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3917
  3918         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  73
* EL050.cbl
  3923         16  cp-extra-periods      pic 9 value zeros.
  3924         16  cp-net-only-state     pic x value spaces.
  3925         16  FILLER                PIC X(13).
  3926******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  74
* EL050.cbl
  3928******************************************************************
  3929*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3930*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3931*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3932*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3933*** MODIFICATION.                                              ***
  3934*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3935*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3936******************************************************************
  3937*    COPY ERCPNDB.
  3938******************************************************************
  3939*                                                                *
  3940*                                                                *
  3941*                            ERCPNDB.                            *
  3942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3943*                            VMOD=2.025                          *
  3944*                                                                *
  3945*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3946*                                                                *
  3947******************************************************************
  3948*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3949*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3950******************************************************************
  3951*                                                                *
  3952*                                                                *
  3953*   FILE TYPE = VSAM,KSDS                                        *
  3954*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3955*                                                                *
  3956*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3957*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3958*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3959*                                                 RKP=13,LEN=36  *
  3960*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3961*                                      AND CHG-SEQ.)             *
  3962*                                                RKP=49,LEN=11   *
  3963*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3964*                                      AND CHG-SEQ.)             *
  3965*                                                RKP=60,LEN=15   *
  3966*                                                                *
  3967*   LOG = NO                                                     *
  3968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3969******************************************************************
  3970******************************************************************
  3971*                   C H A N G E   L O G
  3972*
  3973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3974*-----------------------------------------------------------------
  3975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3976* EFFECTIVE    NUMBER
  3977*-----------------------------------------------------------------
  3978* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3979* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3980* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3981* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3982* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3983* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3984* 032306                   PEMA  ADD BOW LOAN NUMBER
  3985* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  75
* EL050.cbl
  3986* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3987* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3988* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3989* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3990* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3991* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3992* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3993* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3994* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3995******************************************************************
  3996
  3997 01  PENDING-BUSINESS.
  3998     12  PB-RECORD-ID                     PIC XX.
  3999         88  VALID-PB-ID                        VALUE 'PB'.
  4000
  4001     12  PB-CONTROL-PRIMARY.
  4002         16  PB-COMPANY-CD                PIC X.
  4003         16  PB-ENTRY-BATCH               PIC X(6).
  4004         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4005         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4006
  4007     12  PB-CONTROL-BY-ACCOUNT.
  4008         16  PB-COMPANY-CD-A1             PIC X.
  4009         16  PB-CARRIER                   PIC X.
  4010         16  PB-GROUPING.
  4011             20  PB-GROUPING-PREFIX       PIC XXX.
  4012             20  PB-GROUPING-PRIME        PIC XXX.
  4013         16  PB-STATE                     PIC XX.
  4014         16  PB-ACCOUNT.
  4015             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4016             20  PB-ACCOUNT-PRIME         PIC X(6).
  4017         16  PB-CERT-EFF-DT               PIC XX.
  4018         16  PB-CERT-NO.
  4019             20  PB-CERT-PRIME            PIC X(10).
  4020             20  PB-CERT-SFX              PIC X.
  4021         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4022
  4023         16  PB-RECORD-TYPE               PIC X.
  4024             88  PB-MAILING-DATA                VALUE '0'.
  4025             88  PB-ISSUE                       VALUE '1'.
  4026             88  PB-CANCELLATION                VALUE '2'.
  4027             88  PB-BATCH-TRAILER               VALUE '9'.
  4028
  4029     12  PB-CONTROL-BY-ORIG-BATCH.
  4030         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4031         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4032         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4033         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4034
  4035     12  PB-CONTROL-BY-CSR.
  4036         16  PB-CSR-COMPANY-CD            PIC X.
  4037         16  PB-CSR-ID                    PIC X(4).
  4038         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4039         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4040         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4041******************************************************************
  4042*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4043******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  76
* EL050.cbl
  4044
  4045     12  PB-LAST-MAINT-DT                 PIC XX.
  4046     12  PB-LAST-MAINT-BY                 PIC X(4).
  4047     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4048
  4049     12  PB-RECORD-BODY                   PIC X(375).
  4050
  4051     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4052         16  PB-CERT-ORIGIN               PIC X.
  4053             88  CLASIC-CREATED-CERT         VALUE '1'.
  4054         16  PB-I-NAME.
  4055             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4056             20  PB-I-INSURED-FIRST-NAME.
  4057                 24  PB-I-INSURED-1ST-INIT PIC X.
  4058                 24  FILLER                PIC X(9).
  4059             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4060         16  PB-I-AGE                     PIC S99   COMP-3.
  4061         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4062         16  PB-I-BIRTHDAY                PIC XX.
  4063         16  PB-I-INSURED-SEX             PIC X.
  4064             88  PB-SEX-MALE     VALUE 'M'.
  4065             88  PB-SEX-FEMALE   VALUE 'F'.
  4066
  4067         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4068         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4069         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4070         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4071         16  PB-I-SKIP-CODE               PIC X.
  4072             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4073             88  PB-SKIP-JULY              VALUE '1'.
  4074             88  PB-SKIP-AUGUST            VALUE '2'.
  4075             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4076             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4077             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4078             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4079             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4080             88  PB-SKIP-JUNE              VALUE '8'.
  4081             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4082             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4083             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4084         16  PB-I-TERM-TYPE               PIC X.
  4085             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4086             88  PB-PAID-WEEKLY            VALUE 'W'.
  4087             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4088             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4089             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4090         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4091         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4092         16  PB-I-DATA-ENTRY-SW           PIC X.
  4093             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4094             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4095             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4096             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4097         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4098         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4099*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4100         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4101         16  FILLER                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  77
* EL050.cbl
  4102
  4103         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4104             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4105             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4106                                                   '90' THRU '99'.
  4107         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4108                                          PIC XX.
  4109         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4110         16  PB-I-AMOUNT-FINANCED REDEFINES
  4111                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4112         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4113         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4114                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4115         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4116         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4117         16  PB-I-CLP-AMOUNT REDEFINES
  4118                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4119         16  PB-I-LF-CALC-FLAG            PIC X.
  4120             88 PB-COMP-LF-PREM               VALUE '?'.
  4121         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4122         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4123         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4124         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4125         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4126         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4127         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4128         16  PB-I-LF-ABBR                 PIC XXX.
  4129         16  PB-I-LF-INPUT-CD             PIC XX.
  4130
  4131         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4132             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4133             88  PB-INVALID-AH               VALUE '  ' '00'
  4134                                                   '90' THRU '99'.
  4135         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4136         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4137         16  PB-I-AH-CALC-FLAG            PIC X.
  4138             88 PB-COMP-AH-PREM                  VALUE '?'.
  4139         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4140         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4141         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4142         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4143         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4144         16  PB-I-AH-ABBR                 PIC XXX.
  4145         16  PB-I-AH-INPUT-CD             PIC XXX.
  4146
  4147         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4148         16  PB-I-REIN-TABLE              PIC XXX.
  4149         16  PB-I-BUSINESS-TYPE           PIC 99.
  4150         16  PB-I-INDV-GRP-CD             PIC X.
  4151         16  PB-I-MORT-CODE.
  4152             20  PB-I-TABLE               PIC X.
  4153             20  PB-I-INTEREST            PIC XX.
  4154             20  PB-I-MORT-TYP            PIC X.
  4155         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4156         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4157         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4158         16  PB-I-INDV-GRP-OVRD           PIC X.
  4159         16  PB-I-RATE-CLASS-OVRD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  78
* EL050.cbl
  4160         16  PB-I-SIG-SW                  PIC X.
  4161             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4162         16  PB-I-RATE-CLASS              PIC XX.
  4163         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4164         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4165         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4166         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4167         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4168         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4169         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4170         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4171         16  PB-I-OB-FLAG                 PIC X.
  4172             88  PB-I-OB                      VALUE 'B'.
  4173             88  PB-I-SUMMARY                 VALUE 'Z'.
  4174         16  PB-I-ENTRY-STATUS            PIC X.
  4175             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4176                                              'M' '5' '9' '2'.
  4177             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4178             88  PB-I-POLICY-PENDING          VALUE '2'.
  4179             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4180             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4181             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4182             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4183             88  PB-I-REIN-ONLY               VALUE '9'.
  4184             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4185             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4186             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4187             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4188         16  PB-I-INT-CODE                PIC X.
  4189             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4190             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4191         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4192         16  PB-I-SOC-SEC-NO              PIC X(11).
  4193         16  PB-I-MEMBER-NO               PIC X(12).
  4194         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4195*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4196         16  PB-I-OLD-LOF                 PIC XXX.
  4197         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4198         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4199         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4200         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4201         16  PB-I-LIFE-INDICATOR          PIC X.
  4202             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4203         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4204         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4205                                          PIC S9(5)V99    COMP-3.
  4206         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4207             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4208             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4209         16  PB-I-1ST-PMT-DT              PIC XX.
  4210         16  PB-I-JOINT-INSURED.
  4211             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4212             20 PB-I-JOINT-FIRST-NAME.
  4213                24  PB-I-JOINT-FIRST-INIT PIC X.
  4214                24  FILLER                PIC X(9).
  4215             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4216*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4217         16  PB-I-BENEFICIARY-NAME.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  79
* EL050.cbl
  4218             20  PB-I-BANK-NUMBER         PIC X(10).
  4219             20  FILLER                   PIC X(15).
  4220         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4221         16  PB-I-REFERENCE               PIC X(12).
  4222         16  FILLER REDEFINES PB-I-REFERENCE.
  4223             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4224             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4225             20  PB-I-CLP-STATE           PIC XX.
  4226         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4227             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4228             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4229             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4230         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4231         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4232         16  PB-I-RESIDENT-STATE          PIC XX.
  4233         16  PB-I-RATE-CODE               PIC X(4).
  4234         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4235         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4236         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4237         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4238         16  PB-I-BANK-NOCHRGB            PIC 99.
  4239         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4240         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4241
  4242     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4243         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4244             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4245         16  PB-C-CANCEL-ORIGIN           PIC X.
  4246             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4247         16  PB-C-LF-CANCEL-DT            PIC XX.
  4248         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4249         16  PB-C-LF-CALC-REQ             PIC X.
  4250             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4251         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4252         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4253         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4254             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4255         16  PB-C-AH-CANCEL-DT            PIC XX.
  4256         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4257         16  PB-C-AH-CALC-REQ             PIC X.
  4258             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4259         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4260         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4261         16  PB-C-LAST-NAME               PIC X(15).
  4262         16  PB-C-REFUND-SW               PIC X.
  4263             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4264             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4265         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4266         16  PB-C-PAYEE-CODE              PIC X(6).
  4267         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4268         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4269         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4270         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4271         16  PB-C-REFERENCE               PIC X(12).
  4272         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4273         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4274         16  PB-C-POST-CARD-IND           PIC X.
  4275         16  PB-C-CANCEL-REASON           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  80
* EL050.cbl
  4276         16  PB-C-REF-INTERFACE-SW        PIC X.
  4277         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4278         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4279         16  FILLER                       PIC X(01).
  4280*        16  FILLER                       PIC X(18).
  4281         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4282*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4283         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4284         16  PB-CANCELED-CERT-DATA.
  4285             20  PB-CI-INSURED-NAME.
  4286                 24  PB-CI-LAST-NAME      PIC X(15).
  4287                 24  PB-CI-INITIALS       PIC XX.
  4288             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4289             20  PB-CI-INSURED-SEX        PIC X.
  4290             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4291             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4292             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4293             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4294             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4295             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4296             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4297             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4298             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4299             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4300             20  PB-CI-RATE-CLASS         PIC XX.
  4301             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4302             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4303             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4304             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4305             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4306             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4307             20  PB-CI-LF-ABBR            PIC X(3).
  4308             20  PB-CI-AH-ABBR            PIC X(3).
  4309             20  PB-CI-OB-FLAG            PIC X.
  4310                 88  PB-CI-OB                VALUE 'B'.
  4311             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4312                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4313                                           'M' '4' '5' '9' '2'.
  4314                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4315                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4316                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4317                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4318                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4319                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4320                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4321                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4322                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4323                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4324                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4325                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4326                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4327             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4328                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4329                                           'M' '4' '5' '9' '2'.
  4330                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4331                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4332                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4333                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  81
* EL050.cbl
  4334                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4335                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4336                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4337                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4338                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4339                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4340                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4341                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4342                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4343             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4344             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4345             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4346             20  PB-CI-MEMBER-NO          PIC X(12).
  4347             20  PB-CI-INT-CODE           PIC X.
  4348                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4349                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4350             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4351             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4352             20  PB-CI-COMP-EXCP-SW       PIC X.
  4353                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4354                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4355             20  PB-CI-ENTRY-STATUS       PIC X.
  4356             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4357             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4358             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4359             20  PB-CI-DEATH-DT           PIC XX.
  4360             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4361             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4362             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4363             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4364             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4365             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4366             20  PB-CI-ENTRY-DT              PIC XX.
  4367             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4368             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4369             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4370             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4371             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4372             20  PB-CI-OLD-LOF               PIC XXX.
  4373*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4374             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4375             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4376             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4377             20  PB-CI-INDV-GRP-CD           PIC X.
  4378             20  PB-CI-BENEFICIARY-NAME.
  4379                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4380                 24  FILLER                  PIC X(15).
  4381             20  PB-CI-NOTE-SW               PIC X.
  4382             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4383             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4384             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4385             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4386             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4387             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4388             20  PB-CI-FIRST-NAME            PIC X(10).
  4389             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4390
  4391         16  FILLER                       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  82
* EL050.cbl
  4392*032306  16  FILLER                       PIC X(27).
  4393*        16  FILLER                       PIC X(46).
  4394
  4395     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4396         16  FILLER                       PIC X(10).
  4397         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4398         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4399         16  PB-M-INSURED-MID-INIT        PIC X.
  4400         16  PB-M-INSURED-AGE             PIC 99.
  4401         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4402         16  PB-M-INSURED-SEX             PIC X.
  4403         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4404         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4405         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4406         16  PB-M-INSURED-CITY-STATE.
  4407             20  PB-M-INSURED-CITY        PIC X(28).
  4408             20  PB-M-INSURED-STATE       PIC XX.
  4409         16  PB-M-INSURED-ZIP-CODE.
  4410             20  PB-M-INSURED-ZIP-PRIME.
  4411                 24  PB-M-INSURED-ZIP-1   PIC X.
  4412                     88  PB-M-CANADIAN-POST-CODE
  4413                                             VALUE 'A' THRU 'Z'.
  4414                 24  FILLER               PIC X(4).
  4415             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4416         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4417                                        PB-M-INSURED-ZIP-CODE.
  4418             20  PM-M-INS-CAN-POST1       PIC XXX.
  4419             20  PM-M-INS-CAN-POST2       PIC XXX.
  4420             20  FILLER                   PIC XXX.
  4421         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4422         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4423         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4424         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4425         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4426         16  PB-M-CRED-BENE-CITYST.
  4427             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4428             20  PB-M-CRED-BENE-STATE     PIC XX.
  4429         16  FILLER                       PIC X(92).
  4430
  4431     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4432         16  FILLER                       PIC X(10).
  4433         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4434         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4435         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4436         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4437         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4438         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4439         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4440         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4441         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4442         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4443         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4444         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4445         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4446         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4447         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4448         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4449         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  83
* EL050.cbl
  4450         16  PB-ACCOUNT-NAME              PIC X(30).
  4451         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4452         16  PB-REFERENCE                 PIC X(12).
  4453         16  PB-B-RECEIVED-DT             PIC XX.
  4454         16  FILLER                       PIC X(234).
  4455
  4456     12  PB-RECORD-STATUS.
  4457         16  PB-CREDIT-SELECT-DT          PIC XX.
  4458         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4459         16  PB-BILLED-DT                 PIC XX.
  4460         16  PB-BILLING-STATUS            PIC X.
  4461             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4462             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4463             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4464         16  PB-RECORD-BILL               PIC X.
  4465             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4466             88  PB-RECORD-RETURNED           VALUE 'R'.
  4467             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4468             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4469             88  PB-OVERRIDE-AH               VALUE 'A'.
  4470             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4471         16  PB-BATCH-ENTRY               PIC X.
  4472             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4473             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4474             88  PB-REISSUED-CERT             VALUE 'E'.
  4475             88  PB-CASH-CERT                 VALUE 'C'.
  4476             88  PB-MONTHLY-CERT              VALUE 'M'.
  4477             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4478             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4479             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4480         16  PB-FORCE-CODE                PIC X.
  4481             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4482             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4483             88  PB-CANCEL-FORCE              VALUE '8'.
  4484             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4485             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4486             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4487             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4488             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4489             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4490             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4491         16  PB-FATAL-FLAG                PIC X.
  4492             88  PB-FATAL-ERRORS              VALUE 'X'.
  4493         16  PB-FORCE-ER-CD               PIC X.
  4494             88  PB-FORCE-ERRORS              VALUE 'F'.
  4495             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4496         16  PB-WARN-ER-CD                PIC X.
  4497             88  PB-WARNING-ERRORS            VALUE 'W'.
  4498         16  FILLER                       PIC X.
  4499         16  PB-OUT-BAL-CD                PIC X.
  4500             88  PB-OUT-OF-BAL                VALUE 'O'.
  4501         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4502         16  PB-AH-OVERRIDE-L1            PIC X.
  4503         16  PB-INPUT-DT                  PIC XX.
  4504         16  PB-INPUT-BY                  PIC X(4).
  4505         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4506         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4507         16  PB-TOLERANCE-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  84
* EL050.cbl
  4508         16  PB-LF-EARNING-METHOD         PIC X.
  4509         16  PB-AH-EARNING-METHOD         PIC X.
  4510         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4511         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4512         16  PB-REIN-CD                   PIC XXX.
  4513         16  PB-LF-REFUND-TYPE            PIC X.
  4514         16  PB-AH-REFUND-TYPE            PIC X.
  4515         16  PB-ACCT-EFF-DT               PIC XX.
  4516         16  PB-ACCT-EXP-DT               PIC XX.
  4517         16  PB-COMPANY-ID                PIC X(3).
  4518         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4519         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4520         16  PB-SV-CARRIER                PIC X.
  4521         16  PB-SV-GROUPING               PIC X(6).
  4522         16  PB-SV-STATE                  PIC XX.
  4523         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4524         16  PB-GA-BILLING-INFO.
  4525             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4526                                          PIC XX.
  4527         16  PB-SV-REMIT-TO  REDEFINES
  4528             PB-GA-BILLING-INFO           PIC X(10).
  4529         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4530         16  PB-I-LOAN-OFFICER            PIC X(5).
  4531         16  PB-I-VIN                     PIC X(17).
  4532
  4533         16  FILLER                       PIC X(04).
  4534         16  IMNET-BYPASS-SW              PIC X.
  4535
  4536******************************************************************
  4537*                COMMON EDIT ERRORS                              *
  4538******************************************************************
  4539
  4540     12  PB-COMMON-ERRORS.
  4541         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4542                                           PIC S9(4)     COMP.
  4543
  4544******************************************************************
  4545
  4546* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4547*    COPY ELC50W1.
  4548******************************************************************
  4549*                                                                *
  4550*                                                                *
  4551*                             ELC50W1                            *
  4552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4553*                            VMOD=2.004                          *
  4554*                                                                *
  4555*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4556*                                                                *
  4557*                                                                *
  4558******************************************************************
  4559
  4560     12  WK-WORK-AREA.
  4561         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4562         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4563         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4564         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4565         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  85
* EL050.cbl
  4566         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4567         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4568         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4569         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4570         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4571         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4572         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4573         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4574         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4575         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4576         16  WK-CREDIT-EDIT-CONTROLS.
  4577             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4578             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4579             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4580             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4581             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4582             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4583         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4584         16  WK-SAVE-REIN-DATA.
  4585             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4586             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4587             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4588         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4589             88  ENTRY-FROM-EL6311       VALUE '6'.
  4590         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4591         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4592     12  WK-RECORD-ADDRESSES.
  4593         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4594         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4595         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4596         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4597         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4598         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4599         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4600         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4601     12  WK-OVER-SHORT-AREA.
  4602         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4603         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4604         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4605             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4606         16  FILLER                   PIC X(5) VALUE SPACES.
  4607
  4608*    COPY ELCEDITC.
  4609******************************************************************
  4610*                                                                *
  4611*                                                                *
  4612*                            ELCEDITC                            *
  4613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4614*                            VMOD=2.012                          *
  4615*                                                                *
  4616*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4617*                     EL6313, EL050 AND EL517.                   *
  4618*                                                                *
  4619******************************************************************
  4620******************************************************************
  4621*                   C H A N G E   L O G
  4622*
  4623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  86
* EL050.cbl
  4624*-----------------------------------------------------------------
  4625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4626* EFFECTIVE    NUMBER
  4627*-----------------------------------------------------------------
  4628* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4629******************************************************************
  4630
  4631     12  EDIT-CRITERIA-DATA.
  4632         16  EC-CO-MONTH-END-DT       PIC XX.
  4633         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4634         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4635         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4636         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4637         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4638         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4639         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4640         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4641         16  EC-CO-REM-TERM-CALC      PIC X.
  4642               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4643               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4644               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4645               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4646
  4647         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4648               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4649               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4650               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4651               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4652               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4653               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4654               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4655               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4656               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4657               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4658
  4659         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4660               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4661               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4662               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4663               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4664               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4665               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4666               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4667               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4668
  4669         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4670                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4671                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4672
  4673         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4674                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4675                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4676                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4677                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4678                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4679                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4680                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4681                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  87
* EL050.cbl
  4682
  4683         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4684               88  EC-BR-REDUCING                   VALUE 'R'.
  4685               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4686
  4687         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4688         16  EC-BR-LF-DESC             PIC X(10).
  4689         16  EC-BR-AH-DESC             PIC X(10).
  4690         16  EC-BR-LF-COMMENT          PIC X(10).
  4691         16  EC-BR-AH-COMMENT          PIC X(10).
  4692
  4693         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4694               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4695               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4696               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4697               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4698
  4699         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4700               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4701               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4702               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4703               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4704
  4705         16  EC-BR-LF-REFUND-CALC      PIC X.
  4706                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4707                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4708                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4709                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4710                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4711                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4712                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4713
  4714         16  EC-BR-AH-REFUND-CALC      PIC X.
  4715                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4716                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4717                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4718                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4723
  4724         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4725                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4726                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4727                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4728
  4729         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4730                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4731                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4732                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4733
  4734         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4735         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4736         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4737         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4738
  4739         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  88
* EL050.cbl
  4740         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4741                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4742                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4743                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4744                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4745
  4746         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4747               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4748               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4749               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4750               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4751               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4752
  4753         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4754               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4755               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4756               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4757               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4758               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4759
  4760         16  EC-ST-LF-REFUND-CALC      PIC X.
  4761                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4762                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4763                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4764                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4765                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4766                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4767                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4768                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4769
  4770         16  EC-ST-AH-REFUND-CALC      PIC X.
  4771                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4772                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4773                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4774                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4775                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4776                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4777                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4778                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4779
  4780         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4781         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4782         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4783         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4784         16  EC-AM-EXPIRATION-DT       PIC XX.
  4785         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4786         16  EC-AM-CLASS-CD            PIC XX.
  4787         16  EC-AM-LF-DEVIATION        PIC XXX.
  4788         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4789         16  EC-AM-AH-DEVIATION        PIC XXX.
  4790         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4791         16  EC-AM-PHONE-NO            PIC X(10).
  4792
  4793         16  EC-AM-LF-REFUND-CALC      PIC X.
  4794                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4795                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4796                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4797                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  89
* EL050.cbl
  4798                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4799                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4800                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4801
  4802         16  EC-AM-AH-REFUND-CALC      PIC X.
  4803                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4804                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4805                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4806                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4807                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4808                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4809                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4810
  4811         16  EC-AM-BEN-I-G-CD          PIC X.
  4812                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4813                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4814                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4815
  4816         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4817         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4818         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4819         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4820         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4821         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4822         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4823         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4824         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4825
  4826         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4827         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4828         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4829         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4830         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4831         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4832         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4833         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4834         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4836         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4837         16  EC-RT-LF-NSP-ST           PIC XX.
  4838         16  EC-RT-AH-NSP-ST           PIC XX.
  4839         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4840         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4841
  4842         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4843             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4844                                             'M' '5' '9' '2'.
  4845             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4846             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4847             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4848             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4849             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4850             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4851             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4852             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4853             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4854             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4855
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  90
* EL050.cbl
  4856         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4857             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4858                                             'M' '5' '9' '2'.
  4859             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4860             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4861             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4862             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4863             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4864             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4865             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4866             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4867             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4868             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4869
  4870         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4871         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4872         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4873         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4874         16  EC-CM-DEATH-DT            PIC XX.
  4875
  4876*DMD CUSTOM CODING FIELDS BELOW
  4877*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4878         16  EC-BR-DMD-RATING-SW       PIC X.
  4879                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4880                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4881                 88  NO-DMD-RATING               VALUE 'N'.
  4882
  4883         16  EC-NEW-CERT               PIC X(11).
  4884         16  EC-NEW-STATE              PIC XX.
  4885         16  FILLER                    PIC X.
  4886*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4887         16  OVER-SHORT-EDIT-FIELDS.
  4888             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4889             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4890             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4891             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4892             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4893             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4894             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4895             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4896             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4897         16  FILLER                    PIC X(71).
  4898******************************************************************
  4899
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  91
* EL050.cbl
  4901*    COPY ELCDIFRD.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ELCDIFRD.                           *
  4906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4907*                            VMOD=2.004                          *
  4908*                                                                *
  4909*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4910*                                                                *
  4911******************************************************************
  4912*
  4913  01  WS-DIFFERENCE-CALCULATION.
  4914        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4915        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4916        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4917        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4918        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4919        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4920        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4921        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4922        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4923        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4924        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4925
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  92
* EL050.cbl
  4927****************************************************************
  4928*
  4929* Copyright (c) 2007 by Clerity Solutions, Inc.
  4930* All rights reserved.
  4931*
  4932****************************************************************
  4933 01  DFHEIV.
  4934   02  DFHEIV0               PIC X(35).
  4935   02  DFHEIV1               PIC X(08).
  4936   02  DFHEIV2               PIC X(08).
  4937   02  DFHEIV3               PIC X(08).
  4938   02  DFHEIV4               PIC X(06).
  4939   02  DFHEIV5               PIC X(04).
  4940   02  DFHEIV6               PIC X(04).
  4941   02  DFHEIV7               PIC X(02).
  4942   02  DFHEIV8               PIC X(02).
  4943   02  DFHEIV9               PIC X(01).
  4944   02  DFHEIV10              PIC S9(7) COMP-3.
  4945   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4946   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4947   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4948   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4949   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4950   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4951   02  DFHEIV17              PIC X(04).
  4952   02  DFHEIV18              PIC X(04).
  4953   02  DFHEIV19              PIC X(04).
  4954   02  DFHEIV20              USAGE IS POINTER.
  4955   02  DFHEIV21              USAGE IS POINTER.
  4956   02  DFHEIV22              USAGE IS POINTER.
  4957   02  DFHEIV23              USAGE IS POINTER.
  4958   02  DFHEIV24              USAGE IS POINTER.
  4959   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4960   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4961   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4962   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4963   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4964   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4965   02  FILLER                PIC X(02).
  4966   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4967   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4968   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4969   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4970   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4971 LINKAGE  SECTION.
  4972*****************************************************************
  4973*                                                               *
  4974* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4975* All rights reserved.                                          *
  4976*                                                               *
  4977*****************************************************************
  4978 01  dfheiblk.
  4979     02  eibtime          pic s9(7) comp-3.
  4980     02  eibdate          pic s9(7) comp-3.
  4981     02  eibtrnid         pic x(4).
  4982     02  eibtaskn         pic s9(7) comp-3.
  4983     02  eibtrmid         pic x(4).
  4984     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  93
* EL050.cbl
  4985     02  eibcposn         pic s9(4) comp.
  4986     02  eibcalen         pic s9(4) comp.
  4987     02  eibaid           pic x(1).
  4988     02  eibfiller1       pic x(1).
  4989     02  eibfn            pic x(2).
  4990     02  eibfiller2       pic x(2).
  4991     02  eibrcode         pic x(6).
  4992     02  eibfiller3       pic x(2).
  4993     02  eibds            pic x(8).
  4994     02  eibreqid         pic x(8).
  4995     02  eibrsrce         pic x(8).
  4996     02  eibsync          pic x(1).
  4997     02  eibfree          pic x(1).
  4998     02  eibrecv          pic x(1).
  4999     02  eibsend          pic x(1).
  5000     02  eibatt           pic x(1).
  5001     02  eibeoc           pic x(1).
  5002     02  eibfmh           pic x(1).
  5003     02  eibcompl         pic x(1).
  5004     02  eibsig           pic x(1).
  5005     02  eibconf          pic x(1).
  5006     02  eiberr           pic x(1).
  5007     02  eibrldbk         pic x(1).
  5008     02  eiberrcd         pic x(4).
  5009     02  eibsynrb         pic x(1).
  5010     02  eibnodat         pic x(1).
  5011     02  eibfiller5       pic x(2).
  5012     02  eibresp          pic 9(09) comp.
  5013     02  eibresp2         pic 9(09) comp.
  5014     02  dfheigdj         pic s9(4) comp.
  5015     02  dfheigdk         pic s9(4) comp.
  5016
  5017 01  DFHCOMMAREA                   PIC X(1036).
  5018
  5019*01 PARMLIST .
  5020*    02  FILLER                    PIC S9(8)   COMP.
  5021*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5022*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5023*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5024*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5025*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5026*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5027*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5028
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  94
* EL050.cbl
  5030*    COPY ELCCNTL.
  5031******************************************************************
  5032*                                                                *
  5033*                                                                *
  5034*                            ELCCNTL.                            *
  5035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5036*                            VMOD=2.059                          *
  5037*                                                                *
  5038*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5039*                                                                *
  5040*   FILE TYPE = VSAM,KSDS                                        *
  5041*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5042*                                                                *
  5043*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5044*       ALTERNATE INDEX = NONE                                   *
  5045*                                                                *
  5046*   LOG = YES                                                    *
  5047*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5048******************************************************************
  5049*                   C H A N G E   L O G
  5050*
  5051* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5052*-----------------------------------------------------------------
  5053*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5054* EFFECTIVE    NUMBER
  5055*-----------------------------------------------------------------
  5056* 082503                   PEMA  ADD BENEFIT GROUP
  5057* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5058* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5059* 092705    2005050300006  PEMA  ADD SPP LEASES
  5060* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5061* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5062* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5063* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5064* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5065* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5066* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5067* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5068* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5069* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5070******************************************************************
  5071*
  5072 01  CONTROL-FILE.
  5073     12  CF-RECORD-ID                       PIC XX.
  5074         88  VALID-CF-ID                        VALUE 'CF'.
  5075
  5076     12  CF-CONTROL-PRIMARY.
  5077         16  CF-COMPANY-ID                  PIC XXX.
  5078         16  CF-RECORD-TYPE                 PIC X.
  5079             88  CF-COMPANY-MASTER              VALUE '1'.
  5080             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5081             88  CF-STATE-MASTER                VALUE '3'.
  5082             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5083             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5084             88  CF-CARRIER-MASTER              VALUE '6'.
  5085             88  CF-MORTALITY-MASTER            VALUE '7'.
  5086             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5087             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  95
* EL050.cbl
  5088             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5089             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5090             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5091             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5092             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5093             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5094             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5095             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5096             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5097         16  CF-ACCESS-CD-GENL              PIC X(4).
  5098         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5099             20  CF-PROCESSOR               PIC X(4).
  5100         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5101             20  CF-STATE-CODE              PIC XX.
  5102             20  FILLER                     PIC XX.
  5103         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5104             20  FILLER                     PIC XX.
  5105             20  CF-HI-BEN-IN-REC           PIC XX.
  5106         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5107             20  FILLER                     PIC XXX.
  5108             20  CF-CARRIER-CNTL            PIC X.
  5109         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5110             20  FILLER                     PIC XX.
  5111             20  CF-HI-TYPE-IN-REC          PIC 99.
  5112         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5113             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5114                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5115             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5116             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5117         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5118             20  FILLER                     PIC X.
  5119             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5120         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5121             20  FILLER                     PIC XX.
  5122             20  CF-MORTGAGE-PLAN           PIC XX.
  5123         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5124
  5125     12  CF-LAST-MAINT-DT                   PIC XX.
  5126     12  CF-LAST-MAINT-BY                   PIC X(4).
  5127     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5128
  5129     12  CF-RECORD-BODY                     PIC X(728).
  5130
  5131
  5132****************************************************************
  5133*             COMPANY MASTER RECORD                            *
  5134****************************************************************
  5135
  5136     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5137         16  CF-COMPANY-ADDRESS.
  5138             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5139             20  CF-CL-IN-CARE-OF           PIC X(30).
  5140             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5141             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5142             20  CF-CL-CITY-STATE           PIC X(30).
  5143             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5144             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5145         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  96
* EL050.cbl
  5146         16  CF-COMPANY-PASSWORD            PIC X(8).
  5147         16  CF-SECURITY-OPTION             PIC X.
  5148             88  ALL-SECURITY                   VALUE '1'.
  5149             88  COMPANY-VERIFY                 VALUE '2'.
  5150             88  PROCESSOR-VERIFY               VALUE '3'.
  5151             88  NO-SECURITY                    VALUE '4'.
  5152             88  ALL-BUT-TERM                   VALUE '5'.
  5153         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5154             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5155         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5156             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5157         16  CF-INFORCE-LOCATION            PIC X.
  5158             88  CERTS-ARE-ONLINE               VALUE '1'.
  5159             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5160             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5161         16  CF-LOWER-CASE-LETTERS          PIC X.
  5162         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5163             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5164             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5165             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5166             88  CF-ACCNT-CNTL                  VALUE '3'.
  5167             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5168
  5169         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5170         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5171
  5172         16  CF-LGX-CREDIT-USER             PIC X.
  5173             88  CO-IS-NOT-USER                 VALUE 'N'.
  5174             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5175
  5176         16 CF-CREDIT-CALC-CODES.
  5177             20  CF-CR-REM-TERM-CALC PIC X.
  5178               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5179               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5180               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5181               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5182               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5183               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5184               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5185             20  CF-CR-R78-METHOD           PIC X.
  5186               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5187               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5188
  5189         16  CF-CLAIM-CONTROL-COUNTS.
  5190             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5191                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5192
  5193             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5194                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5195
  5196             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5197                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5198
  5199             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5200                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5201
  5202         16  CF-CURRENT-MONTH-END           PIC XX.
  5203
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  97
* EL050.cbl
  5204         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5205             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5206             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5207             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5208             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5209                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5210                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5211             20  CF-CO-PREM-REJECT-SW       PIC X.
  5212                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5213                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5214             20  CF-CO-REF-REJECT-SW        PIC X.
  5215                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5216                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5217
  5218         16  CF-CO-REPORTING-DT             PIC XX.
  5219         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5220         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5221           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5222           88  CF-CO-MONTH-END                  VALUE '1'.
  5223
  5224         16  CF-LGX-CLAIM-USER              PIC X.
  5225             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5226             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5227
  5228         16  CF-CREDIT-EDIT-CONTROLS.
  5229             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5230             20  CF-MIN-AGE                 PIC 99.
  5231             20  CF-DEFAULT-AGE             PIC 99.
  5232             20  CF-MIN-TERM                PIC S999      COMP-3.
  5233             20  CF-MAX-TERM                PIC S999      COMP-3.
  5234             20  CF-DEFAULT-SEX             PIC X.
  5235             20  CF-JOINT-AGE-INPUT         PIC X.
  5236                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5237             20  CF-BIRTH-DATE-INPUT        PIC X.
  5238                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5239             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5240                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5241                 88  CF-ZERO-CARRIER            VALUE '1'.
  5242                 88  CF-ZERO-GROUPING           VALUE '2'.
  5243                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5244             20  CF-EDIT-SW                 PIC X.
  5245                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5246             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5247             20  CF-CR-PR-METHOD            PIC X.
  5248               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5249               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5250             20  FILLER                     PIC X.
  5251
  5252         16  CF-CREDIT-MISC-CONTROLS.
  5253             20  CF-REIN-TABLE-SW           PIC X.
  5254                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5255             20  CF-COMP-TABLE-SW           PIC X.
  5256                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5257             20  CF-EXPERIENCE-RETENTION-AGE
  5258                                            PIC S9        COMP-3.
  5259             20  CF-CONVERSION-DT           PIC XX.
  5260             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5261             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  98
* EL050.cbl
  5262                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5263                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5264
  5265             20  CF-CR-CHECK-NO-CONTROL.
  5266                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5267                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5268                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5269                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5270                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5271                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5272
  5273                 24  CF-CR-CHECK-COUNT       REDEFINES
  5274                     CF-CR-CHECK-COUNTER      PIC X(4).
  5275
  5276                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5277                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5278
  5279                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5280                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5281                 24  CF-MAIL-PROCESSING       PIC X.
  5282                     88  MAIL-PROCESSING          VALUE 'Y'.
  5283
  5284         16  CF-MISC-SYSTEM-CONTROL.
  5285             20  CF-SYSTEM-C                 PIC X.
  5286                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5287             20  CF-SYSTEM-D                 PIC X.
  5288                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5289             20  CF-SOC-SEC-NO-SW            PIC X.
  5290                 88  SOC-SEC-NO-USED             VALUE '1'.
  5291             20  CF-MEMBER-NO-SW             PIC X.
  5292                 88  MEMBER-NO-USED              VALUE '1'.
  5293             20  CF-TAX-ID-NUMBER            PIC X(11).
  5294             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5295             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5296                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5297                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5298                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5299                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5300             20  CF-SYSTEM-E                 PIC X.
  5301                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5302
  5303         16  CF-LGX-LIFE-USER               PIC X.
  5304             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5305             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5306
  5307         16  CF-CR-MONTH-END-DT             PIC XX.
  5308
  5309         16  CF-FILE-MAINT-DATES.
  5310             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5311                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5312             20  CF-LAST-BATCH       REDEFINES
  5313                 CF-LAST-BATCH-NO               PIC X(4).
  5314             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5315             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5316             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5317             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5318             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5319             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page  99
* EL050.cbl
  5320             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5321             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5322             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5323             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5324
  5325         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5326         16  FILLER                         PIC X.
  5327
  5328         16  CF-ALT-MORT-CODE               PIC X(4).
  5329         16  CF-MEMBER-CAPTION              PIC X(10).
  5330
  5331         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5332             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5333             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5334             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5335             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5336             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5337
  5338         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5339
  5340         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5341         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5342         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5343         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5344
  5345         16  CF-AH-OVERRIDE-L1              PIC X.
  5346         16  CF-AH-OVERRIDE-L2              PIC XX.
  5347         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5348         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5349
  5350         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5351         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5352
  5353         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5354         16  CF-AR-LAST-EL860-DT            PIC XX.
  5355         16  CF-MP-MONTH-END-DT             PIC XX.
  5356
  5357         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5358         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5359             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5360
  5361         16  CF-AR-MONTH-END-DT             PIC XX.
  5362
  5363         16  CF-CRDTCRD-USER                PIC X.
  5364             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5365             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5366
  5367         16  CF-CC-MONTH-END-DT             PIC XX.
  5368
  5369         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5370
  5371         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5372             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5373             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5374             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5375         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5376         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5377         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 100
* EL050.cbl
  5378         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5379             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5380             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5381         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5382         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5383         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5384             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5385         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5386
  5387         16  CF-CL-ZIP-CODE.
  5388             20  CF-CL-ZIP-PRIME.
  5389                 24  CF-CL-ZIP-1ST          PIC X.
  5390                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5391                 24  FILLER                 PIC X(4).
  5392             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5393         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5394             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5395             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5396             20  FILLER                     PIC XXX.
  5397
  5398         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5399         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5400         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5401         16  CF-CO-OPTION-START-DATE        PIC XX.
  5402         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5403           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5404                                                      '3' '4'.
  5405           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5406           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5407           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5408           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5409           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5410           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5411
  5412         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5413
  5414         16  CF-PAYMENT-APPROVAL-LEVELS.
  5415             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5416             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5417             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5418             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5419             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5420             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5421
  5422         16  CF-END-USER-REPORTING-USER     PIC X.
  5423             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5424             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5425
  5426         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5427             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5428             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5429
  5430         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5431
  5432         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5433         16  FILLER                         PIC X.
  5434
  5435         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 101
* EL050.cbl
  5436             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5437             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5438             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5439
  5440         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5441
  5442         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5443             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5444             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5445
  5446         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5447             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5448             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5449
  5450         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5451
  5452         16  CF-CO-ACH-ID-CODE              PIC  X.
  5453             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5454             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5455             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5456         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5457         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5458         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5459         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5460         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5461         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5462         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5463         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5464         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5465                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5466         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5467                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5468
  5469         16  CF-CO-OVER-SHORT.
  5470             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5471             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5472
  5473*         16  FILLER                         PIC X(102).
  5474         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5475             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5476             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5477
  5478         16  CF-AH-APPROVAL-DAYS.
  5479             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5480             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5481             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5482             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5483
  5484         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5485
  5486         16  CF-APPROV-LEV-5.
  5487             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5488             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5489             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5490
  5491         16  FILLER                         PIC X(68).
  5492****************************************************************
  5493*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 102
* EL050.cbl
  5494****************************************************************
  5495
  5496     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5497         16  CF-PROCESSOR-NAME              PIC X(30).
  5498         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5499         16  CF-PROCESSOR-TITLE             PIC X(26).
  5500         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5501                 88  MESSAGE-YES                VALUE 'Y'.
  5502                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5503
  5504*****************************************************
  5505****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5506****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5507****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5508****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5509*****************************************************
  5510
  5511         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5512             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5513             20  CF-APPLICATION-FORCE       PIC X.
  5514             20  CF-INDIVIDUAL-APP.
  5515                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5516                     28  CF-BROWSE-APP      PIC X.
  5517                     28  CF-UPDATE-APP      PIC X.
  5518
  5519         16  CF-CURRENT-TERM-ON             PIC X(4).
  5520         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5521             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5522             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5523             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5524             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5525             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5526             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5527             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5528         16  CF-PROCESSOR-CARRIER           PIC X.
  5529             88  NO-CARRIER-SECURITY            VALUE ' '.
  5530         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5531             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5532         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5533             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5534         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5535             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5536
  5537         16  CF-PROC-SYS-ACCESS-SW.
  5538             20  CF-PROC-CREDIT-CLAIMS-SW.
  5539                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5540                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5541                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5542                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5543             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5544                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5545                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5546             20  CF-PROC-LIFE-GNRLDGR-SW.
  5547                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5548                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5549                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5550                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5551             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 103
* EL050.cbl
  5552                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5553                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5554         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5555             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5556             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5557         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5558
  5559         16  CF-APPROVAL-LEVEL                  PIC X.
  5560             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5561             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5562             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5563             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5564             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5565
  5566         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5567
  5568         16  CF-LANGUAGE-TYPE                   PIC X.
  5569             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5570             88  CF-LANG-IS-FR                      VALUE 'F'.
  5571
  5572         16  CF-CSR-IND                         PIC X.
  5573         16  FILLER                             PIC X(239).
  5574
  5575****************************************************************
  5576*             PROCESSOR/REMINDERS RECORD                       *
  5577****************************************************************
  5578
  5579     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5580         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5581             20  CF-START-REMIND-DT         PIC XX.
  5582             20  CF-END-REMIND-DT           PIC XX.
  5583             20  CF-REMINDER-TEXT           PIC X(50).
  5584         16  FILLER                         PIC X(296).
  5585
  5586
  5587****************************************************************
  5588*             STATE MASTER RECORD                              *
  5589****************************************************************
  5590
  5591     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5592         16  CF-STATE-ABBREVIATION          PIC XX.
  5593         16  CF-STATE-NAME                  PIC X(25).
  5594         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5595         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5596             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5597             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5598             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5599             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5600                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5601                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5602             20  CF-ST-PREM-REJECT-SW       PIC X.
  5603                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5604                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5605             20  CF-ST-REF-REJECT-SW        PIC X.
  5606                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5607                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5608         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5609         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 104
* EL050.cbl
  5610         16  CF-ST-REFUND-RULES.
  5611             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5612             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5613             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5614         16  CF-ST-FST-PMT-EXTENSION.
  5615             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5616             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5617                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5618                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5619                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5620                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5621         16  CF-ST-STATE-CALL.
  5622             20  CF-ST-CALL-UNEARNED        PIC X.
  5623             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5624             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5625         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5626             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5627             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5628         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5629         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5630         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5631         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5632         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5633         16  FILLER                         PIC X.
  5634         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5635             20  CF-ST-BENEFIT-CD           PIC XX.
  5636             20  CF-ST-BENEFIT-KIND         PIC X.
  5637                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5638                 88  CF-ST-AH-KIND              VALUE 'A'.
  5639             20  CF-ST-REM-TERM-CALC        PIC X.
  5640                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5641                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5642                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5643                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5644                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5645                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5646                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5647                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5648
  5649             20  CF-ST-REFUND-CALC          PIC X.
  5650                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5651                 88  ST-REFD-BY-R78             VALUE '1'.
  5652                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5653                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5654                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5655                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5656                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5657                 88  ST-REFD-UTAH               VALUE '7'.
  5658                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5659                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5660                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5661
  5662             20  CF-ST-EARNING-CALC         PIC X.
  5663                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5664                 88  ST-EARN-BY-R78             VALUE '1'.
  5665                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5666                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5667                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 105
* EL050.cbl
  5668                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5669                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5670                 88  ST-EARN-MEAN               VALUE '8'.
  5671                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5672
  5673             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5674                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5675                 88  ST-OVRD-BY-R78             VALUE '1'.
  5676                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5677                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5678                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5679                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5680                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5681                 88  ST-OVRD-MEAN               VALUE '8'.
  5682                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5683             20  cf-st-extra-periods        pic 9.
  5684*            20  FILLER                     PIC X.
  5685
  5686         16  CF-ST-COMMISSION-CAPS.
  5687             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5688             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5689             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5690             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5691         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5692                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5693
  5694         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5695
  5696         16  CF-ST-STATUTORY-INTEREST.
  5697             20  CF-ST-STAT-DATE-FROM       PIC X.
  5698                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5699                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5700             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5701             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5702             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5703             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5704             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5705
  5706         16  CF-ST-OVER-SHORT.
  5707             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5708             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5709
  5710         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5711
  5712         16  CF-ST-RT-CALC                  PIC X.
  5713
  5714         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5715         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5716         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5717         16  CF-ST-RF-LR-CALC               PIC X.
  5718         16  CF-ST-RF-LL-CALC               PIC X.
  5719         16  CF-ST-RF-LN-CALC               PIC X.
  5720         16  CF-ST-RF-AH-CALC               PIC X.
  5721         16  CF-ST-RF-CP-CALC               PIC X.
  5722*        16  FILLER                         PIC X(206).
  5723*CIDMOD         16  FILLER                         PIC X(192).
  5724         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5725             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 106
* EL050.cbl
  5726         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5727         16  CF-ST-VFY-2ND-BENE             PIC X.
  5728         16  CF-ST-CAUSAL-STATE             PIC X.
  5729         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5730         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5731         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5732             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5733         16  CF-ST-NET-ONLY-STATE           PIC X.
  5734             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5735         16  FILLER                         PIC X(181).
  5736
  5737****************************************************************
  5738*             BENEFIT MASTER RECORD                            *
  5739****************************************************************
  5740
  5741     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5742         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5743             20  CF-BENEFIT-CODE            PIC XX.
  5744             20  CF-BENEFIT-NUMERIC  REDEFINES
  5745                 CF-BENEFIT-CODE            PIC XX.
  5746             20  CF-BENEFIT-ALPHA           PIC XXX.
  5747             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5748             20  CF-BENEFIT-COMMENT         PIC X(10).
  5749
  5750             20  CF-LF-COVERAGE-TYPE        PIC X.
  5751                 88  CF-REDUCING                VALUE 'R'.
  5752                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5753
  5754             20  CF-SPECIAL-CALC-CD         PIC X.
  5755                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5756                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5757                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5758                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5759                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5760                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5761                 88  CF-FARM-PLAN               VALUE 'F'.
  5762                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5763                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5764                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5765                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5766                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5767                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5768                 88  CF-PRUDENTIAL              VALUE 'P'.
  5769                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5770                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5771                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5772                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5773                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5774                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5775
  5776             20  CF-JOINT-INDICATOR         PIC X.
  5777                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5778
  5779*            20  FILLER                     PIC X(12).
  5780             20  cf-maximum-benefits        pic s999 comp-3.
  5781             20  FILLER                     PIC X(09).
  5782             20  CF-BENEFIT-CATEGORY        PIC X.
  5783             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 107
* EL050.cbl
  5784
  5785             20  CF-CO-REM-TERM-CALC        PIC X.
  5786                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5787                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5788                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5789                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5790                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5791
  5792             20  CF-CO-EARNINGS-CALC        PIC X.
  5793                 88  CO-EARN-BY-R78             VALUE '1'.
  5794                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5795                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5796                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5797                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5798                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5799                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5800                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5801
  5802             20  CF-CO-REFUND-CALC          PIC X.
  5803                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5804                 88  CO-REFD-BY-R78             VALUE '1'.
  5805                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5806                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5807                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5808                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5809                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5810                 88  CO-REFD-MEAN               VALUE '8'.
  5811                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5812                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5813                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5814
  5815             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5816                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5817                 88  CO-OVRD-BY-R78             VALUE '1'.
  5818                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5819                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5820                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5821                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5822                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5823                 88  CO-OVRD-MEAN               VALUE '8'.
  5824                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5825
  5826             20  CF-CO-BEN-I-G-CD           PIC X.
  5827                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5828                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5829                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5830
  5831         16  FILLER                         PIC X(304).
  5832
  5833
  5834****************************************************************
  5835*             CARRIER MASTER RECORD                            *
  5836****************************************************************
  5837
  5838     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5839         16  CF-ADDRESS-DATA.
  5840             20  CF-MAIL-TO-NAME            PIC X(30).
  5841             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 108
* EL050.cbl
  5842             20  CF-ADDRESS-LINE-1          PIC X(30).
  5843             20  CF-ADDRESS-LINE-2          PIC X(30).
  5844             20  CF-CITY-STATE              PIC X(30).
  5845             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5846             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5847
  5848         16  CF-CLAIM-NO-CONTROL.
  5849             20  CF-CLAIM-NO-METHOD         PIC X.
  5850                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5851                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5852                 88  CLAIM-NO-SEQ               VALUE '3'.
  5853                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5854             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5855                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5856                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5857                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5858
  5859         16  CF-CHECK-NO-CONTROL.
  5860             20  CF-CHECK-NO-METHOD         PIC X.
  5861                 88  CHECK-NO-MANUAL            VALUE '1'.
  5862                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5863                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5864                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5865             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5866                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5867
  5868         16  CF-DOMICILE-STATE              PIC XX.
  5869
  5870         16  CF-EXPENSE-CONTROLS.
  5871             20  CF-EXPENSE-METHOD          PIC X.
  5872                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5873                 88  DOLLARS-PER-PMT            VALUE '2'.
  5874                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5875                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5876             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5877             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5878
  5879         16  CF-CORRESPONDENCE-CONTROL.
  5880             20  CF-LETTER-RESEND-OPT       PIC X.
  5881                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5882                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5883             20  FILLER                     PIC X(4).
  5884
  5885         16  CF-RESERVE-CONTROLS.
  5886             20  CF-MANUAL-SW               PIC X.
  5887                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5888             20  CF-FUTURE-SW               PIC X.
  5889                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5890             20  CF-PTC-SW                  PIC X.
  5891                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5892             20  CF-IBNR-SW                 PIC X.
  5893                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5894             20  CF-PTC-LF-SW               PIC X.
  5895                 88  CF-LF-PTC-USED             VALUE '1'.
  5896             20  CF-CDT-ACCESS-METHOD       PIC X.
  5897                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5898                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5899                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 109
* EL050.cbl
  5900             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5901
  5902         16  CF-CLAIM-CALC-METHOD           PIC X.
  5903             88  360-PLUS-MONTHS                VALUE '1'.
  5904             88  365-PLUS-MONTHS                VALUE '2'.
  5905             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5906             88  360-DAILY                      VALUE '4'.
  5907             88  365-DAILY                      VALUE '5'.
  5908
  5909         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5910         16  FILLER                         PIC X(11).
  5911
  5912         16  CF-LIMIT-AMOUNTS.
  5913             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5914             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5915             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5916             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5917             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5918             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5919             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5920             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5921             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5922             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5923
  5924         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5925         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5926         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5927
  5928         16  CF-ZIP-CODE.
  5929             20  CF-ZIP-PRIME.
  5930                 24  CF-ZIP-1ST             PIC X.
  5931                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5932                 24  FILLER                 PIC X(4).
  5933             20  CF-ZIP-PLUS4               PIC X(4).
  5934         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5935             20  CF-CAN-POSTAL-1            PIC XXX.
  5936             20  CF-CAN-POSTAL-2            PIC XXX.
  5937             20  FILLER                     PIC XXX.
  5938
  5939         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5940         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5941         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5942
  5943         16  CF-RATING-SWITCH               PIC X.
  5944             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5945             88  CF-NO-RATING                   VALUE 'N'.
  5946
  5947         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5948
  5949         16  CF-CARRIER-OVER-SHORT.
  5950             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5951             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5952
  5953         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5954         16  CF-SECPAY-SWITCH               PIC X.
  5955             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5956             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5957         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 110
* EL050.cbl
  5958         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5959         16  FILLER                         PIC X(444).
  5960*        16  FILLER                         PIC X(452).
  5961
  5962
  5963****************************************************************
  5964*             MORTALITY MASTER RECORD                          *
  5965****************************************************************
  5966
  5967     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5968         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5969                                INDEXED BY CF-MORT-NDX.
  5970             20  CF-MORT-TABLE              PIC X(5).
  5971             20  CF-MORT-TABLE-TYPE         PIC X.
  5972                 88  CF-MORT-JOINT              VALUE 'J'.
  5973                 88  CF-MORT-SINGLE             VALUE 'S'.
  5974                 88  CF-MORT-COMBINED           VALUE 'C'.
  5975                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5976                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5977             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5978             20  CF-MORT-AGE-METHOD         PIC XX.
  5979                 88  CF-AGE-LAST                VALUE 'AL'.
  5980                 88  CF-AGE-NEAR                VALUE 'AN'.
  5981             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5982             20  CF-MORT-ADJUSTMENT-DIRECTION
  5983                                            PIC X.
  5984                 88  CF-MINUS                   VALUE '-'.
  5985                 88  CF-PLUS                    VALUE '+'.
  5986             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5987             20  CF-MORT-JOINT-CODE         PIC X.
  5988                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5989             20  CF-MORT-PC-Q               PIC X.
  5990                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5991             20  CF-MORT-TABLE-CODE         PIC X(4).
  5992             20  CF-MORT-COMMENTS           PIC X(15).
  5993             20  FILLER                     PIC X(14).
  5994
  5995         16  FILLER                         PIC X(251).
  5996
  5997
  5998****************************************************************
  5999*             BUSSINESS TYPE MASTER RECORD                     *
  6000****************************************************************
  6001
  6002     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6003* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6004* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6005* AND RECORD 05 IS TYPES 81-99
  6006         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6007             20  CF-BUSINESS-TITLE          PIC  X(19).
  6008             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6009                                            PIC S9V9(4) COMP-3.
  6010             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6011             20  FILLER                     PIC  X.
  6012         16  FILLER                         PIC  X(248).
  6013
  6014
  6015****************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 111
* EL050.cbl
  6016*             TERMINAL MASTER RECORD                           *
  6017****************************************************************
  6018
  6019     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6020
  6021         16  CF-COMPANY-TERMINALS.
  6022             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6023                                  PIC X(4).
  6024         16  FILLER               PIC X(248).
  6025
  6026
  6027****************************************************************
  6028*             LIFE EDIT MASTER RECORD                          *
  6029****************************************************************
  6030
  6031     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6032         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6033             20  CF-LIFE-CODE-IN            PIC XX.
  6034             20  CF-LIFE-CODE-OUT           PIC XX.
  6035         16  FILLER                         PIC X(248).
  6036
  6037
  6038****************************************************************
  6039*             AH EDIT MASTER RECORD                            *
  6040****************************************************************
  6041
  6042     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6043         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6044             20  CF-AH-CODE-IN              PIC XXX.
  6045             20  CF-AH-CODE-OUT             PIC XX.
  6046         16  FILLER                         PIC X(248).
  6047
  6048
  6049****************************************************************
  6050*             CREDIBILITY TABLES                               *
  6051****************************************************************
  6052
  6053     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6054         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6055                             INDEXED BY CF-CRDB-NDX.
  6056             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6057             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6058             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6059         16  FILLER                         PIC  X(332).
  6060
  6061
  6062****************************************************************
  6063*             REPORT CUSTOMIZATION RECORD                      *
  6064****************************************************************
  6065
  6066     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6067         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6068             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6069             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6070             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6071**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6072****       A T-TRANSFER.                                   ****
  6073             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 112
* EL050.cbl
  6074
  6075         16  FILLER                         PIC XX.
  6076
  6077         16  CF-CARRIER-CNTL-OPT.
  6078             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6079                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6080                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6081             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6082                                            PIC X.
  6083         16  CF-GROUP-CNTL-OPT.
  6084             20  CF-GROUP-OPT-SEQ           PIC 9.
  6085                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6086                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6087             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6088                                            PIC X(6).
  6089         16  CF-STATE-CNTL-OPT.
  6090             20  CF-STATE-OPT-SEQ           PIC 9.
  6091                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6092                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6093             20  CF-STATE-SELECT OCCURS 3 TIMES
  6094                                            PIC XX.
  6095         16  CF-ACCOUNT-CNTL-OPT.
  6096             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6097                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6098                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6099             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6100                                            PIC X(10).
  6101         16  CF-BUS-TYP-CNTL-OPT.
  6102             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6103                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6104                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6105             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6106                                            PIC XX.
  6107         16  CF-LF-TYP-CNTL-OPT.
  6108             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6109                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6110                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6111             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6112                                            PIC XX.
  6113         16  CF-AH-TYP-CNTL-OPT.
  6114             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6115                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6116                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6117             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6118                                            PIC XX.
  6119         16  CF-REPTCD1-CNTL-OPT.
  6120             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6121                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6123             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-REPTCD2-CNTL-OPT.
  6126             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6127                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6128                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6129             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6130                                            PIC X(10).
  6131         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 113
* EL050.cbl
  6132             20  CF-USER1-OPT-SEQ           PIC 9.
  6133                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6134                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6135             20  CF-USER1-SELECT OCCURS 3 TIMES
  6136                                            PIC X(10).
  6137         16  CF-USER2-CNTL-OPT.
  6138             20  CF-USER2-OPT-SEQ           PIC 9.
  6139                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6140                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6141             20  CF-USER2-SELECT OCCURS 3 TIMES
  6142                                            PIC X(10).
  6143         16  CF-USER3-CNTL-OPT.
  6144             20  CF-USER3-OPT-SEQ           PIC 9.
  6145                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6146                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6147             20  CF-USER3-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-USER4-CNTL-OPT.
  6150             20  CF-USER4-OPT-SEQ           PIC 9.
  6151                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6152                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6153             20  CF-USER4-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-USER5-CNTL-OPT.
  6156             20  CF-USER5-OPT-SEQ           PIC 9.
  6157                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6159             20  CF-USER5-SELECT OCCURS 3 TIMES
  6160                                            PIC X(10).
  6161         16  CF-REINS-CNTL-OPT.
  6162             20  CF-REINS-OPT-SEQ           PIC 9.
  6163                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6164                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6165             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6166                 24  CF-REINS-PRIME         PIC XXX.
  6167                 24  CF-REINS-SUB           PIC XXX.
  6168
  6169         16  CF-AGENT-CNTL-OPT.
  6170             20  CF-AGENT-OPT-SEQ           PIC 9.
  6171                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6172                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6173             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6174                                            PIC X(10).
  6175
  6176         16  FILLER                         PIC X(43).
  6177
  6178         16  CF-LOSS-RATIO-SELECT.
  6179             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6180             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6181         16  CF-ENTRY-DATE-SELECT.
  6182             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6183             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6184         16  CF-EFFECTIVE-DATE-SELECT.
  6185             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6186             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6187
  6188         16  CF-EXCEPTION-LIST-IND          PIC X.
  6189             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 114
* EL050.cbl
  6190
  6191         16  FILLER                         PIC X(318).
  6192
  6193****************************************************************
  6194*                  EXCEPTION REPORTING RECORD                  *
  6195****************************************************************
  6196
  6197     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6198         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6199             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6200
  6201         16  CF-COMBINED-LIFE-AH-OPT.
  6202             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6203             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6204             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6205             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6206
  6207         16  CF-LIFE-OPT.
  6208             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6209             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6210             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6211             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6212             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6213             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6214             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6215             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6216             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6217             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6218
  6219         16  CF-AH-OPT.
  6220             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6221             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6222             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6223             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6224             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6225             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6226             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6227             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6228             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6229             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6230
  6231         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6232             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6233             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6234             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6235
  6236         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6237
  6238         16  FILLER                         PIC X(673).
  6239
  6240
  6241****************************************************************
  6242*             MORTGAGE SYSTEM PLAN RECORD                      *
  6243****************************************************************
  6244
  6245     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6246         16  CF-PLAN-TYPE                   PIC X.
  6247             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 115
* EL050.cbl
  6248             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6249             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6250         16  CF-PLAN-ABBREV                 PIC XXX.
  6251         16  CF-PLAN-DESCRIPT               PIC X(10).
  6252         16  CF-PLAN-NOTES                  PIC X(20).
  6253         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6254         16  CF-PLAN-UNDERWRITING.
  6255             20  CF-PLAN-TERM-DATA.
  6256                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6257                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6258             20  CF-PLAN-AGE-DATA.
  6259                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6260                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6261                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6262             20  CF-PLAN-BENEFIT-DATA.
  6263                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6264                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6265                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6266                                            PIC S9(7)V99  COMP-3.
  6267         16  CF-PLAN-POLICY-FORMS.
  6268             20  CF-POLICY-FORM             PIC X(12).
  6269             20  CF-MASTER-APPLICATION      PIC X(12).
  6270             20  CF-MASTER-POLICY           PIC X(12).
  6271         16  CF-PLAN-RATING.
  6272             20  CF-RATE-CODE               PIC X(5).
  6273             20  CF-SEX-RATING              PIC X.
  6274                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6275                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6276             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6277             20  CF-SUB-STD-TYPE            PIC X.
  6278                 88  CF-PCT-OF-PREM            VALUE '1'.
  6279                 88  CF-PCT-OF-BENE            VALUE '2'.
  6280         16  CF-PLAN-PREM-TOLERANCES.
  6281             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6282             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6283         16  CF-PLAN-PYMT-TOLERANCES.
  6284             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6285             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6286         16  CF-PLAN-MISC-DATA.
  6287             20  FILLER                     PIC X.
  6288             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6289             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6290         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6291         16  CF-PLAN-IND-GRP                PIC X.
  6292             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6293                                                     '1'.
  6294             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6295                                                     '2'.
  6296         16  CF-MIB-SEARCH-SW               PIC X.
  6297             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6298             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6299             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6300             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6301         16  CF-ALPHA-SEARCH-SW             PIC X.
  6302             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6303             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6304             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6305             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 116
* EL050.cbl
  6306             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6307             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6308             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6309             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6310             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6311             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6312                                                     'A' 'B' 'C'
  6313                                                     'X' 'Y' 'Z'.
  6314         16  CF-EFF-DT-RULE-SW              PIC X.
  6315             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6316             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6317             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6318             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6319             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6320         16  FILLER                         PIC X(4).
  6321         16  CF-HEALTH-QUESTIONS            PIC X.
  6322             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6323         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6324         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6325         16  CF-PLAN-SNGL-JNT               PIC X.
  6326             88  CF-COMBINED-PLAN              VALUE 'C'.
  6327             88  CF-JNT-PLAN                   VALUE 'J'.
  6328             88  CF-SNGL-PLAN                  VALUE 'S'.
  6329         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6330         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6331         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6332         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6333         16  CF-RERATE-CNTL                 PIC  X.
  6334             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6335             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6336             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6337             88  CF-AUTO-RECALC                 VALUE '4'.
  6338         16  CF-BENEFIT-TYPE                PIC  X.
  6339             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6340             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6341         16  CF-POLICY-FEE                  PIC S999V99
  6342                                                    COMP-3.
  6343         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6344         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6345         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6346         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6347         16  FILLER                         PIC  X(32).
  6348         16  CF-TERMINATION-FORM            PIC  X(04).
  6349         16  FILLER                         PIC  X(08).
  6350         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6351                                                       COMP-3.
  6352         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6353         16  CF-ISSUE-LETTER                PIC  X(4).
  6354         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6355         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6356             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6357             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6358         16  CF-MP-REFUND-CALC              PIC X.
  6359             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6360             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6361             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6362             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6363             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 117
* EL050.cbl
  6364             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6365             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6366             88  CF-MP-REFD-MEAN                VALUE '8'.
  6367         16  CF-ALT-RATE-CODE               PIC  X(5).
  6368
  6369
  6370         16  FILLER                         PIC X(498).
  6371****************************************************************
  6372*             MORTGAGE COMPANY MASTER RECORD                   *
  6373****************************************************************
  6374
  6375     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6376         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6377         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6378             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6379             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6380             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6381             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6382             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6383
  6384         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6385         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6386         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6387         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6388         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6389
  6390         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6391             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6392         16  CF-MP-RECON-USE-IND            PIC X(1).
  6393             88  CF-MP-USE-RECON             VALUE 'Y'.
  6394         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6395             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6396         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6397             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6398             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6399         16  FILLER                         PIC X(1).
  6400         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6401             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6402         16  CF-MORTG-MIB-VERSION           PIC X.
  6403             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6404             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6405             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6406         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6407             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6408                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6409             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6410                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6411             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6412                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6413             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6414                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6415             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6416                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6417             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6418                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6419         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6420         16  FILLER                         PIC X(7).
  6421         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 118
* EL050.cbl
  6422             20  CF-MORTG-MIB-COMM          PIC X(5).
  6423             20  CF-MORTG-MIB-TERM          PIC X(5).
  6424         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6425             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6426         16  FILLER                         PIC X(03).
  6427         16  CF-MP-CHECK-NO-CONTROL.
  6428             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6429                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6430                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6431                                                ' ' LOW-VALUES.
  6432                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6433                                               VALUE '3'.
  6434         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6435         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6436         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6437             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6438                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6439             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6440                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6441             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6442                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6443             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6444                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6445             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6446                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6447             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6448                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6449         16  CF-MORTG-BILLING-AREA.
  6450             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6451                                            PIC X.
  6452         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6453         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6454         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6455         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6456             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6457             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6458         16  FILLER                         PIC X.
  6459         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6460             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6461             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6462         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6463         16  FILLER                         PIC X(8).
  6464         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6465         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6466         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6467         16  CF-ACH-COMPANY-ID.
  6468             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6469                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6470                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6471                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6472             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6473         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6474             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6475         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6476             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6477             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6478         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6479         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 119
* EL050.cbl
  6480         16  FILLER                         PIC X(536).
  6481
  6482****************************************************************
  6483*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6484****************************************************************
  6485
  6486     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6487         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6488             20  CF-FEMALE-HEIGHT.
  6489                 24  CF-FEMALE-FT           PIC 99.
  6490                 24  CF-FEMALE-IN           PIC 99.
  6491             20  CF-FEMALE-MIN-WT           PIC 999.
  6492             20  CF-FEMALE-MAX-WT           PIC 999.
  6493         16  FILLER                         PIC X(428).
  6494
  6495     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6496         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6497             20  CF-MALE-HEIGHT.
  6498                 24  CF-MALE-FT             PIC 99.
  6499                 24  CF-MALE-IN             PIC 99.
  6500             20  CF-MALE-MIN-WT             PIC 999.
  6501             20  CF-MALE-MAX-WT             PIC 999.
  6502         16  FILLER                         PIC X(428).
  6503******************************************************************
  6504*             AUTOMATIC ACTIVITY RECORD                          *
  6505******************************************************************
  6506     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6507         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6508             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6509             20  CF-SYS-LETTER-ID           PIC X(04).
  6510             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6511             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6512             20  CF-SYS-RESET-SW            PIC X(01).
  6513             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6514             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6515
  6516         16  FILLER                         PIC X(50).
  6517
  6518         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6519             20  CF-USER-ACTIVE-SW          PIC X(01).
  6520             20  CF-USER-LETTER-ID          PIC X(04).
  6521             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6522             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6523             20  CF-USER-RESET-SW           PIC X(01).
  6524             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6525             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6526             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6527
  6528         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 120
* EL050.cbl
  6530*    COPY ERCACCT.
  6531******************************************************************
  6532*                                                                *
  6533*                                                                *
  6534*                            ERCACCT                             *
  6535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6536*                            VMOD=2.031                          *
  6537*                                                                *
  6538*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6539*                                                                *
  6540*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6541*   VSAM ACCOUNT MASTER FILES.                                   *
  6542*                                                                *
  6543*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6544*                                                                *
  6545*   FILE TYPE = VSAM,KSDS                                        *
  6546*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6547*                                                                *
  6548*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6549*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6550*                                                                *
  6551*   LOG = NO                                                     *
  6552*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6553*                                                                *
  6554*                                                                *
  6555******************************************************************
  6556*                   C H A N G E   L O G
  6557*
  6558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6559*-----------------------------------------------------------------
  6560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6561* EFFECTIVE    NUMBER
  6562*-----------------------------------------------------------------
  6563* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6564* 092705    2005050300006  PEMA  ADD SPP LEASES
  6565* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6566* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6567* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6568* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6569* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6570* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6571******************************************************************
  6572
  6573 01  ACCOUNT-MASTER.
  6574     12  AM-RECORD-ID                      PIC XX.
  6575         88  VALID-AM-ID                      VALUE 'AM'.
  6576
  6577     12  AM-CONTROL-PRIMARY.
  6578         16  AM-COMPANY-CD                 PIC X.
  6579         16  AM-MSTR-CNTRL.
  6580             20  AM-CONTROL-A.
  6581                 24  AM-CARRIER            PIC X.
  6582                 24  AM-GROUPING.
  6583                     28 AM-GROUPING-PREFIX PIC XXX.
  6584                     28 AM-GROUPING-PRIME  PIC XXX.
  6585                 24  AM-STATE              PIC XX.
  6586                 24  AM-ACCOUNT.
  6587                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 121
* EL050.cbl
  6588                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6589             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6590                                           PIC X(19).
  6591             20  AM-CNTRL-B.
  6592                 24  AM-EXPIRATION-DT      PIC XX.
  6593                 24  FILLER                PIC X(4).
  6594             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6595                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6596
  6597     12  AM-CONTROL-BY-VAR-GRP.
  6598         16  AM-COMPANY-CD-A1              PIC X.
  6599         16  AM-VG-CARRIER                 PIC X.
  6600         16  AM-VG-GROUPING                PIC X(6).
  6601         16  AM-VG-STATE                   PIC XX.
  6602         16  AM-VG-ACCOUNT                 PIC X(10).
  6603         16  AM-VG-DATE.
  6604             20  AM-VG-EXPIRATION-DT       PIC XX.
  6605             20  FILLER                    PIC X(4).
  6606         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6607                                           PIC 9(11)      COMP-3.
  6608     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6609         16  FILLER                        PIC X(10).
  6610         16  AM-VG-KEY3.
  6611             20  AM-VG3-ACCOUNT            PIC X(10).
  6612             20  AM-VG3-EXP-DT             PIC XX.
  6613         16  FILLER                        PIC X(4).
  6614     12  AM-MAINT-INFORMATION.
  6615         16  AM-LAST-MAINT-DT              PIC XX.
  6616         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6617         16  AM-LAST-MAINT-USER            PIC X(4).
  6618         16  FILLER                        PIC XX.
  6619
  6620     12  AM-EFFECTIVE-DT                   PIC XX.
  6621     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6622
  6623     12  AM-PREV-DATES  COMP-3.
  6624         16  AM-PREV-EXP-DT                PIC 9(11).
  6625         16  AM-PREV-EFF-DT                PIC 9(11).
  6626
  6627     12  AM-REPORT-CODE-1                  PIC X(10).
  6628     12  AM-REPORT-CODE-2                  PIC X(10).
  6629
  6630     12  AM-CITY-CODE                      PIC X(4).
  6631     12  AM-COUNTY-PARISH                  PIC X(6).
  6632
  6633     12  AM-NAME                           PIC X(30).
  6634     12  AM-PERSON                         PIC X(30).
  6635     12  AM-ADDRS                          PIC X(30).
  6636     12  AM-CITY.
  6637         16  AM-ADDR-CITY                  PIC X(28).
  6638         16  AM-ADDR-STATE                 PIC XX.
  6639     12  AM-ZIP.
  6640         16  AM-ZIP-PRIME.
  6641             20  AM-ZIP-PRI-1ST            PIC X.
  6642                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6643             20  FILLER                    PIC X(4).
  6644         16  AM-ZIP-PLUS4                  PIC X(4).
  6645     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 122
* EL050.cbl
  6646         16  AM-CAN-POSTAL-1               PIC XXX.
  6647         16  AM-CAN-POSTAL-2               PIC XXX.
  6648         16  FILLER                        PIC XXX.
  6649     12  AM-TEL-NO.
  6650         16  AM-AREA-CODE                  PIC 999.
  6651         16  AM-TEL-PRE                    PIC 999.
  6652         16  AM-TEL-NBR                    PIC 9(4).
  6653     12  AM-TEL-LOC                        PIC X.
  6654         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6655         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6656
  6657     12  AM-COMM-STRUCTURE.
  6658         16  AM-DEFN-1.
  6659             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6660                 24  AM-AGT.
  6661                     28  AM-AGT-PREFIX     PIC X(4).
  6662                     28  AM-AGT-PRIME      PIC X(6).
  6663                 24  AM-COM-TYP            PIC X.
  6664                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6665                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6666                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6667                 24  AM-RECALC-LV-INDIC    PIC X.
  6668                 24  AM-RETRO-LV-INDIC     PIC X.
  6669                 24  AM-GL-CODES           PIC X.
  6670                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6671                 24  FILLER                PIC X(01).
  6672         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6673             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6674                 24  FILLER                PIC X(11).
  6675                 24  AM-L-COMA             PIC XXX.
  6676                 24  AM-J-COMA             PIC XXX.
  6677                 24  AM-A-COMA             PIC XXX.
  6678                 24  FILLER                PIC X(6).
  6679
  6680     12  AM-COMM-CHANGE-STATUS             PIC X.
  6681         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6682
  6683     12  AM-CSR-CODE                       PIC X(4).
  6684
  6685     12  AM-BILLING-STATUS                 PIC X.
  6686         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6687         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6688     12  AM-AUTO-REFUND-SW                 PIC X.
  6689         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6690         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6691     12  AM-GPCD                           PIC 99.
  6692     12  AM-IG                             PIC X.
  6693         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6694         88  AM-HAS-GROUP                     VALUE '2'.
  6695     12  AM-STATUS                         PIC X.
  6696         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6697         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6698         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6699         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6700         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6701         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6702         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6703         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 123
* EL050.cbl
  6704         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6705         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6706     12  AM-REMIT-TO                       PIC 99.
  6707     12  AM-ID-NO                          PIC X(11).
  6708
  6709     12  AM-CAL-TABLE                      PIC XX.
  6710     12  AM-LF-DEVIATION                   PIC XXX.
  6711     12  AM-AH-DEVIATION                   PIC XXX.
  6712     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6713     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6714     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6715     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6716     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6717     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6718
  6719     12  AM-USER-FIELDS.
  6720         16  AM-FLD-1                      PIC XX.
  6721         16  AM-FLD-2                      PIC XX.
  6722         16  AM-FLD-3                      PIC XX.
  6723         16  AM-FLD-4                      PIC XX.
  6724         16  AM-FLD-5                      PIC XX.
  6725
  6726     12  AM-1ST-PROD-DATE.
  6727         16  AM-1ST-PROD-YR                PIC XX.
  6728         16  AM-1ST-PROD-MO                PIC XX.
  6729         16  AM-1ST-PROD-DA                PIC XX.
  6730     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6731     12  AM-CERTS-PURGED-DATE.
  6732         16  AM-PUR-YR                     PIC XX.
  6733         16  AM-PUR-MO                     PIC XX.
  6734         16  AM-PUR-DA                     PIC XX.
  6735     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6736     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6737     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6738     12  AM-INACTIVE-DATE.
  6739         16  AM-INA-MO                     PIC 99.
  6740         16  AM-INA-DA                     PIC 99.
  6741         16  AM-INA-YR                     PIC 99.
  6742     12  AM-AR-HI-CERT-DATE                PIC XX.
  6743
  6744     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6745     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6746
  6747     12  AM-OB-PAYMENT-MODE                PIC X.
  6748         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6749         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6750         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6751         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6752
  6753     12  AM-AH-ONLY-INDICATOR              PIC X.
  6754         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6755         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6756
  6757     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6758
  6759     12  AM-OVER-SHORT.
  6760         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6761         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 124
* EL050.cbl
  6762
  6763     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6764     12  AM-DCC-CLP-STATE                  PIC XX.
  6765
  6766     12  AM-RECALC-COMM                    PIC X.
  6767     12  AM-RECALC-REIN                    PIC X.
  6768
  6769     12  AM-REI-TABLE                      PIC XXX.
  6770     12  AM-REI-ET-LF                      PIC X.
  6771     12  AM-REI-ET-AH                      PIC X.
  6772     12  AM-REI-PE-LF                      PIC X.
  6773     12  AM-REI-PE-AH                      PIC X.
  6774     12  AM-REI-PRT-ST                     PIC X.
  6775     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6776     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6777     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6778     12  AM-REI-GROUP-A                    PIC X(6).
  6779     12  AM-REI-MORT                       PIC X(4).
  6780     12  AM-REI-PRT-OW                     PIC X.
  6781     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6782     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6783     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6784     12  AM-REI-GROUP-B                    PIC X(6).
  6785
  6786     12  AM-TRUST-TYPE                     PIC X(2).
  6787
  6788     12  AM-EMPLOYER-STMT-USED             PIC X.
  6789     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6790
  6791     12  AM-STD-AH-TYPE                    PIC XX.
  6792     12  AM-EARN-METHODS.
  6793         16  AM-EARN-METHOD-R              PIC X.
  6794             88 AM-REF-RL-R78                 VALUE 'R'.
  6795             88 AM-REF-RL-PR                  VALUE 'P'.
  6796             88 AM-REF-RL-MEAN                VALUE 'M'.
  6797             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6798         16  AM-EARN-METHOD-L              PIC X.
  6799             88 AM-REF-LL-R78                 VALUE 'R'.
  6800             88 AM-REF-LL-PR                  VALUE 'P'.
  6801             88 AM-REF-LL-MEAN                VALUE 'M'.
  6802             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6803         16  AM-EARN-METHOD-A              PIC X.
  6804             88 AM-REF-AH-R78                 VALUE 'R'.
  6805             88 AM-REF-AH-PR                  VALUE 'P'.
  6806             88 AM-REF-AH-MEAN                VALUE 'M'.
  6807             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6808             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6809             88 AM-REF-AH-NET                 VALUE 'N'.
  6810
  6811     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6812     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6813     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6814
  6815     12  AM-RET-Y-N                        PIC X.
  6816     12  AM-RET-P-E                        PIC X.
  6817     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6818     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6819     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 125
* EL050.cbl
  6820     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6821         16  AM-POOL-PRIME                 PIC XXX.
  6822         16  AM-POOL-SUB                   PIC XXX.
  6823     12  AM-RETRO-EARNINGS.
  6824         16  AM-RET-EARN-R                 PIC X.
  6825         16  AM-RET-EARN-L                 PIC X.
  6826         16  AM-RET-EARN-A                 PIC X.
  6827     12  AM-RET-ST-TAX-USE                 PIC X.
  6828         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6829         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6830     12  AM-RETRO-BEG-EARNINGS.
  6831         16  AM-RET-BEG-EARN-R             PIC X.
  6832         16  AM-RET-BEG-EARN-L             PIC X.
  6833         16  AM-RET-BEG-EARN-A             PIC X.
  6834     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6835     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6836
  6837     12  AM-USER-SELECT-OPTIONS.
  6838         16  AM-USER-SELECT-1              PIC X(10).
  6839         16  AM-USER-SELECT-2              PIC X(10).
  6840         16  AM-USER-SELECT-3              PIC X(10).
  6841         16  AM-USER-SELECT-4              PIC X(10).
  6842         16  AM-USER-SELECT-5              PIC X(10).
  6843
  6844     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6845
  6846     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6847
  6848     12  AM-RPT045A-SWITCH                 PIC X.
  6849         88  RPT045A-OFF                   VALUE 'N'.
  6850
  6851     12  AM-INSURANCE-LIMITS.
  6852         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6853         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6854
  6855     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6856         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6857
  6858     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6859         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6860         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6861
  6862     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6863
  6864     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6865     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6866     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6867     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6868     12  AM-DCC-UEF-STATE                  PIC XX.
  6869     12  FILLER                            PIC XXX.
  6870     12  AM-REPORT-CODE-3                  PIC X(10).
  6871*    12  FILLER                            PIC X(22).
  6872
  6873     12  AM-RESERVE-DATE.
  6874         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6875         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6876         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6877
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 126
* EL050.cbl
  6878     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6879     12  AM-NOTIFICATION-TYPES.
  6880         16  AM-NOTIF-OF-LETTERS           PIC X.
  6881         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6882         16  AM-NOTIF-OF-REPORTS           PIC X.
  6883         16  AM-NOTIF-OF-STATUS            PIC X.
  6884
  6885     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6886         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6887         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6888         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6889         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6890
  6891     12  AM-BENEFIT-CONTROLS.
  6892         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6893             20  AM-BENEFIT-CODE           PIC XX.
  6894             20  AM-BENEFIT-TYPE           PIC X.
  6895             20  AM-BENEFIT-REVISION       PIC XXX.
  6896             20  AM-BENEFIT-REM-TERM       PIC X.
  6897             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6898             20  FILLER                    PIC XX.
  6899         16  FILLER                        PIC X(80).
  6900
  6901     12  AM-TRANSFER-DATA.
  6902         16  AM-TRANSFERRED-FROM.
  6903             20  AM-TRNFROM-CARRIER        PIC X.
  6904             20  AM-TRNFROM-GROUPING.
  6905                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6906                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6907             20  AM-TRNFROM-STATE          PIC XX.
  6908             20  AM-TRNFROM-ACCOUNT.
  6909                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6910                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6911             20  AM-TRNFROM-DTE            PIC XX.
  6912         16  AM-TRANSFERRED-TO.
  6913             20  AM-TRNTO-CARRIER          PIC X.
  6914             20  AM-TRNTO-GROUPING.
  6915                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6916                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6917             20  AM-TRNTO-STATE            PIC XX.
  6918             20  AM-TRNTO-ACCOUNT.
  6919                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6920                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6921             20  AM-TRNTO-DTE              PIC XX.
  6922         16  FILLER                        PIC X(10).
  6923
  6924     12  AM-SAVED-REMIT-TO                 PIC 99.
  6925
  6926     12  AM-COMM-STRUCTURE-SAVED.
  6927         16  AM-DEFN-1-SAVED.
  6928             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6929                 24  AM-AGT-SV             PIC X(10).
  6930                 24  AM-COM-TYP-SV         PIC X.
  6931                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6932                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6933                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6934                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6935                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 127
* EL050.cbl
  6936                 24  AM-GL-CODES-SV        PIC X.
  6937                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6938                 24  FILLER                PIC X.
  6939         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6940             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6941                 24  FILLER                PIC X(11).
  6942                 24  AM-L-COMA-SV          PIC XXX.
  6943                 24  AM-J-COMA-SV          PIC XXX.
  6944                 24  AM-A-COMA-SV          PIC XXX.
  6945                 24  FILLER                PIC X(6).
  6946
  6947     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6948         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6949            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6950            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6951            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6952
  6953     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6954     12  FILLER                            PIC X(120).
  6955
  6956     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6957         16  AM-CONTROL-NAME               PIC X(30).
  6958         16  AM-EXECUTIVE-ONE.
  6959             20  AM-EXEC1-NAME             PIC X(15).
  6960             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6961                                                          COMP-3.
  6962             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6963                                                          COMP-3.
  6964         16  AM-EXECUTIVE-TWO.
  6965             20  AM-EXEC2-NAME             PIC X(15).
  6966             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6967                                                          COMP-3.
  6968             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6969                                                          COMP-3.
  6970
  6971     12  AM-RETRO-ADDITIONAL-DATA.
  6972         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6973         16  AM-RETRO-PREM-P-E             PIC X.
  6974         16  AM-RETRO-CLMS-P-I             PIC X.
  6975         16  AM-RETRO-RET-BRACKET-LF.
  6976             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6977                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6978                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6979             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6980                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6981                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6982             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6983                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6984                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6985         16  AM-RETRO-RET-BRACKET-AH.
  6986             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6987                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6988                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6989                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6990             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6991                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6992                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6993             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 128
* EL050.cbl
  6994                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6995                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6996
  6997     12  AM-COMMENTS.
  6998         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6999
  7000     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7001         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7002         16  AM-FLI-BILLING-CODE           PIC X.
  7003         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7004         16  AM-FLI-UNITED-IDENT           PIC X.
  7005         16  AM-FLI-INTEREST-LOST-DATA.
  7006             20  AM-FLI-BANK-NO            PIC X(5).
  7007             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7008             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7009             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7010         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7011             20  AM-FLI-AGT                PIC X(9).
  7012             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7013             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7014         16  FILLER                        PIC X(102).
  7015
  7016     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7017         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7018             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7019             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7020             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7021             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7022             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7023         16  FILLER                          PIC X(10).
  7024******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 129
* EL050.cbl
  7026*    COPY ERCREIN.
  7027******************************************************************
  7028*                                                                *
  7029*                            ERCREIN                             *
  7030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7031*                            VMOD=2.010                          *
  7032*                                                                *
  7033*   ONLINE CREDIT SYSTEM                                         *
  7034*                                                                *
  7035*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7036*                                                                *
  7037*   FILE TYPE = VSAM,KSDS                                        *
  7038*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7039*                                                                *
  7040*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7041*       ALTERNATE PATH = NONE                                    *
  7042*                                                                *
  7043*   LOG = NO                                                     *
  7044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7045*                                                                *
  7046******************************************************************
  7047*                   C H A N G E   L O G
  7048*
  7049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7050*-----------------------------------------------------------------
  7051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7052* EFFECTIVE    NUMBER
  7053*-----------------------------------------------------------------
  7054* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7055* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7056******************************************************************
  7057 01  REINSURANCE-RECORD.
  7058     12  RE-RECORD-ID                      PIC XX.
  7059         88  VALID-RE-ID                      VALUE 'RE'.
  7060
  7061     12  RE-CONTROL-PRIMARY.
  7062         16  RE-COMPANY-CD                 PIC X.
  7063         16  RE-KEY.
  7064             20  RE-CODE                   PIC X.
  7065                 88  RE-TABLE-RECORD          VALUE 'A'.
  7066                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7067             20  RE-TABLE                  PIC XXX.
  7068             20  FILLER                    PIC XXX.
  7069         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7070             20  FILLER                    PIC X.
  7071             20  RE-COMPANY.
  7072                 24  RE-COMP-PRIME         PIC XXX.
  7073                 24  RE-COMP-SUB           PIC XXX.
  7074
  7075     12  RE-MAINT-INFORMATION.
  7076         16  RE-LAST-MAINT-DT              PIC XX.
  7077         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7078         16  RE-LAST-MAINT-USER            PIC X(4).
  7079         16  FILLER                        PIC X(10).
  7080
  7081     12  RE-TABLE-DATA.
  7082         16  RE-100-COMP                   PIC 99.
  7083
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 130
* EL050.cbl
  7084         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7085             20  RE-REI-COMP-NO.
  7086                 24  RE-REI-COMP           PIC XXX.
  7087                 24  RE-REI-COMP-SUB       PIC XXX.
  7088             20  RE-LF-QC                  PIC X.
  7089             20  RE-AH-QC                  PIC X.
  7090             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7091             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7092             20  RE-LFAGE-LO               PIC 99.
  7093             20  RE-LFAGE-HI               PIC 99.
  7094             20  RE-AHAGE-LO               PIC 99.
  7095             20  RE-AHAGE-HI               PIC 99.
  7096             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7097             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7098             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7099             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7100             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7101             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7102             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7103             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7104             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7105             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7106             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7107             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7108             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7109             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7110             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7111             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7112             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7113             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7114             20  RE-LF-BEN-CODE            PIC X.
  7115             20  RE-AH-BEN-CODE            PIC X.
  7116             20  RE-INTERACTIVE            PIC X.
  7117             20  RE-REMAINING              PIC X.
  7118             20  RE-LF-RUNOFF-SW           PIC X.
  7119             20  RE-AH-RUNOFF-SW           PIC X.
  7120             20  FILLER                    PIC X(19).
  7121
  7122         16  RE-COMP-INFO-END              PIC X(6).
  7123         16  RE-NSP-ST-CD-LF               PIC XX.
  7124         16  RE-NSP-ST-CD-AH               PIC XX.
  7125         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7126             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7127
  7128         16  FILLER                        PIC X(27).
  7129
  7130     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7131         16  RE-NAME                       PIC X(30).
  7132         16  RE-LF-PE                      PIC X.
  7133         16  RE-AH-PE                      PIC X.
  7134         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7135         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7136         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7137         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7138         16  RE-PRT-ST                     PIC X.
  7139         16  RE-PRT-OW                     PIC X.
  7140         16  RE-MORT-CODE                  PIC X(4).
  7141         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 131
* EL050.cbl
  7142         16  RE-ZERO-LF-FEE                PIC X.
  7143         16  RE-ZERO-AH-FEE                PIC X.
  7144         16  RE-CEDE-NAME                  PIC X(30).
  7145         16  RE-LF-COMM                    PIC X.
  7146         16  RE-AH-COMM                    PIC X.
  7147         16  RE-LF-TAX                     PIC X.
  7148         16  RE-AH-TAX                     PIC X.
  7149         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7150         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7151         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7152
  7153         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7154             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7155
  7156         16  RE-LF-CEDING-FEE-BRACKETS.
  7157             20  RE-LF-FEE-METHOD          PIC X.
  7158                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7159                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7160                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7161                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7162             20  RE-LF-FEE-BASIS           PIC X.
  7163                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7164                 88  RE-LF-NET-CEDED               VALUE '2'.
  7165                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7166                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7167                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7168                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7169                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7170                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7171             20  FILLER                    PIC XXX.
  7172             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7173                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7174                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7175
  7176         16  RE-AH-CEDING-FEE-BRACKETS.
  7177             20  RE-AH-FEE-METHOD          PIC X.
  7178                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7179                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7180                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7181                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7182             20  RE-AH-FEE-BASIS           PIC X.
  7183                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7184                 88  RE-AH-NET-CEDED               VALUE '2'.
  7185                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7186                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7187                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7188                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7189                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7190                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7191             20  FILLER                    PIC XXX.
  7192             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7193                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7194                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7195
  7196         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7197
  7198         16  RE-OLD-CEDING-STMT            PIC X.
  7199
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 132
* EL050.cbl
  7200         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7201         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7202         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7203         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7204         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7205         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7206         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7207         16  RE-MORT-SW                    PIC X.
  7208         16  RE-CEDING-TYPE-FLAG           PIC X.
  7209             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7210             88  RE-CEDED                          VALUE 'C'.
  7211             88  RE-ASSUMED                        VALUE 'A'.
  7212             88  RE-PHANTOM                        VALUE 'P'.
  7213
  7214         16  RE-CEDING-STMT-OPT-A          PIC X.
  7215             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7216         16  RE-CEDING-STMT-OPT-B          PIC X.
  7217             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7218         16  RE-CEDING-STMT-OPT-C          PIC X.
  7219             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7220         16  RE-CEDING-STMT-OPT-D          PIC X.
  7221             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7222         16  RE-CEDING-STMT-OPT-E          PIC X.
  7223             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7224
  7225         16  RE-PRT-CRSV                   PIC X.
  7226
  7227         16  RE-GL-CENTER                  PIC X(4).
  7228
  7229         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7230
  7231         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7232
  7233         16  RE-EARN-STOP-CODE             PIC X.
  7234             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7235             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7236
  7237         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7238             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7239
  7240         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7241         16  FILLER                        PIC X(2281).
  7242
  7243         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7244
  7245******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 133
* EL050.cbl
  7247*    COPY ERCCTBL.
  7248******************************************************************
  7249*                                                                *
  7250*                                                                *
  7251*                            ERCCTBL                             *
  7252*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7253*                            VMOD=2.003
  7254*                                                                *
  7255*   ONLINE CREDIT SYSTEM                                         *
  7256*                                                                *
  7257*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7258*                                                                *
  7259*   FILE TYPE = VSAM,KSDS                                        *
  7260*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7261*                                                                *
  7262*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7263*       ALTERNATE PATH = NONE                                    *
  7264*                                                                *
  7265*   LOG = NO                                                     *
  7266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7267*                                                                *
  7268*                                                                *
  7269******************************************************************
  7270
  7271 01  COMM-TABLE-RECORD.
  7272     12  CT-RECORD-ID                      PIC XX.
  7273         88  VALID-CT-ID                      VALUE 'CT'.
  7274
  7275     12  CT-CONTROL-PRIMARY.
  7276         16  CT-COMPANY-CD                 PIC X.
  7277         16  CT-TABLE                      PIC XXX.
  7278         16  CT-CNTRL-2.
  7279             20  CT-BEN-TYPE               PIC X.
  7280             20  CT-BEN-CODE               PIC XX.
  7281
  7282     12  CT-MAINT-INFORMATION.
  7283         16  CT-LAST-MAINT-DT              PIC XX.
  7284         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7285         16  CT-LAST-MAINT-USER            PIC X(4).
  7286         16  FILLER                        PIC X(31).
  7287
  7288     12  CT-LIMITS.
  7289         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7290
  7291         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7292
  7293         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7294
  7295     12  CT-RATES.
  7296         16  CT-RTX          OCCURS 27 TIMES.
  7297             20  CT-RT                     PIC SV9(5)     COMP-3.
  7298             20  CT-RT-R   REDEFINES
  7299                 CT-RT                     PIC XXX.
  7300
  7301     12  FILLER                            PIC  X(42).
  7302
  7303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 134
* EL050.cbl
  7305*    COPY ERCFORM.
  7306******************************************************************
  7307*                                                                *
  7308*                                                                *
  7309*                            ERCFORM.                            *
  7310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7311*                            VMOD=2.003                          *
  7312*                                                                *
  7313*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7314*                                                                *
  7315*    FILE TYPE = VSAM,KSDS                                       *
  7316*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7317*                                                                *
  7318*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7319*                                                                *
  7320*    LOG = YES                                                   *
  7321*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7322******************************************************************
  7323 01  FORM-MASTER.
  7324    12  FO-RECORD-ID                 PIC X(02).
  7325        88  VALID-FO-ID                  VALUE 'FO'.
  7326
  7327    12  FO-CONTROL-PRIMARY.
  7328        16  FO-COMPANY-CD            PIC X(01).
  7329        16  FO-STATE                 PIC X(02).
  7330        16  FO-FORM-ID               PIC X(12).
  7331        16  FO-FORM-EXP-DT           PIC X(02).
  7332
  7333    12  FO-POLICY-FORM-DATA.
  7334        16  FO-IND-GRP-CD            PIC X(01).
  7335        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7336        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7337        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7338        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7339        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7340        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7341        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7342        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7343        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7344        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7345        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7346        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7347        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7348        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7349        16  FO-APP-CERT-USE-CD       PIC X(01).
  7350
  7351    12  FILLER                       PIC X(29).
  7352
  7353    12  FO-FORM-PLAN-TABLE.
  7354        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7355            20  FO-PLAN-TYPE         PIC X(01).
  7356            20  FO-PLAN-ID           PIC X(02).
  7357            20  FO-PLAN-TERM         PIC 9(03).
  7358            20  FO-PLAN-REFUND-METHOD
  7359                                     PIC X.
  7360
  7361    12  FILLER                       PIC X(30).
  7362
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 135
* EL050.cbl
  7363    12  FO-COMMENTS-AREA.
  7364        16  FO-COMMENT-LINE-1        PIC X(78).
  7365
  7366    12  FILLER                       PIC X(20).
  7367
  7368    12  FO-MAINT-INFORMATION.
  7369        16  FO-LAST-MAINT-DT         PIC X(02).
  7370        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7371        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 136
* EL050.cbl
  7373*    COPY ELCMSTR.
  7374******************************************************************
  7375*                                                                *
  7376*                            ELCMSTR.                            *
  7377*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7378*                            VMOD=2.012                          *
  7379*                                                                *
  7380*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7381*                                                                *
  7382*   FILE TYPE = VSAM,KSDS                                        *
  7383*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7384*                                                                *
  7385*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7386*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7387*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7388*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7389*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7390*                                                 RKP=75,LEN=21  *
  7391*                                                                *
  7392*   **** NOTE ****                                               *
  7393*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7394*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7395*                                                                *
  7396*   LOG = YES                                                    *
  7397*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7398******************************************************************
  7399*                   C H A N G E   L O G
  7400*
  7401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7402*-----------------------------------------------------------------
  7403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7404* EFFECTIVE    NUMBER
  7405*-----------------------------------------------------------------
  7406* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7407* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7408* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7409* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7410* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7411******************************************************************
  7412 01  CLAIM-MASTER.
  7413     12  CL-RECORD-ID                PIC XX.
  7414         88  VALID-CL-ID         VALUE 'CL'.
  7415
  7416     12  CL-CONTROL-PRIMARY.
  7417         16  CL-COMPANY-CD           PIC X.
  7418         16  CL-CARRIER              PIC X.
  7419         16  CL-CLAIM-NO             PIC X(7).
  7420         16  CL-CERT-NO.
  7421             20  CL-CERT-PRIME       PIC X(10).
  7422             20  CL-CERT-SFX         PIC X.
  7423
  7424     12  CL-CONTROL-BY-NAME.
  7425         16  CL-COMPANY-CD-A1        PIC X.
  7426         16  CL-INSURED-LAST-NAME    PIC X(15).
  7427         16  CL-INSURED-NAME.
  7428             20  CL-INSURED-1ST-NAME PIC X(12).
  7429             20  CL-INSURED-MID-INIT PIC X.
  7430
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 137
* EL050.cbl
  7431     12  CL-CONTROL-BY-SSN.
  7432         16  CL-COMPANY-CD-A2        PIC X.
  7433         16  CL-SOC-SEC-NO.
  7434             20  CL-SSN-STATE        PIC XX.
  7435             20  CL-SSN-ACCOUNT      PIC X(6).
  7436             20  CL-SSN-LN3          PIC X(3).
  7437
  7438     12  CL-CONTROL-BY-CERT-NO.
  7439         16  CL-COMPANY-CD-A4        PIC X.
  7440         16  CL-CERT-NO-A4.
  7441             20  CL-CERT-A4-PRIME    PIC X(10).
  7442             20  CL-CERT-A4-SFX      PIC X.
  7443
  7444     12  CL-CONTROL-BY-CCN.
  7445         16  CL-COMPANY-CD-A5        PIC X.
  7446         16  CL-CCN-A5.
  7447             20  CL-CCN.
  7448                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7449                 24  CL-CCN-PRIME-A5 PIC X(12).
  7450             20  CL-CCN-FILLER-A5    PIC X(4).
  7451
  7452     12  CL-INSURED-PROFILE-DATA.
  7453         16  CL-INSURED-BIRTH-DT     PIC XX.
  7454         16  CL-INSURED-SEX-CD       PIC X.
  7455             88  INSURED-IS-MALE        VALUE 'M'.
  7456             88  INSURED-IS-FEMALE      VALUE 'F'.
  7457             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7458         16  CL-INSURED-OCC-CD       PIC X(6).
  7459         16  FILLER                  PIC X(5).
  7460
  7461     12  CL-PROCESSING-INFO.
  7462         16  CL-PROCESSOR-ID         PIC X(4).
  7463         16  CL-CLAIM-STATUS         PIC X.
  7464             88  CLAIM-IS-OPEN          VALUE 'O'.
  7465             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7466         16  CL-CLAIM-TYPE           PIC X.
  7467*            88  AH-CLAIM               VALUE 'A'.
  7468*            88  LIFE-CLAIM             VALUE 'L'.
  7469*            88  PROPERTY-CLAIM         VALUE 'P'.
  7470*            88  IUI-CLAIM              VALUE 'I'.
  7471*            88  GAP-CLAIM              VALUE 'G'.
  7472*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7473         16  CL-CLAIM-PREM-TYPE      PIC X.
  7474             88  SINGLE-PREMIUM         VALUE '1'.
  7475             88  O-B-COVERAGE           VALUE '2'.
  7476             88  OPEN-END-COVERAGE      VALUE '3'.
  7477         16  CL-INCURRED-DT          PIC XX.
  7478         16  CL-REPORTED-DT          PIC XX.
  7479         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7480         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7481         16  CL-LAST-PMT-DT          PIC XX.
  7482         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7483         16  CL-PAID-THRU-DT         PIC XX.
  7484         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7485         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7486         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7487         16  CL-PMT-CALC-METHOD      PIC X.
  7488             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 138
* EL050.cbl
  7489             88  CL-365-DAY-YR          VALUE '2'.
  7490             88  CL-FULL-MONTHS         VALUE '3'.
  7491         16  CL-CAUSE-CD             PIC X(6).
  7492
  7493         16  CL-PRIME-CERT-NO.
  7494             20  CL-PRIME-CERT-PRIME PIC X(10).
  7495             20  CL-PRIME-CERT-SFX   PIC X.
  7496
  7497         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7498             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7499             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7500
  7501         16  CL-MICROFILM-NO         PIC X(10).
  7502         16  FILLER REDEFINES CL-MICROFILM-NO.
  7503             20  CL-BENEFIT-PERIOD   PIC 99.
  7504             20  FILLER              PIC X(8).
  7505         16  CL-PROG-FORM-TYPE       PIC X.
  7506         16  CL-LAST-ADD-ON-DT       PIC XX.
  7507
  7508         16  CL-LAST-REOPEN-DT       PIC XX.
  7509         16  CL-LAST-CLOSE-DT        PIC XX.
  7510         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7511             88  FINAL-PAID             VALUE '1'.
  7512             88  CLAIM-DENIED           VALUE '2'.
  7513             88  AUTO-CLOSE             VALUE '3'.
  7514             88  MANUAL-CLOSE           VALUE '4'.
  7515             88  BENEFITS-CHANGED       VALUE 'C'.
  7516             88  SETUP-ERRORS           VALUE 'E'.
  7517         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7518         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7519         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7520             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7521         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7522         16  FILLER                  PIC X.
  7523
  7524     12  CL-CERTIFICATE-DATA.
  7525         16  CL-CERT-ORIGIN          PIC X.
  7526             88  CERT-WAS-ONLINE        VALUE '1'.
  7527             88  CERT-WAS-CREATED       VALUE '2'.
  7528             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7529         16  CL-CERT-KEY-DATA.
  7530             20  CL-CERT-CARRIER     PIC X.
  7531             20  CL-CERT-GROUPING    PIC X(6).
  7532             20  CL-CERT-STATE       PIC XX.
  7533             20  CL-CERT-ACCOUNT.
  7534                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7535                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7536             20  CL-CERT-EFF-DT      PIC XX.
  7537
  7538     12  CL-STATUS-CONTROLS.
  7539         16  CL-PRIORITY-CD          PIC X.
  7540             88  CONFIDENTIAL-DATA      VALUE '8'.
  7541             88  HIGHEST-PRIORITY       VALUE '9'.
  7542         16  CL-SUPV-ATTN-CD         PIC X.
  7543             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7544             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7545         16  CL-PURGED-DT            PIC XX.
  7546         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 139
* EL050.cbl
  7547         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7548         16  CL-NEXT-RESEND-DT       PIC XX.
  7549         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7550         16  CL-CRITICAL-PERIOD      PIC 99.
  7551*        16  FILLER                  PIC XX.
  7552         16  CL-LAST-MAINT-DT        PIC XX.
  7553         16  CL-LAST-MAINT-USER      PIC X(4).
  7554         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7555         16  CL-LAST-MAINT-TYPE      PIC X.
  7556             88  CLAIM-SET-UP           VALUE ' '.
  7557             88  PAYMENT-MADE           VALUE '1'.
  7558             88  LETTER-SENT            VALUE '2'.
  7559             88  MASTER-WAS-ALTERED     VALUE '3'.
  7560             88  MASTER-WAS-RESTORED    VALUE '4'.
  7561             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7562             88  FILE-CONVERTED         VALUE '6'.
  7563             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7564             88  ERROR-CORRECTION       VALUE 'E'.
  7565         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7566         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7567         16  CL-BENEFICIARY          PIC X(10).
  7568         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7569         16  CL-DENIAL-TYPE          PIC X.
  7570             88  CL-TYPE-DENIAL          VALUE '1'.
  7571             88  CL-TYPE-RESCISSION      VALUE '2'.
  7572             88  CL-TYPE-REFORMATION     VALUE '3'.
  7573             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7574             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7575         16  filler                  pic x(5).
  7576*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7577*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7578*        16  CL-RTW-DT               PIC XX.
  7579
  7580     12  CL-TRAILER-CONTROLS.
  7581         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7582             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7583             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7584             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7585         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7586         16  FILLER                  PIC XX.
  7587         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7588         16  CL-ADDRESS-TRAILER-CNT.
  7589             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7590                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7591             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7592                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7593             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7594                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7595             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7596                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7597             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7598                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7599             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7600                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7601             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7602                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7603
  7604     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 140
* EL050.cbl
  7605         16  CL-CV-REFNO-PRIME       PIC X(18).
  7606         16  CL-CV-REFNO-SFX         PIC XX.
  7607
  7608     12  CL-FILE-LOCATION            PIC X(4).
  7609
  7610     12  CL-PROCESS-ERRORS.
  7611         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7612             88  NO-FATAL-ERRORS        VALUE ZERO.
  7613         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7614             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7615
  7616     12  CL-PRODUCT-CD               PIC X.
  7617
  7618     12  CL-CURRENT-KEY-DATA.
  7619         16  CL-CURRENT-CARRIER      PIC X.
  7620         16  CL-CURRENT-GROUPING     PIC X(6).
  7621         16  CL-CURRENT-STATE        PIC XX.
  7622         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7623
  7624     12  CL-ASSOCIATES               PIC X.
  7625         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7626         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7627         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7628         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7629
  7630     12  CL-ACTIVITY-CODE            PIC 99.
  7631     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7632     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7633
  7634     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7635     12  CL-LAG-REPORT-CODE          PIC 9.
  7636     12  CL-LOAN-TYPE                PIC XX.
  7637     12  CL-LEGAL-STATE              PIC XX.
  7638
  7639     12  CL-YESNOSW                  PIC X.
  7640     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7641         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7642         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7643         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7644     12  cl-insured-type             pic x.
  7645         88  cl-claim-on-primary         value 'P'.
  7646         88  cl-claim-on-co-borrower     value 'C'.
  7647     12  cl-benefit-expiration-dt    PIC XX.
  7648
  7649 01  PLAN-RECORDS.
  7650     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7651     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7652
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 141
* EL050.cbl
  7654 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7655                          ACCOUNT-MASTER REINSURANCE-RECORD
  7656                          COMM-TABLE-RECORD FORM-MASTER
  7657                          CLAIM-MASTER PLAN-RECORDS.
  7658 0000-DFHEXIT SECTION.
  7659     MOVE '9#                    $   ' TO DFHEIV0.
  7660     MOVE 'EL050' TO DFHEIV1.
  7661     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7662
  7663     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7664
  7665
  7666* EXEC CICS  HANDLE CONDITION
  7667*           ERROR    (9300-ABEND)
  7668*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7669*    END-EXEC.
  7670*    MOVE '"$.J                  ! " #00007661' TO DFHEIV0
  7671     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7673     MOVE X'2220233030303037363631' TO DFHEIV0(25:11)
  7674     CALL 'kxdfhei1' USING DFHEIV0
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678 0000-COPY-PROCEDURE-DIV.
  7679*                          COPY ELC50PD.
  7680******************************************************************
  7681*                                                                *
  7682*                            ELC50PD                             *
  7683*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7684*                            VMOD=2.188                          *
  7685*                                                                *
  7686******************************************************************
  7687*                   C H A N G E   L O G
  7688*
  7689* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7690*-----------------------------------------------------------------
  7691*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7692* EFFECTIVE    NUMBER
  7693*-----------------------------------------------------------------
  7694* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7695* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7696* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7697*                             2709 AND 2718
  7698* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7699* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7700* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7701* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7702* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7703*                                IS OPEN OR CNC DT < PD THRU
  7704* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7705* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7706* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7707* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7708* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7709* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7710* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7711* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 142
* EL050.cbl
  7712* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7713* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7714* 020906                   PEMA  EXPAND LOAN OFFICER
  7715* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7716* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7717* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7718* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7719* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7720* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7721* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7722* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7723* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7724* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7725* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7726* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7727* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7728* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7729* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7730* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7731* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7732* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7733* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7734* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7735* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7736* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7737* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7738* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7739* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7740*                                UPDATE VIN ON CERT TRAILER
  7741* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7742* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7743* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7744* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7745* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7746* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7747* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7748* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7749* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7750* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7751* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7752* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7753* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7754* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7755* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7756* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7757* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7758* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7759* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7760* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7761* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7762* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7763* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7764* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7765* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7766* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7767* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7768* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7769* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 143
* EL050.cbl
  7770* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7771* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7772* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7773* 032912  CR2011110200001  PEMA  AHL CHANGES
  7774* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7775* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7776* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7777* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7778* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7779* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7780* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7781* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7782* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7783* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7784* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7785* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7786* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7787* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7788* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7789* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7790* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7791* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7792* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7793* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7794* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7795* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7796* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7797* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7798* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7799* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7800* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7801*                                CERT #, ADD 2898 FORCIBLE ERROR
  7802* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7803* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7804* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7805* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7806* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7807* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7808* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7809* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7810* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7811******************************************************************
  7812************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7813******************************************************************
  7814
  7815     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7816
  7817     MOVE SPACES                 TO PB-FATAL-FLAG
  7818                                    PB-FORCE-ER-CD
  7819                                    PB-WARN-ER-CD
  7820                                    PB-OUT-BAL-CD.
  7821
  7822     MOVE SPACE                  TO WS-IG-OVRD-AH
  7823                                    WS-IG-OVRD-LF
  7824                                    WS-IG-OVRD-AM
  7825                                    WS-IG-OVRD
  7826                                    WS-IG-OVRD-AH-PL
  7827                                    WS-IG-OVRD-LF-PL
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 144
* EL050.cbl
  7828                                    WS-IG-OVRD-AH-BEN
  7829                                    WS-IG-OVRD-LF-BEN.
  7830
  7831******************************************************************
  7832*************       INITIALIZE COMMON ERRORS       ***************
  7833******************************************************************
  7834
  7835     MOVE +0                     TO PB-NO-OF-ERRORS.
  7836     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7837
  7838******************************************************************
  7839
  7840     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7841     SET JULIAN-TO-BIN           TO TRUE.
  7842*    MOVE 5                      TO DC-OPTION-CODE.
  7843     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7844     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7845
  7846     MOVE ZERO                   TO  SUB4.
  7847
  7848 0040-INITIALIZE-GA-BILL-DT.
  7849
  7850     ADD +1                      TO  SUB4.
  7851
  7852     IF  SUB4 GREATER THAN +5
  7853         GO TO 0050-CHECK-CNTL-FOUND.
  7854
  7855     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7856         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7857
  7858     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7859
  7860 0050-CHECK-CNTL-FOUND.
  7861
  7862     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7863        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7864                                         WS-AH-REM-TERM-CALC
  7865                                         EC-CO-REM-TERM-CALC
  7866        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7867        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7868        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7869                                         WS-TOL-AH-CLAIM
  7870        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7871                                         WS-TOL-AH-PREM
  7872                                         EC-CO-TOL-PREM
  7873        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7874                                         WS-TOL-AH-REFUND
  7875                                         EC-CO-TOL-REFUND
  7876        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7877                                         WS-AH-REFUND-OVS-AMT
  7878                                         EC-CO-OVR-SHT-AMT
  7879        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7880                                         WS-TOL-AH-PREM-PCT
  7881                                         EC-CO-TOL-PREM-PCT
  7882        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7883                                         WS-TOL-AH-REFUND-PCT
  7884                                         EC-CO-TOL-REFUND-PCT
  7885        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 145
* EL050.cbl
  7886                                         WS-AH-REFUND-OVS-PCT
  7887                                         EC-CO-OVR-SHT-PCT
  7888        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7889        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7890        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7891        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7892        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7893        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7894        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7895        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7896        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7897        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7898        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7899        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7900                                         EC-CO-MONTH-END-DT
  7901        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7902          GO TO 0100-READ-ACCT.
  7903
  7904     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7905     MOVE SPACES                 TO CNTL-ACCESS.
  7906     MOVE '1'                    TO CNTL-REC-TYPE.
  7907     MOVE +0                     TO CNTL-SEQ-NO.
  7908
  7909     MOVE '1' TO RC-SW-1.
  7910     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7911     IF NOT CF-COMPANY-MASTER
  7912         MOVE ZEROS             TO WK-CO-TOL-PREM
  7913                                   WK-CO-TOL-CLAIM
  7914                                   WK-CO-TOL-REFUND
  7915                                   WK-REFUND-OVS-AMT
  7916                                   WK-REFUND-OVS-PCT
  7917                                   WK-CO-TOL-PREM-PCT
  7918                                   WK-CO-TOL-REFUND-PCT
  7919                                   WK-DEFAULT-APR
  7920                                   WK-CO-MAX-CAP
  7921        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7922                                   WK-CR-R78-METHOD
  7923                                   WK-CO-REF-REJECT-SW
  7924                                   WK-CO-PREM-REJECT-SW
  7925                                   WK-REM-TRM-CALC-OPTION
  7926                                   WK-BIRTH-DATE-INPUT
  7927                                   WK-JOINT-AGE-INPUT
  7928        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7929        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7930        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7931        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7932          GO TO 0099-COMPANY-NOT-FOUND.
  7933
  7934     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7935        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7936     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7937        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7938     IF CF-CO-TOL-CAP NOT NUMERIC
  7939        MOVE +0                    TO CF-CO-TOL-CAP.
  7940     IF CF-DEFAULT-APR NOT NUMERIC
  7941        MOVE +0                    TO CF-DEFAULT-APR.
  7942
  7943     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 146
* EL050.cbl
  7944     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7945     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7946     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7947     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7948     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7949     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7950     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7951     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7952     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7953     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7954     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7955
  7956     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7957          CF-CO-OVR-SHT-AMT > +0
  7958        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7959
  7960     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7961          CF-CO-OVR-SHT-PCT > +0
  7962        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7963
  7964     IF CF-VALID-REM-TRM-OPTION
  7965         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7966     ELSE
  7967         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7968
  7969     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7970     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7971     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7972     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7973
  7974     GO TO 0050-CHECK-CNTL-FOUND.
  7975
  7976 0099-COMPANY-NOT-FOUND.
  7977
  7978     MOVE ER-2616                TO WS-ERROR.
  7979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7980
  7981 0100-READ-ACCT.
  7982
  7983     MOVE SPACES                 TO DATE-RANGE-SW.
  7984
  7985     IF WK-ACCT-ADDR = ZEROS
  7986        GO TO 0102-ACCT-GETMAIN.
  7987
  7988     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7989     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7990     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7991
  7992     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7993        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7994        GO TO 0105-READ-ACCT
  7995     END-IF
  7996
  7997     IF PB-CARRIER NOT = SPACES
  7998        IF PB-CARRIER NOT = AM-VG-CARRIER
  7999           GO TO 0105-READ-ACCT.
  8000
  8001     IF PB-STATE NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 147
* EL050.cbl
  8002        IF PB-STATE NOT = AM-VG-STATE
  8003           GO TO 0105-READ-ACCT.
  8004
  8005     IF PB-GROUPING NOT = SPACES
  8006        IF PB-GROUPING NOT = AM-VG-GROUPING
  8007           GO TO 0105-READ-ACCT.
  8008
  8009     MOVE 'X'                 TO DATE-RANGE-SW.
  8010
  8011     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8012        MOVE 'X'                 TO DATE-RANGE-SW
  8013        GO TO 0105-READ-ACCT.
  8014
  8015     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8016        GO TO 0105-READ-ACCT.
  8017
  8018     GO TO 0180-ACCOUNT-FOUND.
  8019
  8020 0102-ACCT-GETMAIN.
  8021     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8022     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8023
  8024 0105-READ-ACCT.
  8025     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8026     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8027     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8028     MOVE PB-STATE               TO ACCT-STATE.
  8029     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8030     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8031
  8032     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8033
  8034     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8035
  8036 0110-FIND-ACCT-TOLERANCES-LOOP.
  8037     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8038
  8039     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8040        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8041        GO TO 0199-ACCT-NOT-FOUND
  8042     END-IF
  8043     IF PB-CARRIER NOT = SPACES
  8044        IF PB-CARRIER NOT = AM-VG-CARRIER
  8045           GO TO 0199-ACCT-NOT-FOUND.
  8046
  8047     IF PB-STATE NOT = SPACES
  8048        IF PB-STATE NOT = AM-VG-STATE
  8049           GO TO 0199-ACCT-NOT-FOUND.
  8050
  8051     IF PB-GROUPING NOT = SPACES
  8052        IF PB-GROUPING NOT = AM-VG-GROUPING
  8053           GO TO 0199-ACCT-NOT-FOUND.
  8054
  8055     MOVE 'X'                    TO DATE-RANGE-SW.
  8056
  8057     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8058        MOVE 'X'                 TO DATE-RANGE-SW
  8059        GO TO 0199-ACCT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 148
* EL050.cbl
  8060
  8061     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8062        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8063
  8064 0180-ACCOUNT-FOUND.
  8065     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8066     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8067     MOVE AM-STATE               TO PB-SV-STATE.
  8068     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8069
  8070     IF AM-CANCEL-FEE  NOT NUMERIC
  8071        MOVE ZEROS TO AM-CANCEL-FEE.
  8072
  8073     IF AM-MAX-MON-BEN NOT NUMERIC
  8074        MOVE ZEROS TO AM-MAX-MON-BEN.
  8075
  8076     IF AM-MAX-TOT-BEN NOT NUMERIC
  8077        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8078
  8079     IF AM-CLP-TOL-PCT NOT NUMERIC
  8080        MOVE +0                  TO AM-CLP-TOL-PCT
  8081     END-IF
  8082     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8083        MOVE +0                  TO AM-SPP-LEASE-COMM
  8084     END-IF
  8085     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8086        MOVE ER-2611             TO   WS-ERROR
  8087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8088
  8089     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8090        MOVE ER-2621             TO   WS-ERROR
  8091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8092
  8093     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8094        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8095        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8096        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8097         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8098
  8099     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8100     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8101     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8102     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8103     IF AM-CLP-TOL-PCT NOT = ZEROS
  8104        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8105     END-IF
  8106     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8107        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8108     END-IF
  8109*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8110*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8111*                                   WS-ADMIN-FEES
  8112*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8113*          (SUB5 > +10)
  8114*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8115*             AND (AM-A-COM (SUB5) NUMERIC)
  8116*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8117*                + (AM-A-COM (SUB5) * 1000)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 149
* EL050.cbl
  8118*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8119*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8120*                + (AM-A-COM (SUB5) * 1000)
  8121*             END-IF
  8122*             IF AM-COM-TYP (SUB5) = 'N'
  8123*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8124*                + (AM-A-COM (SUB5) * 1000)
  8125*             END-IF
  8126*          END-IF
  8127*       END-PERFORM
  8128*    END-IF
  8129     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8130        AND (PB-ISSUE)
  8131        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8132                                    ws-cred-union-fees
  8133        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8134           (SUB5 > +10)
  8135           MOVE +0 TO WS-WK-RATE
  8136           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8137                                   'O' OR 'S')
  8138              IF (AM-A-COM (SUB5) NUMERIC)
  8139                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8140                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8141              ELSE
  8142                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8143                 IF PB-ISSUE
  8144                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8145                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8146                 ELSE
  8147                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8148                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8149                 END-IF
  8150                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8151                 MOVE ZEROS             TO WS-SUB1
  8152                                           WS-COMMISSION
  8153                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8154                 MOVE '0530'               TO CTBL-SW
  8155                 MOVE ' '                  TO WS-CTBL-READ-SW
  8156                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8157                 IF FIRST-TIME-THROUGH
  8158                    MOVE 'AA'              TO CTBL-BEN-CODE
  8159                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8160                 END-IF
  8161                 IF CTBL-TABLE-FOUND
  8162                    IF PB-ISSUE
  8163                       COMPUTE WS-COMM-CK-AMT =
  8164                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8165                    ELSE
  8166                       COMPUTE WS-COMM-CK-AMT =
  8167                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8168                    END-IF
  8169                    PERFORM 8800-GET-COMP-RATE
  8170                              THRU 8800-EXIT
  8171                 END-IF
  8172              END-IF
  8173              if am-com-typ (sub5) = 'O' or 'S'
  8174                 compute ws-cred-union-fees rounded =
  8175                    ws-cred-union-fees +
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 150
* EL050.cbl
  8176                    (pb-i-ah-premium-amt * ws-wk-rate)
  8177              else
  8178                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8179                + (WS-WK-RATE * 1000)
  8180              end-if
  8181           END-IF
  8182        END-PERFORM
  8183     END-IF
  8184     IF PB-COMPANY-ID EQUAL 'CRI'
  8185         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8186
  8187     IF PB-COMPANY-ID EQUAL 'NCL'
  8188         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8189     END-IF
  8190
  8191     GO TO 0200-READ-CERT.
  8192
  8193 0199-ACCT-NOT-FOUND.
  8194
  8195     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8196
  8197     IF DATE-RANGE-SW NOT = SPACES
  8198        MOVE ER-2601             TO WS-ERROR
  8199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8200     ELSE
  8201        MOVE ER-2619             TO WS-ERROR
  8202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8203
  8204     GO TO 9990-RETURN.
  8205
  8206 0200-READ-CERT.
  8207
  8208     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8209     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8210     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8211     MOVE PB-SV-STATE            TO CERT-STATE.
  8212     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8213     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8214     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8215
  8216     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8217
  8218     IF CERT-WAS-NOT-FOUND
  8219        GO TO 0299-CERT-NOT-FOUND.
  8220
  8221     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8222        MOVE ER-2759             TO WS-ERROR
  8223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8224        GO TO 0298-UNLOCK-RETURN.
  8225
  8226     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8227         MOVE ER-2758            TO WS-ERROR
  8228         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8229         GO TO 0298-UNLOCK-RETURN.
  8230
  8231     IF PB-ISSUE
  8232        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8233           IF CERT-WAS-CREATED-FOR-CLAIM
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 151
* EL050.cbl
  8234              NEXT SENTENCE
  8235            ELSE
  8236              MOVE ER-2626       TO WS-ERROR
  8237              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8238              GO TO 0298-UNLOCK-RETURN.
  8239
  8240     IF NOT PB-CANCELLATION
  8241        GO TO 0300-CONTINUE-EDIT.
  8242
  8243     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8244     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8245     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8246     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8247     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8248     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8249
  8250     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8251     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8252     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8253     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8254     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8255     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8256     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8257     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8258     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8259
  8260     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8261     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8262     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8263     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8264     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8265     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8266     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8267
  8268     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8269     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8270
  8271     MOVE CM-CREDIT-INTERFACE-SW-1
  8272                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8273     MOVE CM-CREDIT-INTERFACE-SW-2
  8274                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8275
  8276     IF CM-O-B-COVERAGE
  8277         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8278
  8279     IF CM-LIVES NOT NUMERIC
  8280         MOVE ZERO                TO CM-LIVES.
  8281
  8282     IF CM-BILLED NOT NUMERIC
  8283         MOVE ZERO                TO CM-BILLED.
  8284
  8285     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8286         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8287         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8288         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8289         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8290         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8291         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 152
* EL050.cbl
  8292         MOVE CM-LIVES             TO PB-CI-LIVES
  8293*The next line causes a problem with my change  I dont think it is
  8294*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8295
  8296     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8297     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8298     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8299     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8300     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8301     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8302
  8303     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8304     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8305     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8306     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8307
  8308     IF CM-LIFE-COMM-PCT NUMERIC
  8309         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8310     ELSE
  8311         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8312
  8313     IF CM-AH-COMM-PCT NUMERIC
  8314         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8315     ELSE
  8316         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8317
  8318     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8319
  8320     IF CM-LOAN-APR       NOT NUMERIC
  8321           MOVE ZERO               TO CM-LOAN-APR.
  8322
  8323     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8324           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8325
  8326     IF CM-LOAN-TERM      NOT NUMERIC
  8327           MOVE ZERO               TO CM-LOAN-TERM.
  8328
  8329     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8330           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8331
  8332     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8333           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8334
  8335     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8336     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8337     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8338     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8339     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8340     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8341     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8342     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8343     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8344     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8345     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8346     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8347
  8348     IF CM-STATE = CM-SSN-STATE
  8349         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 153
* EL050.cbl
  8350
  8351     IF CM-STATE NOT = CM-MEMB-STATE
  8352         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8353
  8354     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8355
  8356     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8357        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8358        IF CM-ADDL-CLP NOT NUMERIC
  8359           MOVE +0               TO CM-ADDL-CLP
  8360        END-IF
  8361        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8362        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8363           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8364        END-IF
  8365     END-IF
  8366     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8367        MOVE +0                  TO WS-ADMIN-FEES
  8368                                    WS-CSO-ADMIN-FEE
  8369                                    WS-COMM-AND-MFEE
  8370                                    WS-1ST-YR-ALLOW
  8371        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8372           (SUB5 > +10)
  8373           MOVE +0 TO WS-WK-RATE
  8374           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8375              IF (AM-A-COM (SUB5) NUMERIC)
  8376                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8377                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8378              ELSE
  8379                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8380                 IF PB-ISSUE
  8381                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8382                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8383                 ELSE
  8384                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8385                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8386                 END-IF
  8387                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8388                 MOVE ZEROS             TO WS-SUB1
  8389                                           WS-COMMISSION
  8390                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8391                 MOVE '0530'               TO CTBL-SW
  8392                 MOVE ' '                  TO WS-CTBL-READ-SW
  8393                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8394                 IF FIRST-TIME-THROUGH
  8395                    MOVE 'AA'              TO CTBL-BEN-CODE
  8396                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8397                 END-IF
  8398                 IF CTBL-TABLE-FOUND
  8399                    IF PB-ISSUE
  8400                       COMPUTE WS-COMM-CK-AMT =
  8401                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8402                    ELSE
  8403                       COMPUTE WS-COMM-CK-AMT =
  8404                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8405                    END-IF
  8406                    PERFORM 8800-GET-COMP-RATE
  8407                              THRU 8800-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 154
* EL050.cbl
  8408                 END-IF
  8409              END-IF
  8410              IF AM-COM-TYP (SUB5) = 'I'
  8411                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8412                   + (WS-WK-RATE * 1000)
  8413              END-IF
  8414              IF AM-COM-TYP (SUB5) = 'N'
  8415                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8416                   + (WS-WK-RATE * 1000)
  8417              END-IF
  8418              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8419                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8420                   + (WS-WK-RATE * 1000)
  8421              END-IF
  8422              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8423                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8424                   + (WS-WK-RATE * 1000)
  8425              END-IF
  8426           END-IF
  8427        END-PERFORM
  8428     END-IF
  8429     GO TO 0300-CONTINUE-EDIT.
  8430
  8431 0298-UNLOCK-RETURN.
  8432      PERFORM 9250-UNLOCK-RETURN
  8433      GO TO 9990-RETURN.
  8434
  8435 0299-CERT-NOT-FOUND.
  8436
  8437     MOVE '1'                     TO CERT-STATUS-SW.
  8438
  8439     IF PB-COMPANY-ID = 'UCL'
  8440         IF WS-ERROR = ER-2799
  8441             GO TO 3000-CONTINUE-EDIT.
  8442
  8443     IF NOT PB-CANCELLATION
  8444         GO TO 0300-CONTINUE-EDIT.
  8445
  8446     MOVE ER-2726                  TO  WS-ERROR.
  8447     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8448     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8449     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8450                                    PB-CI-LF-TERM
  8451                                    PB-C-LF-REM-TERM
  8452                                    PB-CI-AH-TERM
  8453                                    PB-C-AH-REM-TERM
  8454                                    PB-CI-LF-BENEFIT-CD
  8455                                    PB-CI-LF-BENEFIT-AMT
  8456                                    PB-CI-LF-ALT-BENEFIT-AMT
  8457                                    PB-CI-LF-PREMIUM-AMT
  8458                                    PB-CI-LF-ALT-PREMIUM-AMT
  8459                                    PB-CI-AH-BENEFIT-CD
  8460                                    PB-CI-AH-BENEFIT-AMT
  8461                                    PB-CI-AH-PREMIUM-AMT
  8462                                    PB-CI-PAY-FREQUENCY
  8463                                    PB-CI-LOAN-APR
  8464                                    PB-CI-LOAN-TERM
  8465                                    PB-CI-LIFE-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 155
* EL050.cbl
  8466                                    PB-CI-AH-COMMISSION
  8467                                    PB-CI-CURR-SEQ
  8468                                    PB-CI-AH-CANCEL-AMT
  8469                                    PB-CI-LF-CANCEL-AMT
  8470                                    PB-CI-RATE-DEV-PCT-LF
  8471                                    PB-CI-RATE-DEV-PCT-AH
  8472                                    PB-CI-EXTENTION-DAYS
  8473                                    PB-CI-TERM-IN-DAYS
  8474                                    PB-CI-LIVES
  8475                                    PB-CI-LF-CRIT-PER
  8476                                    PB-CI-AH-CRIT-PER
  8477                                    PB-CI-ADDL-CLP
  8478                                    PB-CI-DDF-IU-RATE-UP.
  8479
  8480     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8481                                    PB-CI-AH-SETTLEMENT-DT
  8482                                    PB-CI-DEATH-DT
  8483                                    PB-CI-LF-PRIOR-CANCEL-DT
  8484                                    PB-CI-AH-PRIOR-CANCEL-DT
  8485                                    PB-CI-ENTRY-DT
  8486                                    PB-CI-LF-EXPIRE-DT
  8487                                    PB-CI-AH-EXPIRE-DT
  8488                                    PB-CI-LOAN-1ST-PMT-DT.
  8489
  8490     IF ACCOUNT-MAST-FOUND
  8491        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8492        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8493
  8494
  8495 0300-CONTINUE-EDIT.
  8496
  8497     IF PB-ISSUE
  8498        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8499            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8500
  8501     IF PB-ISSUE
  8502        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8503            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8504
  8505     IF PB-ISSUE
  8506       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8507          (AM-NO-AH-ONLY)
  8508           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8509               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8510                   MOVE ER-2679 TO WS-ERROR
  8511                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8512
  8513     IF PB-ISSUE
  8514        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8515        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8516        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8517     ELSE
  8518        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8519        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8520        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8521
  8522     MOVE 'N'                    TO PLAN-MASTER-SW
  8523                                    PLAN-MASTER-LIFE-SW
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 156
* EL050.cbl
  8524                                    FORM-MASTER-SW
  8525                                    WS-APP-CERT-SW.
  8526
  8527     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8528                                    WS-PL-TOL-LF-REFUND
  8529                                    WS-PL-REF-OVS-AMT
  8530                                    WS-PL-TOL-LF-PREM-PCT
  8531                                    WS-PL-TOL-LF-REFUND-PCT
  8532                                    WS-PL-REF-OVS-PCT
  8533                                    WS-PL-TOL-LF-CLAIM.
  8534
  8535     IF PB-COMPANY-ID = 'NCL'
  8536       IF PB-ISSUE
  8537         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8538             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8539             IF FORM-MASTER-FOUND
  8540                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8541
  8542     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8543        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8544
  8545********************** MON CODE **********************
  8546     IF PB-COMPANY-ID = 'MON'
  8547     IF PB-ISSUE
  8548     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8549        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8550             PB-I-LOAN-APR = ZERO)
  8551               MOVE 14.0         TO PB-I-LOAN-APR.
  8552******************************************************
  8553
  8554     IF PB-COMPANY-ID = 'NCL'
  8555       IF PB-ISSUE
  8556           IF FORM-MASTER-FOUND
  8557             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8558                AM-DISMBR-COVERAGE
  8559                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8560                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8561                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8562                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8563                                           PB-I-LIFE-BENEFIT-CD.
  8564
  8565     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8566
  8567     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8568         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8569         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8570         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8571         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8572         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8573           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8574             GO TO 0301-LIFE-BENEFIT-SEARCH
  8575         ELSE
  8576             NEXT SENTENCE
  8577     ELSE
  8578         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8579
  8580     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8581     MOVE '4'                    TO CNTL-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 157
* EL050.cbl
  8582     MOVE +0                     TO CNTL-SEQ-NO.
  8583     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8584
  8585     MOVE '1' TO RC-SW-2.
  8586     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8587
  8588     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8589        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8590         GO TO 0305-BENEFIT-NOT-FOUND.
  8591
  8592     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8593
  8594 0301-LIFE-BENEFIT-SEARCH.
  8595
  8596     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8597
  8598     IF NO-BENEFIT-FOUND
  8599        GO TO 0305-BENEFIT-NOT-FOUND.
  8600
  8601     IF WS-BEN-CD = '99'
  8602        GO TO 0305-BENEFIT-NOT-FOUND.
  8603
  8604     IF PB-COMPANY-ID = 'NCL'
  8605         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8606             GO TO 0304-LIFE-BENEFIT-FOUND.
  8607
  8608     MOVE +1                     TO SUB5.
  8609     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8610
  8611* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8612* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8613     IF PB-COMPANY-ID = 'DMD'
  8614         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8615
  8616 0302-EDIT-ACCT-LF-BENEFITS.
  8617
  8618     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8619        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8620           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8621                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8622           GO TO 03XX-GET-LIFE-ERPLAN.
  8623
  8624     IF SUB5 LESS THAN +20
  8625        ADD +1                   TO SUB5
  8626        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8627
  8628     MOVE +1                     TO SUB5.
  8629
  8630     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8631        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8632
  8633 0303-EDIT-DMD-EXTRA-BENEFITS.
  8634
  8635     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8636        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8637           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8638                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8639           GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 158
* EL050.cbl
  8640
  8641     IF SUB5 LESS THAN +30
  8642        ADD +1                   TO SUB5
  8643        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8644
  8645     MOVE +1                     TO SUB5.
  8646
  8647 03XX-EDIT-FOR-NINETY-LF.
  8648
  8649***************************************************************
  8650*                                                             *
  8651*    NINETY BENEFIT PLAN TYPES:                               *
  8652*                                                             *
  8653*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8654*      92 = ALL GROUP REDUCING BENEFITS                       *
  8655*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8656*      94 = ALL GROUP LEVEL BENEFITS                          *
  8657*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8658*           BENEFIT CONTROLS.                                 *
  8659*      99 = ALL BENEFITS                                      *
  8660*                                                             *
  8661***************************************************************
  8662
  8663     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8664                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8665
  8666     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8667       AND
  8668        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8669        GO TO 03XX-GET-LIFE-ERPLAN.
  8670
  8671     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8672       AND
  8673        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8674        IF CF-REDUCING (SUB3)
  8675           IF (PB-I-INDV-GRP-OVRD = 'I')
  8676              OR
  8677           ((AM-IG = '1') AND
  8678           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8679              OR
  8680           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8681           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8682           (AM-IG NOT = '2'))
  8683              GO TO 03XX-GET-LIFE-ERPLAN.
  8684
  8685     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8686       AND
  8687        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8688        IF CF-REDUCING (SUB3)
  8689           IF (PB-I-INDV-GRP-OVRD = 'G')
  8690              OR
  8691           ((AM-IG = '2') AND
  8692           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8693              OR
  8694           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8695           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8696           (AM-IG NOT = '1'))
  8697              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 159
* EL050.cbl
  8698
  8699     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8700       AND
  8701        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8702        IF CF-LEVEL    (SUB3)
  8703           IF (PB-I-INDV-GRP-OVRD = 'I')
  8704              OR
  8705           ((AM-IG = '1') AND
  8706           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8707              OR
  8708           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8709           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8710            (AM-IG NOT = '2'))
  8711              GO TO 03XX-GET-LIFE-ERPLAN.
  8712
  8713     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8714       AND
  8715        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8716        IF CF-LEVEL    (SUB3)
  8717           IF (PB-I-INDV-GRP-OVRD = 'G')
  8718              OR
  8719           ((AM-IG = '2') AND
  8720           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8721              OR
  8722           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8723           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8724           (AM-IG NOT = '1'))
  8725              GO TO 03XX-GET-LIFE-ERPLAN.
  8726
  8727     IF SUB5 LESS THAN +20
  8728        ADD +1                   TO SUB5
  8729        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8730
  8731     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8732
  8733     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8734        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8735
  8736     MOVE +1                     TO SUB5.
  8737
  8738 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8739
  8740     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8741                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8742
  8743     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8744       AND
  8745        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8746        GO TO 03XX-GET-LIFE-ERPLAN.
  8747
  8748     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8749       AND
  8750        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8751        IF CF-REDUCING (SUB3)
  8752           IF (PB-I-INDV-GRP-OVRD = 'I')
  8753              OR
  8754           ((AM-IG = '1') AND
  8755           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 160
* EL050.cbl
  8756              OR
  8757           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8758           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8759           (AM-IG NOT = '2'))
  8760              GO TO 03XX-GET-LIFE-ERPLAN.
  8761
  8762     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8763       AND
  8764        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8765        IF CF-REDUCING (SUB3)
  8766           IF (PB-I-INDV-GRP-OVRD = 'G')
  8767              OR
  8768           ((AM-IG = '2') AND
  8769           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8770              OR
  8771           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8772           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8773           (AM-IG NOT = '1'))
  8774              GO TO 03XX-GET-LIFE-ERPLAN.
  8775
  8776     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8777       AND
  8778        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8779        IF CF-LEVEL    (SUB3)
  8780           IF (PB-I-INDV-GRP-OVRD = 'I')
  8781              OR
  8782           ((AM-IG = '1') AND
  8783           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8784              OR
  8785           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8786           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8787            (AM-IG NOT = '2'))
  8788              GO TO 03XX-GET-LIFE-ERPLAN.
  8789
  8790     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8791       AND
  8792        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8793        IF CF-LEVEL    (SUB3)
  8794           IF (PB-I-INDV-GRP-OVRD = 'G')
  8795              OR
  8796           ((AM-IG = '2') AND
  8797           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8798              OR
  8799           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8800           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8801           (AM-IG NOT = '1'))
  8802              GO TO 03XX-GET-LIFE-ERPLAN.
  8803
  8804     IF SUB5 LESS THAN +30
  8805        ADD +1                   TO SUB5
  8806        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8807
  8808     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8809
  8810 03XX-EDIT-FOR-NINETY-LF-CONT.
  8811
  8812     MOVE +99                    TO SUB5.
  8813
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 161
* EL050.cbl
  8814     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8815        IF PB-ISSUE
  8816           MOVE ER-1924          TO  WS-ERROR
  8817           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8818
  8819     GO TO 0304-LIFE-BENEFIT-FOUND.
  8820
  8821 03XX-GET-LIFE-ERPLAN.
  8822
  8823     IF WK-PLAN-ADDR EQUAL +0
  8824        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8825
  8826     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8827     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8828     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8829     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8830     MOVE 'Y'                    TO PLAN-MASTER-SW
  8831                                    PLAN-MASTER-LIFE-SW.
  8832     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8833
  8834 03XX-ERPLAN-LIFE-GETMAIN.
  8835
  8836     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8837     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8838
  8839 03XX-ERPLAN-LIFE-READ.
  8840
  8841     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8842     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8843     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8844     MOVE PB-SV-STATE            TO PLAN-STATE.
  8845     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8846     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8847     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8848     MOVE WS-SAVE-BENEFIT-REVISION
  8849                                 TO PLAN-REVISION-NO.
  8850
  8851     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8852     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8853
  8854     IF PB-COMPANY-ID = 'NCL'
  8855       IF NOT LF-PLAN-MASTER-FOUND
  8856         IF NOT PB-POLICY-IS-DECLINED  AND
  8857            NOT PB-POLICY-IS-VOIDED
  8858             MOVE  ER-1921         TO  WS-ERROR
  8859             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8860             GO TO 0304-LIFE-BENEFIT-FOUND.
  8861
  8862     IF NOT LF-PLAN-MASTER-FOUND
  8863        GO TO 0304-LIFE-BENEFIT-FOUND.
  8864
  8865 XXXX-CHECK-LF-PLAN-KEY.
  8866
  8867     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8868        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8869        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8870        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8871        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 162
* EL050.cbl
  8872        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8873        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8874        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8875        MOVE 'N'                 TO PLAN-MASTER-SW
  8876          GO TO 03XX-ERPLAN-LIFE-READ.
  8877
  8878     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8879
  8880     IF  PB-CANCELLATION
  8881         GO TO  0303-LF-ACCT-BEN-FOUND.
  8882
  8883     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8884        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8885           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8886           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8887              MOVE ER-2644             TO WS-ERROR
  8888              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8889           ELSE
  8890              NEXT SENTENCE
  8891        ELSE
  8892           IF PB-COMPANY-ID NOT = 'NCL'
  8893              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8894                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8895
  8896 0303-LF-ACCT-BEN-FOUND.
  8897
  8898     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8899
  8900     IF PL-DEV-CODE NOT = SPACES
  8901        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8902
  8903     IF PL-DEV-PCT NUMERIC AND
  8904        PL-DEV-PCT NOT = ZEROS
  8905        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8906
  8907     IF PL-TOL-PREM-AMT GREATER THAN +0
  8908        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8909
  8910     IF PL-TOL-REF-AMT GREATER THAN +0
  8911        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8912
  8913     IF PL-TOL-PREM-PCT GREATER THAN +0
  8914        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8915
  8916     IF PL-TOL-REF-PCT GREATER THAN +0
  8917        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8918
  8919     IF PL-TOL-CLM-AMT GREATER THAN +0
  8920        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8921
  8922     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8923                          PL-OVER-SHORT-AMT > +0
  8924        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8925
  8926     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8927                          PL-OVER-SHORT-PCT > +0
  8928        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8929
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 163
* EL050.cbl
  8930     IF PL-SALES-TAX NUMERIC AND
  8931                          PL-SALES-TAX > +0
  8932         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8933
  8934     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8935        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8936                                    WS-IG-OVRD-AM.
  8937
  8938 0304-LIFE-BENEFIT-FOUND.
  8939
  8940     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8941
  8942     IF PB-ISSUE
  8943        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8944     ELSE
  8945        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8946
  8947     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8948     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8949     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8950     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8951     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8952                                         WS-LF-REFUND-CALC.
  8953     if (ws-lf-earnings-calc = '5')
  8954        and (pb-i-loan-apr = zeros)
  8955        and (benefit-code-chg)
  8956        move +99.9999 to pb-i-loan-apr
  8957     end-if
  8958
  8959     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8960        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8961
  8962     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8963        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8964     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8965
  8966     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8967     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8968     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8969     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8970     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8971     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8972
  8973     IF PB-COMPANY-ID = 'NCL'  AND
  8974        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8975         NEXT SENTENCE
  8976     ELSE
  8977         IF SUB5 NOT GREATER THAN +20
  8978            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8979               MOVE WS-SAVE-BENEFIT-REM-TERM
  8980                                      TO WS-AM-LF-BENE-REM-TERM
  8981                                         EC-BR-LF-REM-TERM-CALC.
  8982
  8983     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8984     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8985
  8986     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8987
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 164
* EL050.cbl
  8988 0305-BENEFIT-NOT-FOUND.
  8989
  8990     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8991     MOVE ER-2604                TO WS-ERROR.
  8992     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8993
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 165
* EL050.cbl
  8995
  8996 0310-FIND-AH-BENEFIT-RECORD.
  8997
  8998     MOVE 'N'                    TO PLAN-MASTER-SW
  8999                                    PLAN-MASTER-AH-SW.
  9000
  9001     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9002                                    WS-PL-TOL-AH-REFUND
  9003                                    WS-AH-PL-REF-OVS-AMT
  9004                                    WS-PL-TOL-AH-PREM-PCT
  9005                                    WS-PL-TOL-AH-REFUND-PCT
  9006                                    WS-AH-PL-REF-OVS-PCT
  9007                                    WS-PL-TOL-AH-CLAIM.
  9008     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9009
  9010
  9011     if pb-issue
  9012        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9013           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9014        end-if
  9015        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9016           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9017           GO TO 0399-BENEFIT-NOT-FOUND
  9018        end-if
  9019     end-if
  9020
  9021     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9022        GO TO 0400-FIND-CARRIER.
  9023
  9024     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9025
  9026     IF WK-AH-BEN-ADDR NOT = ZEROS
  9027         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9028         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9029         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9030         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9031           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9032             GO TO 0311-AH-BENEFIT-SEARCH
  9033         ELSE
  9034             NEXT SENTENCE
  9035     ELSE
  9036         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9037
  9038     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9039     MOVE '5'                    TO CNTL-REC-TYPE.
  9040     MOVE +0                     TO CNTL-SEQ-NO.
  9041     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9042
  9043     MOVE '2' TO RC-SW-2.
  9044     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9045
  9046     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9047        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9048          GO TO 0399-BENEFIT-NOT-FOUND.
  9049
  9050     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9051
  9052 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 166
* EL050.cbl
  9053
  9054     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9055
  9056     IF NO-BENEFIT-FOUND
  9057         GO TO 0399-BENEFIT-NOT-FOUND.
  9058
  9059     IF WS-BEN-CD = '99'
  9060        GO TO 0399-BENEFIT-NOT-FOUND.
  9061
  9062     IF PB-COMPANY-ID  =  'NCL'
  9063         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9064             GO TO 0314-A-H-BENEFIT-FOUND.
  9065
  9066     MOVE +1                     TO SUB5.
  9067     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9068
  9069* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9070* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9071     IF PB-COMPANY-ID = 'DMD'
  9072         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9073
  9074 0312-EDIT-ACCT-AH-BENEFITS.
  9075
  9076     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9077        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9078           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9079                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9080           GO TO 03XX-GET-AH-ERPLAN.
  9081
  9082     IF SUB5 LESS THAN +20
  9083        ADD +1                   TO SUB5
  9084        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9085
  9086     MOVE +1                     TO SUB5.
  9087
  9088     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9089        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9090
  9091 0313-EDIT-DMD-EXTRA-BENEFITS.
  9092
  9093     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9094        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9095           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9096                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9097           GO TO 03XX-GET-AH-ERPLAN.
  9098
  9099     IF SUB5 LESS THAN +30
  9100        ADD +1                   TO SUB5
  9101        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9102
  9103     MOVE +1                     TO SUB5.
  9104
  9105 03XX-EDIT-FOR-NINETY-AH.
  9106
  9107***************************************************************
  9108*                                                             *
  9109*    NINETY BENEFIT PLAN TYPES:                               *
  9110*                                                             *
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 167
* EL050.cbl
  9111*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9112*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9113*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9114*           BENEFIT CONTROLS.                                 *
  9115*      99 = ALL BENEFITS.                                     *
  9116*                                                             *
  9117***************************************************************
  9118
  9119     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9120                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9121
  9122     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9123       AND
  9124        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9125        GO TO 03XX-GET-AH-ERPLAN.
  9126
  9127     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9128       AND
  9129        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9130           IF (PB-I-INDV-GRP-OVRD = 'I')
  9131              OR
  9132           ((AM-IG = '1') AND
  9133           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9134              OR
  9135           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9136           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9137           (AM-IG NOT = '2'))
  9138              GO TO 03XX-GET-AH-ERPLAN.
  9139
  9140     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9141       AND
  9142        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9143           IF (PB-I-INDV-GRP-OVRD = 'G')
  9144              OR
  9145           ((AM-IG = '2') AND
  9146           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9147              OR
  9148           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9149           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9150           (AM-IG NOT = '1'))
  9151              GO TO 03XX-GET-AH-ERPLAN.
  9152
  9153     IF SUB5 LESS THAN +20
  9154        ADD +1                   TO SUB5
  9155        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9156
  9157     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9158        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9159
  9160     MOVE +1                    TO SUB5.
  9161
  9162 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9163
  9164     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9165                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9166
  9167     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9168       AND
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 168
* EL050.cbl
  9169        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9170        GO TO 03XX-GET-AH-ERPLAN.
  9171
  9172     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9173       AND
  9174        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9175           IF (PB-I-INDV-GRP-OVRD = 'I')
  9176              OR
  9177           ((AM-IG = '1') AND
  9178           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9179              OR
  9180           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9181           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9182           (AM-IG NOT = '2'))
  9183              GO TO 03XX-GET-AH-ERPLAN.
  9184
  9185     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9186       AND
  9187        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9188           IF (PB-I-INDV-GRP-OVRD = 'G')
  9189              OR
  9190           ((AM-IG = '2') AND
  9191           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9192              OR
  9193           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9194           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9195           (AM-IG NOT = '1'))
  9196              GO TO 03XX-GET-AH-ERPLAN.
  9197
  9198     IF SUB5 LESS THAN +30
  9199        ADD +1                   TO SUB5
  9200        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9201
  9202 03XX-EDIT-FOR-NINETY-AH-CONT.
  9203
  9204     MOVE +99                    TO SUB5.
  9205
  9206     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9207
  9208     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9209        IF PB-ISSUE
  9210           MOVE ER-1925          TO  WS-ERROR
  9211           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9212
  9213     GO TO 0314-A-H-BENEFIT-FOUND.
  9214
  9215 03XX-GET-AH-ERPLAN.
  9216
  9217     IF WK-PLAN-ADDR EQUAL +0
  9218         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9219
  9220     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9221     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9222     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9223     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9224     MOVE 'Y'                    TO PLAN-MASTER-SW
  9225                                    PLAN-MASTER-AH-SW.
  9226*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 169
* EL050.cbl
  9227     GO TO 03XX-ERPLAN-AH-READ.
  9228
  9229 03XX-ERPLAN-AH-GETMAIN.
  9230
  9231     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9232     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9233
  9234 03XX-ERPLAN-AH-READ.
  9235
  9236     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9237     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9238     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9239     MOVE PB-SV-STATE            TO PLAN-STATE.
  9240     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9241     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9242     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9243     MOVE WS-SAVE-BENEFIT-REVISION
  9244                                 TO PLAN-REVISION-NO.
  9245
  9246     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9247     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9248
  9249     IF PB-COMPANY-ID = 'NCL'
  9250       IF NOT AH-PLAN-MASTER-FOUND
  9251         IF NOT PB-POLICY-IS-DECLINED  AND
  9252            NOT PB-POLICY-IS-VOIDED
  9253             MOVE  ER-1922         TO  WS-ERROR
  9254             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9255             GO TO 0314-A-H-BENEFIT-FOUND.
  9256
  9257     IF NOT AH-PLAN-MASTER-FOUND
  9258        GO TO 0314-A-H-BENEFIT-FOUND.
  9259
  9260 XXXX-CHECK-AH-PLAN-KEY.
  9261
  9262     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9263        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9264        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9265        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9266        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9267        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9268        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9269        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9270        MOVE 'N'                 TO PLAN-MASTER-SW
  9271          GO TO 03XX-ERPLAN-AH-READ.
  9272
  9273     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9274
  9275     IF  PB-CANCELLATION
  9276         GO TO  0313-AH-ACCT-BEN-FOUND.
  9277
  9278     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9279       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9280          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9281          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9282             MOVE ER-2644             TO WS-ERROR
  9283             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9284          ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 170
* EL050.cbl
  9285             NEXT SENTENCE
  9286       ELSE
  9287          IF PB-COMPANY-ID NOT = 'NCL'
  9288             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9289                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9290
  9291 0313-AH-ACCT-BEN-FOUND.
  9292
  9293     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9294
  9295     IF PL-DEV-CODE NOT = SPACES
  9296        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9297
  9298     IF PL-DEV-PCT NUMERIC AND
  9299        PL-DEV-PCT NOT = ZEROS
  9300        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9301
  9302     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9303        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9304
  9305     IF PL-TOL-REF-AMT NOT EQUAL +0
  9306        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9307
  9308     IF PL-TOL-PREM-PCT GREATER THAN +0
  9309        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9310
  9311     IF PL-TOL-REF-PCT GREATER THAN +0
  9312        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9313
  9314     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9315        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9316
  9317     IF PL-OVER-SHORT-AMT NUMERIC AND
  9318                          PL-OVER-SHORT-AMT > +0
  9319        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9320
  9321     IF PL-OVER-SHORT-PCT NUMERIC AND
  9322                          PL-OVER-SHORT-PCT > +0
  9323        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9324
  9325     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9326        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9327        IF WS-IG-OVRD-AM EQUAL SPACES
  9328            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9329
  9330 0314-A-H-BENEFIT-FOUND.
  9331
  9332     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9333
  9334     IF PB-ISSUE
  9335        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9336       ELSE
  9337        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9338
  9339     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9340     if cf-maximum-benefits (sub3) numeric
  9341        move cf-maximum-benefits (sub3)
  9342                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 171
* EL050.cbl
  9343     else
  9344        move zeros               to ws-ah-max-bens
  9345     end-if
  9346     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9347     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9348     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9349                                         WS-AH-REFUND-CALC.
  9350
  9351     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9352        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9353
  9354     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9355        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9356     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9357
  9358     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9359     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9360     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9361     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9362     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9363     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9364
  9365     IF PB-COMPANY-ID = 'NCL'  AND
  9366        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9367         NEXT SENTENCE
  9368     ELSE
  9369         IF SUB5 NOT GREATER THAN +20
  9370            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9371                MOVE WS-SAVE-BENEFIT-REM-TERM
  9372                                      TO WS-AM-AH-BENE-REM-TERM
  9373                                         EC-BR-AH-REM-TERM-CALC.
  9374
  9375     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9376     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9377
  9378     GO TO 0400-FIND-CARRIER.
  9379
  9380 0399-BENEFIT-NOT-FOUND.
  9381
  9382     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9383     MOVE ER-2605                TO WS-ERROR.
  9384     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9385
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 172
* EL050.cbl
  9387
  9388 0400-FIND-CARRIER.
  9389
  9390     MOVE PB-SV-CARRIER          TO WS-CARR.
  9391
  9392     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9393     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9394     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9395     MOVE '6'                    TO CNTL-REC-TYPE.
  9396
  9397*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9398     MOVE SPACE                  TO WS-DMD-RATING-SW
  9399                                    EC-BR-DMD-RATING-SW.
  9400
  9401     MOVE '2'                    TO RC-SW-1.
  9402     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9403
  9404     IF NOT CF-CARRIER-MASTER
  9405        GO TO 0400-CARRIER-NOT-FOUND.
  9406
  9407 0400-BUILD-CARR-TOL.
  9408
  9409     IF CF-CR-TOL-PREM NUMERIC AND
  9410        CF-CR-TOL-PREM GREATER THAN +0
  9411        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9412                                    WS-TOL-AH-PREM.
  9413
  9414     IF CF-CR-TOL-REFUND NUMERIC AND
  9415        CF-CR-TOL-REFUND GREATER THAN +0
  9416        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9417                                    WS-TOL-AH-REFUND.
  9418
  9419     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9420        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9421        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9422                                    WS-AH-REFUND-OVS-AMT.
  9423
  9424     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9425        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9426        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9427                                    WS-AH-REFUND-OVS-PCT.
  9428
  9429     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9430        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9431        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9432                                    WS-TOL-AH-PREM-PCT.
  9433
  9434     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9435        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9436        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9437                                     WS-TOL-AH-REFUND-PCT.
  9438
  9439     IF CF-COMPANY-ID EQUAL 'DMD'
  9440         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9441                                    EC-BR-DMD-RATING-SW.
  9442
  9443     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9444     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 173
* EL050.cbl
  9445        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9446     END-IF
  9447     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9448        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9449     END-IF
  9450     IF WS-TOL-CLP-PCT = ZEROS
  9451        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9452     END-IF
  9453
  9454     IF WS-SPP-LEASE-COMM = ZEROS
  9455        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9456     END-IF
  9457     GO TO 0400-FIND-ERPDEF.
  9458
  9459 0400-CARRIER-NOT-FOUND.
  9460
  9461     MOVE ER-2602                TO WS-ERROR.
  9462     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9463
  9464 0400-FIND-ERPDEF.
  9465*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9466     IF (PB-COMPANY-ID = 'DCC')
  9467        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9468        CONTINUE
  9469     ELSE
  9470        GO TO 0400-FIND-ERCOMP
  9471     END-IF
  9472     MOVE ' '                    TO PDEF-MASTER-SW
  9473     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9474     MOVE PB-STATE               TO ERPDEF-STATE
  9475     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9476        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9477     END-IF
  9478     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9479     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9480     IF PB-ISSUE
  9481        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9482     ELSE
  9483        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9484     END-IF
  9485     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9486     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9487     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9488     IF PDEF-MASTER-FOUND
  9489        MOVE 'N'                 TO PDEF-MASTER-SW
  9490        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9491        IF PDEF-MASTER-FOUND
  9492           IF (ERPDEF-KEY-SAVE (1:16) =
  9493                        PD-CONTROL-PRIMARY (1:16))
  9494              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9495              CONTINUE
  9496           ELSE
  9497              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9498              IF (ERPDEF-KEY-SAVE (1:16) =
  9499                        PD-CONTROL-PRIMARY (1:16))
  9500                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9501                 CONTINUE
  9502              ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 174
* EL050.cbl
  9503                 MOVE 'N'        TO PDEF-MASTER-SW
  9504              END-IF
  9505           END-IF
  9506        END-IF
  9507        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9508     END-IF
  9509     IF PDEF-MASTER-FOUND
  9510        IF PD-TRUNCATED = 'Y'
  9511           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9512        END-IF
  9513     END-IF
  9514     .
  9515 0400-FIND-ERCOMP.
  9516     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9517        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9518           (WS-SUB1 > +10)
  9519           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9520                 OR 'A' OR 'N'
  9521              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9522              MOVE PB-CARRIER    TO COMP-CARRIER
  9523              MOVE PB-GROUPING   TO COMP-GROUPING
  9524              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9525              MOVE AM-AGT (WS-SUB1)
  9526                                 TO COMP-FIN-RESP
  9527              MOVE 'G'           TO COMP-TYPE
  9528              PERFORM 8582-READ-COMPENSATION-MASTER
  9529                                 THRU 8582-EXIT
  9530              IF COMP-MASTER-FOUND
  9531                 IF CO-GA-INACTIVE
  9532                    MOVE ER-2763 TO WS-ERROR
  9533                    PERFORM 9900-ERROR-FORMAT
  9534                                 THRU 9900-EXIT
  9535                    MOVE +11     TO WS-SUB1
  9536                 END-IF
  9537                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9538                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9539                    MOVE ER-2788 TO WS-ERROR
  9540                    PERFORM 9900-ERROR-FORMAT
  9541                                 THRU 9900-EXIT
  9542                    MOVE +11     TO WS-SUB1
  9543                 END-IF
  9544              END-IF
  9545           END-IF
  9546        END-PERFORM
  9547     END-IF
  9548     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9549        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9550           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9551                                    WS-CLP-STATE
  9552        ELSE
  9553           MOVE SPACES           TO PB-I-CLP-STATE
  9554                                    WS-CLP-STATE
  9555        END-IF
  9556     END-IF
  9557
  9558     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9559        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9560        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 175
* EL050.cbl
  9561        CONTINUE
  9562     ELSE
  9563        GO TO 0400-FIND-STATE-RECORD
  9564     END-IF
  9565     MOVE SPACES                 TO WS-CLP-STATE
  9566     MOVE +0                     TO WS-BANK-FEE
  9567                                    WS-BANK-LFEE
  9568                                    WS-BANK-NOCHRGB
  9569
  9570     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9571     IF (PB-ISSUE)
  9572        AND (PB-I-BANK-NUMBER NOT =
  9573            SPACES AND ZEROS AND LOW-VALUES)
  9574        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9575     ELSE
  9576        IF (PB-CANCELLATION)
  9577           AND (PB-CI-BANK-NUMBER NOT =
  9578                SPACES AND ZEROS AND LOW-VALUES)
  9579           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9580        END-IF
  9581     END-IF
  9582     IF COMP-FIN-RESP NOT = LOW-VALUES
  9583        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9584        MOVE PB-CARRIER          TO COMP-CARRIER
  9585        MOVE PB-GROUPING         TO COMP-GROUPING
  9586        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9587        MOVE 'B'                 TO COMP-TYPE
  9588        PERFORM 8582-READ-COMPENSATION-MASTER
  9589                                 THRU 8582-EXIT
  9590        IF COMP-MASTER-FOUND
  9591           IF CO-MAX-BANK-FEE NOT NUMERIC
  9592              MOVE +0            TO CO-MAX-BANK-FEE
  9593           END-IF
  9594           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9595              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9596           END-IF
  9597           IF CO-GA-INACTIVE
  9598              MOVE ER-2763       TO WS-ERROR
  9599              PERFORM 9900-ERROR-FORMAT
  9600                                 THRU 9900-EXIT
  9601           END-IF
  9602           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9603              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9604              MOVE ER-2788 TO WS-ERROR
  9605              PERFORM 9900-ERROR-FORMAT
  9606                                 THRU 9900-EXIT
  9607              MOVE +11     TO WS-SUB1
  9608           END-IF
  9609           IF WS-AH-BEN-CATEGORY = 'G'
  9610              MOVE CO-MAX-BANK-FEE
  9611                                 TO WS-BANK-FEE
  9612                                    PB-I-BANK-FEE
  9613           ELSE
  9614              MOVE CO-MAX-BANK-FEE-LEASE
  9615                                 TO WS-BANK-LFEE
  9616                                    PB-I-BANK-FEE
  9617           END-IF
  9618           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 176
* EL050.cbl
  9619              AND (WS-AH-REFUND-CALC = 'G'))
  9620                        OR
  9621              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9622              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9623              CONTINUE
  9624           ELSE
  9625              MOVE ER-2789 TO WS-ERROR
  9626              PERFORM 9900-ERROR-FORMAT
  9627                                 THRU 9900-EXIT
  9628           END-IF
  9629           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9630                                    PB-I-CLP-STATE
  9631           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9632           MOVE CO-CARRIER       TO BXRF-CARRIER
  9633           MOVE CO-GROUPING      TO BXRF-GROUPING
  9634           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9635           MOVE BXRF-MAX-REC-LENGTH
  9636                                 TO BXRF-REC-LENGTH
  9637           PERFORM 8584-READ-BANK-CROSS-REF
  9638                                 THRU 8584-EXIT
  9639           IF BXRF-MASTER-FOUND
  9640              MOVE ' '           TO BANK-ACCT-SW
  9641              MOVE BK-BANK-POINTER-CNT
  9642                                 TO BK-BANK-POINTER-CNT
  9643              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9644                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9645                 OR (BANK-ACCT-FOUND)
  9646                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9647                    AND (BK-AM-EXP-DT (WS-SUB1)
  9648                                 > PB-CERT-EFF-DT)
  9649                    AND (BK-AM-EFF-DT (WS-SUB1)
  9650                                 NOT > PB-CERT-EFF-DT)
  9651                    SET BANK-ACCT-FOUND TO TRUE
  9652                 END-IF
  9653              END-PERFORM
  9654              IF NOT BANK-ACCT-FOUND
  9655                 MOVE ZEROS      TO WS-BANK-FEE
  9656                                    WS-BANK-LFEE
  9657                 MOVE ER-2869    TO WS-ERROR
  9658                 PERFORM 9900-ERROR-FORMAT
  9659                                 THRU 9900-EXIT
  9660              ELSE
  9661                 PERFORM 5000-PROCESS-REPS
  9662                                 THRU 5000-EXIT
  9663                 IF AGENT-MASTER-FOUND
  9664                    MOVE +0      TO WS-BANK-FEE
  9665                                    WS-BANK-LFEE
  9666*                   MOVE AG-SPP-FEES (1)
  9667*                                TO PB-I-BANK-FEE
  9668*                                   WS-BANK-FEE
  9669                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9670                       (WS-SUB1 > +10)
  9671                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9672                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9673                       END-IF
  9674                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9675                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9676                       END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 177
* EL050.cbl
  9677                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9678                          AG-SPP-FEES (WS-SUB1)
  9679                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9680                          AG-SPP-LFEES (WS-SUB1)
  9681                    END-PERFORM
  9682                    IF WS-AH-BEN-CATEGORY = 'G'
  9683                       MOVE WS-BANK-FEE
  9684                                 TO PB-I-BANK-FEE
  9685                    ELSE
  9686                       MOVE WS-BANK-LFEE
  9687                                 TO PB-I-BANK-FEE
  9688                    END-IF
  9689                 END-IF
  9690              END-IF
  9691           END-IF
  9692        ELSE
  9693           MOVE ER-2879          TO WS-ERROR
  9694           PERFORM 9900-ERROR-FORMAT
  9695                                 THRU 9900-EXIT
  9696        END-IF
  9697     ELSE
  9698        MOVE ER-2879             TO WS-ERROR
  9699        PERFORM 9900-ERROR-FORMAT
  9700                                 THRU 9900-EXIT
  9701     END-IF
  9702     IF WS-AH-BEN-CATEGORY = 'G'
  9703        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9704        + WS-BANK-FEE
  9705     ELSE
  9706        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9707        + WS-BANK-LFEE
  9708     END-IF
  9709     .
  9710 0400-FIND-STATE-RECORD.
  9711
  9712     IF WK-STATE-ADDR NOT = ZEROS
  9713         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9714         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9715         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9716         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9717         IF PB-SV-STATE = CF-STATE-CODE
  9718             GO TO 0405-CONTINUE-EDIT
  9719         ELSE
  9720             NEXT SENTENCE
  9721     ELSE
  9722         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9723
  9724     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9725     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9726     MOVE '3'                    TO CNTL-REC-TYPE.
  9727     MOVE +0                     TO CNTL-SEQ-NO.
  9728
  9729     MOVE '3'                    TO RC-SW-2.
  9730     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9731
  9732     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9733        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9734        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 178
* EL050.cbl
  9735        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9736                                    WS-TOL-AH-CLAIM
  9737                                    WS-MINIMUM-REFUND
  9738                                    WS-TOL-LF-PREM
  9739                                    WS-TOL-AH-PREM
  9740                                    WS-TOL-LF-REFUND
  9741                                    WS-TOL-AH-REFUND
  9742                                    EC-ST-TOL-PREM-PCT
  9743                                    WS-TOL-LF-PREM-PCT
  9744                                    WS-TOL-AH-PREM-PCT
  9745                                    EC-ST-TOL-REFUND-PCT
  9746                                    WS-TOL-LF-REFUND-PCT
  9747                                    WS-TOL-AH-REFUND-PCT
  9748                                    EC-ST-TOL-PREM
  9749                                    EC-ST-TOL-REFUND
  9750                                    EC-ST-FST-PMT-DAYS-MAX
  9751                                    WS-FREE-LOOK-PERIOD
  9752                                    WS-ST-LF-PREM-TAX
  9753                                    WS-ST-AH-PREM-TAX-I
  9754                                    WS-ST-AH-PREM-TAX-G
  9755                                    WS-BANK-FEE
  9756                                    WS-BANK-LFEE
  9757                                    WS-TOL-CLP-PCT
  9758                                    WS-SPP-LEASE-COMM
  9759                                    WS-INT-PERIODS
  9760                                    WS-EXTRA-PMTS
  9761        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9762                                    EC-ST-FST-PMT-DAYS-CHG
  9763                                    WS-LF-REM-TERM-CALC
  9764                                    WS-LF-REFUND-CALC
  9765                                    EC-ST-LF-REM-TERM-CALC
  9766                                    EC-ST-LF-REFUND-CALC
  9767                                    WS-AH-REM-TERM-CALC
  9768                                    WS-AH-REFUND-CALC
  9769                                    WS-LF-BEN-CATEGORY
  9770                                    WS-AH-BEN-CATEGORY
  9771                                    WS-CLP-STATE
  9772                                    WS-ST-REFUND-CLAIM-FLAG
  9773                                    WS-ST-CAUSAL-STATE
  9774                                    ws-st-agent-sig-edit
  9775                                    EC-ST-AH-REM-TERM-CALC
  9776                                    EC-ST-AH-REFUND-CALC
  9777          GO TO 0499-STATE-NOT-FOUND.
  9778
  9779     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9780
  9781 0405-CONTINUE-EDIT.
  9782
  9783     if pb-company-id = 'AHL'
  9784        continue
  9785     else
  9786        IF PB-CERT-PRIME NOT NUMERIC
  9787           MOVE ER-2722          TO WS-ERROR
  9788           PERFORM 9900-ERROR-FORMAT
  9789                                 THRU 9900-EXIT
  9790        end-if
  9791     END-IF
  9792*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 179
* EL050.cbl
  9793*       MOVE +0                  TO SUB3
  9794*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9795*       IF SUB3 > +0
  9796*          MOVE ER-2722          TO WS-ERROR
  9797*          PERFORM 9900-ERROR-FORMAT
  9798*                                THRU 9900-EXIT
  9799*       END-IF
  9800*    END-IF
  9801*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9802*       IF PB-CERT-PRIME NOT NUMERIC
  9803*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9804*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9805*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9806*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9807*
  9808*          MOVE ER-2722          TO WS-ERROR
  9809*          PERFORM 9900-ERROR-FORMAT
  9810*                                THRU 9900-EXIT
  9811*       END-IF
  9812*    END-IF
  9813
  9814     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9815
  9816     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9817        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9818                                    WS-TOL-AH-CLAIM.
  9819
  9820     IF CF-ST-REFUND-MIN NOT NUMERIC
  9821        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9822
  9823     IF CF-ST-REFUND-MIN NOT = ZEROS
  9824        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9825
  9826     IF CF-ST-TOL-PREM  NOT = ZEROS
  9827        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9828                                    WS-TOL-AH-PREM
  9829        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9830
  9831     IF CF-ST-TOL-REFUND NOT = ZEROS
  9832        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9833                                    WS-TOL-AH-REFUND
  9834        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9835
  9836     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9837        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9838        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9839                                    WS-AH-REFUND-OVS-AMT
  9840                                    EC-ST-OVR-SHT-AMT.
  9841
  9842     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9843        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9844        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9845                                    WS-TOL-LF-PREM-PCT
  9846                                    WS-TOL-AH-PREM-PCT.
  9847
  9848     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9849        CF-ST-TOL-REF-PCT GREATER THAN +0
  9850        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 180
* EL050.cbl
  9851                                    WS-TOL-LF-REFUND-PCT
  9852                                    WS-TOL-AH-REFUND-PCT.
  9853
  9854     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9855        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9856        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9857                                    WS-AH-REFUND-OVS-PCT
  9858                                    EC-ST-OVR-SHT-PCT.
  9859
  9860     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9861     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9862
  9863     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9864          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9865
  9866     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9867     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9868     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9869
  9870     IF CF-ST-LF-PREM-TAX NUMERIC
  9871        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9872     END-IF
  9873     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9874        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9875     END-IF
  9876     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9877        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9878     END-IF
  9879
  9880     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9881         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9882     END-IF.
  9883
  9884     IF CF-ST-CAUSAL-STATE > SPACES
  9885         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9886     END-IF.
  9887     if cf-st-extra-interest-periods not numeric
  9888        move zeros               to cf-st-extra-interest-periods
  9889     end-if
  9890     if cf-st-extra-payments not numeric
  9891        move zeros               to cf-st-extra-payments
  9892     end-if
  9893
  9894     move cf-st-extra-interest-periods
  9895                                 to ws-int-periods
  9896     move cf-st-extra-payments   to ws-extra-pmts
  9897     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9898     move cf-st-net-only-state   to ws-net-only-state
  9899     IF WS-LF-BENEFIT-CD = ZEROS
  9900        GO TO 0410-CHECK-AH.
  9901
  9902     IF CF-ST-RT-CALC NOT = SPACES
  9903        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9904                                    EC-ST-LF-REM-TERM-CALC
  9905     END-IF
  9906
  9907     IF WS-LF-COVERAGE-TYPE = 'R'
  9908        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 181
* EL050.cbl
  9909           IF CF-ST-RF-LN-CALC > '0'
  9910              MOVE CF-ST-RF-LN-CALC
  9911                                 TO WS-LF-REFUND-CALC
  9912                                    EC-ST-LF-REFUND-CALC
  9913           END-IF
  9914        ELSE
  9915           IF CF-ST-RF-LR-CALC > '0'
  9916              MOVE CF-ST-RF-LR-CALC
  9917                                 TO WS-LF-REFUND-CALC
  9918                                    EC-ST-LF-REFUND-CALC
  9919           END-IF
  9920        END-IF
  9921     ELSE
  9922        IF CF-ST-RF-LL-CALC > '0'
  9923           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9924                                    EC-ST-LF-REFUND-CALC
  9925        END-IF
  9926     END-IF
  9927
  9928     IF CF-ST-RT-CALC NOT = SPACES
  9929        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9930                                    EC-ST-LF-REM-TERM-CALC
  9931     END-IF
  9932
  9933     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9934     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9935
  9936     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9937
  9938     IF NO-BENEFIT-FOUND
  9939        GO TO 0410-CHECK-AH.
  9940
  9941     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9942        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9943                                 TO EC-ST-LF-REM-TERM-CALC
  9944                                    WS-LF-REM-TERM-CALC
  9945     END-IF
  9946
  9947     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9948        MOVE CF-ST-REFUND-CALC (SUB3)
  9949                                 TO WS-LF-REFUND-CALC
  9950                                    EC-ST-LF-REFUND-CALC
  9951     END-IF
  9952*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9953     if cf-st-extra-periods (sub3) not numeric
  9954        move zeros               to cf-st-extra-periods (sub3)
  9955     end-if
  9956     if cf-st-extra-periods (sub3) > zeros
  9957        if ws-lf-ben-category = 'P'
  9958           move cf-st-extra-periods (sub3)
  9959                                 to ws-extra-pmts
  9960        else
  9961           if ws-lf-ben-category = 'I'
  9962              move cf-st-extra-periods (sub3)
  9963                                 to ws-int-periods
  9964           end-if
  9965        end-if
  9966     end-if
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 182
* EL050.cbl
  9967     .
  9968 0410-CHECK-AH.
  9969
  9970     IF WS-AH-BENEFIT-CD = ZEROS
  9971        GO TO 0500-SET-ACCOUNT.
  9972
  9973     IF CF-ST-RT-CALC NOT = SPACES
  9974        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9975                                    EC-ST-AH-REM-TERM-CALC
  9976     END-IF
  9977
  9978     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9979        IF CF-ST-RF-CP-CALC > '0'
  9980           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9981                                    EC-ST-AH-REFUND-CALC
  9982        END-IF
  9983     ELSE
  9984        IF CF-ST-RF-AH-CALC > '0'
  9985           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9986                                    EC-ST-AH-REFUND-CALC
  9987        END-IF
  9988     END-IF
  9989     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9990     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9991
  9992     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9993
  9994     IF NO-BENEFIT-FOUND
  9995        GO TO 0500-SET-ACCOUNT.
  9996
  9997     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9998        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9999                                 TO WS-AH-REM-TERM-CALC
 10000                                    EC-ST-AH-REM-TERM-CALC
 10001     END-IF
 10002
 10003     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10004        MOVE CF-ST-REFUND-CALC (SUB3)
 10005                                 TO WS-AH-REFUND-CALC
 10006                                    EC-ST-AH-REFUND-CALC
 10007     END-IF
 10008
 10009*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10010
 10011     GO TO 0500-SET-ACCOUNT.
 10012
 10013 0499-STATE-NOT-FOUND.
 10014
 10015     MOVE ER-2603                TO WS-ERROR.
 10016     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10017
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 183
* EL050.cbl
 10019
 10020 0500-SET-ACCOUNT.
 10021*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10022     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10023        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10024        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10025        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10026        MOVE '3'                 TO CNTL-REC-TYPE
 10027        MOVE +0                  TO CNTL-SEQ-NO
 10028
 10029        MOVE '3'                 TO RC-SW-2
 10030        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10031
 10032        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10033           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10034           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10035           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10036                                    WS-ST-AH-PREM-TAX-I
 10037                                    WS-ST-AH-PREM-TAX-G
 10038        ELSE
 10039           IF CF-ST-LF-PREM-TAX NUMERIC
 10040              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10041           END-IF
 10042           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10043              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10044           END-IF
 10045           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10046              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10047           END-IF
 10048        END-IF
 10049        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10050     END-IF
 10051*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10052*  FOR DCC ONLY
 10053     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10054
 10055     MOVE ' '                    TO STAT-MASTER-SW
 10056     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10057     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10058     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10059     MOVE PB-STATE               TO ELSTAT-STATE
 10060     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10061        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10062     END-IF
 10063
 10064     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10065     SET BIN-TO-GREG             TO TRUE
 10066     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10067     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10068     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10069
 10070     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10071     IF STAT-MASTER-FOUND
 10072        MOVE 'N'                 TO STAT-MASTER-SW
 10073        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10074        IF STAT-MASTER-FOUND
 10075           IF (ELSTAT-KEY-SAVE (1:12) =
 10076                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 184
* EL050.cbl
 10077              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10078                 MOVE 'F'        TO STAT-MASTER-SW
 10079              ELSE
 10080                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10081                 IF (STAT-MASTER-FOUND)
 10082                    AND (ELSTAT-KEY-SAVE (1:12) =
 10083                        SF-CONTROL-PRIMARY (1:12))
 10084                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10085                    MOVE 'F'     TO STAT-MASTER-SW
 10086                 END-IF
 10087              END-IF
 10088           END-IF
 10089        END-IF
 10090     END-IF
 10091
 10092     IF STAT-MASTER-SW = 'F'
 10093        IF SF-ST-LF-PREM-TAX NUMERIC
 10094           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10095        END-IF
 10096        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10097           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10098        END-IF
 10099        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10100           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10101        END-IF
 10102     END-IF
 10103
 10104     END-IF
 10105     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10106        AND (PB-ISSUE)
 10107        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10108        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10109        AND (AM-GPCD = 06)
 10110        MOVE 'Y'                 TO WS-GOOD-HIN
 10111        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10112           MOVE PB-I-VIN         TO WS-WORK-VIN
 10113           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10114              (V1 > 16)
 10115              IF WS-WORK-VIN (V1:1) NUMERIC
 10116                 MOVE WS-WORK-VIN-N (V1)
 10117                                 TO WS-ROW-B-VAL (V1)
 10118              ELSE
 10119                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10120                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10121                    OR (V2 > 26)
 10122                 END-PERFORM
 10123                 IF V2 < 27
 10124                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10125                 ELSE
 10126                    MOVE 'N'     TO WS-GOOD-HIN
 10127                 END-IF
 10128              END-IF
 10129              COMPUTE WS-ROW-D-VAL (V1) =
 10130                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10131              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10132                 WS-ROW-D-VAL (V1)
 10133           END-PERFORM
 10134           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 185
* EL050.cbl
 10135           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10136             REMAINDER WS-VIN-REMAINDER
 10137           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10138              CONTINUE
 10139           ELSE
 10140              MOVE 'N'           TO WS-GOOD-HIN
 10141           END-IF
 10142        ELSE
 10143           MOVE 'N'              TO WS-GOOD-HIN
 10144        END-IF
 10145        IF WS-GOOD-HIN NOT = 'Y'
 10146           MOVE ER-3826           TO WS-ERROR
 10147           PERFORM 9900-ERROR-FORMAT
 10148                                 THRU 9900-EXIT
 10149        END-IF
 10150     END-IF
 10151     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10152        AND (PB-ISSUE)
 10153        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10154        AND (AM-GPCD NOT = 06)
 10155        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10156           perform 3400-edit-vin thru 3400-exit
 10157        ELSE
 10158          MOVE ER-3826           TO WS-ERROR
 10159          PERFORM 9900-ERROR-FORMAT
 10160                                 THRU 9900-EXIT
 10161        END-IF
 10162     END-IF
 10163     if (pb-company-id = 'CID')
 10164        and (pb-issue)
 10165        and (pb-i-vin not = spaces and low-values and zeros)
 10166        perform 3400-edit-vin    thru 3400-exit
 10167     end-if
 10168******************************************************************
 10169******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10170******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10171******* METHODS.
 10172******************************************************************
 10173     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10174        IF PB-CANCELLATION
 10175           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10176              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10177                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10178                IF FORM-MASTER-FOUND
 10179                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10180******************************************************************
 10181
 10182     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10183     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10184
 10185     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10186     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10187     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10188     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10189
 10190
 10191     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10192     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 186
* EL050.cbl
 10193     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10194
 10195     IF AM-LF-OB-RATE NOT NUMERIC
 10196         MOVE ZERO               TO AM-LF-OB-RATE.
 10197
 10198     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10199         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10200
 10201     IF AM-AH-OB-RATE NOT NUMERIC
 10202         MOVE ZERO               TO AM-AH-OB-RATE.
 10203
 10204     IF WS-LF-JOINT-INDICATOR = 'J'
 10205         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10206     ELSE
 10207         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10208
 10209     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10210
 10211     IF WS-IG-OVRD-AM  EQUAL SPACE
 10212         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10213
 10214     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10215         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10216                                       WS-IG-OVRD
 10217     ELSE
 10218         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10219             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10220                                       WS-IG-OVRD
 10221         ELSE
 10222             MOVE AM-IG             TO WS-IG-OVRD-AH
 10223                                       WS-IG-OVRD.
 10224
 10225     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10226         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10227                                       WS-IG-OVRD
 10228     ELSE
 10229         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10230             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10231                                       WS-IG-OVRD
 10232         ELSE
 10233             MOVE AM-IG             TO WS-IG-OVRD-LF
 10234                                       WS-IG-OVRD.
 10235
 10236     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10237     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10238     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10239     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10240*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10241     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10242                                              TO 'PRLDSFCTIA'.
 10243
 10244     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10245     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10246     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10247     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10248
 10249     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10250     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 187
* EL050.cbl
 10251     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10252     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10253     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10254     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10255     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10256
 10257     IF WS-ACCT-AH-DEV-PCT > +0
 10258        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10259     ELSE
 10260        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10261
 10262     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10263        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10264     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10265        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10266
 10267        IF AM-EARN-METHOD-L = 'S'
 10268            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10269                                        WS-LF-REFUND-CALC.
 10270
 10271        IF AM-EARN-METHOD-R = 'S'
 10272            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10273                                        WS-LF-REFUND-CALC.
 10274
 10275     IF WS-LF-COVERAGE-TYPE = 'R'
 10276         IF AM-EARN-METHOD-R = 'R'
 10277            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10278                                    WS-LF-REFUND-CALC.
 10279     IF WS-LF-COVERAGE-TYPE = 'R'
 10280         IF AM-EARN-METHOD-R = 'P'
 10281            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10282                                    WS-LF-REFUND-CALC.
 10283     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10284         IF AM-EARN-METHOD-L = 'R'
 10285            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10286                                    WS-LF-REFUND-CALC.
 10287     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10288         IF AM-EARN-METHOD-L = 'P'
 10289            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10290                                    WS-LF-REFUND-CALC.
 10291     IF WS-LF-COVERAGE-TYPE = 'R'
 10292         IF AM-EARN-METHOD-R = 'A'
 10293            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10294                                    WS-LF-REFUND-CALC.
 10295     IF WS-LF-COVERAGE-TYPE = 'R'
 10296         IF AM-EARN-METHOD-R = 'M'
 10297            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10298                                    WS-LF-REFUND-CALC.
 10299     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10300         IF AM-EARN-METHOD-L = 'A'
 10301            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10302                                    WS-LF-REFUND-CALC.
 10303     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10304         IF AM-EARN-METHOD-L = 'M'
 10305            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10306                                    WS-LF-REFUND-CALC.
 10307
 10308     IF AM-EARN-METHOD-A = 'R'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 188
* EL050.cbl
 10309        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10310                                    WS-AH-REFUND-CALC.
 10311     IF AM-EARN-METHOD-A = 'P'
 10312        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10313                                    WS-AH-REFUND-CALC.
 10314     IF AM-EARN-METHOD-A = 'C'
 10315        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10316                                    WS-AH-REFUND-CALC.
 10317     IF AM-EARN-METHOD-A = 'A'
 10318        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10319                                    WS-AH-REFUND-CALC.
 10320     IF AM-EARN-METHOD-A = 'M'
 10321        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10322                                    WS-AH-REFUND-CALC.
 10323     IF AM-EARN-METHOD-A = 'N'
 10324        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10325                                    WS-AH-REFUND-CALC.
 10326     IF AM-EARN-METHOD-A = 'S'
 10327        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10328                                    WS-AH-REFUND-CALC.
 10329
 10330     IF AM-TOL-PREM NOT = ZEROS
 10331        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10332                                    WS-TOL-AH-PREM.
 10333
 10334     IF AM-OVR-SHT-AMT NUMERIC AND
 10335                  AM-OVR-SHT-AMT > 0
 10336        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10337                                    EC-AM-LF-OVR-SHT-AMT
 10338                                    WS-AH-REFUND-OVS-AMT
 10339                                    EC-AM-AH-OVR-SHT-AMT.
 10340
 10341     IF AM-OVR-SHT-PCT NUMERIC AND
 10342                    AM-OVR-SHT-PCT > 0
 10343        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10344                                    EC-AM-LF-OVR-SHT-PCT
 10345                                    WS-AH-REFUND-OVS-PCT
 10346                                    EC-AM-AH-OVR-SHT-PCT.
 10347
 10348     IF AM-TOL-REF-PCT NUMERIC AND
 10349                  AM-TOL-REF-PCT > 0
 10350        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10351                                    WS-TOL-AH-REFUND-PCT.
 10352
 10353     IF AM-TOL-REF  NOT = ZEROS  AND
 10354                  AM-TOL-REF NUMERIC
 10355        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10356                                    EC-AM-LF-TOL-REFUND
 10357                                    WS-TOL-AH-REFUND
 10358                                    EC-AM-AH-TOL-REFUND.
 10359
 10360     IF AM-TOL-CLM  NOT = ZEROS
 10361        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10362                                    WS-TOL-AH-CLAIM.
 10363
 10364     IF AM-CLP-TOL-PCT NOT NUMERIC
 10365        MOVE +0                  TO AM-CLP-TOL-PCT
 10366     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 189
* EL050.cbl
 10367
 10368     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10369        MOVE +0                  TO AM-SPP-LEASE-COMM
 10370     END-IF
 10371     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10372        MOVE WS-PL-TOL-LF-PREM-PCT
 10373                                 TO WS-TOL-LF-PREM-PCT.
 10374
 10375     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10376        MOVE WS-PL-TOL-AH-PREM-PCT
 10377                                 TO WS-TOL-AH-PREM-PCT.
 10378
 10379     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10380        MOVE WS-PL-TOL-LF-REFUND-PCT
 10381                                 TO WS-TOL-LF-REFUND-PCT.
 10382
 10383     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10384        MOVE WS-PL-TOL-AH-REFUND-PCT
 10385                                 TO WS-TOL-AH-REFUND-PCT.
 10386
 10387     IF WS-PL-REF-OVS-AMT > +0
 10388        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10389
 10390     IF WS-PL-REF-OVS-PCT > +0
 10391        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10392
 10393     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10394        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10395     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10396        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10397     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10398        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10399     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10400        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10401     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10402        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10403     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10404        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10405
 10406     IF WS-AH-PL-REF-OVS-AMT > +0
 10407        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10408
 10409     IF WS-AH-PL-REF-OVS-PCT > +0
 10410        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10411
 10412     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10413     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10414
 10415     IF PB-CANCELLATION
 10416        GO TO 3000-CONTINUE-EDIT.
 10417
 10418     MOVE +1 TO SUB1.
 10419     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10420     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10421
 10422     IF CF-COMPANY-ID = 'DMD'
 10423       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10424         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 190
* EL050.cbl
 10425        ELSE
 10426         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10427
 10428  0525-FIND-ACCT-COMM.
 10429     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10430        NEXT SENTENCE
 10431      ELSE
 10432         ADD +1 TO SUB1
 10433         IF SUB1 LESS +11
 10434            GO TO 0525-FIND-ACCT-COMM
 10435          ELSE
 10436             GO TO 0560-EDIT-CONTINUE.
 10437
 10438     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10439     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10440                                    PB-I-LIFE-COMMISSION.
 10441***  IF PB-COMPANY-ID = 'CRI'
 10442     IF PB-PREM-ACCTNG-ONLY
 10443         GO TO 0560-EDIT-CONTINUE.
 10444
 10445     MOVE '0530' TO CTBL-SW.
 10446     MOVE ' '    TO WS-CTBL-READ-SW.
 10447
 10448
 10449 0530-GET-AH-COMP.
 10450     IF NO-AH-COVERAGE  OR
 10451        NO-AH-BENEFIT-MATCH
 10452           GO TO 0540-NEXT-READ-STEP.
 10453
 10454     IF AM-A-COM (SUB1) NUMERIC
 10455        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10456         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10457         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10458         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10459         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10460     ELSE
 10461          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10462          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10463          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10464          MOVE ZEROS             TO WS-SUB1
 10465                                    WS-COMMISSION
 10466          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10467          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10468          IF WS-COMMISSION > ZEROS
 10469             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10470             GO TO 0540-NEXT-READ-STEP
 10471          END-IF
 10472          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10473          IF CTBL-TABLE-FOUND
 10474             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10475                                        PB-I-AH-TERM
 10476             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10477             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10478             GO TO 0540-NEXT-READ-STEP
 10479          ELSE
 10480             IF FIRST-TIME-THROUGH
 10481                 GO TO 0530-GET-AH-COMP
 10482             ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 191
* EL050.cbl
 10483                 MOVE ER-2609                TO WS-ERROR
 10484                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10485
 10486 0540-NEXT-READ-STEP.
 10487     MOVE '0540' TO CTBL-SW.
 10488     MOVE ' '    TO WS-CTBL-READ-SW.
 10489
 10490 0540-GET-LF-COMP.
 10491     IF NO-LIFE-COVERAGE  OR
 10492        NO-LF-BENEFIT-MATCH
 10493           GO TO 0560-EDIT-CONTINUE.
 10494
 10495     IF WS-LF-JOINT-INDICATOR = 'J'
 10496        IF AM-J-COM (SUB1) NUMERIC
 10497           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10498           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10499           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10500           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10501           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10502        ELSE
 10503           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10504           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10505           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10506           MOVE ZEROS                TO WS-SUB1
 10507                                        WS-COMMISSION
 10508           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10509           IF WS-COMMISSION > ZEROS
 10510              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10511              GO TO 0560-EDIT-CONTINUE
 10512           END-IF
 10513           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10514           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10515           IF CTBL-TABLE-FOUND
 10516              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10517              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10518              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10519              GO TO 0560-EDIT-CONTINUE
 10520           ELSE
 10521              IF FIRST-TIME-THROUGH
 10522                  GO TO 0540-GET-LF-COMP
 10523              ELSE
 10524                  MOVE ER-2609                TO WS-ERROR
 10525                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10526                  GO TO 0560-EDIT-CONTINUE.
 10527
 10528     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10529        IF AM-L-COM (SUB1) NUMERIC
 10530           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10531           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10532           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10533           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10534           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10535        ELSE
 10536           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10537           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10538           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10539           MOVE ZEROS                TO WS-SUB1
 10540                                        WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 192
* EL050.cbl
 10541           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10542           IF WS-COMMISSION IS GREATER THAN ZEROS
 10543              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10544              GO TO 0560-EDIT-CONTINUE
 10545           END-IF
 10546           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10547           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10548           IF CTBL-TABLE-FOUND
 10549              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10550              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10551              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10552              GO TO 0560-EDIT-CONTINUE
 10553           ELSE
 10554              IF FIRST-TIME-THROUGH
 10555                  GO TO 0540-GET-LF-COMP
 10556              ELSE
 10557                  MOVE ER-2609                TO WS-ERROR
 10558                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10559
 10560*    GO TO 0560-EDIT-CONTINUE.
 10561
 10562 0560-EDIT-CONTINUE.
 10563     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10564                                    WS-AH-PMF-COMM
 10565*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10566*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10567     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10568        (SUB1 > +10)
 10569        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10570           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10571           MOVE '0530'           TO CTBL-SW
 10572           MOVE ' '              TO WS-CTBL-READ-SW
 10573           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10574           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10575           MOVE '0540'           TO CTBL-SW
 10576           MOVE ' '              TO WS-CTBL-READ-SW
 10577           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10578        END-IF
 10579     END-PERFORM
 10580     GO TO 0564-EDIT-CONTINUE
 10581     .
 10582 0561-CHECK-AH.
 10583     IF (NO-AH-COVERAGE)
 10584        OR (NO-AH-BENEFIT-MATCH)
 10585        CONTINUE
 10586     ELSE
 10587        IF (AM-A-COM (SUB1) NUMERIC)
 10588           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10589           IF (AM-COM-TYP (SUB1) = 'A')
 10590              AND (WS-AH-PMF-COMM = ZEROS)
 10591              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10592           END-IF
 10593           CONTINUE
 10594        ELSE
 10595           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10596           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10597           MOVE PB-AH-OVERRIDE-L1
 10598                                 TO CTBL-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 193
* EL050.cbl
 10599           MOVE ZEROS            TO WS-SUB1
 10600                                    WS-COMMISSION
 10601           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10602           PERFORM 8300-READ-CTBL-TABLE
 10603                                 THRU 8300-EXIT
 10604           IF CTBL-TABLE-FOUND
 10605              IF (AM-COM-TYP (SUB1) = 'A')
 10606                 AND (WS-AH-PMF-COMM = ZEROS)
 10607                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10608                                        PB-I-AH-TERM
 10609                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10610                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10611              END-IF
 10612              CONTINUE
 10613           ELSE
 10614              IF FIRST-TIME-THROUGH
 10615                 GO TO 0561-CHECK-AH
 10616              ELSE
 10617                 MOVE ER-2609    TO WS-ERROR
 10618                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10619              END-IF
 10620           END-IF
 10621        END-IF
 10622     END-IF
 10623     .
 10624 0561-EXIT.
 10625     EXIT.
 10626 0563-CHECK-LF.
 10627     IF (NO-LIFE-COVERAGE)
 10628        OR (NO-LF-BENEFIT-MATCH)
 10629        CONTINUE
 10630     ELSE
 10631        IF WS-LF-JOINT-INDICATOR = 'J'
 10632           IF AM-J-COM (SUB1) NUMERIC
 10633              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10634              IF (AM-COM-TYP (SUB1) = 'A')
 10635                 AND (WS-LF-PMF-COMM = ZEROS)
 10636                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10637              END-IF
 10638              CONTINUE
 10639           ELSE
 10640              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10641              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10642              MOVE PB-LIFE-OVERRIDE-L1
 10643                                 TO CTBL-BEN-TYPE
 10644              MOVE ZEROS         TO WS-SUB1
 10645                                    WS-COMMISSION
 10646              MOVE AM-J-COMA (SUB1)
 10647                                 TO CTBL-TABLE
 10648              PERFORM 8300-READ-CTBL-TABLE
 10649                                 THRU 8300-EXIT
 10650              IF CTBL-TABLE-FOUND
 10651                 IF (AM-COM-TYP (SUB1) = 'A')
 10652                    AND (WS-LF-PMF-COMM = ZEROS)
 10653                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10654                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10655                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10656                 END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 194
* EL050.cbl
 10657                 CONTINUE
 10658              ELSE
 10659                 IF FIRST-TIME-THROUGH
 10660                    GO TO 0563-CHECK-LF
 10661                 ELSE
 10662                    MOVE ER-2609 TO WS-ERROR
 10663                    PERFORM 9900-ERROR-FORMAT
 10664                                 THRU 9900-EXIT
 10665*                   GO TO 0560-EDIT-CONTINUE
 10666                 END-IF
 10667              END-IF
 10668           END-IF
 10669        ELSE
 10670           IF AM-L-COM (SUB1) NUMERIC
 10671              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10672              IF (AM-COM-TYP (SUB1) = 'A')
 10673                 AND (WS-LF-PMF-COMM = ZEROS)
 10674                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10675              END-IF
 10676              CONTINUE
 10677           ELSE
 10678              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10679              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10680              MOVE PB-LIFE-OVERRIDE-L1
 10681                                 TO CTBL-BEN-TYPE
 10682              MOVE ZEROS         TO WS-SUB1
 10683                                    WS-COMMISSION
 10684              MOVE AM-L-COMA (SUB1)
 10685                                 TO CTBL-TABLE
 10686              PERFORM 8300-READ-CTBL-TABLE
 10687                                 THRU 8300-EXIT
 10688              IF CTBL-TABLE-FOUND
 10689                 CONTINUE
 10690              ELSE
 10691                 IF FIRST-TIME-THROUGH
 10692                    GO TO 0563-CHECK-LF
 10693                 ELSE
 10694                    MOVE ER-2609 TO WS-ERROR
 10695                    PERFORM 9900-ERROR-FORMAT
 10696                                 THRU 9900-EXIT
 10697                 END-IF
 10698              END-IF
 10699           END-IF
 10700        END-IF
 10701     END-IF
 10702     .
 10703 0563-EXIT.
 10704     EXIT.
 10705 0564-EDIT-CONTINUE.
 10706
 10707     IF  PB-COMPANY-ID EQUAL 'DMD'
 10708         IF PB-I-NUM-BILLED EQUAL ZEROS
 10709            MOVE ER-8148       TO WS-ERROR
 10710            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10711
 10712*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10713*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10714*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 195
* EL050.cbl
 10715*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10716*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10717*         IF NO-CONVERSION-ERROR
 10718*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10719*         ELSE
 10720*             IF PB-COMPANY-ID EQUAL 'HAN'
 10721*                 MOVE ZEROS     TO PB-I-AGE.
 10722     IF PB-I-BIRTHDAY > LOW-VALUES
 10723        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10724        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10725        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10726        PERFORM 8500-DATE-CONVERT
 10727                                 THRU 8500-EXIT
 10728        IF NO-CONVERSION-ERROR
 10729           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10730           IF PB-I-AGE > ZEROS
 10731              IF WS-WORK-AGE NOT = PB-I-AGE
 10732                 MOVE ER-9501    TO WS-ERROR
 10733                 PERFORM 9900-ERROR-FORMAT
 10734                                 THRU 9900-EXIT
 10735              END-IF
 10736           ELSE
 10737              MOVE WS-WORK-AGE   TO PB-I-AGE
 10738           END-IF
 10739        END-IF
 10740     END-IF
 10741     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10742                                   WS-INS-AGE-SET
 10743     IF PB-I-AGE = ZEROS
 10744        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10745           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10746                                   WS-INS-AGE-SET
 10747           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10748
 10749     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10750                                   WS-AH-EDIT-AGE.
 10751
 10752     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10753        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10754        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10755        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10756        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10757        IF NO-CONVERSION-ERROR
 10758           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10759           IF PB-I-JOINT-AGE > 0
 10760              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10761                 MOVE ER-9503    TO WS-ERROR
 10762                 PERFORM 9900-ERROR-FORMAT
 10763                                 THRU 9900-EXIT
 10764              END-IF
 10765           ELSE
 10766              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10767           END-IF
 10768        ELSE
 10769           MOVE ZEROS            TO PB-I-JOINT-AGE
 10770        END-IF
 10771     END-IF
 10772     IF PB-I-JOINT-AGE NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 196
* EL050.cbl
 10773        MOVE ZERO               TO PB-I-JOINT-AGE.
 10774
 10775     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10776                                   WS-JNT-AGE-SET
 10777     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10778        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10779           (WS-AH-JOINT-INDICATOR = 'J')
 10780           IF PB-I-JOINT-AGE = ZEROS
 10781               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10782                                          WS-JNT-AGE-SET
 10783               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10784           END-IF
 10785        END-IF
 10786     END-IF
 10787
 10788     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10789     IF WS-LF-JOINT-INDICATOR = 'J'
 10790        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10791        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10792            IF  PB-I-JOINT-AGE = ZERO
 10793                MOVE ER-2686       TO WS-ERROR
 10794                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10795            ELSE
 10796                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10797                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10798                    IF PB-COMPANY-ID NOT = 'LBL'
 10799                        MOVE ER-2685    TO WS-ERROR
 10800                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10801
 10802     IF WS-AH-JOINT-INDICATOR = 'J'
 10803        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10804            IF  PB-I-JOINT-AGE = ZERO
 10805                MOVE ER-2686       TO WS-ERROR
 10806                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10807            ELSE
 10808                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10809                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10810                                           WS-EDIT-AGE
 10811                    IF PB-COMPANY-ID NOT = 'LBL'
 10812                        MOVE ER-2685    TO WS-ERROR
 10813                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10814
 10815******************************************************************
 10816*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10817******************************************************************
 10818
 10819     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10820        (WS-AH-SPECIAL-CALC-CD = 'O')
 10821        NEXT SENTENCE
 10822     ELSE
 10823        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10824          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10825           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10826            WS-AH-JOINT-INDICATOR = 'J')  AND
 10827           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10828            MOVE ER-2627             TO WS-ERROR
 10829            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10830
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 197
* EL050.cbl
 10831     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10832        (WS-AH-SPECIAL-CALC-CD = 'O')
 10833         NEXT SENTENCE
 10834     ELSE
 10835         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10836            WS-AH-JOINT-INDICATOR = 'J'
 10837             IF PB-I-JOINT-INSURED = SPACES
 10838                 IF PB-COMPANY-ID NOT = 'JAL'
 10839                     MOVE ER-2696    TO WS-ERROR
 10840                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10841
 10842     IF PB-COMPANY-ID NOT = 'BOA'
 10843        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10844           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10845           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10846               PB-I-JOINT-INSURED NOT = SPACES)
 10847                MOVE ER-2691         TO WS-ERROR
 10848                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10849
 10850     IF PB-COMPANY-ID = 'BOA'
 10851        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10852           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10853            IF PB-I-JOINT-AGE NOT = ZEROS
 10854                MOVE ER-2691         TO WS-ERROR
 10855                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10856
 10857     IF PB-COMPANY-ID = 'CRI'
 10858        IF PB-I-SIG-SW = 'J'
 10859           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10860              WS-AH-JOINT-INDICATOR NOT = 'J'
 10861              MOVE ER-2675       TO WS-ERROR
 10862              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10863
 10864     IF PB-COMPANY-ID = 'CRI'
 10865        IF PB-I-SIG-SW = 'S'
 10866           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10867              WS-AH-JOINT-INDICATOR = 'J'
 10868              MOVE ER-2676       TO WS-ERROR
 10869              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10870
 10871     IF PB-COMPANY-ID = 'CVL'
 10872         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10873            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10874              MOVE ER-2783           TO WS-ERROR
 10875              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10876     IF (WS-LF-JOINT-INDICATOR = 'J')
 10877        AND (WS-AH-JOINT-INDICATOR = 'J')
 10878        AND (PB-I-LF-TERM > 120)
 10879        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10880        MOVE ER-2783             TO WS-ERROR
 10881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10882     END-IF
 10883     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10884
 10885     IF PB-I-INDV-GRP-OVRD = 'I'
 10886        MOVE ER-2666             TO WS-ERROR
 10887        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10888        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 198
* EL050.cbl
 10889
 10890     IF PB-I-INDV-GRP-OVRD = 'G'
 10891        MOVE ER-2666             TO WS-ERROR
 10892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10893        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10894
 10895     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10896        NEXT SENTENCE
 10897     ELSE
 10898        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10899
 10900     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10901        IF WS-ERROR = ER-2666
 10902           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10903           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10904
 10905     IF PB-COMPANY-ID = 'CID'
 10906        IF PB-STATE = 'UT' OR 'MO'
 10907           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10908                 OR '76' OR '77')
 10909                      OR
 10910               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10911                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10912                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10913                   OR '2K' OR '2L'))
 10914              AND PB-I-INDV-GRP-CD = 'I'
 10915              MOVE ER-2721             TO WS-ERROR
 10916              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10917           END-IF
 10918        END-IF
 10919     END-IF
 10920
 10921     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10922     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10923        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10924     ELSE
 10925        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10926     END-IF
 10927
 10928*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10929*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10930     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10931                                    ACCOUNT-AH-CK-SW.
 10932
 10933     IF PB-REISSUED-CERT       OR
 10934        PB-REIN-ONLY-CERT      OR
 10935        PB-POLICY-IS-DECLINED  OR
 10936        PB-POLICY-IS-VOIDED
 10937*       OR PB-MONTHLY-CERT
 10938         GO TO 3000-CONTINUE-EDIT.
 10939
 10940     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10941        IF WS-EDIT-AGE           > +65
 10942           MOVE ER-2709          TO WS-ERROR
 10943           PERFORM 9900-ERROR-FORMAT
 10944                                 THRU 9900-EXIT
 10945        ELSE
 10946           IF WS-EDIT-AGE        > +55
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 199
* EL050.cbl
 10947              MOVE ER-2718       TO WS-ERROR
 10948              PERFORM 9900-ERROR-FORMAT
 10949                                 THRU 9900-EXIT
 10950           END-IF
 10951        END-IF
 10952     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10953        IF WS-EDIT-AGE           > +65
 10954           MOVE ER-2709          TO WS-ERROR
 10955           PERFORM 9900-ERROR-FORMAT
 10956                                 THRU 9900-EXIT
 10957        END-IF
 10958     END-IF
 10959     .
 10960
 10961 0565-LIFE-PLAN-LIMIT-EDITS.
 10962
 10963     IF NOT LF-PLAN-MASTER-FOUND
 10964        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10965                                    EC-AM-LF-MAX-TOT-BEN
 10966        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10967
 10968     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10969
 10970     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10971         IF PL-LM-AGE (1) = ZEROS
 10972             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10973
 10974     IF NO-LF-BENEFIT-MATCH          OR
 10975        WS-LF-BENEFIT-CD = ZEROS     OR
 10976        WS-LF-SPECIAL-CALC-CD = 'M'
 10977        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10978
 10979     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10980     MOVE +1                     TO SUB2.
 10981
 10982     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10983        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10984           MOVE +5   TO SUB2
 10985           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10986              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10987              (PL-LM-AGE (SUB2) EQUAL +0)
 10988              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10989              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10990
 10991     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10992
 10993     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10994                               + PB-I-LF-ALT-BENEFIT-AMT.
 10995
 10996 0568-CHECK-LIFE-ATT-AGE.
 10997
 10998     IF PL-ATT-AGE NUMERIC AND
 10999        PL-ATT-AGE > +0
 11000        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11001     END-IF
 11002*    IF PL-ATT-AGE NUMERIC AND
 11003*       PL-ATT-AGE > +0
 11004*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 200
* EL050.cbl
 11005*       IF PB-I-BIRTHDAY > LOW-VALUES
 11006*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11007*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11008*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11009*          SET BIN-PLUS-ELAPSED  TO TRUE
 11010*          PERFORM 8500-DATE-CONVERT
 11011*                                THRU 8500-EXIT
 11012*          IF NO-CONVERSION-ERROR
 11013*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11014*             MOVE ER-2669       TO WS-ERROR
 11015*             PERFORM 9900-ERROR-FORMAT
 11016*                                THRU 9900-EXIT
 11017*          END-IF
 11018*       ELSE
 11019*          IF WS-ATT-AGE >= PL-ATT-AGE
 11020*             MOVE ER-2669       TO WS-ERROR
 11021*             PERFORM 9900-ERROR-FORMAT
 11022*                                THRU 9900-EXIT
 11023*          END-IF
 11024*       END-IF
 11025*    END-IF
 11026     .
 11027 0570-CHECK-LIFE-LIMITS.
 11028
 11029     IF PB-COMPANY-ID EQUAL 'CRI'
 11030        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11031           IF SUB2 GREATER THAN +4
 11032              MOVE ER-2637 TO WS-ERROR
 11033              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11034              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11035
 11036     IF PB-COMPANY-ID  =  'NCL'
 11037        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11038            SUB2 GREATER THAN +8
 11039             MOVE 'U'         TO PB-BATCH-ENTRY
 11040             MOVE ER-2637     TO WS-ERROR
 11041             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11042             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11043
 11044     IF SUB2 > +8
 11045        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11046           AND (PB-I-SIG-SW = 'Y')
 11047           CONTINUE
 11048        ELSE
 11049           MOVE ER-2637          TO WS-ERROR
 11050           PERFORM 9900-ERROR-FORMAT
 11051                                 THRU 9900-EXIT
 11052        END-IF
 11053        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11054     END-IF
 11055     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11056     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11057     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11058
 11059     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11060        ADD +1  TO SUB2
 11061        GO TO 0570-CHECK-LIFE-LIMITS.
 11062
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 201
* EL050.cbl
 11063     IF PB-COMPANY-ID = 'NCL'
 11064         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11065
 11066     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11067        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11068        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11069           AND (PB-I-SIG-SW = 'Y')
 11070           CONTINUE
 11071        ELSE
 11072           MOVE ER-2637          TO WS-ERROR
 11073           PERFORM 9900-ERROR-FORMAT
 11074                                 THRU 9900-EXIT
 11075        END-IF
 11076     END-IF
 11077     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11078
 11079
 11080 0570-CHECK-NCL-LIFE-LIMITS.
 11081
 11082     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11083        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11084         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11085
 11086     IF APP-CERT-USED
 11087         IF SUB2  LESS THAN  +5
 11088             MOVE +5          TO SUB2
 11089             GO TO 0570-CHECK-LIFE-LIMITS.
 11090
 11091     MOVE ER-2637             TO WS-ERROR.
 11092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11093
 11094     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11095
 11096 0575-CHECK-NCL-SIG-SWITCH.
 11097
 11098     IF NOT APP-CERT-USED
 11099         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11100
 11101     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11102        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11103        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11104        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11105         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11106
 11107     IF SUB2 GREATER THAN +4
 11108         IF PL-LM-AGE (5) = ZEROS  AND
 11109            PL-LM-AGE (6) = ZEROS  AND
 11110            PL-LM-AGE (7) = ZEROS  AND
 11111            PL-LM-AGE (8) = ZEROS
 11112             MOVE  ER-1927        TO WS-ERROR
 11113             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11114             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11115         ELSE
 11116             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11117                 MOVE  ER-1920    TO WS-ERROR
 11118                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11119
 11120     IF PB-I-SIG-SW  = 'Y'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 202
* EL050.cbl
 11121       IF NOT PB-I-POLICY-ACCEPTED  AND
 11122          NOT PB-I-POLICY-DECLINED
 11123           MOVE 'U'               TO PB-BATCH-ENTRY
 11124           MOVE  ER-1926          TO WS-ERROR
 11125           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11126
 11127
 11128 0580-AH-PLAN-LIMIT-EDITS.
 11129
 11130     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11131        IF PB-I-AH-BENEFIT-AMT > +1250
 11132           MOVE ER-2702          TO WS-ERROR
 11133           PERFORM 9900-ERROR-FORMAT
 11134                                 THRU 9900-EXIT
 11135        END-IF
 11136     END-IF
 11137
 11138     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11139        AND (PB-MONTHLY-CERT)
 11140        IF PB-I-AH-BENEFIT-AMT > +3000
 11141           MOVE ER-2881          TO WS-ERROR
 11142           PERFORM 9900-ERROR-FORMAT
 11143                                 THRU 9900-EXIT
 11144        END-IF
 11145     END-IF
 11146     IF NOT AH-PLAN-MASTER-FOUND
 11147        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11148        GO TO 3000-CONTINUE-EDIT.
 11149
 11150     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11151
 11152     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11153         IF PL-LM-AGE (1) = ZEROS
 11154             GO TO 3000-CONTINUE-EDIT.
 11155
 11156     IF NO-AH-BENEFIT-MATCH          OR
 11157        WS-AH-BENEFIT-CD = ZEROS     OR
 11158        WS-AH-SPECIAL-CALC-CD = 'M'
 11159        GO TO 3000-CONTINUE-EDIT.
 11160
 11161     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11162     MOVE +1                     TO SUB2.
 11163
 11164     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11165        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11166           MOVE +5 TO SUB2
 11167           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11168              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11169              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11170              (PL-LM-AGE (SUB2) EQUAL +0)
 11171              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11172              GO TO 3000-CONTINUE-EDIT.
 11173
 11174     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11175
 11176 0590-CHECK-AH-ATT-AGE.
 11177
 11178     IF PL-ATT-AGE NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 203
* EL050.cbl
 11179        PL-ATT-AGE GREATER THAN +0
 11180        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11181     END-IF
 11182*       IF WS-ATT-AGE >= PL-ATT-AGE
 11183*          MOVE ER-3054          TO WS-ERROR
 11184*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11185     .
 11186 0597-CHECK-AH-LIMITS.
 11187
 11188     IF PB-COMPANY-ID EQUAL 'CRI'
 11189        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11190           IF SUB2 GREATER THAN +4
 11191              MOVE ER-2638       TO WS-ERROR
 11192              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11193              GO TO 3000-CONTINUE-EDIT.
 11194
 11195     IF PB-COMPANY-ID  =  'NCL'
 11196        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11197            SUB2 GREATER THAN +8
 11198             MOVE 'U'            TO PB-BATCH-ENTRY
 11199             MOVE ER-2638        TO WS-ERROR
 11200             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11201             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11202
 11203     IF SUB2 > +8
 11204        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11205           AND (PB-I-SIG-SW = 'Y')
 11206           CONTINUE
 11207        ELSE
 11208           MOVE ER-2638          TO WS-ERROR
 11209           PERFORM 9900-ERROR-FORMAT
 11210                                 THRU 9900-EXIT
 11211        END-IF
 11212        GO TO 3000-CONTINUE-EDIT
 11213     END-IF
 11214
 11215     IF PB-COMPANY-ID = 'CRI'
 11216        IF WS-ERROR = ER-2638
 11217           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11218
 11219     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11220     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11221     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11222     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11223
 11224     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11225        ADD +1                   TO SUB2
 11226        GO TO 0597-CHECK-AH-LIMITS.
 11227
 11228     IF PB-COMPANY-ID = 'NCL'
 11229         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11230
 11231     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11232        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11233        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11234                                 > PL-LM-AMT (SUB2))
 11235        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11236           AND (PB-I-SIG-SW = 'Y')
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 204
* EL050.cbl
 11237           CONTINUE
 11238        ELSE
 11239           MOVE ER-2638          TO WS-ERROR
 11240           PERFORM 9900-ERROR-FORMAT
 11241                                 THRU 9900-EXIT
 11242        END-IF
 11243     END-IF
 11244
 11245     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11246         IF  WS-ERROR    EQUAL    ER-2638
 11247             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11248                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11249                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11250                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11251                MOVE  ER-1910    TO  WS-ERROR
 11252                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11253
 11254     IF PB-COMPANY-ID = 'CRI'
 11255        IF WS-ERROR = ER-2638
 11256            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11257            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11258            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11259
 11260     GO TO 3000-CONTINUE-EDIT.
 11261
 11262 0597-CHECK-NCL-AH-LIMITS.
 11263
 11264     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11265        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11266        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11267                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11268         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11269
 11270     IF APP-CERT-USED
 11271         IF SUB2  LESS THAN  +5
 11272             MOVE +5             TO SUB2
 11273             GO TO 0597-CHECK-AH-LIMITS.
 11274
 11275     MOVE ER-2638                TO WS-ERROR.
 11276     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11277
 11278     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11279
 11280 0599-CHECK-NCL-SIG-SWITCH.
 11281
 11282     IF NOT APP-CERT-USED
 11283         GO TO 3000-CONTINUE-EDIT.
 11284
 11285     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11286        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11287        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11288        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11289         GO TO 3000-CONTINUE-EDIT.
 11290
 11291     IF SUB2 GREATER THAN +4
 11292         IF PL-LM-AGE (5) = ZEROS  AND
 11293            PL-LM-AGE (6) = ZEROS  AND
 11294            PL-LM-AGE (7) = ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 205
* EL050.cbl
 11295            PL-LM-AGE (8) = ZEROS
 11296             MOVE  ER-1927        TO WS-ERROR
 11297             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11298             GO TO 3000-CONTINUE-EDIT
 11299         ELSE
 11300             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11301                 MOVE  ER-1920    TO WS-ERROR
 11302                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11303
 11304     IF PB-I-SIG-SW  = 'Y'
 11305       IF NOT PB-I-POLICY-ACCEPTED  AND
 11306          NOT PB-I-POLICY-DECLINED
 11307           MOVE 'U'               TO PB-BATCH-ENTRY
 11308           MOVE  ER-1926          TO WS-ERROR
 11309           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11310
 11311******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 206
* EL050.cbl
 11313
 11314 3000-CONTINUE-EDIT.
 11315
 11316     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11317     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11318     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11319     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11320     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11321
 11322     IF BROWSE-STARTED
 11323        PERFORM 9990-RETURN THRU 9990-EXIT
 11324        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11325
 11326     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11327        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11328        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11329        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11330*       MOVE 1                   TO DC-OPTION-CODE
 11331        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11332        IF DATE-CONVERSION-ERROR
 11333           MOVE ER-2622          TO WS-ERROR
 11334           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11335        ELSE
 11336           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11337              MOVE ER-2623       TO WS-ERROR
 11338              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11339           ELSE
 11340              MOVE ER-2622       TO WS-ERROR
 11341              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11342
 11343     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11344     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11345     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11346*    MOVE 1                      TO DC-OPTION-CODE.
 11347     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11348     IF DATE-CONVERSION-ERROR
 11349        GO TO 3005-EDIT-CONTINUE
 11350     ELSE
 11351        IF DC-ELAPSED-DAYS GREATER +180
 11352           MOVE ER-2613          TO WS-ERROR
 11353           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11354        ELSE
 11355           IF DC-ELAPSED-DAYS GREATER +90
 11356              MOVE ER-2612       TO WS-ERROR
 11357              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358           ELSE
 11359             IF DC-ELAPSED-DAYS GREATER +60
 11360                MOVE ER-2614     TO WS-ERROR
 11361                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11362
 11363 3005-EDIT-CONTINUE.
 11364
 11365     IF PB-CANCELLATION
 11366         GO TO 3700-EDIT-CANCEL.
 11367
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 207
* EL050.cbl
 11369******************************************************************
 11370*                  E D I T   I S S U E                           *
 11371******************************************************************
 11372
 11373 3020-EDIT-ISSUE.
 11374
 11375      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11376      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11377      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11378      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11379      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11380
 11381     IF PB-ISSUE-FORCE
 11382        OR PB-ISSUE-DATE-FORCED
 11383        OR PB-FORCE-OFF
 11384        OR PB-OVERCHARGE-FORCE
 11385        CONTINUE
 11386     ELSE
 11387        MOVE ER-2670             TO WS-ERROR
 11388        PERFORM 9900-ERROR-FORMAT
 11389                                 THRU 9900-EXIT
 11390     END-IF
 11391     .
 11392 3022-SET-POLICY-STATUS.
 11393
 11394     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11395
 11396     IF (PB-REISSUED-CERT)
 11397             OR
 11398        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11399         AND (PB-MONTHLY-CERT))
 11400         MOVE '5'                TO PB-I-ENTRY-STATUS
 11401         MOVE 'E'                TO PB-BATCH-ENTRY
 11402     END-IF
 11403
 11404     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11405        IF PB-MONTHLY-CERT
 11406           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11407        END-IF
 11408        IF PB-CASH-CERT
 11409           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11410        END-IF
 11411     END-IF
 11412     IF PB-POLICY-IS-DECLINED
 11413         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11414     IF PB-POLICY-IS-VOIDED
 11415         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11416     IF PB-NEEDS-UNDERWRITING
 11417         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11418     IF PB-REIN-ONLY-CERT
 11419         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11420     IF PB-PREM-ACCTNG-ONLY
 11421         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11422
 11423     MOVE SPACE                  TO PB-I-OB-FLAG.
 11424
 11425     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11426         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 208
* EL050.cbl
 11427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11428         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11429
 11430     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11431        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11432           MOVE 'Z'             TO PB-I-OB-FLAG.
 11433
 11434     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11435        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11436           MOVE 'Z'             TO PB-I-OB-FLAG.
 11437
 11438     IF ACCOUNT-MAST-FOUND
 11439         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11440         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11441         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11442         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11443         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11444         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11445         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11446     END-IF
 11447
 11448     IF ACCOUNT-MAST-FOUND
 11449        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11450         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11451
 11452     IF (ACCOUNT-MAST-FOUND)
 11453*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11454        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11455        IF PB-REISSUED-CERT
 11456           CONTINUE
 11457        ELSE
 11458           MOVE ER-2608          TO WS-ERROR
 11459           PERFORM 9900-ERROR-FORMAT
 11460                                 THRU 9900-EXIT
 11461         END-IF
 11462     END-IF
 11463
 11464     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11465        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11466        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11467
 11468**********   DMD CUSTOM CODE FOLLOWS  **********
 11469 3024-EDIT-DMD-FIELDS.
 11470     IF PB-COMPANY-ID NOT = 'DMD'
 11471        GO TO 3025-EDIT-REINSURANCE.
 11472
 11473*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11474*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11475*** ERROR IF THEY ARE NOT EQUAL.
 11476
 11477     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11478     SET BIN-TO-GREG               TO TRUE.
 11479     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11480     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11481**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11482
 11483     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11484     SET BIN-TO-GREG               TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 209
* EL050.cbl
 11485     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11486     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11487**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11488
 11489     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11490        MOVE ER-8116               TO WS-ERROR
 11491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11492
 11493     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11494
 11495     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11496                                      WK-FULL-CERT-NO.
 11497     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11498
 11499     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11500
 11501     IF PB-VALID-LIFE
 11502        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11503     ELSE
 11504        IF PB-VALID-AH
 11505          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11506
 11507
 11508     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11509     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11510     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11511                                      DCUA-UNDRWRTR-CODE
 11512                                      DCUA-UNDRWRTR-GROUP-CODE
 11513                                      DCUA-RETURN-CODE.
 11514
 11515****************************************************************
 11516*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11517***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11518***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11519***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11520***   TO THIS RECORD.                                        ***
 11521****************************************************************
 11522     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11523     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11524     IF DCUA-SUCCESSFUL-PROCESS
 11525        GO TO 3024-EDIT-DL7-CONT.
 11526
 11527     IF DCUA-RETURN-CODE EQUAL '01'
 11528        MOVE ER-8110               TO WS-ERROR
 11529        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11530        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11531        GO TO 3024-EDIT-DL7-CONT.
 11532
 11533     IF DCUA-RETURN-CODE EQUAL '02'
 11534        MOVE ER-8111               TO WS-ERROR
 11535        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11537        GO TO 3024-EDIT-DL7-CONT.
 11538
 11539     IF DCUA-RETURN-CODE EQUAL '03'
 11540        MOVE ER-8074               TO WS-ERROR
 11541        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 210
* EL050.cbl
 11543        GO TO 3024-EDIT-DL7-CONT.
 11544
 11545     IF DCUA-RETURN-CODE EQUAL '04'
 11546        MOVE ER-8075               TO WS-ERROR
 11547        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11549        GO TO 3024-EDIT-DL7-CONT.
 11550
 11551     IF DCUA-RETURN-CODE EQUAL '05'
 11552        MOVE ER-8076               TO WS-ERROR
 11553        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11555        GO TO 3024-EDIT-DL7-CONT.
 11556
 11557     IF DCUA-RETURN-CODE EQUAL '06'
 11558        MOVE ER-8077               TO WS-ERROR
 11559        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11561        GO TO 3024-EDIT-DL7-CONT.
 11562
 11563     IF DCUA-RETURN-CODE EQUAL '07'
 11564        MOVE ER-8078               TO WS-ERROR
 11565        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11567        GO TO 3024-EDIT-DL7-CONT.
 11568
 11569     IF DCUA-RETURN-CODE EQUAL 'E1'
 11570        MOVE ER-8079               TO WS-ERROR
 11571        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11572        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11573        GO TO 3024-EDIT-DL7-CONT.
 11574
 11575     IF DCUA-RETURN-CODE EQUAL 'E2'
 11576        MOVE ER-8080               TO WS-ERROR
 11577        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11579        GO TO 3024-EDIT-DL7-CONT.
 11580
 11581     IF DCUA-RETURN-CODE EQUAL 'E3'
 11582        MOVE ER-8098               TO WS-ERROR
 11583        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585        GO TO 3024-EDIT-DL7-CONT.
 11586
 11587     IF DCUA-RETURN-CODE EQUAL 'C1'
 11588        MOVE ER-8099               TO WS-ERROR
 11589        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591        GO TO 3024-EDIT-DL7-CONT.
 11592
 11593     IF DCUA-RETURN-CODE EQUAL 'U1'
 11594        MOVE ER-8109               TO WS-ERROR
 11595        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11597        GO TO 3024-EDIT-DL7-CONT.
 11598
 11599     IF DCUA-RETURN-CODE EQUAL 'N1'
 11600        MOVE ER-8112               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 211
* EL050.cbl
 11601        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11603        GO TO 3024-EDIT-DL7-CONT.
 11604
 11605     IF DCUA-RETURN-CODE EQUAL 'N2'
 11606        MOVE ER-8113               TO WS-ERROR
 11607        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609        GO TO 3024-EDIT-DL7-CONT.
 11610
 11611     IF DCUA-RETURN-CODE EQUAL 'N3'
 11612        MOVE ER-8114               TO WS-ERROR
 11613        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615        GO TO 3024-EDIT-DL7-CONT.
 11616
 11617     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11618     MOVE ER-8097                  TO WS-ERROR.
 11619     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11620     GO TO 3024-EDIT-DL7-CONT.
 11621
 11622 3024-EDIT-DL7-CONT.
 11623
 11624     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11625     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11626     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11627        NEXT SENTENCE
 11628     ELSE
 11629        MOVE ER-9263               TO WS-ERROR
 11630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11631
 11632******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11633******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11634     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11635        NEXT SENTENCE
 11636     ELSE
 11637        MOVE ER-8039               TO WS-ERROR
 11638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11639
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 212
* EL050.cbl
 11641****************************************************************
 11642*** VALIDATE STATE  : DLO022                                 ***
 11643****************************************************************
 11644     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11645     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11646
 11647     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11648     IF DVSC-SUCCESSFUL-EDIT
 11649        GO TO 3024-EDIT-DL22-CONT.
 11650
 11651     IF DVSC-RETURN-CODE EQUAL '01'
 11652        MOVE ER-8300               TO WS-ERROR
 11653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11654        GO TO 3024-EDIT-DL22-CONT.
 11655
 11656     IF DVSC-RETURN-CODE EQUAL '02'
 11657        MOVE ER-8301               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL22-CONT.
 11660
 11661     IF DVSC-RETURN-CODE EQUAL '03'
 11662        MOVE ER-8302               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL22-CONT.
 11665
 11666     IF DVSC-RETURN-CODE EQUAL 'N1'
 11667        MOVE ER-8304               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL22-CONT.
 11670
 11671     MOVE ER-8303                  TO WS-ERROR
 11672     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11673
 11674 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 213
* EL050.cbl
 11676****************************************************************
 11677*** VALIDATE LOAN OFFICER : DLO021                           ***
 11678****************************************************************
 11679
 11680     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11681     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11682     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11683     IF DVLO-SUCCESSFUL-EDIT
 11684        GO TO 3024-EDIT-DL21-CONT.
 11685
 11686     IF DVLO-RETURN-CODE EQUAL '01'
 11687        MOVE ER-8081               TO WS-ERROR
 11688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11689        GO TO 3024-EDIT-DL21-CONT.
 11690
 11691     IF DVLO-RETURN-CODE EQUAL '02'
 11692        MOVE ER-8082               TO WS-ERROR
 11693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11694        GO TO 3024-EDIT-DL21-CONT.
 11695
 11696     IF DVLO-RETURN-CODE EQUAL '03'
 11697        MOVE ER-8083               TO WS-ERROR
 11698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699        GO TO 3024-EDIT-DL21-CONT.
 11700
 11701     IF DVLO-RETURN-CODE EQUAL '04'
 11702        MOVE ER-8084               TO WS-ERROR
 11703        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11704        GO TO 3024-EDIT-DL21-CONT.
 11705
 11706     IF DVLO-RETURN-CODE EQUAL '05'
 11707        MOVE ER-8085               TO WS-ERROR
 11708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11709        GO TO 3024-EDIT-DL21-CONT.
 11710
 11711     MOVE ER-7825                  TO WS-ERROR
 11712     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11713     GO TO 3024-EDIT-DL21-CONT.
 11714
 11715 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 214
* EL050.cbl
 11717
 11718****************************************************************
 11719*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11720****************************************************************
 11721
 11722     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11723     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11724     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11725     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11726     IF DIPF-SUCCESSFUL-EDIT
 11727        GO TO 3024-EDIT-DL02-CONT.
 11728
 11729     IF DIPF-RETURN-CODE EQUAL '01'
 11730        MOVE ER-8086               TO WS-ERROR
 11731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11732        GO TO 3024-EDIT-DL02-CONT.
 11733
 11734     IF DIPF-RETURN-CODE EQUAL '02'
 11735        MOVE ER-8087               TO WS-ERROR
 11736        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11737        GO TO 3024-EDIT-DL02-CONT.
 11738
 11739     IF DIPF-RETURN-CODE EQUAL '03'
 11740        MOVE ER-8088               TO WS-ERROR
 11741        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11742        GO TO 3024-EDIT-DL02-CONT.
 11743
 11744     MOVE ER-8095                  TO WS-ERROR
 11745     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11746     GO TO 3024-EDIT-DL02-CONT.
 11747
 11748 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 215
* EL050.cbl
 11750
 11751****************************************************************
 11752*** VALIDATE BANK ID : DLO003                                ***
 11753****************************************************************
 11754
 11755     MOVE WK-GREG-CENT           TO WCG-CENT.
 11756     MOVE WK-GREG-YYMM           TO WCG-REST.
 11757     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11758        MOVE ER-8040               TO WS-ERROR
 11759        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11760
 11761     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11762     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11763     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11764     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11765     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11766     IF DVBI-SUCCESSFUL-EDIT
 11767        GO TO 3024-EDIT-DL03-CONT.
 11768
 11769     IF DVBI-RETURN-CODE EQUAL '01'
 11770        MOVE ER-8089               TO WS-ERROR
 11771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11772        GO TO 3024-EDIT-DL03-CONT.
 11773
 11774     IF DVBI-RETURN-CODE EQUAL '02'
 11775        MOVE ER-8090               TO WS-ERROR
 11776        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11777        GO TO 3024-EDIT-DL03-CONT.
 11778
 11779     IF DVBI-RETURN-CODE EQUAL '03'
 11780        MOVE ER-8091               TO WS-ERROR
 11781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11782        GO TO 3024-EDIT-DL03-CONT.
 11783
 11784     IF DVBI-RETURN-CODE EQUAL '04'
 11785        MOVE ER-8092               TO WS-ERROR
 11786        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11787        GO TO 3024-EDIT-DL03-CONT.
 11788
 11789     IF DVBI-RETURN-CODE EQUAL '05'
 11790        MOVE ER-8093               TO WS-ERROR
 11791        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792        GO TO 3024-EDIT-DL03-CONT.
 11793
 11794     IF DVBI-RETURN-CODE EQUAL '06'
 11795        MOVE ER-8094               TO WS-ERROR
 11796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11797        GO TO 3024-EDIT-DL03-CONT.
 11798
 11799     MOVE ER-8096                  TO WS-ERROR
 11800     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11801     GO TO 3024-EDIT-DL03-CONT.
 11802
 11803 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 216
* EL050.cbl
 11805
 11806     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11807        NEXT SENTENCE
 11808     ELSE
 11809        MOVE ER-8042               TO WS-ERROR
 11810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11811
 11812     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11813     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11814     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11815
 11816     IF DMPF-RETURN-CODE = '01'
 11817        MOVE ER-8067               TO WS-ERROR
 11818        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11819        GO TO 3024-EDIT-DL01-CONT.
 11820
 11821     IF DMPF-RETURN-CODE = '02'
 11822        MOVE ER-8068               TO WS-ERROR
 11823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11824        GO TO 3024-EDIT-DL01-CONT.
 11825
 11826     IF DMPF-RETURN-CODE = '03'
 11827        MOVE ER-8069               TO WS-ERROR
 11828        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11829        GO TO 3024-EDIT-DL01-CONT.
 11830
 11831     IF DMPF-RETURN-CODE = 'E1'
 11832        MOVE ER-8070               TO WS-ERROR
 11833        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11834        GO TO 3024-EDIT-DL01-CONT.
 11835
 11836     IF DMPF-RETURN-CODE = 'N1'
 11837        MOVE ER-8071               TO WS-ERROR
 11838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11839        GO TO 3024-EDIT-DL01-CONT.
 11840
 11841     IF DMPF-RETURN-CODE NOT = 'OK'
 11842        MOVE ER-8072               TO WS-ERROR
 11843        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11844
 11845 3024-EDIT-DL01-CONT.
 11846******************************************************************
 11847***  VALIDATES RATE CODES : DLO017                             ***
 11848******************************************************************
 11849
 11850      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11851      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11852      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11853      IF DVRC-SUCCESSFUL-EDIT
 11854        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11855        GO TO 3024-CHECK-VALID-RATE.
 11856
 11857      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11858
 11859      IF DVRC-RETURN-CODE EQUAL '01'
 11860         MOVE ER-7817                   TO WS-ERROR
 11861         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11862         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 217
* EL050.cbl
 11863
 11864      IF DVRC-RETURN-CODE EQUAL '02'
 11865         MOVE ER-7818                   TO WS-ERROR
 11866         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11867         GO TO 3025-EDIT-REINSURANCE.
 11868
 11869      IF DVRC-RETURN-CODE EQUAL '03'
 11870         MOVE ER-7819                   TO WS-ERROR
 11871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11872         GO TO 3025-EDIT-REINSURANCE.
 11873
 11874       MOVE ER-7820                     TO WS-ERROR.
 11875       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11876       GO TO 3025-EDIT-REINSURANCE.
 11877
 11878******************************************************************
 11879***  GET PREMIUM RATES : DLO011                                ***
 11880******************************************************************
 11881
 11882 3024-CHECK-VALID-RATE.
 11883
 11884     IF VALID-RATE-CODE
 11885        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11886        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11887        MOVE SPACES                TO DPRB-RETURN-CODE
 11888        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11889     ELSE
 11890         GO TO 3025-EDIT-REINSURANCE.
 11891
 11892      IF DPRB-SUCCESSFUL-PROCESS
 11893         IF PB-VALID-LIFE
 11894             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11895             GO TO 3025-EDIT-REINSURANCE
 11896         ELSE
 11897             IF PB-VALID-AH
 11898                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11899                 GO TO 3025-EDIT-REINSURANCE.
 11900
 11901      IF DPRB-RETURN-CODE EQUAL '01'
 11902         MOVE ER-7812                   TO WS-ERROR
 11903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11904         GO TO 3025-EDIT-REINSURANCE.
 11905
 11906      IF DPRB-RETURN-CODE EQUAL '02'
 11907         MOVE ER-7813                   TO WS-ERROR
 11908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11909         GO TO 3025-EDIT-REINSURANCE.
 11910
 11911      IF DPRB-RETURN-CODE EQUAL '03'
 11912         MOVE ER-7814                   TO WS-ERROR
 11913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11914         GO TO 3025-EDIT-REINSURANCE.
 11915
 11916      IF DPRB-RETURN-CODE EQUAL '04'
 11917         IF NOT DPRB-1ST-TIME
 11918            MOVE ER-7815                   TO WS-ERROR
 11919            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11920            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 218
* EL050.cbl
 11921          ELSE
 11922         IF PB-VALID-LIFE
 11923            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11924          ELSE
 11925            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11926         END-IF
 11927         MOVE SPACES                TO DOCC-RETURN-CODE
 11928         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11929         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11930         IF DOCC-RETURN-CODE = 'OK'
 11931             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11932             GO TO 3024-CHECK-VALID-RATE
 11933           ELSE
 11934             MOVE ER-7823               TO WS-ERROR
 11935             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11936             GO TO 3025-EDIT-REINSURANCE.
 11937
 11938       MOVE ER-7816                     TO WS-ERROR.
 11939       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11940       GO TO 3025-EDIT-REINSURANCE.
 11941
 11942**********   DMD CUSTOM CODE ABOVE    **********
 11943
 11944 3025-EDIT-REINSURANCE.
 11945     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11946         GO TO 3027-EDIT-CONTINUE.
 11947
 11948     MOVE LOW-VALUES               TO ERREIN-KEY.
 11949     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11950     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11951                                      REIN-CODE-2
 11952                                      REIN-CODE-3.
 11953     MOVE 'A'                      TO REIN-TYPE.
 11954
 11955     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11956
 11957     MOVE '3026' TO REIN-SW.
 11958     MOVE ' '                   TO WS-REIN-READ-SW.
 11959
 11960     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11961     IF REIN-TABLE-NOT-FOUND
 11962         GO TO 3026-NO-SPEC-TABLE.
 11963
 11964     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11965     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11966                                   WS-NSP-ST-CD-LF.
 11967     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11968                                   WS-NSP-ST-CD-AH.
 11969
 11970     GO TO 3040-EDIT-CONTINUE.
 11971
 11972 3026-NO-SPEC-TABLE.
 11973
 11974     MOVE ER-2664                TO WS-ERROR.
 11975     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11976     GO TO 3040-EDIT-CONTINUE.
 11977
 11978 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 219
* EL050.cbl
 11979
 11980     IF PB-I-REIN-TABLE = SPACES
 11981       GO TO 3040-EDIT-CONTINUE.
 11982
 11983     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11984          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11985          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11986           GO TO 3040-EDIT-CONTINUE.
 11987
 11988     MOVE LOW-VALUES            TO ERREIN-KEY.
 11989     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11990     MOVE 'A'                   TO REIN-TYPE.
 11991     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11992
 11993     MOVE '3028'                TO REIN-SW.
 11994     MOVE ' '                   TO WS-REIN-READ-SW.
 11995
 11996     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11997     IF REIN-TABLE-NOT-FOUND
 11998         GO TO 3028-NO-REIN-TABLE.
 11999
 12000     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12001     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12002                                   WS-NSP-ST-CD-LF.
 12003     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12004                                   WS-NSP-ST-CD-AH.
 12005
 12006     GO TO 3040-EDIT-CONTINUE.
 12007
 12008 3028-NO-REIN-TABLE.
 12009
 12010     MOVE ER-2615                TO WS-ERROR.
 12011     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12012     GO TO 3040-EDIT-CONTINUE.
 12013
 12014 3040-EDIT-CONTINUE.
 12015
 12016     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12017         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12018
 12019     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12020         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12021
 12022     IF (NOT PB-REISSUED-CERT)
 12023        AND (NOT PB-MONTHLY-CERT)
 12024        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12025            MOVE '001'           TO PB-I-LF-TERM
 12026            MOVE 'M'             TO PB-I-INSURED-SEX.
 12027
 12028     IF (NOT PB-REISSUED-CERT)
 12029        AND (NOT PB-MONTHLY-CERT)
 12030        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12031            MOVE '001'           TO PB-I-AH-TERM
 12032            MOVE 'M'             TO PB-I-INSURED-SEX.
 12033
 12034 3040-EDIT-1ST-PMT-DT.
 12035     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12036     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 220
* EL050.cbl
 12037         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12038
 12039******************************************************************
 12040*                                                                *
 12041*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12042*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12043*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12044*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12045*                                                                *
 12046******************************************************************
 12047
 12048     IF PB-EFF-DT-PROCESSING
 12049        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12050                                    PB-I-LF-EXPIRE-DT
 12051                                    PB-I-AH-EXPIRE-DT
 12052        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12053        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12054        MOVE ZERO                TO DC-ELAPSED-DAYS
 12055        MOVE +1                  TO DC-ELAPSED-MONTHS
 12056        SET BIN-PLUS-ELAPSED     TO TRUE
 12057*       MOVE 6                   TO DC-OPTION-CODE
 12058        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12059        IF NO-CONVERSION-ERROR
 12060           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12061
 12062******************************************************************
 12063*                                                                *
 12064*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12065*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12066*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12067*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12068*                                                                *
 12069******************************************************************
 12070
 12071     IF PB-EXT-DAYS-PROCESSING
 12072          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12073                                         PB-I-LF-EXPIRE-DT
 12074                                         PB-I-AH-EXPIRE-DT
 12075          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12076          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12077          MOVE +1                     TO DC-ELAPSED-MONTHS
 12078          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12079          SET BIN-PLUS-ELAPSED        TO TRUE
 12080*         MOVE 6                      TO DC-OPTION-CODE
 12081          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12082          IF NO-CONVERSION-ERROR
 12083             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12084
 12085******************************************************************
 12086*                                                                *
 12087*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12088*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12089*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12090*        (EXPIRE DATE - (TERM -1))  *  -1.
 12091*                                                                *
 12092******************************************************************
 12093
 12094     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 221
* EL050.cbl
 12095        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12096           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12097              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12098              MOVE PB-I-AH-TERM      TO WS-TERM
 12099           ELSE
 12100              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12101              MOVE PB-I-LF-TERM      TO WS-TERM
 12102        ELSE
 12103           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12104              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12105              MOVE PB-I-LF-TERM      TO WS-TERM
 12106           ELSE
 12107              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12108              MOVE PB-I-AH-TERM      TO WS-TERM.
 12109
 12110     IF PB-EXPIRE-DT-PROCESSING
 12111        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12112        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12113        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12114        MOVE ZERO                TO DC-ELAPSED-DAYS
 12115                                    DC-ODD-DAYS-OVER
 12116          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12117          SET BIN-PLUS-ELAPSED    TO TRUE
 12118*         MOVE 6                  TO DC-OPTION-CODE
 12119          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12120          IF NO-CONVERSION-ERROR
 12121             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12122
 12123******************************************************************
 12124*                                                                *
 12125*            1ST PAYMENT DATE PROCESSING                         *
 12126*                                                                *
 12127******************************************************************
 12128
 12129     IF PB-1ST-PMT-DT-PROCESSING
 12130        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12131                                    PB-I-AH-EXPIRE-DT
 12132        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12133
 12134     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12135         NEXT SENTENCE
 12136     ELSE
 12137         MOVE ER-2680                 TO WS-ERROR
 12138         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12139         GO TO 3060-ORIG-TERM-CHECK.
 12140
 12141     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12142     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12143     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12144*    MOVE 1                      TO DC-OPTION-CODE.
 12145     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12146                                    DC-ELAPSED-DAYS
 12147                                    DC-ODD-DAYS-OVER.
 12148
 12149     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12150
 12151     IF DATE-CONVERSION-ERROR
 12152        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 222
* EL050.cbl
 12153
 12154     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12155     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12156        AND (WS-LF-COVERAGE-TYPE = 'L')
 12157        IF (DC-ELAPSED-MONTHS > 1)
 12158                      OR
 12159           ((DC-ELAPSED-MONTHS = 1)
 12160           AND (DC-ODD-DAYS-OVER > 0))
 12161           MOVE ER-2882          TO WS-ERROR
 12162           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12163        END-IF
 12164     END-IF
 12165     if dc-elapsed-months > 0
 12166        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12167        + dc-odd-days-over
 12168     end-if
 12169     IF PB-EXT-DAYS-PROCESSING
 12170        CONTINUE
 12171     ELSE
 12172        IF DC-ELAPSED-MONTHS = +0
 12173           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12174        ELSE
 12175           IF (WS-LF-EARNINGS-CALC = '4')
 12176              AND (DC-ELAPSED-MONTHS > ZERO)
 12177              AND (DC-ELAPSED-DAYS > ZERO)
 12178              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12179           ELSE
 12180              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12181                                 THRU 6499-EXIT
 12182              MOVE WS-ODD-DAYS-OVER
 12183                                 TO PB-I-EXTENTION-DAYS
 12184           END-IF
 12185        END-IF
 12186     END-IF
 12187******************************************************************
 12188*                                                                *
 12189*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12190*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12191*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12192*            AND ANY ODD DAYS.                                   *
 12193*                                                                *
 12194******************************************************************
 12195
 12196     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12197                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12198     IF WS-LF-EARNINGS-CALC NOT = '4'
 12199        IF DC-ELAPSED-DAYS > ZEROS
 12200           MOVE ER-2681          TO WS-ERROR
 12201           PERFORM 9900-ERROR-FORMAT
 12202                                 THRU 9900-EXIT
 12203        END-IF
 12204     END-IF
 12205
 12206     IF WS-LF-EARNINGS-CALC NOT = '4'
 12207        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12208           MOVE ER-2681          TO WS-ERROR
 12209           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12210
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 223
* EL050.cbl
 12211     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12212        (PB-I-LF-TERM NOT = ZERO) AND
 12213         NOT NO-LIFE-COVERAGE
 12214          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12215          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12216          IF WS-LF-EARNINGS-CALC = '4'
 12217             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12218             PB-I-PAY-FREQUENCY
 12219          END-IF
 12220          MOVE ZERO              TO DC-ELAPSED-DAYS
 12221                                    DC-ODD-DAYS-OVER
 12222          MOVE 1                 TO DC-END-OF-MONTH
 12223          SET BIN-PLUS-ELAPSED        TO TRUE
 12224*         MOVE 6                 TO DC-OPTION-CODE
 12225          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12226          IF NO-CONVERSION-ERROR
 12227             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12228             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12229                (WS-LF-SPECIAL-CALC-CD = 'L')
 12230                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12231                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12232                  MOVE +1             TO DC-ELAPSED-MONTHS
 12233                  SET BIN-PLUS-ELAPSED  TO TRUE
 12234*                 MOVE 6              TO DC-OPTION-CODE
 12235                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12236                  IF NO-CONVERSION-ERROR
 12237                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12238
 12239* okay, i had to move the new att age edit down here because the
 12240* expiration date could get recalculated and i need the exp date
 12241     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12242        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12243        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12244        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12245           AND ZEROS
 12246           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12247           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12248           SET ELAPSED-BETWEEN-BIN TO TRUE
 12249           PERFORM 8500-DATE-CONVERT
 12250                                 THRU 8500-EXIT
 12251           IF NO-CONVERSION-ERROR
 12252              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12253                 MOVE ER-2669       TO WS-ERROR
 12254*                PERFORM 9900-ERROR-FORMAT
 12255*                                THRU 9900-EXIT
 12256              END-IF
 12257           END-IF
 12258        ELSE
 12259           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12260           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12261              MOVE ER-2669       TO WS-ERROR
 12262*             PERFORM 9900-ERROR-FORMAT
 12263*                                THRU 9900-EXIT
 12264           ELSE
 12265              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12266                 MOVE ER-1570    TO WS-ERROR
 12267                 PERFORM 9900-ERROR-FORMAT
 12268                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 224
* EL050.cbl
 12269              END-IF
 12270           END-IF
 12271        END-IF
 12272        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12273           AND ZEROS
 12274           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12275           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12276           SET ELAPSED-BETWEEN-BIN TO TRUE
 12277           PERFORM 8500-DATE-CONVERT
 12278                                 THRU 8500-EXIT
 12279           IF NO-CONVERSION-ERROR
 12280              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12281                 MOVE ER-2669       TO WS-ERROR
 12282*                PERFORM 9900-ERROR-FORMAT
 12283*                                THRU 9900-EXIT
 12284              END-IF
 12285           END-IF
 12286        ELSE
 12287           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12288             (PB-I-LF-TERM / 12)
 12289           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12290              MOVE ER-2669       TO WS-ERROR
 12291*             PERFORM 9900-ERROR-FORMAT
 12292*                                THRU 9900-EXIT
 12293           ELSE
 12294              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12295                 MOVE ER-1571    TO WS-ERROR
 12296                 PERFORM 9900-ERROR-FORMAT
 12297                                 THRU 9900-EXIT
 12298              END-IF
 12299           END-IF
 12300        END-IF
 12301        IF WS-ERROR = ER-2669
 12302           PERFORM 9900-ERROR-FORMAT
 12303                                 THRU 9900-EXIT
 12304        END-IF
 12305     END-IF
 12306     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12307        (PB-I-AH-TERM NOT = ZERO) AND
 12308         NOT NO-AH-COVERAGE
 12309          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12310             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12311             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12312             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12313          ELSE
 12314             IF WS-LF-EARNINGS-CALC = '4'
 12315                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12316                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12317                PB-I-PAY-FREQUENCY
 12318             ELSE
 12319                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12320                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12321             END-IF
 12322          END-IF
 12323          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12324                                         DC-ODD-DAYS-OVER
 12325          MOVE 1                      TO DC-END-OF-MONTH
 12326          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 225
* EL050.cbl
 12327*         MOVE 6                      TO DC-OPTION-CODE
 12328          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12329          IF NO-CONVERSION-ERROR
 12330             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12331     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12332        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12333        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12334        IF PB-I-BIRTHDAY > LOW-VALUES
 12335           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12336           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12337           SET ELAPSED-BETWEEN-BIN TO TRUE
 12338           PERFORM 8500-DATE-CONVERT
 12339                                 THRU 8500-EXIT
 12340           IF NO-CONVERSION-ERROR
 12341              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12342                 MOVE ER-3054       TO WS-ERROR
 12343*                PERFORM 9900-ERROR-FORMAT
 12344*                                THRU 9900-EXIT
 12345              END-IF
 12346           END-IF
 12347        ELSE
 12348           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12349           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12350              MOVE ER-3054       TO WS-ERROR
 12351*             PERFORM 9900-ERROR-FORMAT
 12352*                                THRU 9900-EXIT
 12353           END-IF
 12354        END-IF
 12355        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12356           AND ZEROS
 12357           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12358           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12359           SET ELAPSED-BETWEEN-BIN TO TRUE
 12360           PERFORM 8500-DATE-CONVERT
 12361                                 THRU 8500-EXIT
 12362           IF NO-CONVERSION-ERROR
 12363              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12364                 MOVE ER-3054       TO WS-ERROR
 12365*                PERFORM 9900-ERROR-FORMAT
 12366*                                THRU 9900-EXIT
 12367              END-IF
 12368           END-IF
 12369        ELSE
 12370           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12371             (PB-I-AH-TERM / 12)
 12372           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12373              MOVE ER-3054       TO WS-ERROR
 12374*             PERFORM 9900-ERROR-FORMAT
 12375*                                THRU 9900-EXIT
 12376           END-IF
 12377        END-IF
 12378        IF WS-ERROR = ER-3054
 12379           PERFORM 9900-ERROR-FORMAT
 12380                                 THRU 9900-EXIT
 12381        END-IF
 12382     END-IF
 12383     MOVE SPACE                       TO DC-END-OF-MONTH.
 12384
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 226
* EL050.cbl
 12385     IF PB-COMPANY-ID = 'NCB'
 12386        GO TO 3040-EDIT-EXTENSION-DAYS.
 12387
 12388     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12389       AND
 12390        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12391        NEXT SENTENCE
 12392     ELSE
 12393        GO TO 3040-EDIT-EXTENSION-DAYS.
 12394
 12395     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12396        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12397        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12398     ELSE
 12399        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12400        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12401
 12402     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12403*    MOVE '1'      TO DC-OPTION-CODE
 12404     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12405     IF (NO-CONVERSION-ERROR)
 12406        AND (DC-ELAPSED-MONTHS > +1)
 12407        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12408        MOVE ER-2668   TO WS-ERROR
 12409        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12410
 12411 3040-EDIT-EXTENSION-DAYS.
 12412
 12413     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12414        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12415         GO TO 3050-EDIT-TERM-IN-DAYS
 12416     ELSE
 12417         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12418
 12419     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12420         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12421     ELSE
 12422        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12423           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12424           MOVE ER-2681         TO WS-ERROR
 12425           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12426
 12427     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12428        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12429        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12430         GO TO 3060-ORIG-TERM-CHECK.
 12431
 12432     GO TO 3060-ORIG-TERM-CHECK.
 12433
 12434 3050-EDIT-TERM-IN-DAYS.
 12435
 12436     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12437
 12438     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12439         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12440     ELSE
 12441         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12442            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 227
* EL050.cbl
 12443            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12444
 12445     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12446                                       REMAINDER WS-WORK-TERM.
 12447     IF WS-WORK-TERM GREATER THAN ZERO
 12448         ADD +1 TO PB-I-LF-TERM.
 12449
 12450     IF NOT NO-AH-COVERAGE
 12451         MOVE ER-2684            TO WS-ERROR
 12452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12453
 12454
 12455 3060-ORIG-TERM-CHECK.
 12456
 12457******************************************************************
 12458*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12459******************************************************************
 12460
 12461     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12462        NEXT SENTENCE
 12463     ELSE
 12464        IF NOT NO-LIFE-COVERAGE
 12465           IF PB-I-LF-TERM NUMERIC
 12466              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12467              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12468              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12469                  NEXT SENTENCE
 12470           ELSE
 12471              MOVE ER-2647       TO WS-ERROR
 12472              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12473
 12474     IF NOT NO-AH-COVERAGE
 12475         IF PB-I-AH-TERM NUMERIC
 12476            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12477            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12478            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12479             NEXT SENTENCE
 12480          ELSE
 12481              MOVE ER-2658       TO WS-ERROR
 12482              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12483
 12484     IF PB-COMPANY-ID = 'NCB'
 12485        GO TO 3070-LOAN-TERM-CHECK.
 12486
 12487     IF POLICY-HAS-AH
 12488       AND
 12489        POLICY-HAS-LIFE
 12490       AND
 12491        PB-I-LF-TERM NUMERIC
 12492       AND
 12493        PB-I-AH-TERM NUMERIC
 12494        NEXT SENTENCE
 12495     ELSE
 12496        GO TO 3070-LOAN-TERM-CHECK.
 12497
 12498     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12499     IF WS-TEX-FACT-2 LESS THAN +0
 12500        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 228
* EL050.cbl
 12501
 12502     IF WS-TEX-FACT-2 GREATER THAN +1
 12503        MOVE ER-2668             TO WS-ERROR
 12504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12505
 12506 3070-LOAN-TERM-CHECK.
 12507
 12508     IF (WS-LF-BENEFIT-CD = ZERO)
 12509         OR (NO-LF-BENEFIT-MATCH)
 12510            GO TO 3125-EDIT-PMT-FREQ.
 12511*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12512*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12513*          AND 'V' AND 'W' AND 'X'
 12514*          GO TO 3125-EDIT-PMT-FREQ
 12515*       END-IF
 12516*    ELSE
 12517*       IF WS-AH-DCC-TRUNC = 'T'
 12518*          CONTINUE
 12519*       ELSE
 12520*          GO TO 3125-EDIT-PMT-FREQ
 12521*       END-IF
 12522*    END-IF
 12523     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12524                    OR
 12525        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12526        AND (WS-AH-DCC-TRUNC = 'T'))
 12527        CONTINUE
 12528     ELSE
 12529        GO TO 3125-EDIT-PMT-FREQ
 12530     END-IF
 12531     IF PB-I-LOAN-TERM NOT NUMERIC
 12532         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12533
 12534     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12535        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12536*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12537        PB-I-LOAN-TERM NOT GREATER THAN +360
 12538         NEXT SENTENCE
 12539     ELSE
 12540         MOVE ER-2648            TO WS-ERROR
 12541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12542
 12543     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12544        MOVE ER-3058             TO WS-ERROR
 12545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12546     end-if
 12547
 12548     IF WS-STATE-ABBREVIATION = 'NC'
 12549        IF PB-I-LOAN-TERM > +59
 12550           CONTINUE
 12551        ELSE
 12552           MOVE ER-2792          TO WS-ERROR
 12553           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12554        END-IF
 12555     END-IF
 12556
 12557     .
 12558 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 229
* EL050.cbl
 12559     IF (WS-LF-BENEFIT-CD = ZERO)
 12560         OR (NO-LF-BENEFIT-MATCH)
 12561            GO TO 3127-EDIT-LOAN-OFFICER.
 12562     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12563                    OR
 12564        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12565        AND (WS-AH-DCC-TRUNC = 'T'))
 12566                    OR
 12567         (PB-COMPANY-ID = 'AHL')
 12568        CONTINUE
 12569     ELSE
 12570        IF (PB-I-LOAN-TERM > ZEROS)
 12571           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12572           MOVE ER-1575          TO WS-ERROR
 12573           PERFORM 9900-ERROR-FORMAT
 12574                                 THRU 9900-EXIT
 12575        END-IF
 12576     END-IF
 12577     IF WS-LF-EARNINGS-CALC NOT = '4'
 12578         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12579            MOVE ER-2653         TO WS-ERROR
 12580            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12581            GO TO 3127-EDIT-LOAN-OFFICER
 12582         ELSE
 12583            GO TO 3127-EDIT-LOAN-OFFICER.
 12584
 12585     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12586         MOVE ER-2655            TO WS-ERROR
 12587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12588         GO TO 3127-EDIT-LOAN-OFFICER.
 12589
 12590     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12591         MOVE ER-2654            TO WS-ERROR
 12592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593         GO TO 3127-EDIT-LOAN-OFFICER.
 12594
 12595     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12596         GIVING WS-TEX-FACT-2
 12597             REMAINDER WS-TEX-FACT-3.
 12598
 12599*    IF WS-TEX-FACT-3 NOT = ZERO
 12600*       MOVE ER-2654             TO WS-ERROR
 12601*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12602
 12603
 12604 3127-EDIT-LOAN-OFFICER.
 12605
 12606     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12607        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12608           MOVE ER-2690          TO WS-ERROR
 12609           PERFORM 9900-ERROR-FORMAT
 12610                                 THRU 9900-EXIT
 12611        ELSE
 12612           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12613           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12614           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12615           MOVE PB-SV-STATE      TO LOFC-STATE
 12616           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 230
* EL050.cbl
 12617           MOVE PB-I-LOAN-OFFICER
 12618                                 TO LOFC-CODE
 12619           PERFORM 8586-READ-LOAN-OFFICER
 12620                                 THRU 8586-EXIT
 12621           IF (NOT LOFC-MASTER-FOUND)
 12622              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12623              MOVE ER-3006       TO WS-ERROR
 12624              PERFORM 9900-ERROR-FORMAT
 12625                                 THRU 9900-EXIT
 12626           END-IF
 12627        END-IF
 12628     END-IF
 12629     .
 12630 3129-EDIT-APR.
 12631
 12632     IF (WS-LF-BENEFIT-CD = ZERO)
 12633        OR (NO-LF-BENEFIT-MATCH)
 12634        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12635           GO TO 3130-EDIT-AGE
 12636*       ELSE
 12637*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12638*             GO TO 3130-EDIT-AGE
 12639*          END-IF
 12640        END-IF
 12641     END-IF
 12642
 12643     IF (WS-STATE-ABBREVIATION = 'OH')
 12644         AND (PB-I-RATE-CLASS NOT = 'L ')
 12645         AND (PB-I-LF-TERM GREATER THAN 60)
 12646         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12647         GO TO 3129-APR-CONT.
 12648
 12649     IF (WS-STATE-ABBREVIATION = 'RI')
 12650         AND (PB-I-LF-TERM GREATER THAN 60)
 12651         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12652         GO TO 3129-APR-CONT.
 12653
 12654     IF (WS-STATE-ABBREVIATION = 'UT')
 12655         AND (PB-I-LF-TERM GREATER THAN 62)
 12656         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12657         AND (PB-CERT-EFF-DT LESS WS-830901)
 12658         GO TO 3129-APR-CONT.
 12659
 12660     IF PB-COMPANY-ID = 'LAP'
 12661        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12662           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12663              MOVE ER-2656         TO WS-ERROR
 12664              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12665              GO TO 3130-EDIT-AGE.
 12666
 12667     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12668        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12669        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12670        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12671        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12672        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12673         GO TO 3130-EDIT-AGE.
 12674
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 231
* EL050.cbl
 12675 3129-APR-CONT.
 12676     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12677         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12678         GO TO 3130-EDIT-AGE.
 12679
 12680     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12681         WS-AH-BENEFIT-CD (1:1) = 'S')
 12682        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12683        AND (PB-I-LOAN-APR = ZERO)
 12684        MOVE ER-2657             TO WS-ERROR
 12685        PERFORM 9900-ERROR-FORMAT
 12686                                 THRU 9900-EXIT
 12687        GO TO 3130-EDIT-AGE
 12688     END-IF
 12689*    IF PB-I-LOAN-APR = ZERO
 12690*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12691*    END-IF
 12692
 12693     if pb-i-loan-apr = +99.9999
 12694        move er-2656             to ws-error
 12695        PERFORM 9900-ERROR-FORMAT
 12696                                 THRU 9900-EXIT
 12697        GO TO 3130-EDIT-AGE
 12698     end-if
 12699*    IF PB-I-LOAN-APR = ZERO
 12700*       MOVE ER-2656             TO WS-ERROR
 12701*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12702*       GO TO 3130-EDIT-AGE.
 12703
 12704*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12705     if pb-i-loan-apr not = +99.9999
 12706        IF PB-I-LOAN-APR > +30.000
 12707           MOVE ER-2657          TO WS-ERROR
 12708           PERFORM 9900-ERROR-FORMAT
 12709                                 THRU 9900-EXIT
 12710        end-if
 12711     end-if
 12712     .
 12713 3130-EDIT-AGE.
 12714
 12715******************************************************************
 12716*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12717******************************************************************
 12718
 12719     IF NOT NO-LIFE-COVERAGE
 12720        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12721           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12722               MOVE ER-2628             TO WS-ERROR
 12723               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12724
 12725     IF NOT NO-AH-COVERAGE
 12726        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12727           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12728               MOVE ER-2628         TO WS-ERROR
 12729               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12730
 12731 3133-SEX-CODE.
 12732     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 232
* EL050.cbl
 12733         IF WS-DEFAULT-SEX = 'M'
 12734             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12735          ELSE
 12736             IF WS-DEFAULT-SEX = 'F'
 12737             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12738
 12739     IF PB-I-INSURED-SEX = '1'
 12740         MOVE 'M' TO PB-I-INSURED-SEX.
 12741
 12742     IF PB-I-INSURED-SEX = '2'
 12743         MOVE 'F' TO PB-I-INSURED-SEX.
 12744
 12745 3134-SIG-SW-EDIT.
 12746     IF PB-I-SIG-SW = SPACE
 12747         MOVE 'N'                TO  PB-I-SIG-SW.
 12748
 12749     IF PB-COMPANY-ID = 'NCL'
 12750         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12751             NEXT SENTENCE
 12752         ELSE
 12753             MOVE ER-1923        TO  WS-ERROR
 12754             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12755     ELSE
 12756     IF PB-COMPANY-ID = 'CRI'
 12757         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12758             NEXT SENTENCE
 12759         ELSE
 12760             MOVE ER-2606        TO  WS-ERROR
 12761             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12762     ELSE
 12763     IF PB-COMPANY-ID = 'TMS'
 12764         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12765             NEXT SENTENCE
 12766         ELSE
 12767             MOVE ER-2689        TO  WS-ERROR
 12768             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12769     ELSE
 12770         IF PB-I-SIG-SW = 'Y' OR 'N'
 12771             NEXT SENTENCE
 12772         ELSE
 12773             MOVE ER-2651        TO  WS-ERROR
 12774             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12775
 12776     IF PB-COMPANY-ID = 'FLA'
 12777         IF (WS-EDIT-AGE GREATER 54  OR
 12778             WS-AH-EDIT-AGE GREATER 54)  AND
 12779            PB-I-SIG-SW = 'N'
 12780            MOVE ER-2651         TO  WS-ERROR
 12781            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12782
 12783 3135-NAME-EDIT.
 12784
 12785     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12786        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12787        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12788           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12789                                 TO PB-I-JOINT-FIRST-NAME
 12790        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 233
* EL050.cbl
 12791     END-IF
 12792     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12793        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12794        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12795           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12796                                 TO PB-I-JOINT-LAST-NAME
 12797        END-PERFORM
 12798     END-IF
 12799     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12800        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12801        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12802           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12803                                 TO PB-I-INSURED-FIRST-NAME
 12804        END-PERFORM
 12805     END-IF
 12806     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12807        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12808        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12809           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12810                                 TO PB-I-INSURED-LAST-NAME
 12811        END-PERFORM
 12812     END-IF
 12813     IF PB-I-INSURED-LAST-NAME = SPACES
 12814       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12815       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12816           MOVE ER-2660    TO WS-ERROR
 12817           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12818
 12819 3136-EDIT-SEX.
 12820
 12821******************************************************************
 12822*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12823******************************************************************
 12824
 12825     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12826        (WS-AH-SPECIAL-CALC-CD = 'O')
 12827        NEXT SENTENCE
 12828     ELSE
 12829        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12830           NEXT SENTENCE
 12831        ELSE
 12832           MOVE ER-2629            TO WS-ERROR
 12833           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12834
 12835 3137-EDIT-EFF-DATE.
 12836
 12837     IF PB-REISSUED-CERT       OR
 12838        PB-POLICY-IS-DECLINED  OR
 12839        PB-POLICY-IS-VOIDED
 12840         GO TO 3139-EDIT-COVERAGE-CODES.
 12841
 12842     MOVE SPACE                  TO WS-2671-SW
 12843                                    WS-2672-SW.
 12844
 12845     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12846         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12847             MOVE ER-2703        TO WS-ERROR
 12848             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 234
* EL050.cbl
 12849             GO TO 3139-EDIT-COVERAGE-CODES.
 12850
 12851     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12852         GO TO 3139-EDIT-COVERAGE-CODES.
 12853
 12854     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12855     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12856*    MOVE '1'                    TO DC-OPTION-CODE.
 12857     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12858     MOVE +0                     TO DC-ELAPSED-MONTHS
 12859                                    DC-ELAPSED-DAYS.
 12860     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12861
 12862     IF DATE-CONVERSION-ERROR
 12863         GO TO 3139-EDIT-COVERAGE-CODES.
 12864
 12865     IF DC-ELAPSED-DAYS GREATER +180
 12866         MOVE ER-2672            TO WS-ERROR
 12867         MOVE 'Y'                TO WS-2672-SW
 12868         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12869     END-IF
 12870
 12871     IF WS-ERROR = ER-2671  AND
 12872        PB-COMPANY-ID  = 'LBL'
 12873        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12874        MOVE SPACE               TO WS-2671-SW
 12875        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12876
 12877     IF PB-ISSUE-DATE-FORCED  AND
 12878      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12879         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12880         MOVE ER-2673            TO WS-ERROR
 12881         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12882         MOVE SPACE              TO WS-2671-SW
 12883                                    WS-2672-SW.
 12884
 12885     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12886         IF PB-ISSUE-DATE-FORCED
 12887             MOVE ER-2600          TO  WS-ERROR
 12888             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12889         ELSE
 12890             MOVE ER-2692          TO  WS-ERROR
 12891             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12892
 12893
 12894 3139-EDIT-COVERAGE-CODES.
 12895
 12896     if pb-company-id not = 'AHL'
 12897        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12898           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12899           MOVE ER-2787          TO WS-ERROR
 12900           PERFORM 9900-ERROR-FORMAT
 12901                                 THRU 9900-EXIT
 12902        END-IF
 12903     end-if
 12904     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12905        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12906                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 235
* EL050.cbl
 12907           MOVE ER-2719          TO WS-ERROR
 12908           PERFORM 9900-ERROR-FORMAT
 12909                                 THRU 9900-EXIT
 12910        END-IF
 12911     END-IF
 12912
 12913     IF PB-POLICY-IS-DECLINED  OR
 12914        PB-POLICY-IS-VOIDED
 12915         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12916
 12917     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12918        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12919         MOVE ER-2630                TO WS-ERROR
 12920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12921
 12922     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12923        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12924        PB-I-LF-PREMIUM-AMT = ZERO
 12925         GO TO 3140-CHECK-AH-FOR-ZERO.
 12926
 12927     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12928        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12929        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12930         GO TO 3140-CHECK-AH-FOR-ZERO.
 12931
 12932     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12933        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12934        MOVE ER-2631             TO WS-ERROR
 12935        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12936     END-IF
 12937
 12938
 12939******************************************************************
 12940*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12941******************************************************************
 12942
 12943     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12944        NEXT SENTENCE
 12945     ELSE
 12946        IF PB-I-LF-BENEFIT-AMT = ZERO
 12947           MOVE ER-2632             TO WS-ERROR
 12948           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12949
 12950
 12951******************************************************************
 12952*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12953******************************************************************
 12954
 12955     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12956        CONTINUE
 12957     ELSE
 12958        IF PB-I-LF-PREMIUM-AMT = ZERO
 12959           IF (NOT PB-COMP-LF-PREM)
 12960              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12961              and (ws-lf-ben-category not = 'C')
 12962              MOVE ER-2633       TO WS-ERROR
 12963              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12964           END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 236
* EL050.cbl
 12965        END-IF
 12966     END-IF
 12967     .
 12968 3140-CHECK-AH-FOR-ZERO.
 12969
 12970     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12971        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12972        PB-I-AH-PREMIUM-AMT = ZERO
 12973         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12974
 12975     IF PB-COMPANY-ID = 'CSL'  AND
 12976        PB-I-AH-BENEFIT-CD = ZERO  AND
 12977        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12978        PB-I-AH-PREMIUM-AMT = ZERO
 12979         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12980
 12981     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12982        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12983        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12984         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12985
 12986     IF PB-I-AH-BENEFIT-CD = ZERO
 12987         MOVE ER-2634            TO WS-ERROR
 12988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12989
 12990******************************************************************
 12991*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12992******************************************************************
 12993
 12994     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12995        NEXT SENTENCE
 12996     ELSE
 12997        IF PB-I-AH-BENEFIT-AMT = ZERO
 12998           MOVE ER-2635             TO WS-ERROR
 12999           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13000
 13001******************************************************************
 13002*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13003******************************************************************
 13004
 13005     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13006        NEXT SENTENCE
 13007     ELSE
 13008        IF PB-I-AH-PREMIUM-AMT = ZERO
 13009            IF NOT PB-COMP-AH-PREM
 13010                MOVE ER-2636    TO WS-ERROR
 13011                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13012
 13013
 13014 3140-EDIT-MAX-AMT-SIZES.
 13015* CUSTOM CODE FOR CLIENT    'DMD'
 13016     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13017                                     WS-RES-MUNI-TAX
 13018                                     PB-I-STATE-TAX
 13019                                     PB-I-MUNI-TAX.
 13020
 13021     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13022
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 237
* EL050.cbl
 13023     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13024        GO TO 3150-RATE-OUTSTAND-BAL.
 13025
 13026     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13027        GO TO 3150-RATE-OUTSTAND-BAL.
 13028
 13029     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13030        GO TO 3150-RATE-OUTSTAND-BAL.
 13031
 13032     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13033                             OR 'RIC')
 13034        GO TO 3150-RATE-OUTSTAND-BAL.
 13035
 13036     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13037        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13038            GO TO 3150-RATE-OUTSTAND-BAL
 13039        ELSE
 13040           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13041               GO TO 3150-RATE-OUTSTAND-BAL.
 13042
 13043     IF NOT PB-NO-MONTHS-SKIPPED
 13044        GO TO 3150-RATE-OUTSTAND-BAL.
 13045
 13046     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13047        GO TO 3150-RATE-OUTSTAND-BAL.
 13048
 13049     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13050        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13051           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13052             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13053           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13054           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13055              MOVE ER-2693     TO WS-ERROR
 13056              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13057              GO TO 3150-RATE-OUTSTAND-BAL
 13058           ELSE
 13059              GO TO 3150-RATE-OUTSTAND-BAL.
 13060
 13061 3150-RATE-OUTSTAND-BAL.
 13062
 13063* DMD RATING TEST
 13064     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13065         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13066         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13067         MOVE ER-2687                 TO WS-ERROR
 13068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13069         MOVE 'B'                     TO PB-I-OB-FLAG
 13070         GO TO 3260-EDIT-CONTINUE.
 13071
 13072     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13073         IF  WS-ERROR    EQUAL    ER-2693
 13074             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13075                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13076                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13077                 MOVE  +0            TO  WS-ERROR.
 13078
 13079     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13080         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 238
* EL050.cbl
 13081             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13082                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13083                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13084                 MOVE  +0            TO  WS-ERROR.
 13085
 13086     IF PLAN-MASTER-AH-SW = 'Y'
 13087        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13088            IF  WS-ERROR    EQUAL    ER-2693
 13089              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13090                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13091                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13092                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13093                 MOVE  ER-1910           TO  WS-ERROR
 13094                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13095
 13096     IF PLAN-MASTER-AH-SW = 'Y'
 13097        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13098            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13099               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13100               MOVE  ER-1910           TO  WS-ERROR
 13101               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13102
 13103     IF PLAN-MASTER-AH-SW = 'Y'
 13104        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13105            IF  WS-ERROR    EQUAL    ER-2693
 13106                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13107                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13108                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13109                 MOVE  +0       TO  WS-ERROR.
 13110
 13111     IF WS-ERROR = ER-2693
 13112        IF PB-COMPANY-ID = 'JAL' AND
 13113           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13114           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13115           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13116
 13117     IF WS-ERROR = ER-2693
 13118        IF PB-COMPANY-ID = 'NCL'  AND
 13119           PB-I-AH-BENEFIT-CD = 'OA'
 13120           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13121           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13122
 13123     IF WS-ERROR = ER-2693
 13124        IF PB-COMPANY-ID = 'CNL' AND
 13125           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13126           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13127           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13128
 13129     IF WS-ERROR = ER-2693
 13130        IF PB-COMPANY-ID = 'HER'
 13131           IF WS-LEVEL
 13132              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13133              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13134
 13135     IF ((LF-BENEFIT-FOUND) AND
 13136         (NOT NO-LIFE-COVERAGE)  AND
 13137         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13138       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 239
* EL050.cbl
 13139             (NOT NO-AH-COVERAGE)    AND
 13140             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13141         NEXT SENTENCE
 13142     ELSE
 13143         GO TO 3215-EDIT-RATES.
 13144
 13145     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13146        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13147           MOVE ER-2674          TO WS-ERROR
 13148           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13149           GO TO 3215-EDIT-RATES.
 13150
 13151     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13152        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13153           MOVE ER-2674          TO WS-ERROR
 13154           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13155           GO TO 3215-EDIT-RATES.
 13156
 13157     MOVE 'B'                    TO PB-I-OB-FLAG.
 13158
 13159     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13160         NEXT SENTENCE
 13161     ELSE
 13162         IF NOT NO-LIFE-COVERAGE
 13163             IF WS-ACCT-LF-OB-RT = ZERO
 13164                MOVE ER-2641    TO WS-ERROR
 13165                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13166
 13167     IF PB-COMPANY-ID = 'CRI'
 13168       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13169         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13170         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13171         IF WS-ERROR = ER-2675
 13172            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13173            MOVE ER-2687              TO WS-ERROR
 13174            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13175         ELSE
 13176            MOVE ER-2687              TO WS-ERROR
 13177            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13178
 13179
 13180     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13181         NEXT SENTENCE
 13182     ELSE
 13183       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13184            NEXT SENTENCE
 13185       ELSE
 13186         IF NOT NO-AH-COVERAGE
 13187             IF WS-ACCT-AH-OB-RT = ZERO
 13188                MOVE ER-2642    TO WS-ERROR
 13189                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13190
 13191     IF PB-COMPANY-ID = 'CRI'
 13192       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13193         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13194         IF WS-ERROR = ER-2676
 13195            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13196            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 240
* EL050.cbl
 13197            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13198         ELSE
 13199            MOVE ER-2687              TO WS-ERROR
 13200            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13201
 13202     IF PB-COMPANY-ID NOT = 'GIC'
 13203         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13204            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13205     ELSE
 13206         IF PB-I-LF-PREM-CALC = ZEROS
 13207             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13208                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13209
 13210     IF PB-COMPANY-ID NOT = 'GIC'
 13211         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13212            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13213     ELSE
 13214         IF PB-I-AH-PREM-CALC = ZEROS
 13215             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13216                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13217
 13218     MOVE ZEROS TO PB-I-MORT-CODE.
 13219
 13220     GO TO 3260-EDIT-CONTINUE.
 13221
 13222
 13223 3215-EDIT-RATES.
 13224     IF ACCOUNT-MAST-FOUND
 13225         NEXT SENTENCE
 13226     ELSE
 13227         GO TO 3999-END-EDIT.
 13228
 13229 3220-CHECK-LF-RATES.
 13230
 13231     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13232        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13233        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13234        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13235           AND (NOT WS-LF-CASH))
 13236                           OR
 13237           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13238           AND (NOT WS-AH-CASH)))
 13239                       AND
 13240           (PB-I-ENTRY-STATUS NOT = '5')
 13241           MOVE 'M'              TO PB-BATCH-ENTRY
 13242                                    PB-I-ENTRY-STATUS
 13243        END-IF
 13244     END-IF
 13245     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13246                                    PB-I-AH-PREM-CALC
 13247                                    PB-I-LF-ALT-PREM-CALC
 13248                                    PB-I-LF-ALT-RATE
 13249                                    PB-I-LF-REI-RATE
 13250                                    PB-I-LF-ALT-REI-RATE
 13251                                    PB-I-AH-REI-RATE
 13252                                    PB-I-TOT-FEES-CALC.
 13253
 13254     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 241
* EL050.cbl
 13255        NEXT SENTENCE
 13256     ELSE
 13257        MOVE ZEROS               TO PB-I-LF-RATE
 13258                                    PB-I-AH-RATE.
 13259
 13260     IF PB-I-TOT-FEES NOT NUMERIC
 13261        MOVE ZEROS               TO PB-I-TOT-FEES
 13262     END-IF
 13263     IF PB-I-LIVES NOT NUMERIC
 13264         MOVE ZERO               TO PB-I-LIVES.
 13265
 13266     IF PB-I-NUM-BILLED NOT NUMERIC
 13267         MOVE ZERO               TO PB-I-NUM-BILLED.
 13268
 13269     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13270        MOVE +0                  TO PB-I-LF-PREM-TAX
 13271     END-IF
 13272
 13273     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13274        MOVE +0                  TO PB-I-AH-PREM-TAX
 13275     END-IF
 13276
 13277     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13278        PB-I-PAY-FREQUENCY = ZEROS
 13279            MOVE 12 TO CP-PAY-FREQUENCY
 13280     ELSE
 13281            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13282
 13283     IF PB-I-STATE-TAX NOT NUMERIC
 13284         MOVE ZEROS               TO PB-I-STATE-TAX.
 13285
 13286     IF PB-I-MUNI-TAX NOT NUMERIC
 13287         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13288
 13289     MOVE SPACES                 TO CP-BEN-CATEGORY
 13290     IF PB-COMPANY-ID  = 'CSL'  AND
 13291        PB-I-LF-TERM NOT = ZERO
 13292        COMPUTE WS-PAYMENT-AMT =
 13293             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13294        COMPUTE WS-CSL-AMT1 =
 13295             PB-I-LF-TERM * AM-MAX-MON-BEN
 13296        COMPUTE WS-CSL-AMT2 =
 13297             WS-PAYMENT-AMT * PB-I-LF-TERM
 13298        IF CP-PAY-FREQUENCY NOT = 12
 13299           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13300           MOVE '8' TO WS-CSL-CALC-CD
 13301        ELSE
 13302           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13303              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13304               AM-MAX-TOT-BEN
 13305               MOVE '6' TO WS-CSL-CALC-CD
 13306           ELSE
 13307              IF (WS-CSL-AMT1  GREATER THAN
 13308                 AM-MAX-TOT-BEN) AND
 13309                 (WS-CSL-AMT2  GREATER THAN
 13310                 AM-MAX-TOT-BEN)
 13311                 MOVE '7' TO WS-CSL-CALC-CD
 13312              ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 242
* EL050.cbl
 13313                 MOVE '5' TO WS-CSL-CALC-CD.
 13314
 13315     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13316         NEXT SENTENCE
 13317     ELSE
 13318         GO TO 3300-CHECK-AH-RATES.
 13319
 13320*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13321
 13322     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13323        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13324              OR
 13325           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13326           MOVE ER-2618          TO WS-ERROR
 13327           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13328           GO TO 3300-CHECK-AH-RATES.
 13329
 13330     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13331           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13332                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13333
 13334     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13335         MOVE ER-2687             TO WS-ERROR
 13336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13337         MOVE 'Z000'              TO PB-I-MORT-CODE
 13338         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13339         GO TO 3300-CHECK-AH-RATES.
 13340
 13341     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13342        IF PB-I-LIVES = ZERO
 13343           MOVE ER-2688          TO WS-ERROR
 13344           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13345
 13346     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13347
 13348     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13349     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13350     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13351     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13352     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13353     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13354     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13355     MOVE '3'                    TO CP-PROCESS-TYPE.
 13356     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13357     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13358
 13359******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13360     IF PB-COMPANY-ID EQUAL 'CDL'
 13361         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13362            CP-EARN-AS-NET-PAY)
 13363             IF PB-CERT-EFF-DT GREATER  WS-931231
 13364                 MOVE '1'        TO CP-EARNING-METHOD.
 13365*******
 13366
 13367     MOVE PB-SV-STATE            TO CP-STATE.
 13368     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13369     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13370     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 243
* EL050.cbl
 13371     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13372     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13373                                    CP-RATING-BENEFIT-AMT.
 13374     IF CP-STATE-STD-ABBRV = 'OR'
 13375         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13376                                         PB-I-LF-ALT-BENEFIT-AMT.
 13377     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13378     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13379     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13380     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13381     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13382     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13383     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13384     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13385     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13386                                    CP-REMAINING-TERM
 13387                                    CP-LOAN-TERM.
 13388
 13389     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13390         NEXT SENTENCE
 13391     ELSE
 13392         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13393             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13394                                           PB-I-LF-PREMIUM-AMT.
 13395
 13396     IF PB-COMPANY-ID EQUAL 'CSL'
 13397        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13398           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13399                                         PB-I-LF-PREMIUM-AMT.
 13400
 13401     IF PB-COMPANY-ID EQUAL 'NCB'
 13402         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13403            CP-EARN-AS-NET-PAY
 13404             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13405                 PB-I-LF-PREMIUM-AMT.
 13406
 13407     IF (CP-TRUNCATED-LIFE)
 13408        or ((pb-company-id = 'AHL')
 13409           and (pb-i-loan-term > pb-i-lf-term))
 13410        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13411
 13412     IF PB-COMPANY-ID EQUAL 'CRI'
 13413        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13414
 13415     IF CP-TERM-IS-DAYS
 13416         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13417     ELSE
 13418         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13419     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13420        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13421        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13422        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13423        IF WS-LF-BEN-CATEGORY = 'D'
 13424           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13425           MOVE PB-I-LIFE-COMMISSION
 13426                                 TO CP-DCC-ACT-COMM
 13427           MOVE WS-LF-BEN-CATEGORY
 13428                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 244
* EL050.cbl
 13429        END-IF
 13430        IF (CP-BENEFIT-CD (1:1) = 'P')
 13431           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13432           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13433           add pb-i-ah-premium-amt to cp-original-premium
 13434        END-IF
 13435     END-IF
 13436     IF PB-COMPANY-ID = 'CSL'
 13437         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13438         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13439         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13440
 13441     IF PB-COMPANY-ID = 'CSL'
 13442        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13443
 13444     IF (CP-SPECIAL-CALC-CD = 'H')
 13445        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13446         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13447                                    TO CP-ALTERNATE-BENEFIT
 13448         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13449     if (pb-company-id = 'CID')
 13450        and (ws-lf-earnings-calc = '4')
 13451        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13452        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13453        move pb-i-term-type      to cp-pmt-mode
 13454        move pb-i-no-of-payments to cp-no-of-pmts
 13455     end-if
 13456     move ws-net-only-state      to cp-net-only-state
 13457     IF (PB-COMPANY-ID = 'CID')
 13458        AND (WS-LF-EARNINGS-CALC = 'B')
 13459        AND (CP-STATE-STD-ABBRV = 'MN')
 13460        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13461                                 TO CP-ALTERNATE-BENEFIT
 13462        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13463     END-IF
 13464     IF (PB-COMPANY-ID = 'CID')
 13465        AND (WS-LF-EARNINGS-CALC = 'B')
 13466        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13467                                 TO CP-ALTERNATE-BENEFIT
 13468        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13469        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13470*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13471*         pb-i-lf-alt-premium-amt
 13472        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13473        IF WS-LF-BEN-CATEGORY = 'P'
 13474           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13475        ELSE
 13476           IF WS-LF-BEN-CATEGORY = 'I'
 13477              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13478           END-IF
 13479        END-IF
 13480     END-IF
 13481     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13482     MOVE 'R'                   TO CP-RATE-FILE.
 13483     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13484
 13485     IF CP-ERROR-RATE-NOT-FOUND
 13486        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 245
* EL050.cbl
 13487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13488        GO TO 3300-CHECK-AH-RATES.
 13489
 13490     IF PB-COMPANY-ID EQUAL 'CRI'
 13491        IF CP-ERROR-NO-LIMITS-CRI
 13492           IF NOT ACCOUNT-LIFE-CHECKED
 13493              MOVE ER-2607      TO WS-ERROR
 13494              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13495
 13496******************************************************************
 13497*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13498*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13499******************************************************************
 13500
 13501* CALC LIFE AGE AT EXPIRATION.
 13502
 13503     COMPUTE WS-AGE-AT-EXPIRE =
 13504          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13505
 13506*    IF PB-STATE = 'CO' OR 'UT'
 13507*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13508*        MOVE 'F'            TO PB-FATAL-FLAG
 13509*        MOVE ER-2709        TO WS-ERROR
 13510*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13511*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13512
 13513*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13514*        MOVE 'X'            TO PB-FATAL-FLAG
 13515*        MOVE ER-2718        TO WS-ERROR
 13516*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13517*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13518
 13519* CALC A & H AGE AT EXPIRATION.
 13520
 13521     COMPUTE WS-AGE-AT-EXPIRE =
 13522          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13523
 13524*    IF PB-STATE = 'CO' OR 'UT'
 13525*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13526*        MOVE 'F'            TO PB-FATAL-FLAG
 13527*        MOVE ER-2709        TO WS-ERROR
 13528*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13529*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13530
 13531*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13532*        MOVE 'X'            TO PB-FATAL-FLAG
 13533*        MOVE ER-2718        TO WS-ERROR
 13534*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13535*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13536
 13537     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13538        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13539
 13540     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13541        and (not pb-monthly-cert)
 13542        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13543     end-if
 13544
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 246
* EL050.cbl
 13545     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13546        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13547
 13548     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13549         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13550         MOVE ER-2639        TO WS-ERROR
 13551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13552
 13553
 13554******************************************************************
 13555*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13556******************************************************************
 13557
 13558 PREMIUM-EDITING-IS-BYPASSED.
 13559     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13560        AND (CP-R-MAX-ATT-AGE > +0)
 13561        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13562        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13563           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13564           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13565           MOVE '1'              TO DC-OPTION-CODE
 13566           PERFORM 8500-DATE-CONVERT
 13567                                 THRU 8500-EXIT
 13568           IF NO-CONVERSION-ERROR
 13569              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13570                 MOVE ER-2661       TO WS-ERROR
 13571*                PERFORM 9900-ERROR-FORMAT
 13572*                                THRU 9900-EXIT
 13573              END-IF
 13574           END-IF
 13575        ELSE
 13576           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13577           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13578              MOVE ER-2661       TO WS-ERROR
 13579*             PERFORM 9900-ERROR-FORMAT
 13580*                                THRU 9900-EXIT
 13581           ELSE
 13582              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13583                 MOVE ER-1570    TO WS-ERROR
 13584                 PERFORM 9900-ERROR-FORMAT
 13585                                 THRU 9900-EXIT
 13586              END-IF
 13587           END-IF
 13588        END-IF
 13589        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13590           MOVE PB-I-JOINT-BIRTHDAY
 13591                                 TO DC-BIN-DATE-1
 13592           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13593           MOVE '1'              TO DC-OPTION-CODE
 13594           PERFORM 8500-DATE-CONVERT
 13595                                 THRU 8500-EXIT
 13596           IF NO-CONVERSION-ERROR
 13597              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13598                 MOVE ER-2661       TO WS-ERROR
 13599*                PERFORM 9900-ERROR-FORMAT
 13600*                                THRU 9900-EXIT
 13601              END-IF
 13602           ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 247
* EL050.cbl
 13603              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13604           END-IF
 13605        ELSE
 13606           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13607             (PB-I-LF-TERM / 12)
 13608           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13609              MOVE ER-2661       TO WS-ERROR
 13610*             PERFORM 9900-ERROR-FORMAT
 13611*                                THRU 9900-EXIT
 13612           ELSE
 13613              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13614                 MOVE ER-1571    TO WS-ERROR
 13615                 PERFORM 9900-ERROR-FORMAT
 13616                                 THRU 9900-EXIT
 13617              END-IF
 13618           END-IF
 13619        END-IF
 13620        IF WS-ERROR = ER-2661
 13621           PERFORM 9900-ERROR-FORMAT
 13622                                 THRU 9900-EXIT
 13623        END-IF
 13624     END-IF
 13625*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13626*       MOVE ER-2661             TO WS-ERROR
 13627*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13628
 13629     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13630        MOVE ER-2662             TO WS-ERROR
 13631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13632
 13633     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13634        MOVE ER-2677             TO WS-ERROR
 13635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13636
 13637     IF CP-ERROR-LOAN-TERM
 13638        MOVE ER-2648             TO WS-ERROR
 13639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13640
 13641 3221-CHECK-ERROR-RATE-OPEN.
 13642
 13643     IF CP-ERROR-RATE-FILE-NOTOPEN
 13644         GO TO 3990-FILES-NOT-OPEN.
 13645
 13646     IF PB-COMPANY-ID NOT = 'DMD'
 13647        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13648     END-IF
 13649     .
 13650 3221-CONTINUE.
 13651     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13652                                    WS-DCC-AH-RATE
 13653     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13654        IF WS-LF-BEN-CATEGORY = 'D'
 13655           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13656              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13657        END-IF
 13658     END-IF
 13659     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13660*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 248
* EL050.cbl
 13661     IF (PB-COMPANY-ID = 'CID')
 13662        AND (WS-LF-EARNINGS-CALC = 'B')
 13663        AND (CP-STATE-STD-ABBRV = 'MN')
 13664        AND (PB-CERT-EFF-DT > X'A4FF')
 13665        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13666     END-IF
 13667     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13668
 13669     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13670     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13671        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13672        AND (PB-I-POLICY-IS-MONTHLY)
 13673        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13674        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13675     END-IF
 13676     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13677     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13678     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13679     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13680     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13681        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13682        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13683        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13684        MOVE ER-2786             TO WS-ERROR
 13685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13686     END-IF
 13687
 13688     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13689
 13690******************************************************************
 13691*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13692******************************************************************
 13693     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13694        and ((not pb-monthly-cert)
 13695        or (ws-lf-ben-category = 'C'))
 13696        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13697
 13698     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13699        GO TO 3225-CHECK-ALT-LIFE-RATE
 13700     ELSE
 13701       IF PB-I-LF-RATE = ZERO
 13702          MOVE ER-2641          TO WS-ERROR
 13703          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13704
 13705 3225-CHECK-ALT-LIFE-RATE.
 13706
 13707     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13708        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13709        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13710         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13711
 13712     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13713         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13714             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13715                   OR
 13716              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13717              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13718              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 249
* EL050.cbl
 13719             MOVE ER-2720        TO  WS-ERROR
 13720             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13721             GO TO 3225-RATING-CONT
 13722         ELSE
 13723             GO TO 3225-RATING-CONT.
 13724     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13725        AND (AM-GPCD = 01 OR 06 OR 15)
 13726        MOVE ER-2798             TO WS-ERROR
 13727        PERFORM 9900-ERROR-FORMAT
 13728                                 THRU 9900-EXIT
 13729*       GO TO 3225-RATING-CONT
 13730     END-IF
 13731     if (pb-company-id = 'CID')
 13732        and (ws-lf-earnings-calc = 'B')
 13733        and (ws-lf-ben-category = 'P' or 'I')
 13734        and (ws-net-only-state = 'Y')
 13735        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13736        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13737        go to 3225-rating-cont
 13738     end-if
 13739     IF (PB-COMPANY-ID = 'CID')
 13740        AND (WS-LF-EARNINGS-CALC = 'B')
 13741        AND (CP-STATE-STD-ABBRV = 'MN')
 13742        AND (PB-CERT-EFF-DT > X'A4FF')
 13743        GO TO 3225-RATING-CONT
 13744     END-IF
 13745     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13746        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13747           AND (PB-I-POLICY-IS-MONTHLY)
 13748           GO TO 3225-RATING-CONT
 13749        END-IF
 13750     END-IF
 13751
 13752     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13753        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13754        CP-EARN-AS-REG-BALLOON
 13755        NEXT SENTENCE
 13756     ELSE
 13757        MOVE '2'                 TO CP-EARNING-METHOD.
 13758
 13759 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13760
 13761     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13762
 13763     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13764        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13765        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13766         NEXT SENTENCE
 13767     ELSE
 13768         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13769
 13770     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13771     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13772     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13773                                     CP-RATING-BENEFIT-AMT.
 13774     IF CP-STATE-STD-ABBRV = 'OR'
 13775         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13776                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 250
* EL050.cbl
 13777     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13778        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13779     END-IF
 13780     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13781     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13782     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13783                                    CP-REMAINING-TERM
 13784                                    CP-LOAN-TERM.
 13785     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13786        ADD +1                   TO CP-ORIGINAL-TERM
 13787                                    CP-REMAINING-TERM
 13788                                    CP-LOAN-TERM.
 13789
 13790     MOVE 'R'                   TO CP-RATE-FILE.
 13791     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13792
 13793     IF CP-ERROR-RATE-NOT-FOUND
 13794         MOVE ER-2641            TO WS-ERROR
 13795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13796         GO TO 3300-CHECK-AH-RATES.
 13797
 13798     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13799     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13800
 13801     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13802         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13803
 13804     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13805                               + PB-I-LF-ALT-BENEFIT-AMT.
 13806
 13807     IF ACCOUNT-LIFE-CHECKED  OR
 13808        PB-POLICY-IS-VOIDED   OR
 13809        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13810        and (not pb-monthly-cert))
 13811        GO TO 3225-CONTINUE.
 13812
 13813     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13814        GO TO 3225-CONTINUE.
 13815
 13816     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13817                             EC-RT-LF-MAX-TOT-BEN
 13818        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13819        MOVE ER-2639       TO WS-ERROR
 13820        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13821
 13822 3225-CONTINUE.
 13823     IF PB-I-LF-ALT-RATE = ZERO
 13824         MOVE ER-2659            TO WS-ERROR
 13825         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13826
 13827     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13828        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13829        MOVE ER-2698             TO WS-ERROR
 13830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13831
 13832 3225-RATING-CONT.
 13833
 13834     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 251
* EL050.cbl
 13835        and (not pb-monthly-cert)
 13836         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13837         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13838         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13839            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13840            CONTINUE
 13841         ELSE
 13842            MOVE ER-2687         TO WS-ERROR
 13843            PERFORM 9900-ERROR-FORMAT
 13844                                 THRU 9900-EXIT
 13845         END-IF
 13846         GO TO 3290-EDIT-LF-REIN-RATE
 13847     END-IF
 13848
 13849* DMD RATING TEST
 13850     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13851         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13852         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13853         MOVE ER-2687                 TO WS-ERROR
 13854         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13855         GO TO 3290-EDIT-LF-REIN-RATE.
 13856
 13857 3230-CLIENT-MORT-CD-SPECIALS.
 13858
 13859     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13860     SET BIN-TO-GREG          TO TRUE.
 13861*    MOVE ' '                 TO DC-OPTION-CODE.
 13862     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13863     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13864
 13865 C-POS-3230-MORT-CD.
 13866     IF PB-COMPANY-ID = 'POS' AND
 13867        PB-SV-CARRIER = '2'
 13868         NEXT SENTENCE
 13869     ELSE
 13870         GO TO C-POS-3240-MORT-CD.
 13871
 13872     IF PB-SV-GROUPING = '030'
 13873        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13874         MOVE '2350' TO PB-I-MORT-CODE
 13875      ELSE
 13876         MOVE '3300' TO PB-I-MORT-CODE.
 13877
 13878
 13879 C-POS-3240-MORT-CD.
 13880     IF PB-COMPANY-ID = 'POS' AND
 13881        PB-SV-CARRIER = '1'
 13882         NEXT SENTENCE
 13883     ELSE
 13884         GO TO 3230-CONTINUE.
 13885
 13886     IF PB-SV-STATE = '45' OR '47'
 13887        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13888         MOVE '5200' TO PB-I-MORT-CODE
 13889     ELSE
 13890         MOVE '8300' TO PB-I-MORT-CODE.
 13891
 13892 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 252
* EL050.cbl
 13893
 13894     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13895        GO TO 3240-CONTINUE
 13896     END-IF
 13897
 13898     IF PB-CERT-EFF-DT > WS-971231
 13899        GO TO 3240-CONTINUE
 13900     END-IF
 13901
 13902     IF LF-BENEFIT-FOUND AND
 13903        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13904         MOVE 'F250'       TO PB-I-MORT-CODE
 13905     ELSE
 13906         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13907             MOVE '7250'   TO PB-I-MORT-CODE
 13908         ELSE
 13909             MOVE '4251'   TO PB-I-MORT-CODE
 13910         END-IF
 13911     END-IF
 13912
 13913     .
 13914 3240-CONTINUE.
 13915
 13916     IF PB-COMPANY-ID NOT = 'GNL'
 13917         GO TO 3256-CONTINUE.
 13918
 13919     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13920         MOVE 'A300' TO PB-I-MORT-CODE
 13921     ELSE
 13922         MOVE '8350' TO PB-I-MORT-CODE.
 13923
 13924 3256-CONTINUE.
 13925     IF PB-COMPANY-ID NOT = 'ABL'
 13926         GO TO 3260-EDIT-CONTINUE.
 13927
 13928     IF PB-I-LF-TERM GREATER THAN 59
 13929         MOVE 'F550' TO PB-I-MORT-CODE
 13930     ELSE
 13931         MOVE 'E550' TO PB-I-MORT-CODE.
 13932
 13933 3260-EDIT-CONTINUE.
 13934     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13935
 13936 3290-EDIT-LF-REIN-RATE.
 13937     IF LF-REIN-NSP-NOT-USED
 13938         GO TO 3290-RATING-CONT.
 13939
 13940     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13941        GO TO 3290-RATING-CONT.
 13942     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13943     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13944     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13945     MOVE '3'                   TO CP-PROCESS-TYPE.
 13946     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13947
 13948******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13949     IF PB-COMPANY-ID EQUAL 'CDL'
 13950         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 253
* EL050.cbl
 13951            CP-EARN-AS-NET-PAY)
 13952             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13953*            MOVE SPACE          TO DC-OPTION-CODE
 13954             SET BIN-TO-GREG     TO TRUE
 13955             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13956***  Y2K PROJ 7744
 13957             IF DC-GREG-DATE-CYMD GREATER 19931231
 13958                 MOVE '1'        TO CP-EARNING-METHOD.
 13959***  Y2K PROJ 7744
 13960*******
 13961
 13962     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13963     MOVE PB-SV-STATE           TO CP-STATE.
 13964     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13965     MOVE ZERO                  TO CP-DEVIATION-CODE
 13966                                   CP-RATE-DEV-PCT.
 13967     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13968     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13969                                   CP-RATING-BENEFIT-AMT.
 13970
 13971************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13972     IF PB-COMPANY-ID EQUAL 'NCB'
 13973         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13974            CP-EARN-AS-NET-PAY
 13975             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13976                 PB-I-LF-PREMIUM-AMT.
 13977************
 13978
 13979     IF CP-STATE-STD-ABBRV = 'OR'
 13980         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13981                                         PB-I-LF-ALT-BENEFIT-AMT.
 13982     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13983     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13984     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13985     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13986     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13987     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13988     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13989     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13990                                   CP-REMAINING-TERM
 13991                                   CP-LOAN-TERM.
 13992     IF CP-TRUNCATED-LIFE
 13993        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13994
 13995     IF CP-TERM-IS-DAYS
 13996         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13997     ELSE
 13998         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13999
 14000     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14001        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14002     END-IF
 14003     IF PB-COMPANY-ID NOT = 'TIC'
 14004          MOVE ZERO          TO CP-CLASS-CODE.
 14005
 14006     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14007
 14008     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 254
* EL050.cbl
 14009     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14010
 14011     IF CP-ERROR-RATE-NOT-FOUND
 14012        IF PB-I-OB
 14013           MOVE ER-2625      TO WS-ERROR
 14014           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14015           GO TO 3299-EDIT-CONTINUE
 14016        ELSE
 14017           MOVE ER-2643      TO WS-ERROR
 14018           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14019           GO TO 3299-EDIT-CONTINUE.
 14020
 14021     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14022
 14023     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14024     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14025
 14026     IF PB-I-LF-REI-RATE = ZERO
 14027         MOVE ER-2643        TO WS-ERROR
 14028         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14029
 14030 3290-CHECK-ALT-REIN-RATE.
 14031
 14032     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14033        GO TO 3290-RATING-CONT.
 14034
 14035     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14036     MOVE '2'                    TO CP-EARNING-METHOD.
 14037     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14038     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14039     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14040     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14041                                     CP-RATING-BENEFIT-AMT.
 14042     IF CP-STATE-STD-ABBRV = 'OR'
 14043         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14044                                         PB-I-LF-ALT-BENEFIT-AMT.
 14045     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14046        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14047     END-IF
 14048     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14049     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14050     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14051                                    CP-REMAINING-TERM
 14052                                    CP-LOAN-TERM.
 14053     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14054        ADD +1                   TO CP-ORIGINAL-TERM
 14055                                    CP-REMAINING-TERM
 14056                                    CP-LOAN-TERM.
 14057
 14058     MOVE 'R'                   TO CP-RATE-FILE.
 14059     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14060
 14061     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14062
 14063     IF PB-I-LF-ALT-REI-RATE = ZERO
 14064         MOVE ER-2643            TO WS-ERROR
 14065         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14066
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 255
* EL050.cbl
 14067 3290-RATING-CONT.
 14068
 14069     IF PB-I-OB
 14070*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14071        GO TO 3300-CHECK-AH-RATES.
 14072
 14073 3299-EDIT-CONTINUE.
 14074
 14075     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14076         NEXT SENTENCE
 14077     ELSE
 14078         MOVE ER-2620           TO WS-ERROR
 14079         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14080
 14081 3300-CHECK-AH-RATES.
 14082     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14083         NEXT SENTENCE
 14084     ELSE
 14085         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14086
 14087     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14088        and (not pb-monthly-cert))
 14089                  or
 14090        ((CF-COMPANY-ID = 'DMD') AND
 14091                (NO-DMD-RATING))
 14092         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14093            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14094            CONTINUE
 14095         ELSE
 14096            MOVE ER-2687         TO WS-ERROR
 14097            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14098         END-IF
 14099         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14100         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14101     END-IF
 14102
 14103     IF PB-I-OB
 14104        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14105
 14106     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14107         MOVE ER-2687             TO WS-ERROR
 14108         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14109         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14110         GO TO 3999-END-EDIT.
 14111
 14112*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14113     if pb-company-id = 'AHL'
 14114        go to 3300-skip-crit-per
 14115     end-if
 14116     if (pb-i-ah-crit-per not = zeros)
 14117        and (ws-ah-special-calc-cd not = 'C')
 14118        MOVE ER-1572             TO WS-ERROR
 14119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14120        go to 3300-skip-crit-per
 14121     END-IF
 14122     if (pb-company-id = 'DCC' or 'VPP')
 14123        and (am-dcc-product-code not = spaces)
 14124        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 256
* EL050.cbl
 14125     end-if
 14126     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14127        IF PB-I-AH-CRIT-PER = ZERO
 14128           move ws-ah-max-bens   to pb-i-ah-crit-per
 14129*          MOVE ER-2618       TO WS-ERROR
 14130*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14131*          GO TO 3999-END-EDIT
 14132        END-IF
 14133     END-IF
 14134     if (ws-ah-special-calc-cd = 'C')
 14135        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14136        MOVE ER-1576             TO WS-ERROR
 14137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14138     end-if
 14139
 14140     .
 14141 3300-skip-crit-per.
 14142     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14143     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14144     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14145     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14146     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14147     MOVE PB-SV-STATE            TO CP-STATE.
 14148     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14149     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14150     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14151*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14152     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14153     MOVE '3'                    TO CP-PROCESS-TYPE.
 14154     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14155     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14156                                    CP-RATING-BENEFIT-AMT.
 14157     IF PB-COMPANY-ID = 'CID'
 14158               OR
 14159        CP-STATE-STD-ABBRV = 'OR'
 14160         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14161                                         PB-I-AH-TERM.
 14162     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14163        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14164           AND (PB-I-POLICY-IS-MONTHLY)
 14165           MOVE PB-I-LF-BENEFIT-AMT
 14166                                 TO CP-NET-BENEFIT-AMT
 14167           move pb-i-ah-premium-amt to cp-original-premium
 14168           add pb-i-lf-premium-amt to cp-original-premium
 14169        END-IF
 14170     END-IF
 14171     MOVE SPACES                 TO CP-BEN-CATEGORY
 14172     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14173        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14174        EVALUATE TRUE
 14175           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14176              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14177              MOVE PB-I-LF-BENEFIT-AMT
 14178                                 TO CP-RATING-BENEFIT-AMT
 14179              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14180           WHEN WS-AH-BEN-CATEGORY = 'G'
 14181              MOVE PB-I-UNPAID-CASH-PRICE
 14182                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 257
* EL050.cbl
 14183           WHEN WS-AH-BEN-CATEGORY = 'D'
 14184              MOVE WS-AH-PMF-COMM
 14185                                 TO CP-DCC-PMF-COMM
 14186              MOVE PB-I-AH-COMMISSION
 14187                                 TO CP-DCC-ACT-COMM
 14188        END-EVALUATE
 14189     END-IF
 14190     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14191     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14192     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14193     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14194     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14195     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14196     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14197                                    CP-REMAINING-TERM
 14198                                    WS-WORK-TERM.
 14199     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14200
 14201     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14202     SET BIN-TO-GREG             TO TRUE.
 14203*    MOVE ' '                    TO DC-OPTION-CODE.
 14204     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14205     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14206
 14207     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14208     IF NOT VALID-SKIP-CODE
 14209         MOVE ER-2683            TO WS-ERROR
 14210         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14211         GO TO 3320-RATE-CONTINUE.
 14212
 14213     IF PB-NO-MONTHS-SKIPPED
 14214         GO TO 3320-RATE-CONTINUE.
 14215
 14216     MOVE SPACE TO NUMBER-OF-MONTHS.
 14217
 14218     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14219         MOVE 'S'                TO SK-MO (6).
 14220     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14221         MOVE 'S'                TO SK-MO (7).
 14222     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14223         MOVE 'S'                TO SK-MO (8).
 14224     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14225         MOVE 'S'                TO SK-MO (9).
 14226     IF PB-I-SKIP-CODE = 'A'
 14227         MOVE 'S'                TO SK-MO (10).
 14228
 14229     MOVE 1                      TO SUB2.
 14230     MOVE PB-I-AH-TERM           TO SUB3.
 14231     MOVE WS-MONTH               TO SUB1.
 14232     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14233     GO TO 3320-RATE-CONTINUE.
 14234
 14235 3310-GET-SKIP-MO.
 14236     IF SUB1 = 13
 14237         MOVE 1                  TO SUB1.
 14238
 14239     IF SK-MO (SUB1) = 'S'
 14240         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 258
* EL050.cbl
 14241
 14242     ADD 1 TO SUB2
 14243              SUB1.
 14244
 14245 3320-RATE-CONTINUE.
 14246
 14247     IF WS-WORK-TERM = ZERO
 14248         MOVE 1                  TO WS-WORK-TERM.
 14249
 14250     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14251                                    CP-LOAN-TERM.
 14252
 14253     IF PB-COMPANY-ID EQUAL 'DMD'
 14254         NEXT SENTENCE
 14255     ELSE
 14256         MOVE ZERO               TO PB-I-AH-RATE
 14257                                    PB-I-AH-REI-RATE.
 14258
 14259
 14260     IF PB-COMPANY-ID EQUAL 'CRI'
 14261        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14262
 14263     IF PB-COMPANY-ID = 'CSL'
 14264         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14265         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14266         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14267         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14268
 14269     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14270        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14271           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14272              PB-I-RATE-DEV-PCT-LF
 14273        END-IF
 14274        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14275                                 TO CP-ALTERNATE-BENEFIT
 14276        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14277        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14278        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14279     END-IF
 14280     IF (PB-COMPANY-ID = 'CID')
 14281        AND (WS-LF-EARNINGS-CALC = 'B')
 14282        AND (CP-STATE-STD-ABBRV = 'MN')
 14283        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14284     ELSE
 14285        MOVE ' '                 TO CP-AH-BALLOON-SW
 14286     END-IF
 14287     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14288     MOVE 'R'                   TO CP-RATE-FILE.
 14289     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14290
 14291     IF (CP-ERROR-RATE-NOT-FOUND)
 14292        and (not pb-monthly-cert)
 14293        IF PB-I-OB
 14294           MOVE ER-2624          TO WS-ERROR
 14295           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14296           GO TO 3340-CALCULATE-PREMIUM-AMT
 14297        ELSE
 14298          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 259
* EL050.cbl
 14299              NEXT SENTENCE
 14300          ELSE
 14301           MOVE ER-2642          TO WS-ERROR
 14302           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14303           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14304
 14305     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14306        CP-ERROR-DIV-BY-ZERO
 14307           MOVE ER-3782          TO WS-ERROR
 14308           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14309
 14310     IF PB-COMPANY-ID EQUAL 'CRI'
 14311        IF CP-ERROR-NO-LIMITS-CRI
 14312           IF NOT ACCOUNT-AH-CHECKED
 14313              MOVE ER-2607          TO WS-ERROR
 14314              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14315
 14316     IF ACCOUNT-AH-CHECKED
 14317        NEXT SENTENCE
 14318     ELSE
 14319       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14320          MOVE ER-2640           TO WS-ERROR
 14321          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14322
 14323     IF PB-COMPANY-ID = 'CRI'
 14324         IF WS-ERROR = ER-2640
 14325             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14326     IF ACCOUNT-AH-CHECKED
 14327        CONTINUE
 14328     ELSE
 14329        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14330           AND (CP-R-MAX-ATT-AGE > +0)
 14331           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14332           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14333              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14334              MOVE PB-I-AH-EXPIRE-DT
 14335                                 TO DC-BIN-DATE-2
 14336              MOVE '1'           TO DC-OPTION-CODE
 14337              PERFORM 8500-DATE-CONVERT
 14338                                 THRU 8500-EXIT
 14339              IF NO-CONVERSION-ERROR
 14340                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14341                    MOVE ER-2661       TO WS-ERROR
 14342*                   PERFORM 9900-ERROR-FORMAT
 14343*                                THRU 9900-EXIT
 14344                 END-IF
 14345              END-IF
 14346           ELSE
 14347              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14348              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14349                 MOVE ER-2661    TO WS-ERROR
 14350*                PERFORM 9900-ERROR-FORMAT
 14351*                                THRU 9900-EXIT
 14352              ELSE
 14353                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14354                    MOVE ER-1570 TO WS-ERROR
 14355                    PERFORM 9900-ERROR-FORMAT
 14356                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 260
* EL050.cbl
 14357                 END-IF
 14358              END-IF
 14359           END-IF
 14360           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14361              MOVE PB-I-JOINT-BIRTHDAY
 14362                                    TO DC-BIN-DATE-1
 14363              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14364              MOVE '1'              TO DC-OPTION-CODE
 14365              PERFORM 8500-DATE-CONVERT
 14366                                    THRU 8500-EXIT
 14367              IF NO-CONVERSION-ERROR
 14368                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14369                    MOVE ER-2661       TO WS-ERROR
 14370*                   PERFORM 9900-ERROR-FORMAT
 14371*                                   THRU 9900-EXIT
 14372                 END-IF
 14373              END-IF
 14374           ELSE
 14375              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14376                (PB-I-AH-TERM / 12)
 14377              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14378                 MOVE ER-2661       TO WS-ERROR
 14379*                PERFORM 9900-ERROR-FORMAT
 14380*                                   THRU 9900-EXIT
 14381              ELSE
 14382                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14383                    MOVE ER-1571 TO WS-ERROR
 14384                    PERFORM 9900-ERROR-FORMAT
 14385                                 THRU 9900-EXIT
 14386                 END-IF
 14387              END-IF
 14388           END-IF
 14389           IF WS-ERROR = ER-2661
 14390              PERFORM 9900-ERROR-FORMAT
 14391                                    THRU 9900-EXIT
 14392           END-IF
 14393        END-IF
 14394     END-IF
 14395*    IF ACCOUNT-AH-CHECKED
 14396*       NEXT SENTENCE
 14397*    ELSE
 14398*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14399*          MOVE ER-2661          TO WS-ERROR
 14400*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14401
 14402     IF ACCOUNT-AH-CHECKED
 14403        NEXT SENTENCE
 14404     ELSE
 14405        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14406           MOVE ER-2663          TO WS-ERROR
 14407           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14408
 14409     IF ACCOUNT-AH-CHECKED OR
 14410        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14411         PB-POLICY-IS-VOIDED
 14412        NEXT SENTENCE
 14413     ELSE
 14414        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 261
* EL050.cbl
 14415           MOVE ER-2667            TO WS-ERROR
 14416           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14417
 14418     IF PB-COMPANY-ID = 'CRI'
 14419         IF WS-ERROR = ER-2667
 14420             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14421
 14422     IF ACCOUNT-AH-CHECKED
 14423        NEXT SENTENCE
 14424     ELSE
 14425        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14426           MOVE ER-2678            TO WS-ERROR
 14427           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14428
 14429     IF CP-ERROR-RATE-FILE-NOTOPEN
 14430         GO TO 3990-FILES-NOT-OPEN.
 14431
 14432 3321-CONTINUE.
 14433     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14434     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14435     IF (PB-COMPANY-ID = 'DCC')
 14436        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14437        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14438                                    PB-I-LF-ALT-PREM-CALC
 14439        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14440        IF WS-AH-BEN-CATEGORY = 'G'
 14441           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14442           + PB-I-ADDL-CLP)
 14443           * (1 + WS-TOL-CLP-PCT)
 14444*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14445        ELSE
 14446           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14447           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14448*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14449        END-IF
 14450        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14451                                 TO PB-I-AH-PREM-CALC
 14452        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14453           MOVE ER-8152          TO WS-ERROR
 14454           PERFORM 9900-ERROR-FORMAT
 14455                                 THRU 9900-EXIT
 14456        ELSE
 14457           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14458                 PB-I-ADDL-CLP)
 14459              MOVE ER-8148       TO WS-ERROR
 14460              PERFORM 9900-ERROR-FORMAT
 14461                                 THRU 9900-EXIT
 14462           END-IF
 14463        END-IF
 14464     END-IF
 14465     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14466        AND (PB-I-POLICY-IS-MONTHLY)
 14467        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14468        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14469        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14470           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14471        END-IF
 14472     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 262
* EL050.cbl
 14473     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14474        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14475        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14476        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14477        MOVE ER-2786             TO WS-ERROR
 14478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14479     END-IF
 14480     MOVE +0                     TO PB-I-AH-CLP
 14481     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14482        evaluate true
 14483           when WS-AH-BEN-CATEGORY = 'D'
 14484              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14485                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14486           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14487              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14488           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14489              compute ws-cred-union-fees rounded =
 14490                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14491                    pb-i-ah-commission)
 14492              COMPUTE PB-I-AH-CLP =
 14493                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14494        end-evaluate
 14495     END-IF
 14496     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14497
 14498     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14499         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14500
 14501     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14502         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14503
 14504     if (ws-ah-special-calc-cd = 'E')
 14505        and (pb-monthly-cert)
 14506        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14507     end-if
 14508     IF PB-COMPANY-ID = 'CRI'
 14509         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14510            PB-I-PAYMENT-AMOUNT = ZERO
 14511             NEXT SENTENCE
 14512         ELSE
 14513             COMPUTE PB-I-AH-PREM-CALC =
 14514                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14515                 (CP-PREMIUM-RATE / 100)
 14516             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14517                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14518                                             PB-I-RATE-DEV-PCT-AH.
 14519
 14520     IF (PB-I-AH-RATE  = ZERO)
 14521        and (not pb-monthly-cert)
 14522       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14523           NEXT SENTENCE
 14524       ELSE
 14525         MOVE ER-2642            TO WS-ERROR
 14526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14527
 14528     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14529     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14530     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 263
* EL050.cbl
 14531     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14532     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14533     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14534
 14535     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14536        AND (WS-AH-BEN-CATEGORY = 'G')
 14537        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14538        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14539        IF CP-DEVIATION-CODE NOT = '000'
 14540           MOVE '000'            TO CP-DEVIATION-CODE
 14541           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14542           IF NO-CP-ERROR
 14543              COMPUTE PB-I-DDF-IU-RATE-UP =
 14544              PB-I-AH-CLP - CP-CALC-PREMIUM
 14545           ELSE
 14546              MOVE ER-3057        TO WS-ERROR
 14547              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14548           END-IF
 14549        END-IF
 14550     END-IF
 14551     .
 14552 3335-EDIT-AH-REIN-NSP-RATE.
 14553     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14554        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14555              compute ws-cred-union-fees rounded =
 14556                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14557                    pb-i-ah-commission)
 14558              COMPUTE PB-I-AH-CLP =
 14559                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14560        end-if
 14561     END-IF
 14562     IF AH-REIN-NSP-NOT-USED
 14563         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14564
 14565     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14566     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14567         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14568     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14569     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14570     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14571     MOVE PB-SV-STATE            TO CP-STATE.
 14572     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14573     MOVE ZERO                   TO CP-DEVIATION-CODE
 14574                                    CP-RATE-DEV-PCT.
 14575*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14576     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14577     MOVE '3'                    TO CP-PROCESS-TYPE.
 14578     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14579     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14580                                    CP-RATING-BENEFIT-AMT.
 14581     IF CP-STATE-STD-ABBRV = 'OR'
 14582         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14583                                         PB-I-AH-TERM.
 14584     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14585     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14586     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14587     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14588     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 264
* EL050.cbl
 14589     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14590                                    CP-REMAINING-TERM
 14591                                    WS-WORK-TERM.
 14592     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14593     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14594        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14595     END-IF
 14596     IF  PB-COMPANY-ID = 'TIC'
 14597         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14598            MOVE ZERO TO CP-CLASS-CODE.
 14599
 14600     IF PB-COMPANY-ID NOT = 'TIC'
 14601          MOVE ZERO          TO CP-CLASS-CODE.
 14602
 14603     MOVE ZERO               TO CP-DEVIATION-CODE.
 14604
 14605     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14606
 14607     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14608
 14609     MOVE 'R'                   TO CP-RATE-FILE.
 14610     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14611
 14612     IF CP-ERROR-RATE-NOT-FOUND
 14613         MOVE ER-2645        TO WS-ERROR
 14614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14615         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14616
 14617     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14618
 14619     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14620     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14621
 14622     IF PB-I-AH-REI-RATE = ZERO
 14623         MOVE ER-2645        TO WS-ERROR
 14624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14625
 14626
 14627 3340-CALCULATE-PREMIUM-AMT.
 14628
 14629     IF PB-COMPANY-ID = 'NCL'
 14630         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14631             WS-AH-SPECIAL-CALC-CD = 'O')
 14632             GO TO 3999-END-EDIT.
 14633
 14634     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14635                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14636                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14637                         OR 'AHL'
 14638         NEXT SENTENCE
 14639     ELSE
 14640         IF WS-STATE-ABBREVIATION = 'CT'
 14641             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14642                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14643                 COMPUTE PB-I-LF-PREM-CALC =
 14644                                     PB-I-LF-PREM-CALC * .90
 14645                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14646                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 265
* EL050.cbl
 14647                 COMPUTE PB-I-AH-PREM-CALC =
 14648                                     PB-I-AH-PREM-CALC * .90.
 14649
 14650     IF PB-COMP-LF-PREM
 14651        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14652        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14653
 14654     IF PB-COMP-AH-PREM
 14655        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14656
 14657 3340-CHECK-DCC-TOT-FEES.
 14658     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14659        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14660        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14661        AND (PB-I-POLICY-IS-MONTHLY)
 14662        CONTINUE
 14663     ELSE
 14664        GO TO 3340-EDIT-LF-AH-TOL
 14665     END-IF
 14666     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14667     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14668     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14669        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14670           PB-I-RATE-DEV-PCT-LF
 14671     END-IF
 14672     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14673        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14674           PB-I-RATE-DEV-PCT-AH
 14675     END-IF
 14676     MOVE 'N'                    TO CP-BEN-CATEGORY
 14677     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14678
 14679     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14680     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14681     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14682     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14683     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14684     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14685     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14686     MOVE '3'                    TO CP-PROCESS-TYPE.
 14687     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14688     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14689
 14690     MOVE PB-SV-STATE            TO CP-STATE.
 14691     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14692     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14693     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14694     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14695     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14696                                    CP-RATING-BENEFIT-AMT.
 14697     IF CP-STATE-STD-ABBRV = 'OR'
 14698         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14699                                         PB-I-LF-ALT-BENEFIT-AMT.
 14700     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14701     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14702     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14703     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14704     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 266
* EL050.cbl
 14705     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14706     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14707     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14708     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14709                                    CP-REMAINING-TERM
 14710                                    CP-LOAN-TERM.
 14711     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14712        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14713           PB-I-LF-PREMIUM-AMT
 14714     end-if
 14715
 14716     IF CP-TRUNCATED-LIFE
 14717        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14718
 14719     IF CP-TERM-IS-DAYS
 14720         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14721     ELSE
 14722         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14723
 14724     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14725     IF CP-SPECIAL-CALC-CD = 'H'
 14726         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14727                                    TO CP-ALTERNATE-BENEFIT
 14728         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14729     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14730     MOVE 'R'                    TO CP-RATE-FILE
 14731     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14732     IF NOT CP-ERROR-RATE-NOT-FOUND
 14733        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14734        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14735           AND (CP-BENEFIT-CD (1:1) = 'S')
 14736           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14737                                    PB-I-LF-PREMIUM-AMT
 14738        END-IF
 14739     ELSE
 14740        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14741     END-IF
 14742     .
 14743 3340-EDIT-LF-AH-TOL.
 14744
 14745***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14746***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14747***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14748***
 14749     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14750         PB-I-AH-PREMIUM-AMT
 14751          GIVING WS-CALC-WORK.
 14752
 14753     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14754        AND WS-CALC-WORK NOT = ZERO
 14755         MOVE ER-2649            TO WS-ERROR
 14756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14757
 14758     SUBTRACT PB-I-LF-PREM-CALC
 14759             FROM PB-I-LF-PREMIUM-AMT
 14760                 GIVING WS-UNSIGN-WRK1.
 14761
 14762     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 267
* EL050.cbl
 14763             FROM PB-I-LF-ALT-PREMIUM-AMT
 14764                 GIVING WS-UNSIGN-WRK4.
 14765
 14766     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14767                                + WS-UNSIGN-WRK4.
 14768
 14769     SUBTRACT PB-I-AH-PREM-CALC
 14770             FROM PB-I-AH-PREMIUM-AMT
 14771                 GIVING WS-UNSIGN-WRK2.
 14772
 14773******************************************************************
 14774*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14775******************************************************************
 14776
 14777     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14778         MOVE ZERO TO WS-UNSIGN-WRK1.
 14779
 14780     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14781         MOVE ZERO TO WS-UNSIGN-WRK2.
 14782
 14783     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14784             GIVING WS-UNSIGN-WRK3.
 14785
 14786 3342-CONTINUE.
 14787
 14788     IF (PB-I-LF-RATE = ZERO  AND
 14789         PB-I-AH-RATE = ZERO)
 14790         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14791            WS-AH-SPECIAL-CALC-CD = 'O'
 14792              NEXT SENTENCE
 14793         ELSE
 14794             GO TO 3345-EDIT-CONTINUE.
 14795
 14796     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14797         NEXT SENTENCE
 14798     ELSE
 14799     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14800        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14801           IF (PB-REISSUED-CERT         OR
 14802               PB-POLICY-IS-DECLINED    OR
 14803               PB-POLICY-IS-VOIDED)
 14804              NEXT SENTENCE
 14805           ELSE
 14806              IF WS-PREM-REJECT-SW = SPACE
 14807                 MOVE ER-2652    TO WS-ERROR
 14808                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14809                 GO TO 3344-CHECK-AH
 14810              ELSE
 14811                 MOVE ER-2650    TO WS-ERROR
 14812                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14813                 GO TO 3344-CHECK-AH.
 14814
 14815***
 14816***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14817***
 14818
 14819     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14820         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 268
* EL050.cbl
 14821            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14822             (1 + WS-TOL-LF-PREM-PCT)
 14823         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14824            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14825             (1 - WS-TOL-LF-PREM-PCT)
 14826     ELSE
 14827         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14828         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14829
 14830***
 14831***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14832***
 14833
 14834     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14835         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14836          WS-TOL-LF-PREM.
 14837
 14838     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14839         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14840          WS-TOL-LF-PREM.
 14841
 14842     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14843        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14844
 14845     IF PB-REISSUED-CERT
 14846        or PB-POLICY-IS-DECLINED
 14847        or PB-POLICY-IS-VOIDED
 14848        continue
 14849     ELSE
 14850        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14851              > WS-TOL-LF-HIGH-PREM-AMT)
 14852           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14853              < WS-TOL-LF-LOW-PREM-AMT))
 14854                      or
 14855           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14856              > WS-TOL-LF-HIGH-PREM-PCT)
 14857           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14858              < WS-TOL-LF-LOW-PREM-PCT))
 14859           IF WS-PREM-REJECT-SW = SPACE
 14860              MOVE ER-2652       TO WS-ERROR
 14861              PERFORM 9900-ERROR-FORMAT
 14862                                 THRU 9900-EXIT
 14863           ELSE
 14864              MOVE ER-2650       TO WS-ERROR
 14865              PERFORM 9900-ERROR-FORMAT
 14866                                 THRU 9900-EXIT
 14867           end-if
 14868        end-if
 14869     end-if
 14870
 14871*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14872*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14873*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14874*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14875
 14876     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14877        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14878                      OR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 269
* EL050.cbl
 14879           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14880           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14881           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14882           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14883        END-IF
 14884     END-IF
 14885
 14886     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14887        IF WS-COMP-MAX-CAP GREATER THAN +0
 14888           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14889              IF (PB-REISSUED-CERT         OR
 14890                  PB-POLICY-IS-DECLINED    OR
 14891                  PB-POLICY-IS-VOIDED)
 14892                 NEXT SENTENCE
 14893              ELSE
 14894                  MOVE ER-2646   TO  WS-ERROR
 14895                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14896
 14897 3344-CVL-TOLERANCE-CHECK.
 14898
 14899      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14900          GO TO 3344-CHECK-AH.
 14901
 14902      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14903          GO TO 3344-CHECK-AH.
 14904
 14905      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14906                                     WS-UNSIGN-WRK6.
 14907
 14908      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14909          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14910                                 + PB-I-LF-PREMIUM-AMT
 14911                                 - PB-I-LF-PREM-CALC.
 14912
 14913      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14914          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14915                                 + PB-I-LF-ALT-PREMIUM-AMT
 14916                                 - PB-I-LF-ALT-PREM-CALC.
 14917
 14918      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14919          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14920              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14921                 MOVE ER-2652    TO  WS-ERROR
 14922                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14923              ELSE
 14924                 MOVE ER-2650    TO  WS-ERROR
 14925                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14926
 14927      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14928          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14929              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14930                 MOVE ER-2652    TO  WS-ERROR
 14931                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14932              ELSE
 14933                 MOVE ER-2650    TO  WS-ERROR
 14934                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14935
 14936 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 270
* EL050.cbl
 14937
 14938****************************************************************
 14939***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14940***
 14941
 14942     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14943         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14944             (1 + WS-TOL-AH-PREM-PCT)
 14945         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14946             (1 - WS-TOL-AH-PREM-PCT)
 14947     ELSE
 14948         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14949         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14950
 14951***
 14952***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14953***
 14954
 14955     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14956         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14957
 14958     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14959         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14960
 14961     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14962        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14963
 14964     IF (PB-REISSUED-CERT)
 14965        OR (PB-POLICY-IS-DECLINED)
 14966        OR (PB-POLICY-IS-VOIDED)
 14967        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14968        CONTINUE
 14969     ELSE
 14970        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14971              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14972                          or
 14973           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14974              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14975           IF WS-PREM-REJECT-SW = SPACE
 14976              MOVE ER-3052       TO WS-ERROR
 14977              PERFORM 9900-ERROR-FORMAT
 14978                                 THRU 9900-EXIT
 14979           ELSE
 14980              MOVE ER-3050       TO WS-ERROR
 14981              PERFORM 9900-ERROR-FORMAT
 14982                                 THRU 9900-EXIT
 14983           END-IF
 14984        END-IF
 14985     END-IF
 14986     if (pb-company-id = 'DCC' or 'VPP')
 14987        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14988        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14989        and (pb-i-policy-is-monthly)
 14990        compute ws-tol-ah-high-prem-amt =
 14991           pb-i-tot-fees-calc + ws-tol-ah-prem
 14992        compute ws-tol-ah-low-prem-amt =
 14993           pb-i-tot-fees-calc - ws-tol-ah-prem
 14994        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 271
* EL050.cbl
 14995           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14996              (1 + ws-tol-ah-prem-pct)
 14997           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14998              (1 - ws-tol-ah-prem-pct)
 14999        else
 15000           move +9999999.99      to ws-tol-ah-high-prem-pct
 15001           move +0               to ws-tol-ah-low-prem-pct
 15002        end-if
 15003        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15004            or
 15005           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15006                          or
 15007           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15008           or
 15009           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15010            move er-3049         to ws-error
 15011           perform 9900-error-format
 15012                                 thru 9900-exit
 15013
 15014        end-if
 15015     end-if
 15016     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15017         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15018             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15019             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15020
 15021     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15022        IF WS-COMP-MAX-CAP GREATER THAN +0
 15023           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15024              IF (PB-REISSUED-CERT         OR
 15025                  PB-POLICY-IS-DECLINED    OR
 15026                  PB-POLICY-IS-VOIDED)
 15027                 NEXT SENTENCE
 15028              ELSE
 15029                  MOVE ER-2646   TO  WS-ERROR
 15030                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15031
 15032     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15033        (WS-COMP-MAX-CAP EQUAL +0)
 15034           GO TO 3345-EDIT-CONTINUE.
 15035
 15036     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15037        GREATER THAN WS-COMP-MAX-CAP
 15038           MOVE ER-2646          TO  WS-ERROR
 15039           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15040
 15041 3345-EDIT-CONTINUE.
 15042
 15043*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15044*       IF PB-ENTRY-BATCH   NUMERIC
 15045*          IF PB-ISSUE
 15046*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15047*          ELSE
 15048*              IF PB-CANCELLATION
 15049*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15050
 15051*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15052*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 272
* EL050.cbl
 15053*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15054*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15055*        ELSE
 15056*            MOVE  ER-1909            TO  WS-ERROR
 15057*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15058
 15059     IF PB-I-POLICY-ACCEPTED
 15060        IF PB-POLICY-IS-DECLINED  OR
 15061           PB-REISSUED-CERT  OR
 15062           PB-REIN-ONLY-CERT  OR
 15063           PB-POLICY-IS-VOIDED
 15064            MOVE  ER-1891         TO  WS-ERROR
 15065            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15066        ELSE
 15067            MOVE SPACE            TO  PB-BATCH-ENTRY
 15068            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15069
 15070     IF PB-I-POLICY-DECLINED
 15071        IF PB-REISSUED-CERT  OR
 15072           PB-REIN-ONLY-CERT  OR
 15073           PB-POLICY-IS-VOIDED
 15074            MOVE  ER-1906         TO  WS-ERROR
 15075            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15076        ELSE
 15077            MOVE  'D'             TO  PB-BATCH-ENTRY
 15078                                      PB-I-ENTRY-STATUS.
 15079
 15080     IF PB-I-NEEDS-UNDERWRITING
 15081        IF PB-POLICY-IS-DECLINED OR
 15082           PB-REISSUED-CERT  OR
 15083           PB-REIN-ONLY-CERT  OR
 15084           PB-POLICY-IS-VOIDED
 15085            MOVE  ER-1907         TO  WS-ERROR
 15086            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15087        ELSE
 15088            MOVE 'U'              TO  PB-BATCH-ENTRY
 15089                                      PB-I-ENTRY-STATUS.
 15090
 15091     IF PB-NEEDS-UNDERWRITING
 15092        MOVE  ER-1901             TO  WS-ERROR
 15093        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15094     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15095        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15096        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15097        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15098           AND (NOT WS-LF-CASH))
 15099                           OR
 15100           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15101           AND (NOT WS-AH-CASH)))
 15102                       AND
 15103           (PB-I-ENTRY-STATUS NOT = '5')
 15104           MOVE 'M'              TO PB-BATCH-ENTRY
 15105                                    PB-I-ENTRY-STATUS
 15106        END-IF
 15107     END-IF
 15108     move pending-business       to ws-passed-erpndb
 15109     move ' '                    to ws-exceed-limit-yn
 15110     perform 7780-call-agg       thru 7780-exit
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 273
* EL050.cbl
 15111     display ' el050 exceed ' ws-exceed-limit-yn
 15112     if ws-exceed-limit-yn = 'Y'
 15113        MOVE  ER-9813            TO WS-ERROR
 15114        PERFORM  9900-ERROR-FORMAT
 15115                                 THRU 9900-EXIT
 15116     end-if
 15117     IF  PB-COMPANY-ID NOT = 'NCL'
 15118         GO TO 3999-END-EDIT.
 15119
 15120     IF PB-REISSUED-CERT  OR
 15121        PB-POLICY-IS-DECLINED  OR
 15122        PB-POLICY-IS-VOIDED  OR
 15123        PB-I-OB
 15124         GO TO 3999-END-EDIT.
 15125
 15126     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15127         MOVE  ER-2644            TO  WS-ERROR
 15128         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15129         GO TO 3999-END-EDIT.
 15130
 15131     MOVE 'N'                     TO  FORM-MASTER-SW.
 15132     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15133
 15134     IF NOT FORM-MASTER-FOUND
 15135         GO TO 3999-END-EDIT.
 15136
 15137     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15138                                      FORM-MASTER-AH-SW.
 15139
 15140     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15141         MOVE  +1                 TO SUB6
 15142         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15143
 15144     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15145         MOVE  +1                 TO SUB6
 15146         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15147
 15148     IF LF-FORM-MASTER-FOUND  OR
 15149        AH-FORM-MASTER-FOUND
 15150         GO TO 3360-CHECK-FORM-LIMITS
 15151     ELSE
 15152         GO TO 3999-END-EDIT.
 15153
 15154******************************************************************
 15155*                  3350-GET-ERFORM                               *
 15156*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15157*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15158******************************************************************
 15159
 15160 3350-GET-ERFORM.
 15161
 15162     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15163         GO TO  3350-ERFORM-GETMAIN.
 15164
 15165     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15166     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15167     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15168     MOVE 'Y'                     TO FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 274
* EL050.cbl
 15169
 15170     IF PB-CANCELLATION
 15171         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15172            PB-SV-STATE          EQUAL   FO-STATE       AND
 15173            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15174              GO TO 3350-EXIT
 15175         ELSE
 15176             NEXT SENTENCE
 15177     ELSE
 15178         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15179            PB-SV-STATE          EQUAL   FO-STATE       AND
 15180            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15181              GO TO 3350-EXIT.
 15182
 15183 3350-ERFORM-GETMAIN.
 15184
 15185     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15186     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15187
 15188 3350-ERFORM-READ.
 15189
 15190     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15191     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15192     IF PB-CANCELLATION
 15193         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15194     ELSE
 15195         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15196     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15197
 15198     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15199
 15200     IF FORM-MASTER-FOUND
 15201       IF PB-CANCELLATION
 15202          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15203             PB-SV-STATE          EQUAL   FO-STATE       AND
 15204             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15205              GO  TO 3350-EXIT
 15206          ELSE
 15207              NEXT SENTENCE
 15208       ELSE
 15209          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15210             PB-SV-STATE          EQUAL   FO-STATE       AND
 15211             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15212              GO  TO 3350-EXIT.
 15213
 15214     MOVE  'N'                    TO  FORM-MASTER-SW.
 15215     MOVE  ER-1895                TO  WS-ERROR.
 15216     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15217
 15218 3350-EXIT.
 15219      EXIT.
 15220
 15221******************************************************************
 15222*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15223*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15224*   VALID FOR THE POLICY FORM USED.                              *
 15225******************************************************************
 15226
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 275
* EL050.cbl
 15227 3355-EDIT-FORM-LF-BENEFITS.
 15228
 15229     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15230        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15231         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15232         GO TO   3355-EXIT.
 15233
 15234     IF  SUB6    LESS THAN   +40
 15235         ADD  +1      TO  SUB6
 15236         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15237
 15238     MOVE  ER-1896         TO  WS-ERROR.
 15239     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15240
 15241 3355-EXIT.
 15242      EXIT.
 15243
 15244******************************************************************
 15245*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15246*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15247*   VALID FOR THE POLICY FORM USED.                              *
 15248******************************************************************
 15249
 15250 3356-EDIT-FORM-AH-BENEFITS.
 15251
 15252     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15253        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15254         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15255         GO TO  3356-EXIT.
 15256
 15257      IF  SUB6    LESS THAN     +40
 15258          ADD  +1      TO  SUB6
 15259          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15260
 15261     MOVE  ER-1897         TO  WS-ERROR.
 15262     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15263
 15264 3356-EXIT.
 15265      EXIT.
 15266
 15267******************************************************************
 15268*                  3357-BENEFIT-SEARCH                           *
 15269*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15270*   CANCELLATIONS ONLY.                                          *
 15271******************************************************************
 15272 3357-BENEFIT-SEARCH.
 15273     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15274         MOVE +1                          TO SUB6
 15275         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15276
 15277     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15278         MOVE +1                          TO SUB6
 15279         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15280
 15281 3357-EXIT.
 15282     EXIT.
 15283
 15284******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 276
* EL050.cbl
 15285*                  3358-BENEFIT-LIFE-SEARCH                      *
 15286*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15287*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15288*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15289******************************************************************
 15290 3358-BENEFIT-LIFE-SEARCH.
 15291     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15292       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15293         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15294           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15295              IF FO-PLAN-REFUND-METHOD (SUB6)
 15296                     IS GREATER THAN SPACES
 15297                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15298                                          WS-LF-REFUND-CALC
 15299                 GO TO 3358-EXIT.
 15300
 15301     IF SUB6 LESS THAN +40
 15302         ADD +1                 TO SUB6
 15303         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15304
 15305 3358-EXIT.
 15306     EXIT.
 15307******************************************************************
 15308*                  3359-BENEFIT-AH-SEARCH                        *
 15309*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15310*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15311*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15312******************************************************************
 15313 3359-BENEFIT-AH-SEARCH.
 15314     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15315       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15316         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15317           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15318              IF FO-PLAN-REFUND-METHOD (SUB6)
 15319                      IS GREATER THAN SPACES
 15320                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15321                                          WS-AH-REFUND-CALC
 15322                 GO TO 3359-EXIT.
 15323
 15324     IF SUB6 LESS THAN +40
 15325         ADD +1                 TO SUB6
 15326         GO TO 3359-BENEFIT-AH-SEARCH.
 15327
 15328 3359-EXIT.
 15329     EXIT.
 15330
 15331******************************************************************
 15332*                  3360-CHECK-FORM-LIMITS                        *
 15333*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15334*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15335******************************************************************
 15336
 15337 3360-CHECK-FORM-LIMITS.
 15338
 15339     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15340         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15341
 15342     IF NOT LF-FORM-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 277
* EL050.cbl
 15343         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15344
 15345 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15346
 15347     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15348       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15349        WS-LF-JOINT-INDICATOR = 'J'  AND
 15350        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15351         IF PB-COMPANY-ID = 'NCL'
 15352            MOVE  ER-1911          TO  WS-ERROR
 15353            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15354         ELSE
 15355            MOVE  ER-1892          TO  WS-ERROR
 15356            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15357
 15358 3360-CHECK-FORM-LF-ATT-AGE.
 15359
 15360     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15361
 15362     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15363         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15364         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15365            IF PB-COMPANY-ID = 'NCL'
 15366                MOVE  ER-1913      TO  WS-ERROR
 15367                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15368            ELSE
 15369                MOVE  ER-1894      TO  WS-ERROR
 15370                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15371
 15372 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15373
 15374     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15375         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15376         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15377            IF PB-COMPANY-ID = 'NCL'
 15378                MOVE  ER-1914      TO  WS-ERROR
 15379                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15380            ELSE
 15381                MOVE  ER-1899      TO  WS-ERROR
 15382                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15383
 15384 3360-CHECK-FORM-LF-TERM-BAMT.
 15385
 15386     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15387         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15388         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15389           IF  PB-COMPANY-ID = 'NCL'
 15390               MOVE  ER-1916       TO  WS-ERROR
 15391               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15392           ELSE
 15393               MOVE  ER-1902       TO  WS-ERROR
 15394               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15395
 15396     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15397                                    PB-I-LF-ALT-BENEFIT-AMT.
 15398
 15399     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15400         FO-MAX-LF-AMT   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 278
* EL050.cbl
 15401         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15402             IF  PB-COMPANY-ID = 'NCL'
 15403                 MOVE  ER-1918     TO  WS-ERROR
 15404                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15405             ELSE
 15406                 MOVE  ER-1904     TO  WS-ERROR
 15407                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15408
 15409******************************************************************
 15410*                  3360-CHECK-FORM-AH-LIMITS                     *
 15411*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15412*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15413******************************************************************
 15414
 15415 3360-CHECK-FORM-AH-LIMITS.
 15416
 15417     IF NOT AH-FORM-MASTER-FOUND
 15418         GO TO 3999-END-EDIT.
 15419
 15420 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15421
 15422     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15423       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15424        WS-AH-JOINT-INDICATOR = 'J'  AND
 15425        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15426         IF PB-COMPANY-ID = 'NCL'
 15427            MOVE  ER-1912          TO  WS-ERROR
 15428            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15429         ELSE
 15430            MOVE  ER-1893          TO  WS-ERROR
 15431            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15432
 15433 3360-CHECK-FORM-AH-ATT-AGE.
 15434
 15435     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15436
 15437     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15438         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15439         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15440            IF PB-COMPANY-ID = 'NCL'
 15441                MOVE  ER-1913      TO  WS-ERROR
 15442                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15443            ELSE
 15444                MOVE  ER-1894      TO  WS-ERROR
 15445                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15446
 15447 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15448
 15449     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15450         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15451         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15452            IF PB-COMPANY-ID = 'NCL'
 15453                MOVE  ER-1915      TO  WS-ERROR
 15454                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15455            ELSE
 15456                MOVE  ER-1900      TO  WS-ERROR
 15457                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15458
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 279
* EL050.cbl
 15459 3360-CHECK-FORM-AH-TERM-BAMT.
 15460
 15461     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15462         FO-AH-MAX-TERM    GREATER THAN  +0
 15463         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15464             IF  PB-COMPANY-ID = 'NCL'
 15465                 MOVE  ER-1917     TO  WS-ERROR
 15466                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15467             ELSE
 15468                  MOVE  ER-1903    TO  WS-ERROR
 15469                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15470
 15471     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15472         FO-MAX-AH-AMT    GREATER THAN  +0
 15473         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15474             IF  PB-COMPANY-ID = 'NCL'
 15475                 MOVE  ER-1919     TO  WS-ERROR
 15476                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15477             ELSE
 15478                 MOVE  ER-1905     TO  WS-ERROR
 15479                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15480
 15481     GO TO 3999-END-EDIT.
 15482
 15483******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 280
* EL050.cbl
 15485 3400-edit-vin.
 15486
 15487     MOVE PB-I-VIN               TO WS-WORK-VIN
 15488     MOVE +8                     TO V2
 15489     MOVE ZEROS                  TO WS-VIN-TOTAL
 15490     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15491      (V1 > 17)
 15492        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15493           MOVE ER-3825          TO WS-ERROR
 15494           PERFORM 9900-ERROR-FORMAT
 15495                                 THRU 9900-EXIT
 15496        ELSE
 15497           IF V1 = 8
 15498              MOVE 10            TO V2
 15499           END-IF
 15500           IF V1 = 9
 15501              MOVE 0             TO V2
 15502           END-IF
 15503           IF V1 = 10
 15504              MOVE 9             TO V2
 15505           END-IF
 15506           IF WS-WORK-VIN (V1:1) NUMERIC
 15507              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15508               + (WS-WORK-VIN-N (V1) * V2)
 15509           ELSE
 15510              MOVE WS-WORK-VIN (V1:1)
 15511                            TO WS-HEX-BYTE
 15512              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15513              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15514               + (WS-NUM (V3) * V2)
 15515           END-IF
 15516           COMPUTE V2 = V2 - 1
 15517        END-IF
 15518     END-PERFORM
 15519     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15520     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15521        REMAINDER WS-VIN-REMAINDER
 15522     IF ((WS-WORK-VIN (9:1) = 'X')
 15523        AND (WS-VIN-REMAINDER = 10))
 15524                OR
 15525        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15526        CONTINUE
 15527     ELSE
 15528        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15529           MOVE ER-3826          TO WS-ERROR
 15530           PERFORM 9900-ERROR-FORMAT
 15531                                 THRU 9900-EXIT
 15532        ELSE
 15533           MOVE ER-3827          TO WS-ERROR
 15534           PERFORM 9900-ERROR-FORMAT
 15535                                 THRU 9900-EXIT
 15536        END-IF
 15537     END-IF
 15538
 15539     .
 15540 3400-exit.
 15541     exit.
 15542******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 281
* EL050.cbl
 15543*                  E D I T   C A N C E L                         *
 15544******************************************************************
 15545
 15546 3700-EDIT-CANCEL.
 15547     IF PB-COMPANY-ID = 'DMD'
 15548         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15549                                         WS-RES-MUNI-TAX
 15550                                         PB-CI-STATE-TAX
 15551                                         PB-CI-MUNI-TAX
 15552         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15553
 15554*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15555*       IF PB-ENTRY-BATCH  NUMERIC
 15556*          IF PB-CANCELLATION
 15557*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15558*          ELSE
 15559*             IF PB-ISSUE
 15560*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15561
 15562     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15563        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15564     END-IF
 15565*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15566*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15567
 15568     IF CM-ENTRY-STATUS = 'V'
 15569        MOVE ER-2780             TO WS-ERROR
 15570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15571        GO TO 3999-END-EDIT.
 15572
 15573     IF CM-ENTRY-STATUS = 'D'
 15574        MOVE ER-2781             TO WS-ERROR
 15575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15576        GO TO 3999-END-EDIT.
 15577
 15578     IF CM-ENTRY-STATUS = 'U'
 15579        MOVE ER-2782             TO WS-ERROR
 15580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15581
 15582***************************************************************
 15583*                                                             *
 15584*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15585*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15586*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15587*   OF ANOTHER COVERAGE.                                      *
 15588*                                                             *
 15589***************************************************************
 15590
 15591     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15592                                    PB-C-AH-CANCEL-VOID-SW.
 15593
 15594     IF PB-C-LF-CANCEL-AMT = ZERO
 15595        NEXT SENTENCE
 15596     ELSE
 15597        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15598           AND
 15599           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15600               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 282
* EL050.cbl
 15601               MOVE ER-2745           TO WS-ERROR
 15602               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15603
 15604     IF PB-C-AH-CANCEL-AMT = ZERO
 15605        NEXT SENTENCE
 15606     ELSE
 15607        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15608           AND
 15609           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15610               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15611               MOVE ER-2745           TO WS-ERROR
 15612               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15613
 15614     IF WS-LF-EARNINGS-CALC = '4'
 15615        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15616
 15617     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15618     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15619     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15620     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15621     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15622     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15623
 15624     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15625                                      PB-C-AH-REF-CALC.
 15626     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15627
 15628******************************************************************
 15629*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15630*             TO VALIDATE COVERAGE.                              *
 15631******************************************************************
 15632
 15633     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15634        PB-C-LF-CANCEL-AMT = ZEROS
 15635          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15636      ELSE
 15637          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15638
 15639     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15640        PB-C-AH-CANCEL-AMT = ZEROS
 15641          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15642      ELSE
 15643          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15644
 15645     EVALUATE TRUE
 15646         WHEN PB-CANCEL-FORCE             OR
 15647              PB-CANCEL-DATE-FORCED       OR
 15648              PB-FORCE-OFF
 15649                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15650                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15651                  END-IF
 15652         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15653               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15654              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15655                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15656         WHEN OTHER
 15657              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15658                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 283
* EL050.cbl
 15659              ELSE
 15660                 MOVE ER-2749              TO WS-ERROR
 15661              END-IF
 15662              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15663     END-EVALUATE.
 15664
 15665
 15666*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15667*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15668*            MOVE  ER-1909            TO  WS-ERROR
 15669*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15670*        ELSE
 15671*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15672
 15673     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15674     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15675        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15676     ELSE
 15677        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15678     END-IF
 15679     .
 15680 3705-EDIT-CANCEL-DT.
 15681
 15682     IF LF-COVERAGE-CANCELLED
 15683        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15684         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15685         MOVE WS-CURRENT-MONTH-END
 15686                                 TO DC-BIN-DATE-2
 15687         SET ELAPSED-BETWEEN-BIN TO TRUE
 15688*        MOVE 1                  TO DC-OPTION-CODE
 15689         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15690         IF DATE-CONVERSION-ERROR
 15691            NEXT SENTENCE
 15692          ELSE
 15693             IF DC-ELAPSED-DAYS GREATER +180
 15694                IF PB-CANCEL-DATE-FORCED  OR
 15695                   PB-CANCEL-DATE-FORCED-NO-FEE
 15696                      MOVE ER-2751  TO WS-ERROR
 15697                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15698                 ELSE
 15699                   MOVE ER-2752  TO WS-ERROR
 15700                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15701
 15702     IF AH-COVERAGE-CANCELLED
 15703        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15704         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15705         MOVE WS-CURRENT-MONTH-END
 15706                                 TO DC-BIN-DATE-2
 15707         SET ELAPSED-BETWEEN-BIN TO TRUE
 15708*        MOVE 1                  TO DC-OPTION-CODE
 15709         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15710         IF DATE-CONVERSION-ERROR
 15711            NEXT SENTENCE
 15712          ELSE
 15713             IF DC-ELAPSED-DAYS GREATER +180
 15714                IF PB-CANCEL-DATE-FORCED OR
 15715                   PB-CANCEL-DATE-FORCED-NO-FEE
 15716                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 284
* EL050.cbl
 15717                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15718                 ELSE
 15719                   MOVE ER-2752  TO WS-ERROR
 15720                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15721
 15722     IF WS-ERROR = ER-2752
 15723        AND (PB-COMPANY-ID = 'ABL'
 15724         OR  PB-COMPANY-ID = 'FGL'
 15725         OR  PB-COMPANY-ID = 'IST'
 15726         OR  PB-COMPANY-ID = 'JHL'
 15727         OR  PB-COMPANY-ID = 'LAP'
 15728         OR  PB-COMPANY-ID = 'LBL'
 15729         OR  PB-COMPANY-ID = 'NCB'
 15730         OR  PB-COMPANY-ID = 'NLI'
 15731         OR  PB-COMPANY-ID = 'OFI'
 15732         OR  PB-COMPANY-ID = 'PLI'
 15733         OR  PB-COMPANY-ID = 'TAO'
 15734         OR  PB-COMPANY-ID = 'TIC'
 15735         OR  PB-COMPANY-ID = 'HER'
 15736         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15737         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15738            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15739            MOVE ER-2762     TO WS-ERROR
 15740            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15741
 15742     IF LF-COVERAGE-CANCELLED
 15743        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15744        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15745             MOVE ER-2733         TO WS-ERROR
 15746             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15747
 15748     IF AH-COVERAGE-CANCELLED
 15749        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15750        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15751              MOVE ER-2733        TO WS-ERROR
 15752              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15753
 15754     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15755        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15756        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15757           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15758            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15759              IF PB-COMPANY-ID NOT = 'LAP'
 15760               MOVE ER-2704            TO WS-ERROR
 15761               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15762
 15763     IF CERT-WAS-NOT-FOUND
 15764         GO TO 3999-END-EDIT.
 15765
 15766     IF PB-COMPANY-ID EQUAL 'CDC'
 15767        IF LF-COVERAGE-CANCELLED
 15768           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15769            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15770            MOVE PB-C-LF-CANCEL-DT
 15771                                 TO DC-BIN-DATE-2
 15772            SET ELAPSED-BETWEEN-BIN TO TRUE
 15773*           MOVE 1               TO DC-OPTION-CODE
 15774            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 285
* EL050.cbl
 15775            IF DATE-CONVERSION-ERROR
 15776               NEXT SENTENCE
 15777             ELSE
 15778                IF DC-ELAPSED-DAYS GREATER +60
 15779                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15780
 15781     IF PB-COMPANY-ID EQUAL 'CDC'
 15782        IF AH-COVERAGE-CANCELLED
 15783           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15784            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15785            MOVE PB-C-AH-CANCEL-DT
 15786                                 TO DC-BIN-DATE-2
 15787            MOVE +0              TO DC-ELAPSED-DAYS
 15788                                    DC-ELAPSED-MONTHS
 15789            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15790*           MOVE 1               TO DC-OPTION-CODE
 15791            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15792            IF DATE-CONVERSION-ERROR
 15793               NEXT SENTENCE
 15794             ELSE
 15795                IF DC-ELAPSED-DAYS GREATER +60
 15796                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15797
 15798     MOVE +0                     TO DC-ELAPSED-DAYS
 15799                                    DC-ELAPSED-MONTHS.
 15800
 15801     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15802        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15803          MOVE 'Z'                TO PB-CI-OB-FLAG
 15804          MOVE ER-2767            TO WS-ERROR
 15805          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15806          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15807          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15808          GO TO 3775-OVER-REF-CHK
 15809        ELSE
 15810          MOVE ZEROS              TO PB-CI-LIVES
 15811                                     PB-C-LIVES
 15812          IF PB-CI-OB-FLAG NOT = 'B'
 15813             MOVE SPACE           TO PB-CI-OB-FLAG.
 15814
 15815     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15816         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15817     ELSE
 15818         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15819
 15820     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15821        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15822            MOVE ER-2760         TO WS-ERROR
 15823            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15824
 15825     IF LF-COVERAGE-CANCELLED
 15826        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15827         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15828            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15829               MOVE ER-2774       TO WS-ERROR
 15830               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15831
 15832     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 286
* EL050.cbl
 15833        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15834         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15835            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15836               MOVE ER-2775       TO WS-ERROR
 15837               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15838
 15839     IF LF-COVERAGE-CANCELLED
 15840        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15841         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15842            MOVE ER-2776         TO WS-ERROR
 15843            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15844
 15845     IF AH-COVERAGE-CANCELLED
 15846        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15847         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15848            MOVE ER-2777         TO WS-ERROR
 15849            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15850
 15851     IF LF-COVERAGE-CANCELLED
 15852        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15853        if pb-ci-lf-expire-dt = low-values or spaces
 15854           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15855           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15856           MOVE PB-CI-EXTENTION-DAYS
 15857                                 TO DC-ELAPSED-DAYS
 15858           SET BIN-PLUS-ELAPSED  TO TRUE
 15859           PERFORM 8500-DATE-CONVERT
 15860                                 THRU 8500-EXIT
 15861           IF DATE-CONVERSION-ERROR
 15862              move low-values    to dc-bin-date-2
 15863           end-if
 15864        else
 15865           move pb-ci-lf-expire-dt
 15866                                 to dc-bin-date-2
 15867        end-if
 15868        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15869           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15870                             OR  'FIA'
 15871              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15872           ELSE
 15873              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15874              MOVE ER-2731       TO WS-ERROR
 15875              PERFORM 9900-ERROR-FORMAT
 15876                                 THRU 9900-EXIT
 15877           end-if
 15878        end-if
 15879     end-if
 15880*    IF LF-COVERAGE-CANCELLED
 15881*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15882*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15883*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15884*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15885*        SET BIN-PLUS-ELAPSED      TO TRUE
 15886*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15887*        IF DATE-CONVERSION-ERROR
 15888*           NEXT SENTENCE
 15889*         ELSE
 15890*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 287
* EL050.cbl
 15891*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15892*                            OR  'FIA'
 15893*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15894*              ELSE
 15895*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15896*               MOVE ER-2731       TO WS-ERROR
 15897*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15898     .
 15899 3705-EDIT-AH-CANCEL-DT.
 15900     IF AH-COVERAGE-CANCELLED
 15901        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15902        if pb-ci-AH-expire-dt = low-values or spaces
 15903           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15904           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15905           MOVE PB-CI-EXTENTION-DAYS
 15906                                 TO DC-ELAPSED-DAYS
 15907           SET BIN-PLUS-ELAPSED  TO TRUE
 15908           PERFORM 8500-DATE-CONVERT
 15909                                 THRU 8500-EXIT
 15910           IF DATE-CONVERSION-ERROR
 15911              move low-values    to dc-bin-date-2
 15912           end-if
 15913        else
 15914           move pb-ci-ah-expire-dt
 15915                                 to dc-bin-date-2
 15916        end-if
 15917        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15918           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15919                             OR  'FIA'
 15920              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15921           ELSE
 15922              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15923              MOVE ER-2771       TO WS-ERROR
 15924              PERFORM 9900-ERROR-FORMAT
 15925                                 THRU 9900-EXIT
 15926           end-if
 15927        end-if
 15928     end-if
 15929*    IF AH-COVERAGE-CANCELLED
 15930*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15931*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15932*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15933*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15934**       MOVE 6                    TO DC-OPTION-CODE
 15935*        SET BIN-PLUS-ELAPSED      TO TRUE
 15936*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15937*        IF DATE-CONVERSION-ERROR
 15938*           NEXT SENTENCE
 15939*         ELSE
 15940*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15941*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15942*                             OR 'FIA'
 15943*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15944*             ELSE
 15945*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15946*              MOVE ER-2771       TO WS-ERROR
 15947*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15948     .
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 288
* EL050.cbl
 15949 3705-EDIT-CONTINUED.
 15950
 15951*    IF LF-COVERAGE-CANCELLED
 15952*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15953*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15954*            MOVE ER-2727         TO WS-ERROR
 15955*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15956*
 15957*    IF AH-COVERAGE-CANCELLED
 15958*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15959*        IF PB-COMPANY-ID = 'ACE'
 15960*           MOVE ER-2727        TO WS-ERROR
 15961*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15962*        ELSE
 15963*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15964*              MOVE ER-2727     TO WS-ERROR
 15965*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15966
 15967     IF PB-COMPANY-ID = 'ACE'
 15968       IF AH-COVERAGE-CANCELLED
 15969         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15970           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15971              MOVE ER-2732      TO WS-ERROR
 15972              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15973
 15974     IF PB-COMPANY-ID      EQUAL   'HER'
 15975        IF WS-ERROR        EQUAL   ER-2727
 15976            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15977            MOVE  ER-2725          TO  WS-ERROR
 15978            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15979
 15980     IF PB-C-CLAIM-CREATED-CANCEL
 15981            MOVE ER-2748         TO WS-ERROR
 15982            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15983
 15984     IF PB-C-LAST-NAME NOT = SPACES
 15985         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15986            MOVE ER-2747         TO WS-ERROR
 15987            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15988
 15989 3710-EDIT-LUMP-SUM-PRIOR.
 15990
 15991     IF AH-COVERAGE-CANCELLED
 15992         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15993             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15994                MOVE ER-2735    TO WS-ERROR
 15995                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15996
 15997     IF LF-COVERAGE-CANCELLED
 15998         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15999             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16000                MOVE ER-2735    TO WS-ERROR
 16001                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16002
 16003 3710-EDIT-PRIOR-DEATH.
 16004
 16005*    IF LF-COVERAGE-CANCELLED
 16006*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 289
* EL050.cbl
 16007*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16008*           (NOT PB-CI-OB)
 16009*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16010*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16011*                   MOVE ER-2732  TO WS-ERROR
 16012*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16013*
 16014*    IF AH-COVERAGE-CANCELLED
 16015*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16016*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16017*           (NOT PB-CI-OB)
 16018*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16019*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16020*                   MOVE ER-2732  TO WS-ERROR
 16021*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16022
 16023     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16024         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16025            (NOT PB-COMP-LF-CANCEL)
 16026             NEXT SENTENCE
 16027         ELSE
 16028           IF PB-C-LF-CANCEL-VOIDED
 16029              NEXT SENTENCE
 16030           ELSE
 16031              MOVE ER-2753      TO WS-ERROR
 16032              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16033
 16034     IF CANCEL-FUTURE-DT
 16035         GO TO 3999-END-EDIT.
 16036
 16037 3715-GET-REMAIN-TERM-LF.
 16038
 16039     IF NO-LF-BENEFIT-MATCH  OR
 16040        WS-LF-BENEFIT-CD = ZEROS
 16041        GO TO 3730-GET-AH-REMAIN-TERM.
 16042
 16043     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16044     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16045     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16046     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16047     MOVE PB-SV-STATE            TO CP-STATE.
 16048     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16049     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16050     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16051     MOVE '2'                    TO CP-PROCESS-TYPE.
 16052     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16053     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16054     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16055     IF (PB-COMPANY-ID = 'CID')
 16056        AND (CP-STATE-STD-ABBRV = 'WI')
 16057        MOVE '7'                 TO CP-REM-TERM-METHOD
 16058        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16059     ELSE
 16060        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16061        MOVE WS-REM-TRM-CALC-OPTION
 16062                                 TO CP-REM-TRM-CALC-OPTION
 16063     END-IF
 16064**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 290
* EL050.cbl
 16065     IF (PB-COMPANY-ID = 'CID')
 16066        AND (CP-STATE-STD-ABBRV = 'MO')
 16067        AND (PB-CERT-EFF-DT >= X'9B41')
 16068        AND (PB-CERT-EFF-DT <= X'A2FB')
 16069        MOVE '7'                 TO CP-REM-TERM-METHOD
 16070        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16071     END-IF
 16072     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16073                                    CP-LOAN-TERM.
 16074     IF CP-TRUNCATED-LIFE
 16075        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16076
 16077     IF CP-TERM-IS-DAYS
 16078         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16079     ELSE
 16080         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16081
 16082     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16083
 16084     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16085
 16086     IF LF-COVERAGE-CANCELLED
 16087        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16088        NEXT SENTENCE
 16089      ELSE
 16090          GO TO 3730-GET-AH-REMAIN-TERM.
 16091
 16092 3720-GET-LF-REFUND.
 16093
 16094     IF PB-C-LF-CANCEL-VOIDED
 16095        GO TO 3730-GET-AH-REMAIN-TERM
 16096     end-if
 16097
 16098     IF PB-COMPANY-ID EQUAL 'BOA'
 16099         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16100         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16101         GO TO 3730-GET-AH-REMAIN-TERM.
 16102
 16103     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16104        (WS-AH-SPECIAL-CALC-CD = 'M')
 16105         MOVE ER-2767            TO WS-ERROR
 16106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16107         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16108         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16109         GO TO 3780-UPDATE-CANCEL-CERT.
 16110
 16111*    if (ws-lf-earnings-calc = '6')
 16112*       or (pb-c-lf-refund-override = '6')
 16113*       move cp-remaining-term-1 to cp-remaining-term-2
 16114*    end-if
 16115     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16116
 16117     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16118     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16119     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16120     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16121     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16122     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 291
* EL050.cbl
 16123     IF PB-COMPANY-ID = 'DCC'
 16124        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16125        IF PDEF-MASTER-FOUND
 16126           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16127              (V1 > +8)
 16128              OR (PD-PROD-CODE (V1) = 'L')
 16129           END-PERFORM
 16130           IF V1 < +9
 16131              MOVE PD-MAX-AMT (V1)
 16132                           TO CP-R-MAX-TOT-BEN
 16133                              EC-AM-LF-MAX-TOT-BEN
 16134           END-IF
 16135        ELSE
 16136        MOVE ' '                 TO PDEF-MASTER-SW
 16137        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16138        MOVE PB-STATE            TO ERPDEF-STATE
 16139        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16140           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16141        END-IF
 16142        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16143        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16144        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16145        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16146        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16147        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16148        IF PDEF-MASTER-FOUND
 16149           MOVE 'N'              TO PDEF-MASTER-SW
 16150           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16151           IF PDEF-MASTER-FOUND
 16152              IF (ERPDEF-KEY-SAVE (1:16) =
 16153                           PD-CONTROL-PRIMARY (1:16))
 16154                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16155                 CONTINUE
 16156              ELSE
 16157                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16158                 IF (ERPDEF-KEY-SAVE (1:16) =
 16159                           PD-CONTROL-PRIMARY (1:16))
 16160                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16161                    CONTINUE
 16162                 ELSE
 16163                    MOVE 'N'     TO PDEF-MASTER-SW
 16164                 END-IF
 16165              END-IF
 16166
 16167              IF PDEF-MASTER-FOUND
 16168                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16169                    (V1 > +8)
 16170                    OR (PD-PROD-CODE (V1) = 'L')
 16171                 END-PERFORM
 16172                 IF V1 < +9
 16173                    MOVE PD-MAX-AMT (V1)
 16174                                 TO CP-R-MAX-TOT-BEN
 16175                                    EC-AM-LF-MAX-TOT-BEN
 16176                 END-IF
 16177              END-IF
 16178           END-IF
 16179           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16180        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 292
* EL050.cbl
 16181        END-IF
 16182     END-IF
 16183     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16184
 16185     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16186
 16187     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16188                                    PB-C-LF-REM-TERM.
 16189
 16190     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16191     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16192
 16193     IF PB-COMPANY-ID EQUAL 'FLC'
 16194        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16195           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16196           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16197                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16198                    - CM-LF-ITD-DEATH-AMT
 16199           IF PB-C-LF-REF-CALC LESS THAN +0
 16200              MOVE +0            TO PB-C-LF-REF-CALC
 16201              GO TO 3730-GET-AH-REMAIN-TERM
 16202           ELSE
 16203              GO TO 3730-GET-AH-REMAIN-TERM.
 16204
 16205     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16206                            OR '4' OR '5' OR '6' OR '8'
 16207                            OR '9' OR 'G'
 16208        MOVE PB-C-LF-REFUND-OVERRIDE
 16209                                 TO CP-EARNING-METHOD.
 16210
 16211     if pb-company-id = 'AHL'
 16212        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16213        if cp-class-code = spaces
 16214           move zeros            to cp-class-code
 16215        end-if
 16216     ELSE
 16217        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16218     END-IF
 16219*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16220     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16221     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16222                                    CP-RATING-BENEFIT-AMT.
 16223     IF CP-STATE-STD-ABBRV = 'OR'
 16224         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16225                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16226     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16227     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16228     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16229     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16230     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16231     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16232     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16233     IF WS-DEFAULT-APR NOT NUMERIC
 16234         MOVE ZEROS TO WS-DEFAULT-APR.
 16235****   N O T E   ****
 16236*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16237*      THE OH HARD CODING IN ELCRFNDP
 16238
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 293
* EL050.cbl
 16239     IF PB-COMPANY-ID = 'CID'
 16240        IF CP-STATE-STD-ABBRV = 'OH'
 16241           MOVE WS-LF-EARNINGS-CALC
 16242                                 TO CP-EARNING-METHOD
 16243        END-IF
 16244     END-IF
 16245
 16246****   N O T E   ****
 16247
 16248     IF CP-EARN-AS-NET-PAY
 16249         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16250            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16251                MOVE WS-DEFAULT-APR
 16252                                 TO  CP-LOAN-APR
 16253                MOVE ER-3780     TO  WS-ERROR
 16254                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16255            ELSE
 16256                MOVE ER-3781     TO  WS-ERROR
 16257                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16258*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16259     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16260
 16261     IF CP-REFUND-TYPE-USED NOT = SPACE
 16262         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16263
 16264     IF CP-ERROR-RATE-IS-ZERO OR
 16265        CP-ERROR-RATE-NOT-FOUND
 16266        MOVE ER-2740             TO WS-ERROR
 16267        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16268
 16269     IF CP-ERROR-RATE-FILE-NOTOPEN
 16270        MOVE ER-2617             TO WS-ERROR
 16271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16272
 16273     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16274        AND PB-CI-ENTRY-STATUS = 'M'
 16275        MOVE +0                  TO PB-C-LF-REF-CALC
 16276     ELSE
 16277        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16278     END-IF
 16279
 16280     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16281         GO TO 3730-GET-AH-REMAIN-TERM.
 16282
 16283*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16284*       ADD +1                   TO PB-C-LF-REM-TERM
 16285*                                   CP-REMAINING-TERM
 16286*                                   CP-ORIGINAL-TERM.
 16287
 16288     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16289     MOVE '2'                    TO CP-EARNING-METHOD
 16290                                    CP-RATING-METHOD.
 16291     IF PB-COMPANY-ID = 'CID'
 16292        IF (CP-STATE-STD-ABBRV = 'MN')
 16293           AND (PB-CERT-EFF-DT > X'A4FF')
 16294           AND (WS-LF-EARNINGS-CALC = 'B')
 16295           MOVE '5'              TO CP-EARNING-METHOD
 16296           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 294
* EL050.cbl
 16297        END-IF
 16298     END-IF
 16299     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16300                                        CP-REMAINING-BENEFIT
 16301                                        CP-RATING-BENEFIT-AMT.
 16302     IF CP-STATE-STD-ABBRV = 'OR'
 16303         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16304                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16305     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16306     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16307
 16308     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16309
 16310     IF CP-ERROR-RATE-IS-ZERO OR
 16311        CP-ERROR-RATE-NOT-FOUND
 16312        MOVE ER-2740             TO WS-ERROR
 16313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16314
 16315     IF CP-ERROR-RATE-FILE-NOTOPEN
 16316        MOVE ER-2617             TO WS-ERROR
 16317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16318
 16319     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16320
 16321******************************************************************
 16322
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 295
* EL050.cbl
 16324 3730-GET-AH-REMAIN-TERM.
 16325     IF NO-AH-BENEFIT-MATCH  OR
 16326        WS-AH-BENEFIT-CD = ZEROS
 16327         GO TO 3770-CHECK-REFUNDS.
 16328
 16329     IF PB-CI-AH-LUMP-SUM-DISAB
 16330         IF  PB-C-AH-CANCEL-AMT = ZERO
 16331            IF NOT PB-COMP-AH-CANCEL
 16332             GO TO 3770-CHECK-REFUNDS.
 16333
 16334     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16335     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16336     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16337     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16338     MOVE PB-SV-STATE            TO CP-STATE.
 16339     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16340     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16341     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16342     MOVE '2'                    TO CP-PROCESS-TYPE.
 16343     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16344     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16345     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16346     IF (PB-COMPANY-ID = 'CID')
 16347        AND (CP-STATE-STD-ABBRV = 'WI')
 16348        MOVE '7'                 TO CP-REM-TERM-METHOD
 16349        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16350     ELSE
 16351        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16352        MOVE WS-REM-TRM-CALC-OPTION
 16353                                 TO CP-REM-TRM-CALC-OPTION
 16354     END-IF
 16355     IF (PB-COMPANY-ID = 'CID')
 16356        AND (CP-STATE-STD-ABBRV = 'MO')
 16357        AND (PB-CERT-EFF-DT >= X'9B41')
 16358        AND (PB-CERT-EFF-DT <= X'A2FB')
 16359        MOVE '7'                 TO CP-REM-TERM-METHOD
 16360        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16361     END-IF
 16362     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16363                                    CP-LOAN-TERM.
 16364     IF NOT CP-TERM-IS-DAYS
 16365         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16366
 16367     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16368
 16369     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16370
 16371     IF AH-COVERAGE-CANCELLED
 16372        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16373        NEXT SENTENCE
 16374      ELSE
 16375         GO TO 3770-CHECK-REFUNDS.
 16376
 16377 3740-GET-AH-REFUND.
 16378
 16379     IF PB-C-AH-CANCEL-VOIDED
 16380        GO TO 3780-UPDATE-CANCEL-CERT
 16381     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 296
* EL050.cbl
 16382
 16383     IF PB-COMPANY-ID = 'BOA'
 16384         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16385         GO TO 3770-CHECK-REFUNDS.
 16386
 16387     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16388*    MOVE ' '                    TO DC-OPTION-CODE
 16389     SET BIN-TO-GREG             TO TRUE
 16390     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16391     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16392                                    PB-C-AH-REM-TERM.
 16393     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16394     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16395
 16396     IF PB-COMPANY-ID EQUAL 'FLC'
 16397        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16398           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16399           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16400                    - CM-AH-ITD-AH-PMT)
 16401           IF PB-C-AH-REF-CALC LESS THAN +0
 16402              MOVE +0            TO PB-C-AH-REF-CALC
 16403              GO TO 3770-CHECK-REFUNDS
 16404           ELSE
 16405              GO TO 3770-CHECK-REFUNDS.
 16406
 16407     IF PB-COMPANY-ID = 'DCC'
 16408        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16409            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16410           MOVE 'S'              TO CP-EARNING-METHOD
 16411        END-IF
 16412     END-IF
 16413     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16414                            OR '4' OR '5' OR '6' OR '8'
 16415                            OR '9' OR 'G' OR 'S'
 16416        MOVE PB-C-AH-REFUND-OVERRIDE
 16417                                 TO CP-EARNING-METHOD.
 16418
 16419     if pb-company-id = 'AHL'
 16420        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16421        if cp-class-code = spaces
 16422           move zeros            to cp-class-code
 16423        end-if
 16424     ELSE
 16425        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16426     END-IF
 16427*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16428     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16429     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16430                                    CP-RATING-BENEFIT-AMT.
 16431     IF CP-STATE-STD-ABBRV = 'OR'
 16432         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16433                                         PB-CI-AH-TERM.
 16434     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16435     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16436     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16437     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16438     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16439     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 297
* EL050.cbl
 16440
 16441     IF CP-STATE-STD-ABBRV = 'OH'
 16442        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16443                                AND 'CID' AND 'DCC' and 'VPP'
 16444                                AND 'AHL')
 16445           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16446              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16447              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16448              MOVE '6' TO CP-EARNING-METHOD
 16449           END-IF
 16450        END-IF
 16451        IF PB-COMPANY-ID = 'CID'
 16452           IF NO-LIFE-COVERAGE
 16453              IF CP-CRITICAL-PERIOD
 16454                 MOVE '2'       TO CP-EARNING-METHOD
 16455              ELSE
 16456                 MOVE '6'       TO CP-EARNING-METHOD
 16457              END-IF
 16458           ELSE
 16459              IF WS-LF-COVERAGE-TYPE = 'L'
 16460                 MOVE '2'       TO CP-EARNING-METHOD
 16461              ELSE
 16462                 IF (PB-CI-LF-TERM > +60) OR
 16463                    (WS-LF-EARNINGS-CALC = '5')
 16464                    IF CP-CRITICAL-PERIOD
 16465                       MOVE '2'  TO CP-EARNING-METHOD
 16466                    ELSE
 16467                       MOVE '6'  TO CP-EARNING-METHOD
 16468                    END-IF
 16469                 ELSE
 16470                    MOVE '1'     TO CP-EARNING-METHOD
 16471                 END-IF
 16472              END-IF
 16473           END-IF
 16474        END-IF
 16475     END-IF
 16476
 16477*    IF CP-STATE-STD-ABBRV = 'VA'
 16478*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16479*          IF CP-ORIGINAL-TERM GREATER 61
 16480*             MOVE '6' TO CP-EARNING-METHOD
 16481*          ELSE
 16482*             MOVE '1' TO CP-EARNING-METHOD.
 16483
 16484     IF WS-DEFAULT-APR NOT NUMERIC
 16485         MOVE ZEROS TO WS-DEFAULT-APR.
 16486     IF CP-EARN-AS-NET-PAY
 16487         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16488            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16489                MOVE WS-DEFAULT-APR
 16490                                 TO  CP-LOAN-APR
 16491                MOVE ER-3780     TO  WS-ERROR
 16492                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16493            ELSE
 16494                MOVE ER-3781     TO  WS-ERROR
 16495                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16496     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16497     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 298
* EL050.cbl
 16498        AND CP-CANCEL-REASON = 'R'
 16499        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16500        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16501     END-IF
 16502     IF PB-COMPANY-ID = 'DCC'
 16503        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16504        AND (CP-EARNING-METHOD = 'D')
 16505        AND (CP-CANCEL-REASON NOT = 'R')
 16506        CONTINUE
 16507     ELSE
 16508        GO TO 3750-CONTINUE
 16509     END-IF
 16510     MOVE ' '                    TO DD-IU-SW
 16511     IF NOT PDEF-MASTER-FOUND
 16512        MOVE ' '                 TO PDEF-MASTER-SW
 16513        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16514        MOVE PB-STATE            TO ERPDEF-STATE
 16515        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16516           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16517        END-IF
 16518        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16519        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16520        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16521        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16522        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16523        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16524        IF PDEF-MASTER-FOUND
 16525           MOVE 'N'              TO PDEF-MASTER-SW
 16526           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16527           IF PDEF-MASTER-FOUND
 16528              IF (ERPDEF-KEY-SAVE (1:16) =
 16529                           PD-CONTROL-PRIMARY (1:16))
 16530                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16531                 CONTINUE
 16532              ELSE
 16533                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16534                 IF (ERPDEF-KEY-SAVE (1:16) =
 16535                           PD-CONTROL-PRIMARY (1:16))
 16536                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16537                    CONTINUE
 16538                 ELSE
 16539                    MOVE ER-2740 TO WS-ERROR
 16540                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16541                    GO TO 3770-CHECK-REFUNDS
 16542                 END-IF
 16543              END-IF
 16544           END-IF
 16545           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16546        END-IF
 16547     END-IF
 16548     IF PDEF-MASTER-FOUND
 16549        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16550           (V1 > +8)
 16551           OR (PD-PROD-CODE (V1) = 'I')
 16552        END-PERFORM
 16553        IF V1 < +9
 16554           SET DD-IU-PRESENT        TO TRUE
 16555        END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 299
* EL050.cbl
 16556        IF WS-AH-DCC-TRUNC = 'T'
 16557           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16558        ELSE
 16559           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16560        END-IF
 16561        EVALUATE TRUE
 16562           WHEN WS-TERM > +168
 16563              MOVE 15               TO V1
 16564           WHEN WS-TERM > +156
 16565              MOVE 14               TO V1
 16566           WHEN WS-TERM > +144
 16567              MOVE 13               TO V1
 16568           WHEN WS-TERM > +132
 16569              MOVE 12               TO V1
 16570           WHEN WS-TERM > +120
 16571              MOVE 11               TO V1
 16572           WHEN WS-TERM > +108
 16573              MOVE 10               TO V1
 16574           WHEN WS-TERM > +96
 16575              MOVE 9                TO V1
 16576           WHEN WS-TERM > +84
 16577              MOVE 8                TO V1
 16578           WHEN WS-TERM > +72
 16579              MOVE 7                TO V1
 16580           WHEN WS-TERM > +60
 16581              MOVE 6                TO V1
 16582           WHEN WS-TERM > +48
 16583              MOVE 5                TO V1
 16584           WHEN WS-TERM > +36
 16585              MOVE 4                TO V1
 16586           WHEN WS-TERM > +24
 16587              MOVE 3                TO V1
 16588           WHEN WS-TERM > +12
 16589              MOVE 2                TO V1
 16590           WHEN OTHER
 16591              MOVE 1                TO V1
 16592        END-EVALUATE
 16593
 16594        EVALUATE TRUE
 16595*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16596*             < +13)
 16597*             AND (DD-IU-PRESENT)
 16598*             MOVE 2                TO V2
 16599*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16600*             MOVE 1                TO V2
 16601           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16602              MOVE 2                TO V2
 16603           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16604              MOVE 3                TO V2
 16605           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16606              MOVE 4                TO V2
 16607           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16608              MOVE 5                TO V2
 16609           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16610              MOVE 6                TO V2
 16611           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16612              MOVE 7                TO V2
 16613           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 300
* EL050.cbl
 16614              MOVE 8                TO V2
 16615           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16616              MOVE 9                TO V2
 16617           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16618              MOVE 10               TO V2
 16619           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16620              MOVE 11               TO V2
 16621           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16622              MOVE 12               TO V2
 16623           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16624              MOVE 13               TO V2
 16625           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16626              MOVE 14               TO V2
 16627           WHEN OTHER
 16628              MOVE 15               TO V2
 16629        END-EVALUATE
 16630
 16631        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16632                                 TO CP-DDF-LO-FACT
 16633        MOVE PD-UEP-FACTOR (V1 V2)
 16634                                 TO CP-DDF-HI-FACT
 16635
 16636        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16637        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16638        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16639           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16640        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16641        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16642        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16643           + PD-1ST-YR-ADMIN-ALLOW
 16644
 16645        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16646*       IF PI-CLP-YN = 'Y'
 16647*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16648*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16649*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16650*       END-IF
 16651
 16652        IF DD-IU-PRESENT
 16653           MOVE 'I'              TO CP-EARNING-METHOD
 16654        END-IF
 16655        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16656                                     CP-CLP-RATE-UP
 16657        IF CP-IU-RATE-UP NOT = ZEROS
 16658           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16659              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16660           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16661              / (1 - WS-WORK-FACT)
 16662        END-IF
 16663     END-IF
 16664     .
 16665 3750-CONTINUE.
 16666     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16667
 16668     IF CP-REFUND-TYPE-USED NOT = SPACE
 16669         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16670
 16671     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 301
* EL050.cbl
 16672        CP-ERROR-RATE-NOT-FOUND
 16673        MOVE ER-2740             TO WS-ERROR
 16674        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16675
 16676     IF CP-ERROR-RATE-FILE-NOTOPEN
 16677        MOVE ER-2617             TO WS-ERROR
 16678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16679     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16680        AND PB-CI-ENTRY-STATUS = 'M'
 16681        MOVE +0                  TO PB-C-AH-REF-CALC
 16682     ELSE
 16683        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16684     END-IF
 16685     if pb-company-id = 'VPP'
 16686        MOVE cm-ah-clp           to cp-original-premium
 16687        move zeros               to cp-calc-refund
 16688        perform 7600-get-refund  thru 7600-exit
 16689        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16690           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16691        else
 16692           move zeros            to pb-c-ah-rfnd-clp
 16693        end-if
 16694        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16695           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16696           pb-ci-cancel-fee
 16697     end-if
 16698     IF PB-COMPANY-ID = 'DCC'
 16699        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16700        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16701        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16702        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16703        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16704        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16705        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16706        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16707*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16708     END-IF
 16709     .
 16710 3770-CHECK-REFUNDS.
 16711
 16712     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16713        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16714           MOVE ER-2766          TO WS-ERROR
 16715           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16716           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16717           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16718              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16719
 16720     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16721        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16722           MOVE ER-2766          TO WS-ERROR
 16723           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16724           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16725           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16726              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16727
 16728     IF PB-COMP-LF-CANCEL
 16729        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 302
* EL050.cbl
 16730        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16731           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16732              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16733
 16734     IF PB-COMP-AH-CANCEL
 16735        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16736        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16737           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16738              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16739
 16740     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16741             GIVING WS-UNSIGN-WRK1
 16742     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16743             GIVING WS-UNSIGN-WRK2.
 16744
 16745     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16746         MOVE ZERO TO WS-UNSIGN-WRK1.
 16747
 16748     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16749         MOVE ZERO TO WS-UNSIGN-WRK2.
 16750
 16751     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16752
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 303
* EL050.cbl
 16754
 16755 3772-CONTINUE.
 16756
 16757**********************************
 16758*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16759*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16760*** DOUBLES THE TOLERANCE AMOUNT.
 16761***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16762**********************************
 16763     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16764     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16765         IF WS-REF-REJECT-SW = SPACE
 16766             MOVE ER-2754        TO WS-ERROR
 16767             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16768           ELSE
 16769             MOVE ER-2736        TO WS-ERROR
 16770             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16771**********************************
 16772
 16773 3773-CONTINUE.
 16774
 16775     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16776        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16777           MOVE ER-2723          TO WS-ERROR
 16778           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16779
 16780     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16781        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16782           MOVE ER-2724          TO WS-ERROR
 16783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16784
 16785     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16786         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16787             (1 + WS-LF-REFUND-OVS-PCT)
 16788     ELSE
 16789         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16790
 16791     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16792         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16793             (1 - WS-TOL-LF-REFUND-PCT)
 16794     ELSE
 16795         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16796
 16797     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16798        AND (PB-CI-ENTRY-STATUS = 'M')
 16799        AND (PB-C-LF-CANCEL-AMT > +0)
 16800        MOVE ER-3843             TO WS-ERROR
 16801        PERFORM 9900-ERROR-FORMAT
 16802                                 THRU 9900-EXIT
 16803     END-IF
 16804     EVALUATE TRUE
 16805        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16806           CONTINUE
 16807        WHEN PB-C-LF-CANCEL-AMT = +0
 16808                 AND PB-C-LF-REF-CALC > +0
 16809           CONTINUE
 16810        WHEN WS-LF-REFUND-OVS-AMT = 0
 16811                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 304
* EL050.cbl
 16812           CONTINUE
 16813        WHEN OTHER
 16814           IF WS-TOL-LF-REFUND  = +0
 16815              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16816           END-IF
 16817           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16818                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16819                          (PB-C-LF-CANCEL-AMT))
 16820              CONTINUE
 16821           ELSE
 16822              IF WS-LF-REFUND-OVS-AMT = +0
 16823                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16824              END-IF
 16825              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16826                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16827                                       PB-C-LF-CANCEL-AMT)
 16828                 CONTINUE
 16829              ELSE
 16830                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16831                   MOVE ER-2754   TO  WS-ERROR
 16832                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16833                 ELSE
 16834                    MOVE ER-2736   TO  WS-ERROR
 16835                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16836                 END-IF
 16837              END-IF
 16838           END-IF
 16839     END-EVALUATE.
 16840
 16841     EVALUATE TRUE
 16842        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16843           CONTINUE
 16844        WHEN PB-C-LF-CANCEL-AMT = +0
 16845                 AND PB-C-LF-REF-CALC > +0
 16846           CONTINUE
 16847        WHEN OTHER
 16848           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16849               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16850              CONTINUE
 16851           ELSE
 16852              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16853               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16854                CONTINUE
 16855              ELSE
 16856                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16857                     MOVE ER-2754   TO  WS-ERROR
 16858                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16859                 ELSE
 16860                     MOVE ER-2736   TO  WS-ERROR
 16861                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16862                 END-IF
 16863              END-IF
 16864           END-IF
 16865     END-EVALUATE.
 16866
 16867     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16868         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16869             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 305
* EL050.cbl
 16870     ELSE
 16871         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16872
 16873     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16874         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16875             (1 - WS-TOL-AH-REFUND-PCT)
 16876     ELSE
 16877         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16878
 16879     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16880        AND (PB-CI-ENTRY-STATUS = 'M')
 16881        AND (PB-C-AH-CANCEL-AMT > +0)
 16882        MOVE ER-3843             TO WS-ERROR
 16883        PERFORM 9900-ERROR-FORMAT
 16884                                 THRU 9900-EXIT
 16885     END-IF
 16886     EVALUATE TRUE
 16887        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16888           CONTINUE
 16889*       WHEN PB-C-AH-REF-CALC = +0 AND
 16890*                  PB-C-AH-CANCEL-AMT > +0
 16891        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16892                   PB-C-AH-REF-CALC > +0
 16893           CONTINUE
 16894        WHEN WS-AH-REFUND-OVS-AMT = +0
 16895                AND WS-TOL-AH-REFUND = +0
 16896           CONTINUE
 16897        WHEN OTHER
 16898           IF WS-TOL-AH-REFUND = +0
 16899              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16900           END-IF
 16901           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16902               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16903                                         PB-C-AH-CANCEL-AMT)
 16904              CONTINUE
 16905           ELSE
 16906              IF WS-AH-REFUND-OVS-AMT = +0
 16907                 MOVE +9999999.99 TO
 16908                         WS-AH-REFUND-OVS-AMT
 16909              END-IF
 16910              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16911                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16912                                         PB-C-AH-CANCEL-AMT)
 16913                 CONTINUE
 16914              ELSE
 16915                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16916                    MOVE ER-2754   TO  WS-ERROR
 16917                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16918                 ELSE
 16919                    MOVE ER-2736   TO  WS-ERROR
 16920                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16921                 END-IF
 16922              END-IF
 16923           END-IF
 16924     END-EVALUATE.
 16925
 16926     EVALUATE TRUE
 16927        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 306
* EL050.cbl
 16928           CONTINUE
 16929*       WHEN PB-C-AH-REF-CALC > +0 AND
 16930*                  PB-C-AH-CANCEL-AMT = +0
 16931        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16932                   PB-C-AH-REF-CALC = +0
 16933           CONTINUE
 16934        WHEN OTHER
 16935           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16936               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16937              CONTINUE
 16938           ELSE
 16939              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16940                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16941                 CONTINUE
 16942              ELSE
 16943                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16944                     MOVE ER-2754   TO  WS-ERROR
 16945                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16946                 ELSE
 16947                     MOVE ER-2736   TO  WS-ERROR
 16948                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16949                 END-IF
 16950              END-IF
 16951           END-IF
 16952     END-EVALUATE.
 16953
 16954     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16955        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16956        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16957           AND  PB-C-LF-REF-CALC < +1.00
 16958           AND  PB-C-AH-REF-CALC < +1.00
 16959           CONTINUE
 16960        ELSE
 16961           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16962              AND (PB-CI-ENTRY-STATUS = 'M')
 16963              CONTINUE
 16964           ELSE
 16965              MOVE ER-2741       TO WS-ERROR
 16966              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16967           END-IF
 16968        END-IF
 16969     END-IF
 16970
 16971     IF (PB-C-LF-CANCEL-AMT = ZERO
 16972        AND WS-LF-BENEFIT-CD NOT = ZERO
 16973        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16974        AND PB-C-LF-REF-CALC NOT = ZERO)
 16975        OR
 16976        (PB-C-LF-CANCEL-AMT = ZERO
 16977        AND WS-LF-BENEFIT-CD NOT = ZERO
 16978        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16979             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16980                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16981                NEXT SENTENCE
 16982             ELSE
 16983                MOVE ER-2739        TO WS-ERROR
 16984                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16985
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 307
* EL050.cbl
 16986     IF (PB-C-AH-CANCEL-AMT = ZERO
 16987        AND WS-AH-BENEFIT-CD NOT = ZERO
 16988        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16989        AND PB-C-AH-REF-CALC NOT = ZERO)
 16990        OR
 16991        (PB-C-AH-CANCEL-AMT = ZERO
 16992        AND WS-AH-BENEFIT-CD NOT = ZERO
 16993        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16994             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16995                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16996                NEXT SENTENCE
 16997             ELSE
 16998                MOVE ER-2738        TO WS-ERROR
 16999                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17000
 17001 3775-OVER-REF-CHK.
 17002
 17003     IF PB-CI-ENTRY-STATUS = '5'
 17004        GO TO 3780-UPDATE-CANCEL-CERT.
 17005
 17006     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17007                              PB-CI-LF-ALT-PREMIUM-AMT.
 17008
 17009     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17010        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17011                                 PB-C-LF-REF-CALC
 17012      ELSE
 17013        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17014                                 PB-C-LF-CANCEL-AMT.
 17015
 17016     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17017        MOVE ER-2755             TO WS-ERROR
 17018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17019
 17020     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17021
 17022     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17023        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17024                                 PB-C-AH-REF-CALC
 17025      ELSE
 17026        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17027                                 PB-C-AH-CANCEL-AMT.
 17028
 17029     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17030        MOVE ER-2778             TO WS-ERROR
 17031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17032
 17033     IF PB-CI-OB-FLAG NOT = 'Z'
 17034        NEXT SENTENCE
 17035       ELSE
 17036         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17037            MOVE ER-2757           TO WS-ERROR
 17038            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17039
 17040 3780-UPDATE-CANCEL-CERT.
 17041
 17042     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17043        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 308
* EL050.cbl
 17044        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17045
 17046     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17047         MOVE ER-2729              TO WS-ERROR
 17048         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17049
 17050     IF PB-CI-LF-BENEFIT-CD = ZERO
 17051         GO TO 3780-UPDATE-CONT-1.
 17052
 17053     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17054         GO TO 3780-UPDATE-CONT-1.
 17055
 17056     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17057       AND
 17058        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17059       AND
 17060        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17061       AND
 17062        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17063            NEXT SENTENCE
 17064       ELSE
 17065        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17066          AND
 17067***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17068***       AND
 17069           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17070            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17071               MOVE ER-2730      TO WS-ERROR
 17072               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17073               GO TO 3999-END-EDIT
 17074            ELSE
 17075               GO TO 3999-END-EDIT
 17076        ELSE
 17077            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17078               MOVE ER-2765           TO WS-ERROR
 17079               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17080               GO TO 3785-CHECK-NH.
 17081*              GO TO 3999-END-EDIT.
 17082
 17083 3780-UPDATE-CONT-1.
 17084     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17085
 17086     IF PB-CI-AH-BENEFIT-CD = ZERO
 17087         GO TO 3780-UPDATE-CONT-2.
 17088
 17089     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17090         GO TO 3780-UPDATE-CONT-2.
 17091
 17092     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17093
 17094     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17095       AND
 17096        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17097       AND
 17098        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17099       AND
 17100        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17101            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 309
* EL050.cbl
 17102       ELSE
 17103        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17104          AND
 17105***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17106***       AND
 17107           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17108           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17109            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17110               MOVE ER-2773      TO WS-ERROR
 17111               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17112               GO TO 3999-END-EDIT
 17113            ELSE
 17114               GO TO 3999-END-EDIT
 17115            END-IF
 17116           ELSE
 17117             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17118                IF MSTR-CERT-NO = W-CL-CERT-NO
 17119                   MOVE ER-2890 TO WS-ERROR
 17120                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17121                   GO TO 3999-END-EDIT
 17122                ELSE
 17123                   MOVE ER-2898 TO WS-ERROR
 17124                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17125                   GO TO 3999-END-EDIT
 17126                END-IF
 17127             ELSE
 17128                GO TO 3785-CHECK-NH
 17129             END-IF
 17130           END-IF
 17131          ELSE
 17132            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17133              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17134                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17135                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17136                      MOVE ER-2890 TO WS-ERROR
 17137                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17138                      GO TO 3999-END-EDIT
 17139                   ELSE
 17140                      MOVE ER-2898 TO WS-ERROR
 17141                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17142                      GO TO 3999-END-EDIT
 17143                   END-IF
 17144                ELSE
 17145                   MOVE ER-2765 TO WS-ERROR
 17146                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17147                   GO TO 3785-CHECK-NH
 17148                END-IF
 17149              ELSE
 17150               MOVE ER-2765      TO WS-ERROR
 17151               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17152               GO TO 3785-CHECK-NH.
 17153*              GO TO 3999-END-EDIT.
 17154
 17155 3780-UPDATE-CONT-2.
 17156
 17157     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17158        AND WS-LF-BENEFIT-CD = ZERO
 17159           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 310
* EL050.cbl
 17160           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17161
 17162     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17163        AND WS-AH-BENEFIT-CD = ZERO
 17164           MOVE ER-2744           TO WS-ERROR
 17165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17166
 17167     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17168        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17169        AND
 17170        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17171         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17172           MOVE ER-2746           TO WS-ERROR
 17173           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17174
 17175     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17176       AND
 17177        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17178             MOVE ER-2737        TO WS-ERROR
 17179             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17180
 17181     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17182       AND
 17183        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17184             MOVE ER-2737        TO WS-ERROR
 17185             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17186
 17187     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17188         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17189             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17190             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17191         ELSE
 17192             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17193                 MOVE ER-2768    TO WS-ERROR
 17194                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17195             ELSE
 17196                 MOVE ER-2756    TO WS-ERROR
 17197                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17198
 17199     IF CERT-PEND-ISSUE-RETURNED
 17200        MOVE ER-2772             TO WS-ERROR
 17201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17202 3785-CHECK-NH.
 17203*    IF PB-STATE NOT = 'NH' and 'TN'
 17204     IF PB-STATE NOT = 'NH'
 17205        GO TO 3999-END-EDIT
 17206     END-IF
 17207
 17208     MOVE ER-2796                TO WS-ERROR
 17209     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17210     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17211        OR (CM-NH-INTERFACE-SW = 'Y')
 17212        MOVE ER-2793             TO WS-ERROR
 17213        PERFORM 9900-ERROR-FORMAT
 17214                                 THRU 9900-EXIT
 17215     END-IF
 17216     MOVE +0                     TO WS-PAYMENT-AMT
 17217     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 311
* EL050.cbl
 17218        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17219               PB-C-AH-CANCEL-DT
 17220           GO TO 3999-END-EDIT
 17221        END-IF
 17222     end-if
 17223***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17224***-_-
 17225***-_-   For TN it's only flat cancels
 17226***-_-
 17227***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17228     if pb-state = 'TN'
 17229        if ((pb-c-lf-cancel-dt <> low-values)
 17230           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17231                      or
 17232           ((pb-c-ah-cancel-dt <> low-values)
 17233           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17234           GO TO 3999-END-EDIT
 17235        END-IF
 17236     end-if
 17237     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17238        GO TO 3999-END-EDIT
 17239     END-IF
 17240***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17241***-_-
 17242***-_-   if cancel date within 15 days of effective date, bypass
 17243***-_-
 17244***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17245     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17246     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17247     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17248        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17249     END-IF
 17250     MOVE '1'                    TO DC-OPTION-CODE
 17251     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17252     IF NO-CONVERSION-ERROR
 17253        and pb-state = 'NH'
 17254        IF DC-ELAPSED-DAYS < +16
 17255           GO TO 3999-END-EDIT
 17256        END-IF
 17257     END-IF
 17258***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17259***-_-
 17260***-_-   if cancel date within 30 days of current date then
 17261***-_-   bypass else subtract 15 days from period
 17262***-_-
 17263***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17264     MOVE +0                     TO DC-ELAPSED-DAYS
 17265     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17266     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17267     MOVE '1'                    TO DC-OPTION-CODE
 17268     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17269     IF NO-CONVERSION-ERROR
 17270        IF DC-ELAPSED-DAYS > +30
 17271           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17272        ELSE
 17273           GO TO 3999-END-EDIT
 17274        END-IF
 17275     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 312
* EL050.cbl
 17276        GO TO 3999-END-EDIT
 17277     END-IF
 17278***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17279***-_-
 17280***-_-   'NH' is 10%, TN is 3.5%
 17281***-_-
 17282***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17283     if pb-state = 'NH'
 17284        move +1.10               to ws-work-rate
 17285     else
 17286        move +1.035              to ws-work-rate
 17287     end-if
 17288     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17289        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17290           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17291     IF WS-PAYMENT-AMT < 600.00
 17292        GO TO 3999-END-EDIT
 17293     END-IF
 17294     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17295
 17296     IF (ERMAIL-FOUND = ' ')
 17297         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17298         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17299        GO TO 3999-END-EDIT
 17300     END-IF
 17301     MOVE ER-2795                TO WS-ERROR
 17302     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17303
 17304     GO TO 3999-END-EDIT.
 17305******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 313
* EL050.cbl
 17307 3990-FILES-NOT-OPEN.
 17308
 17309     MOVE ER-2617                TO WS-ERROR.
 17310     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17311     GO TO 9990-RETURN.
 17312
 17313 3999-END-EDIT.
 17314
 17315     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17316
 17317     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17318         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17319         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17320             PERFORM 9250-UNLOCK-RETURN
 17321             GO TO 9990-RETURN
 17322          ELSE
 17323             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17324             GO TO 9990-RETURN.
 17325
 17326     IF PB-CANCELLATION
 17327          GO TO 9990-RETURN.
 17328
 17329     IF CERT-WAS-NOT-FOUND
 17330        MOVE SPACES              TO CERTIFICATE-MASTER.
 17331
 17332     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17333
 17334     IF CERT-WAS-FOUND
 17335         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17336             PERFORM 9250-UNLOCK-RETURN
 17337          ELSE
 17338            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17339      ELSE
 17340         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17341
 17342     if pb-company-id = 'VPP'
 17343        perform 8150-read-elcrtt thru 8150-exit
 17344        if ws-vehicle-odometer numeric
 17345           if ws-vehicle-odometer > 6000
 17346              move er-1583       to ws-error
 17347              PERFORM 9900-ERROR-FORMAT
 17348                                 THRU 9900-EXIT
 17349           end-if
 17350        end-if
 17351     end-if
 17352     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17353        IF ((PB-COMPANY-ID = 'DCC')
 17354           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17355                         or
 17356            (pb-company-id = 'CID' or 'VPP')
 17357            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17358        END-IF
 17359     END-IF.
 17360
 17361     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17362         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17363     END-IF.
 17364     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 314
* EL050.cbl
 17365     perform 8150-read-elcrtt    thru 8150-exit
 17366     if ws-ins-age-defaulted = 'Y'
 17367        move er-1573             to ws-error
 17368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17369     end-if
 17370
 17371     if ws-jnt-age-defaulted = 'Y'
 17372        move er-1574             to ws-error
 17373        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17374     end-if
 17375***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17376***                                                           ****
 17377***  Set an error if the state requires verification of agent ****
 17378***  and agent hasn't verified yet and the status is not =    ****
 17379***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17380***  and the entry date > 09/01/2015.                         ****
 17381***                                                           ****
 17382***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17383     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17384        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17385        and (pb-account (9:2) not = 'OB')
 17386        if (ws-st-agent-sig-edit = 'Y')
 17387           and (am-report-code-1 not = 'CONLEY')
 17388           evaluate true
 17389              when cs-agent-edit-status = 'C'
 17390                 move er-1743    to ws-error
 17391                 perform 9900-error-format
 17392                                 thru 9900-exit
 17393              when cs-agent-edit-status = 'S'
 17394                 move er-1744    to ws-error
 17395                 perform 9900-error-format
 17396                                 thru 9900-exit
 17397              when cs-agent-edit-status = 'M'
 17398                 move er-1745    to ws-error
 17399                 perform 9900-error-format
 17400                                 thru 9900-exit
 17401              when cs-agent-edit-status = 'R'
 17402                 move er-1747    to ws-error
 17403                 perform 9900-error-format
 17404                                 thru 9900-exit
 17405              when cs-agent-edit-status = 'N'
 17406                 move er-1748    to ws-error
 17407                 perform 9900-error-format
 17408                                 thru 9900-exit
 17409              when cs-agent-edit-status <> 'V' and 'U' and
 17410                                           'R' and 'N'
 17411                 move er-1746    to ws-error
 17412                 perform 9900-error-format
 17413                                 thru 9900-exit
 17414           end-evaluate
 17415        end-if
 17416     end-if
 17417     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17418     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17419        AND (WS-NO-SECURE-PAY))
 17420                  OR
 17421        (WS-LF-SPECIAL-CALC-CD = 'O'
 17422        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 315
* EL050.cbl
 17423        SET SKIP-ADDR-EDIT       TO TRUE
 17424     END-IF
 17425     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17426        AND (NOT SKIP-ADDR-EDIT)
 17427        MOVE ER-2963             TO WS-ERROR
 17428        PERFORM 9900-ERROR-FORMAT
 17429                                 THRU 9900-EXIT
 17430        GO TO 9990-RETURN
 17431     END-IF
 17432     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17433     IF ERPNDM-FOUND NOT = 'X'
 17434        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17435           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17436           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17437           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17438           AND (NOT SKIP-ADDR-EDIT)
 17439           MOVE ER-2694          TO WS-ERROR
 17440           PERFORM 9900-ERROR-FORMAT
 17441                                 THRU 9900-EXIT
 17442        END-IF
 17443        MOVE ' '                 TO STATE-RECORD-ERROR
 17444        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17445        MOVE PM-STATE            TO CNTL-ACCESS
 17446        MOVE '3'                 TO CNTL-REC-TYPE
 17447        MOVE +0                  TO CNTL-SEQ-NO
 17448        MOVE '0'                 TO RC-SW-2
 17449        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17450        IF (NO-STATE-RECORD)
 17451           OR (CF-RECORD-TYPE NOT = '3')
 17452           OR (PM-STATE NOT = CF-STATE-CODE)
 17453           IF (PM-STATE = SPACES)
 17454              AND (SKIP-ADDR-EDIT)
 17455              CONTINUE
 17456           ELSE
 17457              MOVE ER-2963       TO WS-ERROR
 17458              PERFORM 9900-ERROR-FORMAT
 17459                                 THRU 9900-EXIT
 17460           END-IF
 17461        END-IF
 17462        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17463           MOVE ER-2883          TO WS-ERROR
 17464           PERFORM 9900-ERROR-FORMAT
 17465                                 THRU 9900-EXIT
 17466        END-IF
 17467        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17468           MOVE ' '                 TO STATE-RECORD-ERROR
 17469           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17470           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17471           MOVE '3'                 TO CNTL-REC-TYPE
 17472           MOVE +0                  TO CNTL-SEQ-NO
 17473           MOVE '0'                 TO RC-SW-2
 17474           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17475           IF NO-STATE-RECORD
 17476              OR (CF-RECORD-TYPE NOT = '3')
 17477              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17478              MOVE ER-2964          TO WS-ERROR
 17479              PERFORM 9900-ERROR-FORMAT
 17480                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 316
* EL050.cbl
 17481           END-IF
 17482        END-IF
 17483     ELSE
 17484        IF NOT SKIP-ADDR-EDIT
 17485           MOVE ER-2393          TO WS-ERROR
 17486           PERFORM 9900-ERROR-FORMAT
 17487                                 THRU 9900-EXIT
 17488        END-IF
 17489     END-IF
 17490
 17491     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17492
 17493     IF (ERMAIL-FOUND = ' ' AND
 17494        ERPNDM-FOUND = ' ')
 17495        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17496           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17497           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17498          OR
 17499           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17500          OR
 17501           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17502           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17503           GO TO 3999-UNLOCK-ERMAIL.
 17504
 17505     IF ERPNDM-FOUND = 'X'
 17506        GO TO 3999-UNLOCK-ERMAIL.
 17507
 17508     IF PM-INSURED-LAST-NAME      = SPACES
 17509        AND PM-INSURED-FIRST-NAME = SPACES
 17510        AND PM-ADDRESS-LINE-1     = SPACES
 17511        AND PM-ADDRESS-LINE-2     = SPACES
 17512        AND PM-CITY-STATE         = SPACES
 17513        AND PM-CRED-BENE-NAME     = SPACES
 17514        AND PM-CRED-BENE-ADDR     = SPACES
 17515        AND PM-CRED-BENE-CTYST    = SPACES
 17516        GO TO 3999-UNLOCK-ERMAIL
 17517     END-IF
 17518
 17519     MOVE SPACES                 TO MAILING-DATA.
 17520
 17521     MOVE 'MA'                   TO MA-RECORD-ID.
 17522     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17523     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17524     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17525     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17526     MOVE PB-SV-STATE            TO MA-STATE.
 17527     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17528     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17529
 17530     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17531     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17532
 17533     IF ERMAIL-FOUND = ' '
 17534        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17535     ELSE
 17536        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17537        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17538        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 317
* EL050.cbl
 17539
 17540     GO TO 9990-RETURN.
 17541
 17542 3999-UNLOCK-ERMAIL.
 17543     IF ERMAIL-FOUND = ' '
 17544        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17545
 17546     GO TO 9990-RETURN.
 17547******************************************************************
 17548
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 318
* EL050.cbl
 17550 4000-UPDATE-CANCELLED-CERT.
 17551     IF CERT-WAS-NOT-FOUND
 17552        GO TO 4299-EXIT.
 17553
 17554*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17555     IF PB-C-NH-INT-ON-REFS > ZEROS
 17556        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17557     END-IF
 17558     IF PB-C-REF-INTERFACE-SW = 'Y'
 17559        MOVE PB-C-REF-INTERFACE-SW
 17560                                 TO CM-NH-INTERFACE-SW
 17561     END-IF
 17562     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17563     IF ERMAIL-FOUND = 'X'
 17564        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17565        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17566        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17567        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17568           MOVE ER-2694          TO WS-ERROR
 17569           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17570     END-IF
 17571
 17572     IF PB-C-POST-CARD-IND = 'Y'
 17573        MOVE +8                  TO SUB
 17574*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17575        IF ERMAIL-FOUND = ' '
 17576           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17577              (SUB > +7)
 17578              OR (MA-MAIL-STATUS (SUB) = '1')
 17579           END-PERFORM
 17580        END-IF
 17581        IF (SUB > +7)
 17582           OR (ERMAIL-FOUND = 'X')
 17583           MOVE ER-3789          TO WS-ERROR
 17584           PERFORM 9900-ERROR-FORMAT
 17585                                 THRU 9900-EXIT
 17586        END-IF
 17587     ELSE
 17588        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17589     END-IF
 17590
 17591     IF ERMAIL-FOUND = ' '
 17592        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17593     END-IF.
 17594
 17595     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17596
 17597     IF PB-CI-OB-FLAG = 'Z'
 17598        GO TO 4150-SUMMARY-CERT-CANCEL.
 17599
 17600     IF PB-C-LF-CANCEL-VOIDED
 17601         PERFORM 4200-REVERSE-LF-CANCEL.
 17602     IF PB-C-AH-CANCEL-VOIDED
 17603         PERFORM 4200-REVERSE-AH-CANCEL.
 17604
 17605 4100-APPLY-LF-CANCEL.
 17606
 17607     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 319
* EL050.cbl
 17608
 17609 4100-CHECK-LF-ERRORS.
 17610
 17611     ADD +1                       TO WS-SUB.
 17612
 17613     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17614        IF LF-COVERAGE-CANCELLED
 17615           GO TO 4100-LF-CANCEL-CONT
 17616        ELSE
 17617           GO TO 4100-UPDATE-LF-COVERAGE.
 17618
 17619     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17620                                   ER-2729 OR
 17621                                   ER-2730 OR
 17622                                   ER-2731 OR
 17623                                   ER-2732 OR
 17624                                   ER-2737 OR
 17625                                   ER-2740 OR
 17626                                   ER-2743 OR
 17627                                   ER-2749 OR
 17628                                   ER-2750 OR
 17629                                   ER-2755 OR
 17630                                   ER-2757 OR
 17631                                   ER-2760 OR
 17632                                   ER-2772 OR
 17633                                   ER-2774 OR
 17634                                   ER-2776 OR
 17635                                   ER-2794
 17636        GO TO 4100-UPDATE-LF-COVERAGE.
 17637
 17638     GO TO 4100-CHECK-LF-ERRORS.
 17639
 17640 4100-UPDATE-LF-COVERAGE.
 17641
 17642     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17643     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17644     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17645        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17646     END-IF
 17647     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17648                                      TO CM-CREDIT-INTERFACE-SW-2.
 17649     IF CM-LF-CANCEL-DT = LOW-VALUE
 17650         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17651
 17652     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17653         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17654                                         CM-LF-STATUS-AT-CANCEL.
 17655
 17656     GO TO 4100-APPLY-AH-CANCEL.
 17657
 17658 4100-LF-CANCEL-CONT.
 17659     IF PB-C-LF-CANCEL-VOIDED
 17660         GO TO 4100-APPLY-AH-CANCEL.
 17661
 17662     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17663         GO TO 4100-APPLY-AH-CANCEL.
 17664
 17665     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 320
* EL050.cbl
 17666        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17667           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17668        ELSE
 17669           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17670
 17671     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17672     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17673
 17674     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17675         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17676
 17677     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17678        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17679         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17680         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17681
 17682     IF PB-RECORD-RETURNED
 17683        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17684      ELSE
 17685        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17686
 17687 4100-APPLY-AH-CANCEL.
 17688
 17689     MOVE +0                      TO WS-SUB.
 17690
 17691 4100-CHECK-AH-ERRORS.
 17692
 17693     ADD +1                       TO WS-SUB.
 17694
 17695     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17696        IF AH-COVERAGE-CANCELLED
 17697           GO TO 4100-AH-CANCEL-CONT
 17698        ELSE
 17699           GO TO 4100-UPDATE-AH-COVERAGE.
 17700
 17701     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17702                                   ER-2729 OR
 17703                                   ER-2732 OR
 17704                                   ER-2737 OR
 17705                                   ER-2740 OR
 17706                                   ER-2744 OR
 17707                                   ER-2749 OR
 17708                                   ER-2750 OR
 17709                                   ER-2755 OR
 17710                                   ER-2757 OR
 17711                                   ER-2760 OR
 17712                                   ER-2771 OR
 17713                                   ER-2772 OR
 17714                                   ER-2773 OR
 17715                                   ER-2775 OR
 17716                                   ER-2777 OR
 17717                                   ER-2778 OR
 17718                                   ER-2794
 17719        GO TO 4100-UPDATE-AH-COVERAGE.
 17720
 17721     GO TO 4100-CHECK-AH-ERRORS.
 17722
 17723 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 321
* EL050.cbl
 17724
 17725     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17726     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17727     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17728     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17729                                      TO CM-CREDIT-INTERFACE-SW-2.
 17730     IF CM-AH-CANCEL-DT = LOW-VALUE
 17731         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17732
 17733     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17734         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17735                                         CM-AH-STATUS-AT-CANCEL.
 17736
 17737     IF LF-COVERAGE-CANCELLED
 17738         IF PB-RECORD-RETURNED
 17739              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17740          ELSE
 17741              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17742
 17743     GO TO 4299-EXIT.
 17744
 17745 4100-AH-CANCEL-CONT.
 17746     IF PB-C-AH-CANCEL-VOIDED
 17747         GO TO 4299-EXIT.
 17748
 17749     if cm-credit-interface-sw-2 = ' '
 17750        if pb-fatal-errors or pb-unforced-errors
 17751           move '4'              to cm-credit-interface-sw-2
 17752        else
 17753           move '1'              to cm-credit-interface-sw-2
 17754        end-if
 17755     end-if
 17756     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17757         GO TO 4299-EXIT.
 17758
 17759     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17760        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17761           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17762        ELSE
 17763           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17764
 17765     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17766     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17767
 17768     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17769         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17770
 17771     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17772         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17773         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17774
 17775     IF PB-RECORD-RETURNED
 17776        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17777      ELSE
 17778        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17779
 17780     GO TO 4299-EXIT.
 17781
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 322
* EL050.cbl
 17782 4150-SUMMARY-CERT-CANCEL.
 17783     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17784
 17785     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17786        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17787                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17788     ELSE
 17789        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17790                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17791
 17792     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17793        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17794                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17795     ELSE
 17796        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17797                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17798
 17799     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17800        NEXT SENTENCE
 17801     ELSE
 17802        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17803
 17804     GO TO 4299-EXIT.
 17805
 17806 4200-REVERSE-LF-CANCEL.
 17807     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17808
 17809     IF CM-LF-CANCEL-APPLIED
 17810        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17811        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17812        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17813
 17814     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17815
 17816     IF PB-RECORD-RETURNED
 17817        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17818       ELSE
 17819        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17820
 17821 4200-REVERSE-LF-EXIT.
 17822       EXIT.
 17823
 17824 4200-REVERSE-AH-CANCEL.
 17825     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17826
 17827     IF CM-AH-CANCEL-APPLIED
 17828        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17829        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17830        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17831
 17832     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17833
 17834     IF PB-RECORD-RETURNED
 17835        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17836       ELSE
 17837        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17838
 17839 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 323
* EL050.cbl
 17840       EXIT.
 17841
 17842 4299-EXIT.
 17843       EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 324
* EL050.cbl
 17845
 17846 4500-UPDATE-NEW-CERT.
 17847     IF CERT-WAS-FOUND
 17848         NEXT SENTENCE
 17849       ELSE
 17850         GO TO 4520-BUILD-NEW-KEY.
 17851
 17852     IF  CLASIC-CREATED-CERT
 17853         GO TO 4999-EXIT.
 17854
 17855     IF  CERT-WAS-CREATED-FOR-CLAIM
 17856         GO TO 4520-BUILD-NEW-KEY.
 17857
 17858     IF CERT-ADDED-BATCH
 17859        IF CM-RECORD-ID = 'CM'
 17860            GO TO 4999-EXIT.
 17861
 17862 4520-BUILD-NEW-KEY.
 17863* BUILD CONTROL PRIMARY
 17864
 17865     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17866                                       CM-COMPANY-CD-A1
 17867                                       CM-COMPANY-CD-A2
 17868                                       CM-COMPANY-CD-A4
 17869                                       CM-COMPANY-CD-A5.
 17870
 17871     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17872     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17873     MOVE PB-SV-STATE               TO CM-STATE.
 17874     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17875     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17876     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17877     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17878
 17879     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17880
 17881     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17882     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17883     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17884     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17885
 17886     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17887        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17888
 17889     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17890         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17891         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17892         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17893         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17894     ELSE
 17895         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17896
 17897     IF PB-COMPANY-ID   EQUAL  'CRI'
 17898         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17899         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17900         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17901         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17902         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 325
* EL050.cbl
 17903
 17904     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17905        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17906         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17907
 17908     IF PB-COMPANY-ID  = 'LBL'
 17909        IF PB-I-JOINT-COVERAGE
 17910            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17911                                           PB-I-MEMBER-NO
 17912            GO TO 4550-CONT-CERT-PROCESS.
 17913
 17914     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17915        NEXT SENTENCE
 17916     ELSE
 17917        GO TO 4540-BUILD-MEMBER-NO.
 17918
 17919******************************************************************
 17920*                                                                *
 17921*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17922*    FOR 'MON'.                                                  *
 17923*                                                                *
 17924******************************************************************
 17925
 17926     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17927     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17928     MOVE +1                     TO WS-SUB1
 17929                                    WS-SUB2.
 17930
 17931 4530-EDIT-MEMB-NAME.
 17932
 17933     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17934        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17935        ADD +1                       TO WS-SUB2.
 17936
 17937     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17938        ADD +1                       TO WS-SUB1
 17939        GO TO 4530-EDIT-MEMB-NAME.
 17940
 17941     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17942     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17943     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17944*    MOVE SPACE                      TO DC-OPTION-CODE.
 17945     SET  BIN-TO-GREG                TO TRUE.
 17946     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17947     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17948
 17949     GO TO 4550-CONT-CERT-PROCESS.
 17950
 17951******************************************************************
 17952*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17953******************************************************************
 17954
 17955 4540-BUILD-MEMBER-NO.
 17956
 17957     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17958         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17959         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17960         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 326
* EL050.cbl
 17961         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17962     ELSE
 17963         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17964
 17965     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17966        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17967         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17968
 17969 4550-CONT-CERT-PROCESS.
 17970
 17971*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17972*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17973*    ELSE
 17974*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17975
 17976     IF CERT-WAS-CREATED-FOR-CLAIM
 17977        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17978        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17979
 17980     IF CERT-AND-CLAIM-ONLINE
 17981        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17982        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17983
 17984     MOVE 'CM'                     TO CM-RECORD-ID.
 17985     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17986
 17987     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17988        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17989        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17990     ELSE
 17991        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17992        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17993
 17994     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17995     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17996     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17997     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17998     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17999     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18000     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18001                                      CM-LF-ITD-CANCEL-AMT
 18002                                      CM-LF-ITD-DEATH-AMT
 18003                                      CM-AH-ITD-AH-PMT
 18004                                      CM-AH-ITD-LUMP-PMT
 18005                                      CM-AH-ITD-CANCEL-AMT
 18006                                      CM-LF-NSP-PREMIUM-AMT
 18007                                      CM-AH-NSP-PREMIUM-AMT.
 18008*                                     CM-CLAIM-DEDUCT-WITHHELD
 18009*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18010     if pb-i-loan-apr = +99.9999
 18011        move zeros                 to cm-loan-apr
 18012     else
 18013        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18014     end-if
 18015     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18016     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18017     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18018     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 327
* EL050.cbl
 18019     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18020     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18021     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18022     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18023     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18024     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18025     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18026
 18027     IF PB-I-LIVES NOT NUMERIC
 18028         MOVE ZERO                 TO PB-I-LIVES.
 18029
 18030     IF PB-I-NUM-BILLED NOT NUMERIC
 18031         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18032
 18033     MOVE PB-I-LIVES               TO CM-LIVES.
 18034     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18035
 18036     IF PB-COMPANY-ID EQUAL  'DMD'
 18037         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18038         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18039
 18040     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18041     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18042     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18043     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18044     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18045     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18046
 18047     IF PB-I-LF-POLICY-FEE NUMERIC
 18048        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18049     ELSE
 18050        MOVE +0                    TO CM-LF-POLICY-FEE.
 18051
 18052     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18053        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18054        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18055     ELSE
 18056        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18057
 18058     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18059     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18060     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18061     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18062     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18063     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18064     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18065     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18066     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18067
 18068     IF PB-I-CANCEL-FEE NUMERIC
 18069        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18070     ELSE
 18071        MOVE +0                  TO CM-CANCEL-FEE
 18072     END-IF
 18073
 18074     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18075        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18076     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 328
* EL050.cbl
 18077        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18078
 18079     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18080     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18081
 18082     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18083                                      CM-LF-DEATH-EXIT-DT
 18084                                      CM-AH-SETTLEMENT-EXIT-DT.
 18085
 18086*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18087*                       'TIH' OR 'OFL' OR 'FLA' OR
 18088*                       'TII' OR 'TMS' OR 'CRI' OR
 18089*                       'NCL'
 18090     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18091
 18092     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18093         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18094            MOVE '2'                TO CM-PREMIUM-TYPE.
 18095
 18096     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18097         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18098            MOVE '2'                TO CM-PREMIUM-TYPE.
 18099
 18100     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18101         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18102     ELSE
 18103         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18104         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18105
 18106     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18107     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18108     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18109     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18110     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18111     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18112     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18113     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18114
 18115     IF PB-NO-MONTHS-SKIPPED
 18116         MOVE SPACE                 TO CM-SKIP-CODE
 18117     ELSE
 18118         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18119
 18120     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18121     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18122                                       CM-LF-STATUS-AT-CANCEL.
 18123
 18124     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18125     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18126                                       CM-AH-STATUS-AT-CANCEL.
 18127
 18128     MOVE '1'                       TO CM-ENTRY-STATUS.
 18129
 18130     IF PB-REISSUED-CERT
 18131        MOVE '5'                    TO CM-ENTRY-STATUS.
 18132
 18133     IF PB-MONTHLY-CERT
 18134        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 329
* EL050.cbl
 18135
 18136     IF PB-CASH-CERT
 18137        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18138
 18139     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18140     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18141     IF PB-POLICY-IS-DECLINED
 18142        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18143
 18144     IF PB-POLICY-IS-VOIDED
 18145        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18146
 18147     IF PB-NEEDS-UNDERWRITING
 18148        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18149
 18150     IF PB-REIN-ONLY-CERT
 18151        MOVE '9'                    TO CM-ENTRY-STATUS.
 18152
 18153     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18154         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18155     ELSE
 18156         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18157
 18158     IF PB-RECORD-RETURNED
 18159        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18160      ELSE
 18161        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18162
 18163     IF PB-I-MAIL-ADDRS-PRESENT
 18164        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18165
 18166     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18167                                       CM-ENTRY-DT.
 18168
 18169 4999-EXIT.
 18170     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 330
* EL050.cbl
 18172
 18173 5000-PROCESS-REPS.
 18174     MOVE ' '                    TO AGTC-MASTER-SW
 18175     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18176     MOVE CO-TYPE                TO AGTC-TYPE
 18177     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18178     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18179     IF (AGTC-MASTER-SW NOT = 'N')
 18180        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18181        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18182        PERFORM 8583-READ-ERAGTC-NEXT
 18183                                 THRU 8583-EXIT
 18184     END-IF
 18185     IF AGTC-MASTER-SW = 'N'
 18186        CONTINUE
 18187     ELSE
 18188        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18189           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18190              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18191              MOVE 'Y'           TO AGTC-MASTER-SW
 18192           END-IF
 18193        END-IF
 18194     END-IF
 18195     .
 18196 5000-EXIT.
 18197     EXIT.
 18198 6370-EDIT-INPUT-LF-CODE.
 18199     move ' ' to ws-benefit-cd-chg-sw
 18200     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18201        MOVE +1                  TO SUB
 18202        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18203        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18204        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18205        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18206        GO TO 6370-SEARCH-LOOP.
 18207
 18208     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18209
 18210     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18211     MOVE SPACES                 TO CNTL-ACCESS.
 18212*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18213     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18214     MOVE +0                     TO CNTL-SEQ-NO.
 18215     MOVE '4' TO RC-SW-2.
 18216     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18217
 18218     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18219        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18220        GO TO 6370-NO-LF-FOUND.
 18221
 18222     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18223     MOVE +1                     TO SUB.
 18224
 18225 6370-SEARCH-LOOP.
 18226     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18227         GO TO 6370-NO-LF-FOUND.
 18228
 18229     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 331
* EL050.cbl
 18230        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18231           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18232           set benefit-code-chg to true
 18233        end-if
 18234        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18235        GO TO 6370-HER-NET-PAY-CHECK.
 18236
 18237     ADD 1   TO SUB.
 18238*    IF SUB GREATER 120
 18239     IF SUB GREATER 200
 18240         GO TO 6370-NO-LF-FOUND.
 18241
 18242     GO TO 6370-SEARCH-LOOP.
 18243
 18244 6370-NO-LF-FOUND.
 18245
 18246     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18247        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18248        set benefit-code-chg to true
 18249     end-if
 18250     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18251
 18252 6370-HER-NET-PAY-CHECK.
 18253
 18254     IF PB-COMPANY-ID = 'CID'
 18255        IF PB-SV-STATE = 'CA' OR 'MN'
 18256           IF PB-I-LF-BENEFIT-CD = '02'
 18257              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18258           ELSE
 18259              IF PB-I-LF-BENEFIT-CD = '04'
 18260                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18261              END-IF
 18262           END-IF
 18263        END-IF
 18264     END-IF
 18265
 18266     IF PB-COMPANY-ID NOT = 'HER'
 18267         GO TO 6370-EXIT.
 18268
 18269     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18270         GO TO 6370-EXIT.
 18271
 18272     IF PB-I-LF-TERM NOT NUMERIC
 18273         MOVE ZEROS              TO PB-I-LF-TERM.
 18274
 18275     IF PB-I-LOAN-TERM NOT NUMERIC
 18276         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18277
 18278     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18279         GO TO 6370-EXIT.
 18280
 18281     IF PB-I-LF-BENEFIT-CD = '33'
 18282         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18283
 18284     IF PB-I-LF-BENEFIT-CD = '34'
 18285         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18286
 18287 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 332
* EL050.cbl
 18288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 333
* EL050.cbl
 18290
 18291 6380-EDIT-INPUT-AH-CODE.
 18292     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18293        MOVE +1                  TO SUB
 18294        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18295        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18296        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18297        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18298        GO TO 6380-SEARCH-LOOP.
 18299
 18300     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18301
 18302     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18303     MOVE SPACES                 TO CNTL-ACCESS.
 18304     MOVE 'A'                    TO CNTL-REC-TYPE.
 18305*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18306     MOVE +0                     TO CNTL-SEQ-NO.
 18307     MOVE '5' TO RC-SW-2.
 18308     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18309
 18310     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18311        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18312        GO TO 6380-NO-AH-FOUND.
 18313
 18314     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18315     MOVE +1 TO SUB.
 18316
 18317 6380-SEARCH-LOOP.
 18318     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18319         GO TO 6380-NO-AH-FOUND.
 18320
 18321     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18322         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18323         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18324
 18325     ADD 1   TO SUB.
 18326     IF SUB GREATER THAN 96
 18327*    IF SUB GREATER THAN 300
 18328         GO TO 6380-NO-AH-FOUND.
 18329
 18330     GO TO 6380-SEARCH-LOOP.
 18331
 18332 6380-NO-AH-FOUND.
 18333
 18334     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18335
 18336     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18337         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18338     ELSE
 18339         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18340
 18341 6380-CSO-AH-ONLY-CHECKS.
 18342
 18343     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18344        NEXT SENTENCE
 18345      ELSE
 18346        GO TO 6380-EXIT.
 18347
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 334
* EL050.cbl
 18348     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18349         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18350
 18351
 18352     GO TO 6380-EXIT
 18353     .
 18354 6380-CSO-LIFE-WITH-AH-CHECKS.
 18355
 18356
 18357     .
 18358 6380-EXIT.
 18359     EXIT.
 18360
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 335
* EL050.cbl
 18362
 18363 6400-COMPUTE-EXTENSION-DAYS.
 18364
 18365******************************************************************
 18366*                                                                *
 18367*                   COMPUTE EXTENSION DAYS                       *
 18368*                                                                *
 18369*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18370*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18371*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18372*    THE EXTENSION DAYS.                                         *
 18373*                                                                *
 18374******************************************************************
 18375
 18376     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18377     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18378
 18379******************************************************************
 18380*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18381*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18382******************************************************************
 18383
 18384     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18385        COMPUTE WS-ODD-DAYS-OVER =
 18386               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18387     ELSE
 18388        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18389
 18390     IF WS-ODD-DAYS-OVER = ZEROS
 18391           GO TO 6499-EXIT
 18392     ELSE
 18393        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18394           IF WS-WDF-MONTH = 02
 18395              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18396              ADD 2       TO  WS-ODD-DAYS-OVER
 18397              GO TO 6499-EXIT
 18398           ELSE
 18399              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18400                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18401                 GO TO 6499-EXIT
 18402               ELSE
 18403                 GO TO 6499-EXIT
 18404        ELSE
 18405           GO TO 6499-EXIT.
 18406
 18407 6412-CHECK-TO-DAY.
 18408
 18409        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18410           IF WS-WDT-DAY = 28
 18411              ADD 2              TO WS-ODD-DAYS-OVER
 18412           ELSE
 18413              IF WS-WDT-DAY = 29
 18414                 ADD 1           TO WS-ODD-DAYS-OVER
 18415              ELSE
 18416                 NEXT SENTENCE
 18417        ELSE
 18418           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18419              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 336
* EL050.cbl
 18420
 18421     GO TO 6499-EXIT.
 18422
 18423
 18424 6415-CHECK-LEAP-YEAR.
 18425
 18426     IF DC-DAYS-IN-MONTH = 29
 18427        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18428
 18429 6415-EXIT.
 18430     EXIT.
 18431
 18432 6499-EXIT.
 18433      EXIT.
 18434
 18435 6500-END.
 18436     EXIT.
 18437
 18438
 18439******************************************************************
 18440************* PROCEDURE DIVISION FOR EL050 ***********************
 18441********************** ELC50PD END *******************************
 18442
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 337
* EL050.cbl
 18444
 18445**START***********************************************************
 18446*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18447*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18448******************************************************************
 18449*
 18450 6600-GET-STATE-MUNICIPAL-TAX.
 18451
 18452     IF PB-COMPANY-ID NOT = 'DMD'
 18453         GO TO 6640-EXIT.
 18454
 18455     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18456     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18457     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18458*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18459*
 18460***  Y2K PROJ 7744
 18461     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18462     SET BIN-TO-GREG          TO TRUE.
 18463     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18464
 18465     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18466
 18467     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18468     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18469
 18470
 18471* EXEC CICS HANDLE CONDITION
 18472*        INVREQ    (6610-START-BROWSE)
 18473*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18474*        NOTFND    (6630-END-OF-FILE)
 18475*    END-EXEC.
 18476*    MOVE '"$8JI                 ! # #00018458' TO DFHEIV0
 18477     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18479     MOVE X'2320233030303138343538' TO DFHEIV0(25:11)
 18480     CALL 'kxdfhei1' USING DFHEIV0
 18481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18482
 18483
 18484 6610-START-BROWSE.
 18485
 18486
 18487* EXEC CICS HANDLE CONDITION
 18488*        NOTFND    (6630-END-OF-FILE)
 18489*        DISABLED  (6630-ERRESS-PROBLEM)
 18490*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18491*        ENDFILE   (6630-END-OF-FILE)
 18492*    END-EXEC.
 18493*    MOVE '"$IcJ''                ! $ #00018466' TO DFHEIV0
 18494     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18496     MOVE X'2420233030303138343636' TO DFHEIV0(25:11)
 18497     CALL 'kxdfhei1' USING DFHEIV0
 18498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18499
 18500
 18501
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 338
* EL050.cbl
 18502* EXEC CICS STARTBR
 18503*        DATASET (FILE-ID-ERRESS)
 18504*        RIDFLD  (WS-ERRESS-KEY)
 18505*        GTEQ
 18506*    END-EXEC.
 18507     MOVE 0
 18508       TO DFHEIV11
 18509*    MOVE '&,         G          &   #00018473' TO DFHEIV0
 18510     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18512     MOVE X'2020233030303138343733' TO DFHEIV0(25:11)
 18513     CALL 'kxdfhei1' USING DFHEIV0,
 18514           FILE-ID-ERRESS,
 18515           WS-ERRESS-KEY,
 18516           DFHEIV99,
 18517           DFHEIV11,
 18518           DFHEIV99
 18519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18520
 18521
 18522 6620-READ-NEXT-ERRESS-MASTER.
 18523
 18524
 18525* EXEC CICS HANDLE CONDITION
 18526*        NOTFND    (6630-END-OF-FILE)
 18527*        ENDFILE   (6630-END-OF-FILE)
 18528*        DISABLED  (6630-ERRESS-PROBLEM)
 18529*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18530*    END-EXEC.
 18531*    MOVE '"$I''cJ                ! % #00018481' TO DFHEIV0
 18532     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18534     MOVE X'2520233030303138343831' TO DFHEIV0(25:11)
 18535     CALL 'kxdfhei1' USING DFHEIV0
 18536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18537
 18538
 18539
 18540* EXEC CICS READNEXT
 18541*        DATASET (FILE-ID-ERRESS)
 18542*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18543*        RIDFLD  (WS-ERRESS-KEY)
 18544*    END-EXEC.
 18545     MOVE LENGTH OF
 18546      RESIDENT-STATE-TAX-MASTER
 18547       TO DFHEIV12
 18548     MOVE 0
 18549       TO DFHEIV11
 18550*    MOVE '&.IL                  )   #00018488' TO DFHEIV0
 18551     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18552     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18553     MOVE X'2020233030303138343838' TO DFHEIV0(25:11)
 18554     CALL 'kxdfhei1' USING DFHEIV0,
 18555           FILE-ID-ERRESS,
 18556           RESIDENT-STATE-TAX-MASTER,
 18557           DFHEIV12,
 18558           WS-ERRESS-KEY,
 18559           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 339
* EL050.cbl
 18560           DFHEIV11,
 18561           DFHEIV99,
 18562           DFHEIV99
 18563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18564
 18565
 18566     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18567
 18568* EXEC CICS ENDBR
 18569*            DATASET (FILE-ID-ERRESS)
 18570*       END-EXEC
 18571     MOVE 0
 18572       TO DFHEIV11
 18573*    MOVE '&2                    $   #00018495' TO DFHEIV0
 18574     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18575     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18576     MOVE X'2020233030303138343935' TO DFHEIV0(25:11)
 18577     CALL 'kxdfhei1' USING DFHEIV0,
 18578           FILE-ID-ERRESS,
 18579           DFHEIV11,
 18580           DFHEIV99
 18581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18582        GO TO 6630-END-OF-FILE.
 18583
 18584     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18585        NEXT SENTENCE
 18586      ELSE
 18587        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18588
 18589*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18590*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18591*
 18592     MOVE +2                     TO WS-SUB1.
 18593
 18594     IF PB-ISSUE
 18595     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18596        MOVE +1                  TO WS-SUB1.
 18597
 18598     IF PB-CANCELLATION
 18599     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18600        MOVE +1                  TO WS-SUB1.
 18601*
 18602*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18603*
 18604***  Y2K PROJ 7744
 18605     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18606***  Y2K PROJ 7744
 18607
 18608*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18609* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18610* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18611
 18612     ADD 1                    TO WS-YEAR-YY.
 18613
 18614     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18615         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18616                              TO WS-RES-STATE-TAX
 18617         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 340
* EL050.cbl
 18618                              TO WS-RES-MUNI-TAX
 18619     ELSE
 18620         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18621                              TO WS-RES-STATE-TAX
 18622         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18623                              TO WS-RES-MUNI-TAX.
 18624
 18625*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18626
 18627     IF PB-CANCELLATION
 18628         GO TO 6640-CANCEL-TAX.
 18629
 18630     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18631         COMPUTE PB-I-STATE-TAX ROUNDED =
 18632                                   PB-I-LF-PREMIUM-AMT
 18633                                 * WS-RES-STATE-TAX
 18634         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18635                                   PB-I-LF-PREMIUM-AMT
 18636                                 * WS-RES-MUNI-TAX
 18637     ELSE
 18638     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18639         COMPUTE PB-I-STATE-TAX ROUNDED =
 18640                                   PB-I-AH-PREMIUM-AMT
 18641                                 * WS-RES-STATE-TAX
 18642         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18643                                   PB-I-AH-PREMIUM-AMT
 18644                                 * WS-RES-MUNI-TAX.
 18645
 18646
 18647* EXEC CICS ENDBR
 18648*         DATASET (FILE-ID-ERRESS)
 18649*    END-EXEC.
 18650     MOVE 0
 18651       TO DFHEIV11
 18652*    MOVE '&2                    $   #00018562' TO DFHEIV0
 18653     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18654     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18655     MOVE X'2020233030303138353632' TO DFHEIV0(25:11)
 18656     CALL 'kxdfhei1' USING DFHEIV0,
 18657           FILE-ID-ERRESS,
 18658           DFHEIV11,
 18659           DFHEIV99
 18660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18661
 18662
 18663     GO TO 6640-EXIT.
 18664
 18665 6640-CANCEL-TAX.
 18666     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18667
 18668     IF PB-C-LF-CANCEL-AMT > ZEROS
 18669         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18670                                   PB-C-LF-CANCEL-AMT
 18671                                 * WS-RES-STATE-TAX
 18672         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18673                                   PB-C-LF-CANCEL-AMT
 18674                                *  WS-RES-MUNI-TAX
 18675     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 341
* EL050.cbl
 18676     IF PB-C-AH-CANCEL-AMT > ZEROS
 18677         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18678                                   PB-C-AH-CANCEL-AMT
 18679                                 * WS-RES-STATE-TAX
 18680         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18681                                   PB-C-AH-CANCEL-AMT
 18682                                *  WS-RES-MUNI-TAX.
 18683
 18684
 18685* EXEC CICS ENDBR
 18686*         DATASET (FILE-ID-ERRESS)
 18687*    END-EXEC.
 18688     MOVE 0
 18689       TO DFHEIV11
 18690*    MOVE '&2                    $   #00018587' TO DFHEIV0
 18691     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18692     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18693     MOVE X'2020233030303138353837' TO DFHEIV0(25:11)
 18694     CALL 'kxdfhei1' USING DFHEIV0,
 18695           FILE-ID-ERRESS,
 18696           DFHEIV11,
 18697           DFHEIV99
 18698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18699
 18700
 18701     GO TO 6640-EXIT.
 18702
 18703 6630-END-OF-FILE.
 18704     MOVE ER-8002              TO WS-ERROR.
 18705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18706
 18707     GO TO 6640-EXIT.
 18708
 18709 6630-ERRESS-PROBLEM.
 18710     MOVE ER-8044              TO WS-ERROR.
 18711     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18712
 18713 6640-EXIT.
 18714     EXIT.
 18715
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 342
* EL050.cbl
 18717 6650-GET-RES-STATE-COMM.
 18718
 18719     IF PB-COMPANY-ID NOT = 'DMD'
 18720         GO TO 6700-COMM-EXIT.
 18721
 18722     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18723     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18724     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18725     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18726     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18727     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18728     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18729
 18730*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18731*
 18732***  Y2K PROJ 7744
 18733     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18734     SET BIN-TO-GREG          TO TRUE.
 18735     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18736
 18737     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18738***  Y2K PROJ 7744
 18739
 18740     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18741
 18742
 18743* EXEC CICS HANDLE CONDITION
 18744*        INVREQ    (6660-START-BROWSE)
 18745*        DISABLED  (6690-ERRESC-PROBLEM)
 18746*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18747*        NOTFND    (6690-END-OF-FILE)
 18748*    END-EXEC.
 18749*    MOVE '"$8cJI                ! & #00018632' TO DFHEIV0
 18750     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18752     MOVE X'2620233030303138363332' TO DFHEIV0(25:11)
 18753     CALL 'kxdfhei1' USING DFHEIV0
 18754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18755
 18756
 18757
 18758* EXEC CICS RESETBR
 18759*        DATASET (FILE-ID-ERRESC)
 18760*        RIDFLD  (WS-ERRESC-KEY)
 18761*    END-EXEC.
 18762     MOVE 0
 18763       TO DFHEIV11
 18764*    MOVE '&4         G          &   #00018639' TO DFHEIV0
 18765     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18766     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18767     MOVE X'2020233030303138363339' TO DFHEIV0(25:11)
 18768     CALL 'kxdfhei1' USING DFHEIV0,
 18769           FILE-ID-ERRESC,
 18770           WS-ERRESC-KEY,
 18771           DFHEIV99,
 18772           DFHEIV11,
 18773           DFHEIV99
 18774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 343
* EL050.cbl
 18775
 18776
 18777 6660-START-BROWSE.
 18778
 18779
 18780* EXEC CICS HANDLE CONDITION
 18781*        NOTFND    (6690-END-OF-FILE)
 18782*        DISABLED  (6690-ERRESC-PROBLEM)
 18783*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18784*        ENDFILE   (6690-END-OF-FILE)
 18785*    END-EXEC.
 18786*    MOVE '"$IcJ''                ! '' #00018646' TO DFHEIV0
 18787     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18789     MOVE X'2720233030303138363436' TO DFHEIV0(25:11)
 18790     CALL 'kxdfhei1' USING DFHEIV0
 18791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18792
 18793
 18794
 18795* EXEC CICS STARTBR
 18796*        DATASET (FILE-ID-ERRESC)
 18797*        RIDFLD  (WS-ERRESC-KEY)
 18798*        GTEQ
 18799*    END-EXEC.
 18800     MOVE 0
 18801       TO DFHEIV11
 18802*    MOVE '&,         G          &   #00018653' TO DFHEIV0
 18803     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18804     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18805     MOVE X'2020233030303138363533' TO DFHEIV0(25:11)
 18806     CALL 'kxdfhei1' USING DFHEIV0,
 18807           FILE-ID-ERRESC,
 18808           WS-ERRESC-KEY,
 18809           DFHEIV99,
 18810           DFHEIV11,
 18811           DFHEIV99
 18812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18813
 18814
 18815     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18816
 18817 6670-READ-NEXT-ERRESC-MASTER.
 18818
 18819
 18820* EXEC CICS HANDLE CONDITION
 18821*        NOTFND    (6690-END-OF-FILE)
 18822*        DISABLED  (6690-ERRESC-PROBLEM)
 18823*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18824*        ENDFILE   (6690-END-OF-FILE)
 18825*    END-EXEC.
 18826*    MOVE '"$IcJ''                ! ( #00018663' TO DFHEIV0
 18827     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18829     MOVE X'2820233030303138363633' TO DFHEIV0(25:11)
 18830     CALL 'kxdfhei1' USING DFHEIV0
 18831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18832
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 344
* EL050.cbl
 18833
 18834
 18835* EXEC CICS READNEXT
 18836*        DATASET (FILE-ID-ERRESC)
 18837*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18838*        RIDFLD  (ERRESC-RECORD-KEY)
 18839*    END-EXEC.
 18840     MOVE LENGTH OF
 18841      ACCOUNT-RESIDENT-ST-COMMISSION
 18842       TO DFHEIV12
 18843     MOVE 0
 18844       TO DFHEIV11
 18845*    MOVE '&.IL                  )   #00018670' TO DFHEIV0
 18846     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18847     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18848     MOVE X'2020233030303138363730' TO DFHEIV0(25:11)
 18849     CALL 'kxdfhei1' USING DFHEIV0,
 18850           FILE-ID-ERRESC,
 18851           ACCOUNT-RESIDENT-ST-COMMISSION,
 18852           DFHEIV12,
 18853           ERRESC-RECORD-KEY,
 18854           DFHEIV99,
 18855           DFHEIV11,
 18856           DFHEIV99,
 18857           DFHEIV99
 18858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18859
 18860
 18861     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18862        NEXT SENTENCE
 18863     ELSE
 18864
 18865* EXEC CICS ENDBR
 18866*            DATASET (FILE-ID-ERRESC)
 18867*       END-EXEC
 18868     MOVE 0
 18869       TO DFHEIV11
 18870*    MOVE '&2                    $   #00018679' TO DFHEIV0
 18871     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18872     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18873     MOVE X'2020233030303138363739' TO DFHEIV0(25:11)
 18874     CALL 'kxdfhei1' USING DFHEIV0,
 18875           FILE-ID-ERRESC,
 18876           DFHEIV11,
 18877           DFHEIV99
 18878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18879        GO TO 6690-END-OF-FILE.
 18880
 18881     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18882
 18883* EXEC CICS ENDBR
 18884*            DATASET (FILE-ID-ERRESC)
 18885*       END-EXEC
 18886     MOVE 0
 18887       TO DFHEIV11
 18888*    MOVE '&2                    $   #00018685' TO DFHEIV0
 18889     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18890     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 345
* EL050.cbl
 18891     MOVE X'2020233030303138363835' TO DFHEIV0(25:11)
 18892     CALL 'kxdfhei1' USING DFHEIV0,
 18893           FILE-ID-ERRESC,
 18894           DFHEIV11,
 18895           DFHEIV99
 18896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18897        GO TO 6690-END-OF-FILE.
 18898
 18899     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18900        NEXT SENTENCE
 18901      ELSE
 18902        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18903
 18904* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18905*
 18906     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18907
 18908     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18909
 18910     IF WS-SUB1 > ZERO
 18911         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18912             PERFORM 6680-SET-COMMISSION
 18913         ELSE
 18914             PERFORM 6680-SET-TABLE-CODE.
 18915
 18916
 18917* EXEC CICS ENDBR
 18918*         DATASET (FILE-ID-ERRESC)
 18919*    END-EXEC.
 18920     MOVE 0
 18921       TO DFHEIV11
 18922*    MOVE '&2                    $   #00018707' TO DFHEIV0
 18923     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18924     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18925     MOVE X'2020233030303138373037' TO DFHEIV0(25:11)
 18926     CALL 'kxdfhei1' USING DFHEIV0,
 18927           FILE-ID-ERRESC,
 18928           DFHEIV11,
 18929           DFHEIV99
 18930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18931
 18932
 18933     GO TO 6700-COMM-EXIT.
 18934
 18935 6680-SET-TABLE-CODE.
 18936     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18937        MOVE ZEROS             TO WS-SUB1
 18938     ELSE
 18939* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18940* TO COMPUTE AH COMMISSION.
 18941        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18942        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18943        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18944        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18945        PERFORM 6680-READ-CTBL-TABLE
 18946        IF WS-CTBL-READ-SW NOT = 'Y'
 18947           MOVE ZEROS          TO WS-SUB1.
 18948
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 346
* EL050.cbl
 18949 6680-READ-CTBL-TABLE.
 18950*
 18951* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18952* TO COMPUTE LIFE COMMISSION
 18953
 18954     IF CTBL-SW = '0540'
 18955        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18956        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18957        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18958
 18959     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18960
 18961     IF CTBL-TABLE-FOUND
 18962        IF CTBL-SW = '0530'
 18963             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18964                                    * PB-I-AH-TERM
 18965             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18966             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18967        ELSE
 18968             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18969             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18970             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18971     ELSE
 18972        IF FIRST-TIME-THROUGH
 18973            GO TO 6680-READ-CTBL-TABLE
 18974        ELSE
 18975            MOVE ZEROS         TO WS-SUB1.
 18976
 18977 6680-SET-COMMISSION.
 18978     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18979           MOVE ZEROS          TO WS-SUB1
 18980       ELSE
 18981           MOVE RESC-COMMISSION-PER (WS-SUB)
 18982                               TO WS-COMMISSION
 18983           IF CTBL-SW = '0530'
 18984               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18985           ELSE
 18986               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18987
 18988 6680-SEARCH-CATEGORY.
 18989     ADD +1                   TO WS-SUB.
 18990     IF WS-SUB > +12
 18991         GO TO 6680-EXIT.
 18992
 18993     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18994          MOVE WS-SUB         TO WS-SUB1
 18995          GO TO 6680-EXIT.
 18996
 18997     GO TO 6680-SEARCH-CATEGORY.
 18998
 18999 6680-EXIT.
 19000     EXIT.
 19001
 19002 6690-END-OF-FILE.
 19003     GO TO 6700-COMM-EXIT.
 19004
 19005 6690-ERRESC-PROBLEM.
 19006      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 347
* EL050.cbl
 19007      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19008
 19009      GO TO 6700-COMM-EXIT.
 19010
 19011 6700-COMM-EXIT.
 19012     EXIT.
 19013
 19014 7000-GET-RATE.
 19015
 19016* EXEC CICS LINK
 19017*        PROGRAM    ('ELRATE')
 19018*        COMMAREA   (CALCULATION-PASS-AREA)
 19019*        LENGTH     (CP-COMM-LENGTH)
 19020*    END-EXEC.
 19021     MOVE 'ELRATE' TO DFHEIV1
 19022*    MOVE '."C                   (   #00018793' TO DFHEIV0
 19023     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19024     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19025     MOVE X'2020233030303138373933' TO DFHEIV0(25:11)
 19026     CALL 'kxdfhei1' USING DFHEIV0,
 19027           DFHEIV1,
 19028           CALCULATION-PASS-AREA,
 19029           CP-COMM-LENGTH,
 19030           DFHEIV99,
 19031           DFHEIV99,
 19032           DFHEIV99,
 19033           DFHEIV99
 19034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19035
 19036
 19037 7000-EXIT.
 19038     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 348
* EL050.cbl
 19040 7100-FIND-BENEFIT-IN-STATE.
 19041     MOVE 'N'                    TO BEN-SEARCH-SW.
 19042
 19043     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19044         VARYING SUB3 FROM 1 BY 1 UNTIL
 19045            ((SUB3 GREATER 50) OR
 19046              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19047               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19048
 19049     IF SUB3 NOT = 51
 19050         MOVE 'Y'                TO BEN-SEARCH-SW.
 19051
 19052     GO TO 7199-EXIT.
 19053
 19054 7100-BENEFIT-DUMMY.
 19055
 19056 7100-DUMMY-EXIT.
 19057     EXIT.
 19058
 19059 7199-EXIT.
 19060     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 349
* EL050.cbl
 19062 7200-FIND-BENEFIT.
 19063     MOVE 'N'                    TO BEN-SEARCH-SW.
 19064
 19065     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19066         VARYING SUB3 FROM 1 BY 1 UNTIL
 19067            ((SUB3 GREATER 8) OR
 19068            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19069
 19070     IF SUB3 NOT = 9
 19071         MOVE 'Y'                TO BEN-SEARCH-SW.
 19072
 19073     GO TO 7200-EXIT.
 19074
 19075 7200-BENEFIT-DUMMY.
 19076
 19077 7200-DUMMY-EXIT.
 19078     EXIT.
 19079
 19080 7200-EXIT.
 19081     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 350
* EL050.cbl
 19083 7250-LOOK-FOR-RESCINDED-CLAIM.
 19084     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19085                                    W-CL-COMP-CD.
 19086     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19087                                    W-CL-CERT-NO.
 19088
 19089
 19090* EXEC CICS HANDLE CONDITION
 19091*        NOTFND  (7250-CONTINUE)
 19092*        ENDFILE (7250-CONTINUE)
 19093*    END-EXEC.
 19094*    MOVE '"$I''                  ! ) #00018851' TO DFHEIV0
 19095     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19097     MOVE X'2920233030303138383531' TO DFHEIV0(25:11)
 19098     CALL 'kxdfhei1' USING DFHEIV0
 19099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19100
 19101
 19102
 19103* EXEC CICS IGNORE CONDITION
 19104*        DUPKEY
 19105*    END-EXEC.
 19106*    MOVE '"*$                   !   #00018856' TO DFHEIV0
 19107     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19109     MOVE X'2020233030303138383536' TO DFHEIV0(25:11)
 19110     CALL 'kxdfhei1' USING DFHEIV0
 19111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19112
 19113
 19114
 19115* EXEC CICS STARTBR
 19116*        DATASET   (CLMS-ID)
 19117*        RIDFLD    (ELMSTR-KEY)
 19118*        GENERIC   EQUAL
 19119*        KEYLENGTH (ELMSTR-LENGTH)
 19120*    END-EXEC.
 19121     MOVE 0
 19122       TO DFHEIV11
 19123*    MOVE '&,   KG    E          &   #00018860' TO DFHEIV0
 19124     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19125     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19126     MOVE X'2020233030303138383630' TO DFHEIV0(25:11)
 19127     CALL 'kxdfhei1' USING DFHEIV0,
 19128           CLMS-ID,
 19129           ELMSTR-KEY,
 19130           ELMSTR-LENGTH,
 19131           DFHEIV11,
 19132           DFHEIV99
 19133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19134
 19135
 19136     MOVE 'Y'                    TO W-BROWSE-SW.
 19137
 19138 7250-NEXT-CLAIM.
 19139
 19140
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 351
* EL050.cbl
 19141* EXEC CICS READNEXT
 19142*        DATASET   (CLMS-ID)
 19143*        RIDFLD    (ELMSTR-KEY)
 19144*        SET       (ADDRESS OF CLAIM-MASTER)
 19145*    END-EXEC.
 19146     MOVE 0
 19147       TO DFHEIV11
 19148*    MOVE '&.S                   )   #00018871' TO DFHEIV0
 19149     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19150     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19151     MOVE X'2020233030303138383731' TO DFHEIV0(25:11)
 19152     CALL 'kxdfhei1' USING DFHEIV0,
 19153           CLMS-ID,
 19154           DFHEIV20,
 19155           DFHEIV99,
 19156           ELMSTR-KEY,
 19157           DFHEIV99,
 19158           DFHEIV11,
 19159           DFHEIV99,
 19160           DFHEIV99
 19161     SET ADDRESS OF CLAIM-MASTER TO
 19162         DFHEIV20
 19163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19164
 19165
 19166     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19167        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19168         GO TO 7250-CONTINUE
 19169     END-IF.
 19170
 19171     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19172        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19173        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19174        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19175        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19176         GO TO 7250-NEXT-CLAIM
 19177     END-IF.
 19178
 19179     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19180        OR (CL-CLAIM-TYPE = 'I')
 19181        OR (CL-CLAIM-TYPE = 'G')
 19182        OR (CL-CLAIM-TYPE = 'F')
 19183          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19184              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19185              GO TO 7250-CONTINUE
 19186          END-IF
 19187     END-IF.
 19188
 19189     GO TO 7250-NEXT-CLAIM.
 19190
 19191 7250-CONTINUE.
 19192
 19193     IF W-BROWSE-SW = 'Y'
 19194
 19195* EXEC CICS ENDBR
 19196*            DATASET   (CLMS-ID)
 19197*        END-EXEC
 19198     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 352
* EL050.cbl
 19199       TO DFHEIV11
 19200*    MOVE '&2                    $   #00018905' TO DFHEIV0
 19201     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19202     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19203     MOVE X'2020233030303138393035' TO DFHEIV0(25:11)
 19204     CALL 'kxdfhei1' USING DFHEIV0,
 19205           CLMS-ID,
 19206           DFHEIV11,
 19207           DFHEIV99
 19208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19209         MOVE 'N' TO W-BROWSE-SW
 19210     END-IF.
 19211
 19212 7250-EXIT.
 19213     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 353
* EL050.cbl
 19215 7300-CHECK-FOR-OPEN-CLMS.
 19216
 19217*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19218*    MOVE SPACES                 TO CNTL-ACCESS.
 19219*    MOVE '1'                    TO CNTL-REC-TYPE.
 19220*    MOVE +0                     TO CNTL-SEQ-NO.
 19221
 19222*    MOVE '3'                    TO RC-SW-1.
 19223*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19224
 19225*    IF NOT CF-COMPANY-MASTER
 19226*         PERFORM 0099-COMPANY-NOT-FOUND
 19227*         GO TO 7300-EXIT.
 19228
 19229     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19230                                    W-CL-COMP-CD.
 19231     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19232                                    W-CL-CERT-NO.
 19233
 19234
 19235* EXEC CICS HANDLE CONDITION
 19236*        NOTFND  (7300-CONTINUE)
 19237*        ENDFILE (7300-CONTINUE)
 19238*    END-EXEC.
 19239*    MOVE '"$I''                  ! * #00018933' TO DFHEIV0
 19240     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19242     MOVE X'2A20233030303138393333' TO DFHEIV0(25:11)
 19243     CALL 'kxdfhei1' USING DFHEIV0
 19244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19245
 19246
 19247
 19248* EXEC CICS IGNORE CONDITION
 19249*        DUPKEY
 19250*    END-EXEC.
 19251*    MOVE '"*$                   !   #00018938' TO DFHEIV0
 19252     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19254     MOVE X'2020233030303138393338' TO DFHEIV0(25:11)
 19255     CALL 'kxdfhei1' USING DFHEIV0
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19257
 19258
 19259
 19260* EXEC CICS STARTBR
 19261*        DATASET   (CLMS-ID)
 19262*        RIDFLD    (ELMSTR-KEY)
 19263*        GENERIC   EQUAL
 19264*        KEYLENGTH (ELMSTR-LENGTH)
 19265*    END-EXEC.
 19266     MOVE 0
 19267       TO DFHEIV11
 19268*    MOVE '&,   KG    E          &   #00018942' TO DFHEIV0
 19269     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19271     MOVE X'2020233030303138393432' TO DFHEIV0(25:11)
 19272     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 354
* EL050.cbl
 19273           CLMS-ID,
 19274           ELMSTR-KEY,
 19275           ELMSTR-LENGTH,
 19276           DFHEIV11,
 19277           DFHEIV99
 19278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19279
 19280
 19281     MOVE 'Y'                    TO W-BROWSE-SW.
 19282
 19283 7300-NEXT-CLAIM.
 19284
 19285
 19286* EXEC CICS READNEXT
 19287*        DATASET   (CLMS-ID)
 19288*        RIDFLD    (ELMSTR-KEY)
 19289*        SET       (ADDRESS OF CLAIM-MASTER)
 19290*    END-EXEC.
 19291     MOVE 0
 19292       TO DFHEIV11
 19293*    MOVE '&.S                   )   #00018953' TO DFHEIV0
 19294     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19295     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19296     MOVE X'2020233030303138393533' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0,
 19298           CLMS-ID,
 19299           DFHEIV20,
 19300           DFHEIV99,
 19301           ELMSTR-KEY,
 19302           DFHEIV99,
 19303           DFHEIV11,
 19304           DFHEIV99,
 19305           DFHEIV99
 19306     SET ADDRESS OF CLAIM-MASTER TO
 19307         DFHEIV20
 19308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19309
 19310
 19311     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19312        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19313         GO TO 7300-CONTINUE.
 19314
 19315     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19316        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19317        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19318        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19319        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19320         GO TO 7300-NEXT-CLAIM.
 19321
 19322*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19323     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19324        OR (CL-CLAIM-TYPE = 'I')
 19325        OR (CL-CLAIM-TYPE = 'G')
 19326        OR (CL-CLAIM-TYPE = 'F')
 19327        IF CLAIM-IS-OPEN
 19328           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19329             AND PB-C-AH-CANCEL-DT > SPACES
 19330              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 355
* EL050.cbl
 19331              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19332           END-IF
 19333           EVALUATE TRUE
 19334             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19335                 MOVE ER-2884      TO WS-ERROR
 19336             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19337                 MOVE ER-2887      TO WS-ERROR
 19338             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19339                 MOVE ER-2886      TO WS-ERROR
 19340             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19341                 MOVE ER-2888      TO WS-ERROR
 19342             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19343                 MOVE ER-2885      TO WS-ERROR
 19344             WHEN OTHER
 19345                 MOVE ER-2768      TO WS-ERROR
 19346           END-EVALUATE
 19347           IF PB-C-AH-CANCEL-VOIDED OR
 19348              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19349                NOT AH-COVERAGE-CANCELLED)
 19350               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19351               MOVE ER-2768      TO WS-ERROR
 19352           END-IF
 19353           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19354           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19355              PB-FORCE-CODE NOT EQUAL '8'
 19356               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19357           END-IF
 19358           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19359           GO TO 7300-NEXT-CLAIM
 19360        ELSE
 19361           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19362*****THIS IS A RESCISSION OR REFORMATION
 19363              IF AH-COVERAGE-CANCELLED
 19364                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19365                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19366                    MOVE 1                   TO DC-ELAPSED-DAYS
 19367                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19368                    SET BIN-PLUS-ELAPSED     TO TRUE
 19369                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19370                    IF NO-CONVERSION-ERROR
 19371                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19372                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19373                          MOVE ER-2897 TO WS-ERROR
 19374                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19375                          GO TO 7300-NEXT-CLAIM
 19376                       END-IF
 19377                    END-IF
 19378                 ELSE
 19379                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19380                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19381                         MOVE ER-2890 TO WS-ERROR
 19382                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19383                         GO TO 7300-NEXT-CLAIM
 19384                      ELSE
 19385                         MOVE ER-2898 TO WS-ERROR
 19386                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19387                         GO TO 7300-NEXT-CLAIM
 19388                      END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 356
* EL050.cbl
 19389                   END-IF
 19390                 END-IF
 19391              END-IF
 19392           ELSE
 19393              IF CL-DENIAL-TYPE = '1'  AND
 19394                 CL-TOTAL-PAID-AMT = 0
 19395                    GO TO 7300-NEXT-CLAIM
 19396              END-IF
 19397              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19398               AND PB-C-AH-CANCEL-DT > SPACES
 19399                 MOVE ER-2756        TO WS-ERROR
 19400                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19401                 GO TO 7300-NEXT-CLAIM
 19402              END-IF
 19403           END-IF
 19404        END-IF
 19405     ELSE
 19406*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19407        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19408           IF (CLAIM-IS-OPEN)
 19409              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19410                 <> zeros
 19411              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19412                 <> zeros)
 19413              MOVE ER-2889      TO WS-ERROR
 19414              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19415              GO TO 7300-NEXT-CLAIM
 19416           ELSE
 19417              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19418*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19419                 IF (LF-COVERAGE-CANCELLED AND
 19420                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19421                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19422                         MOVE ER-2890 TO WS-ERROR
 19423                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19424                         GO TO 7300-NEXT-CLAIM
 19425                      ELSE
 19426                         MOVE ER-2898 TO WS-ERROR
 19427                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19428                         GO TO 7300-NEXT-CLAIM
 19429                      END-IF
 19430                 END-IF
 19431              ELSE
 19432                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19433                    and (CL-TOTAL-PAID-AMT = 0)
 19434                    GO TO 7300-NEXT-CLAIM
 19435                 END-IF
 19436                 IF (
 19437                      (AH-COVERAGE-CANCELLED)
 19438                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19439                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19440                      and (pb-ci-ah-cancel-amt +
 19441                         pb-c-ah-cancel-amt) <> zeros
 19442                    )
 19443                               OR
 19444                    (
 19445                      (LF-COVERAGE-CANCELLED)
 19446                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 357
* EL050.cbl
 19447                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19448                      and (pb-ci-lf-cancel-amt +
 19449                         pb-c-lf-cancel-amt) <> zeros
 19450                    )
 19451                       MOVE ER-2965 TO WS-ERROR
 19452                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19453                       GO TO 7300-NEXT-CLAIM
 19454                 END-IF
 19455                 IF LF-COVERAGE-CANCELLED
 19456                  IF CL-TOTAL-PAID-AMT > 0
 19457                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19458                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19459                        MOVE ER-2891 TO WS-ERROR
 19460                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19461                        GO TO 7300-NEXT-CLAIM
 19462                      END-IF
 19463                    ELSE
 19464****only show this error if cert num matches exactly
 19465                      IF PB-CERT-NO = CL-CERT-NO
 19466                         MOVE ER-2892 TO WS-ERROR
 19467                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19468                         GO TO 7300-NEXT-CLAIM
 19469                      END-IF
 19470                    END-IF
 19471                  END-IF
 19472                 END-IF
 19473              END-IF
 19474           END-IF
 19475        END-IF
 19476     END-IF
 19477
 19478     GO TO 7300-NEXT-CLAIM.
 19479
 19480 7300-CONTINUE.
 19481
 19482     IF W-BROWSE-SW = 'Y'
 19483
 19484* EXEC CICS ENDBR
 19485*            DATASET   (CLMS-ID)
 19486*        END-EXEC.
 19487     MOVE 0
 19488       TO DFHEIV11
 19489*    MOVE '&2                    $   #00019131' TO DFHEIV0
 19490     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19491     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19492     MOVE X'2020233030303139313331' TO DFHEIV0(25:11)
 19493     CALL 'kxdfhei1' USING DFHEIV0,
 19494           CLMS-ID,
 19495           DFHEIV11,
 19496           DFHEIV99
 19497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19498
 19499
 19500 7300-EXIT.
 19501     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 358
* EL050.cbl
 19503
 19504 7400-GET-REMAIN-TERM.
 19505
 19506* EXEC CICS LINK
 19507*        PROGRAM    ('ELRTRM')
 19508*        COMMAREA   (CALCULATION-PASS-AREA)
 19509*        LENGTH     (CP-COMM-LENGTH)
 19510*    END-EXEC.
 19511     MOVE 'ELRTRM' TO DFHEIV1
 19512*    MOVE '."C                   (   #00019140' TO DFHEIV0
 19513     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19514     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19515     MOVE X'2020233030303139313430' TO DFHEIV0(25:11)
 19516     CALL 'kxdfhei1' USING DFHEIV0,
 19517           DFHEIV1,
 19518           CALCULATION-PASS-AREA,
 19519           CP-COMM-LENGTH,
 19520           DFHEIV99,
 19521           DFHEIV99,
 19522           DFHEIV99,
 19523           DFHEIV99
 19524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19525
 19526
 19527 7400-EXIT.
 19528     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 359
* EL050.cbl
 19530
 19531 7500-GET-REMAIN-AMOUNT.
 19532
 19533* EXEC CICS LINK
 19534*        PROGRAM    ('ELRAMT')
 19535*        COMMAREA   (CALCULATION-PASS-AREA)
 19536*        LENGTH     (CP-COMM-LENGTH)
 19537*    END-EXEC.
 19538     MOVE 'ELRAMT' TO DFHEIV1
 19539*    MOVE '."C                   (   #00019151' TO DFHEIV0
 19540     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19542     MOVE X'2020233030303139313531' TO DFHEIV0(25:11)
 19543     CALL 'kxdfhei1' USING DFHEIV0,
 19544           DFHEIV1,
 19545           CALCULATION-PASS-AREA,
 19546           CP-COMM-LENGTH,
 19547           DFHEIV99,
 19548           DFHEIV99,
 19549           DFHEIV99,
 19550           DFHEIV99
 19551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19552
 19553
 19554 7500-EXIT.
 19555     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 360
* EL050.cbl
 19557
 19558 7600-GET-REFUND.
 19559
 19560* EXEC CICS LINK
 19561*        PROGRAM    ('ELRFND')
 19562*        COMMAREA   (CALCULATION-PASS-AREA)
 19563*        LENGTH     (CP-COMM-LENGTH)
 19564*    END-EXEC.
 19565     MOVE 'ELRFND' TO DFHEIV1
 19566*    MOVE '."C                   (   #00019162' TO DFHEIV0
 19567     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19568     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19569     MOVE X'2020233030303139313632' TO DFHEIV0(25:11)
 19570     CALL 'kxdfhei1' USING DFHEIV0,
 19571           DFHEIV1,
 19572           CALCULATION-PASS-AREA,
 19573           CP-COMM-LENGTH,
 19574           DFHEIV99,
 19575           DFHEIV99,
 19576           DFHEIV99,
 19577           DFHEIV99
 19578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19579
 19580
 19581 7600-EXIT.
 19582     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 361
* EL050.cbl
 19584 7700-CALL-DL1.
 19585
 19586* EXEC CICS LINK
 19587*        PROGRAM    ('DLO001')
 19588*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19589*        LENGTH     (DLO001-COMM-LENGTH)
 19590*    END-EXEC.
 19591     MOVE 'DLO001' TO DFHEIV1
 19592*    MOVE '."C                   (   #00019172' TO DFHEIV0
 19593     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19594     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19595     MOVE X'2020233030303139313732' TO DFHEIV0(25:11)
 19596     CALL 'kxdfhei1' USING DFHEIV0,
 19597           DFHEIV1,
 19598           WS-DLO-MASTER-POLICY-FORM,
 19599           DLO001-COMM-LENGTH,
 19600           DFHEIV99,
 19601           DFHEIV99,
 19602           DFHEIV99,
 19603           DFHEIV99
 19604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19605
 19606
 19607 7700-EXIT.
 19608     EXIT.
 19609
 19610 7710-CALL-DL2.
 19611
 19612* EXEC CICS LINK
 19613*        PROGRAM    ('DLO002')
 19614*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19615*        LENGTH     (DLO002-COMM-LENGTH)
 19616*    END-EXEC.
 19617     MOVE 'DLO002' TO DFHEIV1
 19618*    MOVE '."C                   (   #00019182' TO DFHEIV0
 19619     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19620     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19621     MOVE X'2020233030303139313832' TO DFHEIV0(25:11)
 19622     CALL 'kxdfhei1' USING DFHEIV0,
 19623           DFHEIV1,
 19624           WS-DLO-INTERNAL-POLICY-FORM,
 19625           DLO002-COMM-LENGTH,
 19626           DFHEIV99,
 19627           DFHEIV99,
 19628           DFHEIV99,
 19629           DFHEIV99
 19630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19631
 19632
 19633 7710-EXIT.
 19634     EXIT.
 19635
 19636 7720-CALL-DL3.
 19637
 19638* EXEC CICS LINK
 19639*        PROGRAM    ('DLO003')
 19640*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19641*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 362
* EL050.cbl
 19642*    END-EXEC.
 19643     MOVE 'DLO003' TO DFHEIV1
 19644*    MOVE '."C                   (   #00019192' TO DFHEIV0
 19645     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19647     MOVE X'2020233030303139313932' TO DFHEIV0(25:11)
 19648     CALL 'kxdfhei1' USING DFHEIV0,
 19649           DFHEIV1,
 19650           WS-DLO-VALID-BANK-ID,
 19651           DLO003-COMM-LENGTH,
 19652           DFHEIV99,
 19653           DFHEIV99,
 19654           DFHEIV99,
 19655           DFHEIV99
 19656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19657
 19658
 19659 7720-EXIT.
 19660     EXIT.
 19661
 19662 7730-CALL-DL7.
 19663
 19664* EXEC CICS LINK
 19665*        PROGRAM    ('DLO007')
 19666*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19667*        LENGTH     (DLO007-COMM-LENGTH)
 19668*    END-EXEC.
 19669     MOVE 'DLO007' TO DFHEIV1
 19670*    MOVE '."C                   (   #00019202' TO DFHEIV0
 19671     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19672     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19673     MOVE X'2020233030303139323032' TO DFHEIV0(25:11)
 19674     CALL 'kxdfhei1' USING DFHEIV0,
 19675           DFHEIV1,
 19676           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19677           DLO007-COMM-LENGTH,
 19678           DFHEIV99,
 19679           DFHEIV99,
 19680           DFHEIV99,
 19681           DFHEIV99
 19682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19683
 19684
 19685 7730-EXIT.
 19686     EXIT.
 19687
 19688 7740-CALL-DL11.
 19689
 19690* EXEC CICS LINK
 19691*        PROGRAM    ('DLO011')
 19692*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19693*        LENGTH     (DLO011-COMM-LENGTH)
 19694*    END-EXEC.
 19695     MOVE 'DLO011' TO DFHEIV1
 19696*    MOVE '."C                   (   #00019212' TO DFHEIV0
 19697     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19699     MOVE X'2020233030303139323132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 363
* EL050.cbl
 19700     CALL 'kxdfhei1' USING DFHEIV0,
 19701           DFHEIV1,
 19702           WS-DLO-PREM-RATES-BEN-TYPE,
 19703           DLO011-COMM-LENGTH,
 19704           DFHEIV99,
 19705           DFHEIV99,
 19706           DFHEIV99,
 19707           DFHEIV99
 19708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19709
 19710
 19711 7740-EXIT.
 19712     EXIT.
 19713
 19714 7750-CALL-DL17.
 19715
 19716* EXEC CICS LINK
 19717*        PROGRAM    ('DLO017')
 19718*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19719*        LENGTH     (DLO017-COMM-LENGTH)
 19720*    END-EXEC.
 19721     MOVE 'DLO017' TO DFHEIV1
 19722*    MOVE '."C                   (   #00019222' TO DFHEIV0
 19723     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19725     MOVE X'2020233030303139323232' TO DFHEIV0(25:11)
 19726     CALL 'kxdfhei1' USING DFHEIV0,
 19727           DFHEIV1,
 19728           WS-DLO-VALID-RATE-CODE,
 19729           DLO017-COMM-LENGTH,
 19730           DFHEIV99,
 19731           DFHEIV99,
 19732           DFHEIV99,
 19733           DFHEIV99
 19734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19735
 19736
 19737 7750-EXIT.
 19738     EXIT.
 19739
 19740 7755-CALL-DL19.
 19741
 19742* EXEC CICS LINK
 19743*        PROGRAM    ('DLO019')
 19744*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19745*        LENGTH     (DLO019-COMM-LENGTH)
 19746*    END-EXEC.
 19747     MOVE 'DLO019' TO DFHEIV1
 19748*    MOVE '."C                   (   #00019232' TO DFHEIV0
 19749     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19751     MOVE X'2020233030303139323332' TO DFHEIV0(25:11)
 19752     CALL 'kxdfhei1' USING DFHEIV0,
 19753           DFHEIV1,
 19754           WS-DLO-ORIG-COV-CAT,
 19755           DLO019-COMM-LENGTH,
 19756           DFHEIV99,
 19757           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 364
* EL050.cbl
 19758           DFHEIV99,
 19759           DFHEIV99
 19760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19761
 19762
 19763 7755-EXIT.
 19764     EXIT.
 19765
 19766 7760-CALL-DL21.
 19767
 19768* EXEC CICS LINK
 19769*        PROGRAM    ('DLO021')
 19770*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19771*        LENGTH     (DLO021-COMM-LENGTH)
 19772*    END-EXEC.
 19773     MOVE 'DLO021' TO DFHEIV1
 19774*    MOVE '."C                   (   #00019242' TO DFHEIV0
 19775     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19776     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19777     MOVE X'2020233030303139323432' TO DFHEIV0(25:11)
 19778     CALL 'kxdfhei1' USING DFHEIV0,
 19779           DFHEIV1,
 19780           WS-DLO-VALID-LOAN-OFFICER,
 19781           DLO021-COMM-LENGTH,
 19782           DFHEIV99,
 19783           DFHEIV99,
 19784           DFHEIV99,
 19785           DFHEIV99
 19786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19787
 19788
 19789 7760-EXIT.
 19790     EXIT.
 19791
 19792 7770-CALL-DL22.
 19793
 19794* EXEC CICS LINK
 19795*        PROGRAM    ('DLO022')
 19796*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19797*        LENGTH     (DLO022-COMM-LENGTH)
 19798*    END-EXEC.
 19799     MOVE 'DLO022' TO DFHEIV1
 19800*    MOVE '."C                   (   #00019252' TO DFHEIV0
 19801     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19803     MOVE X'2020233030303139323532' TO DFHEIV0(25:11)
 19804     CALL 'kxdfhei1' USING DFHEIV0,
 19805           DFHEIV1,
 19806           WS-DLO-VALID-STATE-CODE,
 19807           DLO022-COMM-LENGTH,
 19808           DFHEIV99,
 19809           DFHEIV99,
 19810           DFHEIV99,
 19811           DFHEIV99
 19812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19813
 19814
 19815 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 365
* EL050.cbl
 19816     EXIT.
 19817
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 366
* EL050.cbl
 19819
 19820 7780-CALL-AGG.
 19821
 19822* EXEC CICS LINK
 19823*        PROGRAM    ('ELAGGO')
 19824*        COMMAREA   (WS-PASS-to-pemaggo)
 19825*        LENGTH     (ws-passed-key-LENGTH)
 19826*    END-EXEC.
 19827     MOVE 'ELAGGO' TO DFHEIV1
 19828*    MOVE '."C                   (   #00019264' TO DFHEIV0
 19829     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19831     MOVE X'2020233030303139323634' TO DFHEIV0(25:11)
 19832     CALL 'kxdfhei1' USING DFHEIV0,
 19833           DFHEIV1,
 19834           WS-PASS-to-pemaggo,
 19835           ws-passed-key-LENGTH,
 19836           DFHEIV99,
 19837           DFHEIV99,
 19838           DFHEIV99,
 19839           DFHEIV99
 19840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19841
 19842 7780-EXIT.
 19843     EXIT.
 19844 7800-REWRITE-CERT.
 19845******************************************************************
 19846*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19847*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19848******************************************************************
 19849
 19850     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19851        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19852        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19853        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19854
 19855* EXEC CICS REWRITE
 19856*                  DATASET (CERT-ID)
 19857*                  FROM    (CERTIFICATE-MASTER)
 19858*              END-EXEC
 19859     MOVE LENGTH OF
 19860      CERTIFICATE-MASTER
 19861       TO DFHEIV11
 19862*    MOVE '&& L                  %   #00019281' TO DFHEIV0
 19863     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19864     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19865     MOVE X'2020233030303139323831' TO DFHEIV0(25:11)
 19866     CALL 'kxdfhei1' USING DFHEIV0,
 19867           CERT-ID,
 19868           CERTIFICATE-MASTER,
 19869           DFHEIV11,
 19870           DFHEIV99
 19871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19872        GO TO 7800-EXIT.
 19873
 19874       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19875       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19876
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 367
* EL050.cbl
 19877 7800-EXIT.
 19878      EXIT.
 19879
 19880 7900-DELETE-CERT.
 19881
 19882* EXEC CICS DELETE
 19883*        DATASET (CERT-ID)
 19884*    END-EXEC.
 19885*    MOVE '&(                    &   #00019294' TO DFHEIV0
 19886     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19887     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19888     MOVE X'2020233030303139323934' TO DFHEIV0(25:11)
 19889     CALL 'kxdfhei1' USING DFHEIV0,
 19890           CERT-ID,
 19891           DFHEIV99,
 19892           DFHEIV99,
 19893           DFHEIV99,
 19894           DFHEIV99
 19895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19896
 19897
 19898 7900-EXIT.
 19899     EXIT.
 19900
 19901 8000-WRITE-CERT.
 19902
 19903* EXEC CICS HANDLE CONDITION
 19904*        DUPKEY    (8000-FREE-MAIN)
 19905*    END-EXEC.
 19906*    MOVE '"$$                   ! + #00019302' TO DFHEIV0
 19907     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19909     MOVE X'2B20233030303139333032' TO DFHEIV0(25:11)
 19910     CALL 'kxdfhei1' USING DFHEIV0
 19911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19912
 19913
 19914
 19915* EXEC CICS WRITE
 19916*        DATASET     (CERT-ID)
 19917*        FROM        (CERTIFICATE-MASTER)
 19918*        RIDFLD      (ELCERT-KEY)
 19919*    END-EXEC.
 19920     MOVE LENGTH OF
 19921      CERTIFICATE-MASTER
 19922       TO DFHEIV11
 19923*    MOVE '&$ L                  ''   #00019306' TO DFHEIV0
 19924     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19926     MOVE X'2020233030303139333036' TO DFHEIV0(25:11)
 19927     CALL 'kxdfhei1' USING DFHEIV0,
 19928           CERT-ID,
 19929           CERTIFICATE-MASTER,
 19930           DFHEIV11,
 19931           ELCERT-KEY,
 19932           DFHEIV99,
 19933           DFHEIV99
 19934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 368
* EL050.cbl
 19935
 19936
 19937 8000-FREE-MAIN.
 19938
 19939 8000-EXIT.
 19940      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 369
* EL050.cbl
 19942
 19943 8100-READ-ERPNDM.
 19944
 19945* EXEC CICS HANDLE CONDITION
 19946*         NOTFND     (8100-NOTFND)
 19947*         ENDFILE    (8100-NOTFND)
 19948*    END-EXEC.
 19949*    MOVE '"$I''                  ! , #00019319' TO DFHEIV0
 19950     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19952     MOVE X'2C20233030303139333139' TO DFHEIV0(25:11)
 19953     CALL 'kxdfhei1' USING DFHEIV0
 19954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19955
 19956
 19957     MOVE SPACES                 TO ERPNDM-FOUND.
 19958     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19959
 19960
 19961* EXEC CICS READ
 19962*         DATASET   (FILE-ERPNDM)
 19963*         RIDFLD    (PM-CONTROL-PRIMARY)
 19964*         INTO      (PENDING-MAILING-DATA)
 19965*    END-EXEC.
 19966     MOVE LENGTH OF
 19967      PENDING-MAILING-DATA
 19968       TO DFHEIV11
 19969*    MOVE '&"IL       E          (   #00019327' TO DFHEIV0
 19970     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19972     MOVE X'2020233030303139333237' TO DFHEIV0(25:11)
 19973     CALL 'kxdfhei1' USING DFHEIV0,
 19974           FILE-ERPNDM,
 19975           PENDING-MAILING-DATA,
 19976           DFHEIV11,
 19977           PM-CONTROL-PRIMARY,
 19978           DFHEIV99,
 19979           DFHEIV99,
 19980           DFHEIV99
 19981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19982
 19983
 19984     GO TO 8100-EXIT.
 19985
 19986 8100-NOTFND.
 19987
 19988     MOVE 'X'                    TO ERPNDM-FOUND.
 19989     MOVE ER-2694                TO WS-ERROR.
 19990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19991     MOVE ER-2883                TO WS-ERROR
 19992     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19993     .
 19994 8100-EXIT.
 19995     EXIT.
 19996
 19997 8110-READ-ERMAIL.
 19998
 19999* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 370
* EL050.cbl
 20000*         NOTFND     (8110-NOTFND)
 20001*         ENDFILE    (8110-NOTFND)
 20002*    END-EXEC.
 20003*    MOVE '"$I''                  ! - #00019347' TO DFHEIV0
 20004     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20006     MOVE X'2D20233030303139333437' TO DFHEIV0(25:11)
 20007     CALL 'kxdfhei1' USING DFHEIV0
 20008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20009
 20010
 20011     MOVE SPACES                 TO ERMAIL-FOUND.
 20012     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20013     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20014     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20015     MOVE PB-SV-STATE            TO MA-STATE.
 20016
 20017
 20018* EXEC CICS READ
 20019*         UPDATE
 20020*         DATASET   (FILE-ERMAIL)
 20021*         RIDFLD    (MA-CONTROL-PRIMARY)
 20022*         INTO      (MAILING-DATA)
 20023*    END-EXEC.
 20024     MOVE LENGTH OF
 20025      MAILING-DATA
 20026       TO DFHEIV11
 20027*    MOVE '&"IL       EU         (   #00019358' TO DFHEIV0
 20028     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20029     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20030     MOVE X'2020233030303139333538' TO DFHEIV0(25:11)
 20031     CALL 'kxdfhei1' USING DFHEIV0,
 20032           FILE-ERMAIL,
 20033           MAILING-DATA,
 20034           DFHEIV11,
 20035           MA-CONTROL-PRIMARY,
 20036           DFHEIV99,
 20037           DFHEIV99,
 20038           DFHEIV99
 20039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20040
 20041
 20042     GO TO 8110-EXIT.
 20043
 20044 8110-NOTFND.
 20045     MOVE 'X'                    TO ERMAIL-FOUND.
 20046
 20047 8110-EXIT.
 20048     EXIT.
 20049
 20050 8120-REWRITE-ERMAIL.
 20051
 20052* EXEC CICS REWRITE
 20053*         DATASET    (FILE-ERMAIL)
 20054*         FROM       (MAILING-DATA)
 20055*    END-EXEC.
 20056     MOVE LENGTH OF
 20057      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 371
* EL050.cbl
 20058       TO DFHEIV11
 20059*    MOVE '&& L                  %   #00019374' TO DFHEIV0
 20060     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20061     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20062     MOVE X'2020233030303139333734' TO DFHEIV0(25:11)
 20063     CALL 'kxdfhei1' USING DFHEIV0,
 20064           FILE-ERMAIL,
 20065           MAILING-DATA,
 20066           DFHEIV11,
 20067           DFHEIV99
 20068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20069
 20070
 20071 8120-EXIT.
 20072     EXIT.
 20073
 20074 8130-WRITE-ERMAIL.
 20075
 20076* EXEC CICS HANDLE CONDITION
 20077*         DUPKEY   (8130-EXIT)
 20078*    END-EXEC.
 20079*    MOVE '"$$                   ! . #00019383' TO DFHEIV0
 20080     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20082     MOVE X'2E20233030303139333833' TO DFHEIV0(25:11)
 20083     CALL 'kxdfhei1' USING DFHEIV0
 20084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20085
 20086
 20087
 20088* EXEC CICS WRITE
 20089*         DATASET     (FILE-ERMAIL)
 20090*         RIDFLD      (MA-CONTROL-PRIMARY)
 20091*         FROM        (MAILING-DATA)
 20092*    END-EXEC.
 20093     MOVE LENGTH OF
 20094      MAILING-DATA
 20095       TO DFHEIV11
 20096*    MOVE '&$ L                  ''   #00019387' TO DFHEIV0
 20097     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20098     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20099     MOVE X'2020233030303139333837' TO DFHEIV0(25:11)
 20100     CALL 'kxdfhei1' USING DFHEIV0,
 20101           FILE-ERMAIL,
 20102           MAILING-DATA,
 20103           DFHEIV11,
 20104           MA-CONTROL-PRIMARY,
 20105           DFHEIV99,
 20106           DFHEIV99
 20107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20108
 20109
 20110 8130-EXIT.
 20111     EXIT.
 20112
 20113 8140-UNLOCK-ERMAIL.
 20114
 20115* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 372
* EL050.cbl
 20116*         DATASET   (FILE-ERMAIL)
 20117*    END-EXEC.
 20118*    MOVE '&*                    #   #00019397' TO DFHEIV0
 20119     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303139333937' TO DFHEIV0(25:11)
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           FILE-ERMAIL,
 20124           DFHEIV99
 20125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20126
 20127
 20128 8140-EXIT.
 20129     EXIT.
 20130
 20131 8150-read-elcrtt.
 20132
 20133
 20134* EXEC CICS HANDLE CONDITION
 20135*        NOTFND   (8150-exit)
 20136*    END-EXEC
 20137*    MOVE '"$I                   ! / #00019406' TO DFHEIV0
 20138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20140     MOVE X'2F20233030303139343036' TO DFHEIV0(25:11)
 20141     CALL 'kxdfhei1' USING DFHEIV0
 20142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20143
 20144     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20145     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20146
 20147
 20148* EXEC CICS READ
 20149*        DATASET  (CRTT-ID)
 20150*        RIDFLD   (WS-ELCRTT-KEY)
 20151*        INTO     (CERTIFICATE-TRAILERS)
 20152*    END-EXEC
 20153     MOVE LENGTH OF
 20154      CERTIFICATE-TRAILERS
 20155       TO DFHEIV11
 20156*    MOVE '&"IL       E          (   #00019413' TO DFHEIV0
 20157     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20159     MOVE X'2020233030303139343133' TO DFHEIV0(25:11)
 20160     CALL 'kxdfhei1' USING DFHEIV0,
 20161           CRTT-ID,
 20162           CERTIFICATE-TRAILERS,
 20163           DFHEIV11,
 20164           WS-ELCRTT-KEY,
 20165           DFHEIV99,
 20166           DFHEIV99,
 20167           DFHEIV99
 20168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20169
 20170     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20171     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20172     move cs-vehicle-odometer    to ws-vehicle-odometer
 20173
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 373
* EL050.cbl
 20174     .
 20175 8150-exit.
 20176     exit.
 20177 8180-UPDATE-VIN-NUMBER.
 20178
 20179* EXEC CICS HANDLE CONDITION
 20180*        NOTFND   (8180-NOTFND)
 20181*    END-EXEC.
 20182*    MOVE '"$I                   ! 0 #00019427' TO DFHEIV0
 20183     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20184     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20185     MOVE X'3020233030303139343237' TO DFHEIV0(25:11)
 20186     CALL 'kxdfhei1' USING DFHEIV0
 20187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20188
 20189
 20190     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20191     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20192
 20193
 20194* EXEC CICS READ
 20195*        UPDATE
 20196*        DATASET  (CRTT-ID)
 20197*        RIDFLD   (WS-ELCRTT-KEY)
 20198*        INTO     (CERTIFICATE-TRAILERS)
 20199*    END-EXEC.
 20200     MOVE LENGTH OF
 20201      CERTIFICATE-TRAILERS
 20202       TO DFHEIV11
 20203*    MOVE '&"IL       EU         (   #00019434' TO DFHEIV0
 20204     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20205     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20206     MOVE X'2020233030303139343334' TO DFHEIV0(25:11)
 20207     CALL 'kxdfhei1' USING DFHEIV0,
 20208           CRTT-ID,
 20209           CERTIFICATE-TRAILERS,
 20210           DFHEIV11,
 20211           WS-ELCRTT-KEY,
 20212           DFHEIV99,
 20213           DFHEIV99,
 20214           DFHEIV99
 20215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20216
 20217
 20218     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20219         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20220
 20221* EXEC CICS REWRITE
 20222*           DATASET  (CRTT-ID)
 20223*           FROM     (CERTIFICATE-TRAILERS)
 20224*        END-EXEC
 20225     MOVE LENGTH OF
 20226      CERTIFICATE-TRAILERS
 20227       TO DFHEIV11
 20228*    MOVE '&& L                  %   #00019443' TO DFHEIV0
 20229     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20230     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20231     MOVE X'2020233030303139343433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 374
* EL050.cbl
 20232     CALL 'kxdfhei1' USING DFHEIV0,
 20233           CRTT-ID,
 20234           CERTIFICATE-TRAILERS,
 20235           DFHEIV11,
 20236           DFHEIV99
 20237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20238     ELSE
 20239
 20240* EXEC CICS UNLOCK
 20241*          DATASET  (CRTT-ID)
 20242*       END-EXEC
 20243*    MOVE '&*                    #   #00019448' TO DFHEIV0
 20244     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20245     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20246     MOVE X'2020233030303139343438' TO DFHEIV0(25:11)
 20247     CALL 'kxdfhei1' USING DFHEIV0,
 20248           CRTT-ID,
 20249           DFHEIV99
 20250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20251     END-IF.
 20252
 20253     GO TO 8180-EXIT.
 20254
 20255 8180-NOTFND.
 20256
 20257     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20258     MOVE 'CS'         TO CS-RECORD-ID.
 20259     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20260     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20261     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20262     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20263
 20264* EXEC CICS WRITE
 20265*       DATASET  (CRTT-ID)
 20266*       RIDFLD   (WS-ELCRTT-KEY)
 20267*       FROM     (CERTIFICATE-TRAILERS)
 20268*    END-EXEC.
 20269     MOVE LENGTH OF
 20270      CERTIFICATE-TRAILERS
 20271       TO DFHEIV11
 20272*    MOVE '&$ L                  ''   #00019463' TO DFHEIV0
 20273     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20275     MOVE X'2020233030303139343633' TO DFHEIV0(25:11)
 20276     CALL 'kxdfhei1' USING DFHEIV0,
 20277           CRTT-ID,
 20278           CERTIFICATE-TRAILERS,
 20279           DFHEIV11,
 20280           WS-ELCRTT-KEY,
 20281           DFHEIV99,
 20282           DFHEIV99
 20283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20284
 20285
 20286 8180-EXIT.
 20287     EXIT.
 20288
 20289 8190-UPDATE-REFUND-CLAIM-FLAG.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 375
* EL050.cbl
 20290
 20291* EXEC CICS HANDLE CONDITION
 20292*        NOTFND   (8190-NOTFND)
 20293*    END-EXEC.
 20294*    MOVE '"$I                   ! 1 #00019473' TO DFHEIV0
 20295     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20297     MOVE X'3120233030303139343733' TO DFHEIV0(25:11)
 20298     CALL 'kxdfhei1' USING DFHEIV0
 20299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20300
 20301
 20302     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20303     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20304
 20305
 20306* EXEC CICS READ
 20307*        UPDATE
 20308*        DATASET  (CRTT-ID)
 20309*        RIDFLD   (WS-ELCRTT-KEY)
 20310*        INTO     (CERTIFICATE-TRAILERS)
 20311*    END-EXEC.
 20312     MOVE LENGTH OF
 20313      CERTIFICATE-TRAILERS
 20314       TO DFHEIV11
 20315*    MOVE '&"IL       EU         (   #00019480' TO DFHEIV0
 20316     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20317     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20318     MOVE X'2020233030303139343830' TO DFHEIV0(25:11)
 20319     CALL 'kxdfhei1' USING DFHEIV0,
 20320           CRTT-ID,
 20321           CERTIFICATE-TRAILERS,
 20322           DFHEIV11,
 20323           WS-ELCRTT-KEY,
 20324           DFHEIV99,
 20325           DFHEIV99,
 20326           DFHEIV99
 20327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20328
 20329
 20330     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20331
 20332* EXEC CICS REWRITE
 20333*       DATASET  (CRTT-ID)
 20334*       FROM     (CERTIFICATE-TRAILERS)
 20335*    END-EXEC.
 20336     MOVE LENGTH OF
 20337      CERTIFICATE-TRAILERS
 20338       TO DFHEIV11
 20339*    MOVE '&& L                  %   #00019488' TO DFHEIV0
 20340     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20341     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20342     MOVE X'2020233030303139343838' TO DFHEIV0(25:11)
 20343     CALL 'kxdfhei1' USING DFHEIV0,
 20344           CRTT-ID,
 20345           CERTIFICATE-TRAILERS,
 20346           DFHEIV11,
 20347           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 376
* EL050.cbl
 20348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20349
 20350
 20351     GO TO 8190-EXIT.
 20352
 20353 8190-NOTFND.
 20354
 20355     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20356     MOVE 'CS'         TO CS-RECORD-ID.
 20357     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20358     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20359     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20360     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20361
 20362* EXEC CICS WRITE
 20363*       DATASET  (CRTT-ID)
 20364*       RIDFLD   (WS-ELCRTT-KEY)
 20365*       FROM     (CERTIFICATE-TRAILERS)
 20366*    END-EXEC.
 20367     MOVE LENGTH OF
 20368      CERTIFICATE-TRAILERS
 20369       TO DFHEIV11
 20370*    MOVE '&$ L                  ''   #00019503' TO DFHEIV0
 20371     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20373     MOVE X'2020233030303139353033' TO DFHEIV0(25:11)
 20374     CALL 'kxdfhei1' USING DFHEIV0,
 20375           CRTT-ID,
 20376           CERTIFICATE-TRAILERS,
 20377           DFHEIV11,
 20378           WS-ELCRTT-KEY,
 20379           DFHEIV99,
 20380           DFHEIV99
 20381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20382
 20383
 20384 8190-EXIT.
 20385     EXIT.
 20386
 20387 8195-UPDATE-AGE-FLAGS.
 20388
 20389* EXEC CICS HANDLE CONDITION
 20390*        NOTFND   (8195-NOTFND)
 20391*    END-EXEC.
 20392*    MOVE '"$I                   ! 2 #00019513' TO DFHEIV0
 20393     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20395     MOVE X'3220233030303139353133' TO DFHEIV0(25:11)
 20396     CALL 'kxdfhei1' USING DFHEIV0
 20397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20398
 20399
 20400     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20401     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20402
 20403
 20404* EXEC CICS READ
 20405*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 377
* EL050.cbl
 20406*        DATASET  (CRTT-ID)
 20407*        RIDFLD   (WS-ELCRTT-KEY)
 20408*        INTO     (CERTIFICATE-TRAILERS)
 20409*    END-EXEC.
 20410     MOVE LENGTH OF
 20411      CERTIFICATE-TRAILERS
 20412       TO DFHEIV11
 20413*    MOVE '&"IL       EU         (   #00019520' TO DFHEIV0
 20414     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20415     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20416     MOVE X'2020233030303139353230' TO DFHEIV0(25:11)
 20417     CALL 'kxdfhei1' USING DFHEIV0,
 20418           CRTT-ID,
 20419           CERTIFICATE-TRAILERS,
 20420           DFHEIV11,
 20421           WS-ELCRTT-KEY,
 20422           DFHEIV99,
 20423           DFHEIV99,
 20424           DFHEIV99
 20425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20426
 20427
 20428     IF WS-INS-AGE-SET = 'Y'
 20429        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20430     END-IF
 20431     IF WS-JNT-AGE-SET = 'Y'
 20432        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20433     END-IF
 20434
 20435
 20436* EXEC CICS REWRITE
 20437*       DATASET  (CRTT-ID)
 20438*       FROM     (CERTIFICATE-TRAILERS)
 20439*    END-EXEC.
 20440     MOVE LENGTH OF
 20441      CERTIFICATE-TRAILERS
 20442       TO DFHEIV11
 20443*    MOVE '&& L                  %   #00019534' TO DFHEIV0
 20444     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20445     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20446     MOVE X'2020233030303139353334' TO DFHEIV0(25:11)
 20447     CALL 'kxdfhei1' USING DFHEIV0,
 20448           CRTT-ID,
 20449           CERTIFICATE-TRAILERS,
 20450           DFHEIV11,
 20451           DFHEIV99
 20452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20453
 20454
 20455     GO TO 8195-EXIT.
 20456
 20457 8195-NOTFND.
 20458
 20459     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20460     MOVE 'CS'         TO CS-RECORD-ID.
 20461     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20462     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20463     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 378
* EL050.cbl
 20464     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20465     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20466
 20467* EXEC CICS WRITE
 20468*       DATASET  (CRTT-ID)
 20469*       RIDFLD   (WS-ELCRTT-KEY)
 20470*       FROM     (CERTIFICATE-TRAILERS)
 20471*    END-EXEC.
 20472     MOVE LENGTH OF
 20473      CERTIFICATE-TRAILERS
 20474       TO DFHEIV11
 20475*    MOVE '&$ L                  ''   #00019550' TO DFHEIV0
 20476     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20478     MOVE X'2020233030303139353530' TO DFHEIV0(25:11)
 20479     CALL 'kxdfhei1' USING DFHEIV0,
 20480           CRTT-ID,
 20481           CERTIFICATE-TRAILERS,
 20482           DFHEIV11,
 20483           WS-ELCRTT-KEY,
 20484           DFHEIV99,
 20485           DFHEIV99
 20486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20487
 20488
 20489 8195-EXIT.
 20490     EXIT.
 20491
 20492 8200-READ-REIN-TABLE.
 20493
 20494* EXEC CICS HANDLE CONDITION
 20495*         NOTFND   (8200-NOTFND)
 20496*    END-EXEC.
 20497*    MOVE '"$I                   ! 3 #00019560' TO DFHEIV0
 20498     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20500     MOVE X'3320233030303139353630' TO DFHEIV0(25:11)
 20501     CALL 'kxdfhei1' USING DFHEIV0
 20502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20503
 20504
 20505
 20506* EXEC CICS READ
 20507*        DATASET     (REIN-ID)
 20508*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20509*        RIDFLD      (ERREIN-KEY)
 20510*    END-EXEC.
 20511*    MOVE '&"S        E          (   #00019564' TO DFHEIV0
 20512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20514     MOVE X'2020233030303139353634' TO DFHEIV0(25:11)
 20515     CALL 'kxdfhei1' USING DFHEIV0,
 20516           REIN-ID,
 20517           DFHEIV20,
 20518           DFHEIV99,
 20519           ERREIN-KEY,
 20520           DFHEIV99,
 20521           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 379
* EL050.cbl
 20522           DFHEIV99
 20523     SET ADDRESS OF REINSURANCE-RECORD TO
 20524         DFHEIV20
 20525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20526
 20527
 20528     GO TO 8200-EXIT.
 20529
 20530 8200-NOTFND.
 20531     MOVE 'N'             TO WS-REIN-READ-SW.
 20532
 20533 8200-EXIT.
 20534      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 380
* EL050.cbl
 20536
 20537 8300-READ-CTBL-TABLE.
 20538
 20539* EXEC CICS HANDLE CONDITION
 20540*        NOTFND    (8300-NOTFND)
 20541*        DISABLED  (8300-ERRESS-PROBLEM)
 20542*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20543*        ENDFILE   (8300-NOTFND)
 20544*    END-EXEC.
 20545*    MOVE '"$IcJ''                ! 4 #00019580' TO DFHEIV0
 20546     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20548     MOVE X'3420233030303139353830' TO DFHEIV0(25:11)
 20549     CALL 'kxdfhei1' USING DFHEIV0
 20550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20551
 20552
 20553
 20554* EXEC CICS READ
 20555*        DATASET     (CTBL-ID)
 20556*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20557*        RIDFLD      (ERCTBL-KEY)
 20558*    END-EXEC.
 20559*    MOVE '&"S        E          (   #00019587' TO DFHEIV0
 20560     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20561     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20562     MOVE X'2020233030303139353837' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0,
 20564           CTBL-ID,
 20565           DFHEIV20,
 20566           DFHEIV99,
 20567           ERCTBL-KEY,
 20568           DFHEIV99,
 20569           DFHEIV99,
 20570           DFHEIV99
 20571     SET ADDRESS OF COMM-TABLE-RECORD TO
 20572         DFHEIV20
 20573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20574
 20575
 20576     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20577
 20578     GO TO 8300-EXIT.
 20579
 20580 8300-NOTFND.
 20581
 20582     IF CTBL-SW = '0530'
 20583         MOVE 'AA'                     TO WS-AH-COMP-CD
 20584         MOVE '0550'                   TO CTBL-SW
 20585         MOVE '1'                      TO WS-CTBL-READ-SW
 20586         GO TO 8300-EXIT.
 20587
 20588     IF CTBL-SW = '0540'
 20589         MOVE 'AA'                     TO WS-LF-COMP-CD
 20590         MOVE '0550'                   TO CTBL-SW
 20591         MOVE '1'                      TO WS-CTBL-READ-SW
 20592         GO TO 8300-EXIT.
 20593
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 381
* EL050.cbl
 20594     IF CTBL-SW = '0550'
 20595         MOVE '2'                      TO WS-CTBL-READ-SW
 20596         GO TO 8300-EXIT.
 20597
 20598     GO TO 8300-EXIT.
 20599
 20600 8300-ERRESS-PROBLEM.
 20601
 20602      MOVE ER-8050              TO WS-ERROR.
 20603      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20604
 20605     GO TO 8300-EXIT.
 20606
 20607 8300-EXIT.
 20608      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 382
* EL050.cbl
 20610
 20611
 20612 8400-GETMAIN-ERFORM.
 20613
 20614
 20615* EXEC CICS   GETMAIN
 20616*        LENGTH  (500)
 20617*        SET     (ADDRESS OF FORM-MASTER)
 20618*    END-EXEC.
 20619     MOVE 500
 20620       TO DFHEIV11
 20621*    MOVE '," L                  $   #00019631' TO DFHEIV0
 20622     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20623     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20624     MOVE X'2020233030303139363331' TO DFHEIV0(25:11)
 20625     CALL 'kxdfhei1' USING DFHEIV0,
 20626           DFHEIV20,
 20627           DFHEIV11,
 20628           DFHEIV99
 20629     SET ADDRESS OF FORM-MASTER TO
 20630         DFHEIV20
 20631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20632
 20633
 20634     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20635
 20636 8400-EXIT.
 20637      EXIT.
 20638
 20639 8450-READ-FORM-MASTER.
 20640
 20641
 20642* EXEC CICS  HANDLE CONDITION
 20643*        NOTFND   (8450-FORM-NOT-FOUND)
 20644*        ENDFILE  (8450-FORM-NOT-FOUND)
 20645*    END-EXEC.
 20646*    MOVE '"$I''                  ! 5 #00019643' TO DFHEIV0
 20647     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20649     MOVE X'3520233030303139363433' TO DFHEIV0(25:11)
 20650     CALL 'kxdfhei1' USING DFHEIV0
 20651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20652
 20653
 20654
 20655* EXEC CICS   READ
 20656*        DATASET   (FORM-ID)
 20657*        RIDFLD    (ERFORM-KEY)
 20658*        INTO      (FORM-MASTER)
 20659*        GTEQ
 20660*    END-EXEC.
 20661     MOVE LENGTH OF
 20662      FORM-MASTER
 20663       TO DFHEIV11
 20664*    MOVE '&"IL       G          (   #00019648' TO DFHEIV0
 20665     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20667     MOVE X'2020233030303139363438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 383
* EL050.cbl
 20668     CALL 'kxdfhei1' USING DFHEIV0,
 20669           FORM-ID,
 20670           FORM-MASTER,
 20671           DFHEIV11,
 20672           ERFORM-KEY,
 20673           DFHEIV99,
 20674           DFHEIV99,
 20675           DFHEIV99
 20676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20677
 20678
 20679     MOVE  'Y'           TO  FORM-MASTER-SW.
 20680
 20681     GO TO  8450-EXIT.
 20682
 20683 8450-FORM-NOT-FOUND.
 20684
 20685     MOVE  'N'           TO  FORM-MASTER-SW.
 20686
 20687 8450-EXIT.
 20688      EXIT.
 20689
 20690 8500-DATE-CONVERT.
 20691
 20692* EXEC CICS LINK
 20693*        PROGRAM    ('ELDATCV')
 20694*        COMMAREA   (DATE-CONVERSION-DATA)
 20695*        LENGTH     (DC-COMM-LENGTH)
 20696*    END-EXEC.
 20697     MOVE 'ELDATCV' TO DFHEIV1
 20698*    MOVE '."C                   (   #00019667' TO DFHEIV0
 20699     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20700     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20701     MOVE X'2020233030303139363637' TO DFHEIV0(25:11)
 20702     CALL 'kxdfhei1' USING DFHEIV0,
 20703           DFHEIV1,
 20704           DATE-CONVERSION-DATA,
 20705           DC-COMM-LENGTH,
 20706           DFHEIV99,
 20707           DFHEIV99,
 20708           DFHEIV99,
 20709           DFHEIV99
 20710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20711
 20712
 20713 8500-EXIT.
 20714     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 384
* EL050.cbl
 20716
 20717 8555-RELOAD-CONTROL-FILE.
 20718     CONTINUE.
 20719
 20720 8555-EXIT.
 20721     EXIT.
 20722
 20723 8557-GETMAIN-ERPLAN.
 20724
 20725
 20726* EXEC CICS GETMAIN
 20727*        LENGTH    (840)
 20728*        SET       (ADDRESS OF PLAN-RECORDS)
 20729*    END-EXEC.
 20730     MOVE 840
 20731       TO DFHEIV11
 20732*    MOVE '," L                  $   #00019685' TO DFHEIV0
 20733     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20734     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20735     MOVE X'2020233030303139363835' TO DFHEIV0(25:11)
 20736     CALL 'kxdfhei1' USING DFHEIV0,
 20737           DFHEIV20,
 20738           DFHEIV11,
 20739           DFHEIV99
 20740     SET ADDRESS OF PLAN-RECORDS TO
 20741         DFHEIV20
 20742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20743
 20744
 20745     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20746
 20747 8557-EXIT.
 20748     EXIT.
 20749
 20750 8560-GETMAIN.
 20751
 20752* EXEC CICS GETMAIN
 20753*        LENGTH    (2000)
 20754*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20755*    END-EXEC.
 20756     MOVE 2000
 20757       TO DFHEIV11
 20758*    MOVE '," L                  $   #00019696' TO DFHEIV0
 20759     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20760     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20761     MOVE X'2020233030303139363936' TO DFHEIV0(25:11)
 20762     CALL 'kxdfhei1' USING DFHEIV0,
 20763           DFHEIV20,
 20764           DFHEIV11,
 20765           DFHEIV99
 20766     SET ADDRESS OF ACCOUNT-MASTER TO
 20767         DFHEIV20
 20768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20769
 20770
 20771     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20772
 20773 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 385
* EL050.cbl
 20774     EXIT.
 20775
 20776 8570-START-ACCOUNT-MASTER.
 20777
 20778* EXEC CICS HANDLE CONDITION
 20779*        NOTFND    (0199-ACCT-NOT-FOUND)
 20780*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20781*    END-EXEC.
 20782*    MOVE '"$I''                  ! 6 #00019707' TO DFHEIV0
 20783     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20785     MOVE X'3620233030303139373037' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0
 20787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20788
 20789
 20790
 20791* EXEC CICS STARTBR
 20792*        DATASET    (ACCT-ID)
 20793*        RIDFLD     (ERACCT-KEY)
 20794*        GTEQ
 20795*    END-EXEC.
 20796     MOVE 0
 20797       TO DFHEIV11
 20798*    MOVE '&,         G          &   #00019712' TO DFHEIV0
 20799     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20800     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20801     MOVE X'2020233030303139373132' TO DFHEIV0(25:11)
 20802     CALL 'kxdfhei1' USING DFHEIV0,
 20803           ACCT-ID,
 20804           ERACCT-KEY,
 20805           DFHEIV99,
 20806           DFHEIV11,
 20807           DFHEIV99
 20808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20809
 20810
 20811 8570-EXIT.
 20812     EXIT.
 20813
 20814 8580-READ-ACCOUNT-MASTER.
 20815
 20816* EXEC CICS HANDLE CONDITION
 20817*        NOTFND    (0199-ACCT-NOT-FOUND)
 20818*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20819*    END-EXEC.
 20820*    MOVE '"$I''                  ! 7 #00019722' TO DFHEIV0
 20821     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20822     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20823     MOVE X'3720233030303139373232' TO DFHEIV0(25:11)
 20824     CALL 'kxdfhei1' USING DFHEIV0
 20825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20826
 20827
 20828
 20829* EXEC CICS READNEXT
 20830*        DATASET     (ACCT-ID)
 20831*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 386
* EL050.cbl
 20832*        RIDFLD      (ERACCT-KEY)
 20833*    END-EXEC.
 20834     MOVE LENGTH OF
 20835      ACCOUNT-MASTER
 20836       TO DFHEIV12
 20837     MOVE 0
 20838       TO DFHEIV11
 20839*    MOVE '&.IL                  )   #00019727' TO DFHEIV0
 20840     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20841     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20842     MOVE X'2020233030303139373237' TO DFHEIV0(25:11)
 20843     CALL 'kxdfhei1' USING DFHEIV0,
 20844           ACCT-ID,
 20845           ACCOUNT-MASTER,
 20846           DFHEIV12,
 20847           ERACCT-KEY,
 20848           DFHEIV99,
 20849           DFHEIV11,
 20850           DFHEIV99,
 20851           DFHEIV99
 20852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20853
 20854
 20855 8580-EXIT.
 20856     EXIT.
 20857
 20858 8582-READ-COMPENSATION-MASTER.
 20859
 20860* EXEC CICS HANDLE CONDITION
 20861*        NOTFND    (8582-COMP-NOT-FOUND)
 20862*        ENDFILE   (8582-COMP-NOT-FOUND)
 20863*    END-EXEC.
 20864*    MOVE '"$I''                  ! 8 #00019737' TO DFHEIV0
 20865     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20867     MOVE X'3820233030303139373337' TO DFHEIV0(25:11)
 20868     CALL 'kxdfhei1' USING DFHEIV0
 20869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20870
 20871
 20872
 20873* EXEC CICS READ
 20874*        DATASET     (COMP-ID)
 20875*        INTO        (COMPENSATION-MASTER)
 20876*        RIDFLD      (ERCOMP-KEY)
 20877*    END-EXEC.
 20878     MOVE LENGTH OF
 20879      COMPENSATION-MASTER
 20880       TO DFHEIV11
 20881*    MOVE '&"IL       E          (   #00019742' TO DFHEIV0
 20882     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20884     MOVE X'2020233030303139373432' TO DFHEIV0(25:11)
 20885     CALL 'kxdfhei1' USING DFHEIV0,
 20886           COMP-ID,
 20887           COMPENSATION-MASTER,
 20888           DFHEIV11,
 20889           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 387
* EL050.cbl
 20890           DFHEIV99,
 20891           DFHEIV99,
 20892           DFHEIV99
 20893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20894
 20895
 20896     MOVE 'Y'                    TO COMP-MASTER-SW
 20897
 20898     GO TO 8582-EXIT
 20899     .
 20900 8582-COMP-NOT-FOUND.
 20901
 20902     MOVE 'N'                    TO COMP-MASTER-SW.
 20903
 20904 8582-EXIT.
 20905     EXIT.
 20906
 20907 8583-READ-ERAGTC.
 20908
 20909* EXEC CICS HANDLE CONDITION
 20910*        NOTFND    (8583-AGTC-NOT-FOUND)
 20911*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20912*    END-EXEC.
 20913*    MOVE '"$I''                  ! 9 #00019760' TO DFHEIV0
 20914     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20916     MOVE X'3920233030303139373630' TO DFHEIV0(25:11)
 20917     CALL 'kxdfhei1' USING DFHEIV0
 20918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20919
 20920
 20921
 20922* EXEC CICS STARTBR
 20923*        DATASET    (AGTC-ID)
 20924*        RIDFLD     (ERAGTC-KEY)
 20925*        GTEQ
 20926*    END-EXEC.
 20927     MOVE 0
 20928       TO DFHEIV11
 20929*    MOVE '&,         G          &   #00019765' TO DFHEIV0
 20930     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20931     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20932     MOVE X'2020233030303139373635' TO DFHEIV0(25:11)
 20933     CALL 'kxdfhei1' USING DFHEIV0,
 20934           AGTC-ID,
 20935           ERAGTC-KEY,
 20936           DFHEIV99,
 20937           DFHEIV11,
 20938           DFHEIV99
 20939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20940
 20941
 20942 8583-READ-ERAGTC-NEXT.
 20943
 20944* EXEC CICS READNEXT
 20945*        DATASET     (AGTC-ID)
 20946*        INTO        (AGENT-COMMISSIONS)
 20947*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 388
* EL050.cbl
 20948*    END-EXEC.
 20949     MOVE LENGTH OF
 20950      AGENT-COMMISSIONS
 20951       TO DFHEIV12
 20952     MOVE 0
 20953       TO DFHEIV11
 20954*    MOVE '&.IL                  )   #00019772' TO DFHEIV0
 20955     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20956     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20957     MOVE X'2020233030303139373732' TO DFHEIV0(25:11)
 20958     CALL 'kxdfhei1' USING DFHEIV0,
 20959           AGTC-ID,
 20960           AGENT-COMMISSIONS,
 20961           DFHEIV12,
 20962           ERAGTC-KEY,
 20963           DFHEIV99,
 20964           DFHEIV11,
 20965           DFHEIV99,
 20966           DFHEIV99
 20967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20968
 20969
 20970*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20971
 20972     GO TO 8583-EXIT
 20973     .
 20974 8583-AGTC-NOT-FOUND.
 20975
 20976     MOVE 'N'                    TO AGTC-MASTER-SW.
 20977
 20978 8583-EXIT.
 20979     EXIT.
 20980
 20981 8584-READ-BANK-CROSS-REF.
 20982
 20983* EXEC CICS HANDLE CONDITION
 20984*        NOTFND    (8584-BXRF-NOT-FOUND)
 20985*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20986*    END-EXEC.
 20987*    MOVE '"$I''                  ! : #00019790' TO DFHEIV0
 20988     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20990     MOVE X'3A20233030303139373930' TO DFHEIV0(25:11)
 20991     CALL 'kxdfhei1' USING DFHEIV0
 20992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20993
 20994
 20995
 20996* EXEC CICS READ
 20997*        DATASET     (BXRF-ID)
 20998*        INTO        (BANK-CROSS-REFERENCE)
 20999*        RIDFLD      (ERBXRF-KEY)
 21000*        LENGTH      (BXRF-REC-LENGTH)
 21001*    END-EXEC.
 21002*    MOVE '&"IL       E          (   #00019795' TO DFHEIV0
 21003     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21005     MOVE X'2020233030303139373935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 389
* EL050.cbl
 21006     CALL 'kxdfhei1' USING DFHEIV0,
 21007           BXRF-ID,
 21008           BANK-CROSS-REFERENCE,
 21009           BXRF-REC-LENGTH,
 21010           ERBXRF-KEY,
 21011           DFHEIV99,
 21012           DFHEIV99,
 21013           DFHEIV99
 21014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21015
 21016
 21017     MOVE 'Y'                    TO BXRF-MASTER-SW
 21018
 21019     GO TO 8584-EXIT
 21020     .
 21021 8584-BXRF-NOT-FOUND.
 21022
 21023     MOVE 'N'                    TO BXRF-MASTER-SW.
 21024
 21025 8584-EXIT.
 21026     EXIT.
 21027
 21028 8585-READ-PLAN-MASTER.
 21029
 21030
 21031* EXEC CICS HANDLE CONDITION
 21032*        NOTFND    (8585-PLAN-NOT-FOUND)
 21033*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21034*    END-EXEC.
 21035*    MOVE '"$I''                  ! ; #00019815' TO DFHEIV0
 21036     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21038     MOVE X'3B20233030303139383135' TO DFHEIV0(25:11)
 21039     CALL 'kxdfhei1' USING DFHEIV0
 21040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21041
 21042
 21043
 21044* EXEC CICS READ
 21045*        DATASET     (PLAN-ID)
 21046*        INTO        (PLAN-MASTER)
 21047*        RIDFLD      (ERPLAN-KEY)
 21048*    END-EXEC.
 21049     MOVE LENGTH OF
 21050      PLAN-MASTER
 21051       TO DFHEIV11
 21052*    MOVE '&"IL       E          (   #00019820' TO DFHEIV0
 21053     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21055     MOVE X'2020233030303139383230' TO DFHEIV0(25:11)
 21056     CALL 'kxdfhei1' USING DFHEIV0,
 21057           PLAN-ID,
 21058           PLAN-MASTER,
 21059           DFHEIV11,
 21060           ERPLAN-KEY,
 21061           DFHEIV99,
 21062           DFHEIV99,
 21063           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 390
* EL050.cbl
 21064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21065
 21066
 21067     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21068
 21069     GO TO 8585-EXIT.
 21070
 21071 8585-PLAN-NOT-FOUND.
 21072
 21073     MOVE 'N'                    TO PLAN-MASTER-SW.
 21074
 21075 8585-EXIT.
 21076     EXIT.
 21077
 21078 8586-READ-LOAN-OFFICER.
 21079
 21080* EXEC CICS READ
 21081*        DATASET     (LOFC-ID)
 21082*        INTO        (LOAN-OFFICER-MASTER)
 21083*        RIDFLD      (ERLOFC-KEY)
 21084*        RESP        (WS-RESPONSE)
 21085*    END-EXEC
 21086     MOVE LENGTH OF
 21087      LOAN-OFFICER-MASTER
 21088       TO DFHEIV11
 21089*    MOVE '&"IL       E          (  N#00019838' TO DFHEIV0
 21090     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21092     MOVE X'204E233030303139383338' TO DFHEIV0(25:11)
 21093     CALL 'kxdfhei1' USING DFHEIV0,
 21094           LOFC-ID,
 21095           LOAN-OFFICER-MASTER,
 21096           DFHEIV11,
 21097           ERLOFC-KEY,
 21098           DFHEIV99,
 21099           DFHEIV99,
 21100           DFHEIV99
 21101     MOVE EIBRESP  TO WS-RESPONSE
 21102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21103
 21104     IF WS-RESP-NORMAL
 21105        MOVE 'Y'                 TO LOFC-MASTER-SW
 21106     ELSE
 21107        MOVE 'N'                 TO LOFC-MASTER-SW
 21108     END-IF
 21109     .
 21110 8586-EXIT.
 21111     EXIT.
 21112 8587-START-ERPDEF.
 21113
 21114* EXEC CICS STARTBR
 21115*       DATASET   (PDEF-ID)
 21116*       RIDFLD    (ERPDEF-KEY)
 21117*       GTEQ
 21118*       RESP      (WS-RESPONSE)
 21119*    END-EXEC
 21120     MOVE 0
 21121       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 391
* EL050.cbl
 21122*    MOVE '&,         G          &  N#00019854' TO DFHEIV0
 21123     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21124     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21125     MOVE X'204E233030303139383534' TO DFHEIV0(25:11)
 21126     CALL 'kxdfhei1' USING DFHEIV0,
 21127           PDEF-ID,
 21128           ERPDEF-KEY,
 21129           DFHEIV99,
 21130           DFHEIV11,
 21131           DFHEIV99
 21132     MOVE EIBRESP  TO WS-RESPONSE
 21133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21134     IF WS-RESP-NORMAL
 21135        MOVE 'Y'                 TO PDEF-MASTER-SW
 21136     ELSE
 21137        MOVE 'N'                 TO PDEF-MASTER-SW
 21138     END-IF
 21139     .
 21140 8587-EXIT.
 21141     EXIT.
 21142 8588-READ-ERPDEF.
 21143
 21144* EXEC CICS READNEXT
 21145*       DATASET   (PDEF-ID)
 21146*       RIDFLD    (ERPDEF-KEY)
 21147*       INTO      (PRODUCT-MASTER)
 21148*       RESP      (WS-RESPONSE)
 21149*    END-EXEC
 21150     MOVE LENGTH OF
 21151      PRODUCT-MASTER
 21152       TO DFHEIV12
 21153     MOVE 0
 21154       TO DFHEIV11
 21155*    MOVE '&.IL                  )  N#00019869' TO DFHEIV0
 21156     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21157     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21158     MOVE X'204E233030303139383639' TO DFHEIV0(25:11)
 21159     CALL 'kxdfhei1' USING DFHEIV0,
 21160           PDEF-ID,
 21161           PRODUCT-MASTER,
 21162           DFHEIV12,
 21163           ERPDEF-KEY,
 21164           DFHEIV99,
 21165           DFHEIV11,
 21166           DFHEIV99,
 21167           DFHEIV99
 21168     MOVE EIBRESP  TO WS-RESPONSE
 21169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21170     IF WS-RESP-NORMAL
 21171        MOVE 'Y'                 TO PDEF-MASTER-SW
 21172     ELSE
 21173        MOVE 'N'                 TO PDEF-MASTER-SW
 21174     END-IF
 21175     .
 21176 8588-EXIT.
 21177     EXIT.
 21178 8589-ENDBR-ERPDEF.
 21179
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 392
* EL050.cbl
 21180* EXEC CICS ENDBR
 21181*       DATASET   (PDEF-ID)
 21182*    END-EXEC
 21183     MOVE 0
 21184       TO DFHEIV11
 21185*    MOVE '&2                    $   #00019884' TO DFHEIV0
 21186     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21187     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21188     MOVE X'2020233030303139383834' TO DFHEIV0(25:11)
 21189     CALL 'kxdfhei1' USING DFHEIV0,
 21190           PDEF-ID,
 21191           DFHEIV11,
 21192           DFHEIV99
 21193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21194     .
 21195 8589-EXIT.
 21196     EXIT.
 21197 8590-READ-CERT-MASTER.
 21198     IF PB-COMPANY-ID = 'UCL'
 21199         GO TO 8690-READ-CERT-MASTER-UCL.
 21200
 21201
 21202* EXEC CICS HANDLE CONDITION
 21203*         NOTFND    (0299-CERT-NOT-FOUND)
 21204*    END-EXEC.
 21205*    MOVE '"$I                   ! < #00019894' TO DFHEIV0
 21206     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21208     MOVE X'3C20233030303139383934' TO DFHEIV0(25:11)
 21209     CALL 'kxdfhei1' USING DFHEIV0
 21210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21211
 21212
 21213
 21214* EXEC CICS READ
 21215*        DATASET     (CERT-ID)
 21216*        INTO        (CERTIFICATE-MASTER)
 21217*        RIDFLD      (ELCERT-KEY)
 21218*        UPDATE
 21219*    END-EXEC.
 21220     MOVE LENGTH OF
 21221      CERTIFICATE-MASTER
 21222       TO DFHEIV11
 21223*    MOVE '&"IL       EU         (   #00019898' TO DFHEIV0
 21224     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21225     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21226     MOVE X'2020233030303139383938' TO DFHEIV0(25:11)
 21227     CALL 'kxdfhei1' USING DFHEIV0,
 21228           CERT-ID,
 21229           CERTIFICATE-MASTER,
 21230           DFHEIV11,
 21231           ELCERT-KEY,
 21232           DFHEIV99,
 21233           DFHEIV99,
 21234           DFHEIV99
 21235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21236
 21237
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 393
* EL050.cbl
 21238 8590-EXIT.
 21239     EXIT.
 21240
 21241 8690-READ-CERT-MASTER-UCL.
 21242
 21243* EXEC CICS HANDLE CONDITION
 21244*         NOTFND    (8700-READ-CERT-MASTER)
 21245*    END-EXEC.
 21246*    MOVE '"$I                   ! = #00019909' TO DFHEIV0
 21247     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21249     MOVE X'3D20233030303139393039' TO DFHEIV0(25:11)
 21250     CALL 'kxdfhei1' USING DFHEIV0
 21251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21252
 21253
 21254 8690-READ-CERT-CONT.
 21255
 21256* EXEC CICS READ
 21257*        DATASET     (CERT-ID)
 21258*        INTO        (CERTIFICATE-MASTER)
 21259*        RIDFLD      (ELCERT-KEY)
 21260*        UPDATE
 21261*    END-EXEC.
 21262     MOVE LENGTH OF
 21263      CERTIFICATE-MASTER
 21264       TO DFHEIV11
 21265*    MOVE '&"IL       EU         (   #00019914' TO DFHEIV0
 21266     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21267     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21268     MOVE X'2020233030303139393134' TO DFHEIV0(25:11)
 21269     CALL 'kxdfhei1' USING DFHEIV0,
 21270           CERT-ID,
 21271           CERTIFICATE-MASTER,
 21272           DFHEIV11,
 21273           ELCERT-KEY,
 21274           DFHEIV99,
 21275           DFHEIV99,
 21276           DFHEIV99
 21277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21278
 21279
 21280     GO TO 8590-EXIT.
 21281
 21282 8700-READ-CERT-MASTER.
 21283     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21284     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21285
 21286* EXEC CICS HANDLE CONDITION
 21287*         DUPKEY    (8720-COMP-ACCOUNTS)
 21288*         ENDFILE   (8730-END-BROWSE)
 21289*         NOTFND    (8740-NOT-FOUND)
 21290*    END-EXEC.
 21291*    MOVE '"$$''I                 ! > #00019926' TO DFHEIV0
 21292     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21294     MOVE X'3E20233030303139393236' TO DFHEIV0(25:11)
 21295     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 394
* EL050.cbl
 21296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21297
 21298
 21299
 21300* EXEC CICS STARTBR
 21301*        DATASET     ('ELCERT5')
 21302*        RIDFLD      (ELCERT2-KEY)
 21303*        EQUAL
 21304*    END-EXEC.
 21305     MOVE 'ELCERT5' TO DFHEIV1
 21306     MOVE 0
 21307       TO DFHEIV11
 21308*    MOVE '&,         E          &   #00019932' TO DFHEIV0
 21309     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21310     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21311     MOVE X'2020233030303139393332' TO DFHEIV0(25:11)
 21312     CALL 'kxdfhei1' USING DFHEIV0,
 21313           DFHEIV1,
 21314           ELCERT2-KEY,
 21315           DFHEIV99,
 21316           DFHEIV11,
 21317           DFHEIV99
 21318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21319
 21320
 21321 8710-READ-NEXT.
 21322
 21323* EXEC CICS READNEXT
 21324*        DATASET     ('ELCERT5')
 21325*        INTO        (CERTIFICATE-MASTER)
 21326*        RIDFLD      (ELCERT2-KEY)
 21327*    END-EXEC.
 21328     MOVE LENGTH OF
 21329      CERTIFICATE-MASTER
 21330       TO DFHEIV12
 21331     MOVE 'ELCERT5' TO DFHEIV1
 21332     MOVE 0
 21333       TO DFHEIV11
 21334*    MOVE '&.IL                  )   #00019939' TO DFHEIV0
 21335     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21336     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21337     MOVE X'2020233030303139393339' TO DFHEIV0(25:11)
 21338     CALL 'kxdfhei1' USING DFHEIV0,
 21339           DFHEIV1,
 21340           CERTIFICATE-MASTER,
 21341           DFHEIV12,
 21342           ELCERT2-KEY,
 21343           DFHEIV99,
 21344           DFHEIV11,
 21345           DFHEIV99,
 21346           DFHEIV99
 21347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21348
 21349
 21350 8720-COMP-ACCOUNTS.
 21351
 21352* EXEC CICS ENTER
 21353*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 395
* EL050.cbl
 21354*         FROM (PB-C-LAST-NAME)
 21355*    END-EXEC.
 21356     MOVE 001
 21357       TO DFHEIV11
 21358*    MOVE ':$F                   %   #00019946' TO DFHEIV0
 21359     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21360     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21361     MOVE X'2020233030303139393436' TO DFHEIV0(25:11)
 21362     CALL 'kxdfhei1' USING DFHEIV0,
 21363           DFHEIV11,
 21364           PB-C-LAST-NAME,
 21365           DFHEIV99,
 21366           DFHEIV99
 21367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21368
 21369
 21370
 21371* EXEC CICS ENTER
 21372*         TRACEID (002)
 21373*         FROM (CM-INSURED-LAST-NAME)
 21374*    END-EXEC.
 21375     MOVE 002
 21376       TO DFHEIV11
 21377*    MOVE ':$F                   %   #00019951' TO DFHEIV0
 21378     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21379     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21380     MOVE X'2020233030303139393531' TO DFHEIV0(25:11)
 21381     CALL 'kxdfhei1' USING DFHEIV0,
 21382           DFHEIV11,
 21383           CM-INSURED-LAST-NAME,
 21384           DFHEIV99,
 21385           DFHEIV99
 21386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21387
 21388
 21389     IF PB-CERT-NO NOT = CM-CERT-NO
 21390         GO TO 8730-END-BROWSE.
 21391
 21392     IF PB-ACCOUNT = CM-ACCOUNT
 21393         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21394             MOVE ER-2799        TO WS-ERROR
 21395             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21396             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21397             GO TO 8730-END-BROWSE.
 21398
 21399     GO TO 8710-READ-NEXT.
 21400
 21401 8730-END-BROWSE.
 21402
 21403* EXEC CICS ENDBR
 21404*         DATASET    ('ELCERT5')
 21405*    END-EXEC.
 21406     MOVE 'ELCERT5' TO DFHEIV1
 21407     MOVE 0
 21408       TO DFHEIV11
 21409*    MOVE '&2                    $   #00019969' TO DFHEIV0
 21410     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 396
* EL050.cbl
 21412     MOVE X'2020233030303139393639' TO DFHEIV0(25:11)
 21413     CALL 'kxdfhei1' USING DFHEIV0,
 21414           DFHEIV1,
 21415           DFHEIV11,
 21416           DFHEIV99
 21417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21418
 21419
 21420 8740-NOT-FOUND.
 21421     GO TO 0299-CERT-NOT-FOUND.
 21422
 21423 8750-START-ELSTAT.
 21424
 21425* EXEC CICS STARTBR
 21426*       DATASET   (STAT-ID)
 21427*       RIDFLD    (ELSTAT-KEY)
 21428*       GTEQ
 21429*       RESP      (WS-RESPONSE)
 21430*    END-EXEC
 21431     MOVE 0
 21432       TO DFHEIV11
 21433*    MOVE '&,         G          &  N#00019977' TO DFHEIV0
 21434     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21435     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21436     MOVE X'204E233030303139393737' TO DFHEIV0(25:11)
 21437     CALL 'kxdfhei1' USING DFHEIV0,
 21438           STAT-ID,
 21439           ELSTAT-KEY,
 21440           DFHEIV99,
 21441           DFHEIV11,
 21442           DFHEIV99
 21443     MOVE EIBRESP  TO WS-RESPONSE
 21444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21445     IF WS-RESP-NORMAL
 21446        MOVE 'Y'                 TO STAT-MASTER-SW
 21447     ELSE
 21448        MOVE 'N'                 TO STAT-MASTER-SW
 21449     END-IF
 21450     .
 21451 8750-EXIT.
 21452     EXIT.
 21453 8752-READ-ELSTAT.
 21454
 21455* EXEC CICS READNEXT
 21456*       DATASET   (STAT-ID)
 21457*       RIDFLD    (ELSTAT-KEY)
 21458*       INTO      (STATE-FILE)
 21459*       RESP      (WS-RESPONSE)
 21460*    END-EXEC
 21461     MOVE LENGTH OF
 21462      STATE-FILE
 21463       TO DFHEIV12
 21464     MOVE 0
 21465       TO DFHEIV11
 21466*    MOVE '&.IL                  )  N#00019992' TO DFHEIV0
 21467     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21468     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21469     MOVE X'204E233030303139393932' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 397
* EL050.cbl
 21470     CALL 'kxdfhei1' USING DFHEIV0,
 21471           STAT-ID,
 21472           STATE-FILE,
 21473           DFHEIV12,
 21474           ELSTAT-KEY,
 21475           DFHEIV99,
 21476           DFHEIV11,
 21477           DFHEIV99,
 21478           DFHEIV99
 21479     MOVE EIBRESP  TO WS-RESPONSE
 21480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21481     IF WS-RESP-NORMAL
 21482        MOVE 'Y'                 TO STAT-MASTER-SW
 21483     ELSE
 21484        MOVE 'N'                 TO STAT-MASTER-SW
 21485     END-IF
 21486     .
 21487 8752-EXIT.
 21488     EXIT.
 21489 8800-GET-COMP-RATE.
 21490     MOVE +1 TO IB.
 21491     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21492         ADD +9 TO IB
 21493         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21494             ADD +9 TO IB
 21495             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21496                MOVE ZEROS       TO WS-WK-RATE
 21497                GO TO 8800-EXIT.
 21498
 21499     IF PB-I-AGE GREATER CT-AGE (1)
 21500         ADD +3 TO IB
 21501         IF PB-I-AGE GREATER CT-AGE (2)
 21502             ADD +3 TO IB
 21503             IF PB-I-AGE GREATER CT-AGE (3)
 21504                MOVE ZEROS       TO WS-WK-RATE
 21505                GO TO 8800-EXIT.
 21506
 21507     IF WS-WORK-TERM GREATER CT-TRM (1)
 21508         ADD +1 TO IB
 21509         IF WS-WORK-TERM GREATER CT-TRM (2)
 21510             ADD +1 TO IB
 21511             IF WS-WORK-TERM GREATER CT-TRM (3)
 21512                MOVE ZEROS       TO WS-WK-RATE
 21513                GO TO 8800-EXIT.
 21514
 21515     IF CT-RT (IB) NOT NUMERIC
 21516         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21517         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21518         GO TO 8800-GET-COMP-RATE.
 21519
 21520     MOVE CT-RT (IB) TO WS-WK-RATE.
 21521
 21522 8800-EXIT.
 21523     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 398
* EL050.cbl
 21525 8900-ADDRESS-FILE.
 21526     IF ERACCT-FILE-ADDRESSED
 21527         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21528         GO TO 8900-ADDRESS-EXIT.
 21529
 21530     IF ELCNTL-FILE-ADDRESSED
 21531         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21532         GO TO 8900-ADDRESS-EXIT.
 21533
 21534     IF ERPLAN-FILE-ADDRESSED
 21535         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21536         GO TO 8900-ADDRESS-EXIT.
 21537
 21538     IF ERFORM-FILE-ADDRESSED
 21539         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21540         GO TO 8900-ADDRESS-EXIT.
 21541
 21542 8900-ADDRESS-EXIT.
 21543     EXIT.
 21544
 21545 9000-READ-CONTROL.
 21546
 21547* EXEC CICS HANDLE CONDITION
 21548*        NOTFND    (9000-NOTFND)
 21549*    END-EXEC.
 21550*    MOVE '"$I                   ! ? #00020063' TO DFHEIV0
 21551     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21553     MOVE X'3F20233030303230303633' TO DFHEIV0(25:11)
 21554     CALL 'kxdfhei1' USING DFHEIV0
 21555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21556
 21557
 21558
 21559* EXEC CICS READ
 21560*        DATASET     (CNTL-ID)
 21561*        SET         (ADDRESS OF CONTROL-FILE)
 21562*        RIDFLD      (ELCNTL-KEY)
 21563*        GTEQ
 21564*    END-EXEC.
 21565*    MOVE '&"S        G          (   #00020067' TO DFHEIV0
 21566     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21568     MOVE X'2020233030303230303637' TO DFHEIV0(25:11)
 21569     CALL 'kxdfhei1' USING DFHEIV0,
 21570           CNTL-ID,
 21571           DFHEIV20,
 21572           DFHEIV99,
 21573           ELCNTL-KEY,
 21574           DFHEIV99,
 21575           DFHEIV99,
 21576           DFHEIV99
 21577     SET ADDRESS OF CONTROL-FILE TO
 21578         DFHEIV20
 21579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21580
 21581
 21582     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 399
* EL050.cbl
 21583
 21584 9000-NOTFND.
 21585     IF RC-SW-1 = '1'
 21586        MOVE ER-2616              TO WS-ERROR
 21587        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21588        GO TO 9000-EXIT.
 21589
 21590     IF RC-SW-1 = '2'
 21591        MOVE ER-2602              TO WS-ERROR
 21592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21593
 21594 9000-EXIT.
 21595      EXIT.
 21596
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 400
* EL050.cbl
 21598 9100-READ-CONTROL.
 21599
 21600* EXEC CICS HANDLE CONDITION
 21601*        NOTFND  (9100-NOTFND)
 21602*        ENDFILE (9100-NOTFND)
 21603*    END-EXEC.
 21604*    MOVE '"$I''                  ! @ #00020091' TO DFHEIV0
 21605     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21607     MOVE X'4020233030303230303931' TO DFHEIV0(25:11)
 21608     CALL 'kxdfhei1' USING DFHEIV0
 21609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21610
 21611
 21612
 21613* EXEC CICS READ
 21614*        DATASET     (CNTL-ID)
 21615*        INTO        (CONTROL-FILE)
 21616*        RIDFLD      (ELCNTL-KEY)
 21617*        GTEQ
 21618*    END-EXEC.
 21619     MOVE LENGTH OF
 21620      CONTROL-FILE
 21621       TO DFHEIV11
 21622*    MOVE '&"IL       G          (   #00020096' TO DFHEIV0
 21623     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21625     MOVE X'2020233030303230303936' TO DFHEIV0(25:11)
 21626     CALL 'kxdfhei1' USING DFHEIV0,
 21627           CNTL-ID,
 21628           CONTROL-FILE,
 21629           DFHEIV11,
 21630           ELCNTL-KEY,
 21631           DFHEIV99,
 21632           DFHEIV99,
 21633           DFHEIV99
 21634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21635
 21636
 21637     GO TO 9100-EXIT.
 21638
 21639 9100-NOTFND.
 21640     IF RC-SW-2 = '0'
 21641        MOVE '1'                  TO STATE-RECORD-ERROR
 21642        GO TO 9100-EXIT
 21643     END-IF
 21644     IF RC-SW-2 = '1'
 21645        MOVE '1'                  TO LF-BENEFIT-ERROR
 21646        MOVE ER-2604              TO WS-ERROR
 21647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21648        GO TO 9100-EXIT.
 21649
 21650     IF RC-SW-2 = '2'
 21651        MOVE '1'                  TO AH-BENEFIT-ERROR
 21652        MOVE ER-2605              TO WS-ERROR
 21653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21654        GO TO 9100-EXIT.
 21655
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 401
* EL050.cbl
 21656     IF RC-SW-2 = '3'
 21657         MOVE ER-2603           TO WS-ERROR
 21658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21659         GO TO 9100-EXIT.
 21660
 21661     IF RC-SW-2 = '4'
 21662         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21663         GO TO 9100-EXIT.
 21664
 21665     IF RC-SW-2 = '5'
 21666         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21667         IF WS-AH-INPUT-CD-1 = SPACE
 21668             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21669         ELSE
 21670             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21671
 21672 9100-EXIT.
 21673      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 402
* EL050.cbl
 21675 9200-CONTROL-GETMAIN.
 21676
 21677* EXEC CICS GETMAIN
 21678*         LENGTH   (750)
 21679*         SET      (ADDRESS OF CONTROL-FILE)
 21680*    END-EXEC.
 21681     MOVE 750
 21682       TO DFHEIV11
 21683*    MOVE '," L                  $   #00020142' TO DFHEIV0
 21684     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21685     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21686     MOVE X'2020233030303230313432' TO DFHEIV0(25:11)
 21687     CALL 'kxdfhei1' USING DFHEIV0,
 21688           DFHEIV20,
 21689           DFHEIV11,
 21690           DFHEIV99
 21691     SET ADDRESS OF CONTROL-FILE TO
 21692         DFHEIV20
 21693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21694
 21695
 21696     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21697
 21698 9200-EXIT.
 21699     EXIT.
 21700
 21701 9250-UNLOCK-RETURN.
 21702
 21703* EXEC CICS UNLOCK
 21704*        DATASET   (CERT-ID)
 21705*    END-EXEC.
 21706*    MOVE '&*                    #   #00020153' TO DFHEIV0
 21707     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21708     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21709     MOVE X'2020233030303230313533' TO DFHEIV0(25:11)
 21710     CALL 'kxdfhei1' USING DFHEIV0,
 21711           CERT-ID,
 21712           DFHEIV99
 21713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21714
 21715
 21716 9300-ABEND.
 21717     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21718
 21719
 21720* EXEC CICS LINK
 21721*        PROGRAM   ('EL004')
 21722*        COMMAREA  (WS-ERROR-LINE)
 21723*        LENGTH    (72)
 21724*    END-EXEC.
 21725     MOVE 'EL004' TO DFHEIV1
 21726     MOVE 72
 21727       TO DFHEIV11
 21728*    MOVE '."C                   (   #00020160' TO DFHEIV0
 21729     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21731     MOVE X'2020233030303230313630' TO DFHEIV0(25:11)
 21732     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 403
* EL050.cbl
 21733           DFHEIV1,
 21734           WS-ERROR-LINE,
 21735           DFHEIV11,
 21736           DFHEIV99,
 21737           DFHEIV99,
 21738           DFHEIV99,
 21739           DFHEIV99
 21740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21741
 21742
 21743     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21744
 21745
 21746* EXEC CICS ABEND
 21747*        ABCODE ('EL50')
 21748*    END-EXEC.
 21749     MOVE 'EL50' TO DFHEIV5
 21750*    MOVE '.,A                   "   #00020168' TO DFHEIV0
 21751     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21752     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21753     MOVE X'2020233030303230313638' TO DFHEIV0(25:11)
 21754     CALL 'kxdfhei1' USING DFHEIV0,
 21755           DFHEIV5
 21756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21757
 21758
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 404
* EL050.cbl
 21760
 21761******************************************************************
 21762*                                                                *
 21763*            E R R O R   F O R M A T   R O U T I N E             *
 21764*                                                                *
 21765******************************************************************
 21766
 21767 9900-ERROR-FORMAT.
 21768
 21769     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21770                    PB-COMMON-ERROR (2) OR
 21771                    PB-COMMON-ERROR (3) OR
 21772                    PB-COMMON-ERROR (4) OR
 21773                    PB-COMMON-ERROR (5) OR
 21774                    PB-COMMON-ERROR (6) OR
 21775                    PB-COMMON-ERROR (7) OR
 21776                    PB-COMMON-ERROR (8) OR
 21777                    PB-COMMON-ERROR (9) OR
 21778                    PB-COMMON-ERROR (10)
 21779        GO TO 9900-EXIT.
 21780
 21781     IF PB-NO-OF-ERRORS = +10
 21782        GO TO 9900-EXIT.
 21783
 21784     ADD +1  TO PB-NO-OF-ERRORS.
 21785     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21786                                       (PB-NO-OF-ERRORS).
 21787 9900-EXIT.
 21788     EXIT.
 21789
 21790 9990-RETURN.
 21791     IF BROWSE-STARTED
 21792
 21793* EXEC CICS ENDBR
 21794*            DATASET  (ACCT-ID)
 21795*       END-EXEC.
 21796     MOVE 0
 21797       TO DFHEIV11
 21798*    MOVE '&2                    $   #00020205' TO DFHEIV0
 21799     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21800     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21801     MOVE X'2020233030303230323035' TO DFHEIV0(25:11)
 21802     CALL 'kxdfhei1' USING DFHEIV0,
 21803           ACCT-ID,
 21804           DFHEIV11,
 21805           DFHEIV99
 21806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21807
 21808
 21809 9990-EXIT.
 21810     EXIT.
 21811
 21812
 21813****Check for CRTO record, add one if not found.
 21814 9991-CHECK-FOR-ELCRTO.
 21815
 21816* EXEC CICS HANDLE CONDITION
 21817*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 405
* EL050.cbl
 21818*         ENDFILE (9991-CRTO-NOT-FOUND)
 21819*     END-EXEC.
 21820*    MOVE '"$I''                  ! A #00020215' TO DFHEIV0
 21821     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21822     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21823     MOVE X'4120233030303230323135' TO DFHEIV0(25:11)
 21824     CALL 'kxdfhei1' USING DFHEIV0
 21825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21826
 21827     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21828     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21829     MOVE +0                     TO ELCRTO-SEQ-NO
 21830
 21831
 21832* EXEC CICS READ
 21833*       DATASET   ('ELCRTO')
 21834*       INTO      (ORIGINAL-CERTIFICATE)
 21835*       RIDFLD    (ELCRTO-KEY)
 21836*       GTEQ
 21837*       RESP      (WS-RESPONSE)
 21838*    END-EXEC
 21839     MOVE LENGTH OF
 21840      ORIGINAL-CERTIFICATE
 21841       TO DFHEIV11
 21842     MOVE 'ELCRTO' TO DFHEIV1
 21843*    MOVE '&"IL       G          (  N#00020223' TO DFHEIV0
 21844     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21846     MOVE X'204E233030303230323233' TO DFHEIV0(25:11)
 21847     CALL 'kxdfhei1' USING DFHEIV0,
 21848           DFHEIV1,
 21849           ORIGINAL-CERTIFICATE,
 21850           DFHEIV11,
 21851           ELCRTO-KEY,
 21852           DFHEIV99,
 21853           DFHEIV99,
 21854           DFHEIV99
 21855     MOVE EIBRESP  TO WS-RESPONSE
 21856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21857
 21858     IF WS-RESP-NORMAL
 21859        AND (OC-CONTROL-PRIMARY (1:33) =
 21860                 PB-CONTROL-BY-ACCOUNT (1:33))
 21861        AND (OC-RECORD-TYPE =  'I')
 21862           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21863               GO TO 9991-CHECK-INDICATORS
 21864           ELSE
 21865               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21866               GO TO 9991-CRTO-ADD-REC
 21867           END-IF
 21868     END-IF.
 21869
 21870 9991-CRTO-NOT-FOUND.
 21871
 21872     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21873     MOVE 'OC'                TO OC-RECORD-ID
 21874     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21875                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 406
* EL050.cbl
 21876     MOVE +4096               TO OC-KEY-SEQ-NO.
 21877
 21878 9991-CRTO-ADD-REC.
 21879
 21880     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21881     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21882     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21883     MOVE 'I'                 TO OC-RECORD-TYPE
 21884     IF PB-ISSUE
 21885         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21886         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21887         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21888         MOVE PB-I-AGE               TO OC-INS-AGE
 21889         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21890         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21891         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21892         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21893         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21894         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21895         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21896         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21897         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21898         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21899         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21900         IF PB-I-JOINT-COMMISSION > +0
 21901             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21902         ELSE
 21903             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21904         END-IF
 21905         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21906         MOVE +0                     TO OC-LF-CANCEL-AMT
 21907                                        OC-LF-ITD-CANCEL-AMT
 21908         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21909         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21910         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21911         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21912         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21913         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21914         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21915         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21916         MOVE +0                     TO OC-AH-CANCEL-AMT
 21917                                        OC-AH-ITD-CANCEL-AMT
 21918         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21919         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21920         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21921     ELSE
 21922         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21923         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21924         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21925         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21926         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21927         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21928         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21929         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21930         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21931          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21932             MOVE SPACES             TO OC-LF-BENCD
 21933             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 407
* EL050.cbl
 21934                                        OC-LF-BEN-AMT
 21935                                        OC-LF-PRM-AMT
 21936                                        OC-LF-ALT-BEN-AMT
 21937                                        OC-LF-ALT-PRM-AMT
 21938                                        OC-LF-COMM-PCT
 21939                                        OC-LF-CANCEL-AMT
 21940             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21941             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21942         ELSE
 21943             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21944             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21945             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21946             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21947             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21948             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21949             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21950             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21951             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21952             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21953         END-IF
 21954         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21955         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21956          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21957             MOVE SPACES             TO OC-AH-BENCD
 21958             MOVE ZEROS              TO OC-AH-TERM
 21959                                        OC-AH-BEN-AMT
 21960                                        OC-AH-PRM-AMT
 21961                                        OC-AH-COMM-PCT
 21962                                        OC-AH-CANCEL-AMT
 21963                                        OC-AH-CP
 21964             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21965             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21966         ELSE
 21967             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21968             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21969             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21970             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21971             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21972             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21973             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21974             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21975             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21976         END-IF
 21977         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21978         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21979         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21980         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21981     END-IF
 21982     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21983
 21984     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21985
 21986
 21987* EXEC CICS READ
 21988*         DATASET   (FILE-ERMAIL)
 21989*         RIDFLD    (MA-CONTROL-PRIMARY)
 21990*         INTO      (MAILING-DATA)
 21991*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 408
* EL050.cbl
 21992*    END-EXEC
 21993     MOVE LENGTH OF
 21994      MAILING-DATA
 21995       TO DFHEIV11
 21996*    MOVE '&"IL       E          (  N#00020359' TO DFHEIV0
 21997     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21999     MOVE X'204E233030303230333539' TO DFHEIV0(25:11)
 22000     CALL 'kxdfhei1' USING DFHEIV0,
 22001           FILE-ERMAIL,
 22002           MAILING-DATA,
 22003           DFHEIV11,
 22004           MA-CONTROL-PRIMARY,
 22005           DFHEIV99,
 22006           DFHEIV99,
 22007           DFHEIV99
 22008     MOVE EIBRESP  TO WS-RESPONSE
 22009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22010
 22011     IF WS-RESP-NORMAL
 22012         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22013     END-IF.
 22014
 22015     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22016     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22017
 22018
 22019* EXEC CICS READ
 22020*         DATASET  (CRTT-ID)
 22021*         RIDFLD   (WS-ELCRTT-KEY)
 22022*         INTO     (CERTIFICATE-TRAILERS)
 22023*         RESP     (WS-RESPONSE)
 22024*    END-EXEC
 22025     MOVE LENGTH OF
 22026      CERTIFICATE-TRAILERS
 22027       TO DFHEIV11
 22028*    MOVE '&"IL       E          (  N#00020373' TO DFHEIV0
 22029     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22031     MOVE X'204E233030303230333733' TO DFHEIV0(25:11)
 22032     CALL 'kxdfhei1' USING DFHEIV0,
 22033           CRTT-ID,
 22034           CERTIFICATE-TRAILERS,
 22035           DFHEIV11,
 22036           WS-ELCRTT-KEY,
 22037           DFHEIV99,
 22038           DFHEIV99,
 22039           DFHEIV99
 22040     MOVE EIBRESP  TO WS-RESPONSE
 22041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22042
 22043     IF WS-RESP-NORMAL
 22044         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22045         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22046     END-IF.
 22047
 22048
 22049* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 409
* EL050.cbl
 22050*       DATASET   ('ELCRTO')
 22051*       FROM      (ORIGINAL-CERTIFICATE)
 22052*       RIDFLD    (OC-CONTROL-PRIMARY)
 22053*       RESP      (WS-RESPONSE)
 22054*    END-EXEC.
 22055     MOVE LENGTH OF
 22056      ORIGINAL-CERTIFICATE
 22057       TO DFHEIV11
 22058     MOVE 'ELCRTO' TO DFHEIV1
 22059*    MOVE '&$ L                  ''  N#00020385' TO DFHEIV0
 22060     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22061     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22062     MOVE X'204E233030303230333835' TO DFHEIV0(25:11)
 22063     CALL 'kxdfhei1' USING DFHEIV0,
 22064           DFHEIV1,
 22065           ORIGINAL-CERTIFICATE,
 22066           DFHEIV11,
 22067           OC-CONTROL-PRIMARY,
 22068           DFHEIV99,
 22069           DFHEIV99
 22070     MOVE EIBRESP  TO WS-RESPONSE
 22071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22072
 22073
 22074     GO TO 9991-EXIT.
 22075
 22076 9991-CHECK-INDICATORS.
 22077
 22078     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22079         GO TO 9991-EXIT
 22080     END-IF.
 22081
 22082     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22083         GO TO 9991-EXIT
 22084     END-IF.
 22085
 22086
 22087* EXEC CICS READ
 22088*       DATASET   ('ELCRTO')
 22089*       INTO      (ORIGINAL-CERTIFICATE)
 22090*       RIDFLD    (OC-CONTROL-PRIMARY)
 22091*       UPDATE
 22092*       RESP      (WS-RESPONSE)
 22093*    END-EXEC
 22094     MOVE LENGTH OF
 22095      ORIGINAL-CERTIFICATE
 22096       TO DFHEIV11
 22097     MOVE 'ELCRTO' TO DFHEIV1
 22098*    MOVE '&"IL       EU         (  N#00020404' TO DFHEIV0
 22099     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22100     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22101     MOVE X'204E233030303230343034' TO DFHEIV0(25:11)
 22102     CALL 'kxdfhei1' USING DFHEIV0,
 22103           DFHEIV1,
 22104           ORIGINAL-CERTIFICATE,
 22105           DFHEIV11,
 22106           OC-CONTROL-PRIMARY,
 22107           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 410
* EL050.cbl
 22108           DFHEIV99,
 22109           DFHEIV99
 22110     MOVE EIBRESP  TO WS-RESPONSE
 22111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22112     IF WS-RESP-NORMAL
 22113        IF PB-ISSUE
 22114          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22115          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22116          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22117          MOVE PB-I-AGE               TO OC-INS-AGE
 22118          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22119          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22120          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22121          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22122          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22123          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22124          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22125          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22126          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22127          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22128          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22129          IF PB-I-JOINT-COMMISSION > +0
 22130              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22131          ELSE
 22132              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22133          END-IF
 22134          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22135          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22136          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22137          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22138          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22139          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22140          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22141          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22142          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22143
 22144          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22145
 22146* EXEC CICS READ
 22147*             DATASET   (FILE-ERMAIL)
 22148*             RIDFLD    (MA-CONTROL-PRIMARY)
 22149*             INTO      (MAILING-DATA)
 22150*             RESP      (WS-RESPONSE)
 22151*         END-EXEC
 22152     MOVE LENGTH OF
 22153      MAILING-DATA
 22154       TO DFHEIV11
 22155*    MOVE '&"IL       E          (  N#00020444' TO DFHEIV0
 22156     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22158     MOVE X'204E233030303230343434' TO DFHEIV0(25:11)
 22159     CALL 'kxdfhei1' USING DFHEIV0,
 22160           FILE-ERMAIL,
 22161           MAILING-DATA,
 22162           DFHEIV11,
 22163           MA-CONTROL-PRIMARY,
 22164           DFHEIV99,
 22165           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 411
* EL050.cbl
 22166           DFHEIV99
 22167     MOVE EIBRESP  TO WS-RESPONSE
 22168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22169          IF WS-RESP-NORMAL
 22170             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22171          END-IF
 22172
 22173          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22174          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22175
 22176* EXEC CICS READ
 22177*             DATASET  (CRTT-ID)
 22178*             RIDFLD   (WS-ELCRTT-KEY)
 22179*             INTO     (CERTIFICATE-TRAILERS)
 22180*             RESP     (WS-RESPONSE)
 22181*         END-EXEC
 22182     MOVE LENGTH OF
 22183      CERTIFICATE-TRAILERS
 22184       TO DFHEIV11
 22185*    MOVE '&"IL       E          (  N#00020456' TO DFHEIV0
 22186     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22188     MOVE X'204E233030303230343536' TO DFHEIV0(25:11)
 22189     CALL 'kxdfhei1' USING DFHEIV0,
 22190           CRTT-ID,
 22191           CERTIFICATE-TRAILERS,
 22192           DFHEIV11,
 22193           WS-ELCRTT-KEY,
 22194           DFHEIV99,
 22195           DFHEIV99,
 22196           DFHEIV99
 22197     MOVE EIBRESP  TO WS-RESPONSE
 22198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22199          IF WS-RESP-NORMAL
 22200             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22201                               OC-INS-AGE-DEFAULT-FLAG
 22202             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22203                               OC-JNT-AGE-DEFAULT-FLAG
 22204          END-IF
 22205
 22206        ELSE
 22207          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22208             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22209             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22210             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22211          END-IF
 22212          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22213             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22214             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22215             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22216          END-IF
 22217          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22218        END-IF
 22219
 22220* EXEC CICS REWRITE
 22221*          DATASET   ('ELCRTO')
 22222*          FROM      (ORIGINAL-CERTIFICATE)
 22223*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 412
* EL050.cbl
 22224*       END-EXEC
 22225     MOVE LENGTH OF
 22226      ORIGINAL-CERTIFICATE
 22227       TO DFHEIV11
 22228     MOVE 'ELCRTO' TO DFHEIV1
 22229*    MOVE '&& L                  %  N#00020482' TO DFHEIV0
 22230     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22231     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22232     MOVE X'204E233030303230343832' TO DFHEIV0(25:11)
 22233     CALL 'kxdfhei1' USING DFHEIV0,
 22234           DFHEIV1,
 22235           ORIGINAL-CERTIFICATE,
 22236           DFHEIV11,
 22237           DFHEIV99
 22238     MOVE EIBRESP  TO WS-RESPONSE
 22239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22240     END-IF.
 22241
 22242 9991-EXIT.
 22243     EXIT.
 22244
 22245
 22246 9999-RETURN.
 22247     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22248
 22249
 22250* EXEC CICS RETURN
 22251*    END-EXEC.
 22252*    MOVE '.(                    ''   #00020496' TO DFHEIV0
 22253     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22254     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22255     MOVE X'2020233030303230343936' TO DFHEIV0(25:11)
 22256     CALL 'kxdfhei1' USING DFHEIV0,
 22257           DFHEIV99,
 22258           DFHEIV99,
 22259           DFHEIV99,
 22260           DFHEIV99,
 22261           DFHEIV99,
 22262           DFHEIV99
 22263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22264
 22265
 22266
 22267* GOBACK.
 22268     MOVE '9%                    "   ' TO DFHEIV0
 22269     MOVE 'EL050' TO DFHEIV1
 22270     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22271     GOBACK.
 22272
 22273 9999-DFHBACK SECTION.
 22274     MOVE '9%                    "   ' TO DFHEIV0
 22275     MOVE 'EL050' TO DFHEIV1
 22276     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22277     GOBACK.
 22278 9999-DFHEXIT.
 22279     IF DFHEIGDJ EQUAL 0001
 22280         NEXT SENTENCE
 22281     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 413
* EL050.cbl
 22282         GO TO 9300-ABEND,
 22283               3990-FILES-NOT-OPEN
 22284         DEPENDING ON DFHEIGDI
 22285     ELSE IF DFHEIGDJ EQUAL 3
 22286         GO TO 6610-START-BROWSE,
 22287               6630-ERRESS-PROBLEM,
 22288               6630-END-OF-FILE
 22289         DEPENDING ON DFHEIGDI
 22290     ELSE IF DFHEIGDJ EQUAL 4
 22291         GO TO 6630-END-OF-FILE,
 22292               6630-ERRESS-PROBLEM,
 22293               6630-ERRESS-PROBLEM,
 22294               6630-END-OF-FILE
 22295         DEPENDING ON DFHEIGDI
 22296     ELSE IF DFHEIGDJ EQUAL 5
 22297         GO TO 6630-END-OF-FILE,
 22298               6630-END-OF-FILE,
 22299               6630-ERRESS-PROBLEM,
 22300               6630-ERRESS-PROBLEM
 22301         DEPENDING ON DFHEIGDI
 22302     ELSE IF DFHEIGDJ EQUAL 6
 22303         GO TO 6660-START-BROWSE,
 22304               6690-ERRESC-PROBLEM,
 22305               6690-ERRESC-PROBLEM,
 22306               6690-END-OF-FILE
 22307         DEPENDING ON DFHEIGDI
 22308     ELSE IF DFHEIGDJ EQUAL 7
 22309         GO TO 6690-END-OF-FILE,
 22310               6690-ERRESC-PROBLEM,
 22311               6690-ERRESC-PROBLEM,
 22312               6690-END-OF-FILE
 22313         DEPENDING ON DFHEIGDI
 22314     ELSE IF DFHEIGDJ EQUAL 8
 22315         GO TO 6690-END-OF-FILE,
 22316               6690-ERRESC-PROBLEM,
 22317               6690-ERRESC-PROBLEM,
 22318               6690-END-OF-FILE
 22319         DEPENDING ON DFHEIGDI
 22320     ELSE IF DFHEIGDJ EQUAL 9
 22321         GO TO 7250-CONTINUE,
 22322               7250-CONTINUE
 22323         DEPENDING ON DFHEIGDI
 22324     ELSE IF DFHEIGDJ EQUAL 10
 22325         GO TO 7300-CONTINUE,
 22326               7300-CONTINUE
 22327         DEPENDING ON DFHEIGDI
 22328     ELSE IF DFHEIGDJ EQUAL 11
 22329         GO TO 8000-FREE-MAIN
 22330         DEPENDING ON DFHEIGDI
 22331     ELSE IF DFHEIGDJ EQUAL 12
 22332         GO TO 8100-NOTFND,
 22333               8100-NOTFND
 22334         DEPENDING ON DFHEIGDI
 22335     ELSE IF DFHEIGDJ EQUAL 13
 22336         GO TO 8110-NOTFND,
 22337               8110-NOTFND
 22338         DEPENDING ON DFHEIGDI
 22339     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 414
* EL050.cbl
 22340         GO TO 8130-EXIT
 22341         DEPENDING ON DFHEIGDI
 22342     ELSE IF DFHEIGDJ EQUAL 15
 22343         GO TO 8150-exit
 22344         DEPENDING ON DFHEIGDI
 22345     ELSE IF DFHEIGDJ EQUAL 16
 22346         GO TO 8180-NOTFND
 22347         DEPENDING ON DFHEIGDI
 22348     ELSE IF DFHEIGDJ EQUAL 17
 22349         GO TO 8190-NOTFND
 22350         DEPENDING ON DFHEIGDI
 22351     ELSE IF DFHEIGDJ EQUAL 18
 22352         GO TO 8195-NOTFND
 22353         DEPENDING ON DFHEIGDI
 22354     ELSE IF DFHEIGDJ EQUAL 19
 22355         GO TO 8200-NOTFND
 22356         DEPENDING ON DFHEIGDI
 22357     ELSE IF DFHEIGDJ EQUAL 20
 22358         GO TO 8300-NOTFND,
 22359               8300-ERRESS-PROBLEM,
 22360               8300-ERRESS-PROBLEM,
 22361               8300-NOTFND
 22362         DEPENDING ON DFHEIGDI
 22363     ELSE IF DFHEIGDJ EQUAL 21
 22364         GO TO 8450-FORM-NOT-FOUND,
 22365               8450-FORM-NOT-FOUND
 22366         DEPENDING ON DFHEIGDI
 22367     ELSE IF DFHEIGDJ EQUAL 22
 22368         GO TO 0199-ACCT-NOT-FOUND,
 22369               0199-ACCT-NOT-FOUND
 22370         DEPENDING ON DFHEIGDI
 22371     ELSE IF DFHEIGDJ EQUAL 23
 22372         GO TO 0199-ACCT-NOT-FOUND,
 22373               0199-ACCT-NOT-FOUND
 22374         DEPENDING ON DFHEIGDI
 22375     ELSE IF DFHEIGDJ EQUAL 24
 22376         GO TO 8582-COMP-NOT-FOUND,
 22377               8582-COMP-NOT-FOUND
 22378         DEPENDING ON DFHEIGDI
 22379     ELSE IF DFHEIGDJ EQUAL 25
 22380         GO TO 8583-AGTC-NOT-FOUND,
 22381               8583-AGTC-NOT-FOUND
 22382         DEPENDING ON DFHEIGDI
 22383     ELSE IF DFHEIGDJ EQUAL 26
 22384         GO TO 8584-BXRF-NOT-FOUND,
 22385               8584-BXRF-NOT-FOUND
 22386         DEPENDING ON DFHEIGDI
 22387     ELSE IF DFHEIGDJ EQUAL 27
 22388         GO TO 8585-PLAN-NOT-FOUND,
 22389               8585-PLAN-NOT-FOUND
 22390         DEPENDING ON DFHEIGDI
 22391     ELSE IF DFHEIGDJ EQUAL 28
 22392         GO TO 0299-CERT-NOT-FOUND
 22393         DEPENDING ON DFHEIGDI
 22394     ELSE IF DFHEIGDJ EQUAL 29
 22395         GO TO 8700-READ-CERT-MASTER
 22396         DEPENDING ON DFHEIGDI
 22397     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 25-Mar-16 11:11 Page 415
* EL050.cbl
 22398         GO TO 8720-COMP-ACCOUNTS,
 22399               8730-END-BROWSE,
 22400               8740-NOT-FOUND
 22401         DEPENDING ON DFHEIGDI
 22402     ELSE IF DFHEIGDJ EQUAL 31
 22403         GO TO 9000-NOTFND
 22404         DEPENDING ON DFHEIGDI
 22405     ELSE IF DFHEIGDJ EQUAL 32
 22406         GO TO 9100-NOTFND,
 22407               9100-NOTFND
 22408         DEPENDING ON DFHEIGDI
 22409     ELSE IF DFHEIGDJ EQUAL 33
 22410         GO TO 9991-CRTO-NOT-FOUND,
 22411               9991-CRTO-NOT-FOUND
 22412         DEPENDING ON DFHEIGDI.
 22413     MOVE '9%                    "   ' TO DFHEIV0
 22414     MOVE 'EL050' TO DFHEIV1
 22415     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22416     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40696     Code:       91514
