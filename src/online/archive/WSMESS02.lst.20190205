* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   1
* WSMESS02.cbl
* Options: int("WSMESS02.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("WSMESS02.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"WSMESS02.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "WSMESS02.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. WSMESS02.
     4 AUTHOR.     Cowtown.
     5 DATE-COMPILED. 19-Jul-17 11:24.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   2
* WSMESS02.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*  Returns premium calc based on info passed to me.              *
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 020617   2017020300002   PEMA  New Program
    27******************************************************************
    28 ENVIRONMENT DIVISION.
    29 data division.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32) VALUE '********************************'.
    33 77  FILLER  PIC X(32) VALUE '   WSMESS02 WORKING STORAGE     '.
    34 77  FILLER  PIC X(32) VALUE '********************************'.
    35*
    36* program buffers
    37*
    38 77 ws-seq-num                   pic s9(8) comp value 0.
    39 77 ws-flags                     pic s9(8) comp value 0.
    40 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    41 77  ws-comp-id                  pic xxx value spaces.
    42 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    43 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    44 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    45 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    46 77 WS-lf-exp-date               PIC X(10)  VALUE SPACES.
    47 77  ws-ah-exp-date              pic x(10)  value spaces.
    48 77 X1                           PIC S999 COMP-3 VALUE +0.
    49 77 S1                           PIC S999 COMP-3 VALUE +0.
    50 77 S2                           PIC S999 COMP-3 VALUE +0.
    51 77 S3                           PIC S999 COMP-3 VALUE +0.
    52 77  b1                          pic s999 comp-3 value +0.
    53 77 WS-BUILD-SW                  PIC X.
    54    88  TIME-TO-BUILD               VALUE 'Y'.
    55 77 WS-SAVE-ERACCT               PIC X(2000).
    56 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    57 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    58    88  GET-RATES                    VALUE 'R'.
    59    88  GET-ACT-ACCTS                VALUE 'A'.
    60 77  ws-bin-current-dt           pic xx  value low-values.
    61 77 ws-bin-eff-dt                pic xx  value low-values.
    62 77  ws-bin-exp-dt               pic xx  value low-values.
    63 77 ws-bin-1st-pmt-dt            pic xx  value low-values.
    64 77 ws-bin-pri-birth-dt          pic xx  value low-values.
    65 77 ws-bin-cob-birth-dt          pic xx  value low-values.
    66 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    67 77 ws-disp-rate                 pic z9.99999.
    68 77  WS-ERACCT-SW                PIC X VALUE ' '.
    69     88  END-OF-ERACCT                 VALUE 'Y'.
    70 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    71     88  END-OF-ERCTBL                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   3
* WSMESS02.cbl
    72 77  WS-STATUS                   PIC X.
    73 77  ws-socket-sw                pic x value ' '.
    74     88  end-of-socket              value 'Y'.
    75 77  rec-cnt                     pic 9(5) value zeros.
    76 77  ws-stop-sw                  pic x value ' '.
    77     88  i-say-stop                 value 'Y'.
    78 77  ws-browse-sw                pic x value ' '.
    79     88  browse-started            value 'Y'.
    80 77  ws-contract-sw              pic x  value ' '.
    81     88  contract-no-assigned      value 'Y'.
    82 77  ws-error-sw                 pic x value ' '.
    83     88  error-in-one-coverage     value 'Y'.
    84 77  ws-connect-sw               pic x value ' '.
    85     88  connected-to-db           value 'Y'.
    86 77  client-id                   pic xxx.
    87 01  P pointer.
    88 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    89 01  var-ptr pointer.
    90 01  env-var-len                 pic 9(4)  binary.
    91 01  rc                          pic 9(9)  binary.
    92 01  WS-KIXSYS.
    93     05  WS-KIX-FIL1             PIC X(10).
    94     05  WS-KIX-APPS             PIC X(10).
    95     05  WS-KIX-ENV              PIC X(10).
    96     05  WS-KIX-MYENV            PIC X(10).
    97     05  WS-KIX-SYS              PIC X(10).
    98 01  a-angle-n                   pic s9(7)v9(11) comp-3 value +0.
    99 01  a-angle-n-m                 pic s9(7)v9(11) comp-3 value +0.
   100 01  a-prm-angle-n               pic s9(7)v9(11) comp-3 value +0.
   101 01  a-prm-angle-n-m             pic s9(7)v9(11) comp-3 value +0.
   102 01  gamma                       pic s9(7)v9(11) comp-5 value +0.
   103 01  temp-value-1                pic s9(7)v9(11) comp-3 value +0.
   104 01  temp-value-2                pic s9(7)v9(11) comp-3 value +0.
   105 01  temp-value-3                pic s9(7)v9(11) comp-3 value +0.
   106 01  temp-value-4                pic s9(7)v9(11) comp-3 value +0.
   107 01  temp-value-5                pic s9(7)v9(11) comp-3 value +0.
   108 01  temp-value-6                pic s9(7)v9(11) comp-3 value +0.
   109 01  mob                         pic s9(7)v9(11) comp-3 value +0.
   110 01  m                           pic s9(4)v9(4)  comp-3 value +0.
   111 01  n                           pic s9(4)v9(4)  comp-3 value +0.
   112 01  i                           pic s9(7)v9(11) comp-3 value +0.
   113 01  l                           PIC S9(7)V99    comp-3 value +0.
   114 01  pmt                         pic s9(7)v99    comp-3 value +0.
   115 01  ppy                         pic s9(5)       comp-3 value +0.
   116 01  dpp                         pic s9(5)       comp-3 value +0.
   117 01  d                           pic s9(5)       comp-3 value +0.
   118 01  plus2                       pic s9(5)       comp-3 value +0.
   119 01  lf-rate                     pic s999v9(5)   comp-3 value +0.
   120 01  ah-rate                     pic s999v9(5)   comp-3 value +0.
   121 01  DL-PREMIUM                  PIC S9(7)V99    comp-3 value +0.
   122 01  LL-PREMIUM                  PIC S9(7)V99    comp-3 value +0.
   123 01  AH-PREMIUM                  PIC S9(7)V99    comp-3 value +0.
   124 01  T-FINANCED                  PIC S9(7)V99    comp-3 value +0.
   125 01  T-REG-Z-FINANCED            PIC S9(7)V99    comp-3 value +0.
   126 01  T-PAYMENTS                  PIC S9(7)V99    comp-3 value +0.
*  127 EXEC SQL
*  128    INCLUDE SQLDA
*  129 END-EXEC
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   4
* WSMESS02.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 01 SQLDA sync.
   131    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   132    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   133    05 SQLN                  PIC S9(4) COMP-5 value 0.
   134    05 SQLD                  PIC S9(4) COMP-5 value 0.
   135    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   136       10 SQLTYPE            PIC S9(4) COMP-5.
   137       10 SQLLEN             PIC S9(4) COMP-5.
   138$IF P64 SET
   139X      *> For 64-bit environments, ensure that SQLDATA is
   140X      *> aligned on an 8-byte boundary.
   141X      10 FILLER             PIC S9(9) COMP-5.
   142$END
   143       10 SQLDATA            USAGE POINTER.
   144       10 SQLIND             USAGE POINTER.
   145       10 SQLNAME.
   146          15 SQLNAMEL        PIC S9(4) COMP-5.
   147          15 SQLNAMEC        PIC X(30).
   148
   149* Values for SQLTYPE
   150
   151 78  ESQL-DATE-CHAR              VALUE 384.
   152 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   153 78  ESQL-DATE-REC               VALUE 386.
   154 78  ESQL-DATE-REC-NULL          VALUE 387.
   155 78  ESQL-TIME-CHAR              VALUE 388.
   156 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   157 78  ESQL-TIME-REC               VALUE 390.
   158 78  ESQL-TIME-REC-NULL          VALUE 391.
   159 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   160 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   161 78  ESQL-TIMESTAMP-REC          VALUE 394.
   162 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   163 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   164 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   165 78  ESQL-TS-OFFSET-REC          VALUE 398.
   166 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   167 78  ESQL-LONGVARBINARY          VALUE 404.
   168 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   169 78  ESQL-LONGVARCHAR            VALUE 408.
   170 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   171 78  ESQL-BINARY                 VALUE 444.
   172 78  ESQL-BINARY-NULL            VALUE 445.
   173 78  ESQL-VARBINARY              VALUE 446.
   174 78  ESQL-VARBINARY-NULL         VALUE 447.
   175 78  ESQL-VARCHAR                VALUE 448.
   176 78  ESQL-VARCHAR-NULL           VALUE 449.
   177
   178 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   179 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   180
   181 78  ESQL-CHAR                   VALUE 452.
   182 78  ESQL-CHAR-NULL              VALUE 453.
   183
   184 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   185 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   186
   187 78  ESQL-DOUBLE                 VALUE 480.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   5
* WSMESS02.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   188 78  ESQL-DOUBLE-NULL            VALUE 481.
   189 78  ESQL-REAL                   VALUE 482.
   190 78  ESQL-REAL-NULL              VALUE 483.
   191 78  ESQL-DECIMAL                VALUE 484.
   192 78  ESQL-DECIMAL-NULL           VALUE 485.
   193 78  ESQL-INTEGER                VALUE 496.
   194 78  ESQL-INTEGER-NULL           VALUE 497.
   195 78  ESQL-SMALLINT               VALUE 500.
   196 78  ESQL-SMALLINT-NULL          VALUE 501.
   197 78  ESQL-TINYINT                VALUE 502.
   198 78  ESQL-TINYINT-NULL           VALUE 503.
*  199 EXEC SQL
*  200    INCLUDE SQLCA
*  201 END-EXEC
   202 01 SQLCA.
   203     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   204     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   205     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   206     05  SQLERRM.
   207         49  SQLERRML    PIC S9(4) COMP-5.
   208         49  SQLERRMC    PIC X(70).
   209     05  SQLERRP         PIC X(8).
   210     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   211     05  SQLWARN.
   212         10  SQLWARN0    PIC X.
   213         10  SQLWARN1    PIC X.
   214         10  SQLWARN2    PIC X.
   215         10  SQLWARN3    PIC X.
   216         10  SQLWARN4    PIC X.
   217         10  SQLWARN5    PIC X.
   218         10  SQLWARN6    PIC X.
   219         10  SQLWARN7    PIC X.
   220     05  SQLEXT.
   221         10  SQLWARN8    PIC X.
   222         10  SQLWARN9    PIC X.
   223         10  SQLWARN10   PIC X.
   224         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   225     05  SQLSTATE    PIC X(5).
   226 EXEC SQL
   227    BEGIN DECLARE SECTION
   228 END-EXEC
   229 01  ws-dealer-state             pic xx.
   230 01  ws-dealer-id                pic x(10).
   231 01  ws-contract-eff-dt          pic x(10).
   232 01  ws-contract-no              pic x(10) value spaces.
   233 01  ws-contract-suffix          pic x     value spaces.
   234 01  ws-FL-lf-benefit-code-table.
   235     05  ws-fl-lf-table.
   236         10  filler              pic x(5) value 'RSN3K'.
   237         10  filler              pic x(5) value 'LSN3O'.
   238         10  filler              pic x(5) value 'NSN3S'.
   239         10  filler              pic x(5) value 'TSN3X'.
   240         10  filler              pic x(5) value 'RSY3M'.
   241         10  filler              pic x(5) value 'LSY3Q'.
   242         10  filler              pic x(5) value 'NSY3U'.
   243         10  filler              pic x(5) value 'TSY3Z'.
   244         10  filler              pic x(5) value 'RJN3L'.
   245         10  filler              pic x(5) value 'LJN3P'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   6
* WSMESS02.cbl
   246         10  filler              pic x(5) value 'NJN3T'.
   247         10  filler              pic x(5) value 'TJN3Y'.
   248         10  filler              pic x(5) value 'RJY3N'.
   249         10  filler              pic x(5) value 'LJY3R'.
   250         10  filler              pic x(5) value 'NJY3V'.
   251         10  filler              pic x(5) value 'TJY4A'.
   252     05  filler redefines ws-fl-lf-table occurs 16.
   253         10  ws-fl-lf-ben-type   pic x.
   254         10  ws-fl-lf-sin-jnt    pic x.
   255         10  ws-fl-lf-dismemb    pic x.
   256         10  ws-fl-lf-ben-code   pic xx.
   257 01  ws-FL-ah-benefit-code-table.
   258     05  ws-fl-ah-table.
   259         10  filler              pic x(8) value 'ASYR1401'.
   260         10  filler              pic x(8) value 'ASYR0703'.
   261         10  filler              pic x(8) value 'ASYR3004'.
   262         10  filler              pic x(8) value 'ASYE1405'.
   263         10  filler              pic x(8) value 'ASYE3002'.
   264         10  filler              pic x(8) value 'ASNR145C'.
   265         10  filler              pic x(8) value 'ASNR075G'.
   266         10  filler              pic x(8) value 'ASNR305D'.
   267         10  filler              pic x(8) value 'ASNE145E'.
   268         10  filler              pic x(8) value 'ASNE305F'.
   269         10  filler              pic x(8) value 'AJYR1454'.
   270         10  filler              pic x(8) value 'AJYR0753'.
   271         10  filler              pic x(8) value 'AJYR3055'.
   272         10  filler              pic x(8) value 'AJYE1456'.
   273         10  filler              pic x(8) value 'AJYE3057'.
   274         10  filler              pic x(8) value 'AJNR145H'.
   275         10  filler              pic x(8) value 'AJNR075L'.
   276         10  filler              pic x(8) value 'AJNR305I'.
   277         10  filler              pic x(8) value 'AJNE145J'.
   278         10  filler              pic x(8) value 'AJNE305K'.
   279     05  filler redefines ws-fl-ah-table occurs 20.
   280         10  ws-fl-ah-ben-type   pic x.
   281         10  ws-fl-ah-sin-jnt    pic x.
   282         10  ws-fl-ah-fullterm   pic x.
   283         10  ws-fl-ah-ret-elim   pic x.
   284         10  ws-fl-ah-elim-days  pic xx.
   285         10  ws-fl-ah-ben-code   pic xx.
   286 01  ws-key-stuff.
   287     05  ws-ks-contract-no       pic x(10) value spaces.
   288 01  ws-error-message            pic x(50) value spaces.
   289 01  sqlcmd                      pic x(1024).
   290 01  svr                         pic x(32).
   291 01  usr                         pic x(32).
   292 01  pass                        pic x(32).
   293 01  usr-pass                    pic x(64).
   294 01  ws-disp-code                pic s9(11).
   295***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   296***                                                            ***
   297***  These indicators are used to determine if a variable      ***
   298***  is        null.           The indicator will be -1        ***
   299***  if the value        is null  and +0 if the value is       ***
   300***  something other than null.  Here is an example on how     ***
   301***  to use the indicator variables.                           ***
   302***                                                            ***
   303***     EXEC SQL                                               ***
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   7
* WSMESS02.cbl
   304***        fetch checkapp into                                 ***
   305***           :db-app-status :nu-app-status,                   ***
   306***           :db-app-by     :nu-app-by,                       ***
   307***           :db-app-date   :nu-app-date,                     ***
   308***           :db-app-batch  :nu-app-batch                     ***
   309***     END-EXEC                                               ***
   310***                                                            ***
   311***           OR This way on an update                         ***
   312***                                                            ***
   313***     EXEC SQL                                               ***
   314***        UPDATE                                              ***
   315***           CUC_Logic_Remittance                             ***
   316***        SET                                                 ***
   317***           LogicStatus     = :ws-status-code,               ***
   318***           LogicStatusDate = :ws-status-date,               ***
   319***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   320***        WHERE                                               ***
   321***           RemitId = :ws-remit-id                           ***
   322***     END-EXEC                                               ***
   323***                                                            ***
   324***    Also, when the table has a column with a data type of   ***
   325***  "BIT" and used as true/false move the 1 byte receiving    ***
   326***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   327***  then its false. I think true would be 256.                ***
   328***                                                            ***
   329***                                                            ***
   330***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   331 01  indicator-vaiables-for-nulls.
   332     05  nu-app-status           pic s9(4) comp value +0.
   333     05  nu-app-by               pic s9(4) comp value +0.
   334     05  nu-app-date             pic s9(4) comp value +0.
   335     05  nu-app-batch            pic s9(4) comp value +0.
   336     05  nu-fincar               pic s9(4) comp value +0.
   337     05  nu-batchno              pic s9(4) comp value +0.
   338     05  nu-error-message        pic s9(4) comp value +0.
   339 01  sql-cert-records.
   340     05  sql-dlr-state           pic xx.
   341     05  sql-dlr-id              pic x(10).
   342     05  sql-eff-dt              pic x(10).
   343     05  sql-contr-no            pic x(10).
   344     05  sql-contr-suffix        pic x.
   345 EXEC SQL
   346    END DECLARE SECTION
   347 END-EXEC
   348 01  filler.
   349     05  ws-work-in              pic x(10).
   350     05  ws-work-out             pic x(10).
   351     05  ws-work-out-v2 redefines
   352         ws-work-out             pic 9(8)v99.
   353     05  ws-work-out-v0 redefines
   354         ws-work-out             pic 9(10).
   355     05  ws-work-out-v5 redefines
   356         ws-work-out             pic 9(5)v9(5).
   357 01  filler.
   358     05  ws-last-suffix          pic x value low-values.
   359     05  ws-tbl-last-suffix      pic x value low-values.
   360     05  filler.  *> Use X1 for this table.
   361         10  ws-codes            pic x(26) value
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   8
* WSMESS02.cbl
   362         ' ABCDEFGHIJKLMNOPQRSTUVWXY'.
   363         10  ws-suffix-value redefines ws-codes
   364           occurs 26             pic x.
   365 01  ws-work-date.
   366     05  ws-work-ccyy            pic x(4).
   367     05  ws-work-mm              pic xx.
   368     05  ws-work-dd              pic xx.
   369 01  ws-work-date-num redefines ws-work-date
   370                                 pic 9(8).
   371 01  raw-message002-area.
   372     05  raw-message-num         pic x(10).
   373     05  raw-state               pic xx.
   374     05  raw-acct-no             pic x(10).
   375     05  raw-vin                 pic x(17).
   376     05  raw-lf-ben-code         pic xx.
   377     05  raw-ah-ben-code         pic xx.
   378     05  raw-earn-meth           pic x.
   379     05  raw-pri-birth-date      pic x(10).
   380     05  raw-cob-birth-date      pic x(10).
   381     05  raw-loan-amt            pic x(9).
   382     05  raw-eff-date            pic x(10).
   383     05  raw-1st-pmt-dt          pic x(10).
   384     05  raw-pmts-per-year       pic xx.
   385     05  raw-loan-term           pic xxx.
   386     05  raw-lf-term             pic XXX.
   387     05  raw-ah-term             pic xxx.
   388     05  raw-apr                 pic x(8).
   389     05  raw-lf-sin-jnt-ind      pic x.
   390     05  raw-ah-sin-jnt-ind      pic x.
   391     05  raw-dismemberment       pic x.
   392     05  raw-retro-elim          pic x.
   393     05  raw-waiting-days        pic xx.
   394     05  raw-crit-per            pic xx.
   395 01  ws-rate-work-area.
   396     05  ws-rate-state           pic xx.
   397     05  ws-rate-acct-no         pic x(10).
   398     05  ws-rate-vin             pic x(17).
   399     05  ws-rate-in-lf-ben-code  pic xx.
   400     05  ws-rate-in-ah-ben-code  pic xx.
   401     05  ws-rate-earn-meth       pic x.
   402     05  ws-rate-pri-birth-date  pic x(10).
   403     05  ws-rate-cob-birth-date  pic x(10).
   404     05  ws-rate-eff-date        pic x(10).
   405     05  ws-rate-1st-pmt-dt      pic x(10).
   406     05  ws-rate-benefit-type    pic x.
   407     05  ws-rate-lf-benefit-cd   pic xx.
   408     05  ws-rate-ah-benefit-cd   pic xx.
   409     05  ws-rate-loan-amt        pic 9(6)v99.
   410     05  ws-rate-per-pmt         pic 9(7)v99.
   411     05  ws-rate-lf-prem         pic 9(5)v99.
   412     05  ws-rate-ah-prem         pic 9(5)v99.
   413     05  ws-rate-lf-rate         pic 99v9(5).
   414     05  ws-rate-ah-rate         pic 99v9(5).
   415     05  ws-rate-apr             pic 99v9(5).
   416     05  ws-rate-pmts-per-year   pic 99.
   417     05  ws-rate-loan-term       pic 999  value zeros.
   418     05  ws-rate-lf-term         pic 999  value zeros.
   419     05  ws-rate-ah-term         pic 999  value zeros.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page   9
* WSMESS02.cbl
   420     05  ws-issue-age            pic 999  value zeros.
   421     05  ws-cob-age              pic 999  value zeros.
   422     05  ws-rate-age             pic 999  value zeros.
   423     05  ws-max-lf-benefit       pic 9(7)v99 value zeros.
   424     05  ws-max-ah-benefit       pic 9(7)v99 value zeros.
   425     05  ws-rate-tot-financed    pic s9(7)v99 value zeros.
   426     05  ws-rate-tot-pmts        pic s9(7)v99 value zeros.
   427     05  ws-rate-crit-per        pic 99.
   428     05  ws-rate-sin-jnt-lf      pic x.
   429     05  ws-rate-sin-jnt-ah      pic x.
   430     05  ws-rate-dismemberment   pic x.
   431     05  ws-rate-retro-elim      pic x.
   432     05  ws-rate-waiting-days    pic 99.
   433     05  ws-rate-fullterm        pic x.
   434 01  ws-return-string.
   435     05  ws-return-error-no      pic x(4).
   436     05  ws-sc1                  pic x.
   437     05  ws-return-error-mess    pic x(46).
   438     05  ws-sc2                  pic x.
   439     05  ws-return-contract-no   pic x(11).
   440     05  ws-sc3                  pic x.
   441     05  ws-return-lf-max-amt    pic z,zzz,z99.99.
   442     05  ws-sc4                  pic x.
   443     05  ws-return-ah-max-amt    pic zzz,z99.99.
   444     05  ws-sc5                  pic x.
   445     05  ws-return-lf-prem       pic zzz,z99.99.
   446     05  ws-sc6                  pic x.
   447     05  ws-return-ah-prem       pic zzz,z99.99.
   448     05  ws-sc7                  pic x.
   449     05  ws-return-lf-rate       pic z9.99999.
   450     05  ws-sc8                  pic x.
   451     05  ws-return-ah-rate       pic z9.99999.
   452     05  ws-sc9                  pic x.
   453     05  ws-return-lf-exp-dt     pic x(10).
   454     05  ws-sc10                 pic x.
   455     05  ws-return-ah-exp-dt     pic x(10).
   456     05  ws-sc11                 pic x.
   457     05  ws-return-lf-benefit-cd pic xx.
   458     05  ws-sc12                 pic x.
   459     05  ws-return-ah-benefit-cd pic xx.
   460     05  ws-sc13                 pic x.
   461     05  ws-return-period-pmt    pic zzz,z99.99.
   462     05  ws-sc14                 pic x.
   463     05  ws-return-tot-financed  pic z,zzz,z99.99.
   464     05  ws-sc15                 pic x.
   465     05  ws-return-tot-pmts      pic z,zzz,z99.99.
   466 01  WS-AM-KEY.
   467     05  WS-AM-COMPANY-CD        PIC X.
   468     05  WS-AM-CARRIER           PIC X.
   469     05  WS-AM-GROUP             PIC X(6).
   470     05  WS-AM-STATE             PIC XX.
   471     05  WS-AM-ACCOUNT           PIC X(10).
   472     05  WS-AM-EXP-DT            PIC XX.
   473     05  FILLER                  PIC X(4).
   474 01  ws-cm5-compare-key          pic x(12).
   475 01  WS-CM5-KEY.
   476     05  WS-CM5-COMPANY-CD       PIC X.
   477     05  WS-CM5-CERT-NO          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  10
* WSMESS02.cbl
   478 01  ws-cm-compare-key           pic x(33).
   479 01  WS-CM-KEY.
   480     05  WS-CM-COMPANY-CD        PIC X.
   481     05  WS-CM-CARRIER           PIC X.
   482     05  WS-CM-GROUP             PIC X(6).
   483     05  WS-CM-STATE             PIC XX.
   484     05  WS-CM-ACCOUNT           PIC X(10).
   485     05  WS-CM-EFF-DT            PIC XX.
   486     05  WS-CM-CERT-NO.
   487         10  ws-cm-cert-ten      pic x(10).
   488         10  ws-cm-cert-suffix   pic x.
   489 01  WS-CS-KEY.
   490     05  WS-CS-COMPANY-CD        PIC X.
   491     05  WS-CS-CARRIER           PIC X.
   492     05  WS-CS-GROUP             PIC X(6).
   493     05  WS-CS-STATE             PIC XX.
   494     05  WS-CS-ACCOUNT           PIC X(10).
   495     05  WS-CS-EFF-DT            PIC XX.
   496     05  WS-CS-CERT-NO           PIC X(11).
   497     05  WS-CS-TRLR-TYPE         PIC X.
   498 01  WS-AM-ALT-KEY.
   499     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   500     05  WS-AM-ALT-EXP-DT        PIC XX.
   501 01  WS-CF-KEY-SAVE              PIC X(10).
   502 01  WS-CF-KEY.
   503     05  WS-CF-COMPANY-ID        PIC XXX.
   504     05  WS-CF-RECORD-TYPE       PIC X.
   505     05  WS-CF-ACCESS            PIC X(4).
   506     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   507 01  filler.
   508     05  ws-errors-table.
   509         10  filler              pic x(50) value
   510         '0000Transaction successfully completed'.
   511         10  filler              pic x(50) value
   512         '0101Problem with amounts'.
   513         10  filler              pic x(50) value
   514         '0102Problem with dates'.
   515         10  filler              pic x(50) value
   516         '0103Issue age outside limits'.
   517         10  filler              pic x(50) value
   518         '0104Attained age outside limits'.
   519         10  filler              pic x(50) value
   520         '0105Term is not valid must be gt 0 and lt 361'.
   521         10  filler              pic x(50) value
   522         '0106Term is outside limits'.
   523         10  filler              pic x(50) value
   524         '0107Amount is outside limits'.
   525         10  filler              pic x(50) value
   526         '0108Loan term must be ge insurance term'.
   527         10  filler              pic x(50) value
   528         '0109Total benefit is outside limits'.
   529         10  filler              pic x(50) value
   530         '0110Rates found were zero'.
   531         10  filler              pic x(50) value
   532         '0111Rate table was not found'.
   533         10  filler              pic x(50) value
   534         '0112Rate file not open'.
   535         10  filler              pic x(50) value
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  11
* WSMESS02.cbl
   536         '0113Premium is out of tolerence'.
   537         10  filler              pic x(50) value
   538         '0114Duplicate contract and VIN on Logic'.
   539         10  filler              pic x(50) value
   540         '0115Problem with loan or insurance term'.
   541     05  filler redefines ws-errors-table occurs 16.
   542         10  ws-table-error-no   pic x(4).
   543         10  ws-table-error-mess pic x(46).
   544 01  ws-mess002-length           pic s9(4) comp value +1024.
   545 01  WS-MESS002-PASS-AREA        PIC X(1024).
   546 01  WS-CID-NO                   PIC X(8).
   547 01  WS-DISP-RESP                PIC 9(5).
   548 01  WS-RESPONSE                 PIC S9(8)   COMP.
   549     88  RESP-NORMAL                  VALUE +00.
   550     88  RESP-NOTFND                  VALUE +13.
   551     88  resp-duprec                  value +14.
   552     88  resp-dupkey                  value +15.
   553     88  RESP-NOTOPEN                 VALUE +19.
   554     88  RESP-ENDFILE                 VALUE +20.
   555*                                 COPY ERCACCT.
   556******************************************************************
   557*                                                                *
   558*                                                                *
   559*                            ERCACCT                             *
   560*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   561*                            VMOD=2.031                          *
   562*                                                                *
   563*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   564*                                                                *
   565*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   566*   VSAM ACCOUNT MASTER FILES.                                   *
   567*                                                                *
   568*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   569*                                                                *
   570*   FILE TYPE = VSAM,KSDS                                        *
   571*   RECORD SIZE = 2000  RECFORM = FIX                            *
   572*                                                                *
   573*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   574*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   575*                                                                *
   576*   LOG = NO                                                     *
   577*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   578*                                                                *
   579*                                                                *
   580******************************************************************
   581*                   C H A N G E   L O G
   582*
   583* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   584*-----------------------------------------------------------------
   585*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   586* EFFECTIVE    NUMBER
   587*-----------------------------------------------------------------
   588* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   589* 092705    2005050300006  PEMA  ADD SPP LEASES
   590* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   591* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   592* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   593* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  12
* WSMESS02.cbl
   594* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   595* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   596******************************************************************
   597
   598 01  ACCOUNT-MASTER.
   599     12  AM-RECORD-ID                      PIC XX.
   600         88  VALID-AM-ID                      VALUE 'AM'.
   601
   602     12  AM-CONTROL-PRIMARY.
   603         16  AM-COMPANY-CD                 PIC X.
   604         16  AM-MSTR-CNTRL.
   605             20  AM-CONTROL-A.
   606                 24  AM-CARRIER            PIC X.
   607                 24  AM-GROUPING.
   608                     28 AM-GROUPING-PREFIX PIC XXX.
   609                     28 AM-GROUPING-PRIME  PIC XXX.
   610                 24  AM-STATE              PIC XX.
   611                 24  AM-ACCOUNT.
   612                     28  AM-ACCOUNT-PREFIX PIC X(4).
   613                     28  AM-ACCOUNT-PRIME  PIC X(6).
   614             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   615                                           PIC X(19).
   616             20  AM-CNTRL-B.
   617                 24  AM-EXPIRATION-DT      PIC XX.
   618                 24  FILLER                PIC X(4).
   619             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   620                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   621
   622     12  AM-CONTROL-BY-VAR-GRP.
   623         16  AM-COMPANY-CD-A1              PIC X.
   624         16  AM-VG-CARRIER                 PIC X.
   625         16  AM-VG-GROUPING                PIC X(6).
   626         16  AM-VG-STATE                   PIC XX.
   627         16  AM-VG-ACCOUNT                 PIC X(10).
   628         16  AM-VG-DATE.
   629             20  AM-VG-EXPIRATION-DT       PIC XX.
   630             20  FILLER                    PIC X(4).
   631         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   632                                           PIC 9(11)      COMP-3.
   633     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   634         16  FILLER                        PIC X(10).
   635         16  AM-VG-KEY3.
   636             20  AM-VG3-ACCOUNT            PIC X(10).
   637             20  AM-VG3-EXP-DT             PIC XX.
   638         16  FILLER                        PIC X(4).
   639     12  AM-MAINT-INFORMATION.
   640         16  AM-LAST-MAINT-DT              PIC XX.
   641         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   642         16  AM-LAST-MAINT-USER            PIC X(4).
   643         16  FILLER                        PIC XX.
   644
   645     12  AM-EFFECTIVE-DT                   PIC XX.
   646     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   647
   648     12  AM-PREV-DATES  COMP-3.
   649         16  AM-PREV-EXP-DT                PIC 9(11).
   650         16  AM-PREV-EFF-DT                PIC 9(11).
   651
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  13
* WSMESS02.cbl
   652     12  AM-REPORT-CODE-1                  PIC X(10).
   653     12  AM-REPORT-CODE-2                  PIC X(10).
   654
   655     12  AM-CITY-CODE                      PIC X(4).
   656     12  AM-COUNTY-PARISH                  PIC X(6).
   657
   658     12  AM-NAME                           PIC X(30).
   659     12  AM-PERSON                         PIC X(30).
   660     12  AM-ADDRS                          PIC X(30).
   661     12  AM-CITY.
   662         16  AM-ADDR-CITY                  PIC X(28).
   663         16  AM-ADDR-STATE                 PIC XX.
   664     12  AM-ZIP.
   665         16  AM-ZIP-PRIME.
   666             20  AM-ZIP-PRI-1ST            PIC X.
   667                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   668             20  FILLER                    PIC X(4).
   669         16  AM-ZIP-PLUS4                  PIC X(4).
   670     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   671         16  AM-CAN-POSTAL-1               PIC XXX.
   672         16  AM-CAN-POSTAL-2               PIC XXX.
   673         16  FILLER                        PIC XXX.
   674     12  AM-TEL-NO.
   675         16  AM-AREA-CODE                  PIC 999.
   676         16  AM-TEL-PRE                    PIC 999.
   677         16  AM-TEL-NBR                    PIC 9(4).
   678     12  AM-TEL-LOC                        PIC X.
   679         88  AM-TEL-AT-HOME                   VALUE 'H'.
   680         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   681
   682     12  AM-COMM-STRUCTURE.
   683         16  AM-DEFN-1.
   684             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   685                 24  AM-AGT.
   686                     28  AM-AGT-PREFIX     PIC X(4).
   687                     28  AM-AGT-PRIME      PIC X(6).
   688                 24  AM-COM-TYP            PIC X.
   689                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   690                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   691                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   692                 24  AM-RECALC-LV-INDIC    PIC X.
   693                 24  AM-RETRO-LV-INDIC     PIC X.
   694                 24  AM-GL-CODES           PIC X.
   695                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   696                 24  FILLER                PIC X(01).
   697         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   698             20  AM-COM-TBLS        OCCURS 10 TIMES.
   699                 24  FILLER                PIC X(11).
   700                 24  AM-L-COMA             PIC XXX.
   701                 24  AM-J-COMA             PIC XXX.
   702                 24  AM-A-COMA             PIC XXX.
   703                 24  FILLER                PIC X(6).
   704
   705     12  AM-COMM-CHANGE-STATUS             PIC X.
   706         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   707
   708     12  AM-CSR-CODE                       PIC X(4).
   709
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  14
* WSMESS02.cbl
   710     12  AM-BILLING-STATUS                 PIC X.
   711         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   712         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   713     12  AM-AUTO-REFUND-SW                 PIC X.
   714         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   715         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   716     12  AM-GPCD                           PIC 99.
   717     12  AM-IG                             PIC X.
   718         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   719         88  AM-HAS-GROUP                     VALUE '2'.
   720     12  AM-STATUS                         PIC X.
   721         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   722         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   723         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   724         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   725         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   726         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   727         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   728         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   729         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   730         88  AM-ACCOUNT-PENDING               VALUE '9'.
   731     12  AM-REMIT-TO                       PIC 99.
   732     12  AM-ID-NO                          PIC X(11).
   733
   734     12  AM-CAL-TABLE                      PIC XX.
   735     12  AM-LF-DEVIATION                   PIC XXX.
   736     12  AM-AH-DEVIATION                   PIC XXX.
   737     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   738     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   739     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   740     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   741     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   742     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   743
   744     12  AM-USER-FIELDS.
   745         16  AM-FLD-1                      PIC XX.
   746         16  AM-FLD-2                      PIC XX.
   747         16  AM-FLD-3                      PIC XX.
   748         16  AM-FLD-4                      PIC XX.
   749         16  AM-FLD-5                      PIC XX.
   750
   751     12  AM-1ST-PROD-DATE.
   752         16  AM-1ST-PROD-YR                PIC XX.
   753         16  AM-1ST-PROD-MO                PIC XX.
   754         16  AM-1ST-PROD-DA                PIC XX.
   755     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   756     12  AM-CERTS-PURGED-DATE.
   757         16  AM-PUR-YR                     PIC XX.
   758         16  AM-PUR-MO                     PIC XX.
   759         16  AM-PUR-DA                     PIC XX.
   760     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   761     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   762     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   763     12  AM-INACTIVE-DATE.
   764         16  AM-INA-MO                     PIC 99.
   765         16  AM-INA-DA                     PIC 99.
   766         16  AM-INA-YR                     PIC 99.
   767     12  AM-AR-HI-CERT-DATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  15
* WSMESS02.cbl
   768
   769     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   770     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   771
   772     12  AM-OB-PAYMENT-MODE                PIC X.
   773         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   774         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   775         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   776         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   777
   778     12  AM-AH-ONLY-INDICATOR              PIC X.
   779         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   780         88  AM-NO-AH-ONLY                    VALUE 'N'.
   781
   782     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   783
   784     12  AM-OVER-SHORT.
   785         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   786         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   787
   788     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   789     12  AM-DCC-CLP-STATE                  PIC XX.
   790
   791     12  AM-RECALC-COMM                    PIC X.
   792     12  AM-RECALC-REIN                    PIC X.
   793
   794     12  AM-REI-TABLE                      PIC XXX.
   795     12  AM-REI-ET-LF                      PIC X.
   796     12  AM-REI-ET-AH                      PIC X.
   797     12  AM-REI-PE-LF                      PIC X.
   798     12  AM-REI-PE-AH                      PIC X.
   799     12  AM-REI-PRT-ST                     PIC X.
   800     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   801     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   802     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   803     12  AM-REI-GROUP-A                    PIC X(6).
   804     12  AM-REI-MORT                       PIC X(4).
   805     12  AM-REI-PRT-OW                     PIC X.
   806     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   807     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   808     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   809     12  AM-REI-GROUP-B                    PIC X(6).
   810
   811     12  AM-TRUST-TYPE                     PIC X(2).
   812
   813     12  AM-EMPLOYER-STMT-USED             PIC X.
   814     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   815
   816     12  AM-STD-AH-TYPE                    PIC XX.
   817     12  AM-EARN-METHODS.
   818         16  AM-EARN-METHOD-R              PIC X.
   819             88 AM-REF-RL-R78                 VALUE 'R'.
   820             88 AM-REF-RL-PR                  VALUE 'P'.
   821             88 AM-REF-RL-MEAN                VALUE 'M'.
   822             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   823         16  AM-EARN-METHOD-L              PIC X.
   824             88 AM-REF-LL-R78                 VALUE 'R'.
   825             88 AM-REF-LL-PR                  VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  16
* WSMESS02.cbl
   826             88 AM-REF-LL-MEAN                VALUE 'M'.
   827             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   828         16  AM-EARN-METHOD-A              PIC X.
   829             88 AM-REF-AH-R78                 VALUE 'R'.
   830             88 AM-REF-AH-PR                  VALUE 'P'.
   831             88 AM-REF-AH-MEAN                VALUE 'M'.
   832             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   833             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   834             88 AM-REF-AH-NET                 VALUE 'N'.
   835
   836     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   837     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   838     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   839
   840     12  AM-RET-Y-N                        PIC X.
   841     12  AM-RET-P-E                        PIC X.
   842     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   843     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   844     12  AM-RET-GRP                        PIC X(6).
   845     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   846         16  AM-POOL-PRIME                 PIC XXX.
   847         16  AM-POOL-SUB                   PIC XXX.
   848     12  AM-RETRO-EARNINGS.
   849         16  AM-RET-EARN-R                 PIC X.
   850         16  AM-RET-EARN-L                 PIC X.
   851         16  AM-RET-EARN-A                 PIC X.
   852     12  AM-RET-ST-TAX-USE                 PIC X.
   853         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   854         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   855     12  AM-RETRO-BEG-EARNINGS.
   856         16  AM-RET-BEG-EARN-R             PIC X.
   857         16  AM-RET-BEG-EARN-L             PIC X.
   858         16  AM-RET-BEG-EARN-A             PIC X.
   859     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   860     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   861
   862     12  AM-USER-SELECT-OPTIONS.
   863         16  AM-USER-SELECT-1              PIC X(10).
   864         16  AM-USER-SELECT-2              PIC X(10).
   865         16  AM-USER-SELECT-3              PIC X(10).
   866         16  AM-USER-SELECT-4              PIC X(10).
   867         16  AM-USER-SELECT-5              PIC X(10).
   868
   869     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   870
   871     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   872
   873     12  AM-RPT045A-SWITCH                 PIC X.
   874         88  RPT045A-OFF                   VALUE 'N'.
   875
   876     12  AM-INSURANCE-LIMITS.
   877         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   878         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   879
   880     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   881         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   882
   883     12  AM-DISMBR-COVERAGE-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  17
* WSMESS02.cbl
   884         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   885         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   886
   887     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   888
   889     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   890     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   891     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   892     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   893     12  AM-DCC-UEF-STATE                  PIC XX.
   894     12  FILLER                            PIC XXX.
   895     12  AM-REPORT-CODE-3                  PIC X(10).
   896*    12  FILLER                            PIC X(22).
   897
   898     12  AM-RESERVE-DATE.
   899         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   900         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   901         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   902
   903     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   904     12  AM-NOTIFICATION-TYPES.
   905         16  AM-NOTIF-OF-LETTERS           PIC X.
   906         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   907         16  AM-NOTIF-OF-REPORTS           PIC X.
   908         16  AM-NOTIF-OF-STATUS            PIC X.
   909
   910     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   911         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   912         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   913         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   914         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   915
   916     12  AM-BENEFIT-CONTROLS.
   917         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   918             20  AM-BENEFIT-CODE           PIC XX.
   919             20  AM-BENEFIT-TYPE           PIC X.
   920             20  AM-BENEFIT-REVISION       PIC XXX.
   921             20  AM-BENEFIT-REM-TERM       PIC X.
   922             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   923             20  FILLER                    PIC XX.
   924         16  FILLER                        PIC X(80).
   925
   926     12  AM-TRANSFER-DATA.
   927         16  AM-TRANSFERRED-FROM.
   928             20  AM-TRNFROM-CARRIER        PIC X.
   929             20  AM-TRNFROM-GROUPING.
   930                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   931                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   932             20  AM-TRNFROM-STATE          PIC XX.
   933             20  AM-TRNFROM-ACCOUNT.
   934                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   935                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   936             20  AM-TRNFROM-DTE            PIC XX.
   937         16  AM-TRANSFERRED-TO.
   938             20  AM-TRNTO-CARRIER          PIC X.
   939             20  AM-TRNTO-GROUPING.
   940                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   941                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  18
* WSMESS02.cbl
   942             20  AM-TRNTO-STATE            PIC XX.
   943             20  AM-TRNTO-ACCOUNT.
   944                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   945                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   946             20  AM-TRNTO-DTE              PIC XX.
   947         16  FILLER                        PIC X(10).
   948
   949     12  AM-SAVED-REMIT-TO                 PIC 99.
   950
   951     12  AM-COMM-STRUCTURE-SAVED.
   952         16  AM-DEFN-1-SAVED.
   953             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   954                 24  AM-AGT-SV             PIC X(10).
   955                 24  AM-COM-TYP-SV         PIC X.
   956                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   957                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   958                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   959                 24  AM-RECALC-LV-INDIC-SV PIC X.
   960                 24  FILLER                PIC X.
   961                 24  AM-GL-CODES-SV        PIC X.
   962                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   963                 24  FILLER                PIC X.
   964         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   965             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   966                 24  FILLER                PIC X(11).
   967                 24  AM-L-COMA-SV          PIC XXX.
   968                 24  AM-J-COMA-SV          PIC XXX.
   969                 24  AM-A-COMA-SV          PIC XXX.
   970                 24  FILLER                PIC X(6).
   971
   972     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   973         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   974            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   975            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   976            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   977
   978     12  AM-ORIG-DEALER-NO                 PIC X(10).
   979     12  FILLER                            PIC X(120).
   980
   981     12  AM-ACCOUNT-EXECUTIVE-DATA.
   982         16  AM-CONTROL-NAME               PIC X(30).
   983         16  AM-EXECUTIVE-ONE.
   984             20  AM-EXEC1-NAME             PIC X(15).
   985             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   986                                                          COMP-3.
   987             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   988                                                          COMP-3.
   989         16  AM-EXECUTIVE-TWO.
   990             20  AM-EXEC2-NAME             PIC X(15).
   991             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   992                                                          COMP-3.
   993             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   994                                                          COMP-3.
   995
   996     12  AM-RETRO-ADDITIONAL-DATA.
   997         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   998         16  AM-RETRO-PREM-P-E             PIC X.
   999         16  AM-RETRO-CLMS-P-I             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  19
* WSMESS02.cbl
  1000         16  AM-RETRO-RET-BRACKET-LF.
  1001             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1002                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1003                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1004             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1005                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1006                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1007             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1008                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1009                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1010         16  AM-RETRO-RET-BRACKET-AH.
  1011             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1012                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1013                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1014                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1015             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1016                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1017                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1018             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1019                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1020                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1021
  1022     12  AM-COMMENTS.
  1023         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1024
  1025     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1026         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1027         16  AM-FLI-BILLING-CODE           PIC X.
  1028         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1029         16  AM-FLI-UNITED-IDENT           PIC X.
  1030         16  AM-FLI-INTEREST-LOST-DATA.
  1031             20  AM-FLI-BANK-NO            PIC X(5).
  1032             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1033             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1034             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1035         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1036             20  AM-FLI-AGT                PIC X(9).
  1037             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1038             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1039         16  FILLER                        PIC X(102).
  1040
  1041     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1042         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1043             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1044             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1045             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1046             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1047             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1048         16  FILLER                          PIC X(10).
  1049******************************************************************
  1050*                                 COPY ELCCERT.
  1051******************************************************************
  1052*                                                                *
  1053*                            ELCCERT.                            *
  1054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1055*                            VMOD=2.013                          *
  1056*                                                                *
  1057*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  20
* WSMESS02.cbl
  1058*                                                                *
  1059*   FILE TYPE = VSAM,KSDS                                        *
  1060*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1061*                                                                *
  1062*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1063*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1064*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1065*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1066*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1067*                                                                *
  1068*   LOG = YES                                                    *
  1069*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1070******************************************************************
  1071*                   C H A N G E   L O G
  1072*
  1073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1074*-----------------------------------------------------------------
  1075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1076* EFFECTIVE    NUMBER
  1077*-----------------------------------------------------------------
  1078* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1079* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1080* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1081* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1082* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1083* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1084* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1085* 032612  CR2011110200001  PEMA  AHL CHANGES
  1086* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1087* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1088******************************************************************
  1089
  1090 01  CERTIFICATE-MASTER.
  1091     12  CM-RECORD-ID                      PIC XX.
  1092         88  VALID-CM-ID                      VALUE 'CM'.
  1093
  1094     12  CM-CONTROL-PRIMARY.
  1095         16  CM-COMPANY-CD                 PIC X.
  1096         16  CM-CARRIER                    PIC X.
  1097         16  CM-GROUPING.
  1098             20  CM-GROUPING-PREFIX        PIC X(3).
  1099             20  CM-GROUPING-PRIME         PIC X(3).
  1100         16  CM-STATE                      PIC XX.
  1101         16  CM-ACCOUNT.
  1102             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1103             20  CM-ACCOUNT-PRIME          PIC X(6).
  1104         16  CM-CERT-EFF-DT                PIC XX.
  1105         16  CM-CERT-NO.
  1106             20  CM-CERT-PRIME             PIC X(10).
  1107             20  CM-CERT-SFX               PIC X.
  1108
  1109     12  CM-CONTROL-BY-NAME.
  1110         16  CM-COMPANY-CD-A1              PIC X.
  1111         16  CM-INSURED-LAST-NAME          PIC X(15).
  1112         16  CM-INSURED-INITIALS.
  1113             20  CM-INSURED-INITIAL1       PIC X.
  1114             20  CM-INSURED-INITIAL2       PIC X.
  1115
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  21
* WSMESS02.cbl
  1116     12  CM-CONTROL-BY-SSN.
  1117         16  CM-COMPANY-CD-A2              PIC X.
  1118         16  CM-SOC-SEC-NO.
  1119             20  CM-SSN-STATE              PIC XX.
  1120             20  CM-SSN-ACCOUNT            PIC X(6).
  1121             20  CM-SSN-LN3.
  1122                 25  CM-INSURED-INITIALS-A2.
  1123                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1124                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1125                 25 CM-PART-LAST-NAME-A2         PIC X.
  1126
  1127     12  CM-CONTROL-BY-CERT-NO.
  1128         16  CM-COMPANY-CD-A4              PIC X.
  1129         16  CM-CERT-NO-A4                 PIC X(11).
  1130
  1131     12  CM-CONTROL-BY-MEMB.
  1132         16  CM-COMPANY-CD-A5              PIC X.
  1133         16  CM-MEMBER-NO.
  1134             20  CM-MEMB-STATE             PIC XX.
  1135             20  CM-MEMB-ACCOUNT           PIC X(6).
  1136             20  CM-MEMB-LN4.
  1137                 25  CM-INSURED-INITIALS-A5.
  1138                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1139                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1140                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1141
  1142     12  CM-INSURED-PROFILE-DATA.
  1143         16  CM-INSURED-FIRST-NAME.
  1144             20  CM-INSURED-1ST-INIT       PIC X.
  1145             20  FILLER                    PIC X(9).
  1146         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1147         16  CM-INSURED-SEX                PIC X.
  1148             88  CM-SEX-MALE                  VALUE 'M'.
  1149             88  CM-SEX-FEMAL                 VALUE 'F'.
  1150         16  CM-INSURED-JOINT-AGE          PIC 99.
  1151         16  CM-JOINT-INSURED-NAME.
  1152             20  CM-JT-LAST-NAME           PIC X(15).
  1153             20  CM-JT-FIRST-NAME.
  1154                 24  CM-JT-1ST-INIT        PIC X.
  1155                 24  FILLER                PIC X(9).
  1156             20  CM-JT-INITIAL             PIC X.
  1157
  1158     12  CM-LIFE-DATA.
  1159         16  CM-LF-BENEFIT-CD              PIC XX.
  1160         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1161         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1162         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1163         16  CM-LF-DEV-CODE                PIC XXX.
  1164         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1165         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1166         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1167         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1168         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1169         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1170         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1171         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1172         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1173         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  22
* WSMESS02.cbl
  1174         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1175         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1176         16  cm-temp-epiq                  pic xx.
  1177             88  EPIQ-CLASS                  value 'EQ'.
  1178*        16  FILLER                        PIC XX.
  1179
  1180     12  CM-AH-DATA.
  1181         16  CM-AH-BENEFIT-CD              PIC XX.
  1182         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1183         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1184         16  CM-AH-DEV-CODE                PIC XXX.
  1185         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1186         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1187         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1188         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1189         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1190         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1191         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1192         16  CM-AH-PAID-THRU-DT            PIC XX.
  1193             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1194         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1195         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1196         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1197         16  FILLER                        PIC X.
  1198
  1199     12  CM-LOAN-INFORMATION.
  1200         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1201         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1202                                           PIC S9(5)V99  COMP-3.
  1203         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1204         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1205         16  CM-PAY-FREQUENCY              PIC S99.
  1206         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1207         16  CM-RATE-CLASS                 PIC XX.
  1208         16  CM-BENEFICIARY                PIC X(25).
  1209         16  CM-POLICY-FORM-NO             PIC X(12).
  1210         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1211         16  CM-LAST-ADD-ON-DT             PIC XX.
  1212         16  CM-DEDUCTIBLE-AMOUNTS.
  1213             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1214             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1215         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1216             20  CM-RESIDENT-STATE         PIC XX.
  1217             20  CM-RATE-CODE              PIC X(4).
  1218             20  FILLER                    PIC XX.
  1219         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1220             20  CM-LOAN-OFFICER           PIC X(5).
  1221             20  FILLER                    PIC XXX.
  1222         16  CM-CSR-CODE                   PIC XXX.
  1223         16  CM-UNDERWRITING-CODE          PIC X.
  1224             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1225         16  CM-POST-CARD-IND              PIC X.
  1226         16  CM-NH-INTERFACE-SW            PIC X.
  1227         16  CM-PREMIUM-TYPE               PIC X.
  1228             88  CM-SING-PRM                  VALUE '1'.
  1229             88  CM-O-B-COVERAGE              VALUE '2'.
  1230             88  CM-OPEN-END                  VALUE '3'.
  1231         16  CM-IND-GRP-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  23
* WSMESS02.cbl
  1232             88  CM-INDIVIDUAL                VALUE 'I'.
  1233             88  CM-GROUP                     VALUE 'G'.
  1234         16  CM-SKIP-CODE                  PIC X.
  1235             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1236             88  SKIP-JULY                    VALUE '1'.
  1237             88  SKIP-AUGUST                  VALUE '2'.
  1238             88  SKIP-SEPTEMBER               VALUE '3'.
  1239             88  SKIP-JULY-AUG                VALUE '4'.
  1240             88  SKIP-AUG-SEPT                VALUE '5'.
  1241             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1242             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1243             88  SKIP-JUNE                    VALUE '8'.
  1244             88  SKIP-JUNE-JULY               VALUE '9'.
  1245             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1246             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1247         16  CM-PAYMENT-MODE               PIC X.
  1248             88  PAY-MONTHLY                  VALUE SPACE.
  1249             88  PAY-WEEKLY                   VALUE '1'.
  1250             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1251             88  PAY-BI-WEEKLY                VALUE '3'.
  1252             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1253         16  CM-LOAN-NUMBER                PIC X(8).
  1254         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1255         16  CM-OLD-LOF                    PIC XXX.
  1256*        16  CM-LOAN-OFFICER               PIC XXX.
  1257         16  CM-REIN-TABLE                 PIC XXX.
  1258         16  CM-SPECIAL-REIN-CODE          PIC X.
  1259         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1260         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1261         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1262
  1263     12  CM-STATUS-DATA.
  1264         16  CM-ENTRY-STATUS               PIC X.
  1265         16  CM-ENTRY-DT                   PIC XX.
  1266
  1267         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1268         16  CM-LF-CANCEL-DT               PIC XX.
  1269         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1270
  1271         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1272         16  CM-LF-DEATH-DT                PIC XX.
  1273         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1274
  1275         16  CM-LF-CURRENT-STATUS          PIC X.
  1276             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1277                                                'M' '4' '5' '9'.
  1278             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1279             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1280             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1281             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1282             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1283             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1284             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1285             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1286             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1287             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1288             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1289             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  24
* WSMESS02.cbl
  1290             88  CM-LF-VOIDED                 VALUE 'V'.
  1291
  1292         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1293         16  CM-AH-CANCEL-DT               PIC XX.
  1294         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1295
  1296         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1297         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1298         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1299
  1300         16  CM-AH-CURRENT-STATUS          PIC X.
  1301             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1302                                                'M' '4' '5' '9'.
  1303             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1304             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1305             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1306             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1307             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1308             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1309             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1310             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1311             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1312             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1313             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1314             88  CM-AH-DECLINED               VALUE 'D'.
  1315             88  CM-AH-VOIDED                 VALUE 'V'.
  1316
  1317         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1318             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1319             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1320             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1321         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1322
  1323         16  CM-ENTRY-BATCH                PIC X(6).
  1324         16  CM-LF-EXIT-BATCH              PIC X(6).
  1325         16  CM-AH-EXIT-BATCH              PIC X(6).
  1326         16  CM-LAST-MONTH-END             PIC XX.
  1327
  1328     12  CM-NOTE-SW                        PIC X.
  1329         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1330         88  CERT-NOTES-PRESENT               VALUE '1'.
  1331         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1332         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1333         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1334         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1335         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1336         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1337     12  CM-COMP-EXCP-SW                   PIC X.
  1338         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1339         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1340     12  CM-INSURED-ADDRESS-SW             PIC X.
  1341         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1342         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1343
  1344*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1345     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1346     12  FILLER                            PIC X.
  1347
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  25
* WSMESS02.cbl
  1348*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1349     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1350     12  FILLER                            PIC X.
  1351*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1352     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1353
  1354     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1355         88  CERT-ADDED-BATCH                 VALUE ' '.
  1356         88  CERT-ADDED-ONLINE                VALUE '1'.
  1357         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1358         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1359         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1360     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1361         88  CERT-AS-LOADED                   VALUE ' '.
  1362         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1363         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1364         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1365         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1366         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1367         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1368         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1369
  1370     12  CM-ACCOUNT-COMM-PCTS.
  1371         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1372         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1373
  1374     12  CM-USER-FIELD                     PIC X.
  1375     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1376     12  CM-CLP-STATE                      PIC XX.
  1377     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1378     12  CM-USER-RESERVED                  PIC XXX.
  1379     12  FILLER REDEFINES CM-USER-RESERVED.
  1380         16  CM-AH-CLASS-CD                PIC XX.
  1381         16  F                             PIC X.
  1382******************************************************************
  1383*                                 COPY ELCCRTT.
  1384******************************************************************
  1385*                                                                *
  1386*                            ELCCRTT.                            *
  1387*                                                                *
  1388*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1389*                                                                *
  1390*   FILE TYPE = VSAM,KSDS                                        *
  1391*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1392*                                                                *
  1393*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1394*                                                                *
  1395*   LOG = YES                                                    *
  1396*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1397******************************************************************
  1398*                   C H A N G E   L O G
  1399*
  1400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1401*-----------------------------------------------------------------
  1402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1403* EFFECTIVE    NUMBER
  1404*-----------------------------------------------------------------
  1405* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  26
* WSMESS02.cbl
  1406* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1407* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1408* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1409* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1410* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1411* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1412* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1413* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1414******************************************************************
  1415
  1416 01  CERTIFICATE-TRAILERS.
  1417     12  CS-RECORD-ID                      PIC XX.
  1418         88  VALID-CS-ID                      VALUE 'CS'.
  1419
  1420     12  CS-CONTROL-PRIMARY.
  1421         16  CS-COMPANY-CD                 PIC X.
  1422         16  CS-CARRIER                    PIC X.
  1423         16  CS-GROUPING                   PIC X(6).
  1424         16  CS-STATE                      PIC XX.
  1425         16  CS-ACCOUNT                    PIC X(10).
  1426         16  CS-CERT-EFF-DT                PIC XX.
  1427         16  CS-CERT-NO.
  1428             20  CS-CERT-PRIME             PIC X(10).
  1429             20  CS-CERT-SFX               PIC X.
  1430         16  CS-TRAILER-TYPE               PIC X.
  1431             88  COMM-TRLR           VALUE 'A'.
  1432             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1433             88  CERT-DATA-TRLR      VALUE 'C'.
  1434
  1435     12  CS-DATA-AREA                      PIC X(516).
  1436
  1437     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1438         16  CS-BANK-COMMISSION-AREA.
  1439             20  CS-BANK-COMMS       OCCURS 10.
  1440                 24  CS-AGT                PIC X(10).
  1441                 24  CS-COM-TYP            PIC X.
  1442                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1443                 24  CS-RECALC-LV-INDIC    PIC X.
  1444                 24  FILLER                PIC X(10).
  1445         16  FILLER                        PIC X(256).
  1446
  1447     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1448****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1449         16  CS-MB-CLAIM-DATA OCCURS 24.
  1450             20  CS-CLAIM-NO               PIC X(7).
  1451             20  CS-CLAIM-TYPE             PIC X.
  1452                 88  CS-AH-CLM               VALUE 'A'.
  1453                 88  CS-IU-CLM               VALUE 'I'.
  1454                 88  CS-GP-CLM               VALUE 'G'.
  1455                 88  CS-LF-CLM               VALUE 'L'.
  1456                 88  CS-PR-CLM               VALUE 'P'.
  1457                 88  CS-FL-CLM               VALUE 'F'.
  1458             20  CS-INSURED-TYPE           PIC X.
  1459                 88  CS-PRIM-INSURED          VALUE 'P'.
  1460                 88  CS-CO-BORROWER           VALUE 'C'.
  1461             20  CS-BENEFIT-PERIOD         PIC 99.
  1462             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1463             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  27
* WSMESS02.cbl
  1464             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1465         16  FILLER                        PIC X(12).
  1466     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1467         16  CS-VIN-NUMBER                 PIC X(17).
  1468         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1469         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1470         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1471         16  cs-agent-name.
  1472             20  cs-agent-fname            pic x(20).
  1473             20  cs-agent-mi               pic x.
  1474             20  cs-agent-lname            pic x(25).
  1475         16  cs-license-no                 pic x(15).
  1476         16  cs-npn-number                 pic x(10).
  1477         16  cs-agent-edit-status          pic x.
  1478             88  cs-ae-refer-to-manager      value 'M'.
  1479             88  cs-ae-cover-sheet           value 'C'.
  1480             88  cs-ae-sig-form              value 'S'.
  1481             88  cs-ae-verified              value 'V'.
  1482             88  cs-unidentified-signature   value 'U'.
  1483             88  cs-cert-returned            value 'R'.
  1484             88  cs-accept-no-commission     value 'N'.
  1485         16  cs-year                       pic 9999.
  1486         16  cs-make                       pic x(20).
  1487         16  cs-model                      pic x(20).
  1488         16  cs-future                     pic x(20).
  1489         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1490         16  FILLER                        PIC X(356). *> was 420
  1491*        16  FILLER                        PIC X(496).
  1492*                                 COPY ELCCNTL.
  1493******************************************************************
  1494*                                                                *
  1495*                                                                *
  1496*                            ELCCNTL.                            *
  1497*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1498*                            VMOD=2.059                          *
  1499*                                                                *
  1500*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1501*                                                                *
  1502*   FILE TYPE = VSAM,KSDS                                        *
  1503*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1504*                                                                *
  1505*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1506*       ALTERNATE INDEX = NONE                                   *
  1507*                                                                *
  1508*   LOG = YES                                                    *
  1509*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1510******************************************************************
  1511*                   C H A N G E   L O G
  1512*
  1513* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1514*-----------------------------------------------------------------
  1515*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1516* EFFECTIVE    NUMBER
  1517*-----------------------------------------------------------------
  1518* 082503                   PEMA  ADD BENEFIT GROUP
  1519* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1520* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1521* 092705    2005050300006  PEMA  ADD SPP LEASES
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  28
* WSMESS02.cbl
  1522* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1523* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1524* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1525* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1526* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1527* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1528* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1529* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1530* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1531* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1532******************************************************************
  1533*
  1534 01  CONTROL-FILE.
  1535     12  CF-RECORD-ID                       PIC XX.
  1536         88  VALID-CF-ID                        VALUE 'CF'.
  1537
  1538     12  CF-CONTROL-PRIMARY.
  1539         16  CF-COMPANY-ID                  PIC XXX.
  1540         16  CF-RECORD-TYPE                 PIC X.
  1541             88  CF-COMPANY-MASTER              VALUE '1'.
  1542             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1543             88  CF-STATE-MASTER                VALUE '3'.
  1544             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1545             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1546             88  CF-CARRIER-MASTER              VALUE '6'.
  1547             88  CF-MORTALITY-MASTER            VALUE '7'.
  1548             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1549             88  CF-TERMINAL-MASTER             VALUE '9'.
  1550             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1551             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1552             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1553             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1554             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1555             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1556             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1557             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1558             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1559         16  CF-ACCESS-CD-GENL              PIC X(4).
  1560         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1561             20  CF-PROCESSOR               PIC X(4).
  1562         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1563             20  CF-STATE-CODE              PIC XX.
  1564             20  FILLER                     PIC XX.
  1565         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1566             20  FILLER                     PIC XX.
  1567             20  CF-HI-BEN-IN-REC           PIC XX.
  1568         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1569             20  FILLER                     PIC XXX.
  1570             20  CF-CARRIER-CNTL            PIC X.
  1571         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1572             20  FILLER                     PIC XX.
  1573             20  CF-HI-TYPE-IN-REC          PIC 99.
  1574         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1575             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1576                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1577             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1578             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1579         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  29
* WSMESS02.cbl
  1580             20  FILLER                     PIC X.
  1581             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1582         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1583             20  FILLER                     PIC XX.
  1584             20  CF-MORTGAGE-PLAN           PIC XX.
  1585         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1586
  1587     12  CF-LAST-MAINT-DT                   PIC XX.
  1588     12  CF-LAST-MAINT-BY                   PIC X(4).
  1589     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1590
  1591     12  CF-RECORD-BODY                     PIC X(728).
  1592
  1593
  1594****************************************************************
  1595*             COMPANY MASTER RECORD                            *
  1596****************************************************************
  1597
  1598     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1599         16  CF-COMPANY-ADDRESS.
  1600             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1601             20  CF-CL-IN-CARE-OF           PIC X(30).
  1602             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1603             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1604             20  CF-CL-CITY-STATE           PIC X(30).
  1605             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1606             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1607         16  CF-COMPANY-CD                  PIC X.
  1608         16  CF-COMPANY-PASSWORD            PIC X(8).
  1609         16  CF-SECURITY-OPTION             PIC X.
  1610             88  ALL-SECURITY                   VALUE '1'.
  1611             88  COMPANY-VERIFY                 VALUE '2'.
  1612             88  PROCESSOR-VERIFY               VALUE '3'.
  1613             88  NO-SECURITY                    VALUE '4'.
  1614             88  ALL-BUT-TERM                   VALUE '5'.
  1615         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1616             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1617         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1618             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1619         16  CF-INFORCE-LOCATION            PIC X.
  1620             88  CERTS-ARE-ONLINE               VALUE '1'.
  1621             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1622             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1623         16  CF-LOWER-CASE-LETTERS          PIC X.
  1624         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1625             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1626             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1627             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1628             88  CF-ACCNT-CNTL                  VALUE '3'.
  1629             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1630
  1631         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1632         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1633
  1634         16  CF-LGX-CREDIT-USER             PIC X.
  1635             88  CO-IS-NOT-USER                 VALUE 'N'.
  1636             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1637
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  30
* WSMESS02.cbl
  1638         16 CF-CREDIT-CALC-CODES.
  1639             20  CF-CR-REM-TERM-CALC PIC X.
  1640               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1641               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1642               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1643               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1644               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1645               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1646               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1647             20  CF-CR-R78-METHOD           PIC X.
  1648               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1649               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1650
  1651         16  CF-CLAIM-CONTROL-COUNTS.
  1652             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1653                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1654
  1655             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1656                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1657
  1658             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1659                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1660
  1661             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1662                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1663
  1664         16  CF-CURRENT-MONTH-END           PIC XX.
  1665
  1666         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1667             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1668             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1669             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1670             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1671                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1672                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1673             20  CF-CO-PREM-REJECT-SW       PIC X.
  1674                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1675                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1676             20  CF-CO-REF-REJECT-SW        PIC X.
  1677                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1678                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1679
  1680         16  CF-CO-REPORTING-DT             PIC XX.
  1681         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1682         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1683           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1684           88  CF-CO-MONTH-END                  VALUE '1'.
  1685
  1686         16  CF-LGX-CLAIM-USER              PIC X.
  1687             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1688             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1689
  1690         16  CF-CREDIT-EDIT-CONTROLS.
  1691             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1692             20  CF-MIN-AGE                 PIC 99.
  1693             20  CF-DEFAULT-AGE             PIC 99.
  1694             20  CF-MIN-TERM                PIC S999      COMP-3.
  1695             20  CF-MAX-TERM                PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  31
* WSMESS02.cbl
  1696             20  CF-DEFAULT-SEX             PIC X.
  1697             20  CF-JOINT-AGE-INPUT         PIC X.
  1698                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1699             20  CF-BIRTH-DATE-INPUT        PIC X.
  1700                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1701             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1702                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1703                 88  CF-ZERO-CARRIER            VALUE '1'.
  1704                 88  CF-ZERO-GROUPING           VALUE '2'.
  1705                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1706             20  CF-EDIT-SW                 PIC X.
  1707                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1708             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1709             20  CF-CR-PR-METHOD            PIC X.
  1710               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1711               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1712             20  FILLER                     PIC X.
  1713
  1714         16  CF-CREDIT-MISC-CONTROLS.
  1715             20  CF-REIN-TABLE-SW           PIC X.
  1716                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1717             20  CF-COMP-TABLE-SW           PIC X.
  1718                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1719             20  CF-EXPERIENCE-RETENTION-AGE
  1720                                            PIC S9        COMP-3.
  1721             20  CF-CONVERSION-DT           PIC XX.
  1722             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1723             20  CF-RUN-FREQUENCY-SW        PIC X.
  1724                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1725                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1726
  1727             20  CF-CR-CHECK-NO-CONTROL.
  1728                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1729                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1730                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1731                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1732                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1733                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1734
  1735                 24  CF-CR-CHECK-COUNT       REDEFINES
  1736                     CF-CR-CHECK-COUNTER      PIC X(4).
  1737
  1738                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1739                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1740
  1741                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1742                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1743                 24  CF-MAIL-PROCESSING       PIC X.
  1744                     88  MAIL-PROCESSING          VALUE 'Y'.
  1745
  1746         16  CF-MISC-SYSTEM-CONTROL.
  1747             20  CF-SYSTEM-C                 PIC X.
  1748                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1749             20  CF-SYSTEM-D                 PIC X.
  1750                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1751             20  CF-SOC-SEC-NO-SW            PIC X.
  1752                 88  SOC-SEC-NO-USED             VALUE '1'.
  1753             20  CF-MEMBER-NO-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  32
* WSMESS02.cbl
  1754                 88  MEMBER-NO-USED              VALUE '1'.
  1755             20  CF-TAX-ID-NUMBER            PIC X(11).
  1756             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1757             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1758                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1759                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1760                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1761                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1762             20  CF-SYSTEM-E                 PIC X.
  1763                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1764
  1765         16  CF-LGX-LIFE-USER               PIC X.
  1766             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1767             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1768
  1769         16  CF-CR-MONTH-END-DT             PIC XX.
  1770
  1771         16  CF-FILE-MAINT-DATES.
  1772             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1773                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1774             20  CF-LAST-BATCH       REDEFINES
  1775                 CF-LAST-BATCH-NO               PIC X(4).
  1776             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1777             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1778             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1779             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1780             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1781             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1782             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1783             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1784             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1785             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1786
  1787         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1788         16  FILLER                         PIC X.
  1789
  1790         16  CF-ALT-MORT-CODE               PIC X(4).
  1791         16  CF-MEMBER-CAPTION              PIC X(10).
  1792
  1793         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1794             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1795             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1796             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1797             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1798             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1799
  1800         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1801
  1802         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1803         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1804         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1805         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1806
  1807         16  CF-AH-OVERRIDE-L1              PIC X.
  1808         16  CF-AH-OVERRIDE-L2              PIC XX.
  1809         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1810         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1811
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  33
* WSMESS02.cbl
  1812         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1813         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1814
  1815         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1816         16  CF-AR-LAST-EL860-DT            PIC XX.
  1817         16  CF-MP-MONTH-END-DT             PIC XX.
  1818
  1819         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1820         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1821             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1822
  1823         16  CF-AR-MONTH-END-DT             PIC XX.
  1824
  1825         16  CF-CRDTCRD-USER                PIC X.
  1826             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1827             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1828
  1829         16  CF-CC-MONTH-END-DT             PIC XX.
  1830
  1831         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1832
  1833         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1834             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1835             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1836             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1837         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1838         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1839         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1840         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1841             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1842             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1843         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1844         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1845         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1846             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1847         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1848
  1849         16  CF-CL-ZIP-CODE.
  1850             20  CF-CL-ZIP-PRIME.
  1851                 24  CF-CL-ZIP-1ST          PIC X.
  1852                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1853                 24  FILLER                 PIC X(4).
  1854             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1855         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1856             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1857             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1858             20  FILLER                     PIC XXX.
  1859
  1860         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1861         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1862         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1863         16  CF-CO-OPTION-START-DATE        PIC XX.
  1864         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1865           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1866                                                      '3' '4'.
  1867           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1868           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1869           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  34
* WSMESS02.cbl
  1870           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1871           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1872           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1873
  1874         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1875
  1876         16  CF-PAYMENT-APPROVAL-LEVELS.
  1877             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1878             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1879             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1880             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1881             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1882             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1883
  1884         16  CF-END-USER-REPORTING-USER     PIC X.
  1885             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1886             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1887
  1888         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1889             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1890             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1891
  1892         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1893
  1894         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1895         16  FILLER                         PIC X.
  1896
  1897         16  CF-CREDIT-ARCHIVE-CNTL.
  1898             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1899             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1900             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1901
  1902         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1903
  1904         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1905             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1906             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1907
  1908         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1909             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1910             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1911
  1912         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1913
  1914         16  CF-CO-ACH-ID-CODE              PIC  X.
  1915             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1916             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1917             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1918         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1919         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1920         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1921         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1922         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1923         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1924         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1925         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1926         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1927                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  35
* WSMESS02.cbl
  1928         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1929                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1930
  1931         16  CF-CO-OVER-SHORT.
  1932             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1933             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1934
  1935*         16  FILLER                         PIC X(102).
  1936         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1937             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1938             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1939
  1940         16  CF-AH-APPROVAL-DAYS.
  1941             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1942             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1943             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1944             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1945
  1946         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1947
  1948         16  CF-APPROV-LEV-5.
  1949             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1950             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1951             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1952
  1953         16  FILLER                         PIC X(68).
  1954****************************************************************
  1955*             PROCESSOR/USER RECORD                            *
  1956****************************************************************
  1957
  1958     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1959         16  CF-PROCESSOR-NAME              PIC X(30).
  1960         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1961         16  CF-PROCESSOR-TITLE             PIC X(26).
  1962         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1963                 88  MESSAGE-YES                VALUE 'Y'.
  1964                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1965
  1966*****************************************************
  1967****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1968****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1969****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1970****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1971*****************************************************
  1972
  1973         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1974             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1975             20  CF-APPLICATION-FORCE       PIC X.
  1976             20  CF-INDIVIDUAL-APP.
  1977                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1978                     28  CF-BROWSE-APP      PIC X.
  1979                     28  CF-UPDATE-APP      PIC X.
  1980
  1981         16  CF-CURRENT-TERM-ON             PIC X(4).
  1982         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1983             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1984             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1985             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  36
* WSMESS02.cbl
  1986             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1987             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1988             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1989             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1990         16  CF-PROCESSOR-CARRIER           PIC X.
  1991             88  NO-CARRIER-SECURITY            VALUE ' '.
  1992         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1993             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1994         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1995             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1996         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1997             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1998
  1999         16  CF-PROC-SYS-ACCESS-SW.
  2000             20  CF-PROC-CREDIT-CLAIMS-SW.
  2001                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2002                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2003                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2004                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2005             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2006                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2007                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2008             20  CF-PROC-LIFE-GNRLDGR-SW.
  2009                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2010                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2011                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2012                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2013             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2014                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2015                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2016         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2017             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2018             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2019         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2020
  2021         16  CF-APPROVAL-LEVEL                  PIC X.
  2022             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2023             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2024             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2025             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2026             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2027
  2028         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2029
  2030         16  CF-LANGUAGE-TYPE                   PIC X.
  2031             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2032             88  CF-LANG-IS-FR                      VALUE 'F'.
  2033
  2034         16  CF-CSR-IND                         PIC X.
  2035         16  FILLER                             PIC X(239).
  2036
  2037****************************************************************
  2038*             PROCESSOR/REMINDERS RECORD                       *
  2039****************************************************************
  2040
  2041     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2042         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2043             20  CF-START-REMIND-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  37
* WSMESS02.cbl
  2044             20  CF-END-REMIND-DT           PIC XX.
  2045             20  CF-REMINDER-TEXT           PIC X(50).
  2046         16  FILLER                         PIC X(296).
  2047
  2048
  2049****************************************************************
  2050*             STATE MASTER RECORD                              *
  2051****************************************************************
  2052
  2053     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2054         16  CF-STATE-ABBREVIATION          PIC XX.
  2055         16  CF-STATE-NAME                  PIC X(25).
  2056         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2057         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2058             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2059             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2060             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2061             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2062                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2063                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2064             20  CF-ST-PREM-REJECT-SW       PIC X.
  2065                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2066                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2067             20  CF-ST-REF-REJECT-SW        PIC X.
  2068                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2069                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2070         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2071         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2072         16  CF-ST-REFUND-RULES.
  2073             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2074             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2075             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2076         16  CF-ST-FST-PMT-EXTENSION.
  2077             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2078             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2079                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2080                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2081                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2082                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2083         16  CF-ST-STATE-CALL.
  2084             20  CF-ST-CALL-UNEARNED        PIC X.
  2085             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2086             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2087         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2088             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2089             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2090         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2091         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2092         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2093         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2094         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2095         16  FILLER                         PIC X.
  2096         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2097             20  CF-ST-BENEFIT-CD           PIC XX.
  2098             20  CF-ST-BENEFIT-KIND         PIC X.
  2099                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2100                 88  CF-ST-AH-KIND              VALUE 'A'.
  2101             20  CF-ST-REM-TERM-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  38
* WSMESS02.cbl
  2102                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2103                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2104                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2105                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2106                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2107                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2108                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2109                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2110
  2111             20  CF-ST-REFUND-CALC          PIC X.
  2112                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2113                 88  ST-REFD-BY-R78             VALUE '1'.
  2114                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2115                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2116                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2117                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2118                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2119                 88  ST-REFD-UTAH               VALUE '7'.
  2120                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2121                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2122                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2123
  2124             20  CF-ST-EARNING-CALC         PIC X.
  2125                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2126                 88  ST-EARN-BY-R78             VALUE '1'.
  2127                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2128                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2129                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2130                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2131                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2132                 88  ST-EARN-MEAN               VALUE '8'.
  2133                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2134
  2135             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2136                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2137                 88  ST-OVRD-BY-R78             VALUE '1'.
  2138                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2139                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2140                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2141                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2142                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2143                 88  ST-OVRD-MEAN               VALUE '8'.
  2144                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2145             20  cf-st-extra-periods        pic 9.
  2146*            20  FILLER                     PIC X.
  2147
  2148         16  CF-ST-COMMISSION-CAPS.
  2149             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2150             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2151             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2152             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2153         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2154                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2155
  2156         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2157
  2158         16  CF-ST-STATUTORY-INTEREST.
  2159             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  39
* WSMESS02.cbl
  2160                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2161                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2162             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2163             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2164             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2165             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2166             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2167
  2168         16  CF-ST-OVER-SHORT.
  2169             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2170             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2171
  2172         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2173
  2174         16  CF-ST-RT-CALC                  PIC X.
  2175
  2176         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2177         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2178         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2179         16  CF-ST-RF-LR-CALC               PIC X.
  2180         16  CF-ST-RF-LL-CALC               PIC X.
  2181         16  CF-ST-RF-LN-CALC               PIC X.
  2182         16  CF-ST-RF-AH-CALC               PIC X.
  2183         16  CF-ST-RF-CP-CALC               PIC X.
  2184*        16  FILLER                         PIC X(206).
  2185*CIDMOD         16  FILLER                         PIC X(192).
  2186         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2187             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2188         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2189         16  CF-ST-VFY-2ND-BENE             PIC X.
  2190         16  CF-ST-CAUSAL-STATE             PIC X.
  2191         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2192         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2193         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2194             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2195         16  CF-ST-NET-ONLY-STATE           PIC X.
  2196             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2197         16  FILLER                         PIC X(181).
  2198
  2199****************************************************************
  2200*             BENEFIT MASTER RECORD                            *
  2201****************************************************************
  2202
  2203     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2204         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2205             20  CF-BENEFIT-CODE            PIC XX.
  2206             20  CF-BENEFIT-NUMERIC  REDEFINES
  2207                 CF-BENEFIT-CODE            PIC XX.
  2208             20  CF-BENEFIT-ALPHA           PIC XXX.
  2209             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2210             20  CF-BENEFIT-COMMENT         PIC X(10).
  2211
  2212             20  CF-LF-COVERAGE-TYPE        PIC X.
  2213                 88  CF-REDUCING                VALUE 'R'.
  2214                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2215
  2216             20  CF-SPECIAL-CALC-CD         PIC X.
  2217                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  40
* WSMESS02.cbl
  2218                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2219                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2220                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2221                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2222                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2223                 88  CF-FARM-PLAN               VALUE 'F'.
  2224                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2225                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2226                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2227                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2228                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2229                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2230                 88  CF-PRUDENTIAL              VALUE 'P'.
  2231                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2232                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2233                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2234                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2235                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2236                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2237
  2238             20  CF-JOINT-INDICATOR         PIC X.
  2239                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2240
  2241*            20  FILLER                     PIC X(12).
  2242             20  cf-maximum-benefits        pic s999 comp-3.
  2243             20  FILLER                     PIC X(09).
  2244             20  CF-BENEFIT-CATEGORY        PIC X.
  2245             20  CF-LOAN-TYPE               PIC X(8).
  2246
  2247             20  CF-CO-REM-TERM-CALC        PIC X.
  2248                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2249                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2250                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2251                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2252                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2253
  2254             20  CF-CO-EARNINGS-CALC        PIC X.
  2255                 88  CO-EARN-BY-R78             VALUE '1'.
  2256                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2257                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2258                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2259                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2260                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2261                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2262                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2263
  2264             20  CF-CO-REFUND-CALC          PIC X.
  2265                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2266                 88  CO-REFD-BY-R78             VALUE '1'.
  2267                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2268                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2269                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2270                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2271                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2272                 88  CO-REFD-MEAN               VALUE '8'.
  2273                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2274                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2275                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  41
* WSMESS02.cbl
  2276
  2277             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2278                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2279                 88  CO-OVRD-BY-R78             VALUE '1'.
  2280                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2281                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2282                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2283                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2284                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2285                 88  CO-OVRD-MEAN               VALUE '8'.
  2286                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2287
  2288             20  CF-CO-BEN-I-G-CD           PIC X.
  2289                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2290                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2291                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2292
  2293         16  FILLER                         PIC X(304).
  2294
  2295
  2296****************************************************************
  2297*             CARRIER MASTER RECORD                            *
  2298****************************************************************
  2299
  2300     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2301         16  CF-ADDRESS-DATA.
  2302             20  CF-MAIL-TO-NAME            PIC X(30).
  2303             20  CF-IN-CARE-OF              PIC X(30).
  2304             20  CF-ADDRESS-LINE-1          PIC X(30).
  2305             20  CF-ADDRESS-LINE-2          PIC X(30).
  2306             20  CF-CITY-STATE              PIC X(30).
  2307             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2308             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2309
  2310         16  CF-CLAIM-NO-CONTROL.
  2311             20  CF-CLAIM-NO-METHOD         PIC X.
  2312                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2313                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2314                 88  CLAIM-NO-SEQ               VALUE '3'.
  2315                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2316             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2317                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2318                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2319                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2320
  2321         16  CF-CHECK-NO-CONTROL.
  2322             20  CF-CHECK-NO-METHOD         PIC X.
  2323                 88  CHECK-NO-MANUAL            VALUE '1'.
  2324                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2325                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2326                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2327             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2328                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2329
  2330         16  CF-DOMICILE-STATE              PIC XX.
  2331
  2332         16  CF-EXPENSE-CONTROLS.
  2333             20  CF-EXPENSE-METHOD          PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  42
* WSMESS02.cbl
  2334                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2335                 88  DOLLARS-PER-PMT            VALUE '2'.
  2336                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2337                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2338             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2339             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2340
  2341         16  CF-CORRESPONDENCE-CONTROL.
  2342             20  CF-LETTER-RESEND-OPT       PIC X.
  2343                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2344                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2345             20  FILLER                     PIC X(4).
  2346
  2347         16  CF-RESERVE-CONTROLS.
  2348             20  CF-MANUAL-SW               PIC X.
  2349                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2350             20  CF-FUTURE-SW               PIC X.
  2351                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2352             20  CF-PTC-SW                  PIC X.
  2353                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2354             20  CF-IBNR-SW                 PIC X.
  2355                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2356             20  CF-PTC-LF-SW               PIC X.
  2357                 88  CF-LF-PTC-USED             VALUE '1'.
  2358             20  CF-CDT-ACCESS-METHOD       PIC X.
  2359                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2360                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2361                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2362             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2363
  2364         16  CF-CLAIM-CALC-METHOD           PIC X.
  2365             88  360-PLUS-MONTHS                VALUE '1'.
  2366             88  365-PLUS-MONTHS                VALUE '2'.
  2367             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2368             88  360-DAILY                      VALUE '4'.
  2369             88  365-DAILY                      VALUE '5'.
  2370
  2371         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2372         16  FILLER                         PIC X(11).
  2373
  2374         16  CF-LIMIT-AMOUNTS.
  2375             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2376             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2377             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2378             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2379             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2380             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2381             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2382             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2383             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2384             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2385
  2386         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2387         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2388         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2389
  2390         16  CF-ZIP-CODE.
  2391             20  CF-ZIP-PRIME.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  43
* WSMESS02.cbl
  2392                 24  CF-ZIP-1ST             PIC X.
  2393                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2394                 24  FILLER                 PIC X(4).
  2395             20  CF-ZIP-PLUS4               PIC X(4).
  2396         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2397             20  CF-CAN-POSTAL-1            PIC XXX.
  2398             20  CF-CAN-POSTAL-2            PIC XXX.
  2399             20  FILLER                     PIC XXX.
  2400
  2401         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2402         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2403         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2404
  2405         16  CF-RATING-SWITCH               PIC X.
  2406             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2407             88  CF-NO-RATING                   VALUE 'N'.
  2408
  2409         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2410
  2411         16  CF-CARRIER-OVER-SHORT.
  2412             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2413             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2414
  2415         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2416         16  CF-SECPAY-SWITCH               PIC X.
  2417             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2418             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2419         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2420         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2421         16  FILLER                         PIC X(444).
  2422*        16  FILLER                         PIC X(452).
  2423
  2424
  2425****************************************************************
  2426*             MORTALITY MASTER RECORD                          *
  2427****************************************************************
  2428
  2429     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2430         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2431                                INDEXED BY CF-MORT-NDX.
  2432             20  CF-MORT-TABLE              PIC X(5).
  2433             20  CF-MORT-TABLE-TYPE         PIC X.
  2434                 88  CF-MORT-JOINT              VALUE 'J'.
  2435                 88  CF-MORT-SINGLE             VALUE 'S'.
  2436                 88  CF-MORT-COMBINED           VALUE 'C'.
  2437                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2438                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2439             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2440             20  CF-MORT-AGE-METHOD         PIC XX.
  2441                 88  CF-AGE-LAST                VALUE 'AL'.
  2442                 88  CF-AGE-NEAR                VALUE 'AN'.
  2443             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2444             20  CF-MORT-ADJUSTMENT-DIRECTION
  2445                                            PIC X.
  2446                 88  CF-MINUS                   VALUE '-'.
  2447                 88  CF-PLUS                    VALUE '+'.
  2448             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2449             20  CF-MORT-JOINT-CODE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  44
* WSMESS02.cbl
  2450                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2451             20  CF-MORT-PC-Q               PIC X.
  2452                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2453             20  CF-MORT-TABLE-CODE         PIC X(4).
  2454             20  CF-MORT-COMMENTS           PIC X(15).
  2455             20  FILLER                     PIC X(14).
  2456
  2457         16  FILLER                         PIC X(251).
  2458
  2459
  2460****************************************************************
  2461*             BUSSINESS TYPE MASTER RECORD                     *
  2462****************************************************************
  2463
  2464     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2465* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2466* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2467* AND RECORD 05 IS TYPES 81-99
  2468         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2469             20  CF-BUSINESS-TITLE          PIC  X(19).
  2470             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2471                                            PIC S9V9(4) COMP-3.
  2472             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2473             20  FILLER                     PIC  X.
  2474         16  FILLER                         PIC  X(248).
  2475
  2476
  2477****************************************************************
  2478*             TERMINAL MASTER RECORD                           *
  2479****************************************************************
  2480
  2481     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2482
  2483         16  CF-COMPANY-TERMINALS.
  2484             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2485                                  PIC X(4).
  2486         16  FILLER               PIC X(248).
  2487
  2488
  2489****************************************************************
  2490*             LIFE EDIT MASTER RECORD                          *
  2491****************************************************************
  2492
  2493     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2494         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2495             20  CF-LIFE-CODE-IN            PIC XX.
  2496             20  CF-LIFE-CODE-OUT           PIC XX.
  2497         16  FILLER                         PIC X(248).
  2498
  2499
  2500****************************************************************
  2501*             AH EDIT MASTER RECORD                            *
  2502****************************************************************
  2503
  2504     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2505         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2506             20  CF-AH-CODE-IN              PIC XXX.
  2507             20  CF-AH-CODE-OUT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  45
* WSMESS02.cbl
  2508         16  FILLER                         PIC X(248).
  2509
  2510
  2511****************************************************************
  2512*             CREDIBILITY TABLES                               *
  2513****************************************************************
  2514
  2515     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2516         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2517                             INDEXED BY CF-CRDB-NDX.
  2518             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2519             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2520             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2521         16  FILLER                         PIC  X(332).
  2522
  2523
  2524****************************************************************
  2525*             REPORT CUSTOMIZATION RECORD                      *
  2526****************************************************************
  2527
  2528     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2529         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2530             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2531             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2532             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2533**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2534****       A T-TRANSFER.                                   ****
  2535             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2536
  2537         16  FILLER                         PIC XX.
  2538
  2539         16  CF-CARRIER-CNTL-OPT.
  2540             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2541                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2542                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2543             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2544                                            PIC X.
  2545         16  CF-GROUP-CNTL-OPT.
  2546             20  CF-GROUP-OPT-SEQ           PIC 9.
  2547                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2548                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2549             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2550                                            PIC X(6).
  2551         16  CF-STATE-CNTL-OPT.
  2552             20  CF-STATE-OPT-SEQ           PIC 9.
  2553                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2554                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2555             20  CF-STATE-SELECT OCCURS 3 TIMES
  2556                                            PIC XX.
  2557         16  CF-ACCOUNT-CNTL-OPT.
  2558             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2559                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2560                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2561             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2562                                            PIC X(10).
  2563         16  CF-BUS-TYP-CNTL-OPT.
  2564             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2565                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  46
* WSMESS02.cbl
  2566                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2567             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2568                                            PIC XX.
  2569         16  CF-LF-TYP-CNTL-OPT.
  2570             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2571                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2572                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2573             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2574                                            PIC XX.
  2575         16  CF-AH-TYP-CNTL-OPT.
  2576             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2577                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2578                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2579             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2580                                            PIC XX.
  2581         16  CF-REPTCD1-CNTL-OPT.
  2582             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2583                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2584                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2585             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2586                                            PIC X(10).
  2587         16  CF-REPTCD2-CNTL-OPT.
  2588             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2589                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2590                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2591             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2592                                            PIC X(10).
  2593         16  CF-USER1-CNTL-OPT.
  2594             20  CF-USER1-OPT-SEQ           PIC 9.
  2595                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2596                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2597             20  CF-USER1-SELECT OCCURS 3 TIMES
  2598                                            PIC X(10).
  2599         16  CF-USER2-CNTL-OPT.
  2600             20  CF-USER2-OPT-SEQ           PIC 9.
  2601                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2602                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2603             20  CF-USER2-SELECT OCCURS 3 TIMES
  2604                                            PIC X(10).
  2605         16  CF-USER3-CNTL-OPT.
  2606             20  CF-USER3-OPT-SEQ           PIC 9.
  2607                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2608                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2609             20  CF-USER3-SELECT OCCURS 3 TIMES
  2610                                            PIC X(10).
  2611         16  CF-USER4-CNTL-OPT.
  2612             20  CF-USER4-OPT-SEQ           PIC 9.
  2613                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2614                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2615             20  CF-USER4-SELECT OCCURS 3 TIMES
  2616                                            PIC X(10).
  2617         16  CF-USER5-CNTL-OPT.
  2618             20  CF-USER5-OPT-SEQ           PIC 9.
  2619                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2620                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2621             20  CF-USER5-SELECT OCCURS 3 TIMES
  2622                                            PIC X(10).
  2623         16  CF-REINS-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  47
* WSMESS02.cbl
  2624             20  CF-REINS-OPT-SEQ           PIC 9.
  2625                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2626                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2627             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2628                 24  CF-REINS-PRIME         PIC XXX.
  2629                 24  CF-REINS-SUB           PIC XXX.
  2630
  2631         16  CF-AGENT-CNTL-OPT.
  2632             20  CF-AGENT-OPT-SEQ           PIC 9.
  2633                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2634                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2635             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2636                                            PIC X(10).
  2637
  2638         16  FILLER                         PIC X(43).
  2639
  2640         16  CF-LOSS-RATIO-SELECT.
  2641             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2642             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2643         16  CF-ENTRY-DATE-SELECT.
  2644             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2645             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2646         16  CF-EFFECTIVE-DATE-SELECT.
  2647             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2648             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2649
  2650         16  CF-EXCEPTION-LIST-IND          PIC X.
  2651             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2652
  2653         16  FILLER                         PIC X(318).
  2654
  2655****************************************************************
  2656*                  EXCEPTION REPORTING RECORD                  *
  2657****************************************************************
  2658
  2659     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2660         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2661             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2662
  2663         16  CF-COMBINED-LIFE-AH-OPT.
  2664             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2665             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2666             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2667             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2668
  2669         16  CF-LIFE-OPT.
  2670             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2671             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2672             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2673             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2674             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2675             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2676             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2677             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2678             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2679             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2680
  2681         16  CF-AH-OPT.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  48
* WSMESS02.cbl
  2682             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2683             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2684             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2685             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2686             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2687             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2688             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2689             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2690             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2691             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2692
  2693         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2694             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2695             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2696             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2697
  2698         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2699
  2700         16  FILLER                         PIC X(673).
  2701
  2702
  2703****************************************************************
  2704*             MORTGAGE SYSTEM PLAN RECORD                      *
  2705****************************************************************
  2706
  2707     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2708         16  CF-PLAN-TYPE                   PIC X.
  2709             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2710             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2711             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2712         16  CF-PLAN-ABBREV                 PIC XXX.
  2713         16  CF-PLAN-DESCRIPT               PIC X(10).
  2714         16  CF-PLAN-NOTES                  PIC X(20).
  2715         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2716         16  CF-PLAN-UNDERWRITING.
  2717             20  CF-PLAN-TERM-DATA.
  2718                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2719                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2720             20  CF-PLAN-AGE-DATA.
  2721                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2722                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2723                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2724             20  CF-PLAN-BENEFIT-DATA.
  2725                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2726                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2727                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2728                                            PIC S9(7)V99  COMP-3.
  2729         16  CF-PLAN-POLICY-FORMS.
  2730             20  CF-POLICY-FORM             PIC X(12).
  2731             20  CF-MASTER-APPLICATION      PIC X(12).
  2732             20  CF-MASTER-POLICY           PIC X(12).
  2733         16  CF-PLAN-RATING.
  2734             20  CF-RATE-CODE               PIC X(5).
  2735             20  CF-SEX-RATING              PIC X.
  2736                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2737                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2738             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2739             20  CF-SUB-STD-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  49
* WSMESS02.cbl
  2740                 88  CF-PCT-OF-PREM            VALUE '1'.
  2741                 88  CF-PCT-OF-BENE            VALUE '2'.
  2742         16  CF-PLAN-PREM-TOLERANCES.
  2743             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2744             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2745         16  CF-PLAN-PYMT-TOLERANCES.
  2746             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2747             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2748         16  CF-PLAN-MISC-DATA.
  2749             20  FILLER                     PIC X.
  2750             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2751             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2752         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2753         16  CF-PLAN-IND-GRP                PIC X.
  2754             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2755                                                     '1'.
  2756             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2757                                                     '2'.
  2758         16  CF-MIB-SEARCH-SW               PIC X.
  2759             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2760             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2761             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2762             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2763         16  CF-ALPHA-SEARCH-SW             PIC X.
  2764             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2765             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2766             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2767             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2768             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2769             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2770             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2771             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2772             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2773             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2774                                                     'A' 'B' 'C'
  2775                                                     'X' 'Y' 'Z'.
  2776         16  CF-EFF-DT-RULE-SW              PIC X.
  2777             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2778             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2779             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2780             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2781             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2782         16  FILLER                         PIC X(4).
  2783         16  CF-HEALTH-QUESTIONS            PIC X.
  2784             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2785         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2786         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2787         16  CF-PLAN-SNGL-JNT               PIC X.
  2788             88  CF-COMBINED-PLAN              VALUE 'C'.
  2789             88  CF-JNT-PLAN                   VALUE 'J'.
  2790             88  CF-SNGL-PLAN                  VALUE 'S'.
  2791         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2792         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2793         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2794         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2795         16  CF-RERATE-CNTL                 PIC  X.
  2796             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2797             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  50
* WSMESS02.cbl
  2798             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2799             88  CF-AUTO-RECALC                 VALUE '4'.
  2800         16  CF-BENEFIT-TYPE                PIC  X.
  2801             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2802             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2803         16  CF-POLICY-FEE                  PIC S999V99
  2804                                                    COMP-3.
  2805         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2806         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2807         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2808         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2809         16  FILLER                         PIC  X(32).
  2810         16  CF-TERMINATION-FORM            PIC  X(04).
  2811         16  FILLER                         PIC  X(08).
  2812         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2813                                                       COMP-3.
  2814         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2815         16  CF-ISSUE-LETTER                PIC  X(4).
  2816         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2817         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2818             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2819             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2820         16  CF-MP-REFUND-CALC              PIC X.
  2821             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2822             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2823             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2824             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2825             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2826             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2827             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2828             88  CF-MP-REFD-MEAN                VALUE '8'.
  2829         16  CF-ALT-RATE-CODE               PIC  X(5).
  2830
  2831
  2832         16  FILLER                         PIC X(498).
  2833****************************************************************
  2834*             MORTGAGE COMPANY MASTER RECORD                   *
  2835****************************************************************
  2836
  2837     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2838         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2839         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2840             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2841             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2842             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2843             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2844             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2845
  2846         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2847         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2848         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2849         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2850         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2851
  2852         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2853             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2854         16  CF-MP-RECON-USE-IND            PIC X(1).
  2855             88  CF-MP-USE-RECON             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  51
* WSMESS02.cbl
  2856         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2857             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2858         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2859             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2860             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2861         16  FILLER                         PIC X(1).
  2862         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2863             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2864         16  CF-MORTG-MIB-VERSION           PIC X.
  2865             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2866             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2867             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2868         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2869             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2870                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2871             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2872                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2873             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2874                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2875             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2876                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2877             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2878                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2879             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2880                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2881         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2882         16  FILLER                         PIC X(7).
  2883         16  CF-MORTG-DESTINATION-SYMBOL.
  2884             20  CF-MORTG-MIB-COMM          PIC X(5).
  2885             20  CF-MORTG-MIB-TERM          PIC X(5).
  2886         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2887             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2888         16  FILLER                         PIC X(03).
  2889         16  CF-MP-CHECK-NO-CONTROL.
  2890             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2891                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2892                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2893                                                ' ' LOW-VALUES.
  2894                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2895                                               VALUE '3'.
  2896         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2897         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2898         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2899             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2900                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2901             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2902                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2903             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2904                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2905             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2906                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2907             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2908                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2909             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2910                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2911         16  CF-MORTG-BILLING-AREA.
  2912             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2913                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  52
* WSMESS02.cbl
  2914         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2915         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2916         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2917         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2918             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2919             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2920         16  FILLER                         PIC X.
  2921         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2922             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2923             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2924         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2925         16  FILLER                         PIC X(8).
  2926         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2927         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2928         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2929         16  CF-ACH-COMPANY-ID.
  2930             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2931                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2932                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2933                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2934             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2935         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2936             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2937         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2938             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2939             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2940         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2941         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2942         16  FILLER                         PIC X(536).
  2943
  2944****************************************************************
  2945*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2946****************************************************************
  2947
  2948     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2949         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2950             20  CF-FEMALE-HEIGHT.
  2951                 24  CF-FEMALE-FT           PIC 99.
  2952                 24  CF-FEMALE-IN           PIC 99.
  2953             20  CF-FEMALE-MIN-WT           PIC 999.
  2954             20  CF-FEMALE-MAX-WT           PIC 999.
  2955         16  FILLER                         PIC X(428).
  2956
  2957     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2958         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2959             20  CF-MALE-HEIGHT.
  2960                 24  CF-MALE-FT             PIC 99.
  2961                 24  CF-MALE-IN             PIC 99.
  2962             20  CF-MALE-MIN-WT             PIC 999.
  2963             20  CF-MALE-MAX-WT             PIC 999.
  2964         16  FILLER                         PIC X(428).
  2965******************************************************************
  2966*             AUTOMATIC ACTIVITY RECORD                          *
  2967******************************************************************
  2968     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2969         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2970             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2971             20  CF-SYS-LETTER-ID           PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  53
* WSMESS02.cbl
  2972             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2973             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2974             20  CF-SYS-RESET-SW            PIC X(01).
  2975             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2976             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2977
  2978         16  FILLER                         PIC X(50).
  2979
  2980         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2981             20  CF-USER-ACTIVE-SW          PIC X(01).
  2982             20  CF-USER-LETTER-ID          PIC X(04).
  2983             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2984             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2985             20  CF-USER-RESET-SW           PIC X(01).
  2986             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2987             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2988             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2989
  2990         16  FILLER                         PIC X(246).
  2991*                                 COPY ELCFUNDT.
  2992*****************************************************************
  2993*                                                               *
  2994*                            ELCFUNDT.                          *
  2995*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
  2996*                            VMOD=2.001                         *
  2997*                                                               *
  2998*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
  2999*                                                               *
  3000*****************************************************************
  3001
  3002
  3003 01  FUNCTION-DATE.
  3004     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
  3005     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
  3006         10  WS-FN-CCYR            PIC 9(4).
  3007         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
  3008             15  WS-FN-CC          PIC 99.
  3009             15  WS-FN-YR          PIC 99.
  3010         10  WS-FN-MO              PIC 99.
  3011         10  WS-FN-DA              PIC 99.
  3012     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
  3013     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
  3014     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
  3015     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
  3016     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
  3017         88  WS-BEHIND-GMT                     VALUE '-'.
  3018         88  WS-AFTER-GMT                      VALUE '+'.
  3019         88  WS-NO-GMT                         VALUE ZERO.
  3020     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
  3021     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
  3022*                                 COPY ELCDATE.
  3023******************************************************************
  3024*                                                                *
  3025*                                                                *
  3026*                            ELCDATE.                            *
  3027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3028*                            VMOD=2.003
  3029*                                                                *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  54
* WSMESS02.cbl
  3030*                                                                *
  3031*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3032*                 LENGTH = 200                                   *
  3033******************************************************************
  3034
  3035 01  DATE-CONVERSION-DATA.
  3036     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3037     12  DC-OPTION-CODE                PIC X.
  3038         88  BIN-TO-GREG                VALUE ' '.
  3039         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3040         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3041         88  YMD-GREG-TO-BIN            VALUE '3'.
  3042         88  MDY-GREG-TO-BIN            VALUE '4'.
  3043         88  JULIAN-TO-BIN              VALUE '5'.
  3044         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3045         88  FIND-CENTURY               VALUE '7'.
  3046         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3047         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3048         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3049         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3050         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3051         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3052         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3053         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3054         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3055         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3056         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3057         88  BIN-3-TO-GREG              VALUE 'I'.
  3058         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3059         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3060         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3061         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3062         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3063         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3064         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3065         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3066         88  THREE-CHARACTER-BIN
  3067                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3068         88  GREGORIAN-TO-BIN
  3069                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3070         88  BIN-TO-GREGORIAN
  3071                  VALUES ' ' '1' 'I' '8' 'G'.
  3072         88  JULIAN-TO-BINARY
  3073                  VALUES '5' 'C' 'E' 'F'.
  3074     12  DC-ERROR-CODE                 PIC X.
  3075         88  NO-CONVERSION-ERROR        VALUE ' '.
  3076         88  DATE-CONVERSION-ERROR
  3077                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3078         88  DATE-IS-ZERO               VALUE '1'.
  3079         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3080         88  DATE-IS-INVALID            VALUE '3'.
  3081         88  DATE1-GREATER-DATE2        VALUE '4'.
  3082         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3083         88  DATE-INVALID-OPTION        VALUE '9'.
  3084         88  INVALID-CENTURY            VALUE 'A'.
  3085         88  ONLY-CENTURY               VALUE 'B'.
  3086         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3087         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  55
* WSMESS02.cbl
  3088     12  DC-END-OF-MONTH               PIC X.
  3089         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3090     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3091         88  USE-NORMAL-PROCESS         VALUE ' '.
  3092         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3093         88  ADJUST-UP-100-YRS          VALUE '2'.
  3094     12  FILLER                        PIC X.
  3095     12  DC-CONVERSION-DATES.
  3096         16  DC-BIN-DATE-1             PIC XX.
  3097         16  DC-BIN-DATE-2             PIC XX.
  3098         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3099         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3100                       DC-GREG-DATE-1-EDIT.
  3101             20  DC-EDIT1-MONTH        PIC 99.
  3102             20  SLASH1-1              PIC X.
  3103             20  DC-EDIT1-DAY          PIC 99.
  3104             20  SLASH1-2              PIC X.
  3105             20  DC-EDIT1-YEAR         PIC 99.
  3106         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3107         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3108                     DC-GREG-DATE-2-EDIT.
  3109             20  DC-EDIT2-MONTH        PIC 99.
  3110             20  SLASH2-1              PIC X.
  3111             20  DC-EDIT2-DAY          PIC 99.
  3112             20  SLASH2-2              PIC X.
  3113             20  DC-EDIT2-YEAR         PIC 99.
  3114         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3115         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3116                     DC-GREG-DATE-1-YMD.
  3117             20  DC-YMD-YEAR           PIC 99.
  3118             20  DC-YMD-MONTH          PIC 99.
  3119             20  DC-YMD-DAY            PIC 99.
  3120         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3121         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3122                      DC-GREG-DATE-1-MDY.
  3123             20  DC-MDY-MONTH          PIC 99.
  3124             20  DC-MDY-DAY            PIC 99.
  3125             20  DC-MDY-YEAR           PIC 99.
  3126         16  DC-GREG-DATE-1-ALPHA.
  3127             20  DC-ALPHA-MONTH        PIC X(10).
  3128             20  DC-ALPHA-DAY          PIC 99.
  3129             20  FILLER                PIC XX.
  3130             20  DC-ALPHA-CENTURY.
  3131                 24 DC-ALPHA-CEN-N     PIC 99.
  3132             20  DC-ALPHA-YEAR         PIC 99.
  3133         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3134         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3135         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3136         16  DC-JULIAN-DATE            PIC 9(05).
  3137         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3138                                       PIC 9(05).
  3139         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3140             20  DC-JULIAN-YEAR        PIC 99.
  3141             20  DC-JULIAN-DAYS        PIC 999.
  3142         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3143         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3144         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3145     12  DATE-CONVERSION-VARIBLES.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  56
* WSMESS02.cbl
  3146         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3147         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3148             20  FILLER                PIC 9(3).
  3149             20  HOLD-CEN-1-CCYY.
  3150                 24  HOLD-CEN-1-CC     PIC 99.
  3151                 24  HOLD-CEN-1-YY     PIC 99.
  3152             20  HOLD-CEN-1-MO         PIC 99.
  3153             20  HOLD-CEN-1-DA         PIC 99.
  3154         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3155             20  HOLD-CEN-1-R-MO       PIC 99.
  3156             20  HOLD-CEN-1-R-DA       PIC 99.
  3157             20  HOLD-CEN-1-R-CCYY.
  3158                 24  HOLD-CEN-1-R-CC   PIC 99.
  3159                 24  HOLD-CEN-1-R-YY   PIC 99.
  3160             20  FILLER                PIC 9(3).
  3161         16  HOLD-CENTURY-1-X.
  3162             20  FILLER                PIC X(3)  VALUE SPACES.
  3163             20  HOLD-CEN-1-X-CCYY.
  3164                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3165                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3166             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3167             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3168         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3169             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3170             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3171             20  HOLD-CEN-1-R-X-CCYY.
  3172                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3173                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3174             20  FILLER                PIC XXX.
  3175         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3176         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3177         16  DC-JULIAN-DATE-1          PIC 9(07).
  3178         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3179             20  DC-JULIAN-1-CCYY.
  3180                 24  DC-JULIAN-1-CC    PIC 99.
  3181                 24  DC-JULIAN-1-YR    PIC 99.
  3182             20  DC-JULIAN-DA-1        PIC 999.
  3183         16  DC-JULIAN-DATE-2          PIC 9(07).
  3184         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3185             20  DC-JULIAN-2-CCYY.
  3186                 24  DC-JULIAN-2-CC    PIC 99.
  3187                 24  DC-JULIAN-2-YR    PIC 99.
  3188             20  DC-JULIAN-DA-2        PIC 999.
  3189         16  DC-GREG-DATE-A-EDIT.
  3190             20  DC-EDITA-MONTH        PIC 99.
  3191             20  SLASHA-1              PIC X VALUE '/'.
  3192             20  DC-EDITA-DAY          PIC 99.
  3193             20  SLASHA-2              PIC X VALUE '/'.
  3194             20  DC-EDITA-CCYY.
  3195                 24  DC-EDITA-CENT     PIC 99.
  3196                 24  DC-EDITA-YEAR     PIC 99.
  3197         16  DC-GREG-DATE-B-EDIT.
  3198             20  DC-EDITB-MONTH        PIC 99.
  3199             20  SLASHB-1              PIC X VALUE '/'.
  3200             20  DC-EDITB-DAY          PIC 99.
  3201             20  SLASHB-2              PIC X VALUE '/'.
  3202             20  DC-EDITB-CCYY.
  3203                 24  DC-EDITB-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  57
* WSMESS02.cbl
  3204                 24  DC-EDITB-YEAR     PIC 99.
  3205         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3206         16  DC-GREG-DATE-CYMD-R REDEFINES
  3207                              DC-GREG-DATE-CYMD.
  3208             20  DC-CYMD-CEN           PIC 99.
  3209             20  DC-CYMD-YEAR          PIC 99.
  3210             20  DC-CYMD-MONTH         PIC 99.
  3211             20  DC-CYMD-DAY           PIC 99.
  3212         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3213         16  DC-GREG-DATE-MDCY-R REDEFINES
  3214                              DC-GREG-DATE-MDCY.
  3215             20  DC-MDCY-MONTH         PIC 99.
  3216             20  DC-MDCY-DAY           PIC 99.
  3217             20  DC-MDCY-CEN           PIC 99.
  3218             20  DC-MDCY-YEAR          PIC 99.
  3219    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3220        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3221    12  DC-EL310-DATE                  PIC X(21).
  3222    12  FILLER                         PIC X(28).
  3223*                                 COPY ELCCALC.
  3224******************************************************************
  3225*                                                                *
  3226*                           ELCCALC.                            *
  3227*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3228*                            VMOD=2.025                          *
  3229*                                                                *
  3230*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3231*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3232*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3233*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3234*                                                                *
  3235*  PASSED TO ELRTRM                                              *
  3236*  -----------------                                             *
  3237*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3238*  ORIGINAL TERM                                                 *
  3239*  BEGINNING DATE                                                *
  3240*  ENDING DATE                                                   *
  3241*  COMPANY I.D.                                                  *
  3242*  ACCOUNT MASTER USER FIELD                                     *
  3243*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3244*  FREE LOOK DAYS                                                *
  3245*                                                                *
  3246*  RETURNED FROM ELRTRM                                          *
  3247*  ---------------------                                         *
  3248*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3249*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3250*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3251*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3252*----------------------------------------------------------------*
  3253*  PASSED TO ELRAMT                                              *
  3254*  ----------------                                              *
  3255*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3256*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3257*  ORIGINAL AMOUNT                                               *
  3258*  ALTERNATE BENEFIT (BALLON)                                    *
  3259*  A.P.R. - NET PAY ONLY                                         *
  3260*  METHOD
  3261*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  58
* WSMESS02.cbl
  3262*  COMPANY I.D.                                                  *
  3263*  BENEFIT TYPE                                                  *
  3264*                                                                *
  3265*  RETURNED FROM ELRAMT                                          *
  3266*  --------------------                                          *
  3267*  REMAINING AMOUNT 1 - CURRENT                                  *
  3268*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3269*  REMAINING AMOUNT FACTOR
  3270*----------------------------------------------------------------*
  3271*  PASSED TO ELRESV                                              *
  3272*  -----------------                                             *
  3273*  CERTIFICATE EFFECTIVE DATE                                    *
  3274*  VALUATION DATE                                                *
  3275*  PAID THRU DATE                                                *
  3276*  BENEFIT                                                       *
  3277*  INCURRED DATE                                                 *
  3278*  REPORTED DATE                                                 *
  3279*  ISSUE AGE                                                     *
  3280*  TERM                                                          *
  3281*  CDT PERCENT                                                   *
  3282*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3283* *CLAIM TYPE (LIFE, A/H)                                        *
  3284* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3285* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3286*                                                                *
  3287*  RETURNED FROM ELRESV                                          *
  3288*  --------------------                                          *
  3289*  CDT TABLE USED                                                *
  3290*  CDT FACTOR USED                                               *
  3291*  PAY TO CURRENT RESERVE                                        *
  3292*  I.B.N.R. - A/H ONLY                                           *
  3293*  FUTURE (ACCRUED) AH ONLY                                      *
  3294*----------------------------------------------------------------*
  3295*  PASSED TO ELRATE                                              *
  3296*  ----------------                                              *
  3297*  CERT ISSUE DATE                                               *
  3298*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3299*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3300*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3301*  STATE CODE (CLIENT DEFINED)                                   *
  3302*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3303*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3304*  DEVIATION CODE                                                *
  3305*  ISSUE AGE                                                     *
  3306*  ORIGINAL BENEFIT AMOUNT                                       *
  3307*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3308*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3309*  BENEFIT KIND (LIFE OR A/H)                                    *
  3310*  A.P.R.                                                        *
  3311*  METHOD
  3312*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3313*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3314*  COMPANY I.D. (3 CHARACTER)                                    *
  3315*  BENEFIT CODE                                                  *
  3316*  BENEFIT OVERRIDE CODE                                         *
  3317*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3318*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3319*  JOINT INDICATOR (CSL ONLY)                                    *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  59
* WSMESS02.cbl
  3320*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3321*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3322*                                                                *
  3323*  RETURNED FROM ELRATE                                          *
  3324*  --------------------                                          *
  3325*  CALCULATED PREMIUM                                            *
  3326*  PREMIUM RATE                                                  *
  3327*  MORTALITY CODE                                                *
  3328*  MAX ATTAINED AGE                                              *
  3329*  MAX AGE                                                       *
  3330*  MAX TERM                                                      *
  3331*  MAX MONTHLY BENEFIT                                           *
  3332*  MAX TOTAL BENIFIT                                             *
  3333*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3334*----------------------------------------------------------------*
  3335*  PASSED TO ELRFND                                              *
  3336*  ----------------                                              *
  3337*  CERT ISSUE DATE                                               *
  3338*  REFUND DATE                                                   *
  3339*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3340*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3341*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3342*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3343*  STATE CODE (CLIENT DEFINED)                                   *
  3344*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3345*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3346*  DEVIATION CODE                                                *
  3347*  ISSUE AGE                                                     *
  3348*  ORIGINAL BENEFIT AMOUNT                                       *
  3349*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3350*  PROCESS TYPE (CANCEL)                                         *
  3351*  BENEFIT KIND (LIFE OR A/H)                                    *
  3352*  A.P.R.                                                        *
  3353*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3354*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3355*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3356*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3357*  COMPANY I.D. (3 CHARACTER)                                    *
  3358*  BENEFIT CODE                                                  *
  3359*  BENEFIT OVERRIDE CODE                                         *
  3360*                                                                *
  3361*  RETURNED FROM ELRFND                                          *
  3362*  --------------------                                          *
  3363*  CALCULATED REFUND                                             *
  3364*----------------------------------------------------------------*
  3365*  PASSED TO ELEARN                                              *
  3366*  ----------------                                              *
  3367*  CERT ISSUE DATE                                               *
  3368*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3369*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3370*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3371*  STATE CODE (CLIENT DEFINED)                                   *
  3372*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3373*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3374*  DEVIATION CODE                                                *
  3375*  ISSUE AGE                                                     *
  3376*  ORIGINAL BENEFIT AMOUNT                                       *
  3377*  BENEFIT KIND (LIFE OR A/H)                                    *
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  60
* WSMESS02.cbl
  3378*  A.P.R.                                                        *
  3379*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3380*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3381*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3382*  COMPANY I.D. (3 CHARACTER)                                    *
  3383*  BENEFIT CODE                                                  *
  3384*  BENEFIT OVERRIDE CODE                                         *
  3385*                                                                *
  3386*  RETURNED FROM ELEARN                                          *
  3387*  --------------------                                          *
  3388*  INDICATED  EARNINGS                                           *
  3389*----------------------------------------------------------------*
  3390*                 LENGTH = 450                                   *
  3391*                                                                *
  3392******************************************************************
  3393******************************************************************
  3394*                   C H A N G E   L O G
  3395*
  3396* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3397*-----------------------------------------------------------------
  3398*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3399* EFFECTIVE    NUMBER
  3400*-----------------------------------------------------------------
  3401* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3402* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3403* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3404* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3405* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3406* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3407* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3408* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3409* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3410* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3411* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3412******************************************************************
  3413
  3414 01  CALCULATION-PASS-AREA.
  3415     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3416                                     COMP.
  3417
  3418     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3419       88  NO-CP-ERROR                             VALUE ZERO.
  3420       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3421                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3422       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3423       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3424       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3425       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3426       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3427       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3428       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3429       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3430       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3431       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3432       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3433       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3434       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3435       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  61
* WSMESS02.cbl
  3436       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3437       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3438       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3439
  3440     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3441       88  NO-CP-ERROR-2                           VALUE ZERO.
  3442***********************  INPUT AREAS ****************************
  3443
  3444     12  CP-CALCULATION-AREA.
  3445         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3446         16  CP-CERT-EFF-DT        PIC XX.
  3447         16  CP-VALUATION-DT       PIC XX.
  3448         16  CP-PAID-THRU-DT       PIC XX.
  3449         16  CP-BENEFIT-TYPE       PIC X.
  3450           88  CP-AH                               VALUE 'A' 'D'
  3451                                                   'I' 'U'.
  3452           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3453           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3454         16  CP-INCURRED-DT        PIC XX.
  3455         16  CP-REPORTED-DT        PIC XX.
  3456         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3457         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3458         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3459                                     COMP-3.
  3460         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3461                                     COMP-3.
  3462         16  CP-CDT-METHOD         PIC X.
  3463           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3464           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3465           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3466         16  CP-CLAIM-TYPE         PIC X.
  3467           88  CP-AH-CLAIM                         VALUE 'A'.
  3468           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3469         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3470                                     COMP-3.
  3471         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3472                                     COMP-3.
  3473         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3474                                     COMP-3.
  3475         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3476                                     COMP-3.
  3477         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3478                                     COMP-3.
  3479         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3480                                     COMP-3.
  3481         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3482                                     COMP-3.
  3483         16  CP-REM-TERM-METHOD    PIC X.
  3484           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3485           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3486           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3487           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3488           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3489           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3490           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3491         16  CP-EARNING-METHOD     PIC X.
  3492           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3493           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  62
* WSMESS02.cbl
  3494           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3495           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3496           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3497           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3498           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3499           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3500           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3501           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3502           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3503           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3504           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3505           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3506         16  CP-PROCESS-TYPE       PIC X.
  3507           88  CP-CLAIM                            VALUE '1'.
  3508           88  CP-CANCEL                           VALUE '2'.
  3509           88  CP-ISSUE                            VALUE '3'.
  3510         16  CP-SPECIAL-CALC-CD    PIC X.
  3511           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3512           88  CP-1-MTH-INTEREST               VALUE ' '.
  3513           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3514           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3515           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3516           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3517           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3518           88  CP-FARM-PLAN                    VALUE 'F'.
  3519           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3520           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3521           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3522           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3523           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3524           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3525           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3526           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3527           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3528           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3529                                                     'W' 'X'.
  3530           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3531           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3532           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3533           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3534           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3535           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3536           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3537           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3538           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3539           88  CP-CSL-METH-1                   VALUE '5'.
  3540           88  CP-CSL-METH-2                   VALUE '6'.
  3541           88  CP-CSL-METH-3                   VALUE '7'.
  3542           88  CP-CSL-METH-4                   VALUE '8'.
  3543
  3544         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3547         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3548         16  CP-STATE              PIC XX          VALUE SPACE.
  3549         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3550         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3551           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  63
* WSMESS02.cbl
  3552               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3553         16  CP-R78-OPTION         PIC X.
  3554           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3555           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3556
  3557         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3558         16  CP-IBNR-RESERVE-SW    PIC X.
  3559         16  CP-CLAIM-STATUS       PIC X.
  3560         16  CP-RATE-FILE          PIC X.
  3561         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3562                                     COMP-3.
  3563
  3564         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3565         16  CP-AH-OVERRIDE-CODE   PIC X.
  3566
  3567         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3568                                     COMP-3.
  3569         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3570                                   PIC S9(5)V99 COMP-3.
  3571         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3572                                     COMP-3.
  3573         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3574                                     COMP-3.
  3575         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3576                                     COMP-3.
  3577         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3578                                  PIC S9(7)V99 COMP-3.
  3579
  3580         16  CP-PAID-FROM-DATE     PIC X(02).
  3581         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3582         16  CP-EXT-DAYS-CALC      PIC X.
  3583           88  CP-EXT-NO-CHG                   VALUE ' '.
  3584           88  CP-EXT-CHG-LF                   VALUE '1'.
  3585           88  CP-EXT-CHG-AH                   VALUE '2'.
  3586           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3587         16  CP-DOMICILE-STATE     PIC XX.
  3588         16  CP-CARRIER            PIC X.
  3589         16  CP-REIN-FLAG          PIC X.
  3590         16  CP-REM-TRM-CALC-OPTION PIC X.
  3591           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3592                      '2' '3' '4' '5'.
  3593           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3594           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3595           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3596           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3597           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3598           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3599           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3600           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3601         16  CP-SIG-SWITCH         PIC X.
  3602         16  CP-RATING-METHOD      PIC X.
  3603           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3604           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3605           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3606           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3607           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3608           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3609           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  64
* WSMESS02.cbl
  3610           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3611           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3612         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3613                                     COMP-3.
  3614         16  CP-BEN-CATEGORY       PIC X.
  3615         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3616         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3617                                   PIC S99V9(5) COMP-3.
  3618         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3619         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3620                                   PIC S99V9(5) COMP-3.
  3621         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3622         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3623         16  CP-EXPIRE-DT          PIC XX.
  3624         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3625         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3626         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3627         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3628         16  CP-DDF-SPEC-CALC      PIC X.
  3629             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3630             88  CP-CALC-CLP              VALUE 'C'.
  3631         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3632         16  CP-CANCEL-REASON      PIC X.
  3633         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3634         16  CP-PMT-MODE           PIC X.
  3635         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3636         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3637         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3638         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3639         16  FILLER                PIC X.
  3640
  3641***************    OUTPUT FROM ELRESV   ************************
  3642
  3643         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3644
  3645         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3648                                     COMP-3.
  3649         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3650                                     COMP-3.
  3651         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3652                                     COMP-3.
  3653         16  FILLER                PIC X(09).
  3654***************    OUTPUT FROM ELRTRM   *************************
  3655
  3656         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3657                                     COMP-3.
  3658         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3659                                     COMP-3.
  3660         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3663                                     COMP-3.
  3664         16  FILLER                PIC X(12).
  3665
  3666***************    OUTPUT FROM ELRAMT   *************************
  3667
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  65
* WSMESS02.cbl
  3668         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3669                                     COMP-3.
  3670         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  FILLER                PIC X(12).
  3673
  3674***************    OUTPUT FROM ELRATE   *************************
  3675
  3676         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3677                                     COMP-3.
  3678         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3679                                     COMP-3.
  3680         16  CP-MORTALITY-CODE     PIC X(4).
  3681         16  CP-RATE-EDIT-FLAG     PIC X.
  3682             88  CP-RATES-NEED-APR                  VALUE '1'.
  3683         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3684                                     COMP-3.
  3685         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3686         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3687         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3688                                   PIC S9(7)V99 COMP-3.
  3689         16  FILLER                PIC X(07).
  3690
  3691***************    OUTPUT FROM ELRFND   *************************
  3692
  3693         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-REFUND-TYPE-USED   PIC X.
  3696           88  CP-R-AS-R78                         VALUE '1'.
  3697           88  CP-R-AS-PRORATA                     VALUE '2'.
  3698           88  CP-R-AS-CALIF                       VALUE '3'.
  3699           88  CP-R-AS-TEXAS                       VALUE '4'.
  3700           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3701           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3702           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3703           88  CP-R-AS-MEAN                        VALUE '8'.
  3704           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3705           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3706           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3707           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3708           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3709           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3710         16  FILLER                PIC X(12).
  3711
  3712***************    OUTPUT FROM ELEARN   *************************
  3713
  3714         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3719                                     COMP-3.
  3720         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3721                                     COMP-3.
  3722         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3725                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  66
* WSMESS02.cbl
  3726         16  CP-EARNING-TYPE-USED  PIC X.
  3727           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3728           88  CP-E-AS-R78                         VALUE '1'.
  3729           88  CP-E-AS-PRORATA                     VALUE '2'.
  3730           88  CP-E-AS-TEXAS                       VALUE '4'.
  3731           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3732           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3733           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3734           88  CP-E-AS-MEAN                        VALUE '8'.
  3735           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3736         16  FILLER                PIC X(12).
  3737
  3738***************    OUTPUT FROM ELPMNT   *************************
  3739
  3740         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3743                                     COMP-3.
  3744         16  FILLER                PIC X(12).
  3745
  3746***************   MISC WORK AREAS    *****************************
  3747         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3748                                     COMP-3.
  3749         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3750                                     COMP-3.
  3751         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3752                                     COMP-3.
  3753         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3754                                     COMP-3.
  3755         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3758                                     COMP-3.
  3759         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3760             88  OPEN-RATE-FILE                   VALUE 'O'.
  3761             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3762             88  IO-ERROR                         VALUE 'E'.
  3763
  3764         16  CP-FIRST-PAY-DATE     PIC XX.
  3765
  3766         16  CP-JOINT-INDICATOR    PIC X.
  3767
  3768         16  CP-RESERVE-REMAINING-TERM
  3769                                   PIC S9(4)V9    VALUE ZERO
  3770                                     COMP-3.
  3771
  3772         16  CP-INSURED-BIRTH-DT   PIC XX.
  3773
  3774         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3775                                     COMP-3.
  3776
  3777         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3778                                     COMP-3.
  3779
  3780         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3781                                     COMP-3.
  3782
  3783         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  67
* WSMESS02.cbl
  3784                                     COMP-3.
  3785
  3786         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3787                                     COMP-3.
  3788
  3789         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3790                                     COMP-3.
  3791
  3792         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3793                                     COMP-3.
  3794
  3795         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3796             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3797
  3798         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3799                                     COMP-3.
  3800         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3801                                     COMP-3.
  3802         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3803         16  cp-extra-periods      pic 9 value zeros.
  3804         16  cp-net-only-state     pic x value spaces.
  3805         16  FILLER                PIC X(13).
  3806******************************************************************
  3807****************************************************************
  3808*
  3809* Copyright (c) 2007-2013 Dell Inc.
  3810* All rights reserved.
  3811*
  3812****************************************************************
  3813 01  DFHEIV.
  3814   02  DFHEIV0               PIC X(35).
  3815   02  DFHEIV1               PIC X(08).
  3816   02  DFHEIV2               PIC X(08).
  3817   02  DFHEIV3               PIC X(08).
  3818   02  DFHEIV4               PIC X(06).
  3819   02  DFHEIV5               PIC X(04).
  3820   02  DFHEIV6               PIC X(04).
  3821   02  DFHEIV7               PIC X(02).
  3822   02  DFHEIV8               PIC X(02).
  3823   02  DFHEIV9               PIC X(01).
  3824   02  DFHEIV10              PIC S9(7) COMP-3.
  3825   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3826   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3827   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3828   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3829   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3830   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3831   02  DFHEIV17              PIC X(04).
  3832   02  DFHEIV18              PIC X(04).
  3833   02  DFHEIV19              PIC X(04).
  3834   02  DFHEIV20              USAGE IS POINTER.
  3835   02  DFHEIV21              USAGE IS POINTER.
  3836   02  DFHEIV22              USAGE IS POINTER.
  3837   02  DFHEIV23              USAGE IS POINTER.
  3838   02  DFHEIV24              USAGE IS POINTER.
  3839   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3840   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3841   02  DFHEIV27              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  68
* WSMESS02.cbl
  3842   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3843   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3844   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3845   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3846   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3847   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3848   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3849   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3850   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3851   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3852   02  FILLER                PIC X(02).
  3853   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3854   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3855   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3856   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3857   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3858   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3859   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3860 LINKAGE  SECTION.
  3861*****************************************************************
  3862*                                                               *
  3863* Copyright (c) 2007-2013 Dell Inc.                             *
  3864* All rights reserved.                                          *
  3865*                                                               *
  3866*****************************************************************
  3867 01  dfheiblk.
  3868     02  eibtime          pic s9(7) comp-3.
  3869     02  eibdate          pic s9(7) comp-3.
  3870     02  eibtrnid         pic x(4).
  3871     02  eibtaskn         pic s9(7) comp-3.
  3872     02  eibtrmid         pic x(4).
  3873     02  dfheigdi         pic s9(4) comp.
  3874     02  eibcposn         pic s9(4) comp.
  3875     02  eibcalen         pic s9(4) comp.
  3876     02  eibaid           pic x(1).
  3877     02  eibfiller1       pic x(1).
  3878     02  eibfn            pic x(2).
  3879     02  eibfiller2       pic x(2).
  3880     02  eibrcode         pic x(6).
  3881     02  eibfiller3       pic x(2).
  3882     02  eibds            pic x(8).
  3883     02  eibreqid         pic x(8).
  3884     02  eibrsrce         pic x(8).
  3885     02  eibsync          pic x(1).
  3886     02  eibfree          pic x(1).
  3887     02  eibrecv          pic x(1).
  3888     02  eibsend          pic x(1).
  3889     02  eibatt           pic x(1).
  3890     02  eibeoc           pic x(1).
  3891     02  eibfmh           pic x(1).
  3892     02  eibcompl         pic x(1).
  3893     02  eibsig           pic x(1).
  3894     02  eibconf          pic x(1).
  3895     02  eiberr           pic x(1).
  3896     02  eibrldbk         pic x(1).
  3897     02  eiberrcd         pic x(4).
  3898     02  eibsynrb         pic x(1).
  3899     02  eibnodat         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  69
* WSMESS02.cbl
  3900     02  eibfiller5       pic x(2).
  3901     02  eibresp          pic s9(8) comp.
  3902     02  eibresp2         pic s9(8) comp.
  3903     02  dfheigdj         pic s9(4) comp.
  3904     02  dfheigdk         pic s9(4) comp.
  3905 01  DFHCOMMAREA                 pic x(1024).
  3906 01  var  pic x(30).
  3907 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3908 0000-DFHEXIT SECTION.
  3909     MOVE '9#                    $   ' TO DFHEIV0.
  3910     MOVE 'WSMESS02' TO DFHEIV1.
  3911     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3912     display ' Entering program WSMESS02 '
  3913     move dfhcommarea            to ws-mess002-pass-area
  3914     perform 0000-init           thru 0000-exit
  3915     display ' mess002 area ' ws-mess002-pass-area
  3916     perform 0100-process-message
  3917                                 thru 0100-exit
  3918     display ' raw after unstring ' raw-message002-area
  3919*    move ' returning string goes here ' to ws-return-string
  3920     go to 0300-RETURN-CICS
  3921     .
  3922 0000-init.
  3923     move 'CID'                  to client-id
  3924     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3925     move ws-fn-cymd             to dc-greg-date-cymd
  3926     move 'L'                    to dc-option-code
  3927     perform 9700-date-link      thru 9700-exit
  3928     if no-conversion-error
  3929        move dc-bin-date-1       to ws-bin-current-dt
  3930     else
  3931        display ' error current dt invalid ' dc-error-code
  3932     end-if
  3933     display ' current date/time '
  3934        ws-fn-mo '/' ws-fn-da '/' ws-fn-ccyy ' - '
  3935           ws-fn-hours ':' ws-fn-minutes ':' ws-fn-seconds
  3936     set P to address of KIXSYS
  3937     CALL "getenv" using by value P returning var-ptr
  3938     if var-ptr = null then
  3939        display ' kixsys not set '
  3940     else
  3941        set address of var to var-ptr
  3942        move 0 to env-var-len
  3943        inspect var tallying env-var-len
  3944          for characters before X'00'
  3945        unstring var (1:env-var-len) delimited by '/'
  3946           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3947              WS-KIX-SYS
  3948        end-unstring
  3949     end-if
  3950     evaluate client-id
  3951        when 'DCC'
  3952           MOVE X'05'            TO WS-COMP-CD
  3953           MOVE 'DCC'            TO WS-COMP-ID
  3954        when 'CID'
  3955           MOVE X'04'            TO WS-COMP-CD
  3956           MOVE 'CID'            TO WS-COMP-ID
  3957        when 'AHL'
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  70
* WSMESS02.cbl
  3958           MOVE X'06'            TO WS-COMP-CD
  3959           MOVE 'AHL'            TO WS-COMP-ID
  3960        when other
  3961           move '0113;Invalid company id ' to ws-return-string
  3962           display ' Invalid company id ' client-id
  3963           go to 0300-RETURN-CICS
  3964     END-evaluate
  3965     .
  3966 0000-exit.
  3967     exit.
  3968 0020-edit-received.
  3969     if ws-rate-sin-jnt-lf = 'S' OR 'J'
  3970        continue
  3971     else
  3972        move 'S'                 to ws-rate-sin-jnt-lf
  3973     end-if
  3974     if ws-rate-sin-jnt-ah = 'S' OR 'J'
  3975        continue
  3976     else
  3977        move 'S'                 to ws-rate-sin-jnt-ah
  3978     end-if
  3979     if ws-rate-dismemberment = 'Y'
  3980        continue
  3981     else
  3982        move 'N'                 to ws-rate-dismemberment
  3983     end-if
  3984     if ws-rate-in-ah-ben-code = 'A'
  3985        if ws-rate-retro-elim = 'R' or 'E'
  3986           continue
  3987        else
  3988           move 'R'              to ws-rate-retro-elim
  3989        end-if
  3990     else
  3991        move spaces              to ws-rate-retro-elim
  3992     end-if
  3993**==============================================================**
  3994**                                                              **
  3995**  Validate passed effective date. Probably should add edits   **
  3996**                                                              **
  3997**==============================================================**
  3998     move ws-rate-eff-date (7:4) to ws-work-date (1:4)
  3999     move ws-rate-eff-date (1:2) to ws-work-date (5:2)
  4000     move ws-rate-eff-date (4:2) to ws-work-date (7:2)
  4001     move ws-work-date-num       to dc-greg-date-cymd
  4002     move 'L'                    to dc-option-code
  4003     perform 9700-date-link      thru 9700-exit
  4004     if no-conversion-error
  4005        move dc-bin-date-1       to ws-bin-eff-dt
  4006     else
  4007        move '0102;Problem with Eff Date' to ws-return-string
  4008        go to 0300-RETURN-CICS
  4009     end-if
  4010     if ws-bin-eff-dt > ws-bin-current-dt
  4011        move '0102;Future Effective Date' to ws-return-string
  4012        go to 0300-RETURN-CICS
  4013     end-if
  4014**==============================================================**
  4015**                                                              **
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  71
* WSMESS02.cbl
  4016**  Validate passed 1st pmt date.   Probably should add edits   **
  4017**                                                              **
  4018**==============================================================**
  4019     move ws-rate-1st-pmt-dt (7:4)
  4020                                 to ws-work-date (1:4)
  4021     move ws-rate-1st-pmt-dt (1:2)
  4022                                 to ws-work-date (5:2)
  4023     move ws-rate-1st-pmt-dt (4:2)
  4024                                 to ws-work-date (7:2)
  4025     move ws-work-date-num       to dc-greg-date-cymd
  4026     move 'L'                    to dc-option-code
  4027     perform 9700-date-link      thru 9700-exit
  4028     if no-conversion-error
  4029        move dc-bin-date-1       to ws-bin-1st-pmt-dt
  4030     else
  4031        move low-values          to ws-bin-1st-pmt-dt
  4032        move '0102;Problem with 1st pmt Date'
  4033                                 to ws-return-string
  4034        go to 0300-RETURN-CICS
  4035     end-if
  4036     if ws-bin-1st-pmt-dt <= ws-bin-eff-dt
  4037        move low-values          to ws-bin-1st-pmt-dt
  4038        move '0102;1st Pmt Date not > Eff Dt '
  4039                                 to ws-return-string
  4040        go to 0300-RETURN-CICS
  4041     end-if
  4042**==============================================================**
  4043**                                                              **
  4044**  Only use the code below if there is a time they don't       **
  4045**  send the 1st pmt date.                                      **
  4046**                                                              **
  4047**==============================================================**
  4048     if ws-bin-1st-pmt-dt = low-values
  4049        move +1                  to dc-elapsed-months
  4050        move +0                  to dc-elapsed-days
  4051        move '6'                 to dc-option-code
  4052        perform 9700-date-link   thru 9700-exit
  4053        if no-conversion-error
  4054           move dc-bin-date-2    to ws-bin-1st-pmt-dt
  4055        else
  4056           move '0102;Problem with 1st pmt Date'
  4057                                 to ws-return-string
  4058           go to 0300-RETURN-CICS
  4059        end-if
  4060     end-if
  4061**==============================================================**
  4062**                                                              **
  4063**  Calculate the days to first payment date                    **
  4064**                                                              **
  4065**==============================================================**
  4066     move ws-bin-eff-dt          to dc-bin-date-1
  4067     move ws-bin-1st-pmt-dt      to dc-bin-date-2
  4068     move zeros                  to dc-elapsed-months
  4069                                    dc-elapsed-days
  4070     move '1'                    to dc-option-code
  4071     perform 9700-date-link   thru 9700-exit
  4072     if no-conversion-error
  4073        move dc-elapsed-days     to d
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  72
* WSMESS02.cbl
  4074     else
  4075        move 30                  to d
  4076     end-if
  4077**==============================================================**
  4078**                                                              **
  4079**  Calculate the lf expiration date to be passed back.         **
  4080**                                                              **
  4081**==============================================================**
  4082     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4083     compute dc-elapsed-months = ws-rate-lf-term - 1
  4084     move +0                     to dc-elapsed-days
  4085     move '6'                    to dc-option-code
  4086     perform 9700-date-link      thru 9700-exit
  4087     if no-conversion-error
  4088        move dc-bin-date-2       to ws-bin-exp-dt
  4089        move dc-greg-date-a-edit to ws-lf-exp-date
  4090     else
  4091        move '0102;Problem with calculating exp date'
  4092                              to ws-return-string
  4093        go to 0300-RETURN-CICS
  4094     end-if
  4095**==============================================================**
  4096**                                                              **
  4097**  Calculate the ah expiration date to be passed back.         **
  4098**                                                              **
  4099**==============================================================**
  4100     move ws-bin-1st-pmt-dt      to dc-bin-date-1
  4101     compute dc-elapsed-months = ws-rate-ah-term - 1
  4102     move +0                     to dc-elapsed-days
  4103     move '6'                    to dc-option-code
  4104     perform 9700-date-link      thru 9700-exit
  4105     if no-conversion-error
  4106        move dc-bin-date-2       to ws-bin-exp-dt
  4107        move dc-greg-date-a-edit to ws-ah-exp-date
  4108     else
  4109        move '0102;Problem with calculating exp date'
  4110                              to ws-return-string
  4111        go to 0300-RETURN-CICS
  4112     end-if
  4113**==============================================================**
  4114**                                                              **
  4115**  Validate primary borrower birth date.                       **
  4116**                                                              **
  4117**==============================================================**
  4118     move ws-rate-pri-birth-date (7:4)
  4119                                 to ws-work-date (1:4)
  4120     move ws-rate-pri-birth-date (1:2)
  4121                                 to ws-work-date (5:2)
  4122     move ws-rate-pri-birth-date (4:2)
  4123                                 to ws-work-date (7:2)
  4124     move ws-work-date-num       to dc-greg-date-cymd
  4125     move 'L'                    to dc-option-code
  4126     perform 9700-date-link      thru 9700-exit
  4127     if no-conversion-error
  4128        move dc-bin-date-1       to ws-bin-pri-birth-dt
  4129     else
  4130        move '0102;Problem with Pri Birth Date'
  4131                                 to ws-return-string
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  73
* WSMESS02.cbl
  4132        go to 0300-RETURN-CICS
  4133     end-if
  4134**==============================================================**
  4135**                                                              **
  4136**  Validate co borrowers birth date.                           **
  4137**                                                              **
  4138**==============================================================**
  4139     if ws-rate-cob-birth-date (7:4) = spaces
  4140        move zeros               to ws-rate-cob-birth-date
  4141     end-if
  4142     move ws-rate-cob-birth-date (7:4)
  4143                                 to ws-work-date (1:4)
  4144     move ws-rate-cob-birth-date (1:2)
  4145                                 to ws-work-date (5:2)
  4146     move ws-rate-cob-birth-date (4:2)
  4147                                 to ws-work-date (7:2)
  4148     move low-values             to ws-bin-cob-birth-dt
  4149     if ws-work-date-num not = zeros
  4150        move ws-work-date-num    to dc-greg-date-cymd
  4151        move 'L'                 to dc-option-code
  4152        perform 9700-date-link   thru 9700-exit
  4153        if no-conversion-error
  4154           move dc-bin-date-1    to ws-bin-cob-birth-dt
  4155        else
  4156           move '0102;Problem with Cob Birth Date'
  4157                                 to ws-return-string
  4158           go to 0300-RETURN-CICS
  4159        end-if
  4160     end-if
  4161**==============================================================**
  4162**                                                              **
  4163**  Calculate primary borrowers age.                            **
  4164**                                                              **
  4165**==============================================================**
  4166     move ws-bin-pri-birth-dt    to dc-bin-date-1
  4167     move ws-bin-eff-dt          to dc-bin-date-2
  4168     move '1'                    to dc-option-code
  4169     perform 9700-date-link      thru 9700-exit
  4170     if no-conversion-error
  4171        compute ws-issue-age = dc-elapsed-months / +12
  4172        display ' issue age = 'ws-issue-age
  4173     else
  4174        move '0102;Problem with Pri Age calculation'
  4175                                 to ws-return-string
  4176        go to 0300-RETURN-CICS
  4177     end-if
  4178**==============================================================**
  4179**                                                              **
  4180**  Calculate co borrowers age.                                 **
  4181**                                                              **
  4182**==============================================================**
  4183     move zeros                  to ws-cob-age
  4184     if ws-bin-cob-birth-dt not = low-values
  4185        move ws-bin-cob-birth-dt to dc-bin-date-1
  4186        move ws-bin-eff-dt       to dc-bin-date-2
  4187        move '1'                 to dc-option-code
  4188        perform 9700-date-link   thru 9700-exit
  4189        if no-conversion-error
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  74
* WSMESS02.cbl
  4190           compute ws-cob-age = dc-elapsed-months / +12
  4191           display ' cob   age = 'ws-cob-age
  4192        else
  4193           move '0102;Problem with Cob Age calculation'
  4194                                 to ws-return-string
  4195           go to 0300-RETURN-CICS
  4196        end-if
  4197     end-if
  4198     move ws-issue-age           to ws-rate-age
  4199     if ws-cob-age > ws-rate-age
  4200        display ' Using Co borrower age ' ws-issue-age
  4201           ' ' ws-cob-age
  4202        move ws-cob-age          to ws-rate-age
  4203     end-if
  4204     .
  4205 0020-exit.
  4206     exit.
  4207 0025-assign-ben-cd.
  4208**==============================================================**
  4209**                                                              **
  4210**     Eventually, depending on how well this project takes off **
  4211**  we should figure out a much better way to assign benefit    **
  4212**  codes. For now since we only have 1 or 2 accounts in TX it  **
  4213**  will be hard coded.                                         **
  4214**                                                              **
  4215**==============================================================**
  4216***____________________________________________________________***
  4217**|                                                            |**
  4218**|   Get the lf benefit code first.                           |**
  4219**|                                                            |**
  4220***____________________________________________________________***
  4221     if ws-rate-state = 'FL'
  4222        if ws-rate-in-lf-ben-code <> spaces
  4223           PERFORM varying b1 from +1 by +1 until
  4224              (b1 > +16)
  4225              or ((ws-fl-lf-ben-type (b1)
  4226                                 = ws-rate-in-lf-ben-code (1:1))
  4227               and (ws-fl-lf-sin-jnt (b1)
  4228                                 = ws-rate-sin-jnt-lf)
  4229               and (ws-fl-lf-dismemb (b1)
  4230                                 = ws-rate-dismemberment))
  4231           end-perform
  4232           if b1 < +17
  4233              display ' found lf ben code ' ws-rate-vin ' '
  4234                 ws-fl-lf-ben-code (b1)
  4235              move ws-fl-lf-ben-code (b1)
  4236                                 to ws-rate-lf-benefit-cd
  4237           else
  4238              display ' lf benefit code not found ' ws-rate-vin
  4239                ' '  ws-rate-in-lf-ben-code ' ' ws-rate-earn-meth
  4240                ' ' ws-rate-sin-jnt-lf ' ' ws-rate-dismemberment
  4241              GO TO 0025-EXIT
  4242           end-if
  4243        end-if
  4244        if ws-rate-in-ah-ben-code <> spaces
  4245           PERFORM varying b1 from +1 by +1 until
  4246              (b1 > +20)
  4247              or ((ws-fl-ah-ben-type (b1)
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  75
* WSMESS02.cbl
  4248                                 = ws-rate-in-ah-ben-code (1:1))
  4249                 and (ws-fl-ah-sin-jnt (b1)
  4250                                 = ws-rate-sin-jnt-ah)
  4251                 and (ws-fl-ah-fullterm (b1)
  4252                                 = ws-rate-fullterm)
  4253                 and (ws-fl-ah-ret-elim (b1)
  4254                                 = ws-rate-retro-elim)
  4255                 and (ws-fl-ah-elim-days (b1)
  4256                                 = ws-rate-waiting-days))
  4257           end-perform
  4258        if b1 < +21
  4259           display ' found ah ben code ' ws-rate-vin ' '
  4260              ws-fl-ah-ben-code (b1)
  4261           move ws-fl-ah-ben-code (b1)
  4262                                 to ws-rate-ah-benefit-cd
  4263           GO TO 0025-EXIT
  4264        else
  4265           display ' ah benefit code not found ' ws-rate-vin ' '
  4266              ws-rate-in-ah-ben-code ' '
  4267              ws-rate-earn-meth ' ' ws-rate-sin-jnt-ah ' '
  4268              ws-rate-fullterm ' ' ws-rate-retro-elim ' '
  4269              ws-rate-waiting-days
  4270           GO TO 0025-EXIT
  4271        end-if
  4272     END-If
  4273     if ws-rate-in-lf-ben-code <> spaces
  4274        if ws-rate-sin-jnt-lf = 'S'
  4275           move '01'             to ws-rate-lf-benefit-cd
  4276        else
  4277           move '03'             to ws-rate-lf-benefit-cd
  4278        end-if
  4279     else
  4280        if ws-rate-sin-jnt-ah = 'J'
  4281           if ws-rate-retro-elim = 'R'
  4282              if ws-rate-waiting-days = 14
  4283                 move '54'       to ws-rate-ah-benefit-cd
  4284              else
  4285                 if ws-rate-waiting-days = 30
  4286                    move '55'    to ws-rate-ah-benefit-cd
  4287                 end-if
  4288              end-if
  4289           else
  4290              if ws-rate-retro-elim = 'E'
  4291                 if ws-rate-waiting-days = 14
  4292                    move '56'    to ws-rate-ah-benefit-cd
  4293                 else
  4294                    if ws-rate-waiting-days = 30
  4295                       move '57' to ws-rate-ah-benefit-cd
  4296                    end-if
  4297                 end-if
  4298              end-if
  4299           end-if
  4300        else
  4301           if ws-rate-retro-elim = 'R'
  4302              if ws-rate-waiting-days = 14
  4303                 move '01'       to ws-rate-ah-benefit-cd
  4304              else
  4305                 if ws-rate-waiting-days = 30
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  76
* WSMESS02.cbl
  4306                    move '04'    to ws-rate-ah-benefit-cd
  4307                 end-if
  4308              end-if
  4309           else
  4310              if ws-rate-retro-elim = 'E'
  4311                 if ws-rate-waiting-days = 14
  4312                    move '05'    to ws-rate-ah-benefit-cd
  4313                 else
  4314                    if ws-rate-waiting-days = 30
  4315                       move '02' to ws-rate-ah-benefit-cd
  4316                    end-if
  4317                 end-if
  4318              end-if
  4319           end-if
  4320        end-if
  4321     end-if
  4322     .
  4323 0025-exit.
  4324     exit.
  4325 0030-get-lf-rate.
  4326     perform 0050-get-account    thru 0050-exit
  4327*    move spaces                 to calculation-pass-area
  4328     move zeros                  to cp-r-max-mon-ben
  4329                                    cp-r-max-tot-ben
  4330                                    cp-rate-dev-pct
  4331                                    cp-original-premium
  4332                                    cp-critical-months
  4333                                    cp-term-or-ext-days
  4334     move am-cal-table           to cp-class-CODE
  4335     move am-lf-deviation        to cp-deviation-code
  4336     move ws-rate-state          to cp-state
  4337                                    cp-state-std-abbrv
  4338     move 'L'                    to cp-benefit-type
  4339     move ws-rate-lf-benefit-cd  to cp-benefit-cd
  4340     move ws-rate-loan-amt       to cp-original-benefit
  4341                                    cp-rating-benefit-amt
  4342     move ws-rate-age            to cp-issue-age
  4343     move ws-comp-id             to cp-company-id
  4344     move ws-comp-cd             to cp-company-cd
  4345     move ws-rate-apr            to cp-loan-apr
  4346     if ws-rate-loan-term = zeros
  4347        move ws-rate-lf-term     to ws-rate-loan-term
  4348     end-if
  4349     move ws-rate-lf-term        to cp-original-term
  4350     move ws-rate-loan-term      to cp-loan-term
  4351     move 'L'                    to cp-life-override-code
  4352     move 'A'                    to cp-ah-override-code
  4353     move '3'                    to cp-process-type
  4354     move ws-rate-earn-meth      to cp-earning-method
  4355                                    cp-rating-method
  4356     move 'R'                    to cp-rate-file
  4357     move ws-bin-eff-dt          to cp-cert-eff-dt
  4358     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4359     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4360     if no-cp-error
  4361        move cp-premium-rate     to lf-rate
  4362                                    ws-rate-lf-rate
  4363        move cp-r-max-tot-ben    to ws-max-lf-benefit
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  77
* WSMESS02.cbl
  4364     else
  4365        move zeros               to lf-rate
  4366     end-if
  4367     .
  4368 0030-exit.
  4369     exit.
  4370 0035-get-ah-rate.
  4371*    move spaces                 to calculation-pass-area
  4372     move zeros                  to cp-r-max-mon-ben
  4373                                    cp-r-max-tot-ben
  4374                                    cp-rate-dev-pct
  4375                                    cp-original-premium
  4376                                    cp-critical-months
  4377                                    cp-term-or-ext-days
  4378                                    cp-original-benefit
  4379                                    cp-rating-benefit-amt
  4380     move am-cal-table           to cp-class-CODE
  4381     move am-ah-deviation        to cp-deviation-code
  4382     move ws-rate-state          to cp-state
  4383                                    cp-state-std-abbrv
  4384     move 'A'                    to cp-benefit-type
  4385     move ws-rate-ah-benefit-cd  to cp-benefit-cd
  4386     if ws-rate-ah-term > zeros
  4387        compute cp-original-benefit =
  4388           ws-rate-loan-amt / ws-rate-ah-term
  4389        move cp-original-benefit to cp-rating-benefit-amt
  4390     end-if
  4391*    move ws-rate-loan-amt       to cp-original-benefit
  4392*                                   cp-rating-benefit-amt
  4393     move ws-rate-age            to cp-issue-age
  4394     move ws-comp-id             to cp-company-id
  4395     move ws-comp-cd             to cp-company-cd
  4396     if ws-rate-loan-term = zeros
  4397        move ws-rate-ah-term     to ws-rate-loan-term
  4398     end-if
  4399     move ws-rate-ah-term        to cp-original-term
  4400     move ws-rate-loan-term      to cp-loan-term
  4401     move 'L'                    to cp-life-override-code
  4402     move 'A'                    to cp-ah-override-code
  4403     move '3'                    to cp-process-type
  4404     move ws-rate-earn-meth      to cp-earning-method
  4405                                    cp-rating-method
  4406     move 'R'                    to cp-rate-file
  4407     move ws-bin-eff-dt          to cp-cert-eff-dt
  4408     move ws-bin-1st-pmt-dt      to cp-first-pay-date
  4409     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4410     if no-cp-error
  4411        move cp-premium-rate     to ah-rate
  4412                                    ws-rate-ah-rate
  4413        move cp-r-max-mon-ben    to ws-max-ah-benefit
  4414        display ' ah rate no error ' cp-premium-rate
  4415     else
  4416        DISPLAY ' Error with AH Rate call ' cp-state ' '
  4417          cp-class-code ' ' cp-deviation-code ' ' cp-benefit-type
  4418          ' ' cp-benefit-cd ' '
  4419          cp-original-benefit ' ' cp-issue-age cp-company-id ' '
  4420          cp-original-term ' ' cp-loan-term ' ' cp-earning-method
  4421          ' ' cp-return-code
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  78
* WSMESS02.cbl
  4422        move zeros               to ah-rate
  4423     end-if
  4424     .
  4425 0035-exit.
  4426     exit.
  4427 0040-format-buffer.
  4428     move spaces                 to ws-return-string
  4429     perform 0045-format-error   thru 0045-exit
  4430     move ';'                    to ws-sc1
  4431                                    ws-sc2
  4432                                    ws-sc3
  4433                                    ws-sc4
  4434                                    ws-sc5
  4435                                    ws-sc6
  4436                                    ws-sc7
  4437                                    ws-sc8
  4438                                    ws-sc9
  4439                                    ws-sc10
  4440                                    ws-sc11
  4441                                    ws-sc12
  4442                                    ws-sc13
  4443                                    ws-sc14
  4444                                    ws-sc15
  4445     if no-cp-error
  4446        if ws-contract-suffix = spaces or low-values
  4447           move ws-contract-no   to ws-return-contract-no (2:10)
  4448        else
  4449           move ws-contract-no   to ws-return-contract-no (1:10)
  4450           move ws-contract-suffix
  4451                                 to ws-return-contract-no (11:1)
  4452        end-if
  4453        move ws-rate-lf-prem     to ws-return-lf-prem
  4454        move ws-rate-ah-prem     to ws-return-ah-prem
  4455        move ws-rate-lf-rate     to ws-return-lf-rate
  4456        move ws-rate-ah-rate     to ws-return-ah-rate
  4457        move ws-max-ah-benefit   to ws-return-ah-max-amt
  4458        move ws-max-lf-benefit   to ws-return-lf-max-amt
  4459        move ws-lf-exp-date      to ws-return-lf-exp-dt
  4460        move ws-ah-exp-date      to ws-return-ah-exp-dt
  4461        move ws-rate-lf-benefit-cd
  4462                                 to ws-return-lf-benefit-cd
  4463        move ws-rate-ah-benefit-cd
  4464                                 to ws-return-ah-benefit-cd
  4465        move ws-rate-per-pmt     to ws-return-period-pmt
  4466        move ws-rate-tot-financed to ws-return-tot-financed
  4467        move ws-rate-tot-pmts    to ws-return-tot-pmts
  4468     else
  4469        set error-in-one-coverage to true
  4470        move spaces              to ws-contract-no
  4471                                    ws-contract-suffix
  4472     end-if
  4473     .
  4474 0040-exit.
  4475     exit.
  4476 0045-format-error.
  4477     evaluate true
  4478        when cp-return-code = '0'
  4479           move +1               to s1
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  79
* WSMESS02.cbl
  4480        when cp-return-code = '1'
  4481           move +2               to s1
  4482        when cp-return-code = '2'
  4483           move +3               to s1
  4484        when cp-return-code = 'A'
  4485           move +4               to s1
  4486        when cp-return-code = 'B'
  4487           move +5               to s1
  4488        when cp-return-code = '4'
  4489           move +6               to s1
  4490        when cp-return-code = '9'
  4491           move +7               to s1
  4492        when cp-return-code = '8'
  4493           move +8               to s1
  4494        when cp-return-code = 'H'
  4495           move +9               to s1
  4496        when cp-return-code = 'C'
  4497           move +10              to s1
  4498        when cp-return-code = '7'
  4499           move +11              to s1
  4500        when cp-return-code = '6'
  4501           move +12              to s1
  4502        when cp-return-code = 'D'
  4503           move +13              to s1
  4504        when cp-return-code = 'Z'
  4505           move +14              to s1
  4506           move cp-calc-premium  to ws-return-ah-prem
  4507           move cp-premium-rate  to ws-return-ah-rate
  4508           move ws-max-ah-benefit   to ws-return-ah-max-amt
  4509           move ws-ah-exp-date      to ws-return-ah-exp-dt
  4510           move ws-rate-ah-benefit-cd to ws-return-ah-benefit-cd
  4511        when cp-return-code = 'Y'
  4512           move +15              to s1
  4513           move cp-calc-premium  to ws-return-ah-prem
  4514           move cp-premium-rate  to ws-return-ah-rate
  4515           move ws-max-ah-benefit   to ws-return-ah-max-amt
  4516           move ws-ah-exp-date      to ws-return-ah-exp-dt
  4517           move ws-rate-ah-benefit-cd to ws-return-ah-benefit-cd
  4518     end-evaluate
  4519     move ws-table-error-no (s1) to ws-return-error-no
  4520     move ws-table-error-mess (s1)
  4521                                 to ws-return-error-mess
  4522     .
  4523 0045-exit.
  4524     exit.
  4525 0050-get-account.
  4526     move ws-comp-cd             to ws-am-company-cd
  4527     move '9'                    to ws-am-carrier
  4528     move '000000'               to ws-am-group
  4529     move ws-rate-state          to ws-am-state
  4530     move ws-rate-acct-no        to ws-am-account
  4531     move ws-bin-eff-dt          to ws-am-exp-dt
  4532
  4533* exec cics read
  4534*       dataset      ('ERACCT')
  4535*       ridfld       (ws-am-key)
  4536*       into         (account-master)
  4537*       GTEQ
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  80
* WSMESS02.cbl
  4538*       resp         (ws-response)
  4539*    end-exec
  4540     MOVE LENGTH OF
  4541      account-master
  4542       TO DFHEIV11
  4543     MOVE 'ERACCT' TO DFHEIV1
  4544*    MOVE '&"IL       G          (  N#00004435' TO DFHEIV0
  4545     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4546     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4547     MOVE X'204E233030303034343335' TO DFHEIV0(25:11)
  4548     CALL 'kxdfhei1' USING DFHEIV0,
  4549           DFHEIV1,
  4550           account-master,
  4551           DFHEIV11,
  4552           ws-am-key,
  4553           DFHEIV99,
  4554           DFHEIV99,
  4555           DFHEIV99
  4556     MOVE EIBRESP  TO ws-response
  4557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4558     if resp-normal
  4559        and (ws-comp-cd = am-company-cd)
  4560        and (ws-rate-state = am-state)
  4561        and (ws-rate-acct-no = am-account)
  4562        and (ws-bin-eff-dt >= am-effective-dt)
  4563        and (ws-bin-eff-dt < am-expiration-dt)
  4564        continue
  4565     else
  4566        move '0114;No account mstr found ' to ws-return-string
  4567        go to 0300-RETURN-CICS
  4568     end-if
  4569     .
  4570 0050-exit.
  4571     exit.
  4572 0060-check-for-dup.
  4573**==============================================================**
  4574**                                                              **
  4575**    All i'm going to do here is check for a dup using         **
  4576**  the state, account, eff dt and last six of vin and a space  **
  4577**  in the cert suffix. If I do find one then I will have to    **
  4578**  find the last suffix and use the next available one in the  **
  4579**  suffix table.                                               **
  4580**                                                              **
  4581**==============================================================**
  4582     move +1                     to x1
  4583     move ' '                    to ws-browse-sw
  4584     move ws-comp-cd             to ws-cm-key
  4585     move '9'                    to ws-cm-carrier
  4586     move '000000'               to ws-cm-group
  4587     move ws-rate-state          to ws-cm-state
  4588     move ws-rate-acct-no        to ws-cm-account
  4589     move ws-bin-eff-dt          to ws-cm-eff-dt
  4590     string
  4591        '0000'
  4592        ws-rate-vin (12:6)
  4593        ' ' delimited by size into ws-cm-cert-no
  4594     end-string
  4595     move ws-cm-key              to ws-cm-compare-key
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  81
* WSMESS02.cbl
  4596     move ws-cm-cert-ten         to ws-contract-no
  4597     move low-values             to ws-last-suffix
  4598     display ' about to startbr ' ws-cm-key (2:19) ' '
  4599        ws-rate-eff-date  ' ' ws-cm-key (23:11)
  4600
  4601* exec cics startbr
  4602*       dataset      ('ELCERT')
  4603*       ridfld       (ws-cm-key)
  4604*       gteq
  4605*       resp         (ws-response)
  4606*    end-exec
  4607     MOVE 'ELCERT' TO DFHEIV1
  4608     MOVE 0
  4609       TO DFHEIV11
  4610*    MOVE '&,         G          &  N#00004484' TO DFHEIV0
  4611     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4612     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4613     MOVE X'204E233030303034343834' TO DFHEIV0(25:11)
  4614     CALL 'kxdfhei1' USING DFHEIV0,
  4615           DFHEIV1,
  4616           ws-cm-key,
  4617           DFHEIV99,
  4618           DFHEIV11,
  4619           DFHEIV99
  4620     MOVE EIBRESP  TO ws-response
  4621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4622     evaluate true
  4623        when resp-normal
  4624           set browse-started to true
  4625        when resp-notfnd or resp-endfile
  4626           set i-say-stop to true
  4627        when other
  4628           move ws-response to ws-disp-resp
  4629           string
  4630              '9999' ';'
  4631              'Bad elcert startbr ' ';'
  4632              ws-disp-resp delimited by size
  4633                                 into ws-return-string
  4634           end-string
  4635           display ' something went wrong with start br '
  4636              ws-response
  4637           go to 0300-RETURN-CICS
  4638     end-evaluate
  4639     perform until i-say-stop
  4640
  4641* exec cics readnext
  4642*          dataset      ('ELCERT')
  4643*          ridfld       (ws-cm-key)
  4644*          into         (certificate-master)
  4645*          resp         (ws-response)
  4646*       end-exec
  4647     MOVE LENGTH OF
  4648      certificate-master
  4649       TO DFHEIV12
  4650     MOVE 'ELCERT' TO DFHEIV1
  4651     MOVE 0
  4652       TO DFHEIV11
  4653*    MOVE '&.IL                  )  N#00004508' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  82
* WSMESS02.cbl
  4654     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4655     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4656     MOVE X'204E233030303034353038' TO DFHEIV0(25:11)
  4657     CALL 'kxdfhei1' USING DFHEIV0,
  4658           DFHEIV1,
  4659           certificate-master,
  4660           DFHEIV12,
  4661           ws-cm-key,
  4662           DFHEIV99,
  4663           DFHEIV11,
  4664           DFHEIV99,
  4665           DFHEIV99
  4666     MOVE EIBRESP  TO ws-response
  4667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4668        if resp-normal
  4669           if ws-cm-key (1:32) = ws-cm-compare-key (1:32)
  4670              move ws-cm-cert-suffix
  4671                                 to ws-last-suffix
  4672           else
  4673              set i-say-stop to true
  4674           end-if
  4675        else
  4676           set i-say-stop to true
  4677        end-if
  4678     end-perform
  4679     if browse-started
  4680
  4681* exec cics endbr
  4682*          dataset   ('ELCERT')
  4683*       END-EXEC
  4684     MOVE 'ELCERT' TO DFHEIV1
  4685     MOVE 0
  4686       TO DFHEIV11
  4687*    MOVE '&2                    $   #00004526' TO DFHEIV0
  4688     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4690     MOVE X'2020233030303034353236' TO DFHEIV0(25:11)
  4691     CALL 'kxdfhei1' USING DFHEIV0,
  4692           DFHEIV1,
  4693           DFHEIV11,
  4694           DFHEIV99
  4695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4696     end-if
  4697     if ws-last-suffix not = low-values
  4698        perform varying x1 from +1 by +1 until
  4699           (x1 > +26)
  4700           or (ws-last-suffix = ws-suffix-value (x1))
  4701        end-perform
  4702        if x1 < +27
  4703           move ws-suffix-value (x1 + 1)
  4704                                 to ws-contract-suffix
  4705        else
  4706           MOVE 'BLEW SUFFIX TABLE ' to ws-return-string
  4707           display ' more than 26 suffix codes ' ws-last-suffix
  4708           go to 0300-RETURN-CICS
  4709        end-if
  4710     end-if
  4711     .
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  83
* WSMESS02.cbl
  4712 0060-exit.
  4713     exit.
  4714 0070-open-cursor.
  4715*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  4716***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  4717***                                                            ***
  4718***  The dates on the sql table have values in the time        ***
  4719***  so I convert it to a string and just use mm/dd/yyyy       ***
  4720***  to perform the comparison.                                ***
  4721***                                                            ***
  4722***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  4723     if not connected-to-db
  4724        perform 6000-connect-to-db thru 6000-exit
  4725     end-if
  4726     move ws-rate-state          to ws-dealer-state
  4727     move ws-rate-acct-no        to ws-dealer-id
  4728     move ws-rate-eff-date       to ws-contract-eff-dt
  4729     move zeros                  to ws-ks-contract-no
  4730     move ws-rate-vin (12:6)     to ws-ks-contract-no (5:6)
  4731     EXEC SQL
  4732        DECLARE
  4733           contracts cursor for
  4734        SELECT
  4735           DlrState,
  4736           DlrId,
  4737           EffDt,
  4738           ContractNo,
  4739           ContractSuffix
  4740        FROM
  4741           PendingContracts
  4742        WHERE
  4743           DlrState     = :ws-dealer-state
  4744           and DlrId    = :ws-dealer-id
  4745           and EffDt    = :ws-contract-eff-dt
  4746           and ContractNo  = :ws-ks-contract-no
  4747        ORDER BY
  4748           dlrstate,
  4749           dlrid,
  4750           effdt,
  4751           contractno,
  4752           contractsuffix
  4753     end-exec
  4754     if sqlcode not = 0
  4755        display "Error: cannot declare cursor "
  4756        display ' sql retrun code ' sqlcode
  4757        display ' sql err mess    ' sqlerrmc
  4758        go to 0070-exit
  4759     end-if
  4760     EXEC SQL
  4761        open contracts
  4762     END-EXEC
  4763     if sqlcode not = 0
  4764        display "Error: cannot open cursor "
  4765        display ' sql retrun code ' sqlcode
  4766        display ' sql err mess    ' sqlerrmc
  4767        go to 0070-exit
  4768     end-if
  4769     .
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  84
* WSMESS02.cbl
  4770 0070-exit.
  4771     exit.
  4772 0080-process-input.
  4773     perform until sqlcode not = 0
  4774        EXEC SQL
  4775           fetch contracts into
  4776              :sql-dlr-state,
  4777              :sql-dlr-id,
  4778              :sql-eff-dt,
  4779              :sql-contr-no,
  4780              :sql-contr-suffix
  4781        END-EXEC
  4782        if sqlcode = 0
  4783           display ' got a hit ' sql-contr-no ' '
  4784              sql-contr-suffix
  4785           move sql-contr-suffix to ws-tbl-last-suffix
  4786        else
  4787           if sqlcode not = 0 and 100
  4788              display "Error: cannot fetch row "
  4789              display ' sql return code ' sqlcode
  4790              display ' sql err mess    ' sqlerrmc
  4791           end-if
  4792        end-if
  4793     end-perform
  4794     if ws-tbl-last-suffix = low-values
  4795        display ' tbl last suffix = LV '
  4796     else
  4797        if ws-tbl-last-suffix = spaces
  4798           display ' tbl last suffix = SPACES '
  4799        else
  4800           display ' tbl last suffix = ' ws-tbl-last-suffix
  4801        end-if
  4802     end-if
  4803     if ws-last-suffix = low-values
  4804        display ' last suffix = LV '
  4805     else
  4806        if ws-last-suffix = spaces
  4807           display ' last suffix = SPACES '
  4808        else
  4809           display ' last suffix = ' ws-last-suffix
  4810        end-if
  4811     end-if
  4812     if sqlcode = 100
  4813        display ' Normal end of record set '
  4814     end-if
  4815     if ws-tbl-last-suffix not = low-values
  4816        and (ws-tbl-last-suffix > ws-last-suffix)
  4817        perform varying x1 from +1 by +1 until
  4818           (x1 > +26)
  4819           or (ws-tbl-last-suffix = ws-suffix-value (x1))
  4820        end-perform
  4821        if x1 < +27
  4822           move ws-suffix-value (x1 + 1)
  4823                                 to ws-contract-suffix
  4824        else
  4825           MOVE 'BLEW SUFFIX TABLE ' to ws-return-string
  4826           display ' more than 26 suffix codes ' ws-last-suffix
  4827           go to 0300-RETURN-CICS
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  85
* WSMESS02.cbl
  4828        end-if
  4829     end-if
  4830     EXEC SQL
  4831         close contracts
  4832     END-EXEC
  4833     if sqlcode not = 0
  4834        display "Error: cannot close cursor "
  4835        display ' sql retrun code ' sqlcode
  4836        display ' sql err mess    ' sqlerrmc
  4837     end-if
  4838     .
  4839 0080-exit.
  4840     exit.
  4841 0100-process-message.
  4842     perform 0110-unstring       thru 0110-exit
  4843     perform 0120-format-message thru 0120-exit
  4844     perform 0020-edit-received  thru 0020-exit
  4845     perform 0025-assign-ben-cd  thru 0025-exit
  4846     perform 0030-get-lf-rate    thru 0030-exit
  4847     perform 0035-get-ah-rate    thru 0035-exit
  4848     perform 0200-calc-payment   thru 0200-exit
  4849*    go to 0100-exit
  4850     if (contract-no-assigned)
  4851            or
  4852        (error-in-one-coverage)
  4853        continue
  4854     else
  4855        perform 0060-check-for-dup
  4856                                 thru 0060-exit
  4857        perform 0070-open-cursor thru 0070-exit
  4858        perform 0080-process-input
  4859                                 thru 0080-exit
  4860     end-if
  4861     perform 0040-format-buffer  thru 0040-exit
  4862     set contract-no-assigned to true
  4863     .
  4864 0100-exit.
  4865     exit.
  4866 0110-unstring.
  4867***____________________________________________________________***
  4868**|                                                            |**
  4869**|    Unstring the raw data into data elements                |**
  4870**|                                                            |**
  4871***____________________________________________________________***
  4872        unstring dfhcommarea
  4873           delimited by '|' into
  4874              raw-message-num
  4875              raw-state
  4876              raw-acct-no
  4877              raw-vin
  4878              raw-lf-ben-code
  4879              raw-ah-ben-code
  4880              raw-earn-meth
  4881              raw-pri-birth-date
  4882              raw-cob-birth-date
  4883              raw-loan-amt
  4884              raw-eff-date
  4885              raw-1st-pmt-dt
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  86
* WSMESS02.cbl
  4886              raw-pmts-per-year
  4887              raw-loan-term
  4888              raw-lf-term
  4889              raw-ah-term
  4890              raw-apr
  4891              raw-lf-sin-jnt-ind
  4892              raw-ah-sin-jnt-ind
  4893              raw-dismemberment
  4894              raw-retro-elim
  4895              raw-waiting-days
  4896              raw-crit-per
  4897        end-unstring
  4898     .
  4899 0110-exit.
  4900     exit.
  4901 0120-format-message.
  4902***____________________________________________________________***
  4903**|                                                            |**
  4904**|    Format each data element to be consistant with          |**
  4905**|  COBOL rate copybook model                                 |**
  4906**|                                                            |**
  4907***____________________________________________________________***
  4908     inspect
  4909        raw-acct-no replacing leading spaces by zeros
  4910     inspect
  4911        raw-pmts-per-year replacing leading spaces by zeros
  4912     inspect
  4913        raw-loan-term replacing leading spaces by zeros
  4914     inspect
  4915        raw-lf-term replacing leading spaces by zeros
  4916     inspect
  4917        raw-ah-term replacing leading spaces by zeros
  4918     inspect
  4919        raw-waiting-days replacing leading spaces by zeros
  4920     inspect
  4921        raw-crit-per replacing leading spaces by zeros
  4922     inspect
  4923        raw-loan-amt replacing all spaces by zeros
  4924     inspect
  4925        raw-apr replacing all spaces by zeros
  4926     move raw-loan-amt           to ws-work-in
  4927     perform 0130-format-amt     thru 0130-exit
  4928     move ws-work-out-v2         to ws-rate-loan-amt
  4929     display ' ben  in *' ws-work-in '*'
  4930     display ' ben  out *' ws-work-out '*'
  4931     move raw-loan-term          to ws-work-in
  4932     perform 0140-format-term    thru 0140-exit
  4933     move ws-work-out-v0         to ws-rate-loan-term
  4934     display ' ln term in *' ws-work-in '*'
  4935     display ' ln term out *' ws-work-out '*'
  4936     move raw-lf-term            to ws-work-in
  4937     perform 0140-format-term    thru 0140-exit
  4938     move ws-work-out-v0         to ws-rate-lf-term
  4939     display ' lf  term in *' ws-work-in '*'
  4940     display ' lf  term out *' ws-work-out '*'
  4941     move raw-ah-term            to ws-work-in
  4942     perform 0140-format-term    thru 0140-exit
  4943     move ws-work-out-v0         to ws-rate-ah-term
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  87
* WSMESS02.cbl
  4944     display ' ah  term in *' ws-work-in '*'
  4945     display ' ah  term out *' ws-work-out '*'
  4946     move raw-waiting-days       to ws-work-in
  4947     perform 0140-format-term    thru 0140-exit
  4948     move ws-work-out-v0         to ws-rate-waiting-days
  4949     display ' wait day in *' ws-work-in '*'
  4950     display ' wait day out *' ws-work-out '*'
  4951     move raw-crit-per           to ws-work-in
  4952     perform 0140-format-term    thru 0140-exit
  4953     move ws-work-out-v0         to ws-rate-crit-per
  4954     display ' crit per in *' ws-work-in '*'
  4955     display ' crit per out *' ws-work-out '*'
  4956     move raw-pmts-per-year      to ws-work-in
  4957     perform 0140-format-term    thru 0140-exit
  4958     move ws-work-out-v0         to ws-rate-pmts-per-year
  4959     display ' crit per in *' ws-work-in '*'
  4960     display ' crit per out *' ws-work-out '*'
  4961     move raw-apr                to ws-work-in
  4962     perform 0150-format-apr     thru 0150-exit
  4963     move ws-work-out-v5         to ws-rate-apr
  4964     display ' ins apr  in *' ws-work-in '*'
  4965     display ' ins apr  out *' ws-work-out '*'
  4966     move raw-state              to ws-rate-state
  4967     move raw-acct-no            to ws-rate-acct-no
  4968     move raw-vin                to ws-rate-vin
  4969     move raw-lf-ben-code        to ws-rate-in-lf-ben-code
  4970     move raw-ah-ben-code        to ws-rate-in-ah-ben-code
  4971     move raw-earn-meth          to ws-rate-earn-meth
  4972     move raw-pri-birth-date     to ws-rate-pri-birth-date
  4973     move raw-cob-birth-date     to ws-rate-cob-birth-date
  4974     move raw-eff-date           to ws-rate-eff-date
  4975     move raw-1st-pmt-dt         to ws-rate-1st-pmt-dt
  4976     move raw-lf-sin-jnt-ind     to ws-rate-sin-jnt-lf
  4977     move raw-ah-sin-jnt-ind     to ws-rate-sin-jnt-ah
  4978     move raw-dismemberment      to ws-rate-dismemberment
  4979     move raw-retro-elim         to ws-rate-retro-elim
  4980     if ws-rate-crit-per = zeros
  4981        move 'Y'                 to ws-rate-fullterm
  4982     else
  4983        move 'N'                 to ws-rate-fullterm
  4984     end-if
  4985     .
  4986 0120-exit.
  4987     exit.
  4988 0130-format-amt.
  4989     move zeros                  to ws-work-out
  4990     perform varying s2 from +10 by -1 until
  4991        (s2 < +1)
  4992        or (ws-work-in (s2:1) = '.')
  4993     end-perform
  4994     if s2 < +9
  4995        move ws-work-in (s2 + 1:2)
  4996                              to ws-work-out (9:2)
  4997        move +8               to s3
  4998        subtract +1 from s2
  4999        perform varying s2 from s2 by -1 until
  5000           (s2 < +1)
  5001           or (s3 = 0)
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  88
* WSMESS02.cbl
  5002           move ws-work-in (s2:1) to ws-work-out (s3:1)
  5003           subtract +1 from s3
  5004        end-perform
  5005     end-if
  5006     .
  5007 0130-exit.
  5008     exit.
  5009 0140-format-term.
  5010     move zeros                  to ws-work-out
  5011     perform varying s2 from +10 by -1 until
  5012        (s2 < +1)
  5013        or (ws-work-in (s2:1) numeric)
  5014     end-perform
  5015     if s2 > +0
  5016        move ws-work-in (s2:1)
  5017                              to ws-work-out (10:1)
  5018        move +9               to s3
  5019        subtract +1 from s2
  5020        perform varying s2 from s2 by -1 until
  5021           (s2 < +1)
  5022           or (s3 = 7)
  5023           move ws-work-in (s2:1) to ws-work-out (s3:1)
  5024           subtract +1 from s3
  5025        end-perform
  5026     end-if
  5027     .
  5028 0140-exit.
  5029     exit.
  5030 0150-format-apr.
  5031     move zeros                  to ws-work-out
  5032     perform varying s2 from +10 by -1 until
  5033        (s2 < +1)
  5034        or (ws-work-in (s2:1) = '.')
  5035     end-perform
  5036     if s2 < +5
  5037        move ws-work-in (s2 + 1:5)
  5038                              to ws-work-out (6:5)
  5039        move +5               to s3
  5040        subtract +1 from s2
  5041        perform varying s2 from s2 by -1 until
  5042           (s2 < +1)
  5043           or (s3 = 0)
  5044           move ws-work-in (s2:1) to ws-work-out (s3:1)
  5045           subtract +1 from s3
  5046        end-perform
  5047     end-if
  5048     .
  5049 0150-exit.
  5050     exit.
  5051 0200-calc-payment.
  5052***____________________________________________________________***
  5053**(-                                                          -)**
  5054**(-   Right now this works for FL net pay +2 only            -)**
  5055**(-                                                          -)**
  5056***____________________________________________________________***
  5057     move 2                      to plus2
  5058     move ws-rate-loan-amt       to l
  5059     move ws-rate-loan-term      to n
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  89
* WSMESS02.cbl
  5060     move ws-rate-lf-term        to m
  5061     move ws-rate-pmts-per-year  to ppy
  5062     move 30                     to dpp
  5063     compute i = ws-rate-apr / (ppy *100)
  5064     COMPUTE A-ANGLE-N ROUNDED =
  5065         (1 - ((1 / (1 + I)) ** N)) / I
  5066     COMPUTE A-ANGLE-N-M ROUNDED =
  5067         (1 - ((1 / (1 + I)) ** (N - M))) / I
  5068     COMPUTE GAMMA ROUNDED =
  5069         (1 + ((D * I) / DPP)) / (1 + I)
  5070     COMPUTE A-PRM-ANGLE-N ROUNDED =
  5071        A-ANGLE-N / GAMMA
  5072     COMPUTE TEMP-VALUE-3 ROUNDED =
  5073        M + ((D - DPP) / DPP)
  5074     compute mob rounded =
  5075        (lf-rate / (m + (ppy/12))) * 2
  5076*    COMPUTE MOB ROUNDED =
  5077*       (lf-rate *
  5078*       (TEMP-VALUE-3 / PPY)) / ((M + (PPY / 12)) / 2)
  5079     COMPUTE TEMP-VALUE-1 ROUNDED =
  5080         (M - (A-ANGLE-N - A-ANGLE-N-M)) / I
  5081     COMPUTE TEMP-VALUE-2 ROUNDED =
  5082         1 + (PLUS2 * I * (PPY / 12))
  5083     display ' L         ' l
  5084     display ' anglen       ' a-angle-n
  5085     display ' gamma        ' gamma
  5086     display ' tv3          ' temp-value-3
  5087     display 'a-prm-angle-n ' a-prm-angle-n
  5088     display ' tv1          ' temp-value-1
  5089     display ' mob          ' mob
  5090     display ' tv2          ' temp-value-2
  5091     display ' ah rate      ' ah-rate
  5092     display ' m            ' m
  5093     COMPUTE pmt ROUNDED =
  5094         L / (A-PRM-ANGLE-N - (TEMP-VALUE-1 * (MOB / 100) *
  5095         TEMP-VALUE-2) - ((ah-rate * M) / 100))
  5096     COMPUTE DL-PREMIUM ROUNDED = Pmt *
  5097         TEMP-VALUE-1 * (MOB / 100) * TEMP-VALUE-2
  5098     COMPUTE AH-PREMIUM ROUNDED =
  5099         Pmt * M * (AH-RATE / 100)
  5100     COMPUTE T-FINANCED =
  5101         L + DL-PREMIUM + AH-PREMIUM
  5102     COMPUTE T-PAYMENTS = N * Pmt
  5103     move pmt                    to ws-rate-per-pmt
  5104     move dl-premium             to ws-rate-lf-prem
  5105     move ah-premium             to ws-rate-ah-prem
  5106     move t-financed             to ws-rate-tot-financed
  5107     move t-payments             to ws-rate-tot-pmts
  5108     display ' lf-rate       ' lf-rate
  5109     display ' ah-rate       ' ah-rate
  5110     display ' payment       ' pmt
  5111     display ' lf prem       ' ws-rate-lf-prem
  5112     display ' ah prem       ' ws-rate-ah-prem
  5113     display ' tot financed  ' ws-rate-tot-financed
  5114     display ' tot payments  ' ws-rate-tot-pmts
  5115     .
  5116 0200-exit.
  5117     exit.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  90
* WSMESS02.cbl
  5118 0300-RETURN-CICS.
  5119     move ws-return-string       to dfhcommarea
  5120
  5121* exec cics return end-exec
  5122*    MOVE '.(                    ''   #00004953' TO DFHEIV0
  5123     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5124     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5125     MOVE X'2020233030303034393533' TO DFHEIV0(25:11)
  5126     CALL 'kxdfhei1' USING DFHEIV0,
  5127           DFHEIV99,
  5128           DFHEIV99,
  5129           DFHEIV99,
  5130           DFHEIV99,
  5131           DFHEIV99,
  5132           DFHEIV99
  5133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5134
  5135* goback
  5136
  5137     MOVE '9%                    "   ' TO DFHEIV0
  5138     MOVE 'WSMESS02' TO DFHEIV1
  5139     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5140     goback
  5141     .
  5142 0300-exit.
  5143     exit.
  5144 6000-CONNECT-TO-DB.
  5145***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  5146***                                                            ***
  5147***                                                            ***
  5148***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  5149     MOVE 'NTSQLTST2_CrtManage'  TO SVR
  5150     move 'sa'                   to usr
  5151     move 'sql2008r2'            to pass
  5152     if ws-kix-myenv = 'cid1p'
  5153        MOVE 'NTCSO2_CrtManage'  TO SVR
  5154        move 'sa'                to usr
  5155        move 'ntcso2'            to pass
  5156     end-if
  5157     string
  5158         usr delimited space
  5159         "." delimited size
  5160         pass delimited space into usr-pass
  5161     end-string
  5162     display ' About to connect to ' svr ' ' usr-pass
  5163     EXEC SQL
  5164        CONNECT TO :svr USER :usr-pass
  5165     END-EXEC
  5166     if sqlcode not = 0
  5167        display "Error: cannot connect to " svr
  5168        display sqlcode
  5169        display sqlerrmc
  5170     else
  5171        display ' Successful Connect ' sqlcode
  5172        set connected-to-db to true
  5173     end-if
  5174     .
  5175 6000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  91
* WSMESS02.cbl
  5176     EXIT.
  5177 7000-GET-RATE.
  5178
  5179* EXEC CICS LINK
  5180*       PROGRAM ('ELRATE')
  5181*       COMMAREA (CALCULATION-PASS-AREA)
  5182*       LENGTH   (CP-COMM-LENGTH)
  5183*    END-EXEC
  5184     MOVE 'ELRATE' TO DFHEIV1
  5185*    MOVE '."C                   (   #00004992' TO DFHEIV0
  5186     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5188     MOVE X'2020233030303034393932' TO DFHEIV0(25:11)
  5189     CALL 'kxdfhei1' USING DFHEIV0,
  5190           DFHEIV1,
  5191           CALCULATION-PASS-AREA,
  5192           CP-COMM-LENGTH,
  5193           DFHEIV99,
  5194           DFHEIV99,
  5195           DFHEIV99,
  5196           DFHEIV99
  5197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5198     .
  5199 7000-EXIT.
  5200     EXIT.
  5201 9700-DATE-LINK.
  5202
  5203* EXEC CICS LINK
  5204*         PROGRAM  ('ELDATCV')
  5205*         COMMAREA (DATE-CONVERSION-DATA)
  5206*         LENGTH   (DC-COMM-LENGTH)
  5207*    END-EXEC.
  5208     MOVE 'ELDATCV' TO DFHEIV1
  5209*    MOVE '."C                   (   #00005001' TO DFHEIV0
  5210     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5211     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5212     MOVE X'2020233030303035303031' TO DFHEIV0(25:11)
  5213     CALL 'kxdfhei1' USING DFHEIV0,
  5214           DFHEIV1,
  5215           DATE-CONVERSION-DATA,
  5216           DC-COMM-LENGTH,
  5217           DFHEIV99,
  5218           DFHEIV99,
  5219           DFHEIV99,
  5220           DFHEIV99
  5221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5222
  5223 9700-EXIT.
  5224      EXIT.
  5225
  5226 9999-DFHBACK SECTION.
  5227     MOVE '9%                    "   ' TO DFHEIV0
  5228     MOVE 'WSMESS02' TO DFHEIV1
  5229     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5230     GOBACK.
  5231 9999-DFHEXIT.
  5232     IF DFHEIGDJ EQUAL 0001
  5233         NEXT SENTENCE.
* Micro Focus Server Express         V5.1 revision 000 19-Jul-17 11:24 Page  92
* WSMESS02.cbl
  5234     MOVE '9%                    "   ' TO DFHEIV0
  5235     MOVE 'WSMESS02' TO DFHEIV1
  5236     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5237     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      145092     Code:       13834
