* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   1
* EL1041.cbl
* Options: int("EL1041.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1041.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1041.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1041.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1041.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   2
* EL1041.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS
    19*    SCREENS     - EL104Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31*-----------------------------------------------------------------
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 041513    2013011500003  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    40*-----------------------------------------------------------------
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*   EL1041 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    48 77  M1                          PIC S999 COMP-3 VALUE +0.
    49 77  M2                          PIC S999 COMP-3 VALUE +0.
    50 77  WS-STOP-SW                  PIC X  VALUE ' '.
    51     88  I-SAY-TO-STOP              VALUE 'Y'.
    52 77  WS-FIND-SW                  PIC X  VALUE ' '.
    53     88  WE-FOUND-IT                VALUE 'Y'.
    54 77  WS-DONE-WITH-ENCC           PIC X  VALUE ' '.
    55     88  DONE-WITH-ENCC             VALUE 'Y'.
    56 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    57 01  ACCESS-KEYS.
    58     12  ELLETR-KEY.
    59         16  ELLETR-COMPANY-CD   PIC X.
    60         16  ELLETR-ACCESS-CD    PIC X(12).
    61         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    62
    63     12  ELENCC-KEY.
    64         16  ELENCC-COMPANY-CD    PIC X.
    65         16  ELENCC-REC-TYPE      PIC X.
    66         16  ELENCC-ENC-CODE      PIC X(5).
    67         16  F                    PIC X(09).
    68 01  WS-DATE-AREA.
    69     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    70     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    71 01  MISC-WORK-AREAS.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   3
* EL1041.cbl
    72     12  WS-RESPONSE             PIC S9(8)   COMP.
    73         88  RESP-NORMAL              VALUE +00.
    74         88  RESP-ERROR               VALUE +01.
    75         88  RESP-NOTFND              VALUE +13.
    76         88  RESP-NOTOPEN             VALUE +19.
    77         88  RESP-ENDFILE             VALUE +20.
    78     12  WS-NUMVAL.
    79         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    80         16  WS-9V999-OF-DEEDIT REDEFINES
    81             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    82     12  DEEDIT-FIELD                PIC X(11).
    83     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    84                                     PIC S9(11).
    85     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    86                                     PIC S9(09)V99.
    87
    88     12  WS-TEST-STATE               PIC X(2) VALUE SPACES.
    89         88 STATE-SPECIFIC    VALUES 'AK','AL','AR','AS','AZ',
    90            'CA','CO','CT','DC','DE','FL','GA','GU','HI','IA',
    91            'ID','IL','IN','KS','KY','LA','MA','MD','ME','MI',
    92            'MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM',
    93            'NV','NY','OH','OK','OR','PA','PR','RI','SC','SD',
    94            'TN','TX','UT','VA','VI','VT','WA','WI','WV','WY'.
    95 01  STANDARD-AREAS.
    96     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    97     12  TRANS-ID                    PIC X(04)   VALUE 'EX1E'.
    98     12  PGM-NAME                    PIC X(08).
    99     12  TIME-IN                     PIC S9(07).
   100     12  TIME-OUT-R  REDEFINES TIME-IN.
   101         16  FILLER                  PIC X(01).
   102         16  TIME-OUT                PIC 99V99.
   103         16  FILLER                  PIC X(02).
   104     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
   105     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
   106     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
   107     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
   108     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
   109     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
   110     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
   111     12  THIS-PGM                    PIC X(08)   VALUE 'EL1041'.
   112     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   113     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   114     12  ELENCC-FILE-ID              PIC X(08)   VALUE 'ELENCC'.
   115     12  ELENCC-LENGTH               PIC S9(04)  VALUE +400  COMP.
   116     12  SUB                         PIC 9(02).
   117     12  SUB-1                       PIC 9(02).
   118     12  SUB2                        PIC 9(02).
   119     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   120     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1041S'.
   121     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL104Z'.
   122     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   123     12  HOLD-ENC-CODES              PIC X(120)  VALUE SPACES.
   124     12  WS-SUB1                     PIC S9(03).
   125     12  WS-SUB2                     PIC S9(03).
   126     12  WS-SUB3                     PIC S9(03).
   127 01  W-Z-CONTROL-DATA.
   128     05  W-NUMBER-OF-COPIES      PIC  9.
   129     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   4
* EL1041.cbl
   130     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   131     05  FILLER                  PIC  X.
   132     05  W-DAYS-TO-RESEND-1      PIC  999.
   133     05  FILLER                  PIC  X.
   134     05  W-FORM-TO-RESEND        PIC  X(4).
   135     05  FILLER                  PIC  X.
   136     05  W-PROMPT-LETTER         PIC  X.
   137     05  FILLER                  PIC  X.
   138     05  W-ENCLOSURE-CD          PIC  XXX.
   139     05  FILLER                  PIC  X.
   140     05  W-AUTO-CLOSE-IND        PIC  X.
   141     05  FILLER                  PIC  X.
   142     05  W-LETTER-TO-BENE        PIC  X.
   143*                                    COPY ELCSCTM.
   144******************************************************************
   145*                                                                *
   146*                                                                *
   147*                            ELCSCTM                             *
   148*                            VMOD=2.001                          *
   149*                                                                *
   150*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   151*                                                                *
   152******************************************************************
   153 01  SECURITY-MESSAGE.
   154     12  FILLER                          PIC X(30)
   155            VALUE '** LOGIC SECURITY VIOLATION -'.
   156     12  SM-READ                         PIC X(6).
   157     12  FILLER                          PIC X(5)
   158            VALUE ' PGM='.
   159     12  SM-PGM                          PIC X(6).
   160     12  FILLER                          PIC X(5)
   161            VALUE ' OPR='.
   162     12  SM-PROCESSOR-ID                 PIC X(4).
   163     12  FILLER                          PIC X(6)
   164            VALUE ' TERM='.
   165     12  SM-TERMID                       PIC X(4).
   166     12  FILLER                          PIC XX   VALUE SPACE.
   167     12  SM-JUL-DATE                     PIC 9(5).
   168     12  FILLER                          PIC X    VALUE SPACE.
   169     12  SM-TIME                         PIC 99.99.
   170
   171*                                    COPY ELCSCRTY.
   172******************************************************************
   173*                                                                *
   174*                                                                *
   175*                            ELCSCRTY                            *
   176*                            VMOD=2.001                          *
   177*                                                                *
   178*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   179*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   180*        SAVED IN PI-SECURITY-ADDRESS.                           *
   181*                                                                *
   182******************************************************************
   183 01  SECURITY-CONTROL.
   184     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   185     12  FILLER                       PIC XX    VALUE 'SC'.
   186     12  SC-CREDIT-CODES.
   187         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   5
* EL1041.cbl
   188             20  SC-CREDIT-DISPLAY    PIC X.
   189             20  SC-CREDIT-UPDATE     PIC X.
   190     12  SC-CLAIMS-CODES.
   191         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   192             20  SC-CLAIMS-DISPLAY    PIC X.
   193             20  SC-CLAIMS-UPDATE     PIC X.
   194 01  ERROR-MESSAGES.
   195     12  ER-0000                     PIC X(04)   VALUE '0000'.
   196     12  ER-0005                     PIC X(04)   VALUE '0005'.
   197     12  ER-0023                     PIC X(04)   VALUE '0023'.
   198     12  ER-0029                     PIC X(04)   VALUE '0029'.
   199     12  ER-0050                     PIC X(04)   VALUE '0050'.
   200     12  ER-0068                     PIC X(04)   VALUE '0068'.
   201     12  ER-0070                     PIC X(04)   VALUE '0070'.
   202     12  ER-0130                     PIC X(04)   VALUE '0130'.
   203     12  ER-0131                     PIC X(04)   VALUE '0131'.
   204     12  ER-0132                     PIC X(04)   VALUE '0132'.
   205     12  ER-0138                     PIC X(04)   VALUE '0138'.
   206     12  ER-0144                     PIC X(04)   VALUE '0144'.
   207     12  ER-0145                     PIC X(04)   VALUE '0145'.
   208     12  ER-0184                     PIC X(04)   VALUE '0184'.
   209     12  ER-0418                     PIC X(04)   VALUE '0418'.
   210     12  ER-0491                     PIC X(04)   VALUE '0491'.
   211     12  ER-0582                     PIC X(04)   VALUE '0582'.
   212     12  ER-0627                     PIC X(04)   VALUE '0627'.
   213     12  ER-0701                     PIC X(04)   VALUE '0701'.
   214     12  ER-0702                     PIC X(04)   VALUE '0702'.
   215     12  ER-0703                     PIC X(04)   VALUE '0703'.
   216     12  ER-0704                     PIC X(04)   VALUE '0704'.
   217     12  ER-0705                     PIC X(04)   VALUE '0705'.
   218     12  ER-0706                     PIC X(04)   VALUE '0706'.
   219     12  ER-0707                     PIC X(04)   VALUE '0707'.
   220     12  ER-0708                     PIC X(04)   VALUE '0708'.
   221     12  ER-0709                     PIC X(04)   VALUE '0709'.
   222     12  ER-0710                     PIC X(04)   VALUE '0710'.
   223     12  ER-0711                     PIC X(04)   VALUE '0711'.
   224     12  ER-0712                     PIC X(04)   VALUE '0712'.
   225     12  ER-0713                     PIC X(04)   VALUE '0713'.
   226     12  ER-0717                     PIC X(04)   VALUE '0717'.
   227     12  ER-0718                     PIC X(04)   VALUE '0718'.
   228     12  ER-0719                     PIC X(04)   VALUE '0719'.
   229     12  ER-0720                     PIC X(04)   VALUE '0720'.
   230     12  ER-0721                     PIC X(04)   VALUE '0721'.
   231     12  ER-0722                     PIC X(04)   VALUE '0722'.
   232     12  ER-0723                     PIC X(04)   VALUE '0723'.
   233     12  ER-0724                     PIC X(04)   VALUE '0724'.
   234     12  ER-0725                     PIC X(04)   VALUE '0725'.
   235     12  ER-0726                     PIC X(04)   VALUE '0726'.
   236     12  ER-0727                     PIC X(04)   VALUE '0727'.
   237     12  ER-0729                     PIC X(04)   VALUE '0729'.
   238     12  ER-0754                     PIC X(04)   VALUE '0754'.
   239     12  ER-1560                     PIC X(04)   VALUE '1560'.
   240     12  ER-1562                     PIC X(04)   VALUE '1562'.
   241     12  ER-2241                     PIC X(04)   VALUE '2241'.
   242     12  ER-2276                     PIC X(04)   VALUE '2276'.
   243     12  ER-7008                     PIC X(04)   VALUE '7008'.
   244     12  ER-7031                     PIC X(04)   VALUE '7031'.
   245     12  ER-7123                     PIC X(04)   VALUE '7123'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   6
* EL1041.cbl
   246     12  ER-8150                     PIC X(04)   VALUE '8150'.
   247     12  ER-9999                     PIC XXXX    VALUE '9999'.
   248*                                    COPY ELCDATE.
   249******************************************************************
   250*                                                                *
   251*                                                                *
   252*                            ELCDATE.                            *
   253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   254*                            VMOD=2.003
   255*                                                                *
   256*                                                                *
   257*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   258*                 LENGTH = 200                                   *
   259******************************************************************
   260
   261 01  DATE-CONVERSION-DATA.
   262     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   263     12  DC-OPTION-CODE                PIC X.
   264         88  BIN-TO-GREG                VALUE ' '.
   265         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   266         88  EDIT-GREG-TO-BIN           VALUE '2'.
   267         88  YMD-GREG-TO-BIN            VALUE '3'.
   268         88  MDY-GREG-TO-BIN            VALUE '4'.
   269         88  JULIAN-TO-BIN              VALUE '5'.
   270         88  BIN-PLUS-ELAPSED           VALUE '6'.
   271         88  FIND-CENTURY               VALUE '7'.
   272         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   273         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   274         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   275         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   276         88  JULIAN-TO-BIN-3            VALUE 'C'.
   277         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   278         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   279         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   280         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   281         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   282         88  CHECK-LEAP-YEAR            VALUE 'H'.
   283         88  BIN-3-TO-GREG              VALUE 'I'.
   284         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   285         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   286         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   287         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   288         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   289         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   290         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   291         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   292         88  THREE-CHARACTER-BIN
   293                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   294         88  GREGORIAN-TO-BIN
   295                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   296         88  BIN-TO-GREGORIAN
   297                  VALUES ' ' '1' 'I' '8' 'G'.
   298         88  JULIAN-TO-BINARY
   299                  VALUES '5' 'C' 'E' 'F'.
   300     12  DC-ERROR-CODE                 PIC X.
   301         88  NO-CONVERSION-ERROR        VALUE ' '.
   302         88  DATE-CONVERSION-ERROR
   303                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   7
* EL1041.cbl
   304         88  DATE-IS-ZERO               VALUE '1'.
   305         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   306         88  DATE-IS-INVALID            VALUE '3'.
   307         88  DATE1-GREATER-DATE2        VALUE '4'.
   308         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   309         88  DATE-INVALID-OPTION        VALUE '9'.
   310         88  INVALID-CENTURY            VALUE 'A'.
   311         88  ONLY-CENTURY               VALUE 'B'.
   312         88  ONLY-LEAP-YEAR             VALUE 'C'.
   313         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   314     12  DC-END-OF-MONTH               PIC X.
   315         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   316     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   317         88  USE-NORMAL-PROCESS         VALUE ' '.
   318         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   319         88  ADJUST-UP-100-YRS          VALUE '2'.
   320     12  FILLER                        PIC X.
   321     12  DC-CONVERSION-DATES.
   322         16  DC-BIN-DATE-1             PIC XX.
   323         16  DC-BIN-DATE-2             PIC XX.
   324         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   325         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   326                       DC-GREG-DATE-1-EDIT.
   327             20  DC-EDIT1-MONTH        PIC 99.
   328             20  SLASH1-1              PIC X.
   329             20  DC-EDIT1-DAY          PIC 99.
   330             20  SLASH1-2              PIC X.
   331             20  DC-EDIT1-YEAR         PIC 99.
   332         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   333         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   334                     DC-GREG-DATE-2-EDIT.
   335             20  DC-EDIT2-MONTH        PIC 99.
   336             20  SLASH2-1              PIC X.
   337             20  DC-EDIT2-DAY          PIC 99.
   338             20  SLASH2-2              PIC X.
   339             20  DC-EDIT2-YEAR         PIC 99.
   340         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   341         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   342                     DC-GREG-DATE-1-YMD.
   343             20  DC-YMD-YEAR           PIC 99.
   344             20  DC-YMD-MONTH          PIC 99.
   345             20  DC-YMD-DAY            PIC 99.
   346         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   347         16  DC-GREG-DATE-1-MDY-R REDEFINES
   348                      DC-GREG-DATE-1-MDY.
   349             20  DC-MDY-MONTH          PIC 99.
   350             20  DC-MDY-DAY            PIC 99.
   351             20  DC-MDY-YEAR           PIC 99.
   352         16  DC-GREG-DATE-1-ALPHA.
   353             20  DC-ALPHA-MONTH        PIC X(10).
   354             20  DC-ALPHA-DAY          PIC 99.
   355             20  FILLER                PIC XX.
   356             20  DC-ALPHA-CENTURY.
   357                 24 DC-ALPHA-CEN-N     PIC 99.
   358             20  DC-ALPHA-YEAR         PIC 99.
   359         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   360         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   361         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   8
* EL1041.cbl
   362         16  DC-JULIAN-DATE            PIC 9(05).
   363         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   364                                       PIC 9(05).
   365         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   366             20  DC-JULIAN-YEAR        PIC 99.
   367             20  DC-JULIAN-DAYS        PIC 999.
   368         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   369         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   370         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   371     12  DATE-CONVERSION-VARIBLES.
   372         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   373         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   374             20  FILLER                PIC 9(3).
   375             20  HOLD-CEN-1-CCYY.
   376                 24  HOLD-CEN-1-CC     PIC 99.
   377                 24  HOLD-CEN-1-YY     PIC 99.
   378             20  HOLD-CEN-1-MO         PIC 99.
   379             20  HOLD-CEN-1-DA         PIC 99.
   380         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   381             20  HOLD-CEN-1-R-MO       PIC 99.
   382             20  HOLD-CEN-1-R-DA       PIC 99.
   383             20  HOLD-CEN-1-R-CCYY.
   384                 24  HOLD-CEN-1-R-CC   PIC 99.
   385                 24  HOLD-CEN-1-R-YY   PIC 99.
   386             20  FILLER                PIC 9(3).
   387         16  HOLD-CENTURY-1-X.
   388             20  FILLER                PIC X(3)  VALUE SPACES.
   389             20  HOLD-CEN-1-X-CCYY.
   390                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   391                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   392             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   393             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   394         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   395             20  HOLD-CEN-1-R-X-MO     PIC XX.
   396             20  HOLD-CEN-1-R-X-DA     PIC XX.
   397             20  HOLD-CEN-1-R-X-CCYY.
   398                 24  HOLD-CEN-1-R-X-CC PIC XX.
   399                 24  HOLD-CEN-1-R-X-YY PIC XX.
   400             20  FILLER                PIC XXX.
   401         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   402         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   403         16  DC-JULIAN-DATE-1          PIC 9(07).
   404         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   405             20  DC-JULIAN-1-CCYY.
   406                 24  DC-JULIAN-1-CC    PIC 99.
   407                 24  DC-JULIAN-1-YR    PIC 99.
   408             20  DC-JULIAN-DA-1        PIC 999.
   409         16  DC-JULIAN-DATE-2          PIC 9(07).
   410         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   411             20  DC-JULIAN-2-CCYY.
   412                 24  DC-JULIAN-2-CC    PIC 99.
   413                 24  DC-JULIAN-2-YR    PIC 99.
   414             20  DC-JULIAN-DA-2        PIC 999.
   415         16  DC-GREG-DATE-A-EDIT.
   416             20  DC-EDITA-MONTH        PIC 99.
   417             20  SLASHA-1              PIC X VALUE '/'.
   418             20  DC-EDITA-DAY          PIC 99.
   419             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page   9
* EL1041.cbl
   420             20  DC-EDITA-CCYY.
   421                 24  DC-EDITA-CENT     PIC 99.
   422                 24  DC-EDITA-YEAR     PIC 99.
   423         16  DC-GREG-DATE-B-EDIT.
   424             20  DC-EDITB-MONTH        PIC 99.
   425             20  SLASHB-1              PIC X VALUE '/'.
   426             20  DC-EDITB-DAY          PIC 99.
   427             20  SLASHB-2              PIC X VALUE '/'.
   428             20  DC-EDITB-CCYY.
   429                 24  DC-EDITB-CENT     PIC 99.
   430                 24  DC-EDITB-YEAR     PIC 99.
   431         16  DC-GREG-DATE-CYMD         PIC 9(08).
   432         16  DC-GREG-DATE-CYMD-R REDEFINES
   433                              DC-GREG-DATE-CYMD.
   434             20  DC-CYMD-CEN           PIC 99.
   435             20  DC-CYMD-YEAR          PIC 99.
   436             20  DC-CYMD-MONTH         PIC 99.
   437             20  DC-CYMD-DAY           PIC 99.
   438         16  DC-GREG-DATE-MDCY         PIC 9(08).
   439         16  DC-GREG-DATE-MDCY-R REDEFINES
   440                              DC-GREG-DATE-MDCY.
   441             20  DC-MDCY-MONTH         PIC 99.
   442             20  DC-MDCY-DAY           PIC 99.
   443             20  DC-MDCY-CEN           PIC 99.
   444             20  DC-MDCY-YEAR          PIC 99.
   445    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   446        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   447    12  DC-EL310-DATE                  PIC X(21).
   448    12  FILLER                         PIC X(28).
   449*                                    COPY ELCLOGOF.
   450******************************************************************
   451*                                                                *
   452*                                                                *
   453*                            ELCLOGOF.                           *
   454*                            VMOD=2.001                          *
   455*                                                                *
   456*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   457*                                                                *
   458******************************************************************
   459 01  CLASIC-LOGOFF.
   460     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   461     12  LOGOFF-TEXT.
   462         16  FILLER          PIC X(5)    VALUE SPACES.
   463         16  LOGOFF-MSG.
   464             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   465             20  FILLER      PIC X       VALUE SPACES.
   466             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   467         16  FILLER          PIC X(80)
   468           VALUE '* YOU ARE NOW LOGGED OFF'.
   469         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   470         16  FILLER          PIC X       VALUE QUOTE.
   471         16  LOGOFF-SYS-MSG  PIC X(17)
   472           VALUE 'S CLAS-IC SYSTEM '.
   473     12  TEXT-MESSAGES.
   474         16  UNACCESS-MSG    PIC X(29)
   475             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   476         16  PGMIDERR-MSG    PIC X(17)
   477             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  10
* EL1041.cbl
   478*                                    COPY ELCATTR.
   479******************************************************************
   480*                                                                *
   481*                            ELCATTR.                            *
   482*                            VMOD=2.001                          *
   483*                                                                *
   484*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   485*                                                                *
   486*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   487*                                                                *
   488*                   POS 1   P=PROTECTED                          *
   489*                           U=UNPROTECTED                        *
   490*                           S=ASKIP                              *
   491*                   POS 2   A=ALPHA/NUMERIC                      *
   492*                           N=NUMERIC                            *
   493*                   POS 3   N=NORMAL                             *
   494*                           B=BRIGHT                             *
   495*                           D=DARK                               *
   496*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   497*                           OF=MODIFIED DATA TAG OFF             *
   498*                                                                *
   499*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   500******************************************************************
   501 01  ATTRIBUTE-LIST.
   502     12  AL-PABOF            PIC X       VALUE 'Y'.
   503     12  AL-PABON            PIC X       VALUE 'Z'.
   504     12  AL-PADOF            PIC X       VALUE '%'.
   505     12  AL-PADON            PIC X       VALUE '_'.
   506     12  AL-PANOF            PIC X       VALUE '-'.
   507     12  AL-PANON            PIC X       VALUE '/'.
   508     12  AL-SABOF            PIC X       VALUE '8'.
   509     12  AL-SABON            PIC X       VALUE '9'.
   510     12  AL-SADOF            PIC X       VALUE '@'.
   511     12  AL-SADON            PIC X       VALUE QUOTE.
   512     12  AL-SANOF            PIC X       VALUE '0'.
   513     12  AL-SANON            PIC X       VALUE '1'.
   514     12  AL-UABOF            PIC X       VALUE 'H'.
   515     12  AL-UABON            PIC X       VALUE 'I'.
   516     12  AL-UADOF            PIC X       VALUE '<'.
   517     12  AL-UADON            PIC X       VALUE '('.
   518     12  AL-UANOF            PIC X       VALUE ' '.
   519     12  AL-UANON            PIC X       VALUE 'A'.
   520     12  AL-UNBOF            PIC X       VALUE 'Q'.
   521     12  AL-UNBON            PIC X       VALUE 'R'.
   522     12  AL-UNDOF            PIC X       VALUE '*'.
   523     12  AL-UNDON            PIC X       VALUE ')'.
   524     12  AL-UNNOF            PIC X       VALUE '&'.
   525     12  AL-UNNON            PIC X       VALUE 'J'.
   526*                                    COPY ELCEMIB.
   527******************************************************************
   528*                                                                *
   529*                                                                *
   530*                            ELCEMIB.                            *
   531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   532*                            VMOD=2.005                          *
   533*                                                                *
   534*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   535*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  11
* EL1041.cbl
   536******************************************************************
   537 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   538     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   539     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   540     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   541     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   542     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   543     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   544     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   545     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   546     12  EMI-SWITCH1             PIC X        VALUE '1'.
   547         88  EMI-NO-ERRORS                    VALUE '1'.
   548         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   549         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   550     12  EMI-SWITCH2             PIC X        VALUE '1'.
   551         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   552     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   553         88  EMI-AREA1-EMPTY                  VALUE '1'.
   554         88  EMI-AREA1-FULL                   VALUE '2'.
   555     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   556         88  EMI-AREA2-EMPTY                  VALUE '1'.
   557         88  EMI-AREA2-FULL                   VALUE '2'.
   558     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   559         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   560         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   561         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   562         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   563         88  EMI-BYPASS-FATALS                VALUE 'X'.
   564     12  EMI-ERROR-LINES.
   565         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   566         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   567         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   568         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   569             20  EMI-ERR-CODES OCCURS 10 TIMES.
   570                 24  EMI-ERR-NUM         PIC X(4).
   571                 24  EMI-FILLER          PIC X.
   572                 24  EMI-SEV             PIC X.
   573                 24  FILLER              PIC X.
   574             20  FILLER                  PIC X(02).
   575     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   576         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   577             20  EMI-ERROR-NUMBER    PIC X(4).
   578             20  EMI-FILL            PIC X.
   579             20  EMI-SEVERITY        PIC X.
   580             20  FILLER              PIC X.
   581             20  EMI-ERROR-TEXT.
   582                 24  EMI-TEXT-VARIABLE   PIC X(10).
   583                 24  FILLER          PIC X(55).
   584     12  EMI-SEVERITY-SAVE           PIC X.
   585         88  EMI-NOTE                    VALUE 'N'.
   586         88  EMI-WARNING                 VALUE 'W'.
   587         88  EMI-FORCABLE                VALUE 'F'.
   588         88  EMI-FATAL                   VALUE 'X'.
   589     12  EMI-MESSAGE-FLAG            PIC X.
   590         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   591         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   592     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   593     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  12
* EL1041.cbl
   594         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   595         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   596         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   597     12  FILLER                      PIC X(137)  VALUE SPACES.
   598     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   599     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   600     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   601     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   602*                                    COPY ELCJPFX.
   603******************************************************************
   604*                                                                *
   605*                                                                *
   606*                            ELCJPFX.                            *
   607*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   608*                            VMOD=2.002                          *
   609*                                                                *
   610*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   611*                                                                *
   612*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   613*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   614*        ELCNTL - CONTROL FILE                                   *
   615*        ELMSTR - CLAIM MASTERS                                  *
   616*        ELTRLR - ACTIVITY TRAILERS                              *
   617*        ELCHKQ - CHECK QUE                                      *
   618******************************************************************
   619 01  JOURNAL-RECORD.
   620     12  JP-USER-ID                  PIC X(4).
   621     12  JP-FILE-ID                  PIC X(8).
   622     12  JP-PROGRAM-ID               PIC X(8).
   623     12  JP-RECORD-TYPE              PIC X.
   624         88 JP-ADD              VALUE 'A'.
   625         88 JP-BEFORE-CHANGE    VALUE 'B'.
   626         88 JP-AFTER-CHANGE     VALUE 'C'.
   627         88 JP-DELETE           VALUE 'D'.
   628         88 JP-GENERIC-DELETE   VALUE 'G'.
   629         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   630         88 JP-KEY-CHG-ADD      VALUE 'N'.
   631     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   632     12  JP-RECORD-AREA
   633
   634
   635                                     PIC X(530).
   636*                                    COPY ELCINTF.
   637******************************************************************
   638*                                                                *
   639*                                                                *
   640*                            ELCINTF.                            *
   641*                            VMOD=2.017                          *
   642*                                                                *
   643*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   644*                                                                *
   645*       LENGTH = 1024                                            *
   646*                                                                *
   647******************************************************************
   648*                   C H A N G E   L O G
   649*
   650* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   651*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  13
* EL1041.cbl
   652*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   653* EFFECTIVE    NUMBER
   654*-----------------------------------------------------------------
   655* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   656******************************************************************
   657 01  PROGRAM-INTERFACE-BLOCK.
   658     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   659     12  PI-CALLING-PROGRAM              PIC X(8).
   660     12  PI-SAVED-PROGRAM-1              PIC X(8).
   661     12  PI-SAVED-PROGRAM-2              PIC X(8).
   662     12  PI-SAVED-PROGRAM-3              PIC X(8).
   663     12  PI-SAVED-PROGRAM-4              PIC X(8).
   664     12  PI-SAVED-PROGRAM-5              PIC X(8).
   665     12  PI-SAVED-PROGRAM-6              PIC X(8).
   666     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   667     12  PI-COMPANY-ID                   PIC XXX.
   668     12  PI-COMPANY-CD                   PIC X.
   669
   670     12  PI-COMPANY-PASSWORD             PIC X(8).
   671
   672     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   673
   674     12  PI-CONTROL-IN-PROGRESS.
   675         16  PI-CARRIER                  PIC X.
   676         16  PI-GROUPING                 PIC X(6).
   677         16  PI-STATE                    PIC XX.
   678         16  PI-ACCOUNT                  PIC X(10).
   679         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   680                                         PIC X(10).
   681         16  PI-CLAIM-CERT-GRP.
   682             20  PI-CLAIM-NO             PIC X(7).
   683             20  PI-CERT-NO.
   684                 25  PI-CERT-PRIME       PIC X(10).
   685                 25  PI-CERT-SFX         PIC X.
   686             20  PI-CERT-EFF-DT          PIC XX.
   687         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   688             20  PI-PLAN-CODE            PIC X(2).
   689             20  PI-REVISION-NUMBER      PIC X(3).
   690             20  PI-PLAN-EFF-DT          PIC X(2).
   691             20  PI-PLAN-EXP-DT          PIC X(2).
   692             20  FILLER                  PIC X(11).
   693         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   694             20  PI-OE-REFERENCE-1.
   695                 25  PI-OE-REF-1-PRIME   PIC X(18).
   696                 25  PI-OE-REF-1-SUFF    PIC XX.
   697
   698     12  PI-SESSION-IN-PROGRESS          PIC X.
   699         88  CLAIM-SESSION                   VALUE '1'.
   700         88  CREDIT-SESSION                  VALUE '2'.
   701         88  WARRANTY-SESSION                VALUE '3'.
   702         88  MORTGAGE-SESSION                VALUE '4'.
   703         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   704
   705
   706*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   707
   708     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   709     12  PI-ORIGINAL-COMPANY-CD          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  14
* EL1041.cbl
   710
   711     12  PI-CREDIT-USER                  PIC X.
   712         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   713         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   714
   715     12  PI-CLAIM-USER                   PIC X.
   716         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   717         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   718
   719     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   720         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   721         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   722         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   723         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   724         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   725
   726     12  PI-PROCESSOR-ID                 PIC X(4).
   727
   728     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   729
   730     12  PI-MEMBER-CAPTION               PIC X(10).
   731
   732     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   733         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   734
   735     12  PI-LIFE-OVERRIDE-L1             PIC X.
   736     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   737     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   738     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   739
   740     12  PI-AH-OVERRIDE-L1               PIC X.
   741     12  PI-AH-OVERRIDE-L2               PIC XX.
   742     12  PI-AH-OVERRIDE-L6               PIC X(6).
   743     12  PI-AH-OVERRIDE-L12              PIC X(12).
   744
   745     12  PI-NEW-SYSTEM                   PIC X(2).
   746
   747     12  PI-PRIMARY-CERT-NO              PIC X(11).
   748     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   749         88  PI-USES-PAID-TO                 VALUE '1'.
   750     12  PI-CRDTCRD-SYSTEM.
   751         16  PI-CRDTCRD-USER             PIC X.
   752             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   753             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   754         16  PI-CC-MONTH-END-DT          PIC XX.
   755     12  PI-PROCESSOR-PRINTER            PIC X(4).
   756
   757     12  PI-OE-REFERENCE-2.
   758         16  PI-OE-REF-2-PRIME           PIC X(10).
   759         16  PI-OE-REF-2-SUFF            PIC X.
   760
   761     12  PI-REM-TRM-CALC-OPTION          PIC X.
   762
   763     12  PI-LANGUAGE-TYPE                PIC X.
   764             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   765             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   766             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   767
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  15
* EL1041.cbl
   768     12  PI-POLICY-LINKAGE-IND           PIC X.
   769         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   770         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   771                                                   LOW-VALUES.
   772
   773     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   774     12  PI-CLAIM-PW-SESSION             PIC X(1).
   775         88  PI-CLAIM-CREDIT                 VALUE '1'.
   776         88  PI-CLAIM-CONVEN                 VALUE '2'.
   777
   778     12  PI-PROCESSOR-CSR-IND            PIC X.
   779         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   780         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   781
   782     12  FILLER                          PIC X(3).
   783
   784     12  PI-SYSTEM-LEVEL                 PIC X(145).
   785
   786     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   787         PI-SYSTEM-LEVEL.
   788
   789         16  PI-ENTRY-CODES.
   790             20  PI-ENTRY-CD-1           PIC X.
   791             20  PI-ENTRY-CD-2           PIC X.
   792
   793         16  PI-RETURN-CODES.
   794             20  PI-RETURN-CD-1          PIC X.
   795             20  PI-RETURN-CD-2          PIC X.
   796
   797         16  PI-UPDATE-STATUS-SAVE.
   798             20  PI-UPDATE-BY            PIC X(4).
   799             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   800
   801         16  PI-LOWER-CASE-LETTERS       PIC X.
   802             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   803
   804*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   805*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   806*            88  CARRIER-CLM-CNTL            VALUE '2'.
   807
   808         16  PI-CERT-ACCESS-CONTROL      PIC X.
   809             88  ST-ACCNT-CNTL               VALUE ' '.
   810             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   811             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   812             88  ACCNT-CNTL                  VALUE '3'.
   813             88  CARR-ACCNT-CNTL             VALUE '4'.
   814
   815         16  PI-PROCESSOR-CAP-LIST.
   816             20  PI-SYSTEM-CONTROLS.
   817                24 PI-SYSTEM-DISPLAY     PIC X.
   818                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   819                24 PI-SYSTEM-MODIFY      PIC X.
   820                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   821             20  FILLER                  PIC XX.
   822             20  PI-DISPLAY-CAP          PIC X.
   823                 88  DISPLAY-CAP             VALUE 'Y'.
   824             20  PI-MODIFY-CAP           PIC X.
   825                 88  MODIFY-CAP              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  16
* EL1041.cbl
   826             20  PI-MSG-AT-LOGON-CAP     PIC X.
   827                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   828             20  PI-FORCE-CAP            PIC X.
   829                 88  FORCE-CAP               VALUE 'Y'.
   830
   831         16  PI-PROGRAM-CONTROLS.
   832             20  PI-PGM-PRINT-OPT        PIC X.
   833             20  PI-PGM-FORMAT-OPT       PIC X.
   834             20  PI-PGM-PROCESS-OPT      PIC X.
   835             20  PI-PGM-TOTALS-OPT       PIC X.
   836
   837         16  PI-HELP-INTERFACE.
   838             20  PI-LAST-ERROR-NO        PIC X(4).
   839             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   840
   841         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   842             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   843
   844         16  PI-CR-CONTROL-IN-PROGRESS.
   845             20  PI-CR-CARRIER           PIC X.
   846             20  PI-CR-GROUPING          PIC X(6).
   847             20  PI-CR-STATE             PIC XX.
   848             20  PI-CR-ACCOUNT           PIC X(10).
   849             20  PI-CR-FIN-RESP          PIC X(10).
   850             20  PI-CR-TYPE              PIC X.
   851
   852         16  PI-CR-BATCH-NUMBER          PIC X(6).
   853
   854         16  PI-CR-MONTH-END-DT          PIC XX.
   855
   856         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   857             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   858             88  PI-ZERO-CARRIER             VALUE '1'.
   859             88  PI-ZERO-GROUPING            VALUE '2'.
   860             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   861
   862         16  PI-CARRIER-SECURITY         PIC X.
   863             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   864
   865         16  PI-ACCOUNT-SECURITY         PIC X(10).
   866             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   867             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   868
   869         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   870             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   871                                         INDEXED BY PI-ACCESS-NDX
   872                                         PIC X.
   873
   874         16  PI-GA-BILLING-CONTROL       PIC X.
   875             88  PI-GA-BILLING               VALUE '1'.
   876
   877         16  PI-MAIL-PROCESSING          PIC X.
   878             88  PI-MAIL-YES                 VALUE 'Y'.
   879
   880         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   881
   882         16  PI-AR-SYSTEM.
   883             20  PI-AR-PROCESSING-CNTL   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  17
* EL1041.cbl
   884                 88  PI-AR-PROCESSING        VALUE 'Y'.
   885             20  PI-AR-SUMMARY-CODE      PIC X(6).
   886             20  PI-AR-MONTH-END-DT      PIC XX.
   887
   888         16  PI-MP-SYSTEM.
   889             20  PI-MORTGAGE-USER            PIC X.
   890                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   891                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   892             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   893                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   894                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   895                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   896                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   897                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   898             20  PI-MP-MONTH-END-DT          PIC XX.
   899             20  PI-MP-REFERENCE-NO.
   900                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   901                 24  PI-MP-REFERENCE-SFX     PIC XX.
   902
   903         16  PI-LABEL-CONTROL            PIC X(01).
   904             88  PI-CREATE-LABELS                    VALUE 'Y'.
   905             88  PI-BYPASS-LABELS                    VALUE 'N'.
   906
   907         16  PI-BILL-GROUPING-CODE       PIC X(01).
   908             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   909
   910         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   911             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   912             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   913
   914         16  FILLER                      PIC X(14).
   915
   916     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   917******************************************************************
   918     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   919*                                    COPY ELC1042.
   920******************************************************************
   921*                                                                *
   922*                                                                *
   923*                           ELC1042                              *
   924*                            VMOD=2.002                          *
   925*                                                                *
   926*    NOTE                                                        *
   927*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   928*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   929*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   930*        TO THESE PROGRAMS.                                      *
   931*                                                                *
   932*    NOTE                                                        *
   933*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   934*        USE ONLY!                                               *
   935*                                                                *
   936******************************************************************
   937
   938         16  PI-1042-WA.
   939             20  PI-ACTION       PIC  X(01).
   940                 88 PI-SHOW-MODE           VALUE '1'.
   941                 88 PI-CLEAR-MODE          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  18
* EL1041.cbl
   942                 88 PI-CREATE-MODE         VALUE '3'.
   943             20  PI-COMM-CONTROL PIC  X(12).
   944             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   945             20  PI-EOF-SW       PIC  X(01).
   946                 88  PI-FILE-EOF           VALUE 'Y'.
   947             20  PI-FILETYP      PIC  X(01).
   948             20  PI-FORM-SQUEEZE-CONTROL
   949                                 PIC  X(01).
   950                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   951                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   952             20  PI-LAST-CONTROL PIC  X(12).
   953             20  PI-TEMP-STOR-ITEMS
   954                                 PIC S9(04) COMP.
   955             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   956             20  PI-UPDATE-SW    PIC  9(01).
   957                 88 ANY-UPDATES            VALUE 1.
   958             20  PI-104-SCREEN-SENT-IND
   959                                 PIC  X(01).
   960                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   961                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   962             20  PI-1042-SCREEN-SENT-IND
   963                                 PIC  X(01).
   964                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   965                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   966             20  PI-1042-ARCHIVE-IND
   967                                 PIC  X(01).
   968                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   969             20  FILLER          PIC  X(29).
   970         16  PI-PREV-LETR-KEY        PIC X(15).
   971         16  PI-CURR-LETR-KEY        PIC X(15).
   972         16  PI-UPDATE-DT            PIC XX.
   973         16  PI-ENC-CODES            PIC X(120).
   974         16  PI-SPLIT-SUB            PIC S9(3)  COMP.
   975         16  FILLER                  PIC X(434).
   976*                                    COPY ELCAID.
   977******************************************************************
   978*                                                                *
   979*                            ELCAID.                             *
   980*                            VMOD=2.001                          *
   981*                                                                *
   982*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   983*                                                                *
   984*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   985*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   986******************************************************************
   987
   988 01  DFHAID.
   989   02  DFHNULL   PIC  X  VALUE  ' '.
   990   02  DFHENTER  PIC  X  VALUE  QUOTE.
   991   02  DFHCLEAR  PIC  X  VALUE  '_'.
   992   02  DFHPEN    PIC  X  VALUE  '='.
   993   02  DFHOPID   PIC  X  VALUE  'W'.
   994   02  DFHPA1    PIC  X  VALUE  '%'.
   995   02  DFHPA2    PIC  X  VALUE  '>'.
   996   02  DFHPA3    PIC  X  VALUE  ','.
   997   02  DFHPF1    PIC  X  VALUE  '1'.
   998   02  DFHPF2    PIC  X  VALUE  '2'.
   999   02  DFHPF3    PIC  X  VALUE  '3'.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  19
* EL1041.cbl
  1000   02  DFHPF4    PIC  X  VALUE  '4'.
  1001   02  DFHPF5    PIC  X  VALUE  '5'.
  1002   02  DFHPF6    PIC  X  VALUE  '6'.
  1003   02  DFHPF7    PIC  X  VALUE  '7'.
  1004   02  DFHPF8    PIC  X  VALUE  '8'.
  1005   02  DFHPF9    PIC  X  VALUE  '9'.
  1006   02  DFHPF10   PIC  X  VALUE  ':'.
  1007   02  DFHPF11   PIC  X  VALUE  '#'.
  1008   02  DFHPF12   PIC  X  VALUE  '@'.
  1009   02  DFHPF13   PIC  X  VALUE  'A'.
  1010   02  DFHPF14   PIC  X  VALUE  'B'.
  1011   02  DFHPF15   PIC  X  VALUE  'C'.
  1012   02  DFHPF16   PIC  X  VALUE  'D'.
  1013   02  DFHPF17   PIC  X  VALUE  'E'.
  1014   02  DFHPF18   PIC  X  VALUE  'F'.
  1015   02  DFHPF19   PIC  X  VALUE  'G'.
  1016   02  DFHPF20   PIC  X  VALUE  'H'.
  1017   02  DFHPF21   PIC  X  VALUE  'I'.
  1018*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1019   02  DFHPF22   PIC  X  VALUE  '['.
  1020   02  DFHPF23   PIC  X  VALUE  '.'.
  1021   02  DFHPF24   PIC  X  VALUE  '<'.
  1022   02  DFHMSRE   PIC  X  VALUE  'X'.
  1023   02  DFHSTRF   PIC  X  VALUE  'h'.
  1024   02  DFHTRIG   PIC  X  VALUE  '"'.
  1025 01  FILLER    REDEFINES DFHAID.
  1026     12  FILLER                      PIC X(08).
  1027     12  PF-VALUES                   PIC X         OCCURS 24.
  1028*                                    COPY EL1041S.
  1029 01  EL104ZI.
  1030     05  FILLER            PIC  X(0012).
  1031*    -------------------------------
  1032     05  DATEL PIC S9(0004) COMP.
  1033     05  DATEF PIC  X(0001).
  1034     05  FILLER REDEFINES DATEF.
  1035         10  DATEA PIC  X(0001).
  1036     05  FILLER            PIC  X(3).
  1037     05  DATEI PIC  X(0008).
  1038*    -------------------------------
  1039     05  TIMEL PIC S9(0004) COMP.
  1040     05  TIMEF PIC  X(0001).
  1041     05  FILLER REDEFINES TIMEF.
  1042         10  TIMEA PIC  X(0001).
  1043     05  FILLER            PIC  X(3).
  1044     05  TIMEI PIC  X(0005).
  1045*    -------------------------------
  1046     05  CMPNYIDL PIC S9(0004) COMP.
  1047     05  CMPNYIDF PIC  X(0001).
  1048     05  FILLER REDEFINES CMPNYIDF.
  1049         10  CMPNYIDA PIC  X(0001).
  1050     05  FILLER            PIC  X(3).
  1051     05  CMPNYIDI PIC  X(0003).
  1052*    -------------------------------
  1053     05  USERIDL PIC S9(0004) COMP.
  1054     05  USERIDF PIC  X(0001).
  1055     05  FILLER REDEFINES USERIDF.
  1056         10  USERIDA PIC  X(0001).
  1057     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  20
* EL1041.cbl
  1058     05  USERIDI PIC  X(0004).
  1059*    -------------------------------
  1060     05  MAINTL PIC S9(0004) COMP.
  1061     05  MAINTF PIC  X(0001).
  1062     05  FILLER REDEFINES MAINTF.
  1063         10  MAINTA PIC  X(0001).
  1064     05  FILLER            PIC  X(3).
  1065     05  MAINTI PIC  X(0001).
  1066*    -------------------------------
  1067     05  LSTUSRL PIC S9(0004) COMP.
  1068     05  LSTUSRF PIC  X(0001).
  1069     05  FILLER REDEFINES LSTUSRF.
  1070         10  LSTUSRA PIC  X(0001).
  1071     05  FILLER            PIC  X(3).
  1072     05  LSTUSRI PIC  X(0004).
  1073*    -------------------------------
  1074     05  LSTDTEL PIC S9(0004) COMP.
  1075     05  LSTDTEF PIC  X(0001).
  1076     05  FILLER REDEFINES LSTDTEF.
  1077         10  LSTDTEA PIC  X(0001).
  1078     05  FILLER            PIC  X(3).
  1079     05  LSTDTEI PIC  X(0008).
  1080*    -------------------------------
  1081     05  LSTTIMEL PIC S9(0004) COMP.
  1082     05  LSTTIMEF PIC  X(0001).
  1083     05  FILLER REDEFINES LSTTIMEF.
  1084         10  LSTTIMEA PIC  X(0001).
  1085     05  FILLER            PIC  X(3).
  1086     05  LSTTIMEI PIC  X(0005).
  1087*    -------------------------------
  1088     05  ZLETRL PIC S9(0004) COMP.
  1089     05  ZLETRF PIC  X(0001).
  1090     05  FILLER REDEFINES ZLETRF.
  1091         10  ZLETRA PIC  X(0001).
  1092     05  FILLER            PIC  X(3).
  1093     05  ZLETRI PIC  X(0004).
  1094*    -------------------------------
  1095     05  ZCOPIESL PIC S9(0004) COMP.
  1096     05  ZCOPIESF PIC  X(0001).
  1097     05  FILLER REDEFINES ZCOPIESF.
  1098         10  ZCOPIESA PIC  X(0001).
  1099     05  FILLER            PIC  X(3).
  1100     05  ZCOPIESI PIC  X(0001).
  1101*    -------------------------------
  1102     05  ZPROMPTL PIC S9(0004) COMP.
  1103     05  ZPROMPTF PIC  X(0001).
  1104     05  FILLER REDEFINES ZPROMPTF.
  1105         10  ZPROMPTA PIC  X(0001).
  1106     05  FILLER            PIC  X(3).
  1107     05  ZPROMPTI PIC  X(0001).
  1108*    -------------------------------
  1109     05  ZENCCDL PIC S9(0004) COMP.
  1110     05  ZENCCDF PIC  X(0001).
  1111     05  FILLER REDEFINES ZENCCDF.
  1112         10  ZENCCDA PIC  X(0001).
  1113     05  FILLER            PIC  X(3).
  1114     05  ZENCCDI PIC  X(0003).
  1115*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  21
* EL1041.cbl
  1116     05  ZRDAYSL PIC S9(0004) COMP.
  1117     05  ZRDAYSF PIC  X(0001).
  1118     05  FILLER REDEFINES ZRDAYSF.
  1119         10  ZRDAYSA PIC  X(0001).
  1120     05  FILLER            PIC  X(3).
  1121     05  ZRDAYSI PIC  X(0003).
  1122*    -------------------------------
  1123     05  ZFORML PIC S9(0004) COMP.
  1124     05  ZFORMF PIC  X(0001).
  1125     05  FILLER REDEFINES ZFORMF.
  1126         10  ZFORMA PIC  X(0001).
  1127     05  FILLER            PIC  X(3).
  1128     05  ZFORMI PIC  X(0004).
  1129*    -------------------------------
  1130     05  ZBENEL PIC S9(0004) COMP.
  1131     05  ZBENEF PIC  X(0001).
  1132     05  FILLER REDEFINES ZBENEF.
  1133         10  ZBENEA PIC  X(0001).
  1134     05  FILLER            PIC  X(3).
  1135     05  ZBENEI PIC  X(0001).
  1136*    -------------------------------
  1137     05  ZCODES1L PIC S9(0004) COMP.
  1138     05  ZCODES1F PIC  X(0001).
  1139     05  FILLER REDEFINES ZCODES1F.
  1140         10  ZCODES1A PIC  X(0001).
  1141     05  FILLER            PIC  X(3).
  1142     05  ZCODES1I PIC  X(0053).
  1143*    -------------------------------
  1144     05  ZCODES2L PIC S9(0004) COMP.
  1145     05  ZCODES2F PIC  X(0001).
  1146     05  FILLER REDEFINES ZCODES2F.
  1147         10  ZCODES2A PIC  X(0001).
  1148     05  FILLER            PIC  X(3).
  1149     05  ZCODES2I PIC  X(0078).
  1150*    -------------------------------
  1151     05  DCCOPTL PIC S9(0004) COMP.
  1152     05  DCCOPTF PIC  X(0001).
  1153     05  FILLER REDEFINES DCCOPTF.
  1154         10  DCCOPTA PIC  X(0001).
  1155     05  FILLER            PIC  X(3).
  1156     05  DCCOPTI PIC  X(0035).
  1157*    -------------------------------
  1158     05  ZFADAYSL PIC S9(0004) COMP.
  1159     05  ZFADAYSF PIC  X(0001).
  1160     05  FILLER REDEFINES ZFADAYSF.
  1161         10  ZFADAYSA PIC  X(0001).
  1162     05  FILLER            PIC  X(3).
  1163     05  ZFADAYSI PIC  X(0003).
  1164*    -------------------------------
  1165     05  ZACLOSEL PIC S9(0004) COMP.
  1166     05  ZACLOSEF PIC  X(0001).
  1167     05  FILLER REDEFINES ZACLOSEF.
  1168         10  ZACLOSEA PIC  X(0001).
  1169     05  FILLER            PIC  X(3).
  1170     05  ZACLOSEI PIC  X(0001).
  1171*    -------------------------------
  1172     05  ERRMSGL PIC S9(0004) COMP.
  1173     05  ERRMSGF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  22
* EL1041.cbl
  1174     05  FILLER REDEFINES ERRMSGF.
  1175         10  ERRMSGA PIC  X(0001).
  1176     05  FILLER            PIC  X(3).
  1177     05  ERRMSGI PIC  X(0072).
  1178*    -------------------------------
  1179     05  PFKEYL PIC S9(0004) COMP.
  1180     05  PFKEYF PIC  X(0001).
  1181     05  FILLER REDEFINES PFKEYF.
  1182         10  PFKEYA PIC  X(0001).
  1183     05  FILLER            PIC  X(3).
  1184     05  PFKEYI PIC  99.
  1185 01  EL104ZO REDEFINES EL104ZI.
  1186     05  FILLER            PIC  X(0012).
  1187*    -------------------------------
  1188     05  FILLER            PIC  X(3).
  1189     05  DATEC PIC  X(0001).
  1190     05  DATEH PIC  X(0001).
  1191     05  DATEU PIC  X(0001).
  1192     05  DATEO PIC  X(0008).
  1193*    -------------------------------
  1194     05  FILLER            PIC  X(3).
  1195     05  TIMEC PIC  X(0001).
  1196     05  TIMEH PIC  X(0001).
  1197     05  TIMEU PIC  X(0001).
  1198     05  TIMEO PIC  99.99.
  1199*    -------------------------------
  1200     05  FILLER            PIC  X(3).
  1201     05  CMPNYIDC PIC  X(0001).
  1202     05  CMPNYIDH PIC  X(0001).
  1203     05  CMPNYIDU PIC  X(0001).
  1204     05  CMPNYIDO PIC  X(0003).
  1205*    -------------------------------
  1206     05  FILLER            PIC  X(3).
  1207     05  USERIDC PIC  X(0001).
  1208     05  USERIDH PIC  X(0001).
  1209     05  USERIDU PIC  X(0001).
  1210     05  USERIDO PIC  X(0004).
  1211*    -------------------------------
  1212     05  FILLER            PIC  X(3).
  1213     05  MAINTC PIC  X(0001).
  1214     05  MAINTH PIC  X(0001).
  1215     05  MAINTU PIC  X(0001).
  1216     05  MAINTO PIC  X(0001).
  1217*    -------------------------------
  1218     05  FILLER            PIC  X(3).
  1219     05  LSTUSRC PIC  X(0001).
  1220     05  LSTUSRH PIC  X(0001).
  1221     05  LSTUSRU PIC  X(0001).
  1222     05  LSTUSRO PIC  X(0004).
  1223*    -------------------------------
  1224     05  FILLER            PIC  X(3).
  1225     05  LSTDTEC PIC  X(0001).
  1226     05  LSTDTEH PIC  X(0001).
  1227     05  LSTDTEU PIC  X(0001).
  1228     05  LSTDTEO PIC  X(0008).
  1229*    -------------------------------
  1230     05  FILLER            PIC  X(3).
  1231     05  LSTTIMEC PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  23
* EL1041.cbl
  1232     05  LSTTIMEH PIC  X(0001).
  1233     05  LSTTIMEU PIC  X(0001).
  1234     05  LSTTIMEO PIC  99.99.
  1235*    -------------------------------
  1236     05  FILLER            PIC  X(3).
  1237     05  ZLETRC PIC  X(0001).
  1238     05  ZLETRH PIC  X(0001).
  1239     05  ZLETRU PIC  X(0001).
  1240     05  ZLETRO PIC  X(0004).
  1241*    -------------------------------
  1242     05  FILLER            PIC  X(3).
  1243     05  ZCOPIESC PIC  X(0001).
  1244     05  ZCOPIESH PIC  X(0001).
  1245     05  ZCOPIESU PIC  X(0001).
  1246     05  ZCOPIESO PIC  9.
  1247*    -------------------------------
  1248     05  FILLER            PIC  X(3).
  1249     05  ZPROMPTC PIC  X(0001).
  1250     05  ZPROMPTH PIC  X(0001).
  1251     05  ZPROMPTU PIC  X(0001).
  1252     05  ZPROMPTO PIC  X(0001).
  1253*    -------------------------------
  1254     05  FILLER            PIC  X(3).
  1255     05  ZENCCDC PIC  X(0001).
  1256     05  ZENCCDH PIC  X(0001).
  1257     05  ZENCCDU PIC  X(0001).
  1258     05  ZENCCDO PIC  X(0003).
  1259*    -------------------------------
  1260     05  FILLER            PIC  X(3).
  1261     05  ZRDAYSC PIC  X(0001).
  1262     05  ZRDAYSH PIC  X(0001).
  1263     05  ZRDAYSU PIC  X(0001).
  1264     05  ZRDAYSO PIC  999.
  1265*    -------------------------------
  1266     05  FILLER            PIC  X(3).
  1267     05  ZFORMC PIC  X(0001).
  1268     05  ZFORMH PIC  X(0001).
  1269     05  ZFORMU PIC  X(0001).
  1270     05  ZFORMO PIC  X(0004).
  1271*    -------------------------------
  1272     05  FILLER            PIC  X(3).
  1273     05  ZBENEC PIC  X(0001).
  1274     05  ZBENEH PIC  X(0001).
  1275     05  ZBENEU PIC  X(0001).
  1276     05  ZBENEO PIC  X(0001).
  1277*    -------------------------------
  1278     05  FILLER            PIC  X(3).
  1279     05  ZCODES1C PIC  X(0001).
  1280     05  ZCODES1H PIC  X(0001).
  1281     05  ZCODES1U PIC  X(0001).
  1282     05  ZCODES1O PIC  X(0053).
  1283*    -------------------------------
  1284     05  FILLER            PIC  X(3).
  1285     05  ZCODES2C PIC  X(0001).
  1286     05  ZCODES2H PIC  X(0001).
  1287     05  ZCODES2U PIC  X(0001).
  1288     05  ZCODES2O PIC  X(0078).
  1289*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  24
* EL1041.cbl
  1290     05  FILLER            PIC  X(3).
  1291     05  DCCOPTC PIC  X(0001).
  1292     05  DCCOPTH PIC  X(0001).
  1293     05  DCCOPTU PIC  X(0001).
  1294     05  DCCOPTO PIC  X(0035).
  1295*    -------------------------------
  1296     05  FILLER            PIC  X(3).
  1297     05  ZFADAYSC PIC  X(0001).
  1298     05  ZFADAYSH PIC  X(0001).
  1299     05  ZFADAYSU PIC  X(0001).
  1300     05  ZFADAYSO PIC  999.
  1301*    -------------------------------
  1302     05  FILLER            PIC  X(3).
  1303     05  ZACLOSEC PIC  X(0001).
  1304     05  ZACLOSEH PIC  X(0001).
  1305     05  ZACLOSEU PIC  X(0001).
  1306     05  ZACLOSEO PIC  X(0001).
  1307*    -------------------------------
  1308     05  FILLER            PIC  X(3).
  1309     05  ERRMSGC PIC  X(0001).
  1310     05  ERRMSGH PIC  X(0001).
  1311     05  ERRMSGU PIC  X(0001).
  1312     05  ERRMSGO PIC  X(0072).
  1313*    -------------------------------
  1314     05  FILLER            PIC  X(3).
  1315     05  PFKEYC PIC  X(0001).
  1316     05  PFKEYH PIC  X(0001).
  1317     05  PFKEYU PIC  X(0001).
  1318     05  PFKEYO PIC  99.
  1319*    -------------------------------
  1320****************************************************************
  1321*
  1322* Copyright (c) 2007 by Clerity Solutions, Inc.
  1323* All rights reserved.
  1324*
  1325****************************************************************
  1326 01  DFHEIV.
  1327   02  DFHEIV0               PIC X(35).
  1328   02  DFHEIV1               PIC X(08).
  1329   02  DFHEIV2               PIC X(08).
  1330   02  DFHEIV3               PIC X(08).
  1331   02  DFHEIV4               PIC X(06).
  1332   02  DFHEIV5               PIC X(04).
  1333   02  DFHEIV6               PIC X(04).
  1334   02  DFHEIV7               PIC X(02).
  1335   02  DFHEIV8               PIC X(02).
  1336   02  DFHEIV9               PIC X(01).
  1337   02  DFHEIV10              PIC S9(7) COMP-3.
  1338   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1339   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1340   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1341   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1342   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1343   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1344   02  DFHEIV17              PIC X(04).
  1345   02  DFHEIV18              PIC X(04).
  1346   02  DFHEIV19              PIC X(04).
  1347   02  DFHEIV20              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  25
* EL1041.cbl
  1348   02  DFHEIV21              USAGE IS POINTER.
  1349   02  DFHEIV22              USAGE IS POINTER.
  1350   02  DFHEIV23              USAGE IS POINTER.
  1351   02  DFHEIV24              USAGE IS POINTER.
  1352   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1353   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1354   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1355   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1356   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1357   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1358   02  FILLER                PIC X(02).
  1359   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1360   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1361   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1362   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1363   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1364 LINKAGE  SECTION.
  1365*****************************************************************
  1366*                                                               *
  1367* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1368* All rights reserved.                                          *
  1369*                                                               *
  1370*****************************************************************
  1371 01  dfheiblk.
  1372     02  eibtime          pic s9(7) comp-3.
  1373     02  eibdate          pic s9(7) comp-3.
  1374     02  eibtrnid         pic x(4).
  1375     02  eibtaskn         pic s9(7) comp-3.
  1376     02  eibtrmid         pic x(4).
  1377     02  dfheigdi         pic s9(4) comp.
  1378     02  eibcposn         pic s9(4) comp.
  1379     02  eibcalen         pic s9(4) comp.
  1380     02  eibaid           pic x(1).
  1381     02  eibfiller1       pic x(1).
  1382     02  eibfn            pic x(2).
  1383     02  eibfiller2       pic x(2).
  1384     02  eibrcode         pic x(6).
  1385     02  eibfiller3       pic x(2).
  1386     02  eibds            pic x(8).
  1387     02  eibreqid         pic x(8).
  1388     02  eibrsrce         pic x(8).
  1389     02  eibsync          pic x(1).
  1390     02  eibfree          pic x(1).
  1391     02  eibrecv          pic x(1).
  1392     02  eibsend          pic x(1).
  1393     02  eibatt           pic x(1).
  1394     02  eibeoc           pic x(1).
  1395     02  eibfmh           pic x(1).
  1396     02  eibcompl         pic x(1).
  1397     02  eibsig           pic x(1).
  1398     02  eibconf          pic x(1).
  1399     02  eiberr           pic x(1).
  1400     02  eibrldbk         pic x(1).
  1401     02  eiberrcd         pic x(4).
  1402     02  eibsynrb         pic x(1).
  1403     02  eibnodat         pic x(1).
  1404     02  eibfiller5       pic x(2).
  1405     02  eibresp          pic 9(09) comp.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  26
* EL1041.cbl
  1406     02  eibresp2         pic 9(09) comp.
  1407     02  dfheigdj         pic s9(4) comp.
  1408     02  dfheigdk         pic s9(4) comp.
  1409 01  DFHCOMMAREA                     PIC X(1024).
  1410*                                    COPY ELCTEXT.
  1411******************************************************************
  1412*                                                                *
  1413*                                                                *
  1414*                            ELCTEXT.                            *
  1415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1416*                            VMOD=2.008                          *
  1417*                                                                *
  1418*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1419*                                     FORM LETTERS,              *
  1420*                                     CERT FORM DISPLAY.
  1421*                                                                *
  1422*   FILE TYPE = VSAM,KSDS                                        *
  1423*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1424*                                                                *
  1425*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1426*       ALTERNATE INDEX = NONE                                   *
  1427*                                                                *
  1428*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1429*       ALTERNATE INDEX = NONE                                   *
  1430*                                                                *
  1431*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1432*       ALTERNATE INDEX = NONE                                   *
  1433*                                                                *
  1434*   LOG = NO                                                     *
  1435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1436******************************************************************
  1437 01  TEXT-FILES.
  1438     12  TEXT-FILE-ID                PIC XX.
  1439         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1440         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1441         88  HELP-FILE-TEXT             VALUE 'TH'.
  1442
  1443     12  TX-CONTROL-PRIMARY.
  1444         16  TX-COMPANY-CD           PIC X.
  1445             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1446         16  TX-ACCESS-CD-GENL       PIC X(12).
  1447
  1448         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1449             20  TX-LETTER-NO        PIC X(4).
  1450             20  FILLER              PIC X(8).
  1451
  1452         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1453             20  TX-FORM-NO          PIC X(12).
  1454
  1455         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1456             20  TX-HELP-TYPE        PIC X.
  1457                 88  HELP-FOR-GENERAL   VALUE ' '.
  1458                 88  HELP-BY-SCREEN     VALUE 'S'.
  1459                 88  HELP-BY-ERROR      VALUE 'E'.
  1460             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1461                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1462             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1463                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  27
* EL1041.cbl
  1464             20  FILLER              PIC X(4).
  1465
  1466         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1467
  1468     12  TX-PROCESS-CONTROL          PIC XX.
  1469         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1470
  1471     12  TX-TEXT-LINE                PIC X(70).
  1472
  1473     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1474         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1475         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1476         88  TX-VALID-FORM-SQUEEZE-VALUE
  1477                                        VALUE 'Y' ' '.
  1478
  1479     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1480         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1481         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1482         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1483         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1484         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1485         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1486         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1487                                              'K' 'N' ' '
  1488                                              'Z'.
  1489
  1490     12  TX-ARCHIVE-SW               PIC X.
  1491         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1492         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1493         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1494
  1495     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1496     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1497
  1498     12  TX-BSR-CODE                 PIC X.
  1499         88  TX-BSR-LETTER              VALUE 'B'.
  1500         88  TX-NON-BSR-LETTER          VALUE ' '.
  1501
  1502     12  FILLER                      PIC X.
  1503*****************************************************************
  1504*                                    COPY ELCENCC.
  1505******************************************************************
  1506*                                                                *
  1507*                                                                *
  1508*                            ELCENCC                             *
  1509*                            VMOD=2.001                          *
  1510*                                                                *
  1511*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  1512*                                                                *
  1513*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  1514*   A NAPERSOFT DOCUMENT                                         *
  1515*                                                                *
  1516*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  1517*                                                                *
  1518*   FILE TYPE = VSAM,KSDS                                        *
  1519*   RECORD SIZE = 400   RECFORM = FIX                            *
  1520*                                                                *
  1521*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  28
* EL1041.cbl
  1522*                                                                *
  1523*   LOG = NO                                                     *
  1524*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1525*                                                                *
  1526*                                                                *
  1527******************************************************************
  1528*                   C H A N G E   L O G
  1529*
  1530* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1531*-----------------------------------------------------------------
  1532*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1533* EFFECTIVE    NUMBER
  1534*-----------------------------------------------------------------
  1535* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  1536******************************************************************
  1537 01  ENCLOSURE-CODES.
  1538     12  NC-RECORD-ID                      PIC XX.
  1539         88  VALID-NC-ID                      VALUE 'NC'.
  1540     12  NC-CONTROL-PRIMARY.
  1541         16  NC-COMPANY-CD                 PIC X.
  1542         16  NC-REC-TYPE                   PIC X.
  1543             88  NC-CLAIMS                   VALUE '1'.
  1544             88  NC-ADMIN                    VALUE '2'.
  1545         16  NC-ENC-CODE                   PIC X(5).
  1546         16  FILLER                        PIC X(09).
  1547     12  NC-MAINT-INFORMATION.
  1548         16  NC-LAST-MAINT-DT              PIC XX.
  1549         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1550         16  NC-LAST-MAINT-USER            PIC X(4).
  1551         16  FILLER                        PIC XX.
  1552     12  NC-OUTPUT-STACK                   PIC XXX.
  1553     12  NC-ENCLOSURE-LINE                 PIC X(100).
  1554     12  NC-ATTACHMENTS                    PIC X(100).
  1555     12  NC-FUTURE                         PIC X(50).
  1556     12  FILLER                            PIC X(117).
  1557******************************************************************
  1558 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES
  1559                          ENCLOSURE-CODES.
  1560 0000-DFHEXIT SECTION.
  1561     MOVE '9#                    $   ' TO DFHEIV0.
  1562     MOVE 'EL1041' TO DFHEIV1.
  1563     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1564     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1565     MOVE '5'                    TO DC-OPTION-CODE
  1566     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1567     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1568     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1569     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1570     IF EIBCALEN = 0
  1571        GO TO 8800-UNAUTHORIZED-ACCESS.
  1572     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1573     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1574     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1575
  1576* EXEC CICS HANDLE CONDITION
  1577*        DUPREC     (8850-DUPREC)
  1578*        NOTOPEN    (8870-NOTOPEN)
  1579*        NOTFND     (8880-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  29
* EL1041.cbl
  1580*        PGMIDERR   (9600-PGMID-ERROR)
  1581*        ERROR      (9990-ABEND)
  1582*    END-EXEC.
  1583*    MOVE '"$%JIL.               ! " #00001571' TO DFHEIV0
  1584     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1586     MOVE X'2220233030303031353731' TO DFHEIV0(25:11)
  1587     CALL 'kxdfhei1' USING DFHEIV0
  1588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1589
  1590     .
  1591 0150-SET-PROGRAM-SAVES.
  1592     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1593         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1594             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1595             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1596             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1597             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1598             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1599             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1600             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1601             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1602         ELSE
  1603             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1604             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1605             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1606             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1607             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1608             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1609             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1610             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1611     ELSE
  1612         GO TO 0200-RECEIVE.
  1613     DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1614     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1615     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1616     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1617     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1618                                    PI-PREV-LETR-KEY
  1619
  1620     PERFORM 6500-BUILD-CURRENT-CODES THRU 6500-EXIT
  1621
  1622     GO TO 1000-SHOW-LETR-RECORD
  1623     .
  1624 0200-RECEIVE.
  1625     IF EIBAID = DFHCLEAR
  1626        GO TO 9400-CLEAR.
  1627     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1628         MOVE LOW-VALUES             TO  EL104ZI
  1629         MOVE ER-7008                TO  EMI-ERROR
  1630         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1631         MOVE -1                     TO  MAINTL
  1632         GO TO 8200-SEND-DATAONLY.
  1633     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1634         NEXT SENTENCE
  1635     ELSE
  1636
  1637* EXEC CICS READQ TS
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  30
* EL1041.cbl
  1638*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1639*            INTO   (SECURITY-CONTROL)
  1640*            LENGTH (SC-COMM-LENGTH)
  1641*            ITEM   (SC-ITEM)
  1642*        END-EXEC
  1643*    MOVE '*$II   L              ''   #00001624' TO DFHEIV0
  1644     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1645     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1646     MOVE X'2020233030303031363234' TO DFHEIV0(25:11)
  1647     CALL 'kxdfhei1' USING DFHEIV0,
  1648           PI-SECURITY-TEMP-STORE-ID,
  1649           SECURITY-CONTROL,
  1650           SC-COMM-LENGTH,
  1651           SC-ITEM,
  1652           DFHEIV99,
  1653           DFHEIV99
  1654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1655         MOVE SC-CLAIMS-DISPLAY (4)  TO  PI-DISPLAY-CAP
  1656         MOVE SC-CLAIMS-UPDATE  (4)  TO  PI-MODIFY-CAP.
  1657
  1658* EXEC CICS RECEIVE
  1659*        MAP      (WS-MAP-NAME)
  1660*        MAPSET   (MAPSET-NAME)
  1661*        INTO     (EL104ZI)
  1662*    END-EXEC
  1663     MOVE LENGTH OF
  1664      EL104ZI
  1665       TO DFHEIV11
  1666*    MOVE '8"T I  L              ''   #00001632' TO DFHEIV0
  1667     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1669     MOVE X'2020233030303031363332' TO DFHEIV0(25:11)
  1670     CALL 'kxdfhei1' USING DFHEIV0,
  1671           WS-MAP-NAME,
  1672           EL104ZI,
  1673           DFHEIV11,
  1674           MAPSET-NAME,
  1675           DFHEIV99,
  1676           DFHEIV99
  1677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1678     IF PFKEYL = +0
  1679         GO TO 0300-CHECK-PFKEYS.
  1680     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1681         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1682     ELSE
  1683         MOVE ER-0029                TO  EMI-ERROR
  1684         GO TO 0320-INPUT-ERROR.
  1685 0300-CHECK-PFKEYS.
  1686     DISPLAY ' MADE IT TO 0300 '
  1687     IF EIBAID EQUAL DFHPF23
  1688         GO TO 8810-PF23.
  1689     IF EIBAID EQUAL DFHPF24
  1690         GO TO 9200-RETURN-MAIN-MENU.
  1691     IF EIBAID EQUAL DFHPF12
  1692         GO TO 9500-PF12.
  1693     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1694         MOVE ER-0050            TO EMI-ERROR
  1695         GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  31
* EL1041.cbl
  1696     IF EIBAID EQUAL DFHENTER
  1697         GO TO 0330-EDIT-DATA.
  1698     MOVE ER-0029                    TO  EMI-ERROR.
  1699 0320-INPUT-ERROR.
  1700     DISPLAY ' MADE IT TO 0320 '
  1701     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1702     MOVE AL-UNBON                   TO  PFKEYA.
  1703     MOVE -1                         TO  PFKEYL.
  1704     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  32
* EL1041.cbl
  1706 0330-EDIT-DATA.
  1707     IF NOT DISPLAY-CAP
  1708         MOVE 'READ'                 TO  SM-READ
  1709         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1710         MOVE ER-0070                TO  EMI-ERROR
  1711         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1712         MOVE -1                     TO  MAINTL
  1713         GO TO 8100-SEND-INITIAL-MAP.
  1714     IF MAINTI EQUAL 'S'
  1715        GO TO 1000-SHOW-LETR-RECORD.
  1716     IF MAINTI = 'C' OR 'A'
  1717        IF NOT MODIFY-CAP
  1718           PERFORM 9995-SECURITY-VIOLATION
  1719                                 THRU 9995-EXIT
  1720           MOVE ER-0070          TO EMI-ERROR
  1721           PERFORM 9900-ERROR-FORMAT
  1722                                 THRU 9900-EXIT
  1723           MOVE LOW-VALUES       TO EL104ZO
  1724           MOVE -1               TO MAINTL
  1725           GO TO 8100-SEND-INITIAL-MAP
  1726        END-IF
  1727     END-IF
  1728     IF MAINTI = 'C'
  1729        GO TO 2000-CHANGE-LETR-RECORD
  1730     END-IF
  1731     IF MAINTI = 'A'
  1732        GO TO 3000-ADD-LETR-RECORD
  1733     END-IF
  1734     MOVE ER-0023                    TO  EMI-ERROR.
  1735     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1736     MOVE -1                         TO  MAINTL.
  1737     MOVE AL-UABON                   TO  MAINTA.
  1738     GO TO 8200-SEND-DATAONLY.
  1739 1000-SHOW-LETR-RECORD.
  1740     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1741
  1742* EXEC CICS STARTBR
  1743*        DATASET   (ELLETR-FILE-ID)
  1744*        RIDFLD    (ELLETR-KEY)
  1745*        GTEQ
  1746*        RESP      (WS-RESPONSE)
  1747*    END-EXEC
  1748     MOVE 0
  1749       TO DFHEIV11
  1750*    MOVE '&,         G          &  N#00001700' TO DFHEIV0
  1751     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1752     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1753     MOVE X'204E233030303031373030' TO DFHEIV0(25:11)
  1754     CALL 'kxdfhei1' USING DFHEIV0,
  1755           ELLETR-FILE-ID,
  1756           ELLETR-KEY,
  1757           DFHEIV99,
  1758           DFHEIV11,
  1759           DFHEIV99
  1760     MOVE EIBRESP  TO WS-RESPONSE
  1761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1762     IF RESP-NORMAL
  1763        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  33
* EL1041.cbl
  1764           OR WE-FOUND-IT
  1765
  1766* EXEC CICS READNEXT
  1767*              DATASET    (ELLETR-FILE-ID)
  1768*              SET        (ADDRESS OF TEXT-FILES)
  1769*              RIDFLD     (ELLETR-KEY)
  1770*              RESP       (WS-RESPONSE)
  1771*          END-EXEC
  1772     MOVE 0
  1773       TO DFHEIV11
  1774*    MOVE '&.S                   )  N#00001709' TO DFHEIV0
  1775     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1776     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1777     MOVE X'204E233030303031373039' TO DFHEIV0(25:11)
  1778     CALL 'kxdfhei1' USING DFHEIV0,
  1779           ELLETR-FILE-ID,
  1780           DFHEIV20,
  1781           DFHEIV99,
  1782           ELLETR-KEY,
  1783           DFHEIV99,
  1784           DFHEIV11,
  1785           DFHEIV99,
  1786           DFHEIV99
  1787     SET ADDRESS OF TEXT-FILES TO
  1788         DFHEIV20
  1789     MOVE EIBRESP  TO WS-RESPONSE
  1790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1791           IF (RESP-NORMAL)
  1792              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1793              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1794                 SET WE-FOUND-IT   TO TRUE
  1795              END-IF
  1796           ELSE
  1797              SET I-SAY-TO-STOP  TO TRUE
  1798           END-IF
  1799        END-PERFORM
  1800     END-IF
  1801     IF WE-FOUND-IT
  1802        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1803                                    PI-PREV-LETR-KEY
  1804        GO TO 7000-BUILD-OUTPUT-MAP
  1805     END-IF
  1806     MOVE ER-0418                TO EMI-ERROR.
  1807     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1808     MOVE -1                     TO MAINTL
  1809     MOVE 'A'                    TO MAINTI
  1810     MOVE AL-UANON               TO MAINTA
  1811     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1812     MOVE +4                     TO ZLETRL
  1813     MOVE AL-UANON               TO ZLETRA
  1814     GO TO 8100-SEND-INITIAL-MAP
  1815     .
  1816 2000-CHANGE-LETR-RECORD.
  1817     display ' made it to 2000 '
  1818     display ' curr   ' pi-curr-letr-key
  1819     display ' prev   ' pi-prev-letr-key
  1820     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1821        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  34
* EL1041.cbl
  1822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1823        MOVE -1                  TO MAINTL
  1824        GO TO 8200-SEND-DATAONLY
  1825     END-IF
  1826     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1827     IF NOT EMI-NO-ERRORS
  1828         GO TO 8200-SEND-DATAONLY.
  1829     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1830     .
  1831 2000-CHANGE-CONTINUE.
  1832
  1833* EXEC CICS READ
  1834*        DATASET    (ELLETR-FILE-ID)
  1835*        SET        (ADDRESS OF TEXT-FILES)
  1836*        RIDFLD     (ELLETR-KEY)
  1837*        UPDATE
  1838*        RESP       (WS-RESPONSE)
  1839*    END-EXEC
  1840*    MOVE '&"S        EU         (  N#00001756' TO DFHEIV0
  1841     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1842     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1843     MOVE X'204E233030303031373536' TO DFHEIV0(25:11)
  1844     CALL 'kxdfhei1' USING DFHEIV0,
  1845           ELLETR-FILE-ID,
  1846           DFHEIV20,
  1847           DFHEIV99,
  1848           ELLETR-KEY,
  1849           DFHEIV99,
  1850           DFHEIV99,
  1851           DFHEIV99
  1852     SET ADDRESS OF TEXT-FILES TO
  1853         DFHEIV20
  1854     MOVE EIBRESP  TO WS-RESPONSE
  1855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1856     IF RESP-NOTFND
  1857        IF ELLETR-SEQ-NO = +0
  1858           GO TO 3000-CONTINUE-ADD
  1859        END-IF
  1860     END-IF
  1861     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1862        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1863
  1864* EXEC CICS UNLOCK
  1865*            DATASET   (ELLETR-FILE-ID)
  1866*        END-EXEC
  1867*    MOVE '&*                    #   #00001770' TO DFHEIV0
  1868     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1869     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1870     MOVE X'2020233030303031373730' TO DFHEIV0(25:11)
  1871     CALL 'kxdfhei1' USING DFHEIV0,
  1872           ELLETR-FILE-ID,
  1873           DFHEIV99
  1874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1875         MOVE ER-0068                TO  EMI-ERROR
  1876         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1877         GO TO 1000-SHOW-LETR-RECORD.
  1878     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1879     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  35
* EL1041.cbl
  1880     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1881     IF ZCOPIESL > +0
  1882        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1883     END-IF
  1884     IF ZFADAYSL > +0
  1885        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1886     END-IF
  1887     IF ZRDAYSL > +0
  1888        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND-1
  1889     END-IF
  1890     IF ZFORML > +0
  1891        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1892     END-IF
  1893     IF ZPROMPTL > +0
  1894        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1895     END-IF
  1896     IF ZENCCDL > +0
  1897        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1898     END-IF
  1899     IF ZACLOSEL > +0
  1900        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1901     END-IF
  1902     IF ZBENEL > +0
  1903        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1904     END-IF
  1905     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1906     .
  1907 2000-CONTINUE-CHANGE.
  1908     DISPLAY ' ABOUT TO REWRITE '
  1909
  1910* EXEC CICS REWRITE
  1911*        DATASET   (ELLETR-FILE-ID)
  1912*        FROM      (TEXT-FILES)
  1913*    END-EXEC.
  1914     MOVE LENGTH OF
  1915      TEXT-FILES
  1916       TO DFHEIV11
  1917*    MOVE '&& L                  %   #00001807' TO DFHEIV0
  1918     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1919     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1920     MOVE X'2020233030303031383037' TO DFHEIV0(25:11)
  1921     CALL 'kxdfhei1' USING DFHEIV0,
  1922           ELLETR-FILE-ID,
  1923           TEXT-FILES,
  1924           DFHEIV11,
  1925           DFHEIV99
  1926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1927
  1928     MOVE ER-0000                    TO  EMI-ERROR.
  1929     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1930     GO TO 1000-SHOW-LETR-RECORD
  1931     .
  1932 3000-ADD-LETR-RECORD.
  1933     display ' made it to 3000 '
  1934     display ' curr   ' pi-curr-letr-key
  1935     display ' prev   ' pi-prev-letr-key
  1936     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1937     .
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  36
* EL1041.cbl
  1938 3000-CONTINUE-ADD.
  1939     IF NOT EMI-NO-ERRORS
  1940        GO TO 8200-SEND-DATAONLY
  1941     END-IF
  1942     MOVE SPACES                 TO ELLETR-KEY
  1943     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  1944     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  1945     MOVE +0                     TO ELLETR-SEQ-NO
  1946
  1947* EXEC CICS READ
  1948*        DATASET    (ELLETR-FILE-ID)
  1949*        SET        (ADDRESS OF TEXT-FILES)
  1950*        RIDFLD     (ELLETR-KEY)
  1951*        GTEQ
  1952*        RESP       (WS-RESPONSE)
  1953*    END-EXEC
  1954*    MOVE '&"S        G          (  N#00001829' TO DFHEIV0
  1955     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  1956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1957     MOVE X'204E233030303031383239' TO DFHEIV0(25:11)
  1958     CALL 'kxdfhei1' USING DFHEIV0,
  1959           ELLETR-FILE-ID,
  1960           DFHEIV20,
  1961           DFHEIV99,
  1962           ELLETR-KEY,
  1963           DFHEIV99,
  1964           DFHEIV99,
  1965           DFHEIV99
  1966     SET ADDRESS OF TEXT-FILES TO
  1967         DFHEIV20
  1968     MOVE EIBRESP  TO WS-RESPONSE
  1969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1970     IF RESP-NORMAL
  1971        IF TX-LETTER-NO = ZLETRI
  1972           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  1973              MOVE ER-0132       TO EMI-ERROR
  1974              PERFORM 9900-ERROR-FORMAT
  1975                                 THRU 9900-EXIT
  1976              MOVE -1            TO ZLETRL
  1977              MOVE AL-UABON      TO ZLETRA
  1978              GO TO 8200-SEND-DATAONLY
  1979           ELSE
  1980              MOVE +0            TO WS-SEQ-NO-TO-USE
  1981           END-IF
  1982        ELSE
  1983           MOVE +1               TO WS-SEQ-NO-TO-USE
  1984        END-IF
  1985     ELSE
  1986        MOVE +1                  TO WS-SEQ-NO-TO-USE
  1987     END-IF
  1988
  1989* EXEC CICS GETMAIN
  1990*       SET(ADDRESS OF TEXT-FILES)
  1991*       LENGTH(ELLETR-LENGTH)
  1992*    END-EXEC
  1993*    MOVE '," L                  $   #00001854' TO DFHEIV0
  1994     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  1995     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  37
* EL1041.cbl
  1996     MOVE X'2020233030303031383534' TO DFHEIV0(25:11)
  1997     CALL 'kxdfhei1' USING DFHEIV0,
  1998           DFHEIV20,
  1999           ELLETR-LENGTH,
  2000           DFHEIV99
  2001     SET ADDRESS OF TEXT-FILES TO
  2002         DFHEIV20
  2003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2004     MOVE SPACES                 TO TEXT-FILES
  2005     MOVE 'TL'                   TO TEXT-FILE-ID
  2006     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2007     MOVE ZLETRI                 TO TX-LETTER-NO
  2008     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2009     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2010     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2011     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2012     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2013     IF ZCOPIESL > +0
  2014        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2015     ELSE
  2016        MOVE 1                   TO W-NUMBER-OF-COPIES
  2017     END-IF
  2018     IF ZFADAYSL > +0
  2019        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2020     ELSE
  2021        MOVE ZEROS               TO W-DAYS-TO-FOLLOW-UP
  2022     END-IF
  2023     IF ZRDAYSL > +0
  2024        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND-1
  2025     ELSE
  2026        MOVE ZEROS               TO W-DAYS-TO-RESEND-1
  2027     END-IF
  2028     IF ZFORML > +0
  2029        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2030     END-IF
  2031     IF ZPROMPTL > +0
  2032        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2033     END-IF
  2034     IF ZENCCDL > +0
  2035        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2036     END-IF
  2037     IF ZACLOSEL > +0
  2038        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2039     END-IF
  2040     IF ZBENEL > +0
  2041        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2042     END-IF
  2043     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2044     DISPLAY ' ABOUT TO WRITE '
  2045     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2046                                    PI-CURR-LETR-KEY
  2047                                    PI-PREV-LETR-KEY
  2048
  2049* EXEC CICS WRITE
  2050*       DATASET (ELLETR-FILE-ID)
  2051*       FROM    (TEXT-FILES)
  2052*       RIDFLD  (ELLETR-KEY)
  2053*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  38
* EL1041.cbl
  2054     MOVE LENGTH OF
  2055      TEXT-FILES
  2056       TO DFHEIV11
  2057*    MOVE '&$ L                  ''   #00001902' TO DFHEIV0
  2058     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2059     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2060     MOVE X'2020233030303031393032' TO DFHEIV0(25:11)
  2061     CALL 'kxdfhei1' USING DFHEIV0,
  2062           ELLETR-FILE-ID,
  2063           TEXT-FILES,
  2064           DFHEIV11,
  2065           ELLETR-KEY,
  2066           DFHEIV99,
  2067           DFHEIV99
  2068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2069     MOVE ER-0000                    TO  EMI-ERROR.
  2070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2071     GO TO 1000-SHOW-LETR-RECORD
  2072     .
  2073 5000-FIND-NEXT-PROD-RECORD.
  2074*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2075*
  2076*    EXEC CICS STARTBR
  2077*        DATASET   (ELLETR-FILE-ID)
  2078*        RIDFLD    (ELLETR-KEY)
  2079*        GTEQ
  2080*        RESP      (WS-RESPONSE)
  2081*    END-EXEC
  2082*
  2083*    IF NOT RESP-NORMAL
  2084*       MOVE -1                  TO PFKEYL
  2085*       MOVE ER-0130             TO EMI-ERROR
  2086*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2087*       GO TO 8200-SEND-DATAONLY
  2088*    END-IF
  2089     .
  2090 5000-READNEXT-LOOP.
  2091*    EXEC CICS READNEXT
  2092*        DATASET   (ELLETR-FILE-ID)
  2093*        SET       (ADDRESS OF PRODUCT-MASTER)
  2094*        RIDFLD    (ELLETR-KEY)
  2095*        RESP      (WS-RESPONSE)
  2096*    END-EXEC
  2097*
  2098*    IF (NOT RESP-NORMAL)
  2099*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2100*       PERFORM 5000-END-BROWSE
  2101*       MOVE -1                  TO PFKEYL
  2102*       MOVE ER-0130             TO EMI-ERROR
  2103*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2104*       GO TO 1000-SHOW-LETR-RECORD
  2105*    END-IF
  2106*
  2107*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2108*       GO TO 5000-READNEXT-LOOP
  2109*    END-IF
  2110*
  2111*    MOVE ELLETR-KEY             TO PI-PROD-KEY
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  39
* EL1041.cbl
  2112*
  2113*    PERFORM 5000-END-BROWSE
  2114*    GO TO 7000-BUILD-OUTPUT-MAP
  2115     .
  2116 5000-END-BROWSE.
  2117*    EXEC CICS ENDBR
  2118*        DATASET   (ELLETR-FILE-ID)
  2119*    END-EXEC
  2120     .
  2121 5100-FIND-PREV-PROD-RECORD.
  2122*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2123*    IF STATEL > +0
  2124*       MOVE STATEI              TO ELLETR-STATE
  2125*    END-IF
  2126*    IF PRODCDL > +0
  2127*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2128*    END-IF
  2129*    IF BENTYPL > +0
  2130*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2131*    IF BENCODEL > +0
  2132*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2133*    IF EXPDTL IS GREATER THAN +0
  2134*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2135*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2136*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2137*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2138*        ELSE
  2139*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2140*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2141*          END-STRING
  2142*           MOVE 'L'                    TO  DC-OPTION-CODE
  2143*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2144*            IF NO-CONVERSION-ERROR
  2145*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2146*            ELSE
  2147*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2148*
  2149*    EXEC CICS HANDLE CONDITION
  2150*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2151*    END-EXEC.
  2152*
  2153*    EXEC CICS STARTBR
  2154*        DATASET   (ELLETR-FILE-ID)
  2155*        RIDFLD    (ELLETR-KEY)
  2156*        GTEQ
  2157*    END-EXEC.
  2158 5100-READPREV-LOOP.
  2159*    EXEC CICS READPREV
  2160*        DATASET   (ELLETR-FILE-ID)
  2161*        SET       (ADDRESS OF PRODUCT-MASTER)
  2162*        RIDFLD    (ELLETR-KEY)
  2163*    END-EXEC.
  2164*
  2165*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2166*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2167*
  2168*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2169*        GO TO 5100-READPREV-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  40
* EL1041.cbl
  2170*
  2171*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2172*
  2173*    GO TO 7000-BUILD-OUTPUT-MAP.
  2174 5100-END-BROWSE.
  2175*    EXEC CICS ENDBR
  2176*        DATASET   (ELLETR-FILE-ID)
  2177*    END-EXEC.
  2178 5100-UNSUCCESSFUL-SEARCH.
  2179     PERFORM 5100-END-BROWSE.
  2180     MOVE ER-0131                    TO  EMI-ERROR.
  2181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2182     GO TO 1000-SHOW-LETR-RECORD.
  2183     .
  2184 6000-EDIT-INPUT-DATA.
  2185     IF MAINTI = 'A'
  2186        IF ZLETRL > +0
  2187           AND ZLETRI NOT = SPACES
  2188           CONTINUE
  2189        ELSE
  2190           MOVE AL-UNBON         TO ZCOPIESA
  2191           MOVE -1               TO ZCOPIESL
  2192           MOVE ER-0005          TO EMI-ERROR
  2193           PERFORM 9900-ERROR-FORMAT
  2194                                 THRU 9900-EXIT
  2195        END-IF
  2196     END-IF
  2197     IF ZCOPIESL > +0
  2198        IF ZCOPIESI NUMERIC
  2199           CONTINUE
  2200        ELSE
  2201           MOVE AL-UNBON         TO ZCOPIESA
  2202           MOVE -1               TO ZCOPIESL
  2203           MOVE ER-0184          TO EMI-ERROR
  2204           PERFORM 9900-ERROR-FORMAT
  2205                                 THRU 9900-EXIT
  2206        END-IF
  2207     END-IF
  2208     IF ZFADAYSL > +0
  2209        IF ZFADAYSI NUMERIC
  2210           CONTINUE
  2211        ELSE
  2212           MOVE AL-UNBON         TO ZFADAYSA
  2213           MOVE -1               TO ZFADAYSL
  2214           MOVE ER-0491          TO EMI-ERROR
  2215           PERFORM 9900-ERROR-FORMAT
  2216                                 THRU 9900-EXIT
  2217        END-IF
  2218     END-IF
  2219     IF ZRDAYSL > +0
  2220        IF ZRDAYSI NUMERIC
  2221           CONTINUE
  2222        ELSE
  2223           MOVE AL-UNBON         TO ZRDAYSA
  2224           MOVE -1               TO ZRDAYSL
  2225           MOVE ER-0491          TO EMI-ERROR
  2226           PERFORM 9900-ERROR-FORMAT
  2227                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  41
* EL1041.cbl
  2228        END-IF
  2229     END-IF
  2230     IF ZPROMPTL > +0
  2231        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2232           CONTINUE
  2233        ELSE
  2234           MOVE AL-UABON         TO ZPROMPTA
  2235           MOVE -1               TO ZPROMPTL
  2236           MOVE ER-0627          TO EMI-ERROR
  2237           PERFORM 9900-ERROR-FORMAT
  2238                                 THRU 9900-EXIT
  2239        END-IF
  2240     END-IF
  2241     IF MAINTI = 'A'
  2242        AND ZENCCDL <= 0
  2243        MOVE AL-UABON            TO ZENCCDA
  2244        MOVE -1                  TO ZENCCDL
  2245        MOVE ER-1560             TO EMI-ERROR
  2246        PERFORM 9900-ERROR-FORMAT
  2247                                 THRU 9900-EXIT
  2248     END-IF
  2249     IF ZENCCDL > +0
  2250        IF ZENCCDI = '@'
  2251            CONTINUE
  2252        ELSE
  2253           MOVE SPACES             TO ELENCC-KEY
  2254           MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2255           MOVE '1'                TO ELENCC-REC-TYPE
  2256           MOVE ZENCCDI            TO ELENCC-ENC-CODE
  2257
  2258
  2259* EXEC CICS READ
  2260*              DATASET    (ELENCC-FILE-ID)
  2261*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2262*              RIDFLD     (ELENCC-KEY)
  2263*              RESP       (WS-RESPONSE)
  2264*          END-EXEC
  2265*    MOVE '&"S        E          (  N#00002096' TO DFHEIV0
  2266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2268     MOVE X'204E233030303032303936' TO DFHEIV0(25:11)
  2269     CALL 'kxdfhei1' USING DFHEIV0,
  2270           ELENCC-FILE-ID,
  2271           DFHEIV20,
  2272           DFHEIV99,
  2273           ELENCC-KEY,
  2274           DFHEIV99,
  2275           DFHEIV99,
  2276           DFHEIV99
  2277     SET ADDRESS OF ENCLOSURE-CODES TO
  2278         DFHEIV20
  2279     MOVE EIBRESP  TO WS-RESPONSE
  2280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2281
  2282           IF RESP-NORMAL
  2283              CONTINUE
  2284           ELSE
  2285              MOVE AL-UABON         TO ZENCCDA
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  42
* EL1041.cbl
  2286              MOVE -1               TO ZENCCDL
  2287              MOVE ER-1560          TO EMI-ERROR
  2288              PERFORM 9900-ERROR-FORMAT
  2289                                 THRU 9900-EXIT
  2290           END-IF
  2291        END-IF
  2292     END-IF
  2293     IF ZACLOSEL > +0
  2294        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2295           CONTINUE
  2296        ELSE
  2297           MOVE -1               TO ZACLOSEL
  2298           MOVE AL-UABON         TO ZACLOSEA
  2299           MOVE ER-1562          TO EMI-ERROR
  2300           PERFORM 9900-ERROR-FORMAT
  2301                                 THRU 9900-EXIT
  2302        END-IF
  2303     END-IF
  2304     IF ZBENEL > +0
  2305        IF ZBENEI = 'Y' OR 'N' OR ' '
  2306           CONTINUE
  2307        ELSE
  2308           MOVE AL-UABON         TO ZBENEA
  2309           MOVE -1               TO ZBENEL
  2310           MOVE ER-0627          TO EMI-ERROR
  2311           PERFORM 9900-ERROR-FORMAT
  2312                                 THRU 9900-EXIT
  2313        END-IF
  2314     END-IF
  2315     .
  2316 6000-EXIT.
  2317     EXIT.
  2318
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  43
* EL1041.cbl
  2320 6500-BUILD-CURRENT-CODES.
  2321      MOVE SPACES             TO ELENCC-KEY
  2322      MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2323      MOVE '1'                TO ELENCC-REC-TYPE
  2324      MOVE LOW-VALUES         TO ELENCC-ENC-CODE
  2325      MOVE SPACES             TO HOLD-ENC-CODES
  2326      MOVE '@'                TO HOLD-ENC-CODES (1:1)
  2327      MOVE HOLD-ENC-CODES     TO PI-ENC-CODES
  2328
  2329
  2330* EXEC CICS STARTBR
  2331*        DATASET   (ELENCC-FILE-ID)
  2332*        RIDFLD    (ELENCC-KEY)
  2333*        GTEQ
  2334*        RESP      (WS-RESPONSE)
  2335*     END-EXEC
  2336     MOVE 0
  2337       TO DFHEIV11
  2338*    MOVE '&,         G          &  N#00002150' TO DFHEIV0
  2339     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2340     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2341     MOVE X'204E233030303032313530' TO DFHEIV0(25:11)
  2342     CALL 'kxdfhei1' USING DFHEIV0,
  2343           ELENCC-FILE-ID,
  2344           ELENCC-KEY,
  2345           DFHEIV99,
  2346           DFHEIV11,
  2347           DFHEIV99
  2348     MOVE EIBRESP  TO WS-RESPONSE
  2349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2350
  2351      IF RESP-NORMAL
  2352        PERFORM UNTIL DONE-WITH-ENCC
  2353           MOVE PI-ENC-CODES TO HOLD-ENC-CODES
  2354
  2355* EXEC CICS READNEXT
  2356*              DATASET    (ELENCC-FILE-ID)
  2357*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2358*              RIDFLD     (ELENCC-KEY)
  2359*              RESP       (WS-RESPONSE)
  2360*          END-EXEC
  2361     MOVE 0
  2362       TO DFHEIV11
  2363*    MOVE '&.S                   )  N#00002160' TO DFHEIV0
  2364     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2365     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2366     MOVE X'204E233030303032313630' TO DFHEIV0(25:11)
  2367     CALL 'kxdfhei1' USING DFHEIV0,
  2368           ELENCC-FILE-ID,
  2369           DFHEIV20,
  2370           DFHEIV99,
  2371           ELENCC-KEY,
  2372           DFHEIV99,
  2373           DFHEIV11,
  2374           DFHEIV99,
  2375           DFHEIV99
  2376     SET ADDRESS OF ENCLOSURE-CODES TO
  2377         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  44
* EL1041.cbl
  2378     MOVE EIBRESP  TO WS-RESPONSE
  2379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2380           IF (RESP-NORMAL)
  2381              AND (ELENCC-COMPANY-CD = PI-COMPANY-CD)
  2382              AND (ELENCC-REC-TYPE = '1')
  2383                 PERFORM VARYING WS-SUB1 FROM 5 BY -1
  2384                      UNTIL ELENCC-ENC-CODE (WS-SUB1:1) <> ' '
  2385                 END-PERFORM
  2386                 IF WS-SUB1 > 2
  2387                     SUBTRACT +1 FROM WS-SUB1
  2388                 END-IF
  2389                 MOVE ELENCC-ENC-CODE (WS-SUB1:2) TO
  2390                             WS-TEST-STATE
  2391                 IF STATE-SPECIFIC AND
  2392                    ELENCC-ENC-CODE NOT = 'ENV'
  2393                    CONTINUE
  2394                 ELSE
  2395                    STRING HOLD-ENC-CODES DELIMITED BY ' '
  2396                         ','
  2397                         ELENCC-ENC-CODE DELIMITED BY ' '
  2398                    INTO PI-ENC-CODES
  2399                 end-if
  2400           ELSE
  2401              SET DONE-WITH-ENCC  TO TRUE
  2402           END-IF
  2403        END-PERFORM
  2404     END-IF
  2405
  2406     MOVE +53 TO PI-SPLIT-SUB
  2407     PERFORM UNTIL PI-ENC-CODES (PI-SPLIT-SUB:1) = ' ' OR ','
  2408         SUBTRACT +1 FROM PI-SPLIT-SUB
  2409     END-PERFORM
  2410
  2411     .
  2412 6500-EXIT.
  2413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  45
* EL1041.cbl
  2415 7000-BUILD-OUTPUT-MAP.
  2416     MOVE LOW-VALUES             TO EL104ZO
  2417     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2418     MOVE TX-LETTER-NO           TO ZLETRO
  2419     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2420     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2421     MOVE W-DAYS-TO-RESEND-1     TO ZRDAYSO
  2422     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2423     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2424     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2425     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2426     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2427     MOVE PI-SPLIT-SUB           TO WS-SUB1
  2428     COMPUTE WS-SUB2 = PI-SPLIT-SUB + 1
  2429     COMPUTE WS-SUB3 = 120 - PI-SPLIT-SUB
  2430     MOVE PI-ENC-CODES (1:WS-SUB1) TO ZCODES1O
  2431     MOVE PI-ENC-CODES (WS-SUB2:WS-SUB3) TO ZCODES2O
  2432     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2433                                    PI-UPDATE-BY
  2434     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2435                                    DC-BIN-DATE-1
  2436     MOVE ' '                    TO DC-OPTION-CODE
  2437     MOVE +0                     TO DC-ELAPSED-DAYS
  2438                                     DC-ELAPSED-MONTHS.
  2439     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2440     IF NO-CONVERSION-ERROR
  2441        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2442     ELSE
  2443        MOVE LOW-VALUES          TO LSTDTEO
  2444     END-IF
  2445     MOVE -1                     TO MAINTL
  2446     .
  2447 8100-SEND-INITIAL-MAP.
  2448     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2449     MOVE EIBTIME                    TO  TIME-IN.
  2450     MOVE SAVE-DATE                  TO  DATEO.
  2451     MOVE TIME-OUT                   TO  TIMEO
  2452     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2453     MOVE PI-PROCESSOR-ID        TO USERIDO
  2454     IF PI-COMPANY-ID = 'DCC'
  2455        MOVE '6-IU CLM FORM,   7-CONTINUING IU,  ' TO DCCOPTO
  2456     END-IF
  2457
  2458* EXEC CICS SEND
  2459*        MAP      (WS-MAP-NAME)
  2460*        MAPSET   (MAPSET-NAME)
  2461*        FROM     (EL104ZO)
  2462*        ERASE
  2463*        CURSOR
  2464*    END-EXEC.
  2465     MOVE LENGTH OF
  2466      EL104ZO
  2467       TO DFHEIV12
  2468     MOVE -1
  2469       TO DFHEIV11
  2470*    MOVE '8$     CT  E    H L F ,   #00002243' TO DFHEIV0
  2471     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2472     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  46
* EL1041.cbl
  2473     MOVE X'2020233030303032323433' TO DFHEIV0(25:11)
  2474     CALL 'kxdfhei1' USING DFHEIV0,
  2475           WS-MAP-NAME,
  2476           EL104ZO,
  2477           DFHEIV12,
  2478           MAPSET-NAME,
  2479           DFHEIV99,
  2480           DFHEIV99,
  2481           DFHEIV99,
  2482           DFHEIV11,
  2483           DFHEIV99,
  2484           DFHEIV99,
  2485           DFHEIV99
  2486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2487
  2488     MOVE '104Z'                 TO PI-CURRENT-SCREEN-NO
  2489     GO TO 9100-RETURN-TRAN
  2490     .
  2491 8200-SEND-DATAONLY.
  2492     DISPLAY ' MADE IT TO 8200 '
  2493     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2494     MOVE EIBTIME                    TO  TIME-IN.
  2495     MOVE SAVE-DATE                  TO  DATEO.
  2496     MOVE TIME-OUT                   TO  TIMEO.
  2497     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2498     MOVE PI-PROCESSOR-ID        TO USERIDO
  2499
  2500* EXEC CICS SEND
  2501*        MAP      (WS-MAP-NAME)
  2502*        MAPSET   (MAPSET-NAME)
  2503*        FROM     (EL104ZO)
  2504*        DATAONLY
  2505*        CURSOR
  2506*    END-EXEC.
  2507     MOVE LENGTH OF
  2508      EL104ZO
  2509       TO DFHEIV12
  2510     MOVE -1
  2511       TO DFHEIV11
  2512*    MOVE '8$D    CT       H L F ,   #00002261' TO DFHEIV0
  2513     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2514     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2515     MOVE X'2020233030303032323631' TO DFHEIV0(25:11)
  2516     CALL 'kxdfhei1' USING DFHEIV0,
  2517           WS-MAP-NAME,
  2518           EL104ZO,
  2519           DFHEIV12,
  2520           MAPSET-NAME,
  2521           DFHEIV99,
  2522           DFHEIV99,
  2523           DFHEIV99,
  2524           DFHEIV11,
  2525           DFHEIV99,
  2526           DFHEIV99,
  2527           DFHEIV99
  2528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2529
  2530     GO TO 9100-RETURN-TRAN
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  47
* EL1041.cbl
  2531     .
  2532 8300-SEND-TEXT.
  2533
  2534* EXEC CICS SEND TEXT
  2535*        FROM  (LOGOFF-TEXT)
  2536*        LENGTH(LOGOFF-LENGTH)
  2537*        ERASE
  2538*        FREEKB
  2539*    END-EXEC.
  2540*    MOVE '8&      T  E F  H   F -   #00002271' TO DFHEIV0
  2541     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2542     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2543     MOVE X'2020233030303032323731' TO DFHEIV0(25:11)
  2544     CALL 'kxdfhei1' USING DFHEIV0,
  2545           LOGOFF-TEXT,
  2546           LOGOFF-LENGTH,
  2547           DFHEIV99,
  2548           DFHEIV99,
  2549           DFHEIV99,
  2550           DFHEIV99,
  2551           DFHEIV99,
  2552           DFHEIV99,
  2553           DFHEIV99,
  2554           DFHEIV99,
  2555           DFHEIV99,
  2556           DFHEIV99
  2557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2558
  2559
  2560* EXEC CICS RETURN
  2561*        END-EXEC.
  2562*    MOVE '.(                    ''   #00002277' TO DFHEIV0
  2563     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2565     MOVE X'2020233030303032323737' TO DFHEIV0(25:11)
  2566     CALL 'kxdfhei1' USING DFHEIV0,
  2567           DFHEIV99,
  2568           DFHEIV99,
  2569           DFHEIV99,
  2570           DFHEIV99,
  2571           DFHEIV99,
  2572           DFHEIV99
  2573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2574
  2575     .
  2576 8500-DEEDIT.
  2577     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2578                                 TO WS-9V999-OF-DEEDIT
  2579     .
  2580 8500-EXIT.
  2581     EXIT.
  2582 8600-DEEDIT.
  2583     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2584                                 TO WS-NUMVAL-OF-DEEDIT
  2585     .
  2586 8600-EXIT.
  2587     EXIT.
  2588 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  48
* EL1041.cbl
  2589     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2590     GO TO 8300-SEND-TEXT.
  2591 8810-PF23.
  2592     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2593     MOVE XCTL-005                   TO  PGM-NAME.
  2594     GO TO 9300-XCTL.
  2595 8850-DUPREC.
  2596     MOVE ER-0132                    TO  EMI-ERROR.
  2597     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2598     MOVE -1                         TO  MAINTL
  2599     MOVE AL-UABON                   TO  ZLETRA
  2600     GO TO 8100-SEND-INITIAL-MAP.
  2601 8870-NOTOPEN.
  2602     MOVE LOW-VALUES                 TO  EL104ZO.
  2603     MOVE -1                         TO  MAINTL.
  2604     MOVE ER-0701                    TO  EMI-ERROR.
  2605     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2606     GO TO 8100-SEND-INITIAL-MAP.
  2607 8880-NOT-FOUND.
  2608     MOVE ER-0702                    TO  EMI-ERROR.
  2609     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2610     MOVE -1                         TO  MAINTL
  2611     MOVE AL-UABON                   TO  ZLETRA
  2612     GO TO 8100-SEND-INITIAL-MAP.
  2613     .
  2614 9100-RETURN-TRAN.
  2615     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2616
  2617* EXEC CICS RETURN
  2618*        TRANSID    (TRANS-ID)
  2619*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2620*        LENGTH     (PI-COMM-LENGTH)
  2621*    END-EXEC.
  2622*    MOVE '.(CT                  ''   #00002320' TO DFHEIV0
  2623     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2624     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2625     MOVE X'2020233030303032333230' TO DFHEIV0(25:11)
  2626     CALL 'kxdfhei1' USING DFHEIV0,
  2627           TRANS-ID,
  2628           PROGRAM-INTERFACE-BLOCK,
  2629           PI-COMM-LENGTH,
  2630           DFHEIV99,
  2631           DFHEIV99,
  2632           DFHEIV99
  2633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2634
  2635 9200-RETURN-MAIN-MENU.
  2636     MOVE XCTL-626                   TO  PGM-NAME.
  2637     GO TO 9300-XCTL.
  2638 9300-XCTL.
  2639
  2640* EXEC CICS XCTL
  2641*        PROGRAM    (PGM-NAME)
  2642*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2643*        LENGTH     (PI-COMM-LENGTH)
  2644*    END-EXEC.
  2645*    MOVE '.$C                   %   #00002329' TO DFHEIV0
  2646     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  49
* EL1041.cbl
  2647     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2648     MOVE X'2020233030303032333239' TO DFHEIV0(25:11)
  2649     CALL 'kxdfhei1' USING DFHEIV0,
  2650           PGM-NAME,
  2651           PROGRAM-INTERFACE-BLOCK,
  2652           PI-COMM-LENGTH,
  2653           DFHEIV99
  2654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2655
  2656 9400-CLEAR.
  2657     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2658     GO TO 9300-XCTL.
  2659 9500-PF12.
  2660     MOVE XCTL-010                   TO  PGM-NAME.
  2661     GO TO 9300-XCTL.
  2662 9600-PGMID-ERROR.
  2663
  2664* EXEC CICS HANDLE CONDITION
  2665*        PGMIDERR   (8300-SEND-TEXT)
  2666*    END-EXEC.
  2667*    MOVE '"$L                   ! # #00002341' TO DFHEIV0
  2668     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2670     MOVE X'2320233030303032333431' TO DFHEIV0(25:11)
  2671     CALL 'kxdfhei1' USING DFHEIV0
  2672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2673
  2674     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2675     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2676     MOVE XCTL-005                   TO  PGM-NAME.
  2677     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2678     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2679     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  50
* EL1041.cbl
  2681 9700-LINK-DATE-CONVERT.
  2682
  2683* EXEC CICS LINK
  2684*        PROGRAM    ('ELDATCV')
  2685*        COMMAREA   (DATE-CONVERSION-DATA)
  2686*        LENGTH     (DC-COMM-LENGTH)
  2687*    END-EXEC.
  2688     MOVE 'ELDATCV' TO DFHEIV1
  2689*    MOVE '."C                   (   #00002352' TO DFHEIV0
  2690     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2691     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2692     MOVE X'2020233030303032333532' TO DFHEIV0(25:11)
  2693     CALL 'kxdfhei1' USING DFHEIV0,
  2694           DFHEIV1,
  2695           DATE-CONVERSION-DATA,
  2696           DC-COMM-LENGTH,
  2697           DFHEIV99,
  2698           DFHEIV99,
  2699           DFHEIV99,
  2700           DFHEIV99
  2701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2702
  2703 9700-EXIT.
  2704     EXIT.
  2705 9900-ERROR-FORMAT.
  2706     IF NOT EMI-ERRORS-COMPLETE
  2707         MOVE LINK-001               TO  PGM-NAME
  2708
  2709* EXEC CICS LINK
  2710*            PROGRAM    (PGM-NAME)
  2711*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2712*            LENGTH     (EMI-COMM-LENGTH)
  2713*        END-EXEC.
  2714*    MOVE '."C                   (   #00002362' TO DFHEIV0
  2715     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2717     MOVE X'2020233030303032333632' TO DFHEIV0(25:11)
  2718     CALL 'kxdfhei1' USING DFHEIV0,
  2719           PGM-NAME,
  2720           ERROR-MESSAGE-INTERFACE-BLOCK,
  2721           EMI-COMM-LENGTH,
  2722           DFHEIV99,
  2723           DFHEIV99,
  2724           DFHEIV99,
  2725           DFHEIV99
  2726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2727
  2728 9900-EXIT.
  2729     EXIT.
  2730 9990-ABEND.
  2731     MOVE LINK-004                   TO  PGM-NAME.
  2732     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2733
  2734* EXEC CICS LINK
  2735*        PROGRAM   (PGM-NAME)
  2736*        COMMAREA  (EMI-LINE1)
  2737*        LENGTH    (72)
  2738*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  51
* EL1041.cbl
  2739     MOVE 72
  2740       TO DFHEIV11
  2741*    MOVE '."C                   (   #00002372' TO DFHEIV0
  2742     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2743     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2744     MOVE X'2020233030303032333732' TO DFHEIV0(25:11)
  2745     CALL 'kxdfhei1' USING DFHEIV0,
  2746           PGM-NAME,
  2747           EMI-LINE1,
  2748           DFHEIV11,
  2749           DFHEIV99,
  2750           DFHEIV99,
  2751           DFHEIV99,
  2752           DFHEIV99
  2753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2754
  2755     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  52
* EL1041.cbl
  2757 9995-SECURITY-VIOLATION.
  2758*                            COPY ELCSCTP.
  2759******************************************************************
  2760*                                                                *
  2761*                            ELCSCTP                             *
  2762*                            VMOD=2.001                          *
  2763*                                                                *
  2764*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2765******************************************************************
  2766
  2767
  2768     MOVE EIBDATE          TO SM-JUL-DATE.
  2769     MOVE EIBTRMID         TO SM-TERMID.
  2770     MOVE THIS-PGM         TO SM-PGM.
  2771     MOVE EIBTIME          TO TIME-IN.
  2772     MOVE TIME-OUT         TO SM-TIME.
  2773     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2774
  2775
  2776* EXEC CICS LINK
  2777*         PROGRAM  ('EL003')
  2778*         COMMAREA (SECURITY-MESSAGE)
  2779*         LENGTH   (80)
  2780*    END-EXEC.
  2781     MOVE 'EL003' TO DFHEIV1
  2782     MOVE 80
  2783       TO DFHEIV11
  2784*    MOVE '."C                   (   #00002397' TO DFHEIV0
  2785     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2787     MOVE X'2020233030303032333937' TO DFHEIV0(25:11)
  2788     CALL 'kxdfhei1' USING DFHEIV0,
  2789           DFHEIV1,
  2790           SECURITY-MESSAGE,
  2791           DFHEIV11,
  2792           DFHEIV99,
  2793           DFHEIV99,
  2794           DFHEIV99,
  2795           DFHEIV99
  2796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2797
  2798
  2799******************************************************************
  2800
  2801 9995-EXIT.
  2802     EXIT.
  2803
  2804 9999-DFHBACK SECTION.
  2805     MOVE '9%                    "   ' TO DFHEIV0
  2806     MOVE 'EL1041' TO DFHEIV1
  2807     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2808     GOBACK.
  2809 9999-DFHEXIT.
  2810     IF DFHEIGDJ EQUAL 0001
  2811         NEXT SENTENCE
  2812     ELSE IF DFHEIGDJ EQUAL 2
  2813         GO TO 8850-DUPREC,
  2814               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 02-May-13 06:23 Page  53
* EL1041.cbl
  2815               8880-NOT-FOUND,
  2816               9600-PGMID-ERROR,
  2817               9990-ABEND
  2818         DEPENDING ON DFHEIGDI
  2819     ELSE IF DFHEIGDJ EQUAL 3
  2820         GO TO 8300-SEND-TEXT
  2821         DEPENDING ON DFHEIGDI.
  2822     MOVE '9%                    "   ' TO DFHEIV0
  2823     MOVE 'EL1041' TO DFHEIV1
  2824     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2825     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4876     Code:        7772
