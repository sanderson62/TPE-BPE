* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80******************************************************************
    81
    82 ENVIRONMENT DIVISION.
    83
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   4
* EL6311.cbl
    85 DATA DIVISION.
    86 WORKING-STORAGE SECTION.
    87 01  DFH-START PIC X(04).
    88 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    89 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    90 77  FILLER  PIC X(32)  VALUE '********************************'.
    91 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    92 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    93 77  A1                          PIC S999 COMP-3 VALUE +0.
    94 77  N1                          PIC S999 COMP-3 VALUE +0.
    95 77  N2                          PIC S999 COMP-3 VALUE +0.
    96 77  N3                          PIC S999 COMP-3 VALUE +0.
    97 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    98 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    99 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   100     88  REVERSAL                    VALUE 'Y'.
   101 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   102 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   103 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   104 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   105 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   106     88  ERMAIL-FOUND                 VALUE 'Y'.
   107 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   108 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   109 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   110 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   111     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   112 77  ws-stop-sw                  pic x value ' '.
   113     88  i-say-stop                 value 'Y'.
   114 77  ws-check-sw                 pic x value ' '.
   115     88  i-have-checks              value 'Y'.
   116 77  ws-proc-check-sw            pic x value ' '.
   117     88  i-have-processed-checks    value 'Y'.
   118 77  ws-any-check-sw             pic x value ' '.
   119     88  i-have-a-check-period      value 'Y'.
   120 77  ws-chek-browse-sw           pic x value ' '.
   121 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   122 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   123 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   124 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   125 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   126 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   127 01  P pointer.
   128 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   129 01  var-ptr pointer.
   130 01  env-var-len                 pic 9(4)  binary.
   131 01  rc                          pic 9(9)  binary.
   132 01  WS-KIXSYS.
   133     05  WS-KIX-FIL1             PIC X(10).
   134     05  WS-KIX-APPS             PIC X(10).
   135     05  WS-KIX-ENV              PIC X(10).
   136     05  WS-KIX-MYENV            PIC X(10).
   137     05  WS-KIX-SYS              PIC X(10).
   138*    COPY ELCSCTM.
   139******************************************************************
   140*                                                                *
   141*                                                                *
   142*                            ELCSCTM                             *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   5
* EL6311.cbl
   143*                            VMOD=2.001                          *
   144*                                                                *
   145*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   146*                                                                *
   147******************************************************************
   148 01  SECURITY-MESSAGE.
   149     12  FILLER                          PIC X(30)
   150            VALUE '** LOGIC SECURITY VIOLATION -'.
   151     12  SM-READ                         PIC X(6).
   152     12  FILLER                          PIC X(5)
   153            VALUE ' PGM='.
   154     12  SM-PGM                          PIC X(6).
   155     12  FILLER                          PIC X(5)
   156            VALUE ' OPR='.
   157     12  SM-PROCESSOR-ID                 PIC X(4).
   158     12  FILLER                          PIC X(6)
   159            VALUE ' TERM='.
   160     12  SM-TERMID                       PIC X(4).
   161     12  FILLER                          PIC XX   VALUE SPACE.
   162     12  SM-JUL-DATE                     PIC 9(5).
   163     12  FILLER                          PIC X    VALUE SPACE.
   164     12  SM-TIME                         PIC 99.99.
   165
   166
   167*    COPY ELCSCRTY.
   168******************************************************************
   169*                                                                *
   170*                                                                *
   171*                            ELCSCRTY                            *
   172*                            VMOD=2.001                          *
   173*                                                                *
   174*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   175*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   176*        SAVED IN PI-SECURITY-ADDRESS.                           *
   177*                                                                *
   178******************************************************************
   179 01  SECURITY-CONTROL.
   180     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   181     12  FILLER                       PIC XX    VALUE 'SC'.
   182     12  SC-CREDIT-CODES.
   183         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   184             20  SC-CREDIT-DISPLAY    PIC X.
   185             20  SC-CREDIT-UPDATE     PIC X.
   186     12  SC-CLAIMS-CODES.
   187         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   188             20  SC-CLAIMS-DISPLAY    PIC X.
   189             20  SC-CLAIMS-UPDATE     PIC X.
   190
   191 01  WS-VA-NO-COMM-MESS.
   192     12  FILLER                  PIC X(41) VALUE
   193        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   194 01  WS-OC-MESSAGE.
   195     12  FILLER                  PIC X(43) VALUE
   196        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   197     12  WS-OC-DIS-AMT           PIC -----9.99.
   198     12  FILLER                  PIC X(4) VALUE ' ON '.
   199     12  WS-OC-DATE              PIC X(10).
   200 01  WS-DATE-AREA.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   6
* EL6311.cbl
   201     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   202     12  WS-CURRENT-DT.
   203         16  FILLER              PIC X(6)    VALUE SPACES.
   204         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   205     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   206     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   207     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   208
   209 01  STANDARD-AREAS.
   210     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   211     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   212     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   213     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   214     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   215     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   216     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   217     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   218     12  PGM-NAME                PIC X(8).
   219     12  TIME-IN                 PIC S9(7).
   220     12  TIME-OUT-R  REDEFINES TIME-IN.
   221         16  FILLER              PIC X.
   222         16  TIME-OUT            PIC 99V99.
   223         16  FILLER              PIC XX.
   224     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   225     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   226     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   227     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   228     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   229     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   230     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   231     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   232     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   233     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   234     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   235     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   236     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   237     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   238     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   239     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   240     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   241     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   242     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   243     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   244     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   245     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   246     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   247     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   248     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   249     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   250     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   251     12  FILE-ID                 PIC X(8).
   252     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   253     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   254     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   255     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   256     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   257     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   258     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   7
* EL6311.cbl
   259     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   260     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   261     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   262     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   263     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   264     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   265     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   266     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   267
   268 01  WS-PASS-AREA.
   269     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   270     05  WS-PASS-VADS-REC    PIC X(350).
   271*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   272*                                COPY ELCZREC.
   273******************************************************************
   274*                                                                *
   275*                                                                *
   276*                            ELCZREC.                            *
   277*                                                                *
   278*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   279*                                                                *
   280******************************************************************
   281*-----------------------------------------------------------------
   282*                   C H A N G E   L O G
   283*
   284* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   285*-----------------------------------------------------------------
   286*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   287* EFFECTIVE    NUMBER
   288*-----------------------------------------------------------------
   289* 122011    2011022800001  AJRA  NEW FILE
   290* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   291* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   292* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   293* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   294*-----------------------------------------------------------------
   295 01  W-Z-CONTROL-DATA.
   296     05  W-NUMBER-OF-COPIES      PIC  9.
   297     05  FILLER                  PIC  X.
   298     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   299     05  FILLER                  PIC  X.
   300     05  W-DAYS-TO-RESEND        PIC  999.
   301     05  FILLER                  PIC  X.
   302     05  W-FORM-TO-RESEND        PIC  X(4).
   303     05  W-ADD-BAR-CODE          PIC  X.
   304     05  W-PROMPT-LETTER         PIC  X.
   305     05  W-HAS-RETURN-ENV        PIC  X.
   306     05  W-ENCLOSURE-CD          PIC  XXX.
   307     05  W-SIG-FLAG-DEFAULT      PIC  X.
   308     05  W-AUTO-CLOSE-IND        PIC  X.
   309     05  FILLER                  PIC  X.
   310     05  W-LETTER-TO-BENE        PIC  X.
   311     05  FILLER                  PIC  X.
   312     05  W-LETTER-TO-ACCT        PIC  X.
   313     05  FILLER                  PIC  X.
   314     05  W-LETTER-TYPE           PIC  X.
   315     05  FILLER                  PIC  X.
   316     05  W-PRINT-CERTIFICATE     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   8
* EL6311.cbl
   317     05  FILLER                  PIC  X.
   318     05  W-REFUND-REQUIRED       PIC  X.
   319     05  FILLER                  PIC  X.
   320     05  W-ONBASE-CODE           PIC  XX.
   321     05  FILLER                  PIC  X.
   322     05  W-ACCT-SUMM             PIC  X.
   323     05  FILLER                  PIC  X.
   324     05  W-CSO-SUMM              PIC  X.
   325     05  FILLER                  PIC  X.
   326     05  W-REASONS-REQUIRED      PIC  X.
   327     05  FILLER                  PIC  X(29).
   328******************************************************************
   329*                                                                *
   330*              A C C E S S   K E Y S                             *
   331*                                                                *
   332******************************************************************
   333
   334 01  ACCESS-KEYS.
   335     12  ERPYAJ-KEY.
   336         16  ERPYAJ-COMPANY-CD       PIC X.
   337         16  ERPYAJ-CARRIER          PIC X.
   338         16  ERPYAJ-GROUPING         PIC X(6).
   339         16  ERPYAJ-FIN-RESP         PIC X(10).
   340         16  ERPYAJ-ACCOUNT          PIC X(10).
   341         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   342         16  ERPYAJ-TYPE             PIC X.
   343     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   344     12  ELCERT-KEY.
   345         16  ELCERT-COMPANY-CD       PIC X.
   346         16  ELCERT-CARRIER          PIC X.
   347         16  ELCERT-GROUPING         PIC X(6).
   348         16  ELCERT-STATE            PIC XX.
   349         16  ELCERT-ACCOUNT          PIC X(10).
   350         16  ELCERT-CERT-EFF-DT      PIC XX.
   351         16  ELCERT-CERT-NO.
   352             20  ELCERT-CERT-PRIME   PIC X(10).
   353             20  ELCERT-CERT-SFX     PIC X.
   354
   355     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   356     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   357     12  ELCRTO-KEY.
   358         16  ELCRTO-COMPANY-CD       PIC X.
   359         16  ELCRTO-CARRIER          PIC X.
   360         16  ELCRTO-GROUPING         PIC X(6).
   361         16  ELCRTO-STATE            PIC XX.
   362         16  ELCRTO-ACCOUNT          PIC X(10).
   363         16  ELCRTO-CERT-EFF-DT      PIC XX.
   364         16  ELCRTO-CERT-NO.
   365             20  ELCRTO-CERT-PRIME   PIC X(10).
   366             20  ELCRTO-CERT-SFX     PIC X.
   367         16  ELCRTO-RECORD-TYPE      PIC X.
   368         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   369
   370     12  ELCRTT-KEY.
   371         16  ELCRTT-PRIMARY          PIC X(33).
   372         16  ELCRTT-REC-TYPE         PIC X(1).
   373     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   374     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page   9
* EL6311.cbl
   375
   376     12  ERPNDB-KEY.
   377         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   378         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   379         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   380         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   381             ERPNDB-BATCH-SEQ-NO     PIC XX.
   382         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   383
   384     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   385     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   386     12  ERCHEK-KEY.
   387         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   388         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   389         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   390         16  CHEK-STATE              PIC XX      VALUE SPACES.
   391         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   392         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   393         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   394         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   395         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   396     12  ELLETR-KEY.
   397         16  LETR-COMPANY-CD     PIC X.
   398         16  LETR-LETTER-ID      PIC X(4).
   399         16  LETR-FILLER         PIC X(8).
   400         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   401     12  ERPNDM-KEY.
   402         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   403         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   404         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   405         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   406
   407*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   408     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   409*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   410     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   411
   412     12  ERPNDB-ALT-KEY.
   413         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   414         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   415         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   416         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   417         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   418         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   419         16  ERPNDB-CERT-NO.
   420             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   421             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   422         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   423         16  ERPNDB-RECORD-TYPE      PIC X.
   424
   425      12  ERPNDB-CSR-KEY.
   426          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   427          20  ERPNDB-CSR-ID                PIC X(4).
   428          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   429          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   430          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   431
   432     12  ERNOTE-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  10
* EL6311.cbl
   433         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   434         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   435         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   436         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   437         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   438         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   439         16  ERNOTE-CERT-NO.
   440             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   441             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   442
   443     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   444     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   445
   446     12  ERCNOT-KEY.
   447         16  ERCNOT-PART-KEY.
   448             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   449             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   450             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   451             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   452             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   453             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   454             20  ERCNOT-CERT-NO.
   455                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   456                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   457         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   458         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   459
   460     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   461     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   462
   463     12  ERMAIL-KEY.
   464         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   465         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   466         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   467         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   468         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   469         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   470         16  ERMAIL-CERT-NO.
   471             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   472             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   473
   474     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   475     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   476
   477     12  ERRQST-KEY.
   478         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   479         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   480
   481     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   482     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   483
   484     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   485
   486     12  ERLOFC-KEY.
   487         16  ERLOFC-COMPANY-CD          PIC  X.
   488         16  ERLOFC-CARRIER             PIC  X.
   489         16  ERLOFC-GROUPING            PIC  X(6).
   490         16  ERLOFC-STATE               PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  11
* EL6311.cbl
   491         16  ERLOFC-ACCOUNT             PIC  X(10).
   492         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   493*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   494
   495     12  ERACCT-KEY.
   496         16  ERACCT-COMPANY-CD          PIC  X.
   497         16  ERACCT-CARRIER             PIC  X.
   498         16  ERACCT-GROUPING            PIC  X(6).
   499         16  ERACCT-STATE               PIC  XX.
   500         16  ERACCT-ACCOUNT             PIC  X(10).
   501         16  ERACCT-EXP-DT.
   502             20  ERACCT-DT              PIC  XX.
   503             20  ERACCT-FILL            PIC  X(4).
   504
   505     12  ERENDT-KEY.
   506         16  ENDT-COMPANY-CD       PIC X.
   507         16  ENDT-CARRIER          PIC X.
   508         16  ENDT-GROUPING         PIC X(6).
   509         16  ENDT-STATE            PIC XX.
   510         16  ENDT-ACCOUNT          PIC X(10).
   511         16  ENDT-CERT-EFF-DT      PIC XX.
   512         16  ENDT-CERT-PRIME       PIC X(10).
   513         16  ENDT-CERT-SFX         PIC X.
   514         16  ENDT-RECORD-TYPE      PIC X.
   515         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   516
   517 01  WS-ELMSTR-WORK.
   518     12  ELMSTR-KEY.
   519         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   520         16  MSTR-CERT-NO.
   521             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   522             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   523     12  W-CLAIM-KEY.
   524         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   525         16  W-CL-CERT-NO.
   526             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   527             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   528      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   529 01  CANCEL-GEN-PASS-AREA.
   530     05  CG-OPTION-CODE          PIC X.
   531         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   532         88  CG-FLAT-CANCEL        VALUE '1'.
   533         88  CG-CANCEL             VALUE '2'.
   534         88  CG-CANCEL-REISSUE     VALUE '3'.
   535     05  CG-ERROR-CODE           PIC 99.
   536         88  CG-SUCCESS            VALUE 00.
   537         88  CG-DATE-ERROR         VALUE 01.
   538         88  CG-CERT-NOT-FOUND     VALUE 02.
   539         88  CG-AMOUNT-ERROR       VALUE 04.
   540         88  CG-OPTION-ERROR       VALUE 05.
   541         88  CG-PREV-CAN           VALUE 06.
   542         88  CG-INVALID-DATA       VALUE 07.
   543         88  CG-NO-ACCT-MSTR       VALUE 08.
   544         88  CG-SFX-A-EXIST        VALUE 09.
   545         88  CG-MISC-ERROR         VALUE 99.
   546     05  CG-COMPANY-ID           PIC XXX.
   547     05  CG-PROC-ID              PIC XXXX.
   548     05  CG-CURRENT-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  12
* EL6311.cbl
   549     05  CG-MONTH-END-DT         PIC XX.
   550     05  CG-CERT-KEY.
   551         10  CG-CERT-COMPANY-CD  PIC X.
   552         10  CG-CERT-CARRIER     PIC X.
   553         10  CG-CERT-GROUP       PIC X(6).
   554         10  CG-CERT-STATE       PIC XX.
   555         10  CG-CERT-ACCOUNT     PIC X(10).
   556         10  CG-CERT-EFF-DT      PIC XX.
   557         10  CG-CERT-CERT-NO     PIC X(11).
   558     05  CG-LF-CAN-DATA.
   559         10  CG-LF-CAN-DT        PIC XX.
   560         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   561     05  CG-AH-CAN-DATA.
   562         10  CG-AH-CAN-DT        PIC XX.
   563         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   564     05  CG-CERT-PROFILE-DATA.
   565         10  CG-INS-LNAME        PIC X(15).
   566         10  CG-INS-FNAME        PIC X(10).
   567         10  CG-INS-MID-INIT     PIC X.
   568         10  CG-INS-AGE          PIC 99.
   569         10  CG-JNT-LNAME        PIC X(15).
   570         10  CG-JNT-FNAME        PIC X(10).
   571         10  CG-JNT-MID-INIT     PIC X.
   572         10  CG-JNT-AGE          PIC 99.
   573     05  CG-LF-ISS-DATA.
   574         10  CG-LF-BENCD         PIC XX.
   575         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   576         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   577     05  CG-AH-ISS-DATA.
   578         10  CG-AH-BENCD         PIC XX.
   579         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   580     05  CG-BATCH-NO             PIC X(6).
   581     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   582     05  FILLER                  PIC X(306).
   583******************************************************************
   584*                                                                *
   585*            G E N E R A L   W O R K   A R E A                   *
   586*                                                                *
   587******************************************************************
   588
   589 01  WORK-AREA.
   590     12  WS-RESPONSE             PIC S9(8)   COMP.
   591         88  RESP-NORMAL           VALUE +0.
   592         88  resp-file-notfnd      value +12.
   593         88  RESP-NOTFND           VALUE +13.
   594         88  resp-duprec           value +14.
   595         88  resp-dupkey           value +15.
   596         88  resp-invreq           value +16.
   597         88  RESP-NOTOPEN          VALUE +19.
   598         88  RESP-ENDFILE          VALUE +20.
   599         88  resp-lengtherr        value +22.
   600     12  DEEDIT-FIELD            PIC X(15).
   601     12  FILLER          REDEFINES DEEDIT-FIELD.
   602         16  FILLER              PIC X(4).
   603         16  DEEDIT-FIELD-X11    PIC X(11).
   604     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   605                                 PIC S9(15).
   606     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  13
* EL6311.cbl
   607                                 PIC S9(13)V99.
   608     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   609                                 PIC S9(11)V9999.
   610     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   611     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   612     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   613         16  WS-CALC-TERM-WHOLE  PIC S999.
   614         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   615
   616     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   617     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   618         16  WS-HR-MINS          PIC 99V99.
   619         16  FILLER              PIC XX.
   620
   621     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   622     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   623
   624     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   625     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   626
   627     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   628     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   629     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   630     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   631     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   632     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   633     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   634
   635     12  QID.
   636         16  QID-TERM            PIC X(4).
   637         16  FILLER              PIC X(4)    VALUE '607B'.
   638
   639     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   640         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   641
   642     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   643         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   644
   645     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   646         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   647                                         'A'.
   648
   649     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   650
   651     12  WS-NUMERIC-SW           PIC X.
   652        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   653
   654     12  WS-EDIT-CSO-FIELD.
   655         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   656                                 PIC X.
   657
   658     12  WS-SAVE-INPUT-FIELDS.
   659         16  WS-BAGE             PIC 99       VALUE ZERO.
   660*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   661         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   662         16  FILLER REDEFINES WS-BAPR.
   663             20  WS-APR-WHOLE-NUM    PIC 99.
   664             20  WS-APR-DEC          PIC 9999.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  14
* EL6311.cbl
   665         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   666         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   667
   668         16  WS-B-COVERAGE OCCURS 2 TIMES.
   669             20  WS-TERM-IN-DAYS-SW  PIC X.
   670                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   671             20  WS-BTERM        PIC 999       COMP-3.
   672             20  WS-BALT-TERM    PIC 999       COMP-3.
   673             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   674             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   675             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   676             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   677             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   678             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   679
   680         16  WS-C-FIELDS COMP-3.
   681             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   682             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   683             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   684
   685         16  WS-D-FIELDS COMP-3.
   686             20  WS-DRISS        PIC S9(5)    VALUE +0.
   687             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   688             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   689             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   690             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   691             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   692
   693     12  WS-SAVE-BIRTH-DATE.
   694         16  FILLER              PIC X(4)   VALUE SPACES.
   695         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   696
   697     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   698     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   699     12  FILLER REDEFINES WS-WORK-BIN-RED.
   700         16  FILLER              PIC X(02).
   701         16  WS-WORK-BIN-DT      PIC X(02).
   702     12  WS-SW-1                 PIC X     VALUE SPACE.
   703     12  WS-SW-2                 PIC X     VALUE SPACE.
   704     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   705         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   706     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   707         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   708
   709     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   710     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   711     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   712     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   713     12  WS-CONVERTED-CANCEL-DATES.
   714         16  WS-CONVERTED-CANDT1                  PIC XX.
   715         16  WS-CONVERTED-CANDT2                  PIC XX.
   716
   717     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   718
   719     12  WS-REC-FOUND-SW         PIC X.
   720         88  RECORD-NOT-FOUND    VALUE 'N'.
   721
   722     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  15
* EL6311.cbl
   723         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   724         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   725
   726     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   727         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   728         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   729
   730     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   731         88  BROWSE-STARTED      VALUE 'Y'.
   732
   733     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   734         88  FIRST-TIME          VALUE 'Y'.
   735
   736     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   737         88  FIRST-ENTRY         VALUE 'Y'.
   738
   739     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   740         88  REC-BILLED          VALUE 'Y'.
   741
   742     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   743         88  NO-CURSOR-SET       VALUE +0.
   744         88  CURSOR-SET          VALUE +1.
   745
   746     12  WS-ERR-SW               PIC X.
   747         88  STD-ERRORS          VALUE 'S'.
   748         88  TRN-ERRORS          VALUE 'T'.
   749
   750     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   751         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   752
   753     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   754         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   755
   756     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   757         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   758
   759     12  WS-ERR-CODE.
   760         16  FILLER              PIC 99.
   761         16  WS-ERROR-SUB        PIC 99.
   762
   763     12  WS-DATE-WORK.
   764         16  WS-WORK-MM          PIC XX.
   765         16  WS-WORK-DD          PIC XX.
   766         16  WS-WORK-YY          PIC XX.
   767
   768     12  WS-MM-YY.
   769         16  WS-MM               PIC XX.
   770         16  FILLER              PIC X     VALUE '/'.
   771         16  WS-YY               PIC XX.
   772
   773     12  WS-CERT-EFF-DT          PIC XX.
   774
   775     12  WS-MEMBER-NO            PIC X(12).
   776     12  FILLER  REDEFINES  WS-MEMBER-NO.
   777         16  WS-MEMBER-NO-1-8    PIC 9(8).
   778         16  FILLER              PIC X(4).
   779
   780     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  16
* EL6311.cbl
   781
   782     12  WS-ERPNDB-ALT-KEY.
   783         16  WS-PB-COMPANY-CD-A1         PIC X.
   784         16  WS-PB-CARRIER               PIC X.
   785         16  WS-PB-GROUPING              PIC X(6).
   786         16  WS-PB-STATE                 PIC XX.
   787         16  WS-PB-ACCOUNT               PIC X(10).
   788         16  WS-PB-CERT-EFF-DT           PIC XX.
   789         16  WS-PB-CERT-NO.
   790             20  WS-PB-CERT-PRIME        PIC X(10).
   791             20  WS-PB-CERT-SFX          PIC X.
   792         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   793         16  WS-PB-RECORD-TYPE           PIC X.
   794
   795     12  WS-SHOW-SAVE-AREAS.
   796         16  WS-NEW-CERT-NO.
   797             20  WS-NEW-PRIME    PIC X(10).
   798             20  WS-NEW-SUFFIX   PIC X.
   799         16  WS-NEW-CERT-EFF-DT  PIC XX.
   800         16  WS-NEW-RECORD-TYPE  PIC X.
   801         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   802             88   SHOW-RECORD            VALUE 'Y'.
   803
   804     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   805
   806     12  WS-BATCH-NO.
   807         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   808         16  FILLER              PIC X(5) VALUE SPACES.
   809
   810     12  WS-FIRST-NAME.
   811         16  WS-1ST-INIT         PIC X.
   812         16  FILLER              PIC X(9).
   813
   814     12  WS-INITIALS.
   815         16  WS-INITIAL-1        PIC X.
   816         16  WS-INITIAL-2        PIC X.
   817
   818     12  WS-C-HDG.
   819         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   820         16  FILLER              PIC X(4) VALUE '-REF'.
   821
   822     12  WS-D-PREM-HDG.
   823         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   824         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   825
   826     12  WS-D-REFUND-HDG.
   827         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   828         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   829
   830     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   831
   832     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   833     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   834     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   835     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   836     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   837     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   838     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  17
* EL6311.cbl
   839
   840     12  WS-01-CANCEL-ERR        PIC X(25)
   841         VALUE 'CANCEL DATE ERROR'.
   842     12  WS-02-CANCEL-ERR        PIC X(25)
   843         VALUE 'CERT NOT FOUND'.
   844     12  WS-04-CANCEL-ERR        PIC X(25)
   845         VALUE 'CANCEL AMOUNT ERROR'.
   846     12  WS-05-CANCEL-ERR        PIC X(25)
   847         VALUE 'CANCEL OPTION ERROR'.
   848     12  WS-06-CANCEL-ERR        PIC X(25)
   849         VALUE 'PREVIOUSLY CANCELLED'.
   850     12  WS-07-CANCEL-ERR        PIC X(25)
   851         VALUE 'INVALID DATA'.
   852     12  WS-08-CANCEL-ERR        PIC X(25)
   853         VALUE 'NO ACCOUNT MASTER'.
   854     12  WS-09-CANCEL-ERR        PIC X(25)
   855         VALUE 'SUFFIX ALREADY EXISTS'.
   856     12  WS-99-CANCEL-ERR        PIC X(25)
   857         VALUE 'MISC CANCEL ERROR'.
   858
   859     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   860     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   861
   862     12  WS-AGE-FIELDS.
   863         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   864         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   865         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   866         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   867
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  18
* EL6311.cbl
   869
   870******************************************************************
   871*                                                                *
   872*                 B A T C H   T O T A L S                        *
   873*                                                                *
   874******************************************************************
   875
   876     12  WS-BATCH-RECORD.
   877         16  FILLER                       PIC X(10).
   878         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   879         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   880         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   881         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   882         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   883         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   884         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   885         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   886         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   887         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   888         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   889         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   890         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   891         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   892         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   893         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   894         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   895         16  WS-ACCOUNT-NAME              PIC X(30).
   896         16  FILLER                       PIC X.
   897         16  WS-REFERENCE                 PIC X(12).
   898         16  FILLER                       PIC X(197).
   899
   900     12  WS-BATCH-TOTALS.
   901         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   902         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   903         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   904         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   905         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   906         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   907         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   909         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   910         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   911         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   912         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   913         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   914         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   916         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   917         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   918         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   919         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   920
   921     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   922
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  19
* EL6311.cbl
   924
   925******************************************************************
   926*                                                                *
   927*                E R R O R   M E S S A G E S                     *
   928*                                                                *
   929******************************************************************
   930
   931 01  ERROR-MESSAGES.
   932     12  ER-0004                 PIC  9(4) VALUE 0004.
   933     12  ER-0008                 PIC  9(4) VALUE 0008.
   934     12  ER-0023                 PIC  9(4) VALUE 0023.
   935     12  ER-0029                 PIC  9(4) VALUE 0029.
   936     12  ER-0033                 PIC  9(4) VALUE 0033.
   937     12  ER-0070                 PIC  9(4) VALUE 0070.
   938     12  ER-0220                 PIC  9(4) VALUE 0220.
   939     12  ER-0248                 PIC  9(4) VALUE 0248.
   940     12  ER-0280                 PIC  9(4) VALUE 0280.
   941     12  ER-0348                 PIC  9(4) VALUE 0348.
   942     12  ER-0582                 PIC  9(4) VALUE 0582.
   943     12  ER-0877                 PIC  9(4) VALUE 0877.
   944     12  ER-1236                 PIC  9(4) VALUE 1236.
   945     12  ER-1570                 PIC  9(4) VALUE 1570.
   946     12  ER-1575                 PIC  9(4) VALUE 1575.
   947     12  ER-1609                 PIC  9(4) VALUE 1609.
   948     12  ER-1819                 PIC  9(4) VALUE 1819.
   949     12  ER-2077                 PIC  9(4) VALUE 2077.
   950     12  ER-2129                 PIC  9(4) VALUE 2129.
   951     12  ER-2188                 PIC  9(4) VALUE 2188.
   952     12  ER-2192                 PIC  9(4) VALUE 2192.
   953     12  ER-2196                 PIC  9(4) VALUE 2196.
   954     12  ER-2197                 PIC  9(4) VALUE 2197.
   955     12  ER-2198                 PIC  9(4) VALUE 2198.
   956     12  ER-2200                 PIC  9(4) VALUE 2200.
   957     12  ER-2212                 PIC  9(4) VALUE 2212.
   958     12  ER-2218                 PIC  9(4) VALUE 2218.
   959     12  ER-2220                 PIC  9(4) VALUE 2220.
   960     12  ER-2222                 PIC  9(4) VALUE 2222.
   961     12  ER-2223                 PIC  9(4) VALUE 2223.
   962     12  ER-2224                 PIC  9(4) VALUE 2224.
   963     12  ER-2225                 PIC  9(4) VALUE 2225.
   964     12  ER-2226                 PIC  9(4) VALUE 2226.
   965     12  ER-2227                 PIC  9(4) VALUE 2227.
   966     12  ER-2228                 PIC  9(4) VALUE 2228.
   967     12  ER-2240                 PIC  9(4) VALUE 2240.
   968     12  ER-2241                 PIC  9(4) VALUE 2241.
   969     12  ER-2242                 PIC  9(4) VALUE 2242.
   970     12  ER-2243                 PIC  9(4) VALUE 2243.
   971     12  ER-2244                 PIC  9(4) VALUE 2244.
   972     12  ER-2245                 PIC  9(4) VALUE 2245.
   973     12  ER-2246                 PIC  9(4) VALUE 2246.
   974     12  ER-2247                 PIC  9(4) VALUE 2247.
   975     12  ER-2251                 PIC  9(4) VALUE 2251.
   976     12  ER-2252                 PIC  9(4) VALUE 2252.
   977     12  ER-2253                 PIC  9(4) VALUE 2253.
   978     12  ER-2254                 PIC  9(4) VALUE 2254.
   979     12  ER-2255                 PIC  9(4) VALUE 2255.
   980     12  ER-2256                 PIC  9(4) VALUE 2256.
   981     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  20
* EL6311.cbl
   982     12  ER-2258                 PIC  9(4) VALUE 2258.
   983     12  ER-2259                 PIC  9(4) VALUE 2259.
   984     12  ER-2260                 PIC  9(4) VALUE 2260.
   985     12  ER-2261                 PIC  9(4) VALUE 2261.
   986     12  ER-2287                 PIC  9(4) VALUE 2287.
   987     12  ER-2336                 PIC  9(4) VALUE 2336.
   988     12  ER-2337                 PIC  9(4) VALUE 2337.
   989     12  ER-2437                 PIC  9(4) VALUE 2437.
   990     12  ER-2471                 PIC  9(4) VALUE 2471.
   991     12  ER-2530                 PIC  9(4) VALUE 2530.
   992     12  ER-2531                 PIC  9(4) VALUE 2531.
   993     12  ER-2532                 PIC  9(4) VALUE 2532.
   994     12  ER-2533                 PIC  9(4) VALUE 2533.
   995     12  ER-2547                 PIC  9(4) VALUE 2547.
   996     12  ER-2591                 PIC  9(4) VALUE 2591.
   997     12  ER-2592                 PIC  9(4) VALUE 2592.
   998     12  ER-2593                 PIC  9(4) VALUE 2593.
   999     12  ER-2600                 PIC  9(4) VALUE 2600.
  1000     12  ER-2601                 PIC  9(4) VALUE 2601.
  1001     12  ER-2604                 PIC  9(4) VALUE 2604.
  1002     12  ER-2605                 PIC  9(4) VALUE 2605.
  1003     12  ER-2606                 PIC  9(4) VALUE 2606.
  1004     12  ER-2607                 PIC  9(4) VALUE 2607.
  1005     12  ER-2622                 PIC  9(4) VALUE 2622.
  1006     12  ER-2625                 PIC  9(4) VALUE 2625.
  1007     12  ER-2626                 PIC  9(4) VALUE 2626.
  1008     12  ER-2627                 PIC  9(4) VALUE 2627.
  1009     12  ER-2628                 PIC  9(4) VALUE 2628.
  1010     12  ER-2629                 PIC  9(4) VALUE 2629.
  1011     12  ER-2630                 PIC  9(4) VALUE 2630.
  1012     12  ER-2631                 PIC  9(4) VALUE 2631.
  1013     12  ER-2632                 PIC  9(4) VALUE 2632.
  1014     12  ER-2633                 PIC  9(4) VALUE 2633.
  1015     12  ER-2634                 PIC  9(4) VALUE 2634.
  1016     12  ER-2635                 PIC  9(4) VALUE 2635.
  1017     12  ER-2636                 PIC  9(4) VALUE 2636.
  1018     12  ER-2639                 PIC  9(4) VALUE 2639.
  1019     12  ER-2640                 PIC  9(4) VALUE 2640.
  1020     12  ER-2647                 PIC  9(4) VALUE 2647.
  1021     12  ER-2648                 PIC  9(4) VALUE 2648.
  1022     12  ER-2649                 PIC  9(4) VALUE 2649.
  1023     12  ER-2650                 PIC  9(4) VALUE 2650.
  1024     12  ER-2653                 PIC  9(4) VALUE 2653.
  1025     12  ER-2654                 PIC  9(4) VALUE 2654.
  1026     12  ER-2655                 PIC  9(4) VALUE 2655.
  1027     12  ER-2656                 PIC  9(4) VALUE 2656.
  1028     12  ER-2657                 PIC  9(4) VALUE 2657.
  1029     12  ER-2660                 PIC  9(4) VALUE 2660.
  1030     12  ER-2661                 PIC  9(4) VALUE 2661.
  1031     12  ER-2662                 PIC  9(4) VALUE 2662.
  1032     12  ER-2663                 PIC  9(4) VALUE 2663.
  1033     12  ER-2664                 PIC  9(4) VALUE 2664.
  1034     12  ER-2667                 PIC  9(4) VALUE 2667.
  1035     12  ER-2668                 PIC  9(4) VALUE 2668.
  1036     12  ER-2669                 PIC  9(4) VALUE 2669.
  1037     12  ER-2670                 PIC  9(4) VALUE 2670.
  1038     12  ER-2671                 PIC  9(4) VALUE 2671.
  1039     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  21
* EL6311.cbl
  1040     12  ER-2673                 PIC  9(4) VALUE 2673.
  1041     12  ER-2677                 PIC  9(4) VALUE 2677.
  1042     12  ER-2678                 PIC  9(4) VALUE 2678.
  1043     12  ER-2679                 PIC  9(4) VALUE 2679.
  1044     12  ER-2680                 PIC  9(4) VALUE 2680.
  1045     12  ER-2681                 PIC  9(4) VALUE 2681.
  1046     12  ER-2682                 PIC  9(4) VALUE 2682.
  1047     12  ER-2683                 PIC  9(4) VALUE 2683.
  1048     12  ER-2684                 PIC  9(4) VALUE 2684.
  1049     12  ER-2686                 PIC  9(4) VALUE 2686.
  1050     12  ER-2689                 PIC  9(4) VALUE 2689.
  1051     12  ER-2690                 PIC  9(4) VALUE 2690.
  1052     12  ER-2693                 PIC  9(4) VALUE 2693.
  1053     12  ER-2695                 PIC  9(4) VALUE 2695.
  1054     12  ER-2701                 PIC  9(4) VALUE 2701.
  1055     12  ER-2720                 PIC  9(4) VALUE 2720.
  1056     12  ER-2709                 PIC  9(4) VALUE 2709.
  1057     12  ER-2704                 PIC  9(4) VALUE 2704.
  1058     12  ER-2725                 PIC  9(4) VALUE 2725.
  1059     12  ER-2726                 PIC  9(4) VALUE 2726.
  1060     12  ER-2728                 PIC  9(4) VALUE 2728.
  1061     12  ER-2729                 PIC  9(4) VALUE 2729.
  1062     12  ER-2731                 PIC  9(4) VALUE 2731.
  1063     12  ER-2732                 PIC  9(4) VALUE 2732.
  1064     12  ER-2733                 PIC  9(4) VALUE 2733.
  1065     12  ER-2735                 PIC  9(4) VALUE 2735.
  1066     12  ER-2738                 PIC  9(4) VALUE 2738.
  1067     12  ER-2742                 PIC  9(4) VALUE 2742.
  1068     12  ER-2743                 PIC  9(4) VALUE 2743.
  1069     12  ER-2744                 PIC  9(4) VALUE 2744.
  1070     12  ER-2747                 PIC  9(4) VALUE 2747.
  1071     12  ER-2749                 PIC  9(4) VALUE 2749.
  1072     12  ER-2753                 PIC  9(4) VALUE 2753.
  1073     12  ER-2755                 PIC  9(4) VALUE 2755.
  1074     12  ER-2757                 PIC  9(4) VALUE 2757.
  1075     12  ER-2771                 PIC  9(4) VALUE 2771.
  1076     12  ER-2774                 PIC  9(4) VALUE 2774.
  1077     12  ER-2775                 PIC  9(4) VALUE 2775.
  1078     12  ER-2776                 PIC  9(4) VALUE 2776.
  1079     12  ER-2777                 PIC  9(4) VALUE 2777.
  1080     12  ER-2794                 PIC  9(4) VALUE 2794.
  1081     12  ER-2799                 PIC  9(4) VALUE 2799.
  1082     12  ER-2900                 PIC  9(4) VALUE 2900.
  1083     12  ER-2902                 PIC  9(4) VALUE 2902.
  1084     12  ER-2945                 PIC  9(4) VALUE 2945.
  1085     12  ER-3000                 PIC  9(4) VALUE 3000.
  1086     12  ER-3006                 PIC  9(4) VALUE 3006.
  1087     12  ER-3054                 PIC  9(4) VALUE 3054.
  1088     12  ER-3224                 PIC  9(4) VALUE 3224.
  1089     12  ER-3269                 PIC  9(4) VALUE 3269.
  1090     12  er-3444                 pic  9(4) value 3444.
  1091     12  er-3446                 pic  9(4) value 3446.
  1092     12  er-3447                 pic  9(4) value 3447.
  1093     12  er-3448                 pic  9(4) value 3448.
  1094     12  er-3449                 pic  9(4) value 3449.
  1095     12  ER-3456                 PIC  9(4) VALUE 3456.
  1096     12  ER-3457                 PIC  9(4) VALUE 3457.
  1097     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  22
* EL6311.cbl
  1098     12  ER-3504                 PIC  9(4) VALUE 3504.
  1099     12  ER-3513                 PIC  9(4) VALUE 3513.
  1100     12  ER-3831                 PIC  9(4) VALUE 3831.
  1101     12  ER-3834                 PIC  9(4) VALUE 3834.
  1102     12  ER-3835                 PIC  9(4) VALUE 3835.
  1103     12  ER-4005                 PIC  9(4) VALUE 4005.
  1104     12  ER-7144                 PIC  9(4) VALUE 7144.
  1105     12  ER-7401                 PIC  9(4) VALUE 7401.
  1106     12  ER-7402                 PIC  9(4) VALUE 7402.
  1107     12  ER-7403                 PIC  9(4) VALUE 7403.
  1108     12  ER-7404                 PIC  9(4) VALUE 7404.
  1109     12  ER-7423                 PIC  9(4) VALUE 7423.
  1110     12  ER-7424                 PIC  9(4) VALUE 7424.
  1111     12  ER-7433                 PIC  9(4) VALUE 7433.
  1112     12  ER-7450                 PIC  9(4) VALUE 7450.
  1113     12  ER-7451                 PIC  9(4) VALUE 7451.
  1114     12  ER-7530                 PIC  9(4) VALUE 7530.
  1115     12  ER-7573                 PIC  9(4) VALUE 7573.
  1116     12  ER-7631                 PIC  9(4) VALUE 7631.
  1117     12  ER-7632                 PIC  9(4) VALUE 7632.
  1118     12  ER-7633                 PIC  9(4) VALUE 7633.
  1119     12  ER-7537                 PIC  9(4) VALUE 7537.
  1120     12  ER-7538                 PIC  9(4) VALUE 7538.
  1121     12  ER-7574                 PIC  9(4) VALUE 7574.
  1122     12  ER-7997                 PIC  9(4) VALUE 7997.
  1123     12  ER-7998                 PIC  9(4) VALUE 7998.
  1124     12  ER-8148                 PIC  9(4) VALUE 8148.
  1125     12  ER-9063                 PIC  9(4) VALUE 9063.
  1126     12  ER-9076                 PIC  9(4) VALUE 9076.
  1127     12  ER-9618                 PIC  9(4) VALUE 9618.
  1128     12  ER-9841                 PIC  9(4) VALUE 9841.
  1129
  1130*                                COPY ELCTEXT.
  1131******************************************************************
  1132*                                                                *
  1133*                                                                *
  1134*                            ELCTEXT.                            *
  1135*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1136*                            VMOD=2.008                          *
  1137*                                                                *
  1138*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1139*                                     FORM LETTERS,              *
  1140*                                     CERT FORM DISPLAY.
  1141*                                                                *
  1142*   FILE TYPE = VSAM,KSDS                                        *
  1143*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1144*                                                                *
  1145*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1146*       ALTERNATE INDEX = NONE                                   *
  1147*                                                                *
  1148*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1149*       ALTERNATE INDEX = NONE                                   *
  1150*                                                                *
  1151*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1152*       ALTERNATE INDEX = NONE                                   *
  1153*                                                                *
  1154*   LOG = NO                                                     *
  1155*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  23
* EL6311.cbl
  1156******************************************************************
  1157 01  TEXT-FILES.
  1158     12  TEXT-FILE-ID                PIC XX.
  1159         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1160         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1161         88  HELP-FILE-TEXT             VALUE 'TH'.
  1162
  1163     12  TX-CONTROL-PRIMARY.
  1164         16  TX-COMPANY-CD           PIC X.
  1165             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1166         16  TX-ACCESS-CD-GENL       PIC X(12).
  1167
  1168         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1169             20  TX-LETTER-NO        PIC X(4).
  1170             20  FILLER              PIC X(8).
  1171
  1172         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1173             20  TX-FORM-NO          PIC X(12).
  1174
  1175         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1176             20  TX-HELP-TYPE        PIC X.
  1177                 88  HELP-FOR-GENERAL   VALUE ' '.
  1178                 88  HELP-BY-SCREEN     VALUE 'S'.
  1179                 88  HELP-BY-ERROR      VALUE 'E'.
  1180             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1181                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1182             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1183                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1184             20  FILLER              PIC X(4).
  1185
  1186         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1187
  1188     12  TX-PROCESS-CONTROL          PIC XX.
  1189         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1190
  1191     12  TX-TEXT-LINE                PIC X(70).
  1192
  1193     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1194         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1195         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1196         88  TX-VALID-FORM-SQUEEZE-VALUE
  1197                                        VALUE 'Y' ' '.
  1198
  1199     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1200         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1201         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1202         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1203         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1204         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1205         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1206         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1207                                              'K' 'N' ' '
  1208                                              'Z'.
  1209
  1210     12  TX-ARCHIVE-SW               PIC X.
  1211         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1212         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1213         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  24
* EL6311.cbl
  1214
  1215     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1216     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1217
  1218     12  TX-BSR-CODE                 PIC X.
  1219         88  TX-BSR-LETTER              VALUE 'B'.
  1220         88  TX-NON-BSR-LETTER          VALUE ' '.
  1221
  1222     12  FILLER                      PIC X.
  1223*****************************************************************
  1224*                                COPY ELCCRTO.
  1225******************************************************************
  1226*                                                                *
  1227*                            ELCCRTO.                            *
  1228*                                                                *
  1229*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1230*                                                                *
  1231*   FILE TYPE = VSAM,KSDS                                        *
  1232*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1233*                                                                *
  1234*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1235*                                                                *
  1236*   LOG = YES                                                    *
  1237*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1238******************************************************************
  1239*                   C H A N G E   L O G
  1240*
  1241* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1242*-----------------------------------------------------------------
  1243*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1244* EFFECTIVE    NUMBER
  1245*-----------------------------------------------------------------
  1246* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1247* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1248* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1249* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1250* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1251******************************************************************
  1252 01  ORIGINAL-CERTIFICATE.
  1253     12  OC-RECORD-ID                      PIC XX.
  1254         88  VALID-OC-ID                      VALUE 'OC'.
  1255     12  OC-CONTROL-PRIMARY.
  1256         16  OC-COMPANY-CD                 PIC X.
  1257         16  OC-CARRIER                    PIC X.
  1258         16  OC-GROUPING                   PIC X(6).
  1259         16  OC-STATE                      PIC XX.
  1260         16  OC-ACCOUNT                    PIC X(10).
  1261         16  OC-CERT-EFF-DT                PIC XX.
  1262         16  OC-CERT-NO.
  1263             20  OC-CERT-PRIME             PIC X(10).
  1264             20  OC-CERT-SFX               PIC X.
  1265         16  OC-RECORD-TYPE                PIC X.
  1266         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1267     12  OC-LAST-MAINT-DT                  PIC XX.
  1268     12  OC-LAST-MAINT-BY                  PIC X(4).
  1269     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1270     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1271     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  25
* EL6311.cbl
  1272     12  OC-ORIG-REC.
  1273         16  OC-INS-LAST-NAME              PIC X(15).
  1274         16  OC-INS-FIRST-NAME             PIC X(10).
  1275         16  OC-INS-MIDDLE-INIT            PIC X.
  1276         16  OC-INS-AGE                    PIC S999     COMP-3.
  1277         16  OC-JNT-LAST-NAME              PIC X(15).
  1278         16  OC-JNT-FIRST-NAME             PIC X(10).
  1279         16  OC-JNT-MIDDLE-INIT            PIC X.
  1280         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1281         16  OC-LF-BENCD                   PIC XX.
  1282         16  OC-LF-TERM                    PIC S999      COMP-3.
  1283         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1284         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1285         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1286         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1287         16  OC-LF-EXP-DT                  PIC XX.
  1288         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1289         16  OC-LF-CANCEL-DT               PIC XX.
  1290         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1291         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1292         16  OC-AH-BENCD                   PIC XX.
  1293         16  OC-AH-TERM                    PIC S999      COMP-3.
  1294         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1295         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1296         16  OC-AH-EXP-DT                  PIC XX.
  1297         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1298         16  OC-AH-CP                      PIC 99.
  1299         16  OC-AH-CANCEL-DT               PIC XX.
  1300         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1301         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1302         16  OC-CRED-BENE-NAME             PIC X(25).
  1303         16  OC-1ST-PMT-DT                 PIC XX.
  1304         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1305         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1306         16  OC-ISSUE-TRAN-IND             PIC X.
  1307         16  OC-CANCEL-TRAN-IND            PIC X.
  1308         16  FILLER                        PIC X(211).
  1309
  1310     12  FILLER                            PIC X(50).
  1311******************************************************************
  1312*                                COPY ERCACCT.
  1313******************************************************************
  1314*                                                                *
  1315*                                                                *
  1316*                            ERCACCT                             *
  1317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1318*                            VMOD=2.031                          *
  1319*                                                                *
  1320*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1321*                                                                *
  1322*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1323*   VSAM ACCOUNT MASTER FILES.                                   *
  1324*                                                                *
  1325*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1326*                                                                *
  1327*   FILE TYPE = VSAM,KSDS                                        *
  1328*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1329*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  26
* EL6311.cbl
  1330*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1331*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1332*                                                                *
  1333*   LOG = NO                                                     *
  1334*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1335*                                                                *
  1336*                                                                *
  1337******************************************************************
  1338*                   C H A N G E   L O G
  1339*
  1340* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1341*-----------------------------------------------------------------
  1342*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1343* EFFECTIVE    NUMBER
  1344*-----------------------------------------------------------------
  1345* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1346* 092705    2005050300006  PEMA  ADD SPP LEASES
  1347* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1348* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1349* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1350* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1351* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1352* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1353******************************************************************
  1354
  1355 01  ACCOUNT-MASTER.
  1356     12  AM-RECORD-ID                      PIC XX.
  1357         88  VALID-AM-ID                      VALUE 'AM'.
  1358
  1359     12  AM-CONTROL-PRIMARY.
  1360         16  AM-COMPANY-CD                 PIC X.
  1361         16  AM-MSTR-CNTRL.
  1362             20  AM-CONTROL-A.
  1363                 24  AM-CARRIER            PIC X.
  1364                 24  AM-GROUPING.
  1365                     28 AM-GROUPING-PREFIX PIC XXX.
  1366                     28 AM-GROUPING-PRIME  PIC XXX.
  1367                 24  AM-STATE              PIC XX.
  1368                 24  AM-ACCOUNT.
  1369                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1370                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1371             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1372                                           PIC X(19).
  1373             20  AM-CNTRL-B.
  1374                 24  AM-EXPIRATION-DT      PIC XX.
  1375                 24  FILLER                PIC X(4).
  1376             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1377                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1378
  1379     12  AM-CONTROL-BY-VAR-GRP.
  1380         16  AM-COMPANY-CD-A1              PIC X.
  1381         16  AM-VG-CARRIER                 PIC X.
  1382         16  AM-VG-GROUPING                PIC X(6).
  1383         16  AM-VG-STATE                   PIC XX.
  1384         16  AM-VG-ACCOUNT                 PIC X(10).
  1385         16  AM-VG-DATE.
  1386             20  AM-VG-EXPIRATION-DT       PIC XX.
  1387             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  27
* EL6311.cbl
  1388         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1389                                           PIC 9(11)      COMP-3.
  1390     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1391         16  FILLER                        PIC X(10).
  1392         16  AM-VG-KEY3.
  1393             20  AM-VG3-ACCOUNT            PIC X(10).
  1394             20  AM-VG3-EXP-DT             PIC XX.
  1395         16  FILLER                        PIC X(4).
  1396     12  AM-MAINT-INFORMATION.
  1397         16  AM-LAST-MAINT-DT              PIC XX.
  1398         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1399         16  AM-LAST-MAINT-USER            PIC X(4).
  1400         16  FILLER                        PIC XX.
  1401
  1402     12  AM-EFFECTIVE-DT                   PIC XX.
  1403     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1404
  1405     12  AM-PREV-DATES  COMP-3.
  1406         16  AM-PREV-EXP-DT                PIC 9(11).
  1407         16  AM-PREV-EFF-DT                PIC 9(11).
  1408
  1409     12  AM-REPORT-CODE-1                  PIC X(10).
  1410     12  AM-REPORT-CODE-2                  PIC X(10).
  1411
  1412     12  AM-CITY-CODE                      PIC X(4).
  1413     12  AM-COUNTY-PARISH                  PIC X(6).
  1414
  1415     12  AM-NAME                           PIC X(30).
  1416     12  AM-PERSON                         PIC X(30).
  1417     12  AM-ADDRS                          PIC X(30).
  1418     12  AM-CITY.
  1419         16  AM-ADDR-CITY                  PIC X(28).
  1420         16  AM-ADDR-STATE                 PIC XX.
  1421     12  AM-ZIP.
  1422         16  AM-ZIP-PRIME.
  1423             20  AM-ZIP-PRI-1ST            PIC X.
  1424                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1425             20  FILLER                    PIC X(4).
  1426         16  AM-ZIP-PLUS4                  PIC X(4).
  1427     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1428         16  AM-CAN-POSTAL-1               PIC XXX.
  1429         16  AM-CAN-POSTAL-2               PIC XXX.
  1430         16  FILLER                        PIC XXX.
  1431     12  AM-TEL-NO.
  1432         16  AM-AREA-CODE                  PIC 999.
  1433         16  AM-TEL-PRE                    PIC 999.
  1434         16  AM-TEL-NBR                    PIC 9(4).
  1435     12  AM-TEL-LOC                        PIC X.
  1436         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1437         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1438
  1439     12  AM-COMM-STRUCTURE.
  1440         16  AM-DEFN-1.
  1441             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1442                 24  AM-AGT.
  1443                     28  AM-AGT-PREFIX     PIC X(4).
  1444                     28  AM-AGT-PRIME      PIC X(6).
  1445                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  28
* EL6311.cbl
  1446                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1447                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1448                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1449                 24  AM-RECALC-LV-INDIC    PIC X.
  1450                 24  AM-RETRO-LV-INDIC     PIC X.
  1451                 24  AM-GL-CODES           PIC X.
  1452                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1453                 24  FILLER                PIC X(01).
  1454         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1455             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1456                 24  FILLER                PIC X(11).
  1457                 24  AM-L-COMA             PIC XXX.
  1458                 24  AM-J-COMA             PIC XXX.
  1459                 24  AM-A-COMA             PIC XXX.
  1460                 24  FILLER                PIC X(6).
  1461
  1462     12  AM-COMM-CHANGE-STATUS             PIC X.
  1463         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1464
  1465     12  AM-CSR-CODE                       PIC X(4).
  1466
  1467     12  AM-BILLING-STATUS                 PIC X.
  1468         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1469         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1470     12  AM-AUTO-REFUND-SW                 PIC X.
  1471         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1472         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1473     12  AM-GPCD                           PIC 99.
  1474     12  AM-IG                             PIC X.
  1475         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1476         88  AM-HAS-GROUP                     VALUE '2'.
  1477     12  AM-STATUS                         PIC X.
  1478         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1479         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1480         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1481         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1482         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1483         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1484         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1485         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1486         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1487         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1488     12  AM-REMIT-TO                       PIC 99.
  1489     12  AM-ID-NO                          PIC X(11).
  1490
  1491     12  AM-CAL-TABLE                      PIC XX.
  1492     12  AM-LF-DEVIATION                   PIC XXX.
  1493     12  AM-AH-DEVIATION                   PIC XXX.
  1494     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1495     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1496     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1497     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1498     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1499     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1500
  1501     12  AM-USER-FIELDS.
  1502         16  AM-FLD-1                      PIC XX.
  1503         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  29
* EL6311.cbl
  1504         16  AM-FLD-3                      PIC XX.
  1505         16  AM-FLD-4                      PIC XX.
  1506         16  AM-FLD-5                      PIC XX.
  1507
  1508     12  AM-1ST-PROD-DATE.
  1509         16  AM-1ST-PROD-YR                PIC XX.
  1510         16  AM-1ST-PROD-MO                PIC XX.
  1511         16  AM-1ST-PROD-DA                PIC XX.
  1512     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1513     12  AM-CERTS-PURGED-DATE.
  1514         16  AM-PUR-YR                     PIC XX.
  1515         16  AM-PUR-MO                     PIC XX.
  1516         16  AM-PUR-DA                     PIC XX.
  1517     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1518     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1519     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1520     12  AM-INACTIVE-DATE.
  1521         16  AM-INA-MO                     PIC 99.
  1522         16  AM-INA-DA                     PIC 99.
  1523         16  AM-INA-YR                     PIC 99.
  1524     12  AM-AR-HI-CERT-DATE                PIC XX.
  1525
  1526     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1527     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1528
  1529     12  AM-OB-PAYMENT-MODE                PIC X.
  1530         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1531         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1532         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1533         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1534
  1535     12  AM-AH-ONLY-INDICATOR              PIC X.
  1536         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1537         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1538
  1539     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1540
  1541     12  AM-OVER-SHORT.
  1542         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1543         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1544
  1545     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1546     12  AM-DCC-CLP-STATE                  PIC XX.
  1547
  1548     12  AM-RECALC-COMM                    PIC X.
  1549     12  AM-RECALC-REIN                    PIC X.
  1550
  1551     12  AM-REI-TABLE                      PIC XXX.
  1552     12  AM-REI-ET-LF                      PIC X.
  1553     12  AM-REI-ET-AH                      PIC X.
  1554     12  AM-REI-PE-LF                      PIC X.
  1555     12  AM-REI-PE-AH                      PIC X.
  1556     12  AM-REI-PRT-ST                     PIC X.
  1557     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1558     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1559     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1560     12  AM-REI-GROUP-A                    PIC X(6).
  1561     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  30
* EL6311.cbl
  1562     12  AM-REI-PRT-OW                     PIC X.
  1563     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1564     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1565     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1566     12  AM-REI-GROUP-B                    PIC X(6).
  1567
  1568     12  AM-TRUST-TYPE                     PIC X(2).
  1569
  1570     12  AM-EMPLOYER-STMT-USED             PIC X.
  1571     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1572
  1573     12  AM-STD-AH-TYPE                    PIC XX.
  1574     12  AM-EARN-METHODS.
  1575         16  AM-EARN-METHOD-R              PIC X.
  1576             88 AM-REF-RL-R78                 VALUE 'R'.
  1577             88 AM-REF-RL-PR                  VALUE 'P'.
  1578             88 AM-REF-RL-MEAN                VALUE 'M'.
  1579             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1580         16  AM-EARN-METHOD-L              PIC X.
  1581             88 AM-REF-LL-R78                 VALUE 'R'.
  1582             88 AM-REF-LL-PR                  VALUE 'P'.
  1583             88 AM-REF-LL-MEAN                VALUE 'M'.
  1584             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1585         16  AM-EARN-METHOD-A              PIC X.
  1586             88 AM-REF-AH-R78                 VALUE 'R'.
  1587             88 AM-REF-AH-PR                  VALUE 'P'.
  1588             88 AM-REF-AH-MEAN                VALUE 'M'.
  1589             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1590             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1591             88 AM-REF-AH-NET                 VALUE 'N'.
  1592
  1593     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1594     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1595     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1596
  1597     12  AM-RET-Y-N                        PIC X.
  1598     12  AM-RET-P-E                        PIC X.
  1599     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1600     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1601     12  AM-RET-GRP                        PIC X(6).
  1602     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1603         16  AM-POOL-PRIME                 PIC XXX.
  1604         16  AM-POOL-SUB                   PIC XXX.
  1605     12  AM-RETRO-EARNINGS.
  1606         16  AM-RET-EARN-R                 PIC X.
  1607         16  AM-RET-EARN-L                 PIC X.
  1608         16  AM-RET-EARN-A                 PIC X.
  1609     12  AM-RET-ST-TAX-USE                 PIC X.
  1610         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1611         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1612     12  AM-RETRO-BEG-EARNINGS.
  1613         16  AM-RET-BEG-EARN-R             PIC X.
  1614         16  AM-RET-BEG-EARN-L             PIC X.
  1615         16  AM-RET-BEG-EARN-A             PIC X.
  1616     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1617     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1618
  1619     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  31
* EL6311.cbl
  1620         16  AM-USER-SELECT-1              PIC X(10).
  1621         16  AM-USER-SELECT-2              PIC X(10).
  1622         16  AM-USER-SELECT-3              PIC X(10).
  1623         16  AM-USER-SELECT-4              PIC X(10).
  1624         16  AM-USER-SELECT-5              PIC X(10).
  1625
  1626     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1627
  1628     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1629
  1630     12  AM-RPT045A-SWITCH                 PIC X.
  1631         88  RPT045A-OFF                   VALUE 'N'.
  1632
  1633     12  AM-INSURANCE-LIMITS.
  1634         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1635         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1636
  1637     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1638         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1639
  1640     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1641         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1642         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1643
  1644     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1645
  1646     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1647     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1648     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1649     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1650     12  AM-DCC-UEF-STATE                  PIC XX.
  1651     12  FILLER                            PIC XXX.
  1652     12  AM-REPORT-CODE-3                  PIC X(10).
  1653*    12  FILLER                            PIC X(22).
  1654
  1655     12  AM-RESERVE-DATE.
  1656         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1657         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1658         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1659
  1660     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1661     12  AM-NOTIFICATION-TYPES.
  1662         16  AM-NOTIF-OF-LETTERS           PIC X.
  1663         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1664         16  AM-NOTIF-OF-REPORTS           PIC X.
  1665         16  AM-NOTIF-OF-STATUS            PIC X.
  1666
  1667     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1668         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1669         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1670         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1671         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1672
  1673     12  AM-BENEFIT-CONTROLS.
  1674         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1675             20  AM-BENEFIT-CODE           PIC XX.
  1676             20  AM-BENEFIT-TYPE           PIC X.
  1677             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  32
* EL6311.cbl
  1678             20  AM-BENEFIT-REM-TERM       PIC X.
  1679             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1680             20  FILLER                    PIC XX.
  1681         16  FILLER                        PIC X(80).
  1682
  1683     12  AM-TRANSFER-DATA.
  1684         16  AM-TRANSFERRED-FROM.
  1685             20  AM-TRNFROM-CARRIER        PIC X.
  1686             20  AM-TRNFROM-GROUPING.
  1687                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1688                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1689             20  AM-TRNFROM-STATE          PIC XX.
  1690             20  AM-TRNFROM-ACCOUNT.
  1691                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1692                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1693             20  AM-TRNFROM-DTE            PIC XX.
  1694         16  AM-TRANSFERRED-TO.
  1695             20  AM-TRNTO-CARRIER          PIC X.
  1696             20  AM-TRNTO-GROUPING.
  1697                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1698                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1699             20  AM-TRNTO-STATE            PIC XX.
  1700             20  AM-TRNTO-ACCOUNT.
  1701                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1702                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1703             20  AM-TRNTO-DTE              PIC XX.
  1704         16  FILLER                        PIC X(10).
  1705
  1706     12  AM-SAVED-REMIT-TO                 PIC 99.
  1707
  1708     12  AM-COMM-STRUCTURE-SAVED.
  1709         16  AM-DEFN-1-SAVED.
  1710             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1711                 24  AM-AGT-SV             PIC X(10).
  1712                 24  AM-COM-TYP-SV         PIC X.
  1713                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1714                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1715                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1716                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1717                 24  FILLER                PIC X.
  1718                 24  AM-GL-CODES-SV        PIC X.
  1719                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1720                 24  FILLER                PIC X.
  1721         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1722             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1723                 24  FILLER                PIC X(11).
  1724                 24  AM-L-COMA-SV          PIC XXX.
  1725                 24  AM-J-COMA-SV          PIC XXX.
  1726                 24  AM-A-COMA-SV          PIC XXX.
  1727                 24  FILLER                PIC X(6).
  1728
  1729     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1730         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1731            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1732            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1733            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1734
  1735     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  33
* EL6311.cbl
  1736     12  FILLER                            PIC X(120).
  1737
  1738     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1739         16  AM-CONTROL-NAME               PIC X(30).
  1740         16  AM-EXECUTIVE-ONE.
  1741             20  AM-EXEC1-NAME             PIC X(15).
  1742             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1743                                                          COMP-3.
  1744             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1745                                                          COMP-3.
  1746         16  AM-EXECUTIVE-TWO.
  1747             20  AM-EXEC2-NAME             PIC X(15).
  1748             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1749                                                          COMP-3.
  1750             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1751                                                          COMP-3.
  1752
  1753     12  AM-RETRO-ADDITIONAL-DATA.
  1754         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1755         16  AM-RETRO-PREM-P-E             PIC X.
  1756         16  AM-RETRO-CLMS-P-I             PIC X.
  1757         16  AM-RETRO-RET-BRACKET-LF.
  1758             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1759                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1760                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1761             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1762                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1763                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1764             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1765                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1766                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1767         16  AM-RETRO-RET-BRACKET-AH.
  1768             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1769                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1770                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1771                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1772             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1773                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1774                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1775             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1776                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1777                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1778
  1779     12  AM-COMMENTS.
  1780         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1781
  1782     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1783         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1784         16  AM-FLI-BILLING-CODE           PIC X.
  1785         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1786         16  AM-FLI-UNITED-IDENT           PIC X.
  1787         16  AM-FLI-INTEREST-LOST-DATA.
  1788             20  AM-FLI-BANK-NO            PIC X(5).
  1789             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1790             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1791             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1792         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1793             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  34
* EL6311.cbl
  1794             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1795             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1796         16  FILLER                        PIC X(102).
  1797
  1798     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1799         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1800             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1801             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1802             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1803             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1804             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1805         16  FILLER                          PIC X(10).
  1806******************************************************************
  1807*                                COPY ELCVADS.
  1808******************************************************************
  1809*                                                                *
  1810*                                                                *
  1811*                            ELCVADS.                            *
  1812*                                                                *
  1813*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1814*   ELVADS                  LENGTH = 350                         *
  1815******************************************************************
  1816******************************************************************
  1817*                   C H A N G E   L O G
  1818*
  1819* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1820*-----------------------------------------------------------------
  1821*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1822* EFFECTIVE    NUMBER
  1823*-----------------------------------------------------------------
  1824* 100111    2011022800001  AJRA  NAPERSOFT
  1825******************************************************************
  1826
  1827 01  VIRGINIA-DISCLOSURE.
  1828     12  VD-COMPANY-CD              PIC X.
  1829     12  VD-CARRIER                 PIC X.
  1830     12  VD-GROUPING.
  1831         20  VD-GROUPING-PREFIX     PIC XXX.
  1832         20  VD-GROUPING-PRIME      PIC XXX.
  1833     12  VD-STATE                   PIC XX.
  1834     12  VD-ACCOUNT.
  1835         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1836         20  VD-ACCOUNT-PRIME       PIC X(6).
  1837     12  VD-CERT-EFF-DT             PIC XX.
  1838     12  VD-CERT-NO.
  1839         20  VD-CERT-PRIME          PIC X(10).
  1840         20  VD-CERT-SFX            PIC X.
  1841     12  VD-ENTRY-BATCH             PIC X(6).
  1842     12  VD-CSR-ID                  PIC X(4).
  1843     12  VD-NAME.
  1844         20  VD-INSURED-LAST-NAME   PIC X(15).
  1845         20  VD-INSURED-FIRST-NAME.
  1846             24  VD-INSURED-1ST-INIT PIC X.
  1847             24  FILLER             PIC X(9).
  1848         20  VD-INSURED-MIDDLE-INIT PIC X.
  1849     12  VD-JOINT-INSURED.
  1850         20 VD-JOINT-LAST-NAME      PIC X(15).
  1851         20 VD-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  35
* EL6311.cbl
  1852            24  VD-JOINT-FIRST-INIT PIC X.
  1853            24  FILLER              PIC X(9).
  1854         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1855     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1856     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1857     12  VD-INSURED-CITY-STATE.
  1858         20  VD-INSURED-CITY        PIC X(28).
  1859         20  VD-INSURED-STATE       PIC XX.
  1860     12  VD-INSURED-ZIP-CODE.
  1861         20  VD-INSURED-ZIP-PRIME.
  1862             24  VD-INSURED-ZIP-1   PIC X.
  1863                 88  VD-CANADIAN-POST-CODE
  1864                                       VALUE 'A' THRU 'Z'.
  1865             24  FILLER             PIC X(4).
  1866         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1867     12  VD-BENEFICIARY-NAME        PIC X(30).
  1868     12  VD-ACCOUNT-NAME            PIC X(30).
  1869     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1870     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1871     12  VD-1ST-PMT-DT              PIC XX.
  1872     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1873         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1874         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1875                                             '90' THRU '99'.
  1876     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1877                                    PIC XX.
  1878     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1879     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1880     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1881     12  VD-LF-TERM                 PIC S999   COMP-3.
  1882     12  VD-AH-BENEFIT-CD           PIC XX.
  1883         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1884         88  VD-INVALID-AH             VALUE '  ' '00'
  1885                                             '90' THRU '99'.
  1886     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1887     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1888     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1889     12  VD-AH-TERM                 PIC S999   COMP-3.
  1890     12  VD-LETTER-ID               PIC X(4).
  1891     12  VD-PROC-ID                 PIC X(4).
  1892     12  VD-COMP-ID                 PIC X(3).
  1893     12  VD-CURRENT-DATE            PIC XX.
  1894     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1895     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1896     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  36
* EL6311.cbl
  1898*    COPY ELCDATE.
  1899******************************************************************
  1900*                                                                *
  1901*                                                                *
  1902*                            ELCDATE.                            *
  1903*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1904*                            VMOD=2.003
  1905*                                                                *
  1906*                                                                *
  1907*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1908*                 LENGTH = 200                                   *
  1909******************************************************************
  1910
  1911 01  DATE-CONVERSION-DATA.
  1912     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1913     12  DC-OPTION-CODE                PIC X.
  1914         88  BIN-TO-GREG                VALUE ' '.
  1915         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1916         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1917         88  YMD-GREG-TO-BIN            VALUE '3'.
  1918         88  MDY-GREG-TO-BIN            VALUE '4'.
  1919         88  JULIAN-TO-BIN              VALUE '5'.
  1920         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1921         88  FIND-CENTURY               VALUE '7'.
  1922         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1923         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1924         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1925         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1926         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1927         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1928         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1929         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1930         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1931         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1932         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1933         88  BIN-3-TO-GREG              VALUE 'I'.
  1934         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1935         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1936         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1937         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1938         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1939         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1940         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1941         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1942         88  THREE-CHARACTER-BIN
  1943                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1944         88  GREGORIAN-TO-BIN
  1945                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1946         88  BIN-TO-GREGORIAN
  1947                  VALUES ' ' '1' 'I' '8' 'G'.
  1948         88  JULIAN-TO-BINARY
  1949                  VALUES '5' 'C' 'E' 'F'.
  1950     12  DC-ERROR-CODE                 PIC X.
  1951         88  NO-CONVERSION-ERROR        VALUE ' '.
  1952         88  DATE-CONVERSION-ERROR
  1953                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1954         88  DATE-IS-ZERO               VALUE '1'.
  1955         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  37
* EL6311.cbl
  1956         88  DATE-IS-INVALID            VALUE '3'.
  1957         88  DATE1-GREATER-DATE2        VALUE '4'.
  1958         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1959         88  DATE-INVALID-OPTION        VALUE '9'.
  1960         88  INVALID-CENTURY            VALUE 'A'.
  1961         88  ONLY-CENTURY               VALUE 'B'.
  1962         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1963         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1964     12  DC-END-OF-MONTH               PIC X.
  1965         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1966     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1967         88  USE-NORMAL-PROCESS         VALUE ' '.
  1968         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1969         88  ADJUST-UP-100-YRS          VALUE '2'.
  1970     12  FILLER                        PIC X.
  1971     12  DC-CONVERSION-DATES.
  1972         16  DC-BIN-DATE-1             PIC XX.
  1973         16  DC-BIN-DATE-2             PIC XX.
  1974         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1975         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1976                       DC-GREG-DATE-1-EDIT.
  1977             20  DC-EDIT1-MONTH        PIC 99.
  1978             20  SLASH1-1              PIC X.
  1979             20  DC-EDIT1-DAY          PIC 99.
  1980             20  SLASH1-2              PIC X.
  1981             20  DC-EDIT1-YEAR         PIC 99.
  1982         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1983         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1984                     DC-GREG-DATE-2-EDIT.
  1985             20  DC-EDIT2-MONTH        PIC 99.
  1986             20  SLASH2-1              PIC X.
  1987             20  DC-EDIT2-DAY          PIC 99.
  1988             20  SLASH2-2              PIC X.
  1989             20  DC-EDIT2-YEAR         PIC 99.
  1990         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1991         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1992                     DC-GREG-DATE-1-YMD.
  1993             20  DC-YMD-YEAR           PIC 99.
  1994             20  DC-YMD-MONTH          PIC 99.
  1995             20  DC-YMD-DAY            PIC 99.
  1996         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1997         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1998                      DC-GREG-DATE-1-MDY.
  1999             20  DC-MDY-MONTH          PIC 99.
  2000             20  DC-MDY-DAY            PIC 99.
  2001             20  DC-MDY-YEAR           PIC 99.
  2002         16  DC-GREG-DATE-1-ALPHA.
  2003             20  DC-ALPHA-MONTH        PIC X(10).
  2004             20  DC-ALPHA-DAY          PIC 99.
  2005             20  FILLER                PIC XX.
  2006             20  DC-ALPHA-CENTURY.
  2007                 24 DC-ALPHA-CEN-N     PIC 99.
  2008             20  DC-ALPHA-YEAR         PIC 99.
  2009         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2010         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2011         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2012         16  DC-JULIAN-DATE            PIC 9(05).
  2013         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  38
* EL6311.cbl
  2014                                       PIC 9(05).
  2015         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2016             20  DC-JULIAN-YEAR        PIC 99.
  2017             20  DC-JULIAN-DAYS        PIC 999.
  2018         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2019         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2020         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2021     12  DATE-CONVERSION-VARIBLES.
  2022         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2023         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2024             20  FILLER                PIC 9(3).
  2025             20  HOLD-CEN-1-CCYY.
  2026                 24  HOLD-CEN-1-CC     PIC 99.
  2027                 24  HOLD-CEN-1-YY     PIC 99.
  2028             20  HOLD-CEN-1-MO         PIC 99.
  2029             20  HOLD-CEN-1-DA         PIC 99.
  2030         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2031             20  HOLD-CEN-1-R-MO       PIC 99.
  2032             20  HOLD-CEN-1-R-DA       PIC 99.
  2033             20  HOLD-CEN-1-R-CCYY.
  2034                 24  HOLD-CEN-1-R-CC   PIC 99.
  2035                 24  HOLD-CEN-1-R-YY   PIC 99.
  2036             20  FILLER                PIC 9(3).
  2037         16  HOLD-CENTURY-1-X.
  2038             20  FILLER                PIC X(3)  VALUE SPACES.
  2039             20  HOLD-CEN-1-X-CCYY.
  2040                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2041                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2042             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2043             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2044         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2045             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2046             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2047             20  HOLD-CEN-1-R-X-CCYY.
  2048                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2049                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2050             20  FILLER                PIC XXX.
  2051         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2052         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2053         16  DC-JULIAN-DATE-1          PIC 9(07).
  2054         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2055             20  DC-JULIAN-1-CCYY.
  2056                 24  DC-JULIAN-1-CC    PIC 99.
  2057                 24  DC-JULIAN-1-YR    PIC 99.
  2058             20  DC-JULIAN-DA-1        PIC 999.
  2059         16  DC-JULIAN-DATE-2          PIC 9(07).
  2060         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2061             20  DC-JULIAN-2-CCYY.
  2062                 24  DC-JULIAN-2-CC    PIC 99.
  2063                 24  DC-JULIAN-2-YR    PIC 99.
  2064             20  DC-JULIAN-DA-2        PIC 999.
  2065         16  DC-GREG-DATE-A-EDIT.
  2066             20  DC-EDITA-MONTH        PIC 99.
  2067             20  SLASHA-1              PIC X VALUE '/'.
  2068             20  DC-EDITA-DAY          PIC 99.
  2069             20  SLASHA-2              PIC X VALUE '/'.
  2070             20  DC-EDITA-CCYY.
  2071                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  39
* EL6311.cbl
  2072                 24  DC-EDITA-YEAR     PIC 99.
  2073         16  DC-GREG-DATE-B-EDIT.
  2074             20  DC-EDITB-MONTH        PIC 99.
  2075             20  SLASHB-1              PIC X VALUE '/'.
  2076             20  DC-EDITB-DAY          PIC 99.
  2077             20  SLASHB-2              PIC X VALUE '/'.
  2078             20  DC-EDITB-CCYY.
  2079                 24  DC-EDITB-CENT     PIC 99.
  2080                 24  DC-EDITB-YEAR     PIC 99.
  2081         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2082         16  DC-GREG-DATE-CYMD-R REDEFINES
  2083                              DC-GREG-DATE-CYMD.
  2084             20  DC-CYMD-CEN           PIC 99.
  2085             20  DC-CYMD-YEAR          PIC 99.
  2086             20  DC-CYMD-MONTH         PIC 99.
  2087             20  DC-CYMD-DAY           PIC 99.
  2088         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2089         16  DC-GREG-DATE-MDCY-R REDEFINES
  2090                              DC-GREG-DATE-MDCY.
  2091             20  DC-MDCY-MONTH         PIC 99.
  2092             20  DC-MDCY-DAY           PIC 99.
  2093             20  DC-MDCY-CEN           PIC 99.
  2094             20  DC-MDCY-YEAR          PIC 99.
  2095    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2096        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2097    12  DC-EL310-DATE                  PIC X(21).
  2098    12  FILLER                         PIC X(28).
  2099
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  40
* EL6311.cbl
  2101*    COPY ELCLOGOF.
  2102******************************************************************
  2103*                                                                *
  2104*                                                                *
  2105*                            ELCLOGOF.                           *
  2106*                            VMOD=2.001                          *
  2107*                                                                *
  2108*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2109*                                                                *
  2110******************************************************************
  2111 01  CLASIC-LOGOFF.
  2112     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2113     12  LOGOFF-TEXT.
  2114         16  FILLER          PIC X(5)    VALUE SPACES.
  2115         16  LOGOFF-MSG.
  2116             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2117             20  FILLER      PIC X       VALUE SPACES.
  2118             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2119         16  FILLER          PIC X(80)
  2120           VALUE '* YOU ARE NOW LOGGED OFF'.
  2121         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2122         16  FILLER          PIC X       VALUE QUOTE.
  2123         16  LOGOFF-SYS-MSG  PIC X(17)
  2124           VALUE 'S CLAS-IC SYSTEM '.
  2125     12  TEXT-MESSAGES.
  2126         16  UNACCESS-MSG    PIC X(29)
  2127             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2128         16  PGMIDERR-MSG    PIC X(17)
  2129             VALUE 'PROGRAM NOT FOUND'.
  2130
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  41
* EL6311.cbl
  2132*    COPY ELCATTR.
  2133******************************************************************
  2134*                                                                *
  2135*                            ELCATTR.                            *
  2136*                            VMOD=2.001                          *
  2137*                                                                *
  2138*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2139*                                                                *
  2140*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2141*                                                                *
  2142*                   POS 1   P=PROTECTED                          *
  2143*                           U=UNPROTECTED                        *
  2144*                           S=ASKIP                              *
  2145*                   POS 2   A=ALPHA/NUMERIC                      *
  2146*                           N=NUMERIC                            *
  2147*                   POS 3   N=NORMAL                             *
  2148*                           B=BRIGHT                             *
  2149*                           D=DARK                               *
  2150*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2151*                           OF=MODIFIED DATA TAG OFF             *
  2152*                                                                *
  2153*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2154******************************************************************
  2155 01  ATTRIBUTE-LIST.
  2156     12  AL-PABOF            PIC X       VALUE 'Y'.
  2157     12  AL-PABON            PIC X       VALUE 'Z'.
  2158     12  AL-PADOF            PIC X       VALUE '%'.
  2159     12  AL-PADON            PIC X       VALUE '_'.
  2160     12  AL-PANOF            PIC X       VALUE '-'.
  2161     12  AL-PANON            PIC X       VALUE '/'.
  2162     12  AL-SABOF            PIC X       VALUE '8'.
  2163     12  AL-SABON            PIC X       VALUE '9'.
  2164     12  AL-SADOF            PIC X       VALUE '@'.
  2165     12  AL-SADON            PIC X       VALUE QUOTE.
  2166     12  AL-SANOF            PIC X       VALUE '0'.
  2167     12  AL-SANON            PIC X       VALUE '1'.
  2168     12  AL-UABOF            PIC X       VALUE 'H'.
  2169     12  AL-UABON            PIC X       VALUE 'I'.
  2170     12  AL-UADOF            PIC X       VALUE '<'.
  2171     12  AL-UADON            PIC X       VALUE '('.
  2172     12  AL-UANOF            PIC X       VALUE ' '.
  2173     12  AL-UANON            PIC X       VALUE 'A'.
  2174     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2175     12  AL-UNBON            PIC X       VALUE 'R'.
  2176     12  AL-UNDOF            PIC X       VALUE '*'.
  2177     12  AL-UNDON            PIC X       VALUE ')'.
  2178     12  AL-UNNOF            PIC X       VALUE '&'.
  2179     12  AL-UNNON            PIC X       VALUE 'J'.
  2180
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  42
* EL6311.cbl
  2182*    COPY ELCEMIB.
  2183******************************************************************
  2184*                                                                *
  2185*                                                                *
  2186*                            ELCEMIB.                            *
  2187*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2188*                            VMOD=2.005                          *
  2189*                                                                *
  2190*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2191*                                                                *
  2192******************************************************************
  2193 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2194     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2195     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2196     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2197     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2198     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2199     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2200     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2201     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2202     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2203         88  EMI-NO-ERRORS                    VALUE '1'.
  2204         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2205         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2206     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2207         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2208     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2209         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2210         88  EMI-AREA1-FULL                   VALUE '2'.
  2211     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2212         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2213         88  EMI-AREA2-FULL                   VALUE '2'.
  2214     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2215         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2216         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2217         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2218         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2219         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2220     12  EMI-ERROR-LINES.
  2221         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2222         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2223         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2224         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2225             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2226                 24  EMI-ERR-NUM         PIC X(4).
  2227                 24  EMI-FILLER          PIC X.
  2228                 24  EMI-SEV             PIC X.
  2229                 24  FILLER              PIC X.
  2230             20  FILLER                  PIC X(02).
  2231     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2232         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2233             20  EMI-ERROR-NUMBER    PIC X(4).
  2234             20  EMI-FILL            PIC X.
  2235             20  EMI-SEVERITY        PIC X.
  2236             20  FILLER              PIC X.
  2237             20  EMI-ERROR-TEXT.
  2238                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2239                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  43
* EL6311.cbl
  2240     12  EMI-SEVERITY-SAVE           PIC X.
  2241         88  EMI-NOTE                    VALUE 'N'.
  2242         88  EMI-WARNING                 VALUE 'W'.
  2243         88  EMI-FORCABLE                VALUE 'F'.
  2244         88  EMI-FATAL                   VALUE 'X'.
  2245     12  EMI-MESSAGE-FLAG            PIC X.
  2246         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2247         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2248     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2249     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2250         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2251         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2252         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2253     12  emi-claim-no                pic x(7).
  2254     12  emi-claim-type              pic x(6).
  2255     12  FILLER                      PIC X(124)  VALUE SPACES.
  2256     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2257     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2258     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2259     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2260
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  44
* EL6311.cbl
  2262*    COPY ELCINTF.
  2263******************************************************************
  2264*                                                                *
  2265*                                                                *
  2266*                            ELCINTF.                            *
  2267*                            VMOD=2.017                          *
  2268*                                                                *
  2269*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2270*                                                                *
  2271*       LENGTH = 1024                                            *
  2272*                                                                *
  2273******************************************************************
  2274*                   C H A N G E   L O G
  2275*
  2276* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2277*-----------------------------------------------------------------
  2278*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2279* EFFECTIVE    NUMBER
  2280*-----------------------------------------------------------------
  2281* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2282******************************************************************
  2283 01  PROGRAM-INTERFACE-BLOCK.
  2284     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2285     12  PI-CALLING-PROGRAM              PIC X(8).
  2286     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2287     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2288     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2289     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2290     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2291     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2292     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2293     12  PI-COMPANY-ID                   PIC XXX.
  2294     12  PI-COMPANY-CD                   PIC X.
  2295
  2296     12  PI-COMPANY-PASSWORD             PIC X(8).
  2297
  2298     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2299
  2300     12  PI-CONTROL-IN-PROGRESS.
  2301         16  PI-CARRIER                  PIC X.
  2302         16  PI-GROUPING                 PIC X(6).
  2303         16  PI-STATE                    PIC XX.
  2304         16  PI-ACCOUNT                  PIC X(10).
  2305         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2306                                         PIC X(10).
  2307         16  PI-CLAIM-CERT-GRP.
  2308             20  PI-CLAIM-NO             PIC X(7).
  2309             20  PI-CERT-NO.
  2310                 25  PI-CERT-PRIME       PIC X(10).
  2311                 25  PI-CERT-SFX         PIC X.
  2312             20  PI-CERT-EFF-DT          PIC XX.
  2313         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2314             20  PI-PLAN-CODE            PIC X(2).
  2315             20  PI-REVISION-NUMBER      PIC X(3).
  2316             20  PI-PLAN-EFF-DT          PIC X(2).
  2317             20  PI-PLAN-EXP-DT          PIC X(2).
  2318             20  FILLER                  PIC X(11).
  2319         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  45
* EL6311.cbl
  2320             20  PI-OE-REFERENCE-1.
  2321                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2322                 25  PI-OE-REF-1-SUFF    PIC XX.
  2323
  2324     12  PI-SESSION-IN-PROGRESS          PIC X.
  2325         88  CLAIM-SESSION                   VALUE '1'.
  2326         88  CREDIT-SESSION                  VALUE '2'.
  2327         88  WARRANTY-SESSION                VALUE '3'.
  2328         88  MORTGAGE-SESSION                VALUE '4'.
  2329         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2330
  2331
  2332*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2333
  2334     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2335     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2336
  2337     12  PI-CREDIT-USER                  PIC X.
  2338         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2339         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2340
  2341     12  PI-CLAIM-USER                   PIC X.
  2342         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2343         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2344
  2345     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2346         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2347         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2348         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2349         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2350         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2351
  2352     12  PI-PROCESSOR-ID                 PIC X(4).
  2353
  2354     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2355
  2356     12  PI-MEMBER-CAPTION               PIC X(10).
  2357
  2358     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2359         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2360
  2361     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2362     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2363     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2364     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2365
  2366     12  PI-AH-OVERRIDE-L1               PIC X.
  2367     12  PI-AH-OVERRIDE-L2               PIC XX.
  2368     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2369     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2370
  2371     12  PI-NEW-SYSTEM                   PIC X(2).
  2372
  2373     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2374     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2375         88  PI-USES-PAID-TO                 VALUE '1'.
  2376     12  PI-CRDTCRD-SYSTEM.
  2377         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  46
* EL6311.cbl
  2378             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2379             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2380         16  PI-CC-MONTH-END-DT          PIC XX.
  2381     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2382
  2383     12  PI-OE-REFERENCE-2.
  2384         16  PI-OE-REF-2-PRIME           PIC X(10).
  2385         16  PI-OE-REF-2-SUFF            PIC X.
  2386
  2387     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2388
  2389     12  PI-LANGUAGE-TYPE                PIC X.
  2390             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2391             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2392             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2393
  2394     12  PI-POLICY-LINKAGE-IND           PIC X.
  2395         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2396         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2397                                                   LOW-VALUES.
  2398
  2399     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2400     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2401         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2402         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2403
  2404     12  PI-PROCESSOR-CSR-IND            PIC X.
  2405         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2406         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2407
  2408     12  FILLER                          PIC X(3).
  2409
  2410     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2411
  2412     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2413         PI-SYSTEM-LEVEL.
  2414
  2415         16  PI-ENTRY-CODES.
  2416             20  PI-ENTRY-CD-1           PIC X.
  2417             20  PI-ENTRY-CD-2           PIC X.
  2418
  2419         16  PI-RETURN-CODES.
  2420             20  PI-RETURN-CD-1          PIC X.
  2421             20  PI-RETURN-CD-2          PIC X.
  2422
  2423         16  PI-UPDATE-STATUS-SAVE.
  2424             20  PI-UPDATE-BY            PIC X(4).
  2425             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2426
  2427         16  PI-LOWER-CASE-LETTERS       PIC X.
  2428             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2429
  2430*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2431*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2432*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2433
  2434         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2435             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  47
* EL6311.cbl
  2436             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2437             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2438             88  ACCNT-CNTL                  VALUE '3'.
  2439             88  CARR-ACCNT-CNTL             VALUE '4'.
  2440
  2441         16  PI-PROCESSOR-CAP-LIST.
  2442             20  PI-SYSTEM-CONTROLS.
  2443                24 PI-SYSTEM-DISPLAY     PIC X.
  2444                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2445                24 PI-SYSTEM-MODIFY      PIC X.
  2446                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2447             20  FILLER                  PIC XX.
  2448             20  PI-DISPLAY-CAP          PIC X.
  2449                 88  DISPLAY-CAP             VALUE 'Y'.
  2450             20  PI-MODIFY-CAP           PIC X.
  2451                 88  MODIFY-CAP              VALUE 'Y'.
  2452             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2453                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2454             20  PI-FORCE-CAP            PIC X.
  2455                 88  FORCE-CAP               VALUE 'Y'.
  2456
  2457         16  PI-PROGRAM-CONTROLS.
  2458             20  PI-PGM-PRINT-OPT        PIC X.
  2459             20  PI-PGM-FORMAT-OPT       PIC X.
  2460             20  PI-PGM-PROCESS-OPT      PIC X.
  2461             20  PI-PGM-TOTALS-OPT       PIC X.
  2462
  2463         16  PI-HELP-INTERFACE.
  2464             20  PI-LAST-ERROR-NO        PIC X(4).
  2465             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2466
  2467         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2468             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2469
  2470         16  PI-CR-CONTROL-IN-PROGRESS.
  2471             20  PI-CR-CARRIER           PIC X.
  2472             20  PI-CR-GROUPING          PIC X(6).
  2473             20  PI-CR-STATE             PIC XX.
  2474             20  PI-CR-ACCOUNT           PIC X(10).
  2475             20  PI-CR-FIN-RESP          PIC X(10).
  2476             20  PI-CR-TYPE              PIC X.
  2477
  2478         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2479
  2480         16  PI-CR-MONTH-END-DT          PIC XX.
  2481
  2482         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2483             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2484             88  PI-ZERO-CARRIER             VALUE '1'.
  2485             88  PI-ZERO-GROUPING            VALUE '2'.
  2486             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2487
  2488         16  PI-CARRIER-SECURITY         PIC X.
  2489             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2490
  2491         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2492             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2493             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  48
* EL6311.cbl
  2494
  2495         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2496             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2497                                         INDEXED BY PI-ACCESS-NDX
  2498                                         PIC X.
  2499
  2500         16  PI-GA-BILLING-CONTROL       PIC X.
  2501             88  PI-GA-BILLING               VALUE '1'.
  2502
  2503         16  PI-MAIL-PROCESSING          PIC X.
  2504             88  PI-MAIL-YES                 VALUE 'Y'.
  2505
  2506         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2507
  2508         16  PI-AR-SYSTEM.
  2509             20  PI-AR-PROCESSING-CNTL   PIC X.
  2510                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2511             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2512             20  PI-AR-MONTH-END-DT      PIC XX.
  2513
  2514         16  PI-MP-SYSTEM.
  2515             20  PI-MORTGAGE-USER            PIC X.
  2516                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2517                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2518             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2519                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2520                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2521                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2522                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2523                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2524             20  PI-MP-MONTH-END-DT          PIC XX.
  2525             20  PI-MP-REFERENCE-NO.
  2526                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2527                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2528
  2529         16  PI-LABEL-CONTROL            PIC X(01).
  2530             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2531             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2532
  2533         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2534             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2535
  2536         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2537             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2538             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2539
  2540         16  FILLER                      PIC X(14).
  2541
  2542     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2543******************************************************************
  2544
  2545     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2546*    COPY ELC631PI.
  2547******************************************************************
  2548*                                                                *
  2549*                                                                *
  2550*                            ELC631PI                            *
  2551*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  49
* EL6311.cbl
  2552*                                                                *
  2553*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2554*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2555*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2556*                                                                *
  2557*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2558*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2559*    BETWEEN PROGRAMS.                                           *
  2560*                                                                *
  2561*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2562*                                                                *
  2563*               EL631 - EL6311 - EL6312 - EL6313                 *
  2564*                                                                *
  2565******************************************************************
  2566*                   C H A N G E   L O G
  2567*
  2568* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2569*-----------------------------------------------------------------
  2570*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2571* EFFECTIVE    NUMBER
  2572*-----------------------------------------------------------------
  2573* 021414    2003053000001  PEMA  changes for auto chk request
  2574******************************************************************
  2575
  2576         16  PI-631-DATA.
  2577             20  PI-ERPNDB-KEY.
  2578                 24  PI-PB-COMPANY-CD     PIC X.
  2579                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2580                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2581                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2582
  2583             20  PI-ERPNDB-ALT-KEY.
  2584                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2585                 24  PI-PB-CARRIER        PIC X.
  2586                 24  PI-PB-GROUPING       PIC X(6).
  2587                 24  PI-PB-STATE          PIC XX.
  2588                 24  PI-PB-ACCOUNT        PIC X(10).
  2589                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2590                 24  PI-PB-CERT-NO.
  2591                     28  PI-PB-CERT-PRIME PIC X(10).
  2592                     28  PI-PB-CERT-SFX   PIC X.
  2593                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2594                 24  PI-PB-RECORD-TYPE    PIC X.
  2595
  2596             20  PI-ERPNDB-CSR-KEY.
  2597                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2598                 24  PI-PB-CSR-ID             PIC X(4).
  2599                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2600                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2601                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2602
  2603             20  PI-BROWSE-TYPE               PIC X.
  2604                 88  PI-FILE-BROWSE             VALUE ' '.
  2605                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2606                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2607                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2608                 88  PI-CSR-BROWSE              VALUE '4'.
  2609
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  50
* EL6311.cbl
  2610             20  PI-MAINT-FUNCTION            PIC X.
  2611                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2612                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2613                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2614                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2615                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2616                 88  PI-PF5-FUNCTION            VALUE '5'.
  2617                 88  PI-PF6-FUNCTION            VALUE '6'.
  2618
  2619             20  PI-FILE-SWITCHES.
  2620                 24  PI-ALL-ISSUES-SW         PIC X.
  2621                     88  ALL-ISSUES             VALUE 'Y'.
  2622                 24  PI-ALL-CANCELS-SW        PIC X.
  2623                     88  ALL-CANCELS            VALUE 'Y'.
  2624                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2625                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2626                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2627                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2628                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2629                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2630                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2631                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2632                 24  PI-HOLD-REC-SW           PIC X.
  2633                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2634                 24  PI-CHANGE-REC-SW         PIC X.
  2635                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2636                 24  PI-CHK-REQ-REC-SW        PIC X.
  2637                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2638                 24  PI-ISSUE-WARNING-SW      PIC X.
  2639                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2640                 24  PI-CANCEL-WARNING-SW     PIC X.
  2641                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2642             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2643                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2644             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2645                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2646
  2647             20  PI-MAP-NAME                  PIC X(8).
  2648
  2649             20  PI-CURSOR                    PIC S9(4) COMP.
  2650
  2651             20  PI-PREV-ALT-KEY              PIC X(36).
  2652             20  PI-PREV-CSR-KEY              PIC X(15).
  2653             20  PI-PREV-KEY.
  2654                 24  PI-PREV-COMPANY-CD       PIC X.
  2655                 24  PI-PREV-BATCH            PIC X(6).
  2656                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2657                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2658             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2659             20  PI-BROWSE-SW                 PIC X.
  2660                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2661                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2662             20  PI-SV-CARRIER                PIC X.
  2663             20  PI-SV-GROUPING               PIC X(6).
  2664             20  PI-SV-STATE                  PIC XX.
  2665             20  PI-EDIT-SW                   PIC X.
  2666             20  PI-DISPLAY-SW                PIC XX.
  2667                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  51
* EL6311.cbl
  2668                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2669             20  PI-CRITERIA-DATA             PIC X(350).
  2670             20  PI-BMODE                     PIC X.
  2671             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2672             20  PI-BPMTS                     PIC S999     COMP-3.
  2673             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2674             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2675             20  PI-CSR-SESSION-SW            PIC X.
  2676                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2677             20  PI-ERRORS-SW                 PIC X.
  2678                 88  FATAL-ERRORS               VALUE 'X'.
  2679*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2680             20  pi-unforced-sw               pic x.
  2681                 88  unforced-errors            value 'X'.
  2682             20  FILLER                       PIC X(4).
  2683
  2684        16  FILLER             PIC X(94).
  2685
  2686 01  W-LETTER-COMMUNICATION-AREAS.
  2687*    COPY ELC1042.
  2688******************************************************************
  2689*                                                                *
  2690*                                                                *
  2691*                           ELC1042                              *
  2692*                            VMOD=2.002                          *
  2693*                                                                *
  2694*    NOTE                                                        *
  2695*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2696*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2697*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2698*        TO THESE PROGRAMS.                                      *
  2699*                                                                *
  2700*    NOTE                                                        *
  2701*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2702*        USE ONLY!                                               *
  2703*                                                                *
  2704******************************************************************
  2705
  2706         16  PI-1042-WA.
  2707             20  PI-ACTION       PIC  X(01).
  2708                 88 PI-SHOW-MODE           VALUE '1'.
  2709                 88 PI-CLEAR-MODE          VALUE '2'.
  2710                 88 PI-CREATE-MODE         VALUE '3'.
  2711             20  PI-COMM-CONTROL PIC  X(12).
  2712             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2713             20  PI-EOF-SW       PIC  X(01).
  2714                 88  PI-FILE-EOF           VALUE 'Y'.
  2715             20  PI-FILETYP      PIC  X(01).
  2716             20  PI-FORM-SQUEEZE-CONTROL
  2717                                 PIC  X(01).
  2718                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2719                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2720             20  PI-LAST-CONTROL PIC  X(12).
  2721             20  PI-TEMP-STOR-ITEMS
  2722                                 PIC S9(04) COMP.
  2723             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2724             20  PI-UPDATE-SW    PIC  9(01).
  2725                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  52
* EL6311.cbl
  2726             20  PI-104-SCREEN-SENT-IND
  2727                                 PIC  X(01).
  2728                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2729                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2730             20  PI-1042-SCREEN-SENT-IND
  2731                                 PIC  X(01).
  2732                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2733                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2734             20  PI-1042-ARCHIVE-IND
  2735                                 PIC  X(01).
  2736                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2737             20  FILLER          PIC  X(29).
  2738*    COPY ELC689PI.
  2739******************************************************************
  2740*                                                                *
  2741*                            ELC689PI                            *
  2742*                            VMOD=2.003                          *
  2743*                                                                *
  2744*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2745*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2746*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2747*                                                                *
  2748*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2749*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2750*    BETWEEN PROGRAMS.                                           *
  2751*                                                                *
  2752*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2753*                                                                *
  2754*               EL631 - EL689  - EL6891 - EL6892                 *
  2755*                                                                *
  2756******************************************************************
  2757*                   C H A N G E   L O G
  2758*
  2759* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2760*-----------------------------------------------------------------
  2761*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2762* EFFECTIVE    NUMBER
  2763*-----------------------------------------------------------------
  2764* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2765* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2766* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2767******************************************************************
  2768
  2769
  2770         16  PI-689-WORK-AREA.
  2771             20  PI-689-ALT-PRINTER-ID
  2772                                 PIC  X(04).
  2773             20  PI-689-ARCHIVE-NUMBER
  2774                                 PIC  9(08).
  2775             20  PI-689-ARCHIVE-SW
  2776                                 PIC  X(01).
  2777                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2778             20  PI-689-DATA-SOURCE
  2779                                 PIC  X(01).
  2780                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2781                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2782                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2783                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  53
* EL6311.cbl
  2784                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2785             20  PI-689-ERROR-IND
  2786                                 PIC  X(01).
  2787                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2788             20  PI-689-ERROR    PIC  9(04).
  2789                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2790                 88  PI-689-FATAL-ERROR
  2791                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2792                            0042 0047 0051 0066 0067 0070
  2793                            0168 0169 0174 0175 0176 0177 0179
  2794                            0180 0181 0182 0184 0185 0189 0190
  2795                            0191
  2796                            0215 0279 0280
  2797                            0412 0413 0454
  2798                            0533 0537
  2799                            2055 2114 2208 2209 2216 2232 2369
  2800                            2398 2433 2908 2999
  2801                            3000 3770 3771 3775
  2802                            7250 7365 7367 7368 7369 7370 7371
  2803                            7272 7373 7374 7376 7377 7378 7379
  2804                            7381 7388 7390 7393 7395 7396 7398
  2805                            9095 9096 9281 9298 9299 9320 9327
  2806                            9426 9427.
  2807                 88  PI-689-STOP-ERROR
  2808                     VALUES 0004 0008 0013 0023 0029 0033
  2809                            0042 0047 0066 0067 0070
  2810                            0168 0169 0174 0175 0176 0177
  2811                            0181 0182 0184 0185 0189 0190
  2812                            0279 0280
  2813                            0412 0413 0454
  2814                            2055 2208 2209 2216 2232
  2815                            2398 2999
  2816                            3000 3770 3771 3775
  2817                            7250 7365 7369 7370 7371
  2818                            7272 7373 7374 7376 7377 7378 7379
  2819                            7381 7388 7390 7393 7396 7398
  2820                            9095 9096 9299 9320 9426.
  2821             20  PI-689-FOLLOW-UP-DATE
  2822                                 PIC  X(02).
  2823             20  PI-689-FORM-NUMBER
  2824                                 PIC  X(04).
  2825             20  PI-689-LABEL-SOURCE
  2826                                 PIC X(01).
  2827                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2828                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2829                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2830                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2831                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2832                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2833                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2834             20  PI-689-NUMBER-COPIES
  2835                                 PIC  9(01).
  2836             20  PI-689-NUMBER-LABEL-LINES
  2837                                 PIC  9(01).
  2838             20  PI-689-NUMBER-TEXT-RECORDS
  2839                                 PIC  9(03).
  2840             20  PI-689-PRINT-ORDER-SW
  2841                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  54
* EL6311.cbl
  2842                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2843                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2844                 88  PI-689-PRINT-LATER     VALUE '3'.
  2845                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2846             20  PI-689-PRINT-RESTRICTION
  2847                                 PIC  X(01).
  2848                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2849                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2850                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2851             20  PI-689-PRINT-SW PIC  X(01).
  2852                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2853             20  PI-689-RESEND-DATE-1
  2854                                 PIC  X(02).
  2855             20  PI-689-RESEND-LETR-1
  2856                                 PIC X(4).
  2857             20  PI-689-TEMP-STOR-ID
  2858                                 PIC  X(08).
  2859             20  PI-689-USE-SCREEN-IND
  2860                                 PIC  X(01).
  2861                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2862             20  PI-689-ARCH-POINTER
  2863                                 PIC S9(08) COMP.
  2864                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2865             20  PI-689-ARCT-POINTER
  2866                                 PIC S9(08) COMP.
  2867                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2868             20  PI-689-VARIABLE-DATA-GRP.
  2869                 24  PI-689-VARIABLE-DATA-1
  2870                                 PIC  X(30).
  2871                 24  PI-689-VARIABLE-DATA-2
  2872                                 PIC  X(30).
  2873                 24  PI-689-VARIABLE-DATA-3
  2874                                 PIC  X(30).
  2875                 24  PI-689-VARIABLE-DATA-4
  2876                                 PIC  X(30).
  2877
  2878         16  PI-689-KEY-DATA-FIELDS.
  2879             20  PI-689-ACCOUNT  PIC  X(10).
  2880             20  PI-689-CARRIER  PIC  X(01).
  2881             20  PI-689-CERT-NO.
  2882                 24  PI-689-CERT-PRIME
  2883                                 PIC  X(10).
  2884                 24  PI-689-CERT-SFX
  2885                                 PIC  X(01).
  2886             20  PI-689-CHG-SEQ-NO
  2887                                 PIC S9(04)    COMP.
  2888             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2889                                 PIC  X(02).
  2890             20  PI-689-ENTRY-BATCH
  2891                                 PIC  X(06).
  2892             20  PI-689-EFF-DATE PIC  X(02).
  2893             20  PI-689-EXP-DATE PIC  X(02).
  2894             20  PI-689-GROUPING PIC  X(06).
  2895             20  PI-689-RESP-PERSON
  2896                                 PIC  X(10).
  2897             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2898             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2899                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  55
* EL6311.cbl
  2900             20  PI-689-STATE    PIC  X(02).
  2901             20  PI-689-TYPE     PIC  X(01).
  2902             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2903             20  PI-689-ALT-SEQ-NO
  2904                                 PIC S9(04)    COMP.
  2905         16  PI-689-DATE-EDIT    PIC  X(08).
  2906         16  PI-689-FOLLOW-UP-EDIT
  2907                                 PIC  X(08).
  2908         16  PI-689-RESEND1-EDIT PIC  X(08).
  2909         16  PI-689-SEQ-EDIT     PIC  X(08).
  2910         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2911         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2912             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2913         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2914         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  56
* EL6311.cbl
  2916
  2917 01  WS-EL6315-PASS-AREA.
  2918        16  PI-6315-ISS-CAN-SW      PIC X.
  2919        16  FILLER                  PIC X(120).
  2920        16  PI-RES-REF-CLM-TYPE     PIC X.
  2921        16  FILLER                  PIC X.
  2922        16  PI-6315-PASS-AREA.
  2923            20 FILLER               PIC X(236).
  2924            20 PI-6315-FINALIZED    PIC X.
  2925            20 FILLER               PIC X(280).
  2926
  2927 01  WS-EL6316-PASS-AREA.
  2928        16  PI-ISS-CAN-SW           PIC X.
  2929        16  FILLER                  PIC X(121).
  2930        16  PI-CLM-RESC-IND         PIC X.
  2931        16  PI-6316-PASS-AREA.
  2932            20 FILLER               PIC X(236).
  2933            20 PI-6316-FINALIZED    PIC X.
  2934            20 FILLER               PIC X(280).
  2935
  2936******************************************************************
  2937*                                                                *
  2938*         P A S S   A R E A   F O R   E D I T                    *
  2939*                                                                *
  2940******************************************************************
  2941
  2942 01  PASSED-RECORD.
  2943     12  RECORD-SAVE                  PIC X(585).
  2944* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2945*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2946*                    BY  WK-CURRENT-DATE.
  2947******************************************************************
  2948*                                                                *
  2949*                                                                *
  2950*                             ELC50W1                            *
  2951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2952*                            VMOD=2.004                          *
  2953*                                                                *
  2954*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2955*                                                                *
  2956*                                                                *
  2957******************************************************************
  2958
  2959     12  WK-WORK-AREA.
  2960         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2961         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2962         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2963         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2964         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2965         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2966         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2967         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2968         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2969         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2970         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2971         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2972         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2973         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  57
* EL6311.cbl
  2974         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2975         16  WK-CREDIT-EDIT-CONTROLS.
  2976             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2977             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2978             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2979             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2980             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2981             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2982         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2983         16  WK-SAVE-REIN-DATA.
  2984             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2985             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2986             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2987         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2988             88  ENTRY-FROM-EL6311       VALUE '6'.
  2989         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2990         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2991     12  WK-RECORD-ADDRESSES.
  2992         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2993         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2994         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2995         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2996         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2997         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2998         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2999         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3000     12  WK-OVER-SHORT-AREA.
  3001         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3002         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3003         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3004             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3005         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  58
* EL6311.cbl
  3007
  3008*    COPY ELCEDITC.
  3009******************************************************************
  3010*                                                                *
  3011*                                                                *
  3012*                            ELCEDITC                            *
  3013*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3014*                            VMOD=2.012                          *
  3015*                                                                *
  3016*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3017*                     EL6313, EL050 AND EL517.                   *
  3018*                                                                *
  3019******************************************************************
  3020******************************************************************
  3021*                   C H A N G E   L O G
  3022*
  3023* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3024*-----------------------------------------------------------------
  3025*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3026* EFFECTIVE    NUMBER
  3027*-----------------------------------------------------------------
  3028* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3029******************************************************************
  3030
  3031     12  EDIT-CRITERIA-DATA.
  3032         16  EC-CO-MONTH-END-DT       PIC XX.
  3033         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3034         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3035         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3036         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3037         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3038         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3039         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3040         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3041         16  EC-CO-REM-TERM-CALC      PIC X.
  3042               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3043               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3044               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3045               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3046
  3047         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3048               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3049               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3050               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3051               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3052               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3053               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3054               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3055               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3056               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3057               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3058
  3059         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3060               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3061               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3062               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3063               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3064               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  59
* EL6311.cbl
  3065               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3066               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3067               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3068
  3069         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3070                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3071                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3072
  3073         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3074                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3075                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3076                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3077                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3078                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3079                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3080                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3081                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3082
  3083         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3084               88  EC-BR-REDUCING                   VALUE 'R'.
  3085               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3086
  3087         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3088         16  EC-BR-LF-DESC             PIC X(10).
  3089         16  EC-BR-AH-DESC             PIC X(10).
  3090         16  EC-BR-LF-COMMENT          PIC X(10).
  3091         16  EC-BR-AH-COMMENT          PIC X(10).
  3092
  3093         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3094               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3095               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3096               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3097               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3098
  3099         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3100               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3101               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3102               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3103               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3104
  3105         16  EC-BR-LF-REFUND-CALC      PIC X.
  3106                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3107                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3108                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3109                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3110                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3111                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3112                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3113
  3114         16  EC-BR-AH-REFUND-CALC      PIC X.
  3115                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3116                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3117                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3118                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3119                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3120                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3121                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3122                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  60
* EL6311.cbl
  3123
  3124         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3125                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3126                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3127                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3128
  3129         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3130                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3131                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3132                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3133
  3134         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3135         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3136         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3137         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3138
  3139         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3140         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3141                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3142                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3143                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3144                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3145
  3146         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3147               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3148               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3149               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3150               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3151               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3152
  3153         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3154               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3155               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3156               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3157               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3158               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3159
  3160         16  EC-ST-LF-REFUND-CALC      PIC X.
  3161                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3162                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3163                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3164                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3165                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3166                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3167                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3168                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3169
  3170         16  EC-ST-AH-REFUND-CALC      PIC X.
  3171                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3172                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3173                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3174                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3175                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3176                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3177                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3178                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3179
  3180         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  61
* EL6311.cbl
  3181         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3182         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3183         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3184         16  EC-AM-EXPIRATION-DT       PIC XX.
  3185         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3186         16  EC-AM-CLASS-CD            PIC XX.
  3187         16  EC-AM-LF-DEVIATION        PIC XXX.
  3188         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3189         16  EC-AM-AH-DEVIATION        PIC XXX.
  3190         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3191         16  EC-AM-PHONE-NO            PIC X(10).
  3192
  3193         16  EC-AM-LF-REFUND-CALC      PIC X.
  3194                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3195                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3196                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3197                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3198                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3199                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3200                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3201
  3202         16  EC-AM-AH-REFUND-CALC      PIC X.
  3203                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3204                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3205                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3206                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3207                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3208                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3209                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3210
  3211         16  EC-AM-BEN-I-G-CD          PIC X.
  3212                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3213                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3214                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3215
  3216         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3217         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3218         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3219         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3220         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3221         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3222         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3223         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3224         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3225
  3226         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3227         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3228         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3229         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3230         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3231         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3232         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3233         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3234         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3235         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3236         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3237         16  EC-RT-LF-NSP-ST           PIC XX.
  3238         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  62
* EL6311.cbl
  3239         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3240         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3241
  3242         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3243             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3244                                             'M' '5' '9' '2'.
  3245             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3246             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3247             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3248             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3249             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3250             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3251             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3252             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3253             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3254             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3255
  3256         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3257             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3258                                             'M' '5' '9' '2'.
  3259             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3260             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3261             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3262             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3263             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3264             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3265             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3266             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3267             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3268             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3269
  3270         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3271         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3272         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3273         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3274         16  EC-CM-DEATH-DT            PIC XX.
  3275
  3276*DMD CUSTOM CODING FIELDS BELOW
  3277*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3278         16  EC-BR-DMD-RATING-SW       PIC X.
  3279                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3280                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3281                 88  NO-DMD-RATING               VALUE 'N'.
  3282
  3283         16  EC-NEW-CERT               PIC X(11).
  3284         16  EC-NEW-STATE              PIC XX.
  3285         16  FILLER                    PIC X.
  3286*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3287         16  OVER-SHORT-EDIT-FIELDS.
  3288             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3289             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3290             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3291             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3292             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3293             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3294             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3295             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3296             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  63
* EL6311.cbl
  3297         16  FILLER                    PIC X(71).
  3298
  3299******************************************************************
  3300
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  64
* EL6311.cbl
  3302
  3303*    COPY ELCJPFX.
  3304******************************************************************
  3305*                                                                *
  3306*                                                                *
  3307*                            ELCJPFX.                            *
  3308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3309*                            VMOD=2.002                          *
  3310*                                                                *
  3311*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3312*                                                                *
  3313*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3314*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3315*        ELCNTL - CONTROL FILE                                   *
  3316*        ELMSTR - CLAIM MASTERS                                  *
  3317*        ELTRLR - ACTIVITY TRAILERS                              *
  3318*        ELCHKQ - CHECK QUE                                      *
  3319******************************************************************
  3320 01  JOURNAL-RECORD.
  3321     12  jp-date                     pic s9(5) comp-3.
  3322     12  jp-time                     pic s9(7) comp-3.
  3323     12  JP-USER-ID                  PIC X(4).
  3324     12  JP-FILE-ID                  PIC X(8).
  3325     12  JP-PROGRAM-ID               PIC X(8).
  3326     12  JP-RECORD-TYPE              PIC X.
  3327         88 JP-ADD              VALUE 'A'.
  3328         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3329         88 JP-AFTER-CHANGE     VALUE 'C'.
  3330         88 JP-DELETE           VALUE 'D'.
  3331         88 JP-GENERIC-DELETE   VALUE 'G'.
  3332         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3333         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3334     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3335     12  JP-RECORD-AREA
  3336
  3337
  3338                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  65
* EL6311.cbl
  3340*    COPY ELCAID.
  3341******************************************************************
  3342*                                                                *
  3343*                            ELCAID.                             *
  3344*                            VMOD=2.001                          *
  3345*                                                                *
  3346*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3347*                                                                *
  3348*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3349*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3350******************************************************************
  3351
  3352 01  DFHAID.
  3353   02  DFHNULL   PIC  X  VALUE  ' '.
  3354   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3355   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3356   02  DFHPEN    PIC  X  VALUE  '='.
  3357   02  DFHOPID   PIC  X  VALUE  'W'.
  3358   02  DFHPA1    PIC  X  VALUE  '%'.
  3359   02  DFHPA2    PIC  X  VALUE  '>'.
  3360   02  DFHPA3    PIC  X  VALUE  ','.
  3361   02  DFHPF1    PIC  X  VALUE  '1'.
  3362   02  DFHPF2    PIC  X  VALUE  '2'.
  3363   02  DFHPF3    PIC  X  VALUE  '3'.
  3364   02  DFHPF4    PIC  X  VALUE  '4'.
  3365   02  DFHPF5    PIC  X  VALUE  '5'.
  3366   02  DFHPF6    PIC  X  VALUE  '6'.
  3367   02  DFHPF7    PIC  X  VALUE  '7'.
  3368   02  DFHPF8    PIC  X  VALUE  '8'.
  3369   02  DFHPF9    PIC  X  VALUE  '9'.
  3370   02  DFHPF10   PIC  X  VALUE  ':'.
  3371   02  DFHPF11   PIC  X  VALUE  '#'.
  3372   02  DFHPF12   PIC  X  VALUE  '@'.
  3373   02  DFHPF13   PIC  X  VALUE  'A'.
  3374   02  DFHPF14   PIC  X  VALUE  'B'.
  3375   02  DFHPF15   PIC  X  VALUE  'C'.
  3376   02  DFHPF16   PIC  X  VALUE  'D'.
  3377   02  DFHPF17   PIC  X  VALUE  'E'.
  3378   02  DFHPF18   PIC  X  VALUE  'F'.
  3379   02  DFHPF19   PIC  X  VALUE  'G'.
  3380   02  DFHPF20   PIC  X  VALUE  'H'.
  3381   02  DFHPF21   PIC  X  VALUE  'I'.
  3382*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3383   02  DFHPF22   PIC  X  VALUE  '['.
  3384   02  DFHPF23   PIC  X  VALUE  '.'.
  3385   02  DFHPF24   PIC  X  VALUE  '<'.
  3386   02  DFHMSRE   PIC  X  VALUE  'X'.
  3387   02  DFHSTRF   PIC  X  VALUE  'h'.
  3388   02  DFHTRIG   PIC  X  VALUE  '"'.
  3389
  3390 01  FILLER    REDEFINES DFHAID.
  3391     12  FILLER              PIC X(8).
  3392     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3393
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  66
* EL6311.cbl
  3395*    COPY EL6311S.
  3396 01  EL631BI.
  3397     05  FILLER            PIC  X(0012).
  3398*    -------------------------------
  3399     05  BDATEL PIC S9(0004) COMP.
  3400     05  BDATEF PIC  X(0001).
  3401     05  FILLER REDEFINES BDATEF.
  3402         10  BDATEA PIC  X(0001).
  3403     05  BDATEI PIC  X(0008).
  3404*    -------------------------------
  3405     05  BTIMEL PIC S9(0004) COMP.
  3406     05  BTIMEF PIC  X(0001).
  3407     05  FILLER REDEFINES BTIMEF.
  3408         10  BTIMEA PIC  X(0001).
  3409     05  BTIMEI PIC  X(0005).
  3410*    -------------------------------
  3411     05  BHEADL PIC S9(0004) COMP.
  3412     05  BHEADF PIC  X(0001).
  3413     05  FILLER REDEFINES BHEADF.
  3414         10  BHEADA PIC  X(0001).
  3415     05  BHEADI PIC  X(0038).
  3416*    -------------------------------
  3417     05  BNCERTLL PIC S9(0004) COMP.
  3418     05  BNCERTLF PIC  X(0001).
  3419     05  FILLER REDEFINES BNCERTLF.
  3420         10  BNCERTLA PIC  X(0001).
  3421     05  BNCERTLI PIC  X(0008).
  3422*    -------------------------------
  3423     05  BNCERTL PIC S9(0004) COMP.
  3424     05  BNCERTF PIC  X(0001).
  3425     05  FILLER REDEFINES BNCERTF.
  3426         10  BNCERTA PIC  X(0001).
  3427     05  BNCERTI PIC  X(0011).
  3428*    -------------------------------
  3429     05  BNSTATLL PIC S9(0004) COMP.
  3430     05  BNSTATLF PIC  X(0001).
  3431     05  FILLER REDEFINES BNSTATLF.
  3432         10  BNSTATLA PIC  X(0001).
  3433     05  BNSTATLI PIC  X(0009).
  3434*    -------------------------------
  3435     05  BNSTATL PIC S9(0004) COMP.
  3436     05  BNSTATF PIC  X(0001).
  3437     05  FILLER REDEFINES BNSTATF.
  3438         10  BNSTATA PIC  X(0001).
  3439     05  BNSTATI PIC  X(0002).
  3440*    -------------------------------
  3441     05  BCHGTL PIC S9(0004) COMP.
  3442     05  BCHGTF PIC  X(0001).
  3443     05  FILLER REDEFINES BCHGTF.
  3444         10  BCHGTA PIC  X(0001).
  3445     05  BCHGTI PIC  X(0004).
  3446*    -------------------------------
  3447     05  BCHGL PIC S9(0004) COMP.
  3448     05  BCHGF PIC  X(0001).
  3449     05  FILLER REDEFINES BCHGF.
  3450         10  BCHGA PIC  X(0001).
  3451     05  BCHGI PIC  X(0004).
  3452*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  67
* EL6311.cbl
  3453     05  BCOMPIDL PIC S9(0004) COMP.
  3454     05  BCOMPIDF PIC  X(0001).
  3455     05  FILLER REDEFINES BCOMPIDF.
  3456         10  BCOMPIDA PIC  X(0001).
  3457     05  BCOMPIDI PIC  X(0003).
  3458*    -------------------------------
  3459     05  BREGIONL PIC S9(0004) COMP.
  3460     05  BREGIONF PIC  X(0001).
  3461     05  FILLER REDEFINES BREGIONF.
  3462         10  BREGIONA PIC  X(0001).
  3463     05  BREGIONI PIC  X(0006).
  3464*    -------------------------------
  3465     05  BUSERL PIC S9(0004) COMP.
  3466     05  BUSERF PIC  X(0001).
  3467     05  FILLER REDEFINES BUSERF.
  3468         10  BUSERA PIC  X(0001).
  3469     05  BUSERI PIC  X(0004).
  3470*    -------------------------------
  3471     05  BMAINTL PIC S9(0004) COMP.
  3472     05  BMAINTF PIC  X(0001).
  3473     05  FILLER REDEFINES BMAINTF.
  3474         10  BMAINTA PIC  X(0001).
  3475     05  BMAINTI PIC  X(0001).
  3476*    -------------------------------
  3477     05  BMANTBYL PIC S9(0004) COMP.
  3478     05  BMANTBYF PIC  X(0001).
  3479     05  FILLER REDEFINES BMANTBYF.
  3480         10  BMANTBYA PIC  X(0001).
  3481     05  BMANTBYI PIC  X(0004).
  3482*    -------------------------------
  3483     05  BCHGHDGL PIC S9(0004) COMP.
  3484     05  BCHGHDGF PIC  X(0001).
  3485     05  FILLER REDEFINES BCHGHDGF.
  3486         10  BCHGHDGA PIC  X(0001).
  3487     05  BCHGHDGI PIC  X(0003).
  3488*    -------------------------------
  3489     05  BMANTDTL PIC S9(0004) COMP.
  3490     05  BMANTDTF PIC  X(0001).
  3491     05  FILLER REDEFINES BMANTDTF.
  3492         10  BMANTDTA PIC  X(0001).
  3493     05  BMANTDTI PIC  X(0008).
  3494*    -------------------------------
  3495     05  BMANTATL PIC S9(0004) COMP.
  3496     05  BMANTATF PIC  X(0001).
  3497     05  FILLER REDEFINES BMANTATF.
  3498         10  BMANTATA PIC  X(0001).
  3499     05  BMANTATI PIC  X(0005).
  3500*    -------------------------------
  3501     05  BCSRL PIC S9(0004) COMP.
  3502     05  BCSRF PIC  X(0001).
  3503     05  FILLER REDEFINES BCSRF.
  3504         10  BCSRA PIC  X(0001).
  3505     05  BCSRI PIC  X(0004).
  3506*    -------------------------------
  3507     05  BBATCHL PIC S9(0004) COMP.
  3508     05  BBATCHF PIC  X(0001).
  3509     05  FILLER REDEFINES BBATCHF.
  3510         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  68
* EL6311.cbl
  3511     05  BBATCHI PIC  X(0006).
  3512*    -------------------------------
  3513     05  BSEQL PIC S9(0004) COMP.
  3514     05  BSEQF PIC  X(0001).
  3515     05  FILLER REDEFINES BSEQF.
  3516         10  BSEQA PIC  X(0001).
  3517     05  BSEQI PIC  X(0004).
  3518*    -------------------------------
  3519     05  BMOENDTL PIC S9(0004) COMP.
  3520     05  BMOENDTF PIC  X(0001).
  3521     05  FILLER REDEFINES BMOENDTF.
  3522         10  BMOENDTA PIC  X(0001).
  3523     05  BMOENDTI PIC  X(0008).
  3524*    -------------------------------
  3525     05  BCARRL PIC S9(0004) COMP.
  3526     05  BCARRF PIC  X(0001).
  3527     05  FILLER REDEFINES BCARRF.
  3528         10  BCARRA PIC  X(0001).
  3529     05  BCARRI PIC  X(0001).
  3530*    -------------------------------
  3531     05  BGROUPL PIC S9(0004) COMP.
  3532     05  BGROUPF PIC  X(0001).
  3533     05  FILLER REDEFINES BGROUPF.
  3534         10  BGROUPA PIC  X(0001).
  3535     05  BGROUPI PIC  X(0006).
  3536*    -------------------------------
  3537     05  BSTATEL PIC S9(0004) COMP.
  3538     05  BSTATEF PIC  X(0001).
  3539     05  FILLER REDEFINES BSTATEF.
  3540         10  BSTATEA PIC  X(0001).
  3541     05  BSTATEI PIC  X(0002).
  3542*    -------------------------------
  3543     05  BACCTL PIC S9(0004) COMP.
  3544     05  BACCTF PIC  X(0001).
  3545     05  FILLER REDEFINES BACCTF.
  3546         10  BACCTA PIC  X(0001).
  3547     05  BACCTI PIC  X(0010).
  3548*    -------------------------------
  3549     05  BVINHL PIC S9(0004) COMP.
  3550     05  BVINHF PIC  X(0001).
  3551     05  FILLER REDEFINES BVINHF.
  3552         10  BVINHA PIC  X(0001).
  3553     05  BVINHI PIC  X(0004).
  3554*    -------------------------------
  3555     05  BVINL PIC S9(0004) COMP.
  3556     05  BVINF PIC  X(0001).
  3557     05  FILLER REDEFINES BVINF.
  3558         10  BVINA PIC  X(0001).
  3559     05  BVINI PIC  X(0017).
  3560*    -------------------------------
  3561     05  BREFHDGL PIC S9(0004) COMP.
  3562     05  BREFHDGF PIC  X(0001).
  3563     05  FILLER REDEFINES BREFHDGF.
  3564         10  BREFHDGA PIC  X(0001).
  3565     05  BREFHDGI PIC  X(0004).
  3566*    -------------------------------
  3567     05  BREFL PIC S9(0004) COMP.
  3568     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  69
* EL6311.cbl
  3569     05  FILLER REDEFINES BREFF.
  3570         10  BREFA PIC  X(0001).
  3571     05  BREFI PIC  X(0012).
  3572*    -------------------------------
  3573     05  BAGEDEFL PIC S9(0004) COMP.
  3574     05  BAGEDEFF PIC  X(0001).
  3575     05  FILLER REDEFINES BAGEDEFF.
  3576         10  BAGEDEFA PIC  X(0001).
  3577     05  BAGEDEFI PIC  X(0004).
  3578*    -------------------------------
  3579     05  BCERTNOL PIC S9(0004) COMP.
  3580     05  BCERTNOF PIC  X(0001).
  3581     05  FILLER REDEFINES BCERTNOF.
  3582         10  BCERTNOA PIC  X(0001).
  3583     05  BCERTNOI PIC  X(0010).
  3584*    -------------------------------
  3585     05  BSUFIXL PIC S9(0004) COMP.
  3586     05  BSUFIXF PIC  X(0001).
  3587     05  FILLER REDEFINES BSUFIXF.
  3588         10  BSUFIXA PIC  X(0001).
  3589     05  BSUFIXI PIC  X(0001).
  3590*    -------------------------------
  3591     05  BEFFDTL PIC S9(0004) COMP.
  3592     05  BEFFDTF PIC  X(0001).
  3593     05  FILLER REDEFINES BEFFDTF.
  3594         10  BEFFDTA PIC  X(0001).
  3595     05  BEFFDTI PIC  X(0008).
  3596*    -------------------------------
  3597     05  BLSTNML PIC S9(0004) COMP.
  3598     05  BLSTNMF PIC  X(0001).
  3599     05  FILLER REDEFINES BLSTNMF.
  3600         10  BLSTNMA PIC  X(0001).
  3601     05  BLSTNMI PIC  X(0015).
  3602*    -------------------------------
  3603     05  B1STNML PIC S9(0004) COMP.
  3604     05  B1STNMF PIC  X(0001).
  3605     05  FILLER REDEFINES B1STNMF.
  3606         10  B1STNMA PIC  X(0001).
  3607     05  B1STNMI PIC  X(0010).
  3608*    -------------------------------
  3609     05  BINITL PIC S9(0004) COMP.
  3610     05  BINITF PIC  X(0001).
  3611     05  FILLER REDEFINES BINITF.
  3612         10  BINITA PIC  X(0001).
  3613     05  BINITI PIC  X(0001).
  3614*    -------------------------------
  3615     05  BSEXL PIC S9(0004) COMP.
  3616     05  BSEXF PIC  X(0001).
  3617     05  FILLER REDEFINES BSEXF.
  3618         10  BSEXA PIC  X(0001).
  3619     05  BSEXI PIC  X(0001).
  3620*    -------------------------------
  3621     05  BAGEL PIC S9(0004) COMP.
  3622     05  BAGEF PIC  X(0001).
  3623     05  FILLER REDEFINES BAGEF.
  3624         10  BAGEA PIC  X(0001).
  3625     05  BAGEI PIC  X(0002).
  3626*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  70
* EL6311.cbl
  3627     05  BBIRTHL PIC S9(0004) COMP.
  3628     05  BBIRTHF PIC  X(0001).
  3629     05  FILLER REDEFINES BBIRTHF.
  3630         10  BBIRTHA PIC  X(0001).
  3631     05  BBIRTHI PIC  X(0008).
  3632*    -------------------------------
  3633     05  B1STPMTL PIC S9(0004) COMP.
  3634     05  B1STPMTF PIC  X(0001).
  3635     05  FILLER REDEFINES B1STPMTF.
  3636         10  B1STPMTA PIC  X(0001).
  3637     05  B1STPMTI PIC  X(0008).
  3638*    -------------------------------
  3639     05  BDAYSL PIC S9(0004) COMP.
  3640     05  BDAYSF PIC  X(0001).
  3641     05  FILLER REDEFINES BDAYSF.
  3642         10  BDAYSA PIC  X(0001).
  3643     05  BDAYSI PIC  X(0003).
  3644*    -------------------------------
  3645     05  BLNTRML PIC S9(0004) COMP.
  3646     05  BLNTRMF PIC  X(0001).
  3647     05  FILLER REDEFINES BLNTRMF.
  3648         10  BLNTRMA PIC  X(0001).
  3649     05  BLNTRMI PIC  X(0003).
  3650*    -------------------------------
  3651     05  BLNOFCRL PIC S9(0004) COMP.
  3652     05  BLNOFCRF PIC  X(0001).
  3653     05  FILLER REDEFINES BLNOFCRF.
  3654         10  BLNOFCRA PIC  X(0001).
  3655     05  BLNOFCRI PIC  X(0005).
  3656*    -------------------------------
  3657     05  BMODEL PIC S9(0004) COMP.
  3658     05  BMODEF PIC  X(0001).
  3659     05  FILLER REDEFINES BMODEF.
  3660         10  BMODEA PIC  X(0001).
  3661     05  BMODEI PIC  X(0001).
  3662*    -------------------------------
  3663     05  BFREQL PIC S9(0004) COMP.
  3664     05  BFREQF PIC  X(0001).
  3665     05  FILLER REDEFINES BFREQF.
  3666         10  BFREQA PIC  X(0001).
  3667     05  BFREQI PIC  X(0002).
  3668*    -------------------------------
  3669     05  BPMTSL PIC S9(0004) COMP.
  3670     05  BPMTSF PIC  X(0001).
  3671     05  FILLER REDEFINES BPMTSF.
  3672         10  BPMTSA PIC  X(0001).
  3673     05  BPMTSI PIC  999.
  3674*    -------------------------------
  3675     05  BPMTAMTL PIC S9(0004) COMP.
  3676     05  BPMTAMTF PIC  X(0001).
  3677     05  FILLER REDEFINES BPMTAMTF.
  3678         10  BPMTAMTA PIC  X(0001).
  3679     05  BPMTAMTI PIC  9(7)V99.
  3680*    -------------------------------
  3681     05  BAPRL PIC S9(0004) COMP.
  3682     05  BAPRF PIC  X(0001).
  3683     05  FILLER REDEFINES BAPRF.
  3684         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  71
* EL6311.cbl
  3685     05  BAPRI PIC  X(7).
  3686*    -------------------------------
  3687     05  BLIVESL PIC S9(0004) COMP.
  3688     05  BLIVESF PIC  X(0001).
  3689     05  FILLER REDEFINES BLIVESF.
  3690         10  BLIVESA PIC  X(0001).
  3691     05  BLIVESI PIC  X(0009).
  3692*    -------------------------------
  3693     05  BMEMCAPL PIC S9(0004) COMP.
  3694     05  BMEMCAPF PIC  X(0001).
  3695     05  FILLER REDEFINES BMEMCAPF.
  3696         10  BMEMCAPA PIC  X(0001).
  3697     05  BMEMCAPI PIC  X(0011).
  3698*    -------------------------------
  3699     05  BORIGHDL PIC S9(0004) COMP.
  3700     05  BORIGHDF PIC  X(0001).
  3701     05  FILLER REDEFINES BORIGHDF.
  3702         10  BORIGHDA PIC  X(0001).
  3703     05  BORIGHDI PIC  X(0009).
  3704*    -------------------------------
  3705     05  DMDBILL PIC S9(0004) COMP.
  3706     05  DMDBILF PIC  X(0001).
  3707     05  FILLER REDEFINES DMDBILF.
  3708         10  DMDBILA PIC  X(0001).
  3709     05  DMDBILI PIC  X(0006).
  3710*    -------------------------------
  3711     05  BFORCEL PIC S9(0004) COMP.
  3712     05  BFORCEF PIC  X(0001).
  3713     05  FILLER REDEFINES BFORCEF.
  3714         10  BFORCEA PIC  X(0001).
  3715     05  BFORCEI PIC  X(0001).
  3716*    -------------------------------
  3717     05  BENTRYL PIC S9(0004) COMP.
  3718     05  BENTRYF PIC  X(0001).
  3719     05  FILLER REDEFINES BENTRYF.
  3720         10  BENTRYA PIC  X(0001).
  3721     05  BENTRYI PIC  X(0001).
  3722*    -------------------------------
  3723     05  BREINL PIC S9(0004) COMP.
  3724     05  BREINF PIC  X(0001).
  3725     05  FILLER REDEFINES BREINF.
  3726         10  BREINA PIC  X(0001).
  3727     05  BREINI PIC  X(0001).
  3728*    -------------------------------
  3729     05  BBILCDL PIC S9(0004) COMP.
  3730     05  BBILCDF PIC  X(0001).
  3731     05  FILLER REDEFINES BBILCDF.
  3732         10  BBILCDA PIC  X(0001).
  3733     05  BBILCDI PIC  X(0001).
  3734*    -------------------------------
  3735     05  BUNWRITL PIC S9(0004) COMP.
  3736     05  BUNWRITF PIC  X(0001).
  3737     05  FILLER REDEFINES BUNWRITF.
  3738         10  BUNWRITA PIC  X(0001).
  3739     05  BUNWRITI PIC  X(0001).
  3740*    -------------------------------
  3741     05  BSKPCDL PIC S9(0004) COMP.
  3742     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  72
* EL6311.cbl
  3743     05  FILLER REDEFINES BSKPCDF.
  3744         10  BSKPCDA PIC  X(0001).
  3745     05  BSKPCDI PIC  X(0001).
  3746*    -------------------------------
  3747     05  BINDGRPL PIC S9(0004) COMP.
  3748     05  BINDGRPF PIC  X(0001).
  3749     05  FILLER REDEFINES BINDGRPF.
  3750         10  BINDGRPA PIC  X(0001).
  3751     05  BINDGRPI PIC  X(0001).
  3752*    -------------------------------
  3753     05  BSIGL PIC S9(0004) COMP.
  3754     05  BSIGF PIC  X(0001).
  3755     05  FILLER REDEFINES BSIGF.
  3756         10  BSIGA PIC  X(0001).
  3757     05  BSIGI PIC  X(0001).
  3758*    -------------------------------
  3759     05  BRTCLSL PIC S9(0004) COMP.
  3760     05  BRTCLSF PIC  X(0001).
  3761     05  FILLER REDEFINES BRTCLSF.
  3762         10  BRTCLSA PIC  X(0001).
  3763     05  BRTCLSI PIC  X(0002).
  3764*    -------------------------------
  3765     05  BCHGCNTL PIC S9(0004) COMP.
  3766     05  BCHGCNTF PIC  X(0001).
  3767     05  FILLER REDEFINES BCHGCNTF.
  3768         10  BCHGCNTA PIC  X(0001).
  3769     05  BCHGCNTI PIC  X(0003).
  3770*    -------------------------------
  3771     05  BMEMBERL PIC S9(0004) COMP.
  3772     05  BMEMBERF PIC  X(0001).
  3773     05  FILLER REDEFINES BMEMBERF.
  3774         10  BMEMBERA PIC  X(0001).
  3775     05  BMEMBERI PIC  X(0012).
  3776*    -------------------------------
  3777     05  BORGNOL PIC S9(0004) COMP.
  3778     05  BORGNOF PIC  X(0001).
  3779     05  FILLER REDEFINES BORGNOF.
  3780         10  BORGNOA PIC  X(0001).
  3781     05  BORGNOI PIC  X(0006).
  3782*    -------------------------------
  3783     05  BORGSEQL PIC S9(0004) COMP.
  3784     05  BORGSEQF PIC  X(0001).
  3785     05  FILLER REDEFINES BORGSEQF.
  3786         10  BORGSEQA PIC  X(0001).
  3787     05  BORGSEQI PIC  X(0004).
  3788*    -------------------------------
  3789     05  BBILLEDL PIC S9(0004) COMP.
  3790     05  BBILLEDF PIC  X(0001).
  3791     05  FILLER REDEFINES BBILLEDF.
  3792         10  BBILLEDA PIC  X(0001).
  3793     05  BBILLEDI PIC  9(9).
  3794*    -------------------------------
  3795     05  BKIND1L PIC S9(0004) COMP.
  3796     05  BKIND1F PIC  X(0001).
  3797     05  FILLER REDEFINES BKIND1F.
  3798         10  BKIND1A PIC  X(0001).
  3799     05  BKIND1I PIC  X(0002).
  3800*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  73
* EL6311.cbl
  3801     05  BTYPE1L PIC S9(0004) COMP.
  3802     05  BTYPE1F PIC  X(0001).
  3803     05  FILLER REDEFINES BTYPE1F.
  3804         10  BTYPE1A PIC  X(0001).
  3805     05  BTYPE1I PIC  X(0003).
  3806*    -------------------------------
  3807     05  BTERM1L PIC S9(0004) COMP.
  3808     05  BTERM1F PIC  X(0001).
  3809     05  FILLER REDEFINES BTERM1F.
  3810         10  BTERM1A PIC  X(0001).
  3811     05  BTERM1I PIC  X(0003).
  3812*    -------------------------------
  3813     05  BBEN1L PIC S9(0004) COMP.
  3814     05  BBEN1F PIC  X(0001).
  3815     05  FILLER REDEFINES BBEN1F.
  3816         10  BBEN1A PIC  X(0001).
  3817     05  BBEN1I PIC  X(0012).
  3818*    -------------------------------
  3819     05  BPREM1L PIC S9(0004) COMP.
  3820     05  BPREM1F PIC  X(0001).
  3821     05  FILLER REDEFINES BPREM1F.
  3822         10  BPREM1A PIC  X(0001).
  3823     05  BPREM1I PIC  X(0011).
  3824*    -------------------------------
  3825     05  BEXPIR1L PIC S9(0004) COMP.
  3826     05  BEXPIR1F PIC  X(0001).
  3827     05  FILLER REDEFINES BEXPIR1F.
  3828         10  BEXPIR1A PIC  X(0001).
  3829     05  BEXPIR1I PIC  X(0008).
  3830*    -------------------------------
  3831     05  BCP1L PIC S9(0004) COMP.
  3832     05  BCP1F PIC  X(0001).
  3833     05  FILLER REDEFINES BCP1F.
  3834         10  BCP1A PIC  X(0001).
  3835     05  BCP1I PIC  X(0002).
  3836*    -------------------------------
  3837     05  BALTBN1L PIC S9(0004) COMP.
  3838     05  BALTBN1F PIC  X(0001).
  3839     05  FILLER REDEFINES BALTBN1F.
  3840         10  BALTBN1A PIC  X(0001).
  3841     05  BALTBN1I PIC  X(0012).
  3842*    -------------------------------
  3843     05  BALTPR1L PIC S9(0004) COMP.
  3844     05  BALTPR1F PIC  X(0001).
  3845     05  FILLER REDEFINES BALTPR1F.
  3846         10  BALTPR1A PIC  X(0001).
  3847     05  BALTPR1I PIC  X(0011).
  3848*    -------------------------------
  3849     05  BBNCD1L PIC S9(0004) COMP.
  3850     05  BBNCD1F PIC  X(0001).
  3851     05  FILLER REDEFINES BBNCD1F.
  3852         10  BBNCD1A PIC  X(0001).
  3853     05  BBNCD1I PIC  X(0003).
  3854*    -------------------------------
  3855     05  BCPRM1L PIC S9(0004) COMP.
  3856     05  BCPRM1F PIC  X(0001).
  3857     05  FILLER REDEFINES BCPRM1F.
  3858         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  74
* EL6311.cbl
  3859     05  BCPRM1I PIC  X(0011).
  3860*    -------------------------------
  3861     05  BCAPRM1L PIC S9(0004) COMP.
  3862     05  BCAPRM1F PIC  X(0001).
  3863     05  FILLER REDEFINES BCAPRM1F.
  3864         10  BCAPRM1A PIC  X(0001).
  3865     05  BCAPRM1I PIC  X(0011).
  3866*    -------------------------------
  3867     05  BENABR1L PIC S9(0004) COMP.
  3868     05  BENABR1F PIC  X(0001).
  3869     05  FILLER REDEFINES BENABR1F.
  3870         10  BENABR1A PIC  X(0001).
  3871     05  BENABR1I PIC  X(0005).
  3872*    -------------------------------
  3873     05  BDIFF1L PIC S9(0004) COMP.
  3874     05  BDIFF1F PIC  X(0001).
  3875     05  FILLER REDEFINES BDIFF1F.
  3876         10  BDIFF1A PIC  X(0001).
  3877     05  BDIFF1I PIC  X(0011).
  3878*    -------------------------------
  3879     05  BBILIT1L PIC S9(0004) COMP.
  3880     05  BBILIT1F PIC  X(0001).
  3881     05  FILLER REDEFINES BBILIT1F.
  3882         10  BBILIT1A PIC  X(0001).
  3883     05  BBILIT1I PIC  X(0008).
  3884*    -------------------------------
  3885     05  BADIFF1L PIC S9(0004) COMP.
  3886     05  BADIFF1F PIC  X(0001).
  3887     05  FILLER REDEFINES BADIFF1F.
  3888         10  BADIFF1A PIC  X(0001).
  3889     05  BADIFF1I PIC  X(0011).
  3890*    -------------------------------
  3891     05  BKIND2L PIC S9(0004) COMP.
  3892     05  BKIND2F PIC  X(0001).
  3893     05  FILLER REDEFINES BKIND2F.
  3894         10  BKIND2A PIC  X(0001).
  3895     05  BKIND2I PIC  X(0002).
  3896*    -------------------------------
  3897     05  BTYPE2L PIC S9(0004) COMP.
  3898     05  BTYPE2F PIC  X(0001).
  3899     05  FILLER REDEFINES BTYPE2F.
  3900         10  BTYPE2A PIC  X(0001).
  3901     05  BTYPE2I PIC  X(0003).
  3902*    -------------------------------
  3903     05  BTERM2L PIC S9(0004) COMP.
  3904     05  BTERM2F PIC  X(0001).
  3905     05  FILLER REDEFINES BTERM2F.
  3906         10  BTERM2A PIC  X(0001).
  3907     05  BTERM2I PIC  X(0003).
  3908*    -------------------------------
  3909     05  BBEN2L PIC S9(0004) COMP.
  3910     05  BBEN2F PIC  X(0001).
  3911     05  FILLER REDEFINES BBEN2F.
  3912         10  BBEN2A PIC  X(0001).
  3913     05  BBEN2I PIC  X(0012).
  3914*    -------------------------------
  3915     05  BPREM2L PIC S9(0004) COMP.
  3916     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  75
* EL6311.cbl
  3917     05  FILLER REDEFINES BPREM2F.
  3918         10  BPREM2A PIC  X(0001).
  3919     05  BPREM2I PIC  X(0011).
  3920*    -------------------------------
  3921     05  BEXPIR2L PIC S9(0004) COMP.
  3922     05  BEXPIR2F PIC  X(0001).
  3923     05  FILLER REDEFINES BEXPIR2F.
  3924         10  BEXPIR2A PIC  X(0001).
  3925     05  BEXPIR2I PIC  X(0008).
  3926*    -------------------------------
  3927     05  BCP2L PIC S9(0004) COMP.
  3928     05  BCP2F PIC  X(0001).
  3929     05  FILLER REDEFINES BCP2F.
  3930         10  BCP2A PIC  X(0001).
  3931     05  BCP2I PIC  X(0002).
  3932*    -------------------------------
  3933     05  BALTBN2L PIC S9(0004) COMP.
  3934     05  BALTBN2F PIC  X(0001).
  3935     05  FILLER REDEFINES BALTBN2F.
  3936         10  BALTBN2A PIC  X(0001).
  3937     05  BALTBN2I PIC  X(0012).
  3938*    -------------------------------
  3939     05  BALTPR2L PIC S9(0004) COMP.
  3940     05  BALTPR2F PIC  X(0001).
  3941     05  FILLER REDEFINES BALTPR2F.
  3942         10  BALTPR2A PIC  X(0001).
  3943     05  BALTPR2I PIC  X(0011).
  3944*    -------------------------------
  3945     05  BBNCD2L PIC S9(0004) COMP.
  3946     05  BBNCD2F PIC  X(0001).
  3947     05  FILLER REDEFINES BBNCD2F.
  3948         10  BBNCD2A PIC  X(0001).
  3949     05  BBNCD2I PIC  X(0003).
  3950*    -------------------------------
  3951     05  BCPRM2L PIC S9(0004) COMP.
  3952     05  BCPRM2F PIC  X(0001).
  3953     05  FILLER REDEFINES BCPRM2F.
  3954         10  BCPRM2A PIC  X(0001).
  3955     05  BCPRM2I PIC  X(0011).
  3956*    -------------------------------
  3957     05  BCAPRM2L PIC S9(0004) COMP.
  3958     05  BCAPRM2F PIC  X(0001).
  3959     05  FILLER REDEFINES BCAPRM2F.
  3960         10  BCAPRM2A PIC  X(0001).
  3961     05  BCAPRM2I PIC  X(0011).
  3962*    -------------------------------
  3963     05  BENABR2L PIC S9(0004) COMP.
  3964     05  BENABR2F PIC  X(0001).
  3965     05  FILLER REDEFINES BENABR2F.
  3966         10  BENABR2A PIC  X(0001).
  3967     05  BENABR2I PIC  X(0005).
  3968*    -------------------------------
  3969     05  BDIFF2L PIC S9(0004) COMP.
  3970     05  BDIFF2F PIC  X(0001).
  3971     05  FILLER REDEFINES BDIFF2F.
  3972         10  BDIFF2A PIC  X(0001).
  3973     05  BDIFF2I PIC  X(0011).
  3974*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  76
* EL6311.cbl
  3975     05  BBILIT2L PIC S9(0004) COMP.
  3976     05  BBILIT2F PIC  X(0001).
  3977     05  FILLER REDEFINES BBILIT2F.
  3978         10  BBILIT2A PIC  X(0001).
  3979     05  BBILIT2I PIC  X(0008).
  3980*    -------------------------------
  3981     05  BADIFF2L PIC S9(0004) COMP.
  3982     05  BADIFF2F PIC  X(0001).
  3983     05  FILLER REDEFINES BADIFF2F.
  3984         10  BADIFF2A PIC  X(0001).
  3985     05  BADIFF2I PIC  X(0011).
  3986*    -------------------------------
  3987     05  BERMSG1L PIC S9(0004) COMP.
  3988     05  BERMSG1F PIC  X(0001).
  3989     05  FILLER REDEFINES BERMSG1F.
  3990         10  BERMSG1A PIC  X(0001).
  3991     05  BERMSG1I PIC  X(0078).
  3992*    -------------------------------
  3993     05  BERMSG2L PIC S9(0004) COMP.
  3994     05  BERMSG2F PIC  X(0001).
  3995     05  FILLER REDEFINES BERMSG2F.
  3996         10  BERMSG2A PIC  X(0001).
  3997     05  BERMSG2I PIC  X(0078).
  3998*    -------------------------------
  3999     05  BERMSG3L PIC S9(0004) COMP.
  4000     05  BERMSG3F PIC  X(0001).
  4001     05  FILLER REDEFINES BERMSG3F.
  4002         10  BERMSG3A PIC  X(0001).
  4003     05  BERMSG3I PIC  X(0078).
  4004*    -------------------------------
  4005     05  BPFENTRL PIC S9(0004) COMP.
  4006     05  BPFENTRF PIC  X(0001).
  4007     05  FILLER REDEFINES BPFENTRF.
  4008         10  BPFENTRA PIC  X(0001).
  4009     05  BPFENTRI PIC  9(2).
  4010*    -------------------------------
  4011     05  BPF5HDRL PIC S9(0004) COMP.
  4012     05  BPF5HDRF PIC  X(0001).
  4013     05  FILLER REDEFINES BPF5HDRF.
  4014         10  BPF5HDRA PIC  X(0001).
  4015     05  BPF5HDRI PIC  X(0005).
  4016*    -------------------------------
  4017     05  BPF4HDRL PIC S9(0004) COMP.
  4018     05  BPF4HDRF PIC  X(0001).
  4019     05  FILLER REDEFINES BPF4HDRF.
  4020         10  BPF4HDRA PIC  X(0001).
  4021     05  BPF4HDRI PIC  X(0013).
  4022*    -------------------------------
  4023     05  BF15HDRL PIC S9(0004) COMP.
  4024     05  BF15HDRF PIC  X(0001).
  4025     05  FILLER REDEFINES BF15HDRF.
  4026         10  BF15HDRA PIC  X(0001).
  4027     05  BF15HDRI PIC  X(0010).
  4028 01  EL631BO REDEFINES EL631BI.
  4029     05  FILLER            PIC  X(0012).
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  77
* EL6311.cbl
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  BTIMEO PIC  99.99.
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BHEADO PIC  X(0038).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BNCERTLO PIC  X(0008).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BNCERTO PIC  X(0011).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BNSTATLO PIC  X(0009).
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  BNSTATO PIC  X(0002).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BCHGTO PIC  X(0004).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BCHGO PIC  ZZZ9.
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BCOMPIDO PIC  X(0003).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BREGIONO PIC  X(0006).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BUSERO PIC  X(0004).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BMAINTO PIC  X(0001).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BMANTBYO PIC  X(0004).
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BCHGHDGO PIC  X(0003).
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
  4077     05  BMANTDTO PIC  X(0008).
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BMANTATO PIC  99.99.
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  BCSRO PIC  X(0004).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  BBATCHO PIC  X(0006).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BSEQO PIC  X(0004).
  4090*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  78
* EL6311.cbl
  4091     05  FILLER            PIC  X(0003).
  4092     05  BMOENDTO PIC  X(0008).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BCARRO PIC  X(0001).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BGROUPO PIC  X(0006).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BSTATEO PIC  X(0002).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BACCTO PIC  X(0010).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BVINHO PIC  X(0004).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BVINO PIC  X(0017).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BREFHDGO PIC  X(0004).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BREFO PIC  X(0012).
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  BAGEDEFO PIC  X(0004).
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BCERTNOO PIC  X(0010).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BSUFIXO PIC  X(0001).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BEFFDTO PIC  X(0008).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  BLSTNMO PIC  X(0015).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  B1STNMO PIC  X(0010).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BINITO PIC  X(0001).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BSEXO PIC  X(0001).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BAGEO PIC  X(0002).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BBIRTHO PIC  X(0008).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  79
* EL6311.cbl
  4149     05  B1STPMTO PIC  X(0008).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BDAYSO PIC  X(0003).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BLNTRMO PIC  X(0003).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BLNOFCRO PIC  X(0005).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BMODEO PIC  X(0001).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BFREQO PIC  X(0002).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BPMTSO PIC  X(0003).
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BPMTAMTO PIC  ZZZZZ9.99.
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BAPRO PIC  99.9999.
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BMEMCAPO PIC  X(0011).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BORIGHDO PIC  X(0009).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  DMDBILO PIC  X(0006).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BFORCEO PIC  X(0001).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BENTRYO PIC  X(0001).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BREINO PIC  X(0001).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BBILCDO PIC  X(0001).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BUNWRITO PIC  X(0001).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BSKPCDO PIC  X(0001).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  80
* EL6311.cbl
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BSIGO PIC  X(0001).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BRTCLSO PIC  X(0002).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BCHGCNTO PIC  X(0003).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BMEMBERO PIC  X(0012).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BORGNOO PIC  X(0006).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BORGSEQO PIC  X(0004).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BKIND1O PIC  X(0002).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BTYPE1O PIC  X(0003).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BTERM1O PIC  X(0003).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BBEN1O PIC  X(0012).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BPREM1O PIC  X(0011).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BEXPIR1O PIC  X(0008).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BCP1O PIC  X(0002).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BALTBN1O PIC  X(0012).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BALTPR1O PIC  X(0011).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BBNCD1O PIC  X(0003).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BCPRM1O PIC  X(0011).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BCAPRM1O PIC  X(0011).
  4264*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  81
* EL6311.cbl
  4265     05  FILLER            PIC  X(0003).
  4266     05  BENABR1O PIC  X(0005).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BDIFF1O PIC  X(0011).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BBILIT1O PIC  X(0008).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BADIFF1O PIC  X(0011).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BKIND2O PIC  X(0002).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BTYPE2O PIC  X(0003).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BTERM2O PIC  X(0003).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BBEN2O PIC  X(0012).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BPREM2O PIC  X(0011).
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BEXPIR2O PIC  X(0008).
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BCP2O PIC  X(0002).
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BALTBN2O PIC  X(0012).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BALTPR2O PIC  X(0011).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  BBNCD2O PIC  X(0003).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  BCPRM2O PIC  X(0011).
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BCAPRM2O PIC  X(0011).
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  BENABR2O PIC  X(0005).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BDIFF2O PIC  X(0011).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  BBILIT2O PIC  X(0008).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  82
* EL6311.cbl
  4323     05  BADIFF2O PIC  X(0011).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BERMSG1O PIC  X(0078).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BERMSG2O PIC  X(0078).
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
  4332     05  BERMSG3O PIC  X(0078).
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  BPFENTRO PIC  X(0002).
  4336*    -------------------------------
  4337     05  FILLER            PIC  X(0003).
  4338     05  BPF5HDRO PIC  X(0005).
  4339*    -------------------------------
  4340     05  FILLER            PIC  X(0003).
  4341     05  BPF4HDRO PIC  X(0013).
  4342*    -------------------------------
  4343     05  FILLER            PIC  X(0003).
  4344     05  BF15HDRO PIC  X(0010).
  4345*    -------------------------------
  4346 01  EL631CI REDEFINES EL631BI.
  4347     05  FILLER            PIC  X(0012).
  4348*    -------------------------------
  4349     05  CDATEL PIC S9(0004) COMP.
  4350     05  CDATEF PIC  X(0001).
  4351     05  FILLER REDEFINES CDATEF.
  4352         10  CDATEA PIC  X(0001).
  4353     05  CDATEI PIC  X(0008).
  4354*    -------------------------------
  4355     05  CTIMEL PIC S9(0004) COMP.
  4356     05  CTIMEF PIC  X(0001).
  4357     05  FILLER REDEFINES CTIMEF.
  4358         10  CTIMEA PIC  X(0001).
  4359     05  CTIMEI PIC  X(0005).
  4360*    -------------------------------
  4361     05  CHEADL PIC S9(0004) COMP.
  4362     05  CHEADF PIC  X(0001).
  4363     05  FILLER REDEFINES CHEADF.
  4364         10  CHEADA PIC  X(0001).
  4365     05  CHEADI PIC  X(0038).
  4366*    -------------------------------
  4367     05  CCHGTL PIC S9(0004) COMP.
  4368     05  CCHGTF PIC  X(0001).
  4369     05  FILLER REDEFINES CCHGTF.
  4370         10  CCHGTA PIC  X(0001).
  4371     05  CCHGTI PIC  X(0004).
  4372*    -------------------------------
  4373     05  CCHGL PIC S9(0004) COMP.
  4374     05  CCHGF PIC  X(0001).
  4375     05  FILLER REDEFINES CCHGF.
  4376         10  CCHGA PIC  X(0001).
  4377     05  CCHGI PIC  X(0004).
  4378*    -------------------------------
  4379     05  CMAINTL PIC S9(0004) COMP.
  4380     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  83
* EL6311.cbl
  4381     05  FILLER REDEFINES CMAINTF.
  4382         10  CMAINTA PIC  X(0001).
  4383     05  CMAINTI PIC  X(0001).
  4384*    -------------------------------
  4385     05  CMANTBYL PIC S9(0004) COMP.
  4386     05  CMANTBYF PIC  X(0001).
  4387     05  FILLER REDEFINES CMANTBYF.
  4388         10  CMANTBYA PIC  X(0001).
  4389     05  CMANTBYI PIC  X(0004).
  4390*    -------------------------------
  4391     05  CCHGHDGL PIC S9(0004) COMP.
  4392     05  CCHGHDGF PIC  X(0001).
  4393     05  FILLER REDEFINES CCHGHDGF.
  4394         10  CCHGHDGA PIC  X(0001).
  4395     05  CCHGHDGI PIC  X(0003).
  4396*    -------------------------------
  4397     05  CMANTDTL PIC S9(0004) COMP.
  4398     05  CMANTDTF PIC  X(0001).
  4399     05  FILLER REDEFINES CMANTDTF.
  4400         10  CMANTDTA PIC  X(0001).
  4401     05  CMANTDTI PIC  X(0008).
  4402*    -------------------------------
  4403     05  CMANTATL PIC S9(0004) COMP.
  4404     05  CMANTATF PIC  X(0001).
  4405     05  FILLER REDEFINES CMANTATF.
  4406         10  CMANTATA PIC  X(0001).
  4407     05  CMANTATI PIC  X(0005).
  4408*    -------------------------------
  4409     05  CCSRL PIC S9(0004) COMP.
  4410     05  CCSRF PIC  X(0001).
  4411     05  FILLER REDEFINES CCSRF.
  4412         10  CCSRA PIC  X(0001).
  4413     05  CCSRI PIC  X(0004).
  4414*    -------------------------------
  4415     05  CBATCHL PIC S9(0004) COMP.
  4416     05  CBATCHF PIC  X(0001).
  4417     05  FILLER REDEFINES CBATCHF.
  4418         10  CBATCHA PIC  X(0001).
  4419     05  CBATCHI PIC  X(0006).
  4420*    -------------------------------
  4421     05  CSEQL PIC S9(0004) COMP.
  4422     05  CSEQF PIC  X(0001).
  4423     05  FILLER REDEFINES CSEQF.
  4424         10  CSEQA PIC  X(0001).
  4425     05  CSEQI PIC  X(0004).
  4426*    -------------------------------
  4427     05  CMOENDTL PIC S9(0004) COMP.
  4428     05  CMOENDTF PIC  X(0001).
  4429     05  FILLER REDEFINES CMOENDTF.
  4430         10  CMOENDTA PIC  X(0001).
  4431     05  CMOENDTI PIC  X(0008).
  4432*    -------------------------------
  4433     05  CCARRL PIC S9(0004) COMP.
  4434     05  CCARRF PIC  X(0001).
  4435     05  FILLER REDEFINES CCARRF.
  4436         10  CCARRA PIC  X(0001).
  4437     05  CCARRI PIC  X(0001).
  4438*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  84
* EL6311.cbl
  4439     05  CGROUPL PIC S9(0004) COMP.
  4440     05  CGROUPF PIC  X(0001).
  4441     05  FILLER REDEFINES CGROUPF.
  4442         10  CGROUPA PIC  X(0001).
  4443     05  CGROUPI PIC  X(0006).
  4444*    -------------------------------
  4445     05  CSTATEL PIC S9(0004) COMP.
  4446     05  CSTATEF PIC  X(0001).
  4447     05  FILLER REDEFINES CSTATEF.
  4448         10  CSTATEA PIC  X(0001).
  4449     05  CSTATEI PIC  X(0002).
  4450*    -------------------------------
  4451     05  CACCTL PIC S9(0004) COMP.
  4452     05  CACCTF PIC  X(0001).
  4453     05  FILLER REDEFINES CACCTF.
  4454         10  CACCTA PIC  X(0001).
  4455     05  CACCTI PIC  X(0010).
  4456*    -------------------------------
  4457     05  CORIGHDL PIC S9(0004) COMP.
  4458     05  CORIGHDF PIC  X(0001).
  4459     05  FILLER REDEFINES CORIGHDF.
  4460         10  CORIGHDA PIC  X(0001).
  4461     05  CORIGHDI PIC  X(0011).
  4462*    -------------------------------
  4463     05  CORGNOL PIC S9(0004) COMP.
  4464     05  CORGNOF PIC  X(0001).
  4465     05  FILLER REDEFINES CORGNOF.
  4466         10  CORGNOA PIC  X(0001).
  4467     05  CORGNOI PIC  X(0006).
  4468*    -------------------------------
  4469     05  CORGSEQL PIC S9(0004) COMP.
  4470     05  CORGSEQF PIC  X(0001).
  4471     05  FILLER REDEFINES CORGSEQF.
  4472         10  CORGSEQA PIC  X(0001).
  4473     05  CORGSEQI PIC  X(0004).
  4474*    -------------------------------
  4475     05  CREFHDGL PIC S9(0004) COMP.
  4476     05  CREFHDGF PIC  X(0001).
  4477     05  FILLER REDEFINES CREFHDGF.
  4478         10  CREFHDGA PIC  X(0001).
  4479     05  CREFHDGI PIC  X(0010).
  4480*    -------------------------------
  4481     05  CREFL PIC S9(0004) COMP.
  4482     05  CREFF PIC  X(0001).
  4483     05  FILLER REDEFINES CREFF.
  4484         10  CREFA PIC  X(0001).
  4485     05  CREFI PIC  X(0012).
  4486*    -------------------------------
  4487     05  CNHINTL PIC S9(0004) COMP.
  4488     05  CNHINTF PIC  X(0001).
  4489     05  FILLER REDEFINES CNHINTF.
  4490         10  CNHINTA PIC  X(0001).
  4491     05  CNHINTI PIC  9(7)V99.
  4492*    -------------------------------
  4493     05  CCERTNOL PIC S9(0004) COMP.
  4494     05  CCERTNOF PIC  X(0001).
  4495     05  FILLER REDEFINES CCERTNOF.
  4496         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  85
* EL6311.cbl
  4497     05  CCERTNOI PIC  X(0010).
  4498*    -------------------------------
  4499     05  CSUFIXL PIC S9(0004) COMP.
  4500     05  CSUFIXF PIC  X(0001).
  4501     05  FILLER REDEFINES CSUFIXF.
  4502         10  CSUFIXA PIC  X(0001).
  4503     05  CSUFIXI PIC  X(0001).
  4504*    -------------------------------
  4505     05  CEFFDTL PIC S9(0004) COMP.
  4506     05  CEFFDTF PIC  X(0001).
  4507     05  FILLER REDEFINES CEFFDTF.
  4508         10  CEFFDTA PIC  X(0001).
  4509     05  CEFFDTI PIC  X(0008).
  4510*    -------------------------------
  4511     05  CLSTNML PIC S9(0004) COMP.
  4512     05  CLSTNMF PIC  X(0001).
  4513     05  FILLER REDEFINES CLSTNMF.
  4514         10  CLSTNMA PIC  X(0001).
  4515     05  CLSTNMI PIC  X(0015).
  4516*    -------------------------------
  4517     05  CPCYNL PIC S9(0004) COMP.
  4518     05  CPCYNF PIC  X(0001).
  4519     05  FILLER REDEFINES CPCYNF.
  4520         10  CPCYNA PIC  X(0001).
  4521     05  CPCYNI PIC  X(0001).
  4522*    -------------------------------
  4523     05  CINAMEL PIC S9(0004) COMP.
  4524     05  CINAMEF PIC  X(0001).
  4525     05  FILLER REDEFINES CINAMEF.
  4526         10  CINAMEA PIC  X(0001).
  4527     05  CINAMEI PIC  X(0015).
  4528*    -------------------------------
  4529     05  CINITSL PIC S9(0004) COMP.
  4530     05  CINITSF PIC  X(0001).
  4531     05  FILLER REDEFINES CINITSF.
  4532         10  CINITSA PIC  X(0001).
  4533     05  CINITSI PIC  X(0010).
  4534*    -------------------------------
  4535     05  CCANREAL PIC S9(0004) COMP.
  4536     05  CCANREAF PIC  X(0001).
  4537     05  FILLER REDEFINES CCANREAF.
  4538         10  CCANREAA PIC  X(0001).
  4539     05  CCANREAI PIC  X(0001).
  4540*    -------------------------------
  4541     05  CKIND1L PIC S9(0004) COMP.
  4542     05  CKIND1F PIC  X(0001).
  4543     05  FILLER REDEFINES CKIND1F.
  4544         10  CKIND1A PIC  X(0001).
  4545     05  CKIND1I PIC  X(0002).
  4546*    -------------------------------
  4547     05  CCANDT1L PIC S9(0004) COMP.
  4548     05  CCANDT1F PIC  X(0001).
  4549     05  FILLER REDEFINES CCANDT1F.
  4550         10  CCANDT1A PIC  X(0001).
  4551     05  CCANDT1I PIC  X(0008).
  4552*    -------------------------------
  4553     05  CREFND1L PIC S9(0004) COMP.
  4554     05  CREFND1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  86
* EL6311.cbl
  4555     05  FILLER REDEFINES CREFND1F.
  4556         10  CREFND1A PIC  X(0001).
  4557     05  CREFND1I PIC  S9(9)V99.
  4558*    -------------------------------
  4559     05  CMTHD1L PIC S9(0004) COMP.
  4560     05  CMTHD1F PIC  X(0001).
  4561     05  FILLER REDEFINES CMTHD1F.
  4562         10  CMTHD1A PIC  X(0001).
  4563     05  CMTHD1I PIC  X(0001).
  4564*    -------------------------------
  4565     05  CKIND2L PIC S9(0004) COMP.
  4566     05  CKIND2F PIC  X(0001).
  4567     05  FILLER REDEFINES CKIND2F.
  4568         10  CKIND2A PIC  X(0001).
  4569     05  CKIND2I PIC  X(0002).
  4570*    -------------------------------
  4571     05  CCANDT2L PIC S9(0004) COMP.
  4572     05  CCANDT2F PIC  X(0001).
  4573     05  FILLER REDEFINES CCANDT2F.
  4574         10  CCANDT2A PIC  X(0001).
  4575     05  CCANDT2I PIC  X(0008).
  4576*    -------------------------------
  4577     05  CREFND2L PIC S9(0004) COMP.
  4578     05  CREFND2F PIC  X(0001).
  4579     05  FILLER REDEFINES CREFND2F.
  4580         10  CREFND2A PIC  X(0001).
  4581     05  CREFND2I PIC  S9(9)V99.
  4582*    -------------------------------
  4583     05  CMTHD2L PIC S9(0004) COMP.
  4584     05  CMTHD2F PIC  X(0001).
  4585     05  FILLER REDEFINES CMTHD2F.
  4586         10  CMTHD2A PIC  X(0001).
  4587     05  CMTHD2I PIC  X(0001).
  4588*    -------------------------------
  4589     05  CLIVESL PIC S9(0004) COMP.
  4590     05  CLIVESF PIC  X(0001).
  4591     05  FILLER REDEFINES CLIVESF.
  4592         10  CLIVESA PIC  X(0001).
  4593     05  CLIVESI PIC  X(0003).
  4594*    -------------------------------
  4595     05  CFORCEL PIC S9(0004) COMP.
  4596     05  CFORCEF PIC  X(0001).
  4597     05  FILLER REDEFINES CFORCEF.
  4598         10  CFORCEA PIC  X(0001).
  4599     05  CFORCEI PIC  X(0001).
  4600*    -------------------------------
  4601     05  CBILCDL PIC S9(0004) COMP.
  4602     05  CBILCDF PIC  X(0001).
  4603     05  FILLER REDEFINES CBILCDF.
  4604         10  CBILCDA PIC  X(0001).
  4605     05  CBILCDI PIC  X(0001).
  4606*    -------------------------------
  4607     05  CCRFND1L PIC S9(0004) COMP.
  4608     05  CCRFND1F PIC  X(0001).
  4609     05  FILLER REDEFINES CCRFND1F.
  4610         10  CCRFND1A PIC  X(0001).
  4611     05  CCRFND1I PIC  X(0011).
  4612*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  87
* EL6311.cbl
  4613     05  CCRFND2L PIC S9(0004) COMP.
  4614     05  CCRFND2F PIC  X(0001).
  4615     05  FILLER REDEFINES CCRFND2F.
  4616         10  CCRFND2A PIC  X(0001).
  4617     05  CCRFND2I PIC  X(0011).
  4618*    -------------------------------
  4619     05  CBILIT1L PIC S9(0004) COMP.
  4620     05  CBILIT1F PIC  X(0001).
  4621     05  FILLER REDEFINES CBILIT1F.
  4622         10  CBILIT1A PIC  X(0001).
  4623     05  CBILIT1I PIC  X(0008).
  4624*    -------------------------------
  4625     05  CDRFND1L PIC S9(0004) COMP.
  4626     05  CDRFND1F PIC  X(0001).
  4627     05  FILLER REDEFINES CDRFND1F.
  4628         10  CDRFND1A PIC  X(0001).
  4629     05  CDRFND1I PIC  X(0011).
  4630*    -------------------------------
  4631     05  CBILIT2L PIC S9(0004) COMP.
  4632     05  CBILIT2F PIC  X(0001).
  4633     05  FILLER REDEFINES CBILIT2F.
  4634         10  CBILIT2A PIC  X(0001).
  4635     05  CBILIT2I PIC  X(0008).
  4636*    -------------------------------
  4637     05  CDRFND2L PIC S9(0004) COMP.
  4638     05  CDRFND2F PIC  X(0001).
  4639     05  FILLER REDEFINES CDRFND2F.
  4640         10  CDRFND2A PIC  X(0001).
  4641     05  CDRFND2I PIC  X(0011).
  4642*    -------------------------------
  4643     05  CCANTXTL PIC S9(0004) COMP.
  4644     05  CCANTXTF PIC  X(0001).
  4645     05  FILLER REDEFINES CCANTXTF.
  4646         10  CCANTXTA PIC  X(0001).
  4647     05  CCANTXTI PIC  X(0005).
  4648*    -------------------------------
  4649     05  CCANFEEL PIC S9(0004) COMP.
  4650     05  CCANFEEF PIC  X(0001).
  4651     05  FILLER REDEFINES CCANFEEF.
  4652         10  CCANFEEA PIC  X(0001).
  4653     05  CCANFEEI PIC  X(0002).
  4654*    -------------------------------
  4655     05  CTERM1L PIC S9(0004) COMP.
  4656     05  CTERM1F PIC  X(0001).
  4657     05  FILLER REDEFINES CTERM1F.
  4658         10  CTERM1A PIC  X(0001).
  4659     05  CTERM1I PIC  X(0003).
  4660*    -------------------------------
  4661     05  CRTERM1L PIC S9(0004) COMP.
  4662     05  CRTERM1F PIC  X(0001).
  4663     05  FILLER REDEFINES CRTERM1F.
  4664         10  CRTERM1A PIC  X(0001).
  4665     05  CRTERM1I PIC  X(0003).
  4666*    -------------------------------
  4667     05  CPREM1L PIC S9(0004) COMP.
  4668     05  CPREM1F PIC  X(0001).
  4669     05  FILLER REDEFINES CPREM1F.
  4670         10  CPREM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  88
* EL6311.cbl
  4671     05  CPREM1I PIC  X(0011).
  4672*    -------------------------------
  4673     05  CTERM2L PIC S9(0004) COMP.
  4674     05  CTERM2F PIC  X(0001).
  4675     05  FILLER REDEFINES CTERM2F.
  4676         10  CTERM2A PIC  X(0001).
  4677     05  CTERM2I PIC  X(0003).
  4678*    -------------------------------
  4679     05  CRTERM2L PIC S9(0004) COMP.
  4680     05  CRTERM2F PIC  X(0001).
  4681     05  FILLER REDEFINES CRTERM2F.
  4682         10  CRTERM2A PIC  X(0001).
  4683     05  CRTERM2I PIC  X(0003).
  4684*    -------------------------------
  4685     05  CPREM2L PIC S9(0004) COMP.
  4686     05  CPREM2F PIC  X(0001).
  4687     05  FILLER REDEFINES CPREM2F.
  4688         10  CPREM2A PIC  X(0001).
  4689     05  CPREM2I PIC  X(0011).
  4690*    -------------------------------
  4691     05  CENTRDTL PIC S9(0004) COMP.
  4692     05  CENTRDTF PIC  X(0001).
  4693     05  FILLER REDEFINES CENTRDTF.
  4694         10  CENTRDTA PIC  X(0001).
  4695     05  CENTRDTI PIC  X(0008).
  4696*    -------------------------------
  4697     05  CPAYEEL PIC S9(0004) COMP.
  4698     05  CPAYEEF PIC  X(0001).
  4699     05  FILLER REDEFINES CPAYEEF.
  4700         10  CPAYEEA PIC  X(0001).
  4701     05  CPAYEEI PIC  X(0006).
  4702*    -------------------------------
  4703     05  CRFNDSWL PIC S9(0004) COMP.
  4704     05  CRFNDSWF PIC  X(0001).
  4705     05  FILLER REDEFINES CRFNDSWF.
  4706         10  CRFNDSWA PIC  X(0001).
  4707     05  CRFNDSWI PIC  X(0003).
  4708*    -------------------------------
  4709     05  CLFHDGL PIC S9(0004) COMP.
  4710     05  CLFHDGF PIC  X(0001).
  4711     05  FILLER REDEFINES CLFHDGF.
  4712         10  CLFHDGA PIC  X(0001).
  4713     05  CLFHDGI PIC  X(0006).
  4714*    -------------------------------
  4715     05  CAHHDGL PIC S9(0004) COMP.
  4716     05  CAHHDGF PIC  X(0001).
  4717     05  FILLER REDEFINES CAHHDGF.
  4718         10  CAHHDGA PIC  X(0001).
  4719     05  CAHHDGI PIC  X(0006).
  4720*    -------------------------------
  4721     05  CENTDTL PIC S9(0004) COMP.
  4722     05  CENTDTF PIC  X(0001).
  4723     05  FILLER REDEFINES CENTDTF.
  4724         10  CENTDTA PIC  X(0001).
  4725     05  CENTDTI PIC  X(0008).
  4726*    -------------------------------
  4727     05  CENTBYL PIC S9(0004) COMP.
  4728     05  CENTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  89
* EL6311.cbl
  4729     05  FILLER REDEFINES CENTBYF.
  4730         10  CENTBYA PIC  X(0001).
  4731     05  CENTBYI PIC  X(0004).
  4732*    -------------------------------
  4733     05  CCHGCNTL PIC S9(0004) COMP.
  4734     05  CCHGCNTF PIC  X(0001).
  4735     05  FILLER REDEFINES CCHGCNTF.
  4736         10  CCHGCNTA PIC  X(0001).
  4737     05  CCHGCNTI PIC  X(0003).
  4738*    -------------------------------
  4739     05  CLFREFNL PIC S9(0004) COMP.
  4740     05  CLFREFNF PIC  X(0001).
  4741     05  FILLER REDEFINES CLFREFNF.
  4742         10  CLFREFNA PIC  X(0001).
  4743     05  CLFREFNI PIC  X(0006).
  4744*    -------------------------------
  4745     05  CAHREFNL PIC S9(0004) COMP.
  4746     05  CAHREFNF PIC  X(0001).
  4747     05  FILLER REDEFINES CAHREFNF.
  4748         10  CAHREFNA PIC  X(0001).
  4749     05  CAHREFNI PIC  X(0006).
  4750*    -------------------------------
  4751     05  CREINCDL PIC S9(0004) COMP.
  4752     05  CREINCDF PIC  X(0001).
  4753     05  FILLER REDEFINES CREINCDF.
  4754         10  CREINCDA PIC  X(0001).
  4755     05  CREINCDI PIC  X(0003).
  4756*    -------------------------------
  4757     05  CAEFFDTL PIC S9(0004) COMP.
  4758     05  CAEFFDTF PIC  X(0001).
  4759     05  FILLER REDEFINES CAEFFDTF.
  4760         10  CAEFFDTA PIC  X(0001).
  4761     05  CAEFFDTI PIC  X(0008).
  4762*    -------------------------------
  4763     05  CAEXPDTL PIC S9(0004) COMP.
  4764     05  CAEXPDTF PIC  X(0001).
  4765     05  FILLER REDEFINES CAEXPDTF.
  4766         10  CAEXPDTA PIC  X(0001).
  4767     05  CAEXPDTI PIC  X(0008).
  4768*    -------------------------------
  4769     05  COMMLFL PIC S9(0004) COMP.
  4770     05  COMMLFF PIC  X(0001).
  4771     05  FILLER REDEFINES COMMLFF.
  4772         10  COMMLFA PIC  X(0001).
  4773     05  COMMLFI PIC  X(0006).
  4774*    -------------------------------
  4775     05  COMMAHL PIC S9(0004) COMP.
  4776     05  COMMAHF PIC  X(0001).
  4777     05  FILLER REDEFINES COMMAHF.
  4778         10  COMMAHA PIC  X(0001).
  4779     05  COMMAHI PIC  X(0006).
  4780*    -------------------------------
  4781     05  CERMSG1L PIC S9(0004) COMP.
  4782     05  CERMSG1F PIC  X(0001).
  4783     05  FILLER REDEFINES CERMSG1F.
  4784         10  CERMSG1A PIC  X(0001).
  4785     05  CERMSG1I PIC  X(0078).
  4786*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  90
* EL6311.cbl
  4787     05  CERMSG2L PIC S9(0004) COMP.
  4788     05  CERMSG2F PIC  X(0001).
  4789     05  FILLER REDEFINES CERMSG2F.
  4790         10  CERMSG2A PIC  X(0001).
  4791     05  CERMSG2I PIC  X(0078).
  4792*    -------------------------------
  4793     05  CERMSG3L PIC S9(0004) COMP.
  4794     05  CERMSG3F PIC  X(0001).
  4795     05  FILLER REDEFINES CERMSG3F.
  4796         10  CERMSG3A PIC  X(0001).
  4797     05  CERMSG3I PIC  X(0078).
  4798*    -------------------------------
  4799     05  CPFENTRL PIC S9(0004) COMP.
  4800     05  CPFENTRF PIC  X(0001).
  4801     05  FILLER REDEFINES CPFENTRF.
  4802         10  CPFENTRA PIC  X(0001).
  4803     05  CPFENTRI PIC  9(2).
  4804*    -------------------------------
  4805     05  CPF5HDRL PIC S9(0004) COMP.
  4806     05  CPF5HDRF PIC  X(0001).
  4807     05  FILLER REDEFINES CPF5HDRF.
  4808         10  CPF5HDRA PIC  X(0001).
  4809     05  CPF5HDRI PIC  X(0005).
  4810*    -------------------------------
  4811     05  CPF4HDRL PIC S9(0004) COMP.
  4812     05  CPF4HDRF PIC  X(0001).
  4813     05  FILLER REDEFINES CPF4HDRF.
  4814         10  CPF4HDRA PIC  X(0001).
  4815     05  CPF4HDRI PIC  X(0013).
  4816*    -------------------------------
  4817     05  CF15HDRL PIC S9(0004) COMP.
  4818     05  CF15HDRF PIC  X(0001).
  4819     05  FILLER REDEFINES CF15HDRF.
  4820         10  CF15HDRA PIC  X(0001).
  4821     05  CF15HDRI PIC  X(0022).
  4822 01  EL631CO REDEFINES EL631BI.
  4823     05  FILLER            PIC  X(0012).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CDATEO PIC  X(0008).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CTIMEO PIC  99.99.
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CHEADO PIC  X(0038).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CCHGTO PIC  X(0004).
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CCHGO PIC  ZZZ9.
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CMAINTO PIC  X(0001).
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CMANTBYO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  91
* EL6311.cbl
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CCHGHDGO PIC  X(0003).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CMANTDTO PIC  X(0008).
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CMANTATO PIC  99.99.
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CCSRO PIC  X(0004).
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CBATCHO PIC  X(0006).
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CSEQO PIC  X(0004).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CMOENDTO PIC  X(0008).
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CCARRO PIC  X(0001).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CGROUPO PIC  X(0006).
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CSTATEO PIC  X(0002).
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CACCTO PIC  X(0010).
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CORIGHDO PIC  X(0011).
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CORGNOO PIC  X(0006).
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CORGSEQO PIC  X(0004).
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  CREFHDGO PIC  X(0010).
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CREFO PIC  X(0012).
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CNHINTO PIC  999999.99.
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CCERTNOO PIC  X(0010).
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CSUFIXO PIC  X(0001).
  4902*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  92
* EL6311.cbl
  4903     05  FILLER            PIC  X(0003).
  4904     05  CEFFDTO PIC  X(0008).
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CLSTNMO PIC  X(0015).
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CPCYNO PIC  X(0001).
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CINAMEO PIC  X(0015).
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CINITSO PIC  X(0010).
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CCANREAO PIC  X(0001).
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CKIND1O PIC  X(0002).
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CCANDT1O PIC  X(0008).
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CREFND1O PIC  Z(7).99-.
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CMTHD1O PIC  X(0001).
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CKIND2O PIC  X(0002).
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CCANDT2O PIC  X(0008).
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CREFND2O PIC  Z(7).99-.
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CMTHD2O PIC  X(0001).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CLIVESO PIC  X(0003).
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CFORCEO PIC  X(0001).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CBILCDO PIC  X(0001).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CCRFND1O PIC  Z(7).99-.
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CCRFND2O PIC  Z(7).99-.
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  93
* EL6311.cbl
  4961     05  CBILIT1O PIC  X(0008).
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CDRFND1O PIC  Z(7).99-.
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CBILIT2O PIC  X(0008).
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CDRFND2O PIC  Z(7).99-.
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CCANTXTO PIC  X(0005).
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CCANFEEO PIC  Z9.
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CTERM1O PIC  ZZ9.
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CRTERM1O PIC  ZZ9.
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CPREM1O PIC  ZZZZZZ9.99-.
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CTERM2O PIC  ZZ9.
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CRTERM2O PIC  ZZ9.
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CPREM2O PIC  ZZZZZZ9.99-.
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CENTRDTO PIC  X(0008).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CPAYEEO PIC  X(0006).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CRFNDSWO PIC  X(0003).
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CLFHDGO PIC  X(0006).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CAHHDGO PIC  X(0006).
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CENTDTO PIC  X(0008).
  5013*    -------------------------------
  5014     05  FILLER            PIC  X(0003).
  5015     05  CENTBYO PIC  X(0004).
  5016*    -------------------------------
  5017     05  FILLER            PIC  X(0003).
  5018     05  CCHGCNTO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  94
* EL6311.cbl
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  CLFREFNO PIC  X(0006).
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  CAHREFNO PIC  X(0006).
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  CREINCDO PIC  X(0003).
  5028*    -------------------------------
  5029     05  FILLER            PIC  X(0003).
  5030     05  CAEFFDTO PIC  X(0008).
  5031*    -------------------------------
  5032     05  FILLER            PIC  X(0003).
  5033     05  CAEXPDTO PIC  X(0008).
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  COMMLFO PIC  .99999.
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  COMMAHO PIC  .99999.
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  CERMSG1O PIC  X(0078).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CERMSG2O PIC  X(0078).
  5046*    -------------------------------
  5047     05  FILLER            PIC  X(0003).
  5048     05  CERMSG3O PIC  X(0078).
  5049*    -------------------------------
  5050     05  FILLER            PIC  X(0003).
  5051     05  CPFENTRO PIC  X(0002).
  5052*    -------------------------------
  5053     05  FILLER            PIC  X(0003).
  5054     05  CPF5HDRO PIC  X(0005).
  5055*    -------------------------------
  5056     05  FILLER            PIC  X(0003).
  5057     05  CPF4HDRO PIC  X(0013).
  5058*    -------------------------------
  5059     05  FILLER            PIC  X(0003).
  5060     05  CF15HDRO PIC  X(0022).
  5061*    -------------------------------
  5062 01  EL631DI REDEFINES EL631BI.
  5063     05  FILLER            PIC  X(0012).
  5064*    -------------------------------
  5065     05  DDATEL PIC S9(0004) COMP.
  5066     05  DDATEF PIC  X(0001).
  5067     05  FILLER REDEFINES DDATEF.
  5068         10  DDATEA PIC  X(0001).
  5069     05  DDATEI PIC  X(0008).
  5070*    -------------------------------
  5071     05  DTIMEL PIC S9(0004) COMP.
  5072     05  DTIMEF PIC  X(0001).
  5073     05  FILLER REDEFINES DTIMEF.
  5074         10  DTIMEA PIC  X(0001).
  5075     05  DTIMEI PIC  X(0005).
  5076*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  95
* EL6311.cbl
  5077     05  DHEADL PIC S9(0004) COMP.
  5078     05  DHEADF PIC  X(0001).
  5079     05  FILLER REDEFINES DHEADF.
  5080         10  DHEADA PIC  X(0001).
  5081     05  DHEADI PIC  X(0038).
  5082*    -------------------------------
  5083     05  DLDATEL PIC S9(0004) COMP.
  5084     05  DLDATEF PIC  X(0001).
  5085     05  FILLER REDEFINES DLDATEF.
  5086         10  DLDATEA PIC  X(0001).
  5087     05  DLDATEI PIC  X(0010).
  5088*    -------------------------------
  5089     05  DBATCHL PIC S9(0004) COMP.
  5090     05  DBATCHF PIC  X(0001).
  5091     05  FILLER REDEFINES DBATCHF.
  5092         10  DBATCHA PIC  X(0001).
  5093     05  DBATCHI PIC  X(0011).
  5094*    -------------------------------
  5095     05  DACCTNML PIC S9(0004) COMP.
  5096     05  DACCTNMF PIC  X(0001).
  5097     05  FILLER REDEFINES DACCTNMF.
  5098         10  DACCTNMA PIC  X(0001).
  5099     05  DACCTNMI PIC  X(0030).
  5100*    -------------------------------
  5101     05  DPROCDTL PIC S9(0004) COMP.
  5102     05  DPROCDTF PIC  X(0001).
  5103     05  FILLER REDEFINES DPROCDTF.
  5104         10  DPROCDTA PIC  X(0001).
  5105     05  DPROCDTI PIC  X(0008).
  5106*    -------------------------------
  5107     05  DINPUTL PIC S9(0004) COMP.
  5108     05  DINPUTF PIC  X(0001).
  5109     05  FILLER REDEFINES DINPUTF.
  5110         10  DINPUTA PIC  X(0001).
  5111     05  DINPUTI PIC  X(0008).
  5112*    -------------------------------
  5113     05  DMAINDTL PIC S9(0004) COMP.
  5114     05  DMAINDTF PIC  X(0001).
  5115     05  FILLER REDEFINES DMAINDTF.
  5116         10  DMAINDTA PIC  X(0001).
  5117     05  DMAINDTI PIC  X(0008).
  5118*    -------------------------------
  5119     05  DCARRL PIC S9(0004) COMP.
  5120     05  DCARRF PIC  X(0001).
  5121     05  FILLER REDEFINES DCARRF.
  5122         10  DCARRA PIC  X(0001).
  5123     05  DCARRI PIC  X(0001).
  5124*    -------------------------------
  5125     05  DGROUPL PIC S9(0004) COMP.
  5126     05  DGROUPF PIC  X(0001).
  5127     05  FILLER REDEFINES DGROUPF.
  5128         10  DGROUPA PIC  X(0001).
  5129     05  DGROUPI PIC  X(0006).
  5130*    -------------------------------
  5131     05  DSTATEL PIC S9(0004) COMP.
  5132     05  DSTATEF PIC  X(0001).
  5133     05  FILLER REDEFINES DSTATEF.
  5134         10  DSTATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  96
* EL6311.cbl
  5135     05  DSTATEI PIC  X(0002).
  5136*    -------------------------------
  5137     05  DACCTL PIC S9(0004) COMP.
  5138     05  DACCTF PIC  X(0001).
  5139     05  FILLER REDEFINES DACCTF.
  5140         10  DACCTA PIC  X(0001).
  5141     05  DACCTI PIC  X(0010).
  5142*    -------------------------------
  5143     05  DRECVDTL PIC S9(0004) COMP.
  5144     05  DRECVDTF PIC  X(0001).
  5145     05  FILLER REDEFINES DRECVDTF.
  5146         10  DRECVDTA PIC  X(0001).
  5147     05  DRECVDTI PIC  X(0008).
  5148*    -------------------------------
  5149     05  DCSRL PIC S9(0004) COMP.
  5150     05  DCSRF PIC  X(0001).
  5151     05  FILLER REDEFINES DCSRF.
  5152         10  DCSRA PIC  X(0001).
  5153     05  DCSRI PIC  X(0004).
  5154*    -------------------------------
  5155     05  DREFHDGL PIC S9(0004) COMP.
  5156     05  DREFHDGF PIC  X(0001).
  5157     05  FILLER REDEFINES DREFHDGF.
  5158         10  DREFHDGA PIC  X(0001).
  5159     05  DREFHDGI PIC  X(0010).
  5160*    -------------------------------
  5161     05  DREFL PIC S9(0004) COMP.
  5162     05  DREFF PIC  X(0001).
  5163     05  FILLER REDEFINES DREFF.
  5164         10  DREFA PIC  X(0001).
  5165     05  DREFI PIC  X(0012).
  5166*    -------------------------------
  5167     05  DLFPHDGL PIC S9(0004) COMP.
  5168     05  DLFPHDGF PIC  X(0001).
  5169     05  FILLER REDEFINES DLFPHDGF.
  5170         10  DLFPHDGA PIC  X(0001).
  5171     05  DLFPHDGI PIC  X(0010).
  5172*    -------------------------------
  5173     05  DAHPHDGL PIC S9(0004) COMP.
  5174     05  DAHPHDGF PIC  X(0001).
  5175     05  FILLER REDEFINES DAHPHDGF.
  5176         10  DAHPHDGA PIC  X(0001).
  5177     05  DAHPHDGI PIC  X(0010).
  5178*    -------------------------------
  5179     05  DLFRHDGL PIC S9(0004) COMP.
  5180     05  DLFRHDGF PIC  X(0001).
  5181     05  FILLER REDEFINES DLFRHDGF.
  5182         10  DLFRHDGA PIC  X(0001).
  5183     05  DLFRHDGI PIC  X(0009).
  5184*    -------------------------------
  5185     05  DAHRHDGL PIC S9(0004) COMP.
  5186     05  DAHRHDGF PIC  X(0001).
  5187     05  FILLER REDEFINES DAHRHDGF.
  5188         10  DAHRHDGA PIC  X(0001).
  5189     05  DAHRHDGI PIC  X(0009).
  5190*    -------------------------------
  5191     05  DRISSL PIC S9(0004) COMP.
  5192     05  DRISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  97
* EL6311.cbl
  5193     05  FILLER REDEFINES DRISSF.
  5194         10  DRISSA PIC  X(0001).
  5195     05  DRISSI PIC  X(0005).
  5196*    -------------------------------
  5197     05  DRLFPRML PIC S9(0004) COMP.
  5198     05  DRLFPRMF PIC  X(0001).
  5199     05  FILLER REDEFINES DRLFPRMF.
  5200         10  DRLFPRMA PIC  X(0001).
  5201     05  DRLFPRMI PIC  S9(9)V99.
  5202*    -------------------------------
  5203     05  DRAHPRML PIC S9(0004) COMP.
  5204     05  DRAHPRMF PIC  X(0001).
  5205     05  FILLER REDEFINES DRAHPRMF.
  5206         10  DRAHPRMA PIC  X(0001).
  5207     05  DRAHPRMI PIC  S9(9)V99.
  5208*    -------------------------------
  5209     05  DRCANCL PIC S9(0004) COMP.
  5210     05  DRCANCF PIC  X(0001).
  5211     05  FILLER REDEFINES DRCANCF.
  5212         10  DRCANCA PIC  X(0001).
  5213     05  DRCANCI PIC  X(0005).
  5214*    -------------------------------
  5215     05  DRLFRFDL PIC S9(0004) COMP.
  5216     05  DRLFRFDF PIC  X(0001).
  5217     05  FILLER REDEFINES DRLFRFDF.
  5218         10  DRLFRFDA PIC  X(0001).
  5219     05  DRLFRFDI PIC  S9(9)V99.
  5220*    -------------------------------
  5221     05  DRAHRFDL PIC S9(0004) COMP.
  5222     05  DRAHRFDF PIC  X(0001).
  5223     05  FILLER REDEFINES DRAHRFDF.
  5224         10  DRAHRFDA PIC  X(0001).
  5225     05  DRAHRFDI PIC  S9(9)V99.
  5226*    -------------------------------
  5227     05  DEISSL PIC S9(0004) COMP.
  5228     05  DEISSF PIC  X(0001).
  5229     05  FILLER REDEFINES DEISSF.
  5230         10  DEISSA PIC  X(0001).
  5231     05  DEISSI PIC  X(0005).
  5232*    -------------------------------
  5233     05  DELFPRML PIC S9(0004) COMP.
  5234     05  DELFPRMF PIC  X(0001).
  5235     05  FILLER REDEFINES DELFPRMF.
  5236         10  DELFPRMA PIC  X(0001).
  5237     05  DELFPRMI PIC  X(0011).
  5238*    -------------------------------
  5239     05  DEAHPRML PIC S9(0004) COMP.
  5240     05  DEAHPRMF PIC  X(0001).
  5241     05  FILLER REDEFINES DEAHPRMF.
  5242         10  DEAHPRMA PIC  X(0001).
  5243     05  DEAHPRMI PIC  X(0011).
  5244*    -------------------------------
  5245     05  DECANCL PIC S9(0004) COMP.
  5246     05  DECANCF PIC  X(0001).
  5247     05  FILLER REDEFINES DECANCF.
  5248         10  DECANCA PIC  X(0001).
  5249     05  DECANCI PIC  X(0005).
  5250*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  98
* EL6311.cbl
  5251     05  DELFRFDL PIC S9(0004) COMP.
  5252     05  DELFRFDF PIC  X(0001).
  5253     05  FILLER REDEFINES DELFRFDF.
  5254         10  DELFRFDA PIC  X(0001).
  5255     05  DELFRFDI PIC  X(0011).
  5256*    -------------------------------
  5257     05  DEAHRFDL PIC S9(0004) COMP.
  5258     05  DEAHRFDF PIC  X(0001).
  5259     05  FILLER REDEFINES DEAHRFDF.
  5260         10  DEAHRFDA PIC  X(0001).
  5261     05  DEAHRFDI PIC  X(0011).
  5262*    -------------------------------
  5263     05  DCISSL PIC S9(0004) COMP.
  5264     05  DCISSF PIC  X(0001).
  5265     05  FILLER REDEFINES DCISSF.
  5266         10  DCISSA PIC  X(0001).
  5267     05  DCISSI PIC  X(0005).
  5268*    -------------------------------
  5269     05  DCLFPRML PIC S9(0004) COMP.
  5270     05  DCLFPRMF PIC  X(0001).
  5271     05  FILLER REDEFINES DCLFPRMF.
  5272         10  DCLFPRMA PIC  X(0001).
  5273     05  DCLFPRMI PIC  X(0011).
  5274*    -------------------------------
  5275     05  DCAHPRML PIC S9(0004) COMP.
  5276     05  DCAHPRMF PIC  X(0001).
  5277     05  FILLER REDEFINES DCAHPRMF.
  5278         10  DCAHPRMA PIC  X(0001).
  5279     05  DCAHPRMI PIC  X(0011).
  5280*    -------------------------------
  5281     05  DCCANCL PIC S9(0004) COMP.
  5282     05  DCCANCF PIC  X(0001).
  5283     05  FILLER REDEFINES DCCANCF.
  5284         10  DCCANCA PIC  X(0001).
  5285     05  DCCANCI PIC  X(0005).
  5286*    -------------------------------
  5287     05  DCLFRFDL PIC S9(0004) COMP.
  5288     05  DCLFRFDF PIC  X(0001).
  5289     05  FILLER REDEFINES DCLFRFDF.
  5290         10  DCLFRFDA PIC  X(0001).
  5291     05  DCLFRFDI PIC  X(0011).
  5292*    -------------------------------
  5293     05  DCAHRFDL PIC S9(0004) COMP.
  5294     05  DCAHRFDF PIC  X(0001).
  5295     05  FILLER REDEFINES DCAHRFDF.
  5296         10  DCAHRFDA PIC  X(0001).
  5297     05  DCAHRFDI PIC  X(0011).
  5298*    -------------------------------
  5299     05  DOISSL PIC S9(0004) COMP.
  5300     05  DOISSF PIC  X(0001).
  5301     05  FILLER REDEFINES DOISSF.
  5302         10  DOISSA PIC  X(0001).
  5303     05  DOISSI PIC  X(0005).
  5304*    -------------------------------
  5305     05  DOLFPRML PIC S9(0004) COMP.
  5306     05  DOLFPRMF PIC  X(0001).
  5307     05  FILLER REDEFINES DOLFPRMF.
  5308         10  DOLFPRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page  99
* EL6311.cbl
  5309     05  DOLFPRMI PIC  X(0011).
  5310*    -------------------------------
  5311     05  DOAHPRML PIC S9(0004) COMP.
  5312     05  DOAHPRMF PIC  X(0001).
  5313     05  FILLER REDEFINES DOAHPRMF.
  5314         10  DOAHPRMA PIC  X(0001).
  5315     05  DOAHPRMI PIC  X(0011).
  5316*    -------------------------------
  5317     05  DOCANCL PIC S9(0004) COMP.
  5318     05  DOCANCF PIC  X(0001).
  5319     05  FILLER REDEFINES DOCANCF.
  5320         10  DOCANCA PIC  X(0001).
  5321     05  DOCANCI PIC  X(0005).
  5322*    -------------------------------
  5323     05  DOLFRFDL PIC S9(0004) COMP.
  5324     05  DOLFRFDF PIC  X(0001).
  5325     05  FILLER REDEFINES DOLFRFDF.
  5326         10  DOLFRFDA PIC  X(0001).
  5327     05  DOLFRFDI PIC  X(0011).
  5328*    -------------------------------
  5329     05  DOAHRFDL PIC S9(0004) COMP.
  5330     05  DOAHRFDF PIC  X(0001).
  5331     05  FILLER REDEFINES DOAHRFDF.
  5332         10  DOAHRFDA PIC  X(0001).
  5333     05  DOAHRFDI PIC  X(0011).
  5334*    -------------------------------
  5335     05  DITOTALL PIC S9(0004) COMP.
  5336     05  DITOTALF PIC  X(0001).
  5337     05  FILLER REDEFINES DITOTALF.
  5338         10  DITOTALA PIC  X(0001).
  5339     05  DITOTALI PIC  X(0005).
  5340*    -------------------------------
  5341     05  DIFATALL PIC S9(0004) COMP.
  5342     05  DIFATALF PIC  X(0001).
  5343     05  FILLER REDEFINES DIFATALF.
  5344         10  DIFATALA PIC  X(0001).
  5345     05  DIFATALI PIC  X(0005).
  5346*    -------------------------------
  5347     05  DIFORCEL PIC S9(0004) COMP.
  5348     05  DIFORCEF PIC  X(0001).
  5349     05  FILLER REDEFINES DIFORCEF.
  5350         10  DIFORCEA PIC  X(0001).
  5351     05  DIFORCEI PIC  X(0005).
  5352*    -------------------------------
  5353     05  DIHOLDL PIC S9(0004) COMP.
  5354     05  DIHOLDF PIC  X(0001).
  5355     05  FILLER REDEFINES DIHOLDF.
  5356         10  DIHOLDA PIC  X(0001).
  5357     05  DIHOLDI PIC  X(0005).
  5358*    -------------------------------
  5359     05  DIAVAILL PIC S9(0004) COMP.
  5360     05  DIAVAILF PIC  X(0001).
  5361     05  FILLER REDEFINES DIAVAILF.
  5362         10  DIAVAILA PIC  X(0001).
  5363     05  DIAVAILI PIC  X(0005).
  5364*    -------------------------------
  5365     05  DIGPREML PIC S9(0004) COMP.
  5366     05  DIGPREMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 100
* EL6311.cbl
  5367     05  FILLER REDEFINES DIGPREMF.
  5368         10  DIGPREMA PIC  X(0001).
  5369     05  DIGPREMI PIC  X(0011).
  5370*    -------------------------------
  5371     05  DIBPREML PIC S9(0004) COMP.
  5372     05  DIBPREMF PIC  X(0001).
  5373     05  FILLER REDEFINES DIBPREMF.
  5374         10  DIBPREMA PIC  X(0001).
  5375     05  DIBPREMI PIC  X(0011).
  5376*    -------------------------------
  5377     05  DCTOTALL PIC S9(0004) COMP.
  5378     05  DCTOTALF PIC  X(0001).
  5379     05  FILLER REDEFINES DCTOTALF.
  5380         10  DCTOTALA PIC  X(0001).
  5381     05  DCTOTALI PIC  X(0005).
  5382*    -------------------------------
  5383     05  DCFATALL PIC S9(0004) COMP.
  5384     05  DCFATALF PIC  X(0001).
  5385     05  FILLER REDEFINES DCFATALF.
  5386         10  DCFATALA PIC  X(0001).
  5387     05  DCFATALI PIC  X(0005).
  5388*    -------------------------------
  5389     05  DCFORCEL PIC S9(0004) COMP.
  5390     05  DCFORCEF PIC  X(0001).
  5391     05  FILLER REDEFINES DCFORCEF.
  5392         10  DCFORCEA PIC  X(0001).
  5393     05  DCFORCEI PIC  X(0005).
  5394*    -------------------------------
  5395     05  DCHOLDL PIC S9(0004) COMP.
  5396     05  DCHOLDF PIC  X(0001).
  5397     05  FILLER REDEFINES DCHOLDF.
  5398         10  DCHOLDA PIC  X(0001).
  5399     05  DCHOLDI PIC  X(0005).
  5400*    -------------------------------
  5401     05  DCAVAILL PIC S9(0004) COMP.
  5402     05  DCAVAILF PIC  X(0001).
  5403     05  FILLER REDEFINES DCAVAILF.
  5404         10  DCAVAILA PIC  X(0001).
  5405     05  DCAVAILI PIC  X(0005).
  5406*    -------------------------------
  5407     05  DCGPREML PIC S9(0004) COMP.
  5408     05  DCGPREMF PIC  X(0001).
  5409     05  FILLER REDEFINES DCGPREMF.
  5410         10  DCGPREMA PIC  X(0001).
  5411     05  DCGPREMI PIC  X(0011).
  5412*    -------------------------------
  5413     05  DCBPREML PIC S9(0004) COMP.
  5414     05  DCBPREMF PIC  X(0001).
  5415     05  FILLER REDEFINES DCBPREMF.
  5416         10  DCBPREMA PIC  X(0001).
  5417     05  DCBPREMI PIC  X(0011).
  5418*    -------------------------------
  5419     05  DNTOTALL PIC S9(0004) COMP.
  5420     05  DNTOTALF PIC  X(0001).
  5421     05  FILLER REDEFINES DNTOTALF.
  5422         10  DNTOTALA PIC  X(0001).
  5423     05  DNTOTALI PIC  X(0005).
  5424*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 101
* EL6311.cbl
  5425     05  DNFATALL PIC S9(0004) COMP.
  5426     05  DNFATALF PIC  X(0001).
  5427     05  FILLER REDEFINES DNFATALF.
  5428         10  DNFATALA PIC  X(0001).
  5429     05  DNFATALI PIC  X(0005).
  5430*    -------------------------------
  5431     05  DNFORCEL PIC S9(0004) COMP.
  5432     05  DNFORCEF PIC  X(0001).
  5433     05  FILLER REDEFINES DNFORCEF.
  5434         10  DNFORCEA PIC  X(0001).
  5435     05  DNFORCEI PIC  X(0005).
  5436*    -------------------------------
  5437     05  DNHOLDL PIC S9(0004) COMP.
  5438     05  DNHOLDF PIC  X(0001).
  5439     05  FILLER REDEFINES DNHOLDF.
  5440         10  DNHOLDA PIC  X(0001).
  5441     05  DNHOLDI PIC  X(0005).
  5442*    -------------------------------
  5443     05  DNAVAILL PIC S9(0004) COMP.
  5444     05  DNAVAILF PIC  X(0001).
  5445     05  FILLER REDEFINES DNAVAILF.
  5446         10  DNAVAILA PIC  X(0001).
  5447     05  DNAVAILI PIC  X(0005).
  5448*    -------------------------------
  5449     05  DNGPREML PIC S9(0004) COMP.
  5450     05  DNGPREMF PIC  X(0001).
  5451     05  FILLER REDEFINES DNGPREMF.
  5452         10  DNGPREMA PIC  X(0001).
  5453     05  DNGPREMI PIC  X(0011).
  5454*    -------------------------------
  5455     05  DNBPREML PIC S9(0004) COMP.
  5456     05  DNBPREMF PIC  X(0001).
  5457     05  FILLER REDEFINES DNBPREMF.
  5458         10  DNBPREMA PIC  X(0001).
  5459     05  DNBPREMI PIC  X(0011).
  5460*    -------------------------------
  5461     05  DERMSGL PIC S9(0004) COMP.
  5462     05  DERMSGF PIC  X(0001).
  5463     05  FILLER REDEFINES DERMSGF.
  5464         10  DERMSGA PIC  X(0001).
  5465     05  DERMSGI PIC  X(0075).
  5466*    -------------------------------
  5467     05  DPFENTRL PIC S9(0004) COMP.
  5468     05  DPFENTRF PIC  X(0001).
  5469     05  FILLER REDEFINES DPFENTRF.
  5470         10  DPFENTRA PIC  X(0001).
  5471     05  DPFENTRI PIC  9(2).
  5472 01  EL631DO REDEFINES EL631BI.
  5473     05  FILLER            PIC  X(0012).
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DDATEO PIC  X(0008).
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DTIMEO PIC  99.99.
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DHEADO PIC  X(0038).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 102
* EL6311.cbl
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DLDATEO PIC  X(0010).
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DBATCHO PIC  X(0011).
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DACCTNMO PIC  X(0030).
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DPROCDTO PIC  X(0008).
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DINPUTO PIC  X(0008).
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DMAINDTO PIC  X(0008).
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DCARRO PIC  X(0001).
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DGROUPO PIC  X(0006).
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DSTATEO PIC  X(0002).
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DACCTO PIC  X(0010).
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DRECVDTO PIC  X(0008).
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DCSRO PIC  X(0004).
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DREFHDGO PIC  X(0010).
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DREFO PIC  X(0012).
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
  5527     05  DLFPHDGO PIC  X(0010).
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DAHPHDGO PIC  X(0010).
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DLFRHDGO PIC  X(0009).
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DAHRHDGO PIC  X(0009).
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DRISSO PIC  ZZ99-.
  5540*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 103
* EL6311.cbl
  5541     05  FILLER            PIC  X(0003).
  5542     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DRCANCO PIC  ZZ99-.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DEISSO PIC  ZZ99-.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DECANCO PIC  ZZ99-.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
  5569     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
  5572     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DCISSO PIC  ZZ99-.
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5579*    -------------------------------
  5580     05  FILLER            PIC  X(0003).
  5581     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5582*    -------------------------------
  5583     05  FILLER            PIC  X(0003).
  5584     05  DCCANCO PIC  ZZ99-.
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
  5590     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DOISSO PIC  ZZ99-.
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
  5596     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 104
* EL6311.cbl
  5599     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DOCANCO PIC  ZZ99-.
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DITOTALO PIC  ZZZ99.
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DIFATALO PIC  ZZZ99.
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DIFORCEO PIC  ZZZ99.
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DIHOLDO PIC  ZZZ99.
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DIAVAILO PIC  ZZZ99.
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DCTOTALO PIC  ZZZ99.
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DCFATALO PIC  ZZZ99.
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DCFORCEO PIC  ZZZ99.
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DCHOLDO PIC  ZZZ99.
  5642*    -------------------------------
  5643     05  FILLER            PIC  X(0003).
  5644     05  DCAVAILO PIC  ZZZ99.
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5651*    -------------------------------
  5652     05  FILLER            PIC  X(0003).
  5653     05  DNTOTALO PIC  ---99.
  5654*    -------------------------------
  5655     05  FILLER            PIC  X(0003).
  5656     05  DNFATALO PIC  ---99.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 105
* EL6311.cbl
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DNFORCEO PIC  ---99.
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DNHOLDO PIC  ---99.
  5663*    -------------------------------
  5664     05  FILLER            PIC  X(0003).
  5665     05  DNAVAILO PIC  ---99.
  5666*    -------------------------------
  5667     05  FILLER            PIC  X(0003).
  5668     05  DNGPREMO PIC  -------9.99.
  5669*    -------------------------------
  5670     05  FILLER            PIC  X(0003).
  5671     05  DNBPREMO PIC  -------9.99.
  5672*    -------------------------------
  5673     05  FILLER            PIC  X(0003).
  5674     05  DERMSGO PIC  X(0075).
  5675*    -------------------------------
  5676     05  FILLER            PIC  X(0003).
  5677     05  DPFENTRO PIC  X(0002).
  5678*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 106
* EL6311.cbl
  5680 01  MAP-B REDEFINES EL631BI.
  5681     12  FILLER                  PIC X(591).
  5682*    12  FILLER                  PIC X(512).
  5683*    12  FILLER                  PIC X(510).
  5684     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5685         16  BKIND-LEN               PIC S9(4)  COMP.
  5686         16  BKIND-ATTRB             PIC X.
  5687         16  BKIND                   PIC XX.
  5688         16  BTYPE-LEN               PIC S9(4)  COMP.
  5689         16  BTYPE-ATTRB             PIC X.
  5690         16  BTYPE                   PIC X(3).
  5691         16  BTERM-LEN               PIC S9(4)  COMP.
  5692         16  BTERM-ATTRB             PIC X.
  5693         16  BTERMI                  PIC 999.
  5694         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5695         16  BBEN-LEN                PIC S9(4)  COMP.
  5696         16  BBEN-ATTRB              PIC X.
  5697         16  BBENI                   PIC 9(10)V99.
  5698*        16  BBENI                   PIC 9(12).
  5699         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5700         16  BPREM-LEN               PIC S9(4)  COMP.
  5701         16  BPREM-ATTRB             PIC X.
  5702         16  BPREMI                  PIC S9(9)V99.
  5703*        16  BPREMI                  PIC 9(11).
  5704         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5705         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5706         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5707         16  BEXPIRE-ATTRB           PIC X.
  5708         16  BEXPIRE                 PIC X(8).
  5709         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5710         16  BCRIT-PERD-ATTRB        PIC X.
  5711         16  BCRIT-PERDI             PIC 99.
  5712         16  BCRIT-PERDO REDEFINES
  5713                         BCRIT-PERDI PIC ZZ.
  5714         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5715         16  BALT-BEN-ATTRB          PIC X.
  5716         16  BALT-BENI               PIC 9(10)V99.
  5717*        16  BALT-BENI               PIC 9(12).
  5718         16  BALT-BENO REDEFINES
  5719                           BALT-BENI PIC Z(9).ZZ.
  5720         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5721         16  BALT-PREM-ATTRB         PIC X.
  5722         16  BALT-PREMI              PIC 9(9)V99.
  5723*        16  BALT-PREMI              PIC 9(11).
  5724         16  BALT-PREMO REDEFINES
  5725                          BALT-PREMI PIC Z(7).ZZ-.
  5726         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5727         16  BBEN-CD-ATTRB           PIC X.
  5728         16  BBEN-CD                 PIC XXX.
  5729         16  BCPREM-LEN              PIC S9(4)  COMP.
  5730         16  BCPREM-ATTRB            PIC X.
  5731         16  BCPREMI                 PIC S9(9)V99.
  5732*        16  BCPREMI                 PIC X(11).
  5733         16  BCPREMO REDEFINES BCPREMI
  5734                                     PIC Z(7).99-.
  5735         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5736         16  BCALT-PREM-ATTRB        PIC X.
  5737         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 107
* EL6311.cbl
  5738         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5739         16  BBEN-ABBR-ATTRB         PIC X.
  5740         16  BBEN-ABBR               PIC X(5).
  5741         16  BDIFF-LEN               PIC S9(4)  COMP.
  5742         16  BDIFF-ATTRB             PIC X.
  5743         16  BDIFFO                  PIC Z(7).99-.
  5744         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5745         16  BBILL-LIT-ATTRB         PIC X.
  5746         16  BBILL-LIT               PIC X(8).
  5747         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5748         16  BDALT-PREM-ATTRB        PIC X.
  5749         16  BDALT-PREM              PIC Z(7).99-.
  5750
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 108
* EL6311.cbl
  5752
  5753****************************************************************
  5754*
  5755* Copyright (c) 2007 by Clerity Solutions, Inc.
  5756* All rights reserved.
  5757*
  5758****************************************************************
  5759 01  DFHEIV.
  5760   02  DFHEIV0               PIC X(35).
  5761   02  DFHEIV1               PIC X(08).
  5762   02  DFHEIV2               PIC X(08).
  5763   02  DFHEIV3               PIC X(08).
  5764   02  DFHEIV4               PIC X(06).
  5765   02  DFHEIV5               PIC X(04).
  5766   02  DFHEIV6               PIC X(04).
  5767   02  DFHEIV7               PIC X(02).
  5768   02  DFHEIV8               PIC X(02).
  5769   02  DFHEIV9               PIC X(01).
  5770   02  DFHEIV10              PIC S9(7) COMP-3.
  5771   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5772   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5773   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5774   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5775   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5776   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5777   02  DFHEIV17              PIC X(04).
  5778   02  DFHEIV18              PIC X(04).
  5779   02  DFHEIV19              PIC X(04).
  5780   02  DFHEIV20              USAGE IS POINTER.
  5781   02  DFHEIV21              USAGE IS POINTER.
  5782   02  DFHEIV22              USAGE IS POINTER.
  5783   02  DFHEIV23              USAGE IS POINTER.
  5784   02  DFHEIV24              USAGE IS POINTER.
  5785   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5786   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5787   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5788   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5789   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5790   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5791   02  FILLER                PIC X(02).
  5792   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5793   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5794   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5795   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5796   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5797 LINKAGE  SECTION.
  5798*****************************************************************
  5799*                                                               *
  5800* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5801* All rights reserved.                                          *
  5802*                                                               *
  5803*****************************************************************
  5804 01  dfheiblk.
  5805     02  eibtime          pic s9(7) comp-3.
  5806     02  eibdate          pic s9(7) comp-3.
  5807     02  eibtrnid         pic x(4).
  5808     02  eibtaskn         pic s9(7) comp-3.
  5809     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 109
* EL6311.cbl
  5810     02  dfheigdi         pic s9(4) comp.
  5811     02  eibcposn         pic s9(4) comp.
  5812     02  eibcalen         pic s9(4) comp.
  5813     02  eibaid           pic x(1).
  5814     02  eibfiller1       pic x(1).
  5815     02  eibfn            pic x(2).
  5816     02  eibfiller2       pic x(2).
  5817     02  eibrcode         pic x(6).
  5818     02  eibfiller3       pic x(2).
  5819     02  eibds            pic x(8).
  5820     02  eibreqid         pic x(8).
  5821     02  eibrsrce         pic x(8).
  5822     02  eibsync          pic x(1).
  5823     02  eibfree          pic x(1).
  5824     02  eibrecv          pic x(1).
  5825     02  eibsend          pic x(1).
  5826     02  eibatt           pic x(1).
  5827     02  eibeoc           pic x(1).
  5828     02  eibfmh           pic x(1).
  5829     02  eibcompl         pic x(1).
  5830     02  eibsig           pic x(1).
  5831     02  eibconf          pic x(1).
  5832     02  eiberr           pic x(1).
  5833     02  eibrldbk         pic x(1).
  5834     02  eiberrcd         pic x(4).
  5835     02  eibsynrb         pic x(1).
  5836     02  eibnodat         pic x(1).
  5837     02  eibfiller5       pic x(2).
  5838     02  eibresp          pic 9(09) comp.
  5839     02  eibresp2         pic 9(09) comp.
  5840     02  dfheigdj         pic s9(4) comp.
  5841     02  dfheigdk         pic s9(4) comp.
  5842 01  DFHCOMMAREA                 PIC X(1300).
  5843*                                COPY ERCPNDB.
  5844******************************************************************
  5845*                                                                *
  5846*                                                                *
  5847*                            ERCPNDB.                            *
  5848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5849*                            VMOD=2.025                          *
  5850*                                                                *
  5851*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5852*                                                                *
  5853******************************************************************
  5854*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5855*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5856******************************************************************
  5857*                                                                *
  5858*                                                                *
  5859*   FILE TYPE = VSAM,KSDS                                        *
  5860*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5861*                                                                *
  5862*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5863*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5864*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5865*                                                 RKP=13,LEN=36  *
  5866*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5867*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 110
* EL6311.cbl
  5868*                                                RKP=49,LEN=11   *
  5869*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5870*                                      AND CHG-SEQ.)             *
  5871*                                                RKP=60,LEN=15   *
  5872*                                                                *
  5873*   LOG = NO                                                     *
  5874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5875******************************************************************
  5876******************************************************************
  5877*                   C H A N G E   L O G
  5878*
  5879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5880*-----------------------------------------------------------------
  5881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5882* EFFECTIVE    NUMBER
  5883*-----------------------------------------------------------------
  5884* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5885* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5886* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5887* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5888* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5889* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5890* 032306                   PEMA  ADD BOW LOAN NUMBER
  5891* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5892* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5893* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5894* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5895* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5896* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5897* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5898* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5899* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5900* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5901* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  5902******************************************************************
  5903
  5904 01  PENDING-BUSINESS.
  5905     12  PB-RECORD-ID                     PIC XX.
  5906         88  VALID-PB-ID                        VALUE 'PB'.
  5907
  5908     12  PB-CONTROL-PRIMARY.
  5909         16  PB-COMPANY-CD                PIC X.
  5910         16  PB-ENTRY-BATCH               PIC X(6).
  5911         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5912         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5913
  5914     12  PB-CONTROL-BY-ACCOUNT.
  5915         16  PB-COMPANY-CD-A1             PIC X.
  5916         16  PB-CARRIER                   PIC X.
  5917         16  PB-GROUPING.
  5918             20  PB-GROUPING-PREFIX       PIC XXX.
  5919             20  PB-GROUPING-PRIME        PIC XXX.
  5920         16  PB-STATE                     PIC XX.
  5921         16  PB-ACCOUNT.
  5922             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5923             20  PB-ACCOUNT-PRIME         PIC X(6).
  5924         16  PB-CERT-EFF-DT               PIC XX.
  5925         16  PB-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 111
* EL6311.cbl
  5926             20  PB-CERT-PRIME            PIC X(10).
  5927             20  PB-CERT-SFX              PIC X.
  5928         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5929
  5930         16  PB-RECORD-TYPE               PIC X.
  5931             88  PB-MAILING-DATA                VALUE '0'.
  5932             88  PB-ISSUE                       VALUE '1'.
  5933             88  PB-CANCELLATION                VALUE '2'.
  5934             88  PB-BATCH-TRAILER               VALUE '9'.
  5935
  5936     12  PB-CONTROL-BY-ORIG-BATCH.
  5937         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5938         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5939         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5940         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5941
  5942     12  PB-CONTROL-BY-CSR.
  5943         16  PB-CSR-COMPANY-CD            PIC X.
  5944         16  PB-CSR-ID                    PIC X(4).
  5945         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5946         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5947         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5948******************************************************************
  5949*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5950******************************************************************
  5951
  5952     12  PB-LAST-MAINT-DT                 PIC XX.
  5953     12  PB-LAST-MAINT-BY                 PIC X(4).
  5954     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5955
  5956     12  PB-RECORD-BODY                   PIC X(375).
  5957
  5958     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5959         16  PB-CERT-ORIGIN               PIC X.
  5960             88  CLASIC-CREATED-CERT         VALUE '1'.
  5961         16  PB-I-NAME.
  5962             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5963             20  PB-I-INSURED-FIRST-NAME.
  5964                 24  PB-I-INSURED-1ST-INIT PIC X.
  5965                 24  FILLER                PIC X(9).
  5966             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5967         16  PB-I-AGE                     PIC S99   COMP-3.
  5968         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5969         16  PB-I-BIRTHDAY                PIC XX.
  5970         16  PB-I-INSURED-SEX             PIC X.
  5971             88  PB-SEX-MALE     VALUE 'M'.
  5972             88  PB-SEX-FEMALE   VALUE 'F'.
  5973
  5974         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5975         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5976         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5977         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5978         16  PB-I-SKIP-CODE               PIC X.
  5979             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5980             88  PB-SKIP-JULY              VALUE '1'.
  5981             88  PB-SKIP-AUGUST            VALUE '2'.
  5982             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5983             88  PB-SKIP-JULY-AUG          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 112
* EL6311.cbl
  5984             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5985             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5986             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5987             88  PB-SKIP-JUNE              VALUE '8'.
  5988             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5989             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5990             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5991         16  PB-I-TERM-TYPE               PIC X.
  5992             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5993             88  PB-PAID-WEEKLY            VALUE 'W'.
  5994             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5995             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5996             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5997         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5998         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5999         16  PB-I-DATA-ENTRY-SW           PIC X.
  6000             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6001             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6002             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6003             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6004         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6005         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6006*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6007         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6008         16  FILLER                       PIC X.
  6009
  6010         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6011             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6012             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6013                                                   '90' THRU '99'.
  6014         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6015                                          PIC XX.
  6016         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6017         16  PB-I-AMOUNT-FINANCED REDEFINES
  6018                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6019         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6020         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6021                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6022         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6023         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6024         16  PB-I-CLP-AMOUNT REDEFINES
  6025                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6026         16  PB-I-LF-CALC-FLAG            PIC X.
  6027             88 PB-COMP-LF-PREM               VALUE '?'.
  6028         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6029         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6030         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6031         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6032         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6033         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6034         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6035         16  PB-I-LF-ABBR                 PIC XXX.
  6036         16  PB-I-LF-INPUT-CD             PIC XX.
  6037
  6038         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6039             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6040             88  PB-INVALID-AH               VALUE '  ' '00'
  6041                                                   '90' THRU '99'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 113
* EL6311.cbl
  6042         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6043         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6044         16  PB-I-AH-CALC-FLAG            PIC X.
  6045             88 PB-COMP-AH-PREM                  VALUE '?'.
  6046         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6047         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6048         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6049         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6050         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6051         16  PB-I-AH-ABBR                 PIC XXX.
  6052         16  PB-I-AH-INPUT-CD             PIC XXX.
  6053
  6054         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6055         16  PB-I-REIN-TABLE              PIC XXX.
  6056         16  PB-I-BUSINESS-TYPE           PIC 99.
  6057         16  PB-I-INDV-GRP-CD             PIC X.
  6058         16  PB-I-MORT-CODE.
  6059             20  PB-I-TABLE               PIC X.
  6060             20  PB-I-INTEREST            PIC XX.
  6061             20  PB-I-MORT-TYP            PIC X.
  6062         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6063         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6064         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6065         16  PB-I-INDV-GRP-OVRD           PIC X.
  6066         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6067         16  PB-I-SIG-SW                  PIC X.
  6068             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6069         16  PB-I-RATE-CLASS              PIC XX.
  6070         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6071         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6072         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6073         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6074         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6075         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6076         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6077         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6078         16  PB-I-OB-FLAG                 PIC X.
  6079             88  PB-I-OB                      VALUE 'B'.
  6080             88  PB-I-SUMMARY                 VALUE 'Z'.
  6081         16  PB-I-ENTRY-STATUS            PIC X.
  6082             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6083                                              'M' '5' '9' '2'.
  6084             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6085             88  PB-I-POLICY-PENDING          VALUE '2'.
  6086             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6087             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6088             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6089             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6090             88  PB-I-REIN-ONLY               VALUE '9'.
  6091             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6092             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6093             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6094             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6095         16  PB-I-INT-CODE                PIC X.
  6096             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6097             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6098         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6099         16  PB-I-SOC-SEC-NO              PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 114
* EL6311.cbl
  6100         16  PB-I-MEMBER-NO               PIC X(12).
  6101         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6102*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6103         16  PB-I-OLD-LOF                 PIC XXX.
  6104         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6105         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6106         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6107         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6108         16  PB-I-LIFE-INDICATOR          PIC X.
  6109             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6110         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6111         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6112                                          PIC S9(5)V99    COMP-3.
  6113         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6114             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6115             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6116         16  PB-I-1ST-PMT-DT              PIC XX.
  6117         16  PB-I-JOINT-INSURED.
  6118             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6119             20 PB-I-JOINT-FIRST-NAME.
  6120                24  PB-I-JOINT-FIRST-INIT PIC X.
  6121                24  FILLER                PIC X(9).
  6122             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6123*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6124         16  PB-I-BENEFICIARY-NAME.
  6125             20  PB-I-BANK-NUMBER         PIC X(10).
  6126             20  FILLER                   PIC X(15).
  6127         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6128         16  PB-I-REFERENCE               PIC X(12).
  6129         16  FILLER REDEFINES PB-I-REFERENCE.
  6130             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6131             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6132             20  PB-I-CLP-STATE           PIC XX.
  6133         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6134             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6135             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6136             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6137         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6138         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6139         16  PB-I-RESIDENT-STATE          PIC XX.
  6140         16  PB-I-RATE-CODE               PIC X(4).
  6141         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6142         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6143         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6144         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6145         16  PB-I-BANK-NOCHRGB            PIC 99.
  6146         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6147         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6148
  6149     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6150         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6151             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6152         16  PB-C-CANCEL-ORIGIN           PIC X.
  6153             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6154         16  PB-C-LF-CANCEL-DT            PIC XX.
  6155         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6156         16  PB-C-LF-CALC-REQ             PIC X.
  6157             88 PB-COMP-LF-CANCEL            VALUE '?'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 115
* EL6311.cbl
  6158         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6159         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6160         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6161             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6162         16  PB-C-AH-CANCEL-DT            PIC XX.
  6163         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6164         16  PB-C-AH-CALC-REQ             PIC X.
  6165             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6166         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6167         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6168         16  PB-C-LAST-NAME               PIC X(15).
  6169         16  PB-C-REFUND-SW               PIC X.
  6170             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6171             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6172         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6173         16  PB-C-PAYEE-CODE              PIC X(6).
  6174         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6175         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6176         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6177         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6178         16  PB-C-REFERENCE               PIC X(12).
  6179         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6180         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6181         16  PB-C-POST-CARD-IND           PIC X.
  6182         16  PB-C-CANCEL-REASON           PIC X.
  6183         16  PB-C-REF-INTERFACE-SW        PIC X.
  6184         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6185         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6186         16  FILLER                       PIC X(01).
  6187*        16  FILLER                       PIC X(18).
  6188         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6189*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6190         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6191         16  PB-CANCELED-CERT-DATA.
  6192             20  PB-CI-INSURED-NAME.
  6193                 24  PB-CI-LAST-NAME      PIC X(15).
  6194                 24  PB-CI-INITIALS       PIC XX.
  6195             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6196             20  PB-CI-INSURED-SEX        PIC X.
  6197             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6198             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6199             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6200             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6201             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6202             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6203             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6204             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6205             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6206             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6207             20  PB-CI-RATE-CLASS         PIC XX.
  6208             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6209             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6210             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6211             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6212             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6213             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6214             20  PB-CI-LF-ABBR            PIC X(3).
  6215             20  PB-CI-AH-ABBR            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 116
* EL6311.cbl
  6216             20  PB-CI-OB-FLAG            PIC X.
  6217                 88  PB-CI-OB                VALUE 'B'.
  6218             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6219                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6220                                           'M' '4' '5' '9' '2'.
  6221                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6222                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6223                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6224                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6225                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6226                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6227                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6228                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6229                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6230                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6231                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6232                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6233                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6234             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6235                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6236                                           'M' '4' '5' '9' '2'.
  6237                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6238                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6239                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6240                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6241                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6242                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6243                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6244                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6245                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6246                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6247                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6248                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6249                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6250             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6251             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6252             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6253             20  PB-CI-MEMBER-NO          PIC X(12).
  6254             20  PB-CI-INT-CODE           PIC X.
  6255                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6256                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6257             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6258             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6259             20  PB-CI-COMP-EXCP-SW       PIC X.
  6260                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6261                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6262             20  PB-CI-ENTRY-STATUS       PIC X.
  6263             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6264             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6265             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6266             20  PB-CI-DEATH-DT           PIC XX.
  6267             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6268             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6269             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6270             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6271             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6272             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6273             20  PB-CI-ENTRY-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 117
* EL6311.cbl
  6274             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6275             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6276             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6277             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6278             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6279             20  PB-CI-OLD-LOF               PIC XXX.
  6280*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6281             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6282             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6283             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6284             20  PB-CI-INDV-GRP-CD           PIC X.
  6285             20  PB-CI-BENEFICIARY-NAME.
  6286                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6287                 24  FILLER                  PIC X(15).
  6288             20  PB-CI-NOTE-SW               PIC X.
  6289             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6290             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6291             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6292             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6293             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6294             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6295             20  PB-CI-FIRST-NAME            PIC X(10).
  6296             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6297
  6298         16  FILLER                       PIC X(13).
  6299*032306  16  FILLER                       PIC X(27).
  6300*        16  FILLER                       PIC X(46).
  6301
  6302     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6303         16  FILLER                       PIC X(10).
  6304         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6305         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6306         16  PB-M-INSURED-MID-INIT        PIC X.
  6307         16  PB-M-INSURED-AGE             PIC 99.
  6308         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6309         16  PB-M-INSURED-SEX             PIC X.
  6310         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6311         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6312         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6313         16  PB-M-INSURED-CITY-STATE.
  6314             20  PB-M-INSURED-CITY        PIC X(28).
  6315             20  PB-M-INSURED-STATE       PIC XX.
  6316         16  PB-M-INSURED-ZIP-CODE.
  6317             20  PB-M-INSURED-ZIP-PRIME.
  6318                 24  PB-M-INSURED-ZIP-1   PIC X.
  6319                     88  PB-M-CANADIAN-POST-CODE
  6320                                             VALUE 'A' THRU 'Z'.
  6321                 24  FILLER               PIC X(4).
  6322             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6323         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6324                                        PB-M-INSURED-ZIP-CODE.
  6325             20  PM-M-INS-CAN-POST1       PIC XXX.
  6326             20  PM-M-INS-CAN-POST2       PIC XXX.
  6327             20  FILLER                   PIC XXX.
  6328         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6329         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6330         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6331         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 118
* EL6311.cbl
  6332         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6333         16  PB-M-CRED-BENE-CITYST.
  6334             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6335             20  PB-M-CRED-BENE-STATE     PIC XX.
  6336         16  FILLER                       PIC X(92).
  6337
  6338     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6339         16  FILLER                       PIC X(10).
  6340         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6341         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6342         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6343         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6344         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6345         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6346         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6347         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6348         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6349         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6350         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6351         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6352         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6353         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6354         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6355         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6356         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6357         16  PB-ACCOUNT-NAME              PIC X(30).
  6358         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6359         16  PB-REFERENCE                 PIC X(12).
  6360         16  PB-B-RECEIVED-DT             PIC XX.
  6361         16  FILLER                       PIC X(234).
  6362
  6363     12  PB-RECORD-STATUS.
  6364         16  PB-CREDIT-SELECT-DT          PIC XX.
  6365         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6366         16  PB-BILLED-DT                 PIC XX.
  6367         16  PB-BILLING-STATUS            PIC X.
  6368             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6369             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6370             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6371         16  PB-RECORD-BILL               PIC X.
  6372             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6373             88  PB-RECORD-RETURNED           VALUE 'R'.
  6374             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6375             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6376             88  PB-OVERRIDE-AH               VALUE 'A'.
  6377             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6378         16  PB-BATCH-ENTRY               PIC X.
  6379             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6380             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6381             88  PB-REISSUED-CERT             VALUE 'E'.
  6382             88  PB-CASH-CERT                 VALUE 'C'.
  6383             88  PB-MONTHLY-CERT              VALUE 'M'.
  6384             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6385             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6386             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6387         16  PB-FORCE-CODE                PIC X.
  6388             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6389             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 119
* EL6311.cbl
  6390             88  PB-CANCEL-FORCE              VALUE '8'.
  6391             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6392             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6393             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6394             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6395             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6396             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6397             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6398             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6399         16  PB-FATAL-FLAG                PIC X.
  6400             88  PB-FATAL-ERRORS              VALUE 'X'.
  6401         16  PB-FORCE-ER-CD               PIC X.
  6402             88  PB-FORCE-ERRORS              VALUE 'F'.
  6403             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6404         16  PB-WARN-ER-CD                PIC X.
  6405             88  PB-WARNING-ERRORS            VALUE 'W'.
  6406         16  FILLER                       PIC X.
  6407         16  PB-OUT-BAL-CD                PIC X.
  6408             88  PB-OUT-OF-BAL                VALUE 'O'.
  6409         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6410         16  PB-AH-OVERRIDE-L1            PIC X.
  6411         16  PB-INPUT-DT                  PIC XX.
  6412         16  PB-INPUT-BY                  PIC X(4).
  6413         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6414         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6415         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6416         16  PB-LF-EARNING-METHOD         PIC X.
  6417         16  PB-AH-EARNING-METHOD         PIC X.
  6418         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6419         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6420         16  PB-REIN-CD                   PIC XXX.
  6421         16  PB-LF-REFUND-TYPE            PIC X.
  6422         16  PB-AH-REFUND-TYPE            PIC X.
  6423         16  PB-ACCT-EFF-DT               PIC XX.
  6424         16  PB-ACCT-EXP-DT               PIC XX.
  6425         16  PB-COMPANY-ID                PIC X(3).
  6426         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6427         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6428         16  PB-SV-CARRIER                PIC X.
  6429         16  PB-SV-GROUPING               PIC X(6).
  6430         16  PB-SV-STATE                  PIC XX.
  6431         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6432         16  PB-GA-BILLING-INFO.
  6433             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6434                                          PIC XX.
  6435         16  PB-SV-REMIT-TO  REDEFINES
  6436             PB-GA-BILLING-INFO           PIC X(10).
  6437         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6438         16  PB-I-LOAN-OFFICER            PIC X(5).
  6439         16  PB-I-VIN                     PIC X(17).
  6440
  6441         16  FILLER                       PIC X(04).
  6442         16  IMNET-BYPASS-SW              PIC X.
  6443
  6444******************************************************************
  6445*                COMMON EDIT ERRORS                              *
  6446******************************************************************
  6447
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 120
* EL6311.cbl
  6448     12  PB-COMMON-ERRORS.
  6449         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6450                                           PIC S9(4)     COMP.
  6451
  6452******************************************************************
  6453*                                COPY ELCCERT.
  6454******************************************************************
  6455*                                                                *
  6456*                            ELCCERT.                            *
  6457*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6458*                            VMOD=2.013                          *
  6459*                                                                *
  6460*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6461*                                                                *
  6462*   FILE TYPE = VSAM,KSDS                                        *
  6463*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6464*                                                                *
  6465*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6466*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6467*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6468*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6469*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6470*                                                                *
  6471*   LOG = YES                                                    *
  6472*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6473******************************************************************
  6474*                   C H A N G E   L O G
  6475*
  6476* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6477*-----------------------------------------------------------------
  6478*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6479* EFFECTIVE    NUMBER
  6480*-----------------------------------------------------------------
  6481* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6482* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6483* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6484* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6485* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6486* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6487* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6488* 032612  CR2011110200001  PEMA  AHL CHANGES
  6489* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6490* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6491******************************************************************
  6492
  6493 01  CERTIFICATE-MASTER.
  6494     12  CM-RECORD-ID                      PIC XX.
  6495         88  VALID-CM-ID                      VALUE 'CM'.
  6496
  6497     12  CM-CONTROL-PRIMARY.
  6498         16  CM-COMPANY-CD                 PIC X.
  6499         16  CM-CARRIER                    PIC X.
  6500         16  CM-GROUPING.
  6501             20  CM-GROUPING-PREFIX        PIC X(3).
  6502             20  CM-GROUPING-PRIME         PIC X(3).
  6503         16  CM-STATE                      PIC XX.
  6504         16  CM-ACCOUNT.
  6505             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 121
* EL6311.cbl
  6506             20  CM-ACCOUNT-PRIME          PIC X(6).
  6507         16  CM-CERT-EFF-DT                PIC XX.
  6508         16  CM-CERT-NO.
  6509             20  CM-CERT-PRIME             PIC X(10).
  6510             20  CM-CERT-SFX               PIC X.
  6511
  6512     12  CM-CONTROL-BY-NAME.
  6513         16  CM-COMPANY-CD-A1              PIC X.
  6514         16  CM-INSURED-LAST-NAME          PIC X(15).
  6515         16  CM-INSURED-INITIALS.
  6516             20  CM-INSURED-INITIAL1       PIC X.
  6517             20  CM-INSURED-INITIAL2       PIC X.
  6518
  6519     12  CM-CONTROL-BY-SSN.
  6520         16  CM-COMPANY-CD-A2              PIC X.
  6521         16  CM-SOC-SEC-NO.
  6522             20  CM-SSN-STATE              PIC XX.
  6523             20  CM-SSN-ACCOUNT            PIC X(6).
  6524             20  CM-SSN-LN3.
  6525                 25  CM-INSURED-INITIALS-A2.
  6526                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6527                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6528                 25 CM-PART-LAST-NAME-A2         PIC X.
  6529
  6530     12  CM-CONTROL-BY-CERT-NO.
  6531         16  CM-COMPANY-CD-A4              PIC X.
  6532         16  CM-CERT-NO-A4                 PIC X(11).
  6533
  6534     12  CM-CONTROL-BY-MEMB.
  6535         16  CM-COMPANY-CD-A5              PIC X.
  6536         16  CM-MEMBER-NO.
  6537             20  CM-MEMB-STATE             PIC XX.
  6538             20  CM-MEMB-ACCOUNT           PIC X(6).
  6539             20  CM-MEMB-LN4.
  6540                 25  CM-INSURED-INITIALS-A5.
  6541                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6542                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6543                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6544
  6545     12  CM-INSURED-PROFILE-DATA.
  6546         16  CM-INSURED-FIRST-NAME.
  6547             20  CM-INSURED-1ST-INIT       PIC X.
  6548             20  FILLER                    PIC X(9).
  6549         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6550         16  CM-INSURED-SEX                PIC X.
  6551             88  CM-SEX-MALE                  VALUE 'M'.
  6552             88  CM-SEX-FEMAL                 VALUE 'F'.
  6553         16  CM-INSURED-JOINT-AGE          PIC 99.
  6554         16  CM-JOINT-INSURED-NAME.
  6555             20  CM-JT-LAST-NAME           PIC X(15).
  6556             20  CM-JT-FIRST-NAME.
  6557                 24  CM-JT-1ST-INIT        PIC X.
  6558                 24  FILLER                PIC X(9).
  6559             20  CM-JT-INITIAL             PIC X.
  6560
  6561     12  CM-LIFE-DATA.
  6562         16  CM-LF-BENEFIT-CD              PIC XX.
  6563         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 122
* EL6311.cbl
  6564         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6565         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6566         16  CM-LF-DEV-CODE                PIC XXX.
  6567         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6568         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6569         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6570         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6571         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6572         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6573         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6574         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6575         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6576         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6577         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6578         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6579         16  cm-temp-epiq                  pic xx.
  6580             88  EPIQ-CLASS                  value 'EQ'.
  6581*        16  FILLER                        PIC XX.
  6582
  6583     12  CM-AH-DATA.
  6584         16  CM-AH-BENEFIT-CD              PIC XX.
  6585         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6586         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6587         16  CM-AH-DEV-CODE                PIC XXX.
  6588         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6589         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6590         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6591         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6592         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6593         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6594         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6595         16  CM-AH-PAID-THRU-DT            PIC XX.
  6596             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6597         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6598         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6599         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6600         16  FILLER                        PIC X.
  6601
  6602     12  CM-LOAN-INFORMATION.
  6603         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6604         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6605                                           PIC S9(5)V99  COMP-3.
  6606         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6607         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6608         16  CM-PAY-FREQUENCY              PIC S99.
  6609         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6610         16  CM-RATE-CLASS                 PIC XX.
  6611         16  CM-BENEFICIARY                PIC X(25).
  6612         16  CM-POLICY-FORM-NO             PIC X(12).
  6613         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6614         16  CM-LAST-ADD-ON-DT             PIC XX.
  6615         16  CM-DEDUCTIBLE-AMOUNTS.
  6616             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6617             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6618         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6619             20  CM-RESIDENT-STATE         PIC XX.
  6620             20  CM-RATE-CODE              PIC X(4).
  6621             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 123
* EL6311.cbl
  6622         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6623             20  CM-LOAN-OFFICER           PIC X(5).
  6624             20  FILLER                    PIC XXX.
  6625         16  CM-CSR-CODE                   PIC XXX.
  6626         16  CM-UNDERWRITING-CODE          PIC X.
  6627             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6628         16  CM-POST-CARD-IND              PIC X.
  6629         16  CM-NH-INTERFACE-SW            PIC X.
  6630         16  CM-PREMIUM-TYPE               PIC X.
  6631             88  CM-SING-PRM                  VALUE '1'.
  6632             88  CM-O-B-COVERAGE              VALUE '2'.
  6633             88  CM-OPEN-END                  VALUE '3'.
  6634         16  CM-IND-GRP-TYPE               PIC X.
  6635             88  CM-INDIVIDUAL                VALUE 'I'.
  6636             88  CM-GROUP                     VALUE 'G'.
  6637         16  CM-SKIP-CODE                  PIC X.
  6638             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6639             88  SKIP-JULY                    VALUE '1'.
  6640             88  SKIP-AUGUST                  VALUE '2'.
  6641             88  SKIP-SEPTEMBER               VALUE '3'.
  6642             88  SKIP-JULY-AUG                VALUE '4'.
  6643             88  SKIP-AUG-SEPT                VALUE '5'.
  6644             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6645             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6646             88  SKIP-JUNE                    VALUE '8'.
  6647             88  SKIP-JUNE-JULY               VALUE '9'.
  6648             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6649             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6650         16  CM-PAYMENT-MODE               PIC X.
  6651             88  PAY-MONTHLY                  VALUE SPACE.
  6652             88  PAY-WEEKLY                   VALUE '1'.
  6653             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6654             88  PAY-BI-WEEKLY                VALUE '3'.
  6655             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6656         16  CM-LOAN-NUMBER                PIC X(8).
  6657         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6658         16  CM-OLD-LOF                    PIC XXX.
  6659*        16  CM-LOAN-OFFICER               PIC XXX.
  6660         16  CM-REIN-TABLE                 PIC XXX.
  6661         16  CM-SPECIAL-REIN-CODE          PIC X.
  6662         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6663         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6664         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6665
  6666     12  CM-STATUS-DATA.
  6667         16  CM-ENTRY-STATUS               PIC X.
  6668         16  CM-ENTRY-DT                   PIC XX.
  6669
  6670         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6671         16  CM-LF-CANCEL-DT               PIC XX.
  6672         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6673
  6674         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6675         16  CM-LF-DEATH-DT                PIC XX.
  6676         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6677
  6678         16  CM-LF-CURRENT-STATUS          PIC X.
  6679             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 124
* EL6311.cbl
  6680                                                'M' '4' '5' '9'.
  6681             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6682             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6683             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6684             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6685             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6686             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6687             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6688             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6689             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6690             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6691             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6692             88  CM-LF-DECLINED               VALUE 'D'.
  6693             88  CM-LF-VOIDED                 VALUE 'V'.
  6694
  6695         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6696         16  CM-AH-CANCEL-DT               PIC XX.
  6697         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6698
  6699         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6700         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6701         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6702
  6703         16  CM-AH-CURRENT-STATUS          PIC X.
  6704             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6705                                                'M' '4' '5' '9'.
  6706             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6707             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6708             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6709             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6710             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6711             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6712             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6713             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6714             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6715             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6716             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6717             88  CM-AH-DECLINED               VALUE 'D'.
  6718             88  CM-AH-VOIDED                 VALUE 'V'.
  6719
  6720         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6721             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6722             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6723             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6724         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6725
  6726         16  CM-ENTRY-BATCH                PIC X(6).
  6727         16  CM-LF-EXIT-BATCH              PIC X(6).
  6728         16  CM-AH-EXIT-BATCH              PIC X(6).
  6729         16  CM-LAST-MONTH-END             PIC XX.
  6730
  6731     12  CM-NOTE-SW                        PIC X.
  6732         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6733         88  CERT-NOTES-PRESENT               VALUE '1'.
  6734         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6735         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6736         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6737         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 125
* EL6311.cbl
  6738         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6739         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6740     12  CM-COMP-EXCP-SW                   PIC X.
  6741         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6742         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6743     12  CM-INSURED-ADDRESS-SW             PIC X.
  6744         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6745         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6746
  6747*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6748     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6749     12  FILLER                            PIC X.
  6750
  6751*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6752     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6753     12  FILLER                            PIC X.
  6754*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6755     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6756
  6757     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6758         88  CERT-ADDED-BATCH                 VALUE ' '.
  6759         88  CERT-ADDED-ONLINE                VALUE '1'.
  6760         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6761         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6762         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6763     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6764         88  CERT-AS-LOADED                   VALUE ' '.
  6765         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6766         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6767         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6768         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6769         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6770         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6771         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6772
  6773     12  CM-ACCOUNT-COMM-PCTS.
  6774         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6775         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6776
  6777     12  CM-USER-FIELD                     PIC X.
  6778     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6779     12  CM-CLP-STATE                      PIC XX.
  6780     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6781     12  CM-USER-RESERVED                  PIC XXX.
  6782     12  FILLER REDEFINES CM-USER-RESERVED.
  6783         16  CM-AH-CLASS-CD                PIC XX.
  6784         16  F                             PIC X.
  6785******************************************************************
  6786*                                COPY ERCNOTE.
  6787******************************************************************
  6788*                                                                *
  6789*                                                                *
  6790*                            ERCNOTE                             *
  6791*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6792*                            VMOD=2.003                          *
  6793*                                                                *
  6794*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6795*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 126
* EL6311.cbl
  6796*        FILE TYPE= VSAM,KSDS                                    *
  6797*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6798*                                                                *
  6799*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6800*                                                                *
  6801*        LOG = YES                                               *
  6802*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6803*                                                                *
  6804******************************************************************
  6805*                   C H A N G E   L O G
  6806*
  6807* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6808*-----------------------------------------------------------------
  6809*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6810* EFFECTIVE    NUMBER
  6811*-----------------------------------------------------------------
  6812* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6813*                                FILE WILL CONTAIN BILLING NOTES O
  6814******************************************************************
  6815
  6816 01  CERTIFICATE-NOTE.
  6817     12  CN-RECORD-ID                PIC  XX.
  6818         88  VALID-CN-ID                  VALUE 'CN'.
  6819
  6820     12  CN-CONTROL-PRIMARY.
  6821         16  CN-COMPANY-CD           PIC X.
  6822         16  CN-CARRIER              PIC X.
  6823         16  CN-GROUPING.
  6824             20 CN-GROUPING-PREFIX   PIC XXX.
  6825             20 CN-GROUPING-PRIME    PIC XXX.
  6826         16  CN-STATE                PIC XX.
  6827         16  CN-ACCOUNT.
  6828             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6829             20 CN-ACCOUNT-PRIME     PIC X(6).
  6830         16  CN-CERT-EFF-DT          PIC XX.
  6831         16  CN-CERT-NO.
  6832             20  CN-CERT-PRIME       PIC X(10).
  6833             20  CN-CERT-SFX         PIC X.
  6834
  6835     12  CN-BILLING-START-LINE-NO    PIC 99.
  6836     12  CN-BILLING-END-LINE-NO      PIC 99.
  6837
  6838     12  CN-LINES.
  6839         16  CN-LINE OCCURS 10       PIC X(77).
  6840
  6841     12  CN-LAST-MAINT-DT            PIC XX.
  6842     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6843     12  CN-LAST-MAINT-USER          PIC X(4).
  6844     12  FILLER                      PIC X(6).
  6845******************************************************************
  6846*                                COPY ERCPNDM.
  6847******************************************************************
  6848*                                                                *
  6849*                                                                *
  6850*                            ERCPNDM                             *
  6851*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6852*                            VMOD=2.003                          *
  6853*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 127
* EL6311.cbl
  6854*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6855*                                                                *
  6856*   FILE TYPE = VSAM,KSDS                                        *
  6857*   RECORD SIZE = 374   RECFORM = FIX                            *
  6858*                                                                *
  6859*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6860*   ALTERNATE PATH    = NOT USED                                 *
  6861*                                                                *
  6862*   LOG = YES                                                    *
  6863*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6864******************************************************************
  6865*                   C H A N G E   L O G
  6866*
  6867* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6868*-----------------------------------------------------------------
  6869*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6870* EFFECTIVE    NUMBER
  6871*-----------------------------------------------------------------
  6872* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6873* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6874* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6875******************************************************************
  6876
  6877 01  PENDING-MAILING-DATA.
  6878     12  PM-RECORD-ID                      PIC XX.
  6879         88  VALID-MA-ID                       VALUE 'PM'.
  6880
  6881     12  PM-CONTROL-PRIMARY.
  6882         16  PM-COMPANY-CD                 PIC X.
  6883         16  PM-ENTRY-BATCH                PIC X(6).
  6884         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6885         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6886
  6887     12  FILLER                            PIC X(14).
  6888
  6889     12  PM-ACCESS-CONTROL.
  6890         16  PM-SOURCE-SYSTEM              PIC XX.
  6891             88  PM-FROM-CREDIT                VALUE 'CR'.
  6892             88  PM-FROM-VSI                   VALUE 'VS'.
  6893             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6894             88  PM-FROM-OTHER                 VALUE 'OT'.
  6895         16  PM-RECORD-ADD-DT              PIC XX.
  6896         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6897         16  PM-LAST-MAINT-DT              PIC XX.
  6898         16  PM-LAST-MAINT-BY              PIC XXXX.
  6899         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6900
  6901     12  PM-PROFILE-INFO.
  6902         16  PM-QUALIFY-CODE-1             PIC XX.
  6903         16  PM-QUALIFY-CODE-2             PIC XX.
  6904         16  PM-QUALIFY-CODE-3             PIC XX.
  6905         16  PM-QUALIFY-CODE-4             PIC XX.
  6906         16  PM-QUALIFY-CODE-5             PIC XX.
  6907
  6908         16  PM-INSURED-LAST-NAME          PIC X(15).
  6909         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6910         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6911         16  PM-INSURED-ISSUE-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 128
* EL6311.cbl
  6912         16  PM-INSURED-BIRTH-DT           PIC XX.
  6913         16  PM-INSURED-SEX                PIC X.
  6914             88  PM-SEX-MALE                   VALUE 'M'.
  6915             88  PM-SEX-FEMALE                 VALUE 'F'.
  6916         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6917
  6918         16  PM-ADDRESS-CORRECTED          PIC X.
  6919         16  PM-JOINT-BIRTH-DT             PIC XX.
  6920*        16  FILLER                        PIC X(12).
  6921
  6922         16  PM-ADDRESS-LINE-1             PIC X(30).
  6923         16  PM-ADDRESS-LINE-2             PIC X(30).
  6924         16  PM-CITY-STATE.
  6925             20  PM-CITY                   PIC X(28).
  6926             20  PM-STATE                  PIC XX.
  6927         16  PM-ZIP.
  6928             20  PM-ZIP-CODE.
  6929                 24  PM-ZIP-1              PIC X.
  6930                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6931                 24  FILLER                PIC X(4).
  6932             20  PM-ZIP-PLUS4              PIC X(4).
  6933         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6934             20  PM-CAN-POST1              PIC XXX.
  6935             20  PM-CAN-POST2              PIC XXX.
  6936             20  FILLER                    PIC XXX.
  6937
  6938         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6939
  6940         16  FILLER                        PIC X(03).
  6941
  6942     12  PM-CRED-BENE-INFO.
  6943         16  PM-CRED-BENE-NAME             PIC X(25).
  6944         16  PM-CRED-BENE-ADDR             PIC X(30).
  6945         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6946         16  PM-CRED-BENE-CTYST.
  6947             20  PM-CRED-BENE-CITY         PIC X(28).
  6948             20  PM-CRED-BENE-STATE        PIC XX.
  6949         16  PM-CRED-BENE-ZIP.
  6950             20  PM-CB-ZIP-CODE.
  6951                 24  PM-CB-ZIP-1           PIC X.
  6952                     88  PM-CB-CANADIAN-POST-CODE
  6953                                  VALUE 'A' THRU 'Z'.
  6954                 24  FILLER                PIC X(4).
  6955             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6956         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6957             20  PM-CB-CAN-POST1           PIC XXX.
  6958             20  PM-CB-CAN-POST2           PIC XXX.
  6959             20  FILLER                    PIC XXX.
  6960     12  PM-POST-CARD-MAIL-DATA.
  6961         16  PM-MAIL-DATA OCCURS 7.
  6962             20  PM-MAIL-TYPE              PIC X.
  6963                 88  PM-12MO-MAILING           VALUE '1'.
  6964                 88  PM-EXP-MAILING            VALUE '2'.
  6965             20  PM-MAIL-STATUS            PIC X.
  6966                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6967                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6968                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6969             20  PM-MAIL-DATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 129
* EL6311.cbl
  6970     12  FILLER                            PIC XX.
  6971     12  FILLER                            PIC X(12).
  6972*    12  FILLER                            PIC X(30).
  6973
  6974******************************************************************
  6975*                                COPY ERCMAIL.
  6976******************************************************************
  6977*                                                                *
  6978*                                                                *
  6979*                            ERCMAIL                             *
  6980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6981*                            VMOD=2.003                          *
  6982*                                                                *
  6983*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6984*                                                                *
  6985*   FILE TYPE = VSAM,KSDS                                        *
  6986*   RECORD SIZE = 374   RECFORM = FIX                            *
  6987*                                                                *
  6988*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6989*   ALTERNATE PATH    = NOT USED                                 *
  6990*                                                                *
  6991*   LOG = YES                                                    *
  6992*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6993******************************************************************
  6994*                   C H A N G E   L O G
  6995*
  6996* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6997*-----------------------------------------------------------------
  6998*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6999* EFFECTIVE    NUMBER
  7000*-----------------------------------------------------------------
  7001* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7002* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7003* 111108                   PEMA  ADD CRED BENE ADDR2
  7004******************************************************************
  7005
  7006 01  MAILING-DATA.
  7007     12  MA-RECORD-ID                      PIC XX.
  7008         88  VALID-MA-ID                       VALUE 'MA'.
  7009
  7010     12  MA-CONTROL-PRIMARY.
  7011         16  MA-COMPANY-CD                 PIC X.
  7012         16  MA-CARRIER                    PIC X.
  7013         16  MA-GROUPING.
  7014             20  MA-GROUPING-PREFIX        PIC XXX.
  7015             20  MA-GROUPING-PRIME         PIC XXX.
  7016         16  MA-STATE                      PIC XX.
  7017         16  MA-ACCOUNT.
  7018             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7019             20  MA-ACCOUNT-PRIME          PIC X(6).
  7020         16  MA-CERT-EFF-DT                PIC XX.
  7021         16  MA-CERT-NO.
  7022             20  MA-CERT-PRIME             PIC X(10).
  7023             20  MA-CERT-SFX               PIC X.
  7024
  7025     12  FILLER                            PIC XX.
  7026
  7027     12  MA-ACCESS-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 130
* EL6311.cbl
  7028         16  MA-SOURCE-SYSTEM              PIC XX.
  7029             88  MA-FROM-CREDIT                VALUE 'CR'.
  7030             88  MA-FROM-VSI                   VALUE 'VS'.
  7031             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7032             88  MA-FROM-OTHER                 VALUE 'OT'.
  7033         16  MA-RECORD-ADD-DT              PIC XX.
  7034         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7035         16  MA-LAST-MAINT-DT              PIC XX.
  7036         16  MA-LAST-MAINT-BY              PIC XXXX.
  7037         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7038
  7039     12  MA-PROFILE-INFO.
  7040         16  MA-QUALIFY-CODE-1             PIC XX.
  7041         16  MA-QUALIFY-CODE-2             PIC XX.
  7042         16  MA-QUALIFY-CODE-3             PIC XX.
  7043         16  MA-QUALIFY-CODE-4             PIC XX.
  7044         16  MA-QUALIFY-CODE-5             PIC XX.
  7045
  7046         16  MA-INSURED-LAST-NAME          PIC X(15).
  7047         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7048         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7049         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7050         16  MA-INSURED-BIRTH-DT           PIC XX.
  7051         16  MA-INSURED-SEX                PIC X.
  7052             88  MA-SEX-MALE                   VALUE 'M'.
  7053             88  MA-SEX-FEMALE                 VALUE 'F'.
  7054         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7055
  7056         16  MA-ADDRESS-CORRECTED          PIC X.
  7057         16  MA-JOINT-BIRTH-DT             PIC XX.
  7058*        16  FILLER                        PIC X(12).
  7059
  7060         16  MA-ADDRESS-LINE-1             PIC X(30).
  7061         16  MA-ADDRESS-LINE-2             PIC X(30).
  7062         16  MA-CITY-STATE.
  7063             20  MA-CITY                   PIC X(28).
  7064             20  MA-ADDR-STATE             PIC XX.
  7065         16  MA-ZIP.
  7066             20  MA-ZIP-CODE.
  7067                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7068                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7069                 24  FILLER                PIC X(4).
  7070             20  MA-ZIP-PLUS4              PIC X(4).
  7071         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7072             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7073             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7074             20  FILLER                    PIC X(3).
  7075
  7076         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7077
  7078         16  FILLER                        PIC XXX.
  7079*        16  FILLER                        PIC X(10).
  7080
  7081     12  MA-CRED-BENE-INFO.
  7082         16  MA-CRED-BENE-NAME                 PIC X(25).
  7083         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7084         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7085         16  MA-CRED-BENE-CTYST.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 131
* EL6311.cbl
  7086             20  MA-CRED-BENE-CITY             PIC X(28).
  7087             20  MA-CRED-BENE-STATE            PIC XX.
  7088         16  MA-CRED-BENE-ZIP.
  7089             20  MA-CB-ZIP-CODE.
  7090                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7091                     88  MA-CB-CANADIAN-POST-CODE
  7092                                           VALUE 'A' THRU 'Z'.
  7093                 24  FILLER                    PIC X(4).
  7094             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7095         16  MA-CB-CANADIAN-POSTAL-CODE
  7096                            REDEFINES MA-CRED-BENE-ZIP.
  7097             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7098             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7099             20  FILLER                        PIC X(3).
  7100     12  MA-POST-CARD-MAIL-DATA.
  7101         16  MA-MAIL-DATA OCCURS 7.
  7102             20  MA-MAIL-TYPE              PIC X.
  7103                 88  MA-12MO-MAILING           VALUE '1'.
  7104                 88  MA-EXP-MAILING            VALUE '2'.
  7105             20  MA-MAIL-STATUS            PIC X.
  7106                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7107                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7108                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7109             20  MA-MAIL-DATE              PIC XX.
  7110     12  FILLER                            PIC XX.
  7111     12  FILLER                            PIC XX.
  7112*    12  FILLER                            PIC X(30).
  7113******************************************************************
  7114*                                COPY ERCRQST.
  7115******************************************************************
  7116*                                                                *
  7117*                                                                *
  7118*                            ERCRQST.                            *
  7119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7120*                            VMOD=2.002                          *
  7121*                                                                *
  7122*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7123*                                                                *
  7124*   FILE TYPE = VSAM,KSDS                                        *
  7125*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7126*                                                                *
  7127*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7128*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7129*                                   ACCOUNT, REF, BATCH)         *
  7130*                                                RKP=9, LEN=38   *
  7131*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7132*                                   ACCOUNT, REF, BATCH)         *
  7133*                                                RKP=47, LEN=46  *
  7134*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7135*                                   BATCH)                       *
  7136*                                                RKP=93, LEN=24  *
  7137*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7138*                                   REF, BATCH)                  *
  7139*                                                RKP=117, LEN=35 *
  7140*   LOG = NO                                                     *
  7141*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7142******************************************************************
  7143
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 132
* EL6311.cbl
  7144 01  AR-REQUEST-RECORD.
  7145     12  RQ-RECORD-ID                     PIC XX.
  7146         88  VALID-RQ-ID                        VALUE 'RQ'.
  7147
  7148     12  RQ-CONTROL-PRIMARY.
  7149         16  RQ-COMPANY-CD                PIC X.
  7150         16  RQ-ENTRY-BATCH               PIC X(6).
  7151
  7152     12  RQ-CONTROL-BY-ACCT-REF.
  7153         16  RQ-COMPANY-CD-A1             PIC X.
  7154         16  RQ-CARRIER-A1                PIC X.
  7155         16  RQ-GROUPING-A1               PIC X(6).
  7156         16  RQ-STATE-A1                  PIC XX.
  7157         16  RQ-ACCOUNT-A1                PIC X(10).
  7158         16  RQ-REFERENCE-A1              PIC X(12).
  7159         16  RQ-BATCH-A1                  PIC X(6).
  7160
  7161     12  RQ-CONTROL-BY-FIN-RESP.
  7162         16  RQ-COMPANY-CD-A2             PIC X.
  7163         16  RQ-CARRIER-A2                PIC X.
  7164         16  RQ-GROUPING-A2               PIC X(6).
  7165         16  RQ-FIN-RESP-A2               PIC X(10).
  7166         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7167         16  RQ-REFERENCE-A2              PIC X(12).
  7168         16  RQ-BATCH-A2                  PIC X(6).
  7169
  7170     12  RQ-CONTROL-BY-ACCT-AGENT.
  7171         16  RQ-COMPANY-CD-A3             PIC X.
  7172         16  RQ-CARRIER-A3                PIC X.
  7173         16  RQ-GROUPING-A3               PIC X(6).
  7174         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7175         16  RQ-BATCH-A3                  PIC X(6).
  7176
  7177     12  RQ-CONTROL-BY-SUMMARY.
  7178         16  RQ-COMPANY-CD-A4             PIC X.
  7179         16  RQ-SUMMARY-CODE              PIC X(6).
  7180         16  RQ-ACCOUNT-A4                PIC X(10).
  7181         16  RQ-REFERENCE-A4              PIC X(12).
  7182         16  RQ-BATCH-A4                  PIC X(6).
  7183
  7184     12  RQ-REQUEST-METHOD                PIC X.
  7185         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7186         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7187         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7188         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7189     12  FILLER                           PIC X.
  7190     12  RQ-STATUS                        PIC X.
  7191         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7192         88  RQ-RESUBMIT                      VALUE 'R'.
  7193     12  RQ-PROCESSOR-ID                  PIC X(4).
  7194     12  RQ-ENTRY-DT                      PIC XX.
  7195     12  RQ-MO-END-DT                     PIC XX.
  7196     12  RQ-REQUEST-DT                    PIC XX.
  7197     12  RQ-STMT-DT                       PIC XX.
  7198     12  RQ-REVERSAL-DT                   PIC XX.
  7199     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7200     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7201
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 133
* EL6311.cbl
  7202     12  FILLER                           PIC X(27).
  7203
  7204******************************************************************
  7205
  7206*                                COPY ERCLOFC.
  7207******************************************************************
  7208*                                                                *
  7209*                                                                *
  7210*                            ERCLOFC                             *
  7211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7212*                            VMOD=2.003                          *
  7213*                                                                *
  7214*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7215*                                                                *
  7216*   FILE TYPE = VSAM,KSDS                                        *
  7217*   RECORD SIZE = 670   RECFORM = FIX                            *
  7218*                                                                *
  7219*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7220*                                                                *
  7221*   LOG = YES                                                    *
  7222*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7223*                                                                *
  7224******************************************************************
  7225
  7226 01  LOAN-OFFICER-MASTER.
  7227     12  LO-RECORD-ID                PIC XX.
  7228         88  VALID-LO-ID                VALUE 'LO'.
  7229
  7230     12  LO-CONTROL-PRIMARY.
  7231         16  LO-COMPANY-CD           PIC X.
  7232         16  LO-CARRIER              PIC X.
  7233         16  LO-GROUPING.
  7234             20  LO-GROUPING-PREFIX  PIC XXX.
  7235             20  LO-GROUPING-PRIME   PIC XXX.
  7236         16  LO-STATE                PIC XX.
  7237         16  LO-ACCOUNT.
  7238             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7239             20  LO-ACCOUNT-PRIME    PIC X(6).
  7240         16  LO-OFFICER-CODE         PIC X(5).
  7241
  7242     12  LO-OFFICER-NAME             PIC X(30).
  7243
  7244     12  LO-LAST-MAINT-DT            PIC XX.
  7245     12  LO-LAST-USER                PIC X(4).
  7246     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7247
  7248     12  LO-COMP-CONTROL             PIC X.
  7249             88  LO-SHOW-COMP           VALUE 'Y'.
  7250             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7251     12  LO-DETAIL-CONTROL           PIC X.
  7252             88  LO-PRINT-DETAIL        VALUE 'D'.
  7253             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7254
  7255     12  LO-SV-CARRIER               PIC X.
  7256     12  LO-SV-GROUPING              PIC X(6).
  7257     12  LO-SV-STATE                 PIC XX.
  7258
  7259     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 134
* EL6311.cbl
  7260     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7261
  7262     12  LO-OFFICER-INFO.
  7263         16  FILLER OCCURS 12 TIMES.
  7264             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7265             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7266             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7267             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7268             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7269             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7270             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7271             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7272     12  FILLER                      PIC X(198).
  7273******************************************************************
  7274*                                COPY ERCPYAJ.
  7275******************************************************************
  7276*                                                                *
  7277*                            ERCPYAJ                             *
  7278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7279*                            VMOD=2.015                          *
  7280*                                                                *
  7281*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7282*                                                                *
  7283*                                                                *
  7284*   FILE TYPE = VSAM,KSDS                                        *
  7285*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7286*                                                                *
  7287*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7288*       ALTERNATE PATHS = NONE                                   *
  7289*                                                                *
  7290*   LOG = YES                                                    *
  7291*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7292******************************************************************
  7293******************************************************************
  7294*                   C H A N G E   L O G
  7295*
  7296* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7297*-----------------------------------------------------------------
  7298*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7299* EFFECTIVE    NUMBER
  7300*-----------------------------------------------------------------
  7301* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7302* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7303******************************************************************
  7304
  7305 01  PENDING-PAY-ADJ.
  7306     12  PY-RECORD-ID                     PIC XX.
  7307         88  VALID-PY-ID                        VALUE 'PY'.
  7308
  7309     12  PY-CONTROL-PRIMARY.
  7310         16  PY-COMPANY-CD                PIC X.
  7311         16  PY-CARRIER                   PIC X.
  7312         16  PY-GROUPING                  PIC X(6).
  7313         16  PY-FIN-RESP                  PIC X(10).
  7314         16  PY-ACCOUNT                   PIC X(10).
  7315         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7316                                          PIC X(10).
  7317         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 135
* EL6311.cbl
  7318         16  PY-RECORD-TYPE               PIC X.
  7319             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7320             88  PY-DEPOSIT                   VALUE 'D'.
  7321             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7322             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7323             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7324             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7325             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7326             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7327             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7328             88  PY-FICA-ENTRY                VALUE 'F'.
  7329             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7330             88  PY-POLICY-FEE                VALUE 'W'.
  7331             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7332
  7333     12  PY-PYMT-TYPE                     PIC X.
  7334             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7335             88  PY-REINS-PYMT                VALUE 'R'.
  7336             88  PY-EXP-PYMT                  VALUE 'E'.
  7337
  7338     12  PY-BIL-INV                       PIC X(6).
  7339     12  PY-REF-NO                        PIC X(12).
  7340
  7341     12  PY-LAST-MAINT-DT                 PIC XX.
  7342     12  PY-LAST-MAINT-BY                 PIC X(4).
  7343     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7344
  7345     12  PY-PYADJ-RECORD.
  7346         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7347         16  PY-ENTRY-COMMENT             PIC X(30).
  7348         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7349             20  PY-GL-ACCOUNT            PIC X(10).
  7350             20  PY-GL-STATE              PIC X(02).
  7351             20  PY-GL-CANC-SW            PIC X(01).
  7352                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7353                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7354             20  PY-GL-COMMENT            PIC X(10).
  7355             20  FILLER      REDEFINES PY-GL-COMMENT.
  7356                 24  PY-GL-CHECK-NO       PIC 9(06).
  7357                 24  FILLER               PIC X(04).
  7358             20  FILLER                   PIC X(07).
  7359         16  PY-SAVE-ACCOUNT              PIC X(10).
  7360         16  PY-SAVE-TYPE                 PIC X(01).
  7361
  7362         16  PY-LETTERS.
  7363             20  PY-LETTER OCCURS 3 TIMES
  7364                           INDEXED BY PY-LET-NDX
  7365                                          PIC X(04).
  7366
  7367         16  PY-ERCOMP-TYPE               PIC X.
  7368             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7369             88  PY-GA-TYPE                   VALUE 'G'.
  7370             88  PY-BANK-TYPE                 VALUE 'B'.
  7371         16  FILLER                       PIC X(05).
  7372
  7373     12  PY-RECORD-STATUS.
  7374         16  PY-CREDIT-SELECT-DT          PIC XX.
  7375         16  PY-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 136
* EL6311.cbl
  7376         16  PY-BILLED-DATE               PIC XX.
  7377         16  PY-REPORTED-DT               PIC XX.
  7378         16  PY-PMT-APPLIED               PIC X.
  7379             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7380             88  PY-GA-PMT                    VALUE 'G'.
  7381             88  PY-OVWRITE-PMT               VALUE 'O'.
  7382             88  PY-NON-AR-PMT                VALUE 'N'.
  7383         16  FILLER                       PIC X(5).
  7384         16  PY-INPUT-DT                  PIC XX.
  7385         16  PY-CHECK-NUMBER              PIC X(6).
  7386         16  PY-VOID-SW                   PIC X.
  7387             88  PY-CHECK-VOIDED              VALUE 'V'.
  7388         16  PY-CHECK-ORIGIN-SW           PIC X.
  7389             88  PY-BILLING-CHECK             VALUE 'B'.
  7390             88  PY-REFUND-CHECK              VALUE 'R'.
  7391             88  PY-GA-CHECK                  VALUE 'G'.
  7392             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7393             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7394         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7395         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7396         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7397         16  PY-BILL-FLAG                 PIC X.
  7398             88  PY-BILLED                    VALUE 'B'.
  7399         16  PY-AR-FLAG                   PIC X.
  7400             88  PY-AR-CYCLE                  VALUE 'C'.
  7401             88  PY-AR-MONTH-END              VALUE 'M'.
  7402         16  PY-AR-DATE                   PIC XX.
  7403
  7404     12  PY-GL-CODES.
  7405         16  PY-GL-DB                     PIC X(14).
  7406         16  PY-GL-CR                     PIC X(14).
  7407         16  PY-GL-FLAG                   PIC X.
  7408         16  PY-GL-DATE                   PIC XX.
  7409
  7410     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7411     12  FILLER                           PIC X(3).
  7412******************************************************************
  7413*                                COPY ERCCNOT.
  7414******************************************************************
  7415*                                                                *
  7416*                            ERCCNOT                             *
  7417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7418*                            VMOD=2.003                          *
  7419*                                                                *
  7420*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7421*                                                                *
  7422*        FILE TYPE= VSAM,KSDS                                    *
  7423*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7424*                                                                *
  7425*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7426*                                                                *
  7427*        LOG = YES                                               *
  7428*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7429*                                                                *
  7430******************************************************************
  7431*                   C H A N G E   L O G
  7432*
  7433* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 137
* EL6311.cbl
  7434*-----------------------------------------------------------------
  7435*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7436* EFFECTIVE    NUMBER
  7437*-----------------------------------------------------------------
  7438* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7439******************************************************************
  7440
  7441 01  CERT-NOTE-FILE.
  7442     12  CZ-RECORD-ID                PIC  XX.
  7443         88  VALID-CZ-ID                  VALUE 'CZ'.
  7444
  7445     12  CZ-CONTROL-PRIMARY.
  7446         16  CZ-COMPANY-CD           PIC X.
  7447         16  CZ-CARRIER              PIC X.
  7448         16  CZ-GROUPING.
  7449             20 CZ-GROUPING-PREFIX   PIC XXX.
  7450             20 CZ-GROUPING-PRIME    PIC XXX.
  7451         16  CZ-STATE                PIC XX.
  7452         16  CZ-ACCOUNT.
  7453             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7454             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7455         16  CZ-CERT-EFF-DT          PIC XX.
  7456         16  CZ-CERT-NO.
  7457             20  CZ-CERT-PRIME       PIC X(10).
  7458             20  CZ-CERT-SFX         PIC X.
  7459         16  CZ-RECORD-TYPE          PIC X.
  7460             88  CERT-NOTE           VALUE '1'.
  7461             88  CLAIM-CERT-NOTE     VALUE '2'.
  7462         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7463
  7464     12  CZ-LAST-MAINT-DT            PIC XX.
  7465     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7466     12  CZ-LAST-MAINT-USER          PIC X(4).
  7467
  7468     12  CZ-NOTE-INFORMATION.
  7469         16  CZ-NOTE                 PIC X(63).
  7470         16  FILLER                  PIC X(39).
  7471******************************************************************
  7472*                                COPY ELCMSTR.
  7473******************************************************************
  7474*                                                                *
  7475*                            ELCMSTR.                            *
  7476*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7477*                            VMOD=2.012                          *
  7478*                                                                *
  7479*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7480*                                                                *
  7481*   FILE TYPE = VSAM,KSDS                                        *
  7482*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7483*                                                                *
  7484*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7485*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7486*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7487*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7488*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7489*                                                 RKP=75,LEN=21  *
  7490*                                                                *
  7491*   **** NOTE ****                                               *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 138
* EL6311.cbl
  7492*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7493*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7494*                                                                *
  7495*   LOG = YES                                                    *
  7496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7497******************************************************************
  7498*                   C H A N G E   L O G
  7499*
  7500* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7501*-----------------------------------------------------------------
  7502*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7503* EFFECTIVE    NUMBER
  7504*-----------------------------------------------------------------
  7505* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7506* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7507* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7508* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7509* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7510******************************************************************
  7511 01  CLAIM-MASTER.
  7512     12  CL-RECORD-ID                PIC XX.
  7513         88  VALID-CL-ID         VALUE 'CL'.
  7514
  7515     12  CL-CONTROL-PRIMARY.
  7516         16  CL-COMPANY-CD           PIC X.
  7517         16  CL-CARRIER              PIC X.
  7518         16  CL-CLAIM-NO             PIC X(7).
  7519         16  CL-CERT-NO.
  7520             20  CL-CERT-PRIME       PIC X(10).
  7521             20  CL-CERT-SFX         PIC X.
  7522
  7523     12  CL-CONTROL-BY-NAME.
  7524         16  CL-COMPANY-CD-A1        PIC X.
  7525         16  CL-INSURED-LAST-NAME    PIC X(15).
  7526         16  CL-INSURED-NAME.
  7527             20  CL-INSURED-1ST-NAME PIC X(12).
  7528             20  CL-INSURED-MID-INIT PIC X.
  7529
  7530     12  CL-CONTROL-BY-SSN.
  7531         16  CL-COMPANY-CD-A2        PIC X.
  7532         16  CL-SOC-SEC-NO.
  7533             20  CL-SSN-STATE        PIC XX.
  7534             20  CL-SSN-ACCOUNT      PIC X(6).
  7535             20  CL-SSN-LN3          PIC X(3).
  7536
  7537     12  CL-CONTROL-BY-CERT-NO.
  7538         16  CL-COMPANY-CD-A4        PIC X.
  7539         16  CL-CERT-NO-A4.
  7540             20  CL-CERT-A4-PRIME    PIC X(10).
  7541             20  CL-CERT-A4-SFX      PIC X.
  7542
  7543     12  CL-CONTROL-BY-CCN.
  7544         16  CL-COMPANY-CD-A5        PIC X.
  7545         16  CL-CCN-A5.
  7546             20  CL-CCN.
  7547                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7548                 24  CL-CCN-PRIME-A5 PIC X(12).
  7549             20  CL-CCN-FILLER-A5    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 139
* EL6311.cbl
  7550
  7551     12  CL-INSURED-PROFILE-DATA.
  7552         16  CL-INSURED-BIRTH-DT     PIC XX.
  7553         16  CL-INSURED-SEX-CD       PIC X.
  7554             88  INSURED-IS-MALE        VALUE 'M'.
  7555             88  INSURED-IS-FEMALE      VALUE 'F'.
  7556             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7557         16  CL-INSURED-OCC-CD       PIC X(6).
  7558         16  FILLER                  PIC X(5).
  7559
  7560     12  CL-PROCESSING-INFO.
  7561         16  CL-PROCESSOR-ID         PIC X(4).
  7562         16  CL-CLAIM-STATUS         PIC X.
  7563             88  CLAIM-IS-OPEN          VALUE 'O'.
  7564             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7565         16  CL-CLAIM-TYPE           PIC X.
  7566*            88  AH-CLAIM               VALUE 'A'.
  7567*            88  LIFE-CLAIM             VALUE 'L'.
  7568*            88  PROPERTY-CLAIM         VALUE 'P'.
  7569*            88  IUI-CLAIM              VALUE 'I'.
  7570*            88  GAP-CLAIM              VALUE 'G'.
  7571*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7572         16  CL-CLAIM-PREM-TYPE      PIC X.
  7573             88  SINGLE-PREMIUM         VALUE '1'.
  7574             88  O-B-COVERAGE           VALUE '2'.
  7575             88  OPEN-END-COVERAGE      VALUE '3'.
  7576         16  CL-INCURRED-DT          PIC XX.
  7577         16  CL-REPORTED-DT          PIC XX.
  7578         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7579         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7580         16  CL-LAST-PMT-DT          PIC XX.
  7581         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7582         16  CL-PAID-THRU-DT         PIC XX.
  7583         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7584         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7585         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7586         16  CL-PMT-CALC-METHOD      PIC X.
  7587             88  CL-360-DAY-YR          VALUE '1'.
  7588             88  CL-365-DAY-YR          VALUE '2'.
  7589             88  CL-FULL-MONTHS         VALUE '3'.
  7590         16  CL-CAUSE-CD             PIC X(6).
  7591
  7592         16  CL-PRIME-CERT-NO.
  7593             20  CL-PRIME-CERT-PRIME PIC X(10).
  7594             20  CL-PRIME-CERT-SFX   PIC X.
  7595
  7596         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7597             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7598             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7599
  7600         16  CL-MICROFILM-NO         PIC X(10).
  7601         16  FILLER REDEFINES CL-MICROFILM-NO.
  7602             20  CL-BENEFIT-PERIOD   PIC 99.
  7603             20  FILLER              PIC X(8).
  7604         16  CL-PROG-FORM-TYPE       PIC X.
  7605         16  CL-LAST-ADD-ON-DT       PIC XX.
  7606
  7607         16  CL-LAST-REOPEN-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 140
* EL6311.cbl
  7608         16  CL-LAST-CLOSE-DT        PIC XX.
  7609         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7610             88  FINAL-PAID             VALUE '1'.
  7611             88  CLAIM-DENIED           VALUE '2'.
  7612             88  AUTO-CLOSE             VALUE '3'.
  7613             88  MANUAL-CLOSE           VALUE '4'.
  7614             88  BENEFITS-CHANGED       VALUE 'C'.
  7615             88  SETUP-ERRORS           VALUE 'E'.
  7616         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7617         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7618         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7619             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7620         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7621         16  FILLER                  PIC X.
  7622
  7623     12  CL-CERTIFICATE-DATA.
  7624         16  CL-CERT-ORIGIN          PIC X.
  7625             88  CERT-WAS-ONLINE        VALUE '1'.
  7626             88  CERT-WAS-CREATED       VALUE '2'.
  7627             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7628         16  CL-CERT-KEY-DATA.
  7629             20  CL-CERT-CARRIER     PIC X.
  7630             20  CL-CERT-GROUPING    PIC X(6).
  7631             20  CL-CERT-STATE       PIC XX.
  7632             20  CL-CERT-ACCOUNT.
  7633                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7634                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7635             20  CL-CERT-EFF-DT      PIC XX.
  7636
  7637     12  CL-STATUS-CONTROLS.
  7638         16  CL-PRIORITY-CD          PIC X.
  7639             88  CONFIDENTIAL-DATA      VALUE '8'.
  7640             88  HIGHEST-PRIORITY       VALUE '9'.
  7641         16  CL-SUPV-ATTN-CD         PIC X.
  7642             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7643             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7644         16  CL-PURGED-DT            PIC XX.
  7645         16  CL-RESTORED-DT          PIC XX.
  7646         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7647         16  CL-NEXT-RESEND-DT       PIC XX.
  7648         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7649         16  CL-CRITICAL-PERIOD      PIC 99.
  7650*        16  FILLER                  PIC XX.
  7651         16  CL-LAST-MAINT-DT        PIC XX.
  7652         16  CL-LAST-MAINT-USER      PIC X(4).
  7653         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7654         16  CL-LAST-MAINT-TYPE      PIC X.
  7655             88  CLAIM-SET-UP           VALUE ' '.
  7656             88  PAYMENT-MADE           VALUE '1'.
  7657             88  LETTER-SENT            VALUE '2'.
  7658             88  MASTER-WAS-ALTERED     VALUE '3'.
  7659             88  MASTER-WAS-RESTORED    VALUE '4'.
  7660             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7661             88  FILE-CONVERTED         VALUE '6'.
  7662             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7663             88  ERROR-CORRECTION       VALUE 'E'.
  7664         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7665         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 141
* EL6311.cbl
  7666         16  CL-BENEFICIARY          PIC X(10).
  7667         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7668         16  CL-DENIAL-TYPE          PIC X.
  7669             88  CL-TYPE-DENIAL          VALUE '1'.
  7670             88  CL-TYPE-RESCISSION      VALUE '2'.
  7671             88  CL-TYPE-REFORMATION     VALUE '3'.
  7672             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7673             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7674         16  filler                  pic x(5).
  7675*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7676*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7677*        16  CL-RTW-DT               PIC XX.
  7678
  7679     12  CL-TRAILER-CONTROLS.
  7680         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7681             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7682             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7683             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7684         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7685         16  FILLER                  PIC XX.
  7686         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7687         16  CL-ADDRESS-TRAILER-CNT.
  7688             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7689                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7690             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7691                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7692             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7693                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7694             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7695                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7696             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7697                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7698             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7699                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7700             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7701                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7702
  7703     12  CL-CV-REFERENCE-NO.
  7704         16  CL-CV-REFNO-PRIME       PIC X(18).
  7705         16  CL-CV-REFNO-SFX         PIC XX.
  7706
  7707     12  CL-FILE-LOCATION            PIC X(4).
  7708
  7709     12  CL-PROCESS-ERRORS.
  7710         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7711             88  NO-FATAL-ERRORS        VALUE ZERO.
  7712         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7713             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7714
  7715     12  CL-PRODUCT-CD               PIC X.
  7716
  7717     12  CL-CURRENT-KEY-DATA.
  7718         16  CL-CURRENT-CARRIER      PIC X.
  7719         16  CL-CURRENT-GROUPING     PIC X(6).
  7720         16  CL-CURRENT-STATE        PIC XX.
  7721         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7722
  7723     12  CL-ASSOCIATES               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 142
* EL6311.cbl
  7724         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7725         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7726         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7727         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7728
  7729     12  CL-ACTIVITY-CODE            PIC 99.
  7730     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7731     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7732
  7733     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7734     12  CL-LAG-REPORT-CODE          PIC 9.
  7735     12  CL-LOAN-TYPE                PIC XX.
  7736     12  CL-LEGAL-STATE              PIC XX.
  7737
  7738     12  CL-YESNOSW                  PIC X.
  7739     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7740         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7741         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7742         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7743     12  cl-insured-type             pic x.
  7744         88  cl-claim-on-primary         value 'P'.
  7745         88  cl-claim-on-co-borrower     value 'C'.
  7746     12  cl-benefit-expiration-dt    PIC XX.
  7747*                                COPY ERCENDT.
  7748******************************************************************
  7749*                                                                *
  7750*                                                                *
  7751*                            ERCENDT.                            *
  7752*                            VMOD=2.001                          *
  7753*                                                                *
  7754*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7755*                                                                *
  7756*   FILE TYPE = VSAM,KSDS                                        *
  7757*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7758*                                                                *
  7759*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7760*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7761*                                                                *
  7762*   LOG = NO                                                     *
  7763*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7764******************************************************************
  7765*-----------------------------------------------------------------
  7766*                   C H A N G E   L O G
  7767*
  7768* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7769*-----------------------------------------------------------------
  7770*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7771* EFFECTIVE    NUMBER
  7772*-----------------------------------------------------------------
  7773* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7774*                                WITH OPEN CLAIMS
  7775* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7776* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7777* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7778* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7779*-----------------------------------------------------------------
  7780 01  ENDORSEMENT-RECORD.
  7781     12  EN-RECORD-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 143
* EL6311.cbl
  7782         88  VALID-EN-ID                VALUE 'EN'.
  7783     12  EN-CONTROL-PRIMARY.
  7784         16  EN-COMPANY-CD           PIC X.
  7785         16  EN-CARRIER              PIC X.
  7786         16  EN-GROUPING             PIC X(6).
  7787         16  EN-STATE                PIC XX.
  7788         16  EN-ACCOUNT              PIC X(10).
  7789         16  EN-CERT-EFF-DT          PIC XX.
  7790         16  EN-CERT-NO.
  7791             20  EN-CERT-PRIME       PIC X(10).
  7792             20  EN-CERT-SFX         PIC X.
  7793         16  EN-REC-TYPE             PIC X.
  7794             88  EN-ISSUE               VALUE 'I'.
  7795             88  EN-CANCELLATION        VALUE 'C'.
  7796         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7797     12  EN-CONTROL-BY-ARCH-NO.
  7798         16  EN-COMPANY-CD-A1              PIC X.
  7799         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7800     12  EN-LAST-MAINT-DT            PIC XX.
  7801     12  EN-LAST-MAINT-BY            PIC X(4).
  7802     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7803     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7804     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7805         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7806         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7807         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7808         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7809         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7810         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7811         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7812         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7813         16  EN-LF-ORIG-BENCD        PIC XX.
  7814         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7815         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7816         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7817         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7818         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7819         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7820*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7821         16  EN-ORIG-CRED-BENE       PIC X(25).
  7822         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7823         16  FILLER                  PIC X.
  7824         16  EN-AH-ORIG-BENCD        PIC XX.
  7825         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7826         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7827         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7828         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7829*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7830*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7831         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7832         16  F                       PIC X(09).
  7833         16  EN-AH-ORIG-CP           PIC 99.
  7834         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7835         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7836         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7837         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7838         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7839         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 144
* EL6311.cbl
  7840         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7841         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7842         16  EN-LF-NEW-BENCD         PIC XX.
  7843         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7844         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7845         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7846         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7847         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7848         16  EN-LF-NEW-EXP-DT        PIC XX.
  7849         16  EN-NEW-CRED-BENE        PIC X(25).
  7850         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7851         16  FILLER                  PIC X.
  7852         16  EN-AH-NEW-BENCD         PIC XX.
  7853         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7854         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7855         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7856         16  EN-AH-NEW-EXP-DT        PIC XX.
  7857*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7858*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7859*        16  F                       PIC X(12).
  7860         16  EN-AH-NEW-CP            PIC 99.
  7861         16  EN-SIG-SW               PIC X.
  7862         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7863         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7864         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7865         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7866         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7867         16  FILLER                  PIC X(33).
  7868     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7869         16  EN-LF-ORIG-REF-DT       PIC XX.
  7870         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7871         16  EN-AH-ORIG-REF-DT       PIC XX.
  7872         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7873         16  EN-LF-NEW-REF-DT        PIC XX.
  7874         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7875         16  EN-AH-NEW-REF-DT        PIC XX.
  7876         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7877         16  EN-FLAG-CERT            PIC X.
  7878         16  EN-INS-LAST-NAME        PIC X(15).
  7879         16  EN-INS-FIRST-NAME       PIC X(10).
  7880         16  EN-INS-MIDDLE-INIT      PIC X.
  7881         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7882         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7883         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7884         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7885         16  FILLER                  PIC X(262).
  7886     12  EN-MONEY-SW             PIC X.
  7887     12  EN-HEALTH-APP           PIC X.
  7888     12  EN-VOUCHER-SW           PIC X.
  7889     12  EN-PAYEE                PIC X(14).
  7890     12  EN-INPUT-DT             PIC XX.
  7891     12  EN-PROCESS-DT           PIC XX.
  7892     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7893     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7894     12  EN-REASON-CODES.
  7895         16  F OCCURS 12.
  7896             20  EN-REASON-CODE  PIC X(4).
  7897     12  EN-TEMPLATE-USED        PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 145
* EL6311.cbl
  7898     12  EN-DOCU-TYPE            PIC X.
  7899         88  EN-VERI-DOCU          VALUE 'V'.
  7900         88  EN-GCE-DOCU           VALUE 'G'.
  7901         88  EN-CANC-DOCU          VALUE 'C'.
  7902     12  EN-COMMENTS1            PIC X(13).
  7903     12  EN-COMMENTS2            PIC X(70).
  7904     12  EN-COMM-CHGBK           PIC X.
  7905         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7906         88  EN-CHG-ACCT           VALUE 'Y'.
  7907     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7908     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7909     12  EN-BATCH-NUMBER         PIC X(6).
  7910     12  EN-ACCT-SUMM            PIC X.
  7911     12  EN-CSO-SUMM             PIC X.
  7912     12  en-check-type           pic x.
  7913     12  FILLER                  PIC X(12).
  7914******************************************************************
  7915*                                COPY ELCCRTT.
  7916******************************************************************
  7917*                                                                *
  7918*                            ELCCRTT.                            *
  7919*                                                                *
  7920*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7921*                                                                *
  7922*   FILE TYPE = VSAM,KSDS                                        *
  7923*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7924*                                                                *
  7925*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7926*                                                                *
  7927*   LOG = YES                                                    *
  7928*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7929******************************************************************
  7930*                   C H A N G E   L O G
  7931*
  7932* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7933*-----------------------------------------------------------------
  7934*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7935* EFFECTIVE    NUMBER
  7936*-----------------------------------------------------------------
  7937* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7938* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7939* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7940* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7941* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7942* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7943* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7944* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7945* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7946******************************************************************
  7947
  7948 01  CERTIFICATE-TRAILERS.
  7949     12  CS-RECORD-ID                      PIC XX.
  7950         88  VALID-CS-ID                      VALUE 'CS'.
  7951
  7952     12  CS-CONTROL-PRIMARY.
  7953         16  CS-COMPANY-CD                 PIC X.
  7954         16  CS-CARRIER                    PIC X.
  7955         16  CS-GROUPING                   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 146
* EL6311.cbl
  7956         16  CS-STATE                      PIC XX.
  7957         16  CS-ACCOUNT                    PIC X(10).
  7958         16  CS-CERT-EFF-DT                PIC XX.
  7959         16  CS-CERT-NO.
  7960             20  CS-CERT-PRIME             PIC X(10).
  7961             20  CS-CERT-SFX               PIC X.
  7962         16  CS-TRAILER-TYPE               PIC X.
  7963             88  COMM-TRLR           VALUE 'A'.
  7964             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7965             88  CERT-DATA-TRLR      VALUE 'C'.
  7966
  7967     12  CS-DATA-AREA                      PIC X(516).
  7968
  7969     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7970         16  CS-BANK-COMMISSION-AREA.
  7971             20  CS-BANK-COMMS       OCCURS 10.
  7972                 24  CS-AGT                PIC X(10).
  7973                 24  CS-COM-TYP            PIC X.
  7974                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7975                 24  CS-RECALC-LV-INDIC    PIC X.
  7976                 24  FILLER                PIC X(10).
  7977         16  FILLER                        PIC X(256).
  7978
  7979     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7980****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7981         16  CS-MB-CLAIM-DATA OCCURS 24.
  7982             20  CS-CLAIM-NO               PIC X(7).
  7983             20  CS-CLAIM-TYPE             PIC X.
  7984                 88  CS-AH-CLM               VALUE 'A'.
  7985                 88  CS-IU-CLM               VALUE 'I'.
  7986                 88  CS-GP-CLM               VALUE 'G'.
  7987                 88  CS-LF-CLM               VALUE 'L'.
  7988                 88  CS-PR-CLM               VALUE 'P'.
  7989                 88  CS-FL-CLM               VALUE 'F'.
  7990             20  CS-INSURED-TYPE           PIC X.
  7991                 88  CS-PRIM-INSURED          VALUE 'P'.
  7992                 88  CS-CO-BORROWER           VALUE 'C'.
  7993             20  CS-BENEFIT-PERIOD         PIC 99.
  7994             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7995             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7996             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7997         16  FILLER                        PIC X(12).
  7998     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7999         16  CS-VIN-NUMBER                 PIC X(17).
  8000         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8001         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8002         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8003         16  cs-agent-name.
  8004             20  cs-agent-fname            pic x(20).
  8005             20  cs-agent-mi               pic x.
  8006             20  cs-agent-lname            pic x(25).
  8007         16  cs-license-no                 pic x(15).
  8008         16  cs-npn-number                 pic x(10).
  8009         16  cs-agent-edit-status          pic x.
  8010             88  cs-ae-refer-to-manager      value 'M'.
  8011             88  cs-ae-cover-sheet           value 'C'.
  8012             88  cs-ae-sig-form              value 'S'.
  8013             88  cs-ae-verified              value 'V'.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 147
* EL6311.cbl
  8014             88  cs-unidentified-signature   value 'U'.
  8015             88  cs-cert-returned            value 'R'.
  8016             88  cs-accept-no-commission     value 'N'.
  8017         16  cs-year                       pic 9999.
  8018         16  cs-make                       pic x(20).
  8019         16  cs-model                      pic x(20).
  8020         16  cs-future                     pic x(20).
  8021         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8022         16  FILLER                        PIC X(356). *> was 420
  8023*        16  FILLER                        PIC X(496).
  8024*                                COPY ERCCHEK.
  8025******************************************************************
  8026*                                                                *
  8027*                                                                *
  8028*                            ERCCHEK                             *
  8029*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8030*                            VMOD=2.008                          *
  8031*                                                                *
  8032*   FILE DESCRIPTION = CHECK RECORDS                             *
  8033*                                                                *
  8034*   FILE TYPE = VSAM,KSDS                                        *
  8035*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8036*                                                                *
  8037*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8038*       ALTERNATE INDEX = NONE                                   *
  8039*                                                                *
  8040*   LOG = YES                                                    *
  8041*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8042******************************************************************
  8043*                   C H A N G E   L O G
  8044*
  8045* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8046*-----------------------------------------------------------------
  8047*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8048* EFFECTIVE    NUMBER
  8049*-----------------------------------------------------------------
  8050* 021414    2003053000001  PEMA  changes for auto chk request
  8051******************************************************************
  8052 01  CHECK-RECORDS.
  8053     12  CH-RECORD-ID                      PIC XX.
  8054         88  VALID-CH-ID                      VALUE 'CH'.
  8055
  8056     12  CH-CONTROL-PRIMARY.
  8057         16  CH-COMPANY-CD                 PIC X.
  8058         16  CH-CARRIER                    PIC X.
  8059         16  CH-GROUPING                   PIC X(6).
  8060         16  CH-STATE                      PIC XX.
  8061         16  CH-ACCOUNT                    PIC X(10).
  8062         16  CH-CERT-EFF-DT                PIC XX.
  8063         16  CH-CERT-NO.
  8064             20  CH-CERT-PRIME             PIC X(10).
  8065             20  CH-CERT-SFX               PIC X.
  8066         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8067
  8068     12  CH-RECORDED-DT                    PIC XX.
  8069     12  CH-RECORDED-BY                    PIC X(4).
  8070     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8071
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 148
* EL6311.cbl
  8072     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8073     12  CH-CHECK-NO                       PIC X(7).
  8074     12  CH-REASON-FOR-CHECK               PIC X(25).
  8075     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8076     12  FILLER                            PIC X.
  8077
  8078     12  CH-PAYEE-INFO.
  8079         16  CH-PAYEE-NAME-1               PIC X(30).
  8080         16  CH-PAYEE-NAME-2               PIC X(30).
  8081         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8082         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8083         16  CH-PAYEE-CITY-ST.
  8084             20  CH-PAYEE-CITY             PIC X(28).
  8085             20  CH-PAYEE-STATE            PIC XX.
  8086         16  CH-PAYEE-ZIP-CODE.
  8087             20  CH-PAYEE-ZIP.
  8088                 24  CH-ZIP-PRI-1ST        PIC X.
  8089                     88  CH-CANADIAN-POST-CODE
  8090                                           VALUES 'A' THRU 'Z'.
  8091                 24  FILLER                PIC X(4).
  8092             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8093         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8094             20  CH-CAN-POSTAL-1           PIC XXX.
  8095             20  CH-CAN-POSTAL-2           PIC XXX.
  8096             20  FILLER                    PIC XXX.
  8097
  8098     12  CH-CHECK-STUB-TEXT.
  8099         16  CH-STUB-LINE-1                PIC X(30).
  8100         16  CH-TEXT-LINE-1                PIC X(50).
  8101         16  CH-TEXT-LINE-2                PIC X(50).
  8102         16  CH-TEXT-LINE-3                PIC X(40).
  8103     12  CH-RETURN-TO                      PIC X(30).
  8104
  8105     12  CH-COMPENSATION-CONTROL.
  8106         16  CH-COMP-CARRIER               PIC X.
  8107         16  CH-COMP-GROUPING              PIC X(6).
  8108         16  CH-COMP-FIN-RESP              PIC X(10).
  8109         16  CH-COMP-ACCOUNT               PIC X(10).
  8110
  8111     12  CH-CREDIT-SELECT-DT               PIC XX.
  8112     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8113     12  CH-PAYEE-CODE                     PIC X(6).
  8114
  8115     12  CH-VOID-DATA.
  8116         20  CH-VOID-DT                    PIC XX.
  8117         20  CH-VOID-BY                    PIC X(4).
  8118         20  CH-VOID-REASON                PIC X(25).
  8119
  8120     12  CH-APPROVAL-DATA.
  8121         20  CH-APPROVAL-DT                PIC XX.
  8122         20  CH-APPROVAL-STATUS            PIC X.
  8123             88  CH-IN-LIMBO                  VALUE ' '.
  8124             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8125             88  CH-APPROVED                  VALUE 'A'.
  8126             88  CH-DENIED                    VALUE 'D'.
  8127         20  CH-APPROVED-BY                PIC XXXX.
  8128     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8129             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 149
* EL6311.cbl
  8130     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8131
  8132     12  ch-released-dt                    pic xx.
  8133     12  ch-check-cashed-dt                pic xx.
  8134     12  FILLER                            PIC X.
  8135*    12  CH-CHECK-REFERENCE                PIC X(12).
  8136     12  CH-CHECK-ORIGIN-SW                PIC X.
  8137             88  CH-REFUND-CHECK              VALUE 'R'.
  8138             88  CH-MAINT-CHECK               VALUE 'M'.
  8139
  8140     12  CH-CANC-DT                        PIC XX.
  8141     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8142     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8143
  8144     12  CH-INSURED-NAME                   PIC X(28).
  8145
  8146     12  ch-released-by                    pic x(4).
  8147     12  ch-csr                            pic x(4).
  8148     12  ch-deduct-commission              pic x.
  8149         88  ch-deduct-comm                  value 'Y'.
  8150         88  ch-do-not-deduct-comm           value 'N'.
  8151
  8152     12  FILLER                            PIC X(11).
  8153*    12  CH-LETTER-TABLE.
  8154*        16  CH-LETTERS OCCURS 3 TIMES
  8155*                       INDEXED BY CH-LT-NDX
  8156*                                          PIC X(04).
  8157
  8158     12  FILLER                            PIC X(07).
  8159
  8160 01  var                         pic x(30).
  8161 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8162                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8163                          PENDING-MAILING-DATA MAILING-DATA
  8164                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8165                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8166                          CLAIM-MASTER ENDORSEMENT-RECORD
  8167                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8168                          VAR.
  8169 0000-DFHEXIT SECTION.
  8170     MOVE '9#                    $   ' TO DFHEIV0.
  8171     MOVE 'EL6311' TO DFHEIV1.
  8172     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8173
  8174     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8175     MOVE EIBTRMID               TO QID-TERM.
  8176     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8177     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8178     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8179     MOVE 2                      TO EMI-SWITCH2.
  8180
  8181     move spaces to ws-kix-myenv
  8182     set P to address of KIXSYS
  8183     CALL "getenv" using by value P returning var-ptr
  8184     if var-ptr = null then
  8185        display ' kixsys not set '
  8186     else
  8187        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 150
* EL6311.cbl
  8188        move 0 to env-var-len
  8189        inspect var tallying env-var-len
  8190          for characters before X'00'
  8191        unstring var (1:env-var-len) delimited by '/'
  8192           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8193              WS-KIX-SYS
  8194        end-unstring
  8195     end-if
  8196     perform varying a1 from +1 by +1 until a1 > +10
  8197        if ws-kix-myenv (a1:1) = low-values or high-values
  8198           display ' found low or hi val '
  8199           move spaces to ws-kix-myenv (a1:1)
  8200        end-if
  8201     end-perform
  8202*    display ' env *' ws-kix-myenv '*'
  8203     IF EIBCALEN = 0
  8204         GO TO 8800-UNAUTHORIZED-ACCESS.
  8205
  8206     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8207     MOVE '5'                   TO DC-OPTION-CODE.
  8208     PERFORM 9700-DATE-LINK.
  8209     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8210     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8211
  8212     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8213     MOVE SPACE                  TO DC-OPTION-CODE.
  8214     PERFORM 9700-DATE-LINK.
  8215     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8216     MOVE LOW-VALUES             TO EL631BI.
  8217
  8218
  8219* EXEC CICS HANDLE CONDITION
  8220*        PGMIDERR  (9600-PGMID-ERROR)
  8221*        ERROR     (9990-ABEND)
  8222*        INVREQ    (9990-ABEND)
  8223*        QIDERR    (0010-MAIN-LOGIC)
  8224*    END-EXEC.
  8225*    MOVE '"$L.8N                ! " #00008214' TO DFHEIV0
  8226     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8228     MOVE X'2220233030303038323134' TO DFHEIV0(25:11)
  8229     CALL 'kxdfhei1' USING DFHEIV0
  8230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8231
  8232
  8233     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8234         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8235             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8236             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8237             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8238             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8239             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8240             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8241             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8242             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8243
  8244             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8245                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 151
* EL6311.cbl
  8246
  8247             ELSE
  8248                 NEXT SENTENCE
  8249
  8250         ELSE
  8251             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8252             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8253             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8254             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8255             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8256             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8257             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8258             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8259             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8260             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8261             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8262             GO TO 3900-RE-DISPLAY-RECORD
  8263     ELSE
  8264         GO TO 0020-MAIN-LOGIC.
  8265
  8266 0010-MAIN-LOGIC.
  8267     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8268                                    WS-FIRST-ENTRY-SW.
  8269
  8270     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8271
  8272     MOVE LOW-VALUES             TO EC-NEW-CERT
  8273                                    EC-NEW-STATE.
  8274
  8275     IF PI-DISPLAY-ORIGINAL-BATCH
  8276         NEXT SENTENCE
  8277     ELSE
  8278         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8279             GO TO 5000-BROWSE-BATCH-HEADERS.
  8280
  8281     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8282         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8283
  8284     IF PI-CSR-BROWSE
  8285        GO TO 4200-BROWSE-CSR-FORWARD.
  8286
  8287     IF PI-FILE-BROWSE
  8288         GO TO 4300-BROWSE-FILE-FORWARD.
  8289
  8290     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8291
  8292 0020-MAIN-LOGIC.
  8293     IF EIBAID = DFHCLEAR
  8294         GO TO 9400-CLEAR.
  8295
  8296     MOVE LOW-VALUES             TO EC-NEW-CERT
  8297                                    EC-NEW-STATE.
  8298
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 152
* EL6311.cbl
  8300
  8301******************************************************************
  8302*                                                                *
  8303*              R E C E I V E   M A P                             *
  8304*                                                                *
  8305******************************************************************
  8306
  8307 0200-RECEIVE.
  8308     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8309         MOVE ER-0008            TO EMI-ERROR
  8310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8311         IF PI-MAP-NAME = EL631B
  8312             MOVE -1                 TO BMAINTL
  8313             GO TO 8200-SEND-DATAONLY
  8314         ELSE
  8315             IF PI-MAP-NAME = EL631C
  8316                 MOVE -1                 TO CMAINTL
  8317                 GO TO 8200-SEND-DATAONLY
  8318             ELSE
  8319                 IF PI-MAP-NAME = EL631D
  8320                     MOVE -1                 TO DPFENTRL
  8321                     GO TO 8200-SEND-DATAONLY.
  8322
  8323
  8324* EXEC CICS RECEIVE
  8325*        MAP      (PI-MAP-NAME)
  8326*        MAPSET   (MAPSET-EL6311S)
  8327*        INTO     (EL631BI)
  8328*    END-EXEC.
  8329     MOVE LENGTH OF
  8330      EL631BI
  8331       TO DFHEIV11
  8332*    MOVE '8"T I  L              ''   #00008311' TO DFHEIV0
  8333     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8335     MOVE X'2020233030303038333131' TO DFHEIV0(25:11)
  8336     CALL 'kxdfhei1' USING DFHEIV0,
  8337           PI-MAP-NAME,
  8338           EL631BI,
  8339           DFHEIV11,
  8340           MAPSET-EL6311S,
  8341           DFHEIV99,
  8342           DFHEIV99
  8343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8344
  8345
  8346******************************************************************
  8347*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8348******************************************************************
  8349
  8350     IF BTYPE-LEN (1) EQUAL +3
  8351        IF BTYPE (1) EQUAL ALL ' '
  8352            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8353
  8354     IF BTYPE-LEN (2) EQUAL +3
  8355        IF BTYPE (2) EQUAL ALL ' '
  8356            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8357
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 153
* EL6311.cbl
  8358     INSPECT EL631BI CONVERTING '_' TO ' '.
  8359
  8360     IF PI-MAP-NAME = EL631B
  8361         IF BPFENTRL GREATER THAN ZEROS
  8362             IF EIBAID NOT = DFHENTER
  8363                 MOVE ER-0004       TO EMI-ERROR
  8364                 MOVE -1            TO BPFENTRL
  8365                 MOVE AL-UNBOF      TO BPFENTRA
  8366                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8367                 GO TO 8200-SEND-DATAONLY
  8368             ELSE
  8369                 IF BPFENTRI NUMERIC AND
  8370                   (BPFENTRI GREATER 0 AND LESS 25)
  8371                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8372                 ELSE
  8373                     MOVE ER-0029  TO EMI-ERROR
  8374                     MOVE AL-UNBON TO BPFENTRA
  8375                     MOVE -1       TO BPFENTRL
  8376                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8377                     GO TO 8200-SEND-DATAONLY
  8378         ELSE
  8379             NEXT SENTENCE
  8380     ELSE
  8381         IF PI-MAP-NAME = EL631C
  8382            IF CPFENTRL GREATER THAN ZEROS
  8383                IF EIBAID NOT = DFHENTER
  8384                 MOVE ER-0004         TO EMI-ERROR
  8385                 MOVE -1              TO CPFENTRL
  8386                 MOVE AL-UNBOF        TO CPFENTRA
  8387                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8388                 GO TO 8200-SEND-DATAONLY
  8389             ELSE
  8390                 IF CPFENTRI NUMERIC AND
  8391                   (CPFENTRI GREATER 0 AND LESS 25)
  8392                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8393                 ELSE
  8394                     MOVE ER-0029      TO EMI-ERROR
  8395                     MOVE AL-UNBON     TO CPFENTRA
  8396                     MOVE -1           TO CPFENTRL
  8397                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8398                     GO TO 8200-SEND-DATAONLY
  8399         ELSE
  8400             NEXT SENTENCE
  8401     ELSE
  8402     IF PI-MAP-NAME = EL631D
  8403         IF DPFENTRL GREATER THAN ZEROS
  8404             IF EIBAID NOT = DFHENTER
  8405                 MOVE ER-0004         TO EMI-ERROR
  8406                 MOVE -1              TO DPFENTRL
  8407                 MOVE AL-UNBOF        TO DPFENTRA
  8408                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8409                 GO TO 8200-SEND-DATAONLY
  8410             ELSE
  8411                 IF DPFENTRI NUMERIC AND
  8412                   (DPFENTRI GREATER 0 AND LESS 25)
  8413                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8414                 ELSE
  8415                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 154
* EL6311.cbl
  8416                     MOVE AL-UNBON     TO DPFENTRA
  8417                     MOVE -1           TO DPFENTRL
  8418                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8419                     GO TO 8200-SEND-DATAONLY.
  8420
  8421     IF EIBAID = DFHPF23
  8422         GO TO 8810-PF23.
  8423
  8424     IF EIBAID = DFHPF24
  8425         GO TO 9200-RETURN-MAIN-MENU.
  8426
  8427     IF EIBAID = DFHPF12
  8428         GO TO 9500-PF12.
  8429
  8430     IF PI-MAP-NAME = EL631B
  8431        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8432
  8433     IF PI-MAP-NAME = EL631C
  8434        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8435
  8436     IF PI-MAP-NAME = EL631D
  8437        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8438
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 155
* EL6311.cbl
  8440
  8441******************************************************************
  8442*                                                                *
  8443*      ISSUE SCREEN PF KEY CHECKING                              *
  8444*                                                                *
  8445******************************************************************
  8446
  8447******************************************************************
  8448*                                                                *
  8449*      PF KEY FUNCTIONS:                                         *
  8450*                                                                *
  8451*      PF1  = BROWSE FORWARD                                     *
  8452*      PF2  = BROWSE BACKWARD                                    *
  8453*      PF3  = CERTIFICATE LOOKUP                                 *
  8454*      PF4  = DISPLAY BATCH HEADER                               *
  8455*      PF5  = ADD ISSUE  SCREEN                                  *
  8456*      PF6  = ADD CANCEL SCREEN                                  *
  8457*      PF7  = CERTIFICATE DISPLAY                                *
  8458*      PF8  = CERTIFICATE NOTES                                  *
  8459*      PF9  = EDIT CONTROL                                       *
  8460*      PF10 = DISPLAY LETTER SCREEN                              *
  8461*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8462*      PF12 = HELP SCREEN                                        *
  8463*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8464*      PF14 = ACCOUNT MASTER                                     *
  8465*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8466*      PF16 = DISPLAY LETTER REVIEW                              *
  8467*                                                                *
  8468******************************************************************
  8469
  8470 0300-CHECK-ISSUE-PF-KEYS.
  8471     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8472        MOVE ER-2337            TO EMI-ERROR
  8473        MOVE -1                  TO BMAINTL
  8474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8475        GO TO 8200-SEND-DATAONLY.
  8476
  8477     IF EIBAID = DFHPF1
  8478        MOVE '0'                TO PI-EDIT-SW
  8479        IF PI-PRIMARY-BROWSE
  8480           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8481        ELSE
  8482           IF PI-PRIMARY-WITH-SELECT
  8483              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8484           ELSE
  8485              IF PI-FILE-BROWSE
  8486                 GO TO 4300-BROWSE-FILE-FORWARD
  8487              ELSE
  8488                 IF PI-CSR-BROWSE
  8489                    GO TO 4200-BROWSE-CSR-FORWARD
  8490                 ELSE
  8491                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8492
  8493     IF EIBAID = DFHPF2
  8494        MOVE '0'                TO PI-EDIT-SW
  8495        IF PI-PRIMARY-BROWSE
  8496           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8497        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 156
* EL6311.cbl
  8498           IF PI-PRIMARY-WITH-SELECT
  8499              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8500           ELSE
  8501              IF PI-FILE-BROWSE
  8502                 GO TO 4800-BROWSE-FILE-BACKWARD
  8503              ELSE
  8504                 IF PI-CSR-BROWSE
  8505                    GO TO 4900-BROWSE-CSR-BACKWARD
  8506                 ELSE
  8507                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8508
  8509     IF EIBAID = DFHPF3
  8510        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8511        MOVE XCTL-EL127         TO PGM-NAME
  8512        GO TO 9300-XCTL.
  8513
  8514     IF (EIBAID = DFHPF15 OR DFHPF6)
  8515        AND (CSR-EDIT-SESSION)
  8516*       AND (FATAL-OR-UNFORCED)
  8517        AND (FATAL-ERRORS)
  8518        MOVE ER-1819             TO EMI-ERROR
  8519        MOVE -1                  TO BMAINTL
  8520        MOVE AL-UANON            TO BMAINTA
  8521        PERFORM 9900-ERROR-FORMAT
  8522                                 THRU 9900-EXIT
  8523        GO TO 8200-SEND-DATAONLY
  8524     END-IF
  8525     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8526      OR (EIBAID = DFHPF10)
  8527        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8528        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8529        IF (RESP-NORMAL)
  8530           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8531              AM-CONTROL-PRIMARY (1:20))
  8532            IF AM-NAME NOT GREATER THAN SPACES OR
  8533               AM-ADDRS NOT GREATER THAN SPACES  OR
  8534               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8535               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8536               AM-ZIP NOT GREATER THAN SPACES
  8537               MOVE ER-3834             TO EMI-ERROR
  8538               MOVE -1                  TO BMAINTL
  8539               MOVE AL-UANON            TO BMAINTA
  8540               PERFORM 9900-ERROR-FORMAT
  8541                                 THRU 9900-EXIT
  8542               GO TO 8200-SEND-DATAONLY
  8543            END-IF
  8544        ELSE
  8545           MOVE ER-1609             TO EMI-ERROR
  8546           MOVE -1                  TO BMAINTL
  8547           MOVE AL-UANON            TO BMAINTA
  8548           PERFORM 9900-ERROR-FORMAT
  8549                                THRU 9900-EXIT
  8550           GO TO 8200-SEND-DATAONLY
  8551        END-IF
  8552
  8553        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8554        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8555        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 157
* EL6311.cbl
  8556            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8557               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8558               MA-CITY NOT GREATER THAN SPACES OR
  8559               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8560               MA-ZIP-CODE NOT GREATER THAN SPACES
  8561               MOVE ER-3835             TO EMI-ERROR
  8562               MOVE -1                  TO BMAINTL
  8563               MOVE AL-UANON            TO BMAINTA
  8564               PERFORM 9900-ERROR-FORMAT
  8565                                 THRU 9900-EXIT
  8566               GO TO 8200-SEND-DATAONLY
  8567            END-IF
  8568        ELSE
  8569           MOVE ER-3000             TO EMI-ERROR
  8570           MOVE -1                  TO BMAINTL
  8571           MOVE AL-UANON            TO BMAINTA
  8572           PERFORM 9900-ERROR-FORMAT
  8573                                THRU 9900-EXIT
  8574           GO TO 8200-SEND-DATAONLY
  8575        END-IF
  8576
  8577     END-IF
  8578     IF (EIBAID = DFHPF15)
  8579        AND (CSR-EDIT-SESSION)
  8580        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8581        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8582        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8583        MOVE PI-SV-STATE         TO PI-STATE
  8584        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8585        MOVE BCERTNOI            TO PI-CERT-PRIME
  8586        MOVE BSUFIXI             TO PI-CERT-SFX
  8587        MOVE BEFFDTI             TO DEEDIT-FIELD
  8588        PERFORM 8600-DEEDIT
  8589        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8590        MOVE '4'                 TO DC-OPTION-CODE
  8591        PERFORM 9700-DATE-LINK
  8592        IF DATE-CONVERSION-ERROR
  8593           MOVE ER-0348          TO EMI-ERROR
  8594           MOVE -1               TO BEFFDTL
  8595           MOVE AL-UABON         TO BEFFDTA
  8596           PERFORM 9900-ERROR-FORMAT
  8597                                 THRU 9900-EXIT
  8598           GO TO 8200-SEND-DATAONLY
  8599        ELSE
  8600           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8601           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8602           MOVE XCTL-EL6315      TO PGM-NAME
  8603           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8604           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8605           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8606           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8607           GO TO 9300-XCTL
  8608        END-IF
  8609     END-IF
  8610
  8611     IF EIBAID = DFHPF4
  8612        MOVE '0'                TO PI-EDIT-SW
  8613        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 158
* EL6311.cbl
  8614           NEXT SENTENCE
  8615        ELSE
  8616           GO TO 7200-DISPLAY-BATCHES.
  8617
  8618     IF EIBAID = DFHPF5
  8619        MOVE ER-0029                TO EMI-ERROR
  8620        MOVE -1                     TO BPFENTRL
  8621        MOVE AL-UNBON               TO BPFENTRA
  8622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8623        GO TO 8200-SEND-DATAONLY.
  8624*        MOVE '0'                TO PI-EDIT-SW
  8625*        IF PI-DISPLAY-ORIGINAL-BATCH
  8626*           NEXT SENTENCE
  8627*        ELSE
  8628*           MOVE EL631B              TO PI-MAP-NAME
  8629*           MOVE LOW-VALUES          TO EL631BI
  8630*           MOVE 'A'                 TO BMAINTO
  8631*           MOVE AL-UANON            TO BMAINTA
  8632*           MOVE -1                  TO BMAINTL
  8633*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8634*           GO TO 8100-SEND-INITIAL-MAP.
  8635
  8636     IF EIBAID = DFHPF6
  8637        IF NOT CSR-EDIT-SESSION
  8638           MOVE ER-0029                TO EMI-ERROR
  8639           MOVE -1                     TO BPFENTRL
  8640           MOVE AL-UNBON               TO BPFENTRA
  8641           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8642           GO TO 8200-SEND-DATAONLY
  8643*           MOVE '0'              TO PI-EDIT-SW
  8644*           IF PI-DISPLAY-ORIGINAL-BATCH
  8645*              NEXT SENTENCE
  8646*           ELSE
  8647*              MOVE EL631C        TO PI-MAP-NAME
  8648*              MOVE LOW-VALUES    TO EL631CI
  8649*              MOVE 'A'           TO CMAINTO
  8650*              MOVE AL-UANON      TO CMAINTA
  8651*              MOVE -1            TO CMAINTL
  8652*              MOVE '6'           TO PI-MAINT-FUNCTION
  8653*              GO TO 8100-SEND-INITIAL-MAP
  8654*           END-IF
  8655        ELSE
  8656           PERFORM 5100-PROCESS-POL-RESC
  8657                                 THRU 5100-EXIT
  8658           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8659           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8660                                    PI-PREV-SEQ-NO
  8661           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8662*                                    WS-CANCEL-LETTER-SW
  8663                                    PI-ALL-ISSUES-SW
  8664                                    PI-ALL-CANCELS-SW
  8665           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8666        END-IF
  8667     END-IF
  8668     IF EIBAID = DFHPF7
  8669        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8670        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8671        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 159
* EL6311.cbl
  8672        MOVE PI-SV-STATE            TO PI-STATE
  8673        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8674        MOVE BCERTNOI               TO PI-CERT-PRIME
  8675        MOVE BSUFIXI                TO PI-CERT-SFX
  8676        MOVE BEFFDTI                TO DEEDIT-FIELD
  8677        PERFORM 8600-DEEDIT
  8678        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8679        MOVE '4'                    TO DC-OPTION-CODE
  8680        PERFORM 9700-DATE-LINK
  8681        IF DATE-CONVERSION-ERROR
  8682           MOVE ER-0348            TO EMI-ERROR
  8683           MOVE -1                  TO BEFFDTL
  8684           MOVE AL-UABON            TO BEFFDTA
  8685           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8686           GO TO 8200-SEND-DATAONLY
  8687        ELSE
  8688           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8689           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8690           MOVE XCTL-EL1273        TO PGM-NAME
  8691           GO TO 9300-XCTL.
  8692
  8693     IF EIBAID = DFHPF8
  8694        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8695        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8696        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8697        MOVE PI-SV-STATE            TO PI-STATE
  8698        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8699        MOVE BCERTNOI               TO PI-CERT-PRIME
  8700        MOVE BSUFIXI                TO PI-CERT-SFX
  8701        MOVE BEFFDTI                TO DEEDIT-FIELD
  8702        PERFORM 8600-DEEDIT
  8703        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8704        MOVE '4'                    TO DC-OPTION-CODE
  8705        PERFORM 9700-DATE-LINK
  8706        IF DATE-CONVERSION-ERROR
  8707           MOVE ER-0348            TO EMI-ERROR
  8708           MOVE -1                  TO BEFFDTL
  8709           MOVE AL-UABON            TO BEFFDTA
  8710           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8711           GO TO 8200-SEND-DATAONLY
  8712        ELSE
  8713           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8714           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8715           IF PI-COMPANY-ID = 'DMD'
  8716               MOVE XCTL-EL401DMD      TO PGM-NAME
  8717             ELSE
  8718               MOVE XCTL-EL1279        TO PGM-NAME
  8719           END-IF
  8720           GO TO 9300-XCTL.
  8721
  8722     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8723        MOVE XCTL-EL6312         TO PGM-NAME
  8724
  8725* EXEC CICS XCTL
  8726*           PROGRAM   (PGM-NAME)
  8727*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8728*           LENGTH    (WS-COMM-LENGTH)
  8729*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 160
* EL6311.cbl
  8730*    MOVE '.$C                   %   #00008695' TO DFHEIV0
  8731     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8732     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8733     MOVE X'2020233030303038363935' TO DFHEIV0(25:11)
  8734     CALL 'kxdfhei1' USING DFHEIV0,
  8735           PGM-NAME,
  8736           PROGRAM-INTERFACE-BLOCK,
  8737           WS-COMM-LENGTH,
  8738           DFHEIV99
  8739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8740     ELSE
  8741        MOVE '0'                 TO  PI-EDIT-SW.
  8742
  8743     IF  EIBAID = DFHPF10
  8744         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8745         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8746         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8747                                    PI-1042-WA
  8748         MOVE 4                  TO PI-689-DATA-SOURCE
  8749         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8750         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8751         MOVE PI-SV-STATE        TO PI-689-STATE
  8752         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8753         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8754         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8755         MOVE PI-PB-ALT-CHG-SEQ-NO
  8756                                 TO PI-689-ALT-SEQ-NO
  8757         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8758         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8759         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8760         MOVE +0                 TO PI-689-CONTROL
  8761         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8762                                    PI-689-EXP-DATE
  8763                                    PI-689-RESP-PERSON
  8764                                    PI-689-TYPE
  8765                                    PI-689-FOLLOW-UP-EDIT
  8766                                    PI-689-RESEND1-EDIT
  8767                                    PI-689-SEQ-EDIT
  8768                                    PI-689-BCSEQ-EDIT
  8769                                    PI-689-LBL-OVERRIDE
  8770         MOVE W-LETTER-COMMUNICATION-AREAS
  8771                                 TO PI-PROGRAM-WORK-AREA
  8772         MOVE XCTL-EL689         TO PGM-NAME
  8773         GO TO 9300-XCTL.
  8774
  8775     IF  EIBAID = DFHPF16
  8776         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8777         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8778         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8779                                    PI-1042-WA
  8780         MOVE 4                  TO PI-689-DATA-SOURCE
  8781         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8782         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8783         MOVE PI-SV-STATE        TO PI-689-STATE
  8784         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8785         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8786         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8787         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 161
* EL6311.cbl
  8788                                 TO PI-689-ALT-SEQ-NO
  8789         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8790         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8791         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8792         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8793         MOVE W-LETTER-COMMUNICATION-AREAS
  8794                                 TO PI-PROGRAM-WORK-AREA
  8795         MOVE XCTL-EL690         TO PGM-NAME
  8796         GO TO 9300-XCTL.
  8797
  8798     IF EIBAID = DFHPF13
  8799         MOVE XCTL-EL6313        TO PGM-NAME
  8800         GO TO 9300-XCTL.
  8801
  8802     IF EIBAID = DFHPF17
  8803        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8804        IF (PB-I-LOAN-APR numeric)
  8805           and (pb-i-loan-apr < 99.9999)
  8806           AND (PB-I-BENEFICIARY-NAME NOT
  8807              = SPACES AND LOW-VALUES)
  8808
  8809           MOVE LINK-ELVADS          TO PGM-NAME
  8810
  8811* EXEC CICS LINK
  8812*              PROGRAM    (PGM-NAME)
  8813*              COMMAREA   (WS-PASS-AREA)
  8814*              LENGTH     (WS-PASS-AREA-LENGTH)
  8815*          END-EXEC
  8816*    MOVE '."C                   (   #00008770' TO DFHEIV0
  8817     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8819     MOVE X'2020233030303038373730' TO DFHEIV0(25:11)
  8820     CALL 'kxdfhei1' USING DFHEIV0,
  8821           PGM-NAME,
  8822           WS-PASS-AREA,
  8823           WS-PASS-AREA-LENGTH,
  8824           DFHEIV99,
  8825           DFHEIV99,
  8826           DFHEIV99,
  8827           DFHEIV99
  8828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8829
  8830           MOVE 0000             TO EMI-ERROR
  8831           MOVE -1               TO BMAINTL
  8832           PERFORM 9900-ERROR-FORMAT
  8833                                 THRU 9900-EXIT
  8834           GO TO 8200-SEND-DATAONLY
  8835        ELSE
  8836           MOVE ER-0877            TO EMI-ERROR
  8837           MOVE -1                  TO BEFFDTL
  8838           MOVE AL-UABON            TO BEFFDTA
  8839           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8840           GO TO 8200-SEND-DATAONLY
  8841        END-IF
  8842     END-IF
  8843     IF EIBAID = DFHPF14
  8844        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8845        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 162
* EL6311.cbl
  8846        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8847        MOVE PI-SV-STATE            TO PI-CR-STATE
  8848        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8849        MOVE SPACE                  TO PI-EDIT-SW
  8850        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8851        MOVE XCTL-EL650             TO PGM-NAME
  8852        GO TO 9300-XCTL.
  8853
  8854     IF EIBAID = DFHPF15
  8855        IF PI-COMPANY-ID  =  'HER'
  8856            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8857            MOVE XCTL-EL680         TO PGM-NAME
  8858            GO TO 9300-XCTL.
  8859
  8860     IF EIBAID = DFHENTER OR DFHPF11
  8861        GO TO 1000-ISSUE-MAINLINE.
  8862
  8863     MOVE ER-0029                TO EMI-ERROR
  8864     MOVE -1                     TO BPFENTRL
  8865     MOVE AL-UNBON               TO BPFENTRA
  8866     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8867     GO TO 8200-SEND-DATAONLY.
  8868
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 163
* EL6311.cbl
  8870
  8871******************************************************************
  8872*                                                                *
  8873*      CANCEL SCREEN PF KEY CHECKING                             *
  8874*                                                                *
  8875******************************************************************
  8876
  8877******************************************************************
  8878*                                                                *
  8879*      PF KEY FUNCTIONS:                                         *
  8880*                                                                *
  8881*      PF1  = BROWSE FORWARD                                     *
  8882*      PF2  = BROWSE BACKWARD                                    *
  8883*      PF3  = CERTIFICATE LOOKUP                                 *
  8884*      PF4  = DISPLAY BATCH HEADER                               *
  8885*      PF5  = ADD ISSUE SCREEN                                   *
  8886*      PF6  = ADD CANCEL SCREEN                                  *
  8887*      PF7  = CERTIFICATE DISPLAY                                *
  8888*      PF8  = CERTIFICATE NOTES                                  *
  8889*      PF9  = EDIT CONTROL                                       *
  8890*      PF10 = DISPLAY LETTER SCREEN                              *
  8891*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8892*      PF12 = DISPLAY HELP SCREEN                                *
  8893*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8894*      PF14 = ACCOUNT MASTER                                     *
  8895*      PF16 = LETTER REVIEW                                      *
  8896*                                                                *
  8897******************************************************************
  8898
  8899 0400-CHECK-CANCEL-PF-KEYS.
  8900     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8901        MOVE ER-2337             TO EMI-ERROR
  8902        MOVE -1                  TO CMAINTL
  8903        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8904        GO TO 8200-SEND-DATAONLY.
  8905
  8906     IF EIBAID = DFHPF1
  8907        MOVE '0'                TO PI-EDIT-SW
  8908        IF PI-PRIMARY-BROWSE
  8909           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8910        ELSE
  8911           IF PI-PRIMARY-WITH-SELECT
  8912              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8913           ELSE
  8914              IF PI-FILE-BROWSE
  8915                 GO TO 4300-BROWSE-FILE-FORWARD
  8916              ELSE
  8917                 IF PI-CSR-BROWSE
  8918                    GO TO 4200-BROWSE-CSR-FORWARD
  8919                 ELSE
  8920                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8921
  8922     IF EIBAID = DFHPF2
  8923        MOVE '0'                TO PI-EDIT-SW
  8924        IF PI-PRIMARY-BROWSE
  8925           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8926        ELSE
  8927           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 164
* EL6311.cbl
  8928              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8929           ELSE
  8930              IF PI-FILE-BROWSE
  8931                 GO TO 4800-BROWSE-FILE-BACKWARD
  8932              ELSE
  8933                 IF PI-CSR-BROWSE
  8934                    GO TO 4900-BROWSE-CSR-BACKWARD
  8935                 ELSE
  8936                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8937
  8938     IF EIBAID = DFHPF3
  8939        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8940        MOVE XCTL-EL127         TO PGM-NAME
  8941        GO TO 9300-XCTL.
  8942
  8943     IF (EIBAID = DFHPF15 OR DFHPF17)
  8944        AND (CSR-EDIT-SESSION)
  8945*       AND (FATAL-OR-UNFORCED)
  8946        AND (FATAL-ERRORS)
  8947        MOVE ER-1819             TO EMI-ERROR
  8948        MOVE -1                  TO CMAINTL
  8949        MOVE AL-UANON            TO CMAINTA
  8950        PERFORM 9900-ERROR-FORMAT
  8951                                 THRU 9900-EXIT
  8952        GO TO 8200-SEND-DATAONLY
  8953     END-IF
  8954     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8955       AND (CSR-EDIT-SESSION)
  8956        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8957        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8958        IF (RESP-NORMAL)
  8959           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8960              AM-CONTROL-PRIMARY (1:20))
  8961            IF AM-NAME NOT GREATER THAN SPACES OR
  8962               AM-ADDRS NOT GREATER THAN SPACES  OR
  8963               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8964               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8965               AM-ZIP NOT GREATER THAN SPACES
  8966               MOVE ER-3834             TO EMI-ERROR
  8967               MOVE -1                  TO BMAINTL
  8968               MOVE AL-UANON            TO BMAINTA
  8969               PERFORM 9900-ERROR-FORMAT
  8970                                 THRU 9900-EXIT
  8971               GO TO 8200-SEND-DATAONLY
  8972            END-IF
  8973        ELSE
  8974           MOVE ER-1609             TO EMI-ERROR
  8975           MOVE -1                  TO BMAINTL
  8976           MOVE AL-UANON            TO BMAINTA
  8977           PERFORM 9900-ERROR-FORMAT
  8978                                THRU 9900-EXIT
  8979           GO TO 8200-SEND-DATAONLY
  8980        END-IF
  8981
  8982        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8983        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8984        IF (ERMAIL-FOUND)
  8985            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 165
* EL6311.cbl
  8986               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8987               MA-CITY NOT GREATER THAN SPACES OR
  8988               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8989               MA-ZIP-CODE NOT GREATER THAN SPACES
  8990               MOVE ER-3835             TO EMI-ERROR
  8991               MOVE -1                  TO BMAINTL
  8992               MOVE AL-UANON            TO BMAINTA
  8993               PERFORM 9900-ERROR-FORMAT
  8994                                 THRU 9900-EXIT
  8995               GO TO 8200-SEND-DATAONLY
  8996            END-IF
  8997        ELSE
  8998           MOVE ER-3000             TO EMI-ERROR
  8999           MOVE -1                  TO BMAINTL
  9000           MOVE AL-UANON            TO BMAINTA
  9001           PERFORM 9900-ERROR-FORMAT
  9002                                THRU 9900-EXIT
  9003           GO TO 8200-SEND-DATAONLY
  9004        END-IF
  9005
  9006     END-IF
  9007     IF (EIBAID = DFHPF15 OR DFHPF17)
  9008        AND (CSR-EDIT-SESSION)
  9009        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9010        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9011        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9012        MOVE PI-SV-STATE         TO PI-STATE
  9013        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9014        MOVE CCERTNOI            TO PI-CERT-PRIME
  9015        MOVE CSUFIXI             TO PI-CERT-SFX
  9016        MOVE CEFFDTI             TO DEEDIT-FIELD
  9017        PERFORM 8600-DEEDIT
  9018        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9019        MOVE '4'                 TO DC-OPTION-CODE
  9020        PERFORM 9700-DATE-LINK
  9021        IF DATE-CONVERSION-ERROR
  9022           MOVE ER-0348          TO EMI-ERROR
  9023           MOVE -1               TO CEFFDTL
  9024           MOVE AL-UABON         TO CEFFDTA
  9025           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9026           GO TO 8200-SEND-DATAONLY
  9027        ELSE
  9028           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9029           PERFORM 6000-CREATE-TEMP-STORAGE
  9030                                 THRU 6000-EXIT
  9031           IF EIBAID = DFHPF17
  9032               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9033                                  THRU 6400-EXIT
  9034               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9035                                 '2' AND '3' AND '4'
  9036                  MOVE ER-3831     TO  EMI-ERROR
  9037                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9038                  GO TO 8200-SEND-DATAONLY
  9039               END-IF
  9040               MOVE 'Y'          TO PI-CLM-RESC-IND
  9041           ELSE
  9042               MOVE 'N'          TO PI-CLM-RESC-IND
  9043           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 166
* EL6311.cbl
  9044           MOVE XCTL-EL6316      TO PGM-NAME
  9045           MOVE '2'              TO PI-ISS-CAN-SW
  9046           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9047           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9048           GO TO 9300-XCTL
  9049        END-IF
  9050     END-IF
  9051
  9052     IF EIBAID = DFHPF4
  9053        MOVE '0'                TO PI-EDIT-SW
  9054        IF PI-DISPLAY-ORIGINAL-BATCH
  9055           NEXT SENTENCE
  9056        ELSE
  9057           GO TO 7200-DISPLAY-BATCHES.
  9058
  9059     IF EIBAID = DFHPF5
  9060        MOVE ER-0029                TO EMI-ERROR
  9061        MOVE -1                     TO BPFENTRL
  9062        MOVE AL-UNBON               TO BPFENTRA
  9063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9064        GO TO 8200-SEND-DATAONLY.
  9065*        MOVE '0'                TO PI-EDIT-SW
  9066*        IF PI-DISPLAY-ORIGINAL-BATCH
  9067*           NEXT SENTENCE
  9068*        ELSE
  9069*           MOVE EL631B              TO PI-MAP-NAME
  9070*           MOVE LOW-VALUES          TO EL631BI
  9071*           MOVE 'A'                 TO BMAINTO
  9072*           MOVE AL-UANON            TO BMAINTA
  9073*           MOVE -1                  TO BMAINTL
  9074*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9075*           GO TO 8100-SEND-INITIAL-MAP.
  9076
  9077     IF EIBAID = DFHPF6
  9078        MOVE ER-0029                TO EMI-ERROR
  9079        MOVE -1                     TO BPFENTRL
  9080        MOVE AL-UNBON               TO BPFENTRA
  9081        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9082        GO TO 8200-SEND-DATAONLY.
  9083*        MOVE '0'                TO PI-EDIT-SW
  9084*        IF PI-DISPLAY-ORIGINAL-BATCH
  9085*           NEXT SENTENCE
  9086*        ELSE
  9087*           MOVE EL631C              TO PI-MAP-NAME
  9088*           MOVE LOW-VALUES          TO EL631CI
  9089*           MOVE 'A'                 TO CMAINTO
  9090*           MOVE AL-UANON            TO CMAINTA
  9091*           MOVE -1                  TO CMAINTL
  9092*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9093*           GO TO 8100-SEND-INITIAL-MAP.
  9094
  9095     IF EIBAID = DFHPF7
  9096        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9097        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9098        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9099        MOVE PI-SV-STATE            TO PI-STATE
  9100        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9101        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 167
* EL6311.cbl
  9102        MOVE CSUFIXI                TO PI-CERT-SFX
  9103        MOVE CEFFDTI                TO DEEDIT-FIELD
  9104        PERFORM 8600-DEEDIT
  9105        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9106        MOVE '4'                    TO DC-OPTION-CODE
  9107        PERFORM 9700-DATE-LINK
  9108        IF DATE-CONVERSION-ERROR
  9109           MOVE ER-0348            TO EMI-ERROR
  9110           MOVE -1                  TO BEFFDTL
  9111           MOVE AL-UABON            TO BEFFDTA
  9112           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9113           GO TO 8200-SEND-DATAONLY
  9114        ELSE
  9115           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9116           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9117           MOVE XCTL-EL1273        TO PGM-NAME
  9118           GO TO 9300-XCTL.
  9119
  9120     IF EIBAID = DFHPF8
  9121        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9122        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9123        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9124        MOVE PI-SV-STATE            TO PI-STATE
  9125        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9126        MOVE CCERTNOI               TO PI-CERT-PRIME
  9127        MOVE CSUFIXI                TO PI-CERT-SFX
  9128        MOVE CEFFDTI                TO DEEDIT-FIELD
  9129        PERFORM 8600-DEEDIT
  9130        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9131        MOVE '4'                    TO DC-OPTION-CODE
  9132        PERFORM 9700-DATE-LINK
  9133        IF DATE-CONVERSION-ERROR
  9134           MOVE ER-0348             TO EMI-ERROR
  9135           MOVE -1                  TO BEFFDTL
  9136           MOVE AL-UABON            TO BEFFDTA
  9137           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9138           GO TO 8200-SEND-DATAONLY
  9139        ELSE
  9140           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9141           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9142           IF PI-COMPANY-ID = 'DMD'
  9143               MOVE XCTL-EL401DMD      TO PGM-NAME
  9144             ELSE
  9145               MOVE XCTL-EL1279        TO PGM-NAME
  9146           END-IF
  9147           GO TO 9300-XCTL.
  9148
  9149     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9150        MOVE XCTL-EL6312     TO PGM-NAME
  9151
  9152* EXEC CICS XCTL
  9153*           PROGRAM  (PGM-NAME)
  9154*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9155*           LENGTH   (WS-COMM-LENGTH)
  9156*       END-EXEC
  9157*    MOVE '.$C                   %   #00009097' TO DFHEIV0
  9158     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9159     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 168
* EL6311.cbl
  9160     MOVE X'2020233030303039303937' TO DFHEIV0(25:11)
  9161     CALL 'kxdfhei1' USING DFHEIV0,
  9162           PGM-NAME,
  9163           PROGRAM-INTERFACE-BLOCK,
  9164           WS-COMM-LENGTH,
  9165           DFHEIV99
  9166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9167     ELSE
  9168        MOVE '0'                 TO  PI-EDIT-SW.
  9169
  9170     IF EIBAID = DFHPF10
  9171         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9172         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9173         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9174         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9175                                    PI-1042-WA
  9176         MOVE 4                  TO PI-689-DATA-SOURCE
  9177         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9178         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9179         MOVE PI-SV-STATE        TO PI-689-STATE
  9180         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9181         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9182         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9183         MOVE PI-PB-ALT-CHG-SEQ-NO
  9184                                 TO PI-689-ALT-SEQ-NO
  9185         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9186         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9187         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9188         MOVE +0                 TO PI-689-CONTROL
  9189         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9190                                    PI-689-EXP-DATE
  9191                                    PI-689-RESP-PERSON
  9192                                    PI-689-TYPE
  9193                                    PI-689-FOLLOW-UP-EDIT
  9194                                    PI-689-RESEND1-EDIT
  9195                                    PI-689-SEQ-EDIT
  9196                                    PI-689-BCSEQ-EDIT
  9197                                    PI-689-LBL-OVERRIDE
  9198         MOVE W-LETTER-COMMUNICATION-AREAS
  9199                                 TO PI-PROGRAM-WORK-AREA
  9200         MOVE XCTL-EL689         TO PGM-NAME
  9201         GO TO 9300-XCTL.
  9202
  9203     IF  EIBAID = DFHPF16
  9204         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9205         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9206         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9207                                    PI-1042-WA
  9208         MOVE 4                  TO PI-689-DATA-SOURCE
  9209         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9210         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9211         MOVE PI-SV-STATE        TO PI-689-STATE
  9212         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9213         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9214         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9215         MOVE PI-PB-ALT-CHG-SEQ-NO
  9216                                 TO PI-689-ALT-SEQ-NO
  9217         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 169
* EL6311.cbl
  9218         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9219         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9220         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9221         MOVE W-LETTER-COMMUNICATION-AREAS
  9222                                 TO PI-PROGRAM-WORK-AREA
  9223         MOVE XCTL-EL690         TO PGM-NAME
  9224         GO TO 9300-XCTL.
  9225     IF (EIBAID = DFHPF13)
  9226        if (not fatal-errors)
  9227           and (not unforced-errors)
  9228           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9229           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9230           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9231           MOVE PI-SV-STATE      TO PI-STATE
  9232           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9233           MOVE CCERTNOI         TO PI-CERT-PRIME
  9234           MOVE CSUFIXI          TO PI-CERT-SFX
  9235           MOVE CEFFDTI          TO DEEDIT-FIELD
  9236           PERFORM 8600-DEEDIT
  9237           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9238           MOVE '4'              TO DC-OPTION-CODE
  9239           PERFORM 9700-DATE-LINK
  9240           IF DATE-CONVERSION-ERROR
  9241              MOVE ER-0348       TO EMI-ERROR
  9242              MOVE -1            TO CEFFDTL
  9243              MOVE AL-UABON      TO CEFFDTA
  9244              PERFORM 9900-ERROR-FORMAT
  9245                                 THRU 9900-EXIT
  9246              GO TO 8200-SEND-DATAONLY
  9247           ELSE
  9248              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9249              MOVE AL-UANON      TO CEFFDTA
  9250              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9251              PERFORM 6000-CREATE-TEMP-STORAGE
  9252                                 THRU 6000-EXIT
  9253              MOVE XCTL-EL677    TO PGM-NAME
  9254              GO TO 9300-XCTL
  9255           end-if
  9256        else
  9257           MOVE ER-3444          TO EMI-ERROR
  9258           MOVE -1               TO CPFENTRL
  9259           MOVE AL-UNBON         TO CPFENTRA
  9260           PERFORM 9900-ERROR-FORMAT
  9261                                 THRU 9900-EXIT
  9262           GO TO 8200-SEND-DATAONLY
  9263        end-if
  9264     end-if
  9265
  9266     IF EIBAID = DFHPF14
  9267        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9268        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9269        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9270        MOVE PI-SV-STATE            TO PI-CR-STATE
  9271        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9272        MOVE SPACE                  TO PI-EDIT-SW
  9273        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9274        MOVE XCTL-EL650             TO PGM-NAME
  9275        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 170
* EL6311.cbl
  9276
  9277     IF EIBAID = DFHENTER OR DFHPF11
  9278        GO TO 2000-CANCEL-MAINLINE.
  9279
  9280     MOVE ER-0029                TO EMI-ERROR.
  9281     MOVE -1                     TO CPFENTRL.
  9282     MOVE AL-UNBON               TO CPFENTRA.
  9283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9284     GO TO 8200-SEND-DATAONLY.
  9285
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 171
* EL6311.cbl
  9287
  9288******************************************************************
  9289*                                                                *
  9290*      BATCH SCREEN PF KEY CHECKING                              *
  9291*                                                                *
  9292******************************************************************
  9293
  9294******************************************************************
  9295*                                                                *
  9296*      PF KEY FUNCTIONS:                                         *
  9297*                                                                *
  9298*      PF1 = BROWSE FORWARD                                      *
  9299*      PF2 = BROWSE BACKWARD                                     *
  9300*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9301*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9302*                                                                *
  9303*                                                                *
  9304******************************************************************
  9305
  9306 0500-CHECK-BATCH-PF-KEYS.
  9307     IF EIBAID = DFHPF1
  9308        MOVE '0'                TO PI-EDIT-SW
  9309        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9310           GO TO 5000-BROWSE-BATCH-HEADERS
  9311        ELSE
  9312           IF PI-GOOD-BROWSE
  9313              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9314                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9315              ELSE
  9316                 IF PI-FILE-BROWSE
  9317                    GO TO 4300-BROWSE-FILE-FORWARD
  9318                 ELSE
  9319                    IF PI-CSR-BROWSE
  9320                       GO TO 4200-BROWSE-CSR-FORWARD
  9321                    ELSE
  9322                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9323           ELSE
  9324              GO TO 0800-BROWSE-ERROR.
  9325
  9326     IF EIBAID = DFHPF2
  9327        MOVE '0'                TO PI-EDIT-SW
  9328        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9329           GO TO 5500-BROWSE-BATCH-BACKWARD
  9330        ELSE
  9331           IF PI-GOOD-BROWSE
  9332              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9333                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9334              ELSE
  9335                 IF PI-FILE-BROWSE
  9336                    GO TO 4800-BROWSE-FILE-BACKWARD
  9337                 ELSE
  9338                    IF PI-CSR-BROWSE
  9339                       GO TO 4900-BROWSE-CSR-BACKWARD
  9340                    ELSE
  9341                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9342           ELSE
  9343              GO TO 0800-BROWSE-ERROR.
  9344
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 172
* EL6311.cbl
  9345     IF EIBAID = DFHPF3
  9346        GO TO 3000-BATCH-MAINLINE.
  9347
  9348     IF  EIBAID = DFHPF4
  9349        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9350        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9351        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9352        MOVE PI-SV-STATE            TO PI-CR-STATE
  9353        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9354                                       PI-CR-FIN-RESP
  9355        MOVE 'A'                    TO PI-CR-TYPE
  9356        MOVE SPACE                  TO PI-EDIT-SW
  9357        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9358        MOVE XCTL-EL640             TO PGM-NAME
  9359        GO TO 9300-XCTL.
  9360
  9361     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9362       AND
  9363        (EIBAID = DFHENTER)
  9364           GO TO 3500-EDIT-BATCH-DATA.
  9365
  9366     IF EIBAID = DFHENTER
  9367        GO TO 3500-EDIT-BATCH-DATA.
  9368
  9369     MOVE ER-0029             TO EMI-ERROR.
  9370     MOVE -1                  TO DPFENTRL.
  9371     MOVE AL-UNBON            TO DPFENTRA.
  9372     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9373     GO TO 8200-SEND-DATAONLY.
  9374
  9375 0800-BROWSE-ERROR.
  9376     MOVE ER-2258                TO EMI-ERROR.
  9377     MOVE -1                     TO DPFENTRL.
  9378     MOVE AL-UNBON               TO DPFENTRA.
  9379     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9380     GO TO 8200-SEND-DATAONLY.
  9381
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 173
* EL6311.cbl
  9383
  9384******************************************************************
  9385*                                                                *
  9386*                I S S U E   M A I N L I N E                     *
  9387*                                                                *
  9388******************************************************************
  9389
  9390 1000-ISSUE-MAINLINE.
  9391     IF PI-DISPLAY-ORIGINAL-BATCH
  9392        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9393           MOVE ER-0023             TO EMI-ERROR
  9394           MOVE -1                  TO BMAINTL
  9395           MOVE AL-UABON            TO BMAINTA
  9396           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9397           GO TO 8200-SEND-DATAONLY
  9398        ELSE
  9399           NEXT SENTENCE
  9400     ELSE
  9401        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9402           MOVE ER-0023             TO EMI-ERROR
  9403           MOVE -1                  TO BMAINTL
  9404           MOVE AL-UABON            TO BMAINTA
  9405           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9406           GO TO 8200-SEND-DATAONLY.
  9407
  9408     IF BMAINTI = 'S'
  9409        GO TO 1100-SHOW-REQUEST.
  9410
  9411     IF NOT MODIFY-CAP
  9412         MOVE 'UPDATE'       TO SM-READ
  9413         PERFORM 9995-SECURITY-VIOLATION
  9414         MOVE ER-0070        TO EMI-ERROR
  9415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9416         GO TO 8100-SEND-INITIAL-MAP.
  9417
  9418     IF BMAINTL GREATER THAN ZEROS
  9419        IF PI-PF5-FUNCTION
  9420           IF BMAINTI NOT = 'A'
  9421              MOVE AL-UABON  TO BMAINTA
  9422              MOVE -1        TO BMAINTL
  9423              MOVE ER-2260   TO EMI-ERROR
  9424              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9425              GO TO 8200-SEND-DATAONLY.
  9426
  9427     IF BCERTNOL = ZEROS
  9428       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9429         NEXT SENTENCE
  9430     ELSE
  9431         IF BCERTNOL NOT = ZEROS
  9432             MOVE AL-UANON       TO BCERTNOA
  9433         ELSE
  9434             MOVE -1             TO BCERTNOL
  9435             MOVE  1             TO SET-CURSOR-SW
  9436             MOVE ER-2218        TO EMI-ERROR
  9437             MOVE AL-UABON       TO BCERTNOA
  9438             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9439
  9440     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 174
* EL6311.cbl
  9441         MOVE AL-UANON       TO BSUFIXA
  9442     ELSE
  9443         MOVE AL-SANOF       TO BSUFIXA.
  9444
  9445     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9446        NEXT SENTENCE
  9447     ELSE
  9448        IF BEFFDTL NOT = ZEROS
  9449           MOVE AL-UNNON             TO BEFFDTA
  9450           MOVE BEFFDTI              TO DEEDIT-FIELD
  9451           PERFORM 8600-DEEDIT
  9452           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9453           MOVE 4                    TO DC-OPTION-CODE
  9454           PERFORM 9700-DATE-LINK
  9455           IF NO-CONVERSION-ERROR
  9456              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9457              ELSE
  9458              MOVE -1                TO BEFFDTL
  9459              MOVE  1                TO SET-CURSOR-SW
  9460              MOVE ER-2226           TO EMI-ERROR
  9461              MOVE AL-UNBON          TO BEFFDTA
  9462              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9463           ELSE
  9464              MOVE -1                TO BEFFDTL
  9465              MOVE  1                TO SET-CURSOR-SW
  9466              MOVE ER-2220           TO EMI-ERROR
  9467              MOVE AL-UNBON          TO BEFFDTA
  9468              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9469
  9470     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9471
  9472     IF BCERTNOL NOT = ZEROS
  9473        MOVE BCERTNOI                TO WS-NEW-PRIME
  9474     ELSE
  9475        MOVE SPACES                  TO WS-NEW-PRIME.
  9476
  9477     IF BSUFIXL NOT = ZEROS
  9478        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9479     ELSE
  9480        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9481
  9482     IF BEFFDTL NOT = ZEROS
  9483        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9484     ELSE
  9485        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9486
  9487     IF BMAINTI = 'A' OR 'K' OR 'S'
  9488        NEXT SENTENCE
  9489     ELSE
  9490        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9491        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9492           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9493           WS-PB-RECORD-TYPE NOT = '1'
  9494           IF BMAINTI = 'C'
  9495               MOVE ER-2287          TO EMI-ERROR
  9496               MOVE -1               TO BCERTNOL
  9497               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9498               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 175
* EL6311.cbl
  9499               GO TO 8200-SEND-DATAONLY
  9500             ELSE
  9501               MOVE ER-2260          TO EMI-ERROR
  9502               MOVE -1               TO BCERTNOL
  9503               MOVE AL-UABON         TO BCERTNOA
  9504               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9505               GO TO 8200-SEND-DATAONLY.
  9506
  9507     IF BMAINTI = 'D'
  9508         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9509
  9510*    IF BMICRNOL  NOT =  ZEROS
  9511*        IF BMICRNOI  NUMERIC
  9512*            MOVE AL-UNNON       TO  BMICRNOA
  9513*        ELSE
  9514*            MOVE -1             TO  BMICRNOL
  9515*            MOVE 1              TO  SET-CURSOR-SW
  9516*            MOVE AL-UNBON       TO  BMICRNOA
  9517*            MOVE ER-2701        TO  EMI-ERROR
  9518*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9519     IF BVINL NOT = ZEROS
  9520        MOVE AL-UANON            TO BVINA
  9521     END-IF
  9522     IF B1STNML NOT = ZEROS
  9523         MOVE AL-UANON                TO B1STNMA.
  9524
  9525     IF BINITL  NOT = ZEROS
  9526        MOVE AL-UANON                TO BINITA.
  9527
  9528     IF BSEXL NOT = ZEROS
  9529        IF BSEXI = 'M' OR 'F'
  9530           MOVE AL-UANON             TO BSEXA
  9531        ELSE
  9532           MOVE -1               TO BSEXL
  9533           MOVE ER-2629          TO EMI-ERROR
  9534           MOVE AL-UABON         TO BSEXA
  9535           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9536
  9537     IF BAGEL NOT = ZEROS
  9538         IF BAGEI NUMERIC
  9539             MOVE BAGEI              TO WS-BAGE
  9540             MOVE AL-UNNON           TO BAGEA
  9541         ELSE
  9542             MOVE -1                 TO BAGEL
  9543             MOVE  1                 TO SET-CURSOR-SW
  9544             MOVE ER-2223            TO EMI-ERROR
  9545             MOVE AL-UNBON           TO BAGEA
  9546             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9547
  9548     IF BLSTNML NOT = ZERO  OR
  9549        B1STNML NOT = ZERO  OR
  9550        BINITL NOT = ZERO
  9551         IF BAGEL = ZEROS
  9552             MOVE -1                 TO BAGEL
  9553             MOVE  1                 TO SET-CURSOR-SW
  9554             MOVE ER-3269            TO EMI-ERROR
  9555             MOVE AL-UNBON           TO BAGEA
  9556             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 176
* EL6311.cbl
  9557         END-IF
  9558     END-IF.
  9559
  9560     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9561
  9562     IF (BBIRTHL GREATER THAN +0) AND
  9563        (BBIRTHI NOT EQUAL SPACES)
  9564        NEXT SENTENCE
  9565     ELSE
  9566        GO TO 1010-CHECK-AGE.
  9567
  9568     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9569     PERFORM 8600-DEEDIT.
  9570     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9571     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9572     MOVE AL-UNNON               TO BBIRTHA.
  9573     MOVE '4'                    TO DC-OPTION-CODE.
  9574     PERFORM 9700-DATE-LINK.
  9575     IF DATE-CONVERSION-ERROR
  9576        MOVE -1                  TO BBIRTHL
  9577        MOVE  1                  TO SET-CURSOR-SW
  9578        MOVE ER-2228             TO EMI-ERROR
  9579        MOVE AL-UNBON            TO BBIRTHA
  9580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9581        GO TO 1010-CHECK-AGE.
  9582
  9583     IF (NO-CONVERSION-ERROR) AND
  9584        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9585        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9586        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9587        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9588                                    WS-CONVERTED-BIRTH
  9589        MOVE AL-UANON            TO BBIRTHA
  9590     ELSE
  9591        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9592        MOVE AL-UANON            TO BBIRTHA.
  9593
  9594 1010-CHECK-AGE.
  9595
  9596*    IF BAGEL = ZERO
  9597*       IF BBIRTHL GREATER THAN ZERO
  9598*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9599
  9600     IF B1STPMTL NOT = ZEROS
  9601        IF B1STPMTI = SPACES
  9602           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9603        ELSE
  9604           MOVE B1STPMTI             TO DEEDIT-FIELD
  9605           PERFORM 8600-DEEDIT
  9606           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9607           MOVE AL-UNNON             TO B1STPMTA
  9608           MOVE 4                    TO DC-OPTION-CODE
  9609           PERFORM 9700-DATE-LINK
  9610           IF NO-CONVERSION-ERROR
  9611              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9612              MOVE AL-UANON          TO B1STPMTA
  9613           ELSE
  9614              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 177
* EL6311.cbl
  9615              MOVE  1                TO SET-CURSOR-SW
  9616              MOVE ER-2200           TO EMI-ERROR
  9617              MOVE AL-UNBON          TO B1STPMTA
  9618              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9619
  9620     IF BDAYSL NOT = ZEROS
  9621         IF BDAYSI NUMERIC
  9622             MOVE AL-UNNON           TO BDAYSA
  9623         ELSE
  9624             MOVE -1                 TO BDAYSL
  9625             MOVE ER-2530            TO EMI-ERROR
  9626             MOVE AL-UNBON           TO BDAYSA
  9627             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9628
  9629     IF BLNTRML NOT = ZEROS
  9630         IF BLNTRMI NUMERIC
  9631             MOVE AL-UNNON       TO BLNTRMA
  9632         ELSE
  9633             MOVE -1             TO BLNTRML
  9634             MOVE ER-2533        TO EMI-ERROR
  9635             MOVE AL-UNBON       TO BLNTRMA
  9636             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9637
  9638**   IF PI-COMPANY-ID = 'DMD'
  9639     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9640        NEXT SENTENCE
  9641     ELSE
  9642         IF BLNOFCRL NOT = ZEROS
  9643            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9644            IF LOAN-OFFICER-FOUND
  9645                MOVE AL-UANON        TO BLNOFCRA
  9646             ELSE
  9647                 MOVE SPACE          TO WS-LOAN-OFFICER
  9648                 MOVE -1             TO BLNOFCRL
  9649                 MOVE  1             TO SET-CURSOR-SW
  9650                 MOVE ER-3006        TO EMI-ERROR
  9651                 MOVE AL-UNBON       TO BLNOFCRA
  9652                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9653
  9654     IF BFREQL NOT = ZEROS
  9655         IF BFREQI NUMERIC
  9656             MOVE AL-UNNON       TO BFREQA
  9657         ELSE
  9658             MOVE -1             TO BFREQL
  9659             MOVE  1             TO SET-CURSOR-SW
  9660             MOVE ER-2223        TO EMI-ERROR
  9661             MOVE AL-UNBON       TO BFREQA
  9662             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9663
  9664     IF BMODEL NOT = ZEROS
  9665         MOVE BMODEI             TO WS-MODE-CODE
  9666                                    PI-BMODE
  9667         IF WS-MODE-CODE-VALID
  9668             MOVE AL-UANON       TO BMODEA
  9669         ELSE
  9670             MOVE -1             TO BMODEL
  9671             MOVE ER-2591        TO EMI-ERROR
  9672             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 178
* EL6311.cbl
  9673             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9674
  9675     IF BPMTSL NOT = ZEROS
  9676         IF BPMTSI NUMERIC
  9677             MOVE AL-UNNON           TO BPMTSA
  9678             MOVE BPMTSI             TO PI-BPMTS
  9679         ELSE
  9680             MOVE -1                 TO BPMTSL
  9681             MOVE ER-2592            TO EMI-ERROR
  9682             MOVE AL-UNBON           TO BPMTSA
  9683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9684
  9685     IF BPMTAMTL NOT = ZEROS
  9686
  9687* EXEC CICS BIF DEEDIT
  9688*            FIELD  (BPMTAMTI)
  9689*            LENGTH (9)
  9690*       END-EXEC
  9691     MOVE 9
  9692       TO DFHEIV11
  9693*    MOVE '@"L                   #   #00009621' TO DFHEIV0
  9694     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9695     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9696     MOVE X'2020233030303039363231' TO DFHEIV0(25:11)
  9697     CALL 'kxdfhei1' USING DFHEIV0,
  9698           BPMTAMTI,
  9699           DFHEIV11
  9700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9701        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9702*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9703*        PERFORM 8600-DEEDIT
  9704*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9705
  9706*    IF BAPRL NOT = ZEROS
  9707*        EXEC CICS BIF DEEDIT
  9708*            FIELD  (BAPRI)
  9709*            LENGTH (7)
  9710*        END-EXEC
  9711*        MOVE BAPRI              TO WS-BAPR.
  9712
  9713     IF BAPRL > 0
  9714        MOVE +0                  TO  WS-BAPR
  9715        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9716           (WS-SUB > 7)
  9717           OR (BAPRI (WS-SUB:1) NUMERIC)
  9718           OR (BAPRI (WS-SUB:1) = '.')
  9719        END-PERFORM
  9720        IF WS-SUB > 7
  9721           MOVE ER-2471       TO EMI-ERROR
  9722           MOVE -1            TO BAPRL
  9723           MOVE AL-UNBON      TO BAPRA
  9724           PERFORM 9900-ERROR-FORMAT
  9725                                 THRU 9900-EXIT
  9726        ELSE
  9727           IF BAPRI (WS-SUB:1) NUMERIC
  9728              MOVE WS-SUB           TO WS-BEG
  9729              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9730                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 179
* EL6311.cbl
  9731                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9732              END-PERFORM
  9733              COMPUTE WS-END = WS-SUB - WS-BEG
  9734              MOVE BAPRI (WS-BEG:WS-END)
  9735                                 TO WS-APR-WHOLE-NUM
  9736           END-IF
  9737           IF BAPRI (WS-SUB:1) = '.'
  9738              COMPUTE WS-BEG = WS-SUB + 1
  9739              IF (WS-BEG < 8)
  9740                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9741                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9742                    (WS-SUB > 7)
  9743                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9744                 END-PERFORM
  9745                 COMPUTE WS-END = WS-SUB - WS-BEG
  9746                 MOVE BAPRI (WS-BEG:WS-END)
  9747                                 TO WS-APR-DEC (1:WS-END)
  9748              END-IF
  9749           END-IF
  9750           MOVE AL-UNNON      TO BAPRA
  9751           MOVE WS-BAPR       TO BAPRO
  9752        END-IF
  9753     END-IF
  9754*     IF BAPRL NOT = ZEROS
  9755*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9756*        PERFORM 8600-DEEDIT
  9757*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9758
  9759     IF BLIVESL NOT = ZEROS
  9760        MOVE BLIVESI             TO DEEDIT-FIELD
  9761        PERFORM 8600-DEEDIT
  9762        IF DEEDIT-FIELD-V0 NUMERIC
  9763           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9764           MOVE AL-UNNON         TO BLIVESA
  9765        ELSE
  9766           MOVE -1               TO BLIVESL
  9767           MOVE AL-UNBON         TO BLIVESA
  9768           MOVE ER-2223          TO EMI-ERROR
  9769           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9770
  9771*DMD CUSTOM CODING*************START
  9772*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9773     IF PI-COMPANY-ID NOT = 'DMD'
  9774         MOVE ZEROS               TO BBILLEDL
  9775         GO TO 1010-EDIT-CONT.
  9776
  9777     IF BBILLEDL NOT = ZEROS
  9778        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9779        MOVE 'Y'                 TO WS-NUMERIC-SW
  9780        MOVE +1                  TO WS-CSO-SUB
  9781        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9782        IF CSO-NUMERIC-FIELD
  9783
  9784* EXEC CICS BIF DEEDIT
  9785*              FIELD  (BBILLEDI)
  9786*              LENGTH (9)
  9787*          END-EXEC
  9788     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 180
* EL6311.cbl
  9789       TO DFHEIV11
  9790*    MOVE '@"L                   #   #00009707' TO DFHEIV0
  9791     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9792     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9793     MOVE X'2020233030303039373037' TO DFHEIV0(25:11)
  9794     CALL 'kxdfhei1' USING DFHEIV0,
  9795           BBILLEDI,
  9796           DFHEIV11
  9797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9798           MOVE BBILLEDI         TO WS-BILLED
  9799           MOVE AL-UNNON         TO BBILLEDA
  9800        ELSE
  9801           MOVE -1               TO BBILLEDL
  9802           MOVE AL-UNBON         TO BBILLEDA
  9803           MOVE ER-2547          TO EMI-ERROR
  9804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9805     ELSE
  9806        IF BMAINTI EQUAL 'A'
  9807           MOVE -1               TO BBILLEDL
  9808           MOVE AL-UNBON         TO BBILLEDA
  9809           MOVE ER-8148          TO EMI-ERROR
  9810           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9811
  9812 1010-EDIT-CONT.
  9813
  9814     IF BFORCEL  NOT = ZEROS
  9815         IF FORCE-CAP
  9816            MOVE AL-UANON            TO BFORCEA
  9817         ELSE
  9818            MOVE ER-2945             TO EMI-ERROR
  9819            MOVE AL-UABON            TO BFORCEA
  9820            MOVE -1                  TO BFORCEL
  9821            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9822
  9823     if (bforcel not = zeros)
  9824        and (bforcei = 'L')
  9825        and (not csr-edit-session)
  9826        and (emi-error <> er-2945)
  9827        MOVE ER-2670             TO EMI-ERROR
  9828        MOVE AL-UABON            TO BFORCEA
  9829        MOVE -1                  TO BFORCEL
  9830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9831     end-if
  9832     IF BENTRYL NOT = ZEROS
  9833        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9834                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9835           MOVE ER-2224              TO EMI-ERROR
  9836           MOVE AL-UABON             TO BENTRYA
  9837           MOVE -1                   TO BENTRYL
  9838           MOVE  1                   TO SET-CURSOR-SW
  9839           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9840        ELSE
  9841           MOVE AL-UANON             TO BENTRYA.
  9842
  9843     IF BUNWRITL NOT = ZEROS
  9844        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9845           MOVE ER-7574              TO EMI-ERROR
  9846           MOVE AL-UABON             TO BUNWRITA
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 181
* EL6311.cbl
  9847           MOVE -1                   TO BUNWRITL
  9848           MOVE  1                   TO SET-CURSOR-SW
  9849           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9850        ELSE
  9851           MOVE AL-UANON             TO BUNWRITA.
  9852
  9853     IF BREINL  NOT = ZEROS
  9854         MOVE AL-UANON               TO BREINA.
  9855
  9856     IF BBILCDL NOT = ZEROS
  9857        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9858                             AND 'A' AND 'B' AND 'E'
  9859           MOVE ER-2225              TO EMI-ERROR
  9860           MOVE AL-UABON             TO BBILCDA
  9861           MOVE -1                   TO BBILCDL
  9862           MOVE  1                   TO SET-CURSOR-SW
  9863           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9864        ELSE
  9865           MOVE AL-UANON             TO BBILCDA.
  9866
  9867     IF BSKPCDL NOT = ZEROS
  9868         MOVE AL-UANON               TO BSKPCDA.
  9869
  9870     IF BINDGRPL NOT = ZEROS
  9871         MOVE AL-UANON               TO BINDGRPA.
  9872
  9873     IF BSIGL   NOT = ZEROS
  9874         MOVE AL-UANON               TO BSIGA.
  9875
  9876     IF BRTCLSL NOT = ZEROS
  9877         MOVE AL-UANON               TO BRTCLSA.
  9878
  9879     IF BMEMBERL NOT = ZEROS
  9880         MOVE AL-UANON               TO BMEMBERA.
  9881
  9882     MOVE +0                         TO WS-SUB1.
  9883
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 182
* EL6311.cbl
  9885
  9886******************************************************************
  9887*                                                                *
  9888*           E D I T   I S S U E   C O V E R A G E S              *
  9889*                                                                *
  9890******************************************************************
  9891
  9892 1020-EDIT-COVERAGES.
  9893     ADD +1                      TO WS-SUB1.
  9894
  9895     IF WS-SUB1 GREATER +2
  9896        GO TO 1025-EDIT-CONTINUE
  9897     END-IF
  9898
  9899     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9900       IF (BMODEL   GREATER ZERO  OR
  9901            BPMTSL   GREATER ZERO  OR
  9902            BPMTAMTL GREATER ZERO)
  9903          AND
  9904            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9905               GO TO 1021-CONT-EDIT.
  9906
  9907     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9908        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9909        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9910        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9911        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9912        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9913        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9914        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9915        NEXT SENTENCE
  9916         ELSE
  9917            GO TO 1020-EDIT-COVERAGES.
  9918
  9919 1021-CONT-EDIT.
  9920
  9921     IF BMAINTI = 'A'
  9922        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9923           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9924        ELSE
  9925           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9926           MOVE ER-7404          TO EMI-ERROR
  9927           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9928           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9929     ELSE
  9930        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9931           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9932
  9933     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9934        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9935        PERFORM 8600-DEEDIT
  9936        IF DEEDIT-FIELD-V0 NUMERIC
  9937           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9938        ELSE
  9939           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9940
  9941     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9942*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 183
* EL6311.cbl
  9943        IF BMODEL  GREATER THAN ZEROS  AND
  9944           BPMTSL  GREATER THAN ZEROS
  9945           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9946
  9947     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9948         IF BMODEL   GREATER THAN ZEROS  OR
  9949            BPMTSL   GREATER THAN ZEROS  OR
  9950            BPMTAMTL GREATER THAN ZEROS
  9951             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9952
  9953     IF BMAINTI = ('C' OR 'K')
  9954        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9955           NEXT SENTENCE
  9956        ELSE
  9957           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9958           PERFORM 8600-DEEDIT
  9959           IF DEEDIT-FIELD-V0 NUMERIC
  9960              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9961              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9962                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9963              ELSE
  9964                    MOVE ER-2241      TO EMI-ERROR
  9965                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9966                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9967                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9968           ELSE
  9969              MOVE ER-2223          TO EMI-ERROR
  9970              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9971              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9972              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9973     ELSE
  9974        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9975            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9976            PERFORM 8600-DEEDIT
  9977            IF DEEDIT-FIELD-V0      NUMERIC
  9978               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9979                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9980                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9981               ELSE
  9982                  MOVE ER-2241         TO EMI-ERROR
  9983                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9984                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9985                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9986            ELSE
  9987              MOVE ER-2223             TO EMI-ERROR
  9988              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9989              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9990              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9991        ELSE
  9992            MOVE ER-2240               TO EMI-ERROR
  9993            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9994            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9995*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9996*        IF BMODEL  GREATER THAN ZEROS  AND
  9997*           BPMTSL  GREATER THAN ZEROS
  9998*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9999
 10000     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 184
* EL6311.cbl
 10001        AND BMAINTI = ('C' OR 'K')
 10002           NEXT SENTENCE
 10003     ELSE
 10004        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10005           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10006
 10007* EXEC CICS BIF DEEDIT
 10008*              FIELD  (BBENI (WS-SUB1))
 10009*              LENGTH (12)
 10010*          END-EXEC
 10011     MOVE 12
 10012       TO DFHEIV11
 10013*    MOVE '@"L                   #   #00009919' TO DFHEIV0
 10014     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10015     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10016     MOVE X'2020233030303039393139' TO DFHEIV0(25:11)
 10017     CALL 'kxdfhei1' USING DFHEIV0,
 10018           BBENI(WS-SUB1),
 10019           DFHEIV11
 10020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10021           IF BBENI (WS-SUB1)  NUMERIC
 10022              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10023                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10024*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10025*          PERFORM 8600-DEEDIT
 10026*          IF DEEDIT-FIELD-V2  NUMERIC
 10027*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10028*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10029              ELSE
 10030                 MOVE ER-7632    TO EMI-ERROR
 10031                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10032                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10033                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10034           ELSE
 10035              MOVE ER-2223         TO EMI-ERROR
 10036              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10037              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10038              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10039        ELSE
 10040           MOVE ER-7632    TO EMI-ERROR
 10041           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10042           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10043           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10044
 10045     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10046        AND (BMAINTI = ('C' OR 'K'))
 10047        CONTINUE
 10048     ELSE
 10049        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10050           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10051           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10052              FOR ALL '.'
 10053           IF WS-TALLY > 1
 10054              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10055                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10056              END-PERFORM
 10057              IF A1 < 9
 10058                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 185
* EL6311.cbl
 10059                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10060              END-IF
 10061           ELSE
 10062              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10063                (A1 > 11)
 10064                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10065                  LOW-VALUES OR SPACES)
 10066              END-PERFORM
 10067              IF A1 > 1 AND < 12
 10068                 MOVE SPACES
 10069                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10070              END-IF
 10071           END-IF
 10072
 10073* EXEC CICS BIF DEEDIT
 10074*              FIELD  (BPREMI (WS-SUB1))
 10075*              LENGTH (11)
 10076*          END-EXEC
 10077     MOVE 11
 10078       TO DFHEIV11
 10079*    MOVE '@"L                   #   #00009974' TO DFHEIV0
 10080     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10081     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10082     MOVE X'2020233030303039393734' TO DFHEIV0(25:11)
 10083     CALL 'kxdfhei1' USING DFHEIV0,
 10084           BPREMI(WS-SUB1),
 10085           DFHEIV11
 10086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10087           IF BPREMI (WS-SUB1) NUMERIC
 10088              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10089                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10090*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10091*          PERFORM 8600-DEEDIT
 10092*          IF DEEDIT-FIELD-V2  NUMERIC
 10093*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10094*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10095              ELSE
 10096                 IF PI-COMPANY-ID NOT = 'DCC' and 'CAP'
 10097                    MOVE ER-7633    TO EMI-ERROR
 10098                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10099                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10100                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10101                 END-IF
 10102              END-IF
 10103           ELSE
 10104              MOVE ER-2223         TO EMI-ERROR
 10105              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10106              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10107              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10108           END-IF
 10109        ELSE
 10110           IF PI-COMPANY-ID NOT = 'DCC' and 'CAP'
 10111              MOVE ER-7633         TO EMI-ERROR
 10112              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10113              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10114              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10115           END-IF
 10116        END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 186
* EL6311.cbl
 10117     END-IF
 10118
 10119     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10120        NEXT SENTENCE
 10121     ELSE
 10122        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10123
 10124* EXEC CICS BIF DEEDIT
 10125*           FIELD  (BCPREMI (WS-SUB1))
 10126*           LENGTH (11)
 10127*       END-EXEC
 10128     MOVE 11
 10129       TO DFHEIV11
 10130*    MOVE '@"L                   #   #00010014' TO DFHEIV0
 10131     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10132     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10133     MOVE X'2020233030303130303134' TO DFHEIV0(25:11)
 10134     CALL 'kxdfhei1' USING DFHEIV0,
 10135           BCPREMI(WS-SUB1),
 10136           DFHEIV11
 10137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10138        IF BCPREMI (WS-SUB1) NUMERIC
 10139           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10140*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10141*       PERFORM 8600-DEEDIT
 10142*       IF DEEDIT-FIELD-V2  NUMERIC
 10143*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10144        ELSE
 10145           MOVE ER-2223         TO EMI-ERROR
 10146           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10147           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10148           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10149
 10150     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10151        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10152        PERFORM 8600-DEEDIT
 10153        IF DEEDIT-FIELD-V0 NUMERIC
 10154           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10155           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10156         ELSE
 10157           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10158           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10159           MOVE ER-2223              TO EMI-ERROR
 10160           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10161
 10162     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10163        IF BEXPIRE   (WS-SUB1) = SPACES
 10164           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10165        ELSE
 10166           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10167           PERFORM 8600-DEEDIT
 10168           IF DEEDIT-FIELD-V0        NUMERIC
 10169              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10170              MOVE 4                TO DC-OPTION-CODE
 10171              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10172              PERFORM 9700-DATE-LINK
 10173              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10174                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 187
* EL6311.cbl
 10175              IF NO-CONVERSION-ERROR
 10176                 NEXT SENTENCE
 10177              ELSE
 10178                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10179                 MOVE ER-2531    TO EMI-ERROR
 10180                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10181                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10182           ELSE
 10183             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10184             MOVE ER-2532        TO EMI-ERROR
 10185             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10186             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10187
 10188     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10189        NEXT SENTENCE
 10190     ELSE
 10191
 10192* EXEC CICS BIF DEEDIT
 10193*           FIELD  (BALT-BENI (WS-SUB1))
 10194*           LENGTH (12)
 10195*       END-EXEC
 10196     MOVE 12
 10197       TO DFHEIV11
 10198*    MOVE '@"L                   #   #00010071' TO DFHEIV0
 10199     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10200     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10201     MOVE X'2020233030303130303731' TO DFHEIV0(25:11)
 10202     CALL 'kxdfhei1' USING DFHEIV0,
 10203           BALT-BENI(WS-SUB1),
 10204           DFHEIV11
 10205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10206        IF BALT-BENI (WS-SUB1) NUMERIC
 10207           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10208*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10209*       PERFORM 8600-DEEDIT
 10210*       IF DEEDIT-FIELD-V0 NUMERIC
 10211*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10212        ELSE
 10213           MOVE ER-2223         TO EMI-ERROR
 10214           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10215           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10216           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10217
 10218     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10219        NEXT SENTENCE
 10220     ELSE
 10221
 10222* EXEC CICS BIF DEEDIT
 10223*           FIELD  (BALT-PREMI (WS-SUB1))
 10224*           LENGTH (11)
 10225*       END-EXEC
 10226     MOVE 11
 10227       TO DFHEIV11
 10228*    MOVE '@"L                   #   #00010090' TO DFHEIV0
 10229     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10230     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10231     MOVE X'2020233030303130303930' TO DFHEIV0(25:11)
 10232     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 188
* EL6311.cbl
 10233           BALT-PREMI(WS-SUB1),
 10234           DFHEIV11
 10235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10236        IF BALT-PREMI (WS-SUB1) NUMERIC
 10237           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10238*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10239*       PERFORM 8600-DEEDIT
 10240*       IF DEEDIT-FIELD-V0 NUMERIC
 10241*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10242        ELSE
 10243           MOVE ER-2223         TO EMI-ERROR
 10244           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10245           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10246           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10247
 10248      GO TO 1020-EDIT-COVERAGES.
 10249     .
 10250 1025-edit-continue.
 10251     IF PI-COMPANY-ID  =  'DMD'
 10252        MOVE LOW-VALUES             TO BNCERTI
 10253                                       BNSTATI.
 10254
 10255     IF EMI-ERROR = ZEROS
 10256         NEXT SENTENCE
 10257     ELSE
 10258         GO TO 8200-SEND-DATAONLY.
 10259
 10260     IF BMAINTI = 'A'
 10261         GO TO 1200-ADD-ISSUE-ROUTINE.
 10262
 10263     IF BMAINTI = 'C'
 10264         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10265
 10266     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10267
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 189
* EL6311.cbl
 10269
 10270 1030-EDIT-FOR-NUMERICS.
 10271     IF WS-CSO-SUB EQUAL 10
 10272        GO TO 1030-EDIT-EXIT.
 10273
 10274     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10275        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10276        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10277           ADD +1               TO WS-CSO-SUB
 10278           GO TO 1030-EDIT-FOR-NUMERICS.
 10279
 10280     MOVE 'N'                   TO WS-NUMERIC-SW.
 10281
 10282 1030-EDIT-EXIT.
 10283******************************************************************
 10284*                                                                *
 10285*                 C A L C U L A T E   A G E                      *
 10286*                                                                *
 10287******************************************************************
 10288
 10289
 10290 1095-CALC-AGE.
 10291
 10292     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10293     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10294     MOVE 1                  TO DC-OPTION-CODE.
 10295     PERFORM 9700-DATE-LINK
 10296     IF NO-CONVERSION-ERROR
 10297         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10298         MOVE WS-BAGE            TO BAGEI
 10299         MOVE +2                 TO BAGEL
 10300         MOVE AL-UNNON TO BAGEA.
 10301
 10302 1099-EXIT.
 10303     EXIT.
 10304
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 190
* EL6311.cbl
 10306
 10307******************************************************************
 10308*                                                                *
 10309*                   S H O W   I S S U E                          *
 10310*                                                                *
 10311******************************************************************
 10312
 10313 1100-SHOW-REQUEST.
 10314     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10315
 10316     IF BCERTNOL = ZEROS AND
 10317        BEFFDTL  = ZEROS
 10318        MOVE -1                  TO BMAINTL
 10319        GO TO 8200-SEND-DATAONLY.
 10320
 10321     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10322
 10323     IF BSUFIXL NOT = ZEROS
 10324        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10325     ELSE
 10326        MOVE SPACE               TO WS-NEW-SUFFIX.
 10327
 10328     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10329     PERFORM 8600-DEEDIT.
 10330     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10331     MOVE '4'                    TO DC-OPTION-CODE.
 10332     PERFORM 9700-DATE-LINK.
 10333     IF DATE-CONVERSION-ERROR
 10334        MOVE ER-0348             TO EMI-ERROR
 10335        MOVE -1                  TO BEFFDTL
 10336        MOVE AL-UABON            TO BEFFDTA
 10337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10338        GO TO 8200-SEND-DATAONLY
 10339     ELSE
 10340        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10341        MOVE AL-UANON            TO BEFFDTA
 10342        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10343
 10344     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10345
 10346     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10347        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10348          MOVE 'Y'                    TO WS-SHOW-SW
 10349          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10350             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10351           ELSE
 10352             IF PI-FILE-BROWSE
 10353                GO TO 4300-BROWSE-FILE-FORWARD
 10354              ELSE
 10355                IF PI-CSR-BROWSE
 10356                   GO TO 4200-BROWSE-CSR-FORWARD
 10357                ELSE
 10358                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10359        ELSE
 10360           GO TO 3900-RE-DISPLAY-RECORD.
 10361
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 191
* EL6311.cbl
 10363
 10364******************************************************************
 10365*                                                                *
 10366*            A D D   I S S U E   R O U T I N E                   *
 10367*                                                                *
 10368******************************************************************
 10369
 10370***************************************************************
 10371*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10372*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10373*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10374*     4. LINK TO THE EDIT ROUTINE.                            *
 10375*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10376*     6. WRITE THE NEW ISSUE RECORD.                          *
 10377*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10378*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10379*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10380*        ELSE                                                 *
 10381*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10382***************************************************************
 10383
 10384 1200-ADD-ISSUE-ROUTINE.
 10385     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10386
 10387
 10388* EXEC CICS GETMAIN
 10389*        SET     (ADDRESS OF PENDING-BUSINESS)
 10390*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10391*    END-EXEC.
 10392*    MOVE '," L                  $   #00010245' TO DFHEIV0
 10393     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10394     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10395     MOVE X'2020233030303130323435' TO DFHEIV0(25:11)
 10396     CALL 'kxdfhei1' USING DFHEIV0,
 10397           DFHEIV20,
 10398           ERPNDB-RECORD-LENGTH,
 10399           DFHEIV99
 10400     SET ADDRESS OF PENDING-BUSINESS TO
 10401         DFHEIV20
 10402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10403
 10404
 10405
 10406* EXEC CICS HANDLE CONDITION
 10407*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10408*    END-EXEC.
 10409*    MOVE '"$I                   ! # #00010250' TO DFHEIV0
 10410     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10412     MOVE X'2320233030303130323530' TO DFHEIV0(25:11)
 10413     CALL 'kxdfhei1' USING DFHEIV0
 10414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10415
 10416
 10417     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10418     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10419     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10420
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 192
* EL6311.cbl
 10421
 10422* EXEC CICS READ
 10423*        INTO    (PENDING-BUSINESS)
 10424*        DATASET (FILE-ID-ERPNDB)
 10425*        RIDFLD  (ERPNDB-KEY)
 10426*    END-EXEC.
 10427     MOVE LENGTH OF
 10428      PENDING-BUSINESS
 10429       TO DFHEIV11
 10430*    MOVE '&"IL       E          (   #00010258' TO DFHEIV0
 10431     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10433     MOVE X'2020233030303130323538' TO DFHEIV0(25:11)
 10434     CALL 'kxdfhei1' USING DFHEIV0,
 10435           FILE-ID-ERPNDB,
 10436           PENDING-BUSINESS,
 10437           DFHEIV11,
 10438           ERPNDB-KEY,
 10439           DFHEIV99,
 10440           DFHEIV99,
 10441           DFHEIV99
 10442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10443
 10444
 10445     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10446
 10447     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10448     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10449     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10450     MOVE SPACES                 TO PENDING-BUSINESS.
 10451     MOVE 'PB'                   TO PB-RECORD-ID.
 10452     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10453     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10454     MOVE SPACES                 TO PB-CERT-SFX.
 10455     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10456     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10457                                    PB-ALT-CHG-SEQ-NO.
 10458
 10459     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10460     MOVE '1'                    TO PB-RECORD-TYPE.
 10461
 10462     IF BSUFIXL NOT = ZEROS
 10463        MOVE BSUFIXI             TO PB-CERT-SFX.
 10464
 10465     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10466
 10467     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10468     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10469
 10470     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10471                                    PB-I-LF-PREM-CALC
 10472                                    PB-I-LF-ALT-PREM-CALC
 10473                                    PB-I-LF-RATE
 10474                                    PB-I-LF-ALT-RATE
 10475                                    PB-I-LF-REI-RATE
 10476                                    PB-I-LF-ALT-REI-RATE
 10477                                    PB-I-RATE-DEV-PCT-LF
 10478                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 193
* EL6311.cbl
 10479                                    PB-I-AH-RATE
 10480                                    PB-I-AH-REI-RATE
 10481                                    PB-I-AH-RATE-TRM
 10482                                    PB-I-RATE-DEV-PCT-AH
 10483                                    PB-I-BUSINESS-TYPE
 10484                                    PB-I-LIFE-COMMISSION
 10485                                    PB-I-JOINT-COMMISSION
 10486                                    PB-I-JOINT-AGE
 10487                                    PB-I-AH-COMMISSION
 10488                                    PB-I-CURR-SEQ
 10489                                    PB-CHG-COUNT
 10490                                    PB-LF-BILLED-AMTS
 10491                                    PB-AH-BILLED-AMTS
 10492                                    PB-CALC-TOLERANCE
 10493                                    PB-I-EXTENTION-DAYS
 10494*                                   PB-I-MICROFILM-NO
 10495                                    PB-I-TERM-IN-DAYS.
 10496
 10497     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10498                                    PB-I-LF-EXPIRE-DT
 10499                                    PB-I-AH-EXPIRE-DT
 10500                                    PB-BILLED-DT
 10501                                    PB-ACCT-EFF-DT
 10502                                    PB-ACCT-EXP-DT
 10503                                    PB-I-1ST-PMT-DT.
 10504
 10505     MOVE 'X'                    TO PB-FATAL-FLAG.
 10506
 10507     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10508
 10509     IF BLSTNML GREATER THAN ZEROS
 10510         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10511
 10512*    IF BMICRNOL  GREATER  ZEROS
 10513*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10514*    ELSE
 10515*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10516     IF BVINL > ZEROS
 10517        MOVE BVINI               TO PB-I-VIN
 10518     END-IF
 10519     IF B1STNML GREATER THAN ZEROS
 10520         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10521
 10522     IF BINITL  GREATER THAN ZEROS
 10523         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10524
 10525     IF BBIRTHL GREATER THAN ZERO
 10526         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10527     ELSE
 10528         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10529
 10530     IF B1STPMTL GREATER THAN ZERO
 10531         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10532     ELSE
 10533         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10534
 10535     IF BAGEL    GREATER THAN ZEROS
 10536         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 194
* EL6311.cbl
 10537        ELSE
 10538         MOVE ZEROS              TO PB-I-AGE.
 10539
 10540     IF BSEXL    GREATER THAN ZEROS
 10541         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10542
 10543     IF BTERM-LEN (1) GREATER THAN ZEROS
 10544        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10545     ELSE
 10546        MOVE ZEROS               TO PB-I-LF-TERM.
 10547
 10548     IF BTERM-LEN (2) GREATER THAN ZEROS
 10549        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10550     ELSE
 10551        MOVE ZEROS               TO PB-I-AH-TERM.
 10552
 10553     IF BLNTRML       GREATER THAN ZEROS
 10554         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10555        ELSE
 10556         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10557
 10558     IF BFREQL        GREATER THAN ZEROS
 10559         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10560        ELSE
 10561         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10562
 10563     IF BSKPCDL       GREATER THAN ZEROS
 10564         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10565
 10566     IF BMODEL        GREATER THAN ZEROS
 10567         MOVE BMODEI             TO PB-I-TERM-TYPE
 10568                                    PI-BMODE.
 10569
 10570     IF BPMTSL        GREATER THAN ZEROS
 10571         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10572                                    PI-BPMTS
 10573        ELSE
 10574         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10575                                    PI-BPMTS.
 10576
 10577     IF BPMTAMTL      GREATER THAN ZEROS
 10578         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10579        ELSE
 10580         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10581
 10582     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10583        IF BTYPE  (1)   NOT = ZEROS
 10584           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10585                                    PI-BTYPE (1)
 10586           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10587           MOVE SPACES           TO PB-I-LF-ABBR
 10588        ELSE
 10589           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10590                                    PB-I-LF-ABBR
 10591           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10592     ELSE
 10593        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10594                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 195
* EL6311.cbl
 10595        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10596
 10597     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10598         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10599     ELSE
 10600         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10601
 10602     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10603         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10604     ELSE
 10605         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10606
 10607     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10608         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10609            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10610            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10611         ELSE
 10612            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10613*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10614*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10615         END-IF
 10616     ELSE
 10617         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10618
 10619     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10620         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10621
 10622     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10623         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10624         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10625     ELSE
 10626         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10627
 10628     IF  BALT-PREM-LEN     (2) > ZEROS
 10629         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10630     ELSE
 10631         MOVE ZEROS            TO PB-I-TOT-FEES.
 10632
 10633     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10634        IF BTYPE      (2)   NOT = ZEROS
 10635           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10636                                  PI-BTYPE (2)
 10637           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10638           MOVE SPACES         TO PB-I-AH-ABBR
 10639        ELSE
 10640           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10641                                  PB-I-AH-ABBR
 10642           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10643     ELSE
 10644        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10645                                  PB-I-AH-ABBR
 10646        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10647
 10648     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10649         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10650     ELSE
 10651         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10652
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 196
* EL6311.cbl
 10653     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10654         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10655            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10656            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10657         ELSE
 10658            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10659*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10660*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10661         END-IF
 10662     ELSE
 10663         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10664
 10665     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10666         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10667
 10668     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10669        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10670     ELSE
 10671        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10672
 10673     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10674        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10675     ELSE
 10676        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10677
 10678     IF BINDGRPL  GREATER THAN ZEROS
 10679         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10680
 10681     IF BRTCLSL   GREATER THAN ZEROS
 10682         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10683
 10684     IF BSIGL     GREATER THAN ZEROS
 10685         MOVE BSIGI              TO PB-I-SIG-SW.
 10686     IF BAPRL > ZEROS
 10687         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10688     ELSE
 10689        if pi-company-id = 'CID'
 10690           move +99.9999         to pb-i-loan-apr
 10691        else
 10692           MOVE ZEROS            TO PB-I-LOAN-APR
 10693        end-if
 10694     end-if
 10695     IF BMEMBERL  GREATER THAN ZEROS
 10696         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10697
 10698     IF BLNOFCRL  GREATER THAN ZEROS
 10699         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10700
 10701     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10702        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10703     ELSE
 10704        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10705
 10706     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10707        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10708     ELSE
 10709        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10710
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 197
* EL6311.cbl
 10711     IF BDAYSL   GREATER THAN ZEROS
 10712        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10713                                    PB-I-EXTENTION-DAYS
 10714     ELSE
 10715        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10716                                    PB-I-EXTENTION-DAYS.
 10717
 10718     IF BDAYSL GREATER THAN ZEROS
 10719        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10720
 10721     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10722        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10723           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10724
 10725     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10726        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10727           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10728
 10729     IF B1STPMTL GREATER THAN ZEROS
 10730        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10731
 10732     IF PB-EXT-DAYS-PROCESSING
 10733        IF PB-I-EXTENTION-DAYS = ZEROS
 10734           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10735
 10736     IF PB-EXPIRE-DT-PROCESSING
 10737        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10738           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10739             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10740
 10741     IF PB-1ST-PMT-DT-PROCESSING
 10742        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10743           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10744
 10745     IF BREINL GREATER THAN ZEROS
 10746        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10747
 10748     IF BENTRYL NOT = ZEROS
 10749        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10750        IF PI-COMPANY-ID = 'CID'
 10751           AND (PB-BATCH-ENTRY = 'P')
 10752           AND (PB-STATE = 'VA')
 10753           PERFORM 1500-UPDATE-ERNOTE
 10754                                 THRU 1500-EXIT
 10755        END-IF
 10756     END-IF
 10757     IF BUNWRITL NOT = ZEROS
 10758        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10759
 10760     IF BFORCEL NOT = ZEROS
 10761        MOVE BFORCEI             TO PB-FORCE-CODE.
 10762
 10763     IF BBILCDL NOT = ZEROS
 10764        MOVE BBILCDI             TO PB-RECORD-BILL.
 10765
 10766     IF BLIVESL GREATER THAN ZEROS
 10767        MOVE WS-BLIVES           TO PB-I-LIVES
 10768     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 198
* EL6311.cbl
 10769        MOVE ZEROS               TO PB-I-LIVES.
 10770
 10771     IF BBILLEDL GREATER THAN ZEROS
 10772        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10773     ELSE
 10774        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10775
 10776*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10777
 10778 1260-WRITE-PB-RECORD.
 10779     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10780                                    PB-INPUT-BY.
 10781     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10782     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10783                                    PB-INPUT-DT.
 10784
 10785     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10786     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10787                                    PB-CONTROL-BY-ORIG-BATCH.
 10788
 10789
 10790     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10791     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10792     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10793     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10794     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10795
 10796     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10797
 10798     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10799
 10800     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10801     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10802     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10803
 10804     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10805     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10806
 10807 1275-WRITE-PENDING-BUSINESS.
 10808     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10809     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10810     MOVE 'A'                    TO JP-RECORD-TYPE.
 10811     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10812
 10813
 10814* EXEC CICS HANDLE CONDITION
 10815*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10816*    END-EXEC.
 10817*    MOVE '"$%                   ! $ #00010632' TO DFHEIV0
 10818     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10820     MOVE X'2420233030303130363332' TO DFHEIV0(25:11)
 10821     CALL 'kxdfhei1' USING DFHEIV0
 10822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10823
 10824
 10825
 10826* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 199
* EL6311.cbl
 10827*        DATASET (FILE-ID-ERPNDB)
 10828*        FROM    (PENDING-BUSINESS)
 10829*        RIDFLD  (PB-CONTROL-PRIMARY)
 10830*    END-EXEC.
 10831     MOVE LENGTH OF
 10832      PENDING-BUSINESS
 10833       TO DFHEIV11
 10834*    MOVE '&$ L                  ''   #00010636' TO DFHEIV0
 10835     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10836     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10837     MOVE X'2020233030303130363336' TO DFHEIV0(25:11)
 10838     CALL 'kxdfhei1' USING DFHEIV0,
 10839           FILE-ID-ERPNDB,
 10840           PENDING-BUSINESS,
 10841           DFHEIV11,
 10842           PB-CONTROL-PRIMARY,
 10843           DFHEIV99,
 10844           DFHEIV99
 10845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10846
 10847
 10848     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10849
 10850     PERFORM 8400-LOG-JOURNAL-RECORD.
 10851
 10852******************************************************************
 10853*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10854******************************************************************
 10855*    display ' made it to add orig cert '
 10856     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10857     MOVE ' '                    TO WS-ERMAIL-SW
 10858
 10859* EXEC CICS READ
 10860*       DATASET   (FILE-ID-ERMAIL)
 10861*       SET       (ADDRESS OF MAILING-DATA)
 10862*       RIDFLD    (ERMAIL-KEY)
 10863*       RESP      (WS-RESPONSE)
 10864*    END-EXEC
 10865*    MOVE '&"S        E          (  N#00010652' TO DFHEIV0
 10866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10868     MOVE X'204E233030303130363532' TO DFHEIV0(25:11)
 10869     CALL 'kxdfhei1' USING DFHEIV0,
 10870           FILE-ID-ERMAIL,
 10871           DFHEIV20,
 10872           DFHEIV99,
 10873           ERMAIL-KEY,
 10874           DFHEIV99,
 10875           DFHEIV99,
 10876           DFHEIV99
 10877     SET ADDRESS OF MAILING-DATA TO
 10878         DFHEIV20
 10879     MOVE EIBRESP  TO WS-RESPONSE
 10880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10881     IF RESP-NORMAL
 10882        SET ERMAIL-FOUND TO TRUE
 10883     END-IF
 10884
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 200
* EL6311.cbl
 10885     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10886     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10887     MOVE 'OC'                   TO OC-RECORD-ID
 10888     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10889                                 TO OC-CONTROL-PRIMARY (1:33)
 10890     MOVE 'I'                    TO OC-RECORD-TYPE
 10891     MOVE +4096                  TO OC-KEY-SEQ-NO
 10892     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10893     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10894     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10895     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10896     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10897     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10898     MOVE PB-I-AGE               TO OC-INS-AGE
 10899     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10900     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10901     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10902     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10903     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10904     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10905     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10906     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10907     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10908     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10909     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10910     IF PB-I-JOINT-COMMISSION > +0
 10911         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10912     ELSE
 10913         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10914     END-IF
 10915     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10916     MOVE +0                     TO OC-LF-CANCEL-AMT
 10917                                    OC-LF-ITD-CANCEL-AMT
 10918     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10919     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10920     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10921     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10922     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10923     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10924     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10925     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10926     MOVE +0                     TO OC-AH-CANCEL-AMT
 10927                                    OC-AH-ITD-CANCEL-AMT
 10928     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10929     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10930     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10931     IF ERMAIL-FOUND
 10932        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10933     END-IF
 10934     IF NOT CERT-TRL-REC-NOT-FOUND
 10935        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10936                           OC-INS-AGE-DEFAULT-FLAG
 10937        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10938                           OC-JNT-AGE-DEFAULT-FLAG
 10939     END-IF
 10940     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10941     .
 10942 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 201
* EL6311.cbl
 10943
 10944* EXEC CICS WRITE
 10945*       DATASET   ('ELCRTO')
 10946*       FROM      (ORIGINAL-CERTIFICATE)
 10947*       RIDFLD    (OC-CONTROL-PRIMARY)
 10948*       RESP      (WS-RESPONSE)
 10949*    END-EXEC
 10950     MOVE LENGTH OF
 10951      ORIGINAL-CERTIFICATE
 10952       TO DFHEIV11
 10953     MOVE 'ELCRTO' TO DFHEIV1
 10954*    MOVE '&$ L                  ''  N#00010720' TO DFHEIV0
 10955     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10956     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10957     MOVE X'204E233030303130373230' TO DFHEIV0(25:11)
 10958     CALL 'kxdfhei1' USING DFHEIV0,
 10959           DFHEIV1,
 10960           ORIGINAL-CERTIFICATE,
 10961           DFHEIV11,
 10962           OC-CONTROL-PRIMARY,
 10963           DFHEIV99,
 10964           DFHEIV99
 10965     MOVE EIBRESP  TO WS-RESPONSE
 10966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10967*    display ' just wrote 1275 ' ws-response
 10968     IF RESP-DUPKEY
 10969        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10970        GO TO 1275-WRITE-ELCRTO
 10971     ELSE
 10972        IF NOT RESP-NORMAL
 10973           MOVE -1               TO BMAINTL
 10974           MOVE ER-7450          TO EMI-ERROR
 10975           PERFORM 9900-ERROR-FORMAT
 10976                                 THRU 9900-EXIT
 10977           GO TO 8200-SEND-DATAONLY
 10978        END-IF
 10979     END-IF
 10980******************************************************************
 10981*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10982******************************************************************
 10983
 10984
 10985* EXEC CICS READ
 10986*        INTO    (PENDING-BUSINESS)
 10987*        DATASET (FILE-ID-ERPNDB)
 10988*        RIDFLD  (ERPNDB-KEY)
 10989*        UPDATE
 10990*    END-EXEC.
 10991     MOVE LENGTH OF
 10992      PENDING-BUSINESS
 10993       TO DFHEIV11
 10994*    MOVE '&"IL       EU         (   #00010743' TO DFHEIV0
 10995     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10996     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10997     MOVE X'2020233030303130373433' TO DFHEIV0(25:11)
 10998     CALL 'kxdfhei1' USING DFHEIV0,
 10999           FILE-ID-ERPNDB,
 11000           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 202
* EL6311.cbl
 11001           DFHEIV11,
 11002           ERPNDB-KEY,
 11003           DFHEIV99,
 11004           DFHEIV99,
 11005           DFHEIV99
 11006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11007
 11008
 11009     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11010     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11011     MOVE 'B'                    TO JP-RECORD-TYPE.
 11012     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11013
 11014     PERFORM 8400-LOG-JOURNAL-RECORD.
 11015
 11016     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11017
 11018
 11019* EXEC CICS REWRITE
 11020*        DATASET (FILE-ID-ERPNDB)
 11021*        FROM    (PENDING-BUSINESS)
 11022*    END-EXEC.
 11023     MOVE LENGTH OF
 11024      PENDING-BUSINESS
 11025       TO DFHEIV11
 11026*    MOVE '&& L                  %   #00010759' TO DFHEIV0
 11027     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11028     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11029     MOVE X'2020233030303130373539' TO DFHEIV0(25:11)
 11030     CALL 'kxdfhei1' USING DFHEIV0,
 11031           FILE-ID-ERPNDB,
 11032           PENDING-BUSINESS,
 11033           DFHEIV11,
 11034           DFHEIV99
 11035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11036
 11037
 11038     MOVE 'C'                    TO JP-RECORD-TYPE.
 11039     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11040
 11041     PERFORM 8400-LOG-JOURNAL-RECORD.
 11042
 11043     IF WS-ERRORS-PRESENT
 11044         GO TO 3900-RE-DISPLAY-RECORD.
 11045
 11046     MOVE ZEROS                  TO EMI-ERROR.
 11047     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11048     MOVE LOW-VALUES             TO EL631BI.
 11049     MOVE  -1                    TO BMAINTL.
 11050     GO TO 8100-SEND-INITIAL-MAP.
 11051
 11052 1280-BATCH-HDR-NOT-FOUND.
 11053     MOVE -1                     TO BMAINTL.
 11054     MOVE ER-7450                TO EMI-ERROR.
 11055     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11056     GO TO 8200-SEND-DATAONLY.
 11057
 11058 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 203
* EL6311.cbl
 11059
 11060******************************************************************
 11061*                                                                *
 11062*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11063*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11064*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11065*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11066*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11067*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11068*                                                                *
 11069******************************************************************
 11070
 11071     IF LCP-ONCTR-01 =  0
 11072         ADD 1 TO LCP-ONCTR-01
 11073        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11074
 11075     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11076
 11077     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11078         NEXT SENTENCE
 11079     ELSE
 11080         ADD +1 TO PB-BATCH-SEQ-NO
 11081                   PB-CSR-BATCH-SEQ-NO
 11082         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11083         GO TO 1275-WRITE-PENDING-BUSINESS.
 11084
 11085     MOVE -1                     TO BCERTNOL.
 11086     MOVE AL-UABON               TO BCERTNOA.
 11087     MOVE AL-UNBON               TO BEFFDTA.
 11088
 11089     MOVE 1                      TO EMI-SUB
 11090                                    EMI-SWITCH1
 11091                                    EMI-SWITCH-AREA-1
 11092                                    EMI-SWITCH-AREA-2.
 11093
 11094     MOVE SPACES                 TO EMI-ERROR-LINES.
 11095
 11096
 11097* EXEC CICS SYNCPOINT ROLLBACK
 11098*    END-EXEC.
 11099*    MOVE '6"R                   !   #00010822' TO DFHEIV0
 11100     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11102     MOVE X'2020233030303130383232' TO DFHEIV0(25:11)
 11103     CALL 'kxdfhei1' USING DFHEIV0
 11104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11105
 11106
 11107     MOVE ER-2247                TO EMI-ERROR.
 11108     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11109     GO TO 8200-SEND-DATAONLY.
 11110
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 204
* EL6311.cbl
 11112
 11113
 11114 1295-READ-CERT-TRAILER.
 11115
 11116
 11117* EXEC CICS GETMAIN
 11118*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11119*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11120*        INITIMG (GETMAIN-SPACE)
 11121*    END-EXEC
 11122*    MOVE ',"IL                  $   #00010834' TO DFHEIV0
 11123     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11125     MOVE X'2020233030303130383334' TO DFHEIV0(25:11)
 11126     CALL 'kxdfhei1' USING DFHEIV0,
 11127           DFHEIV20,
 11128           ELCRTT-RECORD-LENGTH,
 11129           GETMAIN-SPACE
 11130     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11131         DFHEIV20
 11132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11133
 11134     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11135     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11136     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11137
 11138
 11139* EXEC CICS HANDLE CONDITION
 11140*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11141*    END-EXEC.
 11142*    MOVE '"$I                   ! % #00010844' TO DFHEIV0
 11143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11145     MOVE X'2520233030303130383434' TO DFHEIV0(25:11)
 11146     CALL 'kxdfhei1' USING DFHEIV0
 11147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11148
 11149
 11150
 11151* EXEC CICS READ
 11152*        DATASET  (CRTT-ID)
 11153*        RIDFLD   (ELCRTT-KEY)
 11154*        INTO     (CERTIFICATE-TRAILERS)
 11155*    END-EXEC.
 11156     MOVE LENGTH OF
 11157      CERTIFICATE-TRAILERS
 11158       TO DFHEIV11
 11159*    MOVE '&"IL       E          (   #00010848' TO DFHEIV0
 11160     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11162     MOVE X'2020233030303130383438' TO DFHEIV0(25:11)
 11163     CALL 'kxdfhei1' USING DFHEIV0,
 11164           CRTT-ID,
 11165           CERTIFICATE-TRAILERS,
 11166           DFHEIV11,
 11167           ELCRTT-KEY,
 11168           DFHEIV99,
 11169           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 205
* EL6311.cbl
 11170           DFHEIV99
 11171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11172
 11173
 11174     GO TO 1295-EXIT.
 11175
 11176 1295-CERT-TRL-REC-NOTFND.
 11177     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11178
 11179 1295-EXIT.
 11180     EXIT.
 11181
 11182******************************************************************
 11183*                                                                *
 11184*          C H A N G E   I S S U E   R O U T I N E               *
 11185*                                                                *
 11186******************************************************************
 11187
 11188***************************************************************
 11189*                                                             *
 11190*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11191*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11192*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11193*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11194*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11195*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11196*     5. LINK TO THE EDIT ROUTINE.                            *
 11197*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11198*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11199*              THE EDIT ROUTINE.                              *
 11200*     7. REWRITE THE NEW ISSUE                                *
 11201*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11202*                                                             *
 11203***************************************************************
 11204
 11205 1300-CHANGE-ISSUE-ROUTINE.
 11206     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11207
 11208     IF BCHGL NOT = ZEROS
 11209        MOVE ER-2196             TO EMI-ERROR
 11210        MOVE AL-UABON            TO BMAINTA
 11211        MOVE -1                  TO BMAINTL
 11212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11213        GO TO 8200-SEND-DATAONLY.
 11214
 11215     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11216
 11217     IF BSUFIXL NOT = ZEROS
 11218        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11219     ELSE
 11220        MOVE SPACE               TO WS-NEW-SUFFIX.
 11221
 11222     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11223     PERFORM 8600-DEEDIT.
 11224     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11225     MOVE '4'                    TO DC-OPTION-CODE.
 11226     PERFORM 9700-DATE-LINK.
 11227     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 206
* EL6311.cbl
 11228        MOVE ER-0348             TO EMI-ERROR
 11229        MOVE -1                  TO BEFFDTL
 11230        MOVE AL-UABON            TO BEFFDTA
 11231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11232        GO TO 8200-SEND-DATAONLY
 11233     ELSE
 11234        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11235        MOVE AL-UANON            TO BEFFDTA
 11236        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11237
 11238 1325-PROCESS-ISSUE-CHANGES.
 11239
 11240* EXEC CICS HANDLE CONDITION
 11241*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11242*    END-EXEC.
 11243*    MOVE '"$I                   ! & #00010919' TO DFHEIV0
 11244     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11246     MOVE X'2620233030303130393139' TO DFHEIV0(25:11)
 11247     CALL 'kxdfhei1' USING DFHEIV0
 11248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11249
 11250
 11251     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11252     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11253     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11254
 11255
 11256* EXEC CICS GETMAIN
 11257*        SET      (ADDRESS OF PENDING-BUSINESS)
 11258*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11259*        INITIMG  (GETMAIN-SPACE)
 11260*     END-EXEC.
 11261*    MOVE ',"IL                  $   #00010927' TO DFHEIV0
 11262     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11263     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11264     MOVE X'2020233030303130393237' TO DFHEIV0(25:11)
 11265     CALL 'kxdfhei1' USING DFHEIV0,
 11266           DFHEIV20,
 11267           ERPNDB-RECORD-LENGTH,
 11268           GETMAIN-SPACE
 11269     SET ADDRESS OF PENDING-BUSINESS TO
 11270         DFHEIV20
 11271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11272
 11273
 11274
 11275* EXEC CICS READ
 11276*        INTO    (PENDING-BUSINESS)
 11277*        DATASET (FILE-ID-ERPNDB)
 11278*        RIDFLD  (ERPNDB-KEY)
 11279*    END-EXEC.
 11280     MOVE LENGTH OF
 11281      PENDING-BUSINESS
 11282       TO DFHEIV11
 11283*    MOVE '&"IL       E          (   #00010933' TO DFHEIV0
 11284     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11285     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 207
* EL6311.cbl
 11286     MOVE X'2020233030303130393333' TO DFHEIV0(25:11)
 11287     CALL 'kxdfhei1' USING DFHEIV0,
 11288           FILE-ID-ERPNDB,
 11289           PENDING-BUSINESS,
 11290           DFHEIV11,
 11291           ERPNDB-KEY,
 11292           DFHEIV99,
 11293           DFHEIV99,
 11294           DFHEIV99
 11295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11296
 11297
 11298     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11299
 11300
 11301* EXEC CICS HANDLE CONDITION
 11302*         NOTFND     (1385-REC-NOT-FOUND)
 11303*    END-EXEC.
 11304*    MOVE '"$I                   ! '' #00010941' TO DFHEIV0
 11305     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11307     MOVE X'2720233030303130393431' TO DFHEIV0(25:11)
 11308     CALL 'kxdfhei1' USING DFHEIV0
 11309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11310
 11311
 11312**********************************************************
 11313*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11314*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11315**********************************************************
 11316
 11317
 11318* EXEC CICS READ
 11319*        DATASET (FILE-ID-ERPNDB)
 11320*        INTO    (PENDING-BUSINESS)
 11321*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11322*    END-EXEC.
 11323     MOVE LENGTH OF
 11324      PENDING-BUSINESS
 11325       TO DFHEIV11
 11326*    MOVE '&"IL       E          (   #00010950' TO DFHEIV0
 11327     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11329     MOVE X'2020233030303130393530' TO DFHEIV0(25:11)
 11330     CALL 'kxdfhei1' USING DFHEIV0,
 11331           FILE-ID-ERPNDB,
 11332           PENDING-BUSINESS,
 11333           DFHEIV11,
 11334           PI-PREV-CONTROL-PRIMARY,
 11335           DFHEIV99,
 11336           DFHEIV99,
 11337           DFHEIV99
 11338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11339
 11340
 11341********** DO NOT ALLOW CHANGES IF THRU A/R
 11342     IF BMAINTI = 'C'
 11343         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 208
* EL6311.cbl
 11344             MOVE ER-4005          TO EMI-ERROR
 11345             MOVE -1               TO BMAINTL
 11346             MOVE AL-UABON         TO BMAINTA
 11347             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11348             GO TO 8200-SEND-DATAONLY.
 11349**********
 11350
 11351     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11352        MOVE -1                 TO BMAINTL
 11353        MOVE ER-2197            TO EMI-ERROR
 11354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11355        GO TO 8200-SEND-DATAONLY.
 11356
 11357     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11358        MOVE ER-2196             TO EMI-ERROR
 11359        MOVE AL-UABON            TO BMAINTA
 11360        MOVE -1                  TO BMAINTL
 11361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11362        GO TO 8200-SEND-DATAONLY.
 11363
 11364     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11365
 11366     IF PB-BILLED-DT = LOW-VALUES AND
 11367        PB-CHG-COUNT = ZEROS
 11368        NEXT SENTENCE
 11369     ELSE
 11370        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11371            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11372           OR
 11373           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11374            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11375           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11376     move zeros                  to ws-check-amts
 11377     move ' '                    to ws-stop-sw
 11378                                    ws-check-sw
 11379                                    ws-proc-check-sw
 11380                                    ws-any-check-sw
 11381                                    ws-chek-browse-sw
 11382
 11383     perform 2500-browse-checks  thru 2500-exit
 11384
 11385     if i-have-processed-checks
 11386        or i-have-checks
 11387        continue
 11388     else
 11389        go to 1330-continue
 11390     end-if
 11391
 11392     compute ws-tot-orig-prem =
 11393        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11394        pb-i-lf-alt-premium-amt
 11395
 11396     if bprem1l <> zeros
 11397        MOVE AL-UNNON            TO bprem1a
 11398        move ws-bprem (1)        to ws-new-iss-total
 11399     else
 11400        move pb-i-lf-premium-amt to ws-new-iss-total
 11401     end-if
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 209
* EL6311.cbl
 11402     display ' new iss totala ' ws-new-iss-total
 11403
 11404     if baltpr1l <> zeros
 11405        MOVE AL-UNNON            TO baltpr1a
 11406        compute ws-new-iss-total =
 11407           ws-new-iss-total + ws-balt-prem(1)
 11408     else
 11409        compute ws-new-iss-total =
 11410           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11411     end-if
 11412
 11413     if bprem2l <> zeros
 11414        MOVE AL-UNNON            TO bprem2a
 11415        compute ws-new-iss-total = ws-new-iss-total +
 11416           ws-bprem (2)
 11417     else
 11418        compute ws-new-iss-total = ws-new-iss-total +
 11419           pb-i-ah-premium-amt
 11420     end-if
 11421
 11422     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11423        if ((bprem1l <> zeros)
 11424           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11425                      or
 11426           ((bprem2l <> zeros)
 11427           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11428           move er-3456          to emi-error
 11429           perform 9900-error-format
 11430                                 thru 9900-exit
 11431           go to 1330-continue
 11432        end-if
 11433     end-if
 11434
 11435     if ws-new-iss-total > ws-tot-orig-prem
 11436        move er-3458             to emi-error
 11437        perform 9900-error-format thru 9900-exit
 11438        move al-uabon            to bmainta
 11439        move -1                  to bmaintl
 11440        go to 8200-send-dataonly
 11441     end-if
 11442
 11443     if ws-new-iss-total < ws-tot-orig-prem
 11444        move er-3457             to emi-error
 11445        move al-uabon            to bprem1a
 11446                                    bprem2a
 11447        move +0 to bprem1l bprem2l
 11448        perform 9900-error-format thru 9900-exit
 11449        move -1                  to bmaintl
 11450        go to 1330-continue
 11451     end-if
 11452
 11453     .
 11454 1330-continue.
 11455
 11456
 11457* EXEC CICS READ
 11458*        DATASET (FILE-ID-ERPNDB)
 11459*        INTO    (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 210
* EL6311.cbl
 11460*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11461*        UPDATE
 11462*    END-EXEC.
 11463     MOVE LENGTH OF
 11464      PENDING-BUSINESS
 11465       TO DFHEIV11
 11466*    MOVE '&"IL       EU         (   #00011071' TO DFHEIV0
 11467     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11469     MOVE X'2020233030303131303731' TO DFHEIV0(25:11)
 11470     CALL 'kxdfhei1' USING DFHEIV0,
 11471           FILE-ID-ERPNDB,
 11472           PENDING-BUSINESS,
 11473           DFHEIV11,
 11474           PI-PREV-CONTROL-PRIMARY,
 11475           DFHEIV99,
 11476           DFHEIV99,
 11477           DFHEIV99
 11478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11479
 11480
 11481     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11482     MOVE 'B'                    TO JP-RECORD-TYPE
 11483     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11484     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11485
 11486     PERFORM 8400-LOG-JOURNAL-RECORD.
 11487
 11488     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11489        PB-CHG-COUNT NOT = ZEROS
 11490        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11491            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11492           OR
 11493           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11494            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11495            MOVE LOW-VALUES             TO PB-BILLED-DT
 11496            ADD +1                      TO PB-CHG-COUNT.
 11497
 11498     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11499     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11500     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11501     MOVE '5'                    TO DC-OPTION-CODE.
 11502     PERFORM 9700-DATE-LINK
 11503     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11504
 11505*    IF BMICRNOL  GREATER  ZEROS
 11506*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11507
 11508     IF BVINL > ZEROS
 11509        MOVE BVINI               TO PB-I-VIN
 11510     END-IF
 11511     IF (BFORCEL NOT = ZEROS)
 11512        AND (PB-COMPANY-ID = 'DCC' or 'CAP')
 11513        AND (BFORCEI = ' ')
 11514        AND (PB-FORCE-CODE = 'O')
 11515        COMPUTE PB-I-AH-PREMIUM-AMT =
 11516           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11517        PERFORM 1800-REMOVE-CERT-NOTES
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 211
* EL6311.cbl
 11518                                 THRU 1800-EXIT
 11519        PERFORM 1900-DELETE-ERPYAJ
 11520                                 THRU 1900-EXIT
 11521        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11522     END-IF
 11523     IF (BFORCEL NOT = ZEROS)
 11524        AND (PB-COMPANY-ID = 'DCC' or 'CAP')
 11525        AND (BFORCEI = 'O')
 11526        AND (PB-FORCE-CODE NOT = 'O')
 11527        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11528           PB-I-AH-PREM-CALC
 11529        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11530        MOVE SPACE               TO DC-OPTION-CODE
 11531        PERFORM 9700-DATE-LINK
 11532        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11533        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11534        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11535        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11536        PERFORM 1500-UPDATE-ERNOTE
 11537                                 THRU 1500-EXIT
 11538        PERFORM 1600-UPDATE-ERPYAJ
 11539                                 THRU 1600-EXIT
 11540     END-IF
 11541     IF BLSTNML  GREATER THAN ZEROS
 11542         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11543
 11544     IF B1STNML  GREATER THAN ZEROS
 11545         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11546
 11547     IF BINITL   GREATER THAN ZEROS
 11548         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11549
 11550     IF BBIRTHL  GREATER THAN ZERO
 11551         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11552
 11553     IF B1STPMTL GREATER THAN ZERO
 11554         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11555
 11556     IF BAGEL    GREATER THAN ZEROS
 11557         MOVE BAGEI              TO PB-I-AGE.
 11558
 11559     MOVE 'N'                    TO WS-INS-AGE-SET
 11560                                    WS-JNT-AGE-SET.
 11561     IF BAGEL    GREATER THAN ZEROS
 11562        MOVE 'Y'                TO WS-INS-AGE-SET
 11563        IF BAGEI = ZERO AND
 11564             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11565           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11566           MOVE 'AGE*'          TO BAGEDEFO
 11567        ELSE
 11568           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11569           MOVE 'AGE '          TO BAGEDEFO
 11570        END-IF
 11571        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11572     END-IF.
 11573
 11574     IF BSEXL    GREATER THAN ZEROS
 11575         MOVE BSEXI              TO PB-I-INSURED-SEX.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 212
* EL6311.cbl
 11576
 11577     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11578        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11579
 11580     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11581        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11582
 11583     IF BLNTRML  GREATER THAN ZEROS
 11584         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11585
 11586     IF BFREQL   GREATER THAN ZEROS
 11587         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11588
 11589     IF BSKPCDL  GREATER THAN ZEROS
 11590         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11591
 11592     IF BMODEL   GREATER THAN ZEROS
 11593         MOVE BMODEI             TO PB-I-TERM-TYPE
 11594                                    PI-BMODE.
 11595
 11596     IF BPMTSL   GREATER THAN ZEROS
 11597         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11598                                    PI-BPMTS.
 11599
 11600     IF BPMTAMTL GREATER THAN ZEROS
 11601         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11602
 11603     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11604         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11605
 11606     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11607         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11608
 11609     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11610
 11611     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11612         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11613            SUBTRACT PB-I-LF-PREMIUM-AMT
 11614                     FROM WS-B-LF-ISS-PRM-ENTERED
 11615            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11616            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11617            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11618         ELSE
 11619            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11620*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11621*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11622         END-IF
 11623     END-IF.
 11624
 11625     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11626            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11627                     FROM WS-B-LF-ISS-PRM-ENTERED
 11628         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11629         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11630
 11631     IF  BALT-PREM-LEN     (2)  > ZEROS
 11632         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11633
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 213
* EL6311.cbl
 11634     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11635         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11636
 11637     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11638         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11639            SUBTRACT PB-I-AH-PREMIUM-AMT
 11640                     FROM WS-B-AH-ISS-PRM-ENTERED
 11641            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11642            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11643            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11644         ELSE
 11645            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11646*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11647*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11648         END-IF
 11649     END-IF
 11650
 11651     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11652        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11653
 11654     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11655        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11656
 11657     IF BINDGRPL            GREATER THAN ZEROS
 11658         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11659
 11660     IF BRTCLSL             GREATER THAN ZEROS
 11661         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11662
 11663     IF BSIGL               GREATER THAN ZEROS
 11664         MOVE BSIGI              TO PB-I-SIG-SW.
 11665
 11666     IF BAPRL               GREATER THAN ZEROS
 11667         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11668
 11669     IF BMEMBERL            GREATER THAN ZEROS
 11670         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11671
 11672     IF BLNOFCRL            GREATER THAN ZEROS
 11673         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11674
 11675     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11676        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11677
 11678     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11679        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11680
 11681     IF BDAYSL              GREATER THAN ZEROS
 11682        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11683                                    PB-I-EXTENTION-DAYS.
 11684
 11685     IF BDAYSL GREATER THAN ZEROS
 11686        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11687
 11688     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11689        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11690           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11691
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 214
* EL6311.cbl
 11692     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11693        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11694           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11695
 11696     IF B1STPMTL GREATER THAN ZEROS
 11697        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11698
 11699     IF PB-EXT-DAYS-PROCESSING
 11700        IF PB-I-EXTENTION-DAYS = ZEROS
 11701           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11702
 11703     IF PB-EXPIRE-DT-PROCESSING
 11704        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11705           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11706             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11707
 11708     IF PB-1ST-PMT-DT-PROCESSING
 11709        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11710           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11711
 11712     IF BREINL GREATER THAN ZEROS
 11713        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11714
 11715     IF BFORCEL NOT = ZEROS
 11716        MOVE BFORCEI             TO PB-FORCE-CODE.
 11717     IF (BENTRYL NOT = ZEROS)
 11718        AND (PB-COMPANY-ID = 'CID')
 11719        AND (PB-STATE = 'VA')
 11720        AND (BENTRYI NOT = 'P')
 11721        AND (PB-BATCH-ENTRY = 'P')
 11722        PERFORM 1800-REMOVE-CERT-NOTES
 11723                                 THRU 1800-EXIT
 11724     END-IF
 11725     IF BENTRYL NOT = ZEROS
 11726        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11727        IF PI-COMPANY-ID = 'CID'
 11728           AND (PB-BATCH-ENTRY = 'P')
 11729           AND (PB-STATE = 'VA')
 11730           PERFORM 1500-UPDATE-ERNOTE
 11731                                 THRU 1500-EXIT
 11732        END-IF
 11733     END-IF
 11734
 11735     IF BUNWRITL NOT = ZEROS
 11736        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11737
 11738     IF BBILCDL NOT = ZEROS
 11739        MOVE BBILCDI             TO PB-RECORD-BILL.
 11740
 11741     IF BLIVESL GREATER THAN ZEROS
 11742        MOVE WS-BLIVES           TO PB-I-LIVES.
 11743
 11744
 11745*DMD CUSTOM CODING*************START
 11746     IF PI-COMPANY-ID NOT = 'DMD'
 11747         MOVE ZEROS               TO BBILLEDL.
 11748*DMD CUSTOM CODING*************END
 11749
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 215
* EL6311.cbl
 11750     IF BBILLEDL GREATER THAN ZEROS
 11751        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11752
 11753
 11754*****************************************************************
 11755*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11756*****************************************************************
 11757
 11758     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11759        IF BTYPE  (1)   = ZEROS OR SPACES
 11760           IF REMOVE-LF-COVERAGE
 11761               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11762                                        PI-BTYPE (1)
 11763               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11764                                        WS-B-LF-ISS-PRM-ENTERED
 11765               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11766                                        WS-B-LF-ISS-PRM-ENTERED
 11767               SUBTRACT PB-I-LF-PREM-CALC FROM
 11768                                        WS-B-LF-ISS-PRM-COMPUTED
 11769               MOVE ZEROS            TO PB-I-LF-TERM
 11770                                        PB-I-LF-BENEFIT-AMT
 11771                                        PB-I-LF-PREMIUM-AMT
 11772                                        PB-I-LF-BENEFIT-CD
 11773                                        PB-I-LF-PREM-CALC
 11774                                        PB-I-LF-CRIT-PER
 11775                                        PB-I-LF-ALT-BENEFIT-AMT
 11776                                        PB-I-LF-ALT-PREMIUM-AMT
 11777               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11778           ELSE
 11779               NEXT SENTENCE
 11780        ELSE
 11781           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11782                                    PI-BTYPE (1).
 11783     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11784        IF BTYPE  (2)   = ZEROS OR SPACES
 11785           IF  REMOVE-AH-COVERAGE
 11786               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11787                                        PI-BTYPE (2)
 11788               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11789                                        WS-B-AH-ISS-PRM-ENTERED
 11790               SUBTRACT PB-I-AH-PREM-CALC FROM
 11791                                        WS-B-AH-ISS-PRM-COMPUTED
 11792               MOVE ZEROS            TO PB-I-AH-TERM
 11793                                        PB-I-AH-BENEFIT-AMT
 11794                                        PB-I-AH-PREMIUM-AMT
 11795                                        PB-I-AH-BENEFIT-CD
 11796                                        PB-I-AH-PREM-CALC
 11797                                        PB-I-AH-CRIT-PER
 11798               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11799           ELSE
 11800               NEXT SENTENCE
 11801        ELSE
 11802           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11803                                    PI-BTYPE (2).
 11804 1360-REWRITE-PB-RECORD.
 11805     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11806
 11807     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 216
* EL6311.cbl
 11808     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11809
 11810     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11811
 11812     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11813     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11814
 11815     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11816         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11817
 11818     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11819         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11820
 11821     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11822
 11823     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11824
 11825     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11826
 11827     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11828     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11829     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11830
 11831     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11832     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11833
 11834 1375-REWRITE-PB-RECORD.
 11835     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11836     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11837     MOVE 'C'                    TO JP-RECORD-TYPE.
 11838     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11839
 11840
 11841* EXEC CICS REWRITE
 11842*        DATASET (FILE-ID-ERPNDB)
 11843*        FROM    (PENDING-BUSINESS)
 11844*    END-EXEC.
 11845     MOVE LENGTH OF
 11846      PENDING-BUSINESS
 11847       TO DFHEIV11
 11848*    MOVE '&& L                  %   #00011437' TO DFHEIV0
 11849     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11850     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11851     MOVE X'2020233030303131343337' TO DFHEIV0(25:11)
 11852     CALL 'kxdfhei1' USING DFHEIV0,
 11853           FILE-ID-ERPNDB,
 11854           PENDING-BUSINESS,
 11855           DFHEIV11,
 11856           DFHEIV99
 11857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11858
 11859
 11860     PERFORM 8400-LOG-JOURNAL-RECORD.
 11861******************************************************************
 11862*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11863******************************************************************
 11864     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11865     MOVE ' '                    TO WS-ERMAIL-SW
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 217
* EL6311.cbl
 11866
 11867* EXEC CICS READ
 11868*       DATASET   (FILE-ID-ERMAIL)
 11869*       SET       (ADDRESS OF MAILING-DATA)
 11870*       RIDFLD    (ERMAIL-KEY)
 11871*       RESP      (WS-RESPONSE)
 11872*    END-EXEC
 11873*    MOVE '&"S        E          (  N#00011448' TO DFHEIV0
 11874     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11875     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11876     MOVE X'204E233030303131343438' TO DFHEIV0(25:11)
 11877     CALL 'kxdfhei1' USING DFHEIV0,
 11878           FILE-ID-ERMAIL,
 11879           DFHEIV20,
 11880           DFHEIV99,
 11881           ERMAIL-KEY,
 11882           DFHEIV99,
 11883           DFHEIV99,
 11884           DFHEIV99
 11885     SET ADDRESS OF MAILING-DATA TO
 11886         DFHEIV20
 11887     MOVE EIBRESP  TO WS-RESPONSE
 11888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11889     IF RESP-NORMAL
 11890        SET ERMAIL-FOUND TO TRUE
 11891     END-IF
 11892
 11893     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11894     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11895                                 TO ELCRTO-KEY
 11896     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11897     MOVE +0                     TO ELCRTO-SEQ-NO
 11898
 11899* EXEC CICS READ
 11900*       DATASET   ('ELCRTO')
 11901*       INTO      (ORIGINAL-CERTIFICATE)
 11902*       RIDFLD    (ELCRTO-KEY)
 11903*       GTEQ
 11904*       RESP      (WS-RESPONSE)
 11905*    END-EXEC
 11906     MOVE LENGTH OF
 11907      ORIGINAL-CERTIFICATE
 11908       TO DFHEIV11
 11909     MOVE 'ELCRTO' TO DFHEIV1
 11910*    MOVE '&"IL       G          (  N#00011463' TO DFHEIV0
 11911     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11912     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11913     MOVE X'204E233030303131343633' TO DFHEIV0(25:11)
 11914     CALL 'kxdfhei1' USING DFHEIV0,
 11915           DFHEIV1,
 11916           ORIGINAL-CERTIFICATE,
 11917           DFHEIV11,
 11918           ELCRTO-KEY,
 11919           DFHEIV99,
 11920           DFHEIV99,
 11921           DFHEIV99
 11922     MOVE EIBRESP  TO WS-RESPONSE
 11923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 218
* EL6311.cbl
 11924*    display ' just read gteq ' ws-response
 11925     IF RESP-NORMAL
 11926        AND (OC-CONTROL-PRIMARY (1:33) =
 11927                 PB-CONTROL-BY-ACCOUNT (1:33))
 11928        AND (OC-RECORD-TYPE = 'I')
 11929*       display ' resp norm, key =, type i '
 11930        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11931*          display ' end proc blank '
 11932           display ' csr edit session ' PI-CSR-SESSION-SW
 11933           IF NOT CSR-EDIT-SESSION
 11934
 11935* EXEC CICS READ
 11936*                DATASET   ('ELCRTO')
 11937*                INTO      (ORIGINAL-CERTIFICATE)
 11938*                RIDFLD    (OC-CONTROL-PRIMARY)
 11939*                UPDATE
 11940*                RESP      (WS-RESPONSE)
 11941*             END-EXEC
 11942     MOVE LENGTH OF
 11943      ORIGINAL-CERTIFICATE
 11944       TO DFHEIV11
 11945     MOVE 'ELCRTO' TO DFHEIV1
 11946*    MOVE '&"IL       EU         (  N#00011480' TO DFHEIV0
 11947     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11948     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11949     MOVE X'204E233030303131343830' TO DFHEIV0(25:11)
 11950     CALL 'kxdfhei1' USING DFHEIV0,
 11951           DFHEIV1,
 11952           ORIGINAL-CERTIFICATE,
 11953           DFHEIV11,
 11954           OC-CONTROL-PRIMARY,
 11955           DFHEIV99,
 11956           DFHEIV99,
 11957           DFHEIV99
 11958     MOVE EIBRESP  TO WS-RESPONSE
 11959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11960              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11961              IF RESP-NORMAL
 11962                 display ' good read upd '
 11963                 MOVE PB-I-INSURED-LAST-NAME TO
 11964                         OC-INS-LAST-NAME
 11965                 MOVE PB-I-INSURED-FIRST-NAME TO
 11966                         OC-INS-FIRST-NAME
 11967                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11968                         OC-INS-MIDDLE-INIT
 11969                 MOVE PB-I-AGE         TO OC-INS-AGE
 11970                 MOVE PB-I-JOINT-LAST-NAME   TO
 11971                         OC-JNT-LAST-NAME
 11972                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11973                         OC-JNT-FIRST-NAME
 11974                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11975                         OC-JNT-MIDDLE-INIT
 11976                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11977                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11978                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11979                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11980                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11981                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 219
* EL6311.cbl
 11982                         OC-LF-ALT-BEN-AMT
 11983                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11984                         OC-LF-ALT-PRM-AMT
 11985                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11986                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11987                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11988                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11989                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11990                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11991                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11992                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11993                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11994                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11995                 IF OC-CANCEL-TRAN-IND = 'N'
 11996                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11997                    MOVE +0            TO OC-LF-CANCEL-AMT
 11998                                          OC-LF-ITD-CANCEL-AMT
 11999                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12000                    MOVE +0            TO OC-AH-CANCEL-AMT
 12001                                          OC-AH-ITD-CANCEL-AMT
 12002                 END-IF
 12003                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12004                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12005                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12006                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12007                 IF ERMAIL-FOUND
 12008                    MOVE MA-CRED-BENE-NAME
 12009                                 TO OC-CRED-BENE-NAME
 12010                 END-IF
 12011                 IF NOT CERT-TRL-REC-NOT-FOUND
 12012                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12013                           OC-INS-AGE-DEFAULT-FLAG
 12014                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12015                           OC-JNT-AGE-DEFAULT-FLAG
 12016                 END-IF
 12017
 12018* EXEC CICS REWRITE
 12019*                   DATASET   ('ELCRTO')
 12020*                   FROM      (ORIGINAL-CERTIFICATE)
 12021*                   RESP      (WS-RESPONSE)
 12022*                END-EXEC
 12023     MOVE LENGTH OF
 12024      ORIGINAL-CERTIFICATE
 12025       TO DFHEIV11
 12026     MOVE 'ELCRTO' TO DFHEIV1
 12027*    MOVE '&& L                  %  N#00011544' TO DFHEIV0
 12028     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12029     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12030     MOVE X'204E233030303131353434' TO DFHEIV0(25:11)
 12031     CALL 'kxdfhei1' USING DFHEIV0,
 12032           DFHEIV1,
 12033           ORIGINAL-CERTIFICATE,
 12034           DFHEIV11,
 12035           DFHEIV99
 12036     MOVE EIBRESP  TO WS-RESPONSE
 12037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12038                 display ' just rewrote ' ws-response
 12039              END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 220
* EL6311.cbl
 12040           END-IF
 12041        ELSE
 12042           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12043           MOVE 'OC'             TO OC-RECORD-ID
 12044           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12045           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12046           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12047           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12048           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12049           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12050           MOVE PB-I-AGE         TO OC-INS-AGE
 12051           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12052           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12053           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12054           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12055           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12056           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12057           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12058           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12059           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12060           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12061           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12062           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12063           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12064           MOVE +0               TO OC-LF-CANCEL-AMT
 12065                                    OC-LF-ITD-CANCEL-AMT
 12066           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12067           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12068           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12069           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12070           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12071           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12072           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12073           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12074           MOVE +0               TO OC-AH-CANCEL-AMT
 12075                                    OC-AH-ITD-CANCEL-AMT
 12076           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12077           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12078           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12079           IF ERMAIL-FOUND
 12080              MOVE MA-CRED-BENE-NAME
 12081                                 TO OC-CRED-BENE-NAME
 12082           END-IF
 12083           IF NOT CERT-TRL-REC-NOT-FOUND
 12084              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12085                           OC-INS-AGE-DEFAULT-FLAG
 12086              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12087                           OC-JNT-AGE-DEFAULT-FLAG
 12088           END-IF
 12089           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12090
 12091* EXEC CICS WRITE
 12092*             DATASET   ('ELCRTO')
 12093*             FROM      (ORIGINAL-CERTIFICATE)
 12094*             RIDFLD    (OC-CONTROL-PRIMARY)
 12095*             RESP      (WS-RESPONSE)
 12096*          END-EXEC
 12097     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 221
* EL6311.cbl
 12098      ORIGINAL-CERTIFICATE
 12099       TO DFHEIV11
 12100     MOVE 'ELCRTO' TO DFHEIV1
 12101*    MOVE '&$ L                  ''  N#00011601' TO DFHEIV0
 12102     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12104     MOVE X'204E233030303131363031' TO DFHEIV0(25:11)
 12105     CALL 'kxdfhei1' USING DFHEIV0,
 12106           DFHEIV1,
 12107           ORIGINAL-CERTIFICATE,
 12108           DFHEIV11,
 12109           OC-CONTROL-PRIMARY,
 12110           DFHEIV99,
 12111           DFHEIV99
 12112     MOVE EIBRESP  TO WS-RESPONSE
 12113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12114        END-IF
 12115     ELSE
 12116        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12117        MOVE 'OC'                TO OC-RECORD-ID
 12118        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12119                                 TO OC-CONTROL-PRIMARY (1:33)
 12120        MOVE 'I'                 TO OC-RECORD-TYPE
 12121        MOVE +4096               TO OC-KEY-SEQ-NO
 12122        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12123        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12124        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12125        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12126        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12127        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12128        MOVE PB-I-AGE            TO OC-INS-AGE
 12129        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12130        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12131        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12132        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12133        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12134        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12135        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12136        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12137        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12138        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12139        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12140        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12141        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12142        MOVE +0                  TO OC-LF-CANCEL-AMT
 12143                                    OC-LF-ITD-CANCEL-AMT
 12144        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12145        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12146        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12147        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12148        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12149        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12150        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12151        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12152        MOVE +0                  TO OC-AH-CANCEL-AMT
 12153                                    OC-AH-ITD-CANCEL-AMT
 12154        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12155        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 222
* EL6311.cbl
 12156        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12157        IF ERMAIL-FOUND
 12158           MOVE MA-CRED-BENE-NAME
 12159                                 TO OC-CRED-BENE-NAME
 12160        END-IF
 12161        IF NOT CERT-TRL-REC-NOT-FOUND
 12162           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12163                           OC-INS-AGE-DEFAULT-FLAG
 12164           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12165                           OC-JNT-AGE-DEFAULT-FLAG
 12166        END-IF
 12167        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12168
 12169* EXEC CICS WRITE
 12170*          DATASET   ('ELCRTO')
 12171*          FROM      (ORIGINAL-CERTIFICATE)
 12172*          RIDFLD    (OC-CONTROL-PRIMARY)
 12173*          RESP      (WS-RESPONSE)
 12174*       END-EXEC
 12175     MOVE LENGTH OF
 12176      ORIGINAL-CERTIFICATE
 12177       TO DFHEIV11
 12178     MOVE 'ELCRTO' TO DFHEIV1
 12179*    MOVE '&$ L                  ''  N#00011661' TO DFHEIV0
 12180     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12182     MOVE X'204E233030303131363631' TO DFHEIV0(25:11)
 12183     CALL 'kxdfhei1' USING DFHEIV0,
 12184           DFHEIV1,
 12185           ORIGINAL-CERTIFICATE,
 12186           DFHEIV11,
 12187           OC-CONTROL-PRIMARY,
 12188           DFHEIV99,
 12189           DFHEIV99
 12190     MOVE EIBRESP  TO WS-RESPONSE
 12191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12192     END-IF
 12193******************************************************************
 12194*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12195******************************************************************
 12196
 12197     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12198     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12199
 12200
 12201* EXEC CICS READ
 12202*        INTO    (PENDING-BUSINESS)
 12203*        DATASET (FILE-ID-ERPNDB)
 12204*        RIDFLD  (ERPNDB-KEY)
 12205*        UPDATE
 12206*    END-EXEC.
 12207     MOVE LENGTH OF
 12208      PENDING-BUSINESS
 12209       TO DFHEIV11
 12210*    MOVE '&"IL       EU         (   #00011675' TO DFHEIV0
 12211     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12212     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12213     MOVE X'2020233030303131363735' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 223
* EL6311.cbl
 12214     CALL 'kxdfhei1' USING DFHEIV0,
 12215           FILE-ID-ERPNDB,
 12216           PENDING-BUSINESS,
 12217           DFHEIV11,
 12218           ERPNDB-KEY,
 12219           DFHEIV99,
 12220           DFHEIV99,
 12221           DFHEIV99
 12222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12223
 12224
 12225     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12226     MOVE 'B'                    TO JP-RECORD-TYPE.
 12227     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12228
 12229     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12230
 12231     PERFORM 8400-LOG-JOURNAL-RECORD.
 12232
 12233     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12234
 12235     MOVE 'C'                    TO JP-RECORD-TYPE.
 12236     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12237
 12238
 12239* EXEC CICS REWRITE
 12240*        DATASET    (FILE-ID-ERPNDB)
 12241*        FROM       (PENDING-BUSINESS)
 12242*    END-EXEC.
 12243     MOVE LENGTH OF
 12244      PENDING-BUSINESS
 12245       TO DFHEIV11
 12246*    MOVE '&& L                  %   #00011695' TO DFHEIV0
 12247     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12248     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12249     MOVE X'2020233030303131363935' TO DFHEIV0(25:11)
 12250     CALL 'kxdfhei1' USING DFHEIV0,
 12251           FILE-ID-ERPNDB,
 12252           PENDING-BUSINESS,
 12253           DFHEIV11,
 12254           DFHEIV99
 12255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12256
 12257
 12258     PERFORM 8400-LOG-JOURNAL-RECORD.
 12259
 12260     IF WS-ERRORS-PRESENT
 12261        GO TO 3900-RE-DISPLAY-RECORD.
 12262
 12263     MOVE ZEROS                  TO EMI-ERROR.
 12264     MOVE -1                     TO BMAINTL.
 12265     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12266     GO TO 3900-RE-DISPLAY-RECORD.
 12267
 12268 1380-BATCH-HDR-NOT-FOUND.
 12269     MOVE -1                     TO BMAINTL.
 12270     MOVE ER-7450                TO EMI-ERROR.
 12271     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 224
* EL6311.cbl
 12272     GO TO 8200-SEND-DATAONLY.
 12273
 12274 1385-REC-NOT-FOUND.
 12275     MOVE -1                     TO BMAINTL.
 12276     MOVE ER-7451                TO EMI-ERROR.
 12277     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12278     GO TO 8200-SEND-DATAONLY.
 12279
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 225
* EL6311.cbl
 12281
 12282 1386-UPDATE-AGE-FLAGS.
 12283
 12284
 12285* EXEC CICS GETMAIN
 12286*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12287*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12288*        INITIMG (GETMAIN-SPACE)
 12289*    END-EXEC
 12290*    MOVE ',"IL                  $   #00011726' TO DFHEIV0
 12291     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12292     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12293     MOVE X'2020233030303131373236' TO DFHEIV0(25:11)
 12294     CALL 'kxdfhei1' USING DFHEIV0,
 12295           DFHEIV20,
 12296           ELCRTT-RECORD-LENGTH,
 12297           GETMAIN-SPACE
 12298     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12299         DFHEIV20
 12300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12301
 12302
 12303* EXEC CICS HANDLE CONDITION
 12304*        NOTFND   (1386-NOTFND)
 12305*    END-EXEC.
 12306*    MOVE '"$I                   ! ( #00011732' TO DFHEIV0
 12307     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12309     MOVE X'2820233030303131373332' TO DFHEIV0(25:11)
 12310     CALL 'kxdfhei1' USING DFHEIV0
 12311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12312
 12313
 12314     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12315     MOVE 'C'                TO ELCRTT-REC-TYPE
 12316
 12317
 12318* EXEC CICS READ
 12319*        UPDATE
 12320*        DATASET  (CRTT-ID)
 12321*        RIDFLD   (ELCRTT-KEY)
 12322*        INTO     (CERTIFICATE-TRAILERS)
 12323*    END-EXEC.
 12324     MOVE LENGTH OF
 12325      CERTIFICATE-TRAILERS
 12326       TO DFHEIV11
 12327*    MOVE '&"IL       EU         (   #00011739' TO DFHEIV0
 12328     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12329     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12330     MOVE X'2020233030303131373339' TO DFHEIV0(25:11)
 12331     CALL 'kxdfhei1' USING DFHEIV0,
 12332           CRTT-ID,
 12333           CERTIFICATE-TRAILERS,
 12334           DFHEIV11,
 12335           ELCRTT-KEY,
 12336           DFHEIV99,
 12337           DFHEIV99,
 12338           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 226
* EL6311.cbl
 12339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12340
 12341
 12342     IF WS-INS-AGE-SET = 'Y'
 12343        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12344     END-IF
 12345     IF WS-JNT-AGE-SET = 'Y'
 12346        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12347     END-IF
 12348
 12349
 12350* EXEC CICS REWRITE
 12351*       DATASET  (CRTT-ID)
 12352*       FROM     (CERTIFICATE-TRAILERS)
 12353*    END-EXEC.
 12354     MOVE LENGTH OF
 12355      CERTIFICATE-TRAILERS
 12356       TO DFHEIV11
 12357*    MOVE '&& L                  %   #00011753' TO DFHEIV0
 12358     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12359     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12360     MOVE X'2020233030303131373533' TO DFHEIV0(25:11)
 12361     CALL 'kxdfhei1' USING DFHEIV0,
 12362           CRTT-ID,
 12363           CERTIFICATE-TRAILERS,
 12364           DFHEIV11,
 12365           DFHEIV99
 12366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12367
 12368
 12369     GO TO 1386-EXIT.
 12370
 12371 1386-NOTFND.
 12372
 12373     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12374     MOVE 'CS'         TO CS-RECORD-ID.
 12375     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12376     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12377     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12378     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12379     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12380
 12381* EXEC CICS WRITE
 12382*       DATASET  (CRTT-ID)
 12383*       RIDFLD   (ELCRTT-KEY)
 12384*       FROM     (CERTIFICATE-TRAILERS)
 12385*    END-EXEC.
 12386     MOVE LENGTH OF
 12387      CERTIFICATE-TRAILERS
 12388       TO DFHEIV11
 12389*    MOVE '&$ L                  ''   #00011769' TO DFHEIV0
 12390     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12391     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12392     MOVE X'2020233030303131373639' TO DFHEIV0(25:11)
 12393     CALL 'kxdfhei1' USING DFHEIV0,
 12394           CRTT-ID,
 12395           CERTIFICATE-TRAILERS,
 12396           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 227
* EL6311.cbl
 12397           ELCRTT-KEY,
 12398           DFHEIV99,
 12399           DFHEIV99
 12400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12401
 12402
 12403 1386-EXIT.
 12404     EXIT.
 12405
 12406 1390-UPDATE-ERPNDM.
 12407
 12408
 12409* EXEC CICS HANDLE CONDITION
 12410*        NOTFND (1399-EXIT)
 12411*    END-EXEC.
 12412*    MOVE '"$I                   ! ) #00011780' TO DFHEIV0
 12413     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12414     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12415     MOVE X'2920233030303131373830' TO DFHEIV0(25:11)
 12416     CALL 'kxdfhei1' USING DFHEIV0
 12417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12418
 12419
 12420     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12421
 12422
 12423* EXEC CICS READ
 12424*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12425*        DATASET (FILE-ID-ERPNDM)
 12426*        RIDFLD  (ERPNDM-KEY)
 12427*        UPDATE
 12428*    END-EXEC.
 12429*    MOVE '&"S        EU         (   #00011786' TO DFHEIV0
 12430     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12431     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12432     MOVE X'2020233030303131373836' TO DFHEIV0(25:11)
 12433     CALL 'kxdfhei1' USING DFHEIV0,
 12434           FILE-ID-ERPNDM,
 12435           DFHEIV20,
 12436           DFHEIV99,
 12437           ERPNDM-KEY,
 12438           DFHEIV99,
 12439           DFHEIV99,
 12440           DFHEIV99
 12441     SET ADDRESS OF PENDING-MAILING-DATA TO
 12442         DFHEIV20
 12443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12444
 12445
 12446     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12447     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12448     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12449
 12450     IF BLSTNML GREATER THAN ZEROS
 12451         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12452
 12453     IF B1STNML GREATER  THAN ZEROS
 12454         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 228
* EL6311.cbl
 12455
 12456     IF BINITL GREATER THAN ZEROS
 12457         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12458
 12459     IF BAGEL GREATER THAN ZEROS
 12460         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12461
 12462     IF BBIRTHL GREATER THAN ZEROS
 12463         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12464
 12465     IF BSEXL GREATER THAN ZEROS
 12466         MOVE  BSEXI             TO PM-INSURED-SEX.
 12467
 12468
 12469* EXEC CICS REWRITE
 12470*        DATASET (FILE-ID-ERPNDM)
 12471*        FROM    (PENDING-MAILING-DATA)
 12472*    END-EXEC.
 12473     MOVE LENGTH OF
 12474      PENDING-MAILING-DATA
 12475       TO DFHEIV11
 12476*    MOVE '&& L                  %   #00011815' TO DFHEIV0
 12477     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12478     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12479     MOVE X'2020233030303131383135' TO DFHEIV0(25:11)
 12480     CALL 'kxdfhei1' USING DFHEIV0,
 12481           FILE-ID-ERPNDM,
 12482           PENDING-MAILING-DATA,
 12483           DFHEIV11,
 12484           DFHEIV99
 12485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12486
 12487
 12488 1399-EXIT.
 12489     EXIT.
 12490
 12491******************************************************************
 12492*                                                                *
 12493*          D E L E T E   I S S U E   R O U T I N E               *
 12494*                                                                *
 12495******************************************************************
 12496
 12497 1400-DELETE-ISSUE-ROUTINE.
 12498     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12499
 12500     IF BCHGL NOT = ZEROS
 12501        MOVE ER-2196             TO EMI-ERROR
 12502        MOVE AL-UABON            TO BMAINTA
 12503        MOVE -1                  TO BMAINTL
 12504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12505        GO TO 8200-SEND-DATAONLY.
 12506
 12507
 12508* EXEC CICS HANDLE CONDITION
 12509*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12510*    END-EXEC.
 12511*    MOVE '"$I                   ! * #00011839' TO DFHEIV0
 12512     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 229
* EL6311.cbl
 12513     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12514     MOVE X'2A20233030303131383339' TO DFHEIV0(25:11)
 12515     CALL 'kxdfhei1' USING DFHEIV0
 12516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12517
 12518
 12519     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12520     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12521     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12522
 12523
 12524* EXEC CICS READ
 12525*        SET     (ADDRESS OF PENDING-BUSINESS)
 12526*        DATASET (FILE-ID-ERPNDB)
 12527*        RIDFLD  (ERPNDB-KEY)
 12528*    END-EXEC.
 12529*    MOVE '&"S        E          (   #00011847' TO DFHEIV0
 12530     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12532     MOVE X'2020233030303131383437' TO DFHEIV0(25:11)
 12533     CALL 'kxdfhei1' USING DFHEIV0,
 12534           FILE-ID-ERPNDB,
 12535           DFHEIV20,
 12536           DFHEIV99,
 12537           ERPNDB-KEY,
 12538           DFHEIV99,
 12539           DFHEIV99,
 12540           DFHEIV99
 12541     SET ADDRESS OF PENDING-BUSINESS TO
 12542         DFHEIV20
 12543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12544
 12545
 12546     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12547
 12548     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12549
 12550     IF BSUFIXL NOT = ZEROS
 12551        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12552     ELSE
 12553        MOVE SPACE               TO WS-NEW-SUFFIX.
 12554
 12555     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12556     PERFORM 8600-DEEDIT.
 12557     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12558     MOVE '4'                    TO DC-OPTION-CODE.
 12559     PERFORM 9700-DATE-LINK.
 12560     IF DATE-CONVERSION-ERROR
 12561        MOVE ER-0348             TO EMI-ERROR
 12562        MOVE -1                  TO BEFFDTL
 12563        MOVE AL-UABON            TO BEFFDTA
 12564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12565        GO TO 8200-SEND-DATAONLY
 12566     ELSE
 12567        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12568        MOVE AL-UANON            TO BEFFDTA
 12569        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12570
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 230
* EL6311.cbl
 12571
 12572* EXEC CICS HANDLE CONDITION
 12573*         NOTFND    (1490-RECORD-NOT-FOUND)
 12574*    END-EXEC.
 12575*    MOVE '"$I                   ! + #00011878' TO DFHEIV0
 12576     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12578     MOVE X'2B20233030303131383738' TO DFHEIV0(25:11)
 12579     CALL 'kxdfhei1' USING DFHEIV0
 12580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12581
 12582
 12583
 12584* EXEC CICS READ
 12585*        SET     (ADDRESS OF PENDING-BUSINESS)
 12586*        DATASET (FILE-ID-ERPNDB)
 12587*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12588*        UPDATE
 12589*    END-EXEC.
 12590*    MOVE '&"S        EU         (   #00011882' TO DFHEIV0
 12591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12593     MOVE X'2020233030303131383832' TO DFHEIV0(25:11)
 12594     CALL 'kxdfhei1' USING DFHEIV0,
 12595           FILE-ID-ERPNDB,
 12596           DFHEIV20,
 12597           DFHEIV99,
 12598           PI-PREV-CONTROL-PRIMARY,
 12599           DFHEIV99,
 12600           DFHEIV99,
 12601           DFHEIV99
 12602     SET ADDRESS OF PENDING-BUSINESS TO
 12603         DFHEIV20
 12604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12605
 12606
 12607     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12608        MOVE -1                 TO BMAINTL
 12609        MOVE ER-2197            TO EMI-ERROR
 12610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12611        GO TO 8200-SEND-DATAONLY.
 12612
 12613     IF PB-BILLED-DT NOT = LOW-VALUES
 12614        MOVE -1                 TO BMAINTL
 12615        MOVE ER-2129            TO EMI-ERROR
 12616        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12617        GO TO 8200-SEND-DATAONLY.
 12618
 12619     IF PB-CHG-COUNT NOT = ZEROS
 12620        MOVE ER-2336            TO EMI-ERROR
 12621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12622        MOVE AL-UABON            TO BMAINTA
 12623        MOVE -1                  TO BMAINTL
 12624        GO TO 8200-SEND-DATAONLY.
 12625
 12626     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12627        PB-CHG-COUNT NOT = ZEROS
 12628        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 231
* EL6311.cbl
 12629        MOVE AL-UABON            TO BMAINTA
 12630        MOVE -1                  TO BMAINTL
 12631        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12632        GO TO 8200-SEND-DATAONLY.
 12633******************************************************************
 12634*                                                                *
 12635*       Determine if there have been any checks created          *
 12636*                                                                *
 12637******************************************************************
 12638
 12639     perform 2500-browse-checks  thru 2500-exit
 12640
 12641     if i-have-processed-checks
 12642        or i-have-checks
 12643        or i-have-a-check-period
 12644        move er-3446             to emi-error
 12645        perform 9900-error-format thru 9900-exit
 12646        move al-uabon            to bmainta
 12647        move -1                  to bmaintl
 12648        go to 8200-send-dataonly
 12649     end-if
 12650******************************************************************
 12651*                                                                *
 12652*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12653*                                                                *
 12654******************************************************************
 12655     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12656     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12657     MOVE +0                     TO ELCRTO-SEQ-NO
 12658
 12659* EXEC CICS READ
 12660*       DATASET   ('ELCRTO')
 12661*       INTO      (ORIGINAL-CERTIFICATE)
 12662*       RIDFLD    (ELCRTO-KEY)
 12663*       GTEQ
 12664*       RESP      (WS-RESPONSE)
 12665*    END-EXEC
 12666     MOVE LENGTH OF
 12667      ORIGINAL-CERTIFICATE
 12668       TO DFHEIV11
 12669     MOVE 'ELCRTO' TO DFHEIV1
 12670*    MOVE '&"IL       G          (  N#00011940' TO DFHEIV0
 12671     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12672     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12673     MOVE X'204E233030303131393430' TO DFHEIV0(25:11)
 12674     CALL 'kxdfhei1' USING DFHEIV0,
 12675           DFHEIV1,
 12676           ORIGINAL-CERTIFICATE,
 12677           DFHEIV11,
 12678           ELCRTO-KEY,
 12679           DFHEIV99,
 12680           DFHEIV99,
 12681           DFHEIV99
 12682     MOVE EIBRESP  TO WS-RESPONSE
 12683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12684     IF RESP-NORMAL
 12685        AND (OC-CONTROL-PRIMARY (1:33) =
 12686                 PB-CONTROL-BY-ACCOUNT (1:33))
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 232
* EL6311.cbl
 12687        AND (OC-RECORD-TYPE = 'I')
 12688
 12689* EXEC CICS READ
 12690*          DATASET   ('ELCRTO')
 12691*          INTO      (ORIGINAL-CERTIFICATE)
 12692*          RIDFLD    (ELCRTO-KEY)
 12693*          UPDATE
 12694*          RESP      (WS-RESPONSE)
 12695*       END-EXEC
 12696     MOVE LENGTH OF
 12697      ORIGINAL-CERTIFICATE
 12698       TO DFHEIV11
 12699     MOVE 'ELCRTO' TO DFHEIV1
 12700*    MOVE '&"IL       EU         (  N#00011951' TO DFHEIV0
 12701     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12702     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12703     MOVE X'204E233030303131393531' TO DFHEIV0(25:11)
 12704     CALL 'kxdfhei1' USING DFHEIV0,
 12705           DFHEIV1,
 12706           ORIGINAL-CERTIFICATE,
 12707           DFHEIV11,
 12708           ELCRTO-KEY,
 12709           DFHEIV99,
 12710           DFHEIV99,
 12711           DFHEIV99
 12712     MOVE EIBRESP  TO WS-RESPONSE
 12713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12714        IF RESP-NORMAL
 12715
 12716* EXEC CICS DELETE
 12717*             DATASET   ('ELCRTO')
 12718*          END-EXEC
 12719     MOVE 'ELCRTO' TO DFHEIV1
 12720*    MOVE '&(                    &   #00011959' TO DFHEIV0
 12721     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12722     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12723     MOVE X'2020233030303131393539' TO DFHEIV0(25:11)
 12724     CALL 'kxdfhei1' USING DFHEIV0,
 12725           DFHEIV1,
 12726           DFHEIV99,
 12727           DFHEIV99,
 12728           DFHEIV99,
 12729           DFHEIV99
 12730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12731        END-IF
 12732     END-IF
 12733******************************************************************
 12734*                                                                *
 12735*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12736*                                                                *
 12737******************************************************************
 12738
 12739* EXEC CICS HANDLE CONDITION
 12740*        NOTFND    (1405-DELETE-CERTIFICATE)
 12741*    END-EXEC.
 12742*    MOVE '"$I                   ! , #00011969' TO DFHEIV0
 12743     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 233
* EL6311.cbl
 12745     MOVE X'2C20233030303131393639' TO DFHEIV0(25:11)
 12746     CALL 'kxdfhei1' USING DFHEIV0
 12747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12748
 12749
 12750
 12751* EXEC CICS READ
 12752*        EQUAL
 12753*        DATASET   (FILE-ID-ERPNDM)
 12754*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12755*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12756*        UPDATE
 12757*    END-EXEC.
 12758*    MOVE '&"S        EU         (   #00011973' TO DFHEIV0
 12759     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12760     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12761     MOVE X'2020233030303131393733' TO DFHEIV0(25:11)
 12762     CALL 'kxdfhei1' USING DFHEIV0,
 12763           FILE-ID-ERPNDM,
 12764           DFHEIV20,
 12765           DFHEIV99,
 12766           PI-PREV-CONTROL-PRIMARY,
 12767           DFHEIV99,
 12768           DFHEIV99,
 12769           DFHEIV99
 12770     SET ADDRESS OF PENDING-MAILING-DATA TO
 12771         DFHEIV20
 12772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12773
 12774
 12775     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12776     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12777     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12778
 12779     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12780
 12781
 12782* EXEC CICS DELETE
 12783*        DATASET   (FILE-ID-ERPNDM)
 12784*    END-EXEC.
 12785*    MOVE '&(                    &   #00011987' TO DFHEIV0
 12786     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12787     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12788     MOVE X'2020233030303131393837' TO DFHEIV0(25:11)
 12789     CALL 'kxdfhei1' USING DFHEIV0,
 12790           FILE-ID-ERPNDM,
 12791           DFHEIV99,
 12792           DFHEIV99,
 12793           DFHEIV99,
 12794           DFHEIV99
 12795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12796
 12797
 12798******************************************************************
 12799*                PROCESS   CERTIFICATE                           *
 12800******************************************************************
 12801
 12802 1405-DELETE-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 234
* EL6311.cbl
 12803
 12804* EXEC CICS HANDLE CONDITION
 12805*         NOTFND  (1420-CONTINUE-DELETE)
 12806*    END-EXEC.
 12807*    MOVE '"$I                   ! - #00011996' TO DFHEIV0
 12808     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12809     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12810     MOVE X'2D20233030303131393936' TO DFHEIV0(25:11)
 12811     CALL 'kxdfhei1' USING DFHEIV0
 12812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12813
 12814
 12815     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12816     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12817     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12818     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12819
 12820
 12821* EXEC CICS READ
 12822*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12823*        DATASET (FILE-ID-ELCERT)
 12824*        RIDFLD  (ELCERT-KEY)
 12825*        UPDATE
 12826*    END-EXEC.
 12827*    MOVE '&"S        EU         (   #00012005' TO DFHEIV0
 12828     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12829     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12830     MOVE X'2020233030303132303035' TO DFHEIV0(25:11)
 12831     CALL 'kxdfhei1' USING DFHEIV0,
 12832           FILE-ID-ELCERT,
 12833           DFHEIV20,
 12834           DFHEIV99,
 12835           ELCERT-KEY,
 12836           DFHEIV99,
 12837           DFHEIV99,
 12838           DFHEIV99
 12839     SET ADDRESS OF CERTIFICATE-MASTER TO
 12840         DFHEIV20
 12841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12842
 12843
 12844     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12845
 12846     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12847     MOVE 'B'                    TO JP-RECORD-TYPE
 12848     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12849
 12850     PERFORM 8400-LOG-JOURNAL-RECORD.
 12851
 12852     IF CERT-NOTES-ARE-NOT-PRESENT
 12853        MOVE ' '                 TO WS-CERT-NOTE-SW
 12854     ELSE
 12855        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12856
 12857     IF INSURED-ADDR-PRESENT
 12858        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12859
 12860******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 235
* EL6311.cbl
 12861******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12862******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12863******************************************************************
 12864******************************************************************
 12865
 12866     IF CERT-ADDED-BATCH AND
 12867        (NOT NO-CLAIM-ATTACHED
 12868         OR
 12869         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12870        GO TO 1410-REWRITE-CERT.
 12871
 12872******************************************************************
 12873******************************************************************
 12874
 12875     IF CERT-ADDED-BATCH  AND
 12876        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12877        GO TO 1410-REWRITE-CERT.
 12878
 12879     IF NO-CLAIM-ATTACHED
 12880        NEXT SENTENCE
 12881     ELSE
 12882        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12883        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12884        GO TO 1410-REWRITE-CERT.
 12885
 12886     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12887     MOVE 'D'                      TO JP-RECORD-TYPE.
 12888     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12889
 12890
 12891* EXEC CICS DELETE
 12892*         DATASET    (FILE-ID-ELCERT)
 12893*    END-EXEC.
 12894*    MOVE '&(                    &   #00012058' TO DFHEIV0
 12895     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12896     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12897     MOVE X'2020233030303132303538' TO DFHEIV0(25:11)
 12898     CALL 'kxdfhei1' USING DFHEIV0,
 12899           FILE-ID-ELCERT,
 12900           DFHEIV99,
 12901           DFHEIV99,
 12902           DFHEIV99,
 12903           DFHEIV99
 12904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12905
 12906
 12907     PERFORM 8400-LOG-JOURNAL-RECORD.
 12908
 12909******************************************************************
 12910*                                                                *
 12911*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12912*                                                                *
 12913******************************************************************
 12914
 12915     IF  CERT-NOTES-ARE-PRESENT
 12916         NEXT SENTENCE
 12917     ELSE
 12918         GO TO 1407-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 236
* EL6311.cbl
 12919
 12920
 12921* EXEC CICS HANDLE CONDITION
 12922*         NOTFND  (1406-DELETE-ERNOTE)
 12923*    END-EXEC.
 12924*    MOVE '"$I                   ! . #00012075' TO DFHEIV0
 12925     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12927     MOVE X'2E20233030303132303735' TO DFHEIV0(25:11)
 12928     CALL 'kxdfhei1' USING DFHEIV0
 12929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12930
 12931
 12932     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12933     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12934     MOVE 0                     TO ERCNOT-SEQUENCE.
 12935
 12936 1406-DELETE-ERCNOT-LOOP.
 12937
 12938
 12939* EXEC CICS READ
 12940*        GTEQ
 12941*        DATASET   (FILE-ID-ERCNOT)
 12942*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12943*        RIDFLD    (ERCNOT-KEY)
 12944*    END-EXEC.
 12945*    MOVE '&"S        G          (   #00012085' TO DFHEIV0
 12946     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12948     MOVE X'2020233030303132303835' TO DFHEIV0(25:11)
 12949     CALL 'kxdfhei1' USING DFHEIV0,
 12950           FILE-ID-ERCNOT,
 12951           DFHEIV20,
 12952           DFHEIV99,
 12953           ERCNOT-KEY,
 12954           DFHEIV99,
 12955           DFHEIV99,
 12956           DFHEIV99
 12957     SET ADDRESS OF CERT-NOTE-FILE TO
 12958         DFHEIV20
 12959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12960
 12961
 12962     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12963     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12964         GO TO 1406-DELETE-ERNOTE
 12965     END-IF.
 12966
 12967     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12968     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12969     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12970
 12971     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12972
 12973
 12974* EXEC CICS DELETE
 12975*        DATASET   (FILE-ID-ERCNOT)
 12976*        RIDFLD    (ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 237
* EL6311.cbl
 12977*        END-EXEC.
 12978*    MOVE '&(  R                 &   #00012103' TO DFHEIV0
 12979     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12980     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12981     MOVE X'2020233030303132313033' TO DFHEIV0(25:11)
 12982     CALL 'kxdfhei1' USING DFHEIV0,
 12983           FILE-ID-ERCNOT,
 12984           ERCNOT-KEY,
 12985           DFHEIV99,
 12986           DFHEIV99,
 12987           DFHEIV99
 12988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12989
 12990
 12991     PERFORM 8400-LOG-JOURNAL-RECORD.
 12992
 12993     GO TO 1406-DELETE-ERCNOT-LOOP.
 12994
 12995 1406-DELETE-ERNOTE.
 12996
 12997
 12998* EXEC CICS HANDLE CONDITION
 12999*         NOTFND  (1407-DELETE-MAILING)
 13000*    END-EXEC.
 13001*    MOVE '"$I                   ! / #00012114' TO DFHEIV0
 13002     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13004     MOVE X'2F20233030303132313134' TO DFHEIV0(25:11)
 13005     CALL 'kxdfhei1' USING DFHEIV0
 13006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13007
 13008
 13009
 13010* EXEC CICS READ
 13011*        EQUAL
 13012*        DATASET   (FILE-ID-ERNOTE)
 13013*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13014*        RIDFLD    (ELCERT-KEY)
 13015*        UPDATE
 13016*    END-EXEC.
 13017*    MOVE '&"S        EU         (   #00012118' TO DFHEIV0
 13018     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13019     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13020     MOVE X'2020233030303132313138' TO DFHEIV0(25:11)
 13021     CALL 'kxdfhei1' USING DFHEIV0,
 13022           FILE-ID-ERNOTE,
 13023           DFHEIV20,
 13024           DFHEIV99,
 13025           ELCERT-KEY,
 13026           DFHEIV99,
 13027           DFHEIV99,
 13028           DFHEIV99
 13029     SET ADDRESS OF CERTIFICATE-NOTE TO
 13030         DFHEIV20
 13031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13032
 13033
 13034     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 238
* EL6311.cbl
 13035     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13036     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13037
 13038     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13039
 13040
 13041* EXEC CICS DELETE
 13042*        DATASET   (FILE-ID-ERNOTE)
 13043*        END-EXEC.
 13044*    MOVE '&(                    &   #00012132' TO DFHEIV0
 13045     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13046     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13047     MOVE X'2020233030303132313332' TO DFHEIV0(25:11)
 13048     CALL 'kxdfhei1' USING DFHEIV0,
 13049           FILE-ID-ERNOTE,
 13050           DFHEIV99,
 13051           DFHEIV99,
 13052           DFHEIV99,
 13053           DFHEIV99
 13054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13055
 13056
 13057     PERFORM 8400-LOG-JOURNAL-RECORD.
 13058
 13059******************************************************************
 13060*                                                                *
 13061*                DELETE MAILING ADDRESS RECORDS                  *
 13062*                                                                *
 13063******************************************************************
 13064
 13065 1407-DELETE-MAILING.
 13066     IF CERT-ADDRESS-PRESENT
 13067        NEXT SENTENCE
 13068     ELSE
 13069        GO TO 1420-CONTINUE-DELETE.
 13070
 13071
 13072* EXEC CICS HANDLE CONDITION
 13073*         NOTFND  (1420-CONTINUE-DELETE)
 13074*    END-EXEC.
 13075*    MOVE '"$I                   ! 0 #00012150' TO DFHEIV0
 13076     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13078     MOVE X'3020233030303132313530' TO DFHEIV0(25:11)
 13079     CALL 'kxdfhei1' USING DFHEIV0
 13080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13081
 13082
 13083
 13084* EXEC CICS READ
 13085*        EQUAL
 13086*        DATASET   (FILE-ID-ERMAIL)
 13087*        SET       (ADDRESS OF MAILING-DATA)
 13088*        RIDFLD    (ELCERT-KEY)
 13089*        UPDATE
 13090*    END-EXEC.
 13091*    MOVE '&"S        EU         (   #00012154' TO DFHEIV0
 13092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 239
* EL6311.cbl
 13093     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13094     MOVE X'2020233030303132313534' TO DFHEIV0(25:11)
 13095     CALL 'kxdfhei1' USING DFHEIV0,
 13096           FILE-ID-ERMAIL,
 13097           DFHEIV20,
 13098           DFHEIV99,
 13099           ELCERT-KEY,
 13100           DFHEIV99,
 13101           DFHEIV99,
 13102           DFHEIV99
 13103     SET ADDRESS OF MAILING-DATA TO
 13104         DFHEIV20
 13105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13106
 13107
 13108     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13109     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13110     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13111
 13112     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13113
 13114
 13115* EXEC CICS DELETE
 13116*        DATASET   (FILE-ID-ERMAIL)
 13117*    END-EXEC.
 13118*    MOVE '&(                    &   #00012168' TO DFHEIV0
 13119     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13121     MOVE X'2020233030303132313638' TO DFHEIV0(25:11)
 13122     CALL 'kxdfhei1' USING DFHEIV0,
 13123           FILE-ID-ERMAIL,
 13124           DFHEIV99,
 13125           DFHEIV99,
 13126           DFHEIV99,
 13127           DFHEIV99
 13128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13129
 13130
 13131     GO TO 1420-CONTINUE-DELETE.
 13132
 13133 1410-REWRITE-CERT.
 13134     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13135     MOVE 'C'                      TO JP-RECORD-TYPE.
 13136     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13137     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13138
 13139
 13140* EXEC CICS REWRITE
 13141*         DATASET    (FILE-ID-ELCERT)
 13142*         FROM       (CERTIFICATE-MASTER)
 13143*         END-EXEC.
 13144     MOVE LENGTH OF
 13145      CERTIFICATE-MASTER
 13146       TO DFHEIV11
 13147*    MOVE '&& L                  %   #00012180' TO DFHEIV0
 13148     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13149     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13150     MOVE X'2020233030303132313830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 240
* EL6311.cbl
 13151     CALL 'kxdfhei1' USING DFHEIV0,
 13152           FILE-ID-ELCERT,
 13153           CERTIFICATE-MASTER,
 13154           DFHEIV11,
 13155           DFHEIV99
 13156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13157
 13158
 13159     PERFORM 8400-LOG-JOURNAL-RECORD.
 13160
 13161 1420-CONTINUE-DELETE.
 13162     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13163     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13164
 13165     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13166     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13167
 13168     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13169
 13170 1450-DELETE-PB-RECORD.
 13171     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13172     MOVE 'D'                      TO JP-RECORD-TYPE
 13173     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13174
 13175
 13176* EXEC CICS DELETE
 13177*        DATASET    (FILE-ID-ERPNDB)
 13178*    END-EXEC.
 13179*    MOVE '&(                    &   #00012201' TO DFHEIV0
 13180     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13181     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13182     MOVE X'2020233030303132323031' TO DFHEIV0(25:11)
 13183     CALL 'kxdfhei1' USING DFHEIV0,
 13184           FILE-ID-ERPNDB,
 13185           DFHEIV99,
 13186           DFHEIV99,
 13187           DFHEIV99,
 13188           DFHEIV99
 13189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13190
 13191
 13192     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13193
 13194     PERFORM 8400-LOG-JOURNAL-RECORD.
 13195
 13196     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13197     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13198     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13199
 13200
 13201* EXEC CICS HANDLE CONDITION
 13202*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13203*    END-EXEC.
 13204*    MOVE '"$I                   ! 1 #00012213' TO DFHEIV0
 13205     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13207     MOVE X'3120233030303132323133' TO DFHEIV0(25:11)
 13208     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 241
* EL6311.cbl
 13209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13210
 13211
 13212
 13213* EXEC CICS READ
 13214*        SET     (ADDRESS OF PENDING-BUSINESS)
 13215*        DATASET (FILE-ID-ERPNDB)
 13216*        RIDFLD  (ERPNDB-KEY)
 13217*        UPDATE
 13218*    END-EXEC.
 13219*    MOVE '&"S        EU         (   #00012217' TO DFHEIV0
 13220     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13221     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13222     MOVE X'2020233030303132323137' TO DFHEIV0(25:11)
 13223     CALL 'kxdfhei1' USING DFHEIV0,
 13224           FILE-ID-ERPNDB,
 13225           DFHEIV20,
 13226           DFHEIV99,
 13227           ERPNDB-KEY,
 13228           DFHEIV99,
 13229           DFHEIV99,
 13230           DFHEIV99
 13231     SET ADDRESS OF PENDING-BUSINESS TO
 13232         DFHEIV20
 13233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13234
 13235
 13236     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13237
 13238     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13239
 13240     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13241        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13242        MOVE 'D'                   TO JP-RECORD-TYPE
 13243        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13244
 13245* EXEC CICS DELETE
 13246*            DATASET    (FILE-ID-ERPNDB)
 13247*       END-EXEC
 13248*    MOVE '&(                    &   #00012232' TO DFHEIV0
 13249     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13250     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13251     MOVE X'2020233030303132323332' TO DFHEIV0(25:11)
 13252     CALL 'kxdfhei1' USING DFHEIV0,
 13253           FILE-ID-ERPNDB,
 13254           DFHEIV99,
 13255           DFHEIV99,
 13256           DFHEIV99,
 13257           DFHEIV99
 13258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13259        PERFORM 8400-LOG-JOURNAL-RECORD
 13260     ELSE
 13261        MOVE 'B'                 TO JP-RECORD-TYPE
 13262        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13263        PERFORM 8400-LOG-JOURNAL-RECORD
 13264        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13265        MOVE 'C'                 TO JP-RECORD-TYPE
 13266        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 242
* EL6311.cbl
 13267
 13268* EXEC CICS REWRITE
 13269*            DATASET    (FILE-ID-ERPNDB)
 13270*            FROM       (PENDING-BUSINESS)
 13271*       END-EXEC
 13272     MOVE LENGTH OF
 13273      PENDING-BUSINESS
 13274       TO DFHEIV11
 13275*    MOVE '&& L                  %   #00012243' TO DFHEIV0
 13276     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13277     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13278     MOVE X'2020233030303132323433' TO DFHEIV0(25:11)
 13279     CALL 'kxdfhei1' USING DFHEIV0,
 13280           FILE-ID-ERPNDB,
 13281           PENDING-BUSINESS,
 13282           DFHEIV11,
 13283           DFHEIV99
 13284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13285        PERFORM 8400-LOG-JOURNAL-RECORD.
 13286
 13287******************************************************************
 13288*                                                                *
 13289*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13290*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13291*                                                                *
 13292******************************************************************
 13293
 13294     IF NOT PI-AR-PROCESSING
 13295        GO TO 1475-DELETE-FINISHED.
 13296
 13297     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13298        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13299        NEXT SENTENCE
 13300     ELSE
 13301        GO TO 1475-DELETE-FINISHED.
 13302
 13303
 13304* EXEC CICS HANDLE CONDITION
 13305*         NOTFND    (1475-DELETE-FINISHED)
 13306*         END-EXEC.
 13307*    MOVE '"$I                   ! 2 #00012265' TO DFHEIV0
 13308     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13310     MOVE X'3220233030303132323635' TO DFHEIV0(25:11)
 13311     CALL 'kxdfhei1' USING DFHEIV0
 13312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13313
 13314
 13315     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13316     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13317
 13318
 13319* EXEC CICS READ
 13320*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13321*        DATASET (FILE-ID-ERRQST)
 13322*        RIDFLD  (ERRQST-KEY)
 13323*        UPDATE
 13324*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 243
* EL6311.cbl
 13325*    MOVE '&"S        EU         (   #00012272' TO DFHEIV0
 13326     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13327     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13328     MOVE X'2020233030303132323732' TO DFHEIV0(25:11)
 13329     CALL 'kxdfhei1' USING DFHEIV0,
 13330           FILE-ID-ERRQST,
 13331           DFHEIV20,
 13332           DFHEIV99,
 13333           ERRQST-KEY,
 13334           DFHEIV99,
 13335           DFHEIV99,
 13336           DFHEIV99
 13337     SET ADDRESS OF AR-REQUEST-RECORD TO
 13338         DFHEIV20
 13339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13340
 13341
 13342     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13343
 13344     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13345
 13346     MOVE 'D'                      TO JP-RECORD-TYPE.
 13347     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13348
 13349
 13350* EXEC CICS DELETE
 13351*         DATASET    (FILE-ID-ERRQST)
 13352*    END-EXEC.
 13353*    MOVE '&(                    &   #00012286' TO DFHEIV0
 13354     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13355     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13356     MOVE X'2020233030303132323836' TO DFHEIV0(25:11)
 13357     CALL 'kxdfhei1' USING DFHEIV0,
 13358           FILE-ID-ERRQST,
 13359           DFHEIV99,
 13360           DFHEIV99,
 13361           DFHEIV99,
 13362           DFHEIV99
 13363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13364
 13365
 13366     PERFORM 8400-LOG-JOURNAL-RECORD.
 13367
 13368 1475-DELETE-FINISHED.
 13369     MOVE ZEROS                  TO EMI-ERROR.
 13370     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13371     MOVE LOW-VALUES             TO EL631BI.
 13372     MOVE -1                     TO BMAINTL.
 13373     GO TO 8100-SEND-INITIAL-MAP.
 13374
 13375 1480-BATCH-HDR-NOT-FOUND.
 13376     MOVE -1                     TO BMAINTL.
 13377     MOVE ER-7450                TO EMI-ERROR.
 13378     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13379     GO TO 8200-SEND-DATAONLY.
 13380
 13381 1490-RECORD-NOT-FOUND.
 13382     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 244
* EL6311.cbl
 13383     MOVE ER-7451                TO EMI-ERROR.
 13384     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13385     GO TO 8200-SEND-DATAONLY.
 13386
 13387******************************************************************
 13388*            O V E R   C H A R G E   P R O C E S S I N G         *
 13389******************************************************************
 13390 1500-UPDATE-ERNOTE.
 13391     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13392     MOVE 'A'                    TO WS-NOTE-SW
 13393     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13394     .
 13395 1500-EXIT.
 13396     EXIT.
 13397 1510-ADD-ERNOTE-REC.
 13398
 13399* EXEC CICS GETMAIN
 13400*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13401*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13402*        INITIMG (GETMAIN-SPACE)
 13403*    END-EXEC
 13404*    MOVE ',"IL                  $   #00012322' TO DFHEIV0
 13405     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13406     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13407     MOVE X'2020233030303132333232' TO DFHEIV0(25:11)
 13408     CALL 'kxdfhei1' USING DFHEIV0,
 13409           DFHEIV20,
 13410           ERNOTE-RECORD-LENGTH,
 13411           GETMAIN-SPACE
 13412     SET ADDRESS OF CERTIFICATE-NOTE TO
 13413         DFHEIV20
 13414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13415     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13416                                 TO ERNOTE-KEY
 13417
 13418* EXEC CICS READ
 13419*       DATASET    (FILE-ID-ERNOTE)
 13420*       RIDFLD     (ERNOTE-KEY)
 13421*       INTO       (CERTIFICATE-NOTE)
 13422*       RESP       (WS-RESPONSE)
 13423*       UPDATE
 13424*    END-EXEC
 13425     MOVE LENGTH OF
 13426      CERTIFICATE-NOTE
 13427       TO DFHEIV11
 13428*    MOVE '&"IL       EU         (  N#00012329' TO DFHEIV0
 13429     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13430     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13431     MOVE X'204E233030303132333239' TO DFHEIV0(25:11)
 13432     CALL 'kxdfhei1' USING DFHEIV0,
 13433           FILE-ID-ERNOTE,
 13434           CERTIFICATE-NOTE,
 13435           DFHEIV11,
 13436           ERNOTE-KEY,
 13437           DFHEIV99,
 13438           DFHEIV99,
 13439           DFHEIV99
 13440     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 245
* EL6311.cbl
 13441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13442     IF RESP-NORMAL
 13443        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13444           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13445        END-IF
 13446        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13447           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13448        END-IF
 13449        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13450           (N1 > +10)
 13451           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13452           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13453        END-PERFORM
 13454        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13455          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13456
 13457* EXEC CICS UNLOCK
 13458*            DATASET    (FILE-ID-ERNOTE)
 13459*          END-EXEC
 13460*    MOVE '&*                    #   #00012350' TO DFHEIV0
 13461     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13462     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13463     MOVE X'2020233030303132333530' TO DFHEIV0(25:11)
 13464     CALL 'kxdfhei1' USING DFHEIV0,
 13465           FILE-ID-ERNOTE,
 13466           DFHEIV99
 13467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13468        ELSE
 13469          PERFORM VARYING N1 FROM +1 BY +1
 13470           UNTIL (N1 > +10)
 13471           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13472          END-PERFORM
 13473          IF (N1 < +11)
 13474            IF N1 >= CN-BILLING-START-LINE-NO AND
 13475              N1 <= CN-BILLING-END-LINE-NO
 13476              IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13477                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13478              ELSE
 13479                 MOVE WS-VA-NO-COMM-MESS
 13480                                    TO CN-LINE (N1)
 13481              END-IF
 13482            ELSE
 13483              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13484               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13485                IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13486                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13487                ELSE
 13488                  MOVE WS-VA-NO-COMM-MESS
 13489                                    TO CN-LINE (N1)
 13490                END-IF
 13491                MOVE N1             TO CN-BILLING-END-LINE-NO
 13492              ELSE
 13493                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13494                  IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13495                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13496                  ELSE
 13497                     MOVE WS-VA-NO-COMM-MESS
 13498                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 246
* EL6311.cbl
 13499                  END-IF
 13500                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13501                                      CN-BILLING-START-LINE-NO
 13502                ELSE
 13503                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13504                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13505                     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13506                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13507                     ELSE
 13508                       MOVE WS-VA-NO-COMM-MESS
 13509                                    TO CN-LINE (N1)
 13510                     END-IF
 13511                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13512                  ELSE
 13513                     PERFORM 1700-SQUEEZE-IT-IN
 13514                                 THRU 1700-EXIT
 13515                  END-IF
 13516                END-IF
 13517              END-IF
 13518            END-IF
 13519            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13520            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13521            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13522
 13523* EXEC CICS REWRITE
 13524*              DATASET    (FILE-ID-ERNOTE)
 13525*              FROM       (CERTIFICATE-NOTE)
 13526*              RESP       (WS-RESPONSE)
 13527*           END-EXEC
 13528     MOVE LENGTH OF
 13529      CERTIFICATE-NOTE
 13530       TO DFHEIV11
 13531*    MOVE '&& L                  %  N#00012407' TO DFHEIV0
 13532     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13533     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13534     MOVE X'204E233030303132343037' TO DFHEIV0(25:11)
 13535     CALL 'kxdfhei1' USING DFHEIV0,
 13536           FILE-ID-ERNOTE,
 13537           CERTIFICATE-NOTE,
 13538           DFHEIV11,
 13539           DFHEIV99
 13540     MOVE EIBRESP  TO WS-RESPONSE
 13541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13542          END-IF
 13543        END-IF
 13544     ELSE
 13545        MOVE SPACES              TO CERTIFICATE-NOTE
 13546        MOVE 'CN'                TO CN-RECORD-ID
 13547        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13548                                 TO CN-CONTROL-PRIMARY
 13549                                    ERNOTE-KEY
 13550        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13551                                    CN-BILLING-END-LINE-NO
 13552        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13553           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13554        ELSE
 13555           MOVE WS-VA-NO-COMM-MESS
 13556                                 TO CN-LINE (1)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 247
* EL6311.cbl
 13557        END-IF
 13558        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13559        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13560        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13561
 13562* EXEC CICS WRITE
 13563*          DATASET    (FILE-ID-ERNOTE)
 13564*          FROM       (CERTIFICATE-NOTE)
 13565*          RIDFLD     (ERNOTE-KEY)
 13566*          RESP       (WS-RESPONSE)
 13567*       END-EXEC
 13568     MOVE LENGTH OF
 13569      CERTIFICATE-NOTE
 13570       TO DFHEIV11
 13571*    MOVE '&$ L                  ''  N#00012431' TO DFHEIV0
 13572     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13573     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13574     MOVE X'204E233030303132343331' TO DFHEIV0(25:11)
 13575     CALL 'kxdfhei1' USING DFHEIV0,
 13576           FILE-ID-ERNOTE,
 13577           CERTIFICATE-NOTE,
 13578           DFHEIV11,
 13579           ERNOTE-KEY,
 13580           DFHEIV99,
 13581           DFHEIV99
 13582     MOVE EIBRESP  TO WS-RESPONSE
 13583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13584     END-IF
 13585     .
 13586 1510-EXIT.
 13587     EXIT.
 13588 1520-UPDATE-ELCERT.
 13589     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13590                                 TO ELCERT-KEY
 13591
 13592* EXEC CICS READ
 13593*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13594*        DATASET (FILE-ID-ELCERT)
 13595*        RIDFLD  (ELCERT-KEY)
 13596*        UPDATE
 13597*        RESP    (WS-RESPONSE)
 13598*    END-EXEC
 13599*    MOVE '&"S        EU         (  N#00012444' TO DFHEIV0
 13600     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13601     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13602     MOVE X'204E233030303132343434' TO DFHEIV0(25:11)
 13603     CALL 'kxdfhei1' USING DFHEIV0,
 13604           FILE-ID-ELCERT,
 13605           DFHEIV20,
 13606           DFHEIV99,
 13607           ELCERT-KEY,
 13608           DFHEIV99,
 13609           DFHEIV99,
 13610           DFHEIV99
 13611     SET ADDRESS OF CERTIFICATE-MASTER TO
 13612         DFHEIV20
 13613     MOVE EIBRESP  TO WS-RESPONSE
 13614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 248
* EL6311.cbl
 13615     IF RESP-NORMAL
 13616        IF WS-NOTE-SW = 'A'
 13617           IF CM-NOTE-SW = ' '
 13618              MOVE '2'             TO CM-NOTE-SW
 13619           ELSE
 13620             IF CM-NOTE-SW = '1'
 13621                MOVE '3'           TO CM-NOTE-SW
 13622             ELSE
 13623               IF CM-NOTE-SW = '4'
 13624                  MOVE '6'         TO CM-NOTE-SW
 13625               ELSE
 13626                 IF CM-NOTE-SW = '5'
 13627                    MOVE '7'       TO CM-NOTE-SW
 13628                 END-IF
 13629               END-IF
 13630             END-IF
 13631           END-IF
 13632        ELSE
 13633           IF CM-NOTE-SW = '2'
 13634              MOVE ' '             TO CM-NOTE-SW
 13635           ELSE
 13636             IF CM-NOTE-SW = '3'
 13637                MOVE '1'           TO CM-NOTE-SW
 13638             ELSE
 13639               IF CM-NOTE-SW = '6'
 13640                  MOVE '4'         TO CM-NOTE-SW
 13641               ELSE
 13642                 IF CM-NOTE-SW = '7'
 13643                    MOVE '5'       TO CM-NOTE-SW
 13644                 END-IF
 13645               END-IF
 13646             END-IF
 13647           END-IF
 13648        END-IF
 13649
 13650* EXEC CICS REWRITE
 13651*          DATASET    (FILE-ID-ELCERT)
 13652*          FROM       (CERTIFICATE-MASTER)
 13653*          RESP       (WS-RESPONSE)
 13654*       END-EXEC
 13655     MOVE LENGTH OF
 13656      CERTIFICATE-MASTER
 13657       TO DFHEIV11
 13658*    MOVE '&& L                  %  N#00012485' TO DFHEIV0
 13659     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13660     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13661     MOVE X'204E233030303132343835' TO DFHEIV0(25:11)
 13662     CALL 'kxdfhei1' USING DFHEIV0,
 13663           FILE-ID-ELCERT,
 13664           CERTIFICATE-MASTER,
 13665           DFHEIV11,
 13666           DFHEIV99
 13667     MOVE EIBRESP  TO WS-RESPONSE
 13668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13669        IF RESP-NORMAL
 13670           CONTINUE
 13671        ELSE
 13672           MOVE WS-RESPONSE TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 249
* EL6311.cbl
 13673           PERFORM 9900-ERROR-FORMAT
 13674                                 THRU 9900-EXIT
 13675           GO TO 8200-SEND-DATAONLY
 13676        END-IF
 13677     ELSE
 13678        MOVE -1                  TO BMAINTL
 13679        MOVE 0249                TO EMI-ERROR
 13680        PERFORM 9900-ERROR-FORMAT
 13681                                 THRU 9900-EXIT
 13682        GO TO 8200-SEND-DATAONLY
 13683     END-IF
 13684     .
 13685 1520-EXIT.
 13686     EXIT.
 13687 1600-UPDATE-ERPYAJ.
 13688     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13689                                 THRU 1610-EXIT
 13690     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13691                                 THRU 1620-EXIT
 13692     .
 13693 1600-EXIT.
 13694     EXIT.
 13695 1610-ADD-ERPYAJ-BANK-REC.
 13696
 13697* EXEC CICS GETMAIN
 13698*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13699*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13700*        INITIMG (GETMAIN-SPACE)
 13701*    END-EXEC
 13702*    MOVE ',"IL                  $   #00012517' TO DFHEIV0
 13703     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13704     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13705     MOVE X'2020233030303132353137' TO DFHEIV0(25:11)
 13706     CALL 'kxdfhei1' USING DFHEIV0,
 13707           DFHEIV20,
 13708           ERPYAJ-RECORD-LENGTH,
 13709           GETMAIN-SPACE
 13710     SET ADDRESS OF PENDING-PAY-ADJ TO
 13711         DFHEIV20
 13712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13713     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13714     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13715     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13716     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13717     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13718     MOVE +10                    TO ERPYAJ-SEQ-NO
 13719     MOVE 'R'                    TO ERPYAJ-TYPE
 13720     IF REVERSAL
 13721        MOVE 'C'                 TO ERPYAJ-TYPE
 13722     END-IF
 13723     MOVE SPACES                 TO PENDING-PAY-ADJ
 13724     MOVE 'PY'                   TO PY-RECORD-ID
 13725     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13726     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13727     IF REVERSAL
 13728        MOVE PB-I-DCC-OVER-CHG-AMT
 13729                                 TO PY-ENTRY-AMT
 13730     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 250
* EL6311.cbl
 13731     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13732                                    PY-INPUT-DT
 13733*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13734*                                   PY-INPUT-DT
 13735     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13736     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13737     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13738     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13739     IF PB-CARRIER = '2'
 13740        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13741     ELSE
 13742        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13743     END-IF
 13744     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13745                                    PY-BILLED-DATE
 13746                                    PY-AR-DATE
 13747                                    PY-REPORTED-DT
 13748                                    PY-CHECK-WRITTEN-DT
 13749     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13750                                    PY-CHECK-QUE-SEQUENCE
 13751     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13752     PERFORM WITH TEST AFTER
 13753        UNTIL (NOT RESP-DUPKEY)
 13754           AND (NOT RESP-DUPREC)
 13755
 13756* EXEC CICS WRITE
 13757*          DATASET    (FILE-ID-ERPYAJ)
 13758*          FROM       (PENDING-PAY-ADJ)
 13759*          RIDFLD     (ERPYAJ-KEY)
 13760*          RESP       (WS-RESPONSE)
 13761*       END-EXEC
 13762     MOVE LENGTH OF
 13763      PENDING-PAY-ADJ
 13764       TO DFHEIV11
 13765*    MOVE '&$ L                  ''  N#00012564' TO DFHEIV0
 13766     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13767     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13768     MOVE X'204E233030303132353634' TO DFHEIV0(25:11)
 13769     CALL 'kxdfhei1' USING DFHEIV0,
 13770           FILE-ID-ERPYAJ,
 13771           PENDING-PAY-ADJ,
 13772           DFHEIV11,
 13773           ERPYAJ-KEY,
 13774           DFHEIV99,
 13775           DFHEIV99
 13776     MOVE EIBRESP  TO WS-RESPONSE
 13777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13778        IF RESP-DUPKEY OR RESP-DUPREC
 13779           ADD +1                TO ERPYAJ-SEQ-NO
 13780           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13781        END-IF
 13782     END-PERFORM
 13783     .
 13784 1610-EXIT.
 13785     EXIT.
 13786 1620-ADD-ERPYAJ-DLR-REC.
 13787     MOVE 'C'                    TO ERPYAJ-TYPE
 13788     IF REVERSAL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 251
* EL6311.cbl
 13789        MOVE 'R'                 TO ERPYAJ-TYPE
 13790     END-IF
 13791     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13792                                    ERPYAJ-ACCOUNT
 13793     ADD +1                      TO ERPYAJ-SEQ-NO
 13794     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13795     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13796     IF PB-CARRIER = '2'
 13797        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13798     ELSE
 13799        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13800     END-IF
 13801     PERFORM WITH TEST AFTER
 13802        UNTIL (NOT RESP-DUPKEY)
 13803           AND (NOT RESP-DUPREC)
 13804
 13805* EXEC CICS WRITE
 13806*          DATASET    (FILE-ID-ERPYAJ)
 13807*          FROM       (PENDING-PAY-ADJ)
 13808*          RIDFLD     (ERPYAJ-KEY)
 13809*          RESP       (WS-RESPONSE)
 13810*       END-EXEC
 13811     MOVE LENGTH OF
 13812      PENDING-PAY-ADJ
 13813       TO DFHEIV11
 13814*    MOVE '&$ L                  ''  N#00012596' TO DFHEIV0
 13815     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13816     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13817     MOVE X'204E233030303132353936' TO DFHEIV0(25:11)
 13818     CALL 'kxdfhei1' USING DFHEIV0,
 13819           FILE-ID-ERPYAJ,
 13820           PENDING-PAY-ADJ,
 13821           DFHEIV11,
 13822           ERPYAJ-KEY,
 13823           DFHEIV99,
 13824           DFHEIV99
 13825     MOVE EIBRESP  TO WS-RESPONSE
 13826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13827        IF RESP-DUPKEY OR RESP-DUPREC
 13828           ADD +1                TO ERPYAJ-SEQ-NO
 13829           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13830        END-IF
 13831     END-PERFORM
 13832     .
 13833 1620-EXIT.
 13834     EXIT.
 13835 1700-SQUEEZE-IT-IN.
 13836     IF (N1 > CN-BILLING-END-LINE-NO)
 13837        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13838           N1 = +1
 13839           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13840           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13841              IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13842                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13843              ELSE
 13844                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13845              END-IF
 13846              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 252
* EL6311.cbl
 13847              MOVE +2 TO N1
 13848           END-IF
 13849        END-PERFORM
 13850     ELSE
 13851        IF (N1 < CN-BILLING-START-LINE-NO)
 13852           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13853              N1 = +10
 13854              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13855              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13856                 IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13857                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13858                 ELSE
 13859                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13860                 END-IF
 13861                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13862                 MOVE +9 TO N1
 13863              END-IF
 13864           END-PERFORM
 13865        END-IF
 13866     END-IF
 13867     .
 13868 1700-EXIT.
 13869     EXIT.
 13870 1800-REMOVE-CERT-NOTES.
 13871     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13872                                 TO ERNOTE-KEY
 13873
 13874* EXEC CICS READ
 13875*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13876*       DATASET    (FILE-ID-ERNOTE)
 13877*       RIDFLD     (ERNOTE-KEY)
 13878*       RESP       (WS-RESPONSE)
 13879*       UPDATE
 13880*    END-EXEC
 13881*    MOVE '&"S        EU         (  N#00012648' TO DFHEIV0
 13882     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13883     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13884     MOVE X'204E233030303132363438' TO DFHEIV0(25:11)
 13885     CALL 'kxdfhei1' USING DFHEIV0,
 13886           FILE-ID-ERNOTE,
 13887           DFHEIV20,
 13888           DFHEIV99,
 13889           ERNOTE-KEY,
 13890           DFHEIV99,
 13891           DFHEIV99,
 13892           DFHEIV99
 13893     SET ADDRESS OF CERTIFICATE-NOTE TO
 13894         DFHEIV20
 13895     MOVE EIBRESP  TO WS-RESPONSE
 13896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13897     IF RESP-NORMAL
 13898        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13899           (N1 > +10)
 13900           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13901           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13902        END-PERFORM
 13903        IF N1 < +11
 13904           MOVE SPACES              TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 253
* EL6311.cbl
 13905           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13906              N1 <= CN-BILLING-END-LINE-NO
 13907              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13908              IF CN-BILLING-END-LINE-NO <
 13909                               CN-BILLING-START-LINE-NO
 13910                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13911                                     CN-BILLING-START-LINE-NO
 13912              END-IF
 13913              PERFORM 1820-SQUEEZE-ERNOTE
 13914                                  THRU 1820-EXIT
 13915           END-IF
 13916           IF CN-LINES = SPACES
 13917
 13918* EXEC CICS DELETE
 13919*                DATASET    (FILE-ID-ERNOTE)
 13920*                RESP       (WS-RESPONSE)
 13921*             END-EXEC
 13922*    MOVE '&(                    &  N#00012675' TO DFHEIV0
 13923     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13924     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13925     MOVE X'204E233030303132363735' TO DFHEIV0(25:11)
 13926     CALL 'kxdfhei1' USING DFHEIV0,
 13927           FILE-ID-ERNOTE,
 13928           DFHEIV99,
 13929           DFHEIV99,
 13930           DFHEIV99,
 13931           DFHEIV99
 13932     MOVE EIBRESP  TO WS-RESPONSE
 13933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13934              IF RESP-NORMAL
 13935                 MOVE 'D'        TO WS-NOTE-SW
 13936                 PERFORM 1520-UPDATE-ELCERT
 13937                                 THRU 1520-EXIT
 13938              END-IF
 13939           ELSE
 13940
 13941* EXEC CICS REWRITE
 13942*                DATASET    (FILE-ID-ERNOTE)
 13943*                FROM       (CERTIFICATE-NOTE)
 13944*                RESP       (WS-RESPONSE)
 13945*             END-EXEC
 13946     MOVE LENGTH OF
 13947      CERTIFICATE-NOTE
 13948       TO DFHEIV11
 13949*    MOVE '&& L                  %  N#00012685' TO DFHEIV0
 13950     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13951     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13952     MOVE X'204E233030303132363835' TO DFHEIV0(25:11)
 13953     CALL 'kxdfhei1' USING DFHEIV0,
 13954           FILE-ID-ERNOTE,
 13955           CERTIFICATE-NOTE,
 13956           DFHEIV11,
 13957           DFHEIV99
 13958     MOVE EIBRESP  TO WS-RESPONSE
 13959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13960           END-IF
 13961        END-IF
 13962     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 254
* EL6311.cbl
 13963     .
 13964 1800-EXIT.
 13965     EXIT.
 13966 1820-SQUEEZE-ERNOTE.
 13967     MOVE CN-BILLING-START-LINE-NO TO N2
 13968     IF N2 = 0
 13969         MOVE +1                 TO N2
 13970     END-IF
 13971     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13972        (N1 > +9)
 13973        IF CN-LINE (N1) = SPACES
 13974           MOVE CN-LINE (N1 + +1)
 13975                                 TO CN-LINE (N1)
 13976           MOVE SPACES           TO CN-LINE (N1 + +1)
 13977        END-IF
 13978     END-PERFORM
 13979     .
 13980 1820-EXIT.
 13981     EXIT.
 13982 1900-DELETE-ERPYAJ.
 13983     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13984     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13985     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13986     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13987     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13988     MOVE +10                    TO ERPYAJ-SEQ-NO
 13989     MOVE 'R'                    TO ERPYAJ-TYPE
 13990     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13991
 13992* EXEC CICS STARTBR
 13993*       DATASET    (FILE-ID-ERPYAJ)
 13994*       RIDFLD     (ERPYAJ-KEY)
 13995*       RESP       (WS-RESPONSE)
 13996*    END-EXEC
 13997     MOVE 0
 13998       TO DFHEIV11
 13999*    MOVE '&,         G          &  N#00012721' TO DFHEIV0
 14000     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14001     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14002     MOVE X'204E233030303132373231' TO DFHEIV0(25:11)
 14003     CALL 'kxdfhei1' USING DFHEIV0,
 14004           FILE-ID-ERPYAJ,
 14005           ERPYAJ-KEY,
 14006           DFHEIV99,
 14007           DFHEIV11,
 14008           DFHEIV99
 14009     MOVE EIBRESP  TO WS-RESPONSE
 14010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14011     IF RESP-NORMAL
 14012        CONTINUE
 14013     ELSE
 14014        GO TO 1900-GET-DEALER
 14015     END-IF
 14016     .
 14017 1900-READNEXT-ERPYAJ-B.
 14018*  GET THE BANK ERPYAJ RECORD
 14019
 14020* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 255
* EL6311.cbl
 14021*       DATASET    (FILE-ID-ERPYAJ)
 14022*       RIDFLD     (ERPYAJ-KEY)
 14023*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14024*       RESP       (WS-RESPONSE)
 14025*    END-EXEC
 14026     MOVE 0
 14027       TO DFHEIV11
 14028*    MOVE '&.S                   )  N#00012734' TO DFHEIV0
 14029     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14030     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14031     MOVE X'204E233030303132373334' TO DFHEIV0(25:11)
 14032     CALL 'kxdfhei1' USING DFHEIV0,
 14033           FILE-ID-ERPYAJ,
 14034           DFHEIV20,
 14035           DFHEIV99,
 14036           ERPYAJ-KEY,
 14037           DFHEIV99,
 14038           DFHEIV11,
 14039           DFHEIV99,
 14040           DFHEIV99
 14041     SET ADDRESS OF PENDING-PAY-ADJ TO
 14042         DFHEIV20
 14043     MOVE EIBRESP  TO WS-RESPONSE
 14044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14045     IF RESP-NORMAL
 14046        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14047           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14048              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14049                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14050
 14051* EXEC CICS READ
 14052*                   DATASET    (FILE-ID-ERPYAJ)
 14053*                   RIDFLD     (ERPYAJ-KEY)
 14054*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14055*                   RESP       (WS-RESPONSE)
 14056*                   UPDATE
 14057*                END-EXEC
 14058*    MOVE '&"S        EU         (  N#00012745' TO DFHEIV0
 14059     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14060     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14061     MOVE X'204E233030303132373435' TO DFHEIV0(25:11)
 14062     CALL 'kxdfhei1' USING DFHEIV0,
 14063           FILE-ID-ERPYAJ,
 14064           DFHEIV20,
 14065           DFHEIV99,
 14066           ERPYAJ-KEY,
 14067           DFHEIV99,
 14068           DFHEIV99,
 14069           DFHEIV99
 14070     SET ADDRESS OF PENDING-PAY-ADJ TO
 14071         DFHEIV20
 14072     MOVE EIBRESP  TO WS-RESPONSE
 14073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14074                 IF RESP-NORMAL
 14075
 14076* EXEC CICS DELETE
 14077*                      DATASET   (FILE-ID-ERPYAJ)
 14078*                      RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 256
* EL6311.cbl
 14079*                   END-EXEC
 14080*    MOVE '&(                    &  N#00012753' TO DFHEIV0
 14081     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14082     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14083     MOVE X'204E233030303132373533' TO DFHEIV0(25:11)
 14084     CALL 'kxdfhei1' USING DFHEIV0,
 14085           FILE-ID-ERPYAJ,
 14086           DFHEIV99,
 14087           DFHEIV99,
 14088           DFHEIV99,
 14089           DFHEIV99
 14090     MOVE EIBRESP  TO WS-RESPONSE
 14091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14092                 END-IF
 14093              ELSE
 14094                 SET REVERSAL    TO TRUE
 14095                 PERFORM 1600-UPDATE-ERPYAJ
 14096                                 THRU 1600-EXIT
 14097                 GO TO 1900-EXIT
 14098              END-IF
 14099           ELSE
 14100              GO TO 1900-READNEXT-ERPYAJ-B
 14101           END-IF
 14102        END-IF
 14103
 14104* EXEC CICS ENDBR
 14105*          DATASET   (FILE-ID-ERPYAJ)
 14106*       END-EXEC
 14107     MOVE 0
 14108       TO DFHEIV11
 14109*    MOVE '&2                    $   #00012768' TO DFHEIV0
 14110     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14111     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14112     MOVE X'2020233030303132373638' TO DFHEIV0(25:11)
 14113     CALL 'kxdfhei1' USING DFHEIV0,
 14114           FILE-ID-ERPYAJ,
 14115           DFHEIV11,
 14116           DFHEIV99
 14117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14118     END-IF
 14119     .
 14120 1900-GET-DEALER.
 14121     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14122     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14123     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14124     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14125     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14126     MOVE +10                    TO ERPYAJ-SEQ-NO
 14127     MOVE 'C'                    TO ERPYAJ-TYPE
 14128     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14129
 14130* EXEC CICS STARTBR
 14131*       DATASET    (FILE-ID-ERPYAJ)
 14132*       RIDFLD     (ERPYAJ-KEY)
 14133*       RESP       (WS-RESPONSE)
 14134*    END-EXEC
 14135     MOVE 0
 14136       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 257
* EL6311.cbl
 14137*    MOVE '&,         G          &  N#00012782' TO DFHEIV0
 14138     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14139     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14140     MOVE X'204E233030303132373832' TO DFHEIV0(25:11)
 14141     CALL 'kxdfhei1' USING DFHEIV0,
 14142           FILE-ID-ERPYAJ,
 14143           ERPYAJ-KEY,
 14144           DFHEIV99,
 14145           DFHEIV11,
 14146           DFHEIV99
 14147     MOVE EIBRESP  TO WS-RESPONSE
 14148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14149     IF RESP-NORMAL
 14150        CONTINUE
 14151     ELSE
 14152        GO TO 1900-EXIT
 14153     END-IF
 14154     .
 14155 1900-READNEXT-ERPYAJ-D.
 14156*  GET THE DEALER ERPYAJ RECORD
 14157
 14158* EXEC CICS READNEXT
 14159*       DATASET    (FILE-ID-ERPYAJ)
 14160*       RIDFLD     (ERPYAJ-KEY)
 14161*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14162*       RESP       (WS-RESPONSE)
 14163*    END-EXEC
 14164     MOVE 0
 14165       TO DFHEIV11
 14166*    MOVE '&.S                   )  N#00012795' TO DFHEIV0
 14167     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14168     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14169     MOVE X'204E233030303132373935' TO DFHEIV0(25:11)
 14170     CALL 'kxdfhei1' USING DFHEIV0,
 14171           FILE-ID-ERPYAJ,
 14172           DFHEIV20,
 14173           DFHEIV99,
 14174           ERPYAJ-KEY,
 14175           DFHEIV99,
 14176           DFHEIV11,
 14177           DFHEIV99,
 14178           DFHEIV99
 14179     SET ADDRESS OF PENDING-PAY-ADJ TO
 14180         DFHEIV20
 14181     MOVE EIBRESP  TO WS-RESPONSE
 14182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14183     IF RESP-NORMAL
 14184        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14185           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14186              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14187                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14188
 14189* EXEC CICS READ
 14190*                   DATASET    (FILE-ID-ERPYAJ)
 14191*                   RIDFLD     (ERPYAJ-KEY)
 14192*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14193*                   RESP       (WS-RESPONSE)
 14194*                   UPDATE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 258
* EL6311.cbl
 14195*                END-EXEC
 14196*    MOVE '&"S        EU         (  N#00012806' TO DFHEIV0
 14197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14198     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14199     MOVE X'204E233030303132383036' TO DFHEIV0(25:11)
 14200     CALL 'kxdfhei1' USING DFHEIV0,
 14201           FILE-ID-ERPYAJ,
 14202           DFHEIV20,
 14203           DFHEIV99,
 14204           ERPYAJ-KEY,
 14205           DFHEIV99,
 14206           DFHEIV99,
 14207           DFHEIV99
 14208     SET ADDRESS OF PENDING-PAY-ADJ TO
 14209         DFHEIV20
 14210     MOVE EIBRESP  TO WS-RESPONSE
 14211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14212                 IF RESP-NORMAL
 14213
 14214* EXEC CICS DELETE
 14215*                      DATASET   (FILE-ID-ERPYAJ)
 14216*                      RESP      (WS-RESPONSE)
 14217*                   END-EXEC
 14218*    MOVE '&(                    &  N#00012814' TO DFHEIV0
 14219     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14220     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14221     MOVE X'204E233030303132383134' TO DFHEIV0(25:11)
 14222     CALL 'kxdfhei1' USING DFHEIV0,
 14223           FILE-ID-ERPYAJ,
 14224           DFHEIV99,
 14225           DFHEIV99,
 14226           DFHEIV99,
 14227           DFHEIV99
 14228     MOVE EIBRESP  TO WS-RESPONSE
 14229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14230                 END-IF
 14231              ELSE
 14232                 SET REVERSAL    TO TRUE
 14233              END-IF
 14234           ELSE
 14235              GO TO 1900-READNEXT-ERPYAJ-D
 14236           END-IF
 14237        END-IF
 14238
 14239* EXEC CICS ENDBR
 14240*          DATASET   (FILE-ID-ERPYAJ)
 14241*       END-EXEC
 14242     MOVE 0
 14243       TO DFHEIV11
 14244*    MOVE '&2                    $   #00012826' TO DFHEIV0
 14245     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14246     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14247     MOVE X'2020233030303132383236' TO DFHEIV0(25:11)
 14248     CALL 'kxdfhei1' USING DFHEIV0,
 14249           FILE-ID-ERPYAJ,
 14250           DFHEIV11,
 14251           DFHEIV99
 14252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 259
* EL6311.cbl
 14253     END-IF
 14254     .
 14255 1900-EXIT.
 14256     EXIT.
 14257******************************************************************
 14258*            C A N C E L   M A I N L I N E                       *
 14259******************************************************************
 14260
 14261 2000-CANCEL-MAINLINE.
 14262     IF PI-DISPLAY-ORIGINAL-BATCH
 14263        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14264           MOVE ER-0023             TO EMI-ERROR
 14265           MOVE -1                  TO CMAINTL
 14266           MOVE AL-UABON            TO CMAINTA
 14267           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14268           GO TO 8200-SEND-DATAONLY
 14269        ELSE
 14270           NEXT SENTENCE
 14271     ELSE
 14272        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14273           MOVE ER-0023             TO EMI-ERROR
 14274           MOVE -1                  TO CMAINTL
 14275           MOVE AL-UABON            TO CMAINTA
 14276           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14277           GO TO 8200-SEND-DATAONLY.
 14278
 14279     IF CMAINTI = 'S'
 14280        GO TO 2100-SHOW-REQUEST.
 14281
 14282     IF NOT MODIFY-CAP
 14283         MOVE 'UPDATE'       TO SM-READ
 14284         PERFORM 9995-SECURITY-VIOLATION
 14285         MOVE ER-0070        TO EMI-ERROR
 14286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14287         GO TO 8100-SEND-INITIAL-MAP.
 14288
 14289     IF CMAINTL GREATER THAN ZEROS
 14290        IF PI-PF6-FUNCTION
 14291           IF CMAINTI NOT = 'A'
 14292              MOVE AL-UABON  TO CMAINTA
 14293              MOVE -1        TO CMAINTL
 14294              MOVE ER-2260   TO EMI-ERROR
 14295              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14296              GO TO 8200-SEND-DATAONLY.
 14297
 14298     IF CCERTNOL = ZEROS
 14299       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14300         NEXT SENTENCE
 14301     ELSE
 14302         IF CCERTNOL NOT = ZEROS
 14303             MOVE AL-UANON       TO CCERTNOA
 14304         ELSE
 14305             MOVE -1             TO CCERTNOL
 14306             MOVE  1             TO SET-CURSOR-SW
 14307             MOVE ER-2218       TO EMI-ERROR
 14308             MOVE AL-UABON       TO CCERTNOA
 14309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14310
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 260
* EL6311.cbl
 14311     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14312        NEXT SENTENCE
 14313     ELSE
 14314        IF CEFFDTL NOT = ZEROS
 14315           MOVE AL-UNNON         TO CEFFDTA
 14316           MOVE CEFFDTI TO DEEDIT-FIELD
 14317           PERFORM 8600-DEEDIT
 14318           MOVE 4                TO DC-OPTION-CODE
 14319           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14320           PERFORM 9700-DATE-LINK
 14321           IF NO-CONVERSION-ERROR
 14322              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14323              ELSE
 14324              MOVE -1            TO CEFFDTL
 14325              MOVE  1            TO SET-CURSOR-SW
 14326              MOVE ER-2226      TO EMI-ERROR
 14327              MOVE AL-UNBON      TO CEFFDTA
 14328              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14329          ELSE
 14330          MOVE -1                 TO CEFFDTL
 14331          MOVE  1                 TO SET-CURSOR-SW
 14332          MOVE ER-2220            TO EMI-ERROR
 14333          MOVE AL-UNBON           TO CEFFDTA
 14334          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14335
 14336     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14337
 14338     IF CCERTNOL NOT = ZEROS
 14339        MOVE CCERTNOI                TO WS-NEW-PRIME
 14340     ELSE
 14341        MOVE SPACES                  TO WS-NEW-PRIME.
 14342
 14343     IF CSUFIXL NOT = ZEROS
 14344        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14345     ELSE
 14346        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14347
 14348     IF CEFFDTL NOT = ZEROS
 14349        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14350     ELSE
 14351        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14352
 14353     IF CMAINTI = 'A' OR 'K' OR 'S'
 14354        NEXT SENTENCE
 14355     ELSE
 14356        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14357        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14358           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14359           WS-PB-RECORD-TYPE NOT = '2'
 14360           IF CMAINTI = 'C'
 14361              MOVE ER-2287          TO EMI-ERROR
 14362              MOVE -1               TO CCERTNOL
 14363              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14364              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14365              GO TO 8200-SEND-DATAONLY
 14366             ELSE
 14367              MOVE ER-2260          TO EMI-ERROR
 14368              MOVE -1               TO CCERTNOL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 261
* EL6311.cbl
 14369              MOVE AL-UABON         TO CCERTNOA
 14370              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14371              GO TO 8200-SEND-DATAONLY.
 14372
 14373     IF CMAINTI = 'D'
 14374        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14375
 14376     IF CLSTNML GREATER THAN ZEROS
 14377         MOVE AL-UANON           TO CLSTNMA.
 14378
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 262
* EL6311.cbl
 14380
 14381******************************************************************
 14382*                                                                *
 14383*           E D I T   C A N C E L   C O V E R A G E S            *
 14384*                                                                *
 14385******************************************************************
 14386
 14387 2015-EDIT-COVERAGES.
 14388     IF CCANDT1L      GREATER THAN ZEROS OR
 14389        CREFND1L      GREATER THAN ZEROS OR
 14390        CCANDT2L      GREATER THAN ZEROS OR
 14391        CREFND2L      GREATER THAN ZEROS OR
 14392        CMTHD1L       GREATER THAN ZEROS OR
 14393        CMTHD2L       GREATER THAN ZEROS OR
 14394        CLIVESL       GREATER THAN ZEROS OR
 14395        CPAYEEL       GREATER THAN ZEROS OR
 14396        CFORCEL       GREATER THAN ZEROS OR
 14397        CBILCDL       GREATER THAN ZEROS OR
 14398        CCANREAL      GREATER THAN ZEROS
 14399            NEXT SENTENCE
 14400         ELSE
 14401            GO TO 2030-EDIT-COMPLETE.
 14402
 14403     IF CCANDT1L = ZEROS
 14404        AND (CMAINTI = 'C' OR 'K')
 14405        NEXT SENTENCE
 14406     ELSE
 14407        IF CCANDT1L      GREATER THAN ZEROS
 14408            MOVE AL-UNNON            TO CCANDT1A
 14409            IF CCANDT1I = SPACES
 14410               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14411            ELSE
 14412               MOVE CCANDT1I            TO DEEDIT-FIELD
 14413               PERFORM 8600-DEEDIT
 14414               IF DEEDIT-FIELD-V0   NUMERIC
 14415                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14416                  MOVE 4                TO DC-OPTION-CODE
 14417                  PERFORM 9700-DATE-LINK
 14418                  IF NO-CONVERSION-ERROR
 14419                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14420                  ELSE
 14421                      MOVE -1        TO CCANDT1L
 14422                      MOVE ER-2227   TO EMI-ERROR
 14423                      MOVE AL-UNBON  TO CCANDT1A
 14424                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14425               ELSE
 14426                  MOVE -1         TO CCANDT1L
 14427                  MOVE ER-2223    TO EMI-ERROR
 14428                  MOVE AL-UNBON   TO CCANDT1A
 14429                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14430        ELSE
 14431            IF CREFND1L GREATER THAN ZEROS
 14432               MOVE -1             TO CCANDT1L
 14433               MOVE ER-2222        TO EMI-ERROR
 14434               MOVE AL-UNBOF       TO CCANDT1A
 14435               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14436
 14437     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 263
* EL6311.cbl
 14438        AND (CMAINTI = 'C' OR 'K')
 14439         NEXT SENTENCE
 14440     ELSE
 14441         IF CREFND1L NOT = ZEROS
 14442            MOVE AL-UNNON        TO CREFND1A
 14443
 14444* EXEC CICS BIF DEEDIT
 14445*               FIELD  (CREFND1I)
 14446*               LENGTH (11)
 14447*           END-EXEC
 14448     MOVE 11
 14449       TO DFHEIV11
 14450*    MOVE '@"L                   #   #00013019' TO DFHEIV0
 14451     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14452     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14453     MOVE X'2020233030303133303139' TO DFHEIV0(25:11)
 14454     CALL 'kxdfhei1' USING DFHEIV0,
 14455           CREFND1I,
 14456           DFHEIV11
 14457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14458            MOVE CREFND1I        TO WS-CREFND1
 14459*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14460*           PERFORM 8600-DEEDIT
 14461*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14462            IF WS-CREFND1  = ZEROS
 14463               AND CMAINTI = 'A'
 14464             MOVE ER-2437        TO EMI-ERROR
 14465             MOVE -1             TO CREFND1L
 14466             MOVE AL-UNBON       TO CREFND1A
 14467             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14468
 14469     IF CCANREAL > +0
 14470        MOVE AL-UANON            TO CCANREAA
 14471        IF CCANREAI = 'R' OR ' '
 14472           CONTINUE
 14473        ELSE
 14474           MOVE ER-9841        TO EMI-ERROR
 14475           MOVE -1             TO CCANREAL
 14476           MOVE AL-UABON       TO CCANREAA
 14477           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14478        END-IF
 14479     END-IF
 14480     IF CMTHD1L EQUAL +0
 14481        NEXT SENTENCE
 14482     ELSE
 14483        IF CMTHD1L NOT = +0
 14484           MOVE AL-UNNON        TO CMTHD1A
 14485           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14486                         OR '5' OR '6' OR '8' OR '9'
 14487                         OR 'R' OR ' '
 14488              NEXT SENTENCE
 14489           ELSE
 14490              MOVE ER-0582        TO EMI-ERROR
 14491              MOVE -1             TO CMTHD1L
 14492              MOVE AL-UNBON       TO CMTHD1A
 14493              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14494
 14495     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 264
* EL6311.cbl
 14496        AND (CMAINTI = 'C' OR 'K')
 14497         NEXT SENTENCE
 14498     ELSE
 14499         IF CCANDT2L  GREATER THAN ZEROS
 14500             MOVE AL-UNNON       TO CCANDT2A
 14501             IF CCANDT2I = SPACES
 14502                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14503             ELSE
 14504                MOVE CCANDT2I       TO DEEDIT-FIELD
 14505                PERFORM 8600-DEEDIT
 14506                IF DEEDIT-FIELD-V0   NUMERIC
 14507                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14508                   MOVE 4                TO DC-OPTION-CODE
 14509                   PERFORM 9700-DATE-LINK
 14510                   IF NO-CONVERSION-ERROR
 14511                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14512                   ELSE
 14513                      MOVE -1       TO CCANDT2L
 14514                      MOVE ER-2227  TO EMI-ERROR
 14515                      MOVE AL-UNBON TO CCANDT2A
 14516                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14517                ELSE
 14518                   MOVE -1         TO CCANDT2L
 14519                   MOVE ER-2223    TO EMI-ERROR
 14520                   MOVE AL-UNBON   TO CCANDT2A
 14521                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14522         ELSE
 14523            IF CREFND2L GREATER THAN ZEROS
 14524               MOVE -1             TO CCANDT2L
 14525               MOVE ER-2222        TO EMI-ERROR
 14526               MOVE AL-UNBOF       TO CCANDT2A
 14527               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14528
 14529     IF CREFND2L = ZEROS
 14530        AND (CMAINTI = 'C' OR 'K')
 14531         NEXT SENTENCE
 14532     ELSE
 14533         IF CREFND2L NOT = ZEROS
 14534            MOVE AL-UNNON        TO CREFND2A
 14535
 14536* EXEC CICS BIF DEEDIT
 14537*               FIELD  (CREFND2I)
 14538*               LENGTH (11)
 14539*           END-EXEC
 14540     MOVE 11
 14541       TO DFHEIV11
 14542*    MOVE '@"L                   #   #00013100' TO DFHEIV0
 14543     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14544     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14545     MOVE X'2020233030303133313030' TO DFHEIV0(25:11)
 14546     CALL 'kxdfhei1' USING DFHEIV0,
 14547           CREFND2I,
 14548           DFHEIV11
 14549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14550            MOVE CREFND2I        TO WS-CREFND2
 14551*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14552*           PERFORM 8600-DEEDIT
 14553*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 265
* EL6311.cbl
 14554            IF WS-CREFND2  = ZEROS
 14555               AND CMAINTI = 'A'
 14556             MOVE ER-2437        TO EMI-ERROR
 14557             MOVE -1             TO CREFND2L
 14558             MOVE AL-UNBON       TO CREFND2A
 14559             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14560
 14561     IF CMTHD2L EQUAL +0
 14562        NEXT SENTENCE
 14563     ELSE
 14564        IF CMTHD2L NOT = +0
 14565           MOVE AL-UNNON        TO CMTHD2A
 14566           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14567                         OR '5' OR '6' OR '8' OR '9'
 14568                         OR ' ' OR 'R'
 14569              NEXT SENTENCE
 14570           ELSE
 14571              MOVE ER-0582        TO EMI-ERROR
 14572              MOVE -1             TO CMTHD2L
 14573              MOVE AL-UNBON       TO CMTHD2A
 14574              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14575
 14576     IF CLIVESL GREATER THAN ZEROS
 14577         MOVE CLIVESI            TO DEEDIT-FIELD
 14578         PERFORM 8600-DEEDIT
 14579         IF DEEDIT-FIELD-V0 NUMERIC
 14580             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14581             MOVE AL-UNNON       TO CLIVESA
 14582         ELSE
 14583             MOVE -1             TO CLIVESL
 14584             MOVE AL-UNBON       TO CLIVESA
 14585             MOVE ER-2223        TO EMI-ERROR
 14586             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14587
 14588     IF CFORCEL  NOT = ZEROS
 14589         IF FORCE-CAP
 14590            MOVE AL-UANON            TO CFORCEA
 14591         ELSE
 14592            MOVE ER-2945             TO EMI-ERROR
 14593            MOVE AL-UABON            TO CFORCEA
 14594            MOVE -1                  TO CFORCEL
 14595            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14596
 14597     IF CPAYEEL GREATER THAN ZEROS
 14598        MOVE AL-UANON            TO CPAYEEA.
 14599
 14600     IF CBILCDL NOT = ZEROS
 14601        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14602                             AND 'A' AND 'B' AND 'E'
 14603           MOVE ER-2225              TO EMI-ERROR
 14604           MOVE AL-UABON             TO CBILCDA
 14605           MOVE -1                   TO CBILCDL
 14606           MOVE  1                   TO SET-CURSOR-SW
 14607           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14608        ELSE
 14609           MOVE AL-UANON             TO CBILCDA.
 14610
 14611 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 266
* EL6311.cbl
 14612     IF EMI-ERROR = ZEROS
 14613         NEXT SENTENCE
 14614     ELSE
 14615         GO TO 8200-SEND-DATAONLY.
 14616
 14617     IF CMAINTI = 'A'
 14618        GO TO 2200-ADD-CANCEL-ROUTINE.
 14619
 14620     IF CMAINTI = 'C'
 14621        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14622
 14623     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14624
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 267
* EL6311.cbl
 14626
 14627******************************************************************
 14628*                                                                *
 14629*                   S H O W   C A N C E L                        *
 14630*                                                                *
 14631******************************************************************
 14632
 14633 2100-SHOW-REQUEST.
 14634     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14635
 14636     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14637        MOVE -1                  TO CMAINTL
 14638        GO TO 8200-SEND-DATAONLY.
 14639
 14640     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14641
 14642     IF CSUFIXL NOT = ZEROS
 14643        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14644       ELSE
 14645        MOVE SPACE            TO WS-NEW-SUFFIX.
 14646
 14647     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14648     PERFORM 8600-DEEDIT.
 14649     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14650     MOVE '4'                    TO DC-OPTION-CODE.
 14651     PERFORM 9700-DATE-LINK.
 14652     IF DATE-CONVERSION-ERROR
 14653        MOVE ER-0348             TO EMI-ERROR
 14654        MOVE -1                  TO CEFFDTL
 14655        MOVE AL-UABON            TO CEFFDTA
 14656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14657        GO TO 8200-SEND-DATAONLY
 14658     ELSE
 14659        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14660        MOVE AL-UANON            TO CEFFDTA
 14661        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14662
 14663     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14664
 14665     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14666        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14667        MOVE 'Y'                    TO WS-SHOW-SW
 14668        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14669           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14670        ELSE
 14671           IF PI-FILE-BROWSE
 14672              GO TO 4300-BROWSE-FILE-FORWARD
 14673           ELSE
 14674              IF PI-CSR-BROWSE
 14675                 GO TO 4200-BROWSE-CSR-FORWARD
 14676              ELSE
 14677                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14678     ELSE
 14679        GO TO 3900-RE-DISPLAY-RECORD.
 14680
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 268
* EL6311.cbl
 14682
 14683
 14684******************************************************************
 14685*                                                                *
 14686*            A D D   C A N C E L   R O U T I N E                 *
 14687*                                                                *
 14688******************************************************************
 14689
 14690 2200-ADD-CANCEL-ROUTINE.
 14691     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14692
 14693
 14694* EXEC CICS GETMAIN
 14695*        SET     (ADDRESS OF PENDING-BUSINESS)
 14696*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14697*    END-EXEC.
 14698*    MOVE '," L                  $   #00013247' TO DFHEIV0
 14699     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14700     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14701     MOVE X'2020233030303133323437' TO DFHEIV0(25:11)
 14702     CALL 'kxdfhei1' USING DFHEIV0,
 14703           DFHEIV20,
 14704           ERPNDB-RECORD-LENGTH,
 14705           DFHEIV99
 14706     SET ADDRESS OF PENDING-BUSINESS TO
 14707         DFHEIV20
 14708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14709
 14710
 14711
 14712* EXEC CICS HANDLE CONDITION
 14713*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14714*    END-EXEC.
 14715*    MOVE '"$I                   ! 3 #00013252' TO DFHEIV0
 14716     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14717     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14718     MOVE X'3320233030303133323532' TO DFHEIV0(25:11)
 14719     CALL 'kxdfhei1' USING DFHEIV0
 14720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14721
 14722
 14723     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14724     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14725     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14726
 14727
 14728* EXEC CICS READ
 14729*        INTO    (PENDING-BUSINESS)
 14730*        DATASET (FILE-ID-ERPNDB)
 14731*        RIDFLD  (ERPNDB-KEY)
 14732*    END-EXEC.
 14733     MOVE LENGTH OF
 14734      PENDING-BUSINESS
 14735       TO DFHEIV11
 14736*    MOVE '&"IL       E          (   #00013260' TO DFHEIV0
 14737     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14738     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14739     MOVE X'2020233030303133323630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 269
* EL6311.cbl
 14740     CALL 'kxdfhei1' USING DFHEIV0,
 14741           FILE-ID-ERPNDB,
 14742           PENDING-BUSINESS,
 14743           DFHEIV11,
 14744           ERPNDB-KEY,
 14745           DFHEIV99,
 14746           DFHEIV99,
 14747           DFHEIV99
 14748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14749
 14750
 14751     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14752
 14753     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14754     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14755     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14756     MOVE SPACES                 TO PENDING-BUSINESS.
 14757     MOVE 'PB'                   TO PB-RECORD-ID.
 14758     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14759     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14760     MOVE SPACES                 TO PB-CERT-SFX.
 14761     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14762     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14763                                    PB-ALT-CHG-SEQ-NO.
 14764
 14765     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14766     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14767     MOVE '2'                    TO PB-RECORD-TYPE.
 14768
 14769     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14770     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14771
 14772
 14773     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14774                                    PB-ALT-CHG-SEQ-NO
 14775                                    PB-C-LF-REF-CALC
 14776                                    PB-C-AH-REF-CALC
 14777                                    PB-C-LF-RFND-CLP
 14778                                    PB-C-AH-RFND-CLP
 14779                                    PB-CI-INSURED-AGE
 14780                                    PB-CI-LF-TERM
 14781                                    PB-CI-AH-TERM
 14782                                    PB-CI-LF-BENEFIT-CD
 14783                                    PB-CI-LF-BENEFIT-AMT
 14784                                    PB-CI-LF-ALT-BENEFIT-AMT
 14785                                    PB-CI-LF-PREMIUM-AMT
 14786                                    PB-CI-LF-ALT-PREMIUM-AMT
 14787                                    PB-CI-AH-BENEFIT-CD
 14788                                    PB-CI-AH-BENEFIT-AMT
 14789                                    PB-CI-AH-PREMIUM-AMT
 14790                                    PB-CI-PAY-FREQUENCY
 14791                                    PB-CI-LOAN-APR
 14792                                    PB-CI-LOAN-TERM
 14793                                    PB-CI-LIFE-COMMISSION
 14794                                    PB-CI-AH-COMMISSION
 14795                                    PB-CI-CURR-SEQ
 14796                                    PB-CI-AH-CANCEL-AMT
 14797                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 270
* EL6311.cbl
 14798                                    PB-CI-RATE-DEV-PCT-LF
 14799                                    PB-CI-RATE-DEV-PCT-AH
 14800                                    PB-CI-EXTENTION-DAYS
 14801                                    PB-CI-TERM-IN-DAYS
 14802                                    PB-CI-LIVES
 14803                                    PB-CI-LF-CRIT-PER
 14804                                    PB-CI-AH-CRIT-PER
 14805                                    PB-C-LF-REM-TERM
 14806                                    PB-C-AH-REM-TERM
 14807                                    PB-CHG-COUNT
 14808                                    PB-LF-BILLED-AMTS
 14809                                    PB-AH-BILLED-AMTS
 14810                                    PB-C-NH-INT-ON-REFS
 14811*                                   PB-C-MICROFILM-NO
 14812                                    PB-CALC-TOLERANCE.
 14813
 14814     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14815                                    PB-CI-AH-SETTLEMENT-DT
 14816                                    PB-CI-DEATH-DT
 14817                                    PB-CI-LF-PRIOR-CANCEL-DT
 14818                                    PB-CI-AH-PRIOR-CANCEL-DT
 14819                                    PB-CI-ENTRY-DT
 14820                                    PB-CI-LF-EXPIRE-DT
 14821                                    PB-CI-AH-EXPIRE-DT
 14822                                    PB-CI-LOAN-1ST-PMT-DT
 14823                                    PB-C-LF-CANCEL-DT
 14824                                    PB-C-AH-CANCEL-DT
 14825                                    PB-CREDIT-ACCEPT-DT
 14826                                    PB-BILLED-DT
 14827                                    PB-ACCT-EFF-DT
 14828                                    PB-ACCT-EXP-DT.
 14829
 14830     MOVE 'X'                    TO PB-FATAL-FLAG.
 14831
 14832     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14833
 14834     IF CSUFIXL     GREATER THAN ZEROS
 14835        MOVE CSUFIXI             TO PB-CERT-SFX.
 14836
 14837*    IF CMICRNOL  GREATER  ZEROS
 14838*        IF CMICRNOI  NUMERIC
 14839*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14840*            MOVE AL-UNNON       TO  CMICRNOA
 14841*        ELSE
 14842*            MOVE -1             TO  CMICRNOL
 14843*            MOVE AL-UNBON       TO  CMICRNOA
 14844*            MOVE ER-2701        TO  EMI-ERROR
 14845*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14846
 14847     IF CLSTNML     GREATER THAN ZEROS
 14848        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14849
 14850     IF CCANREAL > ZEROS
 14851        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14852     END-IF
 14853     IF CPCYNL > ZEROS
 14854        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14855     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 271
* EL6311.cbl
 14856     IF CCANDT1L    GREATER THAN ZEROS
 14857        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14858
 14859     IF CCANDT2L    GREATER THAN ZEROS
 14860        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14861
 14862     IF CMTHD1L    GREATER THAN +0
 14863        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14864
 14865     IF CMTHD2L    GREATER THAN +0
 14866        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14867
 14868     IF CREFND1L    GREATER THAN ZEROS
 14869        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14870        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14871     ELSE
 14872        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14873
 14874     IF CREFND2L    GREATER THAN ZEROS
 14875        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14876        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14877     ELSE
 14878        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14879
 14880     IF CLIVESL     GREATER THAN ZEROS
 14881        MOVE WS-CLIVES           TO PB-C-LIVES
 14882     ELSE
 14883        MOVE ZEROS               TO PB-C-LIVES.
 14884
 14885     IF CPAYEEL     GREATER THAN ZEROS
 14886        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14887
 14888     IF CFORCEL     GREATER THAN ZEROS
 14889        MOVE CFORCEI             TO PB-FORCE-CODE.
 14890
 14891     IF CBILCDL     GREATER THAN ZEROS
 14892        MOVE CBILCDI             TO PB-RECORD-BILL.
 14893
 14894*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14895
 14896 2260-WRITE-PB-RECORD.
 14897     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14898                                    PB-INPUT-BY.
 14899     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14900     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14901                                    PB-INPUT-DT.
 14902
 14903     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14904     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14905                                    PB-CONTROL-BY-ORIG-BATCH.
 14906
 14907     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14908     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14909     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14910     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14911     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14912
 14913     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 272
* EL6311.cbl
 14914
 14915     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14916
 14917     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14918     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14919     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14920
 14921     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14922     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14923
 14924 2275-WRITE-PENDING-BUSINESS.
 14925     MOVE 'A'                    TO JP-RECORD-TYPE.
 14926     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14927     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14928     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14929
 14930
 14931* EXEC CICS HANDLE CONDITION
 14932*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14933*    END-EXEC.
 14934*    MOVE '"$%                   ! 4 #00013445' TO DFHEIV0
 14935     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14937     MOVE X'3420233030303133343435' TO DFHEIV0(25:11)
 14938     CALL 'kxdfhei1' USING DFHEIV0
 14939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14940
 14941
 14942
 14943* EXEC CICS WRITE
 14944*        DATASET (FILE-ID-ERPNDB)
 14945*        FROM    (PENDING-BUSINESS)
 14946*        RIDFLD  (PB-CONTROL-PRIMARY)
 14947*    END-EXEC.
 14948     MOVE LENGTH OF
 14949      PENDING-BUSINESS
 14950       TO DFHEIV11
 14951*    MOVE '&$ L                  ''   #00013449' TO DFHEIV0
 14952     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14953     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14954     MOVE X'2020233030303133343439' TO DFHEIV0(25:11)
 14955     CALL 'kxdfhei1' USING DFHEIV0,
 14956           FILE-ID-ERPNDB,
 14957           PENDING-BUSINESS,
 14958           DFHEIV11,
 14959           PB-CONTROL-PRIMARY,
 14960           DFHEIV99,
 14961           DFHEIV99
 14962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14963
 14964
 14965     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14966
 14967     PERFORM 8400-LOG-JOURNAL-RECORD.
 14968
 14969******************************************************************
 14970*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14971******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 273
* EL6311.cbl
 14972
 14973     display ' made it to add orig CANCEL cert '
 14974     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14975     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14976     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14977     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14978
 14979
 14980* EXEC CICS READ
 14981*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14982*        DATASET (FILE-ID-ELCERT)
 14983*        RIDFLD  (ELCERT-KEY)
 14984*        RESP    (WS-RESPONSE)
 14985*    END-EXEC.
 14986*    MOVE '&"S        E          (  N#00013469' TO DFHEIV0
 14987     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14989     MOVE X'204E233030303133343639' TO DFHEIV0(25:11)
 14990     CALL 'kxdfhei1' USING DFHEIV0,
 14991           FILE-ID-ELCERT,
 14992           DFHEIV20,
 14993           DFHEIV99,
 14994           ELCERT-KEY,
 14995           DFHEIV99,
 14996           DFHEIV99,
 14997           DFHEIV99
 14998     SET ADDRESS OF CERTIFICATE-MASTER TO
 14999         DFHEIV20
 15000     MOVE EIBRESP  TO WS-RESPONSE
 15001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15002
 15003
 15004     IF NOT RESP-NORMAL
 15005        GO TO 2276-BYPASS-CRTO
 15006     END-IF
 15007
 15008     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15009     MOVE ' '                    TO WS-ERMAIL-SW
 15010
 15011
 15012* EXEC CICS READ
 15013*       DATASET   (FILE-ID-ERMAIL)
 15014*       SET       (ADDRESS OF MAILING-DATA)
 15015*       RIDFLD    (ERMAIL-KEY)
 15016*       RESP      (WS-RESPONSE)
 15017*    END-EXEC
 15018*    MOVE '&"S        E          (  N#00013483' TO DFHEIV0
 15019     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15021     MOVE X'204E233030303133343833' TO DFHEIV0(25:11)
 15022     CALL 'kxdfhei1' USING DFHEIV0,
 15023           FILE-ID-ERMAIL,
 15024           DFHEIV20,
 15025           DFHEIV99,
 15026           ERMAIL-KEY,
 15027           DFHEIV99,
 15028           DFHEIV99,
 15029           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 274
* EL6311.cbl
 15030     SET ADDRESS OF MAILING-DATA TO
 15031         DFHEIV20
 15032     MOVE EIBRESP  TO WS-RESPONSE
 15033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15034
 15035     IF RESP-NORMAL
 15036        SET ERMAIL-FOUND TO TRUE
 15037     END-IF
 15038
 15039     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15040
 15041     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15042     MOVE 'OC'                   TO OC-RECORD-ID
 15043     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15044                                 TO OC-CONTROL-PRIMARY (1:33)
 15045     MOVE 'I'                    TO OC-RECORD-TYPE
 15046     MOVE +4096                  TO OC-KEY-SEQ-NO
 15047     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15048     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15049     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15050
 15051     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15052     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15053     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15054     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15055     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15056     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15057     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15058     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15059     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15060     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15061     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15062     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15063     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15064     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15065     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15066     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15067     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15068     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15069     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15070     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15071     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15072     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15073     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15074     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15075     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15076     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15077     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15078     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15079     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15080     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15081     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15082     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15083
 15084     IF ERMAIL-FOUND
 15085        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15086     END-IF
 15087     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 275
* EL6311.cbl
 15088        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15089                           OC-INS-AGE-DEFAULT-FLAG
 15090        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15091                           OC-JNT-AGE-DEFAULT-FLAG
 15092     END-IF
 15093     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15094     .
 15095 2275-WRITE-ELCRTO.
 15096
 15097
 15098* EXEC CICS WRITE
 15099*       DATASET   ('ELCRTO')
 15100*       FROM      (ORIGINAL-CERTIFICATE)
 15101*       RIDFLD    (OC-CONTROL-PRIMARY)
 15102*       RESP      (WS-RESPONSE)
 15103*    END-EXEC
 15104     MOVE LENGTH OF
 15105      ORIGINAL-CERTIFICATE
 15106       TO DFHEIV11
 15107     MOVE 'ELCRTO' TO DFHEIV1
 15108*    MOVE '&$ L                  ''  N#00013552' TO DFHEIV0
 15109     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15110     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15111     MOVE X'204E233030303133353532' TO DFHEIV0(25:11)
 15112     CALL 'kxdfhei1' USING DFHEIV0,
 15113           DFHEIV1,
 15114           ORIGINAL-CERTIFICATE,
 15115           DFHEIV11,
 15116           OC-CONTROL-PRIMARY,
 15117           DFHEIV99,
 15118           DFHEIV99
 15119     MOVE EIBRESP  TO WS-RESPONSE
 15120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15121
 15122     display ' just wrote 2275 ' ws-response
 15123     IF RESP-DUPKEY
 15124        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15125        GO TO 2275-WRITE-ELCRTO
 15126     ELSE
 15127        IF NOT RESP-NORMAL
 15128           MOVE -1               TO BMAINTL
 15129           MOVE ER-7450          TO EMI-ERROR
 15130           PERFORM 9900-ERROR-FORMAT
 15131                                 THRU 9900-EXIT
 15132           GO TO 8200-SEND-DATAONLY
 15133        END-IF
 15134     END-IF.
 15135
 15136 2276-BYPASS-CRTO.
 15137******************************************************************
 15138*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15139******************************************************************
 15140
 15141
 15142* EXEC CICS READ
 15143*        INTO    (PENDING-BUSINESS)
 15144*        DATASET (FILE-ID-ERPNDB)
 15145*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 276
* EL6311.cbl
 15146*        UPDATE
 15147*    END-EXEC.
 15148     MOVE LENGTH OF
 15149      PENDING-BUSINESS
 15150       TO DFHEIV11
 15151*    MOVE '&"IL       EU         (   #00013578' TO DFHEIV0
 15152     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15153     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15154     MOVE X'2020233030303133353738' TO DFHEIV0(25:11)
 15155     CALL 'kxdfhei1' USING DFHEIV0,
 15156           FILE-ID-ERPNDB,
 15157           PENDING-BUSINESS,
 15158           DFHEIV11,
 15159           ERPNDB-KEY,
 15160           DFHEIV99,
 15161           DFHEIV99,
 15162           DFHEIV99
 15163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15164
 15165
 15166     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15167     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15168     MOVE 'B'                    TO JP-RECORD-TYPE.
 15169     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15170
 15171     PERFORM 8400-LOG-JOURNAL-RECORD.
 15172
 15173     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15174
 15175
 15176* EXEC CICS REWRITE
 15177*        DATASET (FILE-ID-ERPNDB)
 15178*        FROM    (PENDING-BUSINESS)
 15179*    END-EXEC.
 15180     MOVE LENGTH OF
 15181      PENDING-BUSINESS
 15182       TO DFHEIV11
 15183*    MOVE '&& L                  %   #00013594' TO DFHEIV0
 15184     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15185     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15186     MOVE X'2020233030303133353934' TO DFHEIV0(25:11)
 15187     CALL 'kxdfhei1' USING DFHEIV0,
 15188           FILE-ID-ERPNDB,
 15189           PENDING-BUSINESS,
 15190           DFHEIV11,
 15191           DFHEIV99
 15192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15193
 15194
 15195     MOVE 'C'                    TO JP-RECORD-TYPE.
 15196     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15197
 15198     PERFORM 8400-LOG-JOURNAL-RECORD.
 15199
 15200     IF WS-ERRORS-PRESENT
 15201        GO TO 3900-RE-DISPLAY-RECORD.
 15202
 15203     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 277
* EL6311.cbl
 15204     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15205     MOVE LOW-VALUES             TO EL631CI.
 15206     MOVE  -1                    TO CMAINTL.
 15207     GO TO 8100-SEND-INITIAL-MAP.
 15208
 15209 2280-BATCH-HDR-NOT-FOUND.
 15210     MOVE -1                     TO BMAINTL.
 15211     MOVE ER-7450                TO EMI-ERROR.
 15212     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15213     GO TO 8200-SEND-DATAONLY.
 15214
 15215 2290-DUPLICATE-ALT-INDEX.
 15216
 15217******************************************************************
 15218*                                                                *
 15219*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15220*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15221*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15222*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15223*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15224*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15225*                                                                *
 15226******************************************************************
 15227
 15228     IF LCP-ONCTR-02 =  0
 15229         ADD 1 TO LCP-ONCTR-02
 15230        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15231
 15232     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15233
 15234     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15235         NEXT SENTENCE
 15236     ELSE
 15237         ADD +1 TO PB-BATCH-SEQ-NO
 15238                   PB-CSR-BATCH-SEQ-NO
 15239         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15240         GO TO 2275-WRITE-PENDING-BUSINESS.
 15241
 15242     MOVE -1                     TO CCERTNOL.
 15243     MOVE AL-UABON               TO CCERTNOA.
 15244     MOVE AL-UNBON               TO CEFFDTA.
 15245
 15246     MOVE 1                      TO EMI-SUB
 15247                                    EMI-SWITCH1
 15248                                    EMI-SWITCH-AREA-1
 15249                                    EMI-SWITCH-AREA-2.
 15250
 15251     MOVE SPACES                 TO EMI-ERROR-LINES.
 15252
 15253
 15254* EXEC CICS SYNCPOINT ROLLBACK
 15255*    END-EXEC.
 15256*    MOVE '6"R                   !   #00013657' TO DFHEIV0
 15257     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15258     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15259     MOVE X'2020233030303133363537' TO DFHEIV0(25:11)
 15260     CALL 'kxdfhei1' USING DFHEIV0
 15261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 278
* EL6311.cbl
 15262
 15263
 15264     MOVE ER-2247                TO EMI-ERROR.
 15265     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15266     GO TO 8200-SEND-DATAONLY.
 15267
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 279
* EL6311.cbl
 15269
 15270******************************************************************
 15271*                                                                *
 15272*          C H A N G E   C A N C E L   R O U T I N E             *
 15273*                                                                *
 15274******************************************************************
 15275
 15276***************************************************************
 15277*                                                             *
 15278*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15279*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15280*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15281*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15282*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15283*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15284*     5. LINK TO THE EDIT ROUTINE.                            *
 15285*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15286*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15287*              THE EDIT ROUTINE.                              *
 15288*     7. REWRITE THE NEW ISSUE                                *
 15289*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15290*                                                             *
 15291***************************************************************
 15292 2300-CHANGE-CANCEL-ROUTINE.
 15293     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15294
 15295     IF CCHGL NOT = ZEROS
 15296        MOVE ER-2196             TO EMI-ERROR
 15297        MOVE AL-UABON            TO CMAINTA
 15298        MOVE -1                  TO CMAINTL
 15299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15300        GO TO 8200-SEND-DATAONLY.
 15301
 15302     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15303
 15304     IF CSUFIXL NOT = ZEROS
 15305        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15306     ELSE
 15307        MOVE SPACE               TO WS-NEW-SUFFIX.
 15308
 15309     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15310     PERFORM 8600-DEEDIT.
 15311     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15312     MOVE '4'                    TO DC-OPTION-CODE.
 15313
 15314     PERFORM 9700-DATE-LINK.
 15315
 15316     IF DATE-CONVERSION-ERROR
 15317        MOVE ER-0348             TO EMI-ERROR
 15318        MOVE -1                  TO CEFFDTL
 15319        MOVE AL-UABON            TO CEFFDTA
 15320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15321        GO TO 8200-SEND-DATAONLY
 15322     ELSE
 15323        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15324        MOVE AL-UANON            TO CEFFDTA
 15325        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15326
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 280
* EL6311.cbl
 15327 2325-PROCESS-CANCEL-CHANGES.
 15328
 15329* EXEC CICS HANDLE CONDITION
 15330*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15331*    END-EXEC.
 15332*    MOVE '"$I                   ! 5 #00013724' TO DFHEIV0
 15333     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15335     MOVE X'3520233030303133373234' TO DFHEIV0(25:11)
 15336     CALL 'kxdfhei1' USING DFHEIV0
 15337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15338
 15339
 15340     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15341     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15342     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15343
 15344
 15345* EXEC CICS GETMAIN
 15346*        SET      (ADDRESS OF PENDING-BUSINESS)
 15347*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15348*        INITIMG  (GETMAIN-SPACE)
 15349*     END-EXEC.
 15350*    MOVE ',"IL                  $   #00013732' TO DFHEIV0
 15351     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15352     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15353     MOVE X'2020233030303133373332' TO DFHEIV0(25:11)
 15354     CALL 'kxdfhei1' USING DFHEIV0,
 15355           DFHEIV20,
 15356           ERPNDB-RECORD-LENGTH,
 15357           GETMAIN-SPACE
 15358     SET ADDRESS OF PENDING-BUSINESS TO
 15359         DFHEIV20
 15360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15361
 15362
 15363
 15364* EXEC CICS READ
 15365*        INTO    (PENDING-BUSINESS)
 15366*        DATASET (FILE-ID-ERPNDB)
 15367*        RIDFLD  (ERPNDB-KEY)
 15368*    END-EXEC.
 15369     MOVE LENGTH OF
 15370      PENDING-BUSINESS
 15371       TO DFHEIV11
 15372*    MOVE '&"IL       E          (   #00013738' TO DFHEIV0
 15373     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15374     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15375     MOVE X'2020233030303133373338' TO DFHEIV0(25:11)
 15376     CALL 'kxdfhei1' USING DFHEIV0,
 15377           FILE-ID-ERPNDB,
 15378           PENDING-BUSINESS,
 15379           DFHEIV11,
 15380           ERPNDB-KEY,
 15381           DFHEIV99,
 15382           DFHEIV99,
 15383           DFHEIV99
 15384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 281
* EL6311.cbl
 15385
 15386
 15387     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15388
 15389
 15390* EXEC CICS HANDLE CONDITION
 15391*         NOTFND     (2385-REC-NOT-FOUND)
 15392*    END-EXEC.
 15393*    MOVE '"$I                   ! 6 #00013746' TO DFHEIV0
 15394     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15396     MOVE X'3620233030303133373436' TO DFHEIV0(25:11)
 15397     CALL 'kxdfhei1' USING DFHEIV0
 15398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15399
 15400
 15401**********************************************************
 15402*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15403*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15404**********************************************************
 15405
 15406
 15407* EXEC CICS READ
 15408*        DATASET (FILE-ID-ERPNDB)
 15409*        INTO    (PENDING-BUSINESS)
 15410*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15411*    END-EXEC.
 15412     MOVE LENGTH OF
 15413      PENDING-BUSINESS
 15414       TO DFHEIV11
 15415*    MOVE '&"IL       E          (   #00013755' TO DFHEIV0
 15416     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15417     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15418     MOVE X'2020233030303133373535' TO DFHEIV0(25:11)
 15419     CALL 'kxdfhei1' USING DFHEIV0,
 15420           FILE-ID-ERPNDB,
 15421           PENDING-BUSINESS,
 15422           DFHEIV11,
 15423           PI-PREV-CONTROL-PRIMARY,
 15424           DFHEIV99,
 15425           DFHEIV99,
 15426           DFHEIV99
 15427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15428
 15429
 15430********** DO NOT ALLOW CHANGES IF THRU A/R
 15431     IF BMAINTI = 'C'
 15432         IF PB-EL860-INTERNAL-PROCESS
 15433             MOVE ER-4005          TO EMI-ERROR
 15434             MOVE -1               TO BMAINTL
 15435             MOVE AL-UABON         TO BMAINTA
 15436             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15437             GO TO 8200-SEND-DATAONLY.
 15438**********
 15439
 15440     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15441        MOVE -1                 TO CMAINTL
 15442        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 282
* EL6311.cbl
 15443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15444        GO TO 8200-SEND-DATAONLY.
 15445
 15446     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15447        MOVE ER-2196             TO EMI-ERROR
 15448        MOVE AL-UABON            TO CMAINTA
 15449        MOVE -1                  TO CMAINTL
 15450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15451        GO TO 8200-SEND-DATAONLY.
 15452     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15453
 15454     IF PB-BILLED-DT = LOW-VALUES AND
 15455        PB-CHG-COUNT = ZEROS
 15456        NEXT SENTENCE
 15457     ELSE
 15458        IF (CREFND1L GREATER THAN ZEROS AND
 15459            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15460           OR
 15461           (CREFND2L GREATER THAN ZEROS AND
 15462            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15463           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15464     if ((crefnd1l <> zeros)
 15465        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15466                      or
 15467        ((crefnd2l <> zeros)
 15468        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15469        continue
 15470     else
 15471        go to 2330-continue-change
 15472     end-if
 15473
 15474     move zeros                  to ws-check-amts
 15475     move ' '                    to ws-stop-sw
 15476                                    ws-check-sw
 15477                                    ws-any-check-sw
 15478                                    ws-proc-check-sw
 15479                                    ws-chek-browse-sw
 15480
 15481     perform 2500-browse-checks  thru 2500-exit
 15482
 15483     if i-have-processed-checks
 15484        or i-have-checks
 15485        continue
 15486     else
 15487        go to 2330-continue-change
 15488     end-if
 15489
 15490     if crefnd1l <> zeros
 15491        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15492        move ws-crefnd1 to ws-new-ref-total
 15493     else
 15494        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15495     end-if
 15496     if crefnd2l <> zeros
 15497        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15498        compute ws-new-ref-total = ws-new-ref-total +
 15499           ws-crefnd2
 15500     else
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 283
* EL6311.cbl
 15501        compute ws-new-ref-total = ws-new-ref-total +
 15502           pb-c-ah-cancel-amt
 15503     end-if
 15504
 15505     if zeros = (ws-lf-diff + ws-ah-diff)
 15506        move er-3449             to emi-error
 15507        perform 9900-error-format thru 9900-exit
 15508        go to 2330-continue-change
 15509     end-if
 15510
 15511     if (ws-new-ref-total < ws-check-amts)
 15512        and (pb-c-refund-sw = 'Y')
 15513        move er-3447             to emi-error
 15514        perform 9900-error-format thru 9900-exit
 15515        move al-uabon            to cmainta
 15516        move -1                  to cmaintl
 15517        go to 8200-send-dataonly
 15518     end-if
 15519
 15520     if (ws-new-ref-total > ws-check-amts)
 15521        and (ws-check-amts not = zeros)
 15522        move er-3448             to emi-error
 15523        move al-uabon            to crefnd1a
 15524                                    crefnd2a
 15525        perform 9900-error-format thru 9900-exit
 15526     end-if
 15527
 15528*     if (ws-lf-diff + ws-ah-diff) < zeros
 15529*        move er-3447             to emi-error
 15530*        perform 9900-error-format thru 9900-exit
 15531*        move al-uabon            to cmainta
 15532*        move -1                  to cmaintl
 15533*        go to 8200-send-dataonly
 15534*     end-if
 15535     .
 15536 2330-continue-change.
 15537
 15538
 15539* EXEC CICS READ
 15540*        DATASET (FILE-ID-ERPNDB)
 15541*        INTO    (PENDING-BUSINESS)
 15542*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15543*        UPDATE
 15544*    END-EXEC.
 15545     MOVE LENGTH OF
 15546      PENDING-BUSINESS
 15547       TO DFHEIV11
 15548*    MOVE '&"IL       EU         (   #00013869' TO DFHEIV0
 15549     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15550     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15551     MOVE X'2020233030303133383639' TO DFHEIV0(25:11)
 15552     CALL 'kxdfhei1' USING DFHEIV0,
 15553           FILE-ID-ERPNDB,
 15554           PENDING-BUSINESS,
 15555           DFHEIV11,
 15556           PI-PREV-CONTROL-PRIMARY,
 15557           DFHEIV99,
 15558           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 284
* EL6311.cbl
 15559           DFHEIV99
 15560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15561
 15562
 15563     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15564     MOVE 'B'                    TO JP-RECORD-TYPE
 15565     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15566     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15567
 15568     PERFORM 8400-LOG-JOURNAL-RECORD.
 15569
 15570     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15571          PB-CHG-COUNT NOT = ZEROS
 15572        IF (CREFND1L GREATER THAN ZEROS AND
 15573            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15574           OR
 15575           (CREFND2L GREATER THAN ZEROS AND
 15576            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15577            ADD +1                      TO PB-CHG-COUNT
 15578            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15579
 15580*    IF CMICRNOL  GREATER  ZEROS
 15581*        IF CMICRNOI  NUMERIC
 15582*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15583*            MOVE AL-UNNON       TO  CMICRNOA
 15584*        ELSE
 15585*            MOVE -1             TO  CMICRNOL
 15586*            MOVE AL-UNBON       TO  CMICRNOA
 15587*            MOVE ER-2701        TO  EMI-ERROR
 15588*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15589
 15590     IF CSUFIXL GREATER THAN ZEROS
 15591        MOVE CSUFIXI             TO PB-CERT-SFX.
 15592
 15593     IF CLSTNML GREATER THAN ZEROS
 15594         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15595
 15596     IF CCANREAL > ZEROS
 15597        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15598     END-IF
 15599     IF CPCYNL > ZEROS
 15600        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15601     END-IF
 15602     IF CCANDT1L    GREATER THAN ZEROS
 15603        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15604
 15605     IF CCANDT2L    GREATER THAN ZEROS
 15606        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15607
 15608     IF CMTHD1L    GREATER THAN +0
 15609        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15610
 15611     IF CMTHD2L    GREATER THAN +0
 15612        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15613
 15614     IF CREFND1L    GREATER THAN ZEROS
 15615        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15616        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 285
* EL6311.cbl
 15617        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15618        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15619
 15620     IF CREFND2L    GREATER THAN ZEROS
 15621        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15622        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15623        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15624        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15625
 15626     IF CLIVESL     GREATER THAN ZEROS
 15627        MOVE WS-CLIVES           TO PB-C-LIVES.
 15628
 15629     IF CPAYEEL     GREATER THAN ZEROS
 15630        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15631
 15632     IF CFORCEL     GREATER THAN ZEROS
 15633        MOVE CFORCEI             TO PB-FORCE-CODE.
 15634
 15635     IF CBILCDL     GREATER THAN ZEROS
 15636        MOVE CBILCDI             TO PB-RECORD-BILL.
 15637
 15638 2360-REWRITE-PB-RECORD.
 15639     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15640     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15641     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15642     MOVE 'C'                    TO JP-RECORD-TYPE.
 15643     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15644     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15645     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15646
 15647     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15648
 15649     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15650     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15651
 15652     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15653
 15654     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15655
 15656     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15657     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15658     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15659
 15660     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15661     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15662
 15663 2375-REWRITE-PENDING-BUSINESS.
 15664     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15665     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15666     MOVE 'C'                    TO JP-RECORD-TYPE.
 15667     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15668
 15669
 15670* EXEC CICS REWRITE
 15671*        DATASET (FILE-ID-ERPNDB)
 15672*        FROM    (PENDING-BUSINESS)
 15673*    END-EXEC.
 15674     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 286
* EL6311.cbl
 15675      PENDING-BUSINESS
 15676       TO DFHEIV11
 15677*    MOVE '&& L                  %   #00013982' TO DFHEIV0
 15678     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15679     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15680     MOVE X'2020233030303133393832' TO DFHEIV0(25:11)
 15681     CALL 'kxdfhei1' USING DFHEIV0,
 15682           FILE-ID-ERPNDB,
 15683           PENDING-BUSINESS,
 15684           DFHEIV11,
 15685           DFHEIV99
 15686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15687
 15688
 15689     PERFORM 8400-LOG-JOURNAL-RECORD.
 15690
 15691******************************************************************
 15692*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15693******************************************************************
 15694
 15695     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15696     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15697     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15698     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15699
 15700
 15701* EXEC CICS READ
 15702*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15703*        DATASET (FILE-ID-ELCERT)
 15704*        RIDFLD  (ELCERT-KEY)
 15705*        RESP    (WS-RESPONSE)
 15706*    END-EXEC.
 15707*    MOVE '&"S        E          (  N#00013998' TO DFHEIV0
 15708     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15709     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15710     MOVE X'204E233030303133393938' TO DFHEIV0(25:11)
 15711     CALL 'kxdfhei1' USING DFHEIV0,
 15712           FILE-ID-ELCERT,
 15713           DFHEIV20,
 15714           DFHEIV99,
 15715           ELCERT-KEY,
 15716           DFHEIV99,
 15717           DFHEIV99,
 15718           DFHEIV99
 15719     SET ADDRESS OF CERTIFICATE-MASTER TO
 15720         DFHEIV20
 15721     MOVE EIBRESP  TO WS-RESPONSE
 15722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15723
 15724
 15725     IF NOT RESP-NORMAL
 15726        GO TO 2376-BYPASS-CRTO
 15727     END-IF
 15728
 15729
 15730     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15731     MOVE ' '                    TO WS-ERMAIL-SW
 15732
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 287
* EL6311.cbl
 15733
 15734* EXEC CICS READ
 15735*       DATASET   (FILE-ID-ERMAIL)
 15736*       SET       (ADDRESS OF MAILING-DATA)
 15737*       RIDFLD    (ERMAIL-KEY)
 15738*       RESP      (WS-RESPONSE)
 15739*    END-EXEC
 15740*    MOVE '&"S        E          (  N#00014013' TO DFHEIV0
 15741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15743     MOVE X'204E233030303134303133' TO DFHEIV0(25:11)
 15744     CALL 'kxdfhei1' USING DFHEIV0,
 15745           FILE-ID-ERMAIL,
 15746           DFHEIV20,
 15747           DFHEIV99,
 15748           ERMAIL-KEY,
 15749           DFHEIV99,
 15750           DFHEIV99,
 15751           DFHEIV99
 15752     SET ADDRESS OF MAILING-DATA TO
 15753         DFHEIV20
 15754     MOVE EIBRESP  TO WS-RESPONSE
 15755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15756
 15757     IF RESP-NORMAL
 15758        SET ERMAIL-FOUND TO TRUE
 15759     END-IF
 15760
 15761     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15762
 15763     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15764                                 TO ELCRTO-KEY
 15765     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15766     MOVE +0                     TO ELCRTO-SEQ-NO
 15767
 15768
 15769* EXEC CICS READ
 15770*       DATASET   ('ELCRTO')
 15771*       INTO      (ORIGINAL-CERTIFICATE)
 15772*       RIDFLD    (ELCRTO-KEY)
 15773*       GTEQ
 15774*       RESP      (WS-RESPONSE)
 15775*    END-EXEC
 15776     MOVE LENGTH OF
 15777      ORIGINAL-CERTIFICATE
 15778       TO DFHEIV11
 15779     MOVE 'ELCRTO' TO DFHEIV1
 15780*    MOVE '&"IL       G          (  N#00014031' TO DFHEIV0
 15781     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15783     MOVE X'204E233030303134303331' TO DFHEIV0(25:11)
 15784     CALL 'kxdfhei1' USING DFHEIV0,
 15785           DFHEIV1,
 15786           ORIGINAL-CERTIFICATE,
 15787           DFHEIV11,
 15788           ELCRTO-KEY,
 15789           DFHEIV99,
 15790           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 288
* EL6311.cbl
 15791           DFHEIV99
 15792     MOVE EIBRESP  TO WS-RESPONSE
 15793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15794
 15795     IF RESP-NORMAL
 15796        AND (OC-CONTROL-PRIMARY (1:33) =
 15797                 PB-CONTROL-BY-ACCOUNT (1:33))
 15798        AND (OC-RECORD-TYPE = 'I')
 15799        display ' resp norm, key =, type i '
 15800        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15801           display ' end proc blank '
 15802           display ' csr edit session ' PI-CSR-SESSION-SW
 15803           IF NOT CSR-EDIT-SESSION
 15804
 15805* EXEC CICS READ
 15806*                DATASET   ('ELCRTO')
 15807*                INTO      (ORIGINAL-CERTIFICATE)
 15808*                RIDFLD    (OC-CONTROL-PRIMARY)
 15809*                UPDATE
 15810*                RESP      (WS-RESPONSE)
 15811*             END-EXEC
 15812     MOVE LENGTH OF
 15813      ORIGINAL-CERTIFICATE
 15814       TO DFHEIV11
 15815     MOVE 'ELCRTO' TO DFHEIV1
 15816*    MOVE '&"IL       EU         (  N#00014048' TO DFHEIV0
 15817     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15818     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15819     MOVE X'204E233030303134303438' TO DFHEIV0(25:11)
 15820     CALL 'kxdfhei1' USING DFHEIV0,
 15821           DFHEIV1,
 15822           ORIGINAL-CERTIFICATE,
 15823           DFHEIV11,
 15824           OC-CONTROL-PRIMARY,
 15825           DFHEIV99,
 15826           DFHEIV99,
 15827           DFHEIV99
 15828     MOVE EIBRESP  TO WS-RESPONSE
 15829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15830              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15831              IF RESP-NORMAL
 15832                 display ' good read upd '
 15833                 IF OC-ISSUE-TRAN-IND = 'N'
 15834                    MOVE CM-INSURED-LAST-NAME   TO
 15835                         OC-INS-LAST-NAME
 15836                    MOVE CM-INSURED-FIRST-NAME  TO
 15837                         OC-INS-FIRST-NAME
 15838                    MOVE CM-INSURED-INITIAL2    TO
 15839                         OC-INS-MIDDLE-INIT
 15840                    MOVE CM-INSURED-ISSUE-AGE   TO
 15841                         OC-INS-AGE
 15842                    MOVE CM-JT-LAST-NAME        TO
 15843                         OC-JNT-LAST-NAME
 15844                    MOVE CM-JT-FIRST-NAME       TO
 15845                         OC-JNT-FIRST-NAME
 15846                    MOVE CM-JT-INITIAL          TO
 15847                         OC-JNT-MIDDLE-INIT
 15848                    MOVE CM-INSURED-JOINT-AGE   TO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 289
* EL6311.cbl
 15849                         OC-JNT-AGE
 15850                    MOVE CM-LF-BENEFIT-CD       TO
 15851                         OC-LF-BENCD
 15852                    MOVE CM-LF-ORIG-TERM        TO
 15853                         OC-LF-TERM
 15854                    MOVE CM-LF-BENEFIT-AMT      TO
 15855                         OC-LF-BEN-AMT
 15856                    MOVE CM-LF-PREMIUM-AMT      TO
 15857                         OC-LF-PRM-AMT
 15858                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15859                         OC-LF-ALT-BEN-AMT
 15860                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15861                         OC-LF-ALT-PRM-AMT
 15862                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15863                         OC-LF-EXP-DT
 15864                    MOVE CM-LIFE-COMM-PCT       TO
 15865                         OC-LF-COMM-PCT
 15866                    MOVE CM-AH-BENEFIT-CD       TO
 15867                         OC-AH-BENCD
 15868                    MOVE CM-AH-ORIG-TERM        TO
 15869                         OC-AH-TERM
 15870                    MOVE CM-AH-BENEFIT-AMT      TO
 15871                         OC-AH-BEN-AMT
 15872                    MOVE CM-AH-PREMIUM-AMT      TO
 15873                         OC-AH-PRM-AMT
 15874                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15875                         OC-AH-EXP-DT
 15876                    MOVE CM-AH-COMM-PCT         TO
 15877                         OC-AH-COMM-PCT
 15878                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15879                         OC-AH-CP
 15880                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15881                         OC-1ST-PMT-DT
 15882                 END-IF
 15883                 MOVE PB-C-LF-CANCEL-DT      TO
 15884                         OC-LF-CANCEL-DT
 15885                 MOVE PB-C-LF-CANCEL-AMT     TO
 15886                         OC-LF-CANCEL-AMT
 15887                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15888                         OC-LF-ITD-CANCEL-AMT
 15889                 MOVE PB-C-AH-CANCEL-DT      TO
 15890                         OC-AH-CANCEL-DT
 15891                 MOVE PB-C-AH-CANCEL-AMT     TO
 15892                         OC-AH-CANCEL-AMT
 15893                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15894                         OC-AH-ITD-CANCEL-AMT
 15895                 MOVE 'Y'                    TO
 15896                         OC-CANCEL-TRAN-IND
 15897                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15898                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15899                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15900                 IF ERMAIL-FOUND
 15901                    MOVE MA-CRED-BENE-NAME
 15902                                 TO OC-CRED-BENE-NAME
 15903                 END-IF
 15904                 IF NOT CERT-TRL-REC-NOT-FOUND
 15905                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15906                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 290
* EL6311.cbl
 15907                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15908                           OC-JNT-AGE-DEFAULT-FLAG
 15909                 END-IF
 15910
 15911* EXEC CICS REWRITE
 15912*                   DATASET   ('ELCRTO')
 15913*                   FROM      (ORIGINAL-CERTIFICATE)
 15914*                   RESP      (WS-RESPONSE)
 15915*                END-EXEC
 15916     MOVE LENGTH OF
 15917      ORIGINAL-CERTIFICATE
 15918       TO DFHEIV11
 15919     MOVE 'ELCRTO' TO DFHEIV1
 15920*    MOVE '&& L                  %  N#00014135' TO DFHEIV0
 15921     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15922     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15923     MOVE X'204E233030303134313335' TO DFHEIV0(25:11)
 15924     CALL 'kxdfhei1' USING DFHEIV0,
 15925           DFHEIV1,
 15926           ORIGINAL-CERTIFICATE,
 15927           DFHEIV11,
 15928           DFHEIV99
 15929     MOVE EIBRESP  TO WS-RESPONSE
 15930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15931                 display ' just rewrote ' ws-response
 15932              END-IF
 15933           END-IF
 15934        ELSE
 15935           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15936           MOVE 'OC'             TO OC-RECORD-ID
 15937           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15938           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15939           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15940           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15941           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15942           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15943           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15944           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15945           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15946           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15947           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15948           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15949           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15950           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15951           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15952           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15953           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15954           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15955           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15956           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15957           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15958           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15959           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15960           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15961           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15962           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15963           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15964           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 291
* EL6311.cbl
 15965           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15966           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15967           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15968           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15969           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15970           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15971           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15972           IF ERMAIL-FOUND
 15973              MOVE MA-CRED-BENE-NAME
 15974                                 TO OC-CRED-BENE-NAME
 15975           END-IF
 15976           IF NOT CERT-TRL-REC-NOT-FOUND
 15977              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15978                           OC-INS-AGE-DEFAULT-FLAG
 15979              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15980                           OC-JNT-AGE-DEFAULT-FLAG
 15981           END-IF
 15982           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15983
 15984* EXEC CICS WRITE
 15985*             DATASET   ('ELCRTO')
 15986*             FROM      (ORIGINAL-CERTIFICATE)
 15987*             RIDFLD    (OC-CONTROL-PRIMARY)
 15988*             RESP      (WS-RESPONSE)
 15989*          END-EXEC
 15990     MOVE LENGTH OF
 15991      ORIGINAL-CERTIFICATE
 15992       TO DFHEIV11
 15993     MOVE 'ELCRTO' TO DFHEIV1
 15994*    MOVE '&$ L                  ''  N#00014192' TO DFHEIV0
 15995     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15996     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15997     MOVE X'204E233030303134313932' TO DFHEIV0(25:11)
 15998     CALL 'kxdfhei1' USING DFHEIV0,
 15999           DFHEIV1,
 16000           ORIGINAL-CERTIFICATE,
 16001           DFHEIV11,
 16002           OC-CONTROL-PRIMARY,
 16003           DFHEIV99,
 16004           DFHEIV99
 16005     MOVE EIBRESP  TO WS-RESPONSE
 16006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16007        END-IF
 16008     ELSE
 16009        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16010        MOVE 'OC'                TO OC-RECORD-ID
 16011        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16012                                 TO OC-CONTROL-PRIMARY (1:33)
 16013        MOVE 'I'                 TO OC-RECORD-TYPE
 16014        MOVE +4096               TO OC-KEY-SEQ-NO
 16015        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16016        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16017        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16018        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16019        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16020        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16021        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16022        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 292
* EL6311.cbl
 16023        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16024        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16025        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16026        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16027        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16028        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16029        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16030        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16031        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16032        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16033        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16034        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16035        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16036        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16037        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16038        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16039        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16040        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16041        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16042        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16043        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16044        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16045        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16046        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16047        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16048        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16049        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16050        IF ERMAIL-FOUND
 16051           MOVE MA-CRED-BENE-NAME
 16052                                 TO OC-CRED-BENE-NAME
 16053        END-IF
 16054        IF NOT CERT-TRL-REC-NOT-FOUND
 16055           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16056                           OC-INS-AGE-DEFAULT-FLAG
 16057           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16058                           OC-JNT-AGE-DEFAULT-FLAG
 16059        END-IF
 16060        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16061
 16062
 16063* EXEC CICS WRITE
 16064*          DATASET   ('ELCRTO')
 16065*          FROM      (ORIGINAL-CERTIFICATE)
 16066*          RIDFLD    (OC-CONTROL-PRIMARY)
 16067*          RESP      (WS-RESPONSE)
 16068*       END-EXEC
 16069     MOVE LENGTH OF
 16070      ORIGINAL-CERTIFICATE
 16071       TO DFHEIV11
 16072     MOVE 'ELCRTO' TO DFHEIV1
 16073*    MOVE '&$ L                  ''  N#00014253' TO DFHEIV0
 16074     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16075     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16076     MOVE X'204E233030303134323533' TO DFHEIV0(25:11)
 16077     CALL 'kxdfhei1' USING DFHEIV0,
 16078           DFHEIV1,
 16079           ORIGINAL-CERTIFICATE,
 16080           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 293
* EL6311.cbl
 16081           OC-CONTROL-PRIMARY,
 16082           DFHEIV99,
 16083           DFHEIV99
 16084     MOVE EIBRESP  TO WS-RESPONSE
 16085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16086     END-IF.
 16087
 16088 2376-BYPASS-CRTO.
 16089******************************************************************
 16090*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16091******************************************************************
 16092
 16093
 16094* EXEC CICS HANDLE CONDITION
 16095*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16096*    END-EXEC.
 16097*    MOVE '"$I                   ! 7 #00014266' TO DFHEIV0
 16098     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16100     MOVE X'3720233030303134323636' TO DFHEIV0(25:11)
 16101     CALL 'kxdfhei1' USING DFHEIV0
 16102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16103
 16104
 16105
 16106* EXEC CICS READ
 16107*        INTO    (PENDING-BUSINESS)
 16108*        DATASET (FILE-ID-ERPNDB)
 16109*        RIDFLD  (ERPNDB-KEY)
 16110*        UPDATE
 16111*    END-EXEC.
 16112     MOVE LENGTH OF
 16113      PENDING-BUSINESS
 16114       TO DFHEIV11
 16115*    MOVE '&"IL       EU         (   #00014270' TO DFHEIV0
 16116     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16117     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16118     MOVE X'2020233030303134323730' TO DFHEIV0(25:11)
 16119     CALL 'kxdfhei1' USING DFHEIV0,
 16120           FILE-ID-ERPNDB,
 16121           PENDING-BUSINESS,
 16122           DFHEIV11,
 16123           ERPNDB-KEY,
 16124           DFHEIV99,
 16125           DFHEIV99,
 16126           DFHEIV99
 16127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16128
 16129
 16130     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16131     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16132     MOVE 'B'                    TO JP-RECORD-TYPE.
 16133     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16134
 16135     PERFORM 8400-LOG-JOURNAL-RECORD.
 16136
 16137     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16138
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 294
* EL6311.cbl
 16139
 16140* EXEC CICS REWRITE
 16141*        DATASET (FILE-ID-ERPNDB)
 16142*        FROM    (PENDING-BUSINESS)
 16143*    END-EXEC.
 16144     MOVE LENGTH OF
 16145      PENDING-BUSINESS
 16146       TO DFHEIV11
 16147*    MOVE '&& L                  %   #00014286' TO DFHEIV0
 16148     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16149     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16150     MOVE X'2020233030303134323836' TO DFHEIV0(25:11)
 16151     CALL 'kxdfhei1' USING DFHEIV0,
 16152           FILE-ID-ERPNDB,
 16153           PENDING-BUSINESS,
 16154           DFHEIV11,
 16155           DFHEIV99
 16156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16157
 16158
 16159     MOVE 'C'                    TO JP-RECORD-TYPE.
 16160     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16161
 16162     PERFORM 8400-LOG-JOURNAL-RECORD.
 16163
 16164     IF WS-ERRORS-PRESENT
 16165         GO TO 3900-RE-DISPLAY-RECORD.
 16166
 16167     MOVE ZEROS                  TO EMI-ERROR
 16168     MOVE -1                     TO CMAINTL
 16169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16170     GO TO 3900-RE-DISPLAY-RECORD.
 16171
 16172 2380-BATCH-HDR-NOT-FOUND.
 16173     MOVE -1                     TO BMAINTL.
 16174     MOVE ER-7450                TO EMI-ERROR.
 16175     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16176     GO TO 8200-SEND-DATAONLY.
 16177
 16178 2385-REC-NOT-FOUND.
 16179     MOVE -1                     TO BMAINTL.
 16180     MOVE ER-7451                TO EMI-ERROR.
 16181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16182     GO TO 8200-SEND-DATAONLY.
 16183
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 295
* EL6311.cbl
 16185
 16186******************************************************************
 16187*                                                                *
 16188*          D E L E T E   C A N C E L   R O U T I N E             *
 16189*                                                                *
 16190******************************************************************
 16191
 16192 2400-DELETE-CANCEL-ROUTINE.
 16193     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16194
 16195     IF CCHGL NOT = ZEROS
 16196        MOVE ER-2196             TO EMI-ERROR
 16197        MOVE AL-UABON            TO CMAINTA
 16198        MOVE -1                  TO CMAINTL
 16199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16200        GO TO 8200-SEND-DATAONLY.
 16201
 16202
 16203* EXEC CICS HANDLE CONDITION
 16204*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16205*    END-EXEC.
 16206*    MOVE '"$I                   ! 8 #00014334' TO DFHEIV0
 16207     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16209     MOVE X'3820233030303134333334' TO DFHEIV0(25:11)
 16210     CALL 'kxdfhei1' USING DFHEIV0
 16211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16212
 16213
 16214     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16215     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16216     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16217
 16218
 16219* EXEC CICS READ
 16220*        SET     (ADDRESS OF PENDING-BUSINESS)
 16221*        DATASET (FILE-ID-ERPNDB)
 16222*        RIDFLD  (ERPNDB-KEY)
 16223*    END-EXEC.
 16224*    MOVE '&"S        E          (   #00014342' TO DFHEIV0
 16225     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16226     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16227     MOVE X'2020233030303134333432' TO DFHEIV0(25:11)
 16228     CALL 'kxdfhei1' USING DFHEIV0,
 16229           FILE-ID-ERPNDB,
 16230           DFHEIV20,
 16231           DFHEIV99,
 16232           ERPNDB-KEY,
 16233           DFHEIV99,
 16234           DFHEIV99,
 16235           DFHEIV99
 16236     SET ADDRESS OF PENDING-BUSINESS TO
 16237         DFHEIV20
 16238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16239
 16240
 16241     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16242
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 296
* EL6311.cbl
 16243     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16244
 16245     IF CSUFIXL NOT = ZEROS
 16246        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16247     ELSE
 16248        MOVE SPACE               TO WS-NEW-SUFFIX.
 16249
 16250     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16251
 16252     PERFORM 8600-DEEDIT.
 16253     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16254     MOVE '4'                    TO DC-OPTION-CODE.
 16255     PERFORM 9700-DATE-LINK.
 16256
 16257     IF DATE-CONVERSION-ERROR
 16258        MOVE ER-0348             TO EMI-ERROR
 16259        MOVE -1                  TO CEFFDTL
 16260        MOVE AL-UABON            TO CEFFDTA
 16261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16262        GO TO 8200-SEND-DATAONLY
 16263     ELSE
 16264        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16265        MOVE AL-UANON            TO CEFFDTA
 16266        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16267
 16268
 16269* EXEC CICS HANDLE CONDITION
 16270*         NOTFND    (2490-RECORD-NOT-FOUND)
 16271*    END-EXEC.
 16272*    MOVE '"$I                   ! 9 #00014375' TO DFHEIV0
 16273     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16275     MOVE X'3920233030303134333735' TO DFHEIV0(25:11)
 16276     CALL 'kxdfhei1' USING DFHEIV0
 16277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16278
 16279
 16280
 16281* EXEC CICS READ
 16282*        SET     (ADDRESS OF PENDING-BUSINESS)
 16283*        DATASET (FILE-ID-ERPNDB)
 16284*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16285*        UPDATE
 16286*    END-EXEC.
 16287*    MOVE '&"S        EU         (   #00014379' TO DFHEIV0
 16288     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16289     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16290     MOVE X'2020233030303134333739' TO DFHEIV0(25:11)
 16291     CALL 'kxdfhei1' USING DFHEIV0,
 16292           FILE-ID-ERPNDB,
 16293           DFHEIV20,
 16294           DFHEIV99,
 16295           PI-PREV-CONTROL-PRIMARY,
 16296           DFHEIV99,
 16297           DFHEIV99,
 16298           DFHEIV99
 16299     SET ADDRESS OF PENDING-BUSINESS TO
 16300         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 297
* EL6311.cbl
 16301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16302
 16303
 16304     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16305        MOVE -1                 TO CMAINTL
 16306        MOVE ER-2197            TO EMI-ERROR
 16307        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16308        GO TO 8200-SEND-DATAONLY.
 16309
 16310     IF PB-BILLED-DT NOT = LOW-VALUES
 16311        MOVE -1                 TO CMAINTL
 16312        MOVE ER-2129            TO EMI-ERROR
 16313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16314        GO TO 8200-SEND-DATAONLY.
 16315
 16316     IF PB-CHG-COUNT NOT = ZEROS
 16317        MOVE ER-2336            TO EMI-ERROR
 16318        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16319        MOVE AL-UABON            TO CMAINTA
 16320        MOVE -1                  TO CMAINTL
 16321        GO TO 8200-SEND-DATAONLY.
 16322
 16323     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16324        PB-CHG-COUNT NOT = ZEROS
 16325        MOVE ER-2196             TO EMI-ERROR
 16326        MOVE AL-UABON            TO CMAINTA
 16327        MOVE -1                  TO CMAINTL
 16328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16329        GO TO 8200-SEND-DATAONLY.
 16330
 16331     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16332        MOVE ER-2900 TO EMI-ERROR
 16333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16334        MOVE AL-UABON         TO CMAINTA
 16335        MOVE -1               TO CMAINTL
 16336        GO TO 8200-SEND-DATAONLY.
 16337     move ' '                    to ws-stop-sw
 16338                                    ws-check-sw
 16339                                    ws-any-check-sw
 16340                                    ws-proc-check-sw
 16341                                    ws-chek-browse-sw
 16342
 16343     perform 2500-browse-checks  thru 2500-exit
 16344     if (i-have-processed-checks)
 16345        and (pb-c-refund-sw = 'Y')
 16346        move er-3446             to emi-error
 16347        perform 9900-error-format thru 9900-exit
 16348        move al-uabon            to cmainta
 16349        move -1                  to cmaintl
 16350        go to 8200-send-dataonly
 16351     end-if
 16352
 16353* EXEC CICS HANDLE CONDITION
 16354*         NOTFND  (2475-CONTINUE-DELETE)
 16355*    END-EXEC
 16356*    MOVE '"$I                   ! : #00014434' TO DFHEIV0
 16357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 298
* EL6311.cbl
 16359     MOVE X'3A20233030303134343334' TO DFHEIV0(25:11)
 16360     CALL 'kxdfhei1' USING DFHEIV0
 16361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16362
 16363     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16364     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16365     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16366     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16367
 16368
 16369* EXEC CICS READ
 16370*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16371*        DATASET (FILE-ID-ELCERT)
 16372*        RIDFLD  (ELCERT-KEY)
 16373*        UPDATE
 16374*    END-EXEC.
 16375*    MOVE '&"S        EU         (   #00014443' TO DFHEIV0
 16376     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16377     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16378     MOVE X'2020233030303134343433' TO DFHEIV0(25:11)
 16379     CALL 'kxdfhei1' USING DFHEIV0,
 16380           FILE-ID-ELCERT,
 16381           DFHEIV20,
 16382           DFHEIV99,
 16383           ELCERT-KEY,
 16384           DFHEIV99,
 16385           DFHEIV99,
 16386           DFHEIV99
 16387     SET ADDRESS OF CERTIFICATE-MASTER TO
 16388         DFHEIV20
 16389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16390
 16391
 16392     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16393
 16394     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16395     MOVE 'B'                    TO JP-RECORD-TYPE.
 16396     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16397     PERFORM 8400-LOG-JOURNAL-RECORD.
 16398
 16399     IF PB-CI-LIVES NOT NUMERIC
 16400         MOVE ZERO                    TO PB-CI-LIVES.
 16401
 16402     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16403        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16404           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16405           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16406           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16407                                            CM-LF-CANCEL-DT
 16408           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16409        ELSE
 16410           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16411           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16412           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16413           MOVE PB-CI-LIVES              TO CM-LIVES.
 16414
 16415     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16416        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 299
* EL6311.cbl
 16417           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16418               MOVE CM-LF-STATUS-AT-CANCEL
 16419                                        TO CM-LF-CURRENT-STATUS
 16420               MOVE SPACE
 16421                                        TO CM-LF-STATUS-AT-CANCEL
 16422           ELSE
 16423               MOVE PB-CI-LF-POLICY-STATUS
 16424                                        TO CM-LF-CURRENT-STATUS
 16425        ELSE
 16426           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16427
 16428
 16429     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16430        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16431           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16432           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16433           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16434                                            CM-AH-CANCEL-DT
 16435           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16436        ELSE
 16437           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16438           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16439           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16440           MOVE PB-CI-LIVES              TO CM-LIVES.
 16441
 16442     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16443        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16444           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16445               MOVE CM-AH-STATUS-AT-CANCEL
 16446                                        TO CM-AH-CURRENT-STATUS
 16447               MOVE SPACE
 16448                                        TO CM-AH-STATUS-AT-CANCEL
 16449           ELSE
 16450               MOVE PB-CI-AH-POLICY-STATUS
 16451                                        TO CM-AH-CURRENT-STATUS
 16452        ELSE
 16453           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16454
 16455 2450-REWRITE-CERT.
 16456     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16457     MOVE 'C'                      TO JP-RECORD-TYPE.
 16458     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16459
 16460
 16461* EXEC CICS REWRITE
 16462*        DATASET  (FILE-ID-ELCERT)
 16463*        FROM     (CERTIFICATE-MASTER)
 16464*    END-EXEC.
 16465     MOVE LENGTH OF
 16466      CERTIFICATE-MASTER
 16467       TO DFHEIV11
 16468*    MOVE '&& L                  %   #00014518' TO DFHEIV0
 16469     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16470     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16471     MOVE X'2020233030303134353138' TO DFHEIV0(25:11)
 16472     CALL 'kxdfhei1' USING DFHEIV0,
 16473           FILE-ID-ELCERT,
 16474           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 300
* EL6311.cbl
 16475           DFHEIV11,
 16476           DFHEIV99
 16477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16478
 16479
 16480     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16481
 16482     PERFORM 8400-LOG-JOURNAL-RECORD.
 16483
 16484     move ' '                    to ws-stop-sw
 16485                                    ws-any-check-sw
 16486                                    ws-proc-check-sw
 16487                                    ws-chek-browse-sw
 16488
 16489     if i-have-checks
 16490        perform until i-say-stop
 16491           perform 2510-startbr-erchek
 16492                                 thru 2510-exit
 16493           if resp-normal
 16494              perform 2520-readnext-erchek
 16495                                 thru 2520-exit
 16496           end-if
 16497           if (not resp-normal)
 16498              or (pb-control-by-account (1:33) not =
 16499                 ch-control-primary (1:33))
 16500                 set i-say-stop to true
 16501           else
 16502              perform 2530-readupd-erchek
 16503                                 thru 2530-exit
 16504              if resp-normal
 16505                 perform 2540-delete-erchek
 16506                                 thru 2540-exit
 16507              end-if
 16508              if ws-chek-browse-sw = 'Y'
 16509                 perform 2525-endbr-erchek
 16510                                 thru 2525-exit
 16511                 move ' '        to ws-chek-browse-sw
 16512              end-if
 16513           end-if
 16514        end-perform
 16515     end-if
 16516
 16517     if ws-chek-browse-sw = 'Y'
 16518        perform 2525-endbr-erchek thru 2525-exit
 16519     end-if
 16520     .
 16521 2475-CONTINUE-DELETE.
 16522     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16523     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16524
 16525     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16526     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16527
 16528     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16529
 16530     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16531     MOVE 'D'                    TO JP-RECORD-TYPE
 16532     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 301
* EL6311.cbl
 16533
 16534
 16535* EXEC CICS DELETE
 16536*        DATASET    (FILE-ID-ERPNDB)
 16537*    END-EXEC.
 16538*    MOVE '&(                    &   #00014577' TO DFHEIV0
 16539     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16540     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16541     MOVE X'2020233030303134353737' TO DFHEIV0(25:11)
 16542     CALL 'kxdfhei1' USING DFHEIV0,
 16543           FILE-ID-ERPNDB,
 16544           DFHEIV99,
 16545           DFHEIV99,
 16546           DFHEIV99,
 16547           DFHEIV99
 16548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16549
 16550
 16551     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16552
 16553     PERFORM 8400-LOG-JOURNAL-RECORD.
 16554
 16555     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16556     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16557
 16558
 16559* EXEC CICS HANDLE CONDITION
 16560*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16561*    END-EXEC.
 16562*    MOVE '"$I                   ! ; #00014588' TO DFHEIV0
 16563     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16565     MOVE X'3B20233030303134353838' TO DFHEIV0(25:11)
 16566     CALL 'kxdfhei1' USING DFHEIV0
 16567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16568
 16569
 16570
 16571* EXEC CICS READ
 16572*        SET     (ADDRESS OF PENDING-BUSINESS)
 16573*        DATASET (FILE-ID-ERPNDB)
 16574*        RIDFLD  (ERPNDB-KEY)
 16575*        UPDATE
 16576*    END-EXEC.
 16577*    MOVE '&"S        EU         (   #00014592' TO DFHEIV0
 16578     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16579     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16580     MOVE X'2020233030303134353932' TO DFHEIV0(25:11)
 16581     CALL 'kxdfhei1' USING DFHEIV0,
 16582           FILE-ID-ERPNDB,
 16583           DFHEIV20,
 16584           DFHEIV99,
 16585           ERPNDB-KEY,
 16586           DFHEIV99,
 16587           DFHEIV99,
 16588           DFHEIV99
 16589     SET ADDRESS OF PENDING-BUSINESS TO
 16590         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 302
* EL6311.cbl
 16591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16592
 16593
 16594     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16595     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16596
 16597     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16598        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16599        MOVE 'D'                 TO JP-RECORD-TYPE
 16600        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16601
 16602* EXEC CICS DELETE
 16603*            DATASET    (FILE-ID-ERPNDB)
 16604*       END-EXEC
 16605*    MOVE '&(                    &   #00014606' TO DFHEIV0
 16606     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16608     MOVE X'2020233030303134363036' TO DFHEIV0(25:11)
 16609     CALL 'kxdfhei1' USING DFHEIV0,
 16610           FILE-ID-ERPNDB,
 16611           DFHEIV99,
 16612           DFHEIV99,
 16613           DFHEIV99,
 16614           DFHEIV99
 16615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16616        PERFORM 8400-LOG-JOURNAL-RECORD
 16617     ELSE
 16618        MOVE 'B'                 TO JP-RECORD-TYPE
 16619        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16620        PERFORM 8400-LOG-JOURNAL-RECORD
 16621        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16622        MOVE 'C'                 TO JP-RECORD-TYPE
 16623        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16624
 16625* EXEC CICS REWRITE
 16626*            DATASET    (FILE-ID-ERPNDB)
 16627*            FROM       (PENDING-BUSINESS)
 16628*       END-EXEC
 16629     MOVE LENGTH OF
 16630      PENDING-BUSINESS
 16631       TO DFHEIV11
 16632*    MOVE '&& L                  %   #00014617' TO DFHEIV0
 16633     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16634     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16635     MOVE X'2020233030303134363137' TO DFHEIV0(25:11)
 16636     CALL 'kxdfhei1' USING DFHEIV0,
 16637           FILE-ID-ERPNDB,
 16638           PENDING-BUSINESS,
 16639           DFHEIV11,
 16640           DFHEIV99
 16641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16642        PERFORM 8400-LOG-JOURNAL-RECORD.
 16643
 16644******************************************************************
 16645*                                                                *
 16646*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16647*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16648*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 303
* EL6311.cbl
 16649******************************************************************
 16650
 16651     IF NOT PI-AR-PROCESSING
 16652        GO TO 2480-DELETE-FINISHED.
 16653
 16654     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16655        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16656        NEXT SENTENCE
 16657     ELSE
 16658        GO TO 2480-DELETE-FINISHED.
 16659
 16660
 16661* EXEC CICS HANDLE CONDITION
 16662*         NOTFND    (2480-DELETE-FINISHED)
 16663*    END-EXEC.
 16664*    MOVE '"$I                   ! < #00014639' TO DFHEIV0
 16665     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16667     MOVE X'3C20233030303134363339' TO DFHEIV0(25:11)
 16668     CALL 'kxdfhei1' USING DFHEIV0
 16669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16670
 16671
 16672     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16673     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16674
 16675
 16676* EXEC CICS READ
 16677*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16678*        DATASET (FILE-ID-ERRQST)
 16679*        RIDFLD  (ERRQST-KEY)
 16680*        UPDATE
 16681*    END-EXEC.
 16682*    MOVE '&"S        EU         (   #00014646' TO DFHEIV0
 16683     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16684     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16685     MOVE X'2020233030303134363436' TO DFHEIV0(25:11)
 16686     CALL 'kxdfhei1' USING DFHEIV0,
 16687           FILE-ID-ERRQST,
 16688           DFHEIV20,
 16689           DFHEIV99,
 16690           ERRQST-KEY,
 16691           DFHEIV99,
 16692           DFHEIV99,
 16693           DFHEIV99
 16694     SET ADDRESS OF AR-REQUEST-RECORD TO
 16695         DFHEIV20
 16696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16697
 16698
 16699     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16700
 16701     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16702
 16703     MOVE 'D'                      TO JP-RECORD-TYPE.
 16704     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16705
 16706
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 304
* EL6311.cbl
 16707* EXEC CICS DELETE
 16708*         DATASET    (FILE-ID-ERRQST)
 16709*    END-EXEC.
 16710*    MOVE '&(                    &   #00014660' TO DFHEIV0
 16711     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16713     MOVE X'2020233030303134363630' TO DFHEIV0(25:11)
 16714     CALL 'kxdfhei1' USING DFHEIV0,
 16715           FILE-ID-ERRQST,
 16716           DFHEIV99,
 16717           DFHEIV99,
 16718           DFHEIV99,
 16719           DFHEIV99
 16720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16721
 16722
 16723     PERFORM 8400-LOG-JOURNAL-RECORD.
 16724
 16725 2480-DELETE-FINISHED.
 16726     MOVE ZEROS                  TO EMI-ERROR.
 16727     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16728     MOVE LOW-VALUES             TO EL631CI.
 16729     MOVE -1                     TO CMAINTL.
 16730     GO TO 8100-SEND-INITIAL-MAP.
 16731
 16732 2485-BATCH-HDR-NOT-FOUND.
 16733     MOVE -1                     TO CMAINTL
 16734     MOVE AL-UABON               TO CMAINTA.
 16735     MOVE ER-7450                TO EMI-ERROR.
 16736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16737     GO TO 8200-SEND-DATAONLY.
 16738
 16739 2490-RECORD-NOT-FOUND.
 16740     MOVE -1                     TO CMAINTL
 16741     MOVE AL-UABON               TO CMAINTA.
 16742     MOVE ER-7451                TO EMI-ERROR.
 16743     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16744     GO TO 8200-SEND-DATAONLY.
 16745***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16746***                                                            ***
 16747***     2500  B R O W S E   C H E C K S                        ***
 16748***  We perform this routine from 2 different places.          ***
 16749***  1. If the user changes the refund amount on a cancel, we  ***
 16750***    want to.........                                        ***
 16751***    a. determine if prior checks have been processed        ***
 16752***    b. If the amt is larger, display message instructing    ***
 16753***     them to create another check to make up the difference.***
 16754***    c. If the amt is less, do not allow the change and      ***
 16755***     display a FATAL error suggesting they deal with check  ***
 16756***     records befor continuing.                              ***
 16757***  2. If the user wants to delete a cancel record we......   ***
 16758***    a. browse through all the checks and if there is a      ***
 16759***     processed check, send FATAL message.                   ***
 16760***    b. If there is a non-released check, then delete that   ***
 16761***     check after you delete the pending cancel record.      ***
 16762***                                                            ***
 16763***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16764
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 305
* EL6311.cbl
 16765 2500-browse-checks.
 16766
 16767     perform 2510-startbr-erchek thru 2510-exit
 16768
 16769     if not resp-normal
 16770        go to 2500-exit
 16771     end-if
 16772
 16773     perform until i-say-stop
 16774        perform 2520-readnext-erchek
 16775                                 thru 2520-exit
 16776        if (not resp-normal)
 16777           or (pb-control-by-account (1:33) not =
 16778              ch-control-primary (1:33))
 16779              set i-say-stop to true
 16780        else
 16781           set i-have-a-check-period to true
 16782           if (ch-approval-status) = ' '
 16783              and (ch-void-dt = low-values)
 16784              and (ch-released-dt = low-values)
 16785              set i-have-checks to true
 16786           else
 16787              if ch-void-dt = low-values
 16788                 set i-have-processed-checks to true
 16789              end-if
 16790           end-if
 16791           if (ch-credit-accept-dt = low-values)
 16792              and (ch-void-dt = low-values)
 16793              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16794              if (ch-check-origin-sw not = 'R')
 16795                 and (pb-record-type = '2')
 16796                 continue
 16797              else
 16798                 compute ws-check-amts =
 16799                    ws-check-amts + ch-amount-paid
 16800              end-if
 16801           end-if
 16802        end-if
 16803     end-perform
 16804
 16805     if ws-chek-browse-sw = 'Y'
 16806        perform 2525-endbr-erchek thru 2525-exit
 16807     end-if
 16808
 16809    .
 16810 2500-exit.
 16811     exit.
 16812
 16813 2510-startbr-erchek.
 16814
 16815     move pb-control-by-account  to erchek-key
 16816     move +0                     to chek-record-seq
 16817
 16818
 16819* exec cics startbr
 16820*       dataset   ('ERCHEK')
 16821*       ridfld    (erchek-key)
 16822*       gteq
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 306
* EL6311.cbl
 16823*       resp      (ws-response)
 16824*    end-exec
 16825     MOVE 'ERCHEK' TO DFHEIV1
 16826     MOVE 0
 16827       TO DFHEIV11
 16828*    MOVE '&,         G          &  N#00014759' TO DFHEIV0
 16829     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16830     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16831     MOVE X'204E233030303134373539' TO DFHEIV0(25:11)
 16832     CALL 'kxdfhei1' USING DFHEIV0,
 16833           DFHEIV1,
 16834           erchek-key,
 16835           DFHEIV99,
 16836           DFHEIV11,
 16837           DFHEIV99
 16838     MOVE EIBRESP  TO ws-response
 16839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16840
 16841     IF RESP-NORMAL
 16842        move 'Y'                 to ws-chek-browse-sw
 16843     end-if
 16844
 16845     .
 16846 2510-exit.
 16847     exit.
 16848
 16849 2520-readnext-erchek.
 16850
 16851
 16852* EXEC CICS READNEXT
 16853*       SET     (ADDRESS OF CHECK-RECORDS)
 16854*       DATASET ('ERCHEK')
 16855*       RIDFLD  (ERCHEK-KEY)
 16856*       RESP    (WS-RESPONSE)
 16857*    END-EXEC
 16858     MOVE 'ERCHEK' TO DFHEIV1
 16859     MOVE 0
 16860       TO DFHEIV11
 16861*    MOVE '&.S                   )  N#00014776' TO DFHEIV0
 16862     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16863     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16864     MOVE X'204E233030303134373736' TO DFHEIV0(25:11)
 16865     CALL 'kxdfhei1' USING DFHEIV0,
 16866           DFHEIV1,
 16867           DFHEIV20,
 16868           DFHEIV99,
 16869           ERCHEK-KEY,
 16870           DFHEIV99,
 16871           DFHEIV11,
 16872           DFHEIV99,
 16873           DFHEIV99
 16874     SET ADDRESS OF CHECK-RECORDS TO
 16875         DFHEIV20
 16876     MOVE EIBRESP  TO WS-RESPONSE
 16877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16878
 16879     .
 16880 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 307
* EL6311.cbl
 16881     exit.
 16882
 16883 2525-endbr-erchek.
 16884
 16885
 16886* exec cics endbr
 16887*       dataset  ('ERCHEK')
 16888*    end-exec
 16889     MOVE 'ERCHEK' TO DFHEIV1
 16890     MOVE 0
 16891       TO DFHEIV11
 16892*    MOVE '&2                    $   #00014789' TO DFHEIV0
 16893     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16894     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16895     MOVE X'2020233030303134373839' TO DFHEIV0(25:11)
 16896     CALL 'kxdfhei1' USING DFHEIV0,
 16897           DFHEIV1,
 16898           DFHEIV11,
 16899           DFHEIV99
 16900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16901
 16902     .
 16903 2525-exit.
 16904     exit.
 16905
 16906 2530-readupd-erchek.
 16907
 16908
 16909* EXEC CICS READ
 16910*       UPDATE
 16911*       SET     (ADDRESS OF CHECK-RECORDS)
 16912*       DATASET ('ERCHEK')
 16913*       RIDFLD  (ERCHEK-KEY)
 16914*       RESP    (WS-RESPONSE)
 16915*    END-EXEC
 16916     MOVE 'ERCHEK' TO DFHEIV1
 16917*    MOVE '&"S        EU         (  N#00014799' TO DFHEIV0
 16918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16920     MOVE X'204E233030303134373939' TO DFHEIV0(25:11)
 16921     CALL 'kxdfhei1' USING DFHEIV0,
 16922           DFHEIV1,
 16923           DFHEIV20,
 16924           DFHEIV99,
 16925           ERCHEK-KEY,
 16926           DFHEIV99,
 16927           DFHEIV99,
 16928           DFHEIV99
 16929     SET ADDRESS OF CHECK-RECORDS TO
 16930         DFHEIV20
 16931     MOVE EIBRESP  TO WS-RESPONSE
 16932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16933
 16934     .
 16935 2530-exit.
 16936     exit.
 16937
 16938 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 308
* EL6311.cbl
 16939
 16940
 16941* EXEC CICS DELETE
 16942*       DATASET ('ERCHEK')
 16943*       RESP    (WS-RESPONSE)
 16944*    END-EXEC
 16945     MOVE 'ERCHEK' TO DFHEIV1
 16946*    MOVE '&(                    &  N#00014813' TO DFHEIV0
 16947     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16948     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16949     MOVE X'204E233030303134383133' TO DFHEIV0(25:11)
 16950     CALL 'kxdfhei1' USING DFHEIV0,
 16951           DFHEIV1,
 16952           DFHEIV99,
 16953           DFHEIV99,
 16954           DFHEIV99,
 16955           DFHEIV99
 16956     MOVE EIBRESP  TO WS-RESPONSE
 16957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16958
 16959     .
 16960 2540-exit.
 16961     exit.
 16962***************************************************************
 16963*                                                             *
 16964*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16965*                                                             *
 16966***************************************************************
 16967
 16968***************************************************************
 16969*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16970*     AN ALREADY BILLED RECORD.                               *
 16971***************************************************************
 16972
 16973 2700-BUILD-CORRECTION-RECORD.
 16974     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16975     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16976     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16977     MOVE '5'                    TO DC-OPTION-CODE.
 16978     PERFORM 9700-DATE-LINK.
 16979     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16980
 16981     IF PB-CHG-COUNT = ZEROS
 16982        MOVE +1                  TO WS-SEQ-SAVE
 16983     ELSE
 16984        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16985
 16986     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16987     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16988
 16989     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16990
 16991     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16992     MOVE 'A'                    TO JP-RECORD-TYPE.
 16993     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16994
 16995
 16996* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 309
* EL6311.cbl
 16997*        DATASET    (FILE-ID-ERPNDB)
 16998*        FROM       (PENDING-BUSINESS)
 16999*        RIDFLD     (PB-CONTROL-PRIMARY)
 17000*    END-EXEC.
 17001     MOVE LENGTH OF
 17002      PENDING-BUSINESS
 17003       TO DFHEIV11
 17004*    MOVE '&$ L                  ''   #00014854' TO DFHEIV0
 17005     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17006     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17007     MOVE X'2020233030303134383534' TO DFHEIV0(25:11)
 17008     CALL 'kxdfhei1' USING DFHEIV0,
 17009           FILE-ID-ERPNDB,
 17010           PENDING-BUSINESS,
 17011           DFHEIV11,
 17012           PB-CONTROL-PRIMARY,
 17013           DFHEIV99,
 17014           DFHEIV99
 17015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17016
 17017
 17018     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17019
 17020     PERFORM 8400-LOG-JOURNAL-RECORD.
 17021
 17022 2799-EXIT.
 17023      EXIT.
 17024
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 310
* EL6311.cbl
 17026
 17027******************************************************************
 17028*                                                                *
 17029*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17030*                                                                *
 17031******************************************************************
 17032
 17033 2800-REWRITE-ISSUE-CERT-KEY.
 17034     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17035
 17036     IF  BCERTNOL GREATER THAN ZEROS
 17037         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17038
 17039     IF  BSUFIXL  GREATER THAN ZEROS
 17040         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17041
 17042     IF  BEFFDTL  GREATER THAN ZEROS
 17043         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17044
 17045 2810-READ-BY-ACCOUNT.
 17046
 17047* EXEC CICS HANDLE CONDITION
 17048*         NOTFND    (2820-PROCESS-REWRITE)
 17049*    END-EXEC.
 17050*    MOVE '"$I                   ! = #00014888' TO DFHEIV0
 17051     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17053     MOVE X'3D20233030303134383838' TO DFHEIV0(25:11)
 17054     CALL 'kxdfhei1' USING DFHEIV0
 17055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17056
 17057
 17058***  read pndb using new key
 17059
 17060* EXEC CICS READ
 17061*        SET     (ADDRESS OF PENDING-BUSINESS)
 17062*        DATASET (FILE-ID-ERPNDB2)
 17063*        RIDFLD  (ERPNDB-ALT-KEY)
 17064*    END-EXEC.
 17065*    MOVE '&"S        E          (   #00014893' TO DFHEIV0
 17066     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17067     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17068     MOVE X'2020233030303134383933' TO DFHEIV0(25:11)
 17069     CALL 'kxdfhei1' USING DFHEIV0,
 17070           FILE-ID-ERPNDB2,
 17071           DFHEIV20,
 17072           DFHEIV99,
 17073           ERPNDB-ALT-KEY,
 17074           DFHEIV99,
 17075           DFHEIV99,
 17076           DFHEIV99
 17077     SET ADDRESS OF PENDING-BUSINESS TO
 17078         DFHEIV20
 17079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17080
 17081
 17082     GO TO 2890-DUPLICATE-RECORD.
 17083
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 311
* EL6311.cbl
 17084  2820-PROCESS-REWRITE.
 17085
 17086* EXEC CICS HANDLE CONDITION
 17087*         NOTFND    (2885-RECORD-MISSING)
 17088*    END-EXEC.
 17089*    MOVE '"$I                   ! > #00014902' TO DFHEIV0
 17090     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17092     MOVE X'3E20233030303134393032' TO DFHEIV0(25:11)
 17093     CALL 'kxdfhei1' USING DFHEIV0
 17094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17095
 17096
 17097     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17098
 17099***  read pndb using original key
 17100
 17101* EXEC CICS READ
 17102*        SET     (ADDRESS OF PENDING-BUSINESS)
 17103*        DATASET (FILE-ID-ERPNDB)
 17104*        RIDFLD  (ERPNDB-KEY)
 17105*        UPDATE
 17106*    END-EXEC.
 17107*    MOVE '&"S        EU         (   #00014909' TO DFHEIV0
 17108     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17109     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17110     MOVE X'2020233030303134393039' TO DFHEIV0(25:11)
 17111     CALL 'kxdfhei1' USING DFHEIV0,
 17112           FILE-ID-ERPNDB,
 17113           DFHEIV20,
 17114           DFHEIV99,
 17115           ERPNDB-KEY,
 17116           DFHEIV99,
 17117           DFHEIV99,
 17118           DFHEIV99
 17119     SET ADDRESS OF PENDING-BUSINESS TO
 17120         DFHEIV20
 17121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17122
 17123
 17124     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17125     MOVE 'D'                    TO JP-RECORD-TYPE.
 17126     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17127     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17128
 17129     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17130
 17131     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17132     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17133     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17134
 17135***  delete pndb using original key
 17136
 17137* EXEC CICS DELETE
 17138*        DATASET    (FILE-ID-ERPNDB)
 17139*    END-EXEC.
 17140*    MOVE '&(                    &   #00014928' TO DFHEIV0
 17141     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 312
* EL6311.cbl
 17142     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17143     MOVE X'2020233030303134393238' TO DFHEIV0(25:11)
 17144     CALL 'kxdfhei1' USING DFHEIV0,
 17145           FILE-ID-ERPNDB,
 17146           DFHEIV99,
 17147           DFHEIV99,
 17148           DFHEIV99,
 17149           DFHEIV99
 17150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17151
 17152
 17153     PERFORM 8400-LOG-JOURNAL-RECORD.
 17154
 17155
 17156* EXEC CICS GETMAIN
 17157*        SET      (ADDRESS OF PENDING-BUSINESS)
 17158*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17159*        INITIMG  (GETMAIN-SPACE)
 17160*    END-EXEC.
 17161*    MOVE ',"IL                  $   #00014934' TO DFHEIV0
 17162     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17163     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17164     MOVE X'2020233030303134393334' TO DFHEIV0(25:11)
 17165     CALL 'kxdfhei1' USING DFHEIV0,
 17166           DFHEIV20,
 17167           ERPNDB-RECORD-LENGTH,
 17168           GETMAIN-SPACE
 17169     SET ADDRESS OF PENDING-BUSINESS TO
 17170         DFHEIV20
 17171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17172
 17173
 17174***  pending-business now has original record
 17175     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17176
 17177
 17178* EXEC CICS HANDLE CONDITION
 17179*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17180*    END-EXEC.
 17181*    MOVE '"$I                   ! ? #00014943' TO DFHEIV0
 17182     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17184     MOVE X'3F20233030303134393433' TO DFHEIV0(25:11)
 17185     CALL 'kxdfhei1' USING DFHEIV0
 17186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17187
 17188
 17189***  read elcert using original key
 17190
 17191* EXEC CICS READ
 17192*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17193*        DATASET (FILE-ID-ELCERT)
 17194*        RIDFLD  (ELCERT-KEY)
 17195*        UPDATE
 17196*    END-EXEC.
 17197*    MOVE '&"S        EU         (   #00014948' TO DFHEIV0
 17198     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17199     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 313
* EL6311.cbl
 17200     MOVE X'2020233030303134393438' TO DFHEIV0(25:11)
 17201     CALL 'kxdfhei1' USING DFHEIV0,
 17202           FILE-ID-ELCERT,
 17203           DFHEIV20,
 17204           DFHEIV99,
 17205           ELCERT-KEY,
 17206           DFHEIV99,
 17207           DFHEIV99,
 17208           DFHEIV99
 17209     SET ADDRESS OF CERTIFICATE-MASTER TO
 17210         DFHEIV20
 17211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17212
 17213
 17214     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17215     MOVE 'B'                    TO JP-RECORD-TYPE
 17216     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17217     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17218
 17219     IF INSURED-ADDR-PRESENT
 17220        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17221
 17222     IF CERT-NOTES-ARE-NOT-PRESENT
 17223        MOVE SPACE               TO WS-CERT-NOTE-SW
 17224     ELSE
 17225        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17226
 17227     IF CERT-ADDED-BATCH      OR
 17228        CERT-AND-CLAIM-ONLINE OR
 17229        CERT-WAS-CREATED-FOR-CLAIM
 17230        NEXT SENTENCE
 17231     ELSE
 17232        GO TO 2825-DELETE-CERTIFICATE.
 17233
 17234     PERFORM 8400-LOG-JOURNAL-RECORD.
 17235
 17236*********************************************************
 17237** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17238     IF CERT-ADDED-BATCH
 17239         GO TO 2822-REWRITE-ELCERT.
 17240*********************************************************
 17241
 17242     IF NO-CLAIM-ATTACHED
 17243        NEXT SENTENCE
 17244     ELSE
 17245        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17246        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17247
 17248 2822-REWRITE-ELCERT.
 17249     MOVE 'C'                    TO JP-RECORD-TYPE
 17250     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17251
 17252     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17253
 17254
 17255* EXEC CICS REWRITE
 17256*         DATASET    (FILE-ID-ELCERT)
 17257*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 314
* EL6311.cbl
 17258*    END-EXEC.
 17259     MOVE LENGTH OF
 17260      CERTIFICATE-MASTER
 17261       TO DFHEIV11
 17262*    MOVE '&& L                  %   #00014995' TO DFHEIV0
 17263     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17264     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17265     MOVE X'2020233030303134393935' TO DFHEIV0(25:11)
 17266     CALL 'kxdfhei1' USING DFHEIV0,
 17267           FILE-ID-ELCERT,
 17268           CERTIFICATE-MASTER,
 17269           DFHEIV11,
 17270           DFHEIV99
 17271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17272
 17273
 17274     PERFORM 8400-LOG-JOURNAL-RECORD.
 17275
 17276     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17277
 17278 2825-DELETE-CERTIFICATE.
 17279     MOVE 'D'                      TO JP-RECORD-TYPE.
 17280     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17281
 17282     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17283
 17284
 17285* EXEC CICS DELETE
 17286*         DATASET    (FILE-ID-ELCERT)
 17287*    END-EXEC.
 17288*    MOVE '&(                    &   #00015010' TO DFHEIV0
 17289     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17290     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17291     MOVE X'2020233030303135303130' TO DFHEIV0(25:11)
 17292     CALL 'kxdfhei1' USING DFHEIV0,
 17293           FILE-ID-ELCERT,
 17294           DFHEIV99,
 17295           DFHEIV99,
 17296           DFHEIV99,
 17297           DFHEIV99
 17298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17299
 17300
 17301     PERFORM 8400-LOG-JOURNAL-RECORD.
 17302
 17303******************************************************************
 17304*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17305******************************************************************
 17306
 17307     IF CERT-NOTES-ARE-PRESENT
 17308        NEXT SENTENCE
 17309     ELSE
 17310        GO TO 2827-DELETE-MAILING.
 17311
 17312
 17313* EXEC CICS HANDLE CONDITION
 17314*         NOTFND  (2827-DELETE-MAILING)
 17315*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 315
* EL6311.cbl
 17316*    MOVE '"$I                   ! @ #00015025' TO DFHEIV0
 17317     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17319     MOVE X'4020233030303135303235' TO DFHEIV0(25:11)
 17320     CALL 'kxdfhei1' USING DFHEIV0
 17321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17322
 17323
 17324
 17325* EXEC CICS READ
 17326*        EQUAL
 17327*        DATASET   (FILE-ID-ERNOTE)
 17328*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17329*        RIDFLD    (ELCERT-KEY)
 17330*        UPDATE
 17331*    END-EXEC.
 17332*    MOVE '&"S        EU         (   #00015029' TO DFHEIV0
 17333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17334     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17335     MOVE X'2020233030303135303239' TO DFHEIV0(25:11)
 17336     CALL 'kxdfhei1' USING DFHEIV0,
 17337           FILE-ID-ERNOTE,
 17338           DFHEIV20,
 17339           DFHEIV99,
 17340           ELCERT-KEY,
 17341           DFHEIV99,
 17342           DFHEIV99,
 17343           DFHEIV99
 17344     SET ADDRESS OF CERTIFICATE-NOTE TO
 17345         DFHEIV20
 17346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17347
 17348
 17349     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17350     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17351     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17352
 17353     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17354
 17355
 17356* EXEC CICS DELETE
 17357*        DATASET   (FILE-ID-ERNOTE)
 17358*    END-EXEC.
 17359*    MOVE '&(                    &   #00015043' TO DFHEIV0
 17360     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17361     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17362     MOVE X'2020233030303135303433' TO DFHEIV0(25:11)
 17363     CALL 'kxdfhei1' USING DFHEIV0,
 17364           FILE-ID-ERNOTE,
 17365           DFHEIV99,
 17366           DFHEIV99,
 17367           DFHEIV99,
 17368           DFHEIV99
 17369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17370
 17371
 17372     PERFORM 8400-LOG-JOURNAL-RECORD.
 17373
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 316
* EL6311.cbl
 17374******************************************************************
 17375*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17376******************************************************************
 17377
 17378 2827-DELETE-MAILING.
 17379     IF CERT-ADDRESS-PRESENT
 17380        NEXT SENTENCE
 17381     ELSE
 17382        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17383
 17384
 17385* EXEC CICS HANDLE CONDITION
 17386*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17387*    END-EXEC.
 17388*    MOVE '"$I                   ! A #00015059' TO DFHEIV0
 17389     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17391     MOVE X'4120233030303135303539' TO DFHEIV0(25:11)
 17392     CALL 'kxdfhei1' USING DFHEIV0
 17393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17394
 17395
 17396     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17397
 17398
 17399* EXEC CICS READ
 17400*        EQUAL
 17401*        DATASET   (FILE-ID-ERMAIL)
 17402*        SET       (ADDRESS OF MAILING-DATA)
 17403*        RIDFLD    (ERMAIL-KEY)
 17404*        UPDATE
 17405*    END-EXEC.
 17406*    MOVE '&"S        EU         (   #00015065' TO DFHEIV0
 17407     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17408     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17409     MOVE X'2020233030303135303635' TO DFHEIV0(25:11)
 17410     CALL 'kxdfhei1' USING DFHEIV0,
 17411           FILE-ID-ERMAIL,
 17412           DFHEIV20,
 17413           DFHEIV99,
 17414           ERMAIL-KEY,
 17415           DFHEIV99,
 17416           DFHEIV99,
 17417           DFHEIV99
 17418     SET ADDRESS OF MAILING-DATA TO
 17419         DFHEIV20
 17420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17421
 17422
 17423     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17424     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17425     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17426
 17427     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17428
 17429
 17430* EXEC CICS DELETE
 17431*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 317
* EL6311.cbl
 17432*    END-EXEC.
 17433*    MOVE '&(                    &   #00015079' TO DFHEIV0
 17434     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17435     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17436     MOVE X'2020233030303135303739' TO DFHEIV0(25:11)
 17437     CALL 'kxdfhei1' USING DFHEIV0,
 17438           FILE-ID-ERMAIL,
 17439           DFHEIV99,
 17440           DFHEIV99,
 17441           DFHEIV99,
 17442           DFHEIV99
 17443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17444
 17445
 17446     PERFORM 8400-LOG-JOURNAL-RECORD.
 17447
 17448 2830-BUILD-NEW-ISSUE-RECORD.
 17449     MOVE SPACES                 TO ELCERT-KEY.
 17450
 17451     IF  BCERTNOL GREATER THAN ZEROS
 17452         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17453
 17454     IF  BSUFIXL  GREATER THAN ZEROS
 17455         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17456
 17457     IF BEFFDTL GREATER THAN ZEROS
 17458        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17459
 17460 2870-WRITE-PENDING-BUSINESS.
 17461     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17462     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17463     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17464     MOVE '5'                    TO DC-OPTION-CODE.
 17465     PERFORM 9700-DATE-LINK.
 17466     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17467
 17468     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17469
 17470     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17471     MOVE 'A'                    TO JP-RECORD-TYPE.
 17472     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17473
 17474
 17475* EXEC CICS WRITE
 17476*        DATASET  (FILE-ID-ERPNDB)
 17477*        FROM     (PENDING-BUSINESS)
 17478*        RIDFLD   (PB-CONTROL-PRIMARY)
 17479*    END-EXEC.
 17480     MOVE LENGTH OF
 17481      PENDING-BUSINESS
 17482       TO DFHEIV11
 17483*    MOVE '&$ L                  ''   #00015111' TO DFHEIV0
 17484     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17485     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17486     MOVE X'2020233030303135313131' TO DFHEIV0(25:11)
 17487     CALL 'kxdfhei1' USING DFHEIV0,
 17488           FILE-ID-ERPNDB,
 17489           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 318
* EL6311.cbl
 17490           DFHEIV11,
 17491           PB-CONTROL-PRIMARY,
 17492           DFHEIV99,
 17493           DFHEIV99
 17494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17495
 17496
 17497     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17498
 17499     PERFORM 8400-LOG-JOURNAL-RECORD.
 17500
 17501     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17502
 17503 2885-RECORD-MISSING.
 17504     MOVE -1                     TO BMAINTL
 17505     MOVE AL-UABON               TO BMAINTA
 17506     MOVE ER-2902                TO EMI-ERROR.
 17507     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17508     GO TO 8200-SEND-DATAONLY.
 17509
 17510 2890-DUPLICATE-RECORD.
 17511     MOVE -1                     TO BMAINTL.
 17512     MOVE AL-UABON               TO BCERTNOA.
 17513     MOVE AL-UNBON               TO BEFFDTA.
 17514     MOVE SPACE                  TO BMAINTI.
 17515
 17516     MOVE 1                      TO EMI-SUB
 17517                                    EMI-SWITCH1
 17518                                    EMI-SWITCH-AREA-1
 17519                                    EMI-SWITCH-AREA-2.
 17520
 17521     MOVE SPACES                 TO EMI-ERROR-LINES.
 17522
 17523
 17524* EXEC CICS SYNCPOINT ROLLBACK
 17525*    END-EXEC.
 17526*    MOVE '6"R                   !   #00015143' TO DFHEIV0
 17527     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17529     MOVE X'2020233030303135313433' TO DFHEIV0(25:11)
 17530     CALL 'kxdfhei1' USING DFHEIV0
 17531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17532
 17533
 17534     MOVE ER-2247                TO EMI-ERROR.
 17535     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17536     GO TO 8200-SEND-DATAONLY.
 17537
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 319
* EL6311.cbl
 17539
 17540******************************************************************
 17541*                                                                *
 17542*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17543*                                                                *
 17544******************************************************************
 17545
 17546 2900-REWRITE-CAN-CERT-KEY.
 17547     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17548
 17549     IF  CCERTNOL GREATER THAN ZEROS
 17550         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17551
 17552     IF  CSUFIXL  GREATER THAN ZEROS
 17553         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17554
 17555     IF  CEFFDTL  GREATER THAN ZEROS
 17556         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17557
 17558 2910-READ-BY-ACCOUNT.
 17559
 17560* EXEC CICS HANDLE CONDITION
 17561*         NOTFND    (2920-PROCESS-REWRITE)
 17562*    END-EXEC.
 17563*    MOVE '"$I                   ! B #00015171' TO DFHEIV0
 17564     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17566     MOVE X'4220233030303135313731' TO DFHEIV0(25:11)
 17567     CALL 'kxdfhei1' USING DFHEIV0
 17568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17569
 17570
 17571
 17572* EXEC CICS READ
 17573*        SET     (ADDRESS OF PENDING-BUSINESS)
 17574*        DATASET (FILE-ID-ERPNDB2)
 17575*        RIDFLD  (ERPNDB-ALT-KEY)
 17576*    END-EXEC.
 17577*    MOVE '&"S        E          (   #00015175' TO DFHEIV0
 17578     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17580     MOVE X'2020233030303135313735' TO DFHEIV0(25:11)
 17581     CALL 'kxdfhei1' USING DFHEIV0,
 17582           FILE-ID-ERPNDB2,
 17583           DFHEIV20,
 17584           DFHEIV99,
 17585           ERPNDB-ALT-KEY,
 17586           DFHEIV99,
 17587           DFHEIV99,
 17588           DFHEIV99
 17589     SET ADDRESS OF PENDING-BUSINESS TO
 17590         DFHEIV20
 17591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17592
 17593
 17594     GO TO 2990-DUPLICATE-RECORD.
 17595
 17596  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 320
* EL6311.cbl
 17597
 17598* EXEC CICS HANDLE CONDITION
 17599*         NOTFND    (2985-RECORD-MISSING)
 17600*    END-EXEC.
 17601*    MOVE '"$I                   ! C #00015184' TO DFHEIV0
 17602     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17604     MOVE X'4320233030303135313834' TO DFHEIV0(25:11)
 17605     CALL 'kxdfhei1' USING DFHEIV0
 17606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17607
 17608
 17609     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17610
 17611
 17612* EXEC CICS READ
 17613*        SET     (ADDRESS OF PENDING-BUSINESS)
 17614*        DATASET (FILE-ID-ERPNDB)
 17615*        RIDFLD  (ERPNDB-KEY)
 17616*        UPDATE
 17617*    END-EXEC.
 17618*    MOVE '&"S        EU         (   #00015190' TO DFHEIV0
 17619     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17620     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17621     MOVE X'2020233030303135313930' TO DFHEIV0(25:11)
 17622     CALL 'kxdfhei1' USING DFHEIV0,
 17623           FILE-ID-ERPNDB,
 17624           DFHEIV20,
 17625           DFHEIV99,
 17626           ERPNDB-KEY,
 17627           DFHEIV99,
 17628           DFHEIV99,
 17629           DFHEIV99
 17630     SET ADDRESS OF PENDING-BUSINESS TO
 17631         DFHEIV20
 17632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17633
 17634
 17635     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17636     MOVE 'D'                    TO JP-RECORD-TYPE.
 17637     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17638     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17639
 17640     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17641
 17642     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17643     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17644     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17645
 17646
 17647* EXEC CICS DELETE
 17648*        DATASET    (FILE-ID-ERPNDB)
 17649*    END-EXEC.
 17650*    MOVE '&(                    &   #00015208' TO DFHEIV0
 17651     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17652     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17653     MOVE X'2020233030303135323038' TO DFHEIV0(25:11)
 17654     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 321
* EL6311.cbl
 17655           FILE-ID-ERPNDB,
 17656           DFHEIV99,
 17657           DFHEIV99,
 17658           DFHEIV99,
 17659           DFHEIV99
 17660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17661
 17662
 17663     PERFORM 8400-LOG-JOURNAL-RECORD.
 17664
 17665
 17666* EXEC CICS GETMAIN
 17667*        SET      (ADDRESS OF PENDING-BUSINESS)
 17668*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17669*        INITIMG  (GETMAIN-SPACE)
 17670*    END-EXEC.
 17671*    MOVE ',"IL                  $   #00015214' TO DFHEIV0
 17672     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17673     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17674     MOVE X'2020233030303135323134' TO DFHEIV0(25:11)
 17675     CALL 'kxdfhei1' USING DFHEIV0,
 17676           DFHEIV20,
 17677           ERPNDB-RECORD-LENGTH,
 17678           GETMAIN-SPACE
 17679     SET ADDRESS OF PENDING-BUSINESS TO
 17680         DFHEIV20
 17681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17682
 17683
 17684     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17685
 17686 2950-PROCESS-CANCELS.
 17687
 17688
 17689* EXEC CICS HANDLE CONDITION
 17690*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17691*    END-EXEC.
 17692*    MOVE '"$I                   ! D #00015224' TO DFHEIV0
 17693     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17695     MOVE X'4420233030303135323234' TO DFHEIV0(25:11)
 17696     CALL 'kxdfhei1' USING DFHEIV0
 17697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17698
 17699
 17700
 17701* EXEC CICS READ
 17702*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17703*        DATASET (FILE-ID-ELCERT)
 17704*        RIDFLD  (ELCERT-KEY)
 17705*        UPDATE
 17706*    END-EXEC.
 17707*    MOVE '&"S        EU         (   #00015228' TO DFHEIV0
 17708     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17709     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17710     MOVE X'2020233030303135323238' TO DFHEIV0(25:11)
 17711     CALL 'kxdfhei1' USING DFHEIV0,
 17712           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 322
* EL6311.cbl
 17713           DFHEIV20,
 17714           DFHEIV99,
 17715           ELCERT-KEY,
 17716           DFHEIV99,
 17717           DFHEIV99,
 17718           DFHEIV99
 17719     SET ADDRESS OF CERTIFICATE-MASTER TO
 17720         DFHEIV20
 17721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17722
 17723
 17724     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17725
 17726     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17727     MOVE 'B'                      TO JP-RECORD-TYPE.
 17728     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17729     PERFORM 8400-LOG-JOURNAL-RECORD.
 17730
 17731     IF PB-CI-LIVES NOT NUMERIC
 17732         MOVE ZERO                    TO PB-CI-LIVES.
 17733
 17734     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17735        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17736        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17737        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17738                                         CM-LF-CANCEL-DT
 17739     ELSE
 17740        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17741        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17742        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17743        MOVE PB-CI-LIVES              TO CM-LIVES.
 17744
 17745     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17746        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17747            MOVE CM-LF-STATUS-AT-CANCEL
 17748                                     TO CM-LF-CURRENT-STATUS
 17749            MOVE SPACE
 17750                                     TO CM-LF-STATUS-AT-CANCEL
 17751        ELSE
 17752            MOVE PB-CI-LF-POLICY-STATUS
 17753                                     TO CM-LF-CURRENT-STATUS
 17754     ELSE
 17755        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17756
 17757     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17758        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17759        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17760        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17761                                         CM-AH-CANCEL-DT
 17762     ELSE
 17763        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17764        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17765        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17766        MOVE PB-CI-LIVES              TO CM-LIVES.
 17767
 17768     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17769        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17770            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 323
* EL6311.cbl
 17771                                     TO CM-AH-CURRENT-STATUS
 17772            MOVE SPACE
 17773                                     TO CM-AH-STATUS-AT-CANCEL
 17774        ELSE
 17775            MOVE PB-CI-AH-POLICY-STATUS
 17776                                     TO CM-AH-CURRENT-STATUS
 17777     ELSE
 17778        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17779
 17780 2975-REWRITE-CERT.
 17781     MOVE 'C'                      TO JP-RECORD-TYPE.
 17782     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17783
 17784
 17785* EXEC CICS REWRITE
 17786*        DATASET    (FILE-ID-ELCERT)
 17787*        FROM       (CERTIFICATE-MASTER)
 17788*    END-EXEC.
 17789     MOVE LENGTH OF
 17790      CERTIFICATE-MASTER
 17791       TO DFHEIV11
 17792*    MOVE '&& L                  %   #00015295' TO DFHEIV0
 17793     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17794     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17795     MOVE X'2020233030303135323935' TO DFHEIV0(25:11)
 17796     CALL 'kxdfhei1' USING DFHEIV0,
 17797           FILE-ID-ELCERT,
 17798           CERTIFICATE-MASTER,
 17799           DFHEIV11,
 17800           DFHEIV99
 17801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17802
 17803
 17804     PERFORM 8400-LOG-JOURNAL-RECORD.
 17805
 17806 2960-BUILD-NEW-CANCEL-RECORD.
 17807     IF  CCERTNOL GREATER THAN ZEROS
 17808         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17809
 17810     IF  CSUFIXL  GREATER THAN ZEROS
 17811         MOVE CSUFIXI             TO PB-CERT-SFX.
 17812
 17813     IF  CEFFDTL  GREATER  THAN ZEROS
 17814         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17815
 17816 2970-WRITE-PENDING-BUSINESS.
 17817     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17818     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17819     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17820     MOVE '5'                    TO DC-OPTION-CODE.
 17821     PERFORM 9700-DATE-LINK.
 17822     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17823
 17824     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17825
 17826     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17827                                    PB-CI-INSURED-SEX
 17828                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 324
* EL6311.cbl
 17829                                    PB-CI-AH-BENEFIT-CD
 17830                                    PB-CI-RATE-CLASS
 17831                                    PB-CI-RATE-DEV-LF
 17832                                    PB-CI-RATE-DEV-AH
 17833                                    PB-CI-LF-ABBR
 17834                                    PB-CI-AH-ABBR
 17835                                    PB-CI-OB-FLAG
 17836                                    PB-CI-LF-POLICY-STATUS
 17837                                    PB-CI-AH-POLICY-STATUS
 17838                                    PB-CI-INDV-GRP-CD
 17839                                    PB-CI-BENEFICIARY-NAME
 17840                                    PB-CI-NOTE-SW
 17841                                    PB-CI-SOC-SEC-NO
 17842                                    PB-CI-MEMBER-NO
 17843                                    PB-CI-INT-CODE
 17844                                    PB-CI-COMP-EXCP-SW
 17845                                    PB-CI-ENTRY-STATUS
 17846                                    PB-CI-CREDIT-INTERFACE-SW-1
 17847                                    PB-CI-CREDIT-INTERFACE-SW-2
 17848                                    PB-CI-ENTRY-BATCH.
 17849
 17850     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17851                                    PB-CI-AH-SETTLEMENT-DT
 17852                                    PB-CI-DEATH-DT
 17853                                    PB-CI-LF-PRIOR-CANCEL-DT
 17854                                    PB-CI-AH-PRIOR-CANCEL-DT
 17855                                    PB-CI-LOAN-1ST-PMT-DT
 17856                                    PB-CI-ENTRY-DT
 17857                                    PB-CI-LF-EXPIRE-DT
 17858                                    PB-CI-AH-EXPIRE-DT.
 17859
 17860     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17861                                    PB-CI-LF-TERM
 17862                                    PB-CI-LF-BENEFIT-AMT
 17863                                    PB-CI-LF-ALT-BENEFIT-AMT
 17864                                    PB-CI-LF-PREMIUM-AMT
 17865                                    PB-CI-LF-ALT-PREMIUM-AMT
 17866                                    PB-CI-AH-TERM
 17867                                    PB-CI-AH-BENEFIT-AMT
 17868                                    PB-CI-AH-PREMIUM-AMT
 17869                                    PB-CI-RATE-DEV-PCT-LF
 17870                                    PB-CI-RATE-DEV-PCT-AH
 17871                                    PB-CI-LIFE-COMMISSION
 17872                                    PB-CI-AH-COMMISSION
 17873                                    PB-CI-PAY-FREQUENCY
 17874                                    PB-CI-LOAN-APR
 17875                                    PB-CI-LOAN-TERM
 17876                                    PB-CI-CURR-SEQ
 17877                                    PB-CI-AH-CANCEL-AMT
 17878                                    PB-CI-LF-CANCEL-AMT
 17879                                    PB-CI-EXTENTION-DAYS
 17880                                    PB-CI-TERM-IN-DAYS
 17881                                    PB-CI-LOAN-OFFICER
 17882                                    PB-CI-LIVES
 17883                                    PB-CI-LF-CRIT-PER
 17884                                    PB-CI-AH-CRIT-PER
 17885                                    PB-C-LF-REM-TERM
 17886                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 325
* EL6311.cbl
 17887
 17888     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17889     MOVE 'A'                    TO JP-RECORD-TYPE.
 17890     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17891
 17892
 17893* EXEC CICS HANDLE CONDITION
 17894*        DUPREC   (2990-DUPLICATE-RECORD)
 17895*    END-EXEC.
 17896*    MOVE '"$%                   ! E #00015388' TO DFHEIV0
 17897     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17899     MOVE X'4520233030303135333838' TO DFHEIV0(25:11)
 17900     CALL 'kxdfhei1' USING DFHEIV0
 17901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17902
 17903
 17904
 17905* EXEC CICS WRITE
 17906*        DATASET  (FILE-ID-ERPNDB)
 17907*        FROM     (PENDING-BUSINESS)
 17908*        RIDFLD   (PB-CONTROL-PRIMARY)
 17909*    END-EXEC.
 17910     MOVE LENGTH OF
 17911      PENDING-BUSINESS
 17912       TO DFHEIV11
 17913*    MOVE '&$ L                  ''   #00015392' TO DFHEIV0
 17914     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17915     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17916     MOVE X'2020233030303135333932' TO DFHEIV0(25:11)
 17917     CALL 'kxdfhei1' USING DFHEIV0,
 17918           FILE-ID-ERPNDB,
 17919           PENDING-BUSINESS,
 17920           DFHEIV11,
 17921           PB-CONTROL-PRIMARY,
 17922           DFHEIV99,
 17923           DFHEIV99
 17924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17925
 17926
 17927     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17928
 17929     PERFORM 8400-LOG-JOURNAL-RECORD.
 17930
 17931     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17932
 17933 2985-RECORD-MISSING.
 17934     MOVE -1                     TO CMAINTL
 17935     MOVE AL-UABON               TO CMAINTA.
 17936
 17937     MOVE ER-2902                TO EMI-ERROR.
 17938     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17939     GO TO 8200-SEND-DATAONLY.
 17940
 17941 2990-DUPLICATE-RECORD.
 17942     MOVE SPACE                  TO CMAINTI.
 17943     MOVE -1                     TO CMAINTL.
 17944     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 326
* EL6311.cbl
 17945     MOVE AL-UNBON               TO CEFFDTA.
 17946
 17947     MOVE 1                      TO EMI-SUB
 17948                                    EMI-SWITCH1
 17949                                    EMI-SWITCH-AREA-1
 17950                                    EMI-SWITCH-AREA-2.
 17951     MOVE SPACES                 TO EMI-ERROR-LINES.
 17952
 17953
 17954* EXEC CICS SYNCPOINT ROLLBACK
 17955*    END-EXEC.
 17956*    MOVE '6"R                   !   #00015424' TO DFHEIV0
 17957     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17959     MOVE X'2020233030303135343234' TO DFHEIV0(25:11)
 17960     CALL 'kxdfhei1' USING DFHEIV0
 17961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17962
 17963
 17964     MOVE ER-2247                TO EMI-ERROR.
 17965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17966     GO TO 8200-SEND-DATAONLY.
 17967
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 327
* EL6311.cbl
 17969
 17970***************************************************************
 17971*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17972*     PREMIUM FOR A SINGLE BATCH.                             *
 17973*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17974***************************************************************
 17975
 17976 3000-BATCH-MAINLINE.
 17977     IF PI-PREV-KEY NOT = SPACES
 17978         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17979     ELSE
 17980         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17981
 17982     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17983
 17984 3010-READNEXT.
 17985
 17986* EXEC CICS READ
 17987*         DATASET    (FILE-ID-ERPNDB)
 17988*         SET        (ADDRESS OF PENDING-BUSINESS)
 17989*         RIDFLD     (ERPNDB-KEY)
 17990*         GTEQ
 17991*    END-EXEC.
 17992*    MOVE '&"S        G          (   #00015448' TO DFHEIV0
 17993     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17995     MOVE X'2020233030303135343438' TO DFHEIV0(25:11)
 17996     CALL 'kxdfhei1' USING DFHEIV0,
 17997           FILE-ID-ERPNDB,
 17998           DFHEIV20,
 17999           DFHEIV99,
 18000           ERPNDB-KEY,
 18001           DFHEIV99,
 18002           DFHEIV99,
 18003           DFHEIV99
 18004     SET ADDRESS OF PENDING-BUSINESS TO
 18005         DFHEIV20
 18006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18007
 18008
 18009     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18010        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18011          GO TO 3030-END-BATCH.
 18012
 18013     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18014
 18015     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18016        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18017          GO TO 3020-BUMP-SEQ.
 18018
 18019     IF PB-ISSUE
 18020        ADD +1                   TO WS-ISS-TOTAL-CNT
 18021        IF PB-FATAL-ERRORS
 18022           ADD +1                      TO WS-ISS-FATAL-CNT
 18023           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18024           GO TO 3020-BUMP-SEQ
 18025        ELSE
 18026           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 328
* EL6311.cbl
 18027              ADD +1                      TO WS-ISS-FORCE-CNT
 18028              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18029              GO TO 3020-BUMP-SEQ
 18030           ELSE
 18031              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18032                 ADD +1                      TO WS-ISS-HOLD-CNT
 18033                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18034                 GO TO 3020-BUMP-SEQ
 18035              ELSE
 18036                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18037                     THRU  3299-EXIT
 18038                 GO TO 3020-BUMP-SEQ.
 18039
 18040     IF PB-CANCELLATION
 18041        ADD +1                   TO WS-CAN-TOTAL-CNT
 18042        IF PB-FATAL-ERRORS
 18043           ADD +1                 TO WS-CAN-FATAL-CNT
 18044           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18045           GO TO 3020-BUMP-SEQ
 18046        ELSE
 18047           IF PB-UNFORCED-ERRORS
 18048              ADD +1                 TO WS-CAN-FORCE-CNT
 18049              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18050              GO TO 3020-BUMP-SEQ
 18051           ELSE
 18052              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18053                 ADD +1                 TO WS-CAN-HOLD-CNT
 18054                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18055                 GO TO 3020-BUMP-SEQ
 18056              ELSE
 18057                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18058                     THRU  3499-EXIT
 18059                 GO TO 3020-BUMP-SEQ.
 18060
 18061     IF PB-BATCH-TRAILER
 18062         GO TO 3030-END-BATCH.
 18063
 18064 3020-BUMP-SEQ.
 18065     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18066     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18067     GO TO 3010-READNEXT.
 18068
 18069 3030-END-BATCH.
 18070     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18071     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18072     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18073     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18074
 18075     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18076                                          - WS-ISS-FORCE-CNT
 18077                                          - WS-ISS-HOLD-CNT).
 18078
 18079     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18080     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18081
 18082     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18083     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18084     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 329
* EL6311.cbl
 18085     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18086     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18087                                          - WS-CAN-FORCE-CNT
 18088                                          - WS-CAN-HOLD-CNT).
 18089     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18090     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18091
 18092     COMPUTE WS-NET-TOTAL-CNT
 18093         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18094     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18095     COMPUTE WS-NET-FATAL-CNT
 18096         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18097     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18098     COMPUTE WS-NET-FORCE-CNT
 18099         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18100     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18101     COMPUTE WS-NET-HOLD-CNT
 18102         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18103     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18104
 18105     COMPUTE WS-NET-AVAIL-CNT
 18106          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18107                              - WS-ISS-FORCE-CNT
 18108                              - WS-ISS-HOLD-CNT)
 18109          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18110                              - WS-CAN-FORCE-CNT
 18111                              - WS-CAN-HOLD-CNT).
 18112     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18113
 18114     COMPUTE WS-NET-GOOD-PREM
 18115         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18116     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18117     COMPUTE WS-NET-BAD-PREM
 18118         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18119     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18120
 18121     MOVE 0000                   TO EMI-ERROR.
 18122     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18123     MOVE -1                     TO DPFENTRL.
 18124     GO TO 8200-SEND-DATAONLY.
 18125
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 330
* EL6311.cbl
 18127
 18128******************************************************************
 18129*                                                                *
 18130*           A D D    B A D   I S S U E   P R E M I U M           *
 18131*                                                                *
 18132******************************************************************
 18133
 18134 3100-ADD-BAD-ISSUE-PREM.
 18135     IF PB-OVERRIDE-LIFE
 18136       OR PB-OVERRIDE-BOTH
 18137           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18138           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18139       ELSE
 18140           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18141           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18142
 18143     IF PB-OVERRIDE-AH
 18144       OR PB-OVERRIDE-BOTH
 18145           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18146       ELSE
 18147           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18148
 18149 3199-EXIT.
 18150     EXIT.
 18151
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 331
* EL6311.cbl
 18153
 18154******************************************************************
 18155*                                                                *
 18156*       A D D   G O O D   I S S U E   P R E M I U M              *
 18157*                                                                *
 18158******************************************************************
 18159
 18160 3200-ADD-GOOD-ISSUE-PREM.
 18161     IF PB-OVERRIDE-LIFE
 18162       OR PB-OVERRIDE-BOTH
 18163           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18164           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18165       ELSE
 18166           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18167           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18168
 18169     IF PB-OVERRIDE-AH
 18170       OR PB-OVERRIDE-BOTH
 18171           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18172       ELSE
 18173           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18174
 18175 3299-EXIT.
 18176     EXIT.
 18177
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 332
* EL6311.cbl
 18179
 18180
 18181******************************************************************
 18182*                                                                *
 18183*        A D D   B A D   C A N C E L   P R E M I U M             *
 18184*                                                                *
 18185******************************************************************
 18186
 18187 3300-ADD-BAD-CANCEL-PREM.
 18188     IF PB-OVERRIDE-LIFE
 18189       OR PB-OVERRIDE-BOTH
 18190           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18191       ELSE
 18192           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18193
 18194     IF PB-OVERRIDE-AH
 18195       OR PB-OVERRIDE-BOTH
 18196           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18197       ELSE
 18198           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18199
 18200 3399-EXIT.
 18201     EXIT.
 18202
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 333
* EL6311.cbl
 18204
 18205******************************************************************
 18206*                                                                *
 18207*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18208*                                                                *
 18209******************************************************************
 18210
 18211 3400-ADD-GOOD-CANCEL-PREM.
 18212     IF PB-OVERRIDE-LIFE
 18213       OR PB-OVERRIDE-BOTH
 18214           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18215       ELSE
 18216           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18217
 18218     IF PB-OVERRIDE-AH
 18219       OR PB-OVERRIDE-BOTH
 18220           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18221       ELSE
 18222           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18223
 18224 3499-EXIT.
 18225     EXIT.
 18226
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 334
* EL6311.cbl
 18228
 18229******************************************************************
 18230*                                                                *
 18231*           E D I T   B A T C H   D A T A                        *
 18232*                                                                *
 18233******************************************************************
 18234
 18235 3500-EDIT-BATCH-DATA.
 18236     IF PI-PREV-KEY NOT = SPACES
 18237        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18238     ELSE
 18239        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18240
 18241     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18242     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18243
 18244
 18245* EXEC CICS HANDLE CONDITION
 18246*         NOTFND      (3590-NOT-FOUND)
 18247*    END-EXEC.
 18248*    MOVE '"$I                   ! F #00015690' TO DFHEIV0
 18249     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18251     MOVE X'4620233030303135363930' TO DFHEIV0(25:11)
 18252     CALL 'kxdfhei1' USING DFHEIV0
 18253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18254
 18255
 18256     IF DRISSL   GREATER THAN ZEROS OR
 18257        DRISSL   GREATER THAN ZEROS OR
 18258        DRLFPRML GREATER THAN ZEROS OR
 18259        DRAHPRML GREATER THAN ZEROS OR
 18260        DRCANCL  GREATER THAN ZEROS OR
 18261        DRLFRFDL GREATER THAN ZEROS OR
 18262        DRAHRFDL GREATER THAN ZEROS
 18263              NEXT SENTENCE
 18264          ELSE
 18265              MOVE ER-3224    TO EMI-ERROR
 18266              MOVE -1         TO DPFENTRL
 18267              MOVE AL-UNBON   TO DPFENTRA
 18268              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18269              GO TO 8200-SEND-DATAONLY.
 18270
 18271     IF NOT MODIFY-CAP
 18272         MOVE 'UPDATE'       TO SM-READ
 18273         PERFORM 9995-SECURITY-VIOLATION
 18274         MOVE ER-0070        TO EMI-ERROR
 18275         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18276         GO TO 8100-SEND-INITIAL-MAP.
 18277
 18278        IF DRISSL GREATER THAN ZEROS
 18279           MOVE AL-UNNON         TO DRISSA
 18280           MOVE DRISSI           TO DEEDIT-FIELD
 18281           PERFORM 8600-DEEDIT
 18282           IF DEEDIT-FIELD-V0  NUMERIC
 18283              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18284           ELSE
 18285              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 335
* EL6311.cbl
 18286              MOVE -1         TO DRISSL
 18287              MOVE AL-UNBON   TO DRISSA
 18288              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18289
 18290        IF DRLFPRML GREATER THAN ZEROS
 18291           MOVE AL-UNNON         TO DRLFPRMA
 18292
 18293* EXEC CICS BIF DEEDIT
 18294*              FIELD  (DRLFPRMI)
 18295*              LENGTH (11)
 18296*          END-EXEC
 18297     MOVE 11
 18298       TO DFHEIV11
 18299*    MOVE '@"L                   #   #00015730' TO DFHEIV0
 18300     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18301     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18302     MOVE X'2020233030303135373330' TO DFHEIV0(25:11)
 18303     CALL 'kxdfhei1' USING DFHEIV0,
 18304           DRLFPRMI,
 18305           DFHEIV11
 18306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18307           IF DRLFPRMI NUMERIC
 18308              MOVE DRLFPRMI   TO WS-DRLFPRM
 18309*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18310*          PERFORM 8600-DEEDIT
 18311*          IF DEEDIT-FIELD-V2  NUMERIC
 18312*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18313           ELSE
 18314              MOVE ER-2223    TO EMI-ERROR
 18315              MOVE -1         TO DRLFPRML
 18316              MOVE AL-UNBON   TO DRLFPRMA
 18317              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18318
 18319        IF DRAHPRML GREATER THAN ZEROS
 18320           MOVE AL-UNNON         TO DRAHPRMA
 18321
 18322* EXEC CICS BIF DEEDIT
 18323*              FIELD  (DRAHPRMI)
 18324*              LENGTH (11)
 18325*          END-EXEC
 18326     MOVE 11
 18327       TO DFHEIV11
 18328*    MOVE '@"L                   #   #00015748' TO DFHEIV0
 18329     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18330     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18331     MOVE X'2020233030303135373438' TO DFHEIV0(25:11)
 18332     CALL 'kxdfhei1' USING DFHEIV0,
 18333           DRAHPRMI,
 18334           DFHEIV11
 18335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18336           IF DRAHPRMI NUMERIC
 18337              MOVE DRAHPRMI   TO WS-DRAHPRM
 18338*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18339*          PERFORM 8600-DEEDIT
 18340*          IF DEEDIT-FIELD-V2  NUMERIC
 18341*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18342           ELSE
 18343              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 336
* EL6311.cbl
 18344              MOVE -1         TO DRAHPRML
 18345              MOVE AL-UNBON   TO DRAHPRMA
 18346              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18347
 18348        IF DRCANCL GREATER THAN ZEROS
 18349           MOVE AL-UNNON         TO DRCANCA
 18350           MOVE DRCANCI          TO DEEDIT-FIELD
 18351           PERFORM 8600-DEEDIT
 18352           IF DEEDIT-FIELD-V0  NUMERIC
 18353              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18354           ELSE
 18355              MOVE ER-2223    TO EMI-ERROR
 18356              MOVE -1         TO DRCANCL
 18357              MOVE AL-UNBON   TO DRCANCL
 18358              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18359
 18360        IF DRLFRFDL GREATER THAN ZEROS
 18361           MOVE AL-UNNON         TO DRLFRFDA
 18362
 18363* EXEC CICS BIF DEEDIT
 18364*              FIELD  (DRLFRFDI)
 18365*              LENGTH (11)
 18366*          END-EXEC
 18367     MOVE 11
 18368       TO DFHEIV11
 18369*    MOVE '@"L                   #   #00015778' TO DFHEIV0
 18370     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18371     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18372     MOVE X'2020233030303135373738' TO DFHEIV0(25:11)
 18373     CALL 'kxdfhei1' USING DFHEIV0,
 18374           DRLFRFDI,
 18375           DFHEIV11
 18376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18377           IF DRLFRFDI NUMERIC
 18378              MOVE DRLFRFDI   TO WS-DRLFRFD
 18379*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18380*          PERFORM 8600-DEEDIT
 18381*          IF DEEDIT-FIELD-V2  NUMERIC
 18382*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18383           ELSE
 18384              MOVE ER-2223    TO EMI-ERROR
 18385              MOVE -1         TO DRLFRFDL
 18386              MOVE AL-UNBON   TO DRLFRFDA
 18387              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18388
 18389        IF DRAHRFDL GREATER THAN ZEROS
 18390           MOVE AL-UNNON         TO DRAHRFDA
 18391
 18392* EXEC CICS BIF DEEDIT
 18393*              FIELD  (DRAHRFDI)
 18394*              LENGTH (11)
 18395*          END-EXEC
 18396     MOVE 11
 18397       TO DFHEIV11
 18398*    MOVE '@"L                   #   #00015796' TO DFHEIV0
 18399     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18400     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18401     MOVE X'2020233030303135373936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 337
* EL6311.cbl
 18402     CALL 'kxdfhei1' USING DFHEIV0,
 18403           DRAHRFDI,
 18404           DFHEIV11
 18405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18406           IF DRAHRFDI NUMERIC
 18407              MOVE DRAHRFDI   TO WS-DRAHRFD
 18408*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18409*          PERFORM 8600-DEEDIT
 18410*          IF DEEDIT-FIELD-V2  NUMERIC
 18411*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18412           ELSE
 18413              MOVE ER-2223    TO EMI-ERROR
 18414              MOVE -1         TO DRAHRFDL
 18415              MOVE AL-UNBON   TO DRAHRFDA
 18416              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18417
 18418     IF EMI-ERROR = ZEROS
 18419        GO 3600-UPDATE-BATCH-HEADER.
 18420
 18421     GO TO 8200-SEND-DATAONLY.
 18422
 18423 3590-NOT-FOUND.
 18424     MOVE ER-2192                TO EMI-ERROR.
 18425     MOVE -1                     TO DPFENTRL.
 18426     MOVE AL-UNBON               TO DPFENTRA.
 18427     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18428     GO TO 8200-SEND-DATAONLY.
 18429
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 338
* EL6311.cbl
 18431
 18432******************************************************************
 18433*                                                                *
 18434*           U P D A T E   B A T C H   H E A D E R                *
 18435*                                                                *
 18436******************************************************************
 18437
 18438 3600-UPDATE-BATCH-HEADER.
 18439
 18440* EXEC CICS HANDLE CONDITION
 18441*         NOTFND      (3690-NOT-FOUND)
 18442*    END-EXEC.
 18443*    MOVE '"$I                   ! G #00015833' TO DFHEIV0
 18444     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18446     MOVE X'4720233030303135383333' TO DFHEIV0(25:11)
 18447     CALL 'kxdfhei1' USING DFHEIV0
 18448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18449
 18450
 18451
 18452* EXEC CICS READ
 18453*        DATASET (FILE-ID-ERPNDB)
 18454*        RIDFLD  (ERPNDB-KEY)
 18455*        SET     (ADDRESS OF PENDING-BUSINESS)
 18456*        UPDATE
 18457*    END-EXEC.
 18458*    MOVE '&"S        EU         (   #00015837' TO DFHEIV0
 18459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18460     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18461     MOVE X'2020233030303135383337' TO DFHEIV0(25:11)
 18462     CALL 'kxdfhei1' USING DFHEIV0,
 18463           FILE-ID-ERPNDB,
 18464           DFHEIV20,
 18465           DFHEIV99,
 18466           ERPNDB-KEY,
 18467           DFHEIV99,
 18468           DFHEIV99,
 18469           DFHEIV99
 18470     SET ADDRESS OF PENDING-BUSINESS TO
 18471         DFHEIV20
 18472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18473
 18474
 18475     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18476     MOVE 'B'                    TO JP-RECORD-TYPE.
 18477     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18478
 18479     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18480
 18481     PERFORM 8400-LOG-JOURNAL-RECORD.
 18482
 18483     IF DRISSL GREATER THAN ZEROS
 18484        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18485
 18486     IF DRCANCL GREATER THAN ZEROS
 18487        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18488
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 339
* EL6311.cbl
 18489
 18490     IF DRLFPRML GREATER THAN ZEROS
 18491        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18492
 18493     IF DRAHPRML GREATER THAN ZEROS
 18494        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18495
 18496     IF DRLFRFDL GREATER THAN ZEROS
 18497        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18498
 18499     IF DRAHRFDL GREATER THAN ZEROS
 18500        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18501
 18502 3670-REWRITE-BATCH-HEADER.
 18503     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18504        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18505        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18506        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18507        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18508        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18509        MOVE SPACE               TO PB-OUT-BAL-CD
 18510     ELSE
 18511        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18512
 18513     MOVE 'C'                    TO JP-RECORD-TYPE.
 18514     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18515
 18516
 18517* EXEC CICS REWRITE
 18518*         DATASET      (FILE-ID-ERPNDB)
 18519*         FROM         (PENDING-BUSINESS)
 18520*    END-EXEC.
 18521     MOVE LENGTH OF
 18522      PENDING-BUSINESS
 18523       TO DFHEIV11
 18524*    MOVE '&& L                  %   #00015885' TO DFHEIV0
 18525     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18526     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18527     MOVE X'2020233030303135383835' TO DFHEIV0(25:11)
 18528     CALL 'kxdfhei1' USING DFHEIV0,
 18529           FILE-ID-ERPNDB,
 18530           PENDING-BUSINESS,
 18531           DFHEIV11,
 18532           DFHEIV99
 18533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18534
 18535
 18536     PERFORM 8400-LOG-JOURNAL-RECORD.
 18537
 18538     GO TO 7200-DISPLAY-BATCHES.
 18539
 18540 3690-NOT-FOUND.
 18541     MOVE ER-2192                TO EMI-ERROR.
 18542     MOVE -1                     TO DPFENTRL.
 18543     MOVE AL-UNBON               TO DPFENTRA.
 18544     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18545     GO TO 8200-SEND-DATAONLY.
 18546
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 340
* EL6311.cbl
 18548
 18549******************************************************************
 18550*                                                                *
 18551*           R E - D I S P L A Y   R E C O R D                    *
 18552*                                                                *
 18553******************************************************************
 18554
 18555 3900-RE-DISPLAY-RECORD.
 18556
 18557* EXEC CICS HANDLE CONDITION
 18558*         NOTFND   (3990-NOT-FOUND)
 18559*    END-EXEC.
 18560*    MOVE '"$I                   ! H #00015910' TO DFHEIV0
 18561     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18563     MOVE X'4820233030303135393130' TO DFHEIV0(25:11)
 18564     CALL 'kxdfhei1' USING DFHEIV0
 18565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18566
 18567
 18568     IF PI-DISPLAY-ORIGINAL-BATCH
 18569         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18570     ELSE
 18571         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18572
 18573
 18574* EXEC CICS READ
 18575*         DATASET   (FILE-ID)
 18576*         RIDFLD    (PI-PREV-KEY)
 18577*         SET       (ADDRESS OF PENDING-BUSINESS)
 18578*    END-EXEC.
 18579*    MOVE '&"S        E          (   #00015919' TO DFHEIV0
 18580     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18582     MOVE X'2020233030303135393139' TO DFHEIV0(25:11)
 18583     CALL 'kxdfhei1' USING DFHEIV0,
 18584           FILE-ID,
 18585           DFHEIV20,
 18586           DFHEIV99,
 18587           PI-PREV-KEY,
 18588           DFHEIV99,
 18589           DFHEIV99,
 18590           DFHEIV99
 18591     SET ADDRESS OF PENDING-BUSINESS TO
 18592         DFHEIV20
 18593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18594
 18595
 18596     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18597
 18598     IF PB-ISSUE
 18599         GO TO 7000-DISPLAY-ISSUES.
 18600
 18601     IF PB-CANCELLATION
 18602         GO TO 7100-DISPLAY-CANCELS.
 18603
 18604     IF PB-BATCH-TRAILER
 18605         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 341
* EL6311.cbl
 18606
 18607 3990-NOT-FOUND.
 18608     MOVE LOW-VALUES             TO EL631BI.
 18609
 18610     IF PI-MAP-NAME = EL631B
 18611         MOVE -1                  TO BMAINTL
 18612     ELSE
 18613         MOVE -1                  TO CMAINTL.
 18614
 18615     GO TO 8100-SEND-INITIAL-MAP.
 18616
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 342
* EL6311.cbl
 18618
 18619***************************************************************
 18620*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18621*                                                             *
 18622*      1. START BROWSE WITH                                   *
 18623*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18624*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18625*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18626*                                                             *
 18627*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18628*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18629*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18630*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18631*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18632*               AND IS IT TO BE DISPLAYED.                    *
 18633*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18634*               DISPLAYED.                                    *
 18635*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18636*               DISPLAYED.                                    *
 18637*                                                             *
 18638*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18639*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18640***************************************************************
 18641
 18642 4000-BROWSE-DETAIL-FORWARD.
 18643     IF FIRST-TIME
 18644        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18645     ELSE
 18646        IF SHOW-RECORD
 18647           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18648           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18649           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18650           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18651           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18652        ELSE
 18653           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18654
 18655
 18656* EXEC CICS HANDLE CONDITION
 18657*         NOTFND   (4050-END-RECORDS)
 18658*         ENDFILE  (4050-END-RECORDS)
 18659*    END-EXEC.
 18660*    MOVE '"$I''                  ! I #00015984' TO DFHEIV0
 18661     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18663     MOVE X'4920233030303135393834' TO DFHEIV0(25:11)
 18664     CALL 'kxdfhei1' USING DFHEIV0
 18665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18666
 18667
 18668
 18669* EXEC CICS STARTBR
 18670*         DATASET   (FILE-ID-ERPNDB2)
 18671*         RIDFLD    (ERPNDB-ALT-KEY)
 18672*    END-EXEC.
 18673     MOVE 0
 18674       TO DFHEIV11
 18675*    MOVE '&,         G          &   #00015989' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 343
* EL6311.cbl
 18676     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18677     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18678     MOVE X'2020233030303135393839' TO DFHEIV0(25:11)
 18679     CALL 'kxdfhei1' USING DFHEIV0,
 18680           FILE-ID-ERPNDB2,
 18681           ERPNDB-ALT-KEY,
 18682           DFHEIV99,
 18683           DFHEIV11,
 18684           DFHEIV99
 18685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18686
 18687
 18688     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18689
 18690     IF FIRST-TIME OR SHOW-RECORD
 18691        MOVE SPACE               TO WS-FIRST-TIME-SW
 18692        GO TO 4005-READ-NEXT-RECORD.
 18693
 18694
 18695* EXEC CICS READNEXT
 18696*         DATASET    (FILE-ID-ERPNDB2)
 18697*         SET        (ADDRESS OF PENDING-BUSINESS)
 18698*         RIDFLD     (ERPNDB-ALT-KEY)
 18699*    END-EXEC.
 18700     MOVE 0
 18701       TO DFHEIV11
 18702*    MOVE '&.S                   )   #00016000' TO DFHEIV0
 18703     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18704     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18705     MOVE X'2020233030303136303030' TO DFHEIV0(25:11)
 18706     CALL 'kxdfhei1' USING DFHEIV0,
 18707           FILE-ID-ERPNDB2,
 18708           DFHEIV20,
 18709           DFHEIV99,
 18710           ERPNDB-ALT-KEY,
 18711           DFHEIV99,
 18712           DFHEIV11,
 18713           DFHEIV99,
 18714           DFHEIV99
 18715     SET ADDRESS OF PENDING-BUSINESS TO
 18716         DFHEIV20
 18717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18718
 18719
 18720 4005-READ-NEXT-RECORD.
 18721
 18722* EXEC CICS READNEXT
 18723*         DATASET    (FILE-ID-ERPNDB2)
 18724*         SET        (ADDRESS OF PENDING-BUSINESS)
 18725*         RIDFLD     (ERPNDB-ALT-KEY)
 18726*    END-EXEC.
 18727     MOVE 0
 18728       TO DFHEIV11
 18729*    MOVE '&.S                   )   #00016007' TO DFHEIV0
 18730     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18731     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18732     MOVE X'2020233030303136303037' TO DFHEIV0(25:11)
 18733     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 344
* EL6311.cbl
 18734           FILE-ID-ERPNDB2,
 18735           DFHEIV20,
 18736           DFHEIV99,
 18737           ERPNDB-ALT-KEY,
 18738           DFHEIV99,
 18739           DFHEIV11,
 18740           DFHEIV99,
 18741           DFHEIV99
 18742     SET ADDRESS OF PENDING-BUSINESS TO
 18743         DFHEIV20
 18744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18745
 18746
 18747     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18748
 18749     IF WS-BATCH-PREFIX = '#CL'
 18750        GO TO 4005-READ-NEXT-RECORD.
 18751
 18752     IF SHOW-RECORD
 18753        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18754           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18755           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18756           PB-STATE         NOT = PI-PB-STATE          OR
 18757           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18758           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18759           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18760           GO TO 4050-END-RECORDS
 18761        ELSE
 18762           GO TO 4010-CHECK-REC-TYPE.
 18763
 18764     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18765        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18766        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18767        PB-STATE            NOT = PI-PB-STATE          OR
 18768        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18769        GO TO 4050-END-RECORDS.
 18770
 18771     IF PB-BATCH-TRAILER
 18772        GO TO 4005-READ-NEXT-RECORD.
 18773
 18774     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18775        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18776           GO TO 4005-READ-NEXT-RECORD
 18777        ELSE
 18778           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18779              GO TO 4010-CHECK-REC-TYPE
 18780           ELSE
 18781              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18782                 GO TO 4010-CHECK-REC-TYPE
 18783              ELSE
 18784                 GO TO 4005-READ-NEXT-RECORD.
 18785
 18786     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18787        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18788           GO TO 4005-READ-NEXT-RECORD.
 18789
 18790 4010-CHECK-REC-TYPE.
 18791     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 345
* EL6311.cbl
 18792         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18793             NEXT SENTENCE
 18794         ELSE
 18795             GO TO 4005-READ-NEXT-RECORD.
 18796
 18797     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18798         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18799             NEXT SENTENCE
 18800        ELSE
 18801             GO TO 4005-READ-NEXT-RECORD.
 18802
 18803     IF NOT DISPLAY-CHANGE-RECORDS AND
 18804            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18805        GO TO 4005-READ-NEXT-RECORD.
 18806
 18807     IF DISPLAY-HOLD-RECORDS AND
 18808        NOT PB-RECORD-ON-HOLD
 18809          GO TO 4005-READ-NEXT-RECORD.
 18810
 18811     IF PB-ISSUE
 18812        IF DISPLAY-CHK-REQ-RECORDS
 18813            GO TO 4005-READ-NEXT-RECORD.
 18814
 18815     IF PB-ISSUE
 18816        IF ISSUE-WITH-WARNING
 18817           IF PB-WARNING-ERRORS
 18818              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18819                  GO TO 4005-READ-NEXT-RECORD
 18820              ELSE
 18821                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18822                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18823                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18824                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18825                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18826                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18827                 GO TO 7000-DISPLAY-ISSUES
 18828           ELSE
 18829              GO TO 4005-READ-NEXT-RECORD.
 18830
 18831     IF PB-ISSUE
 18832        IF (ISSUES-IN-ERROR AND
 18833            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18834            ALL-ISSUES
 18835            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18836            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18837            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18838            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18839            MOVE PB-SV-STATE            TO PI-SV-STATE
 18840            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18841            GO TO 7000-DISPLAY-ISSUES
 18842        ELSE
 18843            GO TO 4005-READ-NEXT-RECORD.
 18844
 18845     IF PB-CANCELLATION
 18846        IF DISPLAY-CHK-REQ-RECORDS
 18847           IF PB-C-REFUND-REQUESTED
 18848              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18849              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 346
* EL6311.cbl
 18850              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18851              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18852              MOVE PB-SV-STATE            TO PI-SV-STATE
 18853              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18854              GO TO 7100-DISPLAY-CANCELS
 18855           ELSE
 18856               GO TO 4005-READ-NEXT-RECORD.
 18857
 18858     IF PB-CANCELLATION
 18859        IF CANCEL-WITH-WARNING
 18860           IF PB-WARNING-ERRORS
 18861              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18862                  GO TO 4005-READ-NEXT-RECORD
 18863              ELSE
 18864                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18865                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18866                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18867                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18868                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18869                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18870                 GO TO 7100-DISPLAY-CANCELS
 18871           ELSE
 18872              GO TO 4005-READ-NEXT-RECORD.
 18873
 18874     IF PB-CANCELLATION
 18875        IF (CANCEL-IN-ERROR  AND
 18876            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18877            ALL-CANCELS
 18878            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18879            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18880            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18881            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18882            MOVE PB-SV-STATE            TO PI-SV-STATE
 18883            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18884            GO TO 7100-DISPLAY-CANCELS.
 18885
 18886     GO TO 4005-READ-NEXT-RECORD.
 18887
 18888 4050-END-RECORDS.
 18889******************************************************************
 18890*                                                                *
 18891*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18892*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18893*         PROGRAM.                                               *
 18894*                                                                *
 18895******************************************************************
 18896
 18897     IF BROWSE-STARTED
 18898        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18899
 18900* EXEC CICS ENDBR
 18901*            DATASET  (FILE-ID-ERPNDB2)
 18902*       END-EXEC.
 18903     MOVE 0
 18904       TO DFHEIV11
 18905*    MOVE '&2                    $   #00016165' TO DFHEIV0
 18906     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18907     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 347
* EL6311.cbl
 18908     MOVE X'2020233030303136313635' TO DFHEIV0(25:11)
 18909     CALL 'kxdfhei1' USING DFHEIV0,
 18910           FILE-ID-ERPNDB2,
 18911           DFHEIV11,
 18912           DFHEIV99
 18913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18914
 18915
 18916     IF  EIBTRNID NOT = TRANS-EXB1
 18917         IF PENDING-BUS-RECS-FOUND
 18918             NEXT SENTENCE
 18919           ELSE
 18920             MOVE '9'            TO PI-BROWSE-SW
 18921             GO TO 9400-CLEAR.
 18922
 18923     IF SHOW-RECORD
 18924        MOVE ER-2253            TO EMI-ERROR
 18925       ELSE
 18926        MOVE ER-2254            TO EMI-ERROR.
 18927
 18928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18929
 18930     IF PI-MAP-NAME = SPACES
 18931        MOVE -1                  TO DPFENTRL
 18932        MOVE EL631D               TO PI-MAP-NAME
 18933        GO TO 8100-SEND-INITIAL-MAP.
 18934
 18935     IF PI-MAP-NAME = EL631B
 18936        MOVE -1                  TO BMAINTL
 18937     ELSE
 18938        IF PI-MAP-NAME = EL631C
 18939           MOVE -1               TO CMAINTL
 18940        ELSE
 18941           MOVE -1               TO DPFENTRL.
 18942
 18943     GO TO 8200-SEND-DATAONLY.
 18944
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 348
* EL6311.cbl
 18946
 18947***************************************************************
 18948*                                                             *
 18949*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18950*                                                             *
 18951*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18952*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18953*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18954*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18955*                                                             *
 18956*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18957*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18958*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18959*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18960*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18961*                AND IS IT TO BE DISPLAYED.                   *
 18962*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18963*                DISPLAYED.                                   *
 18964*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18965*                DISPLAYED.                                   *
 18966*                                                             *
 18967*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18968*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18969*                                                             *
 18970*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18971*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18972*                THEY ARE NOT TO BE DISPLAYED.                *
 18973*                                                             *
 18974***************************************************************
 18975
 18976 4100-BROWSE-PRIMARY-FORWARD.
 18977     IF FIRST-TIME  OR SHOW-RECORD
 18978        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18979        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18980        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18981     ELSE
 18982        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18983        IF ERPNDB-BATCH-SEQ-NO = +9999
 18984           GO TO 4150-END-BATCH
 18985        ELSE
 18986           IF DISPLAY-CHANGE-RECORDS
 18987              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18988           ELSE
 18989              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18990              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18991
 18992     IF FIRST-TIME
 18993         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18994            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18995              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18996
 18997
 18998* EXEC CICS HANDLE CONDITION
 18999*         ENDFILE  (4150-END-BATCH)
 19000*    END-EXEC.
 19001*    MOVE '"$''                   ! J #00016250' TO DFHEIV0
 19002     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 349
* EL6311.cbl
 19004     MOVE X'4A20233030303136323530' TO DFHEIV0(25:11)
 19005     CALL 'kxdfhei1' USING DFHEIV0
 19006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19007
 19008
 19009 4105-READ-NEXT.
 19010
 19011* EXEC CICS HANDLE CONDITION
 19012*         NOTFND    (4150-END-BATCH)
 19013*    END-EXEC.
 19014*    MOVE '"$I                   ! K #00016255' TO DFHEIV0
 19015     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19017     MOVE X'4B20233030303136323535' TO DFHEIV0(25:11)
 19018     CALL 'kxdfhei1' USING DFHEIV0
 19019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19020
 19021
 19022     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19023
 19024     IF PI-DISPLAY-ORIGINAL-BATCH
 19025        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19026     ELSE
 19027        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19028
 19029
 19030* EXEC CICS READ
 19031*         DATASET   (FILE-ID)
 19032*         SET       (ADDRESS OF PENDING-BUSINESS)
 19033*         RIDFLD    (ERPNDB-KEY)
 19034*         GTEQ
 19035*    END-EXEC.
 19036*    MOVE '&"S        G          (   #00016266' TO DFHEIV0
 19037     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19038     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19039     MOVE X'2020233030303136323636' TO DFHEIV0(25:11)
 19040     CALL 'kxdfhei1' USING DFHEIV0,
 19041           FILE-ID,
 19042           DFHEIV20,
 19043           DFHEIV99,
 19044           ERPNDB-KEY,
 19045           DFHEIV99,
 19046           DFHEIV99,
 19047           DFHEIV99
 19048     SET ADDRESS OF PENDING-BUSINESS TO
 19049         DFHEIV20
 19050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19051
 19052
 19053     IF PI-DISPLAY-ORIGINAL-BATCH
 19054        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19055           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19056           GO TO 4150-END-BATCH
 19057        ELSE
 19058           IF PB-BATCH-TRAILER
 19059              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19060              GO TO 4105-READ-NEXT
 19061           ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 350
* EL6311.cbl
 19062              NEXT SENTENCE
 19063     ELSE
 19064        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19065           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19066           GO TO 4150-END-BATCH.
 19067
 19068     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19069
 19070     IF WS-BATCH-PREFIX = '#CL'
 19071         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19072         GO TO 4105-READ-NEXT.
 19073
 19074     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19075     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19076     MOVE PB-STATE               TO PI-PB-STATE.
 19077     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19078
 19079     IF PB-BATCH-TRAILER
 19080        IF SHOW-RECORD
 19081           GO TO 4150-END-BATCH
 19082        ELSE
 19083           MOVE ER-2251         TO EMI-ERROR
 19084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19085           MOVE 1               TO PI-BROWSE-TYPE
 19086           GO TO 7200-DISPLAY-BATCHES.
 19087
 19088     IF SHOW-RECORD
 19089           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19090              GO TO 4110-BUMP-SEQ
 19091           ELSE
 19092              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19093                 GO TO 4110-BUMP-SEQ
 19094              ELSE
 19095                 GO TO 4107-CHECK-REC-TYPE.
 19096
 19097     IF NOT  PI-PRIMARY-WITH-SELECT
 19098        GO TO 4107-CHECK-REC-TYPE.
 19099
 19100     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19101        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19102           GO TO 4110-BUMP-SEQ
 19103        ELSE
 19104           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19105              GO TO 4107-CHECK-REC-TYPE
 19106           ELSE
 19107              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19108                 GO TO 4107-CHECK-REC-TYPE
 19109              ELSE
 19110                 GO TO 4110-BUMP-SEQ.
 19111
 19112     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19113        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19114           GO TO 4110-BUMP-SEQ.
 19115
 19116 4107-CHECK-REC-TYPE.
 19117     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19118         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19119             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 351
* EL6311.cbl
 19120           ELSE
 19121             GO TO 4110-BUMP-SEQ.
 19122
 19123     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19124         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19125             NEXT SENTENCE
 19126           ELSE
 19127             GO TO 4110-BUMP-SEQ.
 19128
 19129     IF NOT DISPLAY-CHANGE-RECORDS AND
 19130        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19131           GO TO 4110-BUMP-SEQ.
 19132
 19133     IF DISPLAY-HOLD-RECORDS AND
 19134        NOT PB-RECORD-ON-HOLD
 19135          GO TO 4110-BUMP-SEQ.
 19136
 19137     IF PB-ISSUE
 19138        IF DISPLAY-CHK-REQ-RECORDS
 19139            GO TO 4110-BUMP-SEQ.
 19140
 19141     IF PB-ISSUE
 19142        IF ISSUE-WITH-WARNING
 19143           IF PB-WARNING-ERRORS
 19144              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19145                  GO TO 4110-BUMP-SEQ
 19146              ELSE
 19147                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19148                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19149                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19150                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19151                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19152                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19153                 GO TO 7000-DISPLAY-ISSUES
 19154        ELSE
 19155            GO TO 4110-BUMP-SEQ.
 19156
 19157     IF PB-ISSUE
 19158        IF (ISSUES-IN-ERROR AND
 19159            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19160            ALL-ISSUES
 19161            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19162            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19163            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19164            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19165            MOVE PB-SV-STATE            TO PI-SV-STATE
 19166            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19167            GO TO 7000-DISPLAY-ISSUES
 19168        ELSE
 19169            GO TO 4110-BUMP-SEQ.
 19170
 19171     IF PB-CANCELLATION
 19172        IF DISPLAY-CHK-REQ-RECORDS
 19173           IF PB-C-REFUND-REQUESTED
 19174              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19175              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19176              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19177              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 352
* EL6311.cbl
 19178              MOVE PB-SV-STATE            TO PI-SV-STATE
 19179              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19180              GO TO 7100-DISPLAY-CANCELS
 19181           ELSE
 19182              GO TO 4110-BUMP-SEQ.
 19183
 19184     IF PB-CANCELLATION
 19185        IF CANCEL-WITH-WARNING
 19186           IF PB-WARNING-ERRORS
 19187              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19188                  GO TO 4110-BUMP-SEQ
 19189              ELSE
 19190                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19191                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19192                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19193                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19194                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19195                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19196                 GO TO 7100-DISPLAY-CANCELS
 19197           ELSE
 19198              GO TO 4110-BUMP-SEQ.
 19199
 19200     IF PB-CANCELLATION
 19201        IF (CANCEL-IN-ERROR  AND
 19202            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19203            ALL-CANCELS
 19204            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19205            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19206            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19207            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19208            MOVE PB-SV-STATE            TO PI-SV-STATE
 19209            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19210            GO TO 7100-DISPLAY-CANCELS.
 19211
 19212 4110-BUMP-SEQ.
 19213     IF NOT DISPLAY-CHANGE-RECORDS
 19214        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19215        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19216     ELSE
 19217        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19218           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19219           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19220        ELSE
 19221           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19222           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19223
 19224     GO TO 4105-READ-NEXT.
 19225
 19226 4150-END-BATCH.
 19227******************************************************************
 19228*                                                                *
 19229*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19230*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19231*         PROGRAM.                                               *
 19232*                                                                *
 19233******************************************************************
 19234
 19235     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 353
* EL6311.cbl
 19236         IF PENDING-BUS-RECS-FOUND
 19237             NEXT SENTENCE
 19238           ELSE
 19239             MOVE '9'            TO PI-BROWSE-SW
 19240             GO TO 9400-CLEAR.
 19241
 19242     IF SHOW-RECORD
 19243        MOVE ER-2253             TO EMI-ERROR
 19244     ELSE
 19245        MOVE ER-2251             TO EMI-ERROR.
 19246
 19247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19248
 19249     IF PI-MAP-NAME = SPACES
 19250        MOVE -1                  TO BMAINTL
 19251        MOVE EL631B              TO PI-MAP-NAME
 19252        GO TO 8100-SEND-INITIAL-MAP.
 19253
 19254     IF PI-MAP-NAME = EL631B
 19255        MOVE -1                  TO BMAINTL
 19256     ELSE
 19257        IF PI-MAP-NAME = EL631C
 19258           MOVE -1               TO CMAINTL
 19259        ELSE
 19260           MOVE -1               TO DPFENTRL.
 19261
 19262     GO TO 8200-SEND-DATAONLY.
 19263
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 354
* EL6311.cbl
 19265
 19266***************************************************************
 19267*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19268*                                                             *
 19269*      1. START BROWSE WITH                                   *
 19270*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19271*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19272*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19273*                                                             *
 19274*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19275*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19276*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19277*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19278*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19279*               AND IS IT TO BE DISPLAYED.                    *
 19280*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19281*               DISPLAYED.                                    *
 19282*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19283*               DISPLAYED.                                    *
 19284*                                                             *
 19285*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19286*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19287***************************************************************
 19288
 19289 4200-BROWSE-CSR-FORWARD.
 19290
 19291     IF FIRST-TIME
 19292        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19293     ELSE
 19294        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19295
 19296
 19297* EXEC CICS HANDLE CONDITION
 19298*         NOTFND   (4250-END-RECORDS)
 19299*         ENDFILE  (4250-END-RECORDS)
 19300*    END-EXEC.
 19301*    MOVE '"$I''                  ! L #00016516' TO DFHEIV0
 19302     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19304     MOVE X'4C20233030303136353136' TO DFHEIV0(25:11)
 19305     CALL 'kxdfhei1' USING DFHEIV0
 19306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19307
 19308
 19309
 19310* EXEC CICS STARTBR
 19311*         DATASET   (FILE-ID-ERPNDB4)
 19312*         RIDFLD    (ERPNDB-CSR-KEY)
 19313*    END-EXEC.
 19314     MOVE 0
 19315       TO DFHEIV11
 19316*    MOVE '&,         G          &   #00016521' TO DFHEIV0
 19317     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19318     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19319     MOVE X'2020233030303136353231' TO DFHEIV0(25:11)
 19320     CALL 'kxdfhei1' USING DFHEIV0,
 19321           FILE-ID-ERPNDB4,
 19322           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 355
* EL6311.cbl
 19323           DFHEIV99,
 19324           DFHEIV11,
 19325           DFHEIV99
 19326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19327
 19328
 19329     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19330
 19331     IF FIRST-TIME
 19332        MOVE SPACE               TO WS-FIRST-TIME-SW
 19333        GO TO 4205-READ-NEXT-RECORD.
 19334
 19335
 19336* EXEC CICS READNEXT
 19337*         DATASET    (FILE-ID-ERPNDB4)
 19338*         SET        (ADDRESS OF PENDING-BUSINESS)
 19339*         RIDFLD     (ERPNDB-CSR-KEY)
 19340*    END-EXEC.
 19341     MOVE 0
 19342       TO DFHEIV11
 19343*    MOVE '&.S                   )   #00016532' TO DFHEIV0
 19344     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19345     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19346     MOVE X'2020233030303136353332' TO DFHEIV0(25:11)
 19347     CALL 'kxdfhei1' USING DFHEIV0,
 19348           FILE-ID-ERPNDB4,
 19349           DFHEIV20,
 19350           DFHEIV99,
 19351           ERPNDB-CSR-KEY,
 19352           DFHEIV99,
 19353           DFHEIV11,
 19354           DFHEIV99,
 19355           DFHEIV99
 19356     SET ADDRESS OF PENDING-BUSINESS TO
 19357         DFHEIV20
 19358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19359
 19360
 19361 4205-READ-NEXT-RECORD.
 19362
 19363
 19364* EXEC CICS READNEXT
 19365*         DATASET    (FILE-ID-ERPNDB4)
 19366*         SET        (ADDRESS OF PENDING-BUSINESS)
 19367*         RIDFLD     (ERPNDB-CSR-KEY)
 19368*    END-EXEC.
 19369     MOVE 0
 19370       TO DFHEIV11
 19371*    MOVE '&.S                   )   #00016540' TO DFHEIV0
 19372     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19373     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19374     MOVE X'2020233030303136353430' TO DFHEIV0(25:11)
 19375     CALL 'kxdfhei1' USING DFHEIV0,
 19376           FILE-ID-ERPNDB4,
 19377           DFHEIV20,
 19378           DFHEIV99,
 19379           ERPNDB-CSR-KEY,
 19380           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 356
* EL6311.cbl
 19381           DFHEIV11,
 19382           DFHEIV99,
 19383           DFHEIV99
 19384     SET ADDRESS OF PENDING-BUSINESS TO
 19385         DFHEIV20
 19386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19387
 19388
 19389     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19390
 19391     IF WS-BATCH-PREFIX = '#CL'
 19392        GO TO 4205-READ-NEXT-RECORD.
 19393
 19394     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19395        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19396        GO TO 4250-END-RECORDS.
 19397
 19398     IF PB-BATCH-TRAILER
 19399        GO TO 4205-READ-NEXT-RECORD.
 19400
 19401     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19402        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19403           GO TO 4205-READ-NEXT-RECORD
 19404        ELSE
 19405           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19406              GO TO 4210-CHECK-REC-TYPE
 19407           ELSE
 19408              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19409                 GO TO 4210-CHECK-REC-TYPE
 19410              ELSE
 19411                 GO TO 4205-READ-NEXT-RECORD.
 19412
 19413     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19414        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19415           GO TO 4205-READ-NEXT-RECORD.
 19416
 19417 4210-CHECK-REC-TYPE.
 19418     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19419         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19420             NEXT SENTENCE
 19421         ELSE
 19422             GO TO 4205-READ-NEXT-RECORD.
 19423
 19424     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19425         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19426             NEXT SENTENCE
 19427        ELSE
 19428             GO TO 4205-READ-NEXT-RECORD.
 19429
 19430     IF NOT DISPLAY-CHANGE-RECORDS AND
 19431            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19432        GO TO 4205-READ-NEXT-RECORD.
 19433
 19434     IF DISPLAY-HOLD-RECORDS AND
 19435        NOT PB-RECORD-ON-HOLD
 19436          GO TO 4205-READ-NEXT-RECORD.
 19437
 19438     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 357
* EL6311.cbl
 19439        IF DISPLAY-CHK-REQ-RECORDS
 19440            GO TO 4205-READ-NEXT-RECORD.
 19441
 19442     IF PB-ISSUE
 19443        IF ISSUE-WITH-WARNING
 19444           IF PB-WARNING-ERRORS
 19445              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19446                  GO TO 4205-READ-NEXT-RECORD
 19447              ELSE
 19448                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19449                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19450                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19451                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19452                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19453                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19454                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19455                 GO TO 7000-DISPLAY-ISSUES
 19456           ELSE
 19457              GO TO 4205-READ-NEXT-RECORD.
 19458
 19459     IF PB-ISSUE
 19460        IF (ISSUES-IN-ERROR AND
 19461            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19462            ALL-ISSUES
 19463            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19464            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19465            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19466            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19467            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19468            MOVE PB-SV-STATE            TO PI-SV-STATE
 19469            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19470            GO TO 7000-DISPLAY-ISSUES
 19471        ELSE
 19472            GO TO 4205-READ-NEXT-RECORD.
 19473
 19474     IF PB-CANCELLATION
 19475        IF DISPLAY-CHK-REQ-RECORDS
 19476           IF PB-C-REFUND-REQUESTED
 19477              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19478              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19479              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19480              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19481              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19482              MOVE PB-SV-STATE            TO PI-SV-STATE
 19483              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19484              GO TO 7100-DISPLAY-CANCELS
 19485           ELSE
 19486               GO TO 4205-READ-NEXT-RECORD.
 19487
 19488     IF PB-CANCELLATION
 19489        IF CANCEL-WITH-WARNING
 19490           IF PB-WARNING-ERRORS
 19491              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19492                  GO TO 4205-READ-NEXT-RECORD
 19493              ELSE
 19494                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19495                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19496                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 358
* EL6311.cbl
 19497                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19498                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19499                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19500                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19501                 GO TO 7100-DISPLAY-CANCELS
 19502           ELSE
 19503              GO TO 4205-READ-NEXT-RECORD.
 19504
 19505     IF PB-CANCELLATION
 19506        IF (CANCEL-IN-ERROR  AND
 19507            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19508            ALL-CANCELS
 19509            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19510            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19511            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19512            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19513            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19514            MOVE PB-SV-STATE            TO PI-SV-STATE
 19515            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19516            GO TO 7100-DISPLAY-CANCELS.
 19517
 19518     GO TO 4205-READ-NEXT-RECORD.
 19519
 19520 4250-END-RECORDS.
 19521******************************************************************
 19522*                                                                *
 19523*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19524*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19525*         PROGRAM.                                               *
 19526*                                                                *
 19527******************************************************************
 19528
 19529     IF BROWSE-STARTED
 19530        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19531
 19532* EXEC CICS ENDBR
 19533*            DATASET  (FILE-ID-ERPNDB4)
 19534*       END-EXEC.
 19535     MOVE 0
 19536       TO DFHEIV11
 19537*    MOVE '&2                    $   #00016688' TO DFHEIV0
 19538     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19539     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19540     MOVE X'2020233030303136363838' TO DFHEIV0(25:11)
 19541     CALL 'kxdfhei1' USING DFHEIV0,
 19542           FILE-ID-ERPNDB4,
 19543           DFHEIV11,
 19544           DFHEIV99
 19545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19546
 19547
 19548     IF  EIBTRNID NOT = TRANS-EXB1
 19549         IF PENDING-BUS-RECS-FOUND
 19550             NEXT SENTENCE
 19551           ELSE
 19552             MOVE '9'            TO PI-BROWSE-SW
 19553             GO TO 9400-CLEAR.
 19554
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 359
* EL6311.cbl
 19555     IF SHOW-RECORD
 19556        MOVE ER-2253            TO EMI-ERROR
 19557       ELSE
 19558        MOVE ER-2254            TO EMI-ERROR.
 19559
 19560     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19561
 19562     IF PI-MAP-NAME = SPACES
 19563        MOVE -1                  TO DPFENTRL
 19564        MOVE EL631D               TO PI-MAP-NAME
 19565        GO TO 8100-SEND-INITIAL-MAP.
 19566
 19567     IF PI-MAP-NAME = EL631B
 19568        MOVE -1                  TO BMAINTL
 19569     ELSE
 19570        IF PI-MAP-NAME = EL631C
 19571           MOVE -1               TO CMAINTL
 19572        ELSE
 19573           MOVE -1               TO DPFENTRL.
 19574
 19575     GO TO 8200-SEND-DATAONLY.
 19576
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 360
* EL6311.cbl
 19578
 19579***************************************************************
 19580*                                                             *
 19581*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19582*                                                             *
 19583*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19584*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19585*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19586*                                                             *
 19587*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19588*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19589*          A. IS IT WITHIN THE SAME COMPANY                   *
 19590*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19591*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19592*                AND IS IT TO BE DISPLAYED.                   *
 19593*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19594*                DISPLAYED.                                   *
 19595*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19596*                DISPLAYED.                                   *
 19597*                                                             *
 19598*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19599*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19600*                                                             *
 19601*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19602*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19603*                THEY ARE NOT TO BE DISPLAYED.                *
 19604*                                                             *
 19605***************************************************************
 19606
 19607 4300-BROWSE-FILE-FORWARD.
 19608     IF FIRST-TIME OR SHOW-RECORD
 19609        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19610        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19611        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19612     ELSE
 19613        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19614        IF ERPNDB-BATCH-SEQ-NO = +9999
 19615           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19616        ELSE
 19617           IF DISPLAY-CHANGE-RECORDS
 19618              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19619           ELSE
 19620              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19621              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19622
 19623
 19624* EXEC CICS HANDLE CONDITION
 19625*         ENDFILE  (4350-END-BATCH)
 19626*         NOTFND   (4350-END-BATCH)
 19627*    END-EXEC.
 19628*    MOVE '"$''I                  ! M #00016767' TO DFHEIV0
 19629     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19630     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19631     MOVE X'4D20233030303136373637' TO DFHEIV0(25:11)
 19632     CALL 'kxdfhei1' USING DFHEIV0
 19633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19634
 19635
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 361
* EL6311.cbl
 19636 4305-READ-NEXT.
 19637     IF PI-DISPLAY-ORIGINAL-BATCH
 19638        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19639     ELSE
 19640        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19641
 19642
 19643* EXEC CICS READ
 19644*         DATASET   (FILE-ID)
 19645*         SET       (ADDRESS OF PENDING-BUSINESS)
 19646*         RIDFLD    (ERPNDB-KEY)
 19647*         GTEQ
 19648*    END-EXEC.
 19649*    MOVE '&"S        G          (   #00016778' TO DFHEIV0
 19650     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19652     MOVE X'2020233030303136373738' TO DFHEIV0(25:11)
 19653     CALL 'kxdfhei1' USING DFHEIV0,
 19654           FILE-ID,
 19655           DFHEIV20,
 19656           DFHEIV99,
 19657           ERPNDB-KEY,
 19658           DFHEIV99,
 19659           DFHEIV99,
 19660           DFHEIV99
 19661     SET ADDRESS OF PENDING-BUSINESS TO
 19662         DFHEIV20
 19663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19664
 19665
 19666     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19667        GO TO 4350-END-BATCH.
 19668
 19669     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19670                                    WS-BATCH-NO.
 19671
 19672     IF  WS-BATCH-PREFIX = '#CL'
 19673         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19674         GO TO 4305-READ-NEXT.
 19675
 19676     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19677     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19678     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19679     MOVE PB-STATE               TO PI-PB-STATE.
 19680     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19681
 19682     IF PB-BATCH-TRAILER
 19683        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19684        GO TO 4305-READ-NEXT.
 19685
 19686     IF SHOW-RECORD
 19687           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19688              GO TO 4310-BUMP-SEQ
 19689           ELSE
 19690              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19691                 GO TO 4310-BUMP-SEQ
 19692              ELSE
 19693                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 362
* EL6311.cbl
 19694
 19695     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19696        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19697           GO TO 4310-BUMP-SEQ
 19698        ELSE
 19699           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19700              GO TO 4307-CHECK-REC-TYPE
 19701           ELSE
 19702              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19703                 GO TO 4307-CHECK-REC-TYPE
 19704              ELSE
 19705                 GO TO 4310-BUMP-SEQ.
 19706
 19707     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19708        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19709           GO TO 4310-BUMP-SEQ.
 19710
 19711 4307-CHECK-REC-TYPE.
 19712     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19713         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19714             NEXT SENTENCE
 19715         ELSE
 19716             GO TO 4310-BUMP-SEQ.
 19717
 19718     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19719         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19720             NEXT SENTENCE
 19721        ELSE
 19722             GO TO 4310-BUMP-SEQ.
 19723
 19724     IF NOT DISPLAY-CHANGE-RECORDS AND
 19725            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19726        GO TO 4310-BUMP-SEQ.
 19727
 19728     IF DISPLAY-HOLD-RECORDS AND
 19729        NOT PB-RECORD-ON-HOLD
 19730          GO TO 4310-BUMP-SEQ.
 19731
 19732     IF PB-ISSUE
 19733        IF DISPLAY-CHK-REQ-RECORDS
 19734           GO TO 4310-BUMP-SEQ.
 19735
 19736     IF PB-ISSUE
 19737        IF ISSUE-WITH-WARNING
 19738           IF PB-WARNING-ERRORS
 19739              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19740                  GO TO 4310-BUMP-SEQ
 19741              ELSE
 19742                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19743                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19744                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19745                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19746                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19747                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19748                 GO TO 7000-DISPLAY-ISSUES
 19749           ELSE
 19750              GO TO 4310-BUMP-SEQ.
 19751
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 363
* EL6311.cbl
 19752     IF PB-ISSUE
 19753        IF (ISSUES-IN-ERROR AND
 19754            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19755            ALL-ISSUES
 19756            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19757            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19758            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19759            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19760            MOVE PB-SV-STATE            TO PI-SV-STATE
 19761            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19762            GO TO 7000-DISPLAY-ISSUES
 19763        ELSE
 19764            GO TO 4310-BUMP-SEQ.
 19765
 19766     IF PB-CANCELLATION
 19767        IF DISPLAY-CHK-REQ-RECORDS
 19768           IF PB-C-REFUND-REQUESTED
 19769              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19770              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19771              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19772              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19773              MOVE PB-SV-STATE            TO PI-SV-STATE
 19774              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19775              GO TO 7100-DISPLAY-CANCELS
 19776           ELSE
 19777              GO TO 4310-BUMP-SEQ.
 19778
 19779     IF PB-CANCELLATION
 19780        IF CANCEL-WITH-WARNING
 19781           IF PB-WARNING-ERRORS
 19782              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19783                  GO TO 4310-BUMP-SEQ
 19784              ELSE
 19785                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19786                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19787                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19788                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19789                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19790                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19791                 GO TO 7100-DISPLAY-CANCELS
 19792           ELSE
 19793              GO TO 4310-BUMP-SEQ.
 19794
 19795     IF PB-CANCELLATION
 19796        IF (CANCEL-IN-ERROR  AND
 19797            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19798            ALL-CANCELS
 19799            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19800            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19801            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19802            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19803            MOVE PB-SV-STATE            TO PI-SV-STATE
 19804            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19805            GO TO 7100-DISPLAY-CANCELS.
 19806
 19807 4310-BUMP-SEQ.
 19808     IF NOT DISPLAY-CHANGE-RECORDS
 19809        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 364
* EL6311.cbl
 19810        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19811     ELSE
 19812        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19813           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19814           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19815        ELSE
 19816           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19817           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19818
 19819     GO TO 4305-READ-NEXT.
 19820
 19821 4350-END-BATCH.
 19822
 19823******************************************************************
 19824*                                                                *
 19825*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19826*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19827*         PROGRAM.                                               *
 19828*                                                                *
 19829******************************************************************
 19830
 19831     IF  EIBTRNID NOT = TRANS-EXB1
 19832         IF PENDING-BUS-RECS-FOUND
 19833             NEXT SENTENCE
 19834           ELSE
 19835             MOVE '9'            TO PI-BROWSE-SW
 19836             GO TO 9400-CLEAR.
 19837
 19838     IF SHOW-RECORD
 19839        MOVE ER-2253            TO EMI-ERROR
 19840     ELSE
 19841        MOVE ER-2251            TO EMI-ERROR.
 19842
 19843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19844
 19845     IF PI-MAP-NAME = SPACES
 19846        MOVE -1                  TO BMAINTL
 19847        MOVE EL631B               TO PI-MAP-NAME
 19848        GO TO 8100-SEND-INITIAL-MAP.
 19849
 19850     IF PI-MAP-NAME = EL631B
 19851        MOVE -1                  TO BMAINTL
 19852     ELSE
 19853        IF PI-MAP-NAME = EL631C
 19854           MOVE -1               TO CMAINTL
 19855        ELSE
 19856           MOVE -1               TO DPFENTRL.
 19857
 19858     GO TO 8200-SEND-DATAONLY.
 19859
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 365
* EL6311.cbl
 19861
 19862******************************************************************
 19863*                                                                *
 19864*        B R O W S E   D E T A I L   B A C K W A R D             *
 19865*                                                                *
 19866******************************************************************
 19867
 19868 4500-BROWSE-DETAIL-BACKWARD.
 19869
 19870     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19871
 19872
 19873* EXEC CICS HANDLE CONDITION
 19874*         NOTFND   (4570-NOT-FOUND)
 19875*         ENDFILE  (4550-END-RECORDS)
 19876*    END-EXEC
 19877*    MOVE '"$I''                  ! N #00016991' TO DFHEIV0
 19878     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19880     MOVE X'4E20233030303136393931' TO DFHEIV0(25:11)
 19881     CALL 'kxdfhei1' USING DFHEIV0
 19882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19883
 19884
 19885* EXEC CICS STARTBR
 19886*         DATASET   (FILE-ID-ERPNDB2)
 19887*         RIDFLD    (ERPNDB-ALT-KEY)
 19888*    END-EXEC.
 19889     MOVE 0
 19890       TO DFHEIV11
 19891*    MOVE '&,         G          &   #00016996' TO DFHEIV0
 19892     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19893     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19894     MOVE X'2020233030303136393936' TO DFHEIV0(25:11)
 19895     CALL 'kxdfhei1' USING DFHEIV0,
 19896           FILE-ID-ERPNDB2,
 19897           ERPNDB-ALT-KEY,
 19898           DFHEIV99,
 19899           DFHEIV11,
 19900           DFHEIV99
 19901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19902
 19903
 19904     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19905                                    WS-FIRST-TIME-SW.
 19906
 19907 4505-READ-PREV-RECORD.
 19908
 19909* EXEC CICS READPREV
 19910*         DATASET    (FILE-ID-ERPNDB2)
 19911*         SET        (ADDRESS OF PENDING-BUSINESS)
 19912*         RIDFLD     (ERPNDB-ALT-KEY)
 19913*    END-EXEC.
 19914     MOVE 0
 19915       TO DFHEIV11
 19916*    MOVE '&0S                   )   #00017005' TO DFHEIV0
 19917     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19918     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 366
* EL6311.cbl
 19919     MOVE X'2020233030303137303035' TO DFHEIV0(25:11)
 19920     CALL 'kxdfhei1' USING DFHEIV0,
 19921           FILE-ID-ERPNDB2,
 19922           DFHEIV20,
 19923           DFHEIV99,
 19924           ERPNDB-ALT-KEY,
 19925           DFHEIV99,
 19926           DFHEIV11,
 19927           DFHEIV99,
 19928           DFHEIV99
 19929     SET ADDRESS OF PENDING-BUSINESS TO
 19930         DFHEIV20
 19931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19932
 19933
 19934     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19935
 19936     IF WS-BATCH-PREFIX = '#CL'
 19937         GO TO 4505-READ-PREV-RECORD.
 19938
 19939     IF FIRST-TIME
 19940         MOVE SPACE               TO WS-FIRST-TIME-SW
 19941         GO TO 4505-READ-PREV-RECORD.
 19942
 19943     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19944        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19945        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19946        PB-STATE         NOT = PI-PB-STATE    OR
 19947        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19948          GO TO 4550-END-RECORDS.
 19949
 19950
 19951     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19952
 19953     IF PB-BATCH-TRAILER
 19954        GO TO 4505-READ-PREV-RECORD.
 19955
 19956     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19957
 19958     IF  WS-BATCH-PREFIX = '#CL'
 19959         GO TO 4505-READ-PREV-RECORD.
 19960
 19961     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19962        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19963           GO TO 4505-READ-PREV-RECORD
 19964        ELSE
 19965           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19966              GO TO 4510-CHECK-REC-TYPE
 19967           ELSE
 19968              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19969                 GO TO 4510-CHECK-REC-TYPE
 19970              ELSE
 19971                 GO TO 4505-READ-PREV-RECORD.
 19972
 19973     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19974        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19975           GO TO 4505-READ-PREV-RECORD.
 19976
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 367
* EL6311.cbl
 19977 4510-CHECK-REC-TYPE.
 19978     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19979         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19980             NEXT SENTENCE
 19981         ELSE
 19982             GO TO 4505-READ-PREV-RECORD.
 19983
 19984     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19985         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19986             NEXT SENTENCE
 19987        ELSE
 19988             GO TO 4505-READ-PREV-RECORD.
 19989
 19990     IF NOT DISPLAY-CHANGE-RECORDS AND
 19991            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19992        GO TO 4505-READ-PREV-RECORD.
 19993
 19994     IF DISPLAY-HOLD-RECORDS AND
 19995        NOT PB-RECORD-ON-HOLD
 19996          GO TO 4505-READ-PREV-RECORD.
 19997
 19998     IF PB-ISSUE
 19999        IF DISPLAY-CHK-REQ-RECORDS
 20000           GO TO 4505-READ-PREV-RECORD.
 20001
 20002     IF PB-ISSUE
 20003        IF ISSUE-WITH-WARNING
 20004           IF PB-WARNING-ERRORS
 20005              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20006                  GO TO 4505-READ-PREV-RECORD
 20007              ELSE
 20008                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20009                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20010                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20011                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20012                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20013                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20014                 GO TO 7000-DISPLAY-ISSUES
 20015           ELSE
 20016              GO TO 4505-READ-PREV-RECORD.
 20017
 20018     IF PB-ISSUE
 20019        IF (ISSUES-IN-ERROR AND
 20020            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20021            ALL-ISSUES
 20022            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20023            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20024            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20025            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20026            MOVE PB-SV-STATE            TO PI-SV-STATE
 20027            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20028            GO TO 7000-DISPLAY-ISSUES
 20029        ELSE
 20030            GO TO 4505-READ-PREV-RECORD.
 20031
 20032     IF PB-CANCELLATION
 20033        IF DISPLAY-CHK-REQ-RECORDS
 20034           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 368
* EL6311.cbl
 20035              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20036              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20037              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20038              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20039              MOVE PB-SV-STATE            TO PI-SV-STATE
 20040              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20041              GO TO 7100-DISPLAY-CANCELS
 20042           ELSE
 20043              GO TO 4505-READ-PREV-RECORD.
 20044
 20045     IF PB-CANCELLATION
 20046        IF CANCEL-WITH-WARNING
 20047           IF PB-WARNING-ERRORS
 20048              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20049                  GO TO 4505-READ-PREV-RECORD
 20050              ELSE
 20051                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20052                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20053                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20054                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20055                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20056                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20057                 GO TO 7100-DISPLAY-CANCELS
 20058           ELSE
 20059              GO TO 4505-READ-PREV-RECORD.
 20060
 20061     IF PB-CANCELLATION
 20062        IF (CANCEL-IN-ERROR  AND
 20063            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20064            ALL-CANCELS
 20065            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20066            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20067            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20068            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20069            MOVE PB-SV-STATE            TO PI-SV-STATE
 20070            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20071            GO TO 7100-DISPLAY-CANCELS.
 20072
 20073     GO TO 4505-READ-PREV-RECORD.
 20074
 20075 4550-END-RECORDS.
 20076     IF PI-MAP-NAME = EL631B
 20077        MOVE -1                  TO BMAINTL
 20078     ELSE
 20079        IF PI-MAP-NAME = EL631C
 20080           MOVE -1               TO CMAINTL
 20081        ELSE
 20082           MOVE -1               TO DPFENTRL.
 20083
 20084     MOVE ER-2255               TO EMI-ERROR.
 20085     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20086     GO TO 8200-SEND-DATAONLY.
 20087
 20088 4570-NOT-FOUND.
 20089
 20090******************************************************************
 20091*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20092******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 369
* EL6311.cbl
 20093
 20094
 20095* EXEC CICS RESETBR
 20096*         DATASET    (FILE-ID-ERPNDB2)
 20097*         RIDFLD     (ERPNDB-ALT-KEY)
 20098*    END-EXEC.
 20099     MOVE 0
 20100       TO DFHEIV11
 20101*    MOVE '&4         G          &   #00017171' TO DFHEIV0
 20102     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20103     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20104     MOVE X'2020233030303137313731' TO DFHEIV0(25:11)
 20105     CALL 'kxdfhei1' USING DFHEIV0,
 20106           FILE-ID-ERPNDB2,
 20107           ERPNDB-ALT-KEY,
 20108           DFHEIV99,
 20109           DFHEIV11,
 20110           DFHEIV99
 20111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20112
 20113
 20114
 20115* EXEC CICS READNEXT
 20116*         DATASET    (FILE-ID-ERPNDB2)
 20117*         SET        (ADDRESS OF PENDING-BUSINESS)
 20118*         RIDFLD     (ERPNDB-ALT-KEY)
 20119*    END-EXEC.
 20120     MOVE 0
 20121       TO DFHEIV11
 20122*    MOVE '&.S                   )   #00017176' TO DFHEIV0
 20123     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20124     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20125     MOVE X'2020233030303137313736' TO DFHEIV0(25:11)
 20126     CALL 'kxdfhei1' USING DFHEIV0,
 20127           FILE-ID-ERPNDB2,
 20128           DFHEIV20,
 20129           DFHEIV99,
 20130           ERPNDB-ALT-KEY,
 20131           DFHEIV99,
 20132           DFHEIV11,
 20133           DFHEIV99,
 20134           DFHEIV99
 20135     SET ADDRESS OF PENDING-BUSINESS TO
 20136         DFHEIV20
 20137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20138
 20139
 20140
 20141* EXEC CICS READPREV
 20142*         DATASET    (FILE-ID-ERPNDB2)
 20143*         SET        (ADDRESS OF PENDING-BUSINESS)
 20144*         RIDFLD     (ERPNDB-ALT-KEY)
 20145*    END-EXEC.
 20146     MOVE 0
 20147       TO DFHEIV11
 20148*    MOVE '&0S                   )   #00017182' TO DFHEIV0
 20149     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20150     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 370
* EL6311.cbl
 20151     MOVE X'2020233030303137313832' TO DFHEIV0(25:11)
 20152     CALL 'kxdfhei1' USING DFHEIV0,
 20153           FILE-ID-ERPNDB2,
 20154           DFHEIV20,
 20155           DFHEIV99,
 20156           ERPNDB-ALT-KEY,
 20157           DFHEIV99,
 20158           DFHEIV11,
 20159           DFHEIV99,
 20160           DFHEIV99
 20161     SET ADDRESS OF PENDING-BUSINESS TO
 20162         DFHEIV20
 20163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20164
 20165
 20166 4580-READ-PREV-RECORD.
 20167
 20168* EXEC CICS READPREV
 20169*         DATASET    (FILE-ID-ERPNDB2)
 20170*         SET        (ADDRESS OF PENDING-BUSINESS)
 20171*         RIDFLD     (ERPNDB-ALT-KEY)
 20172*    END-EXEC.
 20173     MOVE 0
 20174       TO DFHEIV11
 20175*    MOVE '&0S                   )   #00017189' TO DFHEIV0
 20176     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20177     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20178     MOVE X'2020233030303137313839' TO DFHEIV0(25:11)
 20179     CALL 'kxdfhei1' USING DFHEIV0,
 20180           FILE-ID-ERPNDB2,
 20181           DFHEIV20,
 20182           DFHEIV99,
 20183           ERPNDB-ALT-KEY,
 20184           DFHEIV99,
 20185           DFHEIV11,
 20186           DFHEIV99,
 20187           DFHEIV99
 20188     SET ADDRESS OF PENDING-BUSINESS TO
 20189         DFHEIV20
 20190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20191
 20192
 20193     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20194
 20195     IF WS-BATCH-PREFIX = '#CL'
 20196        GO TO 4580-READ-PREV-RECORD.
 20197
 20198     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20199     GO TO 4505-READ-PREV-RECORD.
 20200
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 371
* EL6311.cbl
 20202
 20203******************************************************************
 20204*                                                                *
 20205*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20206*                                                                *
 20207******************************************************************
 20208
 20209 4600-BROWSE-PRIMARY-BACKWARD.
 20210        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20211
 20212     IF ERPNDB-BATCH-SEQ-NO = +9999
 20213        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20214
 20215        IF ERPNDB-BATCH-SEQ-NO = +0000
 20216           GO TO 4650-END-BATCH
 20217        ELSE
 20218           IF PI-MAP-NAME NOT = EL631D
 20219              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20220                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20221              ELSE
 20222                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20223                 IF DISPLAY-CHANGE-RECORDS
 20224                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20225                 ELSE
 20226                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20227
 20228
 20229* EXEC CICS HANDLE CONDITION
 20230*         NOTFND    (4680-NOT-FOUND)
 20231*         ENDFILE   (4680-NOT-FOUND)
 20232*    END-EXEC.
 20233*    MOVE '"$I''                  ! O #00017230' TO DFHEIV0
 20234     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20236     MOVE X'4F20233030303137323330' TO DFHEIV0(25:11)
 20237     CALL 'kxdfhei1' USING DFHEIV0
 20238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20239
 20240
 20241 4605-READ-NEXT.
 20242     IF ERPNDB-BATCH-SEQ-NO = +0000
 20243        GO TO 4650-END-BATCH.
 20244
 20245     IF PI-DISPLAY-ORIGINAL-BATCH
 20246        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20247     ELSE
 20248        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20249
 20250
 20251* EXEC CICS READ
 20252*         DATASET   (FILE-ID)
 20253*         SET       (ADDRESS OF PENDING-BUSINESS)
 20254*         RIDFLD    (ERPNDB-KEY)
 20255*    END-EXEC.
 20256*    MOVE '&"S        E          (   #00017244' TO DFHEIV0
 20257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20259     MOVE X'2020233030303137323434' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 372
* EL6311.cbl
 20260     CALL 'kxdfhei1' USING DFHEIV0,
 20261           FILE-ID,
 20262           DFHEIV20,
 20263           DFHEIV99,
 20264           ERPNDB-KEY,
 20265           DFHEIV99,
 20266           DFHEIV99,
 20267           DFHEIV99
 20268     SET ADDRESS OF PENDING-BUSINESS TO
 20269         DFHEIV20
 20270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20271
 20272
 20273     IF NOT  PI-PRIMARY-WITH-SELECT
 20274        GO TO 4607-CHECK-REC-TYPE.
 20275
 20276     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20277
 20278     IF  WS-BATCH-PREFIX = '#CL'
 20279         GO TO 4610-BUMP-SEQ.
 20280
 20281     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20282        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20283           GO TO 4610-BUMP-SEQ
 20284        ELSE
 20285           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20286              GO TO 4607-CHECK-REC-TYPE
 20287           ELSE
 20288              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20289                 GO TO 4607-CHECK-REC-TYPE
 20290              ELSE
 20291                 GO TO 4610-BUMP-SEQ.
 20292
 20293     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20294        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20295           GO TO 4610-BUMP-SEQ.
 20296
 20297 4607-CHECK-REC-TYPE.
 20298     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20299         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20300             NEXT SENTENCE
 20301         ELSE
 20302             GO TO 4610-BUMP-SEQ.
 20303
 20304     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20305         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20306             NEXT SENTENCE
 20307        ELSE
 20308             GO TO 4610-BUMP-SEQ.
 20309
 20310     IF NOT DISPLAY-CHANGE-RECORDS AND
 20311            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20312        GO TO 4610-BUMP-SEQ.
 20313
 20314     IF DISPLAY-HOLD-RECORDS AND
 20315        NOT PB-RECORD-ON-HOLD
 20316          GO TO 4610-BUMP-SEQ.
 20317
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 373
* EL6311.cbl
 20318     IF PB-ISSUE
 20319        IF DISPLAY-CHK-REQ-RECORDS
 20320           GO TO 4610-BUMP-SEQ.
 20321
 20322     IF PB-ISSUE
 20323        IF ISSUE-WITH-WARNING
 20324           IF PB-WARNING-ERRORS
 20325              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20326                  GO TO 4610-BUMP-SEQ
 20327              ELSE
 20328                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20329                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20330                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20331                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20332                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20333                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20334                 GO TO 7000-DISPLAY-ISSUES
 20335           ELSE
 20336              GO TO 4610-BUMP-SEQ.
 20337
 20338     IF PB-ISSUE
 20339        IF (ISSUES-IN-ERROR AND
 20340            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20341            ALL-ISSUES
 20342            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20343            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20344            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20345            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20346            MOVE PB-SV-STATE            TO PI-SV-STATE
 20347            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20348            GO TO 7000-DISPLAY-ISSUES
 20349        ELSE
 20350            GO TO 4610-BUMP-SEQ.
 20351
 20352     IF PB-CANCELLATION
 20353        IF DISPLAY-CHK-REQ-RECORDS
 20354           IF PB-C-REFUND-REQUESTED
 20355              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20356              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20357              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20358              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20359              MOVE PB-SV-STATE            TO PI-SV-STATE
 20360              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20361              GO TO 7100-DISPLAY-CANCELS
 20362           ELSE
 20363              GO TO 4610-BUMP-SEQ.
 20364
 20365     IF PB-CANCELLATION
 20366        IF CANCEL-WITH-WARNING
 20367           IF PB-WARNING-ERRORS
 20368              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20369                  GO TO 4610-BUMP-SEQ
 20370              ELSE
 20371                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20372                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20373                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20374                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20375                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 374
* EL6311.cbl
 20376                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20377                 GO TO 7100-DISPLAY-CANCELS
 20378           ELSE
 20379              GO TO 4610-BUMP-SEQ.
 20380
 20381     IF PB-CANCELLATION
 20382        IF (CANCEL-IN-ERROR  AND
 20383            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20384            ALL-CANCELS
 20385            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20386            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20387            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20388            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20389            MOVE PB-SV-STATE            TO PI-SV-STATE
 20390            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20391            GO TO 7100-DISPLAY-CANCELS.
 20392
 20393 4610-BUMP-SEQ.
 20394     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20395        GO TO 4650-END-BATCH.
 20396
 20397     IF DISPLAY-CHANGE-RECORDS
 20398        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20399           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20400        ELSE
 20401           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20402           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20403        ELSE
 20404           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20405           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20406
 20407        GO TO 4605-READ-NEXT.
 20408
 20409 4650-END-BATCH.
 20410     IF PI-MAP-NAME = EL631B
 20411        MOVE -1                  TO BMAINTL
 20412     ELSE
 20413        IF PI-MAP-NAME = EL631C
 20414           MOVE -1               TO CMAINTL
 20415        ELSE
 20416           MOVE -1               TO DPFENTRL.
 20417
 20418     MOVE ER-2252               TO EMI-ERROR.
 20419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20420     GO TO 8200-SEND-DATAONLY.
 20421
 20422 4680-NOT-FOUND.
 20423     IF DISPLAY-CHANGE-RECORDS
 20424        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20425           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20426        ELSE
 20427           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20428           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20429     ELSE
 20430        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20431
 20432     GO TO 4605-READ-NEXT.
 20433
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 375
* EL6311.cbl
 20435
 20436******************************************************************
 20437*                                                                *
 20438*        B R O W S E   F I L E   B A C K W A R D S               *
 20439*                                                                *
 20440******************************************************************
 20441
 20442 4800-BROWSE-FILE-BACKWARD.
 20443
 20444* EXEC CICS HANDLE CONDITION
 20445*         NOTFND   (4860-NOT-FOUND)
 20446*         ENDFILE  (4850-END-RECORDS)
 20447*    END-EXEC.
 20448*    MOVE '"$I''                  ! P #00017420' TO DFHEIV0
 20449     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20451     MOVE X'5020233030303137343230' TO DFHEIV0(25:11)
 20452     CALL 'kxdfhei1' USING DFHEIV0
 20453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20454
 20455
 20456     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20457
 20458     IF PI-DISPLAY-ORIGINAL-BATCH
 20459        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20460     ELSE
 20461        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20462
 20463
 20464* EXEC CICS STARTBR
 20465*         DATASET   (FILE-ID)
 20466*         RIDFLD    (ERPNDB-KEY)
 20467*    END-EXEC.
 20468     MOVE 0
 20469       TO DFHEIV11
 20470*    MOVE '&,         G          &   #00017432' TO DFHEIV0
 20471     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20472     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20473     MOVE X'2020233030303137343332' TO DFHEIV0(25:11)
 20474     CALL 'kxdfhei1' USING DFHEIV0,
 20475           FILE-ID,
 20476           ERPNDB-KEY,
 20477           DFHEIV99,
 20478           DFHEIV11,
 20479           DFHEIV99
 20480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20481
 20482
 20483     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20484
 20485
 20486* EXEC CICS READPREV
 20487*         DATASET    (FILE-ID-ERPNDB)
 20488*         SET        (ADDRESS OF PENDING-BUSINESS)
 20489*         RIDFLD     (ERPNDB-KEY)
 20490*    END-EXEC.
 20491     MOVE 0
 20492       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 376
* EL6311.cbl
 20493*    MOVE '&0S                   )   #00017439' TO DFHEIV0
 20494     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20495     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20496     MOVE X'2020233030303137343339' TO DFHEIV0(25:11)
 20497     CALL 'kxdfhei1' USING DFHEIV0,
 20498           FILE-ID-ERPNDB,
 20499           DFHEIV20,
 20500           DFHEIV99,
 20501           ERPNDB-KEY,
 20502           DFHEIV99,
 20503           DFHEIV11,
 20504           DFHEIV99,
 20505           DFHEIV99
 20506     SET ADDRESS OF PENDING-BUSINESS TO
 20507         DFHEIV20
 20508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20509
 20510
 20511 4810-READ-PREV-RECORD.
 20512
 20513* EXEC CICS READPREV
 20514*         DATASET    (FILE-ID-ERPNDB)
 20515*         SET        (ADDRESS OF PENDING-BUSINESS)
 20516*         RIDFLD     (ERPNDB-KEY)
 20517*    END-EXEC.
 20518     MOVE 0
 20519       TO DFHEIV11
 20520*    MOVE '&0S                   )   #00017446' TO DFHEIV0
 20521     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20522     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20523     MOVE X'2020233030303137343436' TO DFHEIV0(25:11)
 20524     CALL 'kxdfhei1' USING DFHEIV0,
 20525           FILE-ID-ERPNDB,
 20526           DFHEIV20,
 20527           DFHEIV99,
 20528           ERPNDB-KEY,
 20529           DFHEIV99,
 20530           DFHEIV11,
 20531           DFHEIV99,
 20532           DFHEIV99
 20533     SET ADDRESS OF PENDING-BUSINESS TO
 20534         DFHEIV20
 20535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20536
 20537
 20538     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20539        GO TO 4850-END-RECORDS.
 20540
 20541     IF PB-BATCH-TRAILER
 20542        GO TO 4810-READ-PREV-RECORD.
 20543
 20544     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20545
 20546     IF  WS-BATCH-PREFIX = '#CL'
 20547         GO TO 4810-READ-PREV-RECORD.
 20548
 20549     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20550        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 377
* EL6311.cbl
 20551           GO TO 4810-READ-PREV-RECORD
 20552        ELSE
 20553           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20554              GO TO 4820-CHECK-REC-TYPE
 20555           ELSE
 20556              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20557                 GO TO 4820-CHECK-REC-TYPE
 20558              ELSE
 20559                 GO TO 4810-READ-PREV-RECORD.
 20560
 20561     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20562        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20563           GO TO 4810-READ-PREV-RECORD.
 20564
 20565 4820-CHECK-REC-TYPE.
 20566     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20567         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20568             NEXT SENTENCE
 20569         ELSE
 20570             GO TO 4810-READ-PREV-RECORD.
 20571
 20572     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20573         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20574             NEXT SENTENCE
 20575        ELSE
 20576             GO TO 4810-READ-PREV-RECORD.
 20577
 20578     IF NOT DISPLAY-CHANGE-RECORDS AND
 20579            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20580        GO TO 4810-READ-PREV-RECORD.
 20581
 20582     IF DISPLAY-HOLD-RECORDS AND
 20583        NOT PB-RECORD-ON-HOLD
 20584          GO TO 4810-READ-PREV-RECORD.
 20585
 20586     IF PB-ISSUE
 20587        IF DISPLAY-CHK-REQ-RECORDS
 20588           GO TO 4810-READ-PREV-RECORD.
 20589
 20590     IF PB-ISSUE
 20591        IF ISSUE-WITH-WARNING
 20592           IF PB-WARNING-ERRORS
 20593              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20594                  GO TO 4810-READ-PREV-RECORD
 20595              ELSE
 20596                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20597                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20598                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20599                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20600                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20601                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20602                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20603                 GO TO 7000-DISPLAY-ISSUES
 20604           ELSE
 20605              GO TO 4810-READ-PREV-RECORD.
 20606
 20607     IF PB-ISSUE
 20608        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 378
* EL6311.cbl
 20609            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20610            ALL-ISSUES
 20611            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20612            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20613            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20614            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20615            MOVE PB-SV-STATE            TO PI-SV-STATE
 20616            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20617            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20618            GO TO 7000-DISPLAY-ISSUES
 20619        ELSE
 20620            GO TO 4810-READ-PREV-RECORD.
 20621
 20622     IF PB-CANCELLATION
 20623        IF DISPLAY-CHK-REQ-RECORDS
 20624           IF PB-C-REFUND-REQUESTED
 20625              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20626              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20627              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20628              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20629              MOVE PB-SV-STATE            TO PI-SV-STATE
 20630              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20631              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20632              GO TO 7100-DISPLAY-CANCELS
 20633           ELSE
 20634              GO TO 4810-READ-PREV-RECORD.
 20635
 20636     IF PB-CANCELLATION
 20637        IF CANCEL-WITH-WARNING
 20638           IF PB-WARNING-ERRORS
 20639              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20640                  GO TO 4810-READ-PREV-RECORD
 20641              ELSE
 20642                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20643                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20644                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20645                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20646                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20647                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20648                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20649                 GO TO 7100-DISPLAY-CANCELS
 20650           ELSE
 20651              GO TO 4810-READ-PREV-RECORD.
 20652
 20653     IF PB-CANCELLATION
 20654        IF (CANCEL-IN-ERROR  AND
 20655            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20656            ALL-CANCELS
 20657            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20658            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20659            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20660            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20661            MOVE PB-SV-STATE            TO PI-SV-STATE
 20662            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20663            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20664            GO TO 7100-DISPLAY-CANCELS.
 20665
 20666     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 379
* EL6311.cbl
 20667
 20668 4850-END-RECORDS.
 20669     MOVE ER-2252                TO EMI-ERROR.
 20670     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20671
 20672     IF PI-MAP-NAME = EL631B
 20673        MOVE -1                  TO BPFENTRL
 20674     ELSE
 20675        MOVE -1                  TO CPFENTRL.
 20676
 20677     GO TO 8200-SEND-DATAONLY.
 20678
 20679 4860-NOT-FOUND.
 20680
 20681******************************************************************
 20682*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20683******************************************************************
 20684
 20685
 20686* EXEC CICS RESETBR
 20687*         DATASET    (FILE-ID-ERPNDB)
 20688*         RIDFLD     (ERPNDB-KEY)
 20689*     END-EXEC.
 20690     MOVE 0
 20691       TO DFHEIV11
 20692*    MOVE '&4         G          &   #00017599' TO DFHEIV0
 20693     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20694     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20695     MOVE X'2020233030303137353939' TO DFHEIV0(25:11)
 20696     CALL 'kxdfhei1' USING DFHEIV0,
 20697           FILE-ID-ERPNDB,
 20698           ERPNDB-KEY,
 20699           DFHEIV99,
 20700           DFHEIV11,
 20701           DFHEIV99
 20702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20703
 20704
 20705
 20706* EXEC CICS READNEXT
 20707*         DATASET    (FILE-ID-ERPNDB)
 20708*         SET        (ADDRESS OF PENDING-BUSINESS)
 20709*         RIDFLD     (ERPNDB-KEY)
 20710*    END-EXEC.
 20711     MOVE 0
 20712       TO DFHEIV11
 20713*    MOVE '&.S                   )   #00017604' TO DFHEIV0
 20714     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20715     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20716     MOVE X'2020233030303137363034' TO DFHEIV0(25:11)
 20717     CALL 'kxdfhei1' USING DFHEIV0,
 20718           FILE-ID-ERPNDB,
 20719           DFHEIV20,
 20720           DFHEIV99,
 20721           ERPNDB-KEY,
 20722           DFHEIV99,
 20723           DFHEIV11,
 20724           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 380
* EL6311.cbl
 20725           DFHEIV99
 20726     SET ADDRESS OF PENDING-BUSINESS TO
 20727         DFHEIV20
 20728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20729
 20730
 20731
 20732* EXEC CICS READPREV
 20733*         DATASET    (FILE-ID-ERPNDB)
 20734*         SET        (ADDRESS OF PENDING-BUSINESS)
 20735*         RIDFLD     (ERPNDB-KEY)
 20736*    END-EXEC.
 20737     MOVE 0
 20738       TO DFHEIV11
 20739*    MOVE '&0S                   )   #00017610' TO DFHEIV0
 20740     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20741     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20742     MOVE X'2020233030303137363130' TO DFHEIV0(25:11)
 20743     CALL 'kxdfhei1' USING DFHEIV0,
 20744           FILE-ID-ERPNDB,
 20745           DFHEIV20,
 20746           DFHEIV99,
 20747           ERPNDB-KEY,
 20748           DFHEIV99,
 20749           DFHEIV11,
 20750           DFHEIV99,
 20751           DFHEIV99
 20752     SET ADDRESS OF PENDING-BUSINESS TO
 20753         DFHEIV20
 20754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20755
 20756
 20757     GO TO 4810-READ-PREV-RECORD.
 20758
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 381
* EL6311.cbl
 20760
 20761******************************************************************
 20762*                                                                *
 20763*           B R O W S E   C S R   B A C K W A R D                *
 20764*                                                                *
 20765******************************************************************
 20766
 20767 4900-BROWSE-CSR-BACKWARD.
 20768
 20769     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20770
 20771
 20772* EXEC CICS HANDLE CONDITION
 20773*         NOTFND   (4970-NOT-FOUND)
 20774*         ENDFILE  (4950-END-RECORDS)
 20775*    END-EXEC
 20776*    MOVE '"$I''                  ! Q #00017630' TO DFHEIV0
 20777     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20778     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20779     MOVE X'5120233030303137363330' TO DFHEIV0(25:11)
 20780     CALL 'kxdfhei1' USING DFHEIV0
 20781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20782
 20783
 20784* EXEC CICS STARTBR
 20785*         DATASET   (FILE-ID-ERPNDB4)
 20786*         RIDFLD    (ERPNDB-CSR-KEY)
 20787*    END-EXEC.
 20788     MOVE 0
 20789       TO DFHEIV11
 20790*    MOVE '&,         G          &   #00017635' TO DFHEIV0
 20791     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20792     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20793     MOVE X'2020233030303137363335' TO DFHEIV0(25:11)
 20794     CALL 'kxdfhei1' USING DFHEIV0,
 20795           FILE-ID-ERPNDB4,
 20796           ERPNDB-CSR-KEY,
 20797           DFHEIV99,
 20798           DFHEIV11,
 20799           DFHEIV99
 20800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20801
 20802
 20803     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20804                                    WS-FIRST-TIME-SW.
 20805
 20806 4905-READ-PREV-RECORD.
 20807
 20808* EXEC CICS READPREV
 20809*         DATASET    (FILE-ID-ERPNDB4)
 20810*         SET        (ADDRESS OF PENDING-BUSINESS)
 20811*         RIDFLD     (ERPNDB-CSR-KEY)
 20812*    END-EXEC.
 20813     MOVE 0
 20814       TO DFHEIV11
 20815*    MOVE '&0S                   )   #00017644' TO DFHEIV0
 20816     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20817     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 382
* EL6311.cbl
 20818     MOVE X'2020233030303137363434' TO DFHEIV0(25:11)
 20819     CALL 'kxdfhei1' USING DFHEIV0,
 20820           FILE-ID-ERPNDB4,
 20821           DFHEIV20,
 20822           DFHEIV99,
 20823           ERPNDB-CSR-KEY,
 20824           DFHEIV99,
 20825           DFHEIV11,
 20826           DFHEIV99,
 20827           DFHEIV99
 20828     SET ADDRESS OF PENDING-BUSINESS TO
 20829         DFHEIV20
 20830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20831
 20832
 20833     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20834
 20835     IF WS-BATCH-PREFIX = '#CL'
 20836         GO TO 4905-READ-PREV-RECORD.
 20837
 20838     IF FIRST-TIME
 20839         MOVE SPACE               TO WS-FIRST-TIME-SW
 20840         GO TO 4905-READ-PREV-RECORD.
 20841
 20842     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20843        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20844        GO TO 4950-END-RECORDS.
 20845
 20846     IF PB-BATCH-TRAILER
 20847        GO TO 4905-READ-PREV-RECORD.
 20848
 20849     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20850
 20851     IF  WS-BATCH-PREFIX = '#CL'
 20852         GO TO 4905-READ-PREV-RECORD.
 20853
 20854     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20855        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20856           GO TO 4905-READ-PREV-RECORD
 20857        ELSE
 20858           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20859              GO TO 4910-CHECK-REC-TYPE
 20860           ELSE
 20861              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20862                 GO TO 4910-CHECK-REC-TYPE
 20863              ELSE
 20864                 GO TO 4905-READ-PREV-RECORD.
 20865
 20866     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20867        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20868           GO TO 4905-READ-PREV-RECORD.
 20869
 20870 4910-CHECK-REC-TYPE.
 20871     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20872         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20873             NEXT SENTENCE
 20874         ELSE
 20875             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 383
* EL6311.cbl
 20876
 20877     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20878         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20879             NEXT SENTENCE
 20880        ELSE
 20881             GO TO 4905-READ-PREV-RECORD.
 20882
 20883     IF NOT DISPLAY-CHANGE-RECORDS AND
 20884            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20885        GO TO 4905-READ-PREV-RECORD.
 20886
 20887     IF DISPLAY-HOLD-RECORDS AND
 20888        NOT PB-RECORD-ON-HOLD
 20889          GO TO 4905-READ-PREV-RECORD.
 20890
 20891     IF PB-ISSUE
 20892        IF DISPLAY-CHK-REQ-RECORDS
 20893           GO TO 4905-READ-PREV-RECORD.
 20894
 20895     IF PB-ISSUE
 20896        IF ISSUE-WITH-WARNING
 20897           IF PB-WARNING-ERRORS
 20898              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20899                  GO TO 4505-READ-PREV-RECORD
 20900              ELSE
 20901                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20902                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20903                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20904                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20905                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20906                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20907                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20908                 GO TO 7000-DISPLAY-ISSUES
 20909           ELSE
 20910              GO TO 4905-READ-PREV-RECORD.
 20911
 20912     IF PB-ISSUE
 20913        IF (ISSUES-IN-ERROR AND
 20914            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20915            ALL-ISSUES
 20916            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20917            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20918            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20919            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20920            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20921            MOVE PB-SV-STATE            TO PI-SV-STATE
 20922            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20923            GO TO 7000-DISPLAY-ISSUES
 20924        ELSE
 20925            GO TO 4905-READ-PREV-RECORD.
 20926
 20927     IF PB-CANCELLATION
 20928        IF DISPLAY-CHK-REQ-RECORDS
 20929           IF PB-C-REFUND-REQUESTED
 20930              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20931              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20932              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20933              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 384
* EL6311.cbl
 20934              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20935              MOVE PB-SV-STATE            TO PI-SV-STATE
 20936              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20937              GO TO 7100-DISPLAY-CANCELS
 20938           ELSE
 20939              GO TO 4905-READ-PREV-RECORD.
 20940
 20941     IF PB-CANCELLATION
 20942        IF CANCEL-WITH-WARNING
 20943           IF PB-WARNING-ERRORS
 20944              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20945                  GO TO 4505-READ-PREV-RECORD
 20946              ELSE
 20947                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20948                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20949                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20950                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20951                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20952                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20953                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20954                 GO TO 7100-DISPLAY-CANCELS
 20955           ELSE
 20956              GO TO 4905-READ-PREV-RECORD.
 20957
 20958     IF PB-CANCELLATION
 20959        IF (CANCEL-IN-ERROR  AND
 20960            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20961            ALL-CANCELS
 20962            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20963            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20964            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20965            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20966            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20967            MOVE PB-SV-STATE            TO PI-SV-STATE
 20968            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20969            GO TO 7100-DISPLAY-CANCELS.
 20970
 20971     GO TO 4905-READ-PREV-RECORD.
 20972
 20973 4950-END-RECORDS.
 20974     IF PI-MAP-NAME = EL631B
 20975        MOVE -1                  TO BMAINTL
 20976     ELSE
 20977        IF PI-MAP-NAME = EL631C
 20978           MOVE -1               TO CMAINTL
 20979        ELSE
 20980           MOVE -1               TO DPFENTRL.
 20981
 20982     MOVE ER-2255               TO EMI-ERROR.
 20983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20984     GO TO 8200-SEND-DATAONLY.
 20985
 20986 4970-NOT-FOUND.
 20987
 20988******************************************************************
 20989*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20990******************************************************************
 20991
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 385
* EL6311.cbl
 20992
 20993* EXEC CICS RESETBR
 20994*         DATASET    (FILE-ID-ERPNDB4)
 20995*         RIDFLD     (ERPNDB-CSR-KEY)
 20996*    END-EXEC.
 20997     MOVE 0
 20998       TO DFHEIV11
 20999*    MOVE '&4         G          &   #00017809' TO DFHEIV0
 21000     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21001     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21002     MOVE X'2020233030303137383039' TO DFHEIV0(25:11)
 21003     CALL 'kxdfhei1' USING DFHEIV0,
 21004           FILE-ID-ERPNDB4,
 21005           ERPNDB-CSR-KEY,
 21006           DFHEIV99,
 21007           DFHEIV11,
 21008           DFHEIV99
 21009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21010
 21011
 21012
 21013* EXEC CICS READNEXT
 21014*         DATASET    (FILE-ID-ERPNDB4)
 21015*         SET        (ADDRESS OF PENDING-BUSINESS)
 21016*         RIDFLD     (ERPNDB-CSR-KEY)
 21017*    END-EXEC.
 21018     MOVE 0
 21019       TO DFHEIV11
 21020*    MOVE '&.S                   )   #00017814' TO DFHEIV0
 21021     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21022     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21023     MOVE X'2020233030303137383134' TO DFHEIV0(25:11)
 21024     CALL 'kxdfhei1' USING DFHEIV0,
 21025           FILE-ID-ERPNDB4,
 21026           DFHEIV20,
 21027           DFHEIV99,
 21028           ERPNDB-CSR-KEY,
 21029           DFHEIV99,
 21030           DFHEIV11,
 21031           DFHEIV99,
 21032           DFHEIV99
 21033     SET ADDRESS OF PENDING-BUSINESS TO
 21034         DFHEIV20
 21035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21036
 21037
 21038
 21039* EXEC CICS READPREV
 21040*         DATASET    (FILE-ID-ERPNDB4)
 21041*         SET        (ADDRESS OF PENDING-BUSINESS)
 21042*         RIDFLD     (ERPNDB-CSR-KEY)
 21043*    END-EXEC.
 21044     MOVE 0
 21045       TO DFHEIV11
 21046*    MOVE '&0S                   )   #00017820' TO DFHEIV0
 21047     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21048     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21049     MOVE X'2020233030303137383230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 386
* EL6311.cbl
 21050     CALL 'kxdfhei1' USING DFHEIV0,
 21051           FILE-ID-ERPNDB4,
 21052           DFHEIV20,
 21053           DFHEIV99,
 21054           ERPNDB-CSR-KEY,
 21055           DFHEIV99,
 21056           DFHEIV11,
 21057           DFHEIV99,
 21058           DFHEIV99
 21059     SET ADDRESS OF PENDING-BUSINESS TO
 21060         DFHEIV20
 21061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21062
 21063
 21064 4980-READ-PREV-RECORD.
 21065
 21066* EXEC CICS READPREV
 21067*         DATASET    (FILE-ID-ERPNDB4)
 21068*         SET        (ADDRESS OF PENDING-BUSINESS)
 21069*         RIDFLD     (ERPNDB-CSR-KEY)
 21070*    END-EXEC.
 21071     MOVE 0
 21072       TO DFHEIV11
 21073*    MOVE '&0S                   )   #00017827' TO DFHEIV0
 21074     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21075     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21076     MOVE X'2020233030303137383237' TO DFHEIV0(25:11)
 21077     CALL 'kxdfhei1' USING DFHEIV0,
 21078           FILE-ID-ERPNDB4,
 21079           DFHEIV20,
 21080           DFHEIV99,
 21081           ERPNDB-CSR-KEY,
 21082           DFHEIV99,
 21083           DFHEIV11,
 21084           DFHEIV99,
 21085           DFHEIV99
 21086     SET ADDRESS OF PENDING-BUSINESS TO
 21087         DFHEIV20
 21088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21089
 21090
 21091     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21092
 21093     IF WS-BATCH-PREFIX = '#CL'
 21094        GO TO 4980-READ-PREV-RECORD.
 21095
 21096     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21097     GO TO 4905-READ-PREV-RECORD.
 21098
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 387
* EL6311.cbl
 21100
 21101
 21102******************************************************************
 21103*                                                                *
 21104*        B R O W S E   B A T C H   H E A D E R S                 *
 21105*                                                                *
 21106******************************************************************
 21107
 21108 5000-BROWSE-BATCH-HEADERS.
 21109
 21110     IF EIBTRNID NOT = TRANS-EXB1
 21111        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21112        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21113        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21114        GO TO 5010-READ-NEXT-RECORD.
 21115
 21116     IF EIBAID = DFHPF4
 21117        MOVE '0'                TO PI-EDIT-SW
 21118        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21119        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21120        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21121        GO TO 5010-READ-NEXT-RECORD.
 21122
 21123     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21124     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21125     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21126
 21127
 21128* EXEC CICS HANDLE CONDITION
 21129*         ENDFILE  (5050-NOT-FOUND)
 21130*    END-EXEC.
 21131*    MOVE '"$''                   ! R #00017869' TO DFHEIV0
 21132     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21134     MOVE X'5220233030303137383639' TO DFHEIV0(25:11)
 21135     CALL 'kxdfhei1' USING DFHEIV0
 21136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21137
 21138
 21139 5010-READ-NEXT-RECORD.
 21140
 21141* EXEC CICS HANDLE CONDITION
 21142*         NOTFND    (5050-NOT-FOUND)
 21143*    END-EXEC.
 21144*    MOVE '"$I                   ! S #00017874' TO DFHEIV0
 21145     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21147     MOVE X'5320233030303137383734' TO DFHEIV0(25:11)
 21148     CALL 'kxdfhei1' USING DFHEIV0
 21149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21150
 21151
 21152
 21153* EXEC CICS READ
 21154*         DATASET   (FILE-ID-ERPNDB)
 21155*         SET       (ADDRESS OF PENDING-BUSINESS)
 21156*         RIDFLD    (ERPNDB-KEY)
 21157*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 388
* EL6311.cbl
 21158*    END-EXEC.
 21159*    MOVE '&"S        G          (   #00017878' TO DFHEIV0
 21160     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21162     MOVE X'2020233030303137383738' TO DFHEIV0(25:11)
 21163     CALL 'kxdfhei1' USING DFHEIV0,
 21164           FILE-ID-ERPNDB,
 21165           DFHEIV20,
 21166           DFHEIV99,
 21167           ERPNDB-KEY,
 21168           DFHEIV99,
 21169           DFHEIV99,
 21170           DFHEIV99
 21171     SET ADDRESS OF PENDING-BUSINESS TO
 21172         DFHEIV20
 21173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21174
 21175
 21176     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21177         GO TO 5050-NOT-FOUND.
 21178
 21179     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21180
 21181     IF WS-BATCH-PREFIX = '#CL'
 21182         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21183         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21184         GO TO 5010-READ-NEXT-RECORD.
 21185
 21186     IF NOT PB-BATCH-TRAILER
 21187         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21188         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21189         GO TO 5010-READ-NEXT-RECORD.
 21190
 21191     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21192         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21193             NEXT SENTENCE
 21194         ELSE
 21195             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21196             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21197             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21198             GO TO 5010-READ-NEXT-RECORD.
 21199
 21200     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21201         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21202             NEXT SENTENCE
 21203        ELSE
 21204             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21205             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21206             GO TO 5010-READ-NEXT-RECORD.
 21207
 21208     IF EIBAID = DFHPF4
 21209        MOVE '0'                TO PI-EDIT-SW
 21210        GO TO 7200-DISPLAY-BATCHES.
 21211
 21212     IF PI-CSR-BROWSE
 21213        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21214           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21215           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 389
* EL6311.cbl
 21216           GO TO 5010-READ-NEXT-RECORD.
 21217
 21218     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21219       IF PI-PB-CARRIER    = SPACES AND
 21220          PI-PB-GROUPING   = SPACES AND
 21221          PI-PB-STATE      = SPACES AND
 21222          PI-PB-ACCOUNT    = SPACES
 21223            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21224            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21225            GO TO 7200-DISPLAY-BATCHES
 21226         ELSE
 21227           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21228              PI-PB-GROUPING   = PB-GROUPING AND
 21229              PI-PB-STATE      = PB-STATE    AND
 21230              PI-PB-ACCOUNT    = PB-ACCOUNT
 21231              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21232              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21233              GO TO 7200-DISPLAY-BATCHES.
 21234
 21235     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21236     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21237
 21238
 21239* EXEC CICS HANDLE CONDITION
 21240*         NOTFND    (5050-NOT-FOUND)
 21241*    END-EXEC.
 21242*    MOVE '"$I                   ! T #00017947' TO DFHEIV0
 21243     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21245     MOVE X'5420233030303137393437' TO DFHEIV0(25:11)
 21246     CALL 'kxdfhei1' USING DFHEIV0
 21247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21248
 21249
 21250
 21251* EXEC CICS READ
 21252*         DATASET   (FILE-ID-ERPNDB)
 21253*         SET       (ADDRESS OF PENDING-BUSINESS)
 21254*         RIDFLD    (ERPNDB-KEY)
 21255*         GTEQ
 21256*    END-EXEC.
 21257*    MOVE '&"S        G          (   #00017951' TO DFHEIV0
 21258     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21259     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21260     MOVE X'2020233030303137393531' TO DFHEIV0(25:11)
 21261     CALL 'kxdfhei1' USING DFHEIV0,
 21262           FILE-ID-ERPNDB,
 21263           DFHEIV20,
 21264           DFHEIV99,
 21265           ERPNDB-KEY,
 21266           DFHEIV99,
 21267           DFHEIV99,
 21268           DFHEIV99
 21269     SET ADDRESS OF PENDING-BUSINESS TO
 21270         DFHEIV20
 21271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21272
 21273
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 390
* EL6311.cbl
 21274     GO TO 5010-READ-NEXT-RECORD.
 21275
 21276 5050-NOT-FOUND.
 21277
 21278******************************************************************
 21279*                                                                *
 21280*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21281*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21282*         PROGRAM.                                               *
 21283*                                                                *
 21284******************************************************************
 21285
 21286     IF EIBTRNID NOT = TRANS-EXB1
 21287        IF PENDING-BUS-RECS-FOUND
 21288            NEXT SENTENCE
 21289          ELSE
 21290            MOVE '9'            TO PI-BROWSE-SW
 21291            GO TO 9400-CLEAR.
 21292
 21293     MOVE ER-2256                TO EMI-ERROR.
 21294     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21295
 21296     IF PI-MAP-NAME = SPACES
 21297        MOVE EL631D              TO PI-MAP-NAME
 21298        MOVE -1                  TO DPFENTRL
 21299        GO TO 8100-SEND-INITIAL-MAP.
 21300
 21301     IF PI-MAP-NAME = EL631B
 21302        MOVE -1                  TO BMAINTL
 21303     ELSE
 21304        IF PI-MAP-NAME = EL631C
 21305           MOVE -1               TO CMAINTL
 21306        ELSE
 21307           MOVE -1               TO DPFENTRL
 21308           GO TO 8200-SEND-DATAONLY.
 21309
 21310     GO TO 8100-SEND-INITIAL-MAP.
 21311
 21312     .
 21313 5100-PROCESS-POL-RESC.
 21314     MOVE ZEROS                  TO CG-LF-BENCD
 21315                                    CG-AH-BENCD
 21316                                    CG-LF-CAN-AMT
 21317                                    CG-AH-CAN-AMT
 21318     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21319                                    CG-AH-CAN-DT
 21320     MOVE SPACES                 TO CG-BATCH-NO
 21321     MOVE '4'                    TO CG-OPTION-CODE
 21322     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21323     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21324     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21325     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21326     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21327     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21328     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21329     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21330     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21331     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 391
* EL6311.cbl
 21332     MOVE PI-PREV-ALT-KEY (1:33)
 21333                                 TO CG-CERT-KEY
 21334     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21335     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21336                                    CG-AH-CAN-AMT
 21337     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21338                                    CG-AH-CAN-DT
 21339     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21340     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21341      display 'about to cancel ' cg-cert-key
 21342
 21343* EXEC CICS LINK
 21344*        PROGRAM  ('ELCANC')
 21345*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21346*    END-EXEC
 21347     MOVE LENGTH OF
 21348      CANCEL-GEN-PASS-AREA
 21349       TO DFHEIV11
 21350     MOVE 'ELCANC' TO DFHEIV1
 21351*    MOVE '."C                   (   #00018026' TO DFHEIV0
 21352     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21353     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21354     MOVE X'2020233030303138303236' TO DFHEIV0(25:11)
 21355     CALL 'kxdfhei1' USING DFHEIV0,
 21356           DFHEIV1,
 21357           CANCEL-GEN-PASS-AREA,
 21358           DFHEIV11,
 21359           DFHEIV99,
 21360           DFHEIV99,
 21361           DFHEIV99,
 21362           DFHEIV99
 21363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21364     IF CG-SUCCESS
 21365        CONTINUE
 21366     ELSE
 21367        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21368        MOVE '3'                 TO EMI-SWITCH1
 21369        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21370        EVALUATE TRUE
 21371           WHEN CG-DATE-ERROR
 21372             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21373           WHEN CG-CERT-NOT-FOUND
 21374             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21375           WHEN CG-AMOUNT-ERROR
 21376             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21377           WHEN CG-OPTION-ERROR
 21378             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21379           WHEN CG-PREV-CAN
 21380             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21381           WHEN CG-INVALID-DATA
 21382             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21383           WHEN CG-NO-ACCT-MSTR
 21384             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21385           WHEN CG-SFX-A-EXIST
 21386             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21387           WHEN CG-MISC-ERROR
 21388             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21389           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 392
* EL6311.cbl
 21390             MOVE ' ERROR - ELCANC - RETURN '
 21391                                 TO EMI-ERROR-TEXT (1) (12:25)
 21392        END-EVALUATE
 21393        GO TO 8200-SEND-DATAONLY
 21394     END-IF
 21395     .
 21396 5100-EXIT.
 21397     EXIT.
 21398
 21399******************************************************************
 21400*                                                                *
 21401*        B R O W S E   B A T C H   B A C K W A R D S             *
 21402*                                                                *
 21403******************************************************************
 21404
 21405 5500-BROWSE-BATCH-BACKWARD.
 21406
 21407* EXEC CICS HANDLE CONDITION
 21408*         NOTFND   (5550-END-RECORDS)
 21409*         ENDFILE  (5550-END-RECORDS)
 21410*    END-EXEC.
 21411*    MOVE '"$I''                  ! U #00018072' TO DFHEIV0
 21412     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21414     MOVE X'5520233030303138303732' TO DFHEIV0(25:11)
 21415     CALL 'kxdfhei1' USING DFHEIV0
 21416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21417
 21418
 21419 5505-START-BROWSE.
 21420     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21421     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21422     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21423
 21424
 21425* EXEC CICS STARTBR
 21426*         DATASET   (FILE-ID-ERPNDB)
 21427*         RIDFLD    (ERPNDB-ALT-KEY)
 21428*    END-EXEC.
 21429     MOVE 0
 21430       TO DFHEIV11
 21431*    MOVE '&,         G          &   #00018082' TO DFHEIV0
 21432     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21433     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21434     MOVE X'2020233030303138303832' TO DFHEIV0(25:11)
 21435     CALL 'kxdfhei1' USING DFHEIV0,
 21436           FILE-ID-ERPNDB,
 21437           ERPNDB-ALT-KEY,
 21438           DFHEIV99,
 21439           DFHEIV11,
 21440           DFHEIV99
 21441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21442
 21443
 21444     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21445
 21446
 21447* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 393
* EL6311.cbl
 21448*         DATASET    (FILE-ID-ERPNDB)
 21449*         SET        (ADDRESS OF PENDING-BUSINESS)
 21450*         RIDFLD     (ERPNDB-KEY)
 21451*    END-EXEC.
 21452     MOVE 0
 21453       TO DFHEIV11
 21454*    MOVE '&.S                   )   #00018089' TO DFHEIV0
 21455     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21456     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21457     MOVE X'2020233030303138303839' TO DFHEIV0(25:11)
 21458     CALL 'kxdfhei1' USING DFHEIV0,
 21459           FILE-ID-ERPNDB,
 21460           DFHEIV20,
 21461           DFHEIV99,
 21462           ERPNDB-KEY,
 21463           DFHEIV99,
 21464           DFHEIV11,
 21465           DFHEIV99,
 21466           DFHEIV99
 21467     SET ADDRESS OF PENDING-BUSINESS TO
 21468         DFHEIV20
 21469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21470
 21471
 21472
 21473* EXEC CICS READPREV
 21474*         DATASET    (FILE-ID-ERPNDB)
 21475*         SET        (ADDRESS OF PENDING-BUSINESS)
 21476*         RIDFLD     (ERPNDB-KEY)
 21477*    END-EXEC.
 21478     MOVE 0
 21479       TO DFHEIV11
 21480*    MOVE '&0S                   )   #00018095' TO DFHEIV0
 21481     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21482     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21483     MOVE X'2020233030303138303935' TO DFHEIV0(25:11)
 21484     CALL 'kxdfhei1' USING DFHEIV0,
 21485           FILE-ID-ERPNDB,
 21486           DFHEIV20,
 21487           DFHEIV99,
 21488           ERPNDB-KEY,
 21489           DFHEIV99,
 21490           DFHEIV11,
 21491           DFHEIV99,
 21492           DFHEIV99
 21493     SET ADDRESS OF PENDING-BUSINESS TO
 21494         DFHEIV20
 21495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21496
 21497
 21498
 21499* EXEC CICS READPREV
 21500*         DATASET    (FILE-ID-ERPNDB)
 21501*         SET        (ADDRESS OF PENDING-BUSINESS)
 21502*         RIDFLD     (ERPNDB-KEY)
 21503*    END-EXEC.
 21504     MOVE 0
 21505       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 394
* EL6311.cbl
 21506*    MOVE '&0S                   )   #00018101' TO DFHEIV0
 21507     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21508     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21509     MOVE X'2020233030303138313031' TO DFHEIV0(25:11)
 21510     CALL 'kxdfhei1' USING DFHEIV0,
 21511           FILE-ID-ERPNDB,
 21512           DFHEIV20,
 21513           DFHEIV99,
 21514           ERPNDB-KEY,
 21515           DFHEIV99,
 21516           DFHEIV11,
 21517           DFHEIV99,
 21518           DFHEIV99
 21519     SET ADDRESS OF PENDING-BUSINESS TO
 21520         DFHEIV20
 21521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21522
 21523
 21524     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21525        GO TO 5550-END-RECORDS.
 21526
 21527     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21528
 21529     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21530
 21531     IF  WS-BATCH-PREFIX = '#CL'
 21532             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21533
 21534* EXEC CICS ENDBR
 21535*                 DATASET  (FILE-ID-ERPNDB)
 21536*            END-EXEC
 21537     MOVE 0
 21538       TO DFHEIV11
 21539*    MOVE '&2                    $   #00018116' TO DFHEIV0
 21540     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21541     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21542     MOVE X'2020233030303138313136' TO DFHEIV0(25:11)
 21543     CALL 'kxdfhei1' USING DFHEIV0,
 21544           FILE-ID-ERPNDB,
 21545           DFHEIV11,
 21546           DFHEIV99
 21547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21548         GO TO 5505-START-BROWSE.
 21549
 21550     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21551         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21552             NEXT SENTENCE
 21553         ELSE
 21554             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21555
 21556* EXEC CICS ENDBR
 21557*                 DATASET  (FILE-ID-ERPNDB)
 21558*            END-EXEC
 21559     MOVE 0
 21560       TO DFHEIV11
 21561*    MOVE '&2                    $   #00018126' TO DFHEIV0
 21562     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21563     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 395
* EL6311.cbl
 21564     MOVE X'2020233030303138313236' TO DFHEIV0(25:11)
 21565     CALL 'kxdfhei1' USING DFHEIV0,
 21566           FILE-ID-ERPNDB,
 21567           DFHEIV11,
 21568           DFHEIV99
 21569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21570             GO TO 5505-START-BROWSE.
 21571
 21572
 21573     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21574         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21575             NEXT SENTENCE
 21576        ELSE
 21577             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21578
 21579* EXEC CICS ENDBR
 21580*                 DATASET  (FILE-ID-ERPNDB)
 21581*            END-EXEC
 21582     MOVE 0
 21583       TO DFHEIV11
 21584*    MOVE '&2                    $   #00018137' TO DFHEIV0
 21585     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21587     MOVE X'2020233030303138313337' TO DFHEIV0(25:11)
 21588     CALL 'kxdfhei1' USING DFHEIV0,
 21589           FILE-ID-ERPNDB,
 21590           DFHEIV11,
 21591           DFHEIV99
 21592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21593             GO TO 5505-START-BROWSE.
 21594
 21595     IF NOT PB-BATCH-TRAILER
 21596        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21597
 21598* EXEC CICS ENDBR
 21599*            DATASET  (FILE-ID-ERPNDB)
 21600*       END-EXEC
 21601     MOVE 0
 21602       TO DFHEIV11
 21603*    MOVE '&2                    $   #00018144' TO DFHEIV0
 21604     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21605     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21606     MOVE X'2020233030303138313434' TO DFHEIV0(25:11)
 21607     CALL 'kxdfhei1' USING DFHEIV0,
 21608           FILE-ID-ERPNDB,
 21609           DFHEIV11,
 21610           DFHEIV99
 21611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21612        GO TO 5505-START-BROWSE.
 21613
 21614     IF PI-CSR-BROWSE
 21615        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21616           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21617
 21618* EXEC CICS ENDBR
 21619*               DATASET  (FILE-ID-ERPNDB)
 21620*          END-EXEC
 21621     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 396
* EL6311.cbl
 21622       TO DFHEIV11
 21623*    MOVE '&2                    $   #00018152' TO DFHEIV0
 21624     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21625     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21626     MOVE X'2020233030303138313532' TO DFHEIV0(25:11)
 21627     CALL 'kxdfhei1' USING DFHEIV0,
 21628           FILE-ID-ERPNDB,
 21629           DFHEIV11,
 21630           DFHEIV99
 21631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21632           GO TO 5505-START-BROWSE.
 21633
 21634     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21635        IF PI-PB-CARRIER    = SPACES AND
 21636           PI-PB-GROUPING   = SPACES AND
 21637           PI-PB-STATE      = SPACES AND
 21638           PI-PB-ACCOUNT    = SPACES
 21639             GO TO 7200-DISPLAY-BATCHES
 21640          ELSE
 21641            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21642               PI-PB-GROUPING   = PB-GROUPING AND
 21643               PI-PB-STATE      = PB-STATE    AND
 21644               PI-PB-ACCOUNT    = PB-ACCOUNT
 21645                 GO TO 7200-DISPLAY-BATCHES.
 21646
 21647     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21648
 21649
 21650* EXEC CICS ENDBR
 21651*         DATASET  (FILE-ID-ERPNDB)
 21652*    END-EXEC.
 21653     MOVE 0
 21654       TO DFHEIV11
 21655*    MOVE '&2                    $   #00018172' TO DFHEIV0
 21656     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21657     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21658     MOVE X'2020233030303138313732' TO DFHEIV0(25:11)
 21659     CALL 'kxdfhei1' USING DFHEIV0,
 21660           FILE-ID-ERPNDB,
 21661           DFHEIV11,
 21662           DFHEIV99
 21663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21664
 21665
 21666     GO TO 5505-START-BROWSE.
 21667
 21668 5550-END-RECORDS.
 21669     MOVE ER-2257                TO EMI-ERROR.
 21670     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21671     MOVE -1                     TO DPFENTRL.
 21672
 21673     GO TO 8200-SEND-DATAONLY.
 21674
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 397
* EL6311.cbl
 21676
 21677******************************************************************
 21678*                                                                *
 21679*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21680*                                                                *
 21681******************************************************************
 21682
 21683 6000-CREATE-TEMP-STORAGE.
 21684
 21685
 21686* EXEC CICS HANDLE CONDITION
 21687*        QIDERR  (6050-QID-ERROR)
 21688*    END-EXEC.
 21689*    MOVE '"$N                   ! V #00018195' TO DFHEIV0
 21690     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21692     MOVE X'5620233030303138313935' TO DFHEIV0(25:11)
 21693     CALL 'kxdfhei1' USING DFHEIV0
 21694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21695
 21696
 21697
 21698* EXEC CICS WRITEQ TS
 21699*        QUEUE    (QID)
 21700*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21701*        LENGTH   (WS-COMM-LENGTH)
 21702*        ITEM     (W-ONE)
 21703*    END-EXEC.
 21704*    MOVE '*" I                  ''   #00018199' TO DFHEIV0
 21705     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21707     MOVE X'2020233030303138313939' TO DFHEIV0(25:11)
 21708     CALL 'kxdfhei1' USING DFHEIV0,
 21709           QID,
 21710           PROGRAM-INTERFACE-BLOCK,
 21711           WS-COMM-LENGTH,
 21712           W-ONE,
 21713           DFHEIV99,
 21714           DFHEIV99
 21715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21716
 21717
 21718 6000-EXIT.
 21719      EXIT.
 21720
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 398
* EL6311.cbl
 21722
 21723******************************************************************
 21724*                                                                *
 21725*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21726*                                                                *
 21727******************************************************************
 21728
 21729 6050-RECOVER-TEMP-STORAGE.
 21730     IF PGM-NAME = XCTL-EL6312
 21731        GO TO 6050-EXIT.
 21732
 21733     IF PGM-NAME = XCTL-EL6313
 21734        GO TO 6050-EXIT.
 21735
 21736     IF PGM-NAME = XCTL-EL6315
 21737         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21738     END-IF
 21739
 21740     IF PGM-NAME = XCTL-EL6316
 21741         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21742     END-IF
 21743
 21744
 21745* EXEC CICS HANDLE CONDITION
 21746*        QIDERR  (6050-QID-ERROR)
 21747*    END-EXEC.
 21748*    MOVE '"$N                   ! W #00018232' TO DFHEIV0
 21749     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21751     MOVE X'5720233030303138323332' TO DFHEIV0(25:11)
 21752     CALL 'kxdfhei1' USING DFHEIV0
 21753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21754
 21755
 21756
 21757* EXEC CICS READQ TS
 21758*         QUEUE   (QID)
 21759*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21760*         LENGTH  (WS-COMM-LENGTH)
 21761*         ITEM    (W-ONE)
 21762*     END-EXEC.
 21763*    MOVE '*$II   L              ''   #00018236' TO DFHEIV0
 21764     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21766     MOVE X'2020233030303138323336' TO DFHEIV0(25:11)
 21767     CALL 'kxdfhei1' USING DFHEIV0,
 21768           QID,
 21769           PROGRAM-INTERFACE-BLOCK,
 21770           WS-COMM-LENGTH,
 21771           W-ONE,
 21772           DFHEIV99,
 21773           DFHEIV99
 21774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21775
 21776
 21777 6050-DELETE-TEMP-STORAGE.
 21778
 21779
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 399
* EL6311.cbl
 21780* EXEC CICS DELETEQ TS
 21781*        QUEUE   (QID)
 21782*    END-EXEC.
 21783*    MOVE '*&                    #   #00018245' TO DFHEIV0
 21784     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21785     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21786     MOVE X'2020233030303138323435' TO DFHEIV0(25:11)
 21787     CALL 'kxdfhei1' USING DFHEIV0,
 21788           QID,
 21789           DFHEIV99
 21790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21791
 21792
 21793     GO TO 6050-EXIT.
 21794
 21795 6050-QID-ERROR.
 21796     MOVE ER-0033                TO EMI-ERROR
 21797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21798
 21799 6050-EXIT.
 21800      EXIT.
 21801
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 400
* EL6311.cbl
 21803
 21804******************************************************************
 21805*                                                                *
 21806*            T E R M   C O N V E R S I O N                       *
 21807*                                                                *
 21808******************************************************************
 21809
 21810 6100-TERM-CONVERSION.
 21811
 21812     IF PI-BPMTS = ZERO
 21813         GO TO 6199-EXIT.
 21814
 21815     IF PI-BMODE = ' ' OR 'M'
 21816         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21817         GO TO 6105-ROUND-TERM.
 21818
 21819     IF PI-BMODE = 'S'
 21820         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21821         GO TO 6105-ROUND-TERM.
 21822
 21823     IF PI-BMODE = 'W'
 21824         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21825         GO TO 6105-ROUND-TERM.
 21826
 21827     IF PI-BMODE = 'B'
 21828         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21829         GO TO 6105-ROUND-TERM.
 21830
 21831     IF PI-BMODE = 'T'
 21832         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21833
 21834 6105-ROUND-TERM.
 21835
 21836     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21837         ADD +1                  TO WS-CALC-TERM-WHOLE
 21838         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21839
 21840     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21841         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21842
 21843     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21844         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21845                                      WS-BTERM    (WS-SUB1)
 21846         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21847
 21848     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21849         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21850             MOVE -1               TO BMODEL
 21851             MOVE ER-2593          TO EMI-ERROR
 21852             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21853             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21854
 21855 6124-CHECK-BENEFIT.
 21856
 21857     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21858        GO TO 6126-COMPUTE-BENEFIT.
 21859
 21860     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 401
* EL6311.cbl
 21861
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 402
* EL6311.cbl
 21863******************************************************************
 21864**         COMPUTE TERM AND BENEFIT
 21865******************************************************************
 21866 6125-COMPUTE-TERM-BENEFIT.
 21867
 21868     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21869        PI-BPMTAMT = ZERO
 21870         GO TO 6199-EXIT.
 21871
 21872     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21873                                     WS-BTERM  (WS-SUB1).
 21874     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21875
 21876 6126-COMPUTE-BENEFIT.
 21877
 21878     IF PI-BMODE = 'M' OR  ' '
 21879         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21880
 21881     IF PI-BMODE = 'W'
 21882         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21883
 21884     IF PI-BMODE = 'S'
 21885         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21886
 21887     IF PI-BMODE = 'B'
 21888         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21889
 21890     IF PI-BMODE = 'T'
 21891         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21892
 21893     IF WS-SUB1 = +1
 21894        COMPUTE WS-BBEN (WS-SUB1) =
 21895                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21896
 21897     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21898     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21899     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21900
 21901 6199-EXIT.
 21902     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 403
* EL6311.cbl
 21904
 21905******************************************************************
 21906*                                                                *
 21907*             D I S P L A Y   I S S U E S                        *
 21908*                                                                *
 21909******************************************************************
 21910
 21911 6200-CREATE-VADS.
 21912     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21913     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21914     MOVE SPACES                 TO WS-PASS-VADS-REC
 21915
 21916* EXEC CICS GETMAIN
 21917*       SET      (ADDRESS OF PENDING-BUSINESS)
 21918*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21919*       INITIMG  (GETMAIN-SPACE)
 21920*       RESP     (WS-RESPONSE)
 21921*    END-EXEC
 21922*    MOVE ',"IL                  $  N#00018371' TO DFHEIV0
 21923     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21924     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21925     MOVE X'204E233030303138333731' TO DFHEIV0(25:11)
 21926     CALL 'kxdfhei1' USING DFHEIV0,
 21927           DFHEIV20,
 21928           ERPNDB-RECORD-LENGTH,
 21929           GETMAIN-SPACE
 21930     SET ADDRESS OF PENDING-BUSINESS TO
 21931         DFHEIV20
 21932     MOVE EIBRESP  TO WS-RESPONSE
 21933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21934
 21935* EXEC CICS READ
 21936*       INTO    (PENDING-BUSINESS)
 21937*       DATASET (FILE-ID-ERPNDB)
 21938*       RIDFLD  (ERPNDB-KEY)
 21939*       RESP    (WS-RESPONSE)
 21940*    END-EXEC
 21941     MOVE LENGTH OF
 21942      PENDING-BUSINESS
 21943       TO DFHEIV11
 21944*    MOVE '&"IL       E          (  N#00018377' TO DFHEIV0
 21945     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21946     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21947     MOVE X'204E233030303138333737' TO DFHEIV0(25:11)
 21948     CALL 'kxdfhei1' USING DFHEIV0,
 21949           FILE-ID-ERPNDB,
 21950           PENDING-BUSINESS,
 21951           DFHEIV11,
 21952           ERPNDB-KEY,
 21953           DFHEIV99,
 21954           DFHEIV99,
 21955           DFHEIV99
 21956     MOVE EIBRESP  TO WS-RESPONSE
 21957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21958     IF RESP-NORMAL
 21959        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21960        IF (RESP-NORMAL)
 21961           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 404
* EL6311.cbl
 21962              AM-CONTROL-PRIMARY (1:20))
 21963           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21964        ELSE
 21965           MOVE 'ACCOUNT NOT FOUND'
 21966                                 TO VD-ACCOUNT-NAME
 21967        END-IF
 21968        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21969                                    TO M1
 21970        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21971        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21972           (A2 > M1)
 21973           OR (WS-WORK-FIELD (A2:1) = '*')
 21974           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21975           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21976        END-PERFORM
 21977        IF A2 > M1
 21978           CONTINUE
 21979        ELSE
 21980           MOVE WS-WORK-FIELD (1:A2 - 1)
 21981                                    TO VD-ACCOUNT-NAME
 21982        END-IF
 21983        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21984        MOVE PB-CARRIER          TO VD-CARRIER
 21985        MOVE PB-GROUPING         TO VD-GROUPING
 21986        MOVE PB-STATE            TO VD-STATE
 21987        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21988        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21989        MOVE PB-CERT-NO          TO VD-CERT-NO
 21990        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21991        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21992        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21993        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21994        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21995        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21996        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21997        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21998        MOVE PB-CSR-ID           TO VD-CSR-ID
 21999        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22000        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22001        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22002        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22003        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22004        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22005        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22006        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22007        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22008        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22009        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22010        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22011        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22012     END-IF
 22013     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22014
 22015
 22016* EXEC CICS GETMAIN
 22017*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22018*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22019*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 405
* EL6311.cbl
 22020*       RESP     (WS-RESPONSE)
 22021*    END-EXEC
 22022*    MOVE ',"IL                  $  N#00018440' TO DFHEIV0
 22023     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22024     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22025     MOVE X'204E233030303138343430' TO DFHEIV0(25:11)
 22026     CALL 'kxdfhei1' USING DFHEIV0,
 22027           DFHEIV20,
 22028           ERPNDM-RECORD-LENGTH,
 22029           GETMAIN-SPACE
 22030     SET ADDRESS OF PENDING-MAILING-DATA TO
 22031         DFHEIV20
 22032     MOVE EIBRESP  TO WS-RESPONSE
 22033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22034
 22035
 22036* EXEC CICS READ
 22037*       INTO    (PENDING-MAILING-DATA)
 22038*       DATASET (FILE-ID-ERPNDM)
 22039*       RIDFLD  (ERPNDM-KEY)
 22040*       RESP    (WS-RESPONSE)
 22041*    END-EXEC
 22042     MOVE LENGTH OF
 22043      PENDING-MAILING-DATA
 22044       TO DFHEIV11
 22045*    MOVE '&"IL       E          (  N#00018447' TO DFHEIV0
 22046     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22048     MOVE X'204E233030303138343437' TO DFHEIV0(25:11)
 22049     CALL 'kxdfhei1' USING DFHEIV0,
 22050           FILE-ID-ERPNDM,
 22051           PENDING-MAILING-DATA,
 22052           DFHEIV11,
 22053           ERPNDM-KEY,
 22054           DFHEIV99,
 22055           DFHEIV99,
 22056           DFHEIV99
 22057     MOVE EIBRESP  TO WS-RESPONSE
 22058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22059
 22060     IF RESP-NORMAL
 22061        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22062        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22063        MOVE PM-CITY              TO VD-INSURED-CITY
 22064        MOVE PM-STATE             TO VD-INSURED-STATE
 22065        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22066     END-IF
 22067
 22068     MOVE 'VAC1'                  TO VD-LETTER-ID
 22069     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22070     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22071     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22072     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22073     MOVE +0                      TO VD-ARCHIVE-NO
 22074     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22075     .
 22076 6200-EXIT.
 22077     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 406
* EL6311.cbl
 22078 6210-READ-ERACCT.
 22079     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22080     MOVE LOW-VALUES             TO ERACCT-FILL
 22081
 22082* EXEC CICS READ
 22083*         DATASET   ('ERACCT')
 22084*         INTO      (ACCOUNT-MASTER)
 22085*         RIDFLD    (ERACCT-KEY)
 22086*         GTEQ
 22087*         RESP      (WS-RESPONSE)
 22088*    END-EXEC
 22089     MOVE LENGTH OF
 22090      ACCOUNT-MASTER
 22091       TO DFHEIV11
 22092     MOVE 'ERACCT' TO DFHEIV1
 22093*    MOVE '&"IL       G          (  N#00018475' TO DFHEIV0
 22094     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22095     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22096     MOVE X'204E233030303138343735' TO DFHEIV0(25:11)
 22097     CALL 'kxdfhei1' USING DFHEIV0,
 22098           DFHEIV1,
 22099           ACCOUNT-MASTER,
 22100           DFHEIV11,
 22101           ERACCT-KEY,
 22102           DFHEIV99,
 22103           DFHEIV99,
 22104           DFHEIV99
 22105     MOVE EIBRESP  TO WS-RESPONSE
 22106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22107     .
 22108 6210-EXIT.
 22109     EXIT.
 22110
 22111 6220-READ-ERMAIL.
 22112
 22113     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22114     MOVE ' '                    TO WS-ERMAIL-SW
 22115
 22116
 22117* EXEC CICS READ
 22118*       DATASET   (FILE-ID-ERMAIL)
 22119*       SET       (ADDRESS OF MAILING-DATA)
 22120*       RIDFLD    (ERMAIL-KEY)
 22121*       RESP      (WS-RESPONSE)
 22122*    END-EXEC
 22123*    MOVE '&"S        E          (  N#00018491' TO DFHEIV0
 22124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22126     MOVE X'204E233030303138343931' TO DFHEIV0(25:11)
 22127     CALL 'kxdfhei1' USING DFHEIV0,
 22128           FILE-ID-ERMAIL,
 22129           DFHEIV20,
 22130           DFHEIV99,
 22131           ERMAIL-KEY,
 22132           DFHEIV99,
 22133           DFHEIV99,
 22134           DFHEIV99
 22135     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 407
* EL6311.cbl
 22136         DFHEIV20
 22137     MOVE EIBRESP  TO WS-RESPONSE
 22138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22139
 22140     IF RESP-NORMAL
 22141        SET ERMAIL-FOUND TO TRUE
 22142     END-IF
 22143     .
 22144 6220-EXIT.
 22145     EXIT.
 22146
 22147 6400-CHECK-FOR-RES-REF-CLAIM.
 22148     display 'made it to 6400- for ' pi-cert-no
 22149     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22150
 22151     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22152                                    W-CL-COMP-CD.
 22153     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22154                                    W-CL-CERT-NO.
 22155     MOVE SPACES                 TO MSTR-CERT-SFX.
 22156
 22157
 22158* EXEC CICS HANDLE CONDITION
 22159*        NOTFND  (6400-CONTINUE)
 22160*        ENDFILE (6400-CONTINUE)
 22161*    END-EXEC.
 22162*    MOVE '"$I''                  ! X #00018515' TO DFHEIV0
 22163     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22165     MOVE X'5820233030303138353135' TO DFHEIV0(25:11)
 22166     CALL 'kxdfhei1' USING DFHEIV0
 22167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22168
 22169
 22170
 22171* EXEC CICS IGNORE CONDITION
 22172*        DUPKEY
 22173*    END-EXEC.
 22174*    MOVE '"*$                   !   #00018520' TO DFHEIV0
 22175     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22177     MOVE X'2020233030303138353230' TO DFHEIV0(25:11)
 22178     CALL 'kxdfhei1' USING DFHEIV0
 22179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22180
 22181
 22182
 22183* EXEC CICS STARTBR
 22184*        DATASET   (CLMS-ID)
 22185*        RIDFLD    (ELMSTR-KEY)
 22186*        GENERIC   EQUAL
 22187*        KEYLENGTH (ELMSTR-LENGTH)
 22188*    END-EXEC.
 22189     MOVE 0
 22190       TO DFHEIV11
 22191*    MOVE '&,   KG    E          &   #00018524' TO DFHEIV0
 22192     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22193     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 408
* EL6311.cbl
 22194     MOVE X'2020233030303138353234' TO DFHEIV0(25:11)
 22195     CALL 'kxdfhei1' USING DFHEIV0,
 22196           CLMS-ID,
 22197           ELMSTR-KEY,
 22198           ELMSTR-LENGTH,
 22199           DFHEIV11,
 22200           DFHEIV99
 22201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22202
 22203
 22204     display 'browse started'
 22205     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22206
 22207 6400-NEXT-CLAIM.
 22208
 22209
 22210* EXEC CICS READNEXT
 22211*        DATASET   (CLMS-ID)
 22212*        RIDFLD    (ELMSTR-KEY)
 22213*        SET       (ADDRESS OF CLAIM-MASTER)
 22214*    END-EXEC.
 22215     MOVE 0
 22216       TO DFHEIV11
 22217*    MOVE '&.S                   )   #00018536' TO DFHEIV0
 22218     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22219     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22220     MOVE X'2020233030303138353336' TO DFHEIV0(25:11)
 22221     CALL 'kxdfhei1' USING DFHEIV0,
 22222           CLMS-ID,
 22223           DFHEIV20,
 22224           DFHEIV99,
 22225           ELMSTR-KEY,
 22226           DFHEIV99,
 22227           DFHEIV11,
 22228           DFHEIV99,
 22229           DFHEIV99
 22230     SET ADDRESS OF CLAIM-MASTER TO
 22231         DFHEIV20
 22232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22233
 22234
 22235     display 'read claim for ' mstr-cert-no
 22236     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22237        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22238         GO TO 6400-CONTINUE
 22239     END-IF.
 22240
 22241     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22242        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22243        PI-STATE       NOT = CL-CERT-STATE     OR
 22244        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22245        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22246         GO TO 6400-NEXT-CLAIM
 22247     END-IF.
 22248
 22249     display 'found claim ' cl-claim-no
 22250        ' with denial type ' cl-denial-type
 22251     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 409
* EL6311.cbl
 22252         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22253         GO TO 6400-CONTINUE
 22254     END-IF.
 22255
 22256     GO TO 6400-NEXT-CLAIM.
 22257
 22258 6400-CONTINUE.
 22259
 22260     IF WS-BROWSE-STARTED-SW = 'Y'
 22261
 22262* EXEC CICS ENDBR
 22263*            DATASET   (CLMS-ID)
 22264*        END-EXEC
 22265     MOVE 0
 22266       TO DFHEIV11
 22267*    MOVE '&2                    $   #00018568' TO DFHEIV0
 22268     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22269     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22270     MOVE X'2020233030303138353638' TO DFHEIV0(25:11)
 22271     CALL 'kxdfhei1' USING DFHEIV0,
 22272           CLMS-ID,
 22273           DFHEIV11,
 22274           DFHEIV99
 22275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22276         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22277     END-IF.
 22278
 22279 6400-EXIT.
 22280     EXIT.
 22281
 22282 7000-DISPLAY-ISSUES.
 22283
 22284     IF PI-DISPLAY-ORIGINAL-BATCH
 22285        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22286        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22287     ELSE
 22288        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22289
 22290     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22291
 22292     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22293     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22294
 22295     MOVE LOW-VALUES                 TO EL631BI.
 22296     MOVE ZEROS                      TO PI-BPMTAMT
 22297                                        PI-BPMTS.
 22298     MOVE SPACE                      TO PI-BMODE
 22299                                        PI-BTYPE (1)
 22300                                        PI-BTYPE (2).
 22301     MOVE EL631B                     TO PI-MAP-NAME.
 22302     MOVE 'Y'                        TO PI-BROWSE-SW.
 22303     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22304                                        PI-HIGH-SEQ-NO.
 22305
 22306     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22307        MOVE AL-SABOF                TO BCHGTA
 22308        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22309        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 410
* EL6311.cbl
 22310     ELSE
 22311        MOVE AL-SADOF                TO BCHGTA
 22312                                        BCHGA
 22313        MOVE PB-CHG-COUNT            TO BCHGO.
 22314
 22315     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22316     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22317     MOVE WS-HR-MINS                 TO BMANTATO.
 22318
 22319     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22320        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22321        MOVE SPACE                   TO DC-OPTION-CODE
 22322        PERFORM 9700-DATE-LINK
 22323        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22324        MOVE 'INACTIVE'              TO BMOENDTO
 22325     ELSE
 22326        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22327        MOVE SPACE                   TO DC-OPTION-CODE
 22328        PERFORM 9700-DATE-LINK
 22329        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22330        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22331        MOVE SPACE                   TO DC-OPTION-CODE
 22332        PERFORM 9700-DATE-LINK
 22333        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22334
 22335*    MOVE PB-I-REFERENCE             TO BREFO.
 22336
 22337*    IF PI-COMPANY-ID EQUAL 'HER'
 22338*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22339*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22340*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22341*                MOVE WS-MEMBER-NO-1-8
 22342*                                TO  BMICRNOO.
 22343
 22344*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22345*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22346*            MOVE PB-I-MICROFILM-NO
 22347*                                TO  BMICRNOO.
 22348     IF PB-I-VIN NOT = SPACES
 22349        MOVE PB-I-VIN            TO BVINO
 22350     END-IF
 22351
 22352     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22353     MOVE PB-CERT-SFX                TO BSUFIXO.
 22354     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22355     MOVE SPACE                      TO DC-OPTION-CODE.
 22356     PERFORM 9700-DATE-LINK.
 22357     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22358
 22359     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22360     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22361     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22362     MOVE PB-I-INSURED-SEX           TO BSEXO
 22363
 22364     IF PB-I-AGE NOT = ZEROS
 22365         MOVE PB-I-AGE               TO BAGEO.
 22366
 22367     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 411
* EL6311.cbl
 22368                                 TO ELCERT-KEY
 22369     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22370     IF NOT CERT-TRL-REC-NOT-FOUND
 22371         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22372             MOVE 'AGE*'             TO BAGEDEFO
 22373         ELSE
 22374             MOVE 'AGE '             TO BAGEDEFO
 22375         END-IF
 22376     ELSE
 22377         MOVE 'AGE '             TO BAGEDEFO
 22378     END-IF
 22379
 22380     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22381         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22382         MOVE SPACE                  TO DC-OPTION-CODE
 22383         PERFORM 9700-DATE-LINK
 22384         IF NO-CONVERSION-ERROR
 22385            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22386
 22387     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22388         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22389         MOVE SPACE                  TO DC-OPTION-CODE
 22390         PERFORM 9700-DATE-LINK
 22391         IF NO-CONVERSION-ERROR
 22392            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22393
 22394     IF PB-I-EXTENTION-DAYS NUMERIC
 22395        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22396           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22397        ELSE
 22398           IF PB-I-TERM-IN-DAYS NUMERIC
 22399              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22400                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22401
 22402     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22403        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22404
 22405     MOVE PB-FORCE-CODE              TO BFORCEO.
 22406     MOVE PB-I-TERM-TYPE             TO BMODEO
 22407                                        PI-BMODE.
 22408
 22409     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22410        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22411
 22412     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22413         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22414                                        PI-BPMTS.
 22415
 22416     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22417         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22418           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22419                                        PI-BPMTAMT.
 22420
 22421     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22422     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22423     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22424     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22425     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 412
* EL6311.cbl
 22426     MOVE PB-I-SIG-SW                TO BSIGO.
 22427     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22428     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22429     MOVE PB-RECORD-BILL             TO BBILCDO.
 22430     MOVE PB-FORCE-CODE              TO BFORCEO.
 22431
 22432     IF (PB-I-LIVES NUMERIC)
 22433        AND (PB-I-LIVES > ZEROS)
 22434        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22435        IF (RESP-NORMAL)
 22436           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22437           CONTINUE
 22438        ELSE
 22439           MOVE PB-I-LIVES       TO BLIVESO
 22440        END-IF
 22441     END-IF
 22442
 22443     IF PB-I-NUM-BILLED NUMERIC AND
 22444        PB-I-NUM-BILLED GREATER THAN ZEROS
 22445        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22446*    ELSE
 22447*       MOVE ZEROS                   TO BBILLEDO.
 22448
 22449     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22450
 22451     IF PB-I-LOAN-APR NOT = +99.9999
 22452        MOVE PB-I-LOAN-APR           TO BAPRO.
 22453
 22454     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22455        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22456
 22457     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22458        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22459           MOVE AL-SANOF                TO BORIGHDA
 22460           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22461           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22462
 22463     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22464
 22465     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22466        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22467
 22468     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22469        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22470                                        PI-BTYPE (1).
 22471
 22472     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22473        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22474
 22475     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22476        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22477
 22478     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22479        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22480
 22481     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22482        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22483
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 413
* EL6311.cbl
 22484     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22485        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22486
 22487     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22488         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22489         MOVE SPACE                  TO DC-OPTION-CODE
 22490         PERFORM 9700-DATE-LINK
 22491         IF NO-CONVERSION-ERROR
 22492            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22493
 22494     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22495        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22496        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22497        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22498        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22499                 GIVING BDIFFO (1)
 22500     ELSE
 22501        MOVE SPACES                  TO BBEN-CD     (1)
 22502                                        BBEN-ABBR   (1).
 22503
 22504     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22505        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22506        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22507                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22508
 22509     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22510       IF PB-RECORD-ON-HOLD
 22511          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22512
 22513     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22514       IF PB-RECORD-RETURNED
 22515          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22516
 22517     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22518        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22519             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22520
 22521     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22522
 22523     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22524        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22525
 22526     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22527        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22528                                        PI-BTYPE (2).
 22529
 22530     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22531        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22532
 22533     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22534        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22535
 22536     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22537        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22538
 22539     IF PB-I-TOT-FEES NOT NUMERIC
 22540        MOVE ZEROS               TO PB-I-TOT-FEES
 22541     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 414
* EL6311.cbl
 22542     IF PB-I-TOT-FEES > ZEROS
 22543        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22544
 22545     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22546         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22547         MOVE SPACE                  TO DC-OPTION-CODE
 22548         PERFORM 9700-DATE-LINK
 22549         IF NO-CONVERSION-ERROR
 22550            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22551
 22552     IF PB-I-TOT-FEES > ZEROS
 22553        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22554        SUBTRACT PB-I-TOT-FEES FROM
 22555                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22556
 22557     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22558        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22559        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22560        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22561        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22562                 GIVING BDIFFO (2)
 22563     ELSE
 22564        MOVE SPACES                  TO BBEN-CD     (2)
 22565                                        BBEN-ABBR   (2).
 22566
 22567     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22568       IF PB-RECORD-ON-HOLD
 22569          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22570
 22571     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22572       IF PB-RECORD-RETURNED
 22573          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22574
 22575     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22576        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22577             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22578
 22579     MOVE PB-CSR-ID                  TO BCSRO.
 22580
 22581     IF PI-COMPANY-ID  =  'DMD'
 22582        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22583            NEXT SENTENCE
 22584        ELSE
 22585            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22586               MOVE 'NEW CERT'       TO BNCERTLI
 22587               MOVE EC-NEW-CERT      TO BNCERTO.
 22588
 22589     IF PI-COMPANY-ID  =  'DMD'
 22590        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22591            NEXT SENTENCE
 22592        ELSE
 22593           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22594               MOVE 'NEW STATE'      TO BNSTATLI
 22595               MOVE EC-NEW-STATE     TO BNSTATO.
 22596
 22597 7000-CONTINUE.
 22598     MOVE 'C'                        TO BMAINTI.
 22599     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 415
* EL6311.cbl
 22600
 22601     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22602        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22603
 22604     IF PI-6315-FINALIZED = 'Y'   AND
 22605        PB-UNFORCED-ERRORS
 22606          MOVE -1                TO BFORCEL
 22607          MOVE  1                TO SET-CURSOR-SW
 22608     END-IF
 22609
 22610     IF NO-CURSOR-SET
 22611        MOVE -1                      TO BMAINTL.
 22612
 22613     GO TO 8100-SEND-INITIAL-MAP.
 22614
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 416
* EL6311.cbl
 22616
 22617******************************************************************
 22618*                                                                *
 22619*             D I S P L A Y   C A N C E L S                      *
 22620*                                                                *
 22621******************************************************************
 22622
 22623 7100-DISPLAY-CANCELS.
 22624     IF PI-DISPLAY-ORIGINAL-BATCH
 22625        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22626        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22627     ELSE
 22628        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22629
 22630     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22631
 22632     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22633     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22634
 22635     MOVE LOW-VALUES                 TO EL631CI.
 22636     MOVE EL631C                     TO PI-MAP-NAME.
 22637     MOVE 'Y'                        TO PI-BROWSE-SW.
 22638     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22639                                        PI-HIGH-SEQ-NO.
 22640
 22641     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22642        MOVE AL-SABOF                TO CCHGTA
 22643        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22644        MOVE AL-SANON                TO CCHGA
 22645      ELSE
 22646        MOVE AL-SADOF                TO CCHGTA
 22647                                        CCHGA
 22648        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22649
 22650*    MOVE PB-C-REFERENCE             TO CREFO.
 22651
 22652*    IF PB-C-MICROFILM-NO IS NUMERIC
 22653*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22654*          MOVE PB-C-MICROFILM-NO
 22655*                                TO CMICRNOO
 22656*          MOVE AL-UNNON         TO CMICRNOA
 22657*       END-IF
 22658*    END-IF
 22659     IF PB-C-NH-INT-ON-REFS NUMERIC
 22660        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22661           MOVE PB-C-NH-INT-ON-REFS
 22662                                 TO CNHINTO
 22663           MOVE AL-SANOF         TO CNHINTA
 22664        END-IF
 22665     END-IF
 22666     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22667     MOVE PB-CERT-SFX                TO CSUFIXO.
 22668     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22669     MOVE SPACE                      TO DC-OPTION-CODE.
 22670     PERFORM 9700-DATE-LINK.
 22671     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22672
 22673     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 417
* EL6311.cbl
 22674        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22675        MOVE SPACE                   TO DC-OPTION-CODE
 22676        PERFORM 9700-DATE-LINK
 22677        IF NO-CONVERSION-ERROR
 22678           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22679
 22680     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22681        NEXT SENTENCE
 22682     ELSE
 22683        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22684
 22685     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22686        NEXT SENTENCE
 22687     ELSE
 22688        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22689
 22690     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22691        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22692        MOVE SPACE                   TO DC-OPTION-CODE
 22693        PERFORM 9700-DATE-LINK
 22694        IF NO-CONVERSION-ERROR
 22695           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22696
 22697     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22698         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22699
 22700     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22701         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22702
 22703     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22704        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22705        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22706                 GIVING CDRFND1O.
 22707
 22708     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22709        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22710        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22711                 GIVING CDRFND2O.
 22712
 22713     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22714       IF PB-RECORD-ON-HOLD
 22715          MOVE 'ON HOLD'             TO CBILIT1O.
 22716
 22717     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22718       IF PB-RECORD-RETURNED
 22719          MOVE 'RETURNED'            TO CBILIT1O.
 22720
 22721     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22722        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22723             MOVE 'OVERRIDE'         TO CBILIT1O.
 22724
 22725     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22726       IF PB-RECORD-ON-HOLD
 22727          MOVE 'ON HOLD'             TO CBILIT2O.
 22728
 22729     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22730       IF PB-RECORD-RETURNED
 22731          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 418
* EL6311.cbl
 22732
 22733     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22734        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22735             MOVE 'OVERRIDE'         TO CBILIT2O.
 22736
 22737     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22738     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22739     IF PB-C-POST-CARD-IND = 'Y'
 22740        MOVE 'Y'                     TO CPCYNO
 22741     ELSE
 22742        MOVE 'N'                     TO CPCYNO
 22743     END-IF
 22744     MOVE PB-FORCE-CODE              TO CFORCEO.
 22745     MOVE PB-RECORD-BILL             TO CBILCDO.
 22746     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22747     MOVE SPACES                     TO CINITSO.
 22748     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22749         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22750     ELSE
 22751         MOVE PB-CI-INITIALS         TO CINITSO
 22752     END-IF.
 22753
 22754     IF PB-CI-CANCEL-FEE NUMERIC
 22755        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22756        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22757     ELSE
 22758        MOVE ZEROES                  TO W-CANCEL-FEE.
 22759
 22760     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22761
 22762     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22763        ADD PB-CI-LF-PREMIUM-AMT
 22764             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22765
 22766     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22767        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22768
 22769     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22770     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22771     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22772     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22773
 22774     IF PB-C-LIVES NUMERIC
 22775        MOVE PB-C-LIVES              TO CLIVESO.
 22776
 22777     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22778        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22779
 22780     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22781        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22782        MOVE SPACE                   TO DC-OPTION-CODE
 22783        PERFORM 9700-DATE-LINK
 22784        IF NO-CONVERSION-ERROR
 22785           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22786
 22787     IF  PB-C-REFUND-CREATED
 22788         MOVE 'YES'                  TO CRFNDSWO
 22789     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 419
* EL6311.cbl
 22790         IF PB-C-REFUND-REQUESTED
 22791            MOVE 'REQ'               TO CRFNDSWO
 22792         ELSE
 22793            MOVE 'NO'                TO CRFNDSWO.
 22794
 22795     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22796     MOVE SPACE                      TO DC-OPTION-CODE.
 22797     PERFORM 9700-DATE-LINK.
 22798     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22799     MOVE PB-INPUT-BY                TO CENTBYO.
 22800
 22801     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22802        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22803        MOVE SPACE                   TO DC-OPTION-CODE
 22804        PERFORM 9700-DATE-LINK
 22805        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22806        MOVE 'INACTIVE'              TO CMOENDTO
 22807     ELSE
 22808        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22809        MOVE SPACE                   TO DC-OPTION-CODE
 22810        PERFORM 9700-DATE-LINK
 22811        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22812        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22813        MOVE SPACE                   TO DC-OPTION-CODE
 22814        PERFORM 9700-DATE-LINK
 22815        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22816
 22817     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22818
 22819     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22820     MOVE WS-HR-MINS                 TO CMANTATO.
 22821
 22822     EVALUATE PB-LF-REFUND-TYPE
 22823        WHEN '1'
 22824           MOVE 'RULE78'            TO CLFREFNO
 22825        WHEN '2'
 22826           MOVE 'PRORAT'            TO CLFREFNO
 22827        WHEN '3'
 22828           MOVE 'CALIF'             TO CLFREFNO
 22829        WHEN '4'
 22830           MOVE 'IRREG'             TO CLFREFNO
 22831        WHEN '5'
 22832           MOVE 'NETPAY'            TO CLFREFNO
 22833        WHEN '6'
 22834           MOVE 'ATCP'              TO CLFREFNO
 22835        WHEN '7'
 22836           MOVE 'UTAH'              TO CLFREFNO
 22837        WHEN '8'
 22838           MOVE 'MEAN'              TO CLFREFNO
 22839        WHEN '9'
 22840           MOVE 'SUM '              TO CLFREFNO
 22841        WHEN 'B'
 22842           MOVE 'BALN'              TO CLFREFNO
 22843     END-EVALUATE.
 22844
 22845     EVALUATE TRUE
 22846        WHEN PB-AH-REFUND-TYPE =  '1'
 22847           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 420
* EL6311.cbl
 22848        WHEN PB-AH-REFUND-TYPE =  '2'
 22849           MOVE 'PRORAT'            TO CAHREFNO
 22850        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22851           MOVE 'CALIF'             TO CAHREFNO
 22852        WHEN PB-AH-REFUND-TYPE =  '4'
 22853           MOVE 'IRREG'             TO CAHREFNO
 22854        WHEN PB-AH-REFUND-TYPE =  '5'
 22855           MOVE 'NETPAY'            TO CAHREFNO
 22856        WHEN PB-AH-REFUND-TYPE =  '6'
 22857           MOVE 'ATCP'              TO CAHREFNO
 22858        WHEN PB-AH-REFUND-TYPE =  '7'
 22859           MOVE 'UTAH'              TO CAHREFNO
 22860        WHEN PB-AH-REFUND-TYPE =  '8'
 22861           MOVE 'MEAN'              TO CAHREFNO
 22862        WHEN PB-AH-REFUND-TYPE =  '9'
 22863           MOVE 'SUM '              TO CAHREFNO
 22864        WHEN PB-AH-REFUND-TYPE =  'B'
 22865           MOVE 'BALN'              TO CAHREFNO
 22866     END-EVALUATE.
 22867
 22868     MOVE PB-REIN-CD                 TO CREINCDO.
 22869
 22870     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22871        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22872        MOVE SPACE                   TO DC-OPTION-CODE
 22873        PERFORM 9700-DATE-LINK
 22874        IF NO-CONVERSION-ERROR
 22875           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22876
 22877     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22878        MOVE 999999                  TO WS-EXP-DT-EDIT
 22879        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22880        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22881     ELSE
 22882        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22883           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22884           MOVE SPACE                   TO DC-OPTION-CODE
 22885           PERFORM 9700-DATE-LINK
 22886           IF NO-CONVERSION-ERROR
 22887              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22888
 22889     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22890        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22891           MOVE AL-SANOF                TO CORIGHDA
 22892           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22893           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22894
 22895     MOVE PB-CSR-ID              TO CCSRO.
 22896
 22897     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22898     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22899
 22900     MOVE 'C'                    TO CMAINTI.
 22901     MOVE AL-UANON               TO CMAINTA.
 22902
 22903     IF PI-6316-FINALIZED = 'Y'  AND
 22904        PB-UNFORCED-ERRORS
 22905          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 421
* EL6311.cbl
 22906          MOVE  1                TO SET-CURSOR-SW
 22907     END-IF
 22908
 22909     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22910        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22911
 22912     IF NO-CURSOR-SET
 22913        MOVE -1                  TO CMAINTL.
 22914
 22915     GO TO 8100-SEND-INITIAL-MAP.
 22916
 22917
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 422
* EL6311.cbl
 22919***************************************************************
 22920*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22921*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22922***************************************************************
 22923
 22924 7200-DISPLAY-BATCHES.
 22925     MOVE EL631D                 TO PI-MAP-NAME.
 22926     MOVE LOW-VALUES             TO EL631DI.
 22927
 22928     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22929
 22930
 22931* EXEC CICS HANDLE CONDITION
 22932*         NOTFND   (3690-NOT-FOUND)
 22933*    END-EXEC.
 22934*    MOVE '"$I                   ! Y #00019225' TO DFHEIV0
 22935     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22937     MOVE X'5920233030303139323235' TO DFHEIV0(25:11)
 22938     CALL 'kxdfhei1' USING DFHEIV0
 22939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22940
 22941
 22942     IF PI-DISPLAY-SCREEN
 22943        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22944     ELSE
 22945        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22946
 22947     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22948     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22949
 22950
 22951* EXEC CICS READ
 22952*         DATASET   (FILE-ID-ERPNDB)
 22953*         RIDFLD    (ERPNDB-KEY)
 22954*         SET       (ADDRESS OF PENDING-BUSINESS)
 22955*    END-EXEC.
 22956*    MOVE '&"S        E          (   #00019237' TO DFHEIV0
 22957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22959     MOVE X'2020233030303139323337' TO DFHEIV0(25:11)
 22960     CALL 'kxdfhei1' USING DFHEIV0,
 22961           FILE-ID-ERPNDB,
 22962           DFHEIV20,
 22963           DFHEIV99,
 22964           ERPNDB-KEY,
 22965           DFHEIV99,
 22966           DFHEIV99,
 22967           DFHEIV99
 22968     SET ADDRESS OF PENDING-BUSINESS TO
 22969         DFHEIV20
 22970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22971
 22972
 22973     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22974     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22975     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22976     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 423
* EL6311.cbl
 22977     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22978
 22979     MOVE EL631D                 TO PI-MAP-NAME.
 22980     MOVE LOW-VALUES             TO EL631DI.
 22981     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22982
 22983*    IF PI-AR-PROCESSING
 22984*       MOVE PB-REFERENCE        TO DREFO.
 22985
 22986     MOVE PB-CSR-ID              TO DCSRO.
 22987
 22988     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22989        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22990        MOVE SPACE               TO DC-OPTION-CODE
 22991        PERFORM 9700-DATE-LINK
 22992        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22993        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22994        MOVE 'INACTIVE'          TO DLDATEO
 22995     ELSE
 22996        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22997        MOVE SPACE               TO DC-OPTION-CODE
 22998        PERFORM 9700-DATE-LINK
 22999        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23000
 23001     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23002     MOVE SPACE                  TO DC-OPTION-CODE.
 23003     PERFORM 9700-DATE-LINK.
 23004     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23005
 23006     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23007        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23008     ELSE
 23009        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23010        MOVE SPACE               TO DC-OPTION-CODE
 23011        PERFORM 9700-DATE-LINK
 23012        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23013
 23014     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23015     MOVE SPACE                  TO DC-OPTION-CODE.
 23016     PERFORM 9700-DATE-LINK.
 23017     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23018
 23019     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23020     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23021
 23022     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23023        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23024                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23025
 23026     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23027     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23028     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23029
 23030     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23031        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23032                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23033
 23034     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 424
* EL6311.cbl
 23035     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23036     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23037
 23038     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23039        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23040                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23041
 23042     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23043     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23044
 23045     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23046        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23047                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23048
 23049     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23050     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23051     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23052
 23053     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23054        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23055                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23056
 23057     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23058     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23059     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23060
 23061     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23062        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23063                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23064
 23065     MOVE -1                     TO DPFENTRL.
 23066     GO TO 8100-SEND-INITIAL-MAP.
 23067
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 425
* EL6311.cbl
 23069
 23070***************************************************************
 23071*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23072*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23073*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23074*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23075*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23076*     ARE THEN SET ACCORDINGLY.                               *
 23077*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23078*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23079*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23080***************************************************************
 23081
 23082******************************************************************
 23083*                                                                *
 23084*            E R R O R   A N A L Y S I S                         *
 23085*                                                                *
 23086******************************************************************
 23087
 23088******************************************************************
 23089*                                                                *
 23090*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23091*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23092*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23093*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23094*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23095*                                                                *
 23096*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23097*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23098*                                                                *
 23099******************************************************************
 23100
 23101 7300-FORMAT-ERRORS.
 23102     MOVE ' '                    TO PI-ERRORS-SW
 23103     IF PB-COMMON-ERRORS = LOW-VALUES
 23104        IF PB-FATAL-ERRORS
 23105           MOVE ER-2695          TO EMI-ERROR
 23106           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23107           GO TO 7399-EXIT.
 23108
 23109     MOVE +0                     TO WS-SUB4.
 23110
 23111 7310-ERROR-LOOP.
 23112
 23113     ADD +1                      TO WS-SUB4.
 23114
 23115     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23116        GO TO 7350-SET-ERROR-FLAGS.
 23117
 23118     IF PI-COMPANY-ID = 'UCL'
 23119         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23120             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23121             MOVE ' '                   TO DC-OPTION-CODE
 23122             PERFORM 9700-DATE-LINK
 23123             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23124
 23125     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 23126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 426
* EL6311.cbl
 23127     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23128
 23129     GO TO 7310-ERROR-LOOP.
 23130
 23131
 23132 7350-SET-ERROR-FLAGS.
 23133
 23134     IF EMI-FATAL-CTR NOT = ZEROS
 23135        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23136        MOVE 'X'                 TO PB-FATAL-FLAG
 23137                                    PI-ERRORS-SW
 23138        GO TO 7355-SET-ERROR-FLAGS.
 23139
 23140     move ' ' to pi-unforced-sw
 23141     IF EMI-FORCABLE-CTR NOT = ZEROS
 23142        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23143        IF PB-ISSUE
 23144           IF PB-ISSUE-FORCE
 23145              MOVE 'F'           TO PB-FORCE-ER-CD
 23146              MOVE ER-2600       TO EMI-ERROR
 23147              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23148             ELSE
 23149              MOVE 'X'           TO PB-FORCE-ER-CD
 23150*                                   PI-ERRORS-SW
 23151          ELSE
 23152           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23153              MOVE 'F'           TO PB-FORCE-ER-CD
 23154                                    pi-unforced-sw
 23155              MOVE ER-2600       TO EMI-ERROR
 23156              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23157             ELSE
 23158              MOVE 'X'           TO PB-FORCE-ER-CD
 23159                                    pi-unforced-sw.
 23160*                                   PI-ERRORS-SW.
 23161
 23162     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23163     IF PB-ISSUE
 23164         MOVE 'I'                TO ENDT-RECORD-TYPE
 23165     ELSE
 23166         MOVE 'C'                TO ENDT-RECORD-TYPE
 23167     END-IF
 23168     MOVE +0                     TO ENDT-SEQ-NO
 23169
 23170
 23171* EXEC CICS READ
 23172*        DATASET   (FILE-ID-ERENDT)
 23173*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23174*        RIDFLD    (ERENDT-KEY)
 23175*        RESP      (WS-RESPONSE)
 23176*        GTEQ
 23177*    END-EXEC
 23178*    MOVE '&"S        G          (  N#00019440' TO DFHEIV0
 23179     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23181     MOVE X'204E233030303139343430' TO DFHEIV0(25:11)
 23182     CALL 'kxdfhei1' USING DFHEIV0,
 23183           FILE-ID-ERENDT,
 23184           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 427
* EL6311.cbl
 23185           DFHEIV99,
 23186           ERENDT-KEY,
 23187           DFHEIV99,
 23188           DFHEIV99,
 23189           DFHEIV99
 23190     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23191         DFHEIV20
 23192     MOVE EIBRESP  TO WS-RESPONSE
 23193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23194
 23195     IF RESP-NORMAL
 23196        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23197        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23198            MOVE ER-0280          TO EMI-ERROR
 23199            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23200            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23201            EVALUATE TRUE
 23202              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23203                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23204              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23205                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23206              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23207                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23208            END-EVALUATE
 23209        END-IF
 23210     END-IF
 23211
 23212
 23213
 23214     IF FIRST-ENTRY OR
 23215        EIBAID = DFHPF1 OR DFHPF2
 23216        MOVE '0'                TO PI-EDIT-SW
 23217        GO TO 7399-EXIT.
 23218
 23219 7355-SET-ERROR-FLAGS.
 23220
 23221     IF EMI-WARNING-CTR NOT = ZEROS
 23222        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23223        MOVE 'W'                 TO PB-WARN-ER-CD.
 23224
 23225     IF PB-UNFORCED-ERRORS OR
 23226        PB-FATAL-ERRORS    OR
 23227        PB-RECORD-ON-HOLD  OR
 23228        PB-RECORD-RETURNED OR
 23229        PB-CANCELLATION
 23230          NEXT SENTENCE
 23231        ELSE
 23232          GO TO 7399-EXIT.
 23233
 23234
 23235* EXEC CICS  HANDLE CONDITION
 23236*           NOTFND   (7399-EXIT)
 23237*    END-EXEC.
 23238*    MOVE '"$I                   ! Z #00019487' TO DFHEIV0
 23239     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23240     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23241     MOVE X'5A20233030303139343837' TO DFHEIV0(25:11)
 23242     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 428
* EL6311.cbl
 23243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23244
 23245
 23246     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23247     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23248     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23249     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23250
 23251
 23252* EXEC CICS READ
 23253*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23254*        DATASET (FILE-ID-ELCERT)
 23255*        RIDFLD  (ELCERT-KEY)
 23256*        UPDATE
 23257*    END-EXEC.
 23258*    MOVE '&"S        EU         (   #00019496' TO DFHEIV0
 23259     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23260     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23261     MOVE X'2020233030303139343936' TO DFHEIV0(25:11)
 23262     CALL 'kxdfhei1' USING DFHEIV0,
 23263           FILE-ID-ELCERT,
 23264           DFHEIV20,
 23265           DFHEIV99,
 23266           ELCERT-KEY,
 23267           DFHEIV99,
 23268           DFHEIV99,
 23269           DFHEIV99
 23270     SET ADDRESS OF CERTIFICATE-MASTER TO
 23271         DFHEIV20
 23272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23273
 23274
 23275
 23276     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23277     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23278
 23279     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23280        GO TO 7360-REWRITE-CERT-MASTER.
 23281
 23282     IF PB-ISSUE
 23283        IF PB-RECORD-RETURNED
 23284            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23285            GO TO 7360-REWRITE-CERT-MASTER
 23286        ELSE
 23287            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23288            GO TO 7360-REWRITE-CERT-MASTER.
 23289
 23290     IF PB-RECORD-RETURNED
 23291         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23292         GO TO 7360-REWRITE-CERT-MASTER.
 23293
 23294     IF (PB-C-LF-CANCEL-VOIDED)
 23295        or (pb-c-ah-cancel-voided)
 23296        IF (PB-UNFORCED-ERRORS OR
 23297            PB-FATAL-ERRORS    OR
 23298            PB-RECORD-ON-HOLD)
 23299            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23300            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 429
* EL6311.cbl
 23301        ELSE
 23302            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23303            GO TO 7360-REWRITE-CERT-MASTER.
 23304
 23305     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23306                            OR PB-RECORD-ON-HOLD)
 23307        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23308     ELSE
 23309        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23310
 23311 7360-REWRITE-CERT-MASTER.
 23312
 23313     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23314        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23315
 23316* EXEC CICS UNLOCK
 23317*            DATASET    (FILE-ID-ELCERT)
 23318*       END-EXEC
 23319*    MOVE '&*                    #   #00019543' TO DFHEIV0
 23320     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23321     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23322     MOVE X'2020233030303139353433' TO DFHEIV0(25:11)
 23323     CALL 'kxdfhei1' USING DFHEIV0,
 23324           FILE-ID-ELCERT,
 23325           DFHEIV99
 23326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23327        GO TO 7399-EXIT.
 23328
 23329
 23330* EXEC CICS REWRITE
 23331*         DATASET    (FILE-ID-ELCERT)
 23332*         FROM       (CERTIFICATE-MASTER)
 23333*    END-EXEC.
 23334     MOVE LENGTH OF
 23335      CERTIFICATE-MASTER
 23336       TO DFHEIV11
 23337*    MOVE '&& L                  %   #00019548' TO DFHEIV0
 23338     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23339     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23340     MOVE X'2020233030303139353438' TO DFHEIV0(25:11)
 23341     CALL 'kxdfhei1' USING DFHEIV0,
 23342           FILE-ID-ELCERT,
 23343           CERTIFICATE-MASTER,
 23344           DFHEIV11,
 23345           DFHEIV99
 23346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23347
 23348
 23349 7399-EXIT.
 23350      EXIT.
 23351
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 430
* EL6311.cbl
 23353
 23354*************************************************************
 23355*                                                           *
 23356*              S E T   A T T R I B U T E S                  *
 23357*                                                           *
 23358*************************************************************
 23359
 23360 7400-SET-ATTRIBUTES.
 23361
 23362     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23363        GO TO 7499-EXIT.
 23364
 23365**2601**
 23366
 23367     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23368        IF PB-ISSUE
 23369           MOVE AL-UABON         TO BEFFDTA
 23370           GO TO 7499-EXIT
 23371         ELSE
 23372           MOVE AL-UABON         TO CEFFDTA
 23373           GO TO 7499-EXIT.
 23374
 23375**2604**
 23376
 23377     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23378        IF PB-ISSUE
 23379           MOVE AL-UABON         TO BTYPE1A
 23380           MOVE -1               TO BTYPE1L
 23381           MOVE  1               TO SET-CURSOR-SW
 23382           GO TO 7499-EXIT.
 23383
 23384**2605**
 23385
 23386     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23387        IF PB-ISSUE
 23388           MOVE AL-UABON         TO BTYPE2A
 23389           MOVE -1               TO BTYPE2L
 23390           MOVE  1               TO SET-CURSOR-SW
 23391           GO TO 7499-EXIT.
 23392
 23393**2606**
 23394
 23395     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23396        IF PB-ISSUE
 23397           MOVE AL-UABON         TO BSIGA
 23398           MOVE -1               TO BSIGL
 23399           MOVE  1               TO SET-CURSOR-SW
 23400           GO TO 7499-EXIT.
 23401
 23402**2607**
 23403
 23404     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23405        IF PB-ISSUE
 23406           MOVE AL-UABON         TO BSIGA
 23407           MOVE -1               TO BSIGL
 23408           MOVE  1               TO SET-CURSOR-SW
 23409           GO TO 7499-EXIT.
 23410
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 431
* EL6311.cbl
 23411**2615**
 23412
 23413     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23414        IF PB-ISSUE
 23415           MOVE AL-UABOF         TO BREINA
 23416           MOVE -1               TO BREINL
 23417           GO TO 7499-EXIT.
 23418
 23419**2622**
 23420
 23421     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23422        IF PB-ISSUE
 23423           MOVE AL-UABON         TO BEFFDTA
 23424           GO TO 7499-EXIT
 23425        ELSE
 23426           MOVE AL-UABON         TO CEFFDTA
 23427           GO TO 7499-EXIT.
 23428
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 432
* EL6311.cbl
 23430
 23431*************************************************************
 23432*                                                           *
 23433*              I S S U E   E R R O R S                      *
 23434*                                                           *
 23435*************************************************************
 23436
 23437 7420-ISSUE-ERRORS.
 23438
 23439**2626**
 23440
 23441     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23442        MOVE AL-UABON            TO BCERTNOA
 23443        GO TO 7499-EXIT.
 23444
 23445**2627**
 23446
 23447     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23448        MOVE AL-UNBON            TO BAGEA
 23449        MOVE -1                  TO BAGEL
 23450        MOVE  1                  TO SET-CURSOR-SW
 23451        GO TO 7499-EXIT.
 23452
 23453**2628**
 23454
 23455     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23456        MOVE AL-UNBON            TO BAGEA
 23457        MOVE -1                  TO BAGEL
 23458        MOVE  1                  TO SET-CURSOR-SW
 23459        GO TO 7499-EXIT.
 23460
 23461**2629**
 23462
 23463     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23464        MOVE AL-UABON            TO BSEXA
 23465        MOVE -1                  TO BSEXL
 23466        MOVE  1                  TO SET-CURSOR-SW
 23467        GO TO 7499-EXIT.
 23468
 23469**2630**
 23470
 23471     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23472        MOVE -1                  TO BTYPE1L
 23473        MOVE  1                  TO SET-CURSOR-SW
 23474        GO TO 7499-EXIT.
 23475
 23476**2631**
 23477
 23478     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23479        MOVE -1                  TO BTYPE1L
 23480        MOVE  1                  TO SET-CURSOR-SW
 23481        GO TO 7499-EXIT.
 23482
 23483**2632**
 23484
 23485     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23486        MOVE AL-UNBON            TO BBEN1A
 23487        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 433
* EL6311.cbl
 23488        MOVE  1                  TO SET-CURSOR-SW
 23489        GO TO 7499-EXIT.
 23490
 23491**2633**
 23492
 23493     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23494        MOVE AL-UNBON            TO BPREM1A
 23495        MOVE -1                  TO BPREM1L
 23496        MOVE  1                  TO SET-CURSOR-SW
 23497        GO TO 7499-EXIT.
 23498
 23499**2634**
 23500
 23501     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23502        MOVE -1                  TO BTYPE2L
 23503        MOVE  1                  TO SET-CURSOR-SW
 23504        GO TO 7499-EXIT.
 23505
 23506**2635**
 23507
 23508     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23509        MOVE AL-UNBON            TO BBEN2A
 23510        MOVE -1                  TO BBEN2L
 23511        MOVE  1                  TO SET-CURSOR-SW
 23512        GO TO 7499-EXIT.
 23513
 23514**2636**
 23515
 23516     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23517        MOVE AL-UNBON            TO BPREM2A
 23518        MOVE -1                  TO BPREM2L
 23519        MOVE  1                  TO SET-CURSOR-SW
 23520        GO TO 7499-EXIT.
 23521
 23522**2639**
 23523
 23524     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23525        MOVE AL-UNBON            TO BBEN1A
 23526        MOVE -1                  TO BBEN1L
 23527        MOVE  1                  TO SET-CURSOR-SW
 23528        GO TO 7499-EXIT.
 23529
 23530**2640**
 23531
 23532     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23533        MOVE AL-UNBON            TO BBEN2A
 23534        MOVE -1                  TO BBEN2L
 23535        MOVE  1                  TO SET-CURSOR-SW
 23536        GO TO 7499-EXIT.
 23537
 23538**2647**
 23539
 23540     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23541        MOVE AL-UNBON            TO BTERM1A
 23542        MOVE -1                  TO BTERM1L
 23543        MOVE  1                  TO SET-CURSOR-SW
 23544        GO TO 7499-EXIT.
 23545
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 434
* EL6311.cbl
 23546**2648**
 23547
 23548     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23549        MOVE AL-UNBON            TO BLNTRMA
 23550        MOVE -1                  TO BLNTRML
 23551        MOVE  1                  TO SET-CURSOR-SW
 23552        GO TO 7499-EXIT.
 23553
 23554**2649**
 23555
 23556     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23557        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23558            MOVE AL-UNBON            TO BPREM1A
 23559            MOVE -1                  TO BPREM1L
 23560            MOVE  1                  TO SET-CURSOR-SW
 23561            GO TO 7499-EXIT
 23562     ELSE
 23563        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23564           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23565            MOVE AL-UNBON            TO BPREM2A
 23566            MOVE -1                  TO BPREM2L
 23567            MOVE  1                  TO SET-CURSOR-SW
 23568            GO TO 7499-EXIT.
 23569
 23570**2650**
 23571
 23572     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23573        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23574            MOVE AL-UNBON        TO BPREM1A
 23575            MOVE -1              TO BPREM1L
 23576            MOVE  1              TO SET-CURSOR-SW
 23577            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23578                MOVE AL-UNBON        TO BPREM2A
 23579                MOVE -1              TO BPREM2L
 23580                MOVE  1              TO SET-CURSOR-SW
 23581                GO TO 7499-EXIT
 23582            ELSE
 23583                GO TO 7499-EXIT
 23584        ELSE
 23585            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23586                MOVE AL-UNBON        TO BPREM2A
 23587                MOVE -1              TO BPREM2L
 23588                MOVE  1              TO SET-CURSOR-SW
 23589                GO TO 7499-EXIT
 23590            ELSE
 23591                GO TO 7499-EXIT.
 23592
 23593**2651**
 23594
 23595     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23596        MOVE AL-UABON            TO BSIGA
 23597        MOVE -1                  TO BSIGL
 23598        MOVE  1                  TO SET-CURSOR-SW
 23599        GO TO 7499-EXIT.
 23600
 23601**2653**
 23602
 23603     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 435
* EL6311.cbl
 23604        MOVE AL-UABON            TO BFREQA
 23605        MOVE -1                  TO BFREQL
 23606        MOVE  1                  TO SET-CURSOR-SW
 23607        GO TO 7499-EXIT.
 23608
 23609**2654**
 23610
 23611     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23612        MOVE AL-UABON            TO BFREQA
 23613        MOVE -1                  TO BFREQL
 23614        MOVE  1                  TO SET-CURSOR-SW
 23615        GO TO 7499-EXIT.
 23616
 23617**2655**
 23618
 23619     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23620        MOVE AL-UABON            TO BFREQA
 23621        MOVE -1                  TO BFREQL
 23622        MOVE  1                  TO SET-CURSOR-SW
 23623        GO TO 7499-EXIT.
 23624
 23625**2656**
 23626
 23627     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23628        MOVE AL-UNBON            TO BAPRA
 23629        MOVE -1                  TO BAPRL
 23630        MOVE  1                  TO SET-CURSOR-SW
 23631        GO TO 7499-EXIT.
 23632
 23633**2657**
 23634
 23635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23636        MOVE AL-UNBON            TO BAPRA
 23637        MOVE -1                  TO BAPRL
 23638        MOVE  1                  TO SET-CURSOR-SW
 23639        GO TO 7499-EXIT.
 23640
 23641**2658**
 23642
 23643     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23644        MOVE AL-UNBON            TO BTERM2A
 23645        MOVE -1                  TO BTERM2L
 23646        MOVE  1                  TO SET-CURSOR-SW
 23647        GO TO 7499-EXIT.
 23648
 23649**2660**
 23650
 23651     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23652        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23653        MOVE -1                  TO BLSTNML
 23654        MOVE  1                  TO SET-CURSOR-SW
 23655        GO TO 7499-EXIT.
 23656
 23657
 23658**2662**
 23659
 23660     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23661        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 436
* EL6311.cbl
 23662        MOVE -1                  TO BAGEL
 23663        MOVE  1                  TO SET-CURSOR-SW
 23664        GO TO 7499-EXIT.
 23665
 23666**2663**
 23667
 23668     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23669        MOVE AL-UNBON            TO BAGEA
 23670        MOVE -1                  TO BAGEL
 23671        MOVE  1                  TO SET-CURSOR-SW
 23672        GO TO 7499-EXIT.
 23673
 23674**2664**
 23675
 23676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23677        MOVE AL-UABON            TO BREINA
 23678        MOVE -1                  TO BREINL
 23679        MOVE  1                  TO SET-CURSOR-SW
 23680        GO TO 7499-EXIT.
 23681
 23682**2667**
 23683
 23684     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23685        MOVE AL-UNBON            TO BBEN2A
 23686        MOVE -1                  TO BBEN2L
 23687        MOVE  1                  TO SET-CURSOR-SW
 23688        GO TO 7499-EXIT.
 23689
 23690**2668**
 23691
 23692     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23693        MOVE AL-UABON            TO BEFFDTA
 23694        GO TO 7499-EXIT.
 23695
 23696**2669**
 23697
 23698     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23699       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23700       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23701        MOVE AL-UNBON            TO BAGEA
 23702        MOVE -1                  TO BAGEL
 23703        MOVE  1                  TO SET-CURSOR-SW
 23704        GO TO 7499-EXIT.
 23705
 23706**2670**
 23707
 23708     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23709        MOVE AL-UABON            TO BFORCEA
 23710        MOVE -1                  TO BFORCEL
 23711        MOVE  1                  TO SET-CURSOR-SW
 23712        GO TO 7499-EXIT.
 23713
 23714**2671**
 23715
 23716     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23717        MOVE AL-UABON            TO BEFFDTA
 23718        GO TO 7499-EXIT.
 23719
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 437
* EL6311.cbl
 23720**2672**
 23721
 23722     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23723        MOVE AL-UABON            TO BEFFDTA
 23724        GO TO 7499-EXIT.
 23725
 23726**2673**
 23727
 23728     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23729        MOVE AL-UABON            TO BEFFDTA
 23730        GO TO 7499-EXIT.
 23731
 23732**2674**
 23733
 23734     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23735        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23736        MOVE -1                  TO BTYPE1L
 23737        MOVE  1                  TO SET-CURSOR-SW
 23738        GO TO 7499-EXIT.
 23739
 23740**2677**
 23741
 23742     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23743        MOVE AL-UNBON            TO BTERM1A
 23744        MOVE -1                  TO BTERM1L
 23745        MOVE  1                  TO SET-CURSOR-SW
 23746        GO TO 7499-EXIT.
 23747
 23748**2678**
 23749
 23750     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23751        MOVE AL-UNBON            TO BTERM2A
 23752        MOVE -1                  TO BTERM2L
 23753        MOVE  1                  TO SET-CURSOR-SW
 23754        GO TO 7499-EXIT.
 23755
 23756**2679**
 23757
 23758     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23759        MOVE AL-UABON            TO BTYPE1A
 23760        MOVE -1                  TO BTYPE1L
 23761        MOVE  1                  TO SET-CURSOR-SW
 23762        GO TO 7499-EXIT.
 23763
 23764**2680**
 23765
 23766     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23767        MOVE AL-UABOF            TO B1STPMTA
 23768        MOVE -1                  TO B1STPMTL
 23769        MOVE  1                  TO SET-CURSOR-SW
 23770        GO TO 7499-EXIT.
 23771
 23772**2681**
 23773
 23774     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23775        MOVE AL-UABON            TO BDAYSA
 23776        MOVE -1                  TO BDAYSL
 23777        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 438
* EL6311.cbl
 23778        GO TO 7499-EXIT.
 23779
 23780**2682**
 23781
 23782     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23783        MOVE AL-UABON            TO BTERM1A
 23784        MOVE -1                  TO BTERM1L
 23785        MOVE  1                  TO SET-CURSOR-SW
 23786        GO TO 7499-EXIT.
 23787
 23788**2683**
 23789
 23790     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23791        MOVE AL-UABON            TO BSKPCDA
 23792        MOVE -1                  TO BSKPCDL
 23793        MOVE  1                  TO SET-CURSOR-SW
 23794        GO TO 7499-EXIT.
 23795
 23796**2684**
 23797
 23798     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23799        MOVE AL-UABON            TO BTYPE2A
 23800        MOVE -1                  TO BTYPE2L
 23801        MOVE  1                  TO SET-CURSOR-SW
 23802        GO TO 7499-EXIT.
 23803
 23804**2686**
 23805
 23806     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23807        MOVE AL-UABON            TO BTYPE2A
 23808        MOVE -1                  TO BTYPE2L
 23809        MOVE  1                  TO SET-CURSOR-SW
 23810        GO TO 7499-EXIT.
 23811
 23812**2689**
 23813
 23814     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23815        MOVE AL-UABON            TO BSIGA
 23816        MOVE -1                  TO BSIGL
 23817        MOVE  1                  TO SET-CURSOR-SW
 23818        GO TO 7499-EXIT.
 23819
 23820**2690**
 23821
 23822     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23823        MOVE AL-UABOF            TO BLNOFCRA
 23824        MOVE -1                  TO BLNOFCRL
 23825        MOVE  1                  TO SET-CURSOR-SW
 23826        GO TO 7499-EXIT.
 23827
 23828**2693**
 23829
 23830     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23831        MOVE AL-UABOF            TO BLNOFCRA
 23832        MOVE AL-UNBON            TO BBEN1A
 23833        MOVE -1                  TO BBEN1L
 23834        MOVE  1                  TO SET-CURSOR-SW
 23835        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 439
* EL6311.cbl
 23836
 23837**2720**
 23838
 23839     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23840        MOVE AL-UNBON            TO BBEN1A
 23841        MOVE -1                  TO BBEN1L
 23842        MOVE  1                  TO SET-CURSOR-SW
 23843        GO TO 7499-EXIT.
 23844
 23845**2709**
 23846
 23847*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23848*       MOVE AL-UNBON            TO BBEN1A
 23849*       MOVE -1                  TO BBEN1L
 23850*       MOVE  1                  TO SET-CURSOR-SW
 23851*       GO TO 7499-EXIT.
 23852
 23853*************************************************************
 23854*                                                           *
 23855*            C A N C E L   E R R O R S                      *
 23856*                                                           *
 23857*************************************************************
 23858
 23859**2726**
 23860
 23861     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23862        MOVE AL-UABON            TO CCERTNOA
 23863        GO TO 7499-EXIT.
 23864
 23865**2728**
 23866
 23867     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23868        MOVE AL-UABON            TO CCERTNOA
 23869        GO TO 7499-EXIT.
 23870
 23871**2729**
 23872
 23873     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23874        MOVE AL-UABON            TO CCERTNOA
 23875        GO TO 7499-EXIT.
 23876
 23877**2730**
 23878
 23879     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23880        MOVE AL-UABON            TO CCERTNOA
 23881        GO TO 7499-EXIT.
 23882
 23883**2731**
 23884
 23885     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23886        MOVE AL-UABON            TO CCANDT1A
 23887        MOVE -1                  TO CCANDT1L
 23888        MOVE  1                  TO SET-CURSOR-SW
 23889        GO TO 7499-EXIT.
 23890
 23891**2732**
 23892
 23893     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 440
* EL6311.cbl
 23894        MOVE AL-UABON            TO CCANDT1A
 23895        MOVE -1                  TO CCANDT1L
 23896        MOVE  1                  TO SET-CURSOR-SW
 23897        GO TO 7499-EXIT.
 23898
 23899**2733**
 23900
 23901     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23902        MOVE AL-UABON            TO CCANDT1A
 23903        MOVE -1                  TO CCANDT1L
 23904        MOVE  1                  TO SET-CURSOR-SW
 23905        GO TO 7499-EXIT.
 23906
 23907**2734**
 23908
 23909     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23910        MOVE AL-UNBON            TO CREFND1A
 23911        MOVE -1                  TO CREFND1L
 23912        MOVE  1                  TO SET-CURSOR-SW
 23913        GO TO 7499-EXIT.
 23914
 23915**2735**
 23916
 23917     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23918        MOVE AL-UABON            TO CCANDT2A
 23919        MOVE -1                  TO CCANDT2L
 23920        MOVE  1                  TO SET-CURSOR-SW
 23921        GO TO 7499-EXIT.
 23922
 23923**2736**
 23924
 23925     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23926        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23927            MOVE AL-UNBON        TO CREFND1A
 23928            MOVE -1              TO CREFND1L
 23929            MOVE  1              TO SET-CURSOR-SW
 23930            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23931                MOVE AL-UNBON        TO CREFND2A
 23932                MOVE -1              TO CREFND2L
 23933                MOVE  1              TO SET-CURSOR-SW
 23934                GO TO 7499-EXIT
 23935            ELSE
 23936                GO TO 7499-EXIT
 23937        ELSE
 23938            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23939                MOVE AL-UNBON        TO CREFND2A
 23940                MOVE -1              TO CREFND2L
 23941                MOVE  1              TO SET-CURSOR-SW
 23942                GO TO 7499-EXIT
 23943            ELSE
 23944                GO TO 7499-EXIT.
 23945
 23946**2738**
 23947
 23948     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23949        MOVE -1                  TO CREFND2L
 23950        MOVE  1                  TO SET-CURSOR-SW
 23951        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 441
* EL6311.cbl
 23952
 23953**2739**
 23954
 23955     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23956        MOVE -1                  TO CREFND1L
 23957        MOVE  1                  TO SET-CURSOR-SW
 23958        GO TO 7499-EXIT.
 23959
 23960**2741**
 23961
 23962     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23963        MOVE -1                  TO CREFND1L
 23964        MOVE  1                  TO SET-CURSOR-SW
 23965        GO TO 7499-EXIT.
 23966
 23967**2743**
 23968
 23969     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23970        MOVE AL-UNBON            TO CCANDT1A
 23971        MOVE -1                  TO CCANDT1L
 23972        MOVE  1                  TO SET-CURSOR-SW
 23973        GO TO 7499-EXIT.
 23974
 23975**2744**
 23976
 23977     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23978        MOVE AL-UNBON            TO CCANDT2A
 23979        MOVE -1                  TO CCANDT2L
 23980        MOVE  1                  TO SET-CURSOR-SW
 23981        GO TO 7499-EXIT.
 23982
 23983**2747**
 23984
 23985     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23986        MOVE AL-UABON            TO CLSTNMA
 23987        MOVE -1                  TO CLSTNML
 23988        MOVE  1                  TO SET-CURSOR-SW
 23989        GO TO 7499-EXIT.
 23990
 23991**2749**
 23992
 23993     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23994        MOVE AL-UABON            TO CFORCEA
 23995        MOVE -1                  TO CFORCEL
 23996        MOVE  1                  TO SET-CURSOR-SW
 23997        GO TO 7499-EXIT.
 23998
 23999**2753**
 24000
 24001     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24002        MOVE AL-UNBON            TO CCANDT1A
 24003        MOVE -1                  TO CCANDT1L
 24004        MOVE  1                  TO SET-CURSOR-SW
 24005        GO TO 7499-EXIT.
 24006
 24007**2755**
 24008
 24009     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 442
* EL6311.cbl
 24010        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24011            MOVE AL-UNBON        TO CREFND1A
 24012            MOVE -1              TO CREFND1L
 24013            MOVE  1              TO SET-CURSOR-SW
 24014            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24015                MOVE AL-UNBON        TO CREFND2A
 24016                MOVE -1              TO CREFND2L
 24017                MOVE  1              TO SET-CURSOR-SW
 24018                GO TO 7499-EXIT
 24019            ELSE
 24020                GO TO 7499-EXIT
 24021        ELSE
 24022            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24023                MOVE AL-UNBON        TO CREFND2A
 24024                MOVE -1              TO CREFND2L
 24025                MOVE  1              TO SET-CURSOR-SW
 24026            ELSE
 24027                GO TO 7499-EXIT.
 24028
 24029**2757**
 24030
 24031     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24032        MOVE AL-UNBON            TO CLIVESA
 24033        MOVE -1                  TO CLIVESL
 24034        MOVE  1                  TO SET-CURSOR-SW
 24035        GO TO 7499-EXIT.
 24036
 24037**2771**
 24038
 24039     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24040        MOVE AL-UABON            TO CCANDT2A
 24041        MOVE -1                  TO CCANDT2L
 24042        MOVE  1                  TO SET-CURSOR-SW
 24043        GO TO 7499-EXIT.
 24044
 24045**2774**
 24046
 24047     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24048        MOVE AL-UABON            TO CCANDT1A
 24049        MOVE -1                  TO CCANDT1L
 24050        MOVE  1                  TO SET-CURSOR-SW
 24051        GO TO 7499-EXIT.
 24052
 24053**2775**
 24054
 24055     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24056        MOVE AL-UABON            TO CCANDT2A
 24057        MOVE -1                  TO CCANDT2L
 24058        MOVE  1                  TO SET-CURSOR-SW
 24059        GO TO 7499-EXIT.
 24060
 24061**2776**
 24062
 24063     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24064        MOVE AL-UABON            TO CCANDT1A
 24065        MOVE -1                  TO CCANDT1L
 24066        MOVE  1                  TO SET-CURSOR-SW
 24067        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 443
* EL6311.cbl
 24068
 24069
 24070**2777**
 24071
 24072     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24073        MOVE AL-UABON            TO CCANDT2A
 24074        MOVE -1                  TO CCANDT2L
 24075        MOVE  1                  TO SET-CURSOR-SW
 24076        GO TO 7499-EXIT.
 24077
 24078**2794**
 24079
 24080     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24081        MOVE AL-UABON            TO CFORCEA
 24082        MOVE -1                  TO CFORCEL
 24083        MOVE  1                  TO SET-CURSOR-SW
 24084        GO TO 7499-EXIT.
 24085
 24086**2799**
 24087
 24088     IF PI-COMPANY-ID = 'UCL'
 24089         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24090             MOVE AL-UNBON            TO BEFFDTA
 24091             MOVE -1                  TO BEFFDTL
 24092             MOVE  1                  TO SET-CURSOR-SW
 24093             GO TO 7499-EXIT.
 24094
 24095 7499-EXIT.
 24096      EXIT.
 24097
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 444
* EL6311.cbl
 24099
 24100 7500-READ-ERLOFC.
 24101     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24102                                     ERLOFC-KEY.
 24103
 24104     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24105
 24106     IF ST-ACCNT-CNTL
 24107         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24108
 24109     IF CARR-GROUP-ST-ACCNT-CNTL
 24110         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24111         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24112         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24113
 24114     IF CARR-ST-ACCNT-CNTL
 24115         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24116         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24117
 24118     IF CARR-ACCNT-CNTL
 24119         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24120
 24121     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24122
 24123     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24124
 24125
 24126* EXEC CICS HANDLE CONDITION
 24127*        NOTFND   (7550-OFFICER-NOTFND)
 24128*    END-EXEC.
 24129*    MOVE '"$I                   ! [ #00020329' TO DFHEIV0
 24130     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24132     MOVE X'5B20233030303230333239' TO DFHEIV0(25:11)
 24133     CALL 'kxdfhei1' USING DFHEIV0
 24134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24135
 24136
 24137
 24138* EXEC CICS READ
 24139*        DATASET   (FILE-ID-ERLOFC)
 24140*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24141*        RIDFLD    (ERLOFC-KEY)
 24142*        EQUAL
 24143*    END-EXEC.
 24144*    MOVE '&"S        E          (   #00020333' TO DFHEIV0
 24145     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24147     MOVE X'2020233030303230333333' TO DFHEIV0(25:11)
 24148     CALL 'kxdfhei1' USING DFHEIV0,
 24149           FILE-ID-ERLOFC,
 24150           DFHEIV20,
 24151           DFHEIV99,
 24152           ERLOFC-KEY,
 24153           DFHEIV99,
 24154           DFHEIV99,
 24155           DFHEIV99
 24156     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 445
* EL6311.cbl
 24157         DFHEIV20
 24158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24159
 24160
 24161     GO TO 7599-EXIT.
 24162
 24163 7550-OFFICER-NOTFND.
 24164     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24165
 24166 7599-EXIT.
 24167      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 446
* EL6311.cbl
 24169******************************************************************
 24170*                                                                *
 24171*            S  E N D    I N I T I A L   M A P                   *
 24172*                                                                *
 24173******************************************************************
 24174
 24175 8100-SEND-INITIAL-MAP.
 24176     MOVE EIBTIME                TO TIME-IN.
 24177
 24178     IF EIBAID = DFHPF11
 24179        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24181
 24182
 24183     IF PI-COMPANY-ID = CLIENT-GIC
 24184        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24185                                       BCPREM-ATTRB (2).
 24186
 24187     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24188                         CLIENT-PEM OR
 24189                         CLIENT-CSO)
 24190        AND PI-DISPLAY-ORIGINAL-BATCH
 24191          IF PI-MAP-NAME = EL631B
 24192             MOVE AL-SADOF               TO BPF5HDRA
 24193                                            BPF4HDRA
 24194          ELSE
 24195             IF PI-MAP-NAME = EL631C
 24196                MOVE AL-SADOF            TO CPF5HDRA
 24197                                            CPF4HDRA.
 24198
 24199     IF PI-MAP-NAME = EL631B
 24200        MOVE AL-SADOF               TO BPF5HDRA
 24201     ELSE
 24202        MOVE AL-SADOF               TO CPF5HDRA
 24203     END-IF
 24204
 24205*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24206     IF PI-MAP-NAME = EL631B
 24207          IF PI-COMPANY-ID NOT = 'DMD'
 24208             MOVE AL-SANOF            TO BBILLEDA
 24209             MOVE AL-SADOF            TO DMDBILA.
 24210*DMD CUSTOM CODING*************END
 24211
 24212     IF PI-PROCESSOR-ID = 'LGXX'
 24213        IF PI-MAP-NAME = EL631B
 24214           MOVE AL-SABOF                    TO BREFHDGA
 24215           MOVE AL-SANOF                    TO BREFA
 24216        ELSE
 24217           IF PI-MAP-NAME = EL631C
 24218              MOVE AL-SABOF                 TO CREFHDGA
 24219              MOVE AL-SANOF                 TO CREFA.
 24220
 24221     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'CAP'
 24222        continue
 24223     ELSE
 24224        IF PI-MAP-NAME = EL631C
 24225           MOVE AL-SADOF         TO CCANTXTA
 24226                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 447
* EL6311.cbl
 24227        end-if
 24228     end-if
 24229     IF PI-MAP-NAME = EL631D
 24230        IF PI-AR-PROCESSING
 24231           MOVE AL-SANOF            TO DREFHDGA
 24232        ELSE
 24233           MOVE AL-SADOF            TO DREFHDGA.
 24234
 24235     IF (PI-COMPANY-ID NOT = 'DCC' and 'CAP' and 'CID')
 24236        AND (PI-MAP-NAME = EL631B)
 24237        MOVE AL-SADOF            TO BVINHA
 24238                                    BVINA
 24239     END-IF
 24240     IF PI-MAP-NAME = EL631B
 24241        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24242        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24243                                 TO BREGIONO
 24244        MOVE PI-PROCESSOR-ID     TO BUSERO
 24245        IF CSR-EDIT-SESSION
 24246           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24247                                 TO BHEADO
 24248           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24249        ELSE
 24250           MOVE AL-SADOF         TO BF15HDRA
 24251           MOVE '4=B-HDR      '  TO BPF4HDRO
 24252        END-IF
 24253        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24254        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24255        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24256        MOVE WS-CURRENT-DT          TO BDATEO
 24257        MOVE TIME-OUT               TO BTIMEO
 24258        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24259        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24260        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24261        IF   WS-DISPLAY-SCREEN
 24262             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24263             MOVE PB-SV-CARRIER     TO BCARRO
 24264             MOVE PB-SV-GROUPING    TO BGROUPO
 24265             MOVE PB-SV-STATE       TO BSTATEO
 24266             MOVE PB-ACCOUNT        TO BACCTO
 24267        ELSE
 24268             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24269     ELSE
 24270        IF PI-MAP-NAME = EL631C
 24271           MOVE '4=B-HDR      '     TO CPF4HDRO
 24272           IF CSR-EDIT-SESSION
 24273              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24274                                 TO CHEADO
 24275           ELSE
 24276              MOVE AL-SADOF      TO CF15HDRA
 24277           END-IF
 24278           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24279           MOVE WS-CURRENT-DT          TO CDATEO
 24280           MOVE TIME-OUT               TO CTIMEO
 24281           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24282           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24283           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24284           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 448
* EL6311.cbl
 24285           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24286           MOVE WS-C-HDG               TO CAHHDGO
 24287           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24288           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24289           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24290           IF   WS-DISPLAY-SCREEN
 24291                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24292                MOVE PB-SV-CARRIER     TO CCARRO
 24293                MOVE PB-SV-GROUPING    TO CGROUPO
 24294                MOVE PB-SV-STATE       TO CSTATEO
 24295                MOVE PB-ACCOUNT        TO CACCTO
 24296           ELSE
 24297                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24298        ELSE
 24299           MOVE WS-CURRENT-DT          TO DDATEO
 24300           MOVE TIME-OUT               TO DTIMEO
 24301           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24302                                          WS-REFUND-HDG-OVERRIDE
 24303           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24304           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24305           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24306                                          WS-REFUND-HDG-OVERRIDE
 24307           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24308           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24309           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24310           IF CSR-EDIT-SESSION
 24311              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24312                                 TO DHEADO
 24313           END-IF
 24314           IF  WS-DISPLAY-SCREEN
 24315               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24316               MOVE PB-CARRIER         TO DCARRO
 24317               MOVE PB-GROUPING        TO DGROUPO
 24318               MOVE PB-STATE           TO DSTATEO
 24319               MOVE PB-ACCOUNT         TO DACCTO
 24320               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24321           ELSE
 24322               MOVE EL631D             TO PI-MAP-NAME
 24323               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24324               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24325
 24326     MOVE SPACE                        TO WS-DISPLAY-SW.
 24327
 24328
 24329* EXEC CICS SEND
 24330*        MAP      (PI-MAP-NAME)
 24331*        MAPSET   (MAPSET-EL6311S)
 24332*        FROM     (EL631BI)
 24333*        ERASE
 24334*        CURSOR
 24335*    END-EXEC.
 24336     MOVE LENGTH OF
 24337      EL631BI
 24338       TO DFHEIV12
 24339     MOVE -1
 24340       TO DFHEIV11
 24341*    MOVE '8$     CT  E    H L F ,   #00020507' TO DFHEIV0
 24342     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 449
* EL6311.cbl
 24343     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24344     MOVE X'2020233030303230353037' TO DFHEIV0(25:11)
 24345     CALL 'kxdfhei1' USING DFHEIV0,
 24346           PI-MAP-NAME,
 24347           EL631BI,
 24348           DFHEIV12,
 24349           MAPSET-EL6311S,
 24350           DFHEIV99,
 24351           DFHEIV99,
 24352           DFHEIV99,
 24353           DFHEIV11,
 24354           DFHEIV99,
 24355           DFHEIV99,
 24356           DFHEIV99
 24357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24358
 24359
 24360     GO TO 9100-RETURN-TRAN.
 24361
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 450
* EL6311.cbl
 24363
 24364******************************************************************
 24365*                                                                *
 24366*              S E N D    D A T A O N L Y                        *
 24367*                                                                *
 24368******************************************************************
 24369
 24370 8200-SEND-DATAONLY.
 24371     MOVE EIBTIME                TO TIME-IN.
 24372
 24373     IF PI-COMPANY-ID = CLIENT-GIC
 24374        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24375                                       BCPREM-ATTRB (2).
 24376
 24377     IF PI-MAP-NAME = EL631B
 24378        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24379        MOVE WS-CURRENT-DT          TO BDATEO
 24380        MOVE TIME-OUT               TO BTIMEO
 24381        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24382        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24383        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24384        MOVE SPACES                 TO BPFENTRO
 24385        MOVE AL-UANOF               TO BPFENTRA
 24386
 24387*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24388        IF PI-COMPANY-ID NOT = 'DMD'
 24389             MOVE AL-SANOF            TO BBILLEDA
 24390             MOVE AL-SADOF            TO DMDBILA
 24391         ELSE
 24392            NEXT SENTENCE
 24393*DMD CUSTOM CODING*************END
 24394     ELSE
 24395        IF PI-MAP-NAME = EL631C
 24396           MOVE WS-CURRENT-DT          TO CDATEO
 24397           MOVE TIME-OUT               TO CTIMEO
 24398           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24399           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24400           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24401           MOVE SPACES                 TO CPFENTRO
 24402           MOVE AL-UANOF               TO CPFENTRA
 24403        ELSE
 24404           MOVE WS-CURRENT-DT          TO DDATEO
 24405           MOVE TIME-OUT               TO DTIMEO
 24406           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24407
 24408
 24409* EXEC CICS SEND
 24410*        MAP      (PI-MAP-NAME)
 24411*        MAPSET   (MAPSET-EL6311S)
 24412*        FROM     (EL631BI)
 24413*        DATAONLY
 24414*        CURSOR
 24415*    END-EXEC.
 24416     MOVE LENGTH OF
 24417      EL631BI
 24418       TO DFHEIV12
 24419     MOVE -1
 24420       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 451
* EL6311.cbl
 24421*    MOVE '8$D    CT       H L F ,   #00020563' TO DFHEIV0
 24422     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24423     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24424     MOVE X'2020233030303230353633' TO DFHEIV0(25:11)
 24425     CALL 'kxdfhei1' USING DFHEIV0,
 24426           PI-MAP-NAME,
 24427           EL631BI,
 24428           DFHEIV12,
 24429           MAPSET-EL6311S,
 24430           DFHEIV99,
 24431           DFHEIV99,
 24432           DFHEIV99,
 24433           DFHEIV11,
 24434           DFHEIV99,
 24435           DFHEIV99,
 24436           DFHEIV99
 24437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24438
 24439
 24440     GO TO 9100-RETURN-TRAN.
 24441
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 452
* EL6311.cbl
 24443
 24444******************************************************************
 24445*                                                                *
 24446*           U T I L I T Y   R O U T I N E S                      *
 24447*                                                                *
 24448******************************************************************
 24449
 24450 8300-SEND-TEXT.
 24451
 24452* EXEC CICS SEND TEXT
 24453*        FROM     (LOGOFF-TEXT)
 24454*        LENGTH   (LOGOFF-LENGTH)
 24455*        ERASE
 24456*        FREEKB
 24457*    END-EXEC.
 24458*    MOVE '8&      T  E F  H   F -   #00020582' TO DFHEIV0
 24459     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24460     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24461     MOVE X'2020233030303230353832' TO DFHEIV0(25:11)
 24462     CALL 'kxdfhei1' USING DFHEIV0,
 24463           LOGOFF-TEXT,
 24464           LOGOFF-LENGTH,
 24465           DFHEIV99,
 24466           DFHEIV99,
 24467           DFHEIV99,
 24468           DFHEIV99,
 24469           DFHEIV99,
 24470           DFHEIV99,
 24471           DFHEIV99,
 24472           DFHEIV99,
 24473           DFHEIV99,
 24474           DFHEIV99
 24475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24476
 24477
 24478
 24479* EXEC CICS RETURN
 24480*    END-EXEC.
 24481*    MOVE '.(                    ''   #00020589' TO DFHEIV0
 24482     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24483     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24484     MOVE X'2020233030303230353839' TO DFHEIV0(25:11)
 24485     CALL 'kxdfhei1' USING DFHEIV0,
 24486           DFHEIV99,
 24487           DFHEIV99,
 24488           DFHEIV99,
 24489           DFHEIV99,
 24490           DFHEIV99,
 24491           DFHEIV99
 24492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24493
 24494
 24495 8400-LOG-JOURNAL-RECORD.
 24496     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24497     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24498
 24499*    EXEC CICS JOURNAL
 24500*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 453
* EL6311.cbl
 24501*        JTYPEID     ('EL')
 24502*        FROM        (JOURNAL-RECORD)
 24503*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24504*    END-EXEC.
 24505
 24506 8600-DEEDIT.
 24507
 24508* EXEC CICS BIF DEEDIT
 24509*         FIELD   (DEEDIT-FIELD)
 24510*         LENGTH  (15)
 24511*    END-EXEC.
 24512     MOVE 15
 24513       TO DFHEIV11
 24514*    MOVE '@"L                   #   #00020604' TO DFHEIV0
 24515     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24516     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24517     MOVE X'2020233030303230363034' TO DFHEIV0(25:11)
 24518     CALL 'kxdfhei1' USING DFHEIV0,
 24519           DEEDIT-FIELD,
 24520           DFHEIV11
 24521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24522
 24523
 24524 8800-UNAUTHORIZED-ACCESS.
 24525     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24526     GO TO 8300-SEND-TEXT.
 24527
 24528 8810-PF23.
 24529     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24530     MOVE XCTL-EL005             TO PGM-NAME.
 24531     GO TO 9300-XCTL.
 24532
 24533 9100-RETURN-TRAN.
 24534     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24535
 24536     IF  PI-MAP-NAME =  EL631B
 24537         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24538
 24539     IF  PI-MAP-NAME =  EL631C
 24540         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24541
 24542     IF  PI-MAP-NAME =  EL631D
 24543         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24544
 24545
 24546* EXEC CICS RETURN
 24547*        TRANSID    (TRANS-EXB1)
 24548*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24549*        LENGTH     (1300)
 24550*    END-EXEC.
 24551     MOVE 1300
 24552       TO DFHEIV11
 24553*    MOVE '.(CT                  ''   #00020630' TO DFHEIV0
 24554     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24555     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24556     MOVE X'2020233030303230363330' TO DFHEIV0(25:11)
 24557     CALL 'kxdfhei1' USING DFHEIV0,
 24558           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 454
* EL6311.cbl
 24559           PROGRAM-INTERFACE-BLOCK,
 24560           DFHEIV11,
 24561           DFHEIV99,
 24562           DFHEIV99,
 24563           DFHEIV99
 24564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24565
 24566
 24567 9200-RETURN-MAIN-MENU.
 24568     MOVE XCTL-EL626             TO PGM-NAME.
 24569     GO TO 9300-XCTL.
 24570
 24571 9300-XCTL.
 24572
 24573* EXEC CICS XCTL
 24574*        PROGRAM    (PGM-NAME)
 24575*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24576*        LENGTH     (PI-COMM-LENGTH)
 24577*    END-EXEC.
 24578*    MOVE '.$C                   %   #00020641' TO DFHEIV0
 24579     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24580     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24581     MOVE X'2020233030303230363431' TO DFHEIV0(25:11)
 24582     CALL 'kxdfhei1' USING DFHEIV0,
 24583           PGM-NAME,
 24584           PROGRAM-INTERFACE-BLOCK,
 24585           PI-COMM-LENGTH,
 24586           DFHEIV99
 24587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24588
 24589
 24590 9400-CLEAR.
 24591     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24592     GO TO 9300-XCTL.
 24593
 24594 9500-PF12.
 24595     MOVE XCTL-EL010             TO PGM-NAME.
 24596     GO TO 9300-XCTL.
 24597
 24598 9600-PGMID-ERROR.
 24599
 24600* EXEC CICS HANDLE CONDITION
 24601*        PGMIDERR    (8300-SEND-TEXT)
 24602*    END-EXEC.
 24603*    MOVE '"$L                   ! \ #00020656' TO DFHEIV0
 24604     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24606     MOVE X'5C20233030303230363536' TO DFHEIV0(25:11)
 24607     CALL 'kxdfhei1' USING DFHEIV0
 24608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24609
 24610
 24611     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24612     MOVE ' '                    TO PI-ENTRY-CD-1.
 24613     MOVE XCTL-EL005             TO PGM-NAME.
 24614     MOVE PGM-NAME               TO LOGOFF-PGM.
 24615     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24616     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 455
* EL6311.cbl
 24617
 24618 9700-DATE-LINK.
 24619     MOVE LINK-ELDATCV           TO PGM-NAME.
 24620
 24621* EXEC CICS LINK
 24622*        PROGRAM    (PGM-NAME)
 24623*        COMMAREA   (DATE-CONVERSION-DATA)
 24624*        LENGTH     (DC-COMM-LENGTH)
 24625*    END-EXEC.
 24626*    MOVE '."C                   (   #00020669' TO DFHEIV0
 24627     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24629     MOVE X'2020233030303230363639' TO DFHEIV0(25:11)
 24630     CALL 'kxdfhei1' USING DFHEIV0,
 24631           PGM-NAME,
 24632           DATE-CONVERSION-DATA,
 24633           DC-COMM-LENGTH,
 24634           DFHEIV99,
 24635           DFHEIV99,
 24636           DFHEIV99,
 24637           DFHEIV99
 24638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24639
 24640
 24641 9800-LINK-PENDING-EDIT.
 24642     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24643     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24644
 24645     MOVE LINK-EL050             TO PGM-NAME
 24646     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24647     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24648                                    WK-CO-TOL-CLAIM
 24649                                    WK-CO-TOL-PREM
 24650                                    WK-CO-TOL-REFUND
 24651                                    WK-CO-TOL-PREM-PCT
 24652                                    WK-CO-TOL-REFUND-PCT
 24653                                    WK-REFUND-OVS-AMT
 24654                                    WK-REFUND-OVS-PCT
 24655                                    WK-ACCT-ADDR
 24656                                    WK-LIFE-EDIT-ADDR
 24657                                    WK-AH-EDIT-ADDR
 24658                                    WK-LIFE-BEN-ADDR
 24659                                    WK-AH-BEN-ADDR
 24660                                    WK-STATE-ADDR
 24661                                    WK-PLAN-ADDR
 24662                                    WK-FORM-ADDR
 24663     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24664
 24665     MOVE '6'                    TO WK-ENTRY-SW.
 24666
 24667     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24668
 24669     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24670                                    EC-AM-EXPIRATION-DT
 24671                                    EC-AM-EFFECTIVE-DT
 24672                                    EC-CM-LF-CANCEL-DT
 24673                                    EC-CM-AH-CANCEL-DT
 24674                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 456
* EL6311.cbl
 24675
 24676     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24677                                    EC-CO-TOL-REFUND
 24678                                    EC-CO-MIN-AGE
 24679                                    EC-CO-MIN-PREMIUM
 24680                                    EC-CO-MIN-TERM
 24681                                    EC-CO-MAX-TERM
 24682                                    EC-ST-TOL-PREM
 24683                                    EC-ST-TOL-REFUND
 24684                                    EC-AM-LF-TOL-PREM
 24685                                    EC-AM-AH-TOL-PREM
 24686                                    EC-AM-LF-MAX-ATT-AGE
 24687                                    EC-AM-LF-MAX-AGE
 24688                                    EC-AM-LF-MAX-TERM
 24689                                    EC-AM-LF-MAX-TOT-BEN
 24690                                    EC-AM-AH-MAX-ATT-AGE
 24691                                    EC-AM-AH-MAX-AGE
 24692                                    EC-AM-AH-MAX-TERM
 24693                                    EC-AM-AH-MAX-TOT-BEN
 24694                                    EC-AM-AH-MAX-MON-BEN
 24695                                    EC-RT-LF-MAX-ATT-AGE
 24696                                    EC-RT-LF-MAX-AGE
 24697                                    EC-RT-LF-MAX-TERM
 24698                                    EC-RT-LF-MAX-TOT-BEN
 24699                                    EC-RT-AH-MAX-ATT-AGE
 24700                                    EC-RT-AH-MAX-AGE
 24701                                    EC-RT-AH-MAX-TERM
 24702                                    EC-RT-AH-MAX-TOT-BEN
 24703                                    EC-RT-AH-MAX-MON-BEN
 24704                                    EC-RT-AH-RATE
 24705                                    EC-RT-LF-RATE
 24706                                    EC-RT-LF-NSP-RATE
 24707                                    EC-RT-AH-NSP-RATE
 24708                                    EC-CM-LF-PRIOR-REFUND
 24709                                    EC-CM-AH-PRIOR-REFUND.
 24710
 24711     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24712                                    EC-ST-TOL-PREM-PCT
 24713                                    EC-AM-LF-TOL-REFUND
 24714                                    EC-AM-LF-DEV-PERCENT
 24715                                    EC-CO-TOL-REFUND-PCT
 24716                                    EC-ST-TOL-REFUND-PCT
 24717                                    EC-AM-AH-TOL-REFUND
 24718                                    EC-AM-AH-DEV-PERCENT.
 24719
 24720
 24721* EXEC CICS LINK
 24722*         PROGRAM   (PGM-NAME)
 24723*         COMMAREA  (PASSED-RECORD)
 24724*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24725*    END-EXEC.
 24726*    MOVE '."C                   (   #00020754' TO DFHEIV0
 24727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24729     MOVE X'2020233030303230373534' TO DFHEIV0(25:11)
 24730     CALL 'kxdfhei1' USING DFHEIV0,
 24731           PGM-NAME,
 24732           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 457
* EL6311.cbl
 24733           WS-EDIT-PASS-LENGTH,
 24734           DFHEIV99,
 24735           DFHEIV99,
 24736           DFHEIV99,
 24737           DFHEIV99
 24738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24739
 24740
 24741     MOVE '1'                    TO PI-EDIT-SW.
 24742     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24743
 24744     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24745
 24746     IF PI-COMPANY-ID = 'UCL'
 24747         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24748
 24749     IF VALID-PB-ID
 24750        GO TO 9800-EXIT.
 24751
 24752     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24753
 24754     IF PI-MAP-NAME = EL631B
 24755        MOVE -1                  TO BMAINTL
 24756       ELSE
 24757        MOVE -1                  TO CMAINTL.
 24758
 24759     GO TO 8200-SEND-DATAONLY.
 24760
 24761 9800-EXIT.
 24762      EXIT.
 24763
 24764 9900-ERROR-FORMAT.
 24765
 24766     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24767
 24768     IF NOT EMI-ERRORS-COMPLETE
 24769         MOVE LINK-EL001         TO PGM-NAME
 24770
 24771* EXEC CICS LINK
 24772*            PROGRAM    (PGM-NAME)
 24773*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24774*            LENGTH     (EMI-COMM-LENGTH)
 24775*        END-EXEC.
 24776*    MOVE '."C                   (   #00020789' TO DFHEIV0
 24777     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24778     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24779     MOVE X'2020233030303230373839' TO DFHEIV0(25:11)
 24780     CALL 'kxdfhei1' USING DFHEIV0,
 24781           PGM-NAME,
 24782           ERROR-MESSAGE-INTERFACE-BLOCK,
 24783           EMI-COMM-LENGTH,
 24784           DFHEIV99,
 24785           DFHEIV99,
 24786           DFHEIV99,
 24787           DFHEIV99
 24788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24789
 24790
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 458
* EL6311.cbl
 24791 9900-EXIT.
 24792     EXIT.
 24793
 24794 9990-ABEND.
 24795     MOVE LINK-EL004             TO PGM-NAME.
 24796     MOVE DFHEIBLK               TO EMI-LINE1.
 24797
 24798* EXEC CICS LINK
 24799*        PROGRAM   (PGM-NAME)
 24800*        COMMAREA  (EMI-LINE1)
 24801*        LENGTH    (72)
 24802*    END-EXEC.
 24803     MOVE 72
 24804       TO DFHEIV11
 24805*    MOVE '."C                   (   #00020801' TO DFHEIV0
 24806     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24808     MOVE X'2020233030303230383031' TO DFHEIV0(25:11)
 24809     CALL 'kxdfhei1' USING DFHEIV0,
 24810           PGM-NAME,
 24811           EMI-LINE1,
 24812           DFHEIV11,
 24813           DFHEIV99,
 24814           DFHEIV99,
 24815           DFHEIV99,
 24816           DFHEIV99
 24817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24818
 24819
 24820     IF PI-MAP-NAME = EL631B
 24821        MOVE -1                  TO BMAINTL
 24822       ELSE
 24823        MOVE -1                  TO CMAINTL.
 24824
 24825     IF EIBTRNID NOT = TRANS-EXB1
 24826        GO TO 8100-SEND-INITIAL-MAP
 24827       ELSE
 24828        GO TO 8200-SEND-DATAONLY.
 24829
 24830 9995-SECURITY-VIOLATION.
 24831*                            COPY ELCSCTP.
 24832******************************************************************
 24833*                                                                *
 24834*                            ELCSCTP                             *
 24835*                            VMOD=2.001                          *
 24836*                                                                *
 24837*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24838******************************************************************
 24839
 24840
 24841     MOVE EIBDATE          TO SM-JUL-DATE.
 24842     MOVE EIBTRMID         TO SM-TERMID.
 24843     MOVE THIS-PGM         TO SM-PGM.
 24844     MOVE EIBTIME          TO TIME-IN.
 24845     MOVE TIME-OUT         TO SM-TIME.
 24846     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24847
 24848
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 459
* EL6311.cbl
 24849* EXEC CICS LINK
 24850*         PROGRAM  ('EL003')
 24851*         COMMAREA (SECURITY-MESSAGE)
 24852*         LENGTH   (80)
 24853*    END-EXEC.
 24854     MOVE 'EL003' TO DFHEIV1
 24855     MOVE 80
 24856       TO DFHEIV11
 24857*    MOVE '."C                   (   #00020835' TO DFHEIV0
 24858     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24859     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24860     MOVE X'2020233030303230383335' TO DFHEIV0(25:11)
 24861     CALL 'kxdfhei1' USING DFHEIV0,
 24862           DFHEIV1,
 24863           SECURITY-MESSAGE,
 24864           DFHEIV11,
 24865           DFHEIV99,
 24866           DFHEIV99,
 24867           DFHEIV99,
 24868           DFHEIV99
 24869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24870
 24871
 24872******************************************************************
 24873
 24874
 24875 9999-DFHBACK SECTION.
 24876     MOVE '9%                    "   ' TO DFHEIV0
 24877     MOVE 'EL6311' TO DFHEIV1
 24878     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24879     GOBACK.
 24880 9999-DFHEXIT.
 24881     IF DFHEIGDJ EQUAL 0001
 24882         NEXT SENTENCE
 24883     ELSE IF DFHEIGDJ EQUAL 2
 24884         GO TO 9600-PGMID-ERROR,
 24885               9990-ABEND,
 24886               9990-ABEND,
 24887               0010-MAIN-LOGIC
 24888         DEPENDING ON DFHEIGDI
 24889     ELSE IF DFHEIGDJ EQUAL 3
 24890         GO TO 1280-BATCH-HDR-NOT-FOUND
 24891         DEPENDING ON DFHEIGDI
 24892     ELSE IF DFHEIGDJ EQUAL 4
 24893         GO TO 1290-DUPLICATE-ALT-INDEX
 24894         DEPENDING ON DFHEIGDI
 24895     ELSE IF DFHEIGDJ EQUAL 5
 24896         GO TO 1295-CERT-TRL-REC-NOTFND
 24897         DEPENDING ON DFHEIGDI
 24898     ELSE IF DFHEIGDJ EQUAL 6
 24899         GO TO 1380-BATCH-HDR-NOT-FOUND
 24900         DEPENDING ON DFHEIGDI
 24901     ELSE IF DFHEIGDJ EQUAL 7
 24902         GO TO 1385-REC-NOT-FOUND
 24903         DEPENDING ON DFHEIGDI
 24904     ELSE IF DFHEIGDJ EQUAL 8
 24905         GO TO 1386-NOTFND
 24906         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 460
* EL6311.cbl
 24907     ELSE IF DFHEIGDJ EQUAL 9
 24908         GO TO 1399-EXIT
 24909         DEPENDING ON DFHEIGDI
 24910     ELSE IF DFHEIGDJ EQUAL 10
 24911         GO TO 1480-BATCH-HDR-NOT-FOUND
 24912         DEPENDING ON DFHEIGDI
 24913     ELSE IF DFHEIGDJ EQUAL 11
 24914         GO TO 1490-RECORD-NOT-FOUND
 24915         DEPENDING ON DFHEIGDI
 24916     ELSE IF DFHEIGDJ EQUAL 12
 24917         GO TO 1405-DELETE-CERTIFICATE
 24918         DEPENDING ON DFHEIGDI
 24919     ELSE IF DFHEIGDJ EQUAL 13
 24920         GO TO 1420-CONTINUE-DELETE
 24921         DEPENDING ON DFHEIGDI
 24922     ELSE IF DFHEIGDJ EQUAL 14
 24923         GO TO 1406-DELETE-ERNOTE
 24924         DEPENDING ON DFHEIGDI
 24925     ELSE IF DFHEIGDJ EQUAL 15
 24926         GO TO 1407-DELETE-MAILING
 24927         DEPENDING ON DFHEIGDI
 24928     ELSE IF DFHEIGDJ EQUAL 16
 24929         GO TO 1420-CONTINUE-DELETE
 24930         DEPENDING ON DFHEIGDI
 24931     ELSE IF DFHEIGDJ EQUAL 17
 24932         GO TO 1480-BATCH-HDR-NOT-FOUND
 24933         DEPENDING ON DFHEIGDI
 24934     ELSE IF DFHEIGDJ EQUAL 18
 24935         GO TO 1475-DELETE-FINISHED
 24936         DEPENDING ON DFHEIGDI
 24937     ELSE IF DFHEIGDJ EQUAL 19
 24938         GO TO 2280-BATCH-HDR-NOT-FOUND
 24939         DEPENDING ON DFHEIGDI
 24940     ELSE IF DFHEIGDJ EQUAL 20
 24941         GO TO 2290-DUPLICATE-ALT-INDEX
 24942         DEPENDING ON DFHEIGDI
 24943     ELSE IF DFHEIGDJ EQUAL 21
 24944         GO TO 2380-BATCH-HDR-NOT-FOUND
 24945         DEPENDING ON DFHEIGDI
 24946     ELSE IF DFHEIGDJ EQUAL 22
 24947         GO TO 2385-REC-NOT-FOUND
 24948         DEPENDING ON DFHEIGDI
 24949     ELSE IF DFHEIGDJ EQUAL 23
 24950         GO TO 2380-BATCH-HDR-NOT-FOUND
 24951         DEPENDING ON DFHEIGDI
 24952     ELSE IF DFHEIGDJ EQUAL 24
 24953         GO TO 2485-BATCH-HDR-NOT-FOUND
 24954         DEPENDING ON DFHEIGDI
 24955     ELSE IF DFHEIGDJ EQUAL 25
 24956         GO TO 2490-RECORD-NOT-FOUND
 24957         DEPENDING ON DFHEIGDI
 24958     ELSE IF DFHEIGDJ EQUAL 26
 24959         GO TO 2475-CONTINUE-DELETE
 24960         DEPENDING ON DFHEIGDI
 24961     ELSE IF DFHEIGDJ EQUAL 27
 24962         GO TO 2485-BATCH-HDR-NOT-FOUND
 24963         DEPENDING ON DFHEIGDI
 24964     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 461
* EL6311.cbl
 24965         GO TO 2480-DELETE-FINISHED
 24966         DEPENDING ON DFHEIGDI
 24967     ELSE IF DFHEIGDJ EQUAL 29
 24968         GO TO 2820-PROCESS-REWRITE
 24969         DEPENDING ON DFHEIGDI
 24970     ELSE IF DFHEIGDJ EQUAL 30
 24971         GO TO 2885-RECORD-MISSING
 24972         DEPENDING ON DFHEIGDI
 24973     ELSE IF DFHEIGDJ EQUAL 31
 24974         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24975         DEPENDING ON DFHEIGDI
 24976     ELSE IF DFHEIGDJ EQUAL 32
 24977         GO TO 2827-DELETE-MAILING
 24978         DEPENDING ON DFHEIGDI
 24979     ELSE IF DFHEIGDJ EQUAL 33
 24980         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24981         DEPENDING ON DFHEIGDI
 24982     ELSE IF DFHEIGDJ EQUAL 34
 24983         GO TO 2920-PROCESS-REWRITE
 24984         DEPENDING ON DFHEIGDI
 24985     ELSE IF DFHEIGDJ EQUAL 35
 24986         GO TO 2985-RECORD-MISSING
 24987         DEPENDING ON DFHEIGDI
 24988     ELSE IF DFHEIGDJ EQUAL 36
 24989         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24990         DEPENDING ON DFHEIGDI
 24991     ELSE IF DFHEIGDJ EQUAL 37
 24992         GO TO 2990-DUPLICATE-RECORD
 24993         DEPENDING ON DFHEIGDI
 24994     ELSE IF DFHEIGDJ EQUAL 38
 24995         GO TO 3590-NOT-FOUND
 24996         DEPENDING ON DFHEIGDI
 24997     ELSE IF DFHEIGDJ EQUAL 39
 24998         GO TO 3690-NOT-FOUND
 24999         DEPENDING ON DFHEIGDI
 25000     ELSE IF DFHEIGDJ EQUAL 40
 25001         GO TO 3990-NOT-FOUND
 25002         DEPENDING ON DFHEIGDI
 25003     ELSE IF DFHEIGDJ EQUAL 41
 25004         GO TO 4050-END-RECORDS,
 25005               4050-END-RECORDS
 25006         DEPENDING ON DFHEIGDI
 25007     ELSE IF DFHEIGDJ EQUAL 42
 25008         GO TO 4150-END-BATCH
 25009         DEPENDING ON DFHEIGDI
 25010     ELSE IF DFHEIGDJ EQUAL 43
 25011         GO TO 4150-END-BATCH
 25012         DEPENDING ON DFHEIGDI
 25013     ELSE IF DFHEIGDJ EQUAL 44
 25014         GO TO 4250-END-RECORDS,
 25015               4250-END-RECORDS
 25016         DEPENDING ON DFHEIGDI
 25017     ELSE IF DFHEIGDJ EQUAL 45
 25018         GO TO 4350-END-BATCH,
 25019               4350-END-BATCH
 25020         DEPENDING ON DFHEIGDI
 25021     ELSE IF DFHEIGDJ EQUAL 46
 25022         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 27-Feb-17 09:11 Page 462
* EL6311.cbl
 25023               4550-END-RECORDS
 25024         DEPENDING ON DFHEIGDI
 25025     ELSE IF DFHEIGDJ EQUAL 47
 25026         GO TO 4680-NOT-FOUND,
 25027               4680-NOT-FOUND
 25028         DEPENDING ON DFHEIGDI
 25029     ELSE IF DFHEIGDJ EQUAL 48
 25030         GO TO 4860-NOT-FOUND,
 25031               4850-END-RECORDS
 25032         DEPENDING ON DFHEIGDI
 25033     ELSE IF DFHEIGDJ EQUAL 49
 25034         GO TO 4970-NOT-FOUND,
 25035               4950-END-RECORDS
 25036         DEPENDING ON DFHEIGDI
 25037     ELSE IF DFHEIGDJ EQUAL 50
 25038         GO TO 5050-NOT-FOUND
 25039         DEPENDING ON DFHEIGDI
 25040     ELSE IF DFHEIGDJ EQUAL 51
 25041         GO TO 5050-NOT-FOUND
 25042         DEPENDING ON DFHEIGDI
 25043     ELSE IF DFHEIGDJ EQUAL 52
 25044         GO TO 5050-NOT-FOUND
 25045         DEPENDING ON DFHEIGDI
 25046     ELSE IF DFHEIGDJ EQUAL 53
 25047         GO TO 5550-END-RECORDS,
 25048               5550-END-RECORDS
 25049         DEPENDING ON DFHEIGDI
 25050     ELSE IF DFHEIGDJ EQUAL 54
 25051         GO TO 6050-QID-ERROR
 25052         DEPENDING ON DFHEIGDI
 25053     ELSE IF DFHEIGDJ EQUAL 55
 25054         GO TO 6050-QID-ERROR
 25055         DEPENDING ON DFHEIGDI
 25056     ELSE IF DFHEIGDJ EQUAL 56
 25057         GO TO 6400-CONTINUE,
 25058               6400-CONTINUE
 25059         DEPENDING ON DFHEIGDI
 25060     ELSE IF DFHEIGDJ EQUAL 57
 25061         GO TO 3690-NOT-FOUND
 25062         DEPENDING ON DFHEIGDI
 25063     ELSE IF DFHEIGDJ EQUAL 58
 25064         GO TO 7399-EXIT
 25065         DEPENDING ON DFHEIGDI
 25066     ELSE IF DFHEIGDJ EQUAL 59
 25067         GO TO 7550-OFFICER-NOTFND
 25068         DEPENDING ON DFHEIGDI
 25069     ELSE IF DFHEIGDJ EQUAL 60
 25070         GO TO 8300-SEND-TEXT
 25071         DEPENDING ON DFHEIGDI.
 25072     MOVE '9%                    "   ' TO DFHEIV0
 25073     MOVE 'EL6311' TO DFHEIV1
 25074     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25075     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15284     Code:       99214
