* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   1
* EL640.cbl
* Options: int("EL640.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL640.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL640.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL640.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL640.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 15:38:12.
     7*                            VMOD=2.040
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   2
* EL640.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.    TRANSACTION - EXC1 - ACCOUNT BILLING.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    34*                              ADJUSTED REDEFINES EL640AO FILLER
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 083104    2004083000002  PEMA PREVENT ONLINE BILLING
    37* 072105    2004120100002  PEMA FIX ONLINE BILLING FOR DCC SPP
    38* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    39* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    40* 032113  CR2012110800003  PEMA  CORRECT SPP AH REF COMMISSION
    41******************************************************************
    42 ENVIRONMENT DIVISION.
    43
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   3
* EL640.cbl
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL640 WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.040 ************'.
    51 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    52 77  S1                          PIC S999 COMP-3 VALUE +0.
    53*    COPY ELCSCTM.
    54******************************************************************
    55*                                                                *
    56*                                                                *
    57*                            ELCSCTM                             *
    58*                            VMOD=2.001                          *
    59*                                                                *
    60*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    61*                                                                *
    62******************************************************************
    63 01  SECURITY-MESSAGE.
    64     12  FILLER                          PIC X(30)
    65            VALUE '** LOGIC SECURITY VIOLATION -'.
    66     12  SM-READ                         PIC X(6).
    67     12  FILLER                          PIC X(5)
    68            VALUE ' PGM='.
    69     12  SM-PGM                          PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' OPR='.
    72     12  SM-PROCESSOR-ID                 PIC X(4).
    73     12  FILLER                          PIC X(6)
    74            VALUE ' TERM='.
    75     12  SM-TERMID                       PIC X(4).
    76     12  FILLER                          PIC XX   VALUE SPACE.
    77     12  SM-JUL-DATE                     PIC 9(5).
    78     12  FILLER                          PIC X    VALUE SPACE.
    79     12  SM-TIME                         PIC 99.99.
    80
    81*    COPY ELCSCRTY.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCRTY                            *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    89*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    90*        SAVED IN PI-SECURITY-ADDRESS.                           *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-CONTROL.
    94     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    95     12  FILLER                       PIC XX    VALUE 'SC'.
    96     12  SC-CREDIT-CODES.
    97         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    98             20  SC-CREDIT-DISPLAY    PIC X.
    99             20  SC-CREDIT-UPDATE     PIC X.
   100     12  SC-CLAIMS-CODES.
   101         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   102             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   4
* EL640.cbl
   103             20  SC-CLAIMS-UPDATE     PIC X.
   104     12  WS-RESPONSE             PIC S9(8)       COMP.
   105         88  WS-RESP-NORMAL                      VALUE +00.
   106         88  WS-RESP-NOTFND                      VALUE +13.
   107         88  WS-RESP-DUPREC                      VALUE +14.
   108         88  WS-RESP-DUPKEY                      VALUE +15.
   109         88  WS-RESP-NOTOPEN                     VALUE +19.
   110         88  WS-RESP-ENDFILE                     VALUE +20.
   111 01  STANDARD-AREAS.
   112     12  WS-AH-CATEGORY              PIC X       VALUE ' '.
   113     12  CLAS-LOOK                   PIC XX      VALUE '  '.
   114     12  SC-ITEM             PIC S9(4) COMP VALUE +1.
   115
   116     12  W-TRANSFER-CONTROL.
   117         16  WT-CR-CARRIER           PIC X     VALUE SPACES.
   118         16  WT-CR-GROUPING          PIC X(6)  VALUE SPACES.
   119         16  WT-CR-STATE             PIC XX    VALUE SPACES.
   120         16  WT-CR-ACCOUNT           PIC X(10) VALUE SPACES.
   121         16  WT-CR-FIN-RESP          PIC X(10) VALUE SPACES.
   122         16  WT-CR-TYPE              PIC X     VALUE SPACES.
   123
   124     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   125     12  MAP-NAME            PIC X(8)    VALUE 'EL640A'.
   126     12  MAPSET-NAME         PIC X(8)    VALUE 'EL640S'.
   127     12  SCREEN-NUMBER       PIC X(4)    VALUE '640A'.
   128     12  TRANS-ID            PIC X(4)    VALUE 'EXC1'.
   129     12  EL6311-TRANS-ID     PIC X(4)    VALUE 'EXB1'.
   130     12  EL633-TRANS-ID      PIC X(4)    VALUE 'EXB7'.
   131     12  EL633DMD-TRANS-ID   PIC X(4)    VALUE 'EX1F'.
   132     12  EL635-TRANS-ID      PIC X(4)    VALUE 'EXJ4'.
   133     12  EL650-TRANS-ID      PIC X(4)    VALUE 'EXC4'.
   134     12  EL652-TRANS-ID      PIC X(4)    VALUE 'EXD4'.
   135     12  EL658-TRANS-ID      PIC X(4)    VALUE 'EXJ3'.
   136     12  THIS-PGM            PIC X(8)    VALUE 'EL640'.
   137     12  EL640A              PIC X(8)    VALUE 'EL640A'.
   138     12  EL640B              PIC X(8)    VALUE 'EL640B'.
   139     12  PGM-NAME            PIC X(8).
   140     12  TIME-IN             PIC S9(7).
   141     12  TIME-OUT-R  REDEFINES TIME-IN.
   142         16  FILLER          PIC X.
   143         16  TIME-OUT        PIC 99V99.
   144         16  FILLER          PIC XX.
   145
   146     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   147     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   148     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   149     12  XCTL-633            PIC X(8)    VALUE 'EL633'.
   150     12  XCTL-633DMD         PIC X(8)    VALUE 'EL633DMD'.
   151     12  XCTL-635            PIC X(8)    VALUE 'EL635'.
   152     12  XCTL-PYAJ           PIC X(8)    VALUE 'EL633'.
   153     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   154     12  XCTL-652            PIC X(8)    VALUE 'EL652'.
   155     12  XCTL-658            PIC X(8)    VALUE 'EL658'.
   156     12  XCTL-6401           PIC X(8)    VALUE 'EL6401'.
   157     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   158     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   159     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   160     12  ERPNDB-ALT-FILE-ID  PIC X(8)    VALUE 'ERPNDB2'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   5
* EL640.cbl
   161     12  ERPNDB-FILE-ID      PIC X(8)    VALUE 'ERPNDB'.
   162     12  ELCNTL-FILE-ID      PIC X(8)    VALUE 'ELCNTL'.
   163     12  ELLETR-FILE-ID      PIC X(8)    VALUE 'ELLETR'.
   164     12  ERCOMP-FILE-ID      PIC X(8)    VALUE 'ERCOMP'.
   165     12  ERPYAJ-FILE-ID      PIC X(8)    VALUE 'ERPYAJ'.
   166     12  ERACCT-ALT-FILE-ID  PIC X(8)    VALUE 'ERACCT2'.
   167     12  ERACCT-FILE-ID      PIC X(8)    VALUE 'ERACCT'.
   168     12  ERBILL-FILE-ID      PIC X(8)    VALUE 'ERBILL'.
   169     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   170     12  QID.
   171         16  QID-TERM        PIC X(4).
   172         16  FILLER          PIC X(4)    VALUE '640A'.
   173     12  CLIENT-ITY          PIC XXX     VALUE 'ITY'.
   174
   175 01  WORK-AREA.
   176     12  W-LETTER-IND            PIC X     VALUE SPACE.
   177         88  W-LETTER-NOT-FOUND    VALUE 'Y'.
   178     12  FIRST-TIME-SW           PIC X     VALUE 'Y'.
   179         88  FIRST-TIME            VALUE 'Y'.
   180     12  C-RECORD-FOUND-SW       PIC X     VALUE 'Y'.
   181         88  C-RECORD-FOUND        VALUE 'Y'.
   182     12  ACCOUNT-FIN-RESP-SW     PIC X     VALUE ' '.
   183         88  ACCOUNT-FIN-RESP      VALUE 'Y'.
   184         88  ACCOUNT-NOT-FIN-RESP  VALUE 'N'.
   185     12  VALID-BILL-TYPE-VALUES  PIC X     VALUE SPACE.
   186         88  VALID-BILL-TYPE       VALUE  '1' '2'.
   187*        88  VALID-BILL-TYPE       VALUE  '1' '2' '3' '4' '5'.
   188     12  BILL-BATCH-TRAILER-SW   PIC X     VALUE SPACE.
   189         88  BILL-BATCH-TRAILER    VALUE 'Y'.
   190     12  PNDB-EOF-SW             PIC X     VALUE SPACE.
   191         88  PNDB-EOF              VALUE 'Y'.
   192     12  PYAJ-EOF-SW             PIC X     VALUE SPACE.
   193         88  PYAJ-EOF              VALUE 'Y'.
   194     12  COMP-UPDATE-SW          PIC X     VALUE SPACE.
   195         88  UPDATE-COMP-TOTALS    VALUE 'Y'.
   196     12  LIMIT-BILLING-SW        PIC X     VALUE SPACE.
   197         88  LIMIT-BILLING         VALUE 'Y'.
   198     12  WS-PROCESS-SW           PIC X     VALUE SPACE.
   199         88  DO-NOT-BILL-THIS-ACCT VALUE 'Y'.
   200     12  WS-CHARGEBACK-LF-SW     PIC X     VALUE SPACE.
   201         88  CHARGEBACK-CAN-LF     VALUE 'Y'.
   202         88  NO-CHARGEBACK-LF      VALUE 'N'.
   203     12  WS-CHARGEBACK-AH-SW     PIC X     VALUE SPACE.
   204         88  CHARGEBACK-CAN-AH     VALUE 'Y'.
   205         88  NO-CHARGEBACK-AH      VALUE 'N'.
   206     12  NO-BILL-REC-SW          PIC X     VALUE SPACE.
   207         88  NO-BILL-RECS          VALUE 'Y'.
   208     12  DATA-VOIDED-SW          PIC X     VALUE SPACE.
   209         88  DATA-VOIDED           VALUE 'Y'.
   210     12  BATCHES-PROCESSED-SW    PIC X     VALUE SPACE.
   211         88  MORE-THAN-6-BATCHES   VALUE 'Y'.
   212     12  BILLING-DETAIL-TYPE     PIC XX    VALUE SPACES.
   213         88  TOTAL-STATEMENT       VALUE 'TS'.
   214         88  BILLING-DETAIL        VALUE 'BD'.
   215         88  CARRIER-ADDRESS       VALUE 'CA'.
   216         88  GEN-AGT-ADDRESS       VALUE 'GA'.
   217     12  ELCNTL-UPDATE-SW        PIC X     VALUE SPACE.
   218         88  ELCNTL-UPDATE         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   6
* EL640.cbl
   219     12  WS-ENTERED-FROM-MAP     PIC X     VALUE 'A'.
   220         88  WS-ENTERED-FROM-A     VALUE 'A'.
   221
   222     12  ACCOM-SUB               PIC 99    VALUE ZEROS.
   223     12  SUB                     PIC S999  COMP-3  VALUE ZEROS.
   224
   225     12  WORK-ZIP                PIC 9(9)  VALUE ZEROS.
   226     12  WORK-ZIPR1 REDEFINES WORK-ZIP.
   227         16  WORK-ZIPR1-4        PIC 9(4).
   228         16  WORK-ZIPR1-5        PIC 9(5).
   229     12  WORK-ZIPR2 REDEFINES WORK-ZIP.
   230         16  WORK-ZIPR2-5        PIC 9(5).
   231         16  WORK-ZIPR2-4        PIC 9(4).
   232     12  WS-AM-ZIP.
   233         16  WS-AM-ZIP-PRIME     PIC X(5).
   234         16  WS-AM-ZIP-DASH      PIC X.
   235         16  WS-AM-ZIP-PLUS4     PIC X(4).
   236     12  WS-AM-CANADIAN-ZIP  REDEFINES  WS-AM-ZIP.
   237         16  WS-AM-CAN-POST-1    PIC XXX.
   238         16  FILLER              PIC X.
   239         16  WS-AM-CAN-POST-2    PIC XXX.
   240         16  FILLER              PIC XXX.
   241     12  WS-CF-ZIP.
   242         16  WS-CF-ZIP-PRIME     PIC X(5) VALUE SPACES.
   243         16  WS-CF-ZIP-DASH      PIC X    VALUE SPACES.
   244         16  WS-CF-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   245     12  WS-CF-CANADIAN-ZIP  REDEFINES  WS-CF-ZIP.
   246         16  WS-CF-CAN-POST-1    PIC XXX.
   247         16  FILLER              PIC X.
   248         16  WS-CF-CAN-POST-2    PIC XXX.
   249         16  FILLER              PIC XXX.
   250     12  WS-CO-ZIP.
   251         16  WS-CO-ZIP-PRIME     PIC X(5) VALUE SPACES.
   252         16  WS-CO-ZIP-DASH      PIC X    VALUE SPACES.
   253         16  WS-CO-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   254     12  WS-CO-CANADIAN-ZIP  REDEFINES  WS-CO-ZIP.
   255         16  WS-CO-CAN-POST-1    PIC XXX.
   256         16  FILLER              PIC X.
   257         16  WS-CO-CAN-POST-2    PIC XXX.
   258         16  FILLER              PIC XXX.
   259
   260     12  WORK-SEQ-NO             PIC S9(9)   COMP-3 VALUE +0.
   261     12  WS-ERROR-MSG.
   262         16  WS-ERROR-TEXT       PIC X(35) VALUE SPACES.
   263         16  WS-ERROR-BATCH      PIC X(6)  VALUE SPACES.
   264         16  FILLER              PIC X(24) VALUE SPACES.
   265     12  WS-WORK-DATE.
   266         16  WS-MONTH            PIC 99    VALUE ZEROS.
   267         16  WS-DAY              PIC 99    VALUE ZEROS.
   268         16  WS-YEAR             PIC 99    VALUE ZEROS.
   269     12  WS-MONTH-END-DATE.
   270         16  WS-ME-YEAR          PIC 99    VALUE ZEROS.
   271         16  WS-ME-MONTH         PIC 99    VALUE ZEROS.
   272         16  WS-ME-DAY           PIC 99    VALUE ZEROS.
   273     12  WS-CURRENT-DATE         PIC XX    VALUE SPACES.
   274     12  WS-CURRENT-DATE-MDY     PIC X(6)  VALUE SPACES.
   275     12  WS-CURRENT-DATE-EDIT    PIC X(8)  VALUE SPACES.
   276     12  WS-PREV-BILL-DATE       PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   7
* EL640.cbl
   277     12  WS-BEGIN-DATE.
   278         16  FILLER              PIC X(3)  VALUE SPACES.
   279         16  WS-BEGIN-DAY        PIC XX    VALUE SPACES.
   280         16  FILLER              PIC X(3)  VALUE SPACES.
   281     12  PRINT-CONTROL.
   282         16  SINGLE-SPACE        PIC X     VALUE SPACE.
   283         16  DOUBLE-SPACE        PIC X     VALUE ZERO.
   284         16  TRIPLE-SPACE        PIC X     VALUE '-'.
   285         16  SUPPRESS-SPACE      PIC X     VALUE '+'.
   286         16  TOP-OF-PAGE         PIC X     VALUE '1'.
   287     12  WS-EXP-DATE.
   288         16  WS-SAV-EXP-DT     OCCURS 10 TIMES
   289                               INDEXED BY DTNDX  PIC XX.
   290     12  WS-REMIT-TO.
   291         16  WS-SAV-REMIT-TO   OCCURS 10 TIMES
   292                               INDEXED BY RTNDX  PIC X(10).
   293     12  WORK-REMIT-TO           PIC X(10) VALUE SPACES.
   294     12  WS-REMITTED             PIC S9(6)V99 VALUE ZEROS.
   295     12  WS-LINECTR              PIC 99    VALUE ZEROS.
   296     12  WS-PGECTR               PIC 999   VALUE 1.
   297     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   298     12  WS-CARR-COMP.
   299         16  WS-CARRIER          PIC X     VALUE SPACE.
   300         16  WS-COMP             PIC X(6)  VALUE SPACES.
   301
   302     12  REPORT-TOTALS.
   303         16  TOT-REPT-LF-PREM    PIC S9(7)V99   VALUE ZEROS.
   304         16  TOT-REPT-LF-REF     PIC S9(7)V99   VALUE ZEROS.
   305         16  TOT-REPT-LF-COMP    PIC S9(7)V99   VALUE ZEROS.
   306         16  TOT-REPT-LF-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   307         16  TOT-REPT-AH-PREM    PIC S9(7)V99   VALUE ZEROS.
   308         16  TOT-REPT-AH-REF     PIC S9(7)V99   VALUE ZEROS.
   309         16  TOT-REPT-AH-COMP    PIC S9(7)V99   VALUE ZEROS.
   310         16  TOT-REPT-AH-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   311         16  TOT-LF-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   312         16  TOT-AH-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   313         16  TOT-REPT-PREM       PIC S9(7)V99   VALUE ZEROS.
   314         16  TOT-REPT-CANCEL-FEE PIC S9(7)V99   VALUE ZEROS.
   315     12  WORK-AMT                PIC S9(7)V99   VALUE ZEROS.
   316     12  WORK-CHECK-AMT          PIC S9(7)V99   VALUE ZEROS.
   317     12  WORK-CANCEL-FEE         PIC S9(7)V99   VALUE ZEROS.
   318     12  WS-I-LF-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   319     12  WS-I-LF-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   320     12  WS-I-AH-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   321     12  WS-I-AH-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   322     12  WS-C-LF-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   323     12  WS-C-AH-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   324     12  WS-C-CANCEL-FEE         PIC S9(5)V99   COMP-3 VALUE +0.
   325     12  WS-LF-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   326     12  WS-AH-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   327     12  WS-PAY-ADJ              PIC S9(6)V99   COMP-3 VALUE +0.
   328     12  WS-CI-LIFE-BENEFIT      PIC S9(7)V99   COMP-3 VALUE +0.
   329     12  LF-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   330     12  JT-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   331     12  AH-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   332     12  AGENT-OWES              PIC X(18)
   333                         VALUE 'AGENT OWES       ='.
   334     12  OWED-TO-AGENT           PIC X(18)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   8
* EL640.cbl
   335                         VALUE 'OWED TO AGENT    ='.
   336     12  WS-PY-ENTRY-COMMENT.
   337         16  WS-PY-CURRENT-DATE      PIC X(6) VALUE SPACES.
   338         16  FILLER                  PIC X(14) VALUE
   339             ' CHK TO AGENT'.
   340
   341     12  WS-ITY-COMMENT.
   342         16  WS-PY-BEGIN-DT          PIC X(8) VALUE SPACES.
   343         16  FILLER                  PIC X(06) VALUE
   344             ' THRU '.
   345         16  WS-PY-END-DT            PIC X(8) VALUE SPACES.
   346
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page   9
* EL640.cbl
   348     12  WS-ACCT-ADDR-AREA.
   349         16  WS-ACCT-LINES OCCURS 6 TIMES INDEXED BY A-INDX.
   350           18  WS-ACCT-ZIP           PIC X(10) VALUE SPACES.
   351           18  FILLER                PIC X(10) VALUE SPACES.
   352           18  WS-A-LAST-ZIP         PIC X(10) VALUE SPACES.
   353
   354     12  WS-REMIT-ADDR-AREA.
   355         16  WS-REMIT-ACCT           PIC X(10) VALUE SPACES.
   356         16  WS-REMIT-LINES OCCURS 6 TIMES INDEXED BY R-INDX.
   357           18  WS-REMIT-ZIP          PIC X(10) VALUE SPACES.
   358           18  FILLER                PIC X(10) VALUE SPACES.
   359           18  WS-R-LAST-ZIP         PIC X(10) VALUE SPACES.
   360
   361     12  WS-EFFECT-DATE.
   362         16  WS-EFFECT-YR            PIC 99 VALUE ZEROS.
   363         16  WS-EFFECT-MO            PIC 99 VALUE ZEROS.
   364         16  WS-EFFECT-DA            PIC 99 VALUE ZEROS.
   365
   366     12  WS-LIFE-CANCEL-DT.
   367         16  WS-LF-CANCEL-YR         PIC 99 VALUE ZEROS.
   368         16  WS-LF-CANCEL-MO         PIC 99 VALUE ZEROS.
   369         16  WS-LF-CANCEL-DA         PIC 99 VALUE ZEROS.
   370
   371     12  WS-AH-CANCEL-DT.
   372         16  WS-AH-CANCEL-YR         PIC 99 VALUE ZEROS.
   373         16  WS-AH-CANCEL-MO         PIC 99 VALUE ZEROS.
   374         16  WS-AH-CANCEL-DA         PIC 99 VALUE ZEROS.
   375
   376     12  MONTHS-DIFF-LF            PIC S9(05)  VALUE ZEROS.
   377     12  MONTHS-DIFF-AH            PIC S9(05)  VALUE ZEROS.
   378
   379     12  WS-BENEFIT.
   380         16  FILLER                PIC X   VALUE SPACES.
   381         16  WS-BENE-CD            PIC XX  VALUE SPACES.
   382
   383     12  WS-DESC.
   384         16 WS-BATCH-DESC        PIC X(10) VALUE SPACES.
   385         16 WS-BATCH-NBR         PIC X(6)  VALUE SPACES.
   386         16 FILLER               PIC X(4)  VALUE SPACES.
   387     12  WS-NON-PREM             PIC S9(7)V99   COMP-3.
   388     12  WS-NON-COMM             PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  10
* EL640.cbl
   390 01  ACCESS-KEYS.
   391     12  ERPNDB-PRIME-KEY.
   392         16  ERPNDB-CO-CD        PIC X     VALUE SPACES.
   393         16  ERPNDB-BATCH        PIC X(6)  VALUE SPACES.
   394         16  ERPNDB-SEQ-NO       PIC S9(4) COMP VALUE +0.
   395         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP VALUE +0.
   396
   397     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   398
   399     12  ERPNDB-ALT-KEY.
   400         16  ERPNDB-CO-CD-A1     PIC X     VALUE SPACES.
   401         16  ERPNDB-CARR         PIC X     VALUE SPACES.
   402         16  ERPNDB-GROUP        PIC X(6)  VALUE SPACES.
   403         16  ERPNDB-STATE        PIC XX    VALUE SPACES.
   404         16  ERPNDB-ACCT         PIC X(10) VALUE SPACES.
   405         16  ERPNDB-EFF-DT       PIC XX    VALUE SPACES.
   406         16  ERPNDB-CERT.
   407             20  ERPNDB-CERT-PRM PIC X(10) VALUE SPACES.
   408             20  ERPNDB-CERTSFX  PIC X     VALUE SPACES.
   409         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   410         16  ERPNDB-REC-TYPE     PIC X     VALUE SPACES.
   411
   412     12  ELCNTL-KEY.
   413         16  ELCNTL-COMPANY-ID   PIC XXX   VALUE SPACES.
   414         16  ELCNTL-REC-TYPE     PIC X     VALUE SPACES.
   415         16  ELCNTL-ACCESS.
   416             20  ELCNTL-FILLER   PIC X(3)  VALUE SPACES.
   417             20  ELCNTL-CARRIER  PIC X     VALUE SPACES.
   418         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   419
   420     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   421
   422     12  ERCOMP-KEY.
   423         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   424         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   425         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   426         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   427         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   428         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   429
   430     12  ERPYAJ-BROWSE-COMP-KEY.
   431         16  ERPYAJ-BR-COMP-CD   PIC X     VALUE SPACE.
   432         16  ERPYAJ-BR-CARRIER   PIC X     VALUE SPACES.
   433         16  ERPYAJ-BR-GROUPING  PIC X(6)  VALUE SPACES.
   434         16  ERPYAJ-BR-FIN-RESP  PIC X(10) VALUE SPACES.
   435         16  ERPYAJ-BR-ACCOUNT   PIC X(10) VALUE SPACES.
   436
   437     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   438
   439     12  ERPYAJ-KEY.
   440         16  ERPYAJ-COMP-CD      PIC X     VALUE SPACE.
   441         16  ERPYAJ-CARRIER      PIC X     VALUE SPACES.
   442         16  ERPYAJ-GROUPING     PIC X(6)  VALUE SPACES.
   443         16  ERPYAJ-FIN-RESP     PIC X(10) VALUE SPACES.
   444         16  ERPYAJ-ACCOUNT      PIC X(10) VALUE SPACES.
   445         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) VALUE +0 COMP.
   446         16  ERPYAJ-RECORD-TYPE  PIC X     VALUE SPACES.
   447
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  11
* EL640.cbl
   448     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
   449
   450     12  ERACCT-PRIME-KEY.
   451         16  ERACCT-P-CO-CD      PIC X     VALUE SPACES.
   452         16  ERACCT-P-CARRIER    PIC X     VALUE SPACES.
   453         16  ERACCT-P-GROUPING   PIC X(6)  VALUE SPACES.
   454         16  ERACCT-P-STATE      PIC XX    VALUE SPACES.
   455         16  ERACCT-P-ACCOUNT    PIC X(10) VALUE SPACES.
   456         16  ERACCT-P-EXP-DATE   PIC XX    VALUE SPACES.
   457         16  FILLER              PIC X(4)  VALUE SPACES.
   458
   459     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   460
   461     12  ERACCT-ALT-KEY.
   462         16  ERACCT-A-CO-CD      PIC X     VALUE SPACES.
   463         16  ERACCT-A-CARRIER    PIC X     VALUE SPACES.
   464         16  ERACCT-A-GROUPING   PIC X(6)  VALUE SPACES.
   465         16  ERACCT-A-STATE      PIC XX    VALUE SPACES.
   466         16  ERACCT-A-ACCOUNT    PIC X(10) VALUE SPACES.
   467         16  ERACCT-A-EXP-DATE   PIC XX    VALUE SPACES.
   468         16  FILLER              PIC X(4)  VALUE SPACES.
   469
   470     12  ERBILL-KEY.
   471         16  ERBILL-CO-CD        PIC X.
   472         16  ERBILL-CARRIER      PIC X.
   473         16  ERBILL-GROUP        PIC X(6).
   474         16  ERBILL-ACCT         PIC X(10).
   475         16  ERBILL-FIN-RESP     PIC X(10).
   476         16  ERBILL-REC-TYPE     PIC X.
   477         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   478
   479     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   480
   481     12  ELLETR-KEY.
   482         16  ELLETR-COMPANY-CD   PIC  X      VALUE SPACE.
   483         16  ELLETR-FORM-NO      PIC  X(12)  VALUE SPACES.
   484         16  ELLETR-LINE-SEQ     PIC S9(04)  VALUE +0 COMP.
   485
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  12
* EL640.cbl
   487
   488 01  ERROR-NUMBERS.
   489     12  ER-0004                 PIC X(4)  VALUE '0004'.
   490     12  ER-0008                 PIC X(4)  VALUE '0008'.
   491     12  ER-0013                 PIC X(4)  VALUE '0013'.
   492     12  ER-0022                 PIC X(4)  VALUE '0022'.
   493     12  ER-0029                 PIC X(4)  VALUE '0029'.
   494     12  ER-0070                 PIC X(4)  VALUE '0070'.
   495     12  ER-0194                 PIC X(4)  VALUE '0194'.
   496     12  ER-0195                 PIC X(4)  VALUE '0195'.
   497     12  ER-0196                 PIC X(4)  VALUE '0196'.
   498     12  ER-0197                 PIC X(4)  VALUE '0197'.
   499     12  ER-2208                 PIC X(4)  VALUE '2208'.
   500     12  ER-2210                 PIC X(4)  VALUE '2210'.
   501     12  ER-2212                 PIC X(4)  VALUE '2212'.
   502     12  ER-2215                 PIC X(4)  VALUE '2215'.
   503     12  ER-2230                 PIC X(4)  VALUE '2230'.
   504     12  ER-2233                 PIC X(4)  VALUE '2233'.
   505     12  ER-2249                 PIC X(4)  VALUE '2249'.
   506     12  ER-2250                 PIC X(4)  VALUE '2250'.
   507     12  ER-2370                 PIC X(4)  VALUE '2370'.
   508     12  ER-2371                 PIC X(4)  VALUE '2371'.
   509     12  ER-2383                 PIC X(4)  VALUE '2383'.
   510     12  ER-2385                 PIC X(4)  VALUE '2385'.
   511     12  ER-2401                 PIC X(4)  VALUE '2401'.
   512     12  ER-2403                 PIC X(4)  VALUE '2403'.
   513     12  ER-2404                 PIC X(4)  VALUE '2404'.
   514     12  ER-2405                 PIC X(4)  VALUE '2405'.
   515     12  ER-2406                 PIC X(4)  VALUE '2406'.
   516     12  ER-2407                 PIC X(4)  VALUE '2407'.
   517     12  ER-2408                 PIC X(4)  VALUE '2408'.
   518     12  ER-2409                 PIC X(4)  VALUE '2409'.
   519     12  ER-2411                 PIC X(4)  VALUE '2411'.
   520     12  ER-2421                 PIC X(4)  VALUE '2421'.
   521     12  ER-2434                 PIC X(4)  VALUE '2434'.
   522     12  ER-2435                 PIC X(4)  VALUE '2435'.
   523     12  ER-2436                 PIC X(4)  VALUE '2436'.
   524     12  ER-2438                 PIC X(4)  VALUE '2438'.
   525     12  ER-2439                 PIC X(4)  VALUE '2439'.
   526     12  ER-2443                 PIC X(4)  VALUE '2443'.
   527     12  ER-2472                 PIC X(4)  VALUE '2472'.
   528     12  ER-2539                 PIC X(4)  VALUE '2539'.
   529     12  ER-2564                 PIC X(4)  VALUE '2564'.
   530     12  ER-2570                 PIC X(4)  VALUE '2570'.
   531     12  ER-2571                 PIC X(4)  VALUE '2571'.
   532     12  ER-2597                 PIC X(4)  VALUE '2597'.
   533     12  ER-3145                 PIC X(4)  VALUE '3145'.
   534     12  ER-3165                 PIC X(4)  VALUE '3165'.
   535     12  ER-3188                 PIC X(4)  VALUE '3188'.
   536     12  ER-7389                 PIC X(4)  VALUE '7389'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  13
* EL640.cbl
   538 01  BI-REPORT-HEADINGS.
   539     12  BI-PREVIEW-HD.
   540         16  FILLER          PIC X(42)           VALUE SPACES.
   541         16  FILLER          PIC X(47)           VALUE
   542                '**** STATEMENT IS FOR REVIEW PURPOSES ONLY ****'.
   543         16  FILLER          PIC X(43)           VALUE SPACES.
   544
   545     12  BI-HD1.
   546         16  FILLER          PIC X(44)           VALUE SPACES.
   547         16  FILLER          PIC X(44)           VALUE
   548                 '  CREDIT LIFE, ACCIDENT & HEALTH STATEMENT  '.
   549         16  FILLER          PIC X(36)           VALUE SPACES.
   550         16  FILLER          PIC X(8)            VALUE ' EL640 '.
   551
   552     12  BI-HD2.
   553         16  FILLER          PIC X(51)           VALUE SPACES.
   554         16  BI-HD-CO        PIC X(30).
   555         16  FILLER          PIC X(43)           VALUE SPACES.
   556         16  BI-HD-RUN-DT    PIC X(8)            VALUE SPACES.
   557
   558     12  BI-HD3.
   559         16  FILLER          PIC X(57)           VALUE SPACES.
   560         16  BI-HD-BILL-DT   PIC X(18).
   561         16  FILLER          PIC X(37)           VALUE SPACES.
   562         16  FILLER          PIC X(5)            VALUE 'PAGE'.
   563         16  BI-HD-PG        PIC ZZ,ZZ9.
   564
   565     12  BI-HD4.
   566         16  FILLER          PIC  X(44)      VALUE
   567             '                               CERTIFICATE  '.
   568         16  FILLER          PIC  X(44)      VALUE
   569             'EFFECTIVE   CANCEL       BEN.      WRITTEN  '.
   570         12  FILLER          PIC  X(44)      VALUE
   571             '    COMP.                    FACE AMOUNT /  '.
   572
   573     12  BI-HD5.
   574         16  FILLER          PIC  X(44)      VALUE
   575             '       NAME OF INSURED            NUMBER    '.
   576         16  FILLER          PIC  X(44)      VALUE
   577             '  DATE       DATE   TERM TYPE      PREMIUM  '.
   578         16  FILLER          PIC  X(44)      VALUE
   579             '     PCT.    COMPENSATION        BENEFIT    '.
   580
   581     12  BI-HD6.
   582         16  FILLER          PIC  X(44)      VALUE SPACES.
   583         16  FILLER          PIC  X(37)      VALUE SPACES.
   584         16  FILLER          PIC  X(45)      VALUE
   585             '     PROCESSED                  NON-PROCESSED'.
   586         16  FILLER          PIC  X(07)      VALUE SPACES.
   587     12  BI-HD7.
   588         16  FILLER          PIC  X(44)      VALUE SPACES.
   589         16  FILLER          PIC  X(35)      VALUE SPACES.
   590         16  FILLER          PIC  X(45)      VALUE
   591             ' PREMIUM     COMMISSION        PREMIUM     CO'.
   592         16  FILLER          PIC  X(09)      VALUE
   593             'MMISSION'.
   594
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  14
* EL640.cbl
   596
   597*                            COPY ELCDATE.
   598******************************************************************
   599*                                                                *
   600*                                                                *
   601*                            ELCDATE.                            *
   602*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   603*                            VMOD=2.003
   604*                                                                *
   605*                                                                *
   606*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   607*                 LENGTH = 200                                   *
   608******************************************************************
   609
   610 01  DATE-CONVERSION-DATA.
   611     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   612     12  DC-OPTION-CODE                PIC X.
   613         88  BIN-TO-GREG                VALUE ' '.
   614         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   615         88  EDIT-GREG-TO-BIN           VALUE '2'.
   616         88  YMD-GREG-TO-BIN            VALUE '3'.
   617         88  MDY-GREG-TO-BIN            VALUE '4'.
   618         88  JULIAN-TO-BIN              VALUE '5'.
   619         88  BIN-PLUS-ELAPSED           VALUE '6'.
   620         88  FIND-CENTURY               VALUE '7'.
   621         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   622         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   623         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   624         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   625         88  JULIAN-TO-BIN-3            VALUE 'C'.
   626         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   627         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   628         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   629         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   630         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   631         88  CHECK-LEAP-YEAR            VALUE 'H'.
   632         88  BIN-3-TO-GREG              VALUE 'I'.
   633         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   634         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   635         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   636         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   637         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   638         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   639         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   640         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   641         88  THREE-CHARACTER-BIN
   642                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   643         88  GREGORIAN-TO-BIN
   644                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   645         88  BIN-TO-GREGORIAN
   646                  VALUES ' ' '1' 'I' '8' 'G'.
   647         88  JULIAN-TO-BINARY
   648                  VALUES '5' 'C' 'E' 'F'.
   649     12  DC-ERROR-CODE                 PIC X.
   650         88  NO-CONVERSION-ERROR        VALUE ' '.
   651         88  DATE-CONVERSION-ERROR
   652                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   653         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  15
* EL640.cbl
   654         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   655         88  DATE-IS-INVALID            VALUE '3'.
   656         88  DATE1-GREATER-DATE2        VALUE '4'.
   657         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   658         88  DATE-INVALID-OPTION        VALUE '9'.
   659         88  INVALID-CENTURY            VALUE 'A'.
   660         88  ONLY-CENTURY               VALUE 'B'.
   661         88  ONLY-LEAP-YEAR             VALUE 'C'.
   662         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   663     12  DC-END-OF-MONTH               PIC X.
   664         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   665     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   666         88  USE-NORMAL-PROCESS         VALUE ' '.
   667         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   668         88  ADJUST-UP-100-YRS          VALUE '2'.
   669     12  FILLER                        PIC X.
   670     12  DC-CONVERSION-DATES.
   671         16  DC-BIN-DATE-1             PIC XX.
   672         16  DC-BIN-DATE-2             PIC XX.
   673         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   674         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   675                       DC-GREG-DATE-1-EDIT.
   676             20  DC-EDIT1-MONTH        PIC 99.
   677             20  SLASH1-1              PIC X.
   678             20  DC-EDIT1-DAY          PIC 99.
   679             20  SLASH1-2              PIC X.
   680             20  DC-EDIT1-YEAR         PIC 99.
   681         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   682         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   683                     DC-GREG-DATE-2-EDIT.
   684             20  DC-EDIT2-MONTH        PIC 99.
   685             20  SLASH2-1              PIC X.
   686             20  DC-EDIT2-DAY          PIC 99.
   687             20  SLASH2-2              PIC X.
   688             20  DC-EDIT2-YEAR         PIC 99.
   689         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   690         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   691                     DC-GREG-DATE-1-YMD.
   692             20  DC-YMD-YEAR           PIC 99.
   693             20  DC-YMD-MONTH          PIC 99.
   694             20  DC-YMD-DAY            PIC 99.
   695         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   696         16  DC-GREG-DATE-1-MDY-R REDEFINES
   697                      DC-GREG-DATE-1-MDY.
   698             20  DC-MDY-MONTH          PIC 99.
   699             20  DC-MDY-DAY            PIC 99.
   700             20  DC-MDY-YEAR           PIC 99.
   701         16  DC-GREG-DATE-1-ALPHA.
   702             20  DC-ALPHA-MONTH        PIC X(10).
   703             20  DC-ALPHA-DAY          PIC 99.
   704             20  FILLER                PIC XX.
   705             20  DC-ALPHA-CENTURY.
   706                 24 DC-ALPHA-CEN-N     PIC 99.
   707             20  DC-ALPHA-YEAR         PIC 99.
   708         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   709         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   710         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   711         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  16
* EL640.cbl
   712         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   713                                       PIC 9(05).
   714         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   715             20  DC-JULIAN-YEAR        PIC 99.
   716             20  DC-JULIAN-DAYS        PIC 999.
   717         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   718         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   719         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   720     12  DATE-CONVERSION-VARIBLES.
   721         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   722         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   723             20  FILLER                PIC 9(3).
   724             20  HOLD-CEN-1-CCYY.
   725                 24  HOLD-CEN-1-CC     PIC 99.
   726                 24  HOLD-CEN-1-YY     PIC 99.
   727             20  HOLD-CEN-1-MO         PIC 99.
   728             20  HOLD-CEN-1-DA         PIC 99.
   729         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   730             20  HOLD-CEN-1-R-MO       PIC 99.
   731             20  HOLD-CEN-1-R-DA       PIC 99.
   732             20  HOLD-CEN-1-R-CCYY.
   733                 24  HOLD-CEN-1-R-CC   PIC 99.
   734                 24  HOLD-CEN-1-R-YY   PIC 99.
   735             20  FILLER                PIC 9(3).
   736         16  HOLD-CENTURY-1-X.
   737             20  FILLER                PIC X(3)  VALUE SPACES.
   738             20  HOLD-CEN-1-X-CCYY.
   739                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   740                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   741             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   742             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   743         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   744             20  HOLD-CEN-1-R-X-MO     PIC XX.
   745             20  HOLD-CEN-1-R-X-DA     PIC XX.
   746             20  HOLD-CEN-1-R-X-CCYY.
   747                 24  HOLD-CEN-1-R-X-CC PIC XX.
   748                 24  HOLD-CEN-1-R-X-YY PIC XX.
   749             20  FILLER                PIC XXX.
   750         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   751         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   752         16  DC-JULIAN-DATE-1          PIC 9(07).
   753         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   754             20  DC-JULIAN-1-CCYY.
   755                 24  DC-JULIAN-1-CC    PIC 99.
   756                 24  DC-JULIAN-1-YR    PIC 99.
   757             20  DC-JULIAN-DA-1        PIC 999.
   758         16  DC-JULIAN-DATE-2          PIC 9(07).
   759         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   760             20  DC-JULIAN-2-CCYY.
   761                 24  DC-JULIAN-2-CC    PIC 99.
   762                 24  DC-JULIAN-2-YR    PIC 99.
   763             20  DC-JULIAN-DA-2        PIC 999.
   764         16  DC-GREG-DATE-A-EDIT.
   765             20  DC-EDITA-MONTH        PIC 99.
   766             20  SLASHA-1              PIC X VALUE '/'.
   767             20  DC-EDITA-DAY          PIC 99.
   768             20  SLASHA-2              PIC X VALUE '/'.
   769             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  17
* EL640.cbl
   770                 24  DC-EDITA-CENT     PIC 99.
   771                 24  DC-EDITA-YEAR     PIC 99.
   772         16  DC-GREG-DATE-B-EDIT.
   773             20  DC-EDITB-MONTH        PIC 99.
   774             20  SLASHB-1              PIC X VALUE '/'.
   775             20  DC-EDITB-DAY          PIC 99.
   776             20  SLASHB-2              PIC X VALUE '/'.
   777             20  DC-EDITB-CCYY.
   778                 24  DC-EDITB-CENT     PIC 99.
   779                 24  DC-EDITB-YEAR     PIC 99.
   780         16  DC-GREG-DATE-CYMD         PIC 9(08).
   781         16  DC-GREG-DATE-CYMD-R REDEFINES
   782                              DC-GREG-DATE-CYMD.
   783             20  DC-CYMD-CEN           PIC 99.
   784             20  DC-CYMD-YEAR          PIC 99.
   785             20  DC-CYMD-MONTH         PIC 99.
   786             20  DC-CYMD-DAY           PIC 99.
   787         16  DC-GREG-DATE-MDCY         PIC 9(08).
   788         16  DC-GREG-DATE-MDCY-R REDEFINES
   789                              DC-GREG-DATE-MDCY.
   790             20  DC-MDCY-MONTH         PIC 99.
   791             20  DC-MDCY-DAY           PIC 99.
   792             20  DC-MDCY-CEN           PIC 99.
   793             20  DC-MDCY-YEAR          PIC 99.
   794    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   795        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   796    12  DC-EL310-DATE                  PIC X(21).
   797    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  18
* EL640.cbl
   799*                            COPY ELCLOGOF.
   800******************************************************************
   801*                                                                *
   802*                                                                *
   803*                            ELCLOGOF.                           *
   804*                            VMOD=2.001                          *
   805*                                                                *
   806*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   807*                                                                *
   808******************************************************************
   809 01  CLASIC-LOGOFF.
   810     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   811     12  LOGOFF-TEXT.
   812         16  FILLER          PIC X(5)    VALUE SPACES.
   813         16  LOGOFF-MSG.
   814             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   815             20  FILLER      PIC X       VALUE SPACES.
   816             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   817         16  FILLER          PIC X(80)
   818           VALUE '* YOU ARE NOW LOGGED OFF'.
   819         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   820         16  FILLER          PIC X       VALUE QUOTE.
   821         16  LOGOFF-SYS-MSG  PIC X(17)
   822           VALUE 'S CLAS-IC SYSTEM '.
   823     12  TEXT-MESSAGES.
   824         16  UNACCESS-MSG    PIC X(29)
   825             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   826         16  PGMIDERR-MSG    PIC X(17)
   827             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  19
* EL640.cbl
   829*                            COPY ELCATTR.
   830******************************************************************
   831*                                                                *
   832*                            ELCATTR.                            *
   833*                            VMOD=2.001                          *
   834*                                                                *
   835*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   836*                                                                *
   837*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   838*                                                                *
   839*                   POS 1   P=PROTECTED                          *
   840*                           U=UNPROTECTED                        *
   841*                           S=ASKIP                              *
   842*                   POS 2   A=ALPHA/NUMERIC                      *
   843*                           N=NUMERIC                            *
   844*                   POS 3   N=NORMAL                             *
   845*                           B=BRIGHT                             *
   846*                           D=DARK                               *
   847*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   848*                           OF=MODIFIED DATA TAG OFF             *
   849*                                                                *
   850*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   851******************************************************************
   852 01  ATTRIBUTE-LIST.
   853     12  AL-PABOF            PIC X       VALUE 'Y'.
   854     12  AL-PABON            PIC X       VALUE 'Z'.
   855     12  AL-PADOF            PIC X       VALUE '%'.
   856     12  AL-PADON            PIC X       VALUE '_'.
   857     12  AL-PANOF            PIC X       VALUE '-'.
   858     12  AL-PANON            PIC X       VALUE '/'.
   859     12  AL-SABOF            PIC X       VALUE '8'.
   860     12  AL-SABON            PIC X       VALUE '9'.
   861     12  AL-SADOF            PIC X       VALUE '@'.
   862     12  AL-SADON            PIC X       VALUE QUOTE.
   863     12  AL-SANOF            PIC X       VALUE '0'.
   864     12  AL-SANON            PIC X       VALUE '1'.
   865     12  AL-UABOF            PIC X       VALUE 'H'.
   866     12  AL-UABON            PIC X       VALUE 'I'.
   867     12  AL-UADOF            PIC X       VALUE '<'.
   868     12  AL-UADON            PIC X       VALUE '('.
   869     12  AL-UANOF            PIC X       VALUE ' '.
   870     12  AL-UANON            PIC X       VALUE 'A'.
   871     12  AL-UNBOF            PIC X       VALUE 'Q'.
   872     12  AL-UNBON            PIC X       VALUE 'R'.
   873     12  AL-UNDOF            PIC X       VALUE '*'.
   874     12  AL-UNDON            PIC X       VALUE ')'.
   875     12  AL-UNNOF            PIC X       VALUE '&'.
   876     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  20
* EL640.cbl
   878*                            COPY ELCEMIB.
   879******************************************************************
   880*                                                                *
   881*                                                                *
   882*                            ELCEMIB.                            *
   883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   884*                            VMOD=2.005                          *
   885*                                                                *
   886*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   887*                                                                *
   888******************************************************************
   889 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   890     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   891     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   892     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   893     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   894     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   895     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   896     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   897     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   898     12  EMI-SWITCH1             PIC X        VALUE '1'.
   899         88  EMI-NO-ERRORS                    VALUE '1'.
   900         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   901         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   902     12  EMI-SWITCH2             PIC X        VALUE '1'.
   903         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   904     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   905         88  EMI-AREA1-EMPTY                  VALUE '1'.
   906         88  EMI-AREA1-FULL                   VALUE '2'.
   907     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   908         88  EMI-AREA2-EMPTY                  VALUE '1'.
   909         88  EMI-AREA2-FULL                   VALUE '2'.
   910     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   911         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   912         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   913         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   914         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   915         88  EMI-BYPASS-FATALS                VALUE 'X'.
   916     12  EMI-ERROR-LINES.
   917         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   918         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   919         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   920         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   921             20  EMI-ERR-CODES OCCURS 10 TIMES.
   922                 24  EMI-ERR-NUM         PIC X(4).
   923                 24  EMI-FILLER          PIC X.
   924                 24  EMI-SEV             PIC X.
   925                 24  FILLER              PIC X.
   926             20  FILLER                  PIC X(02).
   927     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   928         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   929             20  EMI-ERROR-NUMBER    PIC X(4).
   930             20  EMI-FILL            PIC X.
   931             20  EMI-SEVERITY        PIC X.
   932             20  FILLER              PIC X.
   933             20  EMI-ERROR-TEXT.
   934                 24  EMI-TEXT-VARIABLE   PIC X(10).
   935                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  21
* EL640.cbl
   936     12  EMI-SEVERITY-SAVE           PIC X.
   937         88  EMI-NOTE                    VALUE 'N'.
   938         88  EMI-WARNING                 VALUE 'W'.
   939         88  EMI-FORCABLE                VALUE 'F'.
   940         88  EMI-FATAL                   VALUE 'X'.
   941     12  EMI-MESSAGE-FLAG            PIC X.
   942         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   943         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   944     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   945     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   946         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   947         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   948         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   949     12  FILLER                      PIC X(137)  VALUE SPACES.
   950     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   951     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   952     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   953     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  22
* EL640.cbl
   955*                            COPY ELCINTF.
   956******************************************************************
   957*                                                                *
   958*                                                                *
   959*                            ELCINTF.                            *
   960*                            VMOD=2.017                          *
   961*                                                                *
   962*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   963*                                                                *
   964*       LENGTH = 1024                                            *
   965*                                                                *
   966******************************************************************
   967*                   C H A N G E   L O G
   968*
   969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   970*-----------------------------------------------------------------
   971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   972* EFFECTIVE    NUMBER
   973*-----------------------------------------------------------------
   974* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   975******************************************************************
   976 01  PROGRAM-INTERFACE-BLOCK.
   977     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   978     12  PI-CALLING-PROGRAM              PIC X(8).
   979     12  PI-SAVED-PROGRAM-1              PIC X(8).
   980     12  PI-SAVED-PROGRAM-2              PIC X(8).
   981     12  PI-SAVED-PROGRAM-3              PIC X(8).
   982     12  PI-SAVED-PROGRAM-4              PIC X(8).
   983     12  PI-SAVED-PROGRAM-5              PIC X(8).
   984     12  PI-SAVED-PROGRAM-6              PIC X(8).
   985     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   986     12  PI-COMPANY-ID                   PIC XXX.
   987     12  PI-COMPANY-CD                   PIC X.
   988
   989     12  PI-COMPANY-PASSWORD             PIC X(8).
   990
   991     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   992
   993     12  PI-CONTROL-IN-PROGRESS.
   994         16  PI-CARRIER                  PIC X.
   995         16  PI-GROUPING                 PIC X(6).
   996         16  PI-STATE                    PIC XX.
   997         16  PI-ACCOUNT                  PIC X(10).
   998         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   999                                         PIC X(10).
  1000         16  PI-CLAIM-CERT-GRP.
  1001             20  PI-CLAIM-NO             PIC X(7).
  1002             20  PI-CERT-NO.
  1003                 25  PI-CERT-PRIME       PIC X(10).
  1004                 25  PI-CERT-SFX         PIC X.
  1005             20  PI-CERT-EFF-DT          PIC XX.
  1006         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1007             20  PI-PLAN-CODE            PIC X(2).
  1008             20  PI-REVISION-NUMBER      PIC X(3).
  1009             20  PI-PLAN-EFF-DT          PIC X(2).
  1010             20  PI-PLAN-EXP-DT          PIC X(2).
  1011             20  FILLER                  PIC X(11).
  1012         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  23
* EL640.cbl
  1013             20  PI-OE-REFERENCE-1.
  1014                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1015                 25  PI-OE-REF-1-SUFF    PIC XX.
  1016
  1017     12  PI-SESSION-IN-PROGRESS          PIC X.
  1018         88  CLAIM-SESSION                   VALUE '1'.
  1019         88  CREDIT-SESSION                  VALUE '2'.
  1020         88  WARRANTY-SESSION                VALUE '3'.
  1021         88  MORTGAGE-SESSION                VALUE '4'.
  1022         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1023
  1024
  1025*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1026
  1027     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1028     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1029
  1030     12  PI-CREDIT-USER                  PIC X.
  1031         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1032         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1033
  1034     12  PI-CLAIM-USER                   PIC X.
  1035         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1036         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1037
  1038     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1039         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1040         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1041         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1042         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1043         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1044
  1045     12  PI-PROCESSOR-ID                 PIC X(4).
  1046
  1047     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1048
  1049     12  PI-MEMBER-CAPTION               PIC X(10).
  1050
  1051     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1052         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1053
  1054     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1055     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1056     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1057     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1058
  1059     12  PI-AH-OVERRIDE-L1               PIC X.
  1060     12  PI-AH-OVERRIDE-L2               PIC XX.
  1061     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1062     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1063
  1064     12  PI-NEW-SYSTEM                   PIC X(2).
  1065
  1066     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1067     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1068         88  PI-USES-PAID-TO                 VALUE '1'.
  1069     12  PI-CRDTCRD-SYSTEM.
  1070         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  24
* EL640.cbl
  1071             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1072             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1073         16  PI-CC-MONTH-END-DT          PIC XX.
  1074     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1075
  1076     12  PI-OE-REFERENCE-2.
  1077         16  PI-OE-REF-2-PRIME           PIC X(10).
  1078         16  PI-OE-REF-2-SUFF            PIC X.
  1079
  1080     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1081
  1082     12  PI-LANGUAGE-TYPE                PIC X.
  1083             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1084             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1085             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1086
  1087     12  PI-POLICY-LINKAGE-IND           PIC X.
  1088         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1089         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1090                                                   LOW-VALUES.
  1091
  1092     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1093     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1094         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1095         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1096
  1097     12  PI-PROCESSOR-CSR-IND            PIC X.
  1098         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1099         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1100
  1101     12  FILLER                          PIC X(3).
  1102
  1103     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1104
  1105     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1106         PI-SYSTEM-LEVEL.
  1107
  1108         16  PI-ENTRY-CODES.
  1109             20  PI-ENTRY-CD-1           PIC X.
  1110             20  PI-ENTRY-CD-2           PIC X.
  1111
  1112         16  PI-RETURN-CODES.
  1113             20  PI-RETURN-CD-1          PIC X.
  1114             20  PI-RETURN-CD-2          PIC X.
  1115
  1116         16  PI-UPDATE-STATUS-SAVE.
  1117             20  PI-UPDATE-BY            PIC X(4).
  1118             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1119
  1120         16  PI-LOWER-CASE-LETTERS       PIC X.
  1121             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1122
  1123*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1124*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1125*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1126
  1127         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1128             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  25
* EL640.cbl
  1129             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1130             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1131             88  ACCNT-CNTL                  VALUE '3'.
  1132             88  CARR-ACCNT-CNTL             VALUE '4'.
  1133
  1134         16  PI-PROCESSOR-CAP-LIST.
  1135             20  PI-SYSTEM-CONTROLS.
  1136                24 PI-SYSTEM-DISPLAY     PIC X.
  1137                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1138                24 PI-SYSTEM-MODIFY      PIC X.
  1139                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1140             20  FILLER                  PIC XX.
  1141             20  PI-DISPLAY-CAP          PIC X.
  1142                 88  DISPLAY-CAP             VALUE 'Y'.
  1143             20  PI-MODIFY-CAP           PIC X.
  1144                 88  MODIFY-CAP              VALUE 'Y'.
  1145             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1146                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1147             20  PI-FORCE-CAP            PIC X.
  1148                 88  FORCE-CAP               VALUE 'Y'.
  1149
  1150         16  PI-PROGRAM-CONTROLS.
  1151             20  PI-PGM-PRINT-OPT        PIC X.
  1152             20  PI-PGM-FORMAT-OPT       PIC X.
  1153             20  PI-PGM-PROCESS-OPT      PIC X.
  1154             20  PI-PGM-TOTALS-OPT       PIC X.
  1155
  1156         16  PI-HELP-INTERFACE.
  1157             20  PI-LAST-ERROR-NO        PIC X(4).
  1158             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1159
  1160         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1161             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1162
  1163         16  PI-CR-CONTROL-IN-PROGRESS.
  1164             20  PI-CR-CARRIER           PIC X.
  1165             20  PI-CR-GROUPING          PIC X(6).
  1166             20  PI-CR-STATE             PIC XX.
  1167             20  PI-CR-ACCOUNT           PIC X(10).
  1168             20  PI-CR-FIN-RESP          PIC X(10).
  1169             20  PI-CR-TYPE              PIC X.
  1170
  1171         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1172
  1173         16  PI-CR-MONTH-END-DT          PIC XX.
  1174
  1175         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1176             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1177             88  PI-ZERO-CARRIER             VALUE '1'.
  1178             88  PI-ZERO-GROUPING            VALUE '2'.
  1179             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1180
  1181         16  PI-CARRIER-SECURITY         PIC X.
  1182             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1183
  1184         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1185             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1186             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  26
* EL640.cbl
  1187
  1188         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1189             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1190                                         INDEXED BY PI-ACCESS-NDX
  1191                                         PIC X.
  1192
  1193         16  PI-GA-BILLING-CONTROL       PIC X.
  1194             88  PI-GA-BILLING               VALUE '1'.
  1195
  1196         16  PI-MAIL-PROCESSING          PIC X.
  1197             88  PI-MAIL-YES                 VALUE 'Y'.
  1198
  1199         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1200
  1201         16  PI-AR-SYSTEM.
  1202             20  PI-AR-PROCESSING-CNTL   PIC X.
  1203                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1204             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1205             20  PI-AR-MONTH-END-DT      PIC XX.
  1206
  1207         16  PI-MP-SYSTEM.
  1208             20  PI-MORTGAGE-USER            PIC X.
  1209                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1210                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1211             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1212                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1213                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1214                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1215                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1216                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1217             20  PI-MP-MONTH-END-DT          PIC XX.
  1218             20  PI-MP-REFERENCE-NO.
  1219                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1220                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1221
  1222         16  PI-LABEL-CONTROL            PIC X(01).
  1223             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1224             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1225
  1226         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1227             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1228
  1229         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1230             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1231             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1232
  1233         16  FILLER                      PIC X(14).
  1234
  1235     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1236******************************************************************
  1237     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1238         16  PI-MAP-NAME         PIC X(8).
  1239         16  PI-ACCT-NAME        PIC X(30).
  1240         16  PI-SAV-REMIT-TO     PIC X(10).
  1241         16  PI-SAV-ACCT         PIC X(10).
  1242         16  PI-SAV-CARR         PIC X.
  1243         16  PI-SAV-GROUP        PIC X(6).
  1244         16  PI-SAV-STATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  27
* EL640.cbl
  1245         16  PI-SAV-EXP-DT       PIC XX.
  1246         16  PI-BAL-FRWD-GA      PIC S9(7)V99   COMP-3.
  1247         16  PI-BAL-FRWD         PIC S9(7)V99   COMP-3.
  1248         16  PI-PREMIUM          PIC S9(7)V99   COMP-3.
  1249         16  PI-REMITTED         PIC S9(7)V99   COMP-3.
  1250         16  PI-TOT-ISS-COMP     PIC S9(7)V99   COMP-3.
  1251         16  PI-TOT-CAN-COMP     PIC S9(7)V99   COMP-3.
  1252         16  PI-ADJUSTMENTS      PIC S9(7)V99   COMP-3.
  1253         16  PI-DISBURSED        PIC S9(7)V99   COMP-3.
  1254         16  PI-END-BAL          PIC S9(7)V99   COMP-3.
  1255         16  PI-LF-ISS-COMP      PIC S9(7)V99   COMP-3.
  1256         16  PI-AH-ISS-COMP      PIC S9(7)V99   COMP-3.
  1257         16  PI-LF-CAN-COMP      PIC S9(7)V99   COMP-3.
  1258         16  PI-AH-CAN-COMP      PIC S9(7)V99   COMP-3.
  1259         16  PI-LIMIT-BILLING-BTCHS.
  1260             20  PI-BILLING-BATCHES   OCCURS 3 TIMES
  1261                                 PIC X(6).
  1262         16  PI-BILL-TYPE        PIC X.
  1263             88  PI-PREV-BILL        VALUE '1'.
  1264             88  PI-PREV-REBILL      VALUE '2'.
  1265             88  PI-PREVIEW          VALUE '1' '2'.
  1266             88  PI-BILL             VALUE '3'.
  1267             88  PI-REBILLING        VALUE '4'.
  1268             88  PI-VOID-BILL        VALUE '5'.
  1269             88  PI-TOT-REBILL       VALUE '2' '4'.
  1270             88  PI-UPDATE-FILES     VALUE '3' '4' '5'.
  1271             88  PI-BILLING-FUNCTION VALUE '1' '2' '3' '4'.
  1272         16  PI-BILL-ERRS        PIC X.
  1273         16  PI-CHECK-SW         PIC X.
  1274             88  PI-CHECK-PRODUCED   VALUE 'Y'.
  1275         16  PI-DATA-BILLED-SW   PIC X.
  1276             88  PI-DATA-BILLED      VALUE 'Y'.
  1277         16  PI-MONTH-END-DATE.
  1278             20  PI-ME-MONTH     PIC 99.
  1279             20  FILLER          PIC X.
  1280             20  PI-ME-DAY       PIC 99.
  1281             20  FILLER          PIC X.
  1282             20  PI-ME-YEAR      PIC 99.
  1283         16  PI-BILLING-COUNTS.
  1284             20  FILLER OCCURS 6 TIMES INDEXED BY PINDX.
  1285                 24  PI-BATCH    PIC X(6).
  1286                 24  PI-BILLED   PIC 9(6)  COMP-3.
  1287                 24  PI-PREV     PIC 9(6)  COMP-3.
  1288                 24  PI-NOBILL   PIC 9(6)  COMP-3.
  1289                 24  PI-PREM     PIC S9(7)V99   COMP-3.
  1290                 24  PI-COMM     PIC S9(7)V99   COMP-3.
  1291                 24  PI-NON-PREM PIC S9(7)V99   COMP-3.
  1292                 24  PI-NON-COMM PIC S9(7)V99   COMP-3.
  1293         16  PI-COMP-CONTROL.
  1294             20  PI-COMP-CARRIER     PIC X.
  1295             20  PI-COMP-GROUPING    PIC X(6).
  1296             20  PI-COMP-FIN-RESP    PIC X(10).
  1297         16  PI-SCRN-CONTROL.
  1298             20  PI-SCR-CARRIER      PIC X.
  1299             20  PI-SCR-GROUPING     PIC X(6).
  1300             20  PI-SCR-STATE        PIC X(02).
  1301             20  PI-SCR-ACCOUNT      PIC X(10).
  1302             20  PI-SCR-FIN-RESP     PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  28
* EL640.cbl
  1303             20  PI-SCR-TYPE         PIC X.
  1304         16  PI-TRANSFER-SW          PIC X.
  1305             88  PI-TRANSFER-BEFORE-ACT   VALUE 'Y'.
  1306         16  FILLER                  PIC X(200).
  1307
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  29
* EL640.cbl
  1309*                            COPY ELCJPFX.
  1310******************************************************************
  1311*                                                                *
  1312*                                                                *
  1313*                            ELCJPFX.                            *
  1314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1315*                            VMOD=2.002                          *
  1316*                                                                *
  1317*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1318*                                                                *
  1319*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1320*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1321*        ELCNTL - CONTROL FILE                                   *
  1322*        ELMSTR - CLAIM MASTERS                                  *
  1323*        ELTRLR - ACTIVITY TRAILERS                              *
  1324*        ELCHKQ - CHECK QUE                                      *
  1325******************************************************************
  1326 01  JOURNAL-RECORD.
  1327     12  JP-USER-ID                  PIC X(4).
  1328     12  JP-FILE-ID                  PIC X(8).
  1329     12  JP-PROGRAM-ID               PIC X(8).
  1330     12  JP-RECORD-TYPE              PIC X.
  1331         88 JP-ADD              VALUE 'A'.
  1332         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1333         88 JP-AFTER-CHANGE     VALUE 'C'.
  1334         88 JP-DELETE           VALUE 'D'.
  1335         88 JP-GENERIC-DELETE   VALUE 'G'.
  1336         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1337         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1338     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1339     12  JP-RECORD-AREA
  1340
  1341
  1342                             PIC X(1464).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  30
* EL640.cbl
  1344*                            COPY ELCAID.
  1345******************************************************************
  1346*                                                                *
  1347*                            ELCAID.                             *
  1348*                            VMOD=2.001                          *
  1349*                                                                *
  1350*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1351*                                                                *
  1352*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1353*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1354******************************************************************
  1355
  1356 01  DFHAID.
  1357   02  DFHNULL   PIC  X  VALUE  ' '.
  1358   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1359   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1360   02  DFHPEN    PIC  X  VALUE  '='.
  1361   02  DFHOPID   PIC  X  VALUE  'W'.
  1362   02  DFHPA1    PIC  X  VALUE  '%'.
  1363   02  DFHPA2    PIC  X  VALUE  '>'.
  1364   02  DFHPA3    PIC  X  VALUE  ','.
  1365   02  DFHPF1    PIC  X  VALUE  '1'.
  1366   02  DFHPF2    PIC  X  VALUE  '2'.
  1367   02  DFHPF3    PIC  X  VALUE  '3'.
  1368   02  DFHPF4    PIC  X  VALUE  '4'.
  1369   02  DFHPF5    PIC  X  VALUE  '5'.
  1370   02  DFHPF6    PIC  X  VALUE  '6'.
  1371   02  DFHPF7    PIC  X  VALUE  '7'.
  1372   02  DFHPF8    PIC  X  VALUE  '8'.
  1373   02  DFHPF9    PIC  X  VALUE  '9'.
  1374   02  DFHPF10   PIC  X  VALUE  ':'.
  1375   02  DFHPF11   PIC  X  VALUE  '#'.
  1376   02  DFHPF12   PIC  X  VALUE  '@'.
  1377   02  DFHPF13   PIC  X  VALUE  'A'.
  1378   02  DFHPF14   PIC  X  VALUE  'B'.
  1379   02  DFHPF15   PIC  X  VALUE  'C'.
  1380   02  DFHPF16   PIC  X  VALUE  'D'.
  1381   02  DFHPF17   PIC  X  VALUE  'E'.
  1382   02  DFHPF18   PIC  X  VALUE  'F'.
  1383   02  DFHPF19   PIC  X  VALUE  'G'.
  1384   02  DFHPF20   PIC  X  VALUE  'H'.
  1385   02  DFHPF21   PIC  X  VALUE  'I'.
  1386*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1387   02  DFHPF22   PIC  X  VALUE  '['.
  1388   02  DFHPF23   PIC  X  VALUE  '.'.
  1389   02  DFHPF24   PIC  X  VALUE  '<'.
  1390   02  DFHMSRE   PIC  X  VALUE  'X'.
  1391   02  DFHSTRF   PIC  X  VALUE  'h'.
  1392   02  DFHTRIG   PIC  X  VALUE  '"'.
  1393 01  FILLER    REDEFINES DFHAID.
  1394     12  FILLER              PIC X(8).
  1395     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  31
* EL640.cbl
  1397*                                         COPY EL640S.
  1398 01  EL640AI.
  1399     05  FILLER            PIC  X(0012).
  1400*    -------------------------------
  1401     05  ADATEL PIC S9(0004) COMP.
  1402     05  ADATEF PIC  X(0001).
  1403     05  FILLER REDEFINES ADATEF.
  1404         10  ADATEA PIC  X(0001).
  1405     05  ADATEI PIC  X(0008).
  1406*    -------------------------------
  1407     05  ATIMEL PIC S9(0004) COMP.
  1408     05  ATIMEF PIC  X(0001).
  1409     05  FILLER REDEFINES ATIMEF.
  1410         10  ATIMEA PIC  X(0001).
  1411     05  ATIMEI PIC  X(0005).
  1412*    -------------------------------
  1413     05  CMPNYIDL PIC S9(0004) COMP.
  1414     05  CMPNYIDF PIC  X(0001).
  1415     05  FILLER REDEFINES CMPNYIDF.
  1416         10  CMPNYIDA PIC  X(0001).
  1417     05  CMPNYIDI PIC  X(0003).
  1418*    -------------------------------
  1419     05  USERIDL PIC S9(0004) COMP.
  1420     05  USERIDF PIC  X(0001).
  1421     05  FILLER REDEFINES USERIDF.
  1422         10  USERIDA PIC  X(0001).
  1423     05  USERIDI PIC  X(0004).
  1424*    -------------------------------
  1425     05  AACTNAML PIC S9(0004) COMP.
  1426     05  AACTNAMF PIC  X(0001).
  1427     05  FILLER REDEFINES AACTNAMF.
  1428         10  AACTNAMA PIC  X(0001).
  1429     05  AACTNAMI PIC  X(0030).
  1430*    -------------------------------
  1431     05  ACARHDGL PIC S9(0004) COMP.
  1432     05  ACARHDGF PIC  X(0001).
  1433     05  FILLER REDEFINES ACARHDGF.
  1434         10  ACARHDGA PIC  X(0001).
  1435     05  ACARHDGI PIC  X(0007).
  1436*    -------------------------------
  1437     05  AGRPHDGL PIC S9(0004) COMP.
  1438     05  AGRPHDGF PIC  X(0001).
  1439     05  FILLER REDEFINES AGRPHDGF.
  1440         10  AGRPHDGA PIC  X(0001).
  1441     05  AGRPHDGI PIC  X(0005).
  1442*    -------------------------------
  1443     05  ASTHDGL PIC S9(0004) COMP.
  1444     05  ASTHDGF PIC  X(0001).
  1445     05  FILLER REDEFINES ASTHDGF.
  1446         10  ASTHDGA PIC  X(0001).
  1447     05  ASTHDGI PIC  X(0005).
  1448*    -------------------------------
  1449     05  AACCTL PIC S9(0004) COMP.
  1450     05  AACCTF PIC  X(0001).
  1451     05  FILLER REDEFINES AACCTF.
  1452         10  AACCTA PIC  X(0001).
  1453     05  AACCTI PIC  X(0010).
  1454*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  32
* EL640.cbl
  1455     05  ACARIERL PIC S9(0004) COMP.
  1456     05  ACARIERF PIC  X(0001).
  1457     05  FILLER REDEFINES ACARIERF.
  1458         10  ACARIERA PIC  X(0001).
  1459     05  ACARIERI PIC  X(0001).
  1460*    -------------------------------
  1461     05  AGROUPL PIC S9(0004) COMP.
  1462     05  AGROUPF PIC  X(0001).
  1463     05  FILLER REDEFINES AGROUPF.
  1464         10  AGROUPA PIC  X(0001).
  1465     05  AGROUPI PIC  X(0006).
  1466*    -------------------------------
  1467     05  ASTATEL PIC S9(0004) COMP.
  1468     05  ASTATEF PIC  X(0001).
  1469     05  FILLER REDEFINES ASTATEF.
  1470         10  ASTATEA PIC  X(0001).
  1471     05  ASTATEI PIC  X(0002).
  1472*    -------------------------------
  1473     05  ABALFWDL PIC S9(0004) COMP.
  1474     05  ABALFWDF PIC  X(0001).
  1475     05  FILLER REDEFINES ABALFWDF.
  1476         10  ABALFWDA PIC  X(0001).
  1477     05  ABALFWDI PIC  X(0011).
  1478*    -------------------------------
  1479     05  APREMUML PIC S9(0004) COMP.
  1480     05  APREMUMF PIC  X(0001).
  1481     05  FILLER REDEFINES APREMUMF.
  1482         10  APREMUMA PIC  X(0001).
  1483     05  APREMUMI PIC  X(0011).
  1484*    -------------------------------
  1485     05  AHD1L PIC S9(0004) COMP.
  1486     05  AHD1F PIC  X(0001).
  1487     05  FILLER REDEFINES AHD1F.
  1488         10  AHD1A PIC  X(0001).
  1489     05  AHD1I PIC  X(0018).
  1490*    -------------------------------
  1491     05  AREMITL PIC S9(0004) COMP.
  1492     05  AREMITF PIC  X(0001).
  1493     05  FILLER REDEFINES AREMITF.
  1494         10  AREMITA PIC  X(0001).
  1495     05  AREMITI PIC  X(0011).
  1496*    -------------------------------
  1497     05  ABATCH1L PIC S9(0004) COMP.
  1498     05  ABATCH1F PIC  X(0001).
  1499     05  FILLER REDEFINES ABATCH1F.
  1500         10  ABATCH1A PIC  X(0001).
  1501     05  ABATCH1I PIC  X(0006).
  1502*    -------------------------------
  1503     05  ABILL1L PIC S9(0004) COMP.
  1504     05  ABILL1F PIC  X(0001).
  1505     05  FILLER REDEFINES ABILL1F.
  1506         10  ABILL1A PIC  X(0001).
  1507     05  ABILL1I PIC  X(0006).
  1508*    -------------------------------
  1509     05  APREV1L PIC S9(0004) COMP.
  1510     05  APREV1F PIC  X(0001).
  1511     05  FILLER REDEFINES APREV1F.
  1512         10  APREV1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  33
* EL640.cbl
  1513     05  APREV1I PIC  X(0006).
  1514*    -------------------------------
  1515     05  ANOBIL1L PIC S9(0004) COMP.
  1516     05  ANOBIL1F PIC  X(0001).
  1517     05  FILLER REDEFINES ANOBIL1F.
  1518         10  ANOBIL1A PIC  X(0001).
  1519     05  ANOBIL1I PIC  X(0006).
  1520*    -------------------------------
  1521     05  AHD2L PIC S9(0004) COMP.
  1522     05  AHD2F PIC  X(0001).
  1523     05  FILLER REDEFINES AHD2F.
  1524         10  AHD2A PIC  X(0001).
  1525     05  AHD2I PIC  X(0018).
  1526*    -------------------------------
  1527     05  ACOMPISL PIC S9(0004) COMP.
  1528     05  ACOMPISF PIC  X(0001).
  1529     05  FILLER REDEFINES ACOMPISF.
  1530         10  ACOMPISA PIC  X(0001).
  1531     05  ACOMPISI PIC  X(0011).
  1532*    -------------------------------
  1533     05  ABATCH2L PIC S9(0004) COMP.
  1534     05  ABATCH2F PIC  X(0001).
  1535     05  FILLER REDEFINES ABATCH2F.
  1536         10  ABATCH2A PIC  X(0001).
  1537     05  ABATCH2I PIC  X(0006).
  1538*    -------------------------------
  1539     05  ABILL2L PIC S9(0004) COMP.
  1540     05  ABILL2F PIC  X(0001).
  1541     05  FILLER REDEFINES ABILL2F.
  1542         10  ABILL2A PIC  X(0001).
  1543     05  ABILL2I PIC  X(0006).
  1544*    -------------------------------
  1545     05  APREV2L PIC S9(0004) COMP.
  1546     05  APREV2F PIC  X(0001).
  1547     05  FILLER REDEFINES APREV2F.
  1548         10  APREV2A PIC  X(0001).
  1549     05  APREV2I PIC  X(0006).
  1550*    -------------------------------
  1551     05  ANOBIL2L PIC S9(0004) COMP.
  1552     05  ANOBIL2F PIC  X(0001).
  1553     05  FILLER REDEFINES ANOBIL2F.
  1554         10  ANOBIL2A PIC  X(0001).
  1555     05  ANOBIL2I PIC  X(0006).
  1556*    -------------------------------
  1557     05  AHD3L PIC S9(0004) COMP.
  1558     05  AHD3F PIC  X(0001).
  1559     05  FILLER REDEFINES AHD3F.
  1560         10  AHD3A PIC  X(0001).
  1561     05  AHD3I PIC  X(0018).
  1562*    -------------------------------
  1563     05  ACOMCANL PIC S9(0004) COMP.
  1564     05  ACOMCANF PIC  X(0001).
  1565     05  FILLER REDEFINES ACOMCANF.
  1566         10  ACOMCANA PIC  X(0001).
  1567     05  ACOMCANI PIC  X(0011).
  1568*    -------------------------------
  1569     05  ABATCH3L PIC S9(0004) COMP.
  1570     05  ABATCH3F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  34
* EL640.cbl
  1571     05  FILLER REDEFINES ABATCH3F.
  1572         10  ABATCH3A PIC  X(0001).
  1573     05  ABATCH3I PIC  X(0006).
  1574*    -------------------------------
  1575     05  ABILL3L PIC S9(0004) COMP.
  1576     05  ABILL3F PIC  X(0001).
  1577     05  FILLER REDEFINES ABILL3F.
  1578         10  ABILL3A PIC  X(0001).
  1579     05  ABILL3I PIC  X(0006).
  1580*    -------------------------------
  1581     05  APREV3L PIC S9(0004) COMP.
  1582     05  APREV3F PIC  X(0001).
  1583     05  FILLER REDEFINES APREV3F.
  1584         10  APREV3A PIC  X(0001).
  1585     05  APREV3I PIC  X(0006).
  1586*    -------------------------------
  1587     05  ANOBIL3L PIC S9(0004) COMP.
  1588     05  ANOBIL3F PIC  X(0001).
  1589     05  FILLER REDEFINES ANOBIL3F.
  1590         10  ANOBIL3A PIC  X(0001).
  1591     05  ANOBIL3I PIC  X(0006).
  1592*    -------------------------------
  1593     05  AHD4L PIC S9(0004) COMP.
  1594     05  AHD4F PIC  X(0001).
  1595     05  FILLER REDEFINES AHD4F.
  1596         10  AHD4A PIC  X(0001).
  1597     05  AHD4I PIC  X(0018).
  1598*    -------------------------------
  1599     05  AADJUSTL PIC S9(0004) COMP.
  1600     05  AADJUSTF PIC  X(0001).
  1601     05  FILLER REDEFINES AADJUSTF.
  1602         10  AADJUSTA PIC  X(0001).
  1603     05  AADJUSTI PIC  X(0011).
  1604*    -------------------------------
  1605     05  ABATCH4L PIC S9(0004) COMP.
  1606     05  ABATCH4F PIC  X(0001).
  1607     05  FILLER REDEFINES ABATCH4F.
  1608         10  ABATCH4A PIC  X(0001).
  1609     05  ABATCH4I PIC  X(0006).
  1610*    -------------------------------
  1611     05  ABILL4L PIC S9(0004) COMP.
  1612     05  ABILL4F PIC  X(0001).
  1613     05  FILLER REDEFINES ABILL4F.
  1614         10  ABILL4A PIC  X(0001).
  1615     05  ABILL4I PIC  X(0006).
  1616*    -------------------------------
  1617     05  APREV4L PIC S9(0004) COMP.
  1618     05  APREV4F PIC  X(0001).
  1619     05  FILLER REDEFINES APREV4F.
  1620         10  APREV4A PIC  X(0001).
  1621     05  APREV4I PIC  X(0006).
  1622*    -------------------------------
  1623     05  ANOBIL4L PIC S9(0004) COMP.
  1624     05  ANOBIL4F PIC  X(0001).
  1625     05  FILLER REDEFINES ANOBIL4F.
  1626         10  ANOBIL4A PIC  X(0001).
  1627     05  ANOBIL4I PIC  X(0006).
  1628*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  35
* EL640.cbl
  1629     05  AHD5L PIC S9(0004) COMP.
  1630     05  AHD5F PIC  X(0001).
  1631     05  FILLER REDEFINES AHD5F.
  1632         10  AHD5A PIC  X(0001).
  1633     05  AHD5I PIC  X(0018).
  1634*    -------------------------------
  1635     05  ADISBURL PIC S9(0004) COMP.
  1636     05  ADISBURF PIC  X(0001).
  1637     05  FILLER REDEFINES ADISBURF.
  1638         10  ADISBURA PIC  X(0001).
  1639     05  ADISBURI PIC  X(0011).
  1640*    -------------------------------
  1641     05  ABATCH5L PIC S9(0004) COMP.
  1642     05  ABATCH5F PIC  X(0001).
  1643     05  FILLER REDEFINES ABATCH5F.
  1644         10  ABATCH5A PIC  X(0001).
  1645     05  ABATCH5I PIC  X(0006).
  1646*    -------------------------------
  1647     05  ABILL5L PIC S9(0004) COMP.
  1648     05  ABILL5F PIC  X(0001).
  1649     05  FILLER REDEFINES ABILL5F.
  1650         10  ABILL5A PIC  X(0001).
  1651     05  ABILL5I PIC  X(0006).
  1652*    -------------------------------
  1653     05  APREV5L PIC S9(0004) COMP.
  1654     05  APREV5F PIC  X(0001).
  1655     05  FILLER REDEFINES APREV5F.
  1656         10  APREV5A PIC  X(0001).
  1657     05  APREV5I PIC  X(0006).
  1658*    -------------------------------
  1659     05  ANOBIL5L PIC S9(0004) COMP.
  1660     05  ANOBIL5F PIC  X(0001).
  1661     05  FILLER REDEFINES ANOBIL5F.
  1662         10  ANOBIL5A PIC  X(0001).
  1663     05  ANOBIL5I PIC  X(0006).
  1664*    -------------------------------
  1665     05  AENDHDGL PIC S9(0004) COMP.
  1666     05  AENDHDGF PIC  X(0001).
  1667     05  FILLER REDEFINES AENDHDGF.
  1668         10  AENDHDGA PIC  X(0001).
  1669     05  AENDHDGI PIC  X(0018).
  1670*    -------------------------------
  1671     05  ANETDUEL PIC S9(0004) COMP.
  1672     05  ANETDUEF PIC  X(0001).
  1673     05  FILLER REDEFINES ANETDUEF.
  1674         10  ANETDUEA PIC  X(0001).
  1675     05  ANETDUEI PIC  X(0011).
  1676*    -------------------------------
  1677     05  ABATCH6L PIC S9(0004) COMP.
  1678     05  ABATCH6F PIC  X(0001).
  1679     05  FILLER REDEFINES ABATCH6F.
  1680         10  ABATCH6A PIC  X(0001).
  1681     05  ABATCH6I PIC  X(0006).
  1682*    -------------------------------
  1683     05  ABILL6L PIC S9(0004) COMP.
  1684     05  ABILL6F PIC  X(0001).
  1685     05  FILLER REDEFINES ABILL6F.
  1686         10  ABILL6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  36
* EL640.cbl
  1687     05  ABILL6I PIC  X(0006).
  1688*    -------------------------------
  1689     05  APREV6L PIC S9(0004) COMP.
  1690     05  APREV6F PIC  X(0001).
  1691     05  FILLER REDEFINES APREV6F.
  1692         10  APREV6A PIC  X(0001).
  1693     05  APREV6I PIC  X(0006).
  1694*    -------------------------------
  1695     05  ANOBIL6L PIC S9(0004) COMP.
  1696     05  ANOBIL6F PIC  X(0001).
  1697     05  FILLER REDEFINES ANOBIL6F.
  1698         10  ANOBIL6A PIC  X(0001).
  1699     05  ANOBIL6I PIC  X(0006).
  1700*    -------------------------------
  1701     05  ABILTYPL PIC S9(0004) COMP.
  1702     05  ABILTYPF PIC  X(0001).
  1703     05  FILLER REDEFINES ABILTYPF.
  1704         10  ABILTYPA PIC  X(0001).
  1705     05  ABILTYPI PIC  X(0001).
  1706*    -------------------------------
  1707     05  APRODSWL PIC S9(0004) COMP.
  1708     05  APRODSWF PIC  X(0001).
  1709     05  FILLER REDEFINES APRODSWF.
  1710         10  APRODSWA PIC  X(0001).
  1711     05  APRODSWI PIC  X(0001).
  1712*    -------------------------------
  1713     05  ABILERRL PIC S9(0004) COMP.
  1714     05  ABILERRF PIC  X(0001).
  1715     05  FILLER REDEFINES ABILERRF.
  1716         10  ABILERRA PIC  X(0001).
  1717     05  ABILERRI PIC  X(0001).
  1718*    -------------------------------
  1719     05  ABTCH1L PIC S9(0004) COMP.
  1720     05  ABTCH1F PIC  X(0001).
  1721     05  FILLER REDEFINES ABTCH1F.
  1722         10  ABTCH1A PIC  X(0001).
  1723     05  ABTCH1I PIC  X(0006).
  1724*    -------------------------------
  1725     05  ABTCH2L PIC S9(0004) COMP.
  1726     05  ABTCH2F PIC  X(0001).
  1727     05  FILLER REDEFINES ABTCH2F.
  1728         10  ABTCH2A PIC  X(0001).
  1729     05  ABTCH2I PIC  X(0006).
  1730*    -------------------------------
  1731     05  ABTCH3L PIC S9(0004) COMP.
  1732     05  ABTCH3F PIC  X(0001).
  1733     05  FILLER REDEFINES ABTCH3F.
  1734         10  ABTCH3A PIC  X(0001).
  1735     05  ABTCH3I PIC  X(0006).
  1736*    -------------------------------
  1737     05  AERMSG1L PIC S9(0004) COMP.
  1738     05  AERMSG1F PIC  X(0001).
  1739     05  FILLER REDEFINES AERMSG1F.
  1740         10  AERMSG1A PIC  X(0001).
  1741     05  AERMSG1I PIC  X(0076).
  1742*    -------------------------------
  1743     05  AERMSG2L PIC S9(0004) COMP.
  1744     05  AERMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  37
* EL640.cbl
  1745     05  FILLER REDEFINES AERMSG2F.
  1746         10  AERMSG2A PIC  X(0001).
  1747     05  AERMSG2I PIC  X(0076).
  1748*    -------------------------------
  1749     05  APFNTERL PIC S9(0004) COMP.
  1750     05  APFNTERF PIC  X(0001).
  1751     05  FILLER REDEFINES APFNTERF.
  1752         10  APFNTERA PIC  X(0001).
  1753     05  APFNTERI PIC  9(2).
  1754*    -------------------------------
  1755     05  APF5HDGL PIC S9(0004) COMP.
  1756     05  APF5HDGF PIC  X(0001).
  1757     05  FILLER REDEFINES APF5HDGF.
  1758         10  APF5HDGA PIC  X(0001).
  1759     05  APF5HDGI PIC  X(0020).
  1760*    -------------------------------
  1761     05  AGAHDGL PIC S9(0004) COMP.
  1762     05  AGAHDGF PIC  X(0001).
  1763     05  FILLER REDEFINES AGAHDGF.
  1764         10  AGAHDGA PIC  X(0001).
  1765     05  AGAHDGI PIC  X(0025).
  1766 01  EL640AO REDEFINES EL640AI.
  1767     05  FILLER            PIC  X(0012).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  ADATEO PIC  X(0008).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  ATIMEO PIC  99.99.
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  CMPNYIDO PIC  X(0003).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  USERIDO PIC  X(0004).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  AACTNAMO PIC  X(0030).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  ACARHDGO PIC  X(0007).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  AGRPHDGO PIC  X(0005).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  ASTHDGO PIC  X(0005).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  AACCTO PIC  X(0010).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  ACARIERO PIC  X(0001).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  AGROUPO PIC  X(0006).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  38
* EL640.cbl
  1803     05  ASTATEO PIC  X(0002).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  ABALFWDO PIC  ZZZZZZ9.99-.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  APREMUMO PIC  ZZZZZZ9.99-.
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  AHD1O PIC  X(0018).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  AREMITO PIC  ZZZZZZ9.99-.
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  ABATCH1O PIC  X(0006).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  ABILL1O PIC  Z(5)9.
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  APREV1O PIC  Z(5)9.
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  ANOBIL1O PIC  Z(5)9.
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  AHD2O PIC  X(0018).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  ACOMPISO PIC  ZZZZZZ9.99-.
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  ABATCH2O PIC  X(0006).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  ABILL2O PIC  Z(5)9.
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  APREV2O PIC  Z(5)9.
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  ANOBIL2O PIC  Z(5)9.
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  AHD3O PIC  X(0018).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  ACOMCANO PIC  ZZZZZZ9.99-.
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  ABATCH3O PIC  X(0006).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  ABILL3O PIC  Z(5)9.
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  APREV3O PIC  Z(5)9.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  39
* EL640.cbl
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  ANOBIL3O PIC  Z(5)9.
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  AHD4O PIC  X(0018).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  AADJUSTO PIC  ZZZZZZ9.99-.
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  ABATCH4O PIC  X(0006).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  ABILL4O PIC  Z(5)9.
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  APREV4O PIC  Z(5)9.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  ANOBIL4O PIC  Z(5)9.
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  AHD5O PIC  X(0018).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  ADISBURO PIC  ZZZZZZ9.99-.
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  ABATCH5O PIC  X(0006).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  ABILL5O PIC  Z(5)9.
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  APREV5O PIC  Z(5)9.
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  ANOBIL5O PIC  Z(5)9.
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  AENDHDGO PIC  X(0018).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  ANETDUEO PIC  ZZZZZZ9.99-.
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  ABATCH6O PIC  X(0006).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  ABILL6O PIC  Z(5)9.
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  APREV6O PIC  Z(5)9.
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  ANOBIL6O PIC  Z(5)9.
  1918*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  40
* EL640.cbl
  1919     05  FILLER            PIC  X(0003).
  1920     05  ABILTYPO PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  APRODSWO PIC  X(0001).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  ABILERRO PIC  X(0001).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  ABTCH1O PIC  X(0006).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  ABTCH2O PIC  X(0006).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  ABTCH3O PIC  X(0006).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  AERMSG1O PIC  X(0076).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  AERMSG2O PIC  X(0076).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  APFNTERO PIC  99.
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  APF5HDGO PIC  X(0020).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  AGAHDGO PIC  X(0025).
  1951*    -------------------------------
  1952 01  EL640BI REDEFINES EL640AI.
  1953     05  FILLER            PIC  X(0012).
  1954*    -------------------------------
  1955     05  BDATEL PIC S9(0004) COMP.
  1956     05  BDATEF PIC  X(0001).
  1957     05  FILLER REDEFINES BDATEF.
  1958         10  BDATEA PIC  X(0001).
  1959     05  BDATEI PIC  X(0008).
  1960*    -------------------------------
  1961     05  BTIMEL PIC S9(0004) COMP.
  1962     05  BTIMEF PIC  X(0001).
  1963     05  FILLER REDEFINES BTIMEF.
  1964         10  BTIMEA PIC  X(0001).
  1965     05  BTIMEI PIC  X(0005).
  1966*    -------------------------------
  1967     05  BCMPNYL PIC S9(0004) COMP.
  1968     05  BCMPNYF PIC  X(0001).
  1969     05  FILLER REDEFINES BCMPNYF.
  1970         10  BCMPNYA PIC  X(0001).
  1971     05  BCMPNYI PIC  X(0003).
  1972*    -------------------------------
  1973     05  BUSERIDL PIC S9(0004) COMP.
  1974     05  BUSERIDF PIC  X(0001).
  1975     05  FILLER REDEFINES BUSERIDF.
  1976         10  BUSERIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  41
* EL640.cbl
  1977     05  BUSERIDI PIC  X(0004).
  1978*    -------------------------------
  1979     05  BCHKNOL PIC S9(0004) COMP.
  1980     05  BCHKNOF PIC  X(0001).
  1981     05  FILLER REDEFINES BCHKNOF.
  1982         10  BCHKNOA PIC  X(0001).
  1983     05  BCHKNOI PIC  9(6).
  1984*    -------------------------------
  1985     05  BNAMEL PIC S9(0004) COMP.
  1986     05  BNAMEF PIC  X(0001).
  1987     05  FILLER REDEFINES BNAMEF.
  1988         10  BNAMEA PIC  X(0001).
  1989     05  BNAMEI PIC  X(0029).
  1990*    -------------------------------
  1991     05  BCHKAMTL PIC S9(0004) COMP.
  1992     05  BCHKAMTF PIC  X(0001).
  1993     05  FILLER REDEFINES BCHKAMTF.
  1994         10  BCHKAMTA PIC  X(0001).
  1995     05  BCHKAMTI PIC  S9(9)V99.
  1996*    -------------------------------
  1997     05  BADDR1L PIC S9(0004) COMP.
  1998     05  BADDR1F PIC  X(0001).
  1999     05  FILLER REDEFINES BADDR1F.
  2000         10  BADDR1A PIC  X(0001).
  2001     05  BADDR1I PIC  X(0029).
  2002*    -------------------------------
  2003     05  BADDR2L PIC S9(0004) COMP.
  2004     05  BADDR2F PIC  X(0001).
  2005     05  FILLER REDEFINES BADDR2F.
  2006         10  BADDR2A PIC  X(0001).
  2007     05  BADDR2I PIC  X(0029).
  2008*    -------------------------------
  2009     05  BPAYDT1L PIC S9(0004) COMP.
  2010     05  BPAYDT1F PIC  X(0001).
  2011     05  FILLER REDEFINES BPAYDT1F.
  2012         10  BPAYDT1A PIC  X(0001).
  2013     05  BPAYDT1I PIC  X(0008).
  2014*    -------------------------------
  2015     05  BCITYSTL PIC S9(0004) COMP.
  2016     05  BCITYSTF PIC  X(0001).
  2017     05  FILLER REDEFINES BCITYSTF.
  2018         10  BCITYSTA PIC  X(0001).
  2019     05  BCITYSTI PIC  X(0029).
  2020*    -------------------------------
  2021     05  BPAYDT2L PIC S9(0004) COMP.
  2022     05  BPAYDT2F PIC  X(0001).
  2023     05  FILLER REDEFINES BPAYDT2F.
  2024         10  BPAYDT2A PIC  X(0001).
  2025     05  BPAYDT2I PIC  X(0008).
  2026*    -------------------------------
  2027     05  BZIPL PIC S9(0004) COMP.
  2028     05  BZIPF PIC  X(0001).
  2029     05  FILLER REDEFINES BZIPF.
  2030         10  BZIPA PIC  X(0001).
  2031     05  BZIPI PIC  X(0010).
  2032*    -------------------------------
  2033     05  BACCNAML PIC S9(0004) COMP.
  2034     05  BACCNAMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  42
* EL640.cbl
  2035     05  FILLER REDEFINES BACCNAMF.
  2036         10  BACCNAMA PIC  X(0001).
  2037     05  BACCNAMI PIC  X(0030).
  2038*    -------------------------------
  2039     05  BACCTL PIC S9(0004) COMP.
  2040     05  BACCTF PIC  X(0001).
  2041     05  FILLER REDEFINES BACCTF.
  2042         10  BACCTA PIC  X(0001).
  2043     05  BACCTI PIC  X(0010).
  2044*    -------------------------------
  2045     05  BCARIERL PIC S9(0004) COMP.
  2046     05  BCARIERF PIC  X(0001).
  2047     05  FILLER REDEFINES BCARIERF.
  2048         10  BCARIERA PIC  X(0001).
  2049     05  BCARIERI PIC  X(0001).
  2050*    -------------------------------
  2051     05  BGROUPL PIC S9(0004) COMP.
  2052     05  BGROUPF PIC  X(0001).
  2053     05  FILLER REDEFINES BGROUPF.
  2054         10  BGROUPA PIC  X(0001).
  2055     05  BGROUPI PIC  X(0006).
  2056*    -------------------------------
  2057     05  BSTATEL PIC S9(0004) COMP.
  2058     05  BSTATEF PIC  X(0001).
  2059     05  FILLER REDEFINES BSTATEF.
  2060         10  BSTATEA PIC  X(0001).
  2061     05  BSTATEI PIC  X(0002).
  2062*    -------------------------------
  2063     05  BFORM1L PIC S9(0004) COMP.
  2064     05  BFORM1F PIC  X(0001).
  2065     05  FILLER REDEFINES BFORM1F.
  2066         10  BFORM1A PIC  X(0001).
  2067     05  BFORM1I PIC  X(0004).
  2068*    -------------------------------
  2069     05  BFORM2L PIC S9(0004) COMP.
  2070     05  BFORM2F PIC  X(0001).
  2071     05  FILLER REDEFINES BFORM2F.
  2072         10  BFORM2A PIC  X(0001).
  2073     05  BFORM2I PIC  X(0004).
  2074*    -------------------------------
  2075     05  BFORM3L PIC S9(0004) COMP.
  2076     05  BFORM3F PIC  X(0001).
  2077     05  FILLER REDEFINES BFORM3F.
  2078         10  BFORM3A PIC  X(0001).
  2079     05  BFORM3I PIC  X(0004).
  2080*    -------------------------------
  2081     05  BALAMTL PIC S9(0004) COMP.
  2082     05  BALAMTF PIC  X(0001).
  2083     05  FILLER REDEFINES BALAMTF.
  2084         10  BALAMTA PIC  X(0001).
  2085     05  BALAMTI PIC  X(0011).
  2086*    -------------------------------
  2087     05  BERMSGL PIC S9(0004) COMP.
  2088     05  BERMSGF PIC  X(0001).
  2089     05  FILLER REDEFINES BERMSGF.
  2090         10  BERMSGA PIC  X(0001).
  2091     05  BERMSGI PIC  X(0078).
  2092*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  43
* EL640.cbl
  2093     05  BPFNTERL PIC S9(0004) COMP.
  2094     05  BPFNTERF PIC  X(0001).
  2095     05  FILLER REDEFINES BPFNTERF.
  2096         10  BPFNTERA PIC  X(0001).
  2097     05  BPFNTERI PIC  9(2).
  2098 01  EL640BO REDEFINES EL640AI.
  2099     05  FILLER            PIC  X(0012).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  BDATEO PIC  X(0008).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  BTIMEO PIC  99.99.
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  BCMPNYO PIC  X(0003).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  BUSERIDO PIC  X(0004).
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
  2114     05  BCHKNOO PIC  X(0006).
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  BNAMEO PIC  X(0029).
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  BCHKAMTO PIC  Z(7).ZZ-.
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  BADDR1O PIC  X(0029).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  BADDR2O PIC  X(0029).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  BPAYDT1O PIC  X(0008).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  BCITYSTO PIC  X(0029).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  BPAYDT2O PIC  X(0008).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  BZIPO PIC  X(0010).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  BACCNAMO PIC  X(0030).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  BACCTO PIC  X(0010).
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  BCARIERO PIC  X(0001).
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  BGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  44
* EL640.cbl
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  BSTATEO PIC  X(0002).
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  BFORM1O PIC  X(0004).
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  BFORM2O PIC  X(0004).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  BFORM3O PIC  X(0004).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  BALAMTO PIC  Z(7).99-.
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  BERMSGO PIC  X(0078).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  BPFNTERO PIC  9(2).
  2172*    -------------------------------
  2173 01  MAP-A REDEFINES EL640AO.
  2174     12  FILLER                  PIC X(162).
  2175     12  FILLER OCCURS 6 TIMES INDEXED BY ANDX.
  2176         16  FILLER              PIC X(35).
  2177         16  BATCH-LEN           PIC S9(4)   COMP.
  2178         16  BATCH-ATTRB         PIC X.
  2179         16  BATCH               PIC X(6).
  2180         16  BILL-LEN            PIC S9(4)   COMP.
  2181         16  BILL-ATTRB          PIC X.
  2182         16  BILL                PIC Z(6).
  2183         16  PREV-LEN            PIC S9(4)   COMP.
  2184         16  PREV-ATTRB          PIC X.
  2185         16  PREV                PIC Z(6).
  2186         16  NOBILL-LEN          PIC S9(4)   COMP.
  2187         16  NOBILL-ATTRB        PIC X.
  2188         16  NOBILL              PIC Z(6).
  2189****************************************************************
  2190*
  2191* Copyright (c) 2007 by Clerity Solutions, Inc.
  2192* All rights reserved.
  2193*
  2194****************************************************************
  2195 01  DFHEIV.
  2196   02  DFHEIV0               PIC X(35).
  2197   02  DFHEIV1               PIC X(08).
  2198   02  DFHEIV2               PIC X(08).
  2199   02  DFHEIV3               PIC X(08).
  2200   02  DFHEIV4               PIC X(06).
  2201   02  DFHEIV5               PIC X(04).
  2202   02  DFHEIV6               PIC X(04).
  2203   02  DFHEIV7               PIC X(02).
  2204   02  DFHEIV8               PIC X(02).
  2205   02  DFHEIV9               PIC X(01).
  2206   02  DFHEIV10              PIC S9(7) COMP-3.
  2207   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2208   02  DFHEIV12              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  45
* EL640.cbl
  2209   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2210   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2211   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2212   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2213   02  DFHEIV17              PIC X(04).
  2214   02  DFHEIV18              PIC X(04).
  2215   02  DFHEIV19              PIC X(04).
  2216   02  DFHEIV20              USAGE IS POINTER.
  2217   02  DFHEIV21              USAGE IS POINTER.
  2218   02  DFHEIV22              USAGE IS POINTER.
  2219   02  DFHEIV23              USAGE IS POINTER.
  2220   02  DFHEIV24              USAGE IS POINTER.
  2221   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2222   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2223   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2224   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2225   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2226   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2227   02  FILLER                PIC X(02).
  2228   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2229   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2230   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2231   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2232   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2233 LINKAGE  SECTION.
  2234*****************************************************************
  2235*                                                               *
  2236* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2237* All rights reserved.                                          *
  2238*                                                               *
  2239*****************************************************************
  2240 01  dfheiblk.
  2241     02  eibtime          pic s9(7) comp-3.
  2242     02  eibdate          pic s9(7) comp-3.
  2243     02  eibtrnid         pic x(4).
  2244     02  eibtaskn         pic s9(7) comp-3.
  2245     02  eibtrmid         pic x(4).
  2246     02  dfheigdi         pic s9(4) comp.
  2247     02  eibcposn         pic s9(4) comp.
  2248     02  eibcalen         pic s9(4) comp.
  2249     02  eibaid           pic x(1).
  2250     02  eibfiller1       pic x(1).
  2251     02  eibfn            pic x(2).
  2252     02  eibfiller2       pic x(2).
  2253     02  eibrcode         pic x(6).
  2254     02  eibfiller3       pic x(2).
  2255     02  eibds            pic x(8).
  2256     02  eibreqid         pic x(8).
  2257     02  eibrsrce         pic x(8).
  2258     02  eibsync          pic x(1).
  2259     02  eibfree          pic x(1).
  2260     02  eibrecv          pic x(1).
  2261     02  eibsend          pic x(1).
  2262     02  eibatt           pic x(1).
  2263     02  eibeoc           pic x(1).
  2264     02  eibfmh           pic x(1).
  2265     02  eibcompl         pic x(1).
  2266     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  46
* EL640.cbl
  2267     02  eibconf          pic x(1).
  2268     02  eiberr           pic x(1).
  2269     02  eibrldbk         pic x(1).
  2270     02  eiberrcd         pic x(4).
  2271     02  eibsynrb         pic x(1).
  2272     02  eibnodat         pic x(1).
  2273     02  eibfiller5       pic x(2).
  2274     02  eibresp          pic 9(09) comp.
  2275     02  eibresp2         pic 9(09) comp.
  2276     02  dfheigdj         pic s9(4) comp.
  2277     02  dfheigdk         pic s9(4) comp.
  2278 01  DFHCOMMAREA             PIC X(1024).
  2279
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  47
* EL640.cbl
  2282*                            COPY ERCPNDB.
  2283******************************************************************
  2284*                                                                *
  2285*                                                                *
  2286*                            ERCPNDB.                            *
  2287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2288*                            VMOD=2.025                          *
  2289*                                                                *
  2290*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2291*                                                                *
  2292******************************************************************
  2293*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2294*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2295******************************************************************
  2296*                                                                *
  2297*                                                                *
  2298*   FILE TYPE = VSAM,KSDS                                        *
  2299*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2300*                                                                *
  2301*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2302*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2303*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2304*                                                 RKP=13,LEN=36  *
  2305*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2306*                                      AND CHG-SEQ.)             *
  2307*                                                RKP=49,LEN=11   *
  2308*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2309*                                      AND CHG-SEQ.)             *
  2310*                                                RKP=60,LEN=15   *
  2311*                                                                *
  2312*   LOG = NO                                                     *
  2313*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2314******************************************************************
  2315******************************************************************
  2316*                   C H A N G E   L O G
  2317*
  2318* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2319*-----------------------------------------------------------------
  2320*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2321* EFFECTIVE    NUMBER
  2322*-----------------------------------------------------------------
  2323* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2324* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2325* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2326* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2327* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2328* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2329* 032306                   PEMA  ADD BOW LOAN NUMBER
  2330* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2331* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2332* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2333* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2334* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2335* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2336* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2337* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2338******************************************************************
  2339
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  48
* EL640.cbl
  2340 01  PENDING-BUSINESS.
  2341     12  PB-RECORD-ID                     PIC XX.
  2342         88  VALID-PB-ID                        VALUE 'PB'.
  2343
  2344     12  PB-CONTROL-PRIMARY.
  2345         16  PB-COMPANY-CD                PIC X.
  2346         16  PB-ENTRY-BATCH               PIC X(6).
  2347         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2348         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2349
  2350     12  PB-CONTROL-BY-ACCOUNT.
  2351         16  PB-COMPANY-CD-A1             PIC X.
  2352         16  PB-CARRIER                   PIC X.
  2353         16  PB-GROUPING.
  2354             20  PB-GROUPING-PREFIX       PIC XXX.
  2355             20  PB-GROUPING-PRIME        PIC XXX.
  2356         16  PB-STATE                     PIC XX.
  2357         16  PB-ACCOUNT.
  2358             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2359             20  PB-ACCOUNT-PRIME         PIC X(6).
  2360         16  PB-CERT-EFF-DT               PIC XX.
  2361         16  PB-CERT-NO.
  2362             20  PB-CERT-PRIME            PIC X(10).
  2363             20  PB-CERT-SFX              PIC X.
  2364         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2365
  2366         16  PB-RECORD-TYPE               PIC X.
  2367             88  PB-MAILING-DATA                VALUE '0'.
  2368             88  PB-ISSUE                       VALUE '1'.
  2369             88  PB-CANCELLATION                VALUE '2'.
  2370             88  PB-BATCH-TRAILER               VALUE '9'.
  2371
  2372     12  PB-CONTROL-BY-ORIG-BATCH.
  2373         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2374         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2375         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2376         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2377
  2378     12  PB-CONTROL-BY-CSR.
  2379         16  PB-CSR-COMPANY-CD            PIC X.
  2380         16  PB-CSR-ID                    PIC X(4).
  2381         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2382         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2383         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2384******************************************************************
  2385*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2386******************************************************************
  2387
  2388     12  PB-LAST-MAINT-DT                 PIC XX.
  2389     12  PB-LAST-MAINT-BY                 PIC X(4).
  2390     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2391
  2392     12  PB-RECORD-BODY                   PIC X(375).
  2393
  2394     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2395         16  PB-CERT-ORIGIN               PIC X.
  2396             88  CLASIC-CREATED-CERT         VALUE '1'.
  2397         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  49
* EL640.cbl
  2398             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2399             20  PB-I-INSURED-FIRST-NAME.
  2400                 24  PB-I-INSURED-1ST-INIT PIC X.
  2401                 24  FILLER                PIC X(9).
  2402             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2403         16  PB-I-AGE                     PIC S99   COMP-3.
  2404         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2405         16  PB-I-BIRTHDAY                PIC XX.
  2406         16  PB-I-INSURED-SEX             PIC X.
  2407             88  PB-SEX-MALE     VALUE 'M'.
  2408             88  PB-SEX-FEMALE   VALUE 'F'.
  2409
  2410         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2411         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2412         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2413         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2414         16  PB-I-SKIP-CODE               PIC X.
  2415             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2416             88  PB-SKIP-JULY              VALUE '1'.
  2417             88  PB-SKIP-AUGUST            VALUE '2'.
  2418             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2419             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2420             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2421             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2422             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2423             88  PB-SKIP-JUNE              VALUE '8'.
  2424             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2425             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2426             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2427         16  PB-I-TERM-TYPE               PIC X.
  2428             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2429             88  PB-PAID-WEEKLY            VALUE 'W'.
  2430             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2431             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2432             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2433         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2434         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2435         16  PB-I-DATA-ENTRY-SW           PIC X.
  2436             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2437             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2438             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2439             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2440         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2441         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2442*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2443         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2444         16  FILLER                       PIC X.
  2445
  2446         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2447             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2448             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2449                                                   '90' THRU '99'.
  2450         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2451                                          PIC XX.
  2452         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2453         16  PB-I-AMOUNT-FINANCED REDEFINES
  2454                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2455         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  50
* EL640.cbl
  2456         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2457                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2458         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2459         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2460         16  PB-I-CLP-AMOUNT REDEFINES
  2461                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2462         16  PB-I-LF-CALC-FLAG            PIC X.
  2463             88 PB-COMP-LF-PREM               VALUE '?'.
  2464         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2465         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2466         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2467         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2468         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2469         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2470         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2471         16  PB-I-LF-ABBR                 PIC XXX.
  2472         16  PB-I-LF-INPUT-CD             PIC XX.
  2473
  2474         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2475             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2476             88  PB-INVALID-AH               VALUE '  ' '00'
  2477                                                   '90' THRU '99'.
  2478         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2479         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2480         16  PB-I-AH-CALC-FLAG            PIC X.
  2481             88 PB-COMP-AH-PREM                  VALUE '?'.
  2482         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2483         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2484         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2485         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2486         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2487         16  PB-I-AH-ABBR                 PIC XXX.
  2488         16  PB-I-AH-INPUT-CD             PIC XXX.
  2489
  2490         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2491         16  PB-I-REIN-TABLE              PIC XXX.
  2492         16  PB-I-BUSINESS-TYPE           PIC 99.
  2493         16  PB-I-INDV-GRP-CD             PIC X.
  2494         16  PB-I-MORT-CODE.
  2495             20  PB-I-TABLE               PIC X.
  2496             20  PB-I-INTEREST            PIC XX.
  2497             20  PB-I-MORT-TYP            PIC X.
  2498         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2499         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2500         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2501         16  PB-I-INDV-GRP-OVRD           PIC X.
  2502         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2503         16  PB-I-SIG-SW                  PIC X.
  2504             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2505         16  PB-I-RATE-CLASS              PIC XX.
  2506         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2507         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2508         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2509         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2510         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2511         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2512         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2513         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  51
* EL640.cbl
  2514         16  PB-I-OB-FLAG                 PIC X.
  2515             88  PB-I-OB                      VALUE 'B'.
  2516             88  PB-I-SUMMARY                 VALUE 'Z'.
  2517         16  PB-I-ENTRY-STATUS            PIC X.
  2518             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2519                                              'M' '5' '9' '2'.
  2520             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2521             88  PB-I-POLICY-PENDING          VALUE '2'.
  2522             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2523             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2524             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2525             88  PB-I-REIN-ONLY               VALUE '9'.
  2526             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2527             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2528             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2529             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2530         16  PB-I-INT-CODE                PIC X.
  2531             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2532             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2533         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2534         16  PB-I-SOC-SEC-NO              PIC X(11).
  2535         16  PB-I-MEMBER-NO               PIC X(12).
  2536         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2537*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2538         16  PB-I-OLD-LOF                 PIC XXX.
  2539         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2540         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2541         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2542         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2543         16  PB-I-LIFE-INDICATOR          PIC X.
  2544             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2545         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2546         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2547                                          PIC S9(5)V99    COMP-3.
  2548         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2549             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2550             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2551         16  PB-I-1ST-PMT-DT              PIC XX.
  2552         16  PB-I-JOINT-INSURED.
  2553             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2554             20 PB-I-JOINT-FIRST-NAME.
  2555                24  PB-I-JOINT-FIRST-INIT PIC X.
  2556                24  FILLER                PIC X(9).
  2557             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2558*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2559         16  PB-I-BENEFICIARY-NAME.
  2560             20  PB-I-BANK-NUMBER         PIC X(10).
  2561             20  FILLER                   PIC X(15).
  2562         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2563         16  PB-I-REFERENCE               PIC X(12).
  2564         16  FILLER REDEFINES PB-I-REFERENCE.
  2565             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2566             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2567             20  PB-I-CLP-STATE           PIC XX.
  2568         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2569             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2570             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2571             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  52
* EL640.cbl
  2572         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2573         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2574         16  PB-I-RESIDENT-STATE          PIC XX.
  2575         16  PB-I-RATE-CODE               PIC X(4).
  2576         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2577         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2578         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2579         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2580         16  PB-I-BANK-NOCHRGB            PIC 99.
  2581         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2582         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2583
  2584     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2585         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2586             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2587         16  PB-C-CANCEL-ORIGIN           PIC X.
  2588             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2589         16  PB-C-LF-CANCEL-DT            PIC XX.
  2590         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2591         16  PB-C-LF-CALC-REQ             PIC X.
  2592             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2593         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2594         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2595         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2596             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2597         16  PB-C-AH-CANCEL-DT            PIC XX.
  2598         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2599         16  PB-C-AH-CALC-REQ             PIC X.
  2600             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2601         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2602         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2603         16  PB-C-LAST-NAME               PIC X(15).
  2604         16  PB-C-REFUND-SW               PIC X.
  2605             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2606             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2607         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2608         16  PB-C-PAYEE-CODE              PIC X(6).
  2609         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2610         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2611         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2612         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2613         16  PB-C-REFERENCE               PIC X(12).
  2614         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2615         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2616         16  PB-C-POST-CARD-IND           PIC X.
  2617         16  PB-C-CANCEL-REASON           PIC X.
  2618         16  PB-C-REF-INTERFACE-SW        PIC X.
  2619         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2620         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2621         16  FILLER                       PIC X(01).
  2622*        16  FILLER                       PIC X(18).
  2623         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2624*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2625         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2626         16  PB-CANCELED-CERT-DATA.
  2627             20  PB-CI-INSURED-NAME.
  2628                 24  PB-CI-LAST-NAME      PIC X(15).
  2629                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  53
* EL640.cbl
  2630             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2631             20  PB-CI-INSURED-SEX        PIC X.
  2632             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2633             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2634             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2635             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2636             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2637             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2638             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2639             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2640             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2641             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2642             20  PB-CI-RATE-CLASS         PIC XX.
  2643             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2644             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2645             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2646             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2647             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2648             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2649             20  PB-CI-LF-ABBR            PIC X(3).
  2650             20  PB-CI-AH-ABBR            PIC X(3).
  2651             20  PB-CI-OB-FLAG            PIC X.
  2652                 88  PB-CI-OB                VALUE 'B'.
  2653             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2654                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2655                                           'M' '4' '5' '9' '2'.
  2656                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2657                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2658                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2659                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2660                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2661                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2662                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2663                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2664                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2665                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2666                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2667                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2668             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2669                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2670                                           'M' '4' '5' '9' '2'.
  2671                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2672                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2673                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2674                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2675                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2676                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2677                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2678                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2679                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2680                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2681                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2682                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2683             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2684             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2685             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2686             20  PB-CI-MEMBER-NO          PIC X(12).
  2687             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  54
* EL640.cbl
  2688                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2689                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2690             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2691             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2692             20  PB-CI-COMP-EXCP-SW       PIC X.
  2693                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2694                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2695             20  PB-CI-ENTRY-STATUS       PIC X.
  2696             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2697             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2698             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2699             20  PB-CI-DEATH-DT           PIC XX.
  2700             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2701             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2702             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2703             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2704             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2705             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2706             20  PB-CI-ENTRY-DT              PIC XX.
  2707             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2708             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2709             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2710             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2711             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2712             20  PB-CI-OLD-LOF               PIC XXX.
  2713*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2714             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2715             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2716             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2717             20  PB-CI-INDV-GRP-CD           PIC X.
  2718             20  PB-CI-BENEFICIARY-NAME.
  2719                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2720                 24  FILLER                  PIC X(15).
  2721             20  PB-CI-NOTE-SW               PIC X.
  2722             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2723             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2724             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2725             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2726             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2727             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2728             20  PB-CI-FIRST-NAME            PIC X(10).
  2729             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2730
  2731         16  FILLER                       PIC X(13).
  2732*032306  16  FILLER                       PIC X(27).
  2733*        16  FILLER                       PIC X(46).
  2734
  2735     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2736         16  FILLER                       PIC X(10).
  2737         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2738         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2739         16  PB-M-INSURED-MID-INIT        PIC X.
  2740         16  PB-M-INSURED-AGE             PIC 99.
  2741         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2742         16  PB-M-INSURED-SEX             PIC X.
  2743         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2744         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2745         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  55
* EL640.cbl
  2746         16  PB-M-INSURED-CITY-STATE.
  2747             20  PB-M-INSURED-CITY        PIC X(28).
  2748             20  PB-M-INSURED-STATE       PIC XX.
  2749         16  PB-M-INSURED-ZIP-CODE.
  2750             20  PB-M-INSURED-ZIP-PRIME.
  2751                 24  PB-M-INSURED-ZIP-1   PIC X.
  2752                     88  PB-M-CANADIAN-POST-CODE
  2753                                             VALUE 'A' THRU 'Z'.
  2754                 24  FILLER               PIC X(4).
  2755             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2756         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2757                                        PB-M-INSURED-ZIP-CODE.
  2758             20  PM-M-INS-CAN-POST1       PIC XXX.
  2759             20  PM-M-INS-CAN-POST2       PIC XXX.
  2760             20  FILLER                   PIC XXX.
  2761         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2762         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2763         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2764         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2765         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2766         16  PB-M-CRED-BENE-CITYST.
  2767             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2768             20  PB-M-CRED-BENE-STATE     PIC XX.
  2769         16  FILLER                       PIC X(92).
  2770
  2771     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2772         16  FILLER                       PIC X(10).
  2773         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2774         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2775         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2776         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2777         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2778         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2779         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2780         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2781         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2782         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2783         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2784         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2785         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2786         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2787         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2788         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2789         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2790         16  PB-ACCOUNT-NAME              PIC X(30).
  2791         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2792         16  PB-REFERENCE                 PIC X(12).
  2793         16  PB-B-RECEIVED-DT             PIC XX.
  2794         16  FILLER                       PIC X(234).
  2795
  2796     12  PB-RECORD-STATUS.
  2797         16  PB-CREDIT-SELECT-DT          PIC XX.
  2798         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2799         16  PB-BILLED-DT                 PIC XX.
  2800         16  PB-BILLING-STATUS            PIC X.
  2801             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2802             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2803             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  56
* EL640.cbl
  2804         16  PB-RECORD-BILL               PIC X.
  2805             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2806             88  PB-RECORD-RETURNED           VALUE 'R'.
  2807             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2808             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2809             88  PB-OVERRIDE-AH               VALUE 'A'.
  2810             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2811         16  PB-BATCH-ENTRY               PIC X.
  2812             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2813             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2814             88  PB-REISSUED-CERT             VALUE 'E'.
  2815             88  PB-MONTHLY-CERT              VALUE 'M'.
  2816             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2817             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2818             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2819         16  PB-FORCE-CODE                PIC X.
  2820             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2821             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2822             88  PB-CANCEL-FORCE              VALUE '8'.
  2823             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2824             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2825             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2826             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2827             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2828             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2829             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2830         16  PB-FATAL-FLAG                PIC X.
  2831             88  PB-FATAL-ERRORS              VALUE 'X'.
  2832         16  PB-FORCE-ER-CD               PIC X.
  2833             88  PB-FORCE-ERRORS              VALUE 'F'.
  2834             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2835         16  PB-WARN-ER-CD                PIC X.
  2836             88  PB-WARNING-ERRORS            VALUE 'W'.
  2837         16  FILLER                       PIC X.
  2838         16  PB-OUT-BAL-CD                PIC X.
  2839             88  PB-OUT-OF-BAL                VALUE 'O'.
  2840         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2841         16  PB-AH-OVERRIDE-L1            PIC X.
  2842         16  PB-INPUT-DT                  PIC XX.
  2843         16  PB-INPUT-BY                  PIC X(4).
  2844         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2845         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2846         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2847         16  PB-LF-EARNING-METHOD         PIC X.
  2848         16  PB-AH-EARNING-METHOD         PIC X.
  2849         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2850         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2851         16  PB-REIN-CD                   PIC XXX.
  2852         16  PB-LF-REFUND-TYPE            PIC X.
  2853         16  PB-AH-REFUND-TYPE            PIC X.
  2854         16  PB-ACCT-EFF-DT               PIC XX.
  2855         16  PB-ACCT-EXP-DT               PIC XX.
  2856         16  PB-COMPANY-ID                PIC X(3).
  2857         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2858         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2859         16  PB-SV-CARRIER                PIC X.
  2860         16  PB-SV-GROUPING               PIC X(6).
  2861         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  57
* EL640.cbl
  2862         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2863         16  PB-GA-BILLING-INFO.
  2864             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2865                                          PIC XX.
  2866         16  PB-SV-REMIT-TO  REDEFINES
  2867             PB-GA-BILLING-INFO           PIC X(10).
  2868         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2869         16  PB-I-LOAN-OFFICER            PIC X(5).
  2870         16  PB-I-VIN                     PIC X(17).
  2871
  2872         16  FILLER                       PIC X(04).
  2873         16  IMNET-BYPASS-SW              PIC X.
  2874
  2875******************************************************************
  2876*                COMMON EDIT ERRORS                              *
  2877******************************************************************
  2878
  2879     12  PB-COMMON-ERRORS.
  2880         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2881                                           PIC S9(4)     COMP.
  2882
  2883******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  58
* EL640.cbl
  2885*                            COPY ELCCNTL.
  2886******************************************************************
  2887*                                                                *
  2888*                                                                *
  2889*                            ELCCNTL.                            *
  2890*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2891*                            VMOD=2.059                          *
  2892*                                                                *
  2893*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2894*                                                                *
  2895*   FILE TYPE = VSAM,KSDS                                        *
  2896*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2897*                                                                *
  2898*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2899*       ALTERNATE INDEX = NONE                                   *
  2900*                                                                *
  2901*   LOG = YES                                                    *
  2902*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2903******************************************************************
  2904*                   C H A N G E   L O G
  2905*
  2906* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2907*-----------------------------------------------------------------
  2908*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2909* EFFECTIVE    NUMBER
  2910*-----------------------------------------------------------------
  2911* 082503                   PEMA  ADD BENEFIT GROUP
  2912* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2913* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2914* 092705    2005050300006  PEMA  ADD SPP LEASES
  2915* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2916* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2917* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2918* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2919* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2920* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2921* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2922******************************************************************
  2923*
  2924 01  CONTROL-FILE.
  2925     12  CF-RECORD-ID                       PIC XX.
  2926         88  VALID-CF-ID                        VALUE 'CF'.
  2927
  2928     12  CF-CONTROL-PRIMARY.
  2929         16  CF-COMPANY-ID                  PIC XXX.
  2930         16  CF-RECORD-TYPE                 PIC X.
  2931             88  CF-COMPANY-MASTER              VALUE '1'.
  2932             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2933             88  CF-STATE-MASTER                VALUE '3'.
  2934             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2935             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2936             88  CF-CARRIER-MASTER              VALUE '6'.
  2937             88  CF-MORTALITY-MASTER            VALUE '7'.
  2938             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2939             88  CF-TERMINAL-MASTER             VALUE '9'.
  2940             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2941             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2942             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  59
* EL640.cbl
  2943             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2944             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2945             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2946             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2947             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2948             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2949         16  CF-ACCESS-CD-GENL              PIC X(4).
  2950         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2951             20  CF-PROCESSOR               PIC X(4).
  2952         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2953             20  CF-STATE-CODE              PIC XX.
  2954             20  FILLER                     PIC XX.
  2955         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2956             20  FILLER                     PIC XX.
  2957             20  CF-HI-BEN-IN-REC           PIC XX.
  2958         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2959             20  FILLER                     PIC XXX.
  2960             20  CF-CARRIER-CNTL            PIC X.
  2961         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2962             20  FILLER                     PIC XX.
  2963             20  CF-HI-TYPE-IN-REC          PIC 99.
  2964         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2965             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2966                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2967             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2968             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2969         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2970             20  FILLER                     PIC X.
  2971             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2972         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2973             20  FILLER                     PIC XX.
  2974             20  CF-MORTGAGE-PLAN           PIC XX.
  2975         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2976
  2977     12  CF-LAST-MAINT-DT                   PIC XX.
  2978     12  CF-LAST-MAINT-BY                   PIC X(4).
  2979     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2980
  2981     12  CF-RECORD-BODY                     PIC X(728).
  2982
  2983
  2984****************************************************************
  2985*             COMPANY MASTER RECORD                            *
  2986****************************************************************
  2987
  2988     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2989         16  CF-COMPANY-ADDRESS.
  2990             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2991             20  CF-CL-IN-CARE-OF           PIC X(30).
  2992             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2993             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2994             20  CF-CL-CITY-STATE           PIC X(30).
  2995             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2996             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2997         16  CF-COMPANY-CD                  PIC X.
  2998         16  CF-COMPANY-PASSWORD            PIC X(8).
  2999         16  CF-SECURITY-OPTION             PIC X.
  3000             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  60
* EL640.cbl
  3001             88  COMPANY-VERIFY                 VALUE '2'.
  3002             88  PROCESSOR-VERIFY               VALUE '3'.
  3003             88  NO-SECURITY                    VALUE '4'.
  3004             88  ALL-BUT-TERM                   VALUE '5'.
  3005         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3006             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3007         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3008             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3009         16  CF-INFORCE-LOCATION            PIC X.
  3010             88  CERTS-ARE-ONLINE               VALUE '1'.
  3011             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3012             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3013         16  CF-LOWER-CASE-LETTERS          PIC X.
  3014         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3015             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3016             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3017             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3018             88  CF-ACCNT-CNTL                  VALUE '3'.
  3019             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3020
  3021         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3022         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3023
  3024         16  CF-LGX-CREDIT-USER             PIC X.
  3025             88  CO-IS-NOT-USER                 VALUE 'N'.
  3026             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3027
  3028         16 CF-CREDIT-CALC-CODES.
  3029             20  CF-CR-REM-TERM-CALC PIC X.
  3030               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3031               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3032               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3033               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3034               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3035               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3036               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3037             20  CF-CR-R78-METHOD           PIC X.
  3038               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3039               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3040
  3041         16  CF-CLAIM-CONTROL-COUNTS.
  3042             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3043                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3044
  3045             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3046                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3047
  3048             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3049                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3050
  3051             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3052                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3053
  3054         16  CF-CURRENT-MONTH-END           PIC XX.
  3055
  3056         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3057             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3058             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  61
* EL640.cbl
  3059             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3060             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3061                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3062                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3063             20  CF-CO-PREM-REJECT-SW       PIC X.
  3064                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3065                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3066             20  CF-CO-REF-REJECT-SW        PIC X.
  3067                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3068                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3069
  3070         16  CF-CO-REPORTING-DT             PIC XX.
  3071         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3072         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3073           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3074           88  CF-CO-MONTH-END                  VALUE '1'.
  3075
  3076         16  CF-LGX-CLAIM-USER              PIC X.
  3077             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3078             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3079
  3080         16  CF-CREDIT-EDIT-CONTROLS.
  3081             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3082             20  CF-MIN-AGE                 PIC 99.
  3083             20  CF-DEFAULT-AGE             PIC 99.
  3084             20  CF-MIN-TERM                PIC S999      COMP-3.
  3085             20  CF-MAX-TERM                PIC S999      COMP-3.
  3086             20  CF-DEFAULT-SEX             PIC X.
  3087             20  CF-JOINT-AGE-INPUT         PIC X.
  3088                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3089             20  CF-BIRTH-DATE-INPUT        PIC X.
  3090                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3091             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3092                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3093                 88  CF-ZERO-CARRIER            VALUE '1'.
  3094                 88  CF-ZERO-GROUPING           VALUE '2'.
  3095                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3096             20  CF-EDIT-SW                 PIC X.
  3097                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3098             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3099             20  CF-CR-PR-METHOD            PIC X.
  3100               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3101               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3102             20  FILLER                     PIC X.
  3103
  3104         16  CF-CREDIT-MISC-CONTROLS.
  3105             20  CF-REIN-TABLE-SW           PIC X.
  3106                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3107             20  CF-COMP-TABLE-SW           PIC X.
  3108                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3109             20  CF-EXPERIENCE-RETENTION-AGE
  3110                                            PIC S9        COMP-3.
  3111             20  CF-CONVERSION-DT           PIC XX.
  3112             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3113             20  CF-RUN-FREQUENCY-SW        PIC X.
  3114                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3115                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3116
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  62
* EL640.cbl
  3117             20  CF-CR-CHECK-NO-CONTROL.
  3118                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3119                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3120                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3121                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3122                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3123                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3124
  3125                 24  CF-CR-CHECK-COUNT       REDEFINES
  3126                     CF-CR-CHECK-COUNTER      PIC X(4).
  3127
  3128                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3129                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3130
  3131                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3132                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3133                 24  CF-MAIL-PROCESSING       PIC X.
  3134                     88  MAIL-PROCESSING          VALUE 'Y'.
  3135
  3136         16  CF-MISC-SYSTEM-CONTROL.
  3137             20  CF-SYSTEM-C                 PIC X.
  3138                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3139             20  CF-SYSTEM-D                 PIC X.
  3140                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3141             20  CF-SOC-SEC-NO-SW            PIC X.
  3142                 88  SOC-SEC-NO-USED             VALUE '1'.
  3143             20  CF-MEMBER-NO-SW             PIC X.
  3144                 88  MEMBER-NO-USED              VALUE '1'.
  3145             20  CF-TAX-ID-NUMBER            PIC X(11).
  3146             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3147             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3148                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3149                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3150                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3151                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3152             20  CF-SYSTEM-E                 PIC X.
  3153                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3154
  3155         16  CF-LGX-LIFE-USER               PIC X.
  3156             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3157             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3158
  3159         16  CF-CR-MONTH-END-DT             PIC XX.
  3160
  3161         16  CF-FILE-MAINT-DATES.
  3162             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3163                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3164             20  CF-LAST-BATCH       REDEFINES
  3165                 CF-LAST-BATCH-NO               PIC X(4).
  3166             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3167             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3168             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3169             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3170             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3171             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3172             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3173             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3174             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  63
* EL640.cbl
  3175             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3176
  3177         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3178         16  FILLER                         PIC X.
  3179
  3180         16  CF-ALT-MORT-CODE               PIC X(4).
  3181         16  CF-MEMBER-CAPTION              PIC X(10).
  3182
  3183         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3184             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3185             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3186             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3187             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3188             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3189
  3190         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3191
  3192         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3193         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3194         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3195         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3196
  3197         16  CF-AH-OVERRIDE-L1              PIC X.
  3198         16  CF-AH-OVERRIDE-L2              PIC XX.
  3199         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3200         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3201
  3202         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3203         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3204
  3205         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3206         16  CF-AR-LAST-EL860-DT            PIC XX.
  3207         16  CF-MP-MONTH-END-DT             PIC XX.
  3208
  3209         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3210         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3211             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3212
  3213         16  CF-AR-MONTH-END-DT             PIC XX.
  3214
  3215         16  CF-CRDTCRD-USER                PIC X.
  3216             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3217             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3218
  3219         16  CF-CC-MONTH-END-DT             PIC XX.
  3220
  3221         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3222
  3223         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3224             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3225             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3226             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3227         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3228         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3229         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3230         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3231             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3232             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  64
* EL640.cbl
  3233         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3234         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3235         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3236             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3237         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3238
  3239         16  CF-CL-ZIP-CODE.
  3240             20  CF-CL-ZIP-PRIME.
  3241                 24  CF-CL-ZIP-1ST          PIC X.
  3242                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3243                 24  FILLER                 PIC X(4).
  3244             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3245         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3246             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3247             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3248             20  FILLER                     PIC XXX.
  3249
  3250         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3251         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3252         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3253         16  CF-CO-OPTION-START-DATE        PIC XX.
  3254         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3255           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3256                                                      '3' '4'.
  3257           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3258           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3259           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3260           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3261           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3262           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3263
  3264         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3265
  3266         16  CF-PAYMENT-APPROVAL-LEVELS.
  3267             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3268             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3269             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3270             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3271             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3272             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3273
  3274         16  CF-END-USER-REPORTING-USER     PIC X.
  3275             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3276             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3277
  3278         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3279             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3280             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3281
  3282         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3283
  3284         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3285         16  FILLER                         PIC X.
  3286
  3287         16  CF-CREDIT-ARCHIVE-CNTL.
  3288             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3289             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3290             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  65
* EL640.cbl
  3291
  3292         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3293
  3294         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3295             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3296             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3297
  3298         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3299             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3300             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3301
  3302         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3303
  3304         16  CF-CO-ACH-ID-CODE              PIC  X.
  3305             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3306             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3307             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3308         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3309         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3310         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3311         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3312         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3313         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3314         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3315         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3316         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3317                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3318         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3319                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3320
  3321         16  CF-CO-OVER-SHORT.
  3322             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3323             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3324
  3325*         16  FILLER                         PIC X(102).
  3326         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3327             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3328             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3329
  3330         16  CF-AH-APPROVAL-DAYS.
  3331             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3332             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3333             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3334             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3335
  3336         16  FILLER                         PIC X(82).
  3337****************************************************************
  3338*             PROCESSOR/USER RECORD                            *
  3339****************************************************************
  3340
  3341     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3342         16  CF-PROCESSOR-NAME              PIC X(30).
  3343         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3344         16  CF-PROCESSOR-TITLE             PIC X(26).
  3345         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3346                 88  MESSAGE-YES                VALUE 'Y'.
  3347                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3348
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  66
* EL640.cbl
  3349*****************************************************
  3350****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3351****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3352****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3353****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3354*****************************************************
  3355
  3356         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3357             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3358             20  CF-APPLICATION-FORCE       PIC X.
  3359             20  CF-INDIVIDUAL-APP.
  3360                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3361                     28  CF-BROWSE-APP      PIC X.
  3362                     28  CF-UPDATE-APP      PIC X.
  3363
  3364         16  CF-CURRENT-TERM-ON             PIC X(4).
  3365         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3366             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3367             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3368             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3369             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3370             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3371             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3372             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3373         16  CF-PROCESSOR-CARRIER           PIC X.
  3374             88  NO-CARRIER-SECURITY            VALUE ' '.
  3375         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3376             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3377         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3378             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3379         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3380             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3381
  3382         16  CF-PROC-SYS-ACCESS-SW.
  3383             20  CF-PROC-CREDIT-CLAIMS-SW.
  3384                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3385                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3386                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3387                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3388             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3389                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3390                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3391             20  CF-PROC-LIFE-GNRLDGR-SW.
  3392                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3393                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3394                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3395                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3396             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3397                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3398                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3399         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3400             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3401             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3402         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3403
  3404         16  CF-APPROVAL-LEVEL                  PIC X.
  3405             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3406             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  67
* EL640.cbl
  3407             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3408             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3409
  3410         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3411
  3412         16  CF-LANGUAGE-TYPE                   PIC X.
  3413             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3414             88  CF-LANG-IS-FR                      VALUE 'F'.
  3415
  3416         16  CF-CSR-IND                         PIC X.
  3417         16  FILLER                             PIC X(239).
  3418
  3419****************************************************************
  3420*             PROCESSOR/REMINDERS RECORD                       *
  3421****************************************************************
  3422
  3423     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3424         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3425             20  CF-START-REMIND-DT         PIC XX.
  3426             20  CF-END-REMIND-DT           PIC XX.
  3427             20  CF-REMINDER-TEXT           PIC X(50).
  3428         16  FILLER                         PIC X(296).
  3429
  3430
  3431****************************************************************
  3432*             STATE MASTER RECORD                              *
  3433****************************************************************
  3434
  3435     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3436         16  CF-STATE-ABBREVIATION          PIC XX.
  3437         16  CF-STATE-NAME                  PIC X(25).
  3438         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3439         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3440             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3441             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3442             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3443             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3444                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3445                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3446             20  CF-ST-PREM-REJECT-SW       PIC X.
  3447                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3448                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3449             20  CF-ST-REF-REJECT-SW        PIC X.
  3450                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3451                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3452         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3453         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3454         16  CF-ST-REFUND-RULES.
  3455             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3456             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3457             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3458         16  CF-ST-FST-PMT-EXTENSION.
  3459             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3460             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3461                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3462                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3463                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3464                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  68
* EL640.cbl
  3465         16  CF-ST-STATE-CALL.
  3466             20  CF-ST-CALL-UNEARNED        PIC X.
  3467             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3468             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3469         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3470             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3471             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3472         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3473         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3474         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3475         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3476         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3477         16  FILLER                         PIC X.
  3478         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3479             20  CF-ST-BENEFIT-CD           PIC XX.
  3480             20  CF-ST-BENEFIT-KIND         PIC X.
  3481                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3482                 88  CF-ST-AH-KIND              VALUE 'A'.
  3483             20  CF-ST-REM-TERM-CALC        PIC X.
  3484                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3485                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3486                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3487                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3488                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3489                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3490                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3491                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3492
  3493             20  CF-ST-REFUND-CALC          PIC X.
  3494                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3495                 88  ST-REFD-BY-R78             VALUE '1'.
  3496                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3497                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3498                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3499                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3500                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3501                 88  ST-REFD-UTAH               VALUE '7'.
  3502                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3503                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3504                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3505
  3506             20  CF-ST-EARNING-CALC         PIC X.
  3507                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3508                 88  ST-EARN-BY-R78             VALUE '1'.
  3509                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3510                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3511                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3512                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3513                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3514                 88  ST-EARN-MEAN               VALUE '8'.
  3515                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3516
  3517             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3518                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3519                 88  ST-OVRD-BY-R78             VALUE '1'.
  3520                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3521                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3522                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  69
* EL640.cbl
  3523                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3524                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3525                 88  ST-OVRD-MEAN               VALUE '8'.
  3526                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3527             20  FILLER                     PIC X.
  3528
  3529         16  CF-ST-COMMISSION-CAPS.
  3530             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3531             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3532             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3533             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3534         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3535                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3536
  3537         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3538
  3539         16  CF-ST-STATUTORY-INTEREST.
  3540             20  CF-ST-STAT-DATE-FROM       PIC X.
  3541                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3542                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3543             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3544             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3545             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3546             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3547             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3548
  3549         16  CF-ST-OVER-SHORT.
  3550             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3551             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3552
  3553         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3554
  3555         16  CF-ST-RT-CALC                  PIC X.
  3556
  3557         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3558         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3559         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3560         16  CF-ST-RF-LR-CALC               PIC X.
  3561         16  CF-ST-RF-LL-CALC               PIC X.
  3562         16  CF-ST-RF-LN-CALC               PIC X.
  3563         16  CF-ST-RF-AH-CALC               PIC X.
  3564         16  CF-ST-RF-CP-CALC               PIC X.
  3565*        16  FILLER                         PIC X(206).
  3566*CIDMOD         16  FILLER                         PIC X(192).
  3567         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3568             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3569         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3570         16  CF-ST-VFY-2ND-BENE             PIC X.
  3571         16  CF-ST-CAUSAL-STATE             PIC X.
  3572         16  FILLER                         PIC X(185).
  3573
  3574****************************************************************
  3575*             BENEFIT MASTER RECORD                            *
  3576****************************************************************
  3577
  3578     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3579         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3580             20  CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  70
* EL640.cbl
  3581             20  CF-BENEFIT-NUMERIC  REDEFINES
  3582                 CF-BENEFIT-CODE            PIC XX.
  3583             20  CF-BENEFIT-ALPHA           PIC XXX.
  3584             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3585             20  CF-BENEFIT-COMMENT         PIC X(10).
  3586
  3587             20  CF-LF-COVERAGE-TYPE        PIC X.
  3588                 88  CF-REDUCING                VALUE 'R'.
  3589                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3590
  3591             20  CF-SPECIAL-CALC-CD         PIC X.
  3592                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3593                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3594                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3595                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3596                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3597                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3598                 88  CF-FARM-PLAN               VALUE 'F'.
  3599                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3600                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3601                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3602                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3603                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3604                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3605                 88  CF-PRUDENTIAL              VALUE 'P'.
  3606                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3607                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3608                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3609                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3610                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3611                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3612
  3613             20  CF-JOINT-INDICATOR         PIC X.
  3614                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3615
  3616*            20  FILLER                     PIC X(12).
  3617             20  FILLER                     PIC X(11).
  3618             20  CF-BENEFIT-CATEGORY        PIC X.
  3619             20  CF-LOAN-TYPE               PIC X(8).
  3620
  3621             20  CF-CO-REM-TERM-CALC        PIC X.
  3622                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3623                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3624                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3625                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3626                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3627
  3628             20  CF-CO-EARNINGS-CALC        PIC X.
  3629                 88  CO-EARN-BY-R78             VALUE '1'.
  3630                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3631                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3632                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3633                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3634                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3635                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3636                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3637
  3638             20  CF-CO-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  71
* EL640.cbl
  3639                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3640                 88  CO-REFD-BY-R78             VALUE '1'.
  3641                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3642                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3643                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3644                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3645                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3646                 88  CO-REFD-MEAN               VALUE '8'.
  3647                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3648                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3649                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3650
  3651             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3652                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3653                 88  CO-OVRD-BY-R78             VALUE '1'.
  3654                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3655                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3656                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3657                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3658                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3659                 88  CO-OVRD-MEAN               VALUE '8'.
  3660                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3661
  3662             20  CF-CO-BEN-I-G-CD           PIC X.
  3663                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3664                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3665                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3666
  3667         16  FILLER                         PIC X(304).
  3668
  3669
  3670****************************************************************
  3671*             CARRIER MASTER RECORD                            *
  3672****************************************************************
  3673
  3674     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3675         16  CF-ADDRESS-DATA.
  3676             20  CF-MAIL-TO-NAME            PIC X(30).
  3677             20  CF-IN-CARE-OF              PIC X(30).
  3678             20  CF-ADDRESS-LINE-1          PIC X(30).
  3679             20  CF-ADDRESS-LINE-2          PIC X(30).
  3680             20  CF-CITY-STATE              PIC X(30).
  3681             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3682             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3683
  3684         16  CF-CLAIM-NO-CONTROL.
  3685             20  CF-CLAIM-NO-METHOD         PIC X.
  3686                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3687                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3688                 88  CLAIM-NO-SEQ               VALUE '3'.
  3689                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3690             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3691                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3692                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3693                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3694
  3695         16  CF-CHECK-NO-CONTROL.
  3696             20  CF-CHECK-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  72
* EL640.cbl
  3697                 88  CHECK-NO-MANUAL            VALUE '1'.
  3698                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3699                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3700                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3701             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3702                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3703
  3704         16  CF-DOMICILE-STATE              PIC XX.
  3705
  3706         16  CF-EXPENSE-CONTROLS.
  3707             20  CF-EXPENSE-METHOD          PIC X.
  3708                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3709                 88  DOLLARS-PER-PMT            VALUE '2'.
  3710                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3711                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3712             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3713             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3714
  3715         16  CF-CORRESPONDENCE-CONTROL.
  3716             20  CF-LETTER-RESEND-OPT       PIC X.
  3717                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3718                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3719             20  FILLER                     PIC X(4).
  3720
  3721         16  CF-RESERVE-CONTROLS.
  3722             20  CF-MANUAL-SW               PIC X.
  3723                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3724             20  CF-FUTURE-SW               PIC X.
  3725                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3726             20  CF-PTC-SW                  PIC X.
  3727                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3728             20  CF-IBNR-SW                 PIC X.
  3729                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3730             20  CF-PTC-LF-SW               PIC X.
  3731                 88  CF-LF-PTC-USED             VALUE '1'.
  3732             20  CF-CDT-ACCESS-METHOD       PIC X.
  3733                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3734                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3735                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3736             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3737
  3738         16  CF-CLAIM-CALC-METHOD           PIC X.
  3739             88  360-PLUS-MONTHS                VALUE '1'.
  3740             88  365-PLUS-MONTHS                VALUE '2'.
  3741             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3742             88  360-DAILY                      VALUE '4'.
  3743             88  365-DAILY                      VALUE '5'.
  3744
  3745         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3746         16  FILLER                         PIC X(11).
  3747
  3748         16  CF-LIMIT-AMOUNTS.
  3749             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3750             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3751             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3752             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3753             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3754             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  73
* EL640.cbl
  3755             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3756             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3757             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3758             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3759
  3760         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3761         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3762         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3763
  3764         16  CF-ZIP-CODE.
  3765             20  CF-ZIP-PRIME.
  3766                 24  CF-ZIP-1ST             PIC X.
  3767                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3768                 24  FILLER                 PIC X(4).
  3769             20  CF-ZIP-PLUS4               PIC X(4).
  3770         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3771             20  CF-CAN-POSTAL-1            PIC XXX.
  3772             20  CF-CAN-POSTAL-2            PIC XXX.
  3773             20  FILLER                     PIC XXX.
  3774
  3775         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3776         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3777         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3778
  3779         16  CF-RATING-SWITCH               PIC X.
  3780             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3781             88  CF-NO-RATING                   VALUE 'N'.
  3782
  3783         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3784
  3785         16  CF-CARRIER-OVER-SHORT.
  3786             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3787             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3788
  3789         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3790         16  CF-SECPAY-SWITCH               PIC X.
  3791             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3792             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3793         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3794         16  FILLER                         PIC X(448).
  3795*        16  FILLER                         PIC X(452).
  3796
  3797
  3798****************************************************************
  3799*             MORTALITY MASTER RECORD                          *
  3800****************************************************************
  3801
  3802     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3803         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3804                                INDEXED BY CF-MORT-NDX.
  3805             20  CF-MORT-TABLE              PIC X(5).
  3806             20  CF-MORT-TABLE-TYPE         PIC X.
  3807                 88  CF-MORT-JOINT              VALUE 'J'.
  3808                 88  CF-MORT-SINGLE             VALUE 'S'.
  3809                 88  CF-MORT-COMBINED           VALUE 'C'.
  3810                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3811                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3812             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  74
* EL640.cbl
  3813             20  CF-MORT-AGE-METHOD         PIC XX.
  3814                 88  CF-AGE-LAST                VALUE 'AL'.
  3815                 88  CF-AGE-NEAR                VALUE 'AN'.
  3816             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3817             20  CF-MORT-ADJUSTMENT-DIRECTION
  3818                                            PIC X.
  3819                 88  CF-MINUS                   VALUE '-'.
  3820                 88  CF-PLUS                    VALUE '+'.
  3821             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3822             20  CF-MORT-JOINT-CODE         PIC X.
  3823                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3824             20  CF-MORT-PC-Q               PIC X.
  3825                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3826             20  CF-MORT-TABLE-CODE         PIC X(4).
  3827             20  CF-MORT-COMMENTS           PIC X(15).
  3828             20  FILLER                     PIC X(14).
  3829
  3830         16  FILLER                         PIC X(251).
  3831
  3832
  3833****************************************************************
  3834*             BUSSINESS TYPE MASTER RECORD                     *
  3835****************************************************************
  3836
  3837     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3838* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3839* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3840* AND RECORD 05 IS TYPES 81-99
  3841         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3842             20  CF-BUSINESS-TITLE          PIC  X(19).
  3843             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3844                                            PIC S9V9(4) COMP-3.
  3845             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3846             20  FILLER                     PIC  X.
  3847         16  FILLER                         PIC  X(248).
  3848
  3849
  3850****************************************************************
  3851*             TERMINAL MASTER RECORD                           *
  3852****************************************************************
  3853
  3854     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3855
  3856         16  CF-COMPANY-TERMINALS.
  3857             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3858                                  PIC X(4).
  3859         16  FILLER               PIC X(248).
  3860
  3861
  3862****************************************************************
  3863*             LIFE EDIT MASTER RECORD                          *
  3864****************************************************************
  3865
  3866     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3867         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3868             20  CF-LIFE-CODE-IN            PIC XX.
  3869             20  CF-LIFE-CODE-OUT           PIC XX.
  3870         16  FILLER                         PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  75
* EL640.cbl
  3871
  3872
  3873****************************************************************
  3874*             AH EDIT MASTER RECORD                            *
  3875****************************************************************
  3876
  3877     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3878         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3879             20  CF-AH-CODE-IN              PIC XXX.
  3880             20  CF-AH-CODE-OUT             PIC XX.
  3881         16  FILLER                         PIC X(248).
  3882
  3883
  3884****************************************************************
  3885*             CREDIBILITY TABLES                               *
  3886****************************************************************
  3887
  3888     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3889         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3890                             INDEXED BY CF-CRDB-NDX.
  3891             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3892             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3893             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3894         16  FILLER                         PIC  X(332).
  3895
  3896
  3897****************************************************************
  3898*             REPORT CUSTOMIZATION RECORD                      *
  3899****************************************************************
  3900
  3901     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3902         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3903             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3904             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3905             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3906**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3907****       A T-TRANSFER.                                   ****
  3908             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3909
  3910         16  FILLER                         PIC XX.
  3911
  3912         16  CF-CARRIER-CNTL-OPT.
  3913             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3914                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3915                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3916             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3917                                            PIC X.
  3918         16  CF-GROUP-CNTL-OPT.
  3919             20  CF-GROUP-OPT-SEQ           PIC 9.
  3920                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3921                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3922             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3923                                            PIC X(6).
  3924         16  CF-STATE-CNTL-OPT.
  3925             20  CF-STATE-OPT-SEQ           PIC 9.
  3926                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3927                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3928             20  CF-STATE-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  76
* EL640.cbl
  3929                                            PIC XX.
  3930         16  CF-ACCOUNT-CNTL-OPT.
  3931             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3932                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3933                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3934             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3935                                            PIC X(10).
  3936         16  CF-BUS-TYP-CNTL-OPT.
  3937             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3938                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3939                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3940             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3941                                            PIC XX.
  3942         16  CF-LF-TYP-CNTL-OPT.
  3943             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3944                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3945                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3946             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3947                                            PIC XX.
  3948         16  CF-AH-TYP-CNTL-OPT.
  3949             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3950                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3951                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3952             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3953                                            PIC XX.
  3954         16  CF-REPTCD1-CNTL-OPT.
  3955             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3956                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3957                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3958             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3959                                            PIC X(10).
  3960         16  CF-REPTCD2-CNTL-OPT.
  3961             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3962                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3963                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3964             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3965                                            PIC X(10).
  3966         16  CF-USER1-CNTL-OPT.
  3967             20  CF-USER1-OPT-SEQ           PIC 9.
  3968                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3969                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3970             20  CF-USER1-SELECT OCCURS 3 TIMES
  3971                                            PIC X(10).
  3972         16  CF-USER2-CNTL-OPT.
  3973             20  CF-USER2-OPT-SEQ           PIC 9.
  3974                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3975                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3976             20  CF-USER2-SELECT OCCURS 3 TIMES
  3977                                            PIC X(10).
  3978         16  CF-USER3-CNTL-OPT.
  3979             20  CF-USER3-OPT-SEQ           PIC 9.
  3980                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3981                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3982             20  CF-USER3-SELECT OCCURS 3 TIMES
  3983                                            PIC X(10).
  3984         16  CF-USER4-CNTL-OPT.
  3985             20  CF-USER4-OPT-SEQ           PIC 9.
  3986                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  77
* EL640.cbl
  3987                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3988             20  CF-USER4-SELECT OCCURS 3 TIMES
  3989                                            PIC X(10).
  3990         16  CF-USER5-CNTL-OPT.
  3991             20  CF-USER5-OPT-SEQ           PIC 9.
  3992                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3993                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3994             20  CF-USER5-SELECT OCCURS 3 TIMES
  3995                                            PIC X(10).
  3996         16  CF-REINS-CNTL-OPT.
  3997             20  CF-REINS-OPT-SEQ           PIC 9.
  3998                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3999                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4000             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4001                 24  CF-REINS-PRIME         PIC XXX.
  4002                 24  CF-REINS-SUB           PIC XXX.
  4003
  4004         16  CF-AGENT-CNTL-OPT.
  4005             20  CF-AGENT-OPT-SEQ           PIC 9.
  4006                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4007                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4008             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4009                                            PIC X(10).
  4010
  4011         16  FILLER                         PIC X(43).
  4012
  4013         16  CF-LOSS-RATIO-SELECT.
  4014             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4015             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4016         16  CF-ENTRY-DATE-SELECT.
  4017             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4018             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4019         16  CF-EFFECTIVE-DATE-SELECT.
  4020             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4021             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4022
  4023         16  CF-EXCEPTION-LIST-IND          PIC X.
  4024             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4025
  4026         16  FILLER                         PIC X(318).
  4027
  4028****************************************************************
  4029*                  EXCEPTION REPORTING RECORD                  *
  4030****************************************************************
  4031
  4032     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4033         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4034             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4035
  4036         16  CF-COMBINED-LIFE-AH-OPT.
  4037             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4038             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4039             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4040             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4041
  4042         16  CF-LIFE-OPT.
  4043             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4044             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  78
* EL640.cbl
  4045             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4046             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4047             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4048             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4049             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4050             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4051             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4052             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4053
  4054         16  CF-AH-OPT.
  4055             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4056             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4057             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4058             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4059             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4060             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4061             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4062             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4063             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4064             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4065
  4066         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4067             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4068             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4069             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4070
  4071         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4072
  4073         16  FILLER                         PIC X(673).
  4074
  4075
  4076****************************************************************
  4077*             MORTGAGE SYSTEM PLAN RECORD                      *
  4078****************************************************************
  4079
  4080     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4081         16  CF-PLAN-TYPE                   PIC X.
  4082             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4083             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4084             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4085         16  CF-PLAN-ABBREV                 PIC XXX.
  4086         16  CF-PLAN-DESCRIPT               PIC X(10).
  4087         16  CF-PLAN-NOTES                  PIC X(20).
  4088         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4089         16  CF-PLAN-UNDERWRITING.
  4090             20  CF-PLAN-TERM-DATA.
  4091                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4092                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4093             20  CF-PLAN-AGE-DATA.
  4094                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4095                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4096                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4097             20  CF-PLAN-BENEFIT-DATA.
  4098                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4099                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4100                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4101                                            PIC S9(7)V99  COMP-3.
  4102         16  CF-PLAN-POLICY-FORMS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  79
* EL640.cbl
  4103             20  CF-POLICY-FORM             PIC X(12).
  4104             20  CF-MASTER-APPLICATION      PIC X(12).
  4105             20  CF-MASTER-POLICY           PIC X(12).
  4106         16  CF-PLAN-RATING.
  4107             20  CF-RATE-CODE               PIC X(5).
  4108             20  CF-SEX-RATING              PIC X.
  4109                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4110                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4111             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4112             20  CF-SUB-STD-TYPE            PIC X.
  4113                 88  CF-PCT-OF-PREM            VALUE '1'.
  4114                 88  CF-PCT-OF-BENE            VALUE '2'.
  4115         16  CF-PLAN-PREM-TOLERANCES.
  4116             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4117             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4118         16  CF-PLAN-PYMT-TOLERANCES.
  4119             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4120             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4121         16  CF-PLAN-MISC-DATA.
  4122             20  FILLER                     PIC X.
  4123             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4124             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4125         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4126         16  CF-PLAN-IND-GRP                PIC X.
  4127             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4128                                                     '1'.
  4129             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4130                                                     '2'.
  4131         16  CF-MIB-SEARCH-SW               PIC X.
  4132             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4133             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4134             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4135             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4136         16  CF-ALPHA-SEARCH-SW             PIC X.
  4137             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4138             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4139             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4140             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4141             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4142             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4143             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4144             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4145             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4146             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4147                                                     'A' 'B' 'C'
  4148                                                     'X' 'Y' 'Z'.
  4149         16  CF-EFF-DT-RULE-SW              PIC X.
  4150             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4151             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4152             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4153             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4154             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4155         16  FILLER                         PIC X(4).
  4156         16  CF-HEALTH-QUESTIONS            PIC X.
  4157             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4158         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4159         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4160         16  CF-PLAN-SNGL-JNT               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  80
* EL640.cbl
  4161             88  CF-COMBINED-PLAN              VALUE 'C'.
  4162             88  CF-JNT-PLAN                   VALUE 'J'.
  4163             88  CF-SNGL-PLAN                  VALUE 'S'.
  4164         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4165         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4166         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4167         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4168         16  CF-RERATE-CNTL                 PIC  X.
  4169             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4170             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4171             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4172             88  CF-AUTO-RECALC                 VALUE '4'.
  4173         16  CF-BENEFIT-TYPE                PIC  X.
  4174             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4175             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4176         16  CF-POLICY-FEE                  PIC S999V99
  4177                                                    COMP-3.
  4178         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4179         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4180         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4181         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4182         16  FILLER                         PIC  X(32).
  4183         16  CF-TERMINATION-FORM            PIC  X(04).
  4184         16  FILLER                         PIC  X(08).
  4185         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4186                                                       COMP-3.
  4187         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4188         16  CF-ISSUE-LETTER                PIC  X(4).
  4189         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4190         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4191             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4192             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4193         16  CF-MP-REFUND-CALC              PIC X.
  4194             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4195             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4196             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4197             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4198             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4199             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4200             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4201             88  CF-MP-REFD-MEAN                VALUE '8'.
  4202         16  CF-ALT-RATE-CODE               PIC  X(5).
  4203
  4204
  4205         16  FILLER                         PIC X(498).
  4206****************************************************************
  4207*             MORTGAGE COMPANY MASTER RECORD                   *
  4208****************************************************************
  4209
  4210     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4211         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4212         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4213             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4214             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4215             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4216             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4217             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4218
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  81
* EL640.cbl
  4219         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4220         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4221         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4222         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4223         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4224
  4225         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4226             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4227         16  CF-MP-RECON-USE-IND            PIC X(1).
  4228             88  CF-MP-USE-RECON             VALUE 'Y'.
  4229         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4230             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4231         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4232             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4233             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4234         16  FILLER                         PIC X(1).
  4235         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4236             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4237         16  CF-MORTG-MIB-VERSION           PIC X.
  4238             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4239             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4240             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4241         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4242             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4243                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4244             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4245                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4246             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4247                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4248             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4249                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4250             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4251                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4252             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4253                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4254         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4255         16  FILLER                         PIC X(7).
  4256         16  CF-MORTG-DESTINATION-SYMBOL.
  4257             20  CF-MORTG-MIB-COMM          PIC X(5).
  4258             20  CF-MORTG-MIB-TERM          PIC X(5).
  4259         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4260             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4261         16  FILLER                         PIC X(03).
  4262         16  CF-MP-CHECK-NO-CONTROL.
  4263             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4264                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4265                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4266                                                ' ' LOW-VALUES.
  4267                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4268                                               VALUE '3'.
  4269         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4270         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4271         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4272             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4273                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4274             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4275                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4276             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  82
* EL640.cbl
  4277                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4278             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4279                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4280             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4281                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4282             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4283                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4284         16  CF-MORTG-BILLING-AREA.
  4285             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4286                                            PIC X.
  4287         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4288         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4289         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4290         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4291             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4292             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4293         16  FILLER                         PIC X.
  4294         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4295             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4296             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4297         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4298         16  FILLER                         PIC X(8).
  4299         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4300         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4301         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4302         16  CF-ACH-COMPANY-ID.
  4303             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4304                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4305                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4306                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4307             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4308         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4309             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4310         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4311             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4312             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4313         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4314         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4315         16  FILLER                         PIC X(536).
  4316
  4317****************************************************************
  4318*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4319****************************************************************
  4320
  4321     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4322         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4323             20  CF-FEMALE-HEIGHT.
  4324                 24  CF-FEMALE-FT           PIC 99.
  4325                 24  CF-FEMALE-IN           PIC 99.
  4326             20  CF-FEMALE-MIN-WT           PIC 999.
  4327             20  CF-FEMALE-MAX-WT           PIC 999.
  4328         16  FILLER                         PIC X(428).
  4329
  4330     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4331         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4332             20  CF-MALE-HEIGHT.
  4333                 24  CF-MALE-FT             PIC 99.
  4334                 24  CF-MALE-IN             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  83
* EL640.cbl
  4335             20  CF-MALE-MIN-WT             PIC 999.
  4336             20  CF-MALE-MAX-WT             PIC 999.
  4337         16  FILLER                         PIC X(428).
  4338******************************************************************
  4339*             AUTOMATIC ACTIVITY RECORD                          *
  4340******************************************************************
  4341     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4342         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4343             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4344             20  CF-SYS-LETTER-ID           PIC X(04).
  4345             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4346             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4347             20  CF-SYS-RESET-SW            PIC X(01).
  4348             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4349             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4350
  4351         16  FILLER                         PIC X(50).
  4352
  4353         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4354             20  CF-USER-ACTIVE-SW          PIC X(01).
  4355             20  CF-USER-LETTER-ID          PIC X(04).
  4356             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4357             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4358             20  CF-USER-RESET-SW           PIC X(01).
  4359             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4360             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4361             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4362
  4363         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  84
* EL640.cbl
  4365*                            COPY ERCCOMP.
  4366******************************************************************
  4367*                                                                *
  4368*                                                                *
  4369*                            ERCCOMP                             *
  4370*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4371*                            VMOD=2.019                          *
  4372*                                                                *
  4373*   ONLINE CREDIT SYSTEM                                         *
  4374*                                                                *
  4375*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4376*                                                                *
  4377*   FILE TYPE = VSAM,KSDS                                        *
  4378*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4379*                                                                *
  4380*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4381*       ALTERNATE PATH = NONE                                    *
  4382*                                                                *
  4383*   LOG = NO                                                     *
  4384*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4385*                                                                *
  4386******************************************************************
  4387*                   C H A N G E   L O G
  4388*
  4389* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4390*-----------------------------------------------------------------
  4391*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4392* EFFECTIVE    NUMBER
  4393*-----------------------------------------------------------------
  4394* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4395* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4396* 092205    2005050300006  PEMA  ADD LEASE FEE
  4397* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4398* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4399* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4400* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4401* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4402* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4403******************************************************************
  4404
  4405 01  COMPENSATION-MASTER.
  4406     12  CO-RECORD-ID                          PIC XX.
  4407         88  VALID-CO-ID                          VALUE 'CO'.
  4408
  4409     12  CO-CONTROL-PRIMARY.
  4410         16  CO-COMPANY-CD                     PIC X.
  4411         16  CO-CONTROL.
  4412             20  CO-CTL-1.
  4413                 24  CO-CARR-GROUP.
  4414                     28  CO-CARRIER            PIC X.
  4415                     28  CO-GROUPING.
  4416                         32  CO-GROUP-PREFIX   PIC XXX.
  4417                         32  CO-GROUP-PRIME    PIC XXX.
  4418                 24  CO-RESP-NO.
  4419                     28  CO-RESP-PREFIX        PIC X(4).
  4420                     28  CO-RESP-PRIME         PIC X(6).
  4421             20  CO-CTL-2.
  4422                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  85
* EL640.cbl
  4423                     28  CO-ACCT-PREFIX        PIC X(4).
  4424                     28  CO-ACCT-PRIME         PIC X(6).
  4425         16  CO-TYPE                           PIC X.
  4426             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4427             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4428             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4429
  4430     12  CO-MAINT-INFORMATION.
  4431         16  CO-LAST-MAINT-DT                  PIC XX.
  4432         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4433         16  CO-LAST-MAINT-USER                PIC X(4).
  4434     12  FILLER                                PIC XX.
  4435     12  CO-STMT-TYPE                          PIC XXX.
  4436     12  CO-COMP-TYPE                          PIC X.
  4437         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4438     12  CO-STMT-OWNER                         PIC X(4).
  4439     12  CO-BALANCE-CONTROL                    PIC X.
  4440         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4441         88  CO-NO-BALANCE                        VALUE 'N'.
  4442
  4443     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4444         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4445         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4446         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4447
  4448     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4449         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4450         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4451
  4452     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4453     12  CO-GA-DIRECT-DEP                      PIC X.
  4454     12  CO-FUTURE-SPACE                       PIC X.
  4455         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4456
  4457     12  CO-ACCT-NAME                          PIC X(30).
  4458     12  CO-MAIL-NAME                          PIC X(30).
  4459     12  CO-ADDR-1                             PIC X(30).
  4460     12  CO-ADDR-2                             PIC X(30).
  4461     12  CO-ADDR-3.
  4462         16  CO-ADDR-CITY                      PIC X(27).
  4463         16  CO-ADDR-STATE                     PIC XX.
  4464     12  CO-CSO-1099                           PIC X.
  4465     12  CO-ZIP.
  4466         16  CO-ZIP-PRIME.
  4467             20  CO-ZIP-PRI-1ST                PIC X.
  4468                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4469             20  FILLER                        PIC X(4).
  4470         16  CO-ZIP-PLUS4                      PIC X(4).
  4471     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4472         16  CO-CAN-POSTAL-1                   PIC XXX.
  4473         16  CO-CAN-POSTAL-2                   PIC XXX.
  4474         16  FILLER                            PIC XXX.
  4475     12  CO-SOC-SEC                            PIC X(13).
  4476     12  CO-TELEPHONE.
  4477         16  CO-AREA-CODE                      PIC XXX.
  4478         16  CO-PREFIX                         PIC XXX.
  4479         16  CO-PHONE                          PIC X(4).
  4480
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  86
* EL640.cbl
  4481     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4482
  4483     12  CO-AR-BAL-LEVEL                       PIC X.
  4484         88  CO-AR-REF-LVL                        VALUE '1'.
  4485         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4486         88  CO-AR-BILL-LVL                       VALUE '2'.
  4487         88  CO-AR-AGT-LVL                        VALUE '3'.
  4488         88  CO-AR-FR-LVL                         VALUE '4'.
  4489
  4490     12  CO-AR-NORMAL-PRINT                    PIC X.
  4491         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4492         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4493
  4494     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4495
  4496     12  CO-AR-REPORTING                       PIC X.
  4497         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4498         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4499
  4500     12  CO-AR-PULL-CHECK                      PIC X.
  4501         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4502         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4503
  4504     12  CO-AR-BALANCE-PRINT                   PIC X.
  4505         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4506
  4507     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4508         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4509         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4510         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4511
  4512     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4513
  4514     12  CO-USER-CODE                          PIC X.
  4515     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4516
  4517******************************************************************
  4518*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4519*    THE LAST MONTH END RUN.
  4520******************************************************************
  4521
  4522     12  CO-LAST-ACTIVITY-DATE.
  4523         16  CO-ACT-YEAR                       PIC 99.
  4524         16  CO-ACT-MONTH                      PIC 99.
  4525         16  CO-ACT-DAY                        PIC 99.
  4526
  4527     12  CO-LAST-STMT-DT.
  4528         16  CO-LAST-STMT-YEAR                 PIC 99.
  4529         16  CO-LAST-STMT-MONTH                PIC 99.
  4530         16  CO-LAST-STMT-DAY                  PIC 99.
  4531
  4532     12  CO-MO-END-TOTALS.
  4533         16  CO-MONTHLY-TOTALS.
  4534             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4535             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4536             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4537             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4538             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  87
* EL640.cbl
  4539
  4540         16  CO-AGING-TOTALS.
  4541             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4542             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4543             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4544             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4545
  4546         16  CO-YTD-TOTALS.
  4547             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4548             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4549
  4550         16  CO-OVER-UNDER-TOTALS.
  4551             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4552             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4553
  4554     12  CO-MISCELLANEOUS-TOTALS.
  4555         16  CO-FICA-TOTALS.
  4556             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4557             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4558
  4559         16  CO-CLAIM-TOTALS.
  4560             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4561             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4562
  4563******************************************************************
  4564*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4565*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4566******************************************************************
  4567
  4568     12  CO-CURRENT-TOTALS.
  4569         16  CO-CURRENT-LAST-STMT-DT.
  4570             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4571             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4572             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4573
  4574         16  CO-CURRENT-MONTHLY-TOTALS.
  4575             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4576             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4577             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4578             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4579             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4580
  4581         16  CO-CURRENT-AGING-TOTALS.
  4582             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4583             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4584             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4585             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4586
  4587         16  CO-CURRENT-YTD-TOTALS.
  4588             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4589             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4590
  4591     12  CO-PAID-COMM-TOTALS.
  4592         16  CO-YTD-PAID-COMMS.
  4593             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4594             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4595
  4596     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  88
* EL640.cbl
  4597         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4598         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4599
  4600     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4601         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4602         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4603         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4604         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4605         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4606         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4607         88  CO-FINAL-LETTER                  VALUE 'F'.
  4608         88  CO-RECONCILING                   VALUE 'R'.
  4609         88  CO-PHONE-CALL                    VALUE 'P'.
  4610         88  CO-LEGAL                         VALUE 'L'.
  4611         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4612         88  CO-WRITE-OFF                     VALUE 'W'.
  4613         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4614
  4615     12  CO-CSR-CODE                       PIC X(4).
  4616
  4617     12  CO-GA-STATUS-INFO.
  4618         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4619         16  CO-GA-TERMINATION-DT          PIC XX.
  4620         16  CO-GA-STATUS-CODE             PIC X.
  4621             88  CO-GA-ACTIVE                 VALUE 'A'.
  4622             88  CO-GA-INACTIVE               VALUE 'I'.
  4623             88  CO-GA-PENDING                VALUE 'P'.
  4624         16  CO-GA-COMMENTS.
  4625             20  CO-GA-COMMENT-1           PIC X(40).
  4626             20  CO-GA-COMMENT-2           PIC X(40).
  4627             20  CO-GA-COMMENT-3           PIC X(40).
  4628             20  CO-GA-COMMENT-4           PIC X(40).
  4629
  4630     12  CO-RPTCD2                         PIC X(10).
  4631     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4632         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4633         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4634
  4635     12  CO-TYPE-AGENT                     PIC X(01).
  4636         88  CO-CORPORATION                   VALUE 'C'.
  4637         88  CO-PARTNERSHIP                   VALUE 'P'.
  4638         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4639         88  CO-TRUST                         VALUE 'T'.
  4640         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4641
  4642     12  CO-FAXNO.
  4643         16  CO-FAX-AREA-CODE                  PIC XXX.
  4644         16  CO-FAX-PREFIX                     PIC XXX.
  4645         16  CO-FAX-PHONE                      PIC X(4).
  4646
  4647     12  CO-BANK-INFORMATION.
  4648         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4649         16  CO-BANK-TRANSIT-NON REDEFINES
  4650             CO-BANK-TRANSIT-NO                PIC 9(8).
  4651
  4652         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4653     12  CO-MISC-DEDUCT-INFO REDEFINES
  4654                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  89
* EL640.cbl
  4655         16  CO-MD-GL-ACCT                     PIC X(10).
  4656         16  CO-MD-DIV                         PIC XX.
  4657         16  CO-MD-CENTER                      PIC X(4).
  4658         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4659         16  CO-CREATE-AP-CHECK                PIC X.
  4660         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4661         16  FILLER                            PIC XXX.
  4662     12  CO-ACH-STATUS                         PIC X.
  4663         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4664         88  CO-ACH-PENDING                        VALUE 'P'.
  4665
  4666     12  CO-BILL-SW                            PIC X.
  4667     12  CO-CONTROL-NAME                       PIC X(30).
  4668     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4669     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4670     12  CO-CLP-STATE                          PIC XX.
  4671     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4672     12  CO-SPP-REFUND-EDIT                    PIC X.
  4673
  4674******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  90
* EL640.cbl
  4676*                            COPY ERCPYAJ.
  4677******************************************************************
  4678*                                                                *
  4679*                            ERCPYAJ                             *
  4680*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4681*                            VMOD=2.015                          *
  4682*                                                                *
  4683*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4684*                                                                *
  4685*                                                                *
  4686*   FILE TYPE = VSAM,KSDS                                        *
  4687*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4688*                                                                *
  4689*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4690*       ALTERNATE PATHS = NONE                                   *
  4691*                                                                *
  4692*   LOG = YES                                                    *
  4693*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4694******************************************************************
  4695******************************************************************
  4696*                   C H A N G E   L O G
  4697*
  4698* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4699*-----------------------------------------------------------------
  4700*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4701* EFFECTIVE    NUMBER
  4702*-----------------------------------------------------------------
  4703* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4704* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4705******************************************************************
  4706
  4707 01  PENDING-PAY-ADJ.
  4708     12  PY-RECORD-ID                     PIC XX.
  4709         88  VALID-PY-ID                        VALUE 'PY'.
  4710
  4711     12  PY-CONTROL-PRIMARY.
  4712         16  PY-COMPANY-CD                PIC X.
  4713         16  PY-CARRIER                   PIC X.
  4714         16  PY-GROUPING                  PIC X(6).
  4715         16  PY-FIN-RESP                  PIC X(10).
  4716         16  PY-ACCOUNT                   PIC X(10).
  4717         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4718                                          PIC X(10).
  4719         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4720         16  PY-RECORD-TYPE               PIC X.
  4721             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4722             88  PY-DEPOSIT                   VALUE 'D'.
  4723             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4724             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4725             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4726             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4727             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4728             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4729             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4730             88  PY-FICA-ENTRY                VALUE 'F'.
  4731             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4732             88  PY-POLICY-FEE                VALUE 'W'.
  4733             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  91
* EL640.cbl
  4734
  4735     12  PY-PYMT-TYPE                     PIC X.
  4736             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4737             88  PY-REINS-PYMT                VALUE 'R'.
  4738             88  PY-EXP-PYMT                  VALUE 'E'.
  4739
  4740     12  PY-BIL-INV                       PIC X(6).
  4741     12  PY-REF-NO                        PIC X(12).
  4742
  4743     12  PY-LAST-MAINT-DT                 PIC XX.
  4744     12  PY-LAST-MAINT-BY                 PIC X(4).
  4745     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4746
  4747     12  PY-PYADJ-RECORD.
  4748         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4749         16  PY-ENTRY-COMMENT             PIC X(30).
  4750         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4751             20  PY-GL-ACCOUNT            PIC X(10).
  4752             20  PY-GL-STATE              PIC X(02).
  4753             20  PY-GL-CANC-SW            PIC X(01).
  4754                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4755                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4756             20  PY-GL-COMMENT            PIC X(10).
  4757             20  FILLER      REDEFINES PY-GL-COMMENT.
  4758                 24  PY-GL-CHECK-NO       PIC 9(06).
  4759                 24  FILLER               PIC X(04).
  4760             20  FILLER                   PIC X(07).
  4761         16  PY-SAVE-ACCOUNT              PIC X(10).
  4762         16  PY-SAVE-TYPE                 PIC X(01).
  4763
  4764         16  PY-LETTERS.
  4765             20  PY-LETTER OCCURS 3 TIMES
  4766                           INDEXED BY PY-LET-NDX
  4767                                          PIC X(04).
  4768
  4769         16  PY-ERCOMP-TYPE               PIC X.
  4770             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4771             88  PY-GA-TYPE                   VALUE 'G'.
  4772             88  PY-BANK-TYPE                 VALUE 'B'.
  4773         16  FILLER                       PIC X(05).
  4774
  4775     12  PY-RECORD-STATUS.
  4776         16  PY-CREDIT-SELECT-DT          PIC XX.
  4777         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4778         16  PY-BILLED-DATE               PIC XX.
  4779         16  PY-REPORTED-DT               PIC XX.
  4780         16  PY-PMT-APPLIED               PIC X.
  4781             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4782             88  PY-GA-PMT                    VALUE 'G'.
  4783             88  PY-OVWRITE-PMT               VALUE 'O'.
  4784             88  PY-NON-AR-PMT                VALUE 'N'.
  4785         16  FILLER                       PIC X(5).
  4786         16  PY-INPUT-DT                  PIC XX.
  4787         16  PY-CHECK-NUMBER              PIC X(6).
  4788         16  PY-VOID-SW                   PIC X.
  4789             88  PY-CHECK-VOIDED              VALUE 'V'.
  4790         16  PY-CHECK-ORIGIN-SW           PIC X.
  4791             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  92
* EL640.cbl
  4792             88  PY-REFUND-CHECK              VALUE 'R'.
  4793             88  PY-GA-CHECK                  VALUE 'G'.
  4794             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4795             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4796         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4797         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4798         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4799         16  PY-BILL-FLAG                 PIC X.
  4800             88  PY-BILLED                    VALUE 'B'.
  4801         16  PY-AR-FLAG                   PIC X.
  4802             88  PY-AR-CYCLE                  VALUE 'C'.
  4803             88  PY-AR-MONTH-END              VALUE 'M'.
  4804         16  PY-AR-DATE                   PIC XX.
  4805
  4806     12  PY-GL-CODES.
  4807         16  PY-GL-DB                     PIC X(14).
  4808         16  PY-GL-CR                     PIC X(14).
  4809         16  PY-GL-FLAG                   PIC X.
  4810         16  PY-GL-DATE                   PIC XX.
  4811
  4812     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4813     12  FILLER                           PIC X(3).
  4814******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  93
* EL640.cbl
  4816*                            COPY ERCACCT.
  4817******************************************************************
  4818*                                                                *
  4819*                                                                *
  4820*                            ERCACCT                             *
  4821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4822*                            VMOD=2.031                          *
  4823*                                                                *
  4824*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4825*                                                                *
  4826*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4827*   VSAM ACCOUNT MASTER FILES.                                   *
  4828*                                                                *
  4829*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4830*                                                                *
  4831*   FILE TYPE = VSAM,KSDS                                        *
  4832*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4833*                                                                *
  4834*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4835*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4836*                                                                *
  4837*   LOG = NO                                                     *
  4838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4839*                                                                *
  4840*                                                                *
  4841******************************************************************
  4842*                   C H A N G E   L O G
  4843*
  4844* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4845*-----------------------------------------------------------------
  4846*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4847* EFFECTIVE    NUMBER
  4848*-----------------------------------------------------------------
  4849* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4850* 092705    2005050300006  PEMA  ADD SPP LEASES
  4851* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4852* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4853* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4854* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4855* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4856******************************************************************
  4857
  4858 01  ACCOUNT-MASTER.
  4859     12  AM-RECORD-ID                      PIC XX.
  4860         88  VALID-AM-ID                      VALUE 'AM'.
  4861
  4862     12  AM-CONTROL-PRIMARY.
  4863         16  AM-COMPANY-CD                 PIC X.
  4864         16  AM-MSTR-CNTRL.
  4865             20  AM-CONTROL-A.
  4866                 24  AM-CARRIER            PIC X.
  4867                 24  AM-GROUPING.
  4868                     28 AM-GROUPING-PREFIX PIC XXX.
  4869                     28 AM-GROUPING-PRIME  PIC XXX.
  4870                 24  AM-STATE              PIC XX.
  4871                 24  AM-ACCOUNT.
  4872                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4873                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  94
* EL640.cbl
  4874             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4875                                           PIC X(19).
  4876             20  AM-CNTRL-B.
  4877                 24  AM-EXPIRATION-DT      PIC XX.
  4878                 24  FILLER                PIC X(4).
  4879             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4880                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4881
  4882     12  AM-CONTROL-BY-VAR-GRP.
  4883         16  AM-COMPANY-CD-A1              PIC X.
  4884         16  AM-VG-CARRIER                 PIC X.
  4885         16  AM-VG-GROUPING                PIC X(6).
  4886         16  AM-VG-STATE                   PIC XX.
  4887         16  AM-VG-ACCOUNT                 PIC X(10).
  4888         16  AM-VG-DATE.
  4889             20  AM-VG-EXPIRATION-DT       PIC XX.
  4890             20  FILLER                    PIC X(4).
  4891         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4892                                           PIC 9(11)      COMP-3.
  4893     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4894         16  FILLER                        PIC X(10).
  4895         16  AM-VG-KEY3.
  4896             20  AM-VG3-ACCOUNT            PIC X(10).
  4897             20  AM-VG3-EXP-DT             PIC XX.
  4898         16  FILLER                        PIC X(4).
  4899     12  AM-MAINT-INFORMATION.
  4900         16  AM-LAST-MAINT-DT              PIC XX.
  4901         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4902         16  AM-LAST-MAINT-USER            PIC X(4).
  4903         16  FILLER                        PIC XX.
  4904
  4905     12  AM-EFFECTIVE-DT                   PIC XX.
  4906     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4907
  4908     12  AM-PREV-DATES  COMP-3.
  4909         16  AM-PREV-EXP-DT                PIC 9(11).
  4910         16  AM-PREV-EFF-DT                PIC 9(11).
  4911
  4912     12  AM-REPORT-CODE-1                  PIC X(10).
  4913     12  AM-REPORT-CODE-2                  PIC X(10).
  4914
  4915     12  AM-CITY-CODE                      PIC X(4).
  4916     12  AM-COUNTY-PARISH                  PIC X(6).
  4917
  4918     12  AM-NAME                           PIC X(30).
  4919     12  AM-PERSON                         PIC X(30).
  4920     12  AM-ADDRS                          PIC X(30).
  4921     12  AM-CITY.
  4922         16  AM-ADDR-CITY                  PIC X(28).
  4923         16  AM-ADDR-STATE                 PIC XX.
  4924     12  AM-ZIP.
  4925         16  AM-ZIP-PRIME.
  4926             20  AM-ZIP-PRI-1ST            PIC X.
  4927                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4928             20  FILLER                    PIC X(4).
  4929         16  AM-ZIP-PLUS4                  PIC X(4).
  4930     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4931         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  95
* EL640.cbl
  4932         16  AM-CAN-POSTAL-2               PIC XXX.
  4933         16  FILLER                        PIC XXX.
  4934     12  AM-TEL-NO.
  4935         16  AM-AREA-CODE                  PIC 999.
  4936         16  AM-TEL-PRE                    PIC 999.
  4937         16  AM-TEL-NBR                    PIC 9(4).
  4938     12  AM-TEL-LOC                        PIC X.
  4939         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4940         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4941
  4942     12  AM-COMM-STRUCTURE.
  4943         16  AM-DEFN-1.
  4944             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4945                 24  AM-AGT.
  4946                     28  AM-AGT-PREFIX     PIC X(4).
  4947                     28  AM-AGT-PRIME      PIC X(6).
  4948                 24  AM-COM-TYP            PIC X.
  4949                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4950                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4951                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4952                 24  AM-RECALC-LV-INDIC    PIC X.
  4953                 24  AM-RETRO-LV-INDIC     PIC X.
  4954                 24  AM-GL-CODES           PIC X.
  4955                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4956                 24  FILLER                PIC X(01).
  4957         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4958             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4959                 24  FILLER                PIC X(11).
  4960                 24  AM-L-COMA             PIC XXX.
  4961                 24  AM-J-COMA             PIC XXX.
  4962                 24  AM-A-COMA             PIC XXX.
  4963                 24  FILLER                PIC X(6).
  4964
  4965     12  AM-COMM-CHANGE-STATUS             PIC X.
  4966         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4967
  4968     12  AM-CSR-CODE                       PIC X(4).
  4969
  4970     12  AM-BILLING-STATUS                 PIC X.
  4971         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4972         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4973     12  AM-AUTO-REFUND-SW                 PIC X.
  4974         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4975         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4976     12  AM-GPCD                           PIC 99.
  4977     12  AM-IG                             PIC X.
  4978         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4979         88  AM-HAS-GROUP                     VALUE '2'.
  4980     12  AM-STATUS                         PIC X.
  4981         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4982         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4983         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4984         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4985         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4986         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4987     12  AM-REMIT-TO                       PIC 99.
  4988     12  AM-ID-NO                          PIC X(11).
  4989
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  96
* EL640.cbl
  4990     12  AM-CAL-TABLE                      PIC XX.
  4991     12  AM-LF-DEVIATION                   PIC XXX.
  4992     12  AM-AH-DEVIATION                   PIC XXX.
  4993     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4994     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4995     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4996     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4997     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4998     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4999
  5000     12  AM-USER-FIELDS.
  5001         16  AM-FLD-1                      PIC XX.
  5002         16  AM-FLD-2                      PIC XX.
  5003         16  AM-FLD-3                      PIC XX.
  5004         16  AM-FLD-4                      PIC XX.
  5005         16  AM-FLD-5                      PIC XX.
  5006
  5007     12  AM-1ST-PROD-DATE.
  5008         16  AM-1ST-PROD-YR                PIC XX.
  5009         16  AM-1ST-PROD-MO                PIC XX.
  5010         16  AM-1ST-PROD-DA                PIC XX.
  5011     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5012     12  AM-CERTS-PURGED-DATE.
  5013         16  AM-PUR-YR                     PIC XX.
  5014         16  AM-PUR-MO                     PIC XX.
  5015         16  AM-PUR-DA                     PIC XX.
  5016     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5017     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5018     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5019     12  AM-INACTIVE-DATE.
  5020         16  AM-INA-MO                     PIC 99.
  5021         16  AM-INA-DA                     PIC 99.
  5022         16  AM-INA-YR                     PIC 99.
  5023     12  AM-AR-HI-CERT-DATE                PIC XX.
  5024
  5025     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5026     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5027
  5028     12  AM-OB-PAYMENT-MODE                PIC X.
  5029         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5030         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5031         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5032         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5033
  5034     12  AM-AH-ONLY-INDICATOR              PIC X.
  5035         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5036         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5037
  5038     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5039
  5040     12  AM-OVER-SHORT.
  5041         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5042         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5043
  5044     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5045     12  AM-DCC-CLP-STATE                  PIC XX.
  5046
  5047     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  97
* EL640.cbl
  5048     12  AM-RECALC-REIN                    PIC X.
  5049
  5050     12  AM-REI-TABLE                      PIC XXX.
  5051     12  AM-REI-ET-LF                      PIC X.
  5052     12  AM-REI-ET-AH                      PIC X.
  5053     12  AM-REI-PE-LF                      PIC X.
  5054     12  AM-REI-PE-AH                      PIC X.
  5055     12  AM-REI-PRT-ST                     PIC X.
  5056     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5057     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5058     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5059     12  AM-REI-GROUP-A                    PIC X(6).
  5060     12  AM-REI-MORT                       PIC X(4).
  5061     12  AM-REI-PRT-OW                     PIC X.
  5062     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5063     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5064     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5065     12  AM-REI-GROUP-B                    PIC X(6).
  5066
  5067     12  AM-TRUST-TYPE                     PIC X(2).
  5068
  5069     12  AM-EMPLOYER-STMT-USED             PIC X.
  5070     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5071
  5072     12  AM-STD-AH-TYPE                    PIC XX.
  5073     12  AM-EARN-METHODS.
  5074         16  AM-EARN-METHOD-R              PIC X.
  5075             88 AM-REF-RL-R78                 VALUE 'R'.
  5076             88 AM-REF-RL-PR                  VALUE 'P'.
  5077             88 AM-REF-RL-MEAN                VALUE 'M'.
  5078             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5079         16  AM-EARN-METHOD-L              PIC X.
  5080             88 AM-REF-LL-R78                 VALUE 'R'.
  5081             88 AM-REF-LL-PR                  VALUE 'P'.
  5082             88 AM-REF-LL-MEAN                VALUE 'M'.
  5083             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5084         16  AM-EARN-METHOD-A              PIC X.
  5085             88 AM-REF-AH-R78                 VALUE 'R'.
  5086             88 AM-REF-AH-PR                  VALUE 'P'.
  5087             88 AM-REF-AH-MEAN                VALUE 'M'.
  5088             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5089             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5090             88 AM-REF-AH-NET                 VALUE 'N'.
  5091
  5092     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5093     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5094     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5095
  5096     12  AM-RET-Y-N                        PIC X.
  5097     12  AM-RET-P-E                        PIC X.
  5098     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5099     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5100     12  AM-RET-GRP                        PIC X(6).
  5101     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5102         16  AM-POOL-PRIME                 PIC XXX.
  5103         16  AM-POOL-SUB                   PIC XXX.
  5104     12  AM-RETRO-EARNINGS.
  5105         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  98
* EL640.cbl
  5106         16  AM-RET-EARN-L                 PIC X.
  5107         16  AM-RET-EARN-A                 PIC X.
  5108     12  AM-RET-ST-TAX-USE                 PIC X.
  5109         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5110         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5111     12  AM-RETRO-BEG-EARNINGS.
  5112         16  AM-RET-BEG-EARN-R             PIC X.
  5113         16  AM-RET-BEG-EARN-L             PIC X.
  5114         16  AM-RET-BEG-EARN-A             PIC X.
  5115     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5116     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5117
  5118     12  AM-USER-SELECT-OPTIONS.
  5119         16  AM-USER-SELECT-1              PIC X(10).
  5120         16  AM-USER-SELECT-2              PIC X(10).
  5121         16  AM-USER-SELECT-3              PIC X(10).
  5122         16  AM-USER-SELECT-4              PIC X(10).
  5123         16  AM-USER-SELECT-5              PIC X(10).
  5124
  5125     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5126
  5127     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5128
  5129     12  AM-RPT045A-SWITCH                 PIC X.
  5130         88  RPT045A-OFF                   VALUE 'N'.
  5131
  5132     12  AM-INSURANCE-LIMITS.
  5133         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5134         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5135
  5136     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5137         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5138
  5139     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5140         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5141         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5142
  5143     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5144
  5145     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5146     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5147     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5148     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5149     12  AM-DCC-UEF-STATE                  PIC XX.
  5150     12  FILLER                            PIC XXX.
  5151     12  AM-REPORT-CODE-3                  PIC X(10).
  5152*    12  FILLER                            PIC X(22).
  5153
  5154     12  AM-RESERVE-DATE.
  5155         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5156         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5157         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5158
  5159     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5160     12  AM-NOTIFICATION-TYPES.
  5161         16  AM-NOTIF-OF-LETTERS           PIC X.
  5162         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5163         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page  99
* EL640.cbl
  5164         16  AM-NOTIF-OF-STATUS            PIC X.
  5165
  5166     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5167         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5168         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5169         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5170         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5171
  5172     12  AM-BENEFIT-CONTROLS.
  5173         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5174             20  AM-BENEFIT-CODE           PIC XX.
  5175             20  AM-BENEFIT-TYPE           PIC X.
  5176             20  AM-BENEFIT-REVISION       PIC XXX.
  5177             20  AM-BENEFIT-REM-TERM       PIC X.
  5178             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5179             20  FILLER                    PIC XX.
  5180         16  FILLER                        PIC X(80).
  5181
  5182     12  AM-TRANSFER-DATA.
  5183         16  AM-TRANSFERRED-FROM.
  5184             20  AM-TRNFROM-CARRIER        PIC X.
  5185             20  AM-TRNFROM-GROUPING.
  5186                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5187                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5188             20  AM-TRNFROM-STATE          PIC XX.
  5189             20  AM-TRNFROM-ACCOUNT.
  5190                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5191                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5192             20  AM-TRNFROM-DTE            PIC XX.
  5193         16  AM-TRANSFERRED-TO.
  5194             20  AM-TRNTO-CARRIER          PIC X.
  5195             20  AM-TRNTO-GROUPING.
  5196                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5197                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5198             20  AM-TRNTO-STATE            PIC XX.
  5199             20  AM-TRNTO-ACCOUNT.
  5200                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5201                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5202             20  AM-TRNTO-DTE              PIC XX.
  5203         16  FILLER                        PIC X(10).
  5204
  5205     12  AM-SAVED-REMIT-TO                 PIC 99.
  5206
  5207     12  AM-COMM-STRUCTURE-SAVED.
  5208         16  AM-DEFN-1-SAVED.
  5209             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5210                 24  AM-AGT-SV             PIC X(10).
  5211                 24  AM-COM-TYP-SV         PIC X.
  5212                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5213                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5214                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5215                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5216                 24  FILLER                PIC X.
  5217                 24  AM-GL-CODES-SV        PIC X.
  5218                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5219                 24  FILLER                PIC X.
  5220         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5221             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 100
* EL640.cbl
  5222                 24  FILLER                PIC X(11).
  5223                 24  AM-L-COMA-SV          PIC XXX.
  5224                 24  AM-J-COMA-SV          PIC XXX.
  5225                 24  AM-A-COMA-SV          PIC XXX.
  5226                 24  FILLER                PIC X(6).
  5227
  5228     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5229         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5230            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5231            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5232            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5233
  5234     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5235     12  FILLER                            PIC X(120).
  5236
  5237     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5238         16  AM-CONTROL-NAME               PIC X(30).
  5239         16  AM-EXECUTIVE-ONE.
  5240             20  AM-EXEC1-NAME             PIC X(15).
  5241             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5242                                                          COMP-3.
  5243             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5244                                                          COMP-3.
  5245         16  AM-EXECUTIVE-TWO.
  5246             20  AM-EXEC2-NAME             PIC X(15).
  5247             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5248                                                          COMP-3.
  5249             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5250                                                          COMP-3.
  5251
  5252     12  AM-RETRO-ADDITIONAL-DATA.
  5253         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5254         16  AM-RETRO-PREM-P-E             PIC X.
  5255         16  AM-RETRO-CLMS-P-I             PIC X.
  5256         16  AM-RETRO-RET-BRACKET-LF.
  5257             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5258                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5259                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5260             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5261                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5262                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5263             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5264                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5265                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5266         16  AM-RETRO-RET-BRACKET-AH.
  5267             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5268                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5269                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5270                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5271             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5272                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5273                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5274             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5275                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5276                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5277
  5278     12  AM-COMMENTS.
  5279         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 101
* EL640.cbl
  5280
  5281     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5282         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5283         16  AM-FLI-BILLING-CODE           PIC X.
  5284         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5285         16  AM-FLI-UNITED-IDENT           PIC X.
  5286         16  AM-FLI-INTEREST-LOST-DATA.
  5287             20  AM-FLI-BANK-NO            PIC X(5).
  5288             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5289             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5290             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5291         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5292             20  AM-FLI-AGT                PIC X(9).
  5293             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5294             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5295         16  FILLER                        PIC X(102).
  5296
  5297     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5298         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5299             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5300             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5301             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5302             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5303             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5304         16  FILLER                          PIC X(10).
  5305******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 102
* EL640.cbl
  5307*                            COPY ERCBILL.
  5308******************************************************************
  5309*                                                                *
  5310*                                                                *
  5311*                            ERCBILL                             *
  5312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5313*                            VMOD=2.007                          *
  5314*                                                                *
  5315*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5316*                                                                *
  5317*   FILE TYPE = VSAM,KSDS                                        *
  5318*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5319*                                                                *
  5320*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5321*                                                                *
  5322*   LOG = NO                                                     *
  5323*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5324******************************************************************
  5325 01  BILLING-STATEMENT.
  5326     02 BILLING-STATEMENT-FILE.
  5327     12  BI-RECORD-ID                PIC XX.
  5328         88  VALID-BI-ID                VALUE 'BI'.
  5329
  5330     12  BI-CONTROL-PRIMARY.
  5331         16  BI-COMPANY-CD           PIC X.
  5332         16  BI-CARRIER              PIC X.
  5333         16  BI-GROUPING             PIC X(6).
  5334         16  BI-ACCOUNT              PIC X(10).
  5335         16  BI-FIN-RESP             PIC X(10).
  5336         16  BI-RECORD-TYPE          PIC X.
  5337             88  BI-HEADER-DATA         VALUE '1'.
  5338             88  BI-ADDRESS-DATA        VALUE '2'.
  5339             88  BI-TEXT-DATA           VALUE '3'.
  5340         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5341
  5342     12  BI-TEXT-RECORD.
  5343         16  BI-SKIP-CONTROL         PIC X.
  5344         16  BI-TEXT-LINE            PIC X(157).
  5345         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5346             20  BI-ADDR-LIT         PIC X(14).
  5347             20  BI-CO               PIC X(7).
  5348             20  BI-DASH             PIC X.
  5349             20  BI-ACCT             PIC X(10).
  5350             20  FILLER              PIC XX.
  5351             20  BI-ACCT-ADDR        PIC X(30).
  5352             20  FILLER              PIC X.
  5353             20  BI-REMIT-LIT        PIC X(11).
  5354             20  FILLER              PIC XX.
  5355             20  BI-REMIT-ADDR       PIC X(30).
  5356             20  FILLER              PIC X(49).
  5357         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5358             20  BI-INS-LAST-NAME    PIC X(15).
  5359             20  FILLER              PIC X.
  5360             20  BI-INS-1ST-NAME     PIC X(10).
  5361             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5362                 24  BI-INS-INITS    PIC XX.
  5363                 24  FILLER          PIC X(8).
  5364             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 103
* EL640.cbl
  5365             20  BI-UNDRWRTR.
  5366                 24  BI-INS-INIT     PIC X.
  5367                 24  FILLER          PIC XXX.
  5368             20  BI-CERT             PIC X(11).
  5369             20  FILLER              PIC XX.
  5370             20  BI-EFF-DT           PIC X(8).
  5371             20  FILLER              PIC XX.
  5372             20  BI-CAN-DT           PIC X(8).
  5373             20  FILLER              PIC XX.
  5374             20  BI-ED-TERM          PIC ZZZ.
  5375             20  FILLER              PIC XX.
  5376             20  BI-TYPE             PIC XXXX.
  5377             20  FILLER              PIC X.
  5378             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5379             20  FILLER              PIC X(3).
  5380             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5381             20  FILLER              PIC XX.
  5382             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5383             20  FILLER              PIC XX.
  5384             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5385             20  FILLER              PIC X(26).
  5386         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5387             20  FILLER              PIC X(42).
  5388             20  BI-TOT-DESC         PIC X(20).
  5389             20  FILLER REDEFINES BI-TOT-DESC.
  5390                 24  BI-TOT-LIT      PIC X(6).
  5391                 24  BI-OVERRIDE-L6  PIC X(14).
  5392             20  FILLER              PIC X(11).
  5393             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5394             20  BI-TOT-DASH REDEFINES
  5395                 BI-TOT-PREM         PIC X(15).
  5396             20  FILLER              PIC X(11).
  5397             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5398             20  FILLER              PIC XX.
  5399             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5400             20  FILLER              PIC X(26).
  5401         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5402             20  BI-ENTRY-DESC       PIC X(30).
  5403             20  FILLER              PIC X(11).
  5404             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5405             20  FILLER              PIC X(31).
  5406             20  BI-ACCTG-COMMENT    PIC X(30).
  5407             20  FILLER              PIC X(39).
  5408         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5409             20  FILLER              PIC X(42).
  5410             20  BI-TOT-DESC5        PIC X(20).
  5411             20  FILLER              PIC X(11).
  5412             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5413             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5414             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5415             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5416             20  FILLER              PIC X(24).
  5417         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5418             20  BI-TEXT-2-81        PIC X(80).
  5419             20  FILLER              PIC X(77).
  5420         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5421             20  FILLER              PIC X(53).
  5422             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 104
* EL640.cbl
  5423             20  FILLER              PIC X(25).
  5424         16  BI-TEXT-TYPE            PIC X.
  5425             88 DETAIL-LINE              VALUE 'D'.
  5426         16  BI-TERM                 PIC S999.
  5427         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5428         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5429         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5430
  5431     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5432         16  FILLER                  PIC X.
  5433         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5434         16  FILLER                  PIC X(10).
  5435         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5436         16  FILLER                  PIC X(106).
  5437
  5438     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5439         16  BI-PROCESSOR-CD         PIC X(4).
  5440         16  BI-STATEMENT-TYPE       PIC X.
  5441             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5442         16  BI-NO-OF-COPIES         PIC S9.
  5443         16  BI-CREATION-DT          PIC XX.
  5444         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5445         16  BI-ACCOUNT-TOTALS.
  5446             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5447             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5448             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5449             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5450             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5451             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5452             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5453             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5454         16  BI-FIN-RESP-ACCT        PIC X(10).
  5455         16  BI-FIN-RESP-NAME        PIC X(30).
  5456         16  FILLER                  PIC X(79).
  5457
  5458
  5459     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5460     12  FILLER                      PIC XX.
  5461
  5462     12  GA-CONTROL-PRIMARY.
  5463         16  FILLER                  PIC X(31).
  5464
  5465     12  GA-TEXT-RECORD.
  5466         16  GA-SKIP-CONTROL         PIC X.
  5467         16  GA-TEXT-LINE            PIC X(132).
  5468         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5469             20  FILLER              PIC X.
  5470             20  GA-CARRIER          PIC X.
  5471             20  GA-GROUPING         PIC X(6).
  5472             20  GA-DASH             PIC X.
  5473             20  GA-AGENT            PIC X(10).
  5474             20  FILLER              PIC X.
  5475             20  GA-AGENT-ADDR       PIC X(30).
  5476             20  FILLER              PIC X(82).
  5477         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5478             20  GA-ACCT             PIC X(10).
  5479             20  FILLER              PIC X.
  5480             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 105
* EL640.cbl
  5481             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5482             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5483             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5484             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5485             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5486             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5487             20  FILLER              PIC X.
  5488             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5489             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5490             20  FILLER              PIC X.
  5491         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5492             20  FILLER              PIC X(11).
  5493             20  GA-ENTRY-DESC       PIC X(30).
  5494             20  FILLER              PIC X(60).
  5495             20  GA-ENTRY-COMMENT    PIC X(30).
  5496             20  FILLER              PIC X.
  5497         16  FILLER.
  5498             20  GA-BENEFIT-CD       PIC XX.
  5499             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5500             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5501             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5502             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5503             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5504             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5505             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5506             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5507
  5508     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5509         16  FILLER                  PIC X.
  5510         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5511         16  FILLER                  PIC X(144).
  5512
  5513     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5514         16  GA-PROCESSOR-CD         PIC X(4).
  5515         16  GA-STATEMENT-TYPE       PIC X.
  5516             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5517         16  GA-NO-OF-COPIES         PIC S9.
  5518         16  GA-CREATION-DT          PIC XX.
  5519         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5520         16  GA-AGENT-TOTALS.
  5521             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5522             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5523             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5524             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5525             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5526             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5527             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5528             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5529             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5530         16  GA-AGENTS-NAME          PIC X(30).
  5531         16  FILLER                  PIC X(81).
  5532     12  FILLER                      PIC XX.
  5533
  5534
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 106
* EL640.cbl
  5536*                            COPY ELCTEXT.
  5537******************************************************************
  5538*                                                                *
  5539*                                                                *
  5540*                            ELCTEXT.                            *
  5541*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5542*                            VMOD=2.008                          *
  5543*                                                                *
  5544*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5545*                                     FORM LETTERS,              *
  5546*                                     CERT FORM DISPLAY.
  5547*                                                                *
  5548*   FILE TYPE = VSAM,KSDS                                        *
  5549*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5550*                                                                *
  5551*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5552*       ALTERNATE INDEX = NONE                                   *
  5553*                                                                *
  5554*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5555*       ALTERNATE INDEX = NONE                                   *
  5556*                                                                *
  5557*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5558*       ALTERNATE INDEX = NONE                                   *
  5559*                                                                *
  5560*   LOG = NO                                                     *
  5561*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5562******************************************************************
  5563 01  TEXT-FILES.
  5564     12  TEXT-FILE-ID                PIC XX.
  5565         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5566         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5567         88  HELP-FILE-TEXT             VALUE 'TH'.
  5568
  5569     12  TX-CONTROL-PRIMARY.
  5570         16  TX-COMPANY-CD           PIC X.
  5571             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5572         16  TX-ACCESS-CD-GENL       PIC X(12).
  5573
  5574         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5575             20  TX-LETTER-NO        PIC X(4).
  5576             20  FILLER              PIC X(8).
  5577
  5578         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5579             20  TX-FORM-NO          PIC X(12).
  5580
  5581         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5582             20  TX-HELP-TYPE        PIC X.
  5583                 88  HELP-FOR-GENERAL   VALUE ' '.
  5584                 88  HELP-BY-SCREEN     VALUE 'S'.
  5585                 88  HELP-BY-ERROR      VALUE 'E'.
  5586             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5587                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5588             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5589                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5590             20  FILLER              PIC X(4).
  5591
  5592         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5593
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 107
* EL640.cbl
  5594     12  TX-PROCESS-CONTROL          PIC XX.
  5595         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5596
  5597     12  TX-TEXT-LINE                PIC X(70).
  5598
  5599     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5600         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5601         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5602         88  TX-VALID-FORM-SQUEEZE-VALUE
  5603                                        VALUE 'Y' ' '.
  5604
  5605     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5606         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5607         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5608         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5609         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5610         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5611         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5612         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5613                                              'K' 'N' ' '
  5614                                              'Z'.
  5615
  5616     12  TX-ARCHIVE-SW               PIC X.
  5617         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5618         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5619         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5620
  5621     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5622     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5623
  5624     12  TX-BSR-CODE                 PIC X.
  5625         88  TX-BSR-LETTER              VALUE 'B'.
  5626         88  TX-NON-BSR-LETTER          VALUE ' '.
  5627
  5628     12  FILLER                      PIC X.
  5629*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 108
* EL640.cbl
  5631
  5632 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5633                          CONTROL-FILE COMPENSATION-MASTER
  5634                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5635                          BILLING-STATEMENT TEXT-FILES.
  5636 0000-DFHEXIT SECTION.
  5637     MOVE '9#                    $   ' TO DFHEIV0.
  5638     MOVE 'EL640' TO DFHEIV1.
  5639     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5640
  5641     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5642     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5643     MOVE EIBTRMID               TO QID-TERM.
  5644     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5645     MOVE '5'                    TO DC-OPTION-CODE.
  5646     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  5647     MOVE DC-BIN-DATE-1          TO WS-CURRENT-DATE.
  5648     MOVE DC-GREG-DATE-1-MDY     TO WS-CURRENT-DATE-MDY.
  5649     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DATE-EDIT.
  5650
  5651     IF EIBCALEN = 0
  5652         GO TO 8800-UNAUTHORIZED-ACCESS.
  5653
  5654     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5655         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  5656
  5657     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5658         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5659             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5660             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5661             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5662             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5663             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5664             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5665             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5666             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5667             MOVE PI-CR-CONTROL-IN-PROGRESS TO W-TRANSFER-CONTROL
  5668             MOVE SPACES          TO PI-CR-CONTROL-IN-PROGRESS
  5669         ELSE
  5670             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5671             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5672             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5673             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5674             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5675             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5676             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5677             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5678
  5679     MOVE LOW-VALUES             TO EL640AI.
  5680
  5681     IF PI-AR-PROCESSING
  5682        MOVE XCTL-635            TO XCTL-PYAJ.
  5683
  5684     IF PI-COMPANY-ID = 'DMD'
  5685        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5686
  5687     IF RETURNED-FROM NOT = SPACES
  5688         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 109
* EL640.cbl
  5689         IF RETURNED-FROM = XCTL-PYAJ AND NOT PI-VOID-BILL
  5690             MOVE ZEROS          TO PI-ADJUSTMENTS
  5691                                    PI-DISBURSED
  5692                                    PI-REMITTED
  5693             GO TO 1100-PYAJ-BILLING-PROCESS
  5694         ELSE
  5695             MOVE -1             TO APFNTERL
  5696             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5697             GO TO 8100-SEND-INITIAL-MAP.
  5698
  5699     IF EIBTRNID NOT = TRANS-ID
  5700         PERFORM 0400-CLEAR-PI  THRU  0499-EXIT
  5701         MOVE EL640A             TO PI-MAP-NAME
  5702         MOVE -1                 TO APFNTERL
  5703         GO TO 8100-SEND-INITIAL-MAP.
  5704
  5705
  5706* EXEC CICS HANDLE CONDITION
  5707*        PGMIDERR  (9600-PGMID-ERROR)
  5708*        ERROR     (9990-ABEND)
  5709*    END-EXEC.
  5710*    MOVE '"$L.                  ! " #00005701' TO DFHEIV0
  5711     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5713     MOVE X'2220233030303035373031' TO DFHEIV0(25:11)
  5714     CALL 'kxdfhei1' USING DFHEIV0
  5715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5716
  5717
  5718     IF EIBAID = DFHCLEAR
  5719         IF PI-MAP-NAME = EL640B
  5720             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5721             MOVE EL640A         TO PI-MAP-NAME
  5722             MOVE -1             TO APFNTERL
  5723             GO TO 8100-SEND-INITIAL-MAP
  5724         ELSE
  5725             GO TO 9400-CLEAR.
  5726
  5727     IF PI-PROCESSOR-ID = 'LGXX'
  5728         GO TO 0200-RECEIVE.
  5729
  5730
  5731* EXEC CICS READQ TS
  5732*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5733*        INTO   (SECURITY-CONTROL)
  5734*        LENGTH (SC-COMM-LENGTH)
  5735*        ITEM   (SC-ITEM)
  5736*    END-EXEC.
  5737*    MOVE '*$II   L              ''   #00005718' TO DFHEIV0
  5738     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5739     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5740     MOVE X'2020233030303035373138' TO DFHEIV0(25:11)
  5741     CALL 'kxdfhei1' USING DFHEIV0,
  5742           PI-SECURITY-TEMP-STORE-ID,
  5743           SECURITY-CONTROL,
  5744           SC-COMM-LENGTH,
  5745           SC-ITEM,
  5746           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 110
* EL640.cbl
  5747           DFHEIV99
  5748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5749
  5750
  5751     MOVE SC-CREDIT-DISPLAY (18)  TO PI-DISPLAY-CAP.
  5752     MOVE SC-CREDIT-UPDATE  (18)  TO PI-MODIFY-CAP.
  5753
  5754     IF NOT DISPLAY-CAP
  5755         MOVE 'READ'          TO SM-READ
  5756         PERFORM 9995-SECURITY-VIOLATION
  5757         MOVE ER-0070         TO  EMI-ERROR
  5758         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5759         GO TO 8100-SEND-INITIAL-MAP.
  5760
  5761 0200-RECEIVE.
  5762     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5763         MOVE ER-0008            TO EMI-ERROR
  5764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5765         IF PI-MAP-NAME = EL640A
  5766             MOVE -1             TO APFNTERL
  5767             GO TO 8200-SEND-DATAONLY
  5768         ELSE
  5769             MOVE -1             TO BPFNTERL
  5770             GO TO 8200-SEND-DATAONLY.
  5771
  5772
  5773* EXEC CICS RECEIVE
  5774*        MAP      (PI-MAP-NAME)
  5775*        MAPSET   (MAPSET-NAME)
  5776*        INTO     (EL640AI)
  5777*    END-EXEC.
  5778     MOVE LENGTH OF
  5779      EL640AI
  5780       TO DFHEIV11
  5781*    MOVE '8"T I  L              ''   #00005746' TO DFHEIV0
  5782     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5783     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5784     MOVE X'2020233030303035373436' TO DFHEIV0(25:11)
  5785     CALL 'kxdfhei1' USING DFHEIV0,
  5786           PI-MAP-NAME,
  5787           EL640AI,
  5788           DFHEIV11,
  5789           MAPSET-NAME,
  5790           DFHEIV99,
  5791           DFHEIV99
  5792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5793
  5794
  5795     IF PI-END-BAL NOT NUMERIC
  5796         MOVE ZEROS              TO PI-END-BAL.
  5797
  5798     IF PI-MAP-NAME = EL640A
  5799         IF APFNTERL > ZERO
  5800             IF EIBAID NOT = DFHENTER
  5801                 MOVE ER-0004    TO EMI-ERROR
  5802                 MOVE AL-UNBOF   TO APFNTERA
  5803                 MOVE -1         TO APFNTERL
  5804                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 111
* EL640.cbl
  5805                 GO TO 8200-SEND-DATAONLY
  5806             ELSE
  5807                 IF APFNTERI NUMERIC AND
  5808                   (APFNTERI > 0 AND < 25)
  5809                     MOVE PF-VALUES (APFNTERI) TO EIBAID
  5810                 ELSE
  5811                     MOVE ER-0029  TO EMI-ERROR
  5812                     MOVE AL-UNBOF TO APFNTERA
  5813                     MOVE -1       TO APFNTERL
  5814                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5815                     GO TO 8200-SEND-DATAONLY
  5816         ELSE
  5817             NEXT SENTENCE
  5818     ELSE
  5819     IF PI-MAP-NAME = EL640B
  5820         IF BPFNTERL > ZERO
  5821             IF EIBAID NOT = DFHENTER
  5822                 MOVE ER-0004    TO EMI-ERROR
  5823                 MOVE AL-UNBOF   TO BPFNTERA
  5824                 MOVE -1         TO BPFNTERL
  5825                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5826                 GO TO 8200-SEND-DATAONLY
  5827             ELSE
  5828                 IF BPFNTERI NUMERIC AND
  5829                   (BPFNTERI > 0 AND < 25)
  5830                     MOVE PF-VALUES (BPFNTERI) TO EIBAID
  5831                 ELSE
  5832                     MOVE ER-0029  TO EMI-ERROR
  5833                     MOVE AL-UNBOF TO BPFNTERA
  5834                     MOVE -1       TO BPFNTERL
  5835                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5836                     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 112
* EL640.cbl
  5838 0300-CHECK-PFKEYS.
  5839     IF EIBAID = DFHPF23
  5840         GO TO 8810-PF23.
  5841
  5842     IF EIBAID = DFHPF24
  5843         GO TO 9200-RETURN-MAIN-MENU.
  5844
  5845     IF EIBAID = DFHPF12
  5846         GO TO 9500-PF12.
  5847
  5848******************************************************************
  5849*       IF CARRIER OR ACCOUNT SECURITY ALLOW ONLY                *
  5850*            BILLING TYPE OPTION ONE OR TWO.                     *
  5851*                        04/27/84                                *
  5852******************************************************************
  5853
  5854     IF PI-NO-CARRIER-SECURITY OR
  5855        PI-NO-ACCOUNT-SECURITY
  5856          GO TO 0305-CHECK-PFKEYS.
  5857
  5858     IF EIBAID = DFHENTER OR DFHPF6
  5859        NEXT SENTENCE
  5860       ELSE
  5861        GO TO 0320-INPUT-ERROR.
  5862
  5863 0305-CHECK-PFKEYS.
  5864     IF EIBAID = DFHPF3
  5865       AND PI-MAP-NAME = EL640A
  5866         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5867         MOVE PI-CARRIER         TO PI-CR-CARRIER
  5868         MOVE PI-GROUPING        TO PI-CR-GROUPING
  5869         MOVE PI-STATE           TO PI-CR-STATE
  5870         MOVE PI-ACCOUNT         TO PI-CR-ACCOUNT
  5871         MOVE XCTL-650           TO PGM-NAME
  5872         GO TO 9300-XCTL.
  5873
  5874     IF EIBAID = DFHPF4
  5875       AND PI-MAP-NAME = EL640A
  5876        NEXT SENTENCE
  5877     ELSE
  5878        GO TO 0320-CONT-PFKEYS.
  5879
  5880     IF PI-CR-FIN-RESP NOT = SPACES
  5881         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5882         MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5883         MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5884         MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5885         MOVE XCTL-652           TO PGM-NAME
  5886         GO TO 9300-XCTL.
  5887
  5888     IF PI-SCR-FIN-RESP = SPACES OR LOW-VALUES
  5889         GO TO 0315-PF4-ERROR.
  5890
  5891     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5892
  5893     MOVE PI-SCR-CARRIER    TO PI-CR-CARRIER.
  5894     MOVE PI-SCR-GROUPING   TO PI-CR-GROUPING.
  5895     MOVE PI-SCR-FIN-RESP   TO PI-CR-FIN-RESP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 113
* EL640.cbl
  5896     MOVE PI-SCR-ACCOUNT    TO PI-CR-ACCOUNT.
  5897     MOVE PI-SCR-TYPE       TO PI-CR-TYPE.
  5898     MOVE 'Y'               TO PI-TRANSFER-SW.
  5899
  5900     IF PI-ZERO-CARRIER  OR
  5901        PI-ZERO-CAR-GROUP
  5902         MOVE ZEROS              TO PI-CR-CARRIER.
  5903
  5904     IF PI-ZERO-GROUPING  OR
  5905        PI-ZERO-CAR-GROUP
  5906         MOVE ZEROS              TO PI-CR-GROUPING.
  5907
  5908     MOVE XCTL-652               TO PGM-NAME.
  5909
  5910     GO TO 9300-XCTL.
  5911
  5912 0315-PF4-ERROR.
  5913
  5914     MOVE ER-2407                TO EMI-ERROR.
  5915     MOVE -1                     TO APFNTERL.
  5916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5917     GO TO 8200-SEND-DATAONLY.
  5918
  5919 0320-CONT-PFKEYS.
  5920     IF EIBAID = DFHPF6
  5921       AND PI-MAP-NAME = EL640A
  5922         MOVE LOW-VALUES         TO EL640AO
  5923         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5924         MOVE XCTL-6401          TO PGM-NAME
  5925         GO TO 9300-XCTL.
  5926
  5927     IF EIBAID = DFHPF7
  5928       AND PI-MAP-NAME = EL640A
  5929         IF PI-CR-FIN-RESP NOT = SPACES
  5930             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5931             MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5932             MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5933             MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5934             MOVE XCTL-PYAJ          TO PGM-NAME
  5935             GO TO 9300-XCTL
  5936         ELSE
  5937             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5938                                       XCTL-633DMD
  5939                 GO TO 9400-CLEAR
  5940             ELSE
  5941                 MOVE ER-2411        TO EMI-ERROR
  5942                 MOVE -1             TO APFNTERL
  5943                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5944                 GO TO 8200-SEND-DATAONLY.
  5945
  5946     IF EIBAID = DFHPF8
  5947       AND PI-MAP-NAME = EL640A
  5948           PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5949           MOVE SPACES         TO PI-CR-CONTROL-IN-PROGRESS
  5950           MOVE XCTL-658       TO PGM-NAME
  5951           GO TO 9300-XCTL.
  5952
  5953     IF EIBAID = DFHPF1
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 114
* EL640.cbl
  5954       AND PI-MAP-NAME = EL640B
  5955         GO TO 7500-PRODUCE-CHECK.
  5956
  5957     IF EIBAID = DFHPF5
  5958       AND PI-AR-PROCESSING
  5959         MOVE ER-3188            TO EMI-ERROR
  5960         MOVE -1                 TO APFNTERL
  5961         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5962         GO TO 8200-SEND-DATAONLY.
  5963
  5964     IF PI-COMPANY-ID = 'DMD'
  5965       IF EIBAID = DFHPF5
  5966         GO TO 0320-INPUT-ERROR.
  5967
  5968     IF EIBAID = DFHPF5
  5969       AND PI-MAP-NAME = EL640A
  5970            MOVE EL640B     TO PI-MAP-NAME
  5971            GO TO 7000-PROCESS-CHECK.
  5972
  5973     IF PI-MAP-NAME = EL640A
  5974         IF EIBAID = DFHENTER OR DFHPF3
  5975             GO TO 0330-EDIT-DATA
  5976         ELSE
  5977             GO TO 0320-INPUT-ERROR
  5978     ELSE
  5979         IF PI-MAP-NAME = EL640B
  5980             IF EIBAID = DFHENTER
  5981
  5982* EXEC CICS BIF DEEDIT
  5983*                    FIELD  (BCHKAMTI)
  5984*                    LENGTH (11)
  5985*                END-EXEC
  5986     MOVE 11
  5987       TO DFHEIV11
  5988*    MOVE '@"L                   #   #00005938' TO DFHEIV0
  5989     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5990     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5991     MOVE X'2020233030303035393338' TO DFHEIV0(25:11)
  5992     CALL 'kxdfhei1' USING DFHEIV0,
  5993           BCHKAMTI,
  5994           DFHEIV11
  5995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5996                 MOVE BCHKAMTI   TO  WORK-CHECK-AMT
  5997                 MOVE 'B'        TO  WS-ENTERED-FROM-MAP
  5998                 GO TO 7000-PROCESS-CHECK.
  5999
  6000 0320-INPUT-ERROR.
  6001     MOVE ER-0029                TO EMI-ERROR.
  6002     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6003
  6004     IF PI-MAP-NAME = EL640A
  6005         MOVE AL-UNBON           TO APFNTERA
  6006         MOVE -1                 TO APFNTERL
  6007     ELSE
  6008         MOVE AL-UNBON           TO BPFNTERA
  6009         MOVE -1                 TO BPFNTERL.
  6010
  6011     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 115
* EL640.cbl
  6012
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 116
* EL640.cbl
  6014 0330-EDIT-DATA.
  6015     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6016
  6017     IF VALID-BILL-TYPE
  6018        IF NOT MODIFY-CAP
  6019           IF ABILTYPI = '1' OR '2'
  6020              NEXT SENTENCE
  6021           ELSE
  6022              MOVE 'UPDATE'         TO SM-READ
  6023              PERFORM 9995-SECURITY-VIOLATION
  6024              MOVE ER-0070          TO EMI-ERROR
  6025              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6026              GO TO 8100-SEND-INITIAL-MAP.
  6027
  6028     MOVE SPACES                 TO PI-BILLING-COUNTS
  6029                                    PI-LIMIT-BILLING-BTCHS.
  6030
  6031******************************************************************
  6032*         SECURITY CHECK FOR CARRIER AND ACCOUNT.                *
  6033*                     04/12/84                                   *
  6034******************************************************************
  6035
  6036     IF PI-CARRIER-SECURITY > SPACES
  6037        IF ACARIERL > ZEROS
  6038            IF PI-CARRIER-SECURITY = ACARIERI
  6039                MOVE AL-UANON    TO ACARIERA
  6040            ELSE
  6041                MOVE -1          TO ACARIERL
  6042                MOVE AL-UABON    TO ACARIERA
  6043                MOVE ER-2370     TO EMI-ERROR
  6044                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6045
  6046 350-ERROR-CHECK.
  6047     IF EMI-ERROR = ZEROS
  6048         NEXT SENTENCE
  6049     ELSE
  6050         GO TO 8200-SEND-DATAONLY.
  6051
  6052     IF AACCTL > ZEROS
  6053         MOVE AL-UANON           TO AACCTA
  6054         MOVE AACCTI             TO PI-SAV-ACCT
  6055                                    PI-CR-ACCOUNT
  6056     ELSE
  6057         MOVE -1                 TO AACCTL
  6058         MOVE AL-UABON           TO AACCTA
  6059         MOVE ER-0197            TO EMI-ERROR
  6060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6061
  6062     IF ACARIERL > ZEROS
  6063         MOVE AL-UANON           TO ACARIERA
  6064         MOVE ACARIERI           TO PI-SAV-CARR
  6065                                    WS-CARRIER
  6066     ELSE
  6067         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  6068             MOVE -1             TO ACARIERL
  6069             MOVE AL-UABON       TO ACARIERA
  6070             MOVE ER-0194        TO EMI-ERROR
  6071             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 117
* EL640.cbl
  6072
  6073     IF AGROUPL > ZEROS
  6074         MOVE AL-UANON           TO AGROUPA
  6075         MOVE AGROUPI            TO PI-SAV-GROUP
  6076                                    WS-COMP
  6077     ELSE
  6078         IF CARR-GROUP-ST-ACCNT-CNTL
  6079             MOVE -1             TO AGROUPL
  6080             MOVE AL-UABON       TO AGROUPA
  6081             MOVE ER-0195        TO EMI-ERROR
  6082             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6083
  6084     IF ASTATEL > ZEROS
  6085         MOVE AL-UANON           TO ASTATEA
  6086         MOVE ASTATEI            TO PI-SAV-STATE
  6087     ELSE
  6088         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  6089             MOVE -1             TO ASTATEL
  6090             MOVE AL-UABON       TO ASTATEA
  6091             MOVE ER-0196        TO EMI-ERROR
  6092             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6093
  6094     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6095
  6096     IF VALID-BILL-TYPE
  6097         MOVE AL-UANON           TO ABILTYPA
  6098         MOVE ABILTYPI           TO PI-BILL-TYPE
  6099     ELSE
  6100         MOVE -1                 TO ABILTYPL
  6101         MOVE ER-2249            TO EMI-ERROR
  6102         MOVE AL-UABON           TO ABILTYPA
  6103         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6104
  6105     IF PI-AR-PROCESSING
  6106        IF PI-PREVIEW
  6107           NEXT SENTENCE
  6108        ELSE
  6109           MOVE -1               TO ABILTYPL
  6110           MOVE ER-3145          TO EMI-ERROR
  6111           MOVE AL-UABON         TO ABILTYPA
  6112           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6113
  6114     IF APRODSWL NOT = ZEROS
  6115         IF PI-PREVIEW
  6116             IF APRODSWI = 'Y' OR 'N'
  6117                 MOVE AL-UANON   TO APRODSWA
  6118             ELSE
  6119                 MOVE -1         TO APRODSWL
  6120                 MOVE ER-2436    TO EMI-ERROR
  6121                 MOVE AL-UABON   TO APRODSWA
  6122                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6123         ELSE
  6124             MOVE -1             TO APRODSWL
  6125             MOVE ER-2434        TO EMI-ERROR
  6126             MOVE AL-UABON       TO APRODSWA
  6127             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6128     ELSE
  6129         IF PI-PREVIEW
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 118
* EL640.cbl
  6130             MOVE -1             TO APRODSWL
  6131             MOVE ER-2435        TO EMI-ERROR
  6132             MOVE AL-UABON       TO APRODSWA
  6133             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6134
  6135     IF ABILERRI = 'Y' OR 'N'
  6136         MOVE ABILERRI           TO PI-BILL-ERRS
  6137         MOVE AL-UANON           TO ABILERRA
  6138     ELSE
  6139         IF NOT PI-VOID-BILL
  6140             MOVE -1             TO ABILERRL
  6141             MOVE ER-2250        TO EMI-ERROR
  6142             MOVE AL-UABON       TO ABILERRA
  6143             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6144
  6145     IF ABTCH1L NOT = ZEROS
  6146         MOVE AL-UANON           TO ABTCH1A
  6147         MOVE 'Y'                TO LIMIT-BILLING-SW
  6148         MOVE ABTCH1I            TO PI-BILLING-BATCHES (1).
  6149
  6150     IF ABTCH2L NOT = ZEROS
  6151         MOVE AL-UANON           TO ABTCH2A
  6152         MOVE 'Y'                TO LIMIT-BILLING-SW
  6153         MOVE ABTCH2I            TO PI-BILLING-BATCHES (2).
  6154
  6155     IF ABTCH3L NOT = ZEROS
  6156         MOVE AL-UANON           TO ABTCH3A
  6157         MOVE 'Y'                TO LIMIT-BILLING-SW
  6158         MOVE ABTCH3I            TO PI-BILLING-BATCHES (3).
  6159
  6160     IF EMI-ERROR = ZEROS
  6161         GO TO 1000-BILLING-PROCESS.
  6162
  6163     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 119
* EL640.cbl
  6165 0400-CLEAR-PI.
  6166     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  6167
  6168     MOVE ZEROS                  TO PI-BAL-FRWD-GA  PI-BAL-FRWD
  6169                                    PI-PREMIUM      PI-REMITTED
  6170                                    PI-TOT-ISS-COMP
  6171                                    PI-TOT-CAN-COMP
  6172                                    PI-ADJUSTMENTS  PI-DISBURSED
  6173                                    PI-END-BAL      PI-LF-ISS-COMP
  6174                                    PI-AH-ISS-COMP  PI-LF-CAN-COMP
  6175                                    PI-AH-CAN-COMP.
  6176
  6177     MOVE SPACES                 TO PI-BATCH (1)
  6178                                    PI-BATCH (2)
  6179                                    PI-BATCH (3)
  6180                                    PI-BATCH (4)
  6181                                    PI-BATCH (5)
  6182                                    PI-BATCH (6).
  6183
  6184     MOVE SPACES                 TO PI-BILLING-BATCHES (1)
  6185                                    PI-BILLING-BATCHES (2)
  6186                                    PI-BILLING-BATCHES (3).
  6187
  6188     MOVE ZEROS                  TO PI-BILLED (1) PI-PREV (1)
  6189                                    PI-NOBILL (1)
  6190                                    PI-PREM (1)   PI-COMM (1)
  6191                                    PI-NON-PREM (1)
  6192                                    PI-NON-COMM (1)
  6193                                    PI-BILLED (2) PI-PREV (2)
  6194                                    PI-NOBILL (2)
  6195                                    PI-PREM (2)   PI-COMM (2)
  6196                                    PI-NON-PREM (2)
  6197                                    PI-NON-COMM (2)
  6198                                    PI-BILLED (3) PI-PREV (3)
  6199                                    PI-NOBILL (3)
  6200                                    PI-PREM (3)   PI-COMM (3)
  6201                                    PI-NON-PREM (3)
  6202                                    PI-NON-COMM (3)
  6203                                    PI-BILLED (4) PI-PREV (4)
  6204                                    PI-NOBILL (4)
  6205                                    PI-PREM (4)   PI-COMM (4)
  6206                                    PI-NON-PREM (4)
  6207                                    PI-NON-COMM (4)
  6208                                    PI-BILLED (5) PI-PREV (5)
  6209                                    PI-NOBILL (5)
  6210                                    PI-PREM (5)   PI-COMM (5)
  6211                                    PI-NON-PREM (5)
  6212                                    PI-NON-COMM (5)
  6213                                    PI-BILLED (6) PI-PREV (6)
  6214                                    PI-NOBILL (6)
  6215                                    PI-PREM (6)   PI-COMM (6)
  6216                                    PI-NON-PREM (6)
  6217                                    PI-NON-COMM (6).
  6218
  6219 0499-EXIT.
  6220      EXIT.
  6221
  6222 0500-CREATE-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 120
* EL640.cbl
  6223
  6224     IF PI-BAL-FRWD NOT NUMERIC
  6225         MOVE ZEROS              TO PI-BAL-FRWD
  6226                                    PI-PREMIUM
  6227                                    PI-REMITTED
  6228                                    PI-TOT-ISS-COMP
  6229                                    PI-TOT-CAN-COMP
  6230                                    PI-ADJUSTMENTS
  6231                                    PI-DISBURSED
  6232                                    PI-END-BAL.
  6233
  6234
  6235* EXEC CICS WRITEQ TS
  6236*        QUEUE  (QID)
  6237*        FROM   (PROGRAM-INTERFACE-BLOCK)
  6238*        LENGTH (PI-COMM-LENGTH)
  6239*    END-EXEC.
  6240*    MOVE '*"                    ''   #00006180' TO DFHEIV0
  6241     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  6242     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6243     MOVE X'2020233030303036313830' TO DFHEIV0(25:11)
  6244     CALL 'kxdfhei1' USING DFHEIV0,
  6245           QID,
  6246           PROGRAM-INTERFACE-BLOCK,
  6247           PI-COMM-LENGTH,
  6248           DFHEIV99,
  6249           DFHEIV99,
  6250           DFHEIV99
  6251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6252
  6253
  6254 0590-EXIT.
  6255      EXIT.
  6256
  6257 0600-RECOVER-TEMP-STORAGE.
  6258
  6259* EXEC CICS READQ TS
  6260*        QUEUE  (QID)
  6261*        INTO   (PROGRAM-INTERFACE-BLOCK)
  6262*        LENGTH (PI-COMM-LENGTH)
  6263*    END-EXEC.
  6264*    MOVE '*$I    L              ''   #00006190' TO DFHEIV0
  6265     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6267     MOVE X'2020233030303036313930' TO DFHEIV0(25:11)
  6268     CALL 'kxdfhei1' USING DFHEIV0,
  6269           QID,
  6270           PROGRAM-INTERFACE-BLOCK,
  6271           PI-COMM-LENGTH,
  6272           DFHEIV99,
  6273           DFHEIV99,
  6274           DFHEIV99
  6275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6276
  6277
  6278     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  6279
  6280     MOVE PI-CR-CARRIER    TO PI-SCR-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 121
* EL640.cbl
  6281     MOVE PI-CR-GROUPING   TO PI-SCR-GROUPING.
  6282     MOVE PI-CR-FIN-RESP   TO PI-SCR-FIN-RESP.
  6283     MOVE PI-CR-ACCOUNT    TO PI-SCR-ACCOUNT.
  6284     MOVE PI-CR-TYPE       TO PI-SCR-TYPE.
  6285
  6286     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6287
  6288 0690-EXIT.
  6289      EXIT.
  6290
  6291 0800-DELETE-TS.
  6292
  6293* EXEC CICS HANDLE CONDITION
  6294*        QIDERR (0890-EXIT)
  6295*    END-EXEC.
  6296*    MOVE '"$N                   ! # #00006210' TO DFHEIV0
  6297     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6299     MOVE X'2320233030303036323130' TO DFHEIV0(25:11)
  6300     CALL 'kxdfhei1' USING DFHEIV0
  6301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6302
  6303
  6304
  6305* EXEC CICS DELETEQ TS
  6306*        QUEUE  (QID)
  6307*    END-EXEC.
  6308*    MOVE '*&                    #   #00006214' TO DFHEIV0
  6309     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6311     MOVE X'2020233030303036323134' TO DFHEIV0(25:11)
  6312     CALL 'kxdfhei1' USING DFHEIV0,
  6313           QID,
  6314           DFHEIV99
  6315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6316
  6317
  6318 0890-EXIT.
  6319      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 122
* EL640.cbl
  6321 1000-BILLING-PROCESS.
  6322*                *******************************************
  6323*                *  THIS SECTION PROCESSES THE PENDING     *
  6324*                *  BUSINESS AND PAYMNTS/ADJMNTS FILES.    *
  6325*                *  THE PREMIUM AMT WRITTEN IS EXTRACTED   *
  6326*                *  FROM THE PENDING BUSINESS FILE.        *
  6327*                *******************************************
  6328
  6329     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD
  6330                                    ERPNDB-CO-CD-A1
  6331                                    ERCOMP-COMP-CD
  6332                                    ERPYAJ-COMP-CD
  6333                                    ERACCT-P-CO-CD
  6334                                    ERACCT-A-CO-CD.
  6335
  6336     MOVE WS-CURRENT-DATE-EDIT   TO BI-HD-RUN-DT.
  6337
  6338     MOVE ZEROS                  TO PI-BAL-FRWD
  6339                                    PI-PREMIUM
  6340                                    PI-REMITTED
  6341                                    PI-TOT-ISS-COMP
  6342                                    PI-TOT-CAN-COMP
  6343                                    PI-ADJUSTMENTS
  6344                                    PI-DISBURSED
  6345                                    PI-END-BAL.
  6346
  6347     IF PI-VOID-BILL
  6348         GO TO 2000-VOID-BILLING.
  6349
  6350     MOVE SPACES                 TO ELCNTL-KEY.
  6351     MOVE '1'                    TO ELCNTL-REC-TYPE.
  6352     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  6353
  6354     IF EMI-ERROR NOT = ZEROS
  6355         GO TO 8200-SEND-DATAONLY.
  6356
  6357     IF CF-ACCOUNT-MSTR-MAINT-DT      = LOW-VALUES  OR
  6358        CF-COMPENSATION-MSTR-MAINT-DT = LOW-VALUES
  6359         MOVE ER-2571            TO EMI-ERROR
  6360         MOVE -1                 TO APFNTERL
  6361         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6362         GO TO 8200-SEND-DATAONLY.
  6363
  6364     IF CF-FORMS-PRINTER-ID = SPACES
  6365        IF ABILTYPI = '3' OR '4'
  6366          MOVE 2590               TO EMI-ERROR
  6367          MOVE -1                 TO ABILTYPL
  6368          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6369          GO TO 8200-SEND-DATAONLY.
  6370
  6371     MOVE CF-CL-MAIL-TO-NAME     TO BI-HD-CO.
  6372     MOVE CF-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  6373     MOVE SPACE                  TO DC-OPTION-CODE.
  6374     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6375     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  6376     MOVE DC-GREG-DATE-1-ALPHA   TO BI-HD-BILL-DT.
  6377     MOVE SPACE                  TO PI-DATA-BILLED-SW.
  6378
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 123
* EL640.cbl
  6379     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  6380
  6381     IF PNDB-EOF
  6382         GO TO 1100-PYAJ-BILLING-PROCESS.
  6383
  6384 1010-PNDB-BILLING-PROCESS-LOOP.
  6385     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  6386
  6387     IF PNDB-EOF
  6388         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6389         GO TO 1100-PYAJ-BILLING-PROCESS.
  6390
  6391     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  6392        PB-CARRIER       = PI-SAV-CARR    AND
  6393        PB-GROUPING      = PI-SAV-GROUP   AND
  6394        PB-STATE         = PI-SAV-STATE   AND
  6395        PB-ACCOUNT       = PI-SAV-ACCT
  6396         NEXT SENTENCE
  6397     ELSE
  6398         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6399         GO TO 1100-PYAJ-BILLING-PROCESS.
  6400
  6401     IF (PB-ISSUE) AND
  6402        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6403         PB-I-POLICY-IS-MONTHLY OR
  6404         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6405         PB-I-UNDERWRITE-POLICY)
  6406          GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6407     ELSE
  6408        IF (PB-CANCELLATION)
  6409           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6410             OR  PB-CI-AH-POLICY-IS-REISSUE
  6411             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6412             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6413             OR  PB-CI-LF-POLICY-IS-DECLINED
  6414             OR  PB-CI-AH-POLICY-IS-VOID
  6415             OR  PB-CI-LF-REIN-ONLY
  6416             OR  PB-CI-AH-REIN-ONLY)
  6417             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6418
  6419     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6420         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6421
  6422     IF PB-RECORD-ON-HOLD OR
  6423        PB-RECORD-RETURNED
  6424         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6425         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6426
  6427     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6428         IF PB-ENTRY-REVERSED
  6429             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6430         ELSE
  6431             IF PI-REBILLING
  6432                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6433                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6434
  6435     IF PB-BILLED-DT = LOW-VALUES
  6436       OR PI-TOT-REBILL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 124
* EL640.cbl
  6437       OR PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6438         NEXT SENTENCE
  6439     ELSE
  6440         IF NOT PB-BATCH-TRAILER
  6441             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6442             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6443         ELSE
  6444             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6445
  6446     IF LIMIT-BILLING
  6447         IF PB-ENTRY-BATCH = ABTCH1I OR
  6448                             ABTCH2I OR
  6449                             ABTCH3I
  6450             NEXT SENTENCE
  6451         ELSE
  6452             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6453
  6454     IF PB-FATAL-ERRORS  OR
  6455        PB-UNFORCED-ERRORS
  6456         IF ABILERRI = 'N'
  6457             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6458             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6459             MOVE ER-2570        TO EMI-ERROR
  6460             MOVE -1             TO ABILERRL
  6461             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6462             SET EMI-INDX TO 1
  6463             IF EMI-ERROR-NUMBER (EMI-INDX) = ER-2570
  6464                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6465                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6466                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6467                 GO TO 8200-SEND-DATAONLY
  6468             ELSE
  6469                 SET EMI-INDX    TO 2
  6470                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6471                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6472                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6473                 GO TO 8200-SEND-DATAONLY
  6474         ELSE
  6475             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6476             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6477
  6478     IF PB-BATCH-TRAILER
  6479         IF PI-UPDATE-FILES
  6480             PERFORM 1050-BILL-BATCH-TRAILER-CHK THRU 1059-EXIT
  6481             IF BILL-BATCH-TRAILER
  6482                 MOVE SPACE           TO BILL-BATCH-TRAILER-SW
  6483                 MOVE WS-CURRENT-DATE TO PB-BILLED-DT
  6484                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6485                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6486             ELSE
  6487                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6488         ELSE
  6489             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6490
  6491     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6492
  6493     PERFORM 1300-CHECK-OVERRIDE-PREM THRU 1399-EXIT.
  6494
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 125
* EL640.cbl
  6495     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  6496         MOVE SPACE              TO WS-PROCESS-SW
  6497         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  6498         PERFORM 4300-READ-ACCOUNT-MASTER  THRU 4390-EXIT
  6499         PERFORM 1020-CHK-IF-AGENT-IS-SAME THRU 1029-EXIT
  6500         IF EMI-ERROR NOT = ZEROS
  6501             IF PI-UPDATE-FILES
  6502               OR (PI-PREVIEW AND APRODSWI = 'Y')
  6503                 PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6504                 IF EMI-ERROR NOT = '2403'
  6505                     PERFORM 3940-BILL-GENERIC-DELETE
  6506                             THRU 3940-EXIT
  6507                     GO TO 8200-SEND-DATAONLY
  6508                 ELSE
  6509                     GO TO 8200-SEND-DATAONLY
  6510             ELSE
  6511                 GO TO 8200-SEND-DATAONLY.
  6512
  6513     PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT.
  6514
  6515     IF DO-NOT-BILL-THIS-ACCT
  6516         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6517
  6518     PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  6519
  6520     IF EMI-ERROR NOT = ZEROS
  6521         IF PI-UPDATE-FILES
  6522           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6523             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6524             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6525             GO TO 8200-SEND-DATAONLY
  6526         ELSE
  6527             GO TO 8200-SEND-DATAONLY.
  6528
  6529     IF PI-UPDATE-FILES
  6530       OR (PI-PREVIEW AND APRODSWI = 'Y')
  6531         MOVE 'BD'               TO BILLING-DETAIL-TYPE
  6532         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6533
  6534     IF PI-BILL OR PI-REBILLING
  6535         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6536
  6537     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 126
* EL640.cbl
  6539 1020-CHK-IF-AGENT-IS-SAME.
  6540     MOVE +1 TO ACCOM-SUB.
  6541
  6542 1025-FIND-AGENT-LOOP.
  6543     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6544         NEXT SENTENCE
  6545     ELSE
  6546         ADD +1 TO ACCOM-SUB
  6547         IF ACCOM-SUB > 10
  6548             MOVE -1             TO AACCTL
  6549             MOVE ER-2404        TO EMI-ERROR
  6550             MOVE AL-UABON       TO AACCTA
  6551             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6552         ELSE
  6553             GO TO 1025-FIND-AGENT-LOOP.
  6554
  6555     IF AM-AGT (ACCOM-SUB) NOT = PI-SAV-ACCT
  6556         IF FIRST-TIME
  6557             MOVE -1             TO AACCTL
  6558             MOVE ER-2405        TO EMI-ERROR
  6559             MOVE AL-UABON       TO AACCTA
  6560             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6561             GO TO 1029-EXIT
  6562         ELSE
  6563             MOVE 'Y'            TO WS-PROCESS-SW
  6564             GO TO 1029-EXIT.
  6565
  6566     IF FIRST-TIME
  6567         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6568                                      PI-CR-FIN-RESP
  6569         MOVE 'A'                  TO PI-CR-TYPE
  6570         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6571         MOVE SPACE                TO FIRST-TIME-SW
  6572         IF EMI-ERROR NOT = ZEROS
  6573             GO TO 1029-EXIT.
  6574
  6575     IF AM-AGT (AM-REMIT-TO) = PI-SAV-REMIT-TO
  6576         NEXT SENTENCE
  6577     ELSE
  6578         MOVE 'Y'                TO WS-PROCESS-SW
  6579         MOVE ER-2408            TO EMI-ERROR
  6580         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6581         PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6582         PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT
  6583         MOVE -1                 TO AACCTL
  6584         GO TO 8200-SEND-DATAONLY.
  6585
  6586     MOVE AM-NAME                TO PI-ACCT-NAME.
  6587
  6588     IF PI-BILL OR PI-REBILLING
  6589         PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  6590
  6591 1029-EXIT.
  6592     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 127
* EL640.cbl
  6594 1030-COMPUTE-COMMISSION-TOTALS.
  6595     IF PB-CANCELLATION
  6596         GO TO 1035-COMPUTE-CANCEL-COMM.
  6597
  6598     MOVE SPACES                 TO WS-AH-CATEGORY
  6599     IF (PI-COMPANY-ID = 'DCC')
  6600        AND (NOT PB-INVALID-AH)
  6601        MOVE SPACES              TO ELCNTL-KEY
  6602        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6603        MOVE '5'                 TO ELCNTL-REC-TYPE
  6604        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6605                                    CLAS-LOOK
  6606        MOVE +0                  TO ELCNTL-SEQ-NO
  6607        PERFORM 6130-FIND-BENEFIT-CD
  6608                                 THRU 6140-EXIT
  6609     END-IF
  6610     if (pi-company-id = 'DCC')
  6611        and (ws-ah-category = 'G' or 'L')
  6612        compute pi-premium = ws-i-ah-premium-amt + pi-premium
  6613        move zeros               to ws-i-lf-premium-amt
  6614     else
  6615        COMPUTE PI-PREMIUM = (WS-I-LF-PREMIUM-AMT +
  6616           WS-I-AH-PREMIUM-AMT) + PI-PREMIUM
  6617     end-if
  6618     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6619         (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION).
  6620     IF WS-AH-CATEGORY = 'G' OR 'L'
  6621        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6622           WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6623              - PB-I-ADDL-CLP
  6624     ELSE
  6625        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6626            (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6627     END-IF
  6628     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6629                               PI-LF-ISS-COMP +
  6630                               PI-AH-ISS-COMP.
  6631     GO TO 1039-EXIT.
  6632
  6633 1035-COMPUTE-CANCEL-COMM.
  6634
  6635     MOVE SPACES                 TO WS-AH-CATEGORY
  6636     IF (PI-COMPANY-ID = 'DCC')
  6637        AND (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6638        MOVE SPACES              TO ELCNTL-KEY
  6639        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6640        MOVE '5'                 TO ELCNTL-REC-TYPE
  6641        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6642                                    CLAS-LOOK
  6643        MOVE +0                  TO ELCNTL-SEQ-NO
  6644        PERFORM 6130-FIND-BENEFIT-CD
  6645                                 THRU 6140-EXIT
  6646     END-IF
  6647     IF WS-AH-CATEGORY = 'G' OR 'L'
  6648        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6649          WS-C-AH-CANCEL-AMT
  6650     ELSE
  6651        COMPUTE PI-PREMIUM = PI-PREMIUM -
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 128
* EL640.cbl
  6652         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6653     END-IF
  6654
  6655     COMPUTE PI-LF-CAN-COMP   ROUNDED =
  6656         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION) * -1.
  6657     IF WS-AH-CATEGORY = 'G' OR 'L'
  6658        IF AM-DCC-PRODUCT-CODE = 'DDF'
  6659           COMPUTE CNC-FACT = PB-C-AH-RFND-CLP /
  6660              pb-ci-lf-alt-premium-amt
  6661        else
  6662           COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6663              PB-CI-AH-PREMIUM-AMT
  6664        end-if
  6665        COMPUTE PI-AH-CAN-COMP ROUNDED =
  6666           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6667           PB-CI-LF-ALT-PREMIUM-AMT - PB-CI-ADDL-CLP))
  6668     ELSE
  6669        COMPUTE PI-AH-CAN-COMP   ROUNDED =
  6670         (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION) * -1
  6671     END-IF
  6672     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6673     MOVE PB-C-LF-CANCEL-DT        TO  DC-BIN-DATE-2.
  6674     MOVE '1'                      TO  DC-OPTION-CODE.
  6675     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6676     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-LF.
  6677
  6678     IF DC-ODD-DAYS-OVER > ZEROS
  6679         ADD +1 TO MONTHS-DIFF-LF.
  6680
  6681     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6682     MOVE PB-C-AH-CANCEL-DT        TO  DC-BIN-DATE-2.
  6683     MOVE '1'                      TO  DC-OPTION-CODE.
  6684     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6685     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-AH.
  6686
  6687     IF DC-ODD-DAYS-OVER > ZEROS
  6688         ADD +1 TO MONTHS-DIFF-AH.
  6689
  6690     PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT.
  6691
  6692     MOVE  +0                       TO  SUB.
  6693     MOVE  'Y'                      TO  WS-CHARGEBACK-LF-SW
  6694                                        WS-CHARGEBACK-AH-SW.
  6695
  6696     MOVE ZEROS                     TO  WS-LF-CAN-COMP
  6697                                        WS-AH-CAN-COMP.
  6698 1035-ACCT-COMM-LOOP.
  6699
  6700     ADD +1 TO SUB.
  6701
  6702     IF SUB > +10
  6703         GO TO 1035-COMPUTE-TOT-CAN.
  6704
  6705     IF AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'F' AND 'S'
  6706         GO TO 1035-ACCT-COMM-LOOP.
  6707
  6708     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6709         MOVE  ZEROS            TO  AM-COMM-CHARGEBACK (SUB).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 129
* EL640.cbl
  6710
  6711     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6712         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6713         GO TO 1035-CHECK-AH-CHARGEBACK.
  6714
  6715     IF (MONTHS-DIFF-LF > AM-COMM-CHARGEBACK (SUB))
  6716                            AND
  6717        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6718         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6719     ELSE
  6720         COMPUTE WS-LF-CAN-COMP   ROUNDED =  WS-LF-CAN-COMP +
  6721            (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION).
  6722
  6723 1035-CHECK-AH-CHARGEBACK.
  6724
  6725     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6726         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6727         GO TO  1035-ACCT-COMM-LOOP.
  6728
  6729     IF (MONTHS-DIFF-AH > AM-COMM-CHARGEBACK (SUB))
  6730                            AND
  6731        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6732         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6733     ELSE
  6734        IF WS-AH-CATEGORY = 'G' OR 'L'
  6735           MOVE PI-AH-CAN-COMP   TO WS-AH-CAN-COMP
  6736        ELSE
  6737         COMPUTE WS-AH-CAN-COMP ROUNDED = WS-AH-CAN-COMP +
  6738            (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6739        END-IF
  6740     END-IF
  6741
  6742     GO TO 1035-ACCT-COMM-LOOP.
  6743
  6744 1035-COMPUTE-TOT-CAN.
  6745
  6746     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6747                               WS-LF-CAN-COMP +
  6748                               WS-AH-CAN-COMP.
  6749
  6750 1039-EXIT.
  6751     EXIT.
  6752
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 130
* EL640.cbl
  6754 1040-UPDATE-BILLING-STATISTICS.
  6755     SET PINDX                   TO 1.
  6756
  6757 1041-SEARCH-LOOP.
  6758     IF PI-NON-PREM (PINDX) NOT NUMERIC
  6759        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  6760     IF WS-NON-PREM  NOT NUMERIC
  6761        MOVE ZEROS               TO WS-NON-PREM.
  6762     IF PI-NON-COMM (PINDX) NOT NUMERIC
  6763        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  6764     IF WS-NON-COMM  NOT NUMERIC
  6765        MOVE ZEROS               TO WS-NON-COMM.
  6766
  6767     IF PI-BATCH (PINDX) NOT = SPACES
  6768         GO TO 1042-CHECK-FOR-MATCH.
  6769
  6770     MOVE PB-ENTRY-BATCH         TO PI-BATCH (PINDX).
  6771
  6772     IF PI-COMPANY-ID = 'DMD'
  6773         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6774
  6775     IF DO-NOT-BILL-THIS-ACCT OR
  6776        PB-FATAL-ERRORS       OR
  6777        PB-UNFORCED-ERRORS    OR
  6778        PB-RECORD-ON-HOLD     OR
  6779        PB-RECORD-RETURNED    OR
  6780        PI-VOID-BILL
  6781         MOVE +1                 TO PI-NOBILL (PINDX)
  6782         MOVE ZEROS              TO PI-BILLED (PINDX)
  6783                                    PI-PREV   (PINDX)
  6784     ELSE
  6785         IF PB-BILLED-DT = LOW-VALUES
  6786           OR PI-TOT-REBILL
  6787             MOVE +1             TO PI-BILLED (PINDX)
  6788             MOVE ZEROS          TO PI-NOBILL (PINDX)
  6789                                    PI-PREV   (PINDX)
  6790         ELSE
  6791             MOVE +1             TO PI-PREV   (PINDX)
  6792             MOVE ZEROS          TO PI-BILLED (PINDX)
  6793                                    PI-NOBILL (PINDX).
  6794
  6795     GO TO 1049-EXIT.
  6796
  6797 1042-CHECK-FOR-MATCH.
  6798     IF PI-BATCH (PINDX) = PB-ENTRY-BATCH
  6799         NEXT SENTENCE
  6800     ELSE
  6801         GO TO 1043-SET-INDEX-UP.
  6802
  6803     IF PI-COMPANY-ID = 'DMD'
  6804         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6805
  6806     IF DO-NOT-BILL-THIS-ACCT OR
  6807        PB-FATAL-ERRORS       OR
  6808        PB-UNFORCED-ERRORS    OR
  6809        PB-RECORD-ON-HOLD     OR
  6810        PB-RECORD-RETURNED    OR
  6811        PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 131
* EL640.cbl
  6812         ADD +1 TO PI-NOBILL (PINDX)
  6813     ELSE
  6814         IF PB-BILLED-DT = LOW-VALUES
  6815           OR PI-TOT-REBILL
  6816             ADD +1          TO PI-BILLED (PINDX)
  6817         ELSE
  6818             ADD +1          TO PI-PREV   (PINDX).
  6819
  6820     GO TO 1049-EXIT.
  6821
  6822 1043-SET-INDEX-UP.
  6823     SET PINDX UP BY 1.
  6824
  6825     IF PINDX > +6
  6826         MOVE 'Y'                TO BATCHES-PROCESSED-SW
  6827         GO TO 1049-EXIT
  6828     ELSE
  6829         GO TO 1041-SEARCH-LOOP.
  6830
  6831 1049-EXIT.
  6832     EXIT.
  6833
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 132
* EL640.cbl
  6835 1050-BILL-BATCH-TRAILER-CHK.
  6836     SET PINDX                   TO 1.
  6837
  6838 1052-LOOP.
  6839     IF PI-BATCH (PINDX) = SPACES
  6840         GO TO 1059-EXIT.
  6841
  6842     IF PB-ENTRY-BATCH = PI-BATCH (PINDX)
  6843       AND PI-BILLED (PINDX) NOT = ZEROS
  6844         MOVE 'Y'                TO BILL-BATCH-TRAILER-SW
  6845         GO TO 1059-EXIT.
  6846
  6847     SET PINDX UP BY 1.
  6848     IF PINDX NOT > 6
  6849         GO TO 1052-LOOP.
  6850
  6851 1059-EXIT.
  6852     EXIT.
  6853
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 133
* EL640.cbl
  6855 1060-DMD-ERROR-ROUTINE.
  6856     IF PB-FATAL-ERRORS OR PB-UNFORCED-ERRORS
  6857        IF ABILERRI = 'Y'
  6858           IF PB-ISSUE
  6859              COMPUTE WS-NON-PREM = PB-I-LF-PREMIUM-AMT
  6860                 + PB-I-LF-ALT-PREMIUM-AMT
  6861                 + PB-I-AH-PREMIUM-AMT
  6862              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6863              COMPUTE WS-NON-COMM ROUNDED =
  6864              ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
  6865                                    * PB-I-LIFE-COMMISSION)
  6866                                    +
  6867               (PB-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6868              ADD WS-NON-COMM TO PI-NON-COMM (PINDX)
  6869           ELSE
  6870           IF PB-CANCELLATION
  6871              COMPUTE WS-NON-PREM =
  6872              (PB-C-LF-CANCEL-AMT +  PB-C-AH-CANCEL-AMT) * -1
  6873              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6874              COMPUTE WS-NON-COMM ROUNDED =
  6875              ((PB-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6876                                   +
  6877               (PB-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION))
  6878                                   * -1
  6879              ADD WS-NON-COMM TO PI-NON-COMM (PINDX).
  6880
  6881 1060-EXIT.
  6882     EXIT.
  6883
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 134
* EL640.cbl
  6885 1100-PYAJ-BILLING-PROCESS.
  6886*                *******************************************
  6887*                *  PROCESS THE PAYMENTS/ADJUSTMENTS FILE    *
  6888*                *******************************************
  6889
  6890     IF LIMIT-BILLING AND NOT PI-DATA-BILLED
  6891         MOVE ER-2443            TO EMI-ERROR
  6892         MOVE -1                 TO ABTCH1L
  6893         MOVE AL-UABON           TO ABTCH1A
  6894         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6895         GO TO 8200-SEND-DATAONLY.
  6896
  6897     IF NOT PI-DATA-BILLED
  6898         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  6899         IF EMI-ERROR = ZEROS
  6900             MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6901                                          PI-CR-FIN-RESP
  6902             MOVE AM-REMIT-TO            TO ACCOM-SUB
  6903             MOVE 'A'                    TO PI-CR-TYPE
  6904             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6905             IF EMI-ERROR NOT = ZEROS
  6906                 GO TO 8200-SEND-DATAONLY
  6907             ELSE
  6908                 NEXT SENTENCE
  6909         ELSE
  6910             GO TO 8200-SEND-DATAONLY.
  6911
  6912 1105-PYAJ-BILLING-STARTBR-LOOP.
  6913     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  6914
  6915     IF PYAJ-EOF
  6916         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6917
  6918 1110-PYAJ-BILLING-READ-LOOP.
  6919     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  6920
  6921     IF PYAJ-EOF
  6922         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6923
  6924     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  6925        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  6926        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  6927        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  6928        PY-ACCOUNT    = PI-SAV-ACCT
  6929         NEXT SENTENCE
  6930     ELSE
  6931         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6932
  6933     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6934         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6935
  6936     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6937                         OR 'Z'
  6938         NEXT SENTENCE
  6939     ELSE
  6940         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6941
  6942     IF PY-VOID-SW NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 135
* EL640.cbl
  6943         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6944
  6945     IF PI-AR-PROCESSING
  6946        IF PY-AR-DATE = LOW-VALUES
  6947           OR PI-TOT-REBILL
  6948           OR RETURNED-FROM = XCTL-PYAJ
  6949           NEXT SENTENCE
  6950        ELSE
  6951           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6952     ELSE
  6953        IF (PY-BILLED-DATE = LOW-VALUES AND
  6954            PY-AR-DATE = LOW-VALUES)
  6955           OR PI-TOT-REBILL
  6956           OR RETURNED-FROM = XCTL-PYAJ
  6957           NEXT SENTENCE
  6958        ELSE
  6959           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6960
  6961     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6962
  6963     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6964         PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6965         PY-ADD-TO-BALANCE
  6966         ADD PY-ENTRY-AMT  TO  PI-REMITTED
  6967     ELSE
  6968         IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  6969            AND PY-BILLING-CHECK
  6970             ADD PY-ENTRY-AMT TO PI-DISBURSED
  6971         ELSE
  6972             ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS.
  6973
  6974     IF RETURNED-FROM = SPACES
  6975         IF PI-UPDATE-FILES
  6976           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6977             MOVE 'BP'           TO BILLING-DETAIL-TYPE
  6978             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6979
  6980     IF RETURNED-FROM = SPACES
  6981       AND (PI-BILL OR PI-REBILLING)
  6982         PERFORM 4800-PYAJ-END-BROWSE
  6983         PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT
  6984         ADD +1 TO ERPYAJ-FILE-SEQ-NO
  6985         GO TO 1105-PYAJ-BILLING-STARTBR-LOOP.
  6986
  6987     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6988
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 136
* EL640.cbl
  6990 1200-PYAJ-BILLING-COMPLETE.
  6991     IF PI-DATA-BILLED
  6992       IF RETURNED-FROM = SPACES
  6993         IF PI-UPDATE-FILES
  6994            OR (PI-PREVIEW AND APRODSWI = 'Y')
  6995               MOVE 'TS'           TO BILLING-DETAIL-TYPE
  6996               PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6997
  6998     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
  6999
  7000     GO TO 8100-SEND-INITIAL-MAP.
  7001
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 137
* EL640.cbl
  7003 1300-CHECK-OVERRIDE-PREM.
  7004     IF PB-CANCELLATION
  7005        IF PB-CI-CANCEL-FEE NOT NUMERIC
  7006           MOVE ZEROS  TO  PB-CI-CANCEL-FEE
  7007        END-IF
  7008     END-IF
  7009
  7010     MOVE ZEROS                  TO WS-I-LF-PREMIUM-AMT
  7011                                    WS-I-LF-BENEFIT-AMT
  7012     IF PB-OVERRIDE-LIFE  OR
  7013        PB-OVERRIDE-BOTH
  7014         GO TO 1310-LIFE-OVERRIDE.
  7015
  7016     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7017         IF PB-ISSUE
  7018           IF NOT PB-INVALID-LIFE
  7019            COMPUTE  WS-I-LF-PREMIUM-AMT =
  7020                    (PB-I-LF-PREMIUM-AMT +
  7021                     PB-I-LF-ALT-PREMIUM-AMT) * -1
  7022            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7023                    (PB-I-LF-BENEFIT-AMT +
  7024                     PB-I-LF-ALT-BENEFIT-AMT) * -1
  7025           END-IF
  7026         ELSE
  7027             MULTIPLY PB-C-LF-CANCEL-AMT BY -1
  7028                            GIVING WS-C-LF-CANCEL-AMT
  7029             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7030                            GIVING WS-CI-LIFE-BENEFIT
  7031         END-IF
  7032     ELSE
  7033         IF PB-ISSUE
  7034           IF NOT PB-INVALID-LIFE
  7035            ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
  7036                GIVING WS-I-LF-PREMIUM-AMT
  7037            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7038                     PB-I-LF-BENEFIT-AMT +
  7039                     PB-I-LF-ALT-BENEFIT-AMT
  7040           END-IF
  7041         ELSE
  7042            MOVE PB-C-LF-CANCEL-AMT   TO WS-C-LF-CANCEL-AMT
  7043            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7044         END-IF
  7045     END-IF
  7046
  7047     GO TO 1320-CHECK-AH
  7048
  7049     .
  7050 1310-LIFE-OVERRIDE.
  7051     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7052         IF PB-ISSUE
  7053           IF NOT PB-INVALID-LIFE
  7054            COMPUTE WS-I-LF-PREMIUM-AMT =
  7055                   (PB-I-LF-PREM-CALC +
  7056                      PB-I-LF-ALT-PREM-CALC) * -1
  7057            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7058                     (PB-I-LF-BENEFIT-AMT +
  7059                      PB-I-LF-ALT-BENEFIT-AMT) * -1
  7060           END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 138
* EL640.cbl
  7061         ELSE
  7062             MULTIPLY PB-C-LF-REF-CALC BY -1
  7063                            GIVING WS-C-LF-CANCEL-AMT
  7064             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7065                            GIVING WS-CI-LIFE-BENEFIT
  7066         END-IF
  7067     ELSE
  7068         IF PB-ISSUE
  7069           IF NOT PB-INVALID-LIFE
  7070            ADD PB-I-LF-PREM-CALC   PB-I-LF-ALT-PREM-CALC
  7071                GIVING WS-I-LF-PREMIUM-AMT
  7072            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7073                     PB-I-LF-BENEFIT-AMT +
  7074                     PB-I-LF-ALT-BENEFIT-AMT
  7075           END-IF
  7076         ELSE
  7077            MOVE PB-C-LF-REF-CALC     TO WS-C-LF-CANCEL-AMT
  7078            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7079         END-IF
  7080     END-IF
  7081     .
  7082 1320-CHECK-AH.
  7083     IF PB-OVERRIDE-AH  OR
  7084        PB-OVERRIDE-BOTH
  7085         GO TO 1330-AH-OVERRIDE.
  7086
  7087     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7088         IF PB-ISSUE
  7089            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7090                            GIVING WS-I-AH-BENEFIT-AMT
  7091            MULTIPLY PB-I-AH-PREMIUM-AMT BY -1
  7092                            GIVING WS-I-AH-PREMIUM-AMT
  7093         ELSE
  7094             MULTIPLY PB-C-AH-CANCEL-AMT BY -1
  7095                            GIVING WS-C-AH-CANCEL-AMT
  7096     ELSE
  7097         IF PB-ISSUE
  7098            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7099            MOVE PB-I-AH-PREMIUM-AMT TO WS-I-AH-PREMIUM-AMT
  7100         ELSE
  7101            MOVE PB-C-AH-CANCEL-AMT TO WS-C-AH-CANCEL-AMT
  7102            IF  PB-CI-CANCEL-FEE > ZEROS
  7103                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7104                MULTIPLY WS-C-CANCEL-FEE BY -1
  7105                                          GIVING WORK-CANCEL-FEE
  7106                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7107
  7108     GO TO 1399-EXIT.
  7109
  7110 1330-AH-OVERRIDE.
  7111     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7112         IF PB-ISSUE
  7113            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7114                            GIVING WS-I-AH-BENEFIT-AMT
  7115            MULTIPLY PB-I-AH-PREM-CALC BY -1
  7116                            GIVING WS-I-AH-PREMIUM-AMT
  7117         ELSE
  7118             MULTIPLY PB-C-AH-REF-CALC BY -1
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 139
* EL640.cbl
  7119                            GIVING WS-C-AH-CANCEL-AMT
  7120     ELSE
  7121         IF PB-ISSUE
  7122            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7123            MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  7124         ELSE
  7125            MOVE PB-C-AH-REF-CALC    TO WS-C-AH-CANCEL-AMT
  7126            IF PB-CI-CANCEL-FEE > ZEROS
  7127                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7128                MULTIPLY WS-C-CANCEL-FEE BY -1
  7129                                          GIVING WORK-CANCEL-FEE
  7130                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7131
  7132 1399-EXIT.
  7133     EXIT.
  7134
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 140
* EL640.cbl
  7136 2000-VOID-BILLING.
  7137
  7138*                *******************************************
  7139*                *  PROCESS VOID BILLING.  THIS SECTION    *
  7140*                *  WILL RESET THE FILES TO THE STATUS     *
  7141*                *  THEY WERE IN PRIOR TO THE LAST BILLING *
  7142*                *******************************************
  7143
  7144     MOVE SPACES                 TO WS-EXP-DATE
  7145                                    WS-REMIT-TO.
  7146     SET DTNDX  RTNDX            TO 1.
  7147     MOVE SPACES                 TO ELCNTL-KEY.
  7148     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7149
  7150     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  7151
  7152     IF EMI-ERROR NOT = ZEROS
  7153         GO TO 8200-SEND-DATAONLY.
  7154
  7155     MOVE CF-CURRENT-MONTH-END   TO DC-BIN-DATE-1.
  7156     MOVE SPACE                  TO DC-OPTION-CODE.
  7157     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7158     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  7159
  7160     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  7161
  7162     IF PNDB-EOF
  7163         GO TO 2100-VOID-PNDB-COMPLETE.
  7164
  7165 2010-VOID-PNDB-LOOP.
  7166     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  7167
  7168     IF PNDB-EOF
  7169         GO TO 2100-VOID-PNDB-COMPLETE.
  7170
  7171     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  7172        PB-CARRIER       = PI-SAV-CARR    AND
  7173        PB-GROUPING      = PI-SAV-GROUP   AND
  7174        PB-STATE         = PI-SAV-STATE   AND
  7175        PB-ACCOUNT       = PI-SAV-ACCT
  7176         NEXT SENTENCE
  7177     ELSE
  7178         GO TO 2100-VOID-PNDB-COMPLETE.
  7179
  7180     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7181         GO TO 2010-VOID-PNDB-LOOP.
  7182
  7183     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7184         MOVE PB-CONTROL-PRIMARY TO ERPNDB-PRIME-KEY
  7185
  7186* EXEC CICS ENDBR
  7187*             DATASET (ERPNDB-ALT-FILE-ID)
  7188*        END-EXEC
  7189     MOVE 0
  7190       TO DFHEIV11
  7191*    MOVE '&2                    $   #00007085' TO DFHEIV0
  7192     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7193     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 141
* EL640.cbl
  7194     MOVE X'2020233030303037303835' TO DFHEIV0(25:11)
  7195     CALL 'kxdfhei1' USING DFHEIV0,
  7196           ERPNDB-ALT-FILE-ID,
  7197           DFHEIV11,
  7198           DFHEIV99
  7199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7200
  7201* EXEC CICS DELETE
  7202*            DATASET (ERPNDB-FILE-ID)
  7203*            RIDFLD  (ERPNDB-PRIME-KEY)
  7204*        END-EXEC
  7205*    MOVE '&(  R                 &   #00007088' TO DFHEIV0
  7206     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7207     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7208     MOVE X'2020233030303037303838' TO DFHEIV0(25:11)
  7209     CALL 'kxdfhei1' USING DFHEIV0,
  7210           ERPNDB-FILE-ID,
  7211           ERPNDB-PRIME-KEY,
  7212           DFHEIV99,
  7213           DFHEIV99,
  7214           DFHEIV99
  7215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7216         PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT
  7217         IF PNDB-EOF
  7218            GO TO 2100-VOID-PNDB-COMPLETE
  7219         ELSE
  7220            GO TO 2010-VOID-PNDB-LOOP.
  7221
  7222     IF PB-BILLED-DT = LOW-VALUES  AND
  7223        PB-CHG-COUNT = ZEROS
  7224         GO TO 2010-VOID-PNDB-LOOP.
  7225
  7226     IF PB-BATCH-TRAILER
  7227         GO TO 2115-CONT.
  7228
  7229     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  7230         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  7231         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7232         IF AM-AGT (AM-REMIT-TO) NOT = WORK-REMIT-TO
  7233             MOVE AM-AGT (AM-REMIT-TO) TO WORK-REMIT-TO
  7234                                          WS-SAV-REMIT-TO (RTNDX)
  7235             IF RTNDX < 10
  7236                 SET RTNDX UP BY 1.
  7237
  7238 2115-CONT.
  7239     IF NOT PB-BATCH-TRAILER
  7240         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  7241         PERFORM 1300-CHECK-OVERRIDE-PREM       THRU 1399-EXIT
  7242         PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  7243
  7244     PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  7245
  7246     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7247     GO TO 2010-VOID-PNDB-LOOP.
  7248
  7249 2100-VOID-PNDB-COMPLETE.
  7250     SET RTNDX                   TO 1.
  7251
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 142
* EL640.cbl
  7252     IF NOT DATA-VOIDED
  7253         SET DTNDX TO RTNDX
  7254         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7255         MOVE AM-AGT (AM-REMIT-TO) TO WS-SAV-REMIT-TO (RTNDX).
  7256
  7257 2105-PYAJ-LOOP.
  7258     IF RTNDX > 10
  7259       OR WS-SAV-REMIT-TO (RTNDX) = SPACES
  7260         GO TO 2105-VOID-CONTINUE.
  7261
  7262     MOVE WS-SAV-REMIT-TO (RTNDX) TO PI-SAV-REMIT-TO.
  7263     PERFORM 2200-VOID-PYAJ THRU 2290-EXIT.
  7264
  7265     SET RTNDX UP BY 1.
  7266     GO TO 2105-PYAJ-LOOP.
  7267
  7268 2105-VOID-CONTINUE.
  7269     IF DATA-VOIDED
  7270         NEXT SENTENCE
  7271     ELSE
  7272         MOVE -1                 TO APFNTERL
  7273         MOVE ER-2401            TO EMI-ERROR
  7274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7275         GO TO 8100-SEND-INITIAL-MAP.
  7276
  7277     SET DTNDX                   TO 1.
  7278
  7279 2105-VOID-MASTERS-LOOP.
  7280     IF WS-SAV-EXP-DT (DTNDX) = SPACES
  7281       OR DTNDX > 10
  7282         GO TO 2105-VOID-COMPLETE.
  7283
  7284     MOVE WS-SAV-EXP-DT (DTNDX) TO PI-SAV-EXP-DT.
  7285
  7286     PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  7287
  7288     IF PI-SAV-REMIT-TO NOT = ERCOMP-FIN-RESP
  7289         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  7290         PERFORM 3930-BILL-READ        THRU 3930-EXIT
  7291         IF NOT NO-BILL-RECS
  7292             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT.
  7293
  7294     SET DTNDX UP BY 1.
  7295
  7296     GO TO 2105-VOID-MASTERS-LOOP.
  7297
  7298 2105-VOID-COMPLETE.
  7299     MOVE 0000                   TO EMI-ERROR.
  7300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7301     SET PINDX ANDX TO 1.
  7302
  7303 2110-FORMAT-LOOP.
  7304     IF PI-BATCH (PINDX) NOT = SPACES
  7305         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  7306         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  7307         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  7308         SET ANDX PINDX UP BY 1
  7309         IF PINDX > 6
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 143
* EL640.cbl
  7310             NEXT SENTENCE
  7311         ELSE
  7312             GO TO 2110-FORMAT-LOOP.
  7313
  7314     MOVE -1                     TO AACCTL.
  7315
  7316     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 144
* EL640.cbl
  7318 2200-VOID-PYAJ.
  7319     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  7320
  7321     IF PYAJ-EOF
  7322         GO TO 2290-EXIT.
  7323
  7324 2210-VOID-PYAJ-LOOP.
  7325     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  7326
  7327     IF PYAJ-EOF
  7328         PERFORM 4800-PYAJ-END-BROWSE
  7329         GO TO 2290-EXIT.
  7330
  7331     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  7332        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  7333        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  7334        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  7335        PY-ACCOUNT    = PI-SAV-ACCT
  7336         NEXT SENTENCE
  7337     ELSE
  7338         PERFORM 4800-PYAJ-END-BROWSE
  7339         GO TO 2290-EXIT.
  7340
  7341     IF (PY-BILLED-DATE = LOW-VALUES AND
  7342            PY-AR-DATE = LOW-VALUES)
  7343       OR PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7344         GO TO 2210-VOID-PYAJ-LOOP.
  7345
  7346     PERFORM 4800-PYAJ-END-BROWSE.
  7347
  7348     PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT.
  7349
  7350     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7351     ADD +1 TO ERPYAJ-FILE-SEQ-NO.
  7352
  7353     GO TO 2200-VOID-PYAJ.
  7354
  7355 2290-EXIT.
  7356     EXIT.
  7357
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 145
* EL640.cbl
  7359
  7360 3000-WRITE-BILLING-DETAIL.
  7361
  7362*                *******************************************
  7363*                *  FORMATS THE BILLING DETAIL RECORDS.    *
  7364*                *  THESE RECORDS ARE CREATED IN THE       *
  7365*                *  SAME FORMAT THAT THEY WILL APPEAR      *
  7366*                *  WHEN PRINTED.                          *
  7367*                *******************************************
  7368
  7369     IF CARRIER-ADDRESS  OR
  7370        GEN-AGT-ADDRESS
  7371          PERFORM 3930-BILL-READ THRU 3930-EXIT
  7372         IF NO-BILL-RECS
  7373             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7374         ELSE
  7375             IF BI-PREVIEW-ONLY
  7376               OR BI-INITIAL-PRINT-DATE NOT = LOW-VALUES
  7377               OR PI-TOT-REBILL
  7378                 PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  7379                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7380             ELSE
  7381                 MOVE ER-2403    TO EMI-ERROR
  7382                 MOVE -1         TO ABILTYPL
  7383                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7384                 GO TO 3990-EXIT.
  7385
  7386     IF TOTAL-STATEMENT
  7387         GO TO 3400-FORMAT-TOTAL-LINES.
  7388
  7389 3100-FORMAT-DETAIL-LINES.
  7390     IF PI-PREM (PINDX) NOT NUMERIC
  7391        MOVE ZEROS               TO PI-PREM (PINDX).
  7392     IF PI-COMM (PINDX) NOT NUMERIC
  7393        MOVE ZEROS               TO PI-COMM (PINDX).
  7394
  7395     IF WS-LINECTR > 23
  7396         MOVE ZEROS              TO WS-LINECTR
  7397         MOVE '3'                TO BI-RECORD-TYPE
  7398         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7399         MOVE '          CONTINUED ON NEXT PAGE'
  7400                                 TO BI-TEXT-LINE
  7401         PERFORM 3920-BILL-WRITE
  7402         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7403
  7404     IF WS-LINECTR = ZEROS
  7405         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7406     ELSE
  7407         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL
  7408     END-IF.
  7409
  7410     MOVE '3'                    TO BI-RECORD-TYPE.
  7411
  7412     IF BILLING-DETAIL-TYPE = 'BP'
  7413        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7414             MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7415             MULTIPLY PY-ENTRY-AMT   BY -1
  7416                              GIVING BI-TOT-PREM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 146
* EL640.cbl
  7417             MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7418             ADD +1 TO WS-LINECTR
  7419             PERFORM 3920-BILL-WRITE
  7420             GO TO 3990-EXIT.
  7421
  7422     IF BILLING-DETAIL-TYPE = 'BP'
  7423         MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7424         MOVE PY-ENTRY-AMT       TO BI-TOT-PREM
  7425         MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7426         ADD +1 TO WS-LINECTR
  7427         PERFORM 3920-BILL-WRITE
  7428         GO TO 3990-EXIT.
  7429
  7430     MOVE SPACES                 TO BI-TEXT-LINE.
  7431
  7432     IF PB-ISSUE
  7433        NEXT SENTENCE
  7434     ELSE
  7435        GO TO 3110-FORMAT-DETAIL-CANCEL.
  7436
  7437     MOVE PB-I-INSURED-FIRST-NAME    TO BI-INS-1ST-NAME.
  7438     MOVE PB-I-INSURED-MIDDLE-INIT   TO BI-INS-INIT.
  7439
  7440     IF PI-COMPANY-ID = 'DMD' AND
  7441        PB-ISSUE
  7442        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7443
  7444     MOVE PB-I-INSURED-LAST-NAME     TO BI-INS-LAST-NAME.
  7445     MOVE PB-CERT-NO                 TO BI-CERT.
  7446     MOVE PB-I-LF-TERM               TO BI-ED-TERM  BI-TERM.
  7447     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7448     MOVE SPACE                      TO DC-OPTION-CODE.
  7449     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7450     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7451
  7452     IF PI-COMPANY-ID = 'DMD' AND
  7453        PB-ISSUE  AND
  7454        NOT PB-INVALID-LIFE
  7455          MOVE PB-I-LF-BENEFIT-CD    TO WS-BENE-CD
  7456          MOVE WS-BENEFIT            TO PB-I-LF-ABBR.
  7457
  7458     IF NOT PB-INVALID-LIFE
  7459        MOVE PB-I-LF-ABBR            TO BI-TYPE
  7460        MOVE WS-I-LF-PREMIUM-AMT     TO BI-PREM
  7461                                        BI-PREMIUM-AMT
  7462        ADD WS-I-LF-PREMIUM-AMT      TO TOT-REPT-LF-PREM
  7463        MULTIPLY PB-I-LIFE-COMMISSION BY 100 GIVING BI-ED-RATE
  7464        MOVE PB-I-LIFE-COMMISSION    TO BI-RATE
  7465        MOVE PI-LF-ISS-COMP          TO BI-COMM
  7466        ADD  PI-LF-ISS-COMP          TO TOT-REPT-LF-COMP
  7467        MOVE WS-I-LF-BENEFIT-AMT     TO BI-FACE-AMT
  7468                                        BI-BENEFIT-AMT
  7469        ADD WS-I-LF-BENEFIT-AMT      TO TOT-LF-REPT-FACE-AMT
  7470        ADD WS-I-LF-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7471        ADD PI-LF-ISS-COMP           TO  PI-COMM (PINDX)
  7472        PERFORM 3920-BILL-WRITE
  7473        ADD +1 TO WS-LINECTR
  7474        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 147
* EL640.cbl
  7475        MOVE SPACES                  TO BI-TEXT-LINE.
  7476
  7477     IF PI-COMPANY-ID = 'DMD' AND
  7478        PB-ISSUE  AND
  7479        NOT PB-INVALID-AH
  7480          MOVE PB-I-AH-BENEFIT-CD    TO WS-BENE-CD
  7481          MOVE WS-BENEFIT            TO PB-I-AH-ABBR.
  7482
  7483     IF NOT PB-INVALID-AH
  7484        MOVE PB-I-AH-ABBR            TO BI-TYPE
  7485        MOVE WS-I-AH-PREMIUM-AMT     TO BI-PREM
  7486                                        BI-PREMIUM-AMT
  7487        ADD WS-I-AH-PREMIUM-AMT      TO TOT-REPT-AH-PREM
  7488        MULTIPLY PB-I-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7489        MOVE PB-I-AH-COMMISSION      TO BI-RATE
  7490        MOVE PI-AH-ISS-COMP          TO BI-COMM
  7491        ADD PI-AH-ISS-COMP           TO TOT-REPT-AH-COMP
  7492        MOVE WS-I-AH-BENEFIT-AMT     TO BI-FACE-AMT
  7493        ADD WS-I-AH-BENEFIT-AMT      TO TOT-AH-REPT-FACE-AMT
  7494        ADD WS-I-AH-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7495        ADD PI-AH-ISS-COMP           TO  PI-COMM (PINDX)
  7496        PERFORM 3920-BILL-WRITE
  7497        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
  7498        ADD +1                       TO WS-LINECTR.
  7499
  7500     GO TO 3990-EXIT.
  7501
  7502 3110-FORMAT-DETAIL-CANCEL.
  7503     MOVE PB-CI-LAST-NAME            TO BI-INS-LAST-NAME.
  7504     MOVE PB-CI-INITIALS             TO BI-INS-INITS.
  7505
  7506     IF PI-COMPANY-ID = 'DMD' AND
  7507        PB-CANCELLATION
  7508        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7509
  7510     MOVE PB-CERT-NO                 TO BI-CERT.
  7511     MOVE PB-CI-LF-TERM              TO BI-ED-TERM
  7512                                        BI-TERM.
  7513     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7514     MOVE SPACE                      TO DC-OPTION-CODE.
  7515     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7516     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7517
  7518     IF PI-COMPANY-ID = 'DMD' AND
  7519        PB-CANCELLATION AND
  7520        PB-CI-LF-ABBR > SPACES
  7521          MOVE PB-CI-LF-BENEFIT-CD   TO WS-BENE-CD
  7522          MOVE WS-BENEFIT            TO PB-CI-LF-ABBR.
  7523
  7524     IF PB-CI-LF-ABBR > SPACES
  7525         MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
  7526         MOVE SPACE                  TO DC-OPTION-CODE
  7527         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7528         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7529         MOVE PB-CI-LF-ABBR          TO BI-TYPE
  7530         MOVE WS-C-LF-CANCEL-AMT     TO BI-PREMIUM-AMT
  7531         MULTIPLY WS-C-LF-CANCEL-AMT BY -1 GIVING WORK-AMT
  7532         MOVE WORK-AMT               TO BI-PREM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 148
* EL640.cbl
  7533         ADD WS-C-LF-CANCEL-AMT      TO TOT-REPT-LF-REF
  7534         ADD WORK-AMT                TO TOT-REPT-LF-PREM
  7535                                        PI-PREM (PINDX)
  7536         MULTIPLY PB-CI-LIFE-COMMISSION
  7537                                     BY 100 GIVING BI-ED-RATE
  7538         MOVE PB-CI-LIFE-COMMISSION  TO BI-RATE
  7539         IF WS-CHARGEBACK-LF-SW = 'N'
  7540             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7541             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7542             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7543                                            PI-COMM (PINDX)
  7544             COMPUTE TOT-REPT-LF-COMP-R =
  7545               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7546             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7547             ADD +1                      TO WS-LINECTR
  7548             PERFORM 3920-BILL-WRITE
  7549             MOVE SPACES                 TO BI-TEXT-LINE
  7550         ELSE
  7551             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7552             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7553                                            PI-COMM (PINDX)
  7554             COMPUTE TOT-REPT-LF-COMP-R =
  7555               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7556             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7557             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7558             ADD +1                      TO WS-LINECTR
  7559             PERFORM 3920-BILL-WRITE
  7560             MOVE SPACES                 TO BI-TEXT-LINE.
  7561
  7562     IF PI-COMPANY-ID = 'DMD' AND
  7563        PB-CANCELLATION AND
  7564        PB-CI-AH-ABBR > SPACES
  7565          MOVE PB-CI-AH-BENEFIT-CD   TO WS-BENE-CD
  7566          MOVE WS-BENEFIT            TO PB-CI-AH-ABBR.
  7567
  7568     IF PB-CI-AH-ABBR > SPACES
  7569         MOVE PB-C-AH-CANCEL-DT      TO DC-BIN-DATE-1
  7570         MOVE SPACE                  TO DC-OPTION-CODE
  7571         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7572         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7573         MOVE PB-CI-AH-ABBR          TO BI-TYPE
  7574         MOVE WS-C-AH-CANCEL-AMT     TO BI-PREMIUM-AMT
  7575         MULTIPLY WS-C-AH-CANCEL-AMT BY -1 GIVING WORK-AMT
  7576         MOVE WORK-AMT               TO BI-PREM
  7577         ADD WS-C-AH-CANCEL-AMT      TO TOT-REPT-AH-REF
  7578         ADD WORK-AMT                TO TOT-REPT-AH-PREM
  7579                                        PI-PREM (PINDX)
  7580         MULTIPLY PB-CI-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7581         MOVE PB-CI-AH-COMMISSION    TO BI-RATE
  7582         IF WS-CHARGEBACK-AH-SW = 'N'
  7583             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7584             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7585             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7586                                            PI-COMM (PINDX)
  7587             COMPUTE TOT-REPT-AH-COMP-R =
  7588               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7589             ADD +1                      TO WS-LINECTR
  7590             PERFORM 3920-BILL-WRITE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 149
* EL640.cbl
  7591         ELSE
  7592             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7593             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7594                                            PI-COMM (PINDX)
  7595             COMPUTE TOT-REPT-AH-COMP-R =
  7596               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7597             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7598             ADD +1                      TO WS-LINECTR
  7599             PERFORM 3920-BILL-WRITE.
  7600
  7601     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7602         MOVE ZEROS                      TO PB-CI-CANCEL-FEE.
  7603
  7604     IF PB-CI-CANCEL-FEE > ZEROS
  7605         MOVE SPACES                 TO BI-INS-LAST-NAME
  7606                                        BI-INS-INITS
  7607                                        BI-EFF-DT
  7608                                        BI-CAN-DT
  7609                                        BI-TYPE
  7610         MOVE 'CANCEL FEE'           TO BI-CERT
  7611         MOVE WORK-CANCEL-FEE        TO BI-PREM
  7612                                        BI-COMM
  7613         MOVE ZEROS                  TO BI-PREMIUM-AMT
  7614                                        BI-RATE
  7615                                        BI-ED-RATE
  7616                                        BI-ED-TERM
  7617                                        BI-TERM
  7618         ADD +1                      TO WS-LINECTR
  7619         PERFORM 3920-BILL-WRITE.
  7620
  7621     GO TO 3990-EXIT.
  7622
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 150
* EL640.cbl
  7624
  7625 3200-FORMAT-HDR-ADDR-RECS.
  7626     PERFORM 3910-BILL-GETMAIN.
  7627
  7628     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7629     SET A-INDX  R-INDX          TO 1.
  7630     PERFORM 3210-FORMAT-ADDR-RECS  THRU 3210-EXIT 6 TIMES.
  7631     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7632     PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7633     GO TO 3990-EXIT.
  7634
  7635 3210-FORMAT-ADDR-RECS.
  7636     MOVE '2'                     TO BI-RECORD-TYPE.
  7637     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDRESS-LINE.
  7638     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDRESS-LINE.
  7639     PERFORM 3920-BILL-WRITE.
  7640     SET A-INDX  R-INDX         UP BY 1.
  7641
  7642 3210-EXIT.
  7643     EXIT.
  7644
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 151
* EL640.cbl
  7646 3300-FORMAT-HEADINGS.
  7647     MOVE WS-PGECTR              TO BI-HD-PG.
  7648     ADD +1                      TO WS-PGECTR.
  7649     MOVE '3'                    TO BI-RECORD-TYPE.
  7650     MOVE TOP-OF-PAGE            TO BI-SKIP-CONTROL.
  7651
  7652     IF NOT PI-PREVIEW
  7653         MOVE BI-HD1             TO BI-TEXT-LINE
  7654     ELSE
  7655         MOVE BI-PREVIEW-HD      TO BI-TEXT-LINE
  7656         PERFORM 3920-BILL-WRITE
  7657         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7658         MOVE BI-HD1             TO BI-TEXT-LINE.
  7659
  7660     PERFORM 3920-BILL-WRITE.
  7661     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7662     MOVE BI-HD2                 TO BI-TEXT-LINE.
  7663     PERFORM 3920-BILL-WRITE.
  7664     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7665     MOVE BI-HD3                 TO BI-TEXT-LINE.
  7666     PERFORM 3920-BILL-WRITE.
  7667     SET A-INDX  R-INDX          TO 1.
  7668     PERFORM 3390-FORMAT-ADDR-TEXT-LINES THRU 3390-EXIT 5 TIMES.
  7669     MOVE '3'                    TO BI-RECORD-TYPE.
  7670     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7671     MOVE BI-HD4                 TO BI-TEXT-LINE.
  7672     PERFORM 3920-BILL-WRITE.
  7673     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7674     MOVE BI-HD5                 TO BI-TEXT-LINE.
  7675     PERFORM 3920-BILL-WRITE.
  7676
  7677 3380-EXIT.
  7678     EXIT.
  7679
  7680 3390-FORMAT-ADDR-TEXT-LINES.
  7681     MOVE '3'                    TO BI-RECORD-TYPE.
  7682     MOVE SPACES                 TO BI-TEXT-LINE.
  7683
  7684     IF A-INDX = 1
  7685         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7686         MOVE 'ACCOUNT NO. - '   TO BI-ADDR-LIT
  7687         MOVE WS-CARR-COMP       TO BI-CO
  7688         MOVE '-'                TO BI-DASH
  7689         MOVE PI-SAV-ACCT        TO BI-ACCT
  7690         MOVE 'REMIT TO - '      TO BI-REMIT-LIT
  7691     ELSE
  7692         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL.
  7693
  7694     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDR.
  7695     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDR.
  7696     PERFORM 3920-BILL-WRITE.
  7697     SET A-INDX  R-INDX  UP BY 1.
  7698
  7699 3390-EXIT.
  7700     EXIT.
  7701
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 152
* EL640.cbl
  7703 3400-FORMAT-TOTAL-LINES.
  7704     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  7705                          PI-PREMIUM +
  7706                          TOT-REPT-CANCEL-FEE -
  7707                          PI-REMITTED -
  7708                          PI-TOT-ISS-COMP +
  7709                          PI-TOT-CAN-COMP +
  7710                          PI-ADJUSTMENTS +
  7711                          PI-DISBURSED.
  7712
  7713     MOVE SPACES                 TO BI-TEXT-LINE.
  7714
  7715     MOVE '1'                    TO BI-RECORD-TYPE.
  7716     MOVE PI-PROCESSOR-ID        TO BI-PROCESSOR-CD.
  7717
  7718     IF PI-PREV-BILL OR PI-PREV-REBILL
  7719         MOVE 'P'                TO BI-STATEMENT-TYPE.
  7720
  7721     MOVE +1                     TO BI-NO-OF-COPIES.
  7722     MOVE WS-CURRENT-DATE        TO BI-CREATION-DT.
  7723     MOVE LOW-VALUES             TO BI-INITIAL-PRINT-DATE.
  7724     MOVE PI-BAL-FRWD            TO BI-BAL-FRWD.
  7725     MOVE PI-PREMIUM             TO BI-PREMIUM.
  7726     MOVE PI-REMITTED            TO BI-REMITTED.
  7727     MOVE PI-TOT-ISS-COMP        TO BI-TOT-ISS-COMP.
  7728     MOVE PI-TOT-CAN-COMP        TO BI-TOT-CAN-COMP.
  7729     MOVE PI-ADJUSTMENTS         TO BI-ADJUSTMNTS.
  7730     MOVE PI-DISBURSED           TO BI-DISBURSED.
  7731     MOVE PI-END-BAL             TO BI-END-BAL.
  7732
  7733     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  7734         MOVE WS-ACCT-LINES (1)  TO BI-FIN-RESP-NAME
  7735     ELSE
  7736         MOVE WS-REMIT-LINES (1) TO BI-FIN-RESP-NAME.
  7737
  7738     PERFORM 3920-BILL-WRITE.
  7739
  7740     IF WS-LINECTR > 16
  7741         MOVE ZEROS              TO WS-LINECTR
  7742         MOVE '3'                TO BI-RECORD-TYPE
  7743         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7744         MOVE '          CONTINUED ON NEXT PAGE'
  7745                                 TO BI-TEXT-LINE
  7746         PERFORM 3920-BILL-WRITE
  7747         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7748
  7749     IF PI-BAL-FRWD NOT = ZERO
  7750         MOVE SPACES             TO BI-TEXT-LINE
  7751         MOVE '3'                TO BI-RECORD-TYPE
  7752         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7753         MOVE 'BALANCE FORWARD'  TO BI-TOT-DESC
  7754         MOVE PI-BAL-FRWD        TO BI-TOT-PREM
  7755         PERFORM 3920-BILL-WRITE.
  7756
  7757     IF PI-PREMIUM NOT = ZERO
  7758         MOVE SPACES             TO BI-TEXT-LINE
  7759         MOVE '3'                TO BI-RECORD-TYPE
  7760         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 153
* EL640.cbl
  7761         MOVE 'THIS MONTHS PREMIUM'  TO BI-TOT-DESC
  7762         COMPUTE WORK-AMT  =  TOT-REPT-CANCEL-FEE + PI-PREMIUM
  7763         MOVE WORK-AMT           TO BI-TOT-PREM
  7764         PERFORM 3920-BILL-WRITE.
  7765
  7766     IF PI-TOT-ISS-COMP NOT = ZEROS  OR
  7767        PI-TOT-CAN-COMP NOT = ZEROS
  7768         MOVE SPACES             TO BI-TEXT-LINE
  7769         MOVE '3'                TO BI-RECORD-TYPE
  7770         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7771         MOVE 'LESS COMPENSATION' TO BI-TOT-DESC
  7772         SUBTRACT PI-TOT-CAN-COMP FROM PI-TOT-ISS-COMP
  7773                          GIVING BI-TOT-PREM
  7774         PERFORM 3920-BILL-WRITE.
  7775
  7776     IF PI-REMITTED  NOT = ZEROS  OR
  7777        PI-DISBURSED NOT = ZEROS
  7778         MOVE SPACES             TO BI-TEXT-LINE
  7779         MOVE '3'                TO BI-RECORD-TYPE
  7780         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7781         MOVE 'LESS PAYMENTS'    TO BI-TOT-DESC
  7782         IF PI-COMPANY-ID = 'UCL'
  7783             SUBTRACT PI-DISBURSED FROM PI-REMITTED
  7784                      GIVING BI-TOT-PREM
  7785             PERFORM 3920-BILL-WRITE
  7786           ELSE
  7787             MOVE PI-REMITTED        TO BI-TOT-PREM
  7788             PERFORM 3920-BILL-WRITE.
  7789
  7790     IF PI-ADJUSTMENTS NOT = ZERO
  7791         MOVE SPACES             TO BI-TEXT-LINE
  7792         MOVE '3'                TO BI-RECORD-TYPE
  7793         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7794         MOVE 'ADJUSTMENT'       TO BI-TOT-DESC
  7795         ADD PI-ADJUSTMENTS, PI-DISBURSED GIVING BI-TOT-PREM
  7796         PERFORM 3920-BILL-WRITE.
  7797
  7798     MOVE SPACES                 TO BI-TEXT-LINE.
  7799     MOVE '3'                    TO BI-RECORD-TYPE.
  7800     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7801     MOVE ALL '-'                TO BI-TOT-DASH.
  7802     PERFORM 3920-BILL-WRITE.
  7803
  7804     MOVE SPACES                 TO BI-TEXT-LINE.
  7805     MOVE '3'                    TO BI-RECORD-TYPE.
  7806     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7807
  7808     IF PI-END-BAL < +1.00 AND > -1.00
  7809         NEXT SENTENCE
  7810     ELSE
  7811         IF PI-END-BAL < +0
  7812             MOVE 'WE WILL REFUND' TO BI-TOT-DESC
  7813         ELSE
  7814             MOVE 'PLEASE REMIT' TO BI-TOT-DESC.
  7815
  7816     MOVE PI-END-BAL             TO BI-TOT-PREM.
  7817
  7818     PERFORM 3920-BILL-WRITE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 154
* EL640.cbl
  7819
  7820     IF CO-CARRY-BALANCE
  7821         IF PI-END-BAL > +1.00
  7822             MOVE SPACES         TO BI-TEXT-LINE
  7823             MOVE '3'            TO BI-RECORD-TYPE
  7824             MOVE DOUBLE-SPACE   TO BI-SKIP-CONTROL
  7825             MOVE 'PLEASE RETURN ONE COPY WITH REMITTANCE'
  7826                                 TO BI-TEXT-LINE
  7827             PERFORM 3920-BILL-WRITE.
  7828
  7829     IF PI-COMPANY-ID = 'DMD'
  7830        MOVE SPACES                 TO BI-TEXT-LINE
  7831        MOVE '3'                    TO BI-RECORD-TYPE
  7832        MOVE '0'                    TO BI-SKIP-CONTROL
  7833        MOVE BI-HD6                 TO BI-TEXT-LINE
  7834        PERFORM 3920-BILL-WRITE
  7835        MOVE SPACES                 TO BI-TEXT-LINE
  7836        MOVE ' '                    TO BI-SKIP-CONTROL
  7837        MOVE BI-HD7                 TO BI-TEXT-LINE
  7838        PERFORM 3920-BILL-WRITE
  7839
  7840        PERFORM 3600-FIND-BATCH-NUMBER THRU 3699-EXIT
  7841          VARYING PINDX FROM 1 BY 1
  7842            UNTIL PINDX > +6.
  7843
  7844     MOVE ZEROS                  TO PI-PREM     (PINDX)
  7845                                    PI-COMM     (PINDX)
  7846                                    PI-NON-PREM (PINDX)
  7847                                    PI-NON-COMM (PINDX).
  7848
  7849     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 155
* EL640.cbl
  7851
  7852 3500-TOTAL-OUT-DETAIL.
  7853     IF PI-DATA-BILLED AND
  7854        RETURNED-FROM = SPACES
  7855           NEXT SENTENCE
  7856       ELSE
  7857           GO TO 3599-EXIT.
  7858
  7859     IF PI-UPDATE-FILES  OR
  7860        (PI-PREVIEW AND APRODSWI = 'Y')
  7861           NEXT SENTENCE
  7862        ELSE
  7863           GO TO 3599-EXIT.
  7864
  7865     MOVE SPACES                 TO BI-TEXT-LINE.
  7866*    MOVE '3'                    TO BI-RECORD-TYPE.
  7867*    MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7868*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7869*    MOVE PI-LIFE-OVERRIDE-L6    TO BI-OVERRIDE-L6.
  7870*    MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM.
  7871*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7872*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7873*    PERFORM 3920-BILL-WRITE.
  7874*
  7875*    MOVE SPACES                 TO BI-TEXT-LINE.
  7876*    MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7877*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7878*    MOVE PI-AH-OVERRIDE-L6      TO BI-OVERRIDE-L6.
  7879*    MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7880*    MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7881*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7882*    PERFORM 3920-BILL-WRITE.
  7883
  7884     MOVE SPACES                 TO BI-TEXT-LINE.
  7885     MOVE '3'                    TO BI-RECORD-TYPE.
  7886     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7887     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7888     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7889     ADD TOT-REPT-LF-REF TOT-REPT-LF-PREM
  7890          GIVING BI-TOT-PREM
  7891     ADD TOT-REPT-LF-COMP TOT-REPT-LF-COMP-R
  7892          GIVING BI-COM-TOT
  7893*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7894*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7895     PERFORM 3920-BILL-WRITE.
  7896
  7897     MOVE SPACES                 TO BI-TEXT-LINE.
  7898     MOVE '3'                    TO BI-RECORD-TYPE.
  7899     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7900     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7901     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7902     MOVE TOT-REPT-LF-REF        TO BI-TOT-PREM.
  7903     MOVE TOT-REPT-LF-COMP-R     TO BI-COM-TOT
  7904     PERFORM 3920-BILL-WRITE.
  7905
  7906     MOVE SPACES                 TO BI-TEXT-LINE.
  7907     MOVE '3'                    TO BI-RECORD-TYPE.
  7908     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 156
* EL640.cbl
  7909     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7910     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7911     MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM
  7912     MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT
  7913     MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7914     PERFORM 3920-BILL-WRITE.
  7915
  7916     MOVE SPACES                 TO BI-TEXT-LINE.
  7917     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7918     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7919     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7920     ADD TOT-REPT-AH-REF TOT-REPT-AH-PREM
  7921          GIVING BI-TOT-PREM
  7922     ADD TOT-REPT-AH-COMP TOT-REPT-AH-COMP-R
  7923          GIVING BI-COM-TOT
  7924*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7925     PERFORM 3920-BILL-WRITE.
  7926
  7927     MOVE SPACES                 TO BI-TEXT-LINE.
  7928     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7929     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7930     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7931     MOVE TOT-REPT-AH-REF        TO BI-TOT-PREM
  7932     MOVE TOT-REPT-AH-COMP-R     TO BI-COM-TOT.
  7933     PERFORM 3920-BILL-WRITE.
  7934
  7935     MOVE SPACES                 TO BI-TEXT-LINE.
  7936     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7937     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7938     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7939     MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7940     MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7941     MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7942     PERFORM 3920-BILL-WRITE.
  7943
  7944     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7945         MOVE ZEROS  TO  PB-CI-CANCEL-FEE.
  7946
  7947     IF PB-CI-CANCEL-FEE > ZEROS
  7948         MOVE SPACES                 TO BI-TEXT-LINE
  7949         MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL
  7950         MOVE 'TOTAL'                TO BI-TOT-LIT
  7951         MOVE 'CAN-FE'               TO BI-OVERRIDE-L6
  7952         MOVE TOT-REPT-CANCEL-FEE    TO BI-TOT-PREM
  7953                                        BI-COM-TOT
  7954         MOVE ZEROS                  TO BI-FACE-TOT
  7955         PERFORM 3920-BILL-WRITE.
  7956
  7957     MOVE SPACES                 TO BI-TEXT-LINE.
  7958     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7959     PERFORM 3920-BILL-WRITE.
  7960
  7961 3599-EXIT.
  7962     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 157
* EL640.cbl
  7964
  7965 3600-FIND-BATCH-NUMBER.
  7966     IF PI-PREM (PINDX) NOT NUMERIC
  7967        MOVE ZEROS               TO PI-PREM (PINDX).
  7968     IF PI-COMM (PINDX) NOT NUMERIC
  7969        MOVE ZEROS               TO PI-COMM (PINDX).
  7970     IF PI-NON-PREM (PINDX) NOT NUMERIC
  7971        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  7972     IF PI-NON-COMM (PINDX) NOT NUMERIC
  7973        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  7974
  7975     IF PI-PREM (PINDX)     = ZEROS   AND
  7976        PI-COMM (PINDX)     = ZEROS   AND
  7977        PI-NON-PREM (PINDX) = ZEROS   AND
  7978        PI-NON-COMM (PINDX) = ZEROS
  7979          GO TO 3699-EXIT.
  7980
  7981     MOVE SPACES                 TO BI-TEXT-LINE.
  7982     MOVE '3'                    TO BI-RECORD-TYPE.
  7983     MOVE ' '                    TO BI-SKIP-CONTROL.
  7984     MOVE 'BATCH NO. '           TO WS-BATCH-DESC.
  7985     MOVE PI-BATCH (PINDX)       TO WS-BATCH-NBR.
  7986     MOVE WS-DESC                TO BI-TOT-DESC5.
  7987     MOVE PI-PREM (PINDX)        TO BI-TOT-PREM5.
  7988     MOVE PI-COMM (PINDX)        TO BI-COM-TOT5.
  7989     MOVE PI-NON-PREM (PINDX)    TO BI-NON-PREM5.
  7990     MOVE PI-NON-COMM (PINDX)    TO BI-NON-COMM5.
  7991     PERFORM 3920-BILL-WRITE.
  7992
  7993 3699-EXIT.
  7994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 158
* EL640.cbl
  7996
  7997 3910-BILL-GETMAIN.
  7998
  7999* EXEC CICS GETMAIN
  8000*        SET     (ADDRESS OF BILLING-STATEMENT)
  8001*        LENGTH  (210)
  8002*        INITIMG (GETMAIN-SPACE)
  8003*    END-EXEC.
  8004     MOVE 210
  8005       TO DFHEIV11
  8006*    MOVE ',"IL                  $   #00007874' TO DFHEIV0
  8007     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8008     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8009     MOVE X'2020233030303037383734' TO DFHEIV0(25:11)
  8010     CALL 'kxdfhei1' USING DFHEIV0,
  8011           DFHEIV20,
  8012           DFHEIV11,
  8013           GETMAIN-SPACE
  8014     SET ADDRESS OF BILLING-STATEMENT TO
  8015         DFHEIV20
  8016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8017
  8018
  8019 3920-BILL-WRITE.
  8020     MOVE PI-COMPANY-CD          TO BI-COMPANY-CD.
  8021     MOVE PI-CR-CARRIER          TO BI-CARRIER.
  8022     MOVE PI-CR-GROUPING         TO BI-GROUPING
  8023     MOVE PI-SAV-ACCT            TO BI-ACCOUNT.
  8024     MOVE PI-SAV-REMIT-TO        TO BI-FIN-RESP.
  8025
  8026     MOVE 'BI'                   TO BI-RECORD-ID.
  8027     ADD +1                      TO WS-LINE-SEQ-NO.
  8028
  8029     IF BI-RECORD-TYPE = '1'
  8030         MOVE ZEROS              TO BI-LINE-SEQ-NO
  8031     ELSE
  8032         MOVE WS-LINE-SEQ-NO     TO BI-LINE-SEQ-NO.
  8033
  8034
  8035* EXEC CICS WRITE
  8036*        DATASET (ERBILL-FILE-ID)
  8037*        FROM    (BILLING-STATEMENT)
  8038*        RIDFLD  (BI-CONTROL-PRIMARY)
  8039*    END-EXEC.
  8040     MOVE LENGTH OF
  8041      BILLING-STATEMENT
  8042       TO DFHEIV11
  8043*    MOVE '&$ L                  ''   #00007895' TO DFHEIV0
  8044     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8045     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8046     MOVE X'2020233030303037383935' TO DFHEIV0(25:11)
  8047     CALL 'kxdfhei1' USING DFHEIV0,
  8048           ERBILL-FILE-ID,
  8049           BILLING-STATEMENT,
  8050           DFHEIV11,
  8051           BI-CONTROL-PRIMARY,
  8052           DFHEIV99,
  8053           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 159
* EL640.cbl
  8054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8055
  8056
  8057 3930-BILL-READ.
  8058     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8059     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8060     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8061     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8062     MOVE PI-SAV-REMIT-TO        TO ERBILL-FIN-RESP.
  8063     MOVE '1'                    TO ERBILL-REC-TYPE.
  8064     MOVE ZEROS                  TO ERBILL-LINE-SEQ-NO.
  8065
  8066
  8067* EXEC CICS HANDLE CONDITION
  8068*        NOTFND  (3930-BILL-NOTFND)
  8069*        NOTOPEN (3930-BILL-NOTOPEN)
  8070*    END-EXEC.
  8071*    MOVE '"$IJ                  ! $ #00007910' TO DFHEIV0
  8072     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8074     MOVE X'2420233030303037393130' TO DFHEIV0(25:11)
  8075     CALL 'kxdfhei1' USING DFHEIV0
  8076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8077
  8078
  8079
  8080* EXEC CICS READ
  8081*        SET     (ADDRESS OF BILLING-STATEMENT)
  8082*        DATASET (ERBILL-FILE-ID)
  8083*        RIDFLD  (ERBILL-KEY)
  8084*        GTEQ
  8085*    END-EXEC.
  8086*    MOVE '&"S        G          (   #00007915' TO DFHEIV0
  8087     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8088     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8089     MOVE X'2020233030303037393135' TO DFHEIV0(25:11)
  8090     CALL 'kxdfhei1' USING DFHEIV0,
  8091           ERBILL-FILE-ID,
  8092           DFHEIV20,
  8093           DFHEIV99,
  8094           ERBILL-KEY,
  8095           DFHEIV99,
  8096           DFHEIV99,
  8097           DFHEIV99
  8098     SET ADDRESS OF BILLING-STATEMENT TO
  8099         DFHEIV20
  8100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8101
  8102
  8103     IF BI-COMPANY-CD = PI-COMPANY-CD  AND
  8104        BI-CARRIER    = ERBILL-CARRIER AND
  8105        BI-GROUPING   = ERBILL-GROUP   AND
  8106        BI-ACCOUNT    = ERBILL-ACCT    AND
  8107        BI-FIN-RESP   = ERBILL-FIN-RESP
  8108          MOVE SPACE              TO NO-BILL-REC-SW
  8109          GO TO 3930-EXIT
  8110      ELSE
  8111          GO TO 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 160
* EL640.cbl
  8112
  8113 3930-BILL-NOTOPEN.
  8114     MOVE ER-2564                TO EMI-ERROR.
  8115     MOVE -1 TO APFNTERL.
  8116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8117     GO TO 8200-SEND-DATAONLY.
  8118
  8119 3930-BILL-NOTFND.
  8120     MOVE 'Y'                    TO NO-BILL-REC-SW.
  8121
  8122 3930-EXIT.
  8123     EXIT.
  8124
  8125 3940-BILL-GENERIC-DELETE.
  8126
  8127* EXEC CICS HANDLE CONDITION
  8128*        NOTFND (3940-EXIT)
  8129*    END-EXEC.
  8130*    MOVE '"$I                   ! % #00007945' TO DFHEIV0
  8131     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8133     MOVE X'2520233030303037393435' TO DFHEIV0(25:11)
  8134     CALL 'kxdfhei1' USING DFHEIV0
  8135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8136
  8137
  8138     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8139     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8140     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8141     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8142
  8143     IF ST-ACCNT-CNTL OR ACCNT-CNTL
  8144        MOVE ZEROS               TO ERBILL-CARRIER
  8145                                    ERBILL-GROUP.
  8146
  8147     IF CARR-ST-ACCNT-CNTL OR CARR-ACCNT-CNTL
  8148        MOVE ZEROS               TO ERBILL-GROUP.
  8149
  8150
  8151* EXEC CICS DELETE
  8152*        DATASET   (ERBILL-FILE-ID)
  8153*        RIDFLD    (ERBILL-KEY)
  8154*        KEYLENGTH (18)
  8155*        GENERIC
  8156*    END-EXEC.
  8157     MOVE 18
  8158       TO DFHEIV11
  8159*    MOVE '&(  RKG               &   #00007961' TO DFHEIV0
  8160     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8161     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8162     MOVE X'2020233030303037393631' TO DFHEIV0(25:11)
  8163     CALL 'kxdfhei1' USING DFHEIV0,
  8164           ERBILL-FILE-ID,
  8165           ERBILL-KEY,
  8166           DFHEIV11,
  8167           DFHEIV99,
  8168           DFHEIV99
  8169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 161
* EL640.cbl
  8170
  8171
  8172 3940-EXIT.
  8173     EXIT.
  8174
  8175 3990-EXIT.
  8176     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 162
* EL640.cbl
  8178******************************************************************
  8179*                                                                *
  8180*   ALL I/O FOR THE VARIOUS FILES OTHER THAN THE COMPENSATION    *
  8181*   MASTER IS DONE IN THE FOLLOWING SECTIONS BEGINNING WITH 4XXX *
  8182*   WERE THE XXX INDICATES NUMERIC VALUES.                       *
  8183*                                                                *
  8184******************************************************************
  8185 4000-PNDB-START-BROWSE.
  8186     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD-A1.
  8187     MOVE PI-SAV-CARR            TO ERPNDB-CARR
  8188     MOVE PI-SAV-GROUP           TO ERPNDB-GROUP.
  8189     MOVE PI-SAV-STATE           TO ERPNDB-STATE.
  8190     MOVE PI-SAV-ACCT            TO ERPNDB-ACCT.
  8191     MOVE LOW-VALUES             TO ERPNDB-CERT.
  8192
  8193
  8194* EXEC CICS HANDLE CONDITION
  8195*        NOTFND (4010-REC-NOT-FND)
  8196*    END-EXEC.
  8197*    MOVE '"$I                   ! & #00007989' TO DFHEIV0
  8198     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8200     MOVE X'2620233030303037393839' TO DFHEIV0(25:11)
  8201     CALL 'kxdfhei1' USING DFHEIV0
  8202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8203
  8204
  8205
  8206* EXEC CICS STARTBR
  8207*        DATASET(ERPNDB-ALT-FILE-ID)
  8208*        RIDFLD (ERPNDB-ALT-KEY)
  8209*        GTEQ
  8210*    END-EXEC.
  8211     MOVE 0
  8212       TO DFHEIV11
  8213*    MOVE '&,         G          &   #00007993' TO DFHEIV0
  8214     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8215     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8216     MOVE X'2020233030303037393933' TO DFHEIV0(25:11)
  8217     CALL 'kxdfhei1' USING DFHEIV0,
  8218           ERPNDB-ALT-FILE-ID,
  8219           ERPNDB-ALT-KEY,
  8220           DFHEIV99,
  8221           DFHEIV11,
  8222           DFHEIV99
  8223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8224
  8225
  8226     GO TO 4090-EXIT.
  8227
  8228 4010-REC-NOT-FND.
  8229     MOVE 'Y'                    TO PNDB-EOF-SW.
  8230
  8231 4090-EXIT.
  8232     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 163
* EL640.cbl
  8234 4100-PNDB-READ-NEXT.
  8235
  8236* EXEC CICS HANDLE CONDITION
  8237*        ENDFILE (4110-END-OF-FILE)
  8238*    END-EXEC.
  8239*    MOVE '"$''                   ! '' #00008008' TO DFHEIV0
  8240     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8242     MOVE X'2720233030303038303038' TO DFHEIV0(25:11)
  8243     CALL 'kxdfhei1' USING DFHEIV0
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8245
  8246
  8247
  8248* EXEC CICS READNEXT
  8249*        SET     (ADDRESS OF PENDING-BUSINESS)
  8250*        DATASET (ERPNDB-ALT-FILE-ID)
  8251*        RIDFLD  (ERPNDB-ALT-KEY)
  8252*    END-EXEC.
  8253     MOVE 0
  8254       TO DFHEIV11
  8255*    MOVE '&.S                   )   #00008012' TO DFHEIV0
  8256     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8257     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8258     MOVE X'2020233030303038303132' TO DFHEIV0(25:11)
  8259     CALL 'kxdfhei1' USING DFHEIV0,
  8260           ERPNDB-ALT-FILE-ID,
  8261           DFHEIV20,
  8262           DFHEIV99,
  8263           ERPNDB-ALT-KEY,
  8264           DFHEIV99,
  8265           DFHEIV11,
  8266           DFHEIV99,
  8267           DFHEIV99
  8268     SET ADDRESS OF PENDING-BUSINESS TO
  8269         DFHEIV20
  8270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8271
  8272
  8273     GO TO 4190-EXIT.
  8274
  8275 4110-END-OF-FILE.
  8276     MOVE 'Y'                    TO PNDB-EOF-SW.
  8277
  8278 4190-EXIT.
  8279     EXIT.
  8280
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 164
* EL640.cbl
  8282 4200-PNDB-REWRITE.
  8283     MOVE PB-COMPANY-CD          TO ERPNDB-CO-CD.
  8284     MOVE PB-ENTRY-BATCH         TO ERPNDB-BATCH.
  8285     MOVE PB-BATCH-SEQ-NO        TO ERPNDB-SEQ-NO.
  8286     MOVE PB-BATCH-CHG-SEQ-NO    TO ERPNDB-CHG-SEQ-NO.
  8287
  8288
  8289* EXEC CICS ENDBR
  8290*        DATASET (ERPNDB-ALT-FILE-ID)
  8291*    END-EXEC.
  8292     MOVE 0
  8293       TO DFHEIV11
  8294*    MOVE '&2                    $   #00008033' TO DFHEIV0
  8295     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8296     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8297     MOVE X'2020233030303038303333' TO DFHEIV0(25:11)
  8298     CALL 'kxdfhei1' USING DFHEIV0,
  8299           ERPNDB-ALT-FILE-ID,
  8300           DFHEIV11,
  8301           DFHEIV99
  8302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8303
  8304
  8305
  8306* EXEC CICS HANDLE CONDITION
  8307*        NOTFND   (4270-PNDB-NOTFIND)
  8308*        NOTOPEN  (4280-PNDB-FILE-NOTOPEN)
  8309*    END-EXEC.
  8310*    MOVE '"$IJ                  ! ( #00008037' TO DFHEIV0
  8311     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8313     MOVE X'2820233030303038303337' TO DFHEIV0(25:11)
  8314     CALL 'kxdfhei1' USING DFHEIV0
  8315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8316
  8317
  8318
  8319* EXEC CICS READ
  8320*        SET     (ADDRESS OF PENDING-BUSINESS)
  8321*        DATASET (ERPNDB-FILE-ID)
  8322*        RIDFLD  (ERPNDB-PRIME-KEY)
  8323*        UPDATE
  8324*    END-EXEC.
  8325*    MOVE '&"S        EU         (   #00008042' TO DFHEIV0
  8326     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8327     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8328     MOVE X'2020233030303038303432' TO DFHEIV0(25:11)
  8329     CALL 'kxdfhei1' USING DFHEIV0,
  8330           ERPNDB-FILE-ID,
  8331           DFHEIV20,
  8332           DFHEIV99,
  8333           ERPNDB-PRIME-KEY,
  8334           DFHEIV99,
  8335           DFHEIV99,
  8336           DFHEIV99
  8337     SET ADDRESS OF PENDING-BUSINESS TO
  8338         DFHEIV20
  8339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 165
* EL640.cbl
  8340
  8341
  8342     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  8343         MOVE 'R'                TO PB-BILLING-STATUS.
  8344
  8345     IF PI-VOID-BILL
  8346         MOVE LOW-VALUES         TO PB-BILLED-DT
  8347         MOVE ZEROS              TO PB-CHG-COUNT
  8348     ELSE
  8349         MOVE WS-CURRENT-DATE    TO PB-BILLED-DT.
  8350
  8351     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  8352     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8353     MOVE WS-CURRENT-DATE        TO PB-LAST-MAINT-DT.
  8354
  8355
  8356* EXEC CICS REWRITE
  8357*        DATASET (ERPNDB-FILE-ID)
  8358*        FROM    (PENDING-BUSINESS)
  8359*    END-EXEC.
  8360     MOVE LENGTH OF
  8361      PENDING-BUSINESS
  8362       TO DFHEIV11
  8363*    MOVE '&& L                  %   #00008062' TO DFHEIV0
  8364     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8365     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8366     MOVE X'2020233030303038303632' TO DFHEIV0(25:11)
  8367     CALL 'kxdfhei1' USING DFHEIV0,
  8368           ERPNDB-FILE-ID,
  8369           PENDING-BUSINESS,
  8370           DFHEIV11,
  8371           DFHEIV99
  8372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8373
  8374
  8375
  8376* EXEC CICS STARTBR
  8377*        DATASET (ERPNDB-ALT-FILE-ID)
  8378*        RIDFLD  (ERPNDB-ALT-KEY)
  8379*        GTEQ
  8380*    END-EXEC.
  8381     MOVE 0
  8382       TO DFHEIV11
  8383*    MOVE '&,         G          &   #00008067' TO DFHEIV0
  8384     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8385     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8386     MOVE X'2020233030303038303637' TO DFHEIV0(25:11)
  8387     CALL 'kxdfhei1' USING DFHEIV0,
  8388           ERPNDB-ALT-FILE-ID,
  8389           ERPNDB-ALT-KEY,
  8390           DFHEIV99,
  8391           DFHEIV11,
  8392           DFHEIV99
  8393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8394
  8395
  8396     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  8397
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 166
* EL640.cbl
  8398     GO TO 4290-EXIT.
  8399
  8400 4270-PNDB-NOTFIND.
  8401     MOVE ER-2212                TO EMI-ERROR.
  8402     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8403     GO TO 4290-EXIT.
  8404
  8405 4280-PNDB-FILE-NOTOPEN.
  8406     MOVE -1                     TO ACARIERL.
  8407     MOVE ER-2210                TO EMI-ERROR.
  8408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8409
  8410 4290-EXIT.
  8411     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 167
* EL640.cbl
  8413 4300-READ-ACCOUNT-MASTER.
  8414     MOVE PI-COMPANY-CD          TO ERACCT-A-CO-CD.
  8415     MOVE PI-SAV-CARR            TO ERACCT-A-CARRIER.
  8416     MOVE PI-SAV-GROUP           TO ERACCT-A-GROUPING.
  8417     MOVE PI-SAV-STATE           TO ERACCT-A-STATE.
  8418     MOVE PI-SAV-ACCT            TO ERACCT-A-ACCOUNT.
  8419     MOVE PI-SAV-EXP-DT          TO ERACCT-A-EXP-DATE.
  8420
  8421     MOVE SPACES                 TO WS-AM-ZIP.
  8422
  8423
  8424* EXEC CICS HANDLE CONDITION
  8425*        NOTFND   (4370-ACCOUNT-INVALID)
  8426*        NOTOPEN  (4380-ACCT-FILE-NOTOPEN)
  8427*    END-EXEC.
  8428*    MOVE '"$IJ                  ! ) #00008100' TO DFHEIV0
  8429     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8431     MOVE X'2920233030303038313030' TO DFHEIV0(25:11)
  8432     CALL 'kxdfhei1' USING DFHEIV0
  8433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8434
  8435
  8436
  8437* EXEC CICS READ
  8438*        DATASET   (ERACCT-ALT-FILE-ID)
  8439*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8440*        RIDFLD    (ERACCT-ALT-KEY)
  8441*        GTEQ
  8442*    END-EXEC.
  8443*    MOVE '&"S        G          (   #00008105' TO DFHEIV0
  8444     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8445     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8446     MOVE X'2020233030303038313035' TO DFHEIV0(25:11)
  8447     CALL 'kxdfhei1' USING DFHEIV0,
  8448           ERACCT-ALT-FILE-ID,
  8449           DFHEIV20,
  8450           DFHEIV99,
  8451           ERACCT-ALT-KEY,
  8452           DFHEIV99,
  8453           DFHEIV99,
  8454           DFHEIV99
  8455     SET ADDRESS OF ACCOUNT-MASTER TO
  8456         DFHEIV20
  8457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8458
  8459
  8460     IF AM-CANADIAN-POST-CODE
  8461         MOVE AM-CAN-POSTAL-1    TO WS-AM-CAN-POST-1
  8462         MOVE AM-CAN-POSTAL-2    TO WS-AM-CAN-POST-2
  8463     ELSE
  8464         MOVE AM-ZIP-PRIME       TO WS-AM-ZIP-PRIME
  8465         IF AM-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  8466             MOVE '-'            TO WS-AM-ZIP-DASH
  8467             MOVE AM-ZIP-PLUS4   TO WS-AM-ZIP-PLUS4.
  8468
  8469     IF AM-REMIT-TO NOT NUMERIC
  8470         MOVE +00 TO AM-REMIT-TO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 168
* EL640.cbl
  8471
  8472     IF AM-REMIT-TO = ZEROS
  8473         MOVE ER-2385            TO EMI-ERROR
  8474         MOVE -1                 TO AACCTL
  8475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8476
  8477     MOVE AM-CARRIER             TO PI-CARRIER.
  8478     MOVE AM-GROUPING            TO PI-GROUPING.
  8479     MOVE AM-STATE               TO PI-STATE.
  8480     MOVE AM-ACCOUNT             TO PI-ACCOUNT.
  8481
  8482     MOVE AM-AGT (AM-REMIT-TO)   TO PI-COMP-FIN-RESP.
  8483
  8484     IF PI-ZERO-CARRIER  OR
  8485        PI-ZERO-CAR-GROUP
  8486         MOVE ZEROS              TO PI-COMP-CARRIER
  8487     ELSE
  8488         MOVE AM-CARRIER         TO PI-COMP-CARRIER.
  8489
  8490     IF PI-ZERO-GROUPING  OR
  8491        PI-ZERO-CAR-GROUP
  8492         MOVE ZEROS              TO PI-COMP-GROUPING
  8493     ELSE
  8494         MOVE AM-GROUPING        TO PI-COMP-GROUPING.
  8495
  8496     IF CARR-GROUP-ST-ACCNT-CNTL
  8497         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8498         MOVE AM-GROUPING        TO PI-CR-GROUPING
  8499         MOVE AM-STATE           TO PI-CR-STATE.
  8500
  8501     IF ST-ACCNT-CNTL
  8502         MOVE ZEROS              TO PI-CR-CARRIER
  8503                                    PI-CR-GROUPING
  8504         MOVE AM-STATE           TO PI-CR-STATE.
  8505
  8506     IF CARR-ST-ACCNT-CNTL
  8507         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8508         MOVE ZEROS              TO PI-CR-GROUPING
  8509         MOVE AM-STATE           TO PI-CR-STATE.
  8510
  8511     IF ACCNT-CNTL
  8512         MOVE ZEROS              TO PI-CR-CARRIER
  8513                                    PI-CR-GROUPING
  8514                                    PI-CR-STATE.
  8515
  8516     IF CARR-ACCNT-CNTL
  8517         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8518         MOVE ZEROS              TO PI-CR-GROUPING
  8519                                    PI-CR-STATE.
  8520
  8521     MOVE AM-EXPIRATION-DT       TO ERACCT-A-EXP-DATE.
  8522
  8523     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8524         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8525     ELSE
  8526         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8527
  8528     IF PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 169
* EL640.cbl
  8529         MOVE AM-EXPIRATION-DT   TO WS-SAV-EXP-DT (DTNDX)
  8530         IF DTNDX < 10
  8531             SET DTNDX UP BY 1
  8532             GO TO 4390-EXIT
  8533         ELSE
  8534             GO TO 4390-EXIT.
  8535
  8536     IF PI-COMPANY-CD = AM-COMPANY-CD-A1 AND
  8537        PI-SAV-CARR   = AM-VG-CARRIER    AND
  8538        PI-SAV-GROUP  = AM-VG-GROUPING   AND
  8539        PI-SAV-STATE  = AM-VG-STATE      AND
  8540        PI-SAV-ACCT   = AM-VG-ACCOUNT
  8541          NEXT SENTENCE
  8542     ELSE
  8543          GO TO 4370-ACCOUNT-INVALID.
  8544
  8545     IF PI-GA-BILLING
  8546         NEXT SENTENCE
  8547     ELSE
  8548         GO TO 4390-EXIT.
  8549
  8550     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8551         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8552     ELSE
  8553         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8554
  8555     GO TO 4390-EXIT.
  8556
  8557 4370-ACCOUNT-INVALID.
  8558     MOVE -1                     TO AACCTL.
  8559
  8560     MOVE SPACES                 TO PI-CARRIER
  8561                                    PI-GROUPING
  8562                                    PI-STATE
  8563                                    PI-ACCOUNT.
  8564
  8565     IF CARR-GROUP-ST-ACCNT-CNTL
  8566         MOVE AL-UABON           TO ACARIERA
  8567                                    AGROUPA
  8568                                    ASTATEA
  8569                                    AACCTA
  8570     ELSE
  8571         IF ST-ACCNT-CNTL
  8572             MOVE AL-UABON       TO ASTATEA
  8573                                    AACCTA
  8574         ELSE
  8575             IF CARR-ST-ACCNT-CNTL
  8576                 MOVE AL-UABON   TO ACARIERA
  8577                                    ASTATEA
  8578                                    AACCTA
  8579             ELSE
  8580                 IF ACCNT-CNTL
  8581                     MOVE AL-UABON
  8582                                 TO AACCTA
  8583                 ELSE
  8584                     MOVE AL-UABON
  8585                                 TO ACARIERA
  8586                                    AACCTA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 170
* EL640.cbl
  8587
  8588     MOVE ER-2210                TO EMI-ERROR.
  8589     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8590     GO TO 4390-EXIT.
  8591
  8592 4380-ACCT-FILE-NOTOPEN.
  8593     MOVE -1                     TO ACARIERL.
  8594     MOVE ER-2215                TO EMI-ERROR.
  8595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8596
  8597 4390-EXIT.
  8598     EXIT.
  8599
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 171
* EL640.cbl
  8601 4400-ERACCT-REWRITE.
  8602     IF NOT PI-VOID-BILL
  8603         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8604         MOVE AM-COMPANY-CD      TO ERACCT-P-CO-CD
  8605         MOVE AM-CARRIER         TO ERACCT-P-CARRIER
  8606         MOVE AM-GROUPING        TO ERACCT-P-GROUPING
  8607         MOVE AM-STATE           TO ERACCT-P-STATE
  8608         MOVE AM-ACCOUNT         TO ERACCT-P-ACCOUNT
  8609         MOVE AM-EXPIRATION-DT   TO ERACCT-P-EXP-DATE
  8610     ELSE
  8611         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8612         MOVE PI-COMPANY-CD      TO ERACCT-P-CO-CD
  8613         MOVE PI-CARRIER         TO ERACCT-P-CARRIER
  8614         MOVE PI-GROUPING        TO ERACCT-P-GROUPING
  8615         MOVE PI-STATE           TO ERACCT-P-STATE
  8616         MOVE PI-SAV-ACCT        TO ERACCT-P-ACCOUNT
  8617         MOVE PI-SAV-EXP-DT      TO ERACCT-P-EXP-DATE.
  8618
  8619
  8620* EXEC CICS HANDLE CONDITION
  8621*        NOTFND   (4470-ACCOUNT-INVALID)
  8622*        NOTOPEN  (4480-ACCT-FILE-NOTOPEN)
  8623*    END-EXEC.
  8624*    MOVE '"$IJ                  ! * #00008271' TO DFHEIV0
  8625     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8627     MOVE X'2A20233030303038323731' TO DFHEIV0(25:11)
  8628     CALL 'kxdfhei1' USING DFHEIV0
  8629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8630
  8631
  8632
  8633* EXEC CICS READ
  8634*        DATASET   (ERACCT-FILE-ID)
  8635*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8636*        RIDFLD    (ERACCT-PRIME-KEY)
  8637*        UPDATE
  8638*    END-EXEC.
  8639*    MOVE '&"S        EU         (   #00008276' TO DFHEIV0
  8640     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8641     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8642     MOVE X'2020233030303038323736' TO DFHEIV0(25:11)
  8643     CALL 'kxdfhei1' USING DFHEIV0,
  8644           ERACCT-FILE-ID,
  8645           DFHEIV20,
  8646           DFHEIV99,
  8647           ERACCT-PRIME-KEY,
  8648           DFHEIV99,
  8649           DFHEIV99,
  8650           DFHEIV99
  8651     SET ADDRESS OF ACCOUNT-MASTER TO
  8652         DFHEIV20
  8653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8654
  8655
  8656     IF PI-VOID-BILL
  8657         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO.
  8658
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 172
* EL640.cbl
  8659     IF PI-VOID-BILL
  8660         MOVE SPACE              TO AM-BILLING-STATUS
  8661     ELSE
  8662         MOVE 'B'                TO AM-BILLING-STATUS.
  8663
  8664     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  8665     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  8666     MOVE WS-CURRENT-DATE        TO AM-LAST-MAINT-DT.
  8667
  8668
  8669* EXEC CICS REWRITE
  8670*        DATASET (ERACCT-FILE-ID)
  8671*        FROM    (ACCOUNT-MASTER)
  8672*    END-EXEC.
  8673     MOVE LENGTH OF
  8674      ACCOUNT-MASTER
  8675       TO DFHEIV11
  8676*    MOVE '&& L                  %   #00008295' TO DFHEIV0
  8677     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8678     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8679     MOVE X'2020233030303038323935' TO DFHEIV0(25:11)
  8680     CALL 'kxdfhei1' USING DFHEIV0,
  8681           ERACCT-FILE-ID,
  8682           ACCOUNT-MASTER,
  8683           DFHEIV11,
  8684           DFHEIV99
  8685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8686
  8687
  8688     GO TO 4490-EXIT.
  8689
  8690 4470-ACCOUNT-INVALID.
  8691     MOVE -1                     TO AACCTL.
  8692
  8693     MOVE SPACES                 TO PI-CARRIER
  8694                                    PI-GROUPING
  8695                                    PI-STATE
  8696                                    PI-ACCOUNT.
  8697
  8698     IF CARR-GROUP-ST-ACCNT-CNTL
  8699         MOVE AL-UABON           TO ACARIERA
  8700                                    AGROUPA
  8701                                    ASTATEA
  8702                                    AACCTA
  8703     ELSE
  8704         IF ST-ACCNT-CNTL
  8705             MOVE AL-UABON       TO ASTATEA
  8706                                    AACCTA
  8707         ELSE
  8708             IF CARR-ST-ACCNT-CNTL
  8709                 MOVE AL-UABON   TO ACARIERA
  8710                                    ASTATEA
  8711                                    AACCTA
  8712             ELSE
  8713                 IF ACCNT-CNTL
  8714                     MOVE AL-UABON
  8715                                 TO AACCTA
  8716                 ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 173
* EL640.cbl
  8717                     MOVE AL-UABON
  8718                                 TO ACARIERA
  8719                                    AACCTA.
  8720
  8721     MOVE ER-2210                TO EMI-ERROR.
  8722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8723     GO TO 4490-EXIT.
  8724
  8725 4480-ACCT-FILE-NOTOPEN.
  8726     MOVE -1                     TO ACARIERL.
  8727     MOVE ER-2215                TO EMI-ERROR.
  8728     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8729
  8730 4490-EXIT.
  8731     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 174
* EL640.cbl
  8733
  8734 4500-PYAJ-START-BROWSE.
  8735     MOVE PI-COMPANY-CD          TO ERPYAJ-COMP-CD.
  8736
  8737     IF NOT PI-ZERO-CARRIER  AND
  8738        NOT PI-ZERO-CAR-GROUP
  8739         MOVE PI-COMP-CARRIER    TO ERPYAJ-CARRIER
  8740     ELSE
  8741         MOVE ZEROS              TO ERPYAJ-CARRIER.
  8742
  8743     IF NOT PI-ZERO-GROUPING  AND
  8744        NOT PI-ZERO-CAR-GROUP
  8745         MOVE PI-COMP-GROUPING   TO ERPYAJ-GROUPING
  8746     ELSE
  8747         MOVE ZEROS              TO ERPYAJ-GROUPING.
  8748
  8749     MOVE PI-SAV-REMIT-TO        TO ERPYAJ-FIN-RESP.
  8750     MOVE PI-SAV-ACCT            TO ERPYAJ-ACCOUNT.
  8751
  8752     IF PI-SAV-REMIT-TO = SPACES
  8753         MOVE PI-SAV-ACCT        TO PI-SAV-REMIT-TO
  8754                                    ERPYAJ-FIN-RESP.
  8755
  8756     MOVE LOW-VALUES             TO ERPYAJ-RECORD-TYPE.
  8757     MOVE ERPYAJ-KEY             TO ERPYAJ-BROWSE-COMP-KEY.
  8758
  8759
  8760* EXEC CICS HANDLE CONDITION
  8761*        NOTFND (4510-REC-NOT-FND)
  8762*    END-EXEC.
  8763*    MOVE '"$I                   ! + #00008371' TO DFHEIV0
  8764     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8766     MOVE X'2B20233030303038333731' TO DFHEIV0(25:11)
  8767     CALL 'kxdfhei1' USING DFHEIV0
  8768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8769
  8770
  8771
  8772* EXEC CICS STARTBR
  8773*        DATASET(ERPYAJ-FILE-ID)
  8774*        RIDFLD (ERPYAJ-KEY)
  8775*        GTEQ
  8776*    END-EXEC.
  8777     MOVE 0
  8778       TO DFHEIV11
  8779*    MOVE '&,         G          &   #00008375' TO DFHEIV0
  8780     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8781     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8782     MOVE X'2020233030303038333735' TO DFHEIV0(25:11)
  8783     CALL 'kxdfhei1' USING DFHEIV0,
  8784           ERPYAJ-FILE-ID,
  8785           ERPYAJ-KEY,
  8786           DFHEIV99,
  8787           DFHEIV11,
  8788           DFHEIV99
  8789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8790
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 175
* EL640.cbl
  8791
  8792     GO TO 4590-EXIT.
  8793
  8794 4510-REC-NOT-FND.
  8795     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8796
  8797 4590-EXIT.
  8798     EXIT.
  8799
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 176
* EL640.cbl
  8801 4600-PYAJ-READ-NEXT.
  8802
  8803* EXEC CICS HANDLE CONDITION
  8804*        ENDFILE (4610-END-OF-FILE)
  8805*    END-EXEC.
  8806*    MOVE '"$''                   ! , #00008391' TO DFHEIV0
  8807     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8809     MOVE X'2C20233030303038333931' TO DFHEIV0(25:11)
  8810     CALL 'kxdfhei1' USING DFHEIV0
  8811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8812
  8813
  8814
  8815* EXEC CICS READNEXT
  8816*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8817*        DATASET (ERPYAJ-FILE-ID)
  8818*        RIDFLD  (ERPYAJ-KEY)
  8819*    END-EXEC.
  8820     MOVE 0
  8821       TO DFHEIV11
  8822*    MOVE '&.S                   )   #00008395' TO DFHEIV0
  8823     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8824     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8825     MOVE X'2020233030303038333935' TO DFHEIV0(25:11)
  8826     CALL 'kxdfhei1' USING DFHEIV0,
  8827           ERPYAJ-FILE-ID,
  8828           DFHEIV20,
  8829           DFHEIV99,
  8830           ERPYAJ-KEY,
  8831           DFHEIV99,
  8832           DFHEIV11,
  8833           DFHEIV99,
  8834           DFHEIV99
  8835     SET ADDRESS OF PENDING-PAY-ADJ TO
  8836         DFHEIV20
  8837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8838
  8839
  8840     GO TO 4690-EXIT.
  8841
  8842 4610-END-OF-FILE.
  8843     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8844
  8845 4690-EXIT.
  8846     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 177
* EL640.cbl
  8848 4700-PYAJ-REWRITE.
  8849
  8850* EXEC CICS READ
  8851*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8852*        DATASET (ERPYAJ-FILE-ID)
  8853*        RIDFLD  (ERPYAJ-KEY)
  8854*        UPDATE
  8855*    END-EXEC.
  8856*    MOVE '&"S        EU         (   #00008410' TO DFHEIV0
  8857     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8858     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8859     MOVE X'2020233030303038343130' TO DFHEIV0(25:11)
  8860     CALL 'kxdfhei1' USING DFHEIV0,
  8861           ERPYAJ-FILE-ID,
  8862           DFHEIV20,
  8863           DFHEIV99,
  8864           ERPYAJ-KEY,
  8865           DFHEIV99,
  8866           DFHEIV99,
  8867           DFHEIV99
  8868     SET ADDRESS OF PENDING-PAY-ADJ TO
  8869         DFHEIV20
  8870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8871
  8872
  8873     IF PI-VOID-BILL
  8874         MOVE LOW-VALUES         TO PY-BILLED-DATE
  8875                                    PY-AR-DATE
  8876         IF ACCOUNT-NOT-FIN-RESP
  8877             IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  8878                 PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  8879                 PY-ADD-TO-BALANCE
  8880                 ADD PY-ENTRY-AMT  TO  PI-REMITTED
  8881             ELSE
  8882                 IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  8883                    AND PY-BILLING-CHECK
  8884                    ADD PY-ENTRY-AMT TO PI-DISBURSED
  8885                 ELSE
  8886                     ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS
  8887         ELSE
  8888             NEXT SENTENCE
  8889     ELSE
  8890         MOVE WS-CURRENT-DATE    TO PY-BILLED-DATE.
  8891
  8892     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8893     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8894     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT.
  8895
  8896
  8897* EXEC CICS REWRITE
  8898*        DATASET (ERPYAJ-FILE-ID)
  8899*        FROM    (PENDING-PAY-ADJ)
  8900*    END-EXEC.
  8901     MOVE LENGTH OF
  8902      PENDING-PAY-ADJ
  8903       TO DFHEIV11
  8904*    MOVE '&& L                  %   #00008440' TO DFHEIV0
  8905     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 178
* EL640.cbl
  8906     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8907     MOVE X'2020233030303038343430' TO DFHEIV0(25:11)
  8908     CALL 'kxdfhei1' USING DFHEIV0,
  8909           ERPYAJ-FILE-ID,
  8910           PENDING-PAY-ADJ,
  8911           DFHEIV11,
  8912           DFHEIV99
  8913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8914
  8915
  8916 4790-EXIT.
  8917     EXIT.
  8918
  8919 4800-PYAJ-END-BROWSE.
  8920
  8921* EXEC CICS ENDBR
  8922*        DATASET (ERPYAJ-FILE-ID)
  8923*    END-EXEC.
  8924     MOVE 0
  8925       TO DFHEIV11
  8926*    MOVE '&2                    $   #00008449' TO DFHEIV0
  8927     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8928     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8929     MOVE X'2020233030303038343439' TO DFHEIV0(25:11)
  8930     CALL 'kxdfhei1' USING DFHEIV0,
  8931           ERPYAJ-FILE-ID,
  8932           DFHEIV11,
  8933           DFHEIV99
  8934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8935
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 179
* EL640.cbl
  8937 5000-FORMAT-SCREEN.
  8938*                **********************************************
  8939*                *  FORMAT THE BILLING TOTALS SCREEN (EL640A) *
  8940*                **********************************************
  8941     MOVE LOW-VALUES             TO EL640AO.
  8942
  8943     IF PI-SAV-ACCT > SPACES
  8944        MOVE PI-SAV-ACCT         TO AACCTO
  8945        MOVE PI-SAV-CARR         TO ACARIERO
  8946        MOVE PI-SAV-GROUP        TO AGROUPO
  8947        MOVE PI-SAV-STATE        TO ASTATEO.
  8948
  8949     MOVE PI-BILL-TYPE           TO ABILTYPI.
  8950     MOVE PI-BILL-ERRS           TO ABILERRI.
  8951     MOVE AL-UANON               TO AACCTA
  8952                                    ACARIERA
  8953                                    AGROUPA
  8954                                    ASTATEA
  8955                                    ABILTYPA
  8956                                    ABILERRA.
  8957
  8958     IF ACCOUNT-NOT-FIN-RESP
  8959         MOVE ER-2539            TO EMI-ERROR
  8960         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8961
  8962     IF PI-BILLING-BATCHES (1) NOT = SPACES
  8963         MOVE PI-BILLING-BATCHES (1) TO ABTCH1I
  8964         MOVE AL-UANON               TO ABTCH1A.
  8965
  8966     IF PI-BILLING-BATCHES (2) NOT = SPACES
  8967         MOVE PI-BILLING-BATCHES (2) TO ABTCH2I
  8968         MOVE AL-UANON               TO ABTCH2A.
  8969
  8970     IF PI-BILLING-BATCHES (3) NOT = SPACES
  8971         MOVE PI-BILLING-BATCHES (3) TO ABTCH3I
  8972         MOVE AL-UANON               TO ABTCH3A.
  8973
  8974     SET ANDX  PINDX            TO 1.
  8975
  8976 5005-FORMAT-LOOP.
  8977     IF PI-BATCH (PINDX) NOT = SPACES
  8978         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  8979         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  8980         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  8981         MOVE PI-PREV   (PINDX)  TO PREV   (ANDX)
  8982         SET ANDX PINDX UP BY 1
  8983         IF ANDX > 6
  8984             NEXT SENTENCE
  8985         ELSE
  8986             GO TO 5005-FORMAT-LOOP.
  8987
  8988     IF MORE-THAN-6-BATCHES
  8989         MOVE ER-2472            TO EMI-ERROR
  8990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8991         MOVE ZEROS              TO EMI-ERROR.
  8992
  8993     IF NOT PI-DATA-BILLED
  8994         IF RETURNED-FROM NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 180
* EL640.cbl
  8995             GO TO 5080-CONT
  8996         ELSE
  8997             MOVE ER-2409        TO EMI-ERROR
  8998             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8999             GO TO 5090-EXIT.
  9000
  9001     MOVE PI-BAL-FRWD            TO ABALFWDO.
  9002     MOVE PI-PREMIUM             TO APREMUMO.
  9003     MOVE PI-REMITTED            TO AREMITO.
  9004     MOVE PI-TOT-ISS-COMP        TO ACOMPISO.
  9005     MOVE PI-TOT-CAN-COMP        TO ACOMCANO.
  9006     COMPUTE PI-ADJUSTMENTS  =   PI-ADJUSTMENTS  +
  9007                                 TOT-REPT-CANCEL-FEE.
  9008     MOVE PI-ADJUSTMENTS         TO AADJUSTO.
  9009     MOVE PI-DISBURSED           TO ADISBURO.
  9010
  9011     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  9012                          PI-PREMIUM -
  9013                          PI-REMITTED -
  9014                          PI-TOT-ISS-COMP +
  9015                          PI-TOT-CAN-COMP +
  9016                          PI-ADJUSTMENTS +
  9017                          PI-DISBURSED.
  9018
  9019     MOVE PI-END-BAL             TO ANETDUEO.
  9020
  9021     IF PI-END-BAL NEGATIVE
  9022         MOVE OWED-TO-AGENT      TO AENDHDGO
  9023     ELSE
  9024         IF PI-END-BAL > ZERO
  9025             MOVE AGENT-OWES     TO AENDHDGO
  9026         ELSE
  9027             MOVE 'BALANCE          =' TO AENDHDGO.
  9028
  9029 5080-CONT.
  9030     IF RETURNED-FROM NOT = SPACES
  9031         IF (RETURNED-FROM NOT = XCTL-6401)  AND
  9032             (PI-CR-FIN-RESP NOT = SPACES)
  9033               MOVE ER-2421        TO EMI-ERROR
  9034               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9035               MOVE ZEROS          TO EMI-ERROR
  9036         ELSE
  9037             NEXT SENTENCE
  9038     ELSE
  9039         IF PI-BILL OR PI-REBILLING
  9040             MOVE 'Y'            TO COMP-UPDATE-SW
  9041             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9042             MOVE 'Y'            TO ELCNTL-UPDATE-SW
  9043             MOVE SPACES         TO ELCNTL-KEY
  9044             MOVE '1'            TO ELCNTL-REC-TYPE
  9045             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9046             MOVE WS-CURRENT-DATE TO CF-ACCOUNT-MSTR-MAINT-DT
  9047                                     CF-COMPENSATION-MSTR-MAINT-DT
  9048             PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT.
  9049
  9050 5090-EXIT.
  9051     EXIT.
  9052
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 181
* EL640.cbl
  9054 6000-READ-COMP-MASTER.
  9055
  9056* EXEC CICS HANDLE CONDITION
  9057*        NOTFND   (6070-NO-COMP-MSTR)
  9058*        NOTOPEN  (6080-COMP-FILE-NOTOPEN)
  9059*    END-EXEC.
  9060*    MOVE '"$IJ                  ! - #00008571' TO DFHEIV0
  9061     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9063     MOVE X'2D20233030303038353731' TO DFHEIV0(25:11)
  9064     CALL 'kxdfhei1' USING DFHEIV0
  9065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9066
  9067
  9068     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9069     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9070     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9071     MOVE PI-COMP-FIN-RESP       TO ERCOMP-FIN-RESP.
  9072
  9073     MOVE SPACES                 TO WS-CO-ZIP.
  9074
  9075     IF EIBAID = DFHPF5
  9076         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9077         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9078     ELSE
  9079         MOVE PI-SAV-ACCT        TO ERCOMP-ACCT
  9080         MOVE 'A'                TO ERCOMP-RECORD-TYPE.
  9081
  9082 6001-READ.
  9083     IF UPDATE-COMP-TOTALS OR PI-VOID-BILL
  9084
  9085* EXEC CICS READ
  9086*            DATASET   (ERCOMP-FILE-ID)
  9087*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9088*            RIDFLD    (ERCOMP-KEY)
  9089*            UPDATE
  9090*        END-EXEC
  9091*    MOVE '&"S        EU         (   #00008592' TO DFHEIV0
  9092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9093     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9094     MOVE X'2020233030303038353932' TO DFHEIV0(25:11)
  9095     CALL 'kxdfhei1' USING DFHEIV0,
  9096           ERCOMP-FILE-ID,
  9097           DFHEIV20,
  9098           DFHEIV99,
  9099           ERCOMP-KEY,
  9100           DFHEIV99,
  9101           DFHEIV99,
  9102           DFHEIV99
  9103     SET ADDRESS OF COMPENSATION-MASTER TO
  9104         DFHEIV20
  9105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9106     ELSE
  9107
  9108* EXEC CICS READ
  9109*            DATASET   (ERCOMP-FILE-ID)
  9110*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9111*            RIDFLD    (ERCOMP-KEY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 182
* EL640.cbl
  9112*        END-EXEC.
  9113*    MOVE '&"S        E          (   #00008599' TO DFHEIV0
  9114     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9115     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9116     MOVE X'2020233030303038353939' TO DFHEIV0(25:11)
  9117     CALL 'kxdfhei1' USING DFHEIV0,
  9118           ERCOMP-FILE-ID,
  9119           DFHEIV20,
  9120           DFHEIV99,
  9121           ERCOMP-KEY,
  9122           DFHEIV99,
  9123           DFHEIV99,
  9124           DFHEIV99
  9125     SET ADDRESS OF COMPENSATION-MASTER TO
  9126         DFHEIV20
  9127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9128
  9129
  9130     IF CO-CANADIAN-POST-CODE
  9131         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9132         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9133     ELSE
  9134         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9135         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9136             MOVE '-'            TO WS-CO-ZIP-DASH
  9137             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9138
  9139 6002-CONTINUE.
  9140     IF EIBAID = DFHPF5
  9141         GO TO 6090-EXIT.
  9142
  9143     IF FIRST-TIME
  9144        MOVE CO-MAIL-NAME        TO WS-ACCT-LINES (1)
  9145        MOVE CO-ACCT-NAME        TO WS-ACCT-LINES (2)
  9146        MOVE CO-ADDR-1           TO WS-ACCT-LINES (3)
  9147        MOVE CO-ADDR-2           TO WS-ACCT-LINES (4)
  9148        MOVE CO-ADDR-3           TO WS-ACCT-LINES (5)
  9149        MOVE WS-CO-ZIP           TO WS-ACCT-LINES (6)
  9150        PERFORM 6400-FORMAT-ACCOUNT-ADDRS THRU 6490-EXIT.
  9151
  9152     IF PI-VOID-BILL
  9153         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9154         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9155         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9156         IF ACCOUNT-FIN-RESP
  9157             MOVE CO-MONTHLY-TOTALS TO CO-CURRENT-MONTHLY-TOTALS
  9158             MOVE CO-AGING-TOTALS   TO CO-CURRENT-AGING-TOTALS
  9159             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9160             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9161             PERFORM 6060-ERCOMP-REWRITE
  9162             GO TO 6090-EXIT
  9163         ELSE
  9164             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9165             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9166             PERFORM 6060-ERCOMP-REWRITE
  9167             MOVE LOW-VALUES        TO ERCOMP-ACCT
  9168             MOVE 'G'               TO ERCOMP-RECORD-TYPE
  9169             PERFORM 6001-READ
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 183
* EL640.cbl
  9170             COMPUTE CO-CURRENT-CUR-CHG =
  9171                     CO-CURRENT-CUR-CHG - PI-PREMIUM
  9172             COMPUTE CO-CURRENT-CUR-COM =
  9173                     CO-CURRENT-CUR-COM - PI-TOT-ISS-COMP -
  9174                     PI-TOT-CAN-COMP
  9175             COMPUTE CO-CURRENT-CUR-PMT =
  9176                     CO-CURRENT-CUR-PMT - PI-REMITTED +
  9177                     PI-DISBURSED + PI-ADJUSTMENTS
  9178             COMPUTE CO-CURRENT-END-BAL =
  9179                     CO-CURRENT-BAL-FWD + CO-CURRENT-CUR-CHG -
  9180                     CO-CURRENT-CUR-COM - CO-CURRENT-CUR-PMT
  9181             MOVE CO-AGING-TOTALS   TO  CO-CURRENT-AGING-TOTALS
  9182             PERFORM 6050-AGING  THRU  6059-AGING-EXIT
  9183             IF CO-CURRENT-CUR-CHG = ZEROS AND
  9184                CO-CURRENT-CUR-COM = ZEROS AND
  9185                CO-CURRENT-CUR-PMT = ZEROS
  9186                 MOVE CO-LAST-STMT-DT TO CO-CURRENT-LAST-STMT-DT
  9187                 PERFORM 6060-ERCOMP-REWRITE
  9188                 GO TO 6090-EXIT
  9189             ELSE
  9190                 PERFORM 6060-ERCOMP-REWRITE
  9191                 GO TO 6090-EXIT.
  9192
  9193     IF UPDATE-COMP-TOTALS
  9194         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9195         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9196         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9197         IF ACCOUNT-FIN-RESP
  9198             IF NOT PI-CHECK-PRODUCED
  9199                 IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9200                     MOVE CO-CURRENT-END-BAL
  9201                                 TO CO-CURRENT-BAL-FWD
  9202                     COMPUTE CO-CURRENT-CUR-COM =
  9203                             CO-CURRENT-CUR-COM +
  9204                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9205                     COMPUTE CO-CURRENT-YTD-COM =
  9206                             CO-CURRENT-YTD-COM +
  9207                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9208                     COMPUTE CO-CURRENT-CUR-CHG =
  9209                             CO-CURRENT-CUR-CHG + PI-PREMIUM
  9210                     COMPUTE CO-CURRENT-CUR-PMT =
  9211                             CO-CURRENT-CUR-PMT +
  9212                             PI-REMITTED - PI-DISBURSED -
  9213                             PI-ADJUSTMENTS
  9214                     COMPUTE CO-CURRENT-END-BAL =
  9215                             CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9216                             PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9217                             PI-REMITTED + PI-DISBURSED +
  9218                             PI-ADJUSTMENTS
  9219                     PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9220                     PERFORM 6060-ERCOMP-REWRITE
  9221                     GO TO 6090-EXIT
  9222                ELSE
  9223                    MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9224                    MOVE PI-END-BAL         TO CO-CURRENT-END-BAL
  9225                    COMPUTE CO-CURRENT-CUR-COM =
  9226                            PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9227                    ADD CO-CURRENT-CUR-COM TO CO-CURRENT-YTD-COM
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 184
* EL640.cbl
  9228                    MOVE PI-PREMIUM        TO CO-CURRENT-CUR-CHG
  9229                    COMPUTE CO-CURRENT-CUR-PMT =
  9230                             PI-REMITTED - PI-DISBURSED -
  9231                             PI-ADJUSTMENTS
  9232                    PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9233                    MOVE WS-MONTH-END-DATE
  9234                                 TO CO-CURRENT-LAST-STMT-DT
  9235                    PERFORM 6060-ERCOMP-REWRITE
  9236                    GO TO 6090-EXIT
  9237             ELSE
  9238                 MOVE SPACE      TO PI-CHECK-SW
  9239                 MOVE PI-END-BAL TO CO-CURRENT-END-BAL
  9240                 COMPUTE CO-CURRENT-CUR-CHG = PI-PREMIUM +
  9241                         (PI-ADJUSTMENTS - PI-DISBURSED)
  9242                 PERFORM 6060-ERCOMP-REWRITE
  9243                 GO TO 6090-EXIT
  9244         ELSE
  9245             COMPUTE CO-CURRENT-YTD-COM =
  9246                     CO-CURRENT-YTD-COM + PI-TOT-ISS-COMP
  9247                                        - PI-TOT-CAN-COMP
  9248             PERFORM 6060-ERCOMP-REWRITE
  9249             MOVE LOW-VALUES    TO ERCOMP-ACCT
  9250             MOVE 'G'           TO ERCOMP-RECORD-TYPE
  9251             PERFORM 6001-READ
  9252             IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9253                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9254                 COMPUTE CO-CURRENT-CUR-COM =
  9255                         CO-CURRENT-CUR-COM +
  9256                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9257                 COMPUTE CO-CURRENT-CUR-CHG =
  9258                         CO-CURRENT-CUR-CHG + PI-PREMIUM
  9259                 COMPUTE CO-CURRENT-CUR-PMT =
  9260                         CO-CURRENT-CUR-PMT +
  9261                         PI-REMITTED - PI-DISBURSED -
  9262                         PI-ADJUSTMENTS
  9263                 COMPUTE CO-CURRENT-END-BAL =
  9264                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9265                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9266                         PI-REMITTED + PI-DISBURSED +
  9267                         PI-ADJUSTMENTS
  9268                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9269                 PERFORM 6060-ERCOMP-REWRITE
  9270                 GO TO 6090-EXIT
  9271             ELSE
  9272                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9273                 COMPUTE CO-CURRENT-CUR-COM =
  9274                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9275                 MOVE PI-PREMIUM         TO CO-CURRENT-CUR-CHG
  9276                 COMPUTE CO-CURRENT-CUR-PMT =
  9277                         PI-REMITTED - PI-DISBURSED -
  9278                         PI-ADJUSTMENTS
  9279                 COMPUTE CO-CURRENT-END-BAL =
  9280                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9281                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9282                         PI-REMITTED + PI-DISBURSED +
  9283                         PI-ADJUSTMENTS
  9284                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9285                 MOVE WS-MONTH-END-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 185
* EL640.cbl
  9286                                      TO CO-CURRENT-LAST-STMT-DT
  9287                 PERFORM 6060-ERCOMP-REWRITE
  9288                 GO TO 6090-EXIT.
  9289
  9290     IF PI-TOT-REBILL
  9291         MOVE CO-END-BAL           TO PI-BAL-FRWD
  9292     ELSE
  9293         MOVE CO-CURRENT-END-BAL   TO PI-BAL-FRWD.
  9294
  9295     IF PI-UPDATE-FILES
  9296       OR (PI-PREVIEW AND APRODSWI = 'Y')
  9297         NEXT SENTENCE
  9298     ELSE
  9299         GO TO 6090-EXIT.
  9300
  9301     IF AM-AGT (ACCOM-SUB) = PI-SAV-REMIT-TO
  9302         PERFORM 6040-READ-COMP-MASTER THRU 6049-EXIT
  9303         IF C-RECORD-FOUND
  9304             MOVE CO-ACCT-NAME   TO WS-REMIT-LINES (1)
  9305             MOVE CO-MAIL-NAME   TO WS-REMIT-LINES (2)
  9306             MOVE CO-ADDR-1      TO WS-REMIT-LINES (3)
  9307             MOVE CO-ADDR-2      TO WS-REMIT-LINES (4)
  9308             MOVE CO-ADDR-3      TO WS-REMIT-LINES (5)
  9309             MOVE WS-CO-ZIP      TO WS-REMIT-LINES (6)
  9310             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9311             MOVE 'CA'           TO BILLING-DETAIL-TYPE
  9312             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9313         ELSE
  9314             MOVE SPACES         TO ELCNTL-KEY
  9315             MOVE '6'            TO ELCNTL-REC-TYPE
  9316             MOVE PI-CARRIER     TO ELCNTL-CARRIER
  9317             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9318             MOVE CF-MAIL-TO-NAME   TO WS-REMIT-LINES (1)
  9319             MOVE CF-IN-CARE-OF     TO WS-REMIT-LINES (2)
  9320             MOVE CF-ADDRESS-LINE-1 TO WS-REMIT-LINES (3)
  9321             MOVE CF-ADDRESS-LINE-2 TO WS-REMIT-LINES (4)
  9322             MOVE CF-CITY-STATE     TO WS-REMIT-LINES (5)
  9323             MOVE WS-CF-ZIP         TO WS-REMIT-LINES (6)
  9324             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9325             MOVE 'CA'              TO BILLING-DETAIL-TYPE
  9326             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9327     ELSE
  9328         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9329         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9330         PERFORM 6001-READ
  9331         MOVE CO-ACCT-NAME       TO WS-REMIT-LINES (1)
  9332         MOVE CO-MAIL-NAME       TO WS-REMIT-LINES (2)
  9333         MOVE CO-ADDR-1          TO WS-REMIT-LINES (3)
  9334         MOVE CO-ADDR-2          TO WS-REMIT-LINES (4)
  9335         MOVE CO-ADDR-3          TO WS-REMIT-LINES (5)
  9336         MOVE WS-CO-ZIP          TO WS-REMIT-LINES (6)
  9337         MOVE CO-CURRENT-END-BAL TO PI-BAL-FRWD-GA
  9338         PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9339         MOVE 'GA'               TO BILLING-DETAIL-TYPE
  9340         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  9341
  9342     GO TO 6090-EXIT.
  9343
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 186
* EL640.cbl
  9344 6070-NO-COMP-MSTR.
  9345     MOVE ER-2230                TO EMI-ERROR.
  9346     MOVE -1                     TO AACCTL.
  9347     MOVE AL-UABON               TO ACARIERA
  9348                                    AGROUPA
  9349                                    AACCTA.
  9350     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9351     GO TO 6090-EXIT.
  9352
  9353 6080-COMP-FILE-NOTOPEN.
  9354     MOVE -1                     TO APFNTERL
  9355     MOVE ER-2233                TO EMI-ERROR.
  9356     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9357
  9358 6090-EXIT.
  9359     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 187
* EL640.cbl
  9361
  9362 6040-READ-COMP-MASTER.
  9363
  9364* EXEC CICS HANDLE CONDITION
  9365*        NOTFND   (6045-NO-COMP-MSTR)
  9366*        NOTOPEN  (6045-COMP-FILE-NOTOPEN)
  9367*    END-EXEC.
  9368*    MOVE '"$IJ                  ! . #00008838' TO DFHEIV0
  9369     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9371     MOVE X'2E20233030303038383338' TO DFHEIV0(25:11)
  9372     CALL 'kxdfhei1' USING DFHEIV0
  9373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9374
  9375
  9376     MOVE 'Y'                    TO C-RECORD-FOUND-SW.
  9377     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9378     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9379     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9380     MOVE LOW-VALUES             TO ERCOMP-FIN-RESP
  9381                                    ERCOMP-ACCT.
  9382     MOVE 'C'                    TO ERCOMP-RECORD-TYPE.
  9383
  9384     MOVE SPACES                 TO WS-CO-ZIP.
  9385
  9386
  9387* EXEC CICS READ
  9388*        DATASET   (ERCOMP-FILE-ID)
  9389*        SET       (ADDRESS OF COMPENSATION-MASTER)
  9390*        RIDFLD    (ERCOMP-KEY)
  9391*    END-EXEC.
  9392*    MOVE '&"S        E          (   #00008853' TO DFHEIV0
  9393     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9395     MOVE X'2020233030303038383533' TO DFHEIV0(25:11)
  9396     CALL 'kxdfhei1' USING DFHEIV0,
  9397           ERCOMP-FILE-ID,
  9398           DFHEIV20,
  9399           DFHEIV99,
  9400           ERCOMP-KEY,
  9401           DFHEIV99,
  9402           DFHEIV99,
  9403           DFHEIV99
  9404     SET ADDRESS OF COMPENSATION-MASTER TO
  9405         DFHEIV20
  9406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9407
  9408
  9409     IF CO-CANADIAN-POST-CODE
  9410         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9411         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9412     ELSE
  9413         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9414         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9415             MOVE '-'            TO WS-CO-ZIP-DASH
  9416             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9417
  9418     GO TO 6049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 188
* EL640.cbl
  9419
  9420 6045-COMP-FILE-NOTOPEN.
  9421     MOVE -1                     TO APFNTERL.
  9422     MOVE ER-2233                TO EMI-ERROR.
  9423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9424
  9425     GO TO 6049-EXIT.
  9426
  9427 6045-NO-COMP-MSTR.
  9428     MOVE 'N'                    TO C-RECORD-FOUND-SW.
  9429
  9430 6049-EXIT.
  9431     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 189
* EL640.cbl
  9433
  9434 6050-AGING.
  9435
  9436     IF NOT PI-VOID-BILL
  9437        IF CO-CURRENT-LAST-STMT-DT NOT = WS-MONTH-END-DATE
  9438           if pi-company-id = 'AHL'
  9439              add co-current-ov90
  9440                                 to co-current-ov120
  9441              move co-current-ov60
  9442                                 to co-current-ov90
  9443              move co-current-ov30
  9444                                 to co-current-ov60
  9445              move co-current-cur
  9446                                 to co-current-ov30
  9447           else
  9448              ADD CO-CURRENT-OV60
  9449                                 TO CO-CURRENT-OV90
  9450              MOVE CO-CURRENT-OV30
  9451                                 TO CO-CURRENT-OV60
  9452              MOVE CO-CURRENT-CUR
  9453                                 TO CO-CURRENT-OV30
  9454           end-if
  9455        end-if
  9456     end-if
  9457
  9458     COMPUTE CO-CURRENT-CUR =
  9459             CO-CURRENT-CUR-CHG - CO-CURRENT-CUR-COM.
  9460
  9461     COMPUTE WS-PAY-ADJ =
  9462             PI-REMITTED - PI-DISBURSED - PI-ADJUSTMENTS.
  9463
  9464     IF WS-PAY-ADJ NEGATIVE
  9465         SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-CUR
  9466     ELSE
  9467        if pi-company-id = 'AHL'
  9468           subtract ws-pay-adj from co-current-ov120
  9469        else
  9470           SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-OV90
  9471        end-if
  9472     end-if
  9473
  9474     IF CO-CURRENT-CUR NEGATIVE
  9475        if pi-company-id = 'AHL'
  9476           add co-current-cur to co-current-ov120
  9477        else
  9478           ADD CO-CURRENT-CUR  TO  CO-CURRENT-OV90
  9479        end-if
  9480        MOVE ZEROS              TO  CO-CURRENT-CUR
  9481     end-if
  9482
  9483     if pi-company-id = 'AHL'
  9484        if co-current-ov120 negative
  9485           add co-current-ov120 to co-current-ov90
  9486           move zeros           to co-current-ov120
  9487        end-if
  9488     end-if
  9489     IF CO-CURRENT-OV90 NEGATIVE
  9490         ADD CO-CURRENT-OV90  TO  CO-CURRENT-OV60
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 190
* EL640.cbl
  9491         MOVE ZEROS              TO  CO-CURRENT-OV90.
  9492
  9493     IF CO-CURRENT-OV60 NEGATIVE
  9494         ADD CO-CURRENT-OV60  TO  CO-CURRENT-OV30
  9495         MOVE ZEROS              TO  CO-CURRENT-OV60.
  9496
  9497     IF CO-CURRENT-OV30 NEGATIVE
  9498         ADD CO-CURRENT-OV30  TO  CO-CURRENT-CUR
  9499         MOVE ZEROS              TO  CO-CURRENT-OV30.
  9500
  9501 6059-AGING-EXIT.
  9502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 191
* EL640.cbl
  9504
  9505 6060-ERCOMP-REWRITE.
  9506
  9507
  9508* EXEC CICS REWRITE
  9509*        DATASET (ERCOMP-FILE-ID)
  9510*        FROM    (COMPENSATION-MASTER)
  9511*    END-EXEC.
  9512     MOVE LENGTH OF
  9513      COMPENSATION-MASTER
  9514       TO DFHEIV11
  9515*    MOVE '&& L                  %   #00008957' TO DFHEIV0
  9516     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9517     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9518     MOVE X'2020233030303038393537' TO DFHEIV0(25:11)
  9519     CALL 'kxdfhei1' USING DFHEIV0,
  9520           ERCOMP-FILE-ID,
  9521           COMPENSATION-MASTER,
  9522           DFHEIV11,
  9523           DFHEIV99
  9524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9525
  9526
  9527 6100-READ-CONTROL-FILE.
  9528     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  9529     MOVE +0                     TO ELCNTL-SEQ-NO.
  9530
  9531     MOVE SPACES                 TO WS-CF-ZIP.
  9532
  9533
  9534* EXEC CICS HANDLE CONDITION
  9535*        NOTFND   (6110-NO-RECORD)
  9536*    END-EXEC.
  9537*    MOVE '"$I                   ! / #00008968' TO DFHEIV0
  9538     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9540     MOVE X'2F20233030303038393638' TO DFHEIV0(25:11)
  9541     CALL 'kxdfhei1' USING DFHEIV0
  9542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9543
  9544
  9545     IF NOT ELCNTL-UPDATE
  9546
  9547* EXEC CICS READ
  9548*            DATASET (ELCNTL-FILE-ID)
  9549*            SET     (ADDRESS OF CONTROL-FILE)
  9550*            RIDFLD  (ELCNTL-KEY)
  9551*        END-EXEC
  9552*    MOVE '&"S        E          (   #00008973' TO DFHEIV0
  9553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9555     MOVE X'2020233030303038393733' TO DFHEIV0(25:11)
  9556     CALL 'kxdfhei1' USING DFHEIV0,
  9557           ELCNTL-FILE-ID,
  9558           DFHEIV20,
  9559           DFHEIV99,
  9560           ELCNTL-KEY,
  9561           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 192
* EL640.cbl
  9562           DFHEIV99,
  9563           DFHEIV99
  9564     SET ADDRESS OF CONTROL-FILE TO
  9565         DFHEIV20
  9566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9567     ELSE
  9568         MOVE SPACE              TO ELCNTL-UPDATE-SW
  9569
  9570* EXEC CICS READ
  9571*            DATASET (ELCNTL-FILE-ID)
  9572*            SET     (ADDRESS OF CONTROL-FILE)
  9573*            RIDFLD  (ELCNTL-KEY)
  9574*            UPDATE
  9575*        END-EXEC.
  9576*    MOVE '&"S        EU         (   #00008980' TO DFHEIV0
  9577     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9578     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9579     MOVE X'2020233030303038393830' TO DFHEIV0(25:11)
  9580     CALL 'kxdfhei1' USING DFHEIV0,
  9581           ELCNTL-FILE-ID,
  9582           DFHEIV20,
  9583           DFHEIV99,
  9584           ELCNTL-KEY,
  9585           DFHEIV99,
  9586           DFHEIV99,
  9587           DFHEIV99
  9588     SET ADDRESS OF CONTROL-FILE TO
  9589         DFHEIV20
  9590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9591
  9592
  9593     IF CF-ZIP-CODE-NUM NOT NUMERIC
  9594         MOVE ZEROS              TO CF-ZIP-CODE-NUM.
  9595
  9596     IF CF-ZIP-CODE-NUM NOT = ZEROS
  9597         MOVE CF-ZIP-CODE-NUM    TO WORK-ZIP
  9598         IF WORK-ZIPR1-4 = ZEROS
  9599             MOVE WORK-ZIPR1-5   TO WORK-ZIPR2-5
  9600             MOVE ZEROS          TO WORK-ZIPR2-4
  9601             MOVE WORK-ZIP       TO CF-ZIP-CODE
  9602         ELSE
  9603             MOVE WORK-ZIP       TO CF-ZIP-CODE.
  9604
  9605     IF CF-CANADIAN-POST-CODE
  9606         MOVE CF-CAN-POSTAL-1    TO WS-CF-CAN-POST-1
  9607         MOVE CF-CAN-POSTAL-2    TO WS-CF-CAN-POST-2
  9608     ELSE
  9609         MOVE CF-ZIP-PRIME       TO WS-CF-ZIP-PRIME
  9610         IF CF-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9611             MOVE '-'            TO WS-CF-ZIP-DASH
  9612             MOVE CF-ZIP-PLUS4   TO WS-CF-ZIP-PLUS4.
  9613
  9614     GO TO 6120-EXIT.
  9615
  9616 6110-NO-RECORD.
  9617     IF ELCNTL-REC-TYPE = 1
  9618         MOVE ER-0022            TO EMI-ERROR
  9619     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 193
* EL640.cbl
  9620         MOVE ER-2208            TO EMI-ERROR
  9621         MOVE -1                 TO ACARIERL
  9622         MOVE AL-UABON           TO ACARIERA
  9623         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9624
  9625 6120-EXIT.
  9626     EXIT.
  9627 6130-FIND-BENEFIT-CD.
  9628
  9629* EXEC CICS READ
  9630*       DATASET (ELCNTL-FILE-ID)
  9631*       SET     (ADDRESS OF CONTROL-FILE)
  9632*       RIDFLD  (ELCNTL-KEY)
  9633*       GTEQ
  9634*       RESP    (WS-RESPONSE)
  9635*    END-EXEC
  9636*    MOVE '&"S        G          (  N#00009022' TO DFHEIV0
  9637     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9639     MOVE X'204E233030303039303232' TO DFHEIV0(25:11)
  9640     CALL 'kxdfhei1' USING DFHEIV0,
  9641           ELCNTL-FILE-ID,
  9642           DFHEIV20,
  9643           DFHEIV99,
  9644           ELCNTL-KEY,
  9645           DFHEIV99,
  9646           DFHEIV99,
  9647           DFHEIV99
  9648     SET ADDRESS OF CONTROL-FILE TO
  9649         DFHEIV20
  9650     MOVE EIBRESP  TO WS-RESPONSE
  9651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9652     IF ws-RESP-NORMAL
  9653        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  9654           AND (CF-RECORD-TYPE = '5')
  9655           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  9656              (S1 > +8)
  9657              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9658           END-PERFORM
  9659           IF S1 NOT > +8
  9660              MOVE CF-BENEFIT-CATEGORY (S1)
  9661                                 TO WS-AH-CATEGORY
  9662              GO TO 6140-EXIT
  9663           END-IF
  9664        END-IF
  9665     END-IF
  9666     .
  9667 6140-NO-RECORD.
  9668     MOVE ER-2208                TO EMI-ERROR
  9669     MOVE -1                     TO ACARIERL
  9670     MOVE AL-UABON               TO ACARIERA
  9671     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9672     .
  9673 6140-EXIT.
  9674     EXIT.
  9675 6200-REWRITE-CONTROL-FILE.
  9676
  9677
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 194
* EL640.cbl
  9678* EXEC CICS REWRITE
  9679*        DATASET (ELCNTL-FILE-ID)
  9680*        FROM    (CONTROL-FILE)
  9681*    END-EXEC.
  9682     MOVE LENGTH OF
  9683      CONTROL-FILE
  9684       TO DFHEIV11
  9685*    MOVE '&& L                  %   #00009054' TO DFHEIV0
  9686     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9687     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9688     MOVE X'2020233030303039303534' TO DFHEIV0(25:11)
  9689     CALL 'kxdfhei1' USING DFHEIV0,
  9690           ELCNTL-FILE-ID,
  9691           CONTROL-FILE,
  9692           DFHEIV11,
  9693           DFHEIV99
  9694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9695
  9696
  9697 6290-EXIT.
  9698     EXIT.
  9699
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 195
* EL640.cbl
  9701 6300-ELIMINATE-LINE-SPACES.
  9702     IF WS-REMIT-LINES (1) = SPACES
  9703         MOVE WS-REMIT-LINES (2)  TO WS-REMIT-LINES (1)
  9704         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9705         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9706         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9707         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9708         MOVE SPACES              TO WS-REMIT-LINES (6)
  9709         GO TO 6300-ELIMINATE-LINE-SPACES.
  9710
  9711     IF WS-REMIT-LINES (2) = SPACES AND
  9712        WS-REMIT-LINES (3) = SPACES AND
  9713        WS-REMIT-LINES (4) = SPACES AND
  9714        WS-REMIT-LINES (5) = SPACES AND
  9715        WS-REMIT-LINES (6) = SPACES
  9716          GO TO 6350-MOVE-ZIP.
  9717
  9718     IF WS-REMIT-LINES (2) = SPACES
  9719         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9720         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9721         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9722         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9723         MOVE SPACES              TO WS-REMIT-LINES (6)
  9724         GO TO 6300-ELIMINATE-LINE-SPACES.
  9725
  9726     IF WS-REMIT-LINES (3) = SPACES AND
  9727        WS-REMIT-LINES (4) = SPACES AND
  9728        WS-REMIT-LINES (5) = SPACES AND
  9729        WS-REMIT-LINES (6) = SPACES
  9730          GO TO 6350-MOVE-ZIP.
  9731
  9732     IF WS-REMIT-LINES (3) = SPACES
  9733         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9734         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9735         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9736         MOVE SPACES              TO WS-REMIT-LINES (6)
  9737         GO TO 6300-ELIMINATE-LINE-SPACES.
  9738
  9739     IF WS-REMIT-LINES (4) = SPACES AND
  9740        WS-REMIT-LINES (5) = SPACES AND
  9741        WS-REMIT-LINES (6) = SPACES
  9742          GO TO 6350-MOVE-ZIP.
  9743
  9744     IF WS-REMIT-LINES (4) = SPACES
  9745         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9746         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9747         MOVE SPACES              TO WS-REMIT-LINES (6)
  9748         GO TO 6300-ELIMINATE-LINE-SPACES.
  9749
  9750     IF WS-REMIT-LINES (5) = SPACES
  9751         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9752         MOVE SPACES              TO WS-REMIT-LINES (6).
  9753
  9754 6350-MOVE-ZIP.
  9755     IF WS-REMIT-LINES (6) NOT = SPACES
  9756         MOVE WS-REMIT-ZIP (6)        TO WS-R-LAST-ZIP (5)
  9757         MOVE SPACES                  TO WS-REMIT-LINES (6)
  9758     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 196
* EL640.cbl
  9759         IF WS-REMIT-LINES (5) NOT = SPACES
  9760             MOVE WS-REMIT-ZIP (5)     TO WS-R-LAST-ZIP (5)
  9761             MOVE SPACES               TO WS-REMIT-ZIP (5)
  9762         ELSE
  9763             IF WS-REMIT-LINES (4) NOT = SPACES
  9764                 MOVE WS-REMIT-ZIP (4) TO WS-R-LAST-ZIP (4)
  9765                 MOVE SPACES           TO WS-REMIT-ZIP (4).
  9766
  9767 6390-EXIT.
  9768     EXIT.
  9769
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 197
* EL640.cbl
  9771 6400-FORMAT-ACCOUNT-ADDRS.
  9772     IF WS-ACCT-ADDR-AREA = SPACES
  9773         GO TO 6490-EXIT.
  9774
  9775     IF WS-ACCT-LINES (1) = SPACES
  9776         MOVE WS-ACCT-LINES (2)  TO WS-ACCT-LINES (1)
  9777         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9778         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9779         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9780         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9781         MOVE SPACES              TO WS-ACCT-LINES (6)
  9782         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9783
  9784     IF WS-ACCT-LINES (2) = SPACES AND
  9785        WS-ACCT-LINES (3) = SPACES AND
  9786        WS-ACCT-LINES (4) = SPACES AND
  9787        WS-ACCT-LINES (5) = SPACES AND
  9788        WS-ACCT-LINES (6) = SPACES
  9789          GO TO 6450-MOVE-ZIP.
  9790
  9791     IF WS-ACCT-LINES (2) = SPACES
  9792         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9793         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9794         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9795         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9796         MOVE SPACES             TO WS-ACCT-LINES (6)
  9797         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9798
  9799     IF WS-ACCT-LINES (3) = SPACES AND
  9800        WS-ACCT-LINES (4) = SPACES AND
  9801        WS-ACCT-LINES (5) = SPACES AND
  9802        WS-ACCT-LINES (6) = SPACES
  9803          GO TO 6450-MOVE-ZIP.
  9804
  9805     IF WS-ACCT-LINES (3) = SPACES
  9806         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9807         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9808         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9809         MOVE SPACES             TO WS-ACCT-LINES (6)
  9810         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9811
  9812     IF WS-ACCT-LINES (4) = SPACES AND
  9813        WS-ACCT-LINES (5) = SPACES AND
  9814        WS-ACCT-LINES (6) = SPACES
  9815          GO TO 6450-MOVE-ZIP.
  9816
  9817     IF WS-ACCT-LINES (4) = SPACES
  9818         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9819         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9820         MOVE SPACES             TO WS-ACCT-LINES (6)
  9821         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9822
  9823     IF WS-ACCT-LINES (5) = SPACES
  9824         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9825         MOVE SPACES             TO WS-ACCT-LINES (6).
  9826
  9827 6450-MOVE-ZIP.
  9828     IF WS-ACCT-LINES (6) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 198
* EL640.cbl
  9829         MOVE WS-ACCT-ZIP (6)         TO WS-A-LAST-ZIP (5)
  9830         MOVE SPACES                  TO WS-ACCT-LINES (6)
  9831     ELSE
  9832         IF WS-ACCT-LINES (5) NOT = SPACES
  9833             MOVE WS-ACCT-ZIP (5)      TO WS-A-LAST-ZIP (5)
  9834             MOVE SPACES               TO WS-ACCT-ZIP (5)
  9835         ELSE
  9836             IF WS-ACCT-LINES (4) NOT = SPACES
  9837                 MOVE WS-ACCT-ZIP (4)  TO WS-A-LAST-ZIP (4)
  9838                 MOVE SPACES           TO WS-ACCT-ZIP (4).
  9839
  9840 6490-EXIT.
  9841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 199
* EL640.cbl
  9843 7000-PROCESS-CHECK.
  9844*                *******************************************
  9845*                *    FORMAT THE CHECK SCREEN (EL640D)     *
  9846*                *******************************************
  9847     MOVE LOW-VALUES             TO EL640BO.
  9848
  9849     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  9850         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  9851         IF EMI-ERROR = ZEROS
  9852             MOVE AM-NAME        TO BNAMEO
  9853             MOVE AM-PERSON      TO BADDR1O
  9854             MOVE AM-ADDRS       TO BADDR2O
  9855*            MOVE AM-CITY        TO BCITYSTO
  9856             STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  9857                DELIMITED BY '  ' INTO BCITYSTO
  9858             END-STRING
  9859             MOVE WS-AM-ZIP      TO BZIPO
  9860         ELSE
  9861             MOVE EL640A         TO PI-MAP-NAME
  9862             MOVE -1             TO BPFNTERL
  9863             GO TO 8200-SEND-DATAONLY
  9864     ELSE
  9865         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9866         IF EMI-ERROR = ZEROS
  9867             MOVE CO-ACCT-NAME   TO BNAMEO
  9868             MOVE CO-ADDR-1      TO BADDR1O
  9869             MOVE CO-ADDR-2      TO BADDR2O
  9870*            MOVE CO-ADDR-3      TO BCITYSTO
  9871             STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  9872                DELIMITED BY '  ' INTO BCITYSTO
  9873             END-STRING
  9874             MOVE WS-CO-ZIP      TO BZIPO
  9875         ELSE
  9876             MOVE EL640A         TO PI-MAP-NAME
  9877             MOVE -1             TO BPFNTERL
  9878             GO TO 8200-SEND-DATAONLY.
  9879
  9880     MOVE AL-UNNON               TO BCHKAMTA.
  9881     MOVE PI-ACCT-NAME           TO BACCNAMO.
  9882     MOVE PI-SAV-ACCT            TO BACCTO.
  9883     MOVE PI-COMP-CARRIER        TO BCARIERO.
  9884     MOVE PI-COMP-GROUPING       TO BGROUPO.
  9885     MOVE PI-SAV-STATE           TO BSTATEO.
  9886     MOVE PI-MONTH-END-DATE      TO BPAYDT2O
  9887                                    WS-BEGIN-DATE.
  9888     MOVE '01'                   TO WS-BEGIN-DAY.
  9889     MOVE WS-BEGIN-DATE          TO BPAYDT1O.
  9890     MOVE -1                     TO BCHKNOL
  9891
  9892     IF WS-ENTERED-FROM-A
  9893         COMPUTE WORK-CHECK-AMT = PI-END-BAL * -1
  9894         MOVE WORK-CHECK-AMT     TO BCHKAMTO
  9895     ELSE
  9896         MOVE WORK-CHECK-AMT     TO BCHKAMTO.
  9897
  9898     IF WORK-CHECK-AMT NOT > ZEROS
  9899         MOVE ER-3165    TO  EMI-ERROR
  9900         MOVE -1         TO  BCHKAMTL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 200
* EL640.cbl
  9901         MOVE AL-UNBON   TO  BCHKAMTA
  9902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9903
  9904     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 201
* EL640.cbl
  9906
  9907 7500-PRODUCE-CHECK.
  9908*                *******************************************
  9909*                *   PRODUCES A CHECK FOR LATER PRINTING   *
  9910*                *******************************************
  9911     MOVE SPACES                 TO ELCNTL-KEY.
  9912     MOVE '1'                    TO ELCNTL-REC-TYPE.
  9913     MOVE 'Y'                    TO ELCNTL-UPDATE-SW.
  9914     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  9915
  9916     IF EMI-ERROR NOT = ZEROS
  9917         GO TO 8200-SEND-DATAONLY.
  9918
  9919     IF CR-CHECK-NO-AUTO-SEQ
  9920         IF CR-CHECK-CNT-RESET-VALUE
  9921             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9922             MOVE +1             TO CF-CR-CHECK-COUNTER
  9923             MOVE 6              TO BCHKNOL
  9924         ELSE
  9925             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9926             MOVE 6              TO BCHKNOL
  9927             ADD +1              TO CF-CR-CHECK-COUNTER.
  9928
  9929     IF CR-CHECK-NO-MANUAL
  9930         IF BCHKNOL = ZEROS
  9931             MOVE ER-2438        TO EMI-ERROR
  9932             MOVE -1             TO BCHKNOL
  9933             MOVE AL-UNBON       TO BCHKNOA
  9934             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9935             GO TO 8200-SEND-DATAONLY
  9936         ELSE
  9937             IF BCHKNOI NOT NUMERIC
  9938                 MOVE ER-2439    TO EMI-ERROR
  9939                 MOVE -1         TO BCHKNOL
  9940                 MOVE AL-UNBON   TO BCHKNOA
  9941                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9942                 GO TO 8200-SEND-DATAONLY.
  9943
  9944     PERFORM 7600-CHECK-FORMS THRU 7600-EXIT.
  9945
  9946
  9947* EXEC CICS GETMAIN
  9948*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  9949*        LENGTH  (ERPYAJ-LENGTH)
  9950*        INITIMG (GETMAIN-SPACE)
  9951*    END-EXEC.
  9952*    MOVE ',"IL                  $   #00009308' TO DFHEIV0
  9953     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9954     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9955     MOVE X'2020233030303039333038' TO DFHEIV0(25:11)
  9956     CALL 'kxdfhei1' USING DFHEIV0,
  9957           DFHEIV20,
  9958           ERPYAJ-LENGTH,
  9959           GETMAIN-SPACE
  9960     SET ADDRESS OF PENDING-PAY-ADJ TO
  9961         DFHEIV20
  9962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9963
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 202
* EL640.cbl
  9964
  9965
  9966* EXEC CICS BIF DEEDIT
  9967*        FIELD  (BCHKAMTI)
  9968*        LENGTH (11)
  9969*    END-EXEC.
  9970     MOVE 11
  9971       TO DFHEIV11
  9972*    MOVE '@"L                   #   #00009314' TO DFHEIV0
  9973     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9974     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9975     MOVE X'2020233030303039333134' TO DFHEIV0(25:11)
  9976     CALL 'kxdfhei1' USING DFHEIV0,
  9977           BCHKAMTI,
  9978           DFHEIV11
  9979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9980
  9981
  9982     IF BCHKAMTI NOT > ZEROS
  9983         MOVE ER-3165    TO  EMI-ERROR
  9984         MOVE -1         TO  BCHKAMTL
  9985         MOVE AL-UNBON   TO  BCHKAMTA
  9986         MOVE BCHKAMTI   TO  BCHKAMTO
  9987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9988         GO TO 8200-SEND-DATAONLY.
  9989
  9990     MOVE 'Y'                    TO PI-CHECK-SW.
  9991     MOVE 'PY'                   TO PY-RECORD-ID.
  9992     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  9993     MOVE PI-COMP-CARRIER        TO PY-CARRIER.
  9994     MOVE PI-COMP-GROUPING       TO PY-GROUPING.
  9995     MOVE PI-SAV-REMIT-TO        TO PY-FIN-RESP.
  9996     MOVE PI-SAV-ACCT            TO PY-ACCOUNT.
  9997     MOVE 'C'                    TO PY-RECORD-TYPE.
  9998     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  9999
 10000     IF PI-COMPANY-ID = CLIENT-ITY
 10001        MOVE PI-MONTH-END-DATE   TO WS-PY-END-DT
 10002                                    WS-BEGIN-DATE
 10003        MOVE '01'                TO WS-BEGIN-DAY
 10004        MOVE WS-BEGIN-DATE       TO WS-PY-BEGIN-DT
 10005        MOVE WS-ITY-COMMENT      TO PY-ENTRY-COMMENT
 10006     ELSE
 10007        MOVE WS-CURRENT-DATE-MDY TO WS-PY-CURRENT-DATE
 10008        MOVE WS-PY-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
 10009
 10010     MOVE BCHKAMTI               TO PY-ENTRY-AMT.
 10011     ADD BCHKAMTI TO PI-DISBURSED.
 10012     MOVE BFORM1I                TO PY-LETTER (1).
 10013     MOVE BFORM2I                TO PY-LETTER (2).
 10014     MOVE BFORM3I                TO PY-LETTER (3).
 10015
 10016     IF NOT CR-CHECK-NO-AT-PRINT
 10017         MOVE BCHKNOI            TO PY-CHECK-NUMBER.
 10018
 10019     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
 10020     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
 10021     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 203
* EL640.cbl
 10022                                    PY-INPUT-DT.
 10023     IF PI-BILL OR PI-REBILLING
 10024         MOVE DC-BIN-DATE-1      TO PY-BILLED-DATE
 10025     ELSE
 10026         MOVE LOW-VALUES         TO PY-BILLED-DATE
 10027                                    PY-AR-DATE.
 10028
 10029     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 10030                                    PY-CHECK-QUE-SEQUENCE.
 10031     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 10032                                    PY-REPORTED-DT
 10033                                    PY-CHECK-WRITTEN-DT.
 10034     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
 10035     MOVE 'B'                    TO PY-CHECK-ORIGIN-SW.
 10036
 10037
 10038* EXEC CICS WRITE
 10039*        DATASET (ERPYAJ-FILE-ID)
 10040*        FROM    (PENDING-PAY-ADJ)
 10041*        RIDFLD  (PY-CONTROL-PRIMARY)
 10042*    END-EXEC.
 10043     MOVE LENGTH OF
 10044      PENDING-PAY-ADJ
 10045       TO DFHEIV11
 10046*    MOVE '&$ L                  ''   #00009374' TO DFHEIV0
 10047     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10048     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10049     MOVE X'2020233030303039333734' TO DFHEIV0(25:11)
 10050     CALL 'kxdfhei1' USING DFHEIV0,
 10051           ERPYAJ-FILE-ID,
 10052           PENDING-PAY-ADJ,
 10053           DFHEIV11,
 10054           PY-CONTROL-PRIMARY,
 10055           DFHEIV99,
 10056           DFHEIV99
 10057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10058
 10059
 10060     IF CR-CHECK-NO-AUTO-SEQ
 10061         PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT
 10062     ELSE
 10063
 10064* EXEC CICS UNLOCK
 10065*            DATASET (ELCNTL-FILE-ID)
 10066*        END-EXEC.
 10067*    MOVE '&*                    #   #00009383' TO DFHEIV0
 10068     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10069     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10070     MOVE X'2020233030303039333833' TO DFHEIV0(25:11)
 10071     CALL 'kxdfhei1' USING DFHEIV0,
 10072           ELCNTL-FILE-ID,
 10073           DFHEIV99
 10074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10075
 10076
 10077     MOVE EL640A                 TO PI-MAP-NAME.
 10078     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
 10079     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 204
* EL640.cbl
 10080
 10081 7600-CHECK-FORMS.
 10082
 10083     IF BFORM1L NOT = ZEROS
 10084             AND
 10085        BFORM1I NOT = SPACES
 10086         MOVE BFORM1I            TO ELLETR-FORM-NO
 10087         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10088         IF W-LETTER-NOT-FOUND
 10089             MOVE ER-7389        TO EMI-ERROR
 10090             MOVE -1             TO BFORM1L
 10091             MOVE AL-UABON       TO BFORM1A
 10092             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10093             GO TO 8200-SEND-DATAONLY.
 10094
 10095     IF BFORM2L NOT = ZEROS
 10096             AND
 10097        BFORM2I NOT = SPACES
 10098         MOVE BFORM2I            TO ELLETR-FORM-NO
 10099         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10100
 10101         IF W-LETTER-NOT-FOUND
 10102             MOVE ER-7389        TO EMI-ERROR
 10103             MOVE -1             TO BFORM2L
 10104             MOVE AL-UABON       TO BFORM2A
 10105             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10106             GO TO 8200-SEND-DATAONLY.
 10107
 10108     IF BFORM3L NOT = ZEROS
 10109             AND
 10110        BFORM3I NOT = SPACES
 10111         MOVE BFORM3I            TO ELLETR-FORM-NO
 10112         IF  W-LETTER-NOT-FOUND
 10113             MOVE ER-7389        TO EMI-ERROR
 10114             MOVE -1             TO BFORM3L
 10115             MOVE AL-UABON       TO BFORM3A
 10116             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10117             GO TO 8200-SEND-DATAONLY.
 10118
 10119     IF BFORM1L = ZEROS
 10120         IF BFORM2L NOT = ZEROS
 10121             MOVE BFORM2L        TO BFORM1L
 10122             MOVE BFORM3L        TO BFORM2L
 10123             MOVE BFORM2A        TO BFORM1A
 10124             MOVE BFORM3A        TO BFORM2A
 10125             MOVE BFORM2I        TO BFORM1I
 10126             MOVE BFORM3I        TO BFORM2I
 10127             MOVE LOW-VALUES     TO BFORM3I
 10128                                    BFORM3A
 10129             MOVE ZEROS          TO BFORM3L
 10130         ELSE
 10131             IF BFORM3L NOT = ZEROS
 10132                 MOVE BFORM3L    TO BFORM1L
 10133                 MOVE BFORM3I    TO BFORM1I
 10134                 MOVE BFORM3A    TO BFORM1A
 10135                 MOVE LOW-VALUES TO BFORM3I
 10136                                    BFORM3A
 10137                 MOVE ZEROS      TO BFORM3L
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 205
* EL640.cbl
 10138             ELSE
 10139                 NEXT SENTENCE
 10140     ELSE
 10141         IF BFORM2L = ZEROS
 10142             IF BFORM3L NOT = ZEROS
 10143                 MOVE BFORM3L    TO BFORM2L
 10144                 MOVE BFORM3I    TO BFORM2I
 10145                 MOVE BFORM3A    TO BFORM2A
 10146                 MOVE LOW-VALUES TO BFORM3I
 10147                                    BFORM3A
 10148                 MOVE ZEROS      TO BFORM3L.
 10149
 10150 7600-EXIT.
 10151      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 206
* EL640.cbl
 10153 7620-CHECK-ON-LETTER.
 10154
 10155     MOVE SPACES                 TO W-LETTER-IND.
 10156
 10157     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD.
 10158     MOVE +1                     TO ELLETR-LINE-SEQ.
 10159
 10160
 10161* EXEC CICS HANDLE CONDITION
 10162*        NOTFND   (7620-LETR-NOT-FOUND)
 10163*        ENDFILE  (7620-LETR-NOT-FOUND)
 10164*        NOTOPEN  (7620-LETR-NOT-OPEN)
 10165*    END-EXEC.
 10166*    MOVE '"$I''J                 ! 0 #00009470' TO DFHEIV0
 10167     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10168     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10169     MOVE X'3020233030303039343730' TO DFHEIV0(25:11)
 10170     CALL 'kxdfhei1' USING DFHEIV0
 10171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10172
 10173
 10174
 10175* EXEC CICS READ
 10176*        SET     (ADDRESS OF TEXT-FILES)
 10177*        DATASET (ELLETR-FILE-ID)
 10178*        RIDFLD  (ELLETR-KEY)
 10179*    END-EXEC.
 10180*    MOVE '&"S        E          (   #00009476' TO DFHEIV0
 10181     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10182     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10183     MOVE X'2020233030303039343736' TO DFHEIV0(25:11)
 10184     CALL 'kxdfhei1' USING DFHEIV0,
 10185           ELLETR-FILE-ID,
 10186           DFHEIV20,
 10187           DFHEIV99,
 10188           ELLETR-KEY,
 10189           DFHEIV99,
 10190           DFHEIV99,
 10191           DFHEIV99
 10192     SET ADDRESS OF TEXT-FILES TO
 10193         DFHEIV20
 10194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10195
 10196
 10197     GO TO 7620-EXIT.
 10198
 10199 7620-LETR-NOT-FOUND.
 10200
 10201     MOVE 'Y'                    TO W-LETTER-IND.
 10202     GO TO 7620-EXIT.
 10203
 10204 7620-LETR-NOT-OPEN.
 10205
 10206     MOVE ER-0013                TO EMI-ERROR.
 10207     MOVE -1                     TO BFORM1L.
 10208     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10209     GO TO 8200-SEND-DATAONLY.
 10210
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 207
* EL640.cbl
 10211 7620-EXIT.
 10212      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 208
* EL640.cbl
 10214 8100-SEND-INITIAL-MAP.
 10215
 10216     MOVE SPACES TO PI-TRANSFER-SW.
 10217
 10218     IF PI-MAP-NAME = EL640A
 10219         NEXT SENTENCE
 10220     ELSE
 10221         GO TO 8110-SEND-INITIAL-CHECK-MAP.
 10222
 10223     IF PI-COMPANY-ID = 'DMD'
 10224        MOVE AL-SADOF            TO APF5HDGA.
 10225
 10226     IF NOT PI-GA-BILLING
 10227        MOVE AL-SADOF            TO AGAHDGA.
 10228
 10229     MOVE WS-CURRENT-DATE-EDIT   TO ADATEO.
 10230     MOVE EIBTIME                TO TIME-IN.
 10231     MOVE TIME-OUT               TO ATIMEO.
 10232     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10233     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10234
 10235     MOVE -1                     TO AACCTL.
 10236     MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O.
 10237     MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O.
 10238
 10239     IF CARR-GROUP-ST-ACCNT-CNTL
 10240         NEXT SENTENCE
 10241     ELSE
 10242         IF ST-ACCNT-CNTL
 10243             MOVE AL-SADOF       TO ACARHDGA
 10244                                    AGRPHDGA
 10245             MOVE AL-SANOF       TO ACARIERA
 10246                                    AGROUPA
 10247         ELSE
 10248             IF CARR-ST-ACCNT-CNTL
 10249                 MOVE AL-SADOF   TO AGRPHDGA
 10250                 MOVE AL-SANOF   TO AGROUPA
 10251             ELSE
 10252                 IF ACCNT-CNTL
 10253                     MOVE AL-SADOF TO ACARHDGA
 10254                                      AGRPHDGA
 10255                                      ASTHDGA
 10256                     MOVE AL-SANOF TO ACARIERA
 10257                                      AGROUPA
 10258                                      ASTATEA
 10259                 ELSE
 10260                     IF CARR-ACCNT-CNTL
 10261                         MOVE AL-SADOF TO AGRPHDGA
 10262                                          ASTHDGA
 10263                         MOVE AL-SANOF TO AGROUPA
 10264                                          ASTATEA.
 10265
 10266     IF (EIBTRNID = EL633-TRANS-ID  OR  EL635-TRANS-ID  OR
 10267                    EL633DMD-TRANS-ID  OR
 10268                    EL650-TRANS-ID  OR  EL652-TRANS-ID  OR
 10269                    EL658-TRANS-ID)  AND
 10270          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10271        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 209
* EL640.cbl
 10272        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10273        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10274        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10275        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10276        IF CARR-GROUP-ST-ACCNT-CNTL
 10277            MOVE AL-UANON        TO ACARIERA
 10278                                    AGROUPA
 10279                                    ASTATEA
 10280                                    AACCTA
 10281            MOVE WT-CR-CARRIER   TO ACARIERI
 10282                                    PI-SCR-CARRIER
 10283            MOVE WT-CR-GROUPING  TO AGROUPI
 10284                                    PI-SCR-GROUPING
 10285            MOVE WT-CR-ACCOUNT   TO AACCTI
 10286                                    PI-SCR-ACCOUNT
 10287            MOVE 1               TO ACARIERL
 10288            MOVE 6               TO AGROUPL
 10289            MOVE 10              TO AACCTL
 10290            MOVE -1              TO ASTATEL
 10291        ELSE
 10292         IF ST-ACCNT-CNTL
 10293            MOVE AL-UANON        TO ASTATEA
 10294                                    AACCTA
 10295            MOVE WT-CR-ACCOUNT   TO AACCTI
 10296                                    PI-SCR-ACCOUNT
 10297            MOVE 10              TO AACCTL
 10298            MOVE -1              TO ASTATEL
 10299         ELSE
 10300            IF CARR-ST-ACCNT-CNTL
 10301                MOVE AL-UANON       TO ACARIERA
 10302                                       ASTATEA
 10303                                       AACCTA
 10304                MOVE WT-CR-CARRIER TO ACARIERI
 10305                                      PI-SCR-CARRIER
 10306                MOVE WT-CR-ACCOUNT TO AACCTI
 10307                                      PI-SCR-ACCOUNT
 10308                MOVE 1              TO ACARIERL
 10309                MOVE 10             TO AACCTL
 10310                MOVE -1             TO ASTATEL
 10311            ELSE
 10312                IF ACCNT-CNTL
 10313                    MOVE AL-UANON       TO AACCTA
 10314                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10315                                           PI-SCR-ACCOUNT
 10316                    MOVE 10             TO AACCTL
 10317                    MOVE -1             TO ABILTYPL
 10318                ELSE
 10319                    IF CARR-ACCNT-CNTL
 10320                        MOVE AL-UANON        TO ACARIERA
 10321                                                AACCTA
 10322                        MOVE WT-CR-CARRIER   TO ACARIERI
 10323                                                PI-SCR-CARRIER
 10324                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10325                                                PI-SCR-ACCOUNT
 10326                        MOVE 1               TO ACARIERL
 10327                        MOVE 10              TO AACCTL
 10328                        MOVE -1              TO ABILTYPL.
 10329
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 210
* EL640.cbl
 10330     IF (EIBTRNID = EL6311-TRANS-ID) AND
 10331          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10332        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
 10333        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10334        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10335        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10336        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10337        MOVE SPACES              TO PI-SAV-CARR
 10338                                    PI-SAV-GROUP
 10339                                    PI-SAV-STATE
 10340                                    PI-SAV-ACCT
 10341        MOVE LOW-VALUES          TO PI-SAV-EXP-DT
 10342        IF CARR-GROUP-ST-ACCNT-CNTL
 10343            MOVE AL-UANON        TO ACARIERA
 10344                                    AGROUPA
 10345                                    ASTATEA
 10346                                    AACCTA
 10347            MOVE WT-CR-CARRIER   TO ACARIERI
 10348                                    PI-SCR-CARRIER
 10349                                    PI-SAV-CARR
 10350            MOVE WT-CR-GROUPING  TO AGROUPI
 10351                                    PI-SCR-GROUPING
 10352                                    PI-SAV-GROUP
 10353            MOVE WT-CR-STATE     TO ASTATEI
 10354                                    PI-SCR-STATE
 10355            MOVE WT-CR-ACCOUNT   TO AACCTI
 10356                                    PI-SCR-ACCOUNT
 10357            MOVE 1               TO ACARIERL
 10358            MOVE 6               TO AGROUPL
 10359            MOVE 10              TO AACCTL
 10360            MOVE 2               TO ASTATEL
 10361            MOVE -1              TO ABILTYPL
 10362        ELSE
 10363         IF ST-ACCNT-CNTL
 10364            MOVE AL-UANON        TO ASTATEA
 10365                                    AACCTA
 10366            MOVE WT-CR-STATE     TO ASTATEI
 10367                                    PI-SCR-STATE
 10368                                    PI-SAV-STATE
 10369            MOVE WT-CR-ACCOUNT   TO AACCTI
 10370                                    PI-SCR-ACCOUNT
 10371                                    PI-SAV-ACCT
 10372            MOVE 10              TO AACCTL
 10373            MOVE -1              TO ASTATEL
 10374         ELSE
 10375            IF CARR-ST-ACCNT-CNTL
 10376                MOVE AL-UANON      TO ACARIERA
 10377                                      ASTATEA
 10378                                      AACCTA
 10379                MOVE WT-CR-CARRIER TO ACARIERI
 10380                                      PI-SCR-CARRIER
 10381                                      PI-SAV-CARR
 10382                MOVE WT-CR-STATE   TO ASTATEI
 10383                                      PI-SCR-STATE
 10384                                      PI-SAV-STATE
 10385                MOVE WT-CR-ACCOUNT TO AACCTI
 10386                                      PI-SCR-ACCOUNT
 10387                                      PI-SAV-ACCT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 211
* EL640.cbl
 10388                MOVE 1             TO ACARIERL
 10389                MOVE 10            TO AACCTL
 10390                MOVE 2             TO ASTATEL
 10391                MOVE -1            TO ABILTYPL
 10392            ELSE
 10393                IF ACCNT-CNTL
 10394                    MOVE AL-UANON       TO AACCTA
 10395                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10396                                           PI-SCR-ACCOUNT
 10397                                           PI-SAV-ACCT
 10398                    MOVE 10             TO AACCTL
 10399                    MOVE -1             TO ABILTYPL
 10400                ELSE
 10401                    IF CARR-ACCNT-CNTL
 10402                        MOVE AL-UANON        TO ACARIERA
 10403                                                AACCTA
 10404                        MOVE WT-CR-CARRIER   TO ACARIERI
 10405                                                PI-SCR-CARRIER
 10406                                                PI-SAV-CARR
 10407                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10408                                                PI-SCR-ACCOUNT
 10409                                                PI-SAV-ACCT
 10410                        MOVE 1               TO ACARIERL
 10411                        MOVE 10              TO AACCTL
 10412                        MOVE -1              TO ABILTYPL.
 10413
 10414
 10415* EXEC CICS SEND
 10416*        MAP      (PI-MAP-NAME)
 10417*        MAPSET   (MAPSET-NAME)
 10418*        FROM     (EL640AO)
 10419*        ERASE
 10420*        CURSOR
 10421*    END-EXEC.
 10422     MOVE LENGTH OF
 10423      EL640AO
 10424       TO DFHEIV12
 10425     MOVE -1
 10426       TO DFHEIV11
 10427*    MOVE '8$     CT  E    H L F ,   #00009699' TO DFHEIV0
 10428     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10429     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10430     MOVE X'2020233030303039363939' TO DFHEIV0(25:11)
 10431     CALL 'kxdfhei1' USING DFHEIV0,
 10432           PI-MAP-NAME,
 10433           EL640AO,
 10434           DFHEIV12,
 10435           MAPSET-NAME,
 10436           DFHEIV99,
 10437           DFHEIV99,
 10438           DFHEIV99,
 10439           DFHEIV11,
 10440           DFHEIV99,
 10441           DFHEIV99,
 10442           DFHEIV99
 10443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10444
 10445
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 212
* EL640.cbl
 10446     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 213
* EL640.cbl
 10448 8110-SEND-INITIAL-CHECK-MAP.
 10449     MOVE WS-CURRENT-DATE-EDIT   TO BDATEO.
 10450     MOVE EIBTIME                TO TIME-IN.
 10451     MOVE TIME-OUT               TO BTIMEO.
 10452     MOVE PI-COMPANY-ID          TO BCMPNYO.
 10453     MOVE PI-PROCESSOR-ID        TO BUSERIDO.
 10454     MOVE -1                     TO BPFNTERL.
 10455     MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO.
 10456
 10457
 10458* EXEC CICS SEND
 10459*        MAP      (PI-MAP-NAME)
 10460*        MAPSET   (MAPSET-NAME)
 10461*        FROM     (EL640BO)
 10462*        ERASE
 10463*        CURSOR
 10464*    END-EXEC.
 10465     MOVE LENGTH OF
 10466      EL640BO
 10467       TO DFHEIV12
 10468     MOVE -1
 10469       TO DFHEIV11
 10470*    MOVE '8$     CT  E    H L F ,   #00009718' TO DFHEIV0
 10471     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10472     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10473     MOVE X'2020233030303039373138' TO DFHEIV0(25:11)
 10474     CALL 'kxdfhei1' USING DFHEIV0,
 10475           PI-MAP-NAME,
 10476           EL640BO,
 10477           DFHEIV12,
 10478           MAPSET-NAME,
 10479           DFHEIV99,
 10480           DFHEIV99,
 10481           DFHEIV99,
 10482           DFHEIV11,
 10483           DFHEIV99,
 10484           DFHEIV99,
 10485           DFHEIV99
 10486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10487
 10488
 10489     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 214
* EL640.cbl
 10491 8200-SEND-DATAONLY.
 10492     IF PI-MAP-NAME = EL640A
 10493         MOVE WS-CURRENT-DATE-EDIT   TO ADATEO
 10494         MOVE EIBTIME                TO TIME-IN
 10495         MOVE TIME-OUT               TO ATIMEO
 10496         MOVE PI-COMPANY-ID          TO CMPNYIDO
 10497         MOVE PI-PROCESSOR-ID        TO USERIDO
 10498         MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O
 10499         MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O
 10500
 10501* EXEC CICS SEND
 10502*            MAP      (PI-MAP-NAME)
 10503*            MAPSET   (MAPSET-NAME)
 10504*            FROM     (EL640AO)
 10505*            DATAONLY
 10506*            ERASEAUP
 10507*            CURSOR
 10508*        END-EXEC
 10509     MOVE LENGTH OF
 10510      EL640AO
 10511       TO DFHEIV12
 10512     MOVE -1
 10513       TO DFHEIV11
 10514*    MOVE '8$D    CT  A    H L F ,   #00009737' TO DFHEIV0
 10515     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10516     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10517     MOVE X'2020233030303039373337' TO DFHEIV0(25:11)
 10518     CALL 'kxdfhei1' USING DFHEIV0,
 10519           PI-MAP-NAME,
 10520           EL640AO,
 10521           DFHEIV12,
 10522           MAPSET-NAME,
 10523           DFHEIV99,
 10524           DFHEIV99,
 10525           DFHEIV99,
 10526           DFHEIV11,
 10527           DFHEIV99,
 10528           DFHEIV99,
 10529           DFHEIV99
 10530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10531     ELSE
 10532         MOVE WS-CURRENT-DATE-EDIT   TO BDATEO
 10533         MOVE EIBTIME                TO TIME-IN
 10534         MOVE TIME-OUT               TO BTIMEO
 10535         MOVE PI-COMPANY-ID          TO BCMPNYO
 10536         MOVE PI-PROCESSOR-ID        TO BUSERIDO
 10537         MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO
 10538
 10539* EXEC CICS SEND
 10540*            MAP      (PI-MAP-NAME)
 10541*            MAPSET   (MAPSET-NAME)
 10542*            FROM     (EL640BO)
 10543*            DATAONLY
 10544*            ERASEAUP
 10545*            CURSOR
 10546*        END-EXEC.
 10547     MOVE LENGTH OF
 10548      EL640BO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 215
* EL640.cbl
 10549       TO DFHEIV12
 10550     MOVE -1
 10551       TO DFHEIV11
 10552*    MOVE '8$D    CT  A    H L F ,   #00009752' TO DFHEIV0
 10553     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10554     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10555     MOVE X'2020233030303039373532' TO DFHEIV0(25:11)
 10556     CALL 'kxdfhei1' USING DFHEIV0,
 10557           PI-MAP-NAME,
 10558           EL640BO,
 10559           DFHEIV12,
 10560           MAPSET-NAME,
 10561           DFHEIV99,
 10562           DFHEIV99,
 10563           DFHEIV99,
 10564           DFHEIV11,
 10565           DFHEIV99,
 10566           DFHEIV99,
 10567           DFHEIV99
 10568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10569
 10570
 10571     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 216
* EL640.cbl
 10573 8300-SEND-TEXT.
 10574
 10575* EXEC CICS SEND TEXT
 10576*        FROM     (LOGOFF-TEXT)
 10577*        LENGTH   (LOGOFF-LENGTH)
 10578*        ERASE
 10579*        FREEKB
 10580*    END-EXEC.
 10581*    MOVE '8&      T  E F  H   F -   #00009764' TO DFHEIV0
 10582     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10583     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10584     MOVE X'2020233030303039373634' TO DFHEIV0(25:11)
 10585     CALL 'kxdfhei1' USING DFHEIV0,
 10586           LOGOFF-TEXT,
 10587           LOGOFF-LENGTH,
 10588           DFHEIV99,
 10589           DFHEIV99,
 10590           DFHEIV99,
 10591           DFHEIV99,
 10592           DFHEIV99,
 10593           DFHEIV99,
 10594           DFHEIV99,
 10595           DFHEIV99,
 10596           DFHEIV99,
 10597           DFHEIV99
 10598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10599
 10600
 10601
 10602* EXEC CICS RETURN
 10603*    END-EXEC.
 10604*    MOVE '.(                    ''   #00009771' TO DFHEIV0
 10605     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10606     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10607     MOVE X'2020233030303039373731' TO DFHEIV0(25:11)
 10608     CALL 'kxdfhei1' USING DFHEIV0,
 10609           DFHEIV99,
 10610           DFHEIV99,
 10611           DFHEIV99,
 10612           DFHEIV99,
 10613           DFHEIV99,
 10614           DFHEIV99
 10615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10616
 10617
 10618 8500-DATE-CONVERT.
 10619
 10620* EXEC CICS LINK
 10621*        PROGRAM  (LINK-ELDATCV)
 10622*        COMMAREA (DATE-CONVERSION-DATA)
 10623*        LENGTH   (DC-COMM-LENGTH)
 10624*    END-EXEC.
 10625*    MOVE '."C                   (   #00009775' TO DFHEIV0
 10626     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10627     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10628     MOVE X'2020233030303039373735' TO DFHEIV0(25:11)
 10629     CALL 'kxdfhei1' USING DFHEIV0,
 10630           LINK-ELDATCV,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 217
* EL640.cbl
 10631           DATE-CONVERSION-DATA,
 10632           DC-COMM-LENGTH,
 10633           DFHEIV99,
 10634           DFHEIV99,
 10635           DFHEIV99,
 10636           DFHEIV99
 10637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10638
 10639
 10640 8500-EXIT.
 10641     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 218
* EL640.cbl
 10643 8800-UNAUTHORIZED-ACCESS.
 10644     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10645     GO TO 8300-SEND-TEXT.
 10646
 10647 8810-PF23.
 10648     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10649     MOVE XCTL-005               TO PGM-NAME.
 10650     GO TO 9300-XCTL.
 10651
 10652 8900-SYNCPOINT-ROLLBACK.
 10653
 10654* EXEC CICS SYNCPOINT
 10655*         ROLLBACK
 10656*    END-EXEC.
 10657*    MOVE '6"R                   !   #00009794' TO DFHEIV0
 10658     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10659     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10660     MOVE X'2020233030303039373934' TO DFHEIV0(25:11)
 10661     CALL 'kxdfhei1' USING DFHEIV0
 10662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10663
 10664
 10665 8900-EXIT.
 10666     EXIT.
 10667
 10668 9100-RETURN-TRAN.
 10669     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10670     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10671
 10672
 10673* EXEC CICS RETURN
 10674*        TRANSID    (TRANS-ID)
 10675*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10676*        LENGTH     (PI-COMM-LENGTH)
 10677*    END-EXEC.
 10678*    MOVE '.(CT                  ''   #00009805' TO DFHEIV0
 10679     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10680     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10681     MOVE X'2020233030303039383035' TO DFHEIV0(25:11)
 10682     CALL 'kxdfhei1' USING DFHEIV0,
 10683           TRANS-ID,
 10684           PROGRAM-INTERFACE-BLOCK,
 10685           PI-COMM-LENGTH,
 10686           DFHEIV99,
 10687           DFHEIV99,
 10688           DFHEIV99
 10689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10690
 10691
 10692 9200-RETURN-MAIN-MENU.
 10693     MOVE XCTL-626               TO PGM-NAME.
 10694     GO TO 9300-XCTL.
 10695
 10696 9300-XCTL.
 10697
 10698* EXEC CICS XCTL
 10699*        PROGRAM    (PGM-NAME)
 10700*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 219
* EL640.cbl
 10701*        LENGTH     (PI-COMM-LENGTH)
 10702*    END-EXEC.
 10703*    MOVE '.$C                   %   #00009816' TO DFHEIV0
 10704     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10705     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10706     MOVE X'2020233030303039383136' TO DFHEIV0(25:11)
 10707     CALL 'kxdfhei1' USING DFHEIV0,
 10708           PGM-NAME,
 10709           PROGRAM-INTERFACE-BLOCK,
 10710           PI-COMM-LENGTH,
 10711           DFHEIV99
 10712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10713
 10714
 10715 9400-CLEAR.
 10716     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
 10717     GO TO 9300-XCTL.
 10718
 10719 9500-PF12.
 10720     MOVE XCTL-010               TO PGM-NAME.
 10721     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 220
* EL640.cbl
 10723 9600-PGMID-ERROR.
 10724
 10725* EXEC CICS HANDLE CONDITION
 10726*        PGMIDERR    (8300-SEND-TEXT)
 10727*    END-EXEC.
 10728*    MOVE '"$L                   ! 1 #00009831' TO DFHEIV0
 10729     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10731     MOVE X'3120233030303039383331' TO DFHEIV0(25:11)
 10732     CALL 'kxdfhei1' USING DFHEIV0
 10733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10734
 10735
 10736     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10737     MOVE ' '                    TO PI-ENTRY-CD-1.
 10738     MOVE XCTL-005               TO PGM-NAME.
 10739     MOVE PGM-NAME               TO LOGOFF-PGM.
 10740     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10741     GO TO 9300-XCTL.
 10742
 10743 9900-ERROR-FORMAT.
 10744     IF NOT EMI-ERRORS-COMPLETE
 10745         MOVE LINK-001           TO PGM-NAME
 10746
 10747* EXEC CICS LINK
 10748*            PROGRAM    (PGM-NAME)
 10749*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10750*            LENGTH     (EMI-COMM-LENGTH)
 10751*        END-EXEC.
 10752*    MOVE '."C                   (   #00009845' TO DFHEIV0
 10753     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10755     MOVE X'2020233030303039383435' TO DFHEIV0(25:11)
 10756     CALL 'kxdfhei1' USING DFHEIV0,
 10757           PGM-NAME,
 10758           ERROR-MESSAGE-INTERFACE-BLOCK,
 10759           EMI-COMM-LENGTH,
 10760           DFHEIV99,
 10761           DFHEIV99,
 10762           DFHEIV99,
 10763           DFHEIV99
 10764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10765
 10766
 10767 9900-EXIT.
 10768     EXIT.
 10769
 10770 9990-ABEND.
 10771     MOVE LINK-004               TO PGM-NAME.
 10772     MOVE DFHEIBLK               TO EMI-LINE1.
 10773
 10774
 10775* EXEC CICS LINK
 10776*        PROGRAM   (PGM-NAME)
 10777*        COMMAREA  (EMI-LINE1)
 10778*        LENGTH    (72)
 10779*    END-EXEC.
 10780     MOVE 72
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 221
* EL640.cbl
 10781       TO DFHEIV11
 10782*    MOVE '."C                   (   #00009858' TO DFHEIV0
 10783     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10785     MOVE X'2020233030303039383538' TO DFHEIV0(25:11)
 10786     CALL 'kxdfhei1' USING DFHEIV0,
 10787           PGM-NAME,
 10788           EMI-LINE1,
 10789           DFHEIV11,
 10790           DFHEIV99,
 10791           DFHEIV99,
 10792           DFHEIV99,
 10793           DFHEIV99
 10794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10795
 10796
 10797     IF PI-MAP-NAME = EL640A
 10798         MOVE -1 TO APFNTERL
 10799     ELSE
 10800         MOVE -1 TO BPFNTERL.
 10801
 10802     GO TO 8200-SEND-DATAONLY.
 10803
 10804 9995-SECURITY-VIOLATION.
 10805*                            COPY ELCSCTP.
 10806******************************************************************
 10807*                                                                *
 10808*                            ELCSCTP                             *
 10809*                            VMOD=2.001                          *
 10810*                                                                *
 10811*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10812******************************************************************
 10813
 10814
 10815     MOVE EIBDATE          TO SM-JUL-DATE.
 10816     MOVE EIBTRMID         TO SM-TERMID.
 10817     MOVE THIS-PGM         TO SM-PGM.
 10818     MOVE EIBTIME          TO TIME-IN.
 10819     MOVE TIME-OUT         TO SM-TIME.
 10820     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10821
 10822
 10823* EXEC CICS LINK
 10824*         PROGRAM  ('EL003')
 10825*         COMMAREA (SECURITY-MESSAGE)
 10826*         LENGTH   (80)
 10827*    END-EXEC.
 10828     MOVE 'EL003' TO DFHEIV1
 10829     MOVE 80
 10830       TO DFHEIV11
 10831*    MOVE '."C                   (   #00009889' TO DFHEIV0
 10832     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10834     MOVE X'2020233030303039383839' TO DFHEIV0(25:11)
 10835     CALL 'kxdfhei1' USING DFHEIV0,
 10836           DFHEIV1,
 10837           SECURITY-MESSAGE,
 10838           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 222
* EL640.cbl
 10839           DFHEIV99,
 10840           DFHEIV99,
 10841           DFHEIV99,
 10842           DFHEIV99
 10843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10844
 10845
 10846******************************************************************
 10847
 10848
 10849
 10850 9999-DFHBACK SECTION.
 10851     MOVE '9%                    "   ' TO DFHEIV0
 10852     MOVE 'EL640' TO DFHEIV1
 10853     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10854     GOBACK.
 10855 9999-DFHEXIT.
 10856     IF DFHEIGDJ EQUAL 0001
 10857         NEXT SENTENCE
 10858     ELSE IF DFHEIGDJ EQUAL 2
 10859         GO TO 9600-PGMID-ERROR,
 10860               9990-ABEND
 10861         DEPENDING ON DFHEIGDI
 10862     ELSE IF DFHEIGDJ EQUAL 3
 10863         GO TO 0890-EXIT
 10864         DEPENDING ON DFHEIGDI
 10865     ELSE IF DFHEIGDJ EQUAL 4
 10866         GO TO 3930-BILL-NOTFND,
 10867               3930-BILL-NOTOPEN
 10868         DEPENDING ON DFHEIGDI
 10869     ELSE IF DFHEIGDJ EQUAL 5
 10870         GO TO 3940-EXIT
 10871         DEPENDING ON DFHEIGDI
 10872     ELSE IF DFHEIGDJ EQUAL 6
 10873         GO TO 4010-REC-NOT-FND
 10874         DEPENDING ON DFHEIGDI
 10875     ELSE IF DFHEIGDJ EQUAL 7
 10876         GO TO 4110-END-OF-FILE
 10877         DEPENDING ON DFHEIGDI
 10878     ELSE IF DFHEIGDJ EQUAL 8
 10879         GO TO 4270-PNDB-NOTFIND,
 10880               4280-PNDB-FILE-NOTOPEN
 10881         DEPENDING ON DFHEIGDI
 10882     ELSE IF DFHEIGDJ EQUAL 9
 10883         GO TO 4370-ACCOUNT-INVALID,
 10884               4380-ACCT-FILE-NOTOPEN
 10885         DEPENDING ON DFHEIGDI
 10886     ELSE IF DFHEIGDJ EQUAL 10
 10887         GO TO 4470-ACCOUNT-INVALID,
 10888               4480-ACCT-FILE-NOTOPEN
 10889         DEPENDING ON DFHEIGDI
 10890     ELSE IF DFHEIGDJ EQUAL 11
 10891         GO TO 4510-REC-NOT-FND
 10892         DEPENDING ON DFHEIGDI
 10893     ELSE IF DFHEIGDJ EQUAL 12
 10894         GO TO 4610-END-OF-FILE
 10895         DEPENDING ON DFHEIGDI
 10896     ELSE IF DFHEIGDJ EQUAL 13
* Micro Focus Server Express         V5.1 revision 000 04-Apr-13 12:15 Page 223
* EL640.cbl
 10897         GO TO 6070-NO-COMP-MSTR,
 10898               6080-COMP-FILE-NOTOPEN
 10899         DEPENDING ON DFHEIGDI
 10900     ELSE IF DFHEIGDJ EQUAL 14
 10901         GO TO 6045-NO-COMP-MSTR,
 10902               6045-COMP-FILE-NOTOPEN
 10903         DEPENDING ON DFHEIGDI
 10904     ELSE IF DFHEIGDJ EQUAL 15
 10905         GO TO 6110-NO-RECORD
 10906         DEPENDING ON DFHEIGDI
 10907     ELSE IF DFHEIGDJ EQUAL 16
 10908         GO TO 7620-LETR-NOT-FOUND,
 10909               7620-LETR-NOT-FOUND,
 10910               7620-LETR-NOT-OPEN
 10911         DEPENDING ON DFHEIGDI
 10912     ELSE IF DFHEIGDJ EQUAL 17
 10913         GO TO 8300-SEND-TEXT
 10914         DEPENDING ON DFHEIGDI.
 10915     MOVE '9%                    "   ' TO DFHEIV0
 10916     MOVE 'EL640' TO DFHEIV1
 10917     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10918     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8572     Code:       34614
